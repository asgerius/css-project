[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1499293828, "post_id": 44936959, "comment_id": 76850330, "body": "<code>wsSheet.Range(&quot;1:10&quot;).Insert xlDown, xlFormatFromLeftOrAbove</code>"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 5, "creation_date": 1499295156, "post_id": 44936959, "comment_id": 76850798, "body": "or <code>.Rows(&quot;1:10&quot;)</code>, but not <code>.Rows(&quot;1, 10&quot;)</code>"}], "owner": {"reputation": 53, "user_id": 8185006, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dbd412a58ad1ab14829e4ff9a90c65fe?s=128&d=identicon&r=PG&f=1", "display_name": "vba_n00b", "link": "https://stackoverflow.com/users/8185006/vba-n00b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499293581, "creation_date": 1499293581, "question_id": 44936959, "link": "https://stackoverflow.com/questions/44936959/type-mismatch-when-attempting-to-insert-additional-rows", "title": "Type mismatch when attempting to insert additional rows", "body": "<p>I am trying to add 9 new rows above my first row but am running into a type mismatch with the code below: </p>\n\n<pre><code>wsSheet.Rows(\"1, 10\").Insert Shift:=xlDown, CopyOrgin:=xlFormatFromLeftOrAbove\n</code></pre>\n\n<p>I think it's something easy that I'm missing. </p>\n\n<p>I defined wsSheet as a worksheet and can provide more code if necessary. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1499297489, "post_id": 44936926, "comment_id": 76851440, "body": "<a href=\"https://www.mrexcel.com/forum/excel-questions/333961-capture-autofilter-state.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a> (linked from mmurietta&#39;s linked post)"}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499298671, "post_id": 44937214, "comment_id": 76851738, "body": "(a) &quot;the field that it is applied to&quot; - isn&#39;t that determinable by <code>sht.AutoFilter.Range.Columns(f).Column</code> (i.e. the column in the worksheet that is <code>Columns(f)</code> of the filtered range) (b) The code will need to be tweaked a bit if the user is selecting a list of values in a field rather than just one or two values (<code>Criteria1</code> in that case will be a Variant array, which could be accessed by <code>filtarr(f,1)(1)</code>, <code>filtarr(f,1)(2)</code>, etc)"}, {"owner": {"reputation": 149, "user_id": 4959398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rr7CG.jpg?s=128&g=1", "display_name": "Max Tither", "link": "https://stackoverflow.com/users/4959398/max-tither"}, "edited": false, "score": 0, "creation_date": 1499349663, "post_id": 44937214, "comment_id": 76877255, "body": "Thank you for your response. However, I am having issues executing the line With .Filters. The error is: &quot;Run-time error &#39;91&#39;: Object variable or With block variable not set&quot;"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 149, "user_id": 4959398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rr7CG.jpg?s=128&g=1", "display_name": "Max Tither", "link": "https://stackoverflow.com/users/4959398/max-tither"}, "edited": false, "score": 0, "creation_date": 1499364483, "post_id": 44937214, "comment_id": 76887664, "body": "@MaxTither - you first need to test whether <code>sht.AutoFilter</code> is not <code>Nothing</code> - if there&#39;s no Autofilter applied then you cannot access its <code>Filters</code> property"}, {"owner": {"reputation": 149, "user_id": 4959398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rr7CG.jpg?s=128&g=1", "display_name": "Max Tither", "link": "https://stackoverflow.com/users/4959398/max-tither"}, "edited": false, "score": 0, "creation_date": 1499376512, "post_id": 44937214, "comment_id": 76893723, "body": "In the end, I did not end up using this method to solve my problem, Instead I used a pivot table. I will take your word that it is a solution. Thank you @mmurrietta"}], "tags": [], "owner": {"reputation": 151, "user_id": 5816608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a549fc8da904e0df37f505d6ea82a4f9?s=128&d=identicon&r=PG&f=1", "display_name": "mmurrietta", "link": "https://stackoverflow.com/users/5816608/mmurrietta"}, "is_accepted": true, "score": 2, "last_activity_date": 1499297837, "last_edit_date": 1499297837, "creation_date": 1499295066, "answer_id": 44937214, "question_id": 44936926, "link": "https://stackoverflow.com/questions/44936926/how-do-i-get-filter-criteria-in-excel-2016-using-vba/44937214#44937214", "title": "How do I get Filter Criteria in Excel 2016 using VBA?", "body": "<p>I checked <a href=\"https://stackoverflow.com/questions/9489126/in-excel-vba-how-do-i-save-restore-a-user-defined-filter\">this question</a> and pretty much copied the first part of the code, the only thing is you don't get the field that it is applied to which can be problematic.</p>\n\n<pre><code>Dim sht As Worksheet\nSet sht = ActiveSheet\nWith sht.AutoFilter\n    With .Filters\n        ReDim filtarr(1 To .Count, 1 To 3)\n        For f = 1 To .Count\n            With .Item(f)\n                If .On Then\n                    filtarr(f, 1) = .Criteria1\n                    Debug.Print .Criteria1\n                    If .Operator Then\n                        filtarr(f, 2) = .Operator\n                        filtarr(f, 3) = .Criteria2\n                        Debug.Print .Operator &amp; \", \" &amp; .Criteria2\n                    End If\n                End If\n            End With\n        Next f\n    End With\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1499304127, "creation_date": 1499304127, "answer_id": 44938351, "question_id": 44936926, "link": "https://stackoverflow.com/questions/44936926/how-do-i-get-filter-criteria-in-excel-2016-using-vba/44938351#44938351", "title": "How do I get Filter Criteria in Excel 2016 using VBA?", "body": "<p>the code would to be like this. The code of field is  cells(1, f).</p>\n\n<pre><code>Dim sht As Worksheet\nSet sht = ActiveSheet\nWith sht.AutoFilter\n    With .Filters\n        ReDim filtarr(1 To .Count, 1 To 4) ' change array\n        For f = 1 To .Count\n            With .Item(f)\n                If .On Then\n                    filtarr(f, 1) = .Criteria1\n                    filtarr(f, 4) = Cells(1, f) 'field\n                    Debug.Print .Criteria1, Cells(1, f)\n                    If .Operator Then\n                        filtarr(f, 2) = .Operator\n                        filtarr(f, 3) = .Criteria2\n\n                        Debug.Print .Operator &amp; \", \" &amp; .Criteria2\n                    End If\n                End If\n            End With\n        Next f\n    End With\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 10051852, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HQ_dKTi5F0A/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7q3igNpWLKejtwWbE6HVTV54UIrKQ/mo/photo.jpg?sz=128", "display_name": "Neil Cothran", "link": "https://stackoverflow.com/users/10051852/neil-cothran"}, "edited": false, "score": 0, "creation_date": 1548081045, "post_id": 54276973, "comment_id": 95404682, "body": "Fixed.See answer here: <a href=\"https://stackoverflow.com/questions/54291924/finding-the-status-of-arbitrarily-applied-autofilter-in-excel-2016\">link</a>"}], "tags": [], "owner": {"reputation": 31, "user_id": 10051852, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HQ_dKTi5F0A/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7q3igNpWLKejtwWbE6HVTV54UIrKQ/mo/photo.jpg?sz=128", "display_name": "Neil Cothran", "link": "https://stackoverflow.com/users/10051852/neil-cothran"}, "is_accepted": false, "score": 2, "last_activity_date": 1547991322, "creation_date": 1547991322, "answer_id": 54276973, "question_id": 44936926, "link": "https://stackoverflow.com/questions/44936926/how-do-i-get-filter-criteria-in-excel-2016-using-vba/54276973#54276973", "title": "How do I get Filter Criteria in Excel 2016 using VBA?", "body": "<p>I'd like to add a bit to the discussion.  I found this (and other excellent sources of help) when investigating how to \"return\" the filter status.  In my case, I want to DISPLAY the filter status in a cell on a worksheet.</p>\n\n<p>As I said, this question and many others like it were quite useful.  From that, I was able to build the function shown in the code below.</p>\n\n<p>I pass it the name of the Table for which I want the filter status... thus it's passed in as a RANGE and it then needs to look in the PARENT (sheet) for information.  This is because there may be several Tables on the SHEET from which it comes, so I can't just use the SHEET itself to get Autofilter information.</p>\n\n<p>This works well, except for one thing:  if the active cell on the worksheet is NOT within the table in question, the function will see the number of filters as zero (WholeTable.Parent.Autofilter.Filters.Count in the sample below). I do not understand why this is, nor how to prevent it.  If the active cell IS within the table range, it works perfectly.</p>\n\n<p>Any hints would be appreciated!</p>\n\n<p>Code:</p>\n\n<hr>\n\n<pre><code>Public Function AutoFilterCriteria(ByVal WholeTable As Range) As String\n\nOn Error Resume Next\n\nIf WholeTable.Parent.AutoFilter Is Nothing Then                     ' if no filter is applied\n    AutoFilterCriteria = \"None\"\n    On Error GoTo 0\n    Exit Function\nEnd If\n\nDim LongStr As String, FirstOne As Boolean\nLongStr = \"\"\nFirstOne = False\n\nDim iFilt As Integer\nFor iFilt = 1 To WholeTable.Parent.AutoFilter.Filters.Count         ' loop through each column of the table\n    Dim ThisFilt As Filter\n    Set ThisFilt = WholeTable.Parent.AutoFilter.Filters(iFilt)      ' look at each filter\n    On Error Resume Next\n    With ThisFilt\n        If .On Then\n            If FirstOne Then LongStr = LongStr &amp; \" AND \"            ' Get column title\n            LongStr = LongStr &amp; \"[\" &amp; WholeTable.Parent.Cells(WholeTable.Row - 1, WholeTable.Column + iFilt - 1).Value &amp; \":\"\n            On Error GoTo Handle\n            If .Operator = xlFilterValues Then                      ' dont really care to enumerate multiples, just show \"multiple\"\n                LongStr = LongStr &amp; \"&lt;Multiple&gt;]\"\n            ElseIf .Operator = 0 Then\n                LongStr = LongStr &amp; .Criteria1 &amp; \"]\"\n            ElseIf .Operator = xlAnd Then\n                LongStr = LongStr &amp; .Criteria1 &amp; \" AND \" &amp; .Criteria2 &amp; \"]\"\n            ElseIf .Operator = xlOr Then\n                LongStr = LongStr &amp; .Criteria1 &amp; \" OR \" &amp; .Criteria2 &amp; \"]\"\n            End If\n            On Error GoTo 0\n            FirstOne = True\n        End If\n    End With\nNext\n\nAutoFilterCriteria = LongStr\nOn Error GoTo 0\nExit Function\n\nHandle:\nAutoFilterCriteria = \"! Error !\"\nOn Error GoTo 0\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 4959398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rr7CG.jpg?s=128&g=1", "display_name": "Max Tither", "link": "https://stackoverflow.com/users/4959398/max-tither"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10061, "favorite_count": 0, "accepted_answer_id": 44937214, "answer_count": 3, "score": 3, "last_activity_date": 1616179279, "creation_date": 1499293392, "last_edit_date": 1616179279, "question_id": 44936926, "link": "https://stackoverflow.com/questions/44936926/how-do-i-get-filter-criteria-in-excel-2016-using-vba", "title": "How do I get Filter Criteria in Excel 2016 using VBA?", "body": "<p>I am working on an Excel 2016 VBA Macro that applies a filter to the headings column. Afterwards, the user applies the filter criteria. I would like to be able to in VBA retrieve the filter criteria that the user applied and save it to a string array. Is there a way to access the filter criteria?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1499293634, "post_id": 44936886, "comment_id": 76850232, "body": "Seems like a lot of the relevant code is missing?  There&#39;s nothing related to color here..."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1499349317, "post_id": 44936886, "comment_id": 76876955, "body": "Could you please at least add some screenshots to the question."}, {"owner": {"reputation": 293, "user_id": 5165649, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fdb6cff5b8df87ce947970505dc220e9?s=128&d=identicon&r=PG&f=1", "display_name": "viji", "link": "https://stackoverflow.com/users/5165649/viji"}, "edited": false, "score": 0, "creation_date": 1499377689, "post_id": 44936886, "comment_id": 76894180, "body": "How do I save the format? I guess the value is making it to lose the format.  I guess all I need to do is save the format in this step     ` Range(Ran).Value = Range(Ran).Value &amp; &quot;, &quot; &amp; searchTerms`"}, {"owner": {"reputation": 293, "user_id": 5165649, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fdb6cff5b8df87ce947970505dc220e9?s=128&d=identicon&r=PG&f=1", "display_name": "viji", "link": "https://stackoverflow.com/users/5165649/viji"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1499431703, "post_id": 44936886, "comment_id": 76916973, "body": "@Tim Williams  How to save the font color along with value"}], "answers": [{"comments": [{"owner": {"reputation": 293, "user_id": 5165649, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fdb6cff5b8df87ce947970505dc220e9?s=128&d=identicon&r=PG&f=1", "display_name": "viji", "link": "https://stackoverflow.com/users/5165649/viji"}, "edited": false, "score": 0, "creation_date": 1499795652, "post_id": 44976151, "comment_id": 77057091, "body": "Should I insert this part of code in the highlight function or before using highlight function?as I get the inputs from the user like fontcolor, or the range where I need to insert and basically this is what my highlight function is doing right?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 293, "user_id": 5165649, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fdb6cff5b8df87ce947970505dc220e9?s=128&d=identicon&r=PG&f=1", "display_name": "viji", "link": "https://stackoverflow.com/users/5165649/viji"}, "edited": false, "score": 0, "creation_date": 1499796377, "post_id": 44976151, "comment_id": 77057563, "body": "The relevant change you need to make in your code is that to add to add content to existing content you should use the <code>Characters</code> collection (<code>.Characters(l + 1, Len(txt) + 2).Text = &quot;,&quot; &amp; txt</code>) instead of using something like <code>Range(Ran).Value = Range(Ran).Value &amp; &quot;, &quot; &amp; searchTerms</code>"}, {"owner": {"reputation": 293, "user_id": 5165649, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fdb6cff5b8df87ce947970505dc220e9?s=128&d=identicon&r=PG&f=1", "display_name": "viji", "link": "https://stackoverflow.com/users/5165649/viji"}, "edited": false, "score": 0, "creation_date": 1499803682, "post_id": 44976151, "comment_id": 77061579, "body": "it it possible to force &quot;,&quot; to be black always"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 293, "user_id": 5165649, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fdb6cff5b8df87ce947970505dc220e9?s=128&d=identicon&r=PG&f=1", "display_name": "viji", "link": "https://stackoverflow.com/users/5165649/viji"}, "edited": false, "score": 0, "creation_date": 1499803752, "post_id": 44976151, "comment_id": 77061621, "body": "Yes if that&#39;s what you want - find the &quot;,&quot; and color it/them black: by default it will inherit the color from any existing content."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1499446667, "creation_date": 1499446667, "answer_id": 44976151, "question_id": 44936886, "link": "https://stackoverflow.com/questions/44936886/how-do-i-force-the-font-color-to-remain-the-way-it-is-rather-than-changing/44976151#44976151", "title": "How do I force the font color to remain the way it is rather than changing", "body": "<p>When you do this to add the new words:</p>\n\n<pre><code>Range(Ran).Value = Range(Ran).Value &amp; \", \" &amp; searchTerms\n</code></pre>\n\n<p>you cannot preserve multiple colors of text - replacing the content will just give the whole cell the color of the first letter.  That's OK for your first and second runs, but will fail from run 3 forward.</p>\n\n<p>You need to add the new text using the Characters collection, not by replacing the whole cell content.</p>\n\n<p>Example:</p>\n\n<pre><code>Sub Tester()\n\n    Dim c As Range\n    Set c = Range(\"A1\")\n\n    AddTextWithColor c, \"first\", vbRed\n    AddTextWithColor c, \"second\", vbBlue\n    AddTextWithColor c, \"third\", vbGreen\n\nEnd Sub\n\nSub AddTextWithColor(c As Range, txt As String, clr As Long)\n    Dim l As Long\n    With c\n        If Len(.Value) = 0 Then\n            .Value = txt\n        Else\n            l = .Characters.Count\n            'adds the new text without replacing existing formatting\n            .Characters(l + 1, Len(txt) + 2).Text = \",\" &amp; txt\n        End If\n        With .Characters(IIf(l = 0, 1, l + 2), Len(txt)).Font\n            .Color = clr\n            .Size = 14\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 293, "user_id": 5165649, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fdb6cff5b8df87ce947970505dc220e9?s=128&d=identicon&r=PG&f=1", "display_name": "viji", "link": "https://stackoverflow.com/users/5165649/viji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 1, "accepted_answer_id": 44976151, "answer_count": 1, "score": 0, "last_activity_date": 1499446667, "creation_date": 1499293163, "last_edit_date": 1531164843, "question_id": 44936886, "link": "https://stackoverflow.com/questions/44936886/how-do-i-force-the-font-color-to-remain-the-way-it-is-rather-than-changing", "title": "How do I force the font color to remain the way it is rather than changing", "body": "<p>My program basically highlights the keywords in text to the user choice font color.I have a problem only when displaying the search terms in the cell that is specified by the user not in actual execution of the program. I take the terms input, range/cell to display these terms, font color from the user. This is partial code:</p>\n\n<pre><code> Dim Ran As String\n          searchTerms = InputBox(\"Please enter words to search, if more than one string seperate by comma and space\", \"Need Input\", 1)\n\n\n       Ran = InputBox(\"Please enter cell where you want the search terms to be displayed ideally below verbatim like C2,D2 \", \"Need Input\", 0, 8)\n      r = Range(Ran).Row\n      c = Range(Ran).Column\n\n       If IsEmpty(Cells(r, 1)) And c &lt;&gt; \"A\" Then\n         Range(Ran).Value = Range(Ran).Value &amp; \", \" &amp; searchTerms\n        Else: Range(Ran).EntireRow.Insert\n        Range(Ran).Value = searchTerms\n        End If\n\n       searchTerms = Split(UCase(searchTerms), \", \")\n</code></pre>\n\n<p>This works as expected for 2 executions but for third time execution the previous execution font color changes to the 1st execution color. How do I force it to remain as it was before execution. Suppose after 1st time execution it was yellow, After Second execution the appended variables were green, Then when I am performing the third execution the whole cell content change to yellow before peforming the execution and the only the third execution terms will change to user defined font color. But the Second execution appended terms will be yellow as first execution color.\nThis is the code which is highlighting function:</p>\n\n<pre><code>Function HilightString(offSet As Integer, searchString As String, rowNum As Long, ingredCol As String, FontColor, fontSize As Integer) As Integer\n\n        Dim x As Integer\n        Dim newOffset As Integer\n        Dim targetString As Variant\n\n         If Cells(rowNum, ingredCol).HasFormula Then\nCells(rowNum, ingredCol).Value = \"'\" &amp; Cells(rowNum, ingredCol).Formula\nEnd If\n        targetString = Mid(Cells(rowNum, ingredCol), offSet)\n        foundPos = InStr(UCase(targetString), searchString)\n\n        If foundPos &gt; 0 Then\n\n            Cells(rowNum, ingredCol).Characters(offSet + foundPos - 1, Len(searchString)).Font.ColorIndex = FontColor\n\n            Cells(rowNum, ingredCol).Characters(offSet + foundPos - 1, Len(searchString)).Font.Size = 14\n\n            newOffset = offSet + foundPos + Len(searchString)\n\n            x = HilightString(newOffset, searchString, rowNum, ingredCol, FontColor, fontSize)\n        Else\n\n            Exit Function\n\n        End If\n End Function\n</code></pre>\n\n<p>First execution highlighted turn, signal in blue and created in cell c2:<a href=\"https://i.stack.imgur.com/khCvs.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/khCvs.jpg\" alt=\"After 1st execution\"></a></p>\n\n<p>Second execution highlighted Rear in green It works fine till this point<a href=\"https://i.stack.imgur.com/8LdLa.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8LdLa.jpg\" alt=\"Second execution\"></a></p>\n\n<p>Before complete third execution highlighted blink <a href=\"https://i.stack.imgur.com/Z6W66.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Z6W66.jpg\" alt=\"Before complete 3rd execution\"></a></p>\n\n<p>After 3rd execution. The second executed words turn back to blue <a href=\"https://i.stack.imgur.com/OD12n.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OD12n.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1499293332, "creation_date": 1499293332, "answer_id": 44936914, "question_id": 44936841, "link": "https://stackoverflow.com/questions/44936841/how-to-create-message-box-when-a-value-changes-in-a-range-based-off-a-formula-on/44936914#44936914", "title": "How to create message box when a value changes in a range based off a formula on a different worksheet", "body": "<p>Worksheet_Change events only fire when a value is entered into a cell, not when a formula recalculates the value of a cell. You will need to hook the event to the data entry cell, then use code to check the values in column J for zeros.</p>\n"}], "owner": {"reputation": 11, "user_id": 8261688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/879de266732d605a3ff05c1bf1fda60b?s=128&d=identicon&r=PG&f=1", "display_name": "nunzio", "link": "https://stackoverflow.com/users/8261688/nunzio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1499293332, "creation_date": 1499292848, "last_edit_date": 1531164843, "question_id": 44936841, "link": "https://stackoverflow.com/questions/44936841/how-to-create-message-box-when-a-value-changes-in-a-range-based-off-a-formula-on", "title": "How to create message box when a value changes in a range based off a formula on a different worksheet", "body": "<p>I am trying to create a message box automatically when a cell on a separate worksheet equals 0 in column J. </p>\n\n<p>The values in column J are calculated using a formula based off input values.</p>\n\n<p>I tried using the intersection function and cannot get it to work when operating in a range that is not a specific cell. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499291716, "post_id": 44936543, "comment_id": 76849477, "body": "In the <code>.Formula</code> statement, replace each <code>aCell</code> with <code>&quot; &amp; aCell &amp; &quot;</code>.  do the same for <code>dCell</code> and <code>eCell</code>."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499292056, "post_id": 44936543, "comment_id": 76849629, "body": "And change <code>aCell</code> to <code>cCell</code> just below your <code>&#39;Range(&quot;C2&quot;)</code> comment."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1499292401, "post_id": 44936543, "comment_id": 76849779, "body": "re: <i>because i have two formulas depending on the length of text in Column A&#39;s Cell</i> - this is what has not been described fully. You should easily be able to use one formula for all."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1499293095, "post_id": 44936543, "comment_id": 76850034, "body": "<code>aCell =</code> is in twice, guessing the second instance should be <code>cCell</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": true, "score": 1, "last_activity_date": 1499293766, "creation_date": 1499293766, "answer_id": 44936985, "question_id": 44936543, "link": "https://stackoverflow.com/questions/44936543/loop-formula-in-excel-vba/44936985#44936985", "title": "Loop formula in excel vba", "body": "<p>You haven't explained the number of chars to determine which formula to use, you can use an IF statement to determine the char length of a cell using <code>LEN</code> Then you can post your formula with just one line of code to the entire range as Excel is smart enough to increment by row. Here is an example:</p>\n\n<pre><code>Range(\"B1:B\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row).Formula = \"=IF(LEN(A1)=2,123,987)\"\n</code></pre>\n\n<p>This will put 123 in column B where the corresponding row in column A has a length of 2 characters otherwise it will enter 987.</p>\n\n<p>Change the <code>LEN(A1)=2</code> to the length to trigger the first formula, change 123 to the first formula and change 987 to the second formula you want. If you are testing any cell other than column A, also change that in the <code>LEN</code> part of the formula.</p>\n\n<p>Lastly, why on earth are you making this so complex? Why do <code>CHAR(83)&amp;CHAR(45)</code> instead of <code>\"S-\"</code> its going to be harder to maintain if you put everything in by it's ASCII code.</p>\n"}], "owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 768, "favorite_count": 0, "accepted_answer_id": 44936985, "answer_count": 1, "score": 0, "last_activity_date": 1499293766, "creation_date": 1499291346, "question_id": 44936543, "link": "https://stackoverflow.com/questions/44936543/loop-formula-in-excel-vba", "title": "Loop formula in excel vba", "body": "<p>I am trying to loop a formula instead of using <code>filldown</code> because i have two formulas depending on the length of text in Column A's Cell.</p>\n\n<p>my two formulas are like</p>\n\n<p><code>.Range(\"C2\").Formula = \"=CHAR(83)&amp;CHAR(45)&amp;LEFT(A2,LEN(A2)-9)&amp;CHAR(45)&amp;UPPER(MID(A2,4,LEN(A2)-8))&amp;CHAR(32)&amp;D2&amp;E2\"</code></p>\n\n<p><code>.Range(\"C2\").Formula = \"=LEFT(A2,LEN(A2)-9)&amp;CHAR(45)&amp;UPPER(MID(A2,8,LEN(A2)-12))&amp;CHAR(32)&amp;D2&amp;E2\"</code></p>\n\n<p>This is what i have so far.</p>\n\n<pre><code>Sub AddFormulas()\nApplication.ScreenUpdating = False\n\nDim aCell As String\nDim cCell As String\nDim dCell As String\nDim eCell As String\nDim rowStart As Integer\nDim aCol As Integer\nDim cCol As Integer\nDim dCol As Integer\nDim eCol As Integer\nDim LastRow As Long\nLastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nrowStart = 2\naCol = 1\ncCol = 3\ndCol = 4\neCol = 5\n'Range(\"A2\")\naCell = Cells(rowStart, aCol).Address(RowAbsolute:=False, _\n                                ColumnAbsolute:=False)\n'Range(\"C2\")\naCell = Cells(rowStart, cCol).Address(RowAbsolute:=False, _\n                                ColumnAbsolute:=False)\n'Range(\"D2\")\ndCell = Cells(rowStart, dCol).Address(RowAbsolute:=False, _\n                                ColumnAbsolute:=False)\n'Range(\"E2\")\neCell = Cells(rowStart, eCol).Address(RowAbsolute:=False, _\n                                ColumnAbsolute:=False)\n\nWith ThisWorkbook.Sheets(\"Sheet1\")\n        .Range(cCell).Formula = \"=CHAR(83)&amp;CHAR(45)&amp;LEFT(aCell,LEN(aCell)-9)&amp;CHAR(45)&amp;UPPER(MID(aCell,4,LEN(aCell)-8))&amp;CHAR(32)&amp;(dCell)&amp;(eCell)\"\nEnd With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Thx</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 10875, "user_id": 2392157, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QEWAU.png?s=128&g=1", "display_name": "miroxlav", "link": "https://stackoverflow.com/users/2392157/miroxlav"}, "edited": false, "score": 3, "creation_date": 1499288981, "post_id": 44935988, "comment_id": 76848266, "body": "Description &quot;the code doesn&#39;t seem to function&quot; is too vague. Could you please <a href=\"https://stackoverflow.com/posts/44935988/edit\">edit</a> the question and add explanation what exact issues do you have with the code?"}], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 2566295, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e99f3198bbba00e653d44745ba6ec68a?s=128&d=identicon&r=PG", "display_name": "sai", "link": "https://stackoverflow.com/users/2566295/sai"}, "edited": false, "score": 0, "creation_date": 1499291296, "post_id": 44936460, "comment_id": 76849328, "body": "Quick question what if I want the list to be array would the code still work."}, {"owner": {"reputation": 558, "user_id": 7927748, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/62bb7763ae9694456113fb6787786e9a?s=128&d=identicon&r=PG&f=1", "display_name": "Torc", "link": "https://stackoverflow.com/users/7927748/torc"}, "reply_to_user": {"reputation": 183, "user_id": 2566295, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e99f3198bbba00e653d44745ba6ec68a?s=128&d=identicon&r=PG", "display_name": "sai", "link": "https://stackoverflow.com/users/2566295/sai"}, "edited": false, "score": 0, "creation_date": 1499293198, "post_id": 44936460, "comment_id": 76850073, "body": "Short answer is yes, but are you looking for a fixed length array or a variable size? Also, how are you going to feed values to the array?"}, {"owner": {"reputation": 183, "user_id": 2566295, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e99f3198bbba00e653d44745ba6ec68a?s=128&d=identicon&r=PG", "display_name": "sai", "link": "https://stackoverflow.com/users/2566295/sai"}, "edited": false, "score": 0, "creation_date": 1499351928, "post_id": 44936460, "comment_id": 76879195, "body": "Fixed length - 2"}, {"owner": {"reputation": 183, "user_id": 2566295, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e99f3198bbba00e653d44745ba6ec68a?s=128&d=identicon&r=PG", "display_name": "sai", "link": "https://stackoverflow.com/users/2566295/sai"}, "edited": false, "score": 0, "creation_date": 1499352097, "post_id": 44936460, "comment_id": 76879327, "body": "Dim Ar As Variant     Ar = Range(&quot;A1:A2&quot;).Value"}, {"owner": {"reputation": 183, "user_id": 2566295, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e99f3198bbba00e653d44745ba6ec68a?s=128&d=identicon&r=PG", "display_name": "sai", "link": "https://stackoverflow.com/users/2566295/sai"}, "edited": false, "score": 0, "creation_date": 1499364254, "post_id": 44936460, "comment_id": 76887531, "body": "I have 3 sheets with about 30K rows in them , this script is running a long time and I had to kill the file ( ~1 hr). Are there any suggestions for optimizing"}], "tags": [], "owner": {"reputation": 558, "user_id": 7927748, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/62bb7763ae9694456113fb6787786e9a?s=128&d=identicon&r=PG&f=1", "display_name": "Torc", "link": "https://stackoverflow.com/users/7927748/torc"}, "is_accepted": true, "score": 0, "last_activity_date": 1499290955, "creation_date": 1499290955, "answer_id": 44936460, "question_id": 44935988, "link": "https://stackoverflow.com/questions/44935988/vba-to-delete-rows-based-on-cell-value/44936460#44936460", "title": "VBA to delete rows based on cell value", "body": "<p>Try this:</p>\n\n<pre><code>Sub Delete()    \n\nDim i As Integer\nDim LR As Long\nDim List As Variant\n\nLR = Range(\"E\" &amp; Rows.Count).End(xlUp).Row\nList = Worksheets(\"Sheet1\").Cells(28, \"C\").Value   \n\nFor i = 1 To LR\n    If Cells(i, \"E\").Value = List Then\n        Worksheets(\"Sheet1\").Rows(i).Delete\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 558, "user_id": 7927748, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/62bb7763ae9694456113fb6787786e9a?s=128&d=identicon&r=PG&f=1", "display_name": "Torc", "link": "https://stackoverflow.com/users/7927748/torc"}, "is_accepted": false, "score": 0, "last_activity_date": 1499374799, "creation_date": 1499374799, "answer_id": 44958751, "question_id": 44935988, "link": "https://stackoverflow.com/questions/44935988/vba-to-delete-rows-based-on-cell-value/44958751#44958751", "title": "VBA to delete rows based on cell value", "body": "<p>I think you have a few ways of going about this, but the quickest way I know of is to use MATCH to compare values in a range to values in an array. Please note that this has a limit to 4000 or so values to compare before it fails. For your purposes, I think the following will work:</p>\n\n<pre><code>Sub test1()\n    Dim x As Long\n    Dim array1() As Variant\n    Dim array2() As Variant\n\n    array1 = Array(\"ABC\", \"XYX\")\n    array2 = Range(\"A1:A2\")\n\n    If IsNumeric(Application.Match(Range(\"A1\").Value, array1, 0)) Then\n        x = 1\n    ElseIf IsNumeric(Application.Match(Range(\"A1\").Value, array2, 0)) Then\n        x = IsNumeric(Application.Match(Range(\"A1\").Value, array2, 0))\n    End If\n\n    'If x is not found in these arrays, x will be 0.\n    MsgBox x\nEnd Sub\n</code></pre>\n\n<p>Another similar way is the following:</p>\n\n<pre><code>Sub test2()\n    Dim array1() As Variant\n    Dim FilterArray() As String\n    Dim x As Variant\n\n    x = Range(\"A1\").Value\n    array1 = Array(\"ABC\", \"RANDOM\", \"VBA\")\n\n    FilterArray = Filter(SourceArray:=array1, _\n                          Match:=strText, _\n                          Include:=True, _\n                          Compare:=vbTextCompare)\n\n    If UBound(FindOutArray) = -1 Then\n        MsgBox \"No, Array doesn't contain this item - \" &amp; x\n    Else\n        MsgBox \"Yes, Array contains this item - \" &amp; x\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>So if we were to incorporate that all together (and I tested this btw):</p>\n\n<pre><code>Sub Delete()\n\nDim i As Integer\nDim LR As Long\nDim List() As Variant\nDim x As Long\n\nLR = Range(\"E\" &amp; Rows.count).End(xlUp).Row\nList = Worksheets(\"Sheet1\").Range(\"A1:A2\").Value\n\nFor i = 1 To LR\n    If IsNumeric(Application.Match(Cells(i, \"E\").Value, List, 0)) Then\n        Worksheets(\"Sheet1\").Cells(i, \"E\").Value = \"\"\n    End If\nNext i\n\nWorksheets(\"Sheet1\").Columns(\"E\").SpecialCells(xlCellTypeBlanks).Cells.Delete\n\nEnd Sub\n</code></pre>\n\n<p>This will set the cells that have values that are found in the array to blanks. Once the loop is finished, then the blank cells are deleted. If you want to shift the entire rows up, then use this as the last line instead:</p>\n\n<pre><code>Worksheets(\"Sheet1\").Columns(\"E\").SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 2566295, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e99f3198bbba00e653d44745ba6ec68a?s=128&d=identicon&r=PG", "display_name": "sai", "link": "https://stackoverflow.com/users/2566295/sai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2769, "favorite_count": 0, "accepted_answer_id": 44936460, "answer_count": 2, "score": 0, "last_activity_date": 1499374799, "creation_date": 1499288789, "last_edit_date": 1531164843, "question_id": 44935988, "link": "https://stackoverflow.com/questions/44935988/vba-to-delete-rows-based-on-cell-value", "title": "VBA to delete rows based on cell value", "body": "<p>I am trying to do the following :</p>\n\n<ul>\n<li>VBA to lookup a value from a particular cell</li>\n<li>Match these values in a particular column in specified sheets</li>\n<li>Delete all rows from the sheet if the value do not match</li>\n</ul>\n\n<p>I have tried the following - the code doesn't seem to function </p>\n\n<pre><code>Sub Delete()\n    Dim List As Variant\n    Dim LR As Long\n    Dim r As Long\n    List = Worksheets(\"Sheet1\").Cells(28, \"C\").Value\n    LR = Range(\"E\" &amp; Rows.Count).End(xlUp).Row\n    For r = LR To 1 Step -1\n        If IsError(Application.Match(Range(\"E\" &amp; r).Value, List, False)) Then\n            Worksheets(\"Sheet2\").Range(\"A1:AA36429\").Rows(r).Delete\n        End If\n    Next r\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1499288956, "post_id": 44935743, "comment_id": 76848254, "body": "<a href=\"https://stackoverflow.com/q/10714251/1188513\">How to avoid using Select in Excel VBA macros</a>"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1499289556, "post_id": 44935743, "comment_id": 76848523, "body": "Add a flag, and change it based on the date. Use this flag to hide/unhide columns."}], "answers": [{"comments": [{"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1499348282, "post_id": 44936484, "comment_id": 76876112, "body": "Perfect!  That is exactly what I was looking for Paul!!"}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 0, "last_activity_date": 1499291076, "creation_date": 1499291076, "answer_id": 44936484, "question_id": 44935743, "link": "https://stackoverflow.com/questions/44935743/how-can-i-set-the-width-of-certain-columns/44936484#44936484", "title": "How can I set the width of certain columns?", "body": "<pre><code>Sub dostuff()\n    Dim c As Range\n    For Each c In Range(\"A:C\").Columns\n        c.ColumnWidth = 77\n    Next c\nEnd Sub\n</code></pre>\n\n<p>you should be able to fill in the blanks from here</p>\n"}, {"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 2, "last_activity_date": 1499305793, "creation_date": 1499305793, "answer_id": 44938559, "question_id": 44935743, "link": "https://stackoverflow.com/questions/44935743/how-can-i-set-the-width-of-certain-columns/44938559#44938559", "title": "How can I set the width of certain columns?", "body": "<p>Is this what you were trying to do</p>\n\n<pre><code>Option Explicit\n\nPublic Sub HideColumnsContainingValue()\n\n    Dim c As Range\n    Dim thisIsToday As Date\n    Dim twoWeeksBack As Date\n    Dim threeMonthsAhead As Date\n\n    thisIsToday = Date\n    twoWeeksBack = thisIsToday - 14\n    threeMonthsAhead = thisIsToday + 100\n\n    For Each c In Range(\"O4:XA4\").Cells\n        With c\n            If Len(.Value2) &gt; 0 Then        'if not empty\n                If IsDate(.Value) Then      'if date\n\n                    If .Value &lt; twoWeeksBack Or .Value &gt; threeMonthsAhead Then\n                        .EntireColumn.Hidden = True\n                    Else\n                        .ColumnWidth = 1.75\n                    End If\n\n                End If\n            End If\n        End With\n    Next\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>This version is a bit faster</p>\n\n<pre><code>Public Sub HideDatesNotInRange()\n    Dim dateRng As Range, dateArr As Variant\n    Dim c As Long, minDay As Date, maxDay As Date\n\n    minDay = Date - 14\n    maxDay = Date + 100\n    Set dateRng = Range(\"O4:XA4\")\n    dateArr = dateRng                       'iterate over array\n\n    Application.ScreenUpdating = False\n    For c = 1 To UBound(dateArr, 2)\n        If Len(dateArr(1, c)) &gt; 0 Then      'if not empty\n            If IsDate(dateArr(1, c)) Then   'if date\n                With dateRng(1, c)\n                    If dateArr(1, c) &lt; minDay Or dateArr(1, c) &gt; maxDay Then\n                        .EntireColumn.Hidden = True\n                    Else\n                        .ColumnWidth = 1.75\n                    End If\n                End With\n            End If\n        End If\n    Next\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "accepted_answer_id": 44938559, "answer_count": 2, "score": 1, "last_activity_date": 1499305793, "creation_date": 1499287691, "last_edit_date": 1531164843, "question_id": 44935743, "link": "https://stackoverflow.com/questions/44935743/how-can-i-set-the-width-of-certain-columns", "title": "How can I set the width of certain columns?", "body": "<p>I'm playing around with the code sample below.</p>\n\n<pre><code>Sub Hide_Columns_Containing_Value()\n\nDim c As Range\nDim ThisIsToday As Date\nDim TwoWeeksBack As Date\nDim ThreeMonthsAhead As Date\n\n    ThisIsToday = Date\n    TwoWeeksBack = ThisIsToday - 14\n    ThreeMonthsAhead = ThisIsToday + 100\n\nFor Each c In Range(\"O4:XA4\").Cells\nIf c.Value &lt; TwoWeeksBack Or c.Value &gt; ThreeMonthsAhead Then\n    Range(c.Address).Select\n    Selection.ColumnWidth = 1.75\n    Else\n        c.EntireColumn.Hidden = True\n    End If\nNext c\n\nEnd Sub\n</code></pre>\n\n<p>Basically I want to loop through all cells and if the value is a date less than two seeks ago, or more than 3 months from now, I want to hide the column.  The problem is that the dates are not in every cell; the dates are in every 7 cells, which represent every Friday.  The hiding and showing of columns is not working like I want it to, because of all the blank cells.</p>\n\n<p>Here is a screen shot of the dates.</p>\n\n<p><a href=\"https://i.stack.imgur.com/chDUT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/chDUT.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499288991, "post_id": 44935739, "comment_id": 76848273, "body": "Which line gives the error?"}, {"owner": {"reputation": 3, "user_id": 8212314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaea56868c9021583da10398e46243c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo Abreu", "link": "https://stackoverflow.com/users/8212314/ricardo-abreu"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499290361, "post_id": 44935739, "comment_id": 76848914, "body": "lRowDT = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1499290909, "post_id": 44935739, "comment_id": 76849149, "body": "I don&#39;t suppose the <code>ActiveSheet</code> after opening the &quot;Data Fuel.xls&quot; workbook is a <code>Chart</code>, is it?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499294002, "post_id": 44935739, "comment_id": 76850400, "body": "Try <code>Dim lRowDT As Long</code>. always use long for your variables, never use <code>Integer</code> in VBA unless you have a very special reason."}, {"owner": {"reputation": 3, "user_id": 8212314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaea56868c9021583da10398e46243c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo Abreu", "link": "https://stackoverflow.com/users/8212314/ricardo-abreu"}, "edited": false, "score": 0, "creation_date": 1499370073, "post_id": 44935739, "comment_id": 76890587, "body": "It&#39;s not a chart YowE3K."}, {"owner": {"reputation": 3, "user_id": 8212314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaea56868c9021583da10398e46243c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo Abreu", "link": "https://stackoverflow.com/users/8212314/ricardo-abreu"}, "edited": false, "score": 0, "creation_date": 1499370107, "post_id": 44935739, "comment_id": 76890603, "body": "I tried as long as well but gives me the same error"}, {"owner": {"reputation": 3, "user_id": 8212314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaea56868c9021583da10398e46243c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo Abreu", "link": "https://stackoverflow.com/users/8212314/ricardo-abreu"}, "edited": false, "score": 0, "creation_date": 1499370231, "post_id": 44935739, "comment_id": 76890663, "body": "I simply don&#39;t get it. This is so frustrating sometimes."}, {"owner": {"reputation": 3, "user_id": 8212314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaea56868c9021583da10398e46243c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo Abreu", "link": "https://stackoverflow.com/users/8212314/ricardo-abreu"}, "edited": false, "score": 0, "creation_date": 1499370634, "post_id": 44935739, "comment_id": 76890843, "body": "On lRowDT It is giving me =0 and on Rows.Count=1048576. But I don&#39;t know why."}, {"owner": {"reputation": 3, "user_id": 8212314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaea56868c9021583da10398e46243c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo Abreu", "link": "https://stackoverflow.com/users/8212314/ricardo-abreu"}, "edited": false, "score": 0, "creation_date": 1499370951, "post_id": 44935739, "comment_id": 76890981, "body": "Also he is opening the document correctly but he doesn&#39;t select what I want..."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8212314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaea56868c9021583da10398e46243c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo Abreu", "link": "https://stackoverflow.com/users/8212314/ricardo-abreu"}, "edited": false, "score": 0, "creation_date": 1499369767, "post_id": 44938673, "comment_id": 76890437, "body": "There&#180;s data on column L as well on A, and in between."}, {"owner": {"reputation": 3, "user_id": 8212314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaea56868c9021583da10398e46243c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo Abreu", "link": "https://stackoverflow.com/users/8212314/ricardo-abreu"}, "edited": false, "score": 0, "creation_date": 1499369921, "post_id": 44938673, "comment_id": 76890506, "body": "I have data on A,B,C,H,I and L, there&#39;s columns  in the middle without data but I need to select everything anyway. Thanks for your help"}, {"owner": {"reputation": 3, "user_id": 8212314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaea56868c9021583da10398e46243c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo Abreu", "link": "https://stackoverflow.com/users/8212314/ricardo-abreu"}, "edited": false, "score": 0, "creation_date": 1499370616, "post_id": 44938673, "comment_id": 76890836, "body": "On lRowDT It is giving me =0 and on Rows.Count=1048576. But I don&#39;t know why."}, {"owner": {"reputation": 3, "user_id": 8212314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaea56868c9021583da10398e46243c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo Abreu", "link": "https://stackoverflow.com/users/8212314/ricardo-abreu"}, "edited": false, "score": 0, "creation_date": 1499371236, "post_id": 44938673, "comment_id": 76891122, "body": "Yes it worked by your way. Thanks mate. But I can&#39;t figurer it out why it doesn&#39;t work on my way."}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": true, "score": 0, "last_activity_date": 1499306552, "creation_date": 1499306552, "answer_id": 44938673, "question_id": 44935739, "link": "https://stackoverflow.com/questions/44935739/object-defined-error-copying-range-till-the-last-row-of-information/44938673#44938673", "title": "Object defined error - copying range till the last row of information", "body": "<p>If there is not data over colums L , then this code is suitable.</p>\n\n<pre><code>Sub Subtotals()\nDim DT As Workbook\nDim lRowDT As Integer\nDim Ws As Worksheet\nDim rngDB As Range, r As Long, c As Long\n\n    Set DT = Workbooks.Open(\"C:\\Users\\ricardo\\Desktop\\Data Fuel.xls\")\n    'lRowDT = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n\n    Set Ws = Workbooks(\"Data Fuel.xls\").Worksheets(\"Data\")\n    With Ws\n        r = .Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n        c = .Cells.Find(\"*\", SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Column\n        Set rngDB = .Range(\"a7\", .Cells(r, \"L\"))\n    End With\n    rngDB.Copy\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8212314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaea56868c9021583da10398e46243c9?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo Abreu", "link": "https://stackoverflow.com/users/8212314/ricardo-abreu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 44938673, "answer_count": 1, "score": 0, "last_activity_date": 1499306552, "creation_date": 1499287681, "last_edit_date": 1531164843, "question_id": 44935739, "link": "https://stackoverflow.com/questions/44935739/object-defined-error-copying-range-till-the-last-row-of-information", "title": "Object defined error - copying range till the last row of information", "body": "<p>I'm trying to open a workbook and then select and copy a range from A7 to L7 until the last row of information (in a downward direction). I think the variable isn't properly defined. Any help?     </p>\n\n<pre><code>Sub Subtotals()\nDim DT As Workbook\nDim lRowDT As Integer\n\n\nSet DT = Workbooks.Open(\"C:\\Users\\ricardo\\Desktop\\Data Fuel.xls\")\nlRowDT = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n\nWorkbooks(\"Data Fuel.xls\").Worksheets(\"Data\").Activate\nWorksheets(\"Data\").Range(\"A7:L\" &amp; lRowDT).Copy\n\nEnd sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1499287404, "post_id": 44935346, "comment_id": 76847493, "body": "<i>I can&#39;t figure it out despite multiple hours of googling</i> - yet 30 seconds of <i>debugging</i> would have fixed it. F9 to toggle breakpoints, F8 to step through, Shift+F8 to step over; then you have the <i>locals</i> toolwindow, the <i>immediate</i> pane (Ctrl+G). Place a breakpoint on that <code>With</code> instruction, run it, then press F8 once to get to the <code>If</code> statement. Hover the <code>.OnClick</code> token and you&#39;ll see why next time you press F8 execution jumps to <code>End If</code> and out of the procedure."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1499287142, "post_id": 44935468, "comment_id": 76847354, "body": "That. Also remove that <code>With</code> block, replace that instruction separator colon <code>Else:</code> with an actual line break, and remove all these redundant parentheses in <code>OpenQuery</code> and <code>MsgBox</code> calls."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1499286609, "creation_date": 1499286609, "answer_id": 44935468, "question_id": 44935346, "link": "https://stackoverflow.com/questions/44935346/button-click-event-in-access-vba-code-doesnt-open-queries-as-expected/44935468#44935468", "title": "Button_Click event in Access VBA code doesn&#39;t open queries as expected", "body": "<p><code>If .OnClick = \"\" Then</code> results to false. It is set to <code>[Event Procedure]</code>. </p>\n\n<p>This causes none of your query code to be run.\nRemove it, and the corresponding <code>End If</code></p>\n"}], "owner": {"reputation": 5, "user_id": 8261239, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kyuonFZiW40/AAAAAAAAAAI/AAAAAAAAMRk/tEQ7SiuP5n8/photo.jpg?sz=128", "display_name": "Aidan Hoffman", "link": "https://stackoverflow.com/users/8261239/aidan-hoffman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "accepted_answer_id": 44935468, "answer_count": 1, "score": 0, "last_activity_date": 1499286609, "creation_date": 1499286186, "question_id": 44935346, "link": "https://stackoverflow.com/questions/44935346/button-click-event-in-access-vba-code-doesnt-open-queries-as-expected", "title": "Button_Click event in Access VBA code doesn&#39;t open queries as expected", "body": "<p>I've written the following VBA code to execute some queries off of a form with two text boxes and a button to run the appropriate query. When I perform the click event though, nothing happens... my queries don't open regardless of input, and even with no input the error msgbox doesn't display. I'm still pretty new to VBA and coding in general so I might be missing something obvious, but I can't see any glaring issues. On button click the debug.print does print, so the code is being accessed, it just isn't doing anything. I imagine it has to do with the nested If statements and specifically the opening of the queries, but I can't figure it out despite multiple hours of googling. </p>\n\n<p>This is the button click event. </p>\n\n<pre><code>Private Sub RunQ_Click()\n\nDim Frm As Form\nDim MdlF As TextBox\nDim PartF As TextBox\n\nSet Frm = Forms(\"SearchFormParts\")\nSet MdlF = Forms!SearchFormParts.Controls(\"ModelNoF\")\nSet PartF = Forms!SearchFormParts.Controls(\"PartNoF\")\nDebug.Print \"this code is working2\"\nWith Forms!SearchFormParts.Controls(\"RunQ\")\n    If .OnClick = \"\" Then\n        If MdlF = vbNullString Then\n            If PartF = vbNullString Then\n                DoCmd.OpenQuery (\"CCModel\")\n            Else\n                DoCmd.OpenQuery (\"CCBoth\")\n            End If\n        ElseIf PartF = vbNullString Then\n            If MdlF = vbNullString Then\n                DoCmd.OpenQuery (\"CCPart\")\n            Else\n                DoCmd.OpenQuery (\"CCBoth\")\n            End If\n        Else: MsgBox (\"Please enter a value in either or both fields!\")\n        End If\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Thank you :)</p>\n"}, {"tags": ["vba", "excel", "utf-8", "adodb"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1499285971, "post_id": 44935240, "comment_id": 76846757, "body": "What is the error, and on which line?"}, {"owner": {"reputation": 3, "user_id": 8227180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df391753e62afa3742261429da57b41d?s=128&d=identicon&r=PG&f=1", "display_name": "ChuckCT36", "link": "https://stackoverflow.com/users/8227180/chuckct36"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1499286652, "post_id": 44935240, "comment_id": 76847103, "body": "The error I&#39;m receiving is a type mismatch error for the &quot;objStream.CopyTo Output&quot; line. Thanks!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499288864, "post_id": 44935240, "comment_id": 76848228, "body": "@YowE3K - my bad for not reading through more carefully: I missed the same declaration/assignment was repeated when I was looking mainly at the <code>CopyTo</code> line...  Fixed in my answer and thanks for raising that."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8227180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df391753e62afa3742261429da57b41d?s=128&d=identicon&r=PG&f=1", "display_name": "ChuckCT36", "link": "https://stackoverflow.com/users/8227180/chuckct36"}, "edited": false, "score": 0, "creation_date": 1499291830, "post_id": 44935769, "comment_id": 76849533, "body": "Thanks for the help Tim! I&#39;m breaking out the section into it&#39;s own sub since I got an error for the process being too long. I know I can loop the information I&#39;m trying to export row by row but since my knowledge is limited, I&#39;m having a difficult time. I also prefer to write it all out just so I can understand how each line works. Again, I don&#39;t have a background in programming so all this takes me a good while to understand."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 8227180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df391753e62afa3742261429da57b41d?s=128&d=identicon&r=PG&f=1", "display_name": "ChuckCT36", "link": "https://stackoverflow.com/users/8227180/chuckct36"}, "edited": false, "score": 0, "creation_date": 1499292865, "post_id": 44935769, "comment_id": 76849949, "body": "OK - typically if you&#39;re running into &quot;procedure too long&quot; errors then that&#39;s a red flag: at the least having that much code makes it difficult to maintain and/or debug."}, {"owner": {"reputation": 3, "user_id": 8227180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df391753e62afa3742261429da57b41d?s=128&d=identicon&r=PG&f=1", "display_name": "ChuckCT36", "link": "https://stackoverflow.com/users/8227180/chuckct36"}, "edited": false, "score": 0, "creation_date": 1499293941, "post_id": 44935769, "comment_id": 76850385, "body": "Would it be best to breaks those sections into their own modules as opposed to having different subs on one?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 8227180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df391753e62afa3742261429da57b41d?s=128&d=identicon&r=PG&f=1", "display_name": "ChuckCT36", "link": "https://stackoverflow.com/users/8227180/chuckct36"}, "edited": false, "score": 0, "creation_date": 1499294335, "post_id": 44935769, "comment_id": 76850526, "body": "You&#39;re just moving the problem around at that point - if you have that much code it usually indicates a fundamental problem with your underlying approach.  For example are you hard-coding meta-data into your VBA which would be better stored on a worksheet (e.g. a list of ranges and corresponding tag names)?  It&#39;s difficult to know from the code you posted why you are hitting that limit.  If you find you have split out single lines of code into their own Sub (and they only get called once) then that&#39;s not the way to go."}, {"owner": {"reputation": 3, "user_id": 8227180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df391753e62afa3742261429da57b41d?s=128&d=identicon&r=PG&f=1", "display_name": "ChuckCT36", "link": "https://stackoverflow.com/users/8227180/chuckct36"}, "edited": false, "score": 0, "creation_date": 1499308672, "post_id": 44935769, "comment_id": 76854094, "body": "Thanks, I figured as much. I had a print script that worked perfectly for the XML I&#39;m attempting to output but since I&#39;m now working with source text that contains Japanese and Chinese characters, I&#39;m trying to tweak my macro with an ADODB stream so that the xml file is outputted to UTF-8. I appreciate all the help and information."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1499288762, "last_edit_date": 1499288762, "creation_date": 1499287824, "answer_id": 44935769, "question_id": 44935240, "link": "https://stackoverflow.com/questions/44935240/calling-another-objectstream-write-text-macro-within-my-macro-isnt-workiing/44935769#44935769", "title": "Calling another objectStream.Write text macro within my macro isn&#39;t workiing", "body": "<p><code>CopyTo</code> expects another stream object, not a string/file path. If you want <code>LocaleTest2</code> to write content to the same stream as is already open in <code>Export_iTunes_XML</code>, then you should pass the stream as a parameter when you call <code>LocaleTest2</code>. </p>\n\n<p>Having made that change though, I'm not sure you get any benefit from breaking that out into a separate Sub.</p>\n\n<pre><code>Sub Export_iTunes_XML()\n\n    Dim FilePath As String\n    FilePath = ActiveWorkbook.Path &amp; \"\\\"\n\n    Dim FileName As String\n    FileName = \"metadata.xml\"\n\n    Dim Output As String\n    Output = FilePath &amp; FileName\n\n    If Dir(Output, vbNormal) &lt;&gt; \"\" Then\n        Answer = MsgBox(\"Do you want to overwrite?\", vbOKCancel, \"File Exists\")\n    End If\n    If Answer = vbCancel Then Exit Sub\n\n    Set objStream = CreateObject(\"ADODB.Stream\") 'Create the stream\n    objStream.Open 'Initialize the stream\n    objStream.Position = 0 'Rest the position\n    objStream.Charset = \"UTF-8\" 'indicate the character encoding\n\n    objStream.WriteText \"&lt;?xml version=\"\"1.0\"\" encoding=\"\"UTF-8\"\"?&gt;\" &amp; vbCr\n    objStream.WriteText \"      &lt;title&gt;\" &amp; Sheets(\"RawMetadata\").Range(\"A3\") &amp; \"&lt;/title&gt;\" &amp; vbCr\n\n    If Sheets(\"RawMetadata\").Range(\"P4\") &lt;&gt; 0 \n        LocaleTest2 objStream '&lt;&lt;&lt; pass the stream object\n    End If\n\n    objStream.WriteText \"      &lt;production_company&gt;\" &amp; \n    Sheets(\"RawMetadata\").Range(\"H3\") &amp; \"&lt;/production_company&gt;\" &amp; vbCr\n    '....\nEnd Sub\n\n\nSub LocaleTest2(objStream as Object)\n\n    'write to the provided stream\n    objStream.WriteText Sheets(\"RawMetadata\").Range(\"P4\")\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 8227180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df391753e62afa3742261429da57b41d?s=128&d=identicon&r=PG&f=1", "display_name": "ChuckCT36", "link": "https://stackoverflow.com/users/8227180/chuckct36"}, "edited": false, "score": 0, "creation_date": 1499314728, "post_id": 44939063, "comment_id": 76855554, "body": "Thank you Dy.Lee for the macro. I&#39;m testing this out now to see how it works. I wanted to share my original #print macro so that this thread can see what I was trying to transition from. The macro I had went row by row and outputted the cell value if the row line was &quot;ON&quot; (apologies if this is obvious from the code I provided).  Like I stated before, it worked exactly how I wanted to, with exporting an XML file to the desired output folder but once I started to receive source text in Japanese and Chinese, the outputted XML started showing ???? for all foreign language characters."}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "reply_to_user": {"reputation": 3, "user_id": 8227180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df391753e62afa3742261429da57b41d?s=128&d=identicon&r=PG&f=1", "display_name": "ChuckCT36", "link": "https://stackoverflow.com/users/8227180/chuckct36"}, "edited": false, "score": 0, "creation_date": 1499315038, "post_id": 44939063, "comment_id": 76855627, "body": "@ChuckCT36:  &quot;utf-8&quot;  change &quot;unicode&quot;  and test code."}, {"owner": {"reputation": 3, "user_id": 8227180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df391753e62afa3742261429da57b41d?s=128&d=identicon&r=PG&f=1", "display_name": "ChuckCT36", "link": "https://stackoverflow.com/users/8227180/chuckct36"}, "edited": false, "score": 0, "creation_date": 1499369138, "post_id": 44939063, "comment_id": 76890100, "body": "Thank you so much for your code. It works perfectly! Not only that, I&#39;m able to follow your code and learn little by little on how it all works. Thanks again!"}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1499318216, "last_edit_date": 1499318216, "creation_date": 1499309739, "answer_id": 44939063, "question_id": 44935240, "link": "https://stackoverflow.com/questions/44935240/calling-another-objectstream-write-text-macro-within-my-macro-isnt-workiing/44939063#44939063", "title": "Calling another objectStream.Write text macro within my macro isn&#39;t workiing", "body": "<p>The code would to be like this.</p>\n\n<pre><code>Sub Export_iTunes_XML()\n    Dim vR(), myText As String\n    Dim FilePath As String\n    Dim FileName As String\n    Dim Output As String\n    Dim Ws As Worksheet\n    Dim n As Long\n\n    FilePath = ActiveWorkbook.Path &amp; \"\\\"\n    FileName = \"metadata.xml\"\n    Output = FilePath &amp; FileName\n    Set Ws = Sheets(\"RawMetadata\")\n\n\n    If Dir(Output, vbNormal) &lt;&gt; \"\" Then\n        Answer = MsgBox(\"Do you want to overwrite?\", vbOKCancel, \"File Exists\")\n    End If\n    If Answer = vbCancel Then Exit Sub\n\n    n = n + 1\n    ReDim Preserve vR(1 To n)\n    vR(n) = \"&lt;?xml version=\"\"1.0\"\" encoding=\"\"UTF-8\"\"?&gt;\"\n    n = n + 1\n    ReDim Preserve vR(1 To n)\n    vR(n) = \"      &lt;title&gt;\" &amp; Sheets(\"RawMetadata\").Range(\"A3\") &amp; \"&lt;/title&gt;\"\n    With Ws\n        If Sheets(\"RawMetadata\").Range(\"P4\") &lt;&gt; 0 Then\n            n = n + 1\n            ReDim Preserve vR(1 To n)\n            vR(n) = .Range(\"p4\")\n        End If\n        n = n + 1\n        ReDim Preserve vR(1 To n)\n        vR(n) = \"      &lt;production_company&gt;\" &amp; .Range(\"H3\") &amp; \"&lt;/production_company&gt;\"\n    End With\n\n    myText = Join(vR, vbCrLf)\n    TransToUTF8 Output, myText\nEnd Sub\nSub TransToUTF8(myfile As String, str As String)\n Dim objStream As Object\n Set objStream = CreateObject(\"ADODB.Stream\")\n\n    With objStream\n        .Charset = \"utf-8\"\n        .Open\n        .WriteText str\n        .SaveToFile myfile, 2\n        .Close\n    End With\n    Set objStream = Nothing\n\nEnd Sub\n</code></pre>\n\n<p><strong>Addition</strong></p>\n\n<pre><code>Sub Export_iTunes_XML()\n\n Dim XMLFileName As String\n Dim output4 As String\n Dim range4 As Range\n Dim vDB, vR(), vResult()\n Dim i As Long, n As Long, j As Integer\n Dim myText As String\n\n XMLFileName = \"metadata.xml\"\n FolderName4 = Sheets(\"RawMetadata\").Range(\"D42\") &amp; \"_\" &amp; Sheets(\"iTunes\").Range(\"B8\") &amp; \".itmsp\"\n FolderPath4 = ActiveWorkbook.Path &amp; \"\\\" &amp; FolderName4\n\nMkDir FolderPath4\noutput4 = FolderPath4 &amp; \"\\\" &amp; XMLFileName\n\n vDB = Sheets(\"iTunes\").Range(\"A1:g936\")\n\n\nFor i = 1 To UBound(vDB, 1)\n    If vDB(i, 7) = \"ON\" Then\n        ReDim vR(1 To 6)\n        For j = 1 To 6\n            vR(j) = vDB(i, j)\n        Next j\n        n = n + 1\n        ReDim Preserve vResult(1 To n)\n        vResult(n) = Join(vR, \"\")\n    End If\nNext i\n    myText = Join(vResult, vbCrLf)\n    TransToUTF8 output4, myText\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8227180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df391753e62afa3742261429da57b41d?s=128&d=identicon&r=PG&f=1", "display_name": "ChuckCT36", "link": "https://stackoverflow.com/users/8227180/chuckct36"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 571, "favorite_count": 0, "accepted_answer_id": 44935769, "answer_count": 2, "score": 0, "last_activity_date": 1499318216, "creation_date": 1499285820, "last_edit_date": 1499287862, "question_id": 44935240, "link": "https://stackoverflow.com/questions/44935240/calling-another-objectstream-write-text-macro-within-my-macro-isnt-workiing", "title": "Calling another objectStream.Write text macro within my macro isn&#39;t workiing", "body": "<p>So I'm creating a macro to output an UTF-8 encoded XML since the source text will sometimes involve Japanese or Chinese characters. I'm trying to break each section of the XML into different chunks so it's easier for me to edit but my call line isn't working. Since I'm not trained in programming and my knowledge is based on looking up VBA macro codes and tweaking them until I get the desired result, I'm stumped as to how to get my objStream macro to not error when calling another objStream line.</p>\n\n<p>Thanks!</p>\n\n<p>Here it is:</p>\n\n<pre><code>Sub Export_iTunes_XML()\n\nDim FilePath As String\nFilePath = ActiveWorkbook.Path &amp; \"\\\"\n\nDim FileName As String\nFileName = \"metadata.xml\"\n\nDim Output As String\nOutput = FilePath &amp; FileName\n\nIf Dir(Output, vbNormal) &lt;&gt; \"\" Then\n    Answer = MsgBox(\"Do you want to overwrite?\", vbOKCancel, \"File Exists\")\nEnd If\nIf Answer = vbCancel Then Exit Sub\n\nSet objStream = CreateObject(\"ADODB.Stream\") 'Create the stream\nobjStream.Open 'Initialize the stream\nobjStream.Position = 0 'Rest the position\nobjStream.Charset = \"UTF-8\" 'indicate the character encoding\n\nobjStream.WriteText \"&lt;?xml version=\"\"1.0\"\" encoding=\"\"UTF-8\"\"?&gt;\" &amp; vbCr\nobjStream.WriteText \"      &lt;title&gt;\" &amp; Sheets(\"RawMetadata\").Range(\"A3\") &amp; \"&lt;/title&gt;\" &amp; vbCr\n\nIf Sheets(\"RawMetadata\").Range(\"P4\") &lt;&gt; 0 Then Call LocaleTest2\n\nobjStream.WriteText \"      &lt;production_company&gt;\" &amp; Sheets(\"RawMetadata\").Range(\"H3\") &amp; \"&lt;/production_company&gt;\" &amp; vbCr\n___________________________________________________________________________\nSub LocaleTest2()\n\nDim FilePath As String\nFilePath = ActiveWorkbook.Path &amp; \"\\\"\n\nDim FileName As String\nFileName = \"metadata.xml\"\n\nDim Output As String\nOutput = FilePath &amp; FileName\n\nSet objStream = CreateObject(\"ADODB.Stream\") 'Create the stream\nobjStream.Open 'Initialize the stream\nobjStream.Position = 0 'Rest the position\nobjStream.Charset = \"UTF-8\" 'indicate the character encoding\n\nobjStream.WriteText Sheets(\"RawMetadata\").Range(\"P4\")\nobjStream.CopyTo Output\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1991, "user_id": 447485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e4e2946c3270f4a20e60ec3d3c8f552?s=128&d=identicon&r=PG", "display_name": "airstrike", "link": "https://stackoverflow.com/users/447485/airstrike"}, "edited": false, "score": 0, "creation_date": 1499287063, "post_id": 44935223, "comment_id": 76847313, "body": "This kind of question is better suited for <a href=\"https://codereview.stackexchange.com/\">Code Review</a>. Please consider posting it there instead."}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1501685230, "post_id": 44935223, "comment_id": 77888874, "body": "@Andrew This question is <i>not</i> suitable for Code Review, as the code in it was not working correctly. Notice that he got an error message. Also, just because a question is &quot;better suited&quot; for another site does not mean that it is off-topic here. So even if this <i>was</i> fully-working code, it would still be on-topic for Stack Overflow."}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1501685292, "post_id": 44935223, "comment_id": 77888921, "body": "GCC, please do not edit the answer to your question into the question. If you&#39;ve arrived at your own answer, then you should post it below, in the answer box."}, {"owner": {"reputation": 1991, "user_id": 447485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e4e2946c3270f4a20e60ec3d3c8f552?s=128&d=identicon&r=PG", "display_name": "airstrike", "link": "https://stackoverflow.com/users/447485/airstrike"}, "reply_to_user": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1503040711, "post_id": 44935223, "comment_id": 78458672, "body": "@CodyGray I&#39;m afraid you&#39;re incorrect. He literally says that the code <i>is</i> working but wants it to run more efficiently. If this question doesn&#39;t make the cut to get moved to Code Review, I wonder what does. Additionally, this question is so incredibly specific to his one-off situation that I strongly doubt many future users (if any) will either (a) find this question when searching for help with their own use-cases or (b) find the answer below useful for improving their own code. In sum, this is nothing but clutter on SO but a Good Question on Code Review, therefore it should be moved."}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "reply_to_user": {"reputation": 1991, "user_id": 447485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e4e2946c3270f4a20e60ec3d3c8f552?s=128&d=identicon&r=PG", "display_name": "airstrike", "link": "https://stackoverflow.com/users/447485/airstrike"}, "edited": false, "score": 0, "creation_date": 1503040977, "post_id": 44935223, "comment_id": 78458835, "body": "@Andre There&#39;s an error message displayed right there in the question. This could be <i>made</i> suitable for Code Review by editing, but it is not ready for migration <i>in its current state</i>, which is all that moderators look at. <i>&quot;If this question doesn&#39;t make the cut to get moved\u2026I wonder what does.&quot;</i> Not much. It&#39;s rare that questions asked on one site are sufficiently tailored to the rules of another site that they can be migrated directly. Your &quot;usefulness&quot; justification for migration is...odd. Why do you think a question that is too narrowly scoped to be useful would be useful somewhere else?"}], "answers": [{"tags": [], "owner": {"reputation": 219, "user_id": 7264061, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wSKXr.png?s=128&g=1", "display_name": "Martin G", "link": "https://stackoverflow.com/users/7264061/martin-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1499286345, "creation_date": 1499286345, "answer_id": 44935395, "question_id": 44935223, "link": "https://stackoverflow.com/questions/44935223/how-to-copy-and-paste-a-range-from-one-workbook-to-another-more-efficiently-in-v/44935395#44935395", "title": "How to copy and paste a range from one workbook to another more efficiently in VBA?", "body": "<p>I guess you should not double reference the Worksheet. </p>\n\n<p>try </p>\n\n<pre><code>wb1s1.Range(\"A14\", (\"F\" &amp; Rows.Count)).Copy Destination:=wb2s1.Range(\"A3\")\n</code></pre>\n\n<p>The workbook wb1 does not support the \"Property or Method\" wb1s1, nor does wb2 support wb2s1</p>\n"}], "owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 44935395, "answer_count": 1, "score": 0, "last_activity_date": 1501685305, "creation_date": 1499285772, "last_edit_date": 1501685305, "question_id": 44935223, "link": "https://stackoverflow.com/questions/44935223/how-to-copy-and-paste-a-range-from-one-workbook-to-another-more-efficiently-in-v", "title": "How to copy and paste a range from one workbook to another more efficiently in VBA?", "body": "<p>I have figured out how to copy and paste from one workbook to another but it is not the most efficient. I want to copy a range from one workbook and paste it in cell A3 in a second workbook. Here is my code (I have set all my variables, I just did not include it in this question):</p>\n\n<pre><code>Dim wb1 As Workbook\nDim wb2 As Workbook\nDim wb1s1 As Worksheet\nDim wb1s2 As Worksheet\nDim wb2s1 As Worksheet\nDim wb2s2 As Worksheet\n\n    wb1.Activate\n       With wb1s1\n        .Range(.Range(\"A14\"), .Range(\"F\" &amp; .Rows.Count)).Copy\n      End With\n\n    wb2.Activate\n        With wb2s1\n       .Range(\"A3\").PasteSpecial xlPasteAll\n      End With\n\n\n    wb1.Activate\n      With wb1s2\n        .Range(.Range(\"A14\"), .Range(\"F\" &amp; .Rows.Count)).Copy\n       End With\n\n    wb2.Activate\n       With wb2s2\n       .Range(\"A3\").PasteSpecial xlPasteAll\n       End With\n</code></pre>\n\n<p>Now, I have tried this line of code to increase its efficiency but it is not working for me. </p>\n\n<pre><code>wb1.wb1s1.Range(\"A14\", (\"F\" &amp; Rows.Count)).Copy Destination:=wb2.wb2s1.Range(\"A3\") \n</code></pre>\n\n<p>I get the error \"Object doesn't support this Property or Method\". Any help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27, "user_id": 8227264, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a672d92c875921b21b9d8e862c7f0212?s=128&d=identicon&r=PG&f=1", "display_name": "mmajdalani", "link": "https://stackoverflow.com/users/8227264/mmajdalani"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1499286306, "post_id": 44935212, "comment_id": 76846937, "body": "I don&#39;t think so, that makes count = 26"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1499286719, "post_id": 44935212, "comment_id": 76847143, "body": "Is <code>&quot;firstAddress&quot;</code> a named range? Is it always going to be a single cell?  Also, what are you trying to do there? Your main question may be an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY Problem</a>"}, {"owner": {"reputation": 27, "user_id": 8227264, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a672d92c875921b21b9d8e862c7f0212?s=128&d=identicon&r=PG&f=1", "display_name": "mmajdalani", "link": "https://stackoverflow.com/users/8227264/mmajdalani"}, "edited": false, "score": 0, "creation_date": 1499342483, "post_id": 44935212, "comment_id": 76871569, "body": "&quot;firstAddress&quot; is a named range, and it will always be a single cell in the first column (A). I&#39;m somewhat new to vba excel and thought that if I could count rows from the bottom up to cell(1,1) then I would have the number I need."}], "owner": {"reputation": 27, "user_id": 8227264, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a672d92c875921b21b9d8e862c7f0212?s=128&d=identicon&r=PG&f=1", "display_name": "mmajdalani", "link": "https://stackoverflow.com/users/8227264/mmajdalani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499287234, "creation_date": 1499285746, "last_edit_date": 1499287234, "question_id": 44935212, "link": "https://stackoverflow.com/questions/44935212/how-to-count-from-active-cell-to-the-top", "title": "How to count from active cell to the top?", "body": "<p>I basically have an address in which I would like to offset to the top cell (1,1). In this case the cell I have is $A$4, but could be anywhere in the A column. I'd like to count how many cells are between $A$4 and $A$1 so that I can use it to offset and copy/paste something. In this case I'd be looking for the count to be 3.</p>\n\n<p>I'm currently using</p>\n\n<pre><code>cnt = wb.Sheets(sht.Name).Range(\"firstAddress\", ActiveSheet.Cells(1, 1).End(xlUp)).Rows.Count \n</code></pre>\n\n<p>firstAddress in this case is ($A$4) but I believe I'm going about this completely wrong. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1499291409, "post_id": 44935025, "comment_id": 76849366, "body": "Here&#39;s a push in the right direction: <a href=\"https://stackoverflow.com/questions/32739715/open-word-template-paste-excel-data-in-and-save/32741075\" title=\"open word template paste excel data in and save\">stackoverflow.com/questions/32739715/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6465053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2babcb6671d63076e7256661b63ec536?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno Adriano", "link": "https://stackoverflow.com/users/6465053/bruno-adriano"}, "edited": false, "score": 0, "creation_date": 1499289996, "post_id": 44936244, "comment_id": 76848748, "body": "Maybe I wasn&#39;t clear in the request: I have formatted cells that I need to copy to another place, one that, from excel (no matter what I do) won&#39;t go with the formatting. One way I found was to copy to a Word document and copy again there to paste in the form I need. What I need, is: I inserted a embedded word document that I want to copy the cells, paste there, copy from there to the clipboard. From there, I can just paste where I want."}, {"owner": {"reputation": 669, "user_id": 6754179, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2646872bfa0b8caf0db917b9afde5920?s=128&d=identicon&r=PG&f=1", "display_name": "ERT", "link": "https://stackoverflow.com/users/6754179/ert"}, "reply_to_user": {"reputation": 3, "user_id": 6465053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2babcb6671d63076e7256661b63ec536?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno Adriano", "link": "https://stackoverflow.com/users/6465053/bruno-adriano"}, "edited": false, "score": 0, "creation_date": 1499290162, "post_id": 44936244, "comment_id": 76848827, "body": "What is the &quot;other place&quot; you need to copy your formatted text to?"}, {"owner": {"reputation": 3, "user_id": 6465053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2babcb6671d63076e7256661b63ec536?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno Adriano", "link": "https://stackoverflow.com/users/6465053/bruno-adriano"}, "edited": false, "score": 0, "creation_date": 1499290357, "post_id": 44936244, "comment_id": 76848912, "body": "It&#39;s a html form... or something of the sorts. I&#39;m quite restricted on what I can use here... ie wont work with the site (restricted) and basically what I doing is a mouse macro with sendkeys... If I have in the clipboard a sendkeys &quot;^v&quot; works..."}, {"owner": {"reputation": 669, "user_id": 6754179, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2646872bfa0b8caf0db917b9afde5920?s=128&d=identicon&r=PG&f=1", "display_name": "ERT", "link": "https://stackoverflow.com/users/6754179/ert"}, "reply_to_user": {"reputation": 3, "user_id": 6465053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2babcb6671d63076e7256661b63ec536?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno Adriano", "link": "https://stackoverflow.com/users/6465053/bruno-adriano"}, "edited": false, "score": 0, "creation_date": 1499290589, "post_id": 44936244, "comment_id": 76849001, "body": "I see.  Now I understand the basis of the question.  Would you like a Macro to do this for you?  That would be a fairly simple solution."}, {"owner": {"reputation": 669, "user_id": 6754179, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2646872bfa0b8caf0db917b9afde5920?s=128&d=identicon&r=PG&f=1", "display_name": "ERT", "link": "https://stackoverflow.com/users/6754179/ert"}, "reply_to_user": {"reputation": 3, "user_id": 6465053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2babcb6671d63076e7256661b63ec536?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno Adriano", "link": "https://stackoverflow.com/users/6465053/bruno-adriano"}, "edited": false, "score": 0, "creation_date": 1499290734, "post_id": 44936244, "comment_id": 76849073, "body": "Another option you could attempt is converting the Excel file into Google Sheets, and then copying and pasting the cell values from there.  That could potentially be an easy fix."}, {"owner": {"reputation": 3, "user_id": 6465053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2babcb6671d63076e7256661b63ec536?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno Adriano", "link": "https://stackoverflow.com/users/6465053/bruno-adriano"}, "edited": false, "score": 0, "creation_date": 1499350889, "post_id": 44936244, "comment_id": 76878320, "body": "Google drive and others like that are also restricted... did managed to find some code... the odd thing is: it worked, then it stopped working... and today is working again..."}, {"owner": {"reputation": 669, "user_id": 6754179, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2646872bfa0b8caf0db917b9afde5920?s=128&d=identicon&r=PG&f=1", "display_name": "ERT", "link": "https://stackoverflow.com/users/6754179/ert"}, "reply_to_user": {"reputation": 3, "user_id": 6465053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2babcb6671d63076e7256661b63ec536?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno Adriano", "link": "https://stackoverflow.com/users/6465053/bruno-adriano"}, "edited": false, "score": 0, "creation_date": 1499351161, "post_id": 44936244, "comment_id": 76878564, "body": "That is quite odd.  Where did you find the code for the application?  Your HTML form sounds finicky and somewhat antiquated; do you mind me asking in what setting you are using this form?  There are more streamlined and user-friendly ways to do things like this, I believe."}, {"owner": {"reputation": 3, "user_id": 6465053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2babcb6671d63076e7256661b63ec536?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno Adriano", "link": "https://stackoverflow.com/users/6465053/bruno-adriano"}, "edited": false, "score": 0, "creation_date": 1499357760, "post_id": 44936244, "comment_id": 76883527, "body": "Well... it&#39;s actually an email form... I cant use some direct mailing tool so... doing one myself... (Its a IBM Lotus iNotes)"}], "tags": [], "owner": {"reputation": 669, "user_id": 6754179, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2646872bfa0b8caf0db917b9afde5920?s=128&d=identicon&r=PG&f=1", "display_name": "ERT", "link": "https://stackoverflow.com/users/6754179/ert"}, "is_accepted": false, "score": 0, "last_activity_date": 1499289823, "creation_date": 1499289823, "answer_id": 44936244, "question_id": 44935025, "link": "https://stackoverflow.com/questions/44935025/how-to-temporarily-open-a-word-document-and-use-it-to-copy-paste-a-range/44936244#44936244", "title": "How to temporarily open a Word document and use it to copy-paste a range?", "body": "<p>Have you tried right-clicking on the cell you wish to paste into, and clicking \"Paste Special\"?</p>\n"}], "owner": {"reputation": 3, "user_id": 6465053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2babcb6671d63076e7256661b63ec536?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno Adriano", "link": "https://stackoverflow.com/users/6465053/bruno-adriano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499351083, "creation_date": 1499284974, "last_edit_date": 1499351083, "question_id": 44935025, "link": "https://stackoverflow.com/questions/44935025/how-to-temporarily-open-a-word-document-and-use-it-to-copy-paste-a-range", "title": "How to temporarily open a Word document and use it to copy-paste a range?", "body": "<p>I have formatted cells that I wish to copy and paste into an html form.</p>\n\n<ul>\n<li>If I copy the contents to a Word document and paste them from there to an html form, it works.</li>\n<li>If I copy the contents directly from the spreadsheet into the html form, the formatting is lost.</li>\n<li>If the range is in the clipboard after copying from a Word document, I can paste it to the html form. </li>\n</ul>\n\n<p>I need a way to copy the range to clipboard and retain the formatting. Since from Word it works, that's where I'm starting... but if there is another way...</p>\n\n<p>I'm thinking of either an embed word file, or a hidden one. </p>\n\n<p>Copy cell, paste there, select all and copy from there. Afterwards, close/discard it.</p>\n\n<p>EDIT: Managed to get some code... but it worked, then stopped, then worked again... no idea why...</p>\n\n<pre><code>Sub TempDoc()\n\nDim WDApp As Word.Application\nDim WDDoc As Word.Document\n\n    Application.ScreenUpdating = False\n\nSet WDObj = Sheets(\"Text2Form\").OLEObjects(\"WDOC\")\n\nWDObj.Activate\nWDObj.Object.Application.Visible = False\n\nSet WDApp = GetObject(, \"Word.Application\")\nSet WDDoc = WDApp.ActiveDocument\n\n    WDApp.Visible = False\n\nWorksheets(\"Text2Form\").Cells(12, 4).Copy\n    WDApp.Selection.Goto What:=wdGoToLine, Which:=wdGoToLast\n    WDApp.Selection.PasteSpecial xlPasteValues\n\nWDApp.ActiveDocument.Content.InsertAfter vbNewLine\n\nWorksheets(\"Text2Form\").Cells(14, 4).Copy\n    WDApp.Selection.Goto What:=wdGoToLine, Which:=wdGoToLast\n    WDApp.Selection.PasteSpecial xlPasteValues\n\nWDDoc.Content.Copy\nWDDoc.Content.Delete\n\nWDApp.Quit\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8261236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbc028d2c6e0bc83eb7199504c94a4e7?s=128&d=identicon&r=PG&f=1", "display_name": "NoNels", "link": "https://stackoverflow.com/users/8261236/nonels"}, "edited": false, "score": 0, "creation_date": 1499358791, "post_id": 44935715, "comment_id": 76884189, "body": "Thanks for the help. I found that my problem was with the formatting of the dateNow string. after putting in a MsgBox(dateNow) it showed that the string was listing the numbers with forward slashes separating months/days/years. when passed into the filename this caused the save as function to look for folders that didn&#39;t exist.  I replaced it with  dateNow = month(Date) &amp; day(Date) &amp; year(Date) and now it works"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 3, "user_id": 8261236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbc028d2c6e0bc83eb7199504c94a4e7?s=128&d=identicon&r=PG&f=1", "display_name": "NoNels", "link": "https://stackoverflow.com/users/8261236/nonels"}, "edited": false, "score": 0, "creation_date": 1499367142, "post_id": 44935715, "comment_id": 76889083, "body": "@NoNels That sounds really strange.  I had thought of invalid characters in the filename causing issues, so I tested what would happen with that, and all it did was blank the name out before displaying the dialog.  (And, despite the fact that it wouldn&#39;t give an error, I specifically checked your <code>dateNow</code> variable and ensured that you <b>weren&#39;t</b> putting forward slashes in it - you are using a <code>&quot;mmddyyyy&quot;</code> format that won&#39;t do so.)"}, {"owner": {"reputation": 3, "user_id": 8261236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbc028d2c6e0bc83eb7199504c94a4e7?s=128&d=identicon&r=PG&f=1", "display_name": "NoNels", "link": "https://stackoverflow.com/users/8261236/nonels"}, "edited": false, "score": 0, "creation_date": 1499459756, "post_id": 44935715, "comment_id": 76933781, "body": "You&#39;re right. I must have removed the quotation marks from <code>mmddyyyy</code> while I was fiddling with it yesterday after employing your fix. My bad. Tried using the code I posted and it acts like you described. I&#39;m still fairly new to coding, and this was my first post, so I&#39;m guessing it&#39;s my fault. the important thing is that the code works now. :)"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1499287596, "creation_date": 1499287596, "answer_id": 44935715, "question_id": 44934970, "link": "https://stackoverflow.com/questions/44934970/vba-excel-application-getsaveasfilename-error-13/44935715#44935715", "title": "VBA excel Application.getsaveasfilename error 13", "body": "<p><code>GetSaveAsFilename</code> returns a <code>Variant</code>, which will be a boolean <code>False</code> if the user cancelled the SaveAs dialog, or a string containing the filename that they chose if they didn't cancel the dialog.</p>\n\n<p>Your line saying</p>\n\n<pre><code>Dim saveSuccess As Boolean\n</code></pre>\n\n<p>will cause an issue if a non-boolean value is returned.  So use</p>\n\n<pre><code>Dim saveSuccess As Variant\n</code></pre>\n\n<p>instead.</p>\n\n<hr>\n\n<p>This will still leave you with other problems though:</p>\n\n<ol>\n<li><code>Sheets(3).Range \"E22\" = Date</code> is invalid, and is probably meant to be <code>Sheets(3).Range(\"E22\") = Date</code></li>\n<li><code>*xlsm</code> should probably be <code>*.xlsm</code></li>\n<li><p>At no point are you actually saving the file.  Your final bits of code should probably be something like:</p>\n\n<pre><code>If saveSuccess = False Then\n    'if backup not saved, inform user\n    MsgBox \"save canceled, please save backup before adding new items to the archive today\"\nElse\n    If UCase(Right(saveSuccess, 5)) = \".XLSM\" Then\n        ActiveWorkbook.SaveAs saveSuccess, xlOpenXMLWorkbookMacroEnabled\n        'if backup saved, update date of last backup\n        Sheets(3).Range(\"E22\") = Date\n        MsgBox \"save successful\"\n    ElseIf UCase(Right(saveSuccess, 5)) = \".XLSX\" Then\n        ActiveWorkbook.SaveAs saveSuccess, xlOpenXMLWorkbook\n        'if backup saved, update date of last backup\n        Sheets(3).Range(\"E22\") = Date\n        MsgBox \"save successful\"\n    Else\n        MsgBox \"Unrecognised file extension chosen - backup not created\"\n    End If\nEnd If\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 3, "user_id": 8261236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbc028d2c6e0bc83eb7199504c94a4e7?s=128&d=identicon&r=PG&f=1", "display_name": "NoNels", "link": "https://stackoverflow.com/users/8261236/nonels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 841, "favorite_count": 0, "accepted_answer_id": 44935715, "answer_count": 1, "score": 0, "last_activity_date": 1499287596, "creation_date": 1499284766, "last_edit_date": 1499286638, "question_id": 44934970, "link": "https://stackoverflow.com/questions/44934970/vba-excel-application-getsaveasfilename-error-13", "title": "VBA excel Application.getsaveasfilename error 13", "body": "<p>I'm trying to create a macro to have the user save a backup of the workbook to a specific place. I tried my code below but got an error 13 message. I don't need it to be saved as a macro-enabled workbook, but I thought that would be easier.</p>\n\n<pre><code>Sub openSaveDialog()\n'\n' gives error 13 message when clicking save\n'\nDim saveSuccess As Boolean\nDim fNameRec As String\nDim dateNow As String\nDim saveToDir As String\nsaveToDir = \"Z:\\location of save\\Old Archive spreadsheets\\\"\ndateNow = Format(Now(), \"mmddyyyy\")\nfNameRec = saveToDir &amp; \"BinderArchiveBackup_\" &amp; dateNow\nSheets(3).Range(\"E25\") = fNameRec\n'check if backed up today\nIf (Sheets(3).Range(\"E22\") = Date) Then\n    MsgBox \"backup already saved today no need to save again\"\n    Exit Sub\nEnd If\n\n'open save as window\nsaveSuccess = Application.GetSaveAsFilename(InitialFileName:=fNameRec, FileFilter:= _\n\"Excel Files (*.xlsx),\" &amp; \"*.xlsx, Macro Enabled\" &amp; _\n\"Workbook (*.xlsm), *xlsm\")\n'if backup saved, update date of last backup\nIf saveSuccess Then\n    Sheets(3).Range \"E22\" = Date\n    MsgBox \"save successful\"\nEnd If\n'if backup not saved, inform user\nIf Not saveSuccess Then\n    MsgBox \"save canceled, please save backup before adding new items to the archive today\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Things I tried tweaking</p>\n\n<ul>\n<li>File filter to just macro enabled</li>\n<li>File filter to just excel workbook</li>\n<li>Blank file filter saving as type all files</li>\n<li>Blank file filter with .xlsx at the end of the name</li>\n<li>initial filename without directory but with ChDir so it opens in the right save location anyway</li>\n</ul>\n\n<p>Any help would be great.</p>\n\n<hr>\n\n<p>Save as window that opens</p>\n\n<p><img src=\"https://i.stack.imgur.com/EwBRs.png\" alt=\"[1]\"></p>\n"}, {"tags": ["mysql", "sql", "excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 478, "user_id": 3915651, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FC1j99J6UIc/AAAAAAAAAAI/AAAAAAAANSU/BqvcyzPg77g/photo.jpg?sz=128", "display_name": "Isaiah3015", "link": "https://stackoverflow.com/users/3915651/isaiah3015"}, "edited": false, "score": 2, "creation_date": 1499284423, "post_id": 44934847, "comment_id": 76845834, "body": "You can use VLOOKUP functions with IF ANDs"}, {"owner": {"reputation": 63, "user_id": 7411909, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9c9803f42c1c8406514485ed4823d59b?s=128&d=identicon&r=PG&f=1", "display_name": "Davvvvad", "link": "https://stackoverflow.com/users/7411909/davvvvad"}, "reply_to_user": {"reputation": 478, "user_id": 3915651, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FC1j99J6UIc/AAAAAAAAAAI/AAAAAAAANSU/BqvcyzPg77g/photo.jpg?sz=128", "display_name": "Isaiah3015", "link": "https://stackoverflow.com/users/3915651/isaiah3015"}, "edited": false, "score": 0, "creation_date": 1499284996, "post_id": 44934847, "comment_id": 76846177, "body": "@Isaiah3015 Could you give an example of how to use VLOOKUP function with IF ANDs using the query above ? Thank you."}, {"owner": {"reputation": 5383, "user_id": 3664960, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/fbcd9ff6662774ee78e2026b3671a4e1?s=128&d=identicon&r=PG&f=1", "display_name": "davejal", "link": "https://stackoverflow.com/users/3664960/davejal"}, "edited": false, "score": 0, "creation_date": 1499295942, "post_id": 44934847, "comment_id": 76851027, "body": "if you provide some dummy data, I could write an answer for you"}], "answers": [{"comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1499302452, "post_id": 44937211, "comment_id": 76852599, "body": "OP should know this is a connection to a database engine, <a href=\"https://en.wikipedia.org/wiki/Microsoft_Jet_Database_Engine\" rel=\"nofollow noreferrer\">ACE/JET</a> querying a workbook where ADO is an API connector and can be used for other engines (SQL Server, MySQL, Postgres, etc.)"}], "tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": false, "score": 2, "last_activity_date": 1499302276, "last_edit_date": 1499302276, "creation_date": 1499295007, "answer_id": 44937211, "question_id": 44934847, "link": "https://stackoverflow.com/questions/44934847/excel-equivalent-of-sql-query-select-a-one-b-two-from-a-inner-join-b-on-a-thre/44937211#44937211", "title": "Excel Equivalent of SQL query &quot;SELECT A.one, B.two FROM A INNER JOIN B ON A.three = B.three&quot;", "body": "<p>You can use VBA and ADO to query the worksheets directly with SQL. Just add the following code to a Sub in a VBA module. The code is mainly boilerplate except for the <code>rs.Open</code> line and the <code>With Worksheets</code> line which you should modify to suit your particular scenario.</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>' Set up connection\nDim cn As Object\nSet cn = CreateObject(\"ADODB.Connection\")\n\n' Connection string for Excel 2007 onwards .xlsm files\nWith cn\n   .Provider = \"Microsoft.ACE.OLEDB.12.0\"\n   .ConnectionString = \"Data Source=\" &amp; ThisWorkbook.FullName &amp; \";\" &amp; _\n        \"Extended Properties=\"\"Excel 12.0 Macro;IMEX=1\"\";\"\n    .Open\nEnd With\n\n' Connection string for Excel 97-2003 .xls files\n' It should also work with Excel 2007 onwards worksheets\n' as long as they have less than 65536 rows\n'With cn\n'    .Provider = \"Microsoft.Jet.OLEDB.4.0\"\n'    .ConnectionString = \"Data Source=\" &amp; ThisWorkbook.FullName &amp; \";\" &amp; _\n'        \"Extended Properties=\"\"Excel 8.0;IMEX=1\"\";\"\n'    .Open\n'End With\n\n' Create and run the query\nDim rs As Object\nSet rs = CreateObject(\"ADODB.Recordset\")\n\n' Join the two worksheets - assumed that these are named \"Sheet1\"\n' and \"Sheet2\", the columns are named \"one\", \"two\" and \"three\"\n' and that the results should be output to \"Sheet3\"\nrs.Open \"SELECT [Sheet1$].[one], [Sheet2$].[two] \" &amp; _\n    \"FROM [Sheet1$] INNER JOIN [Sheet2$] \" &amp; _\n    \"ON [Sheet1$].[three] = [Sheet2$].[three];\", cn\n\n' Output the field names and the results\nDim fld As Object\nDim i As Integer\n\n' Change the worksheet to whichever one you want to output to\nWith Worksheets(\"Sheet3\")\n    .UsedRange.ClearContents\n\n    For Each fld In rs.Fields\n        i = i + 1\n        .Cells(1, i).Value = fld.Name\n    Next fld\n\n    .Cells(2, 1).CopyFromRecordset rs\nEnd With\n\n' Tidy up\nrs.Close\ncn.Close\n</code></pre>\n\n<p>The code could be changed to use early binding instead by adding a reference to \"Microsoft ActiveX Data Objects 2.8 Library\" (go to Tools > References in the VBA editor to do this). You would change the following lines which declare and initialize various ADO objects:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim cn As ADODB.Connection\nSet cn = New ADODB.Connection\n\nDim rs As ADODB.Recordset\n\nDim fld As ADODB.Field\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 1, "last_activity_date": 1499322797, "creation_date": 1499322797, "answer_id": 44941376, "question_id": 44934847, "link": "https://stackoverflow.com/questions/44934847/excel-equivalent-of-sql-query-select-a-one-b-two-from-a-inner-join-b-on-a-thre/44941376#44941376", "title": "Excel Equivalent of SQL query &quot;SELECT A.one, B.two FROM A INNER JOIN B ON A.three = B.three&quot;", "body": "<p>Assuming your sheets are as follows:</p>\n\n<p><strong>Sheet1</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/bVXHq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bVXHq.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Sheet2</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/MTpuv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MTpuv.png\" alt=\"enter image description here\"></a></p>\n\n<p>In <code>Cell A2</code> of <code>Sheet3</code> enter the formula</p>\n\n<pre><code>=IFERROR(INDEX(Sheet1!$A$2:$A$8,MATCH(SMALL(IF(COUNTIF(Sheet1!$C$2:$C$10,Sheet2!$C$2:$C$10),Sheet2!$C$2:$C$10),ROW(1:1)),Sheet1!$C$2:$C$8,0)),\"\")\n</code></pre>\n\n<p>and in <code>Cell B2</code> of <code>Sheet3</code> enter the following formula</p>\n\n<pre><code>=IFERROR(INDEX(Sheet2!$B$2:$B$8,MATCH(SMALL(IF(COUNTIF(Sheet1!$C$2:$C$10,Sheet2!$C$2:$C$10),Sheet2!$C$2:$C$10),ROW(1:1)),Sheet1!$C$2:$C$8,0)),\"\")\n</code></pre>\n\n<p>Both the above formula are <strong>array formula</strong> so commit it by pressing <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Enter</kbd>. Drag/Copy down as required. See image for reference.</p>\n\n<p><a href=\"https://i.stack.imgur.com/3ymcC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3ymcC.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>-----------------------------------------------------------------------------------------------------------------------</strong></p>\n\n<p>If you also want to display third column of first two sheets in <code>Sheet3</code> (which is <code>ID</code> in my sample sheet) then enter following formula in <code>Cell A2</code></p>\n\n<pre><code>=IFERROR(SMALL(IF(COUNTIF(Sheet1!$C$2:$C$10,Sheet2!$C$2:$C$10),Sheet2!$C$2:$C$10),ROW(1:1)),\"\")\n</code></pre>\n\n<p>This is also an array formula. In <code>Cell B2</code> enter</p>\n\n<pre><code>=IFERROR(INDEX(Sheet1!$A$2:$A$8,MATCH(A2,Sheet1!$C$2:$C$8,0)),\"\")\n</code></pre>\n\n<p>And in <code>Cell C2</code> enter</p>\n\n<pre><code>=IFERROR(INDEX(Sheet2!$B$2:$B$8,MATCH(A2,Sheet2!$C$2:$C$8,0)),\"\")\n</code></pre>\n\n<p>Drag/Copy down as required. See image below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/TmPmH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TmPmH.png\" alt=\"enter image description here\"></a></p>\n\n<p>Got this from @ScottCraner's answer <a href=\"https://stackoverflow.com/a/35207750/6075259\">here</a>.</p>\n\n<p>There's another way of achieving this without using using formula and VBA. See if <a href=\"https://stackoverflow.com/a/35208430/6075259\">this</a> helps.</p>\n"}], "owner": {"reputation": 63, "user_id": 7411909, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9c9803f42c1c8406514485ed4823d59b?s=128&d=identicon&r=PG&f=1", "display_name": "Davvvvad", "link": "https://stackoverflow.com/users/7411909/davvvvad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1718, "favorite_count": 1, "accepted_answer_id": 44941376, "answer_count": 2, "score": 2, "last_activity_date": 1499322797, "creation_date": 1499284278, "last_edit_date": 1531161705, "question_id": 44934847, "link": "https://stackoverflow.com/questions/44934847/excel-equivalent-of-sql-query-select-a-one-b-two-from-a-inner-join-b-on-a-thre", "title": "Excel Equivalent of SQL query &quot;SELECT A.one, B.two FROM A INNER JOIN B ON A.three = B.three&quot;", "body": "<p>How do you do SQL \"select join on\" in excel?\nSay I want col one from table A, col two from table B and they both have col three.</p>\n\n<p>I would do:</p>\n\n<pre><code>SELECT A.one, B.two\nFROM A\nINNER JOIN B ON\nA.three = B.three\n</code></pre>\n\n<p>But instead of tables I have a few tabs in a Excel sheet. How do I do the equivalent of above query in Excel?</p>\n"}, {"tags": ["excel", "date", "replace", "vba"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1499349595, "post_id": 44934804, "comment_id": 76877197, "body": "Please edit the question and add the source data, actual output, and output you expected."}], "owner": {"reputation": 45, "user_id": 6100243, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ca4e250b47637d9effa8d5abcd747e7e?s=128&d=identicon&r=PG&f=1", "display_name": "chef", "link": "https://stackoverflow.com/users/6100243/chef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1499284105, "creation_date": 1499284105, "last_edit_date": 1531164843, "question_id": 44934804, "link": "https://stackoverflow.com/questions/44934804/date-completely-changing-when-removing-forward-slashes", "title": "Date completely changing when removing forward slashes", "body": "<p>I have been using the same code to format a date for a very long and all of a sudden I am having errors. </p>\n\n<pre><code>Columns(\"E\").Replace _\nWhat:=\"/\", Replacement:=\"\", _\nSearchorder:=xlByColumns, MatchCase:=True\n\nRange(\"E:E\").Select\nFor Each cell In Range(Range(\"E1:E1\"), Range(\"E1:E1\").End(xlDown))\ncell.NumberFormat = \"00000000\"\nNext cell \n</code></pre>\n\n<p>I am getting a return value of 06/7/3849. Anyone know what is going on? I have tried various things to work around this and the date keep getting thrown off.  </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 489, "user_id": 7618270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e3dafb06431451eaec971860c401150?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksandar Misich", "link": "https://stackoverflow.com/users/7618270/aleksandar-misich"}, "edited": false, "score": 1, "creation_date": 1499284520, "post_id": 44934795, "comment_id": 76845893, "body": "A lot, start by not relying on <code>.Activate</code> and always define by <code>ThisWorkbook</code>.  What line is this occurring on?  The <code>MsgBox</code> or the <code>Set cutRef</code>?"}, {"owner": {"reputation": 63, "user_id": 7443576, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10206909331245294/picture?type=large", "display_name": "TylerIlGenio", "link": "https://stackoverflow.com/users/7443576/tylerilgenio"}, "reply_to_user": {"reputation": 489, "user_id": 7618270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e3dafb06431451eaec971860c401150?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksandar Misich", "link": "https://stackoverflow.com/users/7618270/aleksandar-misich"}, "edited": false, "score": 0, "creation_date": 1499285382, "post_id": 44934795, "comment_id": 76846402, "body": "I need activate because this is ran off a button on another sheet. i am getting the error as MsgBox because cutRef is reading as nothing"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1499285540, "post_id": 44934795, "comment_id": 76846478, "body": "That&#39;s not a reason to <code>Activate</code>. Qualify <code>Rows</code> with the worksheet object instead. You&#39;re getting an error because <code>.Find</code> doesn&#39;t <i>find</i> that you&#39;re making it look for. <code>Find</code> returns <code>Nothing</code> when it doesn&#39;t find anything, and your code assumes it always does."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1499285602, "post_id": 44934795, "comment_id": 76846519, "body": "Gah, wrong dupe, sorry. Try <a href=\"https://stackoverflow.com/q/26243490/1188513\">that one</a>. Or <a href=\"https://stackoverflow.com/q/11984404/1188513\">that one</a>. Or <a href=\"https://stackoverflow.com/q/29102052/1188513\">that one</a>."}, {"owner": {"reputation": 489, "user_id": 7618270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e3dafb06431451eaec971860c401150?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksandar Misich", "link": "https://stackoverflow.com/users/7618270/aleksandar-misich"}, "edited": false, "score": 0, "creation_date": 1499285692, "post_id": 44934795, "comment_id": 76846579, "body": "Always check if your Methods have returned <code>Nothing</code>, especially with the shakier application methods like <code>.Find</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1499285915, "post_id": 44934795, "comment_id": 76846709, "body": "As for <i>why .Find doesn&#39;t find the &quot;170&quot;</i>, there&#39;s nothing anyone on this site can do without seeing the actual worksheet. Good luck!"}], "owner": {"reputation": 63, "user_id": 7443576, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10206909331245294/picture?type=large", "display_name": "TylerIlGenio", "link": "https://stackoverflow.com/users/7443576/tylerilgenio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "closed_date": 1499285584, "answer_count": 0, "score": 0, "last_activity_date": 1499286226, "creation_date": 1499284042, "question_id": 44934795, "link": "https://stackoverflow.com/questions/44934795/excel-vba-find-error", "closed_reason": "Duplicate", "title": "excel VBA .find error", "body": "<p>I am trying to do a simple find method. I know \"170\" exists at Z2. My error reads</p>\n\n<p>Run-time error '91':</p>\n\n<p>Object variable or With block variable not set</p>\n\n<pre><code>Dim cutRef as Range\n\nWorksheets(\"Sun\").Activate\nWith Rows(2)\nSet cutRef = .Find(\"170\")\nEnd With\n\nMsgBox cutRef.Address\n</code></pre>\n\n<p>I have no clue what i am doing wrong. Thanks for your help.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2016"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1499284301, "post_id": 44934740, "comment_id": 76845763, "body": "<b>101% Unique</b>. Start by asking this: where are the already used, previously generated strings stored? How? We likely dont need to store all of them, but at least we need to hold a counter somewhere."}, {"owner": {"reputation": 170, "user_id": 7169387, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XXqRp.png?s=128&g=1", "display_name": "Yuval", "link": "https://stackoverflow.com/users/7169387/yuval"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499284467, "post_id": 44934740, "comment_id": 76845865, "body": "Thing is , My knowledge with office access (and office in general is close to none) a wild guess (and I do mean wild) is probably in the actual table."}, {"owner": {"reputation": 2250, "user_id": 1923086, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/6CM1f.jpg?s=128&g=1", "display_name": "JahKnows", "link": "https://stackoverflow.com/users/1923086/jahknows"}, "edited": false, "score": 0, "creation_date": 1499285001, "post_id": 44934740, "comment_id": 76846181, "body": "If we can find out what table these values are stored in. Then this problem becomes much easier"}, {"owner": {"reputation": 170, "user_id": 7169387, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XXqRp.png?s=128&g=1", "display_name": "Yuval", "link": "https://stackoverflow.com/users/7169387/yuval"}, "edited": false, "score": 0, "creation_date": 1499286068, "post_id": 44934740, "comment_id": 76846807, "body": "It&#39;s in hebrew i&#39;m afraid , but I do know the table. the field is the primary key. it can be reffered to as operatorID (equivalent to hebrew) , and the table tblOperator"}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1499412971, "post_id": 44934740, "comment_id": 76905027, "body": "Please read <a href=\"//meta.stackoverflow.com/q/326569\">Under what circumstances may I add \u201curgent\u201d or other similar phrases to my question, in order to obtain faster answers?</a> - the summary is that this is not an ideal way to address volunteers, and is probably counterproductive to obtaining answers. Please refrain from adding this to your questions."}], "answers": [{"comments": [{"owner": {"reputation": 170, "user_id": 7169387, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XXqRp.png?s=128&g=1", "display_name": "Yuval", "link": "https://stackoverflow.com/users/7169387/yuval"}, "edited": false, "score": 0, "creation_date": 1499286370, "post_id": 44935162, "comment_id": 76846974, "body": "Paul , I like your solution , very creative , certainly haven&#39;t thought about it , but it doesn&#39;t have any A-Z characters in it."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1499327699, "post_id": 44935162, "comment_id": 76861428, "body": "Why care? You can generate a unique number every second for one hundred years."}, {"owner": {"reputation": 170, "user_id": 7169387, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XXqRp.png?s=128&g=1", "display_name": "Yuval", "link": "https://stackoverflow.com/users/7169387/yuval"}, "edited": false, "score": 0, "creation_date": 1499336041, "post_id": 44935162, "comment_id": 76867086, "body": "Do you know of a way I can use it for auto generation of a field ? So that I wont need to click a button or activate an event but it will be automaticly activated when opening a new record?"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 2, "last_activity_date": 1499285489, "creation_date": 1499285489, "answer_id": 44935162, "question_id": 44934740, "link": "https://stackoverflow.com/questions/44934740/generate-a-unique-string-made-out-of-numeric-alphabet/44935162#44935162", "title": "Generate a UNIQUE string made out of numeric / ALPHABET", "body": "<p>Use the date-time string:</p>\n\n<ul>\n<li><p>Formula: <code>=TEXT(NOW(),\"yymmddhhmmss\")</code> -> 170705161201</p></li>\n<li><p>VBA: <code>Debug.Print Format(Now, \"yymmddhhmmss\")</code></p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 170, "user_id": 7169387, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XXqRp.png?s=128&g=1", "display_name": "Yuval", "link": "https://stackoverflow.com/users/7169387/yuval"}, "edited": false, "score": 0, "creation_date": 1499336293, "post_id": 44943754, "comment_id": 76867263, "body": "No, but it is common to use this for identification of unique cases, and like Wikipedia states: &quot;Thus, for there to be a one in a billion chance of duplication, 103 trillion version 4 UUIDs must be generated&quot;. I don&#39;t know how large your database is, but I think that should do."}, {"owner": {"reputation": 170, "user_id": 7169387, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XXqRp.png?s=128&g=1", "display_name": "Yuval", "link": "https://stackoverflow.com/users/7169387/yuval"}, "edited": false, "score": 0, "creation_date": 1499336726, "post_id": 44943754, "comment_id": 76867569, "body": "What if the length of the string would be 12 (I need it to be no longer than twelve). is there any way to tell it to run again in case a duplication error has been found? say , catch duplication errors or (do while) duplication_error &lt;&gt; 0 (I dont know vba syntax)."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 170, "user_id": 7169387, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XXqRp.png?s=128&g=1", "display_name": "Yuval", "link": "https://stackoverflow.com/users/7169387/yuval"}, "edited": false, "score": 0, "creation_date": 1499337127, "post_id": 44943754, "comment_id": 76867850, "body": "Well, that limits the uniqueness, increasing the chance of collisions. If I have a chance, I will look into a more appropriate answer. Note that true uniqueness is not possible unless it&#39;s either time-based (limiting you to max 1 ID per second or external library calls to get microseconds) or you will need to keep a log of the (seed of the) previously generated answers."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 4, "last_activity_date": 1512766487, "last_edit_date": 1512766487, "creation_date": 1499330203, "answer_id": 44943754, "question_id": 44934740, "link": "https://stackoverflow.com/questions/44934740/generate-a-unique-string-made-out-of-numeric-alphabet/44943754#44943754", "title": "Generate a UNIQUE string made out of numeric / ALPHABET", "body": "<p>There are multiple solutions to this problem, but I like this one:</p>\n\n<pre><code>Public Function newguidx() As String\n    With CreateObject(\"Scriptlet.TypeLib\")\n        newguidx = Left(.Guid, 38)\n    End With  \nEnd Function\n</code></pre>\n\n<p>It creates a <a href=\"https://en.wikipedia.org/wiki/Universally_unique_identifier\" rel=\"nofollow noreferrer\">GUID</a>. These aren't unique per se, but you can read on the Wikipedia page that they might as well be. You can use <code>Replace</code> to remove the <code>{}-</code> signs if you want to.</p>\n\n<p>Also, since the format is standardized, it will be clear to most programmers what it is.</p>\n\n<p>Obviously, you can trim characters out to get your desired length, and it will increase your chance of finding a duplicate.</p>\n\n<p>Edit:</p>\n\n<p>Unfortunately, access to <code>Scriptlet.TypeLib</code> is currently blocked by default because of security reasons. See <a href=\"https://stackoverflow.com/questions/45332357/ms-access-vba-error-run-time-error-70-permission-denied\">MS Access VBA Error: Run time error &#39;70&#39; Permission Denied</a> for information on that, and <a href=\"https://stackoverflow.com/questions/7031347/how-can-i-generate-guids-in-excel\">How can I generate GUIDs in Excel?</a> for a nice overview of multiple methods to generate a GUID.</p>\n\n<p>My personal preference:</p>\n\n<pre><code>Public Function CreateGUID() As String\n    Do While Len(CreateGUID) &lt; 32\n        If Len(CreateGUID) = 16 Then\n            '17th character holds version information\n            CreateGUID = CreateGUID &amp; Hex$(8 + CInt(Rnd * 3))\n        End If\n        CreateGUID = CreateGUID &amp; Hex$(CInt(Rnd * 15))\n    Loop\n    CreateGUID = \"{\" &amp; Mid(CreateGUID, 1, 8) &amp; \"-\" &amp; Mid(CreateGUID, 9, 4) &amp; \"-\" &amp; Mid(CreateGUID, 13, 4) &amp; \"-\" &amp; Mid(CreateGUID, 17, 4) &amp; \"-\" &amp; Mid(CreateGUID, 21, 12) &amp; \"}\"\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1499340973, "last_edit_date": 1499340973, "creation_date": 1499340330, "answer_id": 44947571, "question_id": 44934740, "link": "https://stackoverflow.com/questions/44934740/generate-a-unique-string-made-out-of-numeric-alphabet/44947571#44947571", "title": "Generate a UNIQUE string made out of numeric / ALPHABET", "body": "<p>Well, I guess if it really needs to be alphanumeric and unique, this is the way to go: </p>\n\n<p>This code generates a random string of characters based on the current time (like the answer by @paul-bica), only it encodes them alphanumerically and uses the timer to get fractions of a second to reach 12 characters). This way you should be able to generate multiple random strings per second.</p>\n\n<p>Just call <code>UniqueTimeBasedString()</code> to get the string.\n(Note that if you use this function in a query, Access will cache the result and it won't be unique at all).</p>\n\n<pre><code>Public Function UniqueTimeBasedString() As String\n    Dim alphanumericCharacters As String\n    alphanumericCharacters = \"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n    Dim timeString As String\n    timeString = Format(Now, \"yymmddhhmmss\") &amp; Getmtimestring(6)\n    Dim c As Integer\n    Dim intTimepart As Integer\n    c = 1\n    Do While c &lt; Len(timeString)\n        intTimepart = CInt(Mid(timeString, c, 3))\n        c = c + 3\n        UniqueTimeBasedString = UniqueTimeBasedString &amp; Mid(alphanumericCharacters, Int(intTimepart / 61) + 1, 1) &amp; Mid(alphanumericCharacters, intTimepart Mod 61 + 1, 1)\n    Loop\nEnd Function\n\nPublic Function Getmtimestring(length As Integer) As String\n    Dim mtime As Double\n    mtime = Timer()\n    Dim mtimeLng As Long\n    mtimeLng = Int((mtime - Int(mtime)) * (10 ^ length))\n    Getmtimestring = CStr(mtimeLng)\n    Do While Len(Getmtimestring) &lt; length\n        Getmtimestring = \"0\" &amp; Getmtimestring\n    Loop\nEnd Function\n</code></pre>\n\n<p>Notes:</p>\n\n<ol>\n<li><code>Timer()</code> isn't really accurate, and this can theoretically cause\nproblems</li>\n<li>This code is incompatible with OS X, but that won't be a problem if you stay limited to Access (<code>Getmtimestring</code> will just return zeroes)</li>\n<li>You really should have a talk with your boss. Asking you to do something you aren't really qualified for with a tight deadline no options to use a slightly other solution isn't healthy workplace behaviour.</li>\n<li>The string contains encoded time, and can be decoded. Don't report it if you want the time of creation of the string to be secret.</li>\n</ol>\n"}], "owner": {"reputation": 170, "user_id": 7169387, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XXqRp.png?s=128&g=1", "display_name": "Yuval", "link": "https://stackoverflow.com/users/7169387/yuval"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1354, "favorite_count": 0, "accepted_answer_id": 44947571, "answer_count": 3, "score": 0, "last_activity_date": 1512766487, "creation_date": 1499283873, "last_edit_date": 1499412857, "question_id": 44934740, "link": "https://stackoverflow.com/questions/44934740/generate-a-unique-string-made-out-of-numeric-alphabet", "title": "Generate a UNIQUE string made out of numeric / ALPHABET", "body": "<h1>My Problem</h1>\n\n<ul>\n<li>I don't know any VBA</li>\n<li>Need to generate a string of 12 chars (ALPHA +  numbers , 0-9 , A-Z) <strong>IN</strong> <strong>VBA...</strong></li>\n<li><p><strong>Sample output :</strong></p>\n\n<pre><code>\"ADF3V3224K1WQ\"\n</code></pre>\n\n<p>(12 characters long , Higher caps Alphabetical letters , and Numeric values aswell).</p></li>\n</ul>\n\n<hr>\n\n<p><strong>Story</strong></p>\n\n<p>I'm having a hard time figuring out how to create a string generator (didn't say it has to be random, but it 100% has to be unique, meaning it has to check for duplications or store existing values), I have no experience with VBA. I already found a similar post here, but it is different then mine, as it does not specifically ask for the string to be 100% unique. (I don't need a very low chance, I need 100% across the board).</p>\n\n<p>Syntax-wise I'm pretty confused, I managed to find where the code behind events are, ie Button presses, so I know where I need to write it, but I have no idea how to check for duplications. (even relying on a time seed that can ensure it will be 100% unique is great).</p>\n\n<p><em>Link to the similar post:</em> <a href=\"https://stackoverflow.com/questions/22630264/ms-access-visual-basic-generate-random-string-in-text-field\">MS Access Visual Basic - generate random string in text field</a></p>\n"}, {"tags": ["excel", "vba", "security", "batch-file", "ms-office"], "comments": [{"owner": {"reputation": 7637, "user_id": 1306012, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/5a309f07bf7f23a6f176b8d57c22cc65?s=128&d=identicon&r=PG", "display_name": "Bruno Bieri", "link": "https://stackoverflow.com/users/1306012/bruno-bieri"}, "edited": false, "score": 0, "creation_date": 1499321328, "post_id": 44934651, "comment_id": 76857661, "body": "I recommend not to uninstall any Security Updates. Please investigate more on the error you get. The Path may exist but do you have the permission to (over)ride the files where you want to put them? Are the files accessible? Maybe check: <a href=\"https://msdn.microsoft.com/en-us/library/aa264531(v=vs.60).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa264531(v=vs.60).aspx</a>"}, {"owner": {"reputation": 33, "user_id": 8217141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47bdf8de4db43c7292869532624b9659?s=128&d=identicon&r=PG&f=1", "display_name": "Cliff Cross", "link": "https://stackoverflow.com/users/8217141/cliff-cross"}, "reply_to_user": {"reputation": 7637, "user_id": 1306012, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/5a309f07bf7f23a6f176b8d57c22cc65?s=128&d=identicon&r=PG", "display_name": "Bruno Bieri", "link": "https://stackoverflow.com/users/1306012/bruno-bieri"}, "edited": false, "score": 0, "creation_date": 1499435540, "post_id": 44934651, "comment_id": 76919886, "body": "Yes, I have &#39;Full Control&#39; permissions on all files, folders, and sub-folders I am attempting to access. Everything was working fine the day before the update and nothing in the tool or file structure changed. I just double checked to verify that the update didn&#39;t modify my permissions."}, {"owner": {"reputation": 7637, "user_id": 1306012, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/5a309f07bf7f23a6f176b8d57c22cc65?s=128&d=identicon&r=PG", "display_name": "Bruno Bieri", "link": "https://stackoverflow.com/users/1306012/bruno-bieri"}, "edited": false, "score": 0, "creation_date": 1499442636, "post_id": 44934651, "comment_id": 76925089, "body": "Do you have User Account Control (UAC) activated? If so does it work without? On my Windows 8.1 without UAC activated both <code>.exe</code> as well as <code>.bat</code> worked."}, {"owner": {"reputation": 33, "user_id": 8217141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47bdf8de4db43c7292869532624b9659?s=128&d=identicon&r=PG&f=1", "display_name": "Cliff Cross", "link": "https://stackoverflow.com/users/8217141/cliff-cross"}, "reply_to_user": {"reputation": 7637, "user_id": 1306012, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/5a309f07bf7f23a6f176b8d57c22cc65?s=128&d=identicon&r=PG", "display_name": "Bruno Bieri", "link": "https://stackoverflow.com/users/1306012/bruno-bieri"}, "edited": false, "score": 0, "creation_date": 1499443904, "post_id": 44934651, "comment_id": 76925867, "body": "Not sure. I will have to wait on IT to do it for me, so hopefully I can check today. Thanks. I will let you know."}, {"owner": {"reputation": 33, "user_id": 8217141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47bdf8de4db43c7292869532624b9659?s=128&d=identicon&r=PG&f=1", "display_name": "Cliff Cross", "link": "https://stackoverflow.com/users/8217141/cliff-cross"}, "reply_to_user": {"reputation": 7637, "user_id": 1306012, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/5a309f07bf7f23a6f176b8d57c22cc65?s=128&d=identicon&r=PG", "display_name": "Bruno Bieri", "link": "https://stackoverflow.com/users/1306012/bruno-bieri"}, "edited": false, "score": 1, "creation_date": 1503068976, "post_id": 44934651, "comment_id": 78477536, "body": "FYI: UAC was deactivated. Thank you for the suggestion. IT opened a ticket to explore, but that was a month and a half ago so I&#39;m not holding my breath. I found a work around though."}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 8217141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47bdf8de4db43c7292869532624b9659?s=128&d=identicon&r=PG&f=1", "display_name": "Cliff Cross", "link": "https://stackoverflow.com/users/8217141/cliff-cross"}, "is_accepted": true, "score": 1, "last_activity_date": 1503069876, "creation_date": 1503069876, "answer_id": 45760129, "question_id": 44934651, "link": "https://stackoverflow.com/questions/44934651/visual-basic-filecopy-error75-after-microsoft-office-2010-updates/45760129#45760129", "title": "Visual Basic FileCopy error75 after Microsoft Office 2010 updates", "body": "<p>While I never found a real fix for this issue, I did come up with a slightly 'hacky' work-around.</p>\n\n<p>The MS security patch prevented me from copy/pasting .BAT and .EXE files, I but could still save .BAT files.\nSo, I ended up having my script create a text file called \"copyExe.txt\" which had a single line:</p>\n\n<pre><code>ECHO F|xcopy &lt;source&gt; &lt;destination&gt;\n</code></pre>\n\n<p>This was then renamed to be \"copyExe.bat\" and run.</p>\n\n<p>By creating a .txt file, I circumvented the errors when using the VBA Open function on .BAT files (so I could actually create this new batch file). This batch file has the sole purpose of copy/pasting a .EXE file from one folder to another, which circumvented errors when trying to copy/paste .EXE files.\nAfter the copy/paste script is run, it is deleted.</p>\n\n<p>All-in-all it feels like a very silly solution, but it works and is very non-invasive for the user.</p>\n"}], "owner": {"reputation": 33, "user_id": 8217141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47bdf8de4db43c7292869532624b9659?s=128&d=identicon&r=PG&f=1", "display_name": "Cliff Cross", "link": "https://stackoverflow.com/users/8217141/cliff-cross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 45760129, "answer_count": 1, "score": 1, "last_activity_date": 1503069876, "creation_date": 1499283531, "question_id": 44934651, "link": "https://stackoverflow.com/questions/44934651/visual-basic-filecopy-error75-after-microsoft-office-2010-updates", "title": "Visual Basic FileCopy error75 after Microsoft Office 2010 updates", "body": "<p>Recently a large number of security updates were pushed for Microsoft Office at work. We have an Excel tool with a Visual Basic backbone which worked prior to the updates, and now does not work.</p>\n\n<p>I have done some isolated testing and have found that we see the same 'error 75' when using the FileCopy method on .BAT and .EXE files. Other less 'risky' file types seem to be ok. This is also an issue with the 'Open' command.</p>\n\n<p>Does anybody know of a workaround for this issue when copy/pasting .EXE and .BAT files, or maybe this is a known issue with a certain security update? I have searched everywhere, but the Google is failing me. I am hoping either:</p>\n\n<ol>\n<li>Someone knows which security update is the culprit and I can try\nuninstalling it to see if that fixes the issue</li>\n<li>There is a different way to copy/open/manipulate .BAT and .EXE files that doesn't violate the new security patch.</li>\n</ol>\n\n<p>Some background: \nWe are using Microsoft Office Professional Plus 2010 and the tool uses Excel as the interface.</p>\n\n<p>Here is the testing code I am using. I have verified that .TXT and .DAT files run just fine while .EXE and .BAT files cause 'error 75' indicating a permissions error. And before you ask, yes, the file path is correct, I have just omitted my employee identification information.</p>\n\n<pre><code>Sub Macro1()\n    ' Declare variables\n    Dim Filename, SourcePath, DestPath As String\n\n    ' Pathname variables\n    Filename = \"test.dat\"\n    SourcePath = \"C:\\Users\\&lt;REDACTED&gt;\\Desktop\\working_copy\\\" &amp; Filename\n    DestPath = \"C:\\Users\\&lt;REDACTED&gt;\\Desktop\\working_copy\\test\\\" &amp; Filename\n\n    ' Copy file from Source and paste in Destination\n    FileCopy SourcePath, DestPath\nEnd Sub\n</code></pre>\n\n<p>Here is an image with the updates that were installed. The tool worked prior to the 6/14/2017 dump, so anything before can be disregarded.\nSorry for the image, too many to enter them manually, no easy way to copy from the update list:</p>\n\n<p><a href=\"https://i.stack.imgur.com/tJgnj.png\" rel=\"nofollow noreferrer\">MS Office 2010 Security Updates</a></p>\n\n<p>Nothing with the tool or file structure changed. The only thing different is the updates. Also, we tested the same tool with Microsoft Office Home 2016 and it worked without a hitch.</p>\n\n<p>Any and all help will be appreciated. Thanks in advance!</p>\n"}, {"tags": ["performance", "excel", "vba"], "comments": [{"owner": {"reputation": 11, "user_id": 8261181, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MiSNeNCn8xo/AAAAAAAAAAI/AAAAAAAAIoQ/l9rV8gyXSYo/photo.jpg?sz=128", "display_name": "Akash Malhotra", "link": "https://stackoverflow.com/users/8261181/akash-malhotra"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499287544, "post_id": 44934518, "comment_id": 76847564, "body": "@A.S.H Could you please provide a sample VB code for the above proposed combination"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499288787, "post_id": 44934518, "comment_id": 76848191, "body": "Is <code>NA</code> the whole cell content? or just &quot;contains&quot; <code>NA</code>?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1499289347, "post_id": 44934518, "comment_id": 76848428, "body": "Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it <b>in the question itself</b>. Questions without a clear problem statement are not useful to other readers. See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1499289396, "post_id": 44934518, "comment_id": 76848448, "body": "Protip: instead of &quot;finding code for this on Stack Overflow&quot;, how about writing your own and understanding what you&#39;re doing?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1499351995, "post_id": 44934518, "comment_id": 76879243, "body": "Thanks for adding the code, that&#39;s a good first step towards getting your question back on track. Now you need a <i>clear problem statement</i>. Describe how your code is failing to do what you mean it to do =)"}, {"owner": {"reputation": 11, "user_id": 8261181, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MiSNeNCn8xo/AAAAAAAAAAI/AAAAAAAAIoQ/l9rV8gyXSYo/photo.jpg?sz=128", "display_name": "Akash Malhotra", "link": "https://stackoverflow.com/users/8261181/akash-malhotra"}, "edited": false, "score": 0, "creation_date": 1499353203, "post_id": 44934518, "comment_id": 76880191, "body": "Now, I have explained the issues with my current VBA code."}, {"owner": {"reputation": 11, "user_id": 8261181, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MiSNeNCn8xo/AAAAAAAAAAI/AAAAAAAAIoQ/l9rV8gyXSYo/photo.jpg?sz=128", "display_name": "Akash Malhotra", "link": "https://stackoverflow.com/users/8261181/akash-malhotra"}, "edited": false, "score": 0, "creation_date": 1499368538, "post_id": 44934518, "comment_id": 76889800, "body": "How do I get my question back on track?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8261181, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MiSNeNCn8xo/AAAAAAAAAAI/AAAAAAAAIoQ/l9rV8gyXSYo/photo.jpg?sz=128", "display_name": "Akash Malhotra", "link": "https://stackoverflow.com/users/8261181/akash-malhotra"}, "edited": false, "score": 0, "creation_date": 1499286295, "post_id": 44935230, "comment_id": 76846932, "body": "Could you please provide a sample VB code for this? Thanks in advance :)"}, {"owner": {"reputation": 219, "user_id": 7264061, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wSKXr.png?s=128&g=1", "display_name": "Martin G", "link": "https://stackoverflow.com/users/7264061/martin-g"}, "reply_to_user": {"reputation": 11, "user_id": 8261181, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MiSNeNCn8xo/AAAAAAAAAAI/AAAAAAAAIoQ/l9rV8gyXSYo/photo.jpg?sz=128", "display_name": "Akash Malhotra", "link": "https://stackoverflow.com/users/8261181/akash-malhotra"}, "edited": false, "score": 0, "creation_date": 1499287694, "post_id": 44935230, "comment_id": 76847632, "body": "Would depend on the table layout of yours. Use a small copy, let&#39;s say the first 100 rows of your table, do all the steps and record with the macro recorder. For the check for &quot;NA&quot; just loop through the cells of a row."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11, "user_id": 8261181, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MiSNeNCn8xo/AAAAAAAAAAI/AAAAAAAAIoQ/l9rV8gyXSYo/photo.jpg?sz=128", "display_name": "Akash Malhotra", "link": "https://stackoverflow.com/users/8261181/akash-malhotra"}, "edited": false, "score": 3, "creation_date": 1499289455, "post_id": 44935230, "comment_id": 76848482, "body": "@AkashMalhotra spoonfeedme.stackexchange.com has yet to come online."}], "tags": [], "owner": {"reputation": 219, "user_id": 7264061, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wSKXr.png?s=128&g=1", "display_name": "Martin G", "link": "https://stackoverflow.com/users/7264061/martin-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1499285789, "creation_date": 1499285789, "answer_id": 44935230, "question_id": 44934518, "link": "https://stackoverflow.com/questions/44934518/efficient-vba-code-for-conditionally-deleting-rows-in-big-excel-sheet/44935230#44935230", "title": "Efficient VBA code for conditionally deleting rows in big excel sheet", "body": "<p>My suggestion would be to 1. create an additional column and get the macro to write an \"NA\" into it, whenever \"NA\" is found wihthin the row and the line number else. 2. Sort the table using that column and delete all \"NA\" rows as block. 3. Resort the table using the row numbers and 4. delete the extra column.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8261181, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MiSNeNCn8xo/AAAAAAAAAAI/AAAAAAAAIoQ/l9rV8gyXSYo/photo.jpg?sz=128", "display_name": "Akash Malhotra", "link": "https://stackoverflow.com/users/8261181/akash-malhotra"}, "is_accepted": false, "score": 0, "last_activity_date": 1499462934, "creation_date": 1499462934, "answer_id": 44979884, "question_id": 44934518, "link": "https://stackoverflow.com/questions/44934518/efficient-vba-code-for-conditionally-deleting-rows-in-big-excel-sheet/44979884#44979884", "title": "Efficient VBA code for conditionally deleting rows in big excel sheet", "body": "<p>The fastest solution to this is as follows: (<a href=\"https://www.excelforum.com/excel-programming-vba-macros/1191894-efficient-vba-code-for-conditionally-deleting-rows-in-big-excel-sheet.html\" rel=\"nofollow noreferrer\">Source</a>)</p>\n\n<p>as this is a CSV file, parsing as text at the command line is likely the most efficient way;</p>\n\n<p>if you're on a Unix machine (Linux or OS X) then you can use SED (stream editor) from the terminal. this processes the changes in under a second!</p>\n\n<p>sed '/NA/d' ahs-comb-madhya_pradesh-dhar.csv > ahs-comb-madhya_pradesh-dhar_CLEAN.csv</p>\n\n<p>I believe you could use PowerShell on Windows to do something similar, the below command appears to work, although takes about 7 seconds</p>\n\n<p>Get-Content .\\ahs-comb-madhya_pradesh-dhar.csv | Where-Object {$_ -CNotMatch 'NA'} | Set-Content ahs-comb-madhya_pradesh-dhar_CLEAN.csv </p>\n"}], "owner": {"reputation": 11, "user_id": 8261181, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MiSNeNCn8xo/AAAAAAAAAAI/AAAAAAAAIoQ/l9rV8gyXSYo/photo.jpg?sz=128", "display_name": "Akash Malhotra", "link": "https://stackoverflow.com/users/8261181/akash-malhotra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1499462934, "creation_date": 1499282970, "last_edit_date": 1531161705, "question_id": 44934518, "link": "https://stackoverflow.com/questions/44934518/efficient-vba-code-for-conditionally-deleting-rows-in-big-excel-sheet", "title": "Efficient VBA code for conditionally deleting rows in big excel sheet", "body": "<p>My excel sheet has 40 columns and more than 1,00,000 rows. I want to delete all the rows which contain cell with a string \"NA\" in any of the columns. I am struggling to find an efficient VB code for this, which doesn't cause excel to crash. \nMy current VBA code (explained below) takes forever to run (>5 mins on Intel Xenon and 16 GB RAM) and crashes on slower machines (i5, 4 GB RAM). Any suggestions to streamline and make it faster?</p>\n\n<p>P.S. Exact number of rows and columns are not known apriori. And, I'm new to VBA, any help would be greatly appreciated.</p>\n\n<p>Link to the concerned file - <a href=\"https://drive.google.com/file/d/0Bzl56SYDK-iRdTE1LTlYZGsxSE0/view?usp=sharing\" rel=\"nofollow noreferrer\">https://drive.google.com/file/d/0Bzl56SYDK-iRdTE1LTlYZGsxSE0/view?usp=sharing</a></p>\n\n<p>My VBA code:</p>\n\n<pre><code>Sub DeleteRowWithContents()\n\n'Finds the last non-blank cell on a sheet/range.\n\nDim lRow As Long\nDim lCol As Long\n\n    lRow = Cells.Find(What:=\"*\", _\n                    After:=Range(\"A1\"), _\n                    LookAt:=xlPart, _\n                    LookIn:=xlFormulas, _\n                    SearchOrder:=xlByRows, _\n                    SearchDirection:=xlPrevious, _\n                    MatchCase:=False).Row\n\n    lCol = Cells.Find(What:=\"*\", _\n                    After:=Range(\"A1\"), _\n                    LookAt:=xlPart, _\n                    LookIn:=xlFormulas, _\n                    SearchOrder:=xlByColumns, _\n                    SearchDirection:=xlPrevious, _\n                    MatchCase:=False).Column\n\n        'MsgBox \"Last Row: \" &amp; lRow\n        'MsgBox \"Last Column: \" &amp; lCol\n\n\n     For j = lCol To 1 Step -1\n     For i = lRow To 1 Step -1\n        If (Cells(i, j).Value) = \"NA\" Then\n            Cells(i, \"A\").EntireRow.Delete\n        End If\n    Next i\n    lRow = Cells.Find(What:=\"*\", _\n                    After:=Range(\"A1\"), _\n                    LookAt:=xlPart, _\n                    LookIn:=xlFormulas, _\n                    SearchOrder:=xlByRows, _\n                    SearchDirection:=xlPrevious, _\n                    MatchCase:=False).Row\n    Next j\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 8261185, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207465292350483/picture?type=large", "display_name": "Michael Thomas", "link": "https://stackoverflow.com/users/8261185/michael-thomas"}, "edited": false, "score": 0, "creation_date": 1499283172, "post_id": 44934506, "comment_id": 76845106, "body": "Forgot to mention, if you build a quick workbook to play around with this... you will need 3 tabs: &quot;Events&quot;, &quot;Calendar&quot;, &quot;Recurring&quot;. Go to the link above to get the ReadMe doc to setup the workbook....and install the code. It is actually pretty slick!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1499295498, "post_id": 44934506, "comment_id": 76850900, "body": "There&#39;s a lot of code there and no really clear description of how to replicate your problem or what the problem &quot;looks like&quot;, so you might find it helps you with getting suggestions if you create a sample workbook, already set up to show the problem, hosted on dropbox, etc."}, {"owner": {"reputation": 1, "user_id": 8261185, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207465292350483/picture?type=large", "display_name": "Michael Thomas", "link": "https://stackoverflow.com/users/8261185/michael-thomas"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1499440691, "post_id": 44934506, "comment_id": 76923780, "body": "Great idea, and here is the link... <a href=\"https://www.dropbox.com/s/z0rcpji1koierzf/Sample%20Workbook.xlsm?dl=0\" rel=\"nofollow noreferrer\">Sample Workbook</a>"}, {"owner": {"reputation": 1, "user_id": 8261185, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207465292350483/picture?type=large", "display_name": "Michael Thomas", "link": "https://stackoverflow.com/users/8261185/michael-thomas"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1499440787, "post_id": 44934506, "comment_id": 76923856, "body": "@timwilliams The problem manifests when selecting the April or June (4 or 6) filter cell in the Events tab...."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1499449965, "post_id": 44934506, "comment_id": 76928901, "body": "Your error is in <code>ParseRecurring</code> - if you check the Events collection for months 4 or 6 it has no content.  I don&#39;t have time to debug the whole thing but the issue seems to be with your use of <code>GetFilteredRangeTopRow</code>, which returns the row number on the Events sheet, which is not the same as the row number of the pasted content on Recurring (because all hidden rows are removed when you paste)"}], "owner": {"reputation": 1, "user_id": 8261185, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207465292350483/picture?type=large", "display_name": "Michael Thomas", "link": "https://stackoverflow.com/users/8261185/michael-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499286752, "creation_date": 1499282931, "last_edit_date": 1499286752, "question_id": 44934506, "link": "https://stackoverflow.com/questions/44934506/excel-vba-calendar-generator-doesnt-return-april-june", "title": "Excel VBA Calendar Generator doesn&#39;t return April/June?", "body": "<p>I borrowed code (<a href=\"https://github.com/BehindTheMath/vba-generate-calendar\" rel=\"nofollow noreferrer\">https://github.com/BehindTheMath/vba-generate-calendar</a>) to create a printable calendar based on a list of events ...which works great until I get to April, and June as two examples. Then, even though I have data there...the calendar doesn't return anything?</p>\n\n<p>Secondly, I noticed that the recurring events wouldn't recur across the month? </p>\n\n<p>The code was edited to allow for filtering, so that the calendar would simple display the filtered month graphically.</p>\n\n<p>email me and I can send sample workbook with events list...couldn't figure out how to attach it?</p>\n\n<p>format for events is given below in the attached image</p>\n\n<p><img src=\"https://i.stack.imgur.com/08iCz.png\" alt=\"Events List\"></p>\n\n<pre><code>Option Explicit\n\nPublic MaxEvents As Integer, EventsSheet As Worksheet, CalendarSheet As Worksheet, RecurringSheet As Worksheet, NumWeeks As Integer, LastDay As Integer\n\n' Change these column numbers to reflect the Events data table\nConst EventNameColumn As Integer = 1, EventStartDateColumn As Integer = 3, EventStartTimeColumn As Integer = 4\nConst EventEndDateColumn As Integer = 5, EventEndTimeColumn As Integer = 6, EventDurationColumn As Integer = 7, RecurringColumn As Integer = 8, LastColumn As Integer = 11\n\nPrivate Sub GenerateCalendar()\n    Dim FirstDayOfWeek As Integer, ThisMonth As Integer, ThisYear As Integer, DayOfWeekCounter As Integer, DateCounter As Integer, EventListRowCounter As Integer\n    Dim x As Integer, TopRow As Integer\n    Dim EventData As Variant\n    Dim StartDay As Date\n    Dim DaysEvents As Collection, Events As New Collection\n\n    Set EventsSheet = Worksheets(\"Events\")\n    Set CalendarSheet = Worksheets(\"Calendar\")\n    Set RecurringSheet = Worksheets(\"Recurring\")\n    ThisYear = Year(EventsSheet.Cells(GetFilteredRangeTopRow, EventStartDateColumn))\n    ThisMonth = Month(EventsSheet.Cells(GetFilteredRangeTopRow, EventStartDateColumn))\n    StartDay = DateSerial(ThisYear, ThisMonth, 1)\n    NumWeeks = 0\n\n    ' Unprotect sheet if it had a previous calendar to prevent errors.\n    CalendarSheet.Protect Contents:=False\n    ' Prevent screen from flashing while drawing the calendar.\n    Application.ScreenUpdating = False\n\n    ' Clear any previous data.\n    CalendarSheet.Cells.Clear\n\n    ' Setup the headers\n    SetupHeaders StartDay\n\n    ' Get on which day of the week the month starts.\n    FirstDayOfWeek = Weekday(StartDay)\n    ' Get the last date of the month\n    LastDay = Day(DateSerial(ThisYear, ThisMonth + 1, 1) - 1)\n    DateCounter = 1\n    TopRow = 3\n\n    ' If there are recurring events\n    If EventsSheet.Cells(GetFilteredRangeTopRow, RecurringColumn).End(xlDown) &lt;&gt; vbNullString Then\n        ParseRecurring\n        Set Events = LoadEvents(Worksheets(\"Recurring\"))\n        Worksheets(\"Recurring\").Cells.Clear\n    Else\n        Set Events = LoadEvents(EventsSheet)\n    End If\n\n    Do\n        For DayOfWeekCounter = FirstDayOfWeek To 7\n            ' Write the dates\n            With CalendarSheet.Cells(TopRow, DayOfWeekCounter)\n                .Value = DateCounter\n                .Font.Size = 12\n                .Font.Bold = True\n                .RowHeight = 20\n                .HorizontalAlignment = xlRight\n                .IndentLevel = 1\n            End With\n\n            ' Write events\n            Set DaysEvents = Nothing\n            ' Get this day's events (if there are any)\n            On Error Resume Next\n            Set DaysEvents = Events(Str(DateCounter))\n            On Error GoTo 0\n            ' If there are events on this day\n            If Not DaysEvents Is Nothing Then\n                EventListRowCounter = 0\n                ' Go through this day's events and write them\n                For Each EventData In DaysEvents\n                    EventListRowCounter = EventListRowCounter + 1\n                    CalendarSheet.Cells(TopRow + EventListRowCounter, DayOfWeekCounter) = EventData\n                Next EventData\n            End If\n\n            DateCounter = DateCounter + 1\n            ' If we reached the end of the month, stop.\n            If DateCounter &gt; LastDay Then\n                NumWeeks = NumWeeks + 1\n                Exit Do\n            End If\n        Next DayOfWeekCounter\n\n        NumWeeks = NumWeeks + 1\n        FirstDayOfWeek = 1\n        TopRow = TopRow + MaxEvents + 1\n    Loop\n\n    ' Set row height\n    For x = 1 To NumWeeks\n        CalendarSheet.Range(CalendarSheet.Cells(3 + x + MaxEvents * (x - 1), 1), CalendarSheet.Cells(3 + MaxEvents * x + (x - 1), 1)).RowHeight = 15\n    Next x\n\n    DrawBorders\n\n    ' Set the print area\n    SetupPage\n\n    ' Turn off gridlines.\n    ActiveWindow.DisplayGridlines = False\n    ' Protect sheet to prevent overwriting the dates.\n    CalendarSheet.Protect Contents:=True, UserInterfaceOnly:=True\n\n    ' Resize window to show all of calendar (may have to be adjusted\n    ' for video configuration).\n    ActiveWindow.WindowState = xlMaximized\n    ActiveWindow.ScrollRow = 1\n\n    ' Allow screen to redraw with calendar showing.\n    Application.ScreenUpdating = True\n\n    Set Events = Nothing: Set EventsSheet = Nothing: Set CalendarSheet = Nothing: Set DaysEvents = Nothing: Set RecurringSheet = Nothing\nEnd Sub\n\nSub SetupHeaders(ByVal StartDay As Date)\n    Dim x As Integer\n\n    ' Create the month and year title.\n    With CalendarSheet.Range(\"A1:G1\")\n        .Merge\n        .Value = Format(StartDay, \"mmmm yyyy\")\n        .HorizontalAlignment = xlCenterAcrossSelection\n        .VerticalAlignment = xlCenter\n        .Font.Size = 18\n        .Font.Bold = True\n        .RowHeight = 35\n        .NumberFormat = \"mmmm yyyy\"\n    End With\n\n    ' Format A2:G2 for the days of week labels.\n    With CalendarSheet.Range(\"A2:G2\")\n        .HorizontalAlignment = xlCenter\n        .Font.Size = 12\n        .Font.Bold = True\n        .RowHeight = 20\n        .ColumnWidth = 35\n    End With\n    ' Write days of week in A2:G2.\n    For x = 1 To 7\n        CalendarSheet.Cells(2, x) = WeekdayName(x)\n    Next x\nEnd Sub\n\nSub ParseRecurring()\n    Dim CurDate As Integer, LastRow As Integer, OriginalLastRow As Integer, CurOriginalRow As Integer, DateCounter As Integer\n\n    LastRow = GetLastRow(EventsSheet)\n    OriginalLastRow = LastRow\n\n    With RecurringSheet\n        ' Clear any old data from the Recurring sheet\n        .Cells.Clear\n        ' Copy the data from the Events sheet to the Recurring sheet so we can manipulate it without affecting the original data\n        EventsSheet.Range(\"A1\", .Cells(OriginalLastRow, LastColumn).Address).Copy .Range(\"A1\")\n\n        ' For each row of the original data\n        For CurOriginalRow = GetFilteredRangeTopRow To OriginalLastRow\n            ' If this event is recurring\n            If .Cells(CurOriginalRow, RecurringColumn) &lt;&gt; vbNullString Then\n                ' Get the date of the original event\n                CurDate = Day(.Cells(CurOriginalRow, EventStartDateColumn))\n                ' What is the frequency that it recurs\n                Select Case LCase(.Cells(CurOriginalRow, RecurringColumn))\n                    Case \"daily\"\n                        ' For each subsequent day\n                        For DateCounter = CurDate To LastDay\n                            ' Copy the data\n                            .Range(.Cells(CurOriginalRow, 1), .Cells(CurOriginalRow, RecurringColumn - 1)).Copy .Cells(LastRow + DateCounter - CurDate + 1, 1)\n                            'Update the day to the new day\n                            .Cells(LastRow + (DateCounter - CurDate) + 1, EventStartDateColumn) = .Cells(CurOriginalRow, EventStartDateColumn) + (DateCounter - CurDate) + 1\n                            .Cells(LastRow + (DateCounter - CurDate) + 1, EventEndDateColumn) = .Cells(CurOriginalRow, EventEndDateColumn) + (DateCounter - CurDate) + 1\n                        Next DateCounter\n                        LastRow = LastRow + DateCounter - CurDate - 1\n                    Case \"weekly\"\n                        ' If there are more dates to recur on\n                        If LastDay - CurDate &gt;= 7 Then\n                            ' For each week\n                            For DateCounter = 7 To LastDay - CurDate Step 7\n                                ' Copy the data\n                                .Range(.Cells(CurOriginalRow, 1), .Cells(CurOriginalRow, RecurringColumn - 1)).Copy .Cells(LastRow + (DateCounter / 7), 1)\n                                'Update the day to the new day\n                                .Cells(LastRow + (DateCounter / 7), EventStartDateColumn) = .Cells(CurOriginalRow, EventStartDateColumn) + DateCounter\n                                .Cells(LastRow + (DateCounter / 7), EventEndDateColumn) = .Cells(CurOriginalRow, EventEndDateColumn) + DateCounter\n                            Next DateCounter\n                            LastRow = LastRow + ((DateCounter - 7) / 7)\n                        End If\n                End Select\n            End If\n        Next CurOriginalRow\n    End With\nEnd Sub\n\nFunction LoadEvents(ByRef sheet As Worksheet) As Collection\n    Dim RowCounter As Integer, CurDate As Integer, CurMonth As Integer\n    Dim EventData As String, LastDate As String, EventDuration As String\n    Dim MonthsEvents As New Collection\n\n    SortEvents sheet:=sheet\n    RowCounter = GetFilteredRangeTopRow\n    CurDate = Day(sheet.Cells(RowCounter, EventStartDateColumn))\n    CurMonth = Month(sheet.Cells(RowCounter, EventStartDateColumn))\n    LastDate = \"0\"\n\n    Do While sheet.Cells(RowCounter, EventStartDateColumn) &lt;&gt; vbNullString\n        ' If the next event is from a different month, stop\n        If Month(sheet.Cells(RowCounter, EventStartDateColumn)) &lt;&gt; CurMonth Then Exit Do\n\n        ' Get the next event\n        EventDuration = Format(sheet.Cells(RowCounter, EventDurationColumn), \"h:mm\")\n        ' Formula for calculating duration:\n        'EventDuration = Int(DateDiff(\"n\", Sheet.Cells(RowCounter, EventStartTimeColumn), Sheet.Cells(RowCounter, EventEndTimeColumn)) / 60)\n        'EventDuration = Event Duration &amp; \":\" &amp; DateDiff(\"n\", Sheet.Cells(RowCounter, EventStartTimeColumn), Sheet.Cells(RowCounter, EventEndTimeColumn)) Mod 60\n        EventData = sheet.Cells(RowCounter, EventNameColumn) &amp; \": \" &amp; Format(sheet.Cells(RowCounter, EventStartTimeColumn), \"h:mm AMPM\") &amp; \" - \"\n        EventData = EventData &amp; Format(sheet.Cells(RowCounter, EventEndTimeColumn), \"h:mm AMPM\") &amp; \" (\" &amp; EventDuration &amp; \")\"\n\n        If LastDate &lt;&gt; Str(CurDate) Then\n            LastDate = Str(CurDate)\n            MonthsEvents.Add New Collection, LastDate\n        End If\n\n        MonthsEvents(LastDate).Add EventData\n        If MonthsEvents(LastDate).Count &gt; MaxEvents Then MaxEvents = MonthsEvents(LastDate).Count\n\n        ' Advance to the next row\n        RowCounter = RowCounter + 1\n        CurDate = Day(sheet.Cells(RowCounter, EventStartDateColumn))\n    Loop\n\n    Set LoadEvents = MonthsEvents\n\n    Set MonthsEvents = Nothing\nEnd Function\n\nSub SortEvents(ByRef sheet As Worksheet)\n    With sheet.Sort\n        .SortFields.Clear\n        .SortFields.Add Key:=sheet.Columns(EventStartDateColumn), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .SortFields.Add Key:=sheet.Columns(EventStartTimeColumn), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .SortFields.Add Key:=sheet.Columns(EventEndDateColumn), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .SetRange sheet.Range(sheet.Cells(2, 1), sheet.Cells(GetLastRow(sheet), LastColumn))\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\nEnd Sub\n\nSub DrawBorders()\n    Dim x As Integer\n\n    ' Draw outside and vertical borders\n    With CalendarSheet.Range(CalendarSheet.Cells(1, 1), CalendarSheet.Cells(2 + NumWeeks * (MaxEvents + 1), 7))\n        .Borders(xlEdgeTop).Weight = xlThick\n        .Borders(xlEdgeTop).ColorIndex = xlAutomatic\n        .Borders(xlEdgeBottom).Weight = xlThick\n        .Borders(xlEdgeBottom).ColorIndex = xlAutomatic\n        .Borders(xlRight).Weight = xlThick\n        .Borders(xlRight).ColorIndex = xlAutomatic\n    End With\n    With CalendarSheet.Range(CalendarSheet.Cells(1, 1), CalendarSheet.Cells(2 + NumWeeks * (MaxEvents + 1), 1))\n        .Borders(xlLeft).Weight = xlThick\n        .Borders(xlLeft).ColorIndex = xlAutomatic\n    End With\n\n    ' Draw border above the weekday names\n    With CalendarSheet.Range(\"A2:G2\")\n        .Borders(xlEdgeTop).Weight = xlThick\n        .Borders(xlEdgeTop).ColorIndex = xlAutomatic\n    End With\n\n    ' Draw borders above and below the dates\n    For x = 1 To NumWeeks\n        With CalendarSheet.Range(CalendarSheet.Cells(3 + ((MaxEvents + 1) * (x - 1)), 1), CalendarSheet.Cells(3 + ((MaxEvents + 1) * (x - 1)), 7))\n            .Borders(xlEdgeTop).Weight = xlThick\n            .Borders(xlEdgeTop).ColorIndex = xlAutomatic\n            .Borders(xlEdgeBottom).Weight = xlThick\n            .Borders(xlEdgeBottom).ColorIndex = xlAutomatic\n        End With\n    Next x\nEnd Sub\n\nSub SetupPage()\n    Worksheets(\"Calendar\").Select\n    ' Switch to Page Break Preview mode\n    ActiveWindow.View = xlPageBreakPreview\n    With CalendarSheet\n        ' Remove old page breaks\n        .ResetAllPageBreaks\n        ' Set landscape\n        .PageSetup.Orientation = xlLandscape\n        ' Set page area\n        .PageSetup.PrintArea = .Range(.Cells(1, 1), .Cells(2 + NumWeeks * (MaxEvents + 1), 7)).Address\n        ' Move page breaks if necessary\n        If .VPageBreaks.Count Then .VPageBreaks(1).DragOff Direction:=xlToRight, RegionIndex:=1\n        If .HPageBreaks.Count Then Set .HPageBreaks(1).Location = .Range(\"$A$53\")\n    End With\n    ' Switch back to Normal View\n    ActiveWindow.View = xlNormalView\nEnd Sub\n\nFunction GetLastRow(ByRef sheet As Worksheet) As Integer\n    ' Refresh UsedRange\n    'sheet.UsedRange\n    'GetLastRow = sheet.UsedRange.Rows(sheet.UsedRange.Rows.Count).Row\n    GetLastRow = sheet.Cells(1, EventNameColumn).CurrentRegion.Rows.Count\nEnd Function\nFunction GetFilteredRangeTopRow() As Long\n  Dim HeaderRow As Long, LastFilterRow As Long\n  On Error GoTo NoFilterOnSheet\n  Range(\"eventlist\").Activate\n  With ActiveSheet\n    HeaderRow = .AutoFilter.Range(1).Row\n    LastFilterRow = .Range(Split(.AutoFilter.Range.Address, \":\")(1)).Row\n    GetFilteredRangeTopRow = .Range(.Rows(HeaderRow + 1), .Rows(Rows.Count)).SpecialCells(xlCellTypeVisible)(1).Row\n    If GetFilteredRangeTopRow = LastFilterRow + 1 Then GetFilteredRangeTopRow = 0\n  End With\nNoFilterOnSheet:\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "edited": false, "score": 0, "creation_date": 1499280619, "post_id": 44933827, "comment_id": 76843593, "body": "To add, if I run my code while the second worksheet is open, the opposite  occurs. So if wb2 is open (has 30 rows), all 30 rows will be bordered in both wb2 and wb1"}, {"owner": {"reputation": 3371, "user_id": 276627, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/47a283ee9f848339d34f75f0ebd9593f?s=128&d=identicon&r=PG", "display_name": "ktdrv", "link": "https://stackoverflow.com/users/276627/ktdrv"}, "edited": false, "score": 0, "creation_date": 1499282206, "post_id": 44933827, "comment_id": 76844507, "body": "Welcome to SO! Here&#39;s a recommendation: instead of adding additional info as a comment, try editing the original question."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1499282487, "post_id": 44933827, "comment_id": 76844695, "body": "related: <a href=\"https://stackoverflow.com/questions/36368220/is-the-in-range-necessary-when-defined-by-cells\">Is the . in .Range necessary when defined by .Cells?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "edited": false, "score": 0, "creation_date": 1499281042, "post_id": 44933973, "comment_id": 76843848, "body": "Thanks so much, that works perfectly. Still new to VBA and I have encountered this problem a lot. This"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "edited": false, "score": 0, "creation_date": 1499281115, "post_id": 44933973, "comment_id": 76843884, "body": "My pleasure. I would say sheet referencing is  probably the single biggest cause of problems."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1499281724, "post_id": 44933973, "comment_id": 76844223, "body": "^ that. <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> code inspections can help you find them."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1499281750, "last_edit_date": 1499281750, "creation_date": 1499280908, "answer_id": 44933973, "question_id": 44933827, "link": "https://stackoverflow.com/questions/44933827/how-to-add-borders-to-multiple-ranges-in-vba/44933973#44933973", "title": "How to add borders to multiple ranges in VBA?", "body": "<p>You need to fully reference the sheets. I think you can also shorten your code by avoiding the loops.</p>\n\n<pre><code>Sub lines()\n\nDim wb As Worksheet\nDim wb2 As Worksheet\n\nSet wb = Worksheets(\"wb Summary\")\nSet wb2 = Worksheets(\"wb2 Summary\")\n\nWith wb.Range(\"A2:H\" &amp; wb.Cells(wb.Rows.Count, \"H\").End(xlUp).Row)\n    .Borders.LineStyle = xlContinuous\n    .Borders.Weight = xlThin\nEnd With\n\nWith wb2.Range(\"A2:H\" &amp; wb2.Cells(wb2.Rows.Count, \"H\").End(xlUp).Row)\n    .Borders.LineStyle = xlContinuous\n    .Borders.Weight = xlThin\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1058, "favorite_count": 0, "accepted_answer_id": 44933973, "answer_count": 1, "score": 0, "last_activity_date": 1499281750, "creation_date": 1499280349, "question_id": 44933827, "link": "https://stackoverflow.com/questions/44933827/how-to-add-borders-to-multiple-ranges-in-vba", "title": "How to add borders to multiple ranges in VBA?", "body": "<p>I have been trying to add borders to two ranges on two different worksheets. \nIn my case, sheet one has 14 rows whereas the second worksheet has 30 rows. Each worksheet has the same amount of columns. When I run my code, the first worksheet works fine but the second worksheet only has 14 rows that are bordered and the other 16 are left without a border. Why isn't my code bordering the last 16 columns of my second worksheet?</p>\n\n<pre><code>Sub lines()\n\nDim wb As Worksheet\nDim wb2 As Worksheet\nDim arrBorders As Variant, vBorder As Variant\n\n\nSet wb = Worksheets(\"wb Summary\")\nSet wb2 = Worksheets(\"wb2 Summary\")\narrBorders = Array(xlEdgeLeft, xlEdgeTop, xlEdgeBottom, _\n                       xlEdgeRight, xlInsideVertical, xlInsideHorizontal)\n\nWith wb.Range(\"A2:H\" &amp; Cells(Rows.Count, \"H\").End(xlUp).Row)\n    For Each vBorder In arrBorders\n    With .Borders(vBorder)\n     .LineStyle = xlContinuous\n\n                .Weight = xlThin\n            End With\n        Next\n    End With\n\nWith wb2.Range(\"A2:H\" &amp; Cells(Rows.Count, \"H\").End(xlUp).Row)\n    For Each vBorder In arrBorders\n    With .Borders(vBorder)\n     .LineStyle = xlContinuous\n                .Weight = xlThin\n            End With\n        Next\n    End With\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["database", "ms-access", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1499281035, "post_id": 44933741, "comment_id": 76843841, "body": "So... you&#39;re asking how to turn Excel into a database?"}, {"owner": {"reputation": 48, "user_id": 8137603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d16a406ddbf1b8278db85c23d9c1204?s=128&d=identicon&r=PG&f=1", "display_name": "VBAmazing", "link": "https://stackoverflow.com/users/8137603/vbamazing"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1499281344, "post_id": 44933741, "comment_id": 76844021, "body": "Basically. I&#39;m asking how to project values from hundreds of different spreadsheets onto an Access Database using VBA Code or otherwise."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1499281635, "post_id": 44933741, "comment_id": 76844171, "body": "You should import it once, and then let the data live in the database; a spreadsheet should <i>read</i> from the db, not the other way around. Having data live in a spreadsheet is extremely error-prone. What if a row is accidentally deleted and all row ID&#39;s are now offset? Referencial integrity <i>requires</i> a database, trying to have it in a spreadsheet is a waste of time."}, {"owner": {"reputation": 3203, "user_id": 430567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e5c53d9384850093ebc925e896629b1?s=128&d=identicon&r=PG", "display_name": "Lord Peter", "link": "https://stackoverflow.com/users/430567/lord-peter"}, "edited": false, "score": 1, "creation_date": 1499282833, "post_id": 44933741, "comment_id": 76844911, "body": "I&#39;m afraid that whatever you do with Access and Excel it isn&#39;t going to work &quot;in real time&quot;. Excel will take a lock on the spreadsheet when it is opened, and Access won&#39;t be able to see changes until the spreadsheet is saved and closed, and whatever query you are using to display the results is re-executed.Sounds like you need a database and not hundreds of spreadsheets."}], "answers": [{"comments": [{"owner": {"reputation": 48, "user_id": 8137603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d16a406ddbf1b8278db85c23d9c1204?s=128&d=identicon&r=PG&f=1", "display_name": "VBAmazing", "link": "https://stackoverflow.com/users/8137603/vbamazing"}, "edited": false, "score": 0, "creation_date": 1499282846, "post_id": 44934094, "comment_id": 76844916, "body": "This seems to do what I want it to do, but I only want to copy certain cell values on each of the folders. I am attempting to change the &#39;DoCmd&#39; line to make it take from my named ranges, but I can&#39;t seem to get the syntax right (if what I&#39;m trying is even possible)"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 48, "user_id": 8137603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d16a406ddbf1b8278db85c23d9c1204?s=128&d=identicon&r=PG&f=1", "display_name": "VBAmazing", "link": "https://stackoverflow.com/users/8137603/vbamazing"}, "edited": false, "score": 0, "creation_date": 1499285440, "post_id": 44934094, "comment_id": 76846433, "body": "It is. Try something like this: <code>DoCmd.TransferSpreadsheet acLink, , objFile.Name, objFile.Path, ,&quot;A1:B2&quot;</code>. Note that this is for all spreadsheets. Read here: <a href=\"https://msdn.microsoft.com/VBA/Access-VBA/articles/docmd-transferspreadsheet-method-access\" rel=\"nofollow noreferrer\">msdn.microsoft.com/VBA/Access-VBA/articles/&hellip;</a> for more information on the method."}, {"owner": {"reputation": 48, "user_id": 8137603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d16a406ddbf1b8278db85c23d9c1204?s=128&d=identicon&r=PG&f=1", "display_name": "VBAmazing", "link": "https://stackoverflow.com/users/8137603/vbamazing"}, "edited": false, "score": 0, "creation_date": 1499359289, "post_id": 44934094, "comment_id": 76884541, "body": "I couldn&#39;t use any of my named ranges but found a workaround. Working like a charm, thanks for the code. Answer selected"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1499434861, "post_id": 44934094, "comment_id": 76919293, "body": "Nice one Erik!!"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 2, "last_activity_date": 1499281333, "creation_date": 1499281333, "answer_id": 44934094, "question_id": 44933741, "link": "https://stackoverflow.com/questions/44933741/real-time-database-updating/44934094#44934094", "title": "Real-Time Database Updating", "body": "<p>Luckily, I had just that lying around somewhere. This links all excel files in the same folder as the database.</p>\n\n<p>Note that this just uses the file name as the tablename, and links everything using default settings. Change the <code>DoCmd.TransferSpreadsheet</code> line to customize it. Originally I have this linked to a form so I can choose what to import, and how it is handled.</p>\n\n<pre><code>Public Sub ImportExcel()\n    Dim objFSO As Object 'FileSystemObject\n    Dim databasefolderlocation As String\n    Dim objFolder As Object 'Folder\n    Dim objFile As Variant\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    databasefolderlocation = Application.CurrentProject.Path 'This sets the folder, you can change it for another folder\n    Set objFolder = objFSO.GetFolder(databasefolderlocation)\n    For Each objFile In objFolder.Files\n        If objFile.Name Like \"*.xls\" Or objFile.Name Like \"*.xlsx\" Then\n            DoCmd.TransferSpreadsheet acLink, , objFile.Name, objFile.Path\n        End If\n    Next objFile\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 48, "user_id": 8137603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d16a406ddbf1b8278db85c23d9c1204?s=128&d=identicon&r=PG&f=1", "display_name": "VBAmazing", "link": "https://stackoverflow.com/users/8137603/vbamazing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 44934094, "answer_count": 1, "score": 0, "last_activity_date": 1499285279, "creation_date": 1499280116, "last_edit_date": 1499285279, "question_id": 44933741, "link": "https://stackoverflow.com/questions/44933741/real-time-database-updating", "title": "Real-Time Database Updating", "body": "<p>I have ~300 Identical Excel Spreadsheets (.xlsx) that all have ten different cells I would like to project to an Access database. Some are single cells, a few ranges-- all of them are named in each individual workbook. The database should hold all values from the same worksheet on the same line, and all numbers should update in real time.</p>\n\n<p>My goal is to use access to keep a running record on the contents of these cells. I have attempted to link the workbooks to the Master Access database using: External Data->Import and Link->Excel->Link to the data source by creating a linked table-> and here I would select one of the named ranges and click 'Finish', but I can only do this once per spreadsheet. This makes repeating this process for all spreadsheets unfeasible.</p>\n\n<p>Is there a way to use Access VBA to create a linked Excel Table for each Workbook in the folder?</p>\n\n<p>I am sort of teaching myself Access, and am still relatively new at it so any insight will help.</p>\n\n<p>Cheers.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1499280118, "post_id": 44933700, "comment_id": 76843322, "body": "&quot;1&quot; will always <code>=True</code>. Same for &quot;2&quot; and &quot;3&quot;, etc. Do you mean if the item is <i>selected</i> in the listbox?"}, {"owner": {"reputation": 103, "user_id": 8122554, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/939313cb40ac81872af575000467a6f4?s=128&d=identicon&r=PG&f=1", "display_name": "N. Whyter", "link": "https://stackoverflow.com/users/8122554/n-whyter"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1499280177, "post_id": 44933700, "comment_id": 76843351, "body": "Yes if they are selected."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 8122554, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/939313cb40ac81872af575000467a6f4?s=128&d=identicon&r=PG&f=1", "display_name": "N. Whyter", "link": "https://stackoverflow.com/users/8122554/n-whyter"}, "edited": false, "score": 0, "creation_date": 1499281612, "post_id": 44933922, "comment_id": 76844151, "body": "This looks like just what I need. Would I put this code in the sub produced from double clicking the listbox? How do I call A array so its data can be altered?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 103, "user_id": 8122554, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/939313cb40ac81872af575000467a6f4?s=128&d=identicon&r=PG&f=1", "display_name": "N. Whyter", "link": "https://stackoverflow.com/users/8122554/n-whyter"}, "edited": false, "score": 0, "creation_date": 1499283165, "post_id": 44933922, "comment_id": 76845100, "body": "<i>Where</i> you would put it depends on what you&#39;re trying to do. I can&#39;t answer that for you. I don&#39;t understand your second question. Do you understand variable <i>scope</i> in VBA? If not, please research it and use appropriate scope. Probably you want a public variable in the UserForm module, but again, that depends on what you&#39;re trying to do."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 103, "user_id": 8122554, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/939313cb40ac81872af575000467a6f4?s=128&d=identicon&r=PG&f=1", "display_name": "N. Whyter", "link": "https://stackoverflow.com/users/8122554/n-whyter"}, "edited": false, "score": 0, "creation_date": 1499283240, "post_id": 44933922, "comment_id": 76845135, "body": "If you want to call this code from the ListBox, I would suggest the <code>Change</code> or <code>AfterUpdate</code> event, probably not the <code>Click</code> event."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1499283577, "last_edit_date": 1499283577, "creation_date": 1499280736, "answer_id": 44933922, "question_id": 44933700, "link": "https://stackoverflow.com/questions/44933700/change-array-values-depending-on-selections-in-listbox-on-a-userform/44933922#44933922", "title": "Change array values depending on selections in listbox on a userform", "body": "<p>This is tested in a <code>ListBox_AfterUpdate()</code> event. Get a handle on the <code>ListBox</code> object (assigned to variable <code>lb</code>) then iterate the items in the <code>lb.List</code>, checking if each is selected. If selected, then assign a positional value to the array <code>A</code>.</p>\n\n<p>The array <code>A</code> is declared as a module/user-form scoped variable here, and assigned default/initial values during the form's <code>_Initialize</code> event. Those values are then changed if the user makes a selection(s) in the ListBox.</p>\n\n<pre><code>Option Explicit\nDim A()\nPrivate Sub UserForm_Initialize()\n'Assigns initial values to your array:\nA = Array(25, 50, 75, 100)\n'Assigns the default ListBox items:\nMe.ListBox1.List = Array(\"1\", \"2\", \"3\")\nEnd Sub\nPrivate Sub ListBox1_AfterUpdate()\nDim lb As MSForms.ListBox\nDim i As Long, v As Long\nSet lb = Me.ListBox1 '# Modify as needed\nFor i = 0 To lb.ListCount - 1\n    If lb.Selected(i) Then\n        Select Case lb.List(i)\n            Case \"1\"\n                v = 10\n            Case \"2\"\n                v = 0\n            Case \"3\"\n                v = 1000\n        End Select\n        'confirm prev &amp; new values for array:\n        MsgBox (A(i) &amp; \" will be changed to: \" &amp; v)\n        A(i) = v\n        'Confirm the value in array has changed\n        MsgBox (A(i))\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p>Depending on where/when you initialize the <code>A</code> array, you could modify this and invoke it from the <code>ListBox_Change</code> or <code>ListBox_AfterUpdate</code> event, or call it from another control's event procedure as needed.</p>\n"}], "owner": {"reputation": 103, "user_id": 8122554, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/939313cb40ac81872af575000467a6f4?s=128&d=identicon&r=PG&f=1", "display_name": "N. Whyter", "link": "https://stackoverflow.com/users/8122554/n-whyter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 442, "favorite_count": 0, "accepted_answer_id": 44933922, "answer_count": 1, "score": 0, "last_activity_date": 1499283577, "creation_date": 1499279968, "last_edit_date": 1531164843, "question_id": 44933700, "link": "https://stackoverflow.com/questions/44933700/change-array-values-depending-on-selections-in-listbox-on-a-userform", "title": "Change array values depending on selections in listbox on a userform", "body": "<p>I want to be able to change array values from my sub that runs a userform. How do I go about doing this?</p>\n\n<p>Here is an example of what I have:</p>\n\n<pre><code>A = [25, 50, 75, 100]\nUserForm1.Show\n</code></pre>\n\n<p>UserForm1 contains a listbox with options 1, 2 or 3.<br>\nBy selecting \"1\", \"2,\", \"3\", or multiple combinations of them I want to change the value of A accordingly.</p>\n\n<pre><code>If \"1\" is selected Then\nA(0) = 10\nIf \"2\" is selected Then\nA(1) = 0\nIf \"3\" is selected Then\nA(2) = 1000\n</code></pre>\n\n<p>How would I make this happen? Thanks in advance for any help.</p>\n"}, {"tags": ["excel", "vba", "loops", "nested-loops"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1499280176, "post_id": 44933661, "comment_id": 76843348, "body": "<code>Sheets(&quot;Data&quot;).Range(&quot;a1&quot;).CurrentRegion</code> will select all content beginning at A1  - same as selecting A1 then pressing Ctrl+A.  If that&#39;s more than one column wide then Text to Columns will not run. <code>Sheets(&quot;Data&quot;).Range(&quot;a1&quot;).CurrentRegion.Columns(1)</code> should operate only on the first column."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499280521, "post_id": 44933661, "comment_id": 76843531, "body": "also I&#39;m not sure that you need <code>TextToColumns</code> at all. Why do you need that?"}], "owner": {"reputation": 333, "user_id": 6261674, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/TtLFz.jpg?s=128&g=1", "display_name": "Luke Zhang", "link": "https://stackoverflow.com/users/6261674/luke-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499279827, "creation_date": 1499279827, "question_id": 44933661, "link": "https://stackoverflow.com/questions/44933661/vba-nested-loop-giving-me-error-excel-can-only-convert-one-column-at-a-time", "title": "VBA: Nested loop giving me Error: Excel can only convert one column at a time", "body": "<p>Right now, I have a nested loop to extract stock prices from Google finance's API. \nIt gets stored onto a sheet named 'Data', which after I write the Open and Close as Open~Close to another sheet Spread</p>\n\n<p>I have a nested loop, however, I keep getting the error message that excel can only convert one column at a time. I've tried doing a number of things, but I keep getting the error message.</p>\n\n<pre><code>Sub GetData()\nDim DataSheet As Worksheet\nDim EndDate As Date\nDim StartDate As Date\nDim Symbol As String\nDim qurl As String\nDim nQuery As Name\nDim LastRow As Integer\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\nApplication.Calculation = xlCalculationManual\n\nSheets(\"Data\").Cells.Clear\n\n\nSet DataSheet = ActiveSheet\n\nStartDate = DataSheet.Range(\"startDate\").Value\nEndDate = DataSheet.Range(\"endDate\").Value\nSheets(\"Data\").Range(\"a1\").CurrentRegion.ClearContents\n\n'my ops here'\nSheets(\"Spread\").Cells.Clear\n\nDim Last As Integer\nLast = DataSheet.Range(\"K6000\").End(xlUp).Row\nDim j As Integer\nFor j = 2 To Last\n        If j &lt; Last Then\n        Symbol = DataSheet.Range(\"K\" &amp; j).Value\n'On my Sheet, I have a list of symbols down Column K'\n'********'\n\n\nqurl = \"http://finance.google.com/finance/historical?q=\" &amp; Symbol\nqurl = qurl &amp; \"&amp;startdate=\" &amp; MonthName(Month(StartDate), True) &amp; _\n       \"+\" &amp; Day(StartDate) &amp; \"+\" &amp; Year(StartDate) &amp; _\n       \"&amp;enddate=\" &amp; MonthName(Month(EndDate), True) &amp; _\n       \"+\" &amp; Day(EndDate) &amp; \"+\" &amp; Year(EndDate) &amp; \"&amp;output=csv\"\n\nQueryQuote:\nWith Sheets(\"Data\").QueryTables.Add(Connection:=\"URL;\" &amp; qurl, Destination:=Sheets(\"Data\").Range(\"a1\"))\n    .BackgroundQuery = True\n    .TablesOnlyFromHTML = False\n    .Refresh BackgroundQuery:=False\n    .SaveData = True\nEnd With\n\n\n'Below is where I think the error start. I'm not sure if the loop get iterated here before my nested loop is done..'\nSheets(\"Data\").Range(\"a1\").CurrentRegion.TextToColumns Destination:=Sheets(\"Data\").Range(\"a1\"), DataType:=xlDelimited, _\n                                                       TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n                                                       Semicolon:=False, Comma:=True, Space:=False, other:=False\n\nSheets(\"Data\").Columns(\"A:H\").ColumnWidth = 15\n\nLastRow = Sheets(\"Data\").UsedRange.Row - 2 + Sheets(\"Data\").UsedRange.Rows.Count\n\n\n\n\nSheets(\"Data\").Sort.SortFields.Add Key:=Range(\"A2:A\" &amp; LastRow), _\n                                   SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n\nWith Sheets(\"Data\").Sort\n    .SetRange Range(\"A1:G\" &amp; LastRow)\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\n    .SortFields.Clear\nEnd With\n\n'My ops here'\nSheets(\"Spread\").Cells(1, j) = Symbol\nDim k As Integer\nk = Sheets(\"Data\").Range(\"A1\", Sheets(\"Data\").Range(\"A1\").End(xlDown)).Rows.Count\n\n\nDim i As Integer\nFor i = 2 To k - 1\nIf i &lt; k - 1 Then\nSheets(\"Spread\").Cells(i, j) = Sheets(\"Data\").Cells(i, 2) &amp; \"~\" &amp; Sheets(\"Data\").Cells(i, 5)\nEnd If\nNext i\n\n\nEnd If\nNext j\n'Here is where I have a nested loop'\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499282377, "post_id": 44933368, "comment_id": 76844621, "body": "<i>&quot;when I write this code to lock ... I get the error - Delete method or range class failed.&quot;</i> How is that possible? you&#39;re not trying to delete anything in <code>Worksheet_SelectionChange</code>. Where exactly do you get the error? which routine, which line?"}, {"owner": {"reputation": 135, "user_id": 7823968, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/3b7e03a0d338515beed6369f1e176f84?s=128&d=identicon&r=PG&f=1", "display_name": "Hema", "link": "https://stackoverflow.com/users/7823968/hema"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499285119, "post_id": 44933368, "comment_id": 76846257, "body": "&quot;ClearExistingRows&quot; sub uses delete."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499289243, "post_id": 44933368, "comment_id": 76848383, "body": "So where is the problem? you lock some cells and protect the worksheet, no surprise that you cannot delete any range containing at least one protected cell."}], "owner": {"reputation": 135, "user_id": 7823968, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/3b7e03a0d338515beed6369f1e176f84?s=128&d=identicon&r=PG&f=1", "display_name": "Hema", "link": "https://stackoverflow.com/users/7823968/hema"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 804, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499278736, "creation_date": 1499278736, "question_id": 44933368, "link": "https://stackoverflow.com/questions/44933368/delete-method-of-range-class-failed-error", "title": "Delete method of range class failed - Error", "body": "<p>I have this code to retrieve rows from the database to the excel spreadsheet:</p>\n\n<pre><code>Public Sub Button1_Click()\n\nActiveSheet.Unprotect  ' This will unprotect the whole sheet\n\nDim sQry As String\nDim iRows As Integer\nDim iCols As Integer\nDim SQL As String\n\n\n\nOn Error GoTo ErrHandler\n\n\n\n'Clear worksheet\nCall ClearExistingRows(4)\n\n'Create ADODB Recordset for retrieved data\n Call DBConnection.OpenDBConnection\n\n'Create Recordset\nDim rsMY_Resources As ADODB.Recordset\nSet rsMY_Resources = New ADODB.Recordset\n\nSQL = \"SELECT EmpID, EName, [Grouping], CCNum, CCName, ResTypeNum, ResName, Status from Employee_FTE Order by Status\"\n\n'Query the database\n\nrsMY_Resources.Open SQL, DBConnection.oConn, adOpenStatic, adLockReadOnly\nIf rsMY_Resources.EOF = True Then\n    MsgBox (\"No record found in database\")\n    Exit Sub\nEnd If\n\n'Fill excel active sheet, starting from row# 3\niRows = 3\nFor iCols = 0 To rsMY_Resources.Fields.Count - 1\n    ActiveSheet.Cells(iRows, iCols + 1).Value = rsMY_Resources.Fields(iCols).Name\nNext\nActiveSheet.Range(ActiveSheet.Cells(iRows, 1), ActiveSheet.Cells(iRows, rsMY_Resources.Fields.Count)).Font.Bold = True\n\niRows = iRows + 1\nActiveSheet.Range(\"A\" + CStr(iRows)).CopyFromRecordset rsMY_Resources\n\niRows = rsMY_Resources.RecordCount\n\n'Clean up\nrsMY_Resources.Close:\nSet rsMY_Resources = Nothing\n\nCall DBConnection.CloseDBConnection\n\n\nMsgBox (CStr(iRows) + \" records have been retrieved from the database!\")\n\nColumns(\"B:H\").Select\nSelection.Locked = False\nActiveSheet.Protect\n\nExit Sub\n\nErrHandler:\nMsgBox (Error)\n\nEnd Sub\n\n\nPublic Sub ClearExistingRows(lRowStart As Long)\nDim lLastRow As Long\nDim iLastCol As Integer\n\nIf (Not (Cells.Find(\"*\", Range(\"A1\"), xlFormulas, , xlByRows, xlPrevious) Is Nothing)) Then\n    lLastRow = Cells.Find(\"*\", Range(\"A1\"), xlFormulas, , xlByRows, xlPrevious).Row ' Find the last row with data\n\n    If (lLastRow &gt;= lRowStart) Then\n        iLastCol = Cells.Find(\"*\", Range(\"A1\"), xlFormulas, , xlByColumns, xlPrevious).Column ' Find the last column with data\n        Range(Cells(lRowStart, 1), Cells(lLastRow, iLastCol)).Select\n        Selection.EntireRow.Delete\n    End If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>However, when I write this code to lock the entire row if the H column has value \"InActive\" then I get the error - Delete method or range class failed.</p>\n\n<pre><code>    Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n\n    For Each cell In Range(\"A4:H500\")\n\n    If cell.Value = \"InActive\" Then\n\n    ActiveSheet.Unprotect\n\n    cell.EntireRow.Locked = True\n\n    ActiveSheet.Protect\n\n    End If\n\n    Next cell\n\n\n    End Sub\n</code></pre>\n\n<p>Please let me know how to fix this error.</p>\n\n<p>Thanks,\nHema</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1499281006, "post_id": 44933292, "comment_id": 76843826, "body": "<code>Criteria1=&quot;=00*&quot;</code>  -----&gt;  <code>Criteria1:=&quot;=00*&quot;</code> (dont forget the <i>column</i> after parameters&#39; names)."}, {"owner": {"reputation": 149, "user_id": 8260869, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5896f962504315fcbb5945e08d3713b9?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/8260869/j-doe"}, "edited": false, "score": 0, "creation_date": 1499282376, "post_id": 44933292, "comment_id": 76844620, "body": "Thanks for pointing that out! It was a typo and in the real program, it has the colon there."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499282589, "post_id": 44933292, "comment_id": 76844771, "body": "What are you selecting when you run the macro? And why use <code>Selection</code> at all !? Try running it on an explicit, fully qualified range."}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 8260869, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5896f962504315fcbb5945e08d3713b9?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/8260869/j-doe"}, "edited": false, "score": 0, "creation_date": 1499365352, "post_id": 44933521, "comment_id": 76888120, "body": "Thanks! I was new to Excel Macro, and did not know the data had different types. I thought they were all strings. I used this as a hint and I managed to get it to work. Appreciate it everyone for help!"}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 0, "last_activity_date": 1499279319, "creation_date": 1499279319, "answer_id": 44933521, "question_id": 44933292, "link": "https://stackoverflow.com/questions/44933292/vba-autofilter-with-symbol-not-working/44933521#44933521", "title": "VBA AutoFilter with symbol (*) Not Working", "body": "<p>Excel treats time values as decimal numbers. One approach would be is to insert a helper column called \"Hour\" and put the following formula in D2</p>\n\n<pre><code>=HOUR(C2)\n</code></pre>\n\n<p>and copy it down.</p>\n\n<p>Now filter the data like below...</p>\n\n<pre><code>Range(\"$A$1:$D1\").Autofilter Field:=4, Criteria1:=\"=0\"\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 8260869, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5896f962504315fcbb5945e08d3713b9?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/8260869/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "accepted_answer_id": 44933521, "answer_count": 1, "score": 0, "last_activity_date": 1499282390, "creation_date": 1499278485, "last_edit_date": 1499282390, "question_id": 44933292, "link": "https://stackoverflow.com/questions/44933292/vba-autofilter-with-symbol-not-working", "title": "VBA AutoFilter with symbol (*) Not Working", "body": "<p>I am trying to filter excel data using AutoFilter, but somehow it is not working. \nThe data I want to filter represent time and are in format of 00:00 through 23:59.\nSpecifically, I am trying to filter by the hour, so like \"00\" through \"23\", or \"00:\" through \"23:\", whichever works. \nHowever, it is not working and none of them gets filtered. </p>\n\n<p>Assuming there is a table like </p>\n\n<p>|ID|Date| time | <br>\n| 0 | 7/5 | 00:00| <br>\n| 1 | 7/5 | 00:20| <br>\n| 2 | 7/5 | 00:35| <br>\n| 3 | 7/5 | 00:47| <br>\n| 4 | 7/5 | 00:58| <br>\n| 5 | 7/5 | 01:03| <br>\n| 6 | 7/5 | 01:15| <br>\n| 7 | 7/5 | 01:27| <br>\n| 8 | 7/5 | 01:48| <br>\n<br>\nI tested the following macro:</p>\n\n<pre><code>Selection.Autofilter Field:=3, Criteria1:=\"=00*\"\n</code></pre>\n\n<p>hoping that I could get the top 5 rows of the data as their times begin with \"00\". I looked for information on how to set \"start with\" in AutoFilter, and I found that star (*) can be used. However, this does not work and none of the rows gets filtered.\nInterestingly, if I tried the following:</p>\n\n<pre><code>Selection.Autofilter Field:=3, Criteria1:=\"00:20\"\n</code></pre>\n\n<p>it worked fine and it filtered the second row only where the time is \"00:20\".</p>\n\n<p>Why is my first macro with * not working? I tried many different ways to no avail. Can someone tell me why this is not working?</p>\n"}, {"tags": ["vba", "excel", "runtime-error"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499279991, "post_id": 44933249, "comment_id": 76843246, "body": "Maybe because the loop reached an empty file? Don&#39;t empty your string <code>whole_file</code> before the error line, keep it so you can see if it&#39;s empty in the debugger."}, {"owner": {"reputation": 489, "user_id": 7618270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e3dafb06431451eaec971860c401150?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksandar Misich", "link": "https://stackoverflow.com/users/7618270/aleksandar-misich"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499280672, "post_id": 44933249, "comment_id": 76843616, "body": "Try using an <code>if</code> to check the value of the <code>UBound</code> or <code>Debug.Print</code> your <code>file_path</code> and <code>UBound</code>.  There might be a problem with your file, or as @A.S.H stated, you could just straight up be reaching an empty file."}], "owner": {"reputation": 64, "user_id": 5517852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b984v.jpg?s=128&g=1", "display_name": "Sombrero22", "link": "https://stackoverflow.com/users/5517852/sombrero22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 224, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499278318, "creation_date": 1499278318, "question_id": 44933249, "link": "https://stackoverflow.com/questions/44933249/error-subscript-out-of-range-on-vba-function", "title": "Error &quot;Subscript out of range.&quot; on VBA Function", "body": "<p>My question is, what could cause this error (Error \"Subscript out of range.\")? I'm running a function in VBA that reads data from a specific CSV that gets updated every minute. My function is: </p>\n\n<pre><code>Function CSVtoDataArray(CSVpath As String, fileName As String) As String()\n\nDim fnum As Integer\nDim whole_file As String\nDim lines As Variant\nDim one_line As Variant\nDim num_rows As Long\nDim the_array() As String\nDim file_path As String\n\nwhole_file = \"\"\n\nfile_path = CSVpath &amp; fileName\n' Load the file.\nfnum = FreeFile\nOpen file_path For Input As fnum\nwhole_file = Input$(LOF(fnum), #fnum)\nClose fnum\n\n' Break the file into lines.'\nlines = Split(whole_file, vbCrLf)\nwhole_file = \"\"\nnum_rows = UBound(lines)\nthe_array = Split(lines(num_rows - 1), \",\")\n\nCSVtoDataArray = the_array()\n\nEnd Function\n</code></pre>\n\n<p>The error pops a while after my script started running, and the debug marks the error to reach these lines:</p>\n\n<pre><code>num_rows = UBound(lines)\nthe_array = Split(lines(num_rows - 1), \",\")\n</code></pre>\n\n<p>This shows that my String <code>whole_file</code> is empty, giving a value of -1 to <code>num_rows</code>. Why do you think is the problem? And why does this error happens only after a while and not immediately?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 126499, "user_id": 1531124, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/zw18i.png?s=128&g=1", "display_name": "GhostCat", "link": "https://stackoverflow.com/users/1531124/ghostcat"}, "edited": false, "score": 1, "creation_date": 1499279633, "post_id": 44933204, "comment_id": 76843037, "body": "You want to read <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>; and you want to edit your question so that it is human. Focus on your question, instead of complaining 5 times that you dont know what you are doing."}], "answers": [{"comments": [{"owner": {"reputation": 1545, "user_id": 765032, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/0ec4aec46c485a19d24b3f57ac25fbdf?s=128&d=identicon&r=PG", "display_name": "wrlee", "link": "https://stackoverflow.com/users/765032/wrlee"}, "edited": false, "score": 0, "creation_date": 1499288446, "post_id": 44934039, "comment_id": 76848022, "body": "It&#39;d be helpful if you could provide some explanation of your solution and how/why it is resolving the question."}, {"owner": {"reputation": 1, "user_id": 8260832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b9290bacd7c070adbd909d39038774d?s=128&d=identicon&r=PG&f=1", "display_name": "haydini", "link": "https://stackoverflow.com/users/8260832/haydini"}, "edited": false, "score": 0, "creation_date": 1499371341, "post_id": 44934039, "comment_id": 76891178, "body": "I made the changes you suggested and its throwing a Runtime error 1004 Method &#39;Range&quot; of object&#39;_Global failed"}, {"owner": {"reputation": 1, "user_id": 8260832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b9290bacd7c070adbd909d39038774d?s=128&d=identicon&r=PG&f=1", "display_name": "haydini", "link": "https://stackoverflow.com/users/8260832/haydini"}, "edited": false, "score": 0, "creation_date": 1499371414, "post_id": 44934039, "comment_id": 76891219, "body": "Sorry...the error occurs in line...SheetName = Range(&quot;A&quot; &amp; I).Value"}, {"owner": {"reputation": 1, "user_id": 8260832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b9290bacd7c070adbd909d39038774d?s=128&d=identicon&r=PG&f=1", "display_name": "haydini", "link": "https://stackoverflow.com/users/8260832/haydini"}, "edited": false, "score": 0, "creation_date": 1499371791, "post_id": 44934039, "comment_id": 76891406, "body": "Could the fact that the code modules/macros are stored and run from personal.xlsx on another workbook&#39;s raw data?"}, {"owner": {"reputation": 1, "user_id": 8260832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b9290bacd7c070adbd909d39038774d?s=128&d=identicon&r=PG&f=1", "display_name": "haydini", "link": "https://stackoverflow.com/users/8260832/haydini"}, "edited": false, "score": 0, "creation_date": 1499372516, "post_id": 44934039, "comment_id": 76891748, "body": "I apologize...I put the &quot;SheetName = &quot; statement outside the For Next loop.  Now it just throws an error 9 subscript out of range.  But only after I select a certain combination of checkboxes.  Weird"}], "tags": [], "owner": {"reputation": 1, "user_id": 8260178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5023afdd6c32f3b7e18ef95e4e6af78?s=128&d=identicon&r=PG&f=1", "display_name": "Mike McGrath", "link": "https://stackoverflow.com/users/8260178/mike-mcgrath"}, "is_accepted": false, "score": 0, "last_activity_date": 1499289934, "last_edit_date": 1499289934, "creation_date": 1499281138, "answer_id": 44934039, "question_id": 44933204, "link": "https://stackoverflow.com/questions/44933204/excel-vba-type-mismatch-error-13-for-sheetname-reference-from-a-range-on-anoth/44934039#44934039", "title": "Excel VBA type mismatch (error 13) for sheetname reference from a range on another sheet", "body": "<p>Try this:</p>\n\n<pre><code>Public Sub Button_Click()\n Dim I As Integer\n Dim SheetName as String\n\n For I = 1 To Sheets.Count\n SheetName = Range(\"A\" &amp; I).Value\n If Range(\"AZ\" &amp; I).Value = False Or Range(\"AZ\" &amp; I) = Empty Then\n Sheets(SheetName).Visible = False\n Else:\n Sheets(SheetName).Visible = True\n End If\n Next\n End Sub \n</code></pre>\n\n<p>I think the type mismatch is coming from the Sheets(Range(\"A\" &amp; I)).Visible line. The Sheets object requires a string that contains the name of a valid sheet in the workbook. In your case, you are pointing to a range value, not a string. Since the Range value you pointed to contains the name of the sheet, I simply made the SheetName variable for the Sheets object to point to. Since SheetName is a string, it should not throw any 'type mismatch' errors. I hope this helps.</p>\n"}], "owner": {"reputation": 1, "user_id": 8260832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b9290bacd7c070adbd909d39038774d?s=128&d=identicon&r=PG&f=1", "display_name": "haydini", "link": "https://stackoverflow.com/users/8260832/haydini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 758, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1499327929, "creation_date": 1499278183, "last_edit_date": 1531164843, "question_id": 44933204, "link": "https://stackoverflow.com/questions/44933204/excel-vba-type-mismatch-error-13-for-sheetname-reference-from-a-range-on-anoth", "title": "Excel VBA type mismatch (error 13) for sheetname reference from a range on another sheet", "body": "<p>I have <code>Personal.xls</code> VBA code/macros that are designed to reformat any file of a certain structure that the code is run on. One of the tasks is to create a series of filtered tab sheets from a primary data sheet provided in the original file. I then create a new worksheet that creates checkboxes adjacent to a sheetname reference list. </p>\n\n<p>I want to hide or unhide checked the underlying sheets for checked boxes. I created a button that automatically will run a macro when pressed (after checkboxes have been selected) that loops through the sheetnames and sets them visible or not. Being that I'm such a dummy...</p>\n\n<p>I cannot get past syntax for objects and get the loop to perform without an error 13 type mismatch error. Here is the code I'm running and an attached picture of the active sheet that the code is referencing. </p>\n\n<p>NB: D is the column where I'm storing the linked cell data for range A1 to \"the number of sheets in the workbook\".</p>\n\n<pre><code>Public Sub Button_Click()\n Dim I As Integer\n For I = 1 To Sheets.Count\n If Range(\"AZ\" &amp; I).Value = False Or Range(\"AZ\" &amp; I) = Empty Then\n Sheets(Range(\"A\" &amp; I)).Visible = False\n Else:\n Sheets(Range(\"A\" &amp; I)).Visible = True\n End If\n Next\n End Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/qQDdT.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qQDdT.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["javascript", "html", "excel", "vba"], "comments": [{"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 1, "creation_date": 1499282543, "post_id": 44933130, "comment_id": 76844732, "body": "&quot;The information seems to be stored inside a javascript file being accessed by the HTML&quot; ... well that will need a little bit more description for this to be a good question. It&#39;s possible you can log in and then use <code>WinHttp.WinHttpRequest</code> to simply download the file. Alternatively, talk to your IT administrators and see if they can point you in the right direction for automating this data retrieval. Do you own the information? Is it in a database? If so this should be easy. If this isn&#39;t a webpage you own you should look at using their API, which may cost money, but also may be a simple url"}], "answers": [{"tags": [], "owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "is_accepted": false, "score": 0, "last_activity_date": 1499288192, "creation_date": 1499288192, "answer_id": 44935849, "question_id": 44933130, "link": "https://stackoverflow.com/questions/44933130/how-to-extract-data-from-js-array-in-an-html-file-to-vba/44935849#44935849", "title": "How to extract data from JS array in an html file to VBA", "body": "<p>If it a static value defined in the script file , you can use XMLHTTP60 to get the responseText of the script file.</p>\n\n<p>Such as :</p>\n\n<p><code>var arr = [\"hello\", \"world\"];</code></p>\n\n<p>Let's say you want \"world\"</p>\n\n<p>Then load up the script in a ScriptControl object, and evaluate it:</p>\n\n<pre><code>Dim script As IHTMLScriptElement\nSet script = doc.getElementById(\"myScript\") 'may need another way to identify\n\nDim sControl As ScriptControl 'needs reference to Miscrosoft Script Control 1.0\nSet sControl = New ScriptControl\nsControl.Language = \"JScript\"\n\nDim xhr As MSXML2.XMLHTTP60\nSet xhr = New MSXML2.XMLHTTP60\nWith xhr\n     .Open \"GET\", URL3.Path &amp; \"/\" &amp; script.src, False 'define full path to script file properly \n     'if necessary change above path to full script src URL\n     .send\n     Dim jsText As String\n     jsText = .responseText\nEnd With\nsControl.AddCode jsText 'adds the contents of the script file to ScriptControl object\n\nDim v As Variant\nv = sControl.Eval(\"arr[1]\")\n\nMsgBox v\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8260784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85049ed626d8de10446e6ca309867078?s=128&d=identicon&r=PG&f=1", "display_name": "Rich93", "link": "https://stackoverflow.com/users/8260784/rich93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 288, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499288192, "creation_date": 1499277873, "question_id": 44933130, "link": "https://stackoverflow.com/questions/44933130/how-to-extract-data-from-js-array-in-an-html-file-to-vba", "title": "How to extract data from JS array in an html file to VBA", "body": "<p>I'm trying to automate retrieval of information from an online source at my new internship. I've managed to create code that manages to open up the password-protected site, and navigate two additional pages to get to the page I want. However, this page has information tabulated that I am having trouble extracting. The information seems o be stored inside a javascript file being accessed by the HTML. Is there a way to get this info and put it in an excel worksheet?</p>\n\n<p>Here is my code so far...Unfortunately, I can't display the URL, as I am not sure if my company will allow it.</p>\n\n<pre><code>            Sub AutomateIE()\n\n            Dim URL As String\n            Dim URL2 As String\n            Dim IE As Object\n            Dim objPage As Object\n\n            Set IE = CreateObject(\"InternetExplorer.Application\")\n            IE.Visible = True \n\n            URL = \"URL\" \n            URL2 = \"URL2\" \n            URL3 = \"URL3\"\n            IE.navigate URL\n            Do While IE.ReadyState &lt; 4: \n            DoEvents: Loop\n            Do Until IE.ReadyState = 4:\n            DoEvents: Loop\n\n            Set objPage = IE.document\n            objPage.getelementbyid(\"ucLogin_txtLogonID\").Value = \"Employee name\" \n            objPage.getelementbyid(\"ucLogin_txtLogonPassword\").Value = \"Employee password\"\n            Application.SendKeys \"{Return}\", True '\n            Application.Wait (Now + TimeValue(\"0:00:05\")) \n            IE.navigate URL2\n            Application.Wait (Now + TimeValue(\"0:00:05\"))\n            IE.navigate URL3 \n\n            End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 324, "user_id": 7492587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb43623146786946865dbfd262031d2a?s=128&d=identicon&r=PG&f=1", "display_name": "D. R.", "link": "https://stackoverflow.com/users/7492587/d-r"}, "edited": false, "score": 2, "creation_date": 1499277536, "post_id": 44933002, "comment_id": 76841896, "body": "Can you use the same INDEX() function, but with the column_number changed?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 324, "user_id": 7492587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb43623146786946865dbfd262031d2a?s=128&d=identicon&r=PG&f=1", "display_name": "D. R.", "link": "https://stackoverflow.com/users/7492587/d-r"}, "edited": false, "score": 0, "creation_date": 1499278289, "post_id": 44933002, "comment_id": 76842334, "body": "@D.R. I think he wants all cells to the right (based on the example having 6 columns and the output are rows 4-6), which would need a bit more code than that, but that&#39;s definitely a simple and great solution for the written question/title."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1499278397, "post_id": 44933002, "comment_id": 76842395, "body": "@Daniel_Coutinho, do you have a fixed number of columns, or how does the data sit?  Unsure if you want a dynamic range to work with, or if you can deal with with a fixed range of 6 columns, like the example."}], "answers": [{"tags": [], "owner": {"reputation": 582, "user_id": 7041246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6721154f2b19b914c7ee561af1db00d?s=128&d=identicon&r=PG&f=1", "display_name": "maxhob17", "link": "https://stackoverflow.com/users/7041246/maxhob17"}, "is_accepted": false, "score": 0, "last_activity_date": 1518615586, "last_edit_date": 1518615586, "creation_date": 1499282441, "answer_id": 44934392, "question_id": 44933002, "link": "https://stackoverflow.com/questions/44933002/excel-how-to-create-a-formula-to-return-a-cell-to-the-right-of-the-result-of-a/44934392#44934392", "title": "Excel - How to create a formula to return a cell to the right of the result of another formula", "body": "<p>I think you'll want an Array Formula for this. Instead of the match use a SMALL function to get the item you want, something like this:</p>\n\n<pre><code>={INDEX('Financials Cashflow Year'!$C30:$M30,1,SMALL(IF('Financials Cashflow Year'!$C30:$M30&gt;0,COLUMN('Financials Cashflow Year'!$C30:$M30)),2)-2)}\n</code></pre>\n\n<p>The IF function gets an array of column numbers where the row's value is above zero.</p>\n\n<p>Then the 2 parameter of the Small function, will bring back the value of the cell in the second most left columns whose value isn't zero.</p>\n\n<p>I.e. in your example above it would bring back the 3, similarly if you changed the parameter to 1 it would bring back the 4.</p>\n\n<p>The If statement gets the column numbers for the values in the index above zero.</p>\n\n<p><strong>Note</strong>: Hit the combination Ctrl + Shfit + Enter to submit rather than just enter\n<strong>Note2</strong>: I noticed you are working across a row so I think you need the \",1,\" before the SMALL</p>\n"}, {"tags": [], "owner": {"reputation": 489, "user_id": 7618270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e3dafb06431451eaec971860c401150?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksandar Misich", "link": "https://stackoverflow.com/users/7618270/aleksandar-misich"}, "is_accepted": false, "score": 0, "last_activity_date": 1499283021, "creation_date": 1499283021, "answer_id": 44934531, "question_id": 44933002, "link": "https://stackoverflow.com/questions/44933002/excel-how-to-create-a-formula-to-return-a-cell-to-the-right-of-the-result-of-a/44934531#44934531", "title": "Excel - How to create a formula to return a cell to the right of the result of another formula", "body": "<pre><code>=INDEX(C30:M30,MATCH(TRUE,INDEX(C30:M30&lt;&gt;0,),0)+1)\n</code></pre>\n\n<p>Would give you the value of the cell one to the right of the first formula, but since it looks like you're looking for something more dynamic, this wouldn't work out incredibly well, for the cell two to the right of the first formula, you'd need this:</p>\n\n<pre><code>=INDEX(C30:M30,MATCH(TRUE,INDEX(C30:M30&lt;&gt;0,),0)+2)\n</code></pre>\n\n<p>Your best bet for grabbing out all cells to the right of the shown formula would be either transposing and filtering or using VBA, example for VBA:</p>\n\n<pre><code>Sub toRightOfZeros()\n\n    Dim rng, cell As Range\n    Dim startCellCol, destCellLocX As Integer\n    Dim ValsArr() As String\n    Dim wb As Workbook\n    Dim foundNotZero As Boolean\n\n    Set wb = ThisWorkbook\n    destCellLocX = 1\n    foundNotZero = False\n\n    With wb.Sheets(\"Sheet1\")\n        Set rng = .Range(.Cells(30, 3), .Cells(30, 13))\n    End With\n\n    For Each cell In rng\n        If foundNotZero = False Then\n            If Not cell.Value = 0 Then\n                foundNotZero = True\n                startCellCol = cell.Column\n                Exit For\n            End If\n        End If\n    Next\n\n    With wb.Sheets(\"Sheet1\")\n        Set rng = .Range(.Cells(30, startCellCol), .Cells(30, 13))\n    End With\n\n    For Each cell In rng\n        With wb.Sheets(\"Sheet2\")\n            .Cells(1, destCellLocX).Value = cell.Value\n        End With\n        destCellLocX = destCellLocX + 1\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Input(In C30:M30): <code>0 0 0 0 365 788 940 239 12 0 99</code></p>\n\n<p>Output(On Sheet 2): <code>365 788 940 239 12 0 99</code></p>\n"}], "owner": {"reputation": 11, "user_id": 8260815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a78b471a404d02b0ede11913664d7b76?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Coutinho", "link": "https://stackoverflow.com/users/8260815/daniel-coutinho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1518615586, "creation_date": 1499277384, "last_edit_date": 1499277898, "question_id": 44933002, "link": "https://stackoverflow.com/questions/44933002/excel-how-to-create-a-formula-to-return-a-cell-to-the-right-of-the-result-of-a", "title": "Excel - How to create a formula to return a cell to the right of the result of another formula", "body": "<p>Basically, I have this formula in a cell to return the very first non 0 value in a row: </p>\n\n<p><code>=INDEX('Financials Cashflow Year'!C30:M30,MATCH(TRUE,INDEX('Financials Cashflow Year'!C30:M30&lt;&gt;0,),0))</code></p>\n\n<p>I would like a formula to return the value of the cell on the right of the one picked up by this very first formula. </p>\n\n<p>Say we have sheet 1 first row:</p>\n\n<pre><code>0 0 0 4 3 2\n</code></pre>\n\n<p>Sheet 2 I would like to see with the formulas. Something scalable.</p>\n\n<pre><code>4 3 2\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 6353684, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b901d399edab557070b38e91abf0bc0f?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Bischoff", "link": "https://stackoverflow.com/users/6353684/jacob-bischoff"}, "edited": false, "score": 0, "creation_date": 1499277813, "post_id": 44932887, "comment_id": 76842081, "body": "I am actually trying to use the <code>.Chars</code> and <code>.Insert</code> methods along with the <code>.Length</code> property to go through a string and add spaces in certain positions given a set of criteria. However, the code is a little long so I decided to use the code from MSDN because was simple and was theoretically supposed to work. Are there ways to read characters from a string and modify a string in VBA?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1499277993, "post_id": 44932887, "comment_id": 76842171, "body": "The code on MSDN is for another language, it won&#39;t work in VBA. There&#39;s no <code>.Chars</code>, <code>.Insert</code> or <code>.Length</code> member for a string in VBA. You use functions from the <code>VBA.Strings</code> module instead, which you can browse using the <i>Object Browser</i> (F2)."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 3, "last_activity_date": 1499277474, "last_edit_date": 1499277474, "creation_date": 1499276932, "answer_id": 44932887, "question_id": 44932809, "link": "https://stackoverflow.com/questions/44932809/string-modifiers-and-properties-do-not-work/44932887#44932887", "title": "string modifiers and properties do not work", "body": "<blockquote>\n<pre><code>modified = original.Insert(3, \" \")\n</code></pre>\n</blockquote>\n\n<p>You're thinking in VB.NET, but writing VBA. Strings (or any primitive or UDT type) don't have members in VBA. Not your fault, finding official VBA documentation is getting harder every day, with every \"VBA\" search yielding results for VB.NET.</p>\n\n<p>That original code is clearly VB.NET.</p>\n\n<p>If you mean to concatenate 3 spaces in front of <code>original</code>, then what you want to do is this:</p>\n\n<pre><code>modified = String(3, \" \") &amp; original\n</code></pre>\n\n<p>If you mean to get <em>a new string in which a specified string is inserted at a specified index position in this instance</em> (<a href=\"https://msdn.microsoft.com/en-us/library/system.string.insert(v=vs.110).aspx\" rel=\"nofollow noreferrer\">MSDN</a>), then you want to do this (thanks @A.S.H!):</p>\n\n<pre><code>modified = Left$(original, 3) &amp; \" \" &amp; Right$(original, Len(original) - 3)\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 6353684, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b901d399edab557070b38e91abf0bc0f?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Bischoff", "link": "https://stackoverflow.com/users/6353684/jacob-bischoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 44932887, "answer_count": 1, "score": 1, "last_activity_date": 1499277849, "creation_date": 1499276608, "question_id": 44932809, "link": "https://stackoverflow.com/questions/44932809/string-modifiers-and-properties-do-not-work", "title": "string modifiers and properties do not work", "body": "<p>I am trying to use <code>Methods</code> and <code>Properties</code> of the <code>String Class</code> to modify a string, but I keep getting an Invalid qualifier compile error. I even copied the following code* directly from the MSDN website and it throws the same error.</p>\n\n<pre><code>Public Sub Main()\n    Dim original As String\n    original = \"aaabbb\"\n    Dim modified As String\n    modified = original.Insert(3, \" \")\nEnd Sub\n\n'This is the original code, but I had to change it slightly because the word-vba\n'programming environment didn't like the syntax and highlighted everything red.\n\n'Public Sub Main()\n   'Dim original As String = \"aaabbb\"\n   'Console.WriteLine(\"The original string: '{0}'\", original)\n   'Dim modified As String = original.Insert(3, \" \")\n   'Console.WriteLine(\"The modified string: '{0}'\", modified)\n'End Sub\n</code></pre>\n\n<p>Does word-vba not support string class modifiers and properties, am I not initializing the string correctly, or is there some other problem?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1499276950, "post_id": 44932718, "comment_id": 76841589, "body": "$I$8 to $I8, and if you just copy it, the reference will be dynamic and become I9."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1499276993, "post_id": 44932718, "comment_id": 76841616, "body": "@Cyril - that will work if you copy it <i>down the row</i> - but user needs across the column."}, {"owner": {"reputation": 1, "user_id": 8260642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-W654B25ZCeM/AAAAAAAAAAI/AAAAAAAAABc/6IbgR7HWDJs/photo.jpg?sz=128", "display_name": "Terzenta L", "link": "https://stackoverflow.com/users/8260642/terzenta-l"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1499277205, "post_id": 44932718, "comment_id": 76841723, "body": "@Scott Holtzman is correct. Copying it across the column it just stays I8."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1499277372, "post_id": 44932718, "comment_id": 76841811, "body": "@ScottHoltzman, Doh... i took the wrong fixed section off.  &quot;$&quot; is used to fix the item, so if you want the COLUMN dynamic, you will use I$8 (given the example).  If you want BOTH to be dynamic, you have I8; currently, they are both fixed, $I$8."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1499353113, "post_id": 44932718, "comment_id": 76880117, "body": "@Cyril - user needs <i>row to move down 1</i> when formula is <i>copied 1 column over</i>"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1499357990, "post_id": 44932718, "comment_id": 76883672, "body": "@ScottHoltzman I guess I&#39;m not understanding that from the question.  Maybe an image might help?  What I think I&#39;m reading is that there is a macro which has a fixed reference to row 8 in column 9, aka column &quot;I&quot;, to determine if the activecell should have an X or not.  If their is a column added in the active region, the fixed reference needs to be row 9 in column 10.  If this is the case, then the fixed reference cell can be somethign such as Cells(i,i+1), where i is a column count or sorts (hell, use find to search for the header and make i the column that is in, making is Cells(i-1,i))."}, {"owner": {"reputation": 1, "user_id": 8260642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-W654B25ZCeM/AAAAAAAAAAI/AAAAAAAAABc/6IbgR7HWDJs/photo.jpg?sz=128", "display_name": "Terzenta L", "link": "https://stackoverflow.com/users/8260642/terzenta-l"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1499451145, "post_id": 44932718, "comment_id": 76929531, "body": "@Cyril I&#39;m not sure how I can explain it different. What I need is a simple way to take the exact formula I have above, and paste it into a new column. Let&#39;s say that right now that formula is in column A. I want column B to be looking at cell I9 instead of I8. So each column I move the formula over needs to look at the next row down on the RTM sheet."}], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1499453846, "creation_date": 1499453846, "answer_id": 44977910, "question_id": 44932718, "link": "https://stackoverflow.com/questions/44932718/how-can-i-make-a-macro-to-copy-an-entire-column-but-change-a-single-row-number/44977910#44977910", "title": "How can I make a macro to copy an entire column but change a single row number?", "body": "<p>Thanks for re-affirming my understanding.  I'll give this a shot with providing some code, based on your string:</p>\n\n<pre><code>Dim LC as Long, i as Integer\n\nColumns(9).Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nCells(1,10).Value=\"\" 'Add your header\n\nLC = Cells(1, Columns.Count).End(xlToLeft).Column\ni = LC-1 'See description below code\n\nRange(\"J2:J100\").Formula=\"=IF((CommaSeparatedListContains(RTM!$I$\" &amp; i &amp; \",ROW()-2))=TRUE,\"\"X\"\",\"\"\"\")\"\n</code></pre>\n\n<p>For i, you want to ensure that you substract the correct number... given the example of I8 being the cell you want to reference, and assuming that Column I is the last column of your sheet, then the 9th column, 8th row, is the cell you want to reference.  So, the variable i = last column - 1, in this example.</p>\n\n<p>In this case, the column is always added to the right of column I, the assumed last column in the sheet.</p>\n\n<p>One other assumption is that you're using rows 2 to 100 for the range that you have the formula... So, Range(\"J2:J100\").Formula will be affected by your actual range for the formula.</p>\n"}], "owner": {"reputation": 1, "user_id": 8260642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-W654B25ZCeM/AAAAAAAAAAI/AAAAAAAAABc/6IbgR7HWDJs/photo.jpg?sz=128", "display_name": "Terzenta L", "link": "https://stackoverflow.com/users/8260642/terzenta-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1499453846, "creation_date": 1499276287, "last_edit_date": 1531161705, "question_id": 44932718, "link": "https://stackoverflow.com/questions/44932718/how-can-i-make-a-macro-to-copy-an-entire-column-but-change-a-single-row-number", "title": "How can I make a macro to copy an entire column but change a single row number?", "body": "<p>I have inherited a poorly designed workbook, and I am trying to make it work a bit better without starting from scratch.\nThe last problem I have is that I have a formula in a column that I need to copy to the next column, but change the row number referenced in the formula. The easiest thing to do would be to change the format of the workbook but that will cause an uprising by the users.</p>\n\n<pre><code>=IF((CommaSeparatedListContains(RTM!$I$8,ROW()-2))=TRUE,\"X\",\"\")\n</code></pre>\n\n<p>The code above is what I need to copy, but I need to change it so that it looks at I9 instead of I8. RTM is the name of the sheet that the cell is on, and CommaSeparatedListContains is a macro that will return true if the referenced cell has a value (ROW()-2) in the comma delimited list.\nBasically I need a macro to add a new column to the worksheet that works like the others, so that the end users who don't know how to use Excel can just click a button and add a column.\nFor example, that code is in cell A1, and I need to move it to B1 keeping the I the same but increment the row number. If I remove Both $ signs it would change it to J8, if I have $I8 it stays I8, and if I have $I$8 it stays I8.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2243, "user_id": 3389900, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/73283dbb19b8c2ffe975ef7d63fac6ab?s=128&d=identicon&r=PG&f=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/3389900/trevor"}, "edited": false, "score": 0, "creation_date": 1499276102, "post_id": 44932610, "comment_id": 76841109, "body": "You can <code>for each</code> through all the controls instead. <a href=\"https://stackoverflow.com/questions/3344649/how-to-loop-through-all-controls-in-a-form-including-controls-in-a-subform-ac\" title=\"how to loop through all controls in a form including controls in a subform ac\">stackoverflow.com/questions/3344649/&hellip;</a> should give you an idea how to do it."}, {"owner": {"reputation": 11, "user_id": 8260340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9530cb51e2fd3a1864bc67ced9441933?s=128&d=identicon&r=PG&f=1", "display_name": "finnjitsu", "link": "https://stackoverflow.com/users/8260340/finnjitsu"}, "reply_to_user": {"reputation": 2243, "user_id": 3389900, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/73283dbb19b8c2ffe975ef7d63fac6ab?s=128&d=identicon&r=PG&f=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/3389900/trevor"}, "edited": false, "score": 0, "creation_date": 1499281921, "post_id": 44932610, "comment_id": 76844335, "body": "Thanks @TrevorD, I&#39;ll check it out."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8260340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9530cb51e2fd3a1864bc67ced9441933?s=128&d=identicon&r=PG&f=1", "display_name": "finnjitsu", "link": "https://stackoverflow.com/users/8260340/finnjitsu"}, "is_accepted": true, "score": 0, "last_activity_date": 1499463947, "creation_date": 1499463947, "answer_id": 44980097, "question_id": 44932610, "link": "https://stackoverflow.com/questions/44932610/copying-textbox-values-between-excel-userforms-using-for-next-and-if-then-statem/44980097#44980097", "title": "Copying textbox values between excel userforms using FOR/NEXT and IF/THEN statements", "body": "<p>I looked at using the <code>For Each</code> for this problem but I couldn't figure out how to make it work with the number of <code>textboxes</code> I have in my <code>userform</code>.</p>\n\n<p>After messing more with my code I realized that the error was not in my code but in the contents of the <code>textboxes</code>. In other words, it was a dumb mistake on my part and the code was working just fine. So if someone comes across this in the future, this code is a way to <code>loop</code> through specific <code>textboxes</code> on multiple <code>userforms</code> with nested <code>If Then</code> statements. I'm sure there are better ways to write this code but in the end it worked for me.</p>\n"}], "owner": {"reputation": 11, "user_id": 8260340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9530cb51e2fd3a1864bc67ced9441933?s=128&d=identicon&r=PG&f=1", "display_name": "finnjitsu", "link": "https://stackoverflow.com/users/8260340/finnjitsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 44980097, "answer_count": 1, "score": 1, "last_activity_date": 1499463947, "creation_date": 1499275886, "question_id": 44932610, "link": "https://stackoverflow.com/questions/44932610/copying-textbox-values-between-excel-userforms-using-for-next-and-if-then-statem", "title": "Copying textbox values between excel userforms using FOR/NEXT and IF/THEN statements", "body": "<p>Disclaimer: I'm still new to Excel VBA.</p>\n\n<p>I've searched around a lot but can't seem to find a solution to my problem.</p>\n\n<p>I'm attempting to streamline a data entry process with the use of a couple userforms and macros that will automate a majority of the process. I've gotten very far with a lot of help from just searching this site but I think it's come time to submit a question.</p>\n\n<p>Essentially what I want this piece of code to do is loop through textboxes and check their values in one userform(QAResults) against certain criteria, when the criteria is satisfied I want it to compare that textbox with another textbox in the second userform(NewEntryUserForm) and copy some textbox values from QAResults to NewEntryUserForm. I think the problem lies in how I'm trying to use FOR and NEXT to cycle through the userform textboxes.</p>\n\n<p>I'm not sure if my explanation makes sense but maybe the code will help show what I'm trying to do. I don't get any errors but it's not doing what I think it should be doing. Any suggestions would be appreciated.</p>\n\n<pre><code>Private Sub RetrieveLabComments_Click()\n\nDim i As Integer\nDim y As Integer\nDim ufm As UserForm\nDim qa As UserForm\n\nFor i = 1 To 3\n\nSet qa = QAResults\n    If qa.Controls(\"TC\" &amp; i &amp; \"_DN_FQA\").Value &lt;&gt; \"\" And _\n        qa.Controls(\"TC\" &amp; i &amp; \"_RLOG_FQA\").Value &lt;&gt; \"NA\" And _\n        qa.Controls(\"TC\" &amp; i &amp; \"_RLOG_FQA\").Value &gt; qa.Controls(\"TC\" &amp; i &amp; _\n              \"_327_FQA\").Value Then\n\n        For y = 1 To 14\n        Set ufm = NewEntryUserForm\n        Set qa = QAResults\n            If qa.Controls(\"TC\" &amp; i &amp; \"_DN_FQA\").Value = ufm.Controls(\"CN\" _ \n                &amp; y).Value Then\n                    If ufm.Controls(\"DT\" &amp; y).Value = \"LD\" Then\n                        ufm.Controls(\"QAY\" &amp; y &amp; \"A\").Value = \"ILN\"\n                            If ufm.Controls(\"DT \" &amp; y).Value = \"FD\" Then\n                                ufm.Controls(\"QAYF\" &amp; y &amp; \"B\").Value = \n                                qa.Controls(\"TC\" &amp; i &amp; \"_RLOG_FQA\").Value _\n                                &amp; \"&gt;\" &amp; qa.Controls(\"TC\" &amp; i &amp; _\n                                \"_327_FQA\").Value\n                            End If\n                    End If\n           End If\n        Next y\n    End If\n\n\nNext i\n\nIf MsgBox(\"Data retrieved!\", vbOKOnly, \"Incoming Message...\") Then\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2034, "user_id": 2486496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Rpd3r.jpg?s=128&g=1", "display_name": "gravity", "link": "https://stackoverflow.com/users/2486496/gravity"}, "edited": false, "score": 0, "creation_date": 1499275915, "post_id": 44932549, "comment_id": 76841028, "body": "I believe you should not be encapsulating your variable.  <code>Range(&quot;C2:C&quot; &amp; lastrow).Select</code>"}], "answers": [{"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499276106, "post_id": 44932623, "comment_id": 76841115, "body": "Ah, good catch, I didn&#39;t even notice that the <code>&amp; lastrow</code> was inside the string literal. :D"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499276141, "post_id": 44932623, "comment_id": 76841139, "body": "@A.S.H It happens to the very best of us :)"}], "tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": false, "score": 1, "last_activity_date": 1499275945, "creation_date": 1499275945, "answer_id": 44932623, "question_id": 44932549, "link": "https://stackoverflow.com/questions/44932549/how-to-get-row-count-and-use-in-range/44932623#44932623", "title": "How to get row count and use in range", "body": "<p>If I'm not mistaken, this code shouldnt compile. Your code is this:</p>\n\n<pre><code>Dim lastrow As Long\nlastrow = Cells(Rows.Count, \"A\").End(xlUp).Row\nRange(\"C1\").Select\nActiveCell.Copy\nRange(\"C2:C &amp; lastrow\").Select ' &lt;----\nActiveSheet.Paste\nRange(\"A2:A &amp; lastrow\").Select ' &lt;----\nActiveSheet.Paste\n</code></pre>\n\n<p>And it should be:</p>\n\n<pre><code>Dim lastrow As Long\nlastrow = Cells(Rows.Count, \"A\").End(xlUp).Row\nRange(\"C1\").Select\nActiveCell.Copy\nRange(\"C2:C\" &amp; lastrow).Select\nActiveSheet.Paste\nRange(\"A2:A\" &amp; lastrow).Select\nActiveSheet.Paste\n</code></pre>\n\n<p>This ignores the inefficiency of Select, Activate, Paste, etc, but it solves your problem (or at least should, unless I am really missing something).</p>\n"}], "owner": {"reputation": 143, "user_id": 5583469, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Dt97U.jpg?s=128&g=1", "display_name": "jdcaliff", "link": "https://stackoverflow.com/users/5583469/jdcaliff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1442, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499275945, "creation_date": 1499275690, "last_edit_date": 1531164843, "question_id": 44932549, "link": "https://stackoverflow.com/questions/44932549/how-to-get-row-count-and-use-in-range", "title": "How to get row count and use in range", "body": "<p>I am trying to get the number of rows in a spreadsheet and then use the number to select a range as such:</p>\n\n<pre><code>Dim lastrow As Long\nlastrow = Cells(Rows.Count, \"A\").End(xlUp).Row\nRange(\"C1\").Select\nActiveCell.Copy\nRange(\"C2:C &amp; lastrow\").Select\nActiveSheet.Paste\nRange(\"A2:A &amp; lastrow\").Select\nActiveSheet.Paste\n</code></pre>\n\n<p>So basically I am trying to copy content of C1 into every cell within columns A and C. However, using C:C and A:A in my Range statements causes extra rows to be added when I paste. So I really I need to be able to get the count of rows and then use that in the range. Can someone help me with this?</p>\n\n<p>Thanks,</p>\n\n<ul>\n<li>Jesse</li>\n</ul>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1499275490, "post_id": 44932333, "comment_id": 76840795, "body": "Loop over <code>.Range(&quot;A4:A84&quot;)</code> like this:  <a href=\"https://stackoverflow.com/questions/3875415/loop-through-each-cell-in-a-range-of-cells-when-given-a-range-object\" title=\"loop through each cell in a range of cells when given a range object\">stackoverflow.com/questions/3875415/&hellip;</a> you can increment a variable within the loop to get 1..81 and <code>Left(mp_start, 2) &amp; Right(mp_start, 12)</code> seems constant so store its value outside the loop and use that variable inside."}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1499275423, "creation_date": 1499275423, "answer_id": 44932479, "question_id": 44932333, "link": "https://stackoverflow.com/questions/44932333/how-i-make-this-code-shorter/44932479#44932479", "title": "How i make this code shorter?", "body": "<p>Use a <code>For</code>loop:</p>\n\n<pre><code>.Range(\"A3\") = mp_start\nFor i = 4 To 84\n    .Range(\"A\" &amp; i) = Left(mp_start, 2) &amp; Right(mp_start, 12) + i - 3\nNext i\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 7219951, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/118483571972540/picture?type=large", "display_name": "Connolly Destin", "link": "https://stackoverflow.com/users/7219951/connolly-destin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 44932479, "answer_count": 1, "score": 1, "last_activity_date": 1499275423, "creation_date": 1499274936, "last_edit_date": 1531164843, "question_id": 44932333, "link": "https://stackoverflow.com/questions/44932333/how-i-make-this-code-shorter", "title": "How i make this code shorter?", "body": "<p>I have a startup value with letters in the beginning and number at the end I need to add the numbers 82 times. if you could tell me a possible way to shorten this I would be grateful.</p>\n\n<pre><code>'With Sheets(\"License Plate Number\")\n.Range(\"A3\") = mp_start\n.Range(\"A4\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 1\n.Range(\"A5\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 2\n.Range(\"A6\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 3\n.Range(\"A7\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 4\n.Range(\"A8\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 5\n.Range(\"A9\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 6\n.Range(\"A10\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 7\n.Range(\"A11\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 8\n.Range(\"A12\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 9\n.Range(\"A13\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 10\n.Range(\"A14\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 11\n.Range(\"A15\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 12\n.Range(\"A16\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 13\n.Range(\"A17\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 14\n.Range(\"A18\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 15\n.Range(\"A19\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 16\n.Range(\"A20\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 17\n.Range(\"A21\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 18\n.Range(\"A22\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 19\n.Range(\"A23\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 20\n.Range(\"A24\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 21\n.Range(\"A25\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 22\n.Range(\"A26\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 23\n.Range(\"A27\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 24\n.Range(\"A28\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 25\n.Range(\"A29\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 26\n.Range(\"A30\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 27\n.Range(\"A31\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 28\n.Range(\"A32\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 29\n.Range(\"A33\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 30\n.Range(\"A34\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 31\n.Range(\"A35\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 32\n.Range(\"A36\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 33\n.Range(\"A37\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 34\n.Range(\"A38\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 35\n.Range(\"A39\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 36\n.Range(\"A40\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 37\n.Range(\"A41\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 38\n.Range(\"A42\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 39\n.Range(\"A43\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 40\n.Range(\"A44\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 41\n.Range(\"A45\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 42\n.Range(\"A46\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 43\n.Range(\"A47\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 44\n.Range(\"A48\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 45\n.Range(\"A49\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 46\n.Range(\"A50\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 47\n.Range(\"A51\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 48\n.Range(\"A52\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 49\n.Range(\"A53\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 50\n.Range(\"A54\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 51\n.Range(\"A55\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 52\n.Range(\"A56\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 53\n.Range(\"A57\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 54\n.Range(\"A58\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 55\n.Range(\"A59\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 56\n.Range(\"A60\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 57\n.Range(\"A61\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 58\n.Range(\"A62\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 59\n.Range(\"A63\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 60\n.Range(\"A64\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 61\n.Range(\"A65\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 62\n.Range(\"A66\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 63\n.Range(\"A67\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 64\n.Range(\"A68\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 65\n.Range(\"A69\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 66\n.Range(\"A70\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 67\n.Range(\"A71\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 68\n.Range(\"A72\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 69\n.Range(\"A73\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 70\n.Range(\"A74\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 71\n.Range(\"A75\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 72\n.Range(\"A76\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 73\n.Range(\"A77\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 74\n.Range(\"A78\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 75\n.Range(\"A79\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 76\n.Range(\"A80\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 77\n.Range(\"A81\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 78\n.Range(\"A82\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 79\n.Range(\"A83\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 80\n.Range(\"A84\") = Left(mp_start, 2) &amp; Right(mp_start, 12) + 81      \nEnd With'\n</code></pre>\n\n<p>if you could tell me a possible way to shorten this I would be grateful.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 555, "user_id": 2488499, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/tbXdo.jpg?s=128&g=1", "display_name": "Mor Sagmon", "link": "https://stackoverflow.com/users/2488499/mor-sagmon"}, "edited": false, "score": 0, "creation_date": 1499275683, "post_id": 44932254, "comment_id": 76840901, "body": "While I found a workaround, I&#39;m still interested to understand what&#39;s happening here. To bypass, I&#39;m using: WorksheetFunction.Power(dbl, 0.2)"}], "answers": [{"comments": [{"owner": {"reputation": 555, "user_id": 2488499, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/tbXdo.jpg?s=128&g=1", "display_name": "Mor Sagmon", "link": "https://stackoverflow.com/users/2488499/mor-sagmon"}, "edited": false, "score": 0, "creation_date": 1499326684, "post_id": 44932588, "comment_id": 76860787, "body": "Thanks Brian! This definitely does the trick. I now apply the power operand on ABS(dbl) and negate afterwards if dbl was negative."}], "tags": [], "owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "is_accepted": true, "score": 1, "last_activity_date": 1499276827, "last_edit_date": 1499276827, "creation_date": 1499275789, "answer_id": 44932588, "question_id": 44932254, "link": "https://stackoverflow.com/questions/44932254/excel-vba-error-5-invalid-procedure-call-or-argument-with-power-operand/44932588#44932588", "title": "Excel vba Error 5 Invalid procedure call or argument with power operand", "body": "<p>Here is a solution to your problem:</p>\n\n<pre><code>Sub TestPower()\n    Dim dbl As Double\n\n    dbl = 0.682434999562851\n\n    Debug.Print (-0.682434999562851 ^ 0.2)\n    Debug.Print -(dbl ^ 0.2)\nEnd Sub\n</code></pre>\n\n<p>Notice that I placed the negative sign outside the parenthesis (and changed dbl accordingly).</p>\n\n<p>From the MSDN library, \"A number can be negative only if exponent is an integer value.\"  I'm not a mathematician but it has something to do with the result being a Complex Number.</p>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 8245976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/159a9f3246a3d55b6f4c3aae75a83f12?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Staffa", "link": "https://stackoverflow.com/users/8245976/chris-staffa"}, "is_accepted": false, "score": 2, "last_activity_date": 1499276361, "creation_date": 1499276361, "answer_id": 44932737, "question_id": 44932254, "link": "https://stackoverflow.com/questions/44932254/excel-vba-error-5-invalid-procedure-call-or-argument-with-power-operand/44932737#44932737", "title": "Excel vba Error 5 Invalid procedure call or argument with power operand", "body": "<p>It seems that when you use the literal, VBA interprets the expression (-0.6824 ^ 0.2) as (-(0.6824 ^ 0.2)), but when you use the variable, it realizes you're trying to compute a fractional power of a negative number and gives up.</p>\n"}, {"comments": [{"owner": {"reputation": 555, "user_id": 2488499, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/tbXdo.jpg?s=128&g=1", "display_name": "Mor Sagmon", "link": "https://stackoverflow.com/users/2488499/mor-sagmon"}, "edited": false, "score": 0, "creation_date": 1499326576, "post_id": 44932800, "comment_id": 76860712, "body": "Thanks Ron. Great explanation."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 4, "last_activity_date": 1499281244, "last_edit_date": 1499281244, "creation_date": 1499276572, "answer_id": 44932800, "question_id": 44932254, "link": "https://stackoverflow.com/questions/44932254/excel-vba-error-5-invalid-procedure-call-or-argument-with-power-operand/44932800#44932800", "title": "Excel vba Error 5 Invalid procedure call or argument with power operand", "body": "<p>What you are seeing has to do with operator precedence in VBA.</p>\n\n<p>In VBA, exponentiation has a higher precedence than does negation.  So in your first equation, the exponentiation operation occurs first, and then the result is negated.</p>\n\n<p>Actually, it seems the Power function is smarter than the exponentiation operator.  In point of fact, you are trying to take the fifth root of a negative number, which would be a real number.  The Power function recognizes that. The exponentiation operator does not. </p>\n\n<p><strong>EDIT:</strong> From VBA Help for the <strong>^</strong>:  Remarks A <code>number</code> can be negative only if <code>exponent</code> is an integer value.</p>\n\n<p><em>So it seems that the explanation for the behavior difference is, indeed, operator precedence, and a limitation of the VBA <code>^</code> operator.</em></p>\n"}], "owner": {"reputation": 555, "user_id": 2488499, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/tbXdo.jpg?s=128&g=1", "display_name": "Mor Sagmon", "link": "https://stackoverflow.com/users/2488499/mor-sagmon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1030, "favorite_count": 0, "accepted_answer_id": 44932588, "answer_count": 3, "score": 0, "last_activity_date": 1499281244, "creation_date": 1499274676, "question_id": 44932254, "link": "https://stackoverflow.com/questions/44932254/excel-vba-error-5-invalid-procedure-call-or-argument-with-power-operand", "title": "Excel vba Error 5 Invalid procedure call or argument with power operand", "body": "<p>Please consider this sub:</p>\n\n<pre><code>Sub TestPower()\n\n    Dim dbl As Double\n\n    dbl = -0.682434999562851\n\n    Debug.Print (-0.682434999562851 ^ 0.2)\n    Debug.Print (dbl ^ 0.2)\nEnd Sub\n</code></pre>\n\n<p>On the second \"debug.print\" command, I'm getting an Error 5: Invalid procedure call or argument.</p>\n\n<p>Excel Office 2016.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["sql-server", "vba", "excel"], "comments": [{"owner": {"reputation": 10997, "user_id": 75852, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fe6c5931802371700bddfa845f8a4d86?s=128&d=identicon&r=PG", "display_name": "squillman", "link": "https://stackoverflow.com/users/75852/squillman"}, "edited": false, "score": 1, "creation_date": 1499273968, "post_id": 44931983, "comment_id": 76839971, "body": "<code>iRowNo = iRowNo + 20</code> - This means it is only sending data to the database for every 20th row in your worksheet.  Is that what you want?"}, {"owner": {"reputation": 359, "user_id": 8088749, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/12f8cf6e8d08ad399814c0a88b1d9475?s=128&d=identicon&r=PG&f=1", "display_name": "DRUIDRUID", "link": "https://stackoverflow.com/users/8088749/druidruid"}, "reply_to_user": {"reputation": 10997, "user_id": 75852, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fe6c5931802371700bddfa845f8a4d86?s=128&d=identicon&r=PG", "display_name": "squillman", "link": "https://stackoverflow.com/users/75852/squillman"}, "edited": false, "score": 0, "creation_date": 1499274400, "post_id": 44931983, "comment_id": 76840181, "body": "@squillman Negative, I would like to send all rows that I have entered data in that resemble the excel snipped photo. As of right now, even if I have 20 rows im only send the 1st"}, {"owner": {"reputation": 10997, "user_id": 75852, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fe6c5931802371700bddfa845f8a4d86?s=128&d=identicon&r=PG", "display_name": "squillman", "link": "https://stackoverflow.com/users/75852/squillman"}, "edited": false, "score": 1, "creation_date": 1499274862, "post_id": 44931983, "comment_id": 76840406, "body": "What happens if you change that line to <code>iRowNo = iRowNo + 1</code>?"}, {"owner": {"reputation": 2292, "user_id": 6664878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a92963189b3d0c302cc86daeb6e1ac4?s=128&d=identicon&r=PG&f=1", "display_name": "soohoonigan", "link": "https://stackoverflow.com/users/6664878/soohoonigan"}, "edited": false, "score": 0, "creation_date": 1499274975, "post_id": 44931983, "comment_id": 76840475, "body": "I would try squillman&#39;s suggestion, and if you&#39;re still only seeing one row inserted try adding &quot;cmd.parameters.clear&quot; after cmd is executed each time to make sure the parameters are getting new values each loop"}, {"owner": {"reputation": 359, "user_id": 8088749, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/12f8cf6e8d08ad399814c0a88b1d9475?s=128&d=identicon&r=PG&f=1", "display_name": "DRUIDRUID", "link": "https://stackoverflow.com/users/8088749/druidruid"}, "edited": false, "score": 0, "creation_date": 1499275491, "post_id": 44931983, "comment_id": 76840797, "body": "When I switch to <code>iRowNo = iRowNo +1</code> I get an error <code>Multiple-step OLE DB operator generated errors. Check each OLE DB status value, if available. No work was done.</code>"}, {"owner": {"reputation": 10997, "user_id": 75852, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fe6c5931802371700bddfa845f8a4d86?s=128&d=identicon&r=PG", "display_name": "squillman", "link": "https://stackoverflow.com/users/75852/squillman"}, "reply_to_user": {"reputation": 2292, "user_id": 6664878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a92963189b3d0c302cc86daeb6e1ac4?s=128&d=identicon&r=PG&f=1", "display_name": "soohoonigan", "link": "https://stackoverflow.com/users/6664878/soohoonigan"}, "edited": false, "score": 0, "creation_date": 1499276089, "post_id": 44931983, "comment_id": 76841104, "body": "Add the call to <code>cmd.Parameters.Clear</code> that @soohoonigan suggested right before you start appending parameters."}, {"owner": {"reputation": 2292, "user_id": 6664878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a92963189b3d0c302cc86daeb6e1ac4?s=128&d=identicon&r=PG&f=1", "display_name": "soohoonigan", "link": "https://stackoverflow.com/users/6664878/soohoonigan"}, "edited": false, "score": 0, "creation_date": 1499276461, "post_id": 44931983, "comment_id": 76841327, "body": "That new error you got can be thrown for a number of reasons, hard to say which it is without knowing your db schema. But things to check are that you aren&#39;t trying to insert null into a not-null column, and casting the cell values into the correct datatypes (i.e. text/varchar mismatches). I also see some &quot;time&quot; columns, make sure the strings are being converted to datetimes in your sql correctly if the time columns are date/time datatypes, etc"}, {"owner": {"reputation": 359, "user_id": 8088749, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/12f8cf6e8d08ad399814c0a88b1d9475?s=128&d=identicon&r=PG&f=1", "display_name": "DRUIDRUID", "link": "https://stackoverflow.com/users/8088749/druidruid"}, "reply_to_user": {"reputation": 10997, "user_id": 75852, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fe6c5931802371700bddfa845f8a4d86?s=128&d=identicon&r=PG", "display_name": "squillman", "link": "https://stackoverflow.com/users/75852/squillman"}, "edited": false, "score": 0, "creation_date": 1499276466, "post_id": 44931983, "comment_id": 76841332, "body": "@squillman @soohoonigan I did this keeping  <code>iRowNo = iRowNo +20</code> and tried with <code>iRowNo = iRowNo +1</code> I receive this error <code>Compile error: Method or data member not found</code> .Clear"}, {"owner": {"reputation": 359, "user_id": 8088749, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/12f8cf6e8d08ad399814c0a88b1d9475?s=128&d=identicon&r=PG&f=1", "display_name": "DRUIDRUID", "link": "https://stackoverflow.com/users/8088749/druidruid"}, "reply_to_user": {"reputation": 2292, "user_id": 6664878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a92963189b3d0c302cc86daeb6e1ac4?s=128&d=identicon&r=PG&f=1", "display_name": "soohoonigan", "link": "https://stackoverflow.com/users/6664878/soohoonigan"}, "edited": false, "score": 0, "creation_date": 1499276672, "post_id": 44931983, "comment_id": 76841438, "body": "@soohoonigan Data types are correct. When I test one column it is successful. I copied the column and pasted to several rows to test as well, its essentially the same data..."}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1499278427, "post_id": 44931983, "comment_id": 76842415, "body": "Thats is not VB.NET code.  The tags include text to guide you on which to use."}, {"owner": {"reputation": 359, "user_id": 8088749, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/12f8cf6e8d08ad399814c0a88b1d9475?s=128&d=identicon&r=PG&f=1", "display_name": "DRUIDRUID", "link": "https://stackoverflow.com/users/8088749/druidruid"}, "reply_to_user": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1499281144, "post_id": 44931983, "comment_id": 76843897, "body": "@Plutonix oops, corrected the tags...thnx"}], "owner": {"reputation": 359, "user_id": 8088749, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/12f8cf6e8d08ad399814c0a88b1d9475?s=128&d=identicon&r=PG&f=1", "display_name": "DRUIDRUID", "link": "https://stackoverflow.com/users/8088749/druidruid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499287051, "creation_date": 1499273593, "last_edit_date": 1499287051, "question_id": 44931983, "link": "https://stackoverflow.com/questions/44931983/write-multiple-rows-in-excel-vb-to-sql-table", "title": "Write Multiple Rows in EXCEL (VB) to SQL Table", "body": "<p>Would like to be able to write all rows that have data in them to SQL table, with the below I can only export the 1st row. If I add more rows of data and click the Export Button I will only send the first row. Can some one help me script my request?<a href=\"https://i.stack.imgur.com/DdEb3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DdEb3.png\" alt=\"enter image description here\"></a>  </p>\n\n<pre><code>Sub Button1_Click()\nDim conn As ADODB.Connection\nDim cmd As ADODB.Command\n\nDim strSQL As String\n\nstrSQL = \"INSERT INTO dbo.TimeLog\" &amp; _\n\"(EventDate, ID, DeptCode, Opcode, StartTime, FinishTime, Units) \" &amp; _\n\"VALUES (?,?,?,?,?,?,?);\"\n\nSet conn = New ADODB.Connection\nconn.Open \"Provider=SQLOLEDB;Data Source=db\\db1;Initial Catalog=Table1;Integrated Security=SSPI;\"\n'Skip the header row\niRowNo = 2\n\nSet cmd = New ADODB.Command\n\ncmd.ActiveConnection = conn\ncmd.CommandType = adCmdText\ncmd.CommandText = strSQL\n\niRowNo = 2\n\nWith Sheets(\"Sheet1\")\n'Loop until empty cell in EventDate\nDo Until .Cells(iRowNo, 1) = \"\"\n\n cmd.Parameters.Append _\n cmd.CreateParameter(\"pEventDate\", adVarChar, adParamInput, 8, .Cells(iRowNo, 1))\n cmd.Parameters.Append _\n cmd.CreateParameter(\"pID\", adInteger, adParamInput, , .Cells(iRowNo, 2))\n cmd.Parameters.Append _\n cmd.CreateParameter(\"pDeptCode\", adVarChar, adParamInput, 2, .Cells(iRowNo, 3))\n cmd.Parameters.Append _\n cmd.CreateParameter(\"pOpCode\", adVarChar, adParamInput, 2, .Cells(iRowNo, 4))\n cmd.Parameters.Append _\n cmd.CreateParameter(\"pStartTime\", adDBTime, adParamInput, 0, .Cells(iRowNo, 5))\n cmd.Parameters.Append _\n cmd.CreateParameter(\"pFinishTime\", adDBTime, adParamInput, 0, .Cells(iRowNo, 6))\n cmd.Parameters.Append _\n cmd.CreateParameter(\"pUnits\", adInteger, adParamInput, , .Cells(iRowNo, 7))\n\n cmd.Execute\n\n iRowNo = iRowNo + 20\n Loop\n\n MsgBox \"Success!\"\n\nEnd With\n\nconn.Close\nSet conn = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "worksheet", "consolidation"], "answers": [{"comments": [{"owner": {"reputation": 669, "user_id": 6754179, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2646872bfa0b8caf0db917b9afde5920?s=128&d=identicon&r=PG&f=1", "display_name": "ERT", "link": "https://stackoverflow.com/users/6754179/ert"}, "edited": false, "score": 0, "creation_date": 1499277646, "post_id": 44932467, "comment_id": 76841968, "body": "This seems to be what I am looking for.  Let me try implementing this, and I will get back to you."}, {"owner": {"reputation": 669, "user_id": 6754179, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2646872bfa0b8caf0db917b9afde5920?s=128&d=identicon&r=PG&f=1", "display_name": "ERT", "link": "https://stackoverflow.com/users/6754179/ert"}, "edited": false, "score": 1, "creation_date": 1499281113, "post_id": 44932467, "comment_id": 76843882, "body": "This works beautifully.  Thank you so much for your assistance."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 2, "last_activity_date": 1499275383, "creation_date": 1499275383, "answer_id": 44932467, "question_id": 44931879, "link": "https://stackoverflow.com/questions/44931879/excel-macro-copy-sheets-from-multiple-workbooks-with-added-refresh-capability/44932467#44932467", "title": "Excel Macro: Copy Sheets from Multiple Workbooks WITH Added Refresh Capability", "body": "<p>Basically you want to <em>refresh</em> the worksheet's data if it already exists in <code>ThisWorkbook</code>, otherwise copy/add it. You can use this subroutine to accomplish this:</p>\n\n<pre><code>Sub copyOrRefreshSheet(destWb As Workbook, sourceWs As Worksheet)\n  Dim ws As Worksheet\n  On Error Resume Next\n  Set ws = destWb.Worksheets(sourceWs.Name)\n  On Error GoTo 0\n  If ws Is Nothing Then\n    sourceWs.Copy After:=destWb.Worksheets(destWb.Worksheets.count)\n  Else\n    ws.Cells.ClearContents\n    ws.Range(sourceWs.UsedRange.Address).value = sourceWs.UsedRange.Value2\n  End If\nEnd Sub\n</code></pre>\n\n<p>Now to use this, change this line from your routine's code:</p>\n\n<blockquote>\n<pre><code>Sheet.Copy After:=ThisWorkbook.Sheets(1)\n</code></pre>\n</blockquote>\n\n<p>into:</p>\n\n<pre><code>copyOrRefreshSheet ThisWorkbook, sheet\n</code></pre>\n"}], "owner": {"reputation": 669, "user_id": 6754179, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2646872bfa0b8caf0db917b9afde5920?s=128&d=identicon&r=PG&f=1", "display_name": "ERT", "link": "https://stackoverflow.com/users/6754179/ert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1868, "favorite_count": 0, "accepted_answer_id": 44932467, "answer_count": 1, "score": 1, "last_activity_date": 1499275383, "creation_date": 1499273235, "question_id": 44931879, "link": "https://stackoverflow.com/questions/44931879/excel-macro-copy-sheets-from-multiple-workbooks-with-added-refresh-capability", "title": "Excel Macro: Copy Sheets from Multiple Workbooks WITH Added Refresh Capability", "body": "<p>I am looking to merge sheets in multiple Excel files into one master file with refresh/update functionality.</p>\n\n<p>To be more specific, I have ~25 workbooks in one folder which are identical in structure and vary based on entity.  Each file has one sheet, which is identical to the name of the file.  Each entity will update their specific file each week with up-to-date number values.  I want to create a macro which will:</p>\n\n<ol>\n<li>Copy the one worksheet from each file and paste them in one \"Master\" workbook.</li>\n<li>Have the added functionality which allows me to \"refresh\" these copy/pasted tabs each week.</li>\n</ol>\n\n<p>I have this code thus far:</p>\n\n<pre><code>Sub ConslidateWorkbooks()\n'Code to pull sheets from multiple Excel files in one file directory\n'into master \"Consolidation\" sheet.\n\nDim FolderPath As String\nDim Filename As String\nDim Sheet As Worksheet\n\nApplication.ScreenUpdating = False\nFolderPath = \".....\"       'I have this filled in my code\nFilename = Dir(FolderPath &amp; \"*.xls*\")\n\nDo While Filename &lt;&gt; \"\"\n Workbooks.Open Filename:=FolderPath &amp; Filename, ReadOnly:=True\n For Each Sheet In ActiveWorkbook.Sheets\n Sheet.Copy After:=ThisWorkbook.Sheets(1)\n Next Sheet\n Workbooks(Filename).Close\n Filename = Dir()\nLoop\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>This code works fine to pull the data from multiple workbooks into a master workbook, but I need to add some sort of refresh capability WITHOUT deleting and re-copying the tabs (because I have links in other tabs in the Master sheet which will become #REF if sheets are deleted and re-copied).</p>\n\n<p>Thank you for your help in advance.</p>\n"}, {"tags": ["string", "matlab", "excel", "insert", "vba"], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 2, "last_activity_date": 1499273454, "creation_date": 1499273454, "answer_id": 44931939, "question_id": 44931670, "link": "https://stackoverflow.com/questions/44931670/insert-a-symbol-between-the-characters-in-a-list-of-strings/44931939#44931939", "title": "Insert a symbol &quot;&gt;&quot; between the characters in a list of strings", "body": "<p>If you have only ASCII characters, you can try this simple UDF:</p>\n\n<pre><code>Function insertChar(s As String, c As String) As String\n  insertChar = Join(Split(StrConv(s, vbUnicode), vbNullChar), c)\nEnd Function\n</code></pre>\n\n<p>Test:</p>\n\n<pre><code>A1: abcd;'.\nB1: =insertChar(A1, \"&gt;\")   -----&gt;   a&gt;b&gt;c&gt;d&gt;;&gt;'&gt;.&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1499273562, "creation_date": 1499273562, "answer_id": 44931971, "question_id": 44931670, "link": "https://stackoverflow.com/questions/44931670/insert-a-symbol-between-the-characters-in-a-list-of-strings/44931971#44931971", "title": "Insert a symbol &quot;&gt;&quot; between the characters in a list of strings", "body": "<p>This is an interesting question!  Try it this way.</p>\n\n<pre><code>Sub InsertCharacter()\n\nDim Rng As Range\nDim InputRng As Range, OutRng As Range\nDim xRow As Integer\nDim xChar As String\nDim index As Integer\nDim arr As Variant\nDim xValue As String\nDim outValue As String\nDim xNum As Integer\n\nSet InputRng = Application.Selection\nSet InputRng = Application.InputBox(\"Range :\", xTitleId, InputRng.Address, Type:=8)\nxRow = Application.InputBox(\"Number of characters :\", xTitleId, Type:=1)\nxChar = Application.InputBox(\"Specify a character :\", xTitleId, Type:=2)\nSet OutRng = Application.InputBox(\"Out put to (select range):\", xTitleId, Type:=8)\nSet OutRng = OutRng.Range(\"A1\")\nxNum = 1\nFor Each Rng In InputRng\n    xValue = Rng.Value\n    outValue = \"\"\n    For index = 1 To VBA.Len(xValue)\n        If index Mod xRow = 0 And index &lt;&gt; VBA.Len(xValue) Then\n            outValue = outValue + VBA.Mid(xValue, index, 1) + xChar\n        Else\n            outValue = outValue + VBA.Mid(xValue, index, 1)\n        End If\n    Next\n    OutRng.Cells(xNum, 1).Value = outValue\n    xNum = xNum + 1\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8313, "user_id": 7621674, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/323bed98b2e655d5fa9ac6d23a72b995?s=128&d=identicon&r=PG", "display_name": "m7913d", "link": "https://stackoverflow.com/users/7621674/m7913d"}, "is_accepted": false, "score": 3, "last_activity_date": 1499273670, "creation_date": 1499273670, "answer_id": 44932001, "question_id": 44931670, "link": "https://stackoverflow.com/questions/44931670/insert-a-symbol-between-the-characters-in-a-list-of-strings/44932001#44932001", "title": "Insert a symbol &quot;&gt;&quot; between the characters in a list of strings", "body": "<p>A single line matlab solution would be:</p>\n\n<pre class=\"lang-matlab prettyprint-override\"><code>strjoin(cellstr(str(:)), '&gt;')\n</code></pre>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n<li><a href=\"https://mathworks.com/help/matlab/ref/cellstr.html\" rel=\"nofollow noreferrer\"><code>cellstr(str(:))</code></a>: converts the char array to a cell array</li>\n<li><a href=\"https://mathworks.com/help/matlab/ref/strjoin.html\" rel=\"nofollow noreferrer\"><code>strjoin</code></a>: joins all the cells with the given delimiter, i.e. <code>&gt;</code></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 3829966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97601bb4652dcddfdc3181646b353cf5?s=128&d=identicon&r=PG&f=1", "display_name": "JustDaveN", "link": "https://stackoverflow.com/users/3829966/justdaven"}, "is_accepted": false, "score": 1, "last_activity_date": 1499279844, "last_edit_date": 1499279844, "creation_date": 1499274045, "answer_id": 44932080, "question_id": 44931670, "link": "https://stackoverflow.com/questions/44931670/insert-a-symbol-between-the-characters-in-a-list-of-strings/44932080#44932080", "title": "Insert a symbol &quot;&gt;&quot; between the characters in a list of strings", "body": "<p>You'll want to create a custom function that takes in the value, loops through and places the characters, from the looks of it you want to skip when the character is a space... I also added the ability to change the character you are inserting on the fly, rather than hard coding. Something like:</p>\n\n<pre><code>Public Function AddGTSigns(strIn As String, strCharToAdd As String) As String\n    Dim strOut As String\n    Dim lngCount As Integer\n    Dim lngLength As Integer\n    Dim strNextChar As String\n    lngLength = Len(strIn)\n\n    For lngCount = 1 To lngLength\n        strOut = strOut &amp; Mid(strIn, lngCount, 1)\n        If lngCount &lt; lngLength Then\n            'Check next character'\n            If Mid(strIn, lngCount, 1) &lt;&gt; \" \" Then\n                strOut = strOut &amp; strCharToAdd\n            End If\n        End If\n    Next lngCount\n\n    AddGTSigns = strOut\n\nEnd Function\n\nPrivate Sub RunIt()\n    Dim strTest As String\n\n    strTest = AddGTSigns(\"ABC CDE GHE\", \"&gt;\")\n\n    MsgBox strTest\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15105, "user_id": 3768871, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Wxgi0.jpg?s=128&g=1", "display_name": "OmG", "link": "https://stackoverflow.com/users/3768871/omg"}, "is_accepted": false, "score": 1, "last_activity_date": 1499274604, "last_edit_date": 1499274604, "creation_date": 1499274262, "answer_id": 44932139, "question_id": 44931670, "link": "https://stackoverflow.com/questions/44931670/insert-a-symbol-between-the-characters-in-a-list-of-strings/44932139#44932139", "title": "Insert a symbol &quot;&gt;&quot; between the characters in a list of strings", "body": "<p>In complete case of the other answers, you can load the file in matlab an change the string by <code>strjoin</code>:</p>\n\n<pre><code>[~,~,raw] = xlsread(fileName);\nnum = length(raw{:,1});\nfor rawNum = 1:num\n    str = raw{rawNum,1};\n    raw{rawNum,1} = strjoin(cellstr(str(:)), '&gt;');\nend \nxlswrite(fileName, raw);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4232, "user_id": 2077101, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/TUFNg.jpg?s=128&g=1", "display_name": "James Watkins", "link": "https://stackoverflow.com/users/2077101/james-watkins"}, "edited": false, "score": 0, "creation_date": 1499277154, "post_id": 44932544, "comment_id": 76841697, "body": "Welcome to SO! Good first answer! Using uppercase I as a variable name might be confusing, also it doesn&#39;t look like you&#39;re using this variable. Can you clarify how to remove the last &gt; symbol?"}, {"owner": {"reputation": 31, "user_id": 8260627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ea26eb7ac44d9141b406fb16aaac3a6?s=128&d=identicon&r=PG", "display_name": "user8260627", "link": "https://stackoverflow.com/users/8260627/user8260627"}, "reply_to_user": {"reputation": 4232, "user_id": 2077101, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/TUFNg.jpg?s=128&g=1", "display_name": "James Watkins", "link": "https://stackoverflow.com/users/2077101/james-watkins"}, "edited": false, "score": 0, "creation_date": 1499278126, "post_id": 44932544, "comment_id": 76842244, "body": "uppercase or lowercase doesn&#39;t matter in vba. You can just write left(txt,len(txt)-1) for removing the last symbol."}, {"owner": {"reputation": 4232, "user_id": 2077101, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/TUFNg.jpg?s=128&g=1", "display_name": "James Watkins", "link": "https://stackoverflow.com/users/2077101/james-watkins"}, "edited": false, "score": 0, "creation_date": 1499278244, "post_id": 44932544, "comment_id": 76842316, "body": "I mean &quot;I&quot; might be confused as a lowercase L or the number one. Your psuedocode still isn&#39;t correct, as you&#39;re not using the variable anywhere. Please edit your answer."}, {"owner": {"reputation": 31, "user_id": 8260627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ea26eb7ac44d9141b406fb16aaac3a6?s=128&d=identicon&r=PG", "display_name": "user8260627", "link": "https://stackoverflow.com/users/8260627/user8260627"}, "reply_to_user": {"reputation": 4232, "user_id": 2077101, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/TUFNg.jpg?s=128&g=1", "display_name": "James Watkins", "link": "https://stackoverflow.com/users/2077101/james-watkins"}, "edited": false, "score": 0, "creation_date": 1499278332, "post_id": 44932544, "comment_id": 76842363, "body": "thanks. I have used lowercase I. I myself got confused between 1 and I :)"}], "tags": [], "owner": {"reputation": 31, "user_id": 8260627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ea26eb7ac44d9141b406fb16aaac3a6?s=128&d=identicon&r=PG", "display_name": "user8260627", "link": "https://stackoverflow.com/users/8260627/user8260627"}, "is_accepted": false, "score": 1, "last_activity_date": 1499278418, "last_edit_date": 1499278418, "creation_date": 1499275670, "answer_id": 44932544, "question_id": 44931670, "link": "https://stackoverflow.com/questions/44931670/insert-a-symbol-between-the-characters-in-a-list-of-strings/44932544#44932544", "title": "Insert a symbol &quot;&gt;&quot; between the characters in a list of strings", "body": "<p>If the words are of same length, you can directly use the formula :-</p>\n\n<p>MID(A1,1,1)&amp;\">\"&amp;MID(A1,2,2)&amp;\">\".....</p>\n\n<p>This will extract the characters and insert \">\" between them.</p>\n\n<p>If the words aren't of the same length, you can write a simple macro. The pseudo-code would be :-</p>\n\n<p>for i = 1 to len(string)</p>\n\n<p>Range(\"B1\")=mid(A1,i,i)&amp;\">\"</p>\n\n<p>next i</p>\n\n<p>and then remove the last > sign using left(txt,len(txt)-1).</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 8260627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ea26eb7ac44d9141b406fb16aaac3a6?s=128&d=identicon&r=PG", "display_name": "user8260627", "link": "https://stackoverflow.com/users/8260627/user8260627"}, "edited": false, "score": 0, "creation_date": 1499283725, "post_id": 44934699, "comment_id": 76845393, "body": "Here is the working code as my previous answer was causing confusion."}], "tags": [], "owner": {"reputation": 31, "user_id": 8260627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ea26eb7ac44d9141b406fb16aaac3a6?s=128&d=identicon&r=PG", "display_name": "user8260627", "link": "https://stackoverflow.com/users/8260627/user8260627"}, "is_accepted": false, "score": 2, "last_activity_date": 1499283680, "creation_date": 1499283680, "answer_id": 44934699, "question_id": 44931670, "link": "https://stackoverflow.com/questions/44931670/insert-a-symbol-between-the-characters-in-a-list-of-strings/44934699#44934699", "title": "Insert a symbol &quot;&gt;&quot; between the characters in a list of strings", "body": "<p>Here is the working macro code</p>\n\n<pre><code>Sub gt()\n\nDim a As Integer, b As String, U(100) As String, J\n\nb = Selection\na = Len(Selection)\nSelection.Offset(0, 1).Select\n\n\nFor i = 1 To a\n\nIf i &lt;&gt; a Then\nJ = J &amp; Mid(b, i, 1) &amp; \"&gt;\"\nElse\nJ = J &amp; Mid(b, i, 1)\nEnd If\n\nNext i\n\nActiveCell = J\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 579, "user_id": 4520329, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cc2834189986109961f70c612332c9b9?s=128&d=identicon&r=PG&f=1", "display_name": "kgk", "link": "https://stackoverflow.com/users/4520329/kgk"}, "edited": false, "score": 0, "creation_date": 1499308614, "post_id": 44936219, "comment_id": 76854085, "body": "what if str is a cell-array?"}, {"owner": {"reputation": 579, "user_id": 4520329, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cc2834189986109961f70c612332c9b9?s=128&d=identicon&r=PG&f=1", "display_name": "kgk", "link": "https://stackoverflow.com/users/4520329/kgk"}, "edited": false, "score": 0, "creation_date": 1499316641, "post_id": 44936219, "comment_id": 76856004, "body": "for the first line, there is an error: &quot;Error: The input character is not valid in MATLAB statements or expressions&quot;"}, {"owner": {"reputation": 656, "user_id": 6850716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c437157670f86e78b18000eb2b1cd00c?s=128&d=identicon&r=PG&f=1", "display_name": "matlabbit", "link": "https://stackoverflow.com/users/6850716/matlabbit"}, "reply_to_user": {"reputation": 579, "user_id": 4520329, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cc2834189986109961f70c612332c9b9?s=128&d=identicon&r=PG&f=1", "display_name": "kgk", "link": "https://stackoverflow.com/users/4520329/kgk"}, "edited": false, "score": 0, "creation_date": 1499358689, "post_id": 44936219, "comment_id": 76884116, "body": "strip and replace will work on cellstrs. Double quotes for string creation were added in 17a and strip/replace were added in 16b. If you are using a version from before 16b, OmG looks to have the right solution."}, {"owner": {"reputation": 656, "user_id": 6850716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c437157670f86e78b18000eb2b1cd00c?s=128&d=identicon&r=PG&f=1", "display_name": "matlabbit", "link": "https://stackoverflow.com/users/6850716/matlabbit"}, "reply_to_user": {"reputation": 579, "user_id": 4520329, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cc2834189986109961f70c612332c9b9?s=128&d=identicon&r=PG&f=1", "display_name": "kgk", "link": "https://stackoverflow.com/users/4520329/kgk"}, "edited": false, "score": 1, "creation_date": 1499359017, "post_id": 44936219, "comment_id": 76884352, "body": "Added regexprep example too."}], "tags": [], "owner": {"reputation": 656, "user_id": 6850716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c437157670f86e78b18000eb2b1cd00c?s=128&d=identicon&r=PG&f=1", "display_name": "matlabbit", "link": "https://stackoverflow.com/users/6850716/matlabbit"}, "is_accepted": false, "score": 1, "last_activity_date": 1499358990, "last_edit_date": 1499358990, "creation_date": 1499289742, "answer_id": 44936219, "question_id": 44931670, "link": "https://stackoverflow.com/questions/44931670/insert-a-symbol-between-the-characters-in-a-list-of-strings/44936219#44936219", "title": "Insert a symbol &quot;&gt;&quot; between the characters in a list of strings", "body": "<p>In MATLAB (requires 17a for double quotes and 16b for strip/replace)</p>\n\n<pre><code>&gt;&gt; str = [\"ABC\"; \"BCD\"; \"BA\"];\n&gt;&gt; str = strip(replace(str,'','&gt;'),'&gt;')\n\nstr = \n\n  3\u00d71 string array\n\n    \"A&gt;B&gt;C\"\n    \"B&gt;C&gt;D\"\n    \"B&gt;A\"\n</code></pre>\n\n<p>Regexprep will work for older versions of MATLAB too</p>\n\n<pre><code>&gt;&gt; str = {'ABC';'BCD';'BA'};\n&gt;&gt; str = regexprep(str,'(.)(?=.)','$1&gt;')\n\nstr =\n\n  3\u00d71 cell array\n\n    {'A&gt;B&gt;C'}\n    {'B&gt;C&gt;D'}\n    {'B&gt;A'  }\n</code></pre>\n"}], "owner": {"reputation": 579, "user_id": 4520329, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cc2834189986109961f70c612332c9b9?s=128&d=identicon&r=PG&f=1", "display_name": "kgk", "link": "https://stackoverflow.com/users/4520329/kgk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 1, "answer_count": 8, "score": 2, "last_activity_date": 1499358990, "creation_date": 1499272498, "last_edit_date": 1531161705, "question_id": 44931670, "link": "https://stackoverflow.com/questions/44931670/insert-a-symbol-between-the-characters-in-a-list-of-strings", "title": "Insert a symbol &quot;&gt;&quot; between the characters in a list of strings", "body": "<p>I have a column in Excel like this:</p>\n\n<pre><code>ABC\nBCD\nBA\n</code></pre>\n\n<p>How can I put the symbols \">\" between every letters in the strings? The expected output should be like this:</p>\n\n<pre><code>A&gt;B&gt;C\nB&gt;C&gt;D\nB&gt;A\n</code></pre>\n\n<p>Or could we do this in Matlab ? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 4, "creation_date": 1499271606, "post_id": 44931301, "comment_id": 76838576, "body": "The limit is ~2 billion characters for a VBA string variable. If you see truncation its likely because there is a restriction in whatever you are outputting the string to or you have introduced a null character which can cause this.  The way to test is to look at <code>len(returnString)</code> rather than the content. Note always use &amp; rather than + to concatenate strings."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1499271814, "post_id": 44931301, "comment_id": 76838699, "body": "If your function is a UDF then the linked question is <i>exactly</i> your issue. Also... if you have 32K characters in an Excel cell, you&#39;re doing something wrong. Excel wasn&#39;t designed for this."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1499272667, "post_id": 44931301, "comment_id": 76839212, "body": "Does a string of length 32346 work for you and only begins to fail at 32347? If not, please isolate the threshold at which your code fails. Also, please show your code."}, {"owner": {"reputation": 333, "user_id": 7297656, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7acdba3eda39265922c8d0abe4c5a829?s=128&d=identicon&r=PG&f=1", "display_name": "emma", "link": "https://stackoverflow.com/users/7297656/emma"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1499273751, "post_id": 44931301, "comment_id": 76839859, "body": "@Alex K, thank you for the info. I used len(returnString) which gave me 32347 for the working string."}, {"owner": {"reputation": 333, "user_id": 7297656, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7acdba3eda39265922c8d0abe4c5a829?s=128&d=identicon&r=PG&f=1", "display_name": "emma", "link": "https://stackoverflow.com/users/7297656/emma"}, "edited": false, "score": 0, "creation_date": 1499274022, "post_id": 44931301, "comment_id": 76840002, "body": "@ Mats&#39; Mug - thanks for your comment, but I don&#39;t follow. This guy had a problem with 255 characters and it was to do with Application.OnTime only being able to handle 255 characters. How is this the same as my issue? I know I&#39;m abusing Excel slightly, but it has been perfect so far and is the only obvious way I have to create my JSON file."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1499274475, "post_id": 44931301, "comment_id": 76840215, "body": "The problem in the linked question is because Excel uses Pascal strings internally which is why strings in many places in Excel are limited to 255 bytes. I&#39;m not sure that&#39;s the case for your problem. I see an apparent limit in this case (using Excel 2010) of 32,767 characters as the return value from a UDF). If you&#39;re creating JSON, why not just dump it to a .txt file instead of forcing it in to an Excel cell?"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1499295871, "post_id": 44931301, "comment_id": 76851007, "body": "32,767 characters is the stated maximum that can be stored in an Excel cell - see <a href=\"https://support.office.com/en-us/article/Excel-specifications-and-limits-1672b34d-7043-467e-8e27-269d656771c3#ID0EBABAAA=Excel_2016-2013\" rel=\"nofollow noreferrer\">Excel specifications and limits</a> - but if your text contains line feeds then there is a separate maximum of 253 line feeds per cell"}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1499273004, "post_id": 44931443, "comment_id": 76839437, "body": "this doesn&#39;t appear to directly answer the question (which admittedly is of somewhat low quality). This perhaps should have been a comment on the OP rather than an &quot;answer&quot;. It&#39;s not obvious that your suggestion would avoid the error or problem in OP (due in part to lack of specificity in the question itself)."}], "tags": [], "owner": {"reputation": 82, "user_id": 8216801, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zkU5Mx0-xs8/AAAAAAAAAAI/AAAAAAAADB0/aiB7MFwApbg/photo.jpg?sz=128", "display_name": "MNF", "link": "https://stackoverflow.com/users/8216801/mnf"}, "is_accepted": false, "score": -2, "last_activity_date": 1499271714, "creation_date": 1499271714, "answer_id": 44931443, "question_id": 44931301, "link": "https://stackoverflow.com/questions/44931301/getting-round-max-string-size-of-32347-in-a-vba-function/44931443#44931443", "title": "Getting round Max string size of 32347 in a VBA function", "body": "<p>I would recommend the use of an Array instead. You could create a dynamically sized array and at the end, it is easier to manipulate it.</p>\n"}], "owner": {"reputation": 333, "user_id": 7297656, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7acdba3eda39265922c8d0abe4c5a829?s=128&d=identicon&r=PG&f=1", "display_name": "emma", "link": "https://stackoverflow.com/users/7297656/emma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2203, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1499273683, "creation_date": 1499271209, "last_edit_date": 1531164843, "question_id": 44931301, "link": "https://stackoverflow.com/questions/44931301/getting-round-max-string-size-of-32347-in-a-vba-function", "title": "Getting round Max string size of 32347 in a VBA function", "body": "<p>My VBA function stops working with one additional line of code. The final line of code in the working function is: <code>returnString = returnString + \"some text from some cell\"</code>. If I copy paste that line of code, it breaks. </p>\n\n<p>The only cause I can see is string length. When I output the length of returnString in the working function it is 32347. <strong>EDIT</strong>: So 32347 works, but adding a further 10 characters or so it starts to fail. This looks suspiciously close to a maximum length of some sort. Is there any way round this? </p>\n\n<p>At the moment I am using this Function (not Sub) to return the string to an Excel cell. A separate Sub-routine then picks up the contents of the cell, to integrate it with other data and output a JSON file.</p>\n\n<p>This question appears to ask the same thing, but the max was 255, and so the answers don't help me: <a href=\"https://stackoverflow.com/questions/2516702/getting-around-the-max-string-size-in-a-vba-function\">Getting around the Max String size in a vba function?</a>. Please note, though, that when I save the 32347-length string, it is 32k. So I can't have hit the 2GB limit!</p>\n\n<p>Any help appreciated!</p>\n\n<pre><code>Function getData(str)\n\nDim lArray() As String\nDim pData As String\nDim ctr As Integer\nDim ctr2 As Integer\nDim ctr3 As Integer\nDim returnString As String\nSet rangetoexport = Worksheets(\"mysheet\").Range(\"c2:m2728\")\nDim id As Long\nDim rowRef As Long\nDim colRef As Integer\nDim var(47) As String\n\nConst idColumn = 1\nConst webColumn = 2\nConst nameColumn = 3\nConst revColumn = 4\nConst empColumn = 5\nConst ctryColumn = 10\nConst indyColumn = 11\n\nConst numFactors = 47\n\nConst labelRow = 1\n\nConst apost = \"\"\"\"\n\n\n\n\n\n\nlArray = Split(str, \",\")\n\nreturnString = \"[\"\n\n  If UBound(lArray) &lt;&gt; 0 Then\n\n        pData = \"\"\n\n        For ctr = 0 To UBound(lArray)\n\n            'Open the object\n            returnString = returnString + \"{\"\n\n            'Find the row\n            id = lArray(ctr)\n            rowRef = -1\n\n            For ctr2 = 0 To rangetoexport.Rows.Count\n                If rangetoexport.Cells(ctr2, idColumn) = id Then\n                    rowRef = ctr2\n                    Exit For\n                End If\n            Next\n\n            'add the parts\n            'add the ID and new object\n\n            returnString = returnString &amp; \"\"\"company\"\": {\"\n\n\n\n            returnString = returnString &amp; \"\"\"ID\"\":\" &amp; rangetoexport.Cells(rowRef, idColumn) &amp; \",\"\n            returnString = returnString &amp; \"\"\"Website\"\":\"\"\" &amp; rangetoexport.Cells(rowRef, webColumn) &amp; \"\"\",\"\n            returnString = returnString &amp; \"\"\"Company Name\"\":\"\"\" &amp; rangetoexport.Cells(rowRef, nameColumn) &amp; \"\"\",\"\n            returnString = returnString &amp; \"\"\"Revenue\"\":\"\"\" &amp; rangetoexport.Cells(rowRef, revColumn) &amp; \"\"\",\"\n            returnString = returnString &amp; \"\"\"Employee Count\"\":\" &amp; rangetoexport.Cells(rowRef, empColumn) &amp; \",\"\n            returnString = returnString &amp; \"\"\"Country\"\":\"\"\" &amp; rangetoexport.Cells(rowRef, ctryColumn) &amp; \"\"\",\"\n            returnString = returnString &amp; \"\"\"Industry Classification (SIC4)\"\":\"\"\" &amp; rangetoexport.Cells(rowRef, indyColumn) &amp; \"\"\"}},\"\n\n            'returnString = returnString &amp; \"\"\"factors\"\": {\"\n\n            'For ctr3 = 1 To 10\n\n\n            'Next\n\n            'returnString = returnString &amp; apost &amp; rangetoexport.Cells(labelRow, 12) &amp; apost &amp; \":\" &amp; rangetoexport.Cells(rowRef, 12) &amp; \",\"\n            'returnString = returnString &amp; apost &amp; rangetoexport.Cells(labelRow, 12) &amp; apost &amp; \":\" &amp; rangetoexport.Cells(rowRef, 12) &amp; \",\"\n            'returnString = returnString &amp; apost &amp; rangetoexport.Cells(labelRow, 12) &amp; apost &amp; \":\" &amp; rangetoexport.Cells(rowRef, 12) &amp; \",\"\n            'returnString = returnString &amp; apost &amp; rangetoexport.Cells(labelRow, 12) &amp; apost &amp; \":\" &amp; rangetoexport.Cells(rowRef, 12) &amp; \",\"\n\n\n\n            'returnString = returnString &amp; rangetoexport.Cells(rowRef, webColumn) &amp; \"},\"\n\n        Next\n\n    Else\n        returnString = \"\"\n\n\n    End If\n\n\nreturnString = Left(returnString, Len(returnString) - 1)\n\ngetData = returnString &amp; \"]\"\n</code></pre>\n"}, {"tags": ["excel", "runtime-error", "ms-word", "vba"], "comments": [{"owner": {"reputation": 29, "user_id": 8160629, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e132917d0ec1161e492987ede766ea26?s=128&d=identicon&r=PG&f=1", "display_name": "Jmaragno", "link": "https://stackoverflow.com/users/8160629/jmaragno"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1499274656, "post_id": 44931191, "comment_id": 76840312, "body": "@pnuts excel was a recommended tag and word vba since the code I was trying to figure out was in Word."}], "answers": [{"tags": [], "owner": {"reputation": 6233, "user_id": 5741073, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1uZeL.jpg?s=128&g=1", "display_name": "TomServo", "link": "https://stackoverflow.com/users/5741073/tomservo"}, "is_accepted": true, "score": 1, "last_activity_date": 1499428407, "last_edit_date": 1499428407, "creation_date": 1499272227, "answer_id": 44931590, "question_id": 44931191, "link": "https://stackoverflow.com/questions/44931191/selecting-top-of-word-document-using-vba/44931590#44931590", "title": "Selecting top of word document using VBA", "body": "<p>Please try </p>\n\n<pre><code>ActiveDocument.Bookmarks(\"\\StartOfDoc\").Select\n</code></pre>\n\n<p>It makes use of a pre-defined, implicit bookmark to take you to the beginning of the document.</p>\n\n<p>I just tested in Word 2016 and it works.</p>\n"}], "owner": {"reputation": 29, "user_id": 8160629, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e132917d0ec1161e492987ede766ea26?s=128&d=identicon&r=PG&f=1", "display_name": "Jmaragno", "link": "https://stackoverflow.com/users/8160629/jmaragno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 903, "favorite_count": 0, "accepted_answer_id": 44931590, "answer_count": 1, "score": 0, "last_activity_date": 1499428407, "creation_date": 1499270827, "last_edit_date": 1531164843, "question_id": 44931191, "link": "https://stackoverflow.com/questions/44931191/selecting-top-of-word-document-using-vba", "title": "Selecting top of word document using VBA", "body": "<p>I am using excel VBA to populate data onto a word template from an excel spreadsheet. The problem I am having is selecting the top of the word document so the information goes into the right spot. </p>\n\n<p>I have tried using <code>Selection.HomeKey wd:=Story</code> and <code>Selection.MoveUp Unit:=wdScreen, count:=1</code> both with no success as I am consistently getting </p>\n\n<blockquote>\n  <p><code>runtime error 4120</code></p>\n</blockquote>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1499271690, "post_id": 44931190, "comment_id": 76838629, "body": "Remove <code>On Error Resume Next</code>. <code>collect.Add</code> is throwing run-time error 91 because you never <code>Set</code> it to a valid object reference."}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1499273381, "post_id": 44931190, "comment_id": 76839648, "body": "Are you passing it the collection you want populated or are you returning the collection?"}], "answers": [{"tags": [], "owner": {"reputation": 293, "user_id": 754682, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7acaf79765f1f4666b8916dc5ea4a987?s=128&d=identicon&r=PG", "display_name": "wizlog", "link": "https://stackoverflow.com/users/754682/wizlog"}, "is_accepted": false, "score": 0, "last_activity_date": 1499278592, "creation_date": 1499278592, "answer_id": 44933334, "question_id": 44931190, "link": "https://stackoverflow.com/questions/44931190/passing-an-array-to-a-collection/44933334#44933334", "title": "Passing an array to a collection", "body": "<p>As Mat's Mug said, make sure to set the collection to an object reference.  One way to do this is to put <code>set collect = new collection</code> before your for loop.</p>\n"}], "owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 234, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499278592, "creation_date": 1499270827, "last_edit_date": 1531164843, "question_id": 44931190, "link": "https://stackoverflow.com/questions/44931190/passing-an-array-to-a-collection", "title": "Passing an array to a collection", "body": "<p>I am trying to pass an array to a collection, but I cannot seem to get the collection to populate.</p>\n\n<pre><code>Public Function CreateCol(ws As Worksheet, ary, col As collection)\nDim rng As Range, collect As collection\nDim y, skey, svalue\n\n    On Error Resume Next\n    'populate fund list\n\n    For y = LBound(ary) To UBound(ary)\n        If ary(y) &lt;&gt; \"\" Then\n            skey = Trim(ary(y))\n            svalue = WorksheetFunction.SumIf(ws.Range(\"A:A\"), ary(y), ws.Range(\"P:P\"))\n            collect.Add svalue, skey\n        End If\n    Next y\n\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "openpyxl"], "comments": [{"owner": {"reputation": 14362, "user_id": 2385133, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3a93c5a0f975385738c1f27848f3b50a?s=128&d=identicon&r=PG", "display_name": "Charlie Clark", "link": "https://stackoverflow.com/users/2385133/charlie-clark"}, "edited": false, "score": 1, "creation_date": 1499274276, "post_id": 44931073, "comment_id": 76840120, "body": "So, there is no exception when the Python code runs?"}, {"owner": {"reputation": 41, "user_id": 8260173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b854168e11f3999a8f2c5e3e85b4447?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Horning", "link": "https://stackoverflow.com/users/8260173/sean-horning"}, "reply_to_user": {"reputation": 14362, "user_id": 2385133, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3a93c5a0f975385738c1f27848f3b50a?s=128&d=identicon&r=PG", "display_name": "Charlie Clark", "link": "https://stackoverflow.com/users/2385133/charlie-clark"}, "edited": false, "score": 0, "creation_date": 1499274544, "post_id": 44931073, "comment_id": 76840255, "body": "Not at all.  It generates the new, filled-in workbooks in the destination folder without raising any errors.  The workbooks that it produces are identical to the template that I loaded except with additional data.  I have keep_vba set to true but is it possible that some aspect of the workbook isn&#39;t being preserved?  Let me know if you need more of the VBA code."}, {"owner": {"reputation": 41, "user_id": 8260173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b854168e11f3999a8f2c5e3e85b4447?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Horning", "link": "https://stackoverflow.com/users/8260173/sean-horning"}, "reply_to_user": {"reputation": 14362, "user_id": 2385133, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3a93c5a0f975385738c1f27848f3b50a?s=128&d=identicon&r=PG", "display_name": "Charlie Clark", "link": "https://stackoverflow.com/users/2385133/charlie-clark"}, "edited": false, "score": 0, "creation_date": 1499278223, "post_id": 44931073, "comment_id": 76842300, "body": "additionally I&#39;ve just noticed that the workbook template is 488 KB itself, whereas the filled in copies are ~180 KB.  All of the macros seem to be preserved, but does this indicate I&#39;m losing important functionality when loading and resaving the template?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1499286345, "post_id": 44931073, "comment_id": 76846960, "body": "Where is <code>acrow</code> inititalized? It seems that <code>Sheets(&quot;Accounts&quot;).Cells(acrow, 1).Value = aNumber</code> is always false and you thus have an infinite loop. In any event, a VBA linear search for a value in a column is poor VBA. It is better to use the <code>Find</code> method of a <code>Range</code> object. That can lead to a dramatic improvement of run-time."}, {"owner": {"reputation": 41, "user_id": 8260173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b854168e11f3999a8f2c5e3e85b4447?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Horning", "link": "https://stackoverflow.com/users/8260173/sean-horning"}, "edited": false, "score": 0, "creation_date": 1499288445, "post_id": 44931073, "comment_id": 76848020, "body": "acrow is initialized as an Integer, beginning at 2. I didn&#39;t write the VBA side of things so I&#39;m not totally sure what that loop is supposed to be doing, not to mention I&#39;m not VBA literate.  but you&#39;re right, it does seem to be not terminating and causing the overflow.  It looks like it continues looping until it comes across an identical account number, or until it hits an empty cell.  I just don&#39;t get why it would terminate when I manually enter the data but not when the same data is automatically entered.."}, {"owner": {"reputation": 41, "user_id": 8260173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b854168e11f3999a8f2c5e3e85b4447?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Horning", "link": "https://stackoverflow.com/users/8260173/sean-horning"}, "edited": false, "score": 0, "creation_date": 1499289196, "post_id": 44931073, "comment_id": 76848357, "body": "So I&#39;ve realized that aNumber is of type Variant.  Which in excel can be anything except for a fixed length string.  Since account numbers occasionally started with 1 or two letters, I was writing them as strings into that field!  This is probably why the comparison is never evaluating true! What other type could I cast the account numbers to so that they are compatible with the excel variant type?  They are usually of the format 555555555 or X555555555"}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 8260173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b854168e11f3999a8f2c5e3e85b4447?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Horning", "link": "https://stackoverflow.com/users/8260173/sean-horning"}, "is_accepted": false, "score": 0, "last_activity_date": 1499345922, "creation_date": 1499345922, "answer_id": 44949614, "question_id": 44931073, "link": "https://stackoverflow.com/questions/44931073/openpyxl-runtime-error-6-overflow/44949614#44949614", "title": "OpenpyXL: Runtime Error 6 Overflow", "body": "<p>John Coleman was correct about the location of the overflow.  The issue was that I was writing aNumber as strings and aNumber was declared in the VBA as Variant type, which according to the docs can represent anything other than a fixed length string.  I simply changed my strategy and wrote account numbers as integers which resolved the problem.  </p>\n"}], "owner": {"reputation": 41, "user_id": 8260173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b854168e11f3999a8f2c5e3e85b4447?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Horning", "link": "https://stackoverflow.com/users/8260173/sean-horning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1499345922, "creation_date": 1499270423, "last_edit_date": 1499345818, "question_id": 44931073, "link": "https://stackoverflow.com/questions/44931073/openpyxl-runtime-error-6-overflow", "title": "OpenpyXL: Runtime Error 6 Overflow", "body": "<p>I have a program utilizing openpyxl that opens two existing Excel files.  One is a simple worksheet with data that needs to be copied into the other file, which is a workbook containing many worksheets and with VBA macros that use this copied data.  When the VBA code runs, though, I get a Runtime Error 6 overflow.  The strange thing is that if I manually copy all of the required cells into the workbook, the macros run without a hitch.  But when this process is automated, even though the values in the cells are identical, this error pops up.  Below is the code which transcribes the data from one worksheet to the other.  </p>\n\n<pre><code>def transcribe_client_data_to_workbooks():\n    _active_sheet_index = 5\n    for client in set(cdict.values()):\n        report_path = r'C:\\Program Files\\Notepad++\\reports' + '\\\\' + \n        string.replace(client,'/','-') + '_report.csv'\n        wb = openpyxl.load_workbook('Bucket-Asset Allocation Model.xlsm', \n             read_only = False, keep_vba = True)\n        ws = wb.active\n        with open(report_path, 'rU') as f:\n            reader = csv.reader(f)\n            for row_index, row in enumerate(reader):\n                for column_index, cell in enumerate(row):\n                    column_letter = get_column_letter((column_index+1))\n                    ws[column_letter+str(row_index+1)] = cell\n            f.close()\n        wb.save('C:\\\\Program Files\\\\Notepad++\\\\workbooks\\\\' + \n        string.replace(client,'/','-') + '_workbook.xlsm')\n</code></pre>\n\n<p>I don't understand why I would receive this error message when this data is automatically copied in, but not when I copy/paste manually. I open the same workbook template each iteration and then save it as a new one after the appropriate data has been copied over.  For reference, here is the section of VBA code where the error occurs.  </p>\n\n<pre><code>Do Until Sheets(\"Raw Data\").Cells(crow, 1).Value = Empty\n                aNumber = Sheets(\"Raw Data\").Cells(crow, 1).Value\n                ticker = Sheets(\"Raw Data\").Cells(crow, 9).Value\n                security = Sheets(\"Raw Data\").Cells(crow, 8).Value\n                mValue = Sheets(\"Raw Data\").Cells(crow, 12).Value\n                bAmt = Sheets(\"Raw Data\").Cells(crow, 18).Value\n                uGain = Sheets(\"Raw Data\").Cells(crow, 20).Value\n                    Do Until Sheets(\"Accounts\").Cells(acrow, 1).Value = aNumber\n                    acrow = acrow + 1\n                    Loop\n</code></pre>\n\n<p>Specifically it occurs on the line that increments acrow:\nacrow = acrow + 1\nI tried changing acrow from an integer to a long, but that just causes the program to run indefinitely  until I click or cancel it, at which point I receive Run-time error '1004', Application defined or object-defined error, on the line directly preceding the increment of acrow.  </p>\n\n<p>Any help would be appreciated, thanks!</p>\n"}, {"tags": ["vba", "excel", "dictionary"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1499270409, "post_id": 44930992, "comment_id": 76837799, "body": "Shouldn&#39;t that be a conditional format instead?"}, {"owner": {"reputation": 141, "user_id": 8098341, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ef1ed0838b7d8560d8c3e198ffd31cf?s=128&d=identicon&r=PG&f=1", "display_name": "anve", "link": "https://stackoverflow.com/users/8098341/anve"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1499272110, "post_id": 44930992, "comment_id": 76838881, "body": "@Mat&#39;sMug I am having trouble figuring out the Conditional Formatting since I am comparing two ranges from different sheets and want a range that isn&#39;t being compared to change cell color. If you have any other suggestions on how to go about that or any other external resources, I&#39;d be very grateful. Thanks!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1499272231, "post_id": 44930992, "comment_id": 76838945, "body": "Figure out what formula you would use in a separate column; make that formula return TRUE for red, FALSE for anything else; once you have that formula, take it and make it your conditional formatting formula. Likely a combination of <code>INDEX</code> and <code>MATCH</code>, or a <code>VLOOKUP</code>."}], "owner": {"reputation": 141, "user_id": 8098341, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ef1ed0838b7d8560d8c3e198ffd31cf?s=128&d=identicon&r=PG&f=1", "display_name": "anve", "link": "https://stackoverflow.com/users/8098341/anve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 355, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499270213, "creation_date": 1499270213, "question_id": 44930992, "link": "https://stackoverflow.com/questions/44930992/using-a-dictionary-to-store-read-values-to-change-cell-color-and-call-macro", "title": "Using a dictionary to store &amp; read values to change cell color and call macro", "body": "<p>I have a form on a sheet (Sheet2), I would like for the values entered in the D column cells to be compared to a list of values on a different sheet (Sheet5, column C). If the value entered in the D column of Sheet2 equals any of the values in Sheet5 column C, I want the F column cell in the same row of Sheet2 to turn red. If D7 = a value in column C of Sheet5, I'd like F7 to turn red. Ultimately I want this to check if any of the values in the D column are associated with macros I have created for certain values but I am trying to avoid hard coding anything.</p>\n\n<p>I have started doing this by setting up a dictionary in my VBA code but I've never used dictionaries before and the code I have so far isn't working as I'd like. With this code, the cells in the F column of Sheet2 do not turn red. </p>\n\n<pre><code>Option Explicit\nSub estArrays()\n\nDim dict As Object\nSet dict = CreateObject(\"Scripting.Dictionary\")\n\n\n' Read to dictionary\nDim i As Long\nFor i = 1 To 17\n    dict.Add Sheet5.Range(\"C\" &amp; i).Value, 1\nNext i\n\n' Read column d\nFor i = 7 To 446\n    If dict.Exists(Sheet2.Range(\"D\" &amp; i).Value) Then\n        ' Set to Red\n        Sheet2.Range(\"F\" &amp; i).Interior.Color = 3\n    End If\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>FYI: values are derived from a \"MID\" formula in column D on Sheet2 so, the values entered in column D are not manually entered. Thanks in advance for any answers/feedback/suggestions. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499271165, "post_id": 44930895, "comment_id": 76838263, "body": "At first glance, you are doing each search <b>twice</b>, once to check for existence, and once to work with. You can get rid of that by putting the result of <code>Match</code> in a <code>Variant</code> variable and check with <code>If IsError(variable)</code>."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499271257, "post_id": 44930895, "comment_id": 76838331, "body": "Another possible speedup is to sort your data ascending and use match with <i>binary search</i> (third parameter = <code>1</code> instead of <code>0</code>)."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499271354, "post_id": 44930895, "comment_id": 76838403, "body": "Also disable events and screen updating, and <b>dont</b> update the status bar at each inner iteration! maybe put it at the outer iteration. Minimize also the VBA-Excel exchange by loading the range of values into an array, etc.."}, {"owner": {"reputation": 119, "user_id": 7436082, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/02192aff66297a0485e0776b8f4a27f1?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Byars", "link": "https://stackoverflow.com/users/7436082/michael-byars"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499276029, "post_id": 44930895, "comment_id": 76841077, "body": "I tried the binary search, but it doesn&#39;t work for this situation.  I already had the screen updating set to false but I do have the events on so that I can stop the code if need be.  I am working on only searching once to see if that makes any difference."}, {"owner": {"reputation": 119, "user_id": 7436082, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/02192aff66297a0485e0776b8f4a27f1?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Byars", "link": "https://stackoverflow.com/users/7436082/michael-byars"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499276132, "post_id": 44930895, "comment_id": 76841133, "body": "as for the status bar updating, it&#39;s the only way I know of to keep track of the progress.  Otherwise I am just staring at blank screen for a couple of hours."}, {"owner": {"reputation": 119, "user_id": 7436082, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/02192aff66297a0485e0776b8f4a27f1?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Byars", "link": "https://stackoverflow.com/users/7436082/michael-byars"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499276199, "post_id": 44930895, "comment_id": 76841175, "body": "I have never worked with arrays.  How would I go about replicating this using arrays?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499276233, "post_id": 44930895, "comment_id": 76841189, "body": "To use binary search you need two things: 1- sort the data ascending and 2- after each match, check also if it is an <i>exact match</i> because it may be not the case."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499276296, "post_id": 44930895, "comment_id": 76841231, "body": "Progress bar: You dont need to remove completely the progress bar, just to refresh it after each &quot;batch&quot; of loops. What I was saying is move it to the outher loop for example."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499276417, "post_id": 44930895, "comment_id": 76841298, "body": "Arrays: 1- make <code>LegTable</code> a Variant and put the <code>.Value2</code> of the range inside. 2- Load also the range &quot;B1:B&quot; &amp; f` into an array, for example."}, {"owner": {"reputation": 119, "user_id": 7436082, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/02192aff66297a0485e0776b8f4a27f1?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Byars", "link": "https://stackoverflow.com/users/7436082/michael-byars"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499284262, "post_id": 44930895, "comment_id": 76845742, "body": "so, I got the variable suggestion to work with the binary, but unfortunetly, the binary won&#39;t work right (although it was going faster until it stopped working).  I think I am down to using the array method.  I guess I will be researching how to do that tomorow.  Thanks for the ideas."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499289707, "post_id": 44930895, "comment_id": 76848598, "body": "Note that <code>MATCH</code> with binary search does not perform an &quot;exact&quot; match, but somehow the &quot;closest&quot;. After it returns to you an index, check <i>again</i> if that cell exactly equals what you are searching."}], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 7436082, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/02192aff66297a0485e0776b8f4a27f1?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Byars", "link": "https://stackoverflow.com/users/7436082/michael-byars"}, "is_accepted": true, "score": 0, "last_activity_date": 1499434793, "creation_date": 1499434793, "answer_id": 44972282, "question_id": 44930895, "link": "https://stackoverflow.com/questions/44930895/faster-matching-code/44972282#44972282", "title": "Faster matching code", "body": "<p>Thank you very much A.S.H.  with your help, I not only learned alot about using arrays, but also ended up cutting my runtime from about 90 minutes to just over 3 minutes.  This is my final working code that used a combination of your suggestions. </p>\n\n<pre><code>Sub BuildingLines()\n'strings together segments into trip\n\nDim i As Long\nDim z As Long\nDim c As Long\nDim f As Long\nDim l As Long\nDim LegTable As Range\nDim TurnTable As Range\nDim FirstTurn() As Variant\nDim NextTurn() As Variant\nDim y As String\nDim b As String\nDim FTtext As String\nDim wb As Workbook\nDim ref As Worksheet\n\nSet wb = ThisWorkbook\nSet ref = wb.Sheets(\"Ref\")\n\nWith Sheets(\"MoveData\")\nz = .Cells(1, 1).End(xlDown).Row\nx = .Cells(2, 1).End(xlToRight).Column\nRange(.Cells(1, 3), (.Cells(z, x + 3))).Clear\nz = .Cells(1, 1).End(xlDown).Row\ng = ref.Cells(24, 1).End(xlDown).Row\n\nFor a = 24 To g\n\n    If ref.Cells(a, 2) = \"\" Then GoTo NextA\n\n    f = ref.Cells(a, 2)\n    c = ref.Cells(a, 3)\n    l = ref.Cells(a, 4)\n    Set LegTable = Range(.Cells(f, 1), .Cells(l, 1))\n    Set TurnTable = Range(.Cells(f, 1), .Cells(l, 2))\n\n    FirstTurn = TurnTable\n\n\n        .Sort.SortFields.Clear\n        .Sort.SortFields.Add Key:=LegTable, SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    With .Sort\n        .SetRange TurnTable\n        .Header = xlNo\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\n    For i = f To l\n\n        Application.StatusBar = \"Progress: Step 5 of 20 - Building lines for \" &amp; ref.Cells(a, 1) &amp; \" (\" &amp; (a - 23) &amp; \" A/C types of \" &amp; (g - 23) &amp; \") : \" &amp; (i - f) + 1 &amp; \" Legs of \" &amp; c &amp; \" analyzed. (\" &amp; Format(((i - f) + 1) / c, \"Percent\") &amp; \")\"\n    DoEvents\n\n    y = 0\n    b = 0\n\n        y = Application.Match(.Cells(i, 2), LegTable, 1)\n        If .Cells(i, 2) &lt;&gt; FirstTurn(y, 1) Then GoTo NextI\n\n        NextLeg = NextLeg + 1\n        ReDim Preserve NextTurn(0, 1 To NextLeg)\n        NextTurn(0, NextLeg) = FirstTurn(y, 2)\n\n            Do\n                FTtext = FirstTurn(y, 2)\n                On Error GoTo errhdlr\n                b = Application.WorksheetFunction.Match(FTtext, LegTable, 1)\n                If FTtext &lt;&gt; FirstTurn(b, 1) Then GoTo NextI\n\n                NextLeg = NextLeg + 1\n                ReDim Preserve NextTurn(0, 1 To NextLeg)\n                NextTurn(0, NextLeg) = FirstTurn(b, 2)\n                y = b\n            Loop\n\nerrhdlr:\n    Resume NextI\nNextI:\n\n    If NextLeg &gt; 0 Then Range(.Cells(i, 3), .Cells(i, NextLeg + 2)).Value = NextTurn\n    Erase NextTurn\n    NextLeg = 0\n    Next i\n\nSet LegTable = Nothing\nSet TurnTable = Nothing\nErase NextTurn\nErase FirstTurn\n\nNextA:\nNext a\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>I first tried using just the arrays, but the Match function was WAY SLOWER in the arrays.  So I ended up using the Match to find the index and then grabbed the data from the array to build my second array which then became my output.  I can't wait to adapt my new found knowledge with the rest of this project and cut my runtime from 2+ hours to just minutes!! Thanks, again!!!</p>\n"}], "owner": {"reputation": 119, "user_id": 7436082, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/02192aff66297a0485e0776b8f4a27f1?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Byars", "link": "https://stackoverflow.com/users/7436082/michael-byars"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 44972282, "answer_count": 1, "score": 0, "last_activity_date": 1499434793, "creation_date": 1499269904, "last_edit_date": 1531164843, "question_id": 44930895, "link": "https://stackoverflow.com/questions/44930895/faster-matching-code", "title": "Faster matching code", "body": "<p>I have a code that takes a list of Airline flightlegs and matches them up to give me full lines of flight.  The code works but.....  it takes a very long time (45-60 min for just 35,000 rows) due to the amount of data it has to go through.  This is compounded and the overall code takes about 2 hours to run.  Is there a faster method to get the same results?</p>\n\n<p>Here is my current code that really bogs down the entire process:</p>\n\n<pre><code>Sub BuildingLines()\n'strings together segments into trip\n\nDim i As Long\nDim z As Long\nDim T As Long\nDim c As Long\nDim a As Long\nDim f As Long\nDim l As Long\nDim g As Long\n\n\nDim y As String\nDim b As String\n\nSet ref = Sheets(\"Ref\")\n\nWith Sheets(\"MoveData\")\nz = .Cells(1, 1).End(xlDown).Row\nx = .Cells(2, 1).End(xlToRight).Column\nRange(.Cells(1, 3), (.Cells(z, x + 3))).Clear\nz = .Cells(1, 1).End(xlDown).Row\ng = ref.Cells(24, 1).End(xlDown).Row\n\nFor a = 24 To g\n\n    If ref.Cells(a, 2) = \"\" Then GoTo nexta\n\n    f = ref.Cells(a, 2)\n    c = ref.Cells(a, 3)\n    l = ref.Cells(a, 4)\n    Set LegTable = Range(.Cells(f, 1), .Cells(l, 1))\n\n    For i = f To l\n\n        Application.StatusBar = \"Progress: Step 5 of 20 - Building lines for \" &amp; ref.Cells(a, 1) &amp; \" (\" &amp; (a - 23) &amp; \" A/C types of \" &amp; (g - 23) &amp; \") : \" &amp; (i - f) + 1 &amp; \" Legs of \" &amp; c &amp; \" analyzed. (\" &amp; Format(((i - f) + 1) / c, \"Percent\") &amp; \")\"\n    DoEvents\n\n    'On Error GoTo NextI\n\n    If IsError(Application.Match(.Cells(i, 2), LegTable, 0)) Then\n        GoTo nexti\n\n    Else\n            y = Application.Match(.Cells(i, 2), LegTable, 0) + f - 1\n            .Cells(i, 1).End(xlToRight).Offset(0, 1).Value2 = .Cells(y, 2)\n\n                Do\n                'On Error GoTo NextI\n                If IsError(Application.Match(.Cells(y, 2), LegTable, 0)) Then\n\n                GoTo nexti\n                Else\n                    b = Application.Match(.Cells(y, 2), LegTable, 0) + f - 1\n                    h = .Cells(b, 2)\n                    .Cells(i, 1).End(xlToRight).Offset(0, 1) = h\n                    y = b\n                End If\n                Loop\nnexti:\n\n        End If\n\n    b = \"\"\n    y = \"\"\n\n    Next i\nnexta:\nNext a\nEnd With\nEnd Sub\n</code></pre>\n\n<p>The data is all string data of about 50+ chars.</p>\n\n<p>Thank you for any recomendations.</p>\n"}, {"tags": ["vba", "performance", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7914387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a955dd37d14ac030fdaee1e7f651479?s=128&d=identicon&r=PG&f=1", "display_name": "Vist", "link": "https://stackoverflow.com/users/7914387/vist"}, "edited": false, "score": 0, "creation_date": 1499440399, "post_id": 44932606, "comment_id": 76923575, "body": "I am getting a debug error at the following line:         If ur(r, c) = &quot;0&quot; Then"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 3, "user_id": 7914387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a955dd37d14ac030fdaee1e7f651479?s=128&d=identicon&r=PG&f=1", "display_name": "Vist", "link": "https://stackoverflow.com/users/7914387/vist"}, "edited": false, "score": 0, "creation_date": 1499445474, "post_id": 44932606, "comment_id": 76926734, "body": "What is the first cell and last cell on your sheet?"}, {"owner": {"reputation": 3, "user_id": 7914387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a955dd37d14ac030fdaee1e7f651479?s=128&d=identicon&r=PG&f=1", "display_name": "Vist", "link": "https://stackoverflow.com/users/7914387/vist"}, "edited": false, "score": 0, "creation_date": 1499699014, "post_id": 44932606, "comment_id": 77004808, "body": "The core filter is from cell o1:o859"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 3, "user_id": 7914387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a955dd37d14ac030fdaee1e7f651479?s=128&d=identicon&r=PG&f=1", "display_name": "Vist", "link": "https://stackoverflow.com/users/7914387/vist"}, "edited": false, "score": 0, "creation_date": 1499740292, "post_id": 44932606, "comment_id": 77023069, "body": "I made some changes (issue should be fixed as well). I customized it to search column O only; I also tested it on a small data set. Please try it again and accept the answer if it works, and let me know if it&#39;s faster than the initial one, if possible"}, {"owner": {"reputation": 3, "user_id": 7914387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a955dd37d14ac030fdaee1e7f651479?s=128&d=identicon&r=PG&f=1", "display_name": "Vist", "link": "https://stackoverflow.com/users/7914387/vist"}, "edited": false, "score": 0, "creation_date": 1500044263, "post_id": 44932606, "comment_id": 77183271, "body": "This is brilliant! Thank you. It works much faster now."}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 0, "last_activity_date": 1499739997, "last_edit_date": 1499739997, "creation_date": 1499275876, "answer_id": 44932606, "question_id": 44930811, "link": "https://stackoverflow.com/questions/44930811/vba-excel-small-code-optimization-for-on-worksheet-open-macro/44932606#44932606", "title": "VBA EXCEL - Small code optimization for on-worksheet open macro", "body": "<p>Try this version:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Activate()\n  Const LAST_ROW = 859\n  Const CL = 15             'O column\n  Const RO = 14\n  Const HIDE_ROWS = True    'or False\n\n  Dim ur As Variant, hr As Range, R As Long\n\n  Application.ScreenUpdating = False\n\n  Rows(RO &amp; \":\" &amp; LAST_ROW).EntireRow.AutoFit\n\n  ur = Range(Cells(1, CL), Cells(LAST_ROW, CL))\n  For R = 1 To LAST_ROW\n    If Len(ur(R, 1)) = 0 Then Exit For\n    If ur(R, 1) = 0 Then\n        If hr Is Nothing Then Set hr = Cells(R, 1) Else: Set hr = Union(hr, Cells(R, 1))\n    End If\n  Next\n  hr.EntireRow.Hidden = HIDE_ROWS\n\n  Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7914387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a955dd37d14ac030fdaee1e7f651479?s=128&d=identicon&r=PG&f=1", "display_name": "Vist", "link": "https://stackoverflow.com/users/7914387/vist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 44932606, "answer_count": 1, "score": 0, "last_activity_date": 1500309327, "creation_date": 1499269688, "last_edit_date": 1500309327, "question_id": 44930811, "link": "https://stackoverflow.com/questions/44930811/vba-excel-small-code-optimization-for-on-worksheet-open-macro", "title": "VBA EXCEL - Small code optimization for on-worksheet open macro", "body": "<p>I am looking to speed up an on-worksheet open macro I have in excel.</p>\n\n<p>Every time the worksheet is opened, I would like it to autofit x rows and then hide any rows that have a 0 in it.</p>\n\n<p>The macro works fine, but I think there must be a better/faster way to hide all relevant rows. Any help would be appreciated.</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n    Rows(\"14:859\").EntireRow.AutoFit\nApplication.ScreenUpdating = False\nDim c As Range\n    For Each c In Range(\"O1:O859\").Cells\n        If c.Value = \"0\" Then\n            c.EntireRow.Hidden = True\n        End If\n    Next c\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 53, "user_id": 8185006, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dbd412a58ad1ab14829e4ff9a90c65fe?s=128&d=identicon&r=PG&f=1", "display_name": "vba_n00b", "link": "https://stackoverflow.com/users/8185006/vba-n00b"}, "edited": false, "score": 0, "creation_date": 1499278735, "post_id": 44930755, "comment_id": 76842571, "body": "One more question: I added the following code to add 9 rows and am now getting a type mismatch: &#39;code&#39; wsSheet.Rows(&quot;1, 10&quot;).Insert Shift:=xlDown , CopyOrgin:=xlFormatFromLeftOrAbove &#39;code&#39; Any thoughts?"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 8185006, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dbd412a58ad1ab14829e4ff9a90c65fe?s=128&d=identicon&r=PG&f=1", "display_name": "vba_n00b", "link": "https://stackoverflow.com/users/8185006/vba-n00b"}, "edited": false, "score": 0, "creation_date": 1499271552, "post_id": 44931151, "comment_id": 76838536, "body": "Thank you that fixed it! So I was not being specific enough with my command? Fortunately, there is nothing that has been deleted that should not have been."}], "tags": [], "owner": {"reputation": 34, "user_id": 8121313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65bfdaf9a21cd7955b918613bd4f28d9?s=128&d=identicon&r=PG&f=1", "display_name": "KarmaWin", "link": "https://stackoverflow.com/users/8121313/karmawin"}, "is_accepted": true, "score": 0, "last_activity_date": 1499270703, "creation_date": 1499270703, "answer_id": 44931151, "question_id": 44930755, "link": "https://stackoverflow.com/questions/44930755/delete-command-is-deleting-data-rather-than-just-the-columns/44931151#44931151", "title": "Delete command is deleting data rather than just the columns", "body": "<p>To have the columns deleted on all the desired worksheets I think you should write:</p>\n\n<pre><code>wsSheet.Range(\"A:H\").Delete\n</code></pre>\n\n<p>Also do you mean that columns that should not  have be deleted were deleted with your code?</p>\n"}], "owner": {"reputation": 53, "user_id": 8185006, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dbd412a58ad1ab14829e4ff9a90c65fe?s=128&d=identicon&r=PG&f=1", "display_name": "vba_n00b", "link": "https://stackoverflow.com/users/8185006/vba-n00b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 44931151, "answer_count": 1, "score": 1, "last_activity_date": 1499270703, "creation_date": 1499269537, "last_edit_date": 1499270134, "question_id": 44930755, "link": "https://stackoverflow.com/questions/44930755/delete-command-is-deleting-data-rather-than-just-the-columns", "title": "Delete command is deleting data rather than just the columns", "body": "<p>I am currently trying to reformat some sheets that receive their input from other macros. The input to the sheets is fine, but once I try to delete the columns that I need to get rid of (A:H) it only happens on one sheet and all of the data disappears on that sheet.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Dim wsSheet As Worksheet\nDim current_flt_date, dept_time As Date\nDim dept_station, arrv_station, subfleet_type, route, red_eye As String\nDim current_flt_number As Integer\n\nFor Each wsSheet In ThisWorkbook.Worksheets\n\n    If Not wsSheet.Name = \"Sheet3\" Then\n        wsSheet.Rows(1).Value = Worksheets(\"Sheet3\").Rows(1).Value\n        lCol = Cells(1, Columns.Count).End(xlToLeft).Column\n        wsSheet.Cells(1, lCol + 1) = \"Qty Loaded\"\n        wsSheet.Rows(1).Font.Bold = True\n        wsSheet.Rows(1).Font.Underline = True\n        current_flt_date = wsSheet.Cells(2, 1)\n        Debug.Print current_flt_date\n        dept_station = wsSheet.Cells(2, 2)\n        current_flt_number = wsSheet.Cells(2, 3)\n        dept_time = wsSheet.Cells(2, 4)\n        arrv_station = wsSheet.Cells(2, 5)\n        subfleet_type = wsSheet.Cells(2, 6)\n        Debug.Print subfleet_type\n        route = wsSheet.Cells(2, 7)\n        red_eye = wsSheet.Cells(2, 8)\n        Range(\"A:H\").Delete\n\n    End If\n\nNext wsSheet\n</code></pre>\n\n<p>I added some screens as well. The first one shows what happens without the delete and the second is with the delete. </p>\n\n<p><a href=\"https://i.stack.imgur.com/P7Lo2.jpg\" rel=\"nofollow noreferrer\">Without delete</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/M7Tb1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M7Tb1.jpg\" alt=\"With delete\"></a></p>\n"}, {"tags": ["vba", "excel", "conditional-formatting"], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1499272024, "last_edit_date": 1499272024, "creation_date": 1499269370, "answer_id": 44930708, "question_id": 44930646, "link": "https://stackoverflow.com/questions/44930646/excel-vba-remove-conditional-formatting-keep-borders/44930708#44930708", "title": "Excel VBA Remove Conditional formatting keep borders", "body": "<p>Inside the <code>With aCell</code> block, you can try adding this:</p>\n\n<pre><code>Dim b as long\nFor b = 1 To 12\n  .Borders(b).LineStyle = .DisplayFormat.Borders(b).LineStyle\n  .Borders(b).Color = .DisplayFormat.Borders(b).Color\n  .Borders(b).Weight = .DisplayFormat.Borders(b).Weight\nNext\n</code></pre>\n\n<p>p.s. I used numeric values for the enumeration <code>xlEdgeTop</code>, <code>xlEdgeLeft</code> etc..., to shorten the code with a loop.</p>\n"}], "owner": {"reputation": 335, "user_id": 4920363, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fcfc13b80adfc16e2e70235c957977a8?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4920363/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 453, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1499272024, "creation_date": 1499269134, "question_id": 44930646, "link": "https://stackoverflow.com/questions/44930646/excel-vba-remove-conditional-formatting-keep-borders", "title": "Excel VBA Remove Conditional formatting keep borders", "body": "<p>I have found a <a href=\"https://stackoverflow.com/questions/25768023/excel-copy-conditional-formatting-remove-rules-keep-format\">thread where the conditional formatting is removed but the format is kept</a>. </p>\n\n<p>If I run the script I am losing the conditional formatting of the borders. Is it also possible to keep all information on the border?</p>\n\n<p>Best,\nAlex</p>\n"}, {"tags": ["validation", "ms-access", "vba", "ms-access-forms"], "comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1499269368, "post_id": 44930514, "comment_id": 76837077, "body": "Have you tried moving the <code>Before Update</code> event validation to the control instead of the Form?"}, {"owner": {"reputation": 165, "user_id": 8066894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f252696fd21bda400a5c6aaf08fa5e4?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8066894/steve"}, "reply_to_user": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1499270630, "post_id": 44930514, "comment_id": 76837946, "body": "I am checking the before update event in the control.  Sorry for the lack of clarity.  I have edited my comment to reflect that."}], "answers": [{"tags": [], "owner": {"reputation": 165, "user_id": 8066894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f252696fd21bda400a5c6aaf08fa5e4?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8066894/steve"}, "is_accepted": true, "score": 0, "last_activity_date": 1499276815, "creation_date": 1499276815, "answer_id": 44932857, "question_id": 44930514, "link": "https://stackoverflow.com/questions/44930514/validate-single-record-on-continuous-form/44932857#44932857", "title": "Validate single record on continuous form", "body": "<p>This seems to just be a reference issue as I am looking on the database on two completely separate networks.  The original uses all Office 16.0 libraries whereas the instance I was having the issue with was using Office 15.0 libraries.  I played around with the original and it works fine, even if all the locations become bad at the same time.</p>\n"}], "owner": {"reputation": 165, "user_id": 8066894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f252696fd21bda400a5c6aaf08fa5e4?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8066894/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 44932857, "answer_count": 1, "score": 0, "last_activity_date": 1499276815, "creation_date": 1499268795, "last_edit_date": 1499270589, "question_id": 44930514, "link": "https://stackoverflow.com/questions/44930514/validate-single-record-on-continuous-form", "title": "Validate single record on continuous form", "body": "<p>So I have a form and a table called Variables.  The table is simply the fields VarID, VarDescription, and VarValue.  It's only three items that are all network locations of things.  The VarValue is the only thing that can be changed through the form, and thus it is the only thing validated.  I validate those records on the form with the Before Update Event in the control by using logic such as:</p>\n\n<pre><code>    If Me.VarID = 1 Then\n        If Me.Tex like \"*:\\* Then....\n        End If\n        If GetAttr(Me.Tex) = vbDirectory Then\n        End\n    End If\n\n    If Me.VarID = 2 Then\n        If Me.Tex like \"*:\\* Then....\n        End If\n        If GetAttr(Me.Tex) = vbNormal Or GetAttr(Me.Tex) = vbArchive Then\n        End If\n    End If\n</code></pre>\n\n<p>This all works great.  However my issue comes in when multiple locations become invalid at once.  I get stuck in one cell because the other VarValue's are invalid as well.  How can I validate only the cell I have changed?  I tried playing around with various Dirty and Focus events/methods, but those seem to be form specific, not cell specific.</p>\n"}, {"tags": ["vba", "loops", "row", "rows"], "comments": [{"owner": {"reputation": 6233, "user_id": 5741073, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1uZeL.jpg?s=128&g=1", "display_name": "TomServo", "link": "https://stackoverflow.com/users/5741073/tomservo"}, "edited": false, "score": 1, "creation_date": 1499273369, "post_id": 44930390, "comment_id": 76839639, "body": "What is the problem?  What is the expected behavior? What is the undesired behavior?"}, {"owner": {"reputation": 31, "user_id": 8260124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5394f346b2c57b6796cc68e88fb2ac6b?s=128&d=identicon&r=PG&f=1", "display_name": "NAMB", "link": "https://stackoverflow.com/users/8260124/namb"}, "reply_to_user": {"reputation": 6233, "user_id": 5741073, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1uZeL.jpg?s=128&g=1", "display_name": "TomServo", "link": "https://stackoverflow.com/users/5741073/tomservo"}, "edited": false, "score": 0, "creation_date": 1499276161, "post_id": 44930390, "comment_id": 76841151, "body": "I&#39;m expecting the rows to be deleted when the macro is finished running but they aren&#39;t."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 8260124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5394f346b2c57b6796cc68e88fb2ac6b?s=128&d=identicon&r=PG&f=1", "display_name": "NAMB", "link": "https://stackoverflow.com/users/8260124/namb"}, "edited": false, "score": 0, "creation_date": 1499276198, "post_id": 44932076, "comment_id": 76841173, "body": "Yeah i have screen updating turned off, then turned back on at the end"}, {"owner": {"reputation": 34, "user_id": 8121313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65bfdaf9a21cd7955b918613bd4f28d9?s=128&d=identicon&r=PG&f=1", "display_name": "KarmaWin", "link": "https://stackoverflow.com/users/8121313/karmawin"}, "reply_to_user": {"reputation": 31, "user_id": 8260124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5394f346b2c57b6796cc68e88fb2ac6b?s=128&d=identicon&r=PG&f=1", "display_name": "NAMB", "link": "https://stackoverflow.com/users/8260124/namb"}, "edited": false, "score": 0, "creation_date": 1499277038, "post_id": 44932076, "comment_id": 76841641, "body": "ha sorry my mistake I thought your macro was slow to run. Maybe it is because it is not deleting the rows in the correct sheet? <code>ResultSheet.Rows(RowCounter).EntireRow.Delete</code>"}], "tags": [], "owner": {"reputation": 34, "user_id": 8121313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65bfdaf9a21cd7955b918613bd4f28d9?s=128&d=identicon&r=PG&f=1", "display_name": "KarmaWin", "link": "https://stackoverflow.com/users/8121313/karmawin"}, "is_accepted": false, "score": 0, "last_activity_date": 1499274025, "creation_date": 1499274025, "answer_id": 44932076, "question_id": 44930390, "link": "https://stackoverflow.com/questions/44930390/vba-looping-through-range-and-deleting-rows-based-on-value/44932076#44932076", "title": "VBA Looping through range and deleting rows based on value", "body": "<p>Does your bigger macro have screen updating off before the row deletion?</p>\n\n<p>Maybe you can try this line before you delete the rows: <code>Application.ScreenUpdating = False</code></p>\n\n<p>And turn it on at the end: <code>Application.ScreenUpdating = true</code></p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 8260124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5394f346b2c57b6796cc68e88fb2ac6b?s=128&d=identicon&r=PG&f=1", "display_name": "NAMB", "link": "https://stackoverflow.com/users/8260124/namb"}, "is_accepted": true, "score": 1, "last_activity_date": 1499279012, "creation_date": 1499279012, "answer_id": 44933432, "question_id": 44930390, "link": "https://stackoverflow.com/questions/44930390/vba-looping-through-range-and-deleting-rows-based-on-value/44933432#44933432", "title": "VBA Looping through range and deleting rows based on value", "body": "<p>It turns out that it was deleting rows but that would move the row up to #3 again, so then it would essentially skip that row by moving to row #4..  this is the workaround i figured out</p>\n\n<pre><code>    If SgLendsQ.Value = True Then\n        LastRowResults = ResultSheet.Range(\"A1\").End(xlDown).Row\n        DelC = 3\n        For Counter = 3 To LastRowResults\n            If ResultSheet.Range(\"I\" &amp; DelC).Value = \"No\" Then\n                ResultSheet.Rows(DelC).EntireRow.Delete\n            ElseIf ResultSheet.Range(\"I\" &amp; DelC).Value = \"Yes\" Then\n                DelC = DelC + 1\n            End If\n        Next Counter\n    End If\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8260124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5394f346b2c57b6796cc68e88fb2ac6b?s=128&d=identicon&r=PG&f=1", "display_name": "NAMB", "link": "https://stackoverflow.com/users/8260124/namb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2409, "favorite_count": 1, "accepted_answer_id": 44933432, "answer_count": 2, "score": 1, "last_activity_date": 1499279012, "creation_date": 1499268480, "last_edit_date": 1499270045, "question_id": 44930390, "link": "https://stackoverflow.com/questions/44930390/vba-looping-through-range-and-deleting-rows-based-on-value", "title": "VBA Looping through range and deleting rows based on value", "body": "<p>I'm not sure why but i'm having a lot of difficulty running this code to loop through the range and delete the rows based on the value.  This code is part of a bigger macro i'm writing but it all runs well up to this point. </p>\n\n<pre><code>Dim Lastrowresults as integer\nDim Counter as integer\nDim Resultsheet as worksheet\nDim rowcounter as integer\n\nSet resultsheet=sheets(\"Search Results\")\nLastRowResults = ResultSheet.Range(\"A1\").End(xlDown).Row\n    For Counter = 3 To LastRowResults\n      If ResultSheet.Range(\"I\" &amp; Counter).Value = \"No\" Then\n         RowCounter = ResultSheet.Range(\"I\" &amp; Counter).Row\n         Rows(RowCounter).EntireRow.Delete\n     End If\n    Next Counter \n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1499269577, "post_id": 44930396, "comment_id": 76837225, "body": "Note that <code>.Find</code> will return <code>Nothing</code> whenever it doesn&#39;t find a match for what it&#39;s looking for: this code will throw run-time error 91 in these cases. You should <b>always</b> only ever access members of the result of a <code>Find</code> call <i>after</i> verifying that it contains a valid object reference, e.g. <code>If Not findrng Is Nothing Then</code>"}], "tags": [], "owner": {"reputation": 55, "user_id": 7307138, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/fd464931c80a9c91673b2e2e91d2c5e1?s=128&d=identicon&r=PG&f=1", "display_name": "simpleMan", "link": "https://stackoverflow.com/users/7307138/simpleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1499268498, "creation_date": 1499268498, "answer_id": 44930396, "question_id": 44930216, "link": "https://stackoverflow.com/questions/44930216/how-to-find-and-return-a-column-index-in-vba/44930396#44930396", "title": "How to find and return a column index in VBA?", "body": "<p>Ah sorry guys I just found it. It was simple as hell...</p>\n\n<pre><code>ind1 = findrng.Find(\"COUNTRY\").Column\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 78, "user_id": 4503467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f76f85dd126ca3f12e012fbc58e2f71?s=128&d=identicon&r=PG&f=1", "display_name": "emilyn", "link": "https://stackoverflow.com/users/4503467/emilyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1499268510, "creation_date": 1499268510, "answer_id": 44930406, "question_id": 44930216, "link": "https://stackoverflow.com/questions/44930216/how-to-find-and-return-a-column-index-in-vba/44930406#44930406", "title": "How to find and return a column index in VBA?", "body": "<p>I am confused to what you are asking. </p>\n\n<p>Is your problem that you would like to be able to search your first row for headers, and retrieve a specific column based on the header?</p>\n\n<pre><code>thisRow = 1\n\nsearchCol = Sheet1.Cells(thisRow, 1).EntireRow.Find(What:=\"someString\", LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=False).Column\n</code></pre>\n\n<p>? Then you can access that column with the <code>.column</code> accessor. </p>\n"}], "owner": {"reputation": 55, "user_id": 7307138, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/fd464931c80a9c91673b2e2e91d2c5e1?s=128&d=identicon&r=PG&f=1", "display_name": "simpleMan", "link": "https://stackoverflow.com/users/7307138/simpleman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11196, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1499268510, "creation_date": 1499267998, "last_edit_date": 1531164843, "question_id": 44930216, "link": "https://stackoverflow.com/questions/44930216/how-to-find-and-return-a-column-index-in-vba", "title": "How to find and return a column index in VBA?", "body": "<p>I am creating a VBA code to clear some data from multiple excel files. The problem is that the positions of the headers are not fixed and the columns slip away when I put together the files. \nI have to find the column index based on header name and assign them to variables.</p>\n\n<p>I declared the range of the header to a variable.\n<strong>How can I return the column index to a variable?</strong> \nI have never done this before that is why I am asking you guys.\nAt my first attempt I was thinking something like this:</p>\n\n<pre><code>Set findrng = sourceWS.Range(Cells(1, 1), Cells(1, 100))\nindex1 = findrng.Find(\"COUNTRY\")\n</code></pre>\n\n<p>index1 should store an integer like 1 or 21 ...</p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1499272285, "post_id": 44930368, "comment_id": 76838967, "body": "@Mat&#39;s Mug  I must doing something wrong here guys as that method did not work for me at all. I am wondering, as I have manged to create another copy of the file with DNU in the name, is just to delete the original leaving the copy with DNU in it. Is that sensible? What would be the best way to work it into my code? and for some reason I get .txt actually in the file name and sheet name, can you see what I need to remove? I tried taking part of this line out fileToOpen = Application.GetOpenFilename(&quot;Text Files (*.txt), *.txt&quot;) but it didn&#39;t work either!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "edited": false, "score": 0, "creation_date": 1499272488, "post_id": 44930368, "comment_id": 76839094, "body": "@Dyhouse learn to use the debugger. Use F9 to set/clear breakpoints, F8 to step-through, Shift+F8 to step-over, and you can drag the yellow line to any executable instruction in the scope you&#39;re breaking in. Use the immediate pane (Ctrl+G) and the <i>locals</i> toolwindows to examine variables&#39; values and how they change when you assign them."}, {"owner": {"reputation": 823, "user_id": 7746454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95207c62ad1aed75ade3f53fb7216308?s=128&d=identicon&r=PG&f=1", "display_name": "Busse", "link": "https://stackoverflow.com/users/7746454/busse"}, "reply_to_user": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "edited": false, "score": 0, "creation_date": 1499272490, "post_id": 44930368, "comment_id": 76839097, "body": "@Dyhouse are you receiving an error? Or is it just outright not working.  Can you edit your original post and show the full code that you are trying with Name?"}, {"owner": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "edited": false, "score": 0, "creation_date": 1499273544, "post_id": 44930368, "comment_id": 76839738, "body": "@Busse I have updated my original post. Please let me know where I am going wrong. I really appreciate the help. I am fairly new to the VBA world so I am learning all the time."}, {"owner": {"reputation": 823, "user_id": 7746454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95207c62ad1aed75ade3f53fb7216308?s=128&d=identicon&r=PG&f=1", "display_name": "Busse", "link": "https://stackoverflow.com/users/7746454/busse"}, "reply_to_user": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "edited": false, "score": 0, "creation_date": 1499273710, "post_id": 44930368, "comment_id": 76839834, "body": "@Dyhouse, I don&#39;t actually see the function <code>Name</code> written anywhere in the code.  I see you declared your variables and set them, but now you need to write <code>Name oldPath newPath</code> underneath the assignment of the variables. Did you not have this or did you just forget to add it when you updated your original post?"}, {"owner": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "edited": false, "score": 0, "creation_date": 1499273862, "post_id": 44930368, "comment_id": 76839913, "body": "@Busse when I try and add &#39;Name oldPath newPath&#39; I get a compile error"}, {"owner": {"reputation": 823, "user_id": 7746454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95207c62ad1aed75ade3f53fb7216308?s=128&d=identicon&r=PG&f=1", "display_name": "Busse", "link": "https://stackoverflow.com/users/7746454/busse"}, "edited": false, "score": 0, "creation_date": 1499274036, "post_id": 44930368, "comment_id": 76840019, "body": "Your oldPath and newPath variables call a variable called &quot;Test&quot;.  I don&#39;t see declaration or assignment of that variable."}, {"owner": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "edited": false, "score": 0, "creation_date": 1499335064, "post_id": 44930368, "comment_id": 76866391, "body": "@Busse with a bit playing around, I have actually managed to get this to work. Thank you again for your help."}], "tags": [], "owner": {"reputation": 823, "user_id": 7746454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95207c62ad1aed75ade3f53fb7216308?s=128&d=identicon&r=PG&f=1", "display_name": "Busse", "link": "https://stackoverflow.com/users/7746454/busse"}, "is_accepted": true, "score": 2, "last_activity_date": 1499269652, "last_edit_date": 1499269652, "creation_date": 1499268432, "answer_id": 44930368, "question_id": 44930207, "link": "https://stackoverflow.com/questions/44930207/overwrite-initial-filename/44930368#44930368", "title": "Overwrite initial filename", "body": "<p>There is a built-in function in VBA called <code>Name</code>, it works as follows:</p>\n\n<pre><code>Name [old/current path/name] [new path/name]\n</code></pre>\n\n<p>So for your code, you would want to do:</p>\n\n<pre><code>Name (\"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment Limited\\\" &amp; Filename) (\"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment Limited\\\" &amp; Filename &amp; \"!DNU!\")\n</code></pre>\n\n<p>I would recommend assigning variables to the paths, call them oldpath and newpath. So</p>\n\n<pre><code>Dim oldPath As String, newPath as String\n\noldPath = \"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment Limited\\\" &amp; sheetname &amp; \".txt\"\nnewPath = \"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment Limited\\\" &amp; sheetname &amp; \"!DNU!.txt\"\n\nName oldPath newPath\n</code></pre>\n\n<p>BUT, the file needs to be closed before you can do this.  So make sure the file is closed by looping through the open workbooks and closing them all.  Then by running this, it should rename the file from the old name to the new name.</p>\n\n<p>I would recommend making a new workbook and placing it on your desktop and testing first before using it with your real code/workbooks.  Make a new workbook, save it to your desktop, call it test.xlsx and then close it.  In a separate workbook start a new Sub and paste the code in, but change the oldPath and newPath to reflect your desktop path and test.xlsx file.  Give this a shot.</p>\n"}], "owner": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 44930368, "answer_count": 1, "score": 0, "last_activity_date": 1499273468, "creation_date": 1499267978, "last_edit_date": 1499273468, "question_id": 44930207, "link": "https://stackoverflow.com/questions/44930207/overwrite-initial-filename", "title": "Overwrite initial filename", "body": "<p>With a little bit of help in places, I have written the below code which works perfectly but I need to be able to overwrite the initial file name (the one which we are asked to select with GetOpenFilename) to include !DNU! so users know after they have selected it, not to select the same file again especially as the files they will use are all fairly similar. You can see I tried with the line underneath 'Rename original text file but it doesn't do anything! Any help with this will be greatly appreciated.</p>\n\n<pre><code> Sub BACSConversion()\n\n Dim MyNewBook As String\n Dim MySaveFile As String\n Dim fileToOpen As Variant\n Dim fileName As String\n Dim sheetName As String\n Dim rCopy As Range\n\n 'Turn off display alerts\n  Application.DisplayAlerts = False\n 'Turn off screen updates\n  Application.ScreenUpdating = False\n\n 'Ensures that the file open directory is always the same\n   ChDir \"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment Limited\\\"\n\n 'Opens the folder to location to select txt file\n  fileToOpen = Application.GetOpenFilename(\"Text Files (*.txt), *.txt\")\n    If fileToOpen &lt;&gt; False Then\n    Workbooks.OpenText fileName:=fileToOpen, _\n    DataType:=xlDelimited, Tab:=True\n    End If\n 'Creates the file name based on txt file name\n  fileName = Mid(fileToOpen, InStrRev(fileToOpen, \"\\\") + 1)\n 'Creates the sheet name based on the active txt file\n  sheetName = Left(ActiveWorkbook.Name, Len(ActiveWorkbook.Name) - 4)\n\n 'Rename the original text file\n  ActiveWorkbook.SaveAs (\"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment \n Limited\" &amp; sheetName &amp; \"!DNU!\" &amp; \".txt\")\n\n 'Save active file as...\n  ActiveWorkbook.SaveAs (\"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment \n Limited\\BACS File Original\\\" &amp; _\n   fileName &amp; \".CSV\"), FileFormat:=xlCSV\n\n\n 'Selects all data in column A and copies to clipboard\n  Set rCopy = Range(\"A1\", Range(\"A1\").End(xlDown))\n\n 'Open the original document where the BACS file is located\n  Workbooks.Open \"S:\\Accounts (New)\\Management Information \n (Analysis)\\Phil Hanmore - Analysis\\bacs conversation calc.xlsx\"\n 'Selects the worksheet called \"Original\"\n  Sheets(\"Original\").Range(\"A:A\").ClearContents\n\n 'Paste selected values from previous sheet\n rCopy.Copy\n Sheets(\"Original\").Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n\n 'Selects appropriate worksheet - Non-MyPayFINAL\n  Sheets(\"Non-MyPay FINAL\").Select\n\n 'Selects all data in column A and copies to clipboard\n Range(\"A1\", Range(\"A1\").End(xlDown)).Select\n Selection.Copy\n\n  'Add a new workbook\n   Workbooks.Add\n 'Paste selected values from previous sheet\n  Selection.PasteSpecial Paste:=xlPasteValues\n\n  'Build SaveAs file name (for CSV file)\n   MySaveFile = Format(Now(), \"DDMMYYYY\") &amp; \"NonMyPayFINAL\" &amp; \".CSV\"\n  'Save template file as...(for CSV file)\n   ActiveWorkbook.SaveAs (\"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment \n   Limited\\\" &amp; MySaveFile), FileFormat:=xlCSV\n\n  'Build SaveAs file name (for Txt file)\n   MySaveFile = Format(Now(), \"DDMMYYYY\") &amp; \"NonMyPayFINAL\" &amp; \".Txt\"\n  'Save template file as...(for Txt file)\n   ActiveWorkbook.SaveAs (\"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment \n  Limited\\\" &amp; MySaveFile), FileFormat:=xlTextWindows\n\n  'Close the new saved file\n   ActiveWorkbook.Close\n\n 'Selects appropriate worksheet - MyPayFINAL\n   Sheets(\"MyPay FINAL\").Select\n\n  'Selects all data in column A and copies to clipboard\n   Range(\"A1\", Range(\"A1\").End(xlDown)).Select\n   Selection.Copy\n\n  'Add a new workbook\n   Workbooks.Add\n 'Paste selected values from previous sheet\n   Selection.PasteSpecial Paste:=xlPasteValues\n\n  'Build SaveAs file name (for CSV file)\n   MySaveFile = Format(Now(), \"DDMMYYYY\") &amp; \"MyPayFINAL\" &amp; \".CSV\"\n  'Save template file as...(for CSV file)\n    ActiveWorkbook.SaveAs (\"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment \n  Limited\\\" \n  &amp; MySaveFile), FileFormat:=xlCSV\n\n'Build SaveAs file name (for Txt file)\n  MySaveFile = Format(Now(), \"DDMMYYYY\") &amp; \"MyPayFINAL\" &amp; \".Txt\"\n 'Save template file as...(for Txt file)\n  ActiveWorkbook.SaveAs (\"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment \n  Limited\\\" &amp; MySaveFile), FileFormat:=xlTextWindows\n\n 'Close the new saved file\n  ActiveWorkbook.Close\n 'Close original source workbook (template)\n  Workbooks(\"bacs conversation calc\").Close\n 'Close final workbook\n  ActiveWorkbook.Close savechanges:=True\n\n  MsgBox \"Your file has been processed successfully!\", vbExclamation\n\n 'Turn on display alerts\n   Application.DisplayAlerts = True\n 'Turn on screen updates\n  Application.ScreenUpdating = True\n\n  End Sub\n\n  Sub FileNameChange()\n\n  Dim oldPath As String\n  Dim newPath As String\n\n  oldPath = \"S:\\Accounts (New)\\Management Information (Analysis)\\Phil \n  Hanmore - Analysis\\Neil Test\\\" &amp; Test &amp; \".xlsx\"\n  newPath = \"S:\\Accounts (New)\\Management Information (Analysis)\\Phil \n  Hanmore - Analysis\\Neil Test\\\" &amp; Test &amp; \"!DNU!.xlsx\"\n\n\n\n  End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1499267538, "post_id": 44929949, "comment_id": 76835772, "body": "What is the point of inserting a whole new row instead of just writing the values to the cell?"}, {"owner": {"reputation": 293, "user_id": 5165649, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fdb6cff5b8df87ce947970505dc220e9?s=128&d=identicon&r=PG&f=1", "display_name": "viji", "link": "https://stackoverflow.com/users/5165649/viji"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1499268309, "post_id": 44929949, "comment_id": 76836321, "body": "@John I want to insert these values below the column names which might vary sometimes the column names are in first row sometimes 3rd row. Thus I am expecting the user to input the cell. I dont want to mess up with the data that is avaliable in the excel sheet. Thus want a separate row."}], "owner": {"reputation": 293, "user_id": 5165649, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fdb6cff5b8df87ce947970505dc220e9?s=128&d=identicon&r=PG&f=1", "display_name": "viji", "link": "https://stackoverflow.com/users/5165649/viji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499281264, "creation_date": 1499267204, "last_edit_date": 1531164843, "question_id": 44929949, "link": "https://stackoverflow.com/questions/44929949/excel-vba-how-do-i-check-in-a-specified-row-except-the-specified-cell-is-empty", "title": "Excel vba How do I check in a specified row except the specified cell is empty", "body": "<p>This is part of the code.I want to display the values(strings separated by comma) that the user enters(using input box) in a cell that is also mentioned by the user. So for the first time execution I want to insert a row when the user mentions a specific range/ cell. Then insert the values the user mentioned in the exact cell where they want it to be inserted. For the next time execution I want the values to be appended to the same cell seperated by a comma.\nI started with this code:</p>\n\n<pre><code>Case 14\nDim Rang As String\nTerms = InputBox(\"Please enter words, if more than one string seperate by comma and space\", \"Need Input\", 1)\nRang = InputBox(\"Please enter cell where you want the terms to be displayed like C2,D2 \", \"Need Input\", 0, 8)\nRange(Rang).EntireRow.Insert\nRange(Rang).Value = Terms\n.....\n</code></pre>\n\n<p>For eg when the user mentions terms: turn, signal\nfor Rang they say f2\nSecond row is created and then in cell f2: turn, signal is displayed.\nFor the next time execution I want the values to be appended to the previous one separated by comma and space. With the current code it is creating a new row each time and adding the value to the new cell.I can ask the user to mention the same cell value each time if that helps. I thought of using the following code to append the values.</p>\n\n<pre><code>Range(Rang).Value=Range(Rang).Value &amp; \", \" &amp;Terms\n</code></pre>\n\n<p>How do I check if the specified row except the specified cell is empty so that I dont have to insert the specified entire row but append the values accordingly</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499267258, "post_id": 44929866, "comment_id": 76835570, "body": "<code>testFunc(aRange)</code>? or <code>testFunc(imcomesNamesRange)</code>? I urge you to use <code>Option Explicit</code>, it will save you a lot of debugging time. Also please post the code you are testing <b>as is</b> using copy/paste."}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499267487, "post_id": 44929866, "comment_id": 76835734, "body": "@ A.S.H , ops, didn&#39;t notice thanks. Might be deleted then"}, {"owner": {"reputation": 867, "user_id": 2770438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8219814e55b3ab73a24b7f24fdf8eb73?s=128&d=identicon&r=PG&f=1", "display_name": "jmdon", "link": "https://stackoverflow.com/users/2770438/jmdon"}, "edited": false, "score": 0, "creation_date": 1499267488, "post_id": 44929866, "comment_id": 76835737, "body": "Function should only be used if you are expecting a value to be returned, you should change Function testFunc to Sub testFunc"}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1499267519, "post_id": 44929866, "comment_id": 76835763, "body": "@ jmdon i&#39;m returning a value to Cells(1,5)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1499267870, "post_id": 44929866, "comment_id": 76836008, "body": "What workbook is the <code>Cells(1,5)</code> to be on? I&#39;m assuming it should be the <i>original</i> workbook, not <code>dataWorkbook</code>, correct? If so, make sure to add say <code>Dim origWB as Workbook</code> // <code>Set origWB = ActiveWorkook</code> <i>before</i> you open the other and then do <code>origWB.Sheets(&quot;Sheet1&quot;).Cells(1,5) = ...</code>.  Without qualifying the worbook and sheet with <code>Range()</code>/<code>Cells()</code>, VBA uses whatever the activesheet is."}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499267007, "creation_date": 1499267007, "question_id": 44929866, "link": "https://stackoverflow.com/questions/44929866/excel-vba-mistakes-one-range-for-the-other", "title": "Excel vba mistakes one range for the other", "body": "<p>I have a sub that opens workbook, puts its particular range into a variable and them passes that variable as an argument to a function that is supposed to MsgBox each value of the range and change it.</p>\n\n<pre><code>Function testFunc(aCol As Range)\n  Dim i As Integer\n  i = 0\n  For Each cell In aCol\n    MsgBox (cell.Value)\n    cell.Value = i\n    i = i + 1\n  Next\n\n  testFunc = i\nEnd Function\n\n\nSub testSub()   \n    Dim dataWorkbook As Workbook\n    Set dataWorkbook = Application.Workbooks.Open(\"Y:\\vba\\test_reserves\\test_data\\0503317-3_FO_001-2582480.XLS\")\n\n   Set imcomesNamesRange = dataWorkbook.Worksheets(\"sheet 1\").Range(\"A1:A20\")\n   Cells(1, 5) = testFunc(aRange)\nEnd Sub\n</code></pre>\n\n<p>But it doesn't happen - it only MsgBoxes values of the curren workbook's worksheet's range (that workbook which contains the macros) instead of reading and editing the newly opened workbook. What is wrong here?</p>\n"}, {"tags": ["vba", "winapi", "unicode-normalization"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1499269174, "post_id": 44929724, "comment_id": 76836932, "body": "Stab in the dark: <code>Len</code> returns the number of <i>characters</i> in the string; have you tried <code>LenB</code> instead, which returns the number of <i>bytes</i> in the string? VBA strings use 2 bytes per character."}, {"owner": {"reputation": 207, "user_id": 5017037, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f3b3deb217af6c347df5b6e73ba554aa?s=128&d=identicon&r=PG", "display_name": "someprogrammer", "link": "https://stackoverflow.com/users/5017037/someprogrammer"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1499274571, "post_id": 44929724, "comment_id": 76840269, "body": "@Mat&#39;sMug: The Len() function returns the number of UTF-16 code units.  The LenB() function will be double that and give an even worse result."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1499274713, "post_id": 44929724, "comment_id": 76840346, "body": "<code>Len</code> returns the number of ANSI characters in a string. That this matches UTF-16 code units is a coincidence."}, {"owner": {"reputation": 207, "user_id": 5017037, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f3b3deb217af6c347df5b6e73ba554aa?s=128&d=identicon&r=PG", "display_name": "someprogrammer", "link": "https://stackoverflow.com/users/5017037/someprogrammer"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1499274824, "post_id": 44929724, "comment_id": 76840386, "body": "@Mat&#39;sMug: Testing it here does not show that to be true.  It shows it to give the number of code units."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1499275152, "post_id": 44929724, "comment_id": 76840584, "body": "<a href=\"https://msdn.microsoft.com/VBA/Language-Reference-VBA/articles/len-function\" rel=\"nofollow noreferrer\">Len function on MSDN</a> - <i>Returns a Long containing the number of characters in a string or the number of bytes required to store a variable.</i> - given a <code>String</code>, it&#39;s specified to return the number of characters. With examples."}], "answers": [{"comments": [{"owner": {"reputation": 207, "user_id": 5017037, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f3b3deb217af6c347df5b6e73ba554aa?s=128&d=identicon&r=PG", "display_name": "someprogrammer", "link": "https://stackoverflow.com/users/5017037/someprogrammer"}, "edited": false, "score": 0, "creation_date": 1499971242, "post_id": 44933720, "comment_id": 77149722, "body": "Thank you for your response.  It doesn&#39;t work here.  First, it gives a multiple of 3 for the size, not of 2.  If it were a multiple of 2, I&#39;d think it was bytes, but a multiple of 3 makes no sense to me.  I&#39;ve tried tweaking it a number of ways and it just crashes every time."}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 207, "user_id": 5017037, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f3b3deb217af6c347df5b6e73ba554aa?s=128&d=identicon&r=PG", "display_name": "someprogrammer", "link": "https://stackoverflow.com/users/5017037/someprogrammer"}, "edited": false, "score": 0, "creation_date": 1499972038, "post_id": 44933720, "comment_id": 77150179, "body": "It works for me. The size from the first call is an estimated capacity in bytes allocated to fit the result for the worst case. It doesn&#39;t represent the size of the result. Since a unicode character is represented on 2 bytes, you need to divide this capacity by 2 to get an estimated number of characters. You&#39;ll get the real size from the second call."}, {"owner": {"reputation": 207, "user_id": 5017037, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f3b3deb217af6c347df5b6e73ba554aa?s=128&d=identicon&r=PG", "display_name": "someprogrammer", "link": "https://stackoverflow.com/users/5017037/someprogrammer"}, "edited": false, "score": 1, "creation_date": 1520965464, "post_id": 44933720, "comment_id": 85530123, "body": "Seems to work now.  I added 2 to the buffer size instead of 1 (after division) and it works."}], "tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": true, "score": 1, "last_activity_date": 1522147235, "last_edit_date": 1522147235, "creation_date": 1499280034, "answer_id": 44933720, "question_id": 44929724, "link": "https://stackoverflow.com/questions/44929724/vba-string-normalization-via-winapi/44933720#44933720", "title": "VBA String Normalization (via WinAPI)", "body": "<p>The function <code>NormalizeString</code> returns an estimated size in bytes when <code>cwDstLength</code> is 0, but you are using it as the number of characters.</p>\n\n<p>So take half the result from the first call and truncate the buffer with the result from the second call:</p>\n\n<pre><code>Private Declare PtrSafe Function NormalizeString Lib \"Normaliz\" ( _\n  ByVal normForm As Long, _\n  ByVal lpSrcString As LongPtr, _\n  ByVal cwSrcLength As Long, _\n  ByVal lpDstString As LongPtr, _\n  ByVal cwDstLength As Long _\n) As Long\n\nPublic Enum NormalizationForm\n  NormOther = 0\n  NormC = 1\n  NormD = 2\n  NormKC = 5\n  NormKD = 6\nEnd Enum\n\nPublic Function NormalizeStr(source As String, ByVal normForm As NormalizationForm) As String\n  Dim buffer As String, size As Long, i As Long\n\n  For i = 1 To 5\n    size = NormalizeString(normForm, StrPtr(source), Len(source), StrPtr(buffer), Len(buffer))\n\n    If size &gt;= 0 And size &lt; Len(buffer) Then\n      NormalizeStr = Left$(buffer, size)\n      Exit Function\n    End If\n\n    buffer = String$(Abs(size) + 1, 0)\n  Next\n\n  Err.Raise 9, , \"NormalizeString failed\"\nEnd Function\n\nPublic Sub Usage()\n  Debug.Print NormalizeStr(ChrW(196), NormD)\n  Debug.Print NormalizeStr(\"A\" &amp; ChrW(776), NormC)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 207, "user_id": 5017037, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f3b3deb217af6c347df5b6e73ba554aa?s=128&d=identicon&r=PG", "display_name": "someprogrammer", "link": "https://stackoverflow.com/users/5017037/someprogrammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 1, "accepted_answer_id": 44933720, "answer_count": 1, "score": 1, "last_activity_date": 1522147235, "creation_date": 1499266614, "question_id": 44929724, "link": "https://stackoverflow.com/questions/44929724/vba-string-normalization-via-winapi", "title": "VBA String Normalization (via WinAPI)", "body": "<p>I'm new to attempting to write code in VBA to use WinAPI functions.  What encoding does the WinAPI Normalize() function work with?  UTF-16 is what I would expect, but the following does not work.  The number of characters seems like it's not calculated right, and then the attempt to actually create a normalized string will just crash Access.</p>\n\n<pre><code>'normFormEnum\n'not random numbers, but from ...\n'https://msdn.microsoft.com/en-us/library/windows/desktop/dd319094(v=vs.85).aspx\n'for use in calling the Win API Function NormalizeString()\nPublic Enum normFormEnum\n    normFOther = 0\n    normFC = 1      'the W3C (Internet) required normalization format\n    normFD = 2\n    normFKC = 5\n    normFKD = 6\nEnd Enum\n\n'https://msdn.microsoft.com/en-us/library/windows/desktop/dd319093(v=vs.85).aspx\nPrivate Declare Function NormalizeString Lib \"Normaliz\" ( _\n    ByVal normForm As normFormEnum, _\n    ByVal lpSrcString As LongPtr, _\n    ByVal cwSrcLength As Long, _\n    ByRef lpDstString As LongPtr, _\n    ByVal cwDstLength As Long _\n    ) As Long\n\nPublic Function stringNormalize( _\n    ByVal theString As String, _\n    Optional ByVal normForm As normFormEnum = normFC _\n    ) As String\n\n    Dim nChars As Long\n    Dim newString As String\n\n    nChars = NormalizeString(normForm, StrPtr(theString), Len(theString), 0&amp;, 0)\n\n    'prefill the string buffer so it can be altered shortly...\n    newString = String(nChars, \" \")\n\nDebug.Print nChars\n'prints nChars, showing that it 3x the amount of characters.\n\n'The following will crash the application....\n\n'    NormalizeString normForm, StrPtr(theString), Len(theString), StrPtr(newString), nChars\n\n    stringNormalize = newString\n\nEnd Function\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1499267414, "post_id": 44929609, "comment_id": 76835690, "body": "Sounds to me like one of Access&#39;s many bugs. I would have guessed that Me.Repaint after Me.Form.Requery might work, but docs say &quot;completes any <i>pending</i> screen updates&quot;, but I&#39;m guessing the problem is that Access is somehow discarding paint requests for the textbox, so there&#39;s no pending requests to complete.  You could still try that to see if it forces a full repaint.  If that doesn&#39;t work, perhaps to the end of getSearchResults, add <code>txtViewAll.Visible = False</code> followed by <code>txtViewAll.Visible = True</code> or some other code that forces an update of txtViewAll appearance."}, {"owner": {"reputation": 89, "user_id": 4872152, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10204150407987018/picture?type=large", "display_name": "Eleyna", "link": "https://stackoverflow.com/users/4872152/eleyna"}, "reply_to_user": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1499268579, "post_id": 44929609, "comment_id": 76836512, "body": "Hm. I really thought Me.Repaint was going to work, but I got nothing. This small problem is turning into quite a little bugger."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 1, "creation_date": 1499270049, "post_id": 44929609, "comment_id": 76837563, "body": "I believe the hyperlink&#39;s control source should be blank and the &quot;View All&quot; text should be in the default value property of the textbox."}, {"owner": {"reputation": 89, "user_id": 4872152, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10204150407987018/picture?type=large", "display_name": "Eleyna", "link": "https://stackoverflow.com/users/4872152/eleyna"}, "edited": false, "score": 0, "creation_date": 1499270884, "post_id": 44929609, "comment_id": 76838105, "body": "Thank you, it worked! Such a simple solution."}], "owner": {"reputation": 89, "user_id": 4872152, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10204150407987018/picture?type=large", "display_name": "Eleyna", "link": "https://stackoverflow.com/users/4872152/eleyna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499266314, "creation_date": 1499266314, "question_id": 44929609, "link": "https://stackoverflow.com/questions/44929609/hyperlink-text-disappears-based-on-combo-box-value-on-continuous-form", "title": "Hyperlink text disappears based on combo box value on continuous form", "body": "<p>I'm having a bit of an unusual problem (or at least I think it's unusual). I have a continuous form that shows certain records based on a query that updates after I change the value in a combo box. I have a \"View All\" hyperlinked text box so that I can switch to seeing all of the records when I want to, but have discovered it only <em>appears</em> when I have selected a combo box value that has records. For example, if I want to find records assigned to Joe Shmo and there is one record assigned to him, the hyperlink appears. If I want to find records assigned to Susie Seashell and she has none assigned to her, it disappears. The catch is that if I click on the area of the screen where the hyperlink <strong><em>should</em></strong> appear, it still works as expected-- there is just nothing visible that would lead you to click there. The text field's visibility is on, and I even tried coding in a txtfield.visible=true and it did nothing. Any help would be appreciated!</p>\n\n<p><strong>Note:</strong> The hyperlink control source is =\"View All\". Not sure if that matters or not.</p>\n\n<p>All of the VBA code used on this form is below:</p>\n\n<pre><code>Option Compare Database\n\nPrivate Sub cboFindNotice_AfterUpdate()\ngetSearchResults\n\nEnd Sub\n\n\nPrivate Function getSearchResults()\n    Dim sql As String\n    Dim errMsg As String\n    '== Sets value of string 'sql'\n\n    sql = \"SELECT tblNotice.ID, tblNotice.noticeSEIFnoticeNumber, tblNotice.noticeJurisdiction, tblNotice.noticeDueDate, tblNotice.noticeTitle, \" _\n        &amp; \"tblAnalysts.[analyst_lName] &amp; \"\", \"\" &amp; [analyst_fName] AS Expr1, tblNotice.noticeStatus\" _\n        &amp; \" FROM tblAnalysts INNER JOIN tblNotice ON tblAnalysts.ID = tblNotice.noticeAnalyst\" _\n        &amp; \" WHERE tblNotice.noticeAnalyst LIKE '*\" &amp; Me.cboFindNotice &amp; \"*'\" _\n        &amp; \" ORDER BY tblNotice.noticeDueDate\"\n\n\n    '== Displays records based on query\n    Me.Form.RecordSource = sql\n    Me.Form.Requery\nEnd Function\n\nPrivate Sub noticeSEIFnoticeNumber_Click()\n    DoCmd.OpenForm \"frmNoticeDetails\"\n    [Forms]![frmNoticeDetails].Controls(\"txtControlField\").Value = Me.Controls(\"ID\").Value\nCall Forms.frmNoticeDetails.txtControlField_AfterUpdate\nEnd Sub\n\n\nPrivate Sub txtViewAll_Click()\n    Me.cboFindNotice.Value = \"\"\n    Call cboFindNotice_AfterUpdate\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1499266345, "post_id": 44929364, "comment_id": 76834785, "body": "Add <code>Application.WorksheetFunction.Match(&quot;Account1&quot;, .Range(&quot;A:A&quot;), 0)</code> and <code>Application.WorksheetFunction.Match(ComboBox1.Value &amp; &quot; &quot; &amp; Year(Date), .Range(&quot;A6:BZ6&quot;), 0)</code> to the watch window. What values are each when <code>.Cells</code> encounters the error?"}, {"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1499266480, "post_id": 44929364, "comment_id": 76834918, "body": "Also try using <code>Debug.Print</code> on your formula string to see if it is giving the correct formula, e.g. <code>Debug.Print &quot;=VLOOKUP(&quot;&quot;Account1 Service&quot;&quot;,&#39;&quot; &amp; Root &amp; sourceSheet &amp; ws.Name &amp; &quot; &quot; &amp; monthNumber &amp; &quot;.&quot; &amp; lastDay &amp; &quot;.&quot; &amp; Format(Now(), &quot;yy&quot;) &amp; &quot;&#39;!$A:$G,4,FALSE)&quot;</code>"}, {"owner": {"reputation": 173, "user_id": 7237046, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b0e25d0e4a6d9bf9a28a26dc77b3582b?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Kelly ", "link": "https://stackoverflow.com/users/7237046/sean-kelly"}, "reply_to_user": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1499267106, "post_id": 44929364, "comment_id": 76835449, "body": "When I add those expressions to the watch window, nothing changes and it doesn&#39;t tell me anything. The value is just &quot;Expression not defined in context.&quot; Also, where should i put the Debug.Print? On a new line or directly in line with the VLOOKUP?"}, {"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 1, "creation_date": 1499268602, "post_id": 44929364, "comment_id": 76836530, "body": "Put the debug just above the <code>.Cells</code> line that is erroring so you can see the formula string when it errors"}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 7237046, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b0e25d0e4a6d9bf9a28a26dc77b3582b?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Kelly ", "link": "https://stackoverflow.com/users/7237046/sean-kelly"}, "edited": false, "score": 0, "creation_date": 1499266810, "post_id": 44929756, "comment_id": 76835207, "body": "ws.ComboBox1.Value produces a &quot;Data Member Not Found&quot; error"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "reply_to_user": {"reputation": 173, "user_id": 7237046, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b0e25d0e4a6d9bf9a28a26dc77b3582b?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Kelly ", "link": "https://stackoverflow.com/users/7237046/sean-kelly"}, "edited": false, "score": 0, "creation_date": 1499266948, "post_id": 44929756, "comment_id": 76835317, "body": "@SeanKelly, where is combobox in sheet or Userform?"}, {"owner": {"reputation": 173, "user_id": 7237046, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b0e25d0e4a6d9bf9a28a26dc77b3582b?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Kelly ", "link": "https://stackoverflow.com/users/7237046/sean-kelly"}, "edited": false, "score": 0, "creation_date": 1499266995, "post_id": 44929756, "comment_id": 76835352, "body": "It is in the sheet"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "reply_to_user": {"reputation": 173, "user_id": 7237046, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b0e25d0e4a6d9bf9a28a26dc77b3582b?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Kelly ", "link": "https://stackoverflow.com/users/7237046/sean-kelly"}, "edited": false, "score": 0, "creation_date": 1499267079, "post_id": 44929756, "comment_id": 76835424, "body": "@SeanKelly: what sheet? every sheet? or specific sheet?"}, {"owner": {"reputation": 173, "user_id": 7237046, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b0e25d0e4a6d9bf9a28a26dc77b3582b?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Kelly ", "link": "https://stackoverflow.com/users/7237046/sean-kelly"}, "edited": false, "score": 0, "creation_date": 1499267154, "post_id": 44929756, "comment_id": 76835491, "body": "It&#39;s on every sheet. There are 25 sheets"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "reply_to_user": {"reputation": 173, "user_id": 7237046, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b0e25d0e4a6d9bf9a28a26dc77b3582b?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Kelly ", "link": "https://stackoverflow.com/users/7237046/sean-kelly"}, "edited": false, "score": 0, "creation_date": 1499270246, "post_id": 44929756, "comment_id": 76837688, "body": "@SeanKelly:  It seems to use oleobject."}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1499270155, "last_edit_date": 1499270155, "creation_date": 1499266721, "answer_id": 44929756, "question_id": 44929364, "link": "https://stackoverflow.com/questions/44929364/simple-vba-throwing-object-error-1004/44929756#44929756", "title": "Simple VBA Throwing Object Error 1004", "body": "<p>the object seems to ComboBox1.Value .\nIn sheet code, it is possible to use combobox. But  in module, it is not possible. So use obleObject and link cell. And get the cell value.</p>\n\n<pre><code>Dim ws As Worksheet\nDim obj As OLEObject\nDim strCombo As String\nFor Each ws In ThisWorkbook.Worksheets\n    If (ws.Name = \"Sheet1\") Or (ws.Name = \"Sheet2\") Then\n    Else\n        Set wbPath2 = Workbooks.Open(\"C:\\MyDirectory\\MyFile1.csv\")\n        sourceSheet = \"[MySheet.csv]\"\n\n        With ws\n            k = .Name\n            Set obj = .OLEObjects(\"ComboBox1\")\n            obj.LinkedCell = \"q1\" 'your  blank cell link ; this link \"q1\" cell\n            strCombo = .Range(\"q1\")\n            .Cells(Application.WorksheetFunction.Match(\"Account1\", .Range(\"A:A\"), 0), Application.WorksheetFunction.Match(strCombo &amp; \" \" &amp; Year(Date), .Range(\"A6:BZ6\"), 0)).Formula = \"=VLOOKUP(\"\"Account1 Service\"\",'\" &amp; Root &amp; sourceSheet &amp; ws.Name &amp; \" \" &amp; monthNumber &amp; \".\" &amp; lastDay &amp; \".\" &amp; Format(Now(), \"yy\") &amp; \"'!$A:$G,4,FALSE)\"\n            .Range(\"q1\").Clear\n        End With\n    End If\n\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 173, "user_id": 7237046, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b0e25d0e4a6d9bf9a28a26dc77b3582b?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Kelly ", "link": "https://stackoverflow.com/users/7237046/sean-kelly"}, "is_accepted": false, "score": 0, "last_activity_date": 1499269033, "creation_date": 1499269033, "answer_id": 44930607, "question_id": 44929364, "link": "https://stackoverflow.com/questions/44929364/simple-vba-throwing-object-error-1004/44930607#44930607", "title": "Simple VBA Throwing Object Error 1004", "body": "<p>It turns out I forgot to concatenate something in my file path pointer. Thank you to @Jordan for the Debug tips.</p>\n"}], "owner": {"reputation": 173, "user_id": 7237046, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b0e25d0e4a6d9bf9a28a26dc77b3582b?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Kelly ", "link": "https://stackoverflow.com/users/7237046/sean-kelly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 195, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1499270155, "creation_date": 1499265646, "question_id": 44929364, "link": "https://stackoverflow.com/questions/44929364/simple-vba-throwing-object-error-1004", "title": "Simple VBA Throwing Object Error 1004", "body": "<p>This loops through each worksheet and inserts a VLOOKUP formula (which references a closed workbook). The code will start with the first sheet, find and open the corresponding workbook, and perform the VLOOKUP, then onto the next sheet/corresponding workbook. Everything works until I hit .Cells which is where i run into the Object error. What am I missing? I run this macro from the original workbook, then it opens the external workbook</p>\n\n<pre><code>For Each ws In ThisWorkbook.Worksheets\n    If (ws.Name &lt;&gt; \"Sheet1\") And (ws.Name &lt;&gt; \"Sheet2\") Then\n        Set wbPath2 = Workbooks.Open(\"C:\\MyDirectory\\MyFile1.csv\") \n        sourceSheet = \"[MySheet.csv]\"\n\n        With ws\n            .Cells(Application.WorksheetFunction.Match(\"Account1\", .Range(\"A:A\"), 0), Application.WorksheetFunction.Match(ComboBox1.Value &amp; \" \" &amp; Year(Date), .Range(\"A6:BZ6\"), 0)).Formula = \"=VLOOKUP(\"\"Account1 Service\"\",'\" &amp; Root &amp; sourceSheet &amp; ws.Name &amp; \" \" &amp; monthNumber &amp; \".\" &amp; lastDay &amp; \".\" &amp; Format(Now(), \"yy\") &amp; \"'!$A:$G,4,FALSE)\"\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 35510, "user_id": 3706016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqmW0.jpg?s=128&g=1", "display_name": "jarlh", "link": "https://stackoverflow.com/users/3706016/jarlh"}, "edited": false, "score": 0, "creation_date": 1499265994, "post_id": 44929338, "comment_id": 76834464, "body": "Why the SQL tag? I see no SQL there."}, {"owner": {"reputation": 1, "user_id": 8259564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fa42a9e106f3204b6987df6b86d63e?s=128&d=identicon&r=PG&f=1", "display_name": "Srihari", "link": "https://stackoverflow.com/users/8259564/srihari"}, "reply_to_user": {"reputation": 35510, "user_id": 3706016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqmW0.jpg?s=128&g=1", "display_name": "jarlh", "link": "https://stackoverflow.com/users/3706016/jarlh"}, "edited": false, "score": 1, "creation_date": 1499266227, "post_id": 44929338, "comment_id": 76834661, "body": "Yes, no sql in above code. But sql works in ms access. i also tried below query                                       SELECT * INTO [temp]  FROM [Text;HDR=Yes;FMT=Delimited;Database=C:\\Users\\Documents\\VBA]&zwnj;&#8203;.Rawfile.txt"}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1499266499, "post_id": 44929338, "comment_id": 76834938, "body": "I did not see @Srihari comment before answering - this was what I was thinking would work better."}, {"owner": {"reputation": 1, "user_id": 8259564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fa42a9e106f3204b6987df6b86d63e?s=128&d=identicon&r=PG&f=1", "display_name": "Srihari", "link": "https://stackoverflow.com/users/8259564/srihari"}, "edited": false, "score": 0, "creation_date": 1499266718, "post_id": 44929338, "comment_id": 76835125, "body": "but  blank records inserted into table when i tried above query  ."}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1499267421, "post_id": 44929338, "comment_id": 76835694, "body": "but &quot;blank records&quot; or are the columns not coming in correctly?  A select * will fail if the input file is missing a column, but I usually want it to fail if something changes (that way)."}, {"owner": {"reputation": 1, "user_id": 8259564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fa42a9e106f3204b6987df6b86d63e?s=128&d=identicon&r=PG&f=1", "display_name": "Srihari", "link": "https://stackoverflow.com/users/8259564/srihari"}, "edited": false, "score": 0, "creation_date": 1499268279, "post_id": 44929338, "comment_id": 76836298, "body": "even file column names are not coming into table and two columns ypf and f2  are being created. in the table"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1499274087, "post_id": 44929338, "comment_id": 76840044, "body": "Let&#39;s stop guessing. Please share a few rows of actual text file."}, {"owner": {"reputation": 1, "user_id": 8259564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fa42a9e106f3204b6987df6b86d63e?s=128&d=identicon&r=PG&f=1", "display_name": "Srihari", "link": "https://stackoverflow.com/users/8259564/srihari"}, "edited": false, "score": 0, "creation_date": 1499343666, "post_id": 44929338, "comment_id": 76872414, "body": "text file is tab-delimited (a excel was converted into text file using another macro, i&#39;m trying to load text file into ms access) , file data image is mentioned in post starting"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8259564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fa42a9e106f3204b6987df6b86d63e?s=128&d=identicon&r=PG&f=1", "display_name": "Srihari", "link": "https://stackoverflow.com/users/8259564/srihari"}, "edited": false, "score": 0, "creation_date": 1499268044, "post_id": 44929666, "comment_id": 76836121, "body": "i tried <code>DoCmd.RunSQL &quot;select [State Name],[Column name2],Country INTO [temp] FROM [Text;HDR=Yes;FMT=Delimited;Database=C:\\Users\\Documents].fil&zwnj;&#8203;e.csv;&quot;</code> But  a promote (promote name is &quot;enter parameter value&quot;)  is coming for each column mentioned in above query and asking to enter parameter value for all those columns."}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "reply_to_user": {"reputation": 1, "user_id": 8259564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fa42a9e106f3204b6987df6b86d63e?s=128&d=identicon&r=PG&f=1", "display_name": "Srihari", "link": "https://stackoverflow.com/users/8259564/srihari"}, "edited": false, "score": 0, "creation_date": 1499271716, "post_id": 44929666, "comment_id": 76838642, "body": "When you get that prompt, it&#39;s referring to something it does not recognize in the source.  Is the column header spelled the same in Rawfile?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1499274175, "post_id": 44929666, "comment_id": 76840084, "body": "This solution assumes text file is comma-delimited. OP, please share your text data which may have different delimiter."}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1499277742, "post_id": 44929666, "comment_id": 76842038, "body": "If they used some other uncommon type of delimiter, you may have to use a schema.ini (or change delimited to tabdelimited as that&#39;s the other most common format).   At the same time, since your original import specification was calling for the same delimited value from the Windows registry.... <a href=\"https://www.pcreview.co.uk/threads/read-text-file-from-query.1675413/\" rel=\"nofollow noreferrer\">I may just be pointing out extra info</a> ;)"}, {"owner": {"reputation": 1, "user_id": 8259564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fa42a9e106f3204b6987df6b86d63e?s=128&d=identicon&r=PG&f=1", "display_name": "Srihari", "link": "https://stackoverflow.com/users/8259564/srihari"}, "edited": false, "score": 0, "creation_date": 1499281171, "post_id": 44929666, "comment_id": 76843919, "body": "Sorry, forgot to mention, text file is tab-delimited.  i copied the column headers from raw file and pasted in query. <code>DoCmd.RunSQL &quot;select [State Name],[Column name2],[Country] INTO INTO [temp] FROM [Text;FMT=tabdelimited;HDR=Yes;Database=C:\\Documents\\].File.&zwnj;&#8203;csv;&quot; </code> Still i&#39;m getting a prompt for each column and asking to enter parameter values for the columns. i entered few character for each column prompt and it created a table with all columns (mentioned in query) datatype as binary."}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1499281662, "post_id": 44929666, "comment_id": 76844185, "body": "Odd, let me get this straight, so it works after you provide values for each column initially?  I&#39;ve seen quirks with the editor before like this."}, {"owner": {"reputation": 1, "user_id": 8259564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fa42a9e106f3204b6987df6b86d63e?s=128&d=identicon&r=PG&f=1", "display_name": "Srihari", "link": "https://stackoverflow.com/users/8259564/srihari"}, "edited": false, "score": 1, "creation_date": 1499282021, "post_id": 44929666, "comment_id": 76844394, "body": "No, text/csv file data not copied into table. All rows of column have same value which has been provided in prompt window.   i&#39;m new to schema.ini , let me try schema.ini . please let me know if there are any other better options"}, {"owner": {"reputation": 1, "user_id": 8259564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fa42a9e106f3204b6987df6b86d63e?s=128&d=identicon&r=PG&f=1", "display_name": "Srihari", "link": "https://stackoverflow.com/users/8259564/srihari"}, "edited": false, "score": 0, "creation_date": 1499342728, "post_id": 44929666, "comment_id": 76871711, "body": "I used schema.ini and  vba code is <code>Option Compare Database Sub ImportSchemaTable()     Dim db As DAO.Database     Set db = CurrentDb()     db.Execute _     &quot;SELECT * INTO Newtab FROM [Text;FMT=tabDelimited;HDR=Yes;DATABASE=C:\\Users\\smodepalli\\&zwnj;&#8203;Documents;].[File#tx&zwnj;&#8203;t];&quot;, _     dbFailOnError     db.TableDefs.Refresh End Sub </code>  (i will mention the schema code and data in next comments) Now result is new table create with file columns but blank rows  being inserted for all columns and number of blank rows is 30(double the data in file). please let me know is there any error in code"}, {"owner": {"reputation": 1, "user_id": 8259564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fa42a9e106f3204b6987df6b86d63e?s=128&d=identicon&r=PG&f=1", "display_name": "Srihari", "link": "https://stackoverflow.com/users/8259564/srihari"}, "edited": false, "score": 0, "creation_date": 1499342927, "post_id": 44929666, "comment_id": 76871860, "body": "schema.ini code is<code>[File.txt] ColNameHeader=True Format=FixedLength MaxScanRows=0 CharacterSet=OEM Col1=&quot;Fiscal Year&quot; Char Width 60 Col2=&quot;Currency&quot; Char Width 60 Col3=&quot;Month&quot; Char Width 60 Col4=&quot;Value&quot; Char Width 50</code> schema.ini file and data file are in same folder. (raw file data is in next comments)"}, {"owner": {"reputation": 1, "user_id": 8259564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fa42a9e106f3204b6987df6b86d63e?s=128&d=identicon&r=PG&f=1", "display_name": "Srihari", "link": "https://stackoverflow.com/users/8259564/srihari"}, "edited": false, "score": 0, "creation_date": 1499343699, "post_id": 44929666, "comment_id": 76872438, "body": "text file is tab-delimited (a excel was converted into text file using another macro, i&#39;m trying to load text file into ms access) , file data image is mentioned in post starting"}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1499356365, "post_id": 44929666, "comment_id": 76882532, "body": "Another option is to create a linked table in Access, that points to the path of your file.  Then you can try to run the query on this &quot;linked&quot; table.  I&#39;ve had to do this before, to deal with some of the troubles you&#39;re having."}], "tags": [], "owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "is_accepted": false, "score": 0, "last_activity_date": 1499266440, "creation_date": 1499266440, "answer_id": 44929666, "question_id": 44929338, "link": "https://stackoverflow.com/questions/44929338/vba-code-to-load-text-file-into-ms-access-table/44929666#44929666", "title": "vba code to load text file into ms access table", "body": "<p>I've had this issue with the import specs before.  They're great for layouts that do not change.  There's a couple alternatives, one is via Access's SQL.</p>\n\n<pre><code>'RawFile may have to be renamed as .CSV vs .TXT\n\nDoCmd.RunSQL \"SELECT ColumnIKnow1, ColumnIKnow2, ColumnIKnow3 INTO TargetTable FROM [Text;DATABASE=C:\\Users\\Documents\\;HDR=Yes].Rawfile.csv\" \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8259564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fa42a9e106f3204b6987df6b86d63e?s=128&d=identicon&r=PG&f=1", "display_name": "Srihari", "link": "https://stackoverflow.com/users/8259564/srihari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2820, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1499343533, "creation_date": 1499265601, "last_edit_date": 1499343533, "question_id": 44929338, "link": "https://stackoverflow.com/questions/44929338/vba-code-to-load-text-file-into-ms-access-table", "title": "vba code to load text file into ms access table", "body": "<p><a href=\"https://i.stack.imgur.com/hjRiV.png\" rel=\"nofollow noreferrer\">file data image </a>I need to import a text file data into an Access table. Below is my VBA code</p>\n\n<pre><code>DoCmd.TransferText transfertype:=acImportDelim, _\n  TransferType:=acImportDelim, _\n  SpecificationName:=\"Generic\", _\n  FileName:=\"C:\\Users\\Documents\\Rawfile.txt\", _\n  hasfieldnames:=False\n</code></pre>\n\n<p>Data is loading into table. \nBut when column headers/names order changes in raw file then this TransferText loading data into table as per column headers/names order specified in 'SpecificationName' and doesn't cross check column names in file, resulting the one column data loading into another column in table.</p>\n\n<p>Is there any alternate solution while loading data it should check column names and load data into correct column headers/names ?</p>\n\n<p>Note: column header names doesn't change in file but only column header order may changes in raw file.</p>\n"}, {"tags": ["vba", "excel", "import"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8259821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d1f096371a8051d38ef2c5dd10ba554?s=128&d=identicon&r=PG&f=1", "display_name": "S.SCH", "link": "https://stackoverflow.com/users/8259821/s-sch"}, "edited": false, "score": 0, "creation_date": 1499327271, "post_id": 44942665, "comment_id": 76861160, "body": "Tank you for your answer, can you tell me where i insert the textfile , where do i need to change the code and input the thread of my text file?"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 3, "user_id": 8259821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d1f096371a8051d38ef2c5dd10ba554?s=128&d=identicon&r=PG&f=1", "display_name": "S.SCH", "link": "https://stackoverflow.com/users/8259821/s-sch"}, "edited": false, "score": 0, "creation_date": 1499327331, "post_id": 44942665, "comment_id": 76861201, "body": "Just run the code, it will open a file dialog and you can select a .txt file."}, {"owner": {"reputation": 3, "user_id": 8259821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d1f096371a8051d38ef2c5dd10ba554?s=128&d=identicon&r=PG&f=1", "display_name": "S.SCH", "link": "https://stackoverflow.com/users/8259821/s-sch"}, "edited": false, "score": 0, "creation_date": 1499327727, "post_id": 44942665, "comment_id": 76861450, "body": "Okay, yes it opened the dialog but after that it showed the result in a msg box, but did not import it in an sheet, do i need to change something?"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 3, "user_id": 8259821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d1f096371a8051d38ef2c5dd10ba554?s=128&d=identicon&r=PG&f=1", "display_name": "S.SCH", "link": "https://stackoverflow.com/users/8259821/s-sch"}, "edited": false, "score": 0, "creation_date": 1499327881, "post_id": 44942665, "comment_id": 76861552, "body": "This is meant to be an example, not a solution for your exact problem. The lines are stored in the array <code>x</code>, use it to give out the line you want into the sheet."}, {"owner": {"reputation": 3, "user_id": 8259821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d1f096371a8051d38ef2c5dd10ba554?s=128&d=identicon&r=PG&f=1", "display_name": "S.SCH", "link": "https://stackoverflow.com/users/8259821/s-sch"}, "edited": false, "score": 0, "creation_date": 1499328747, "post_id": 44942665, "comment_id": 76862128, "body": "could you explain how to use array x to determine a specific line?"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 3, "user_id": 8259821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d1f096371a8051d38ef2c5dd10ba554?s=128&d=identicon&r=PG&f=1", "display_name": "S.SCH", "link": "https://stackoverflow.com/users/8259821/s-sch"}, "edited": false, "score": 0, "creation_date": 1499329881, "post_id": 44942665, "comment_id": 76862857, "body": "What helps is to go trough your code with <code>F8</code> line by line, you can hover over the variables to see the values. I edited my code to give out the lines in a sheet. In the <code>For</code> loop i go trough the array aka lines with the index <code>i</code>. If you are not familar with array and how they are build up, you should go look them up."}], "tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": true, "score": 0, "last_activity_date": 1499329655, "last_edit_date": 1499329655, "creation_date": 1499326964, "answer_id": 44942665, "question_id": 44929212, "link": "https://stackoverflow.com/questions/44929212/want-to-import-bits-a-couple-of-rows-of-an-txt-to-excel/44942665#44942665", "title": "Want to import bits (a couple of rows) of an .txt to excel", "body": "<p>You can do it, but not with a Querytable. \nTry this code: </p>\n\n<pre><code>Private Sub Open_Click()\nDim fn As Variant, myLine As Long, txt As String, x As Variant, ouput As String\nDim i As Integer, j As Integer: j = 1\nDim sht As Worksheet\n\nSet sht = Worksheets(\"Sheet1\") 'Modify Sheet Name\n\nfn = Application.GetOpenFilename(\"Text Files (*.txt),*.txt\", , _\n       \"Open File\")\nIf fn = False Then Exit Sub\ntxt = CreateObject(\"Scripting.FileSystemObject\").OpenTextFile(fn).ReadAll\nx = Split(txt, vbNewLine)\n\nFor i = 0 To UBound(x)\n    If x(i) &lt;&gt; \"SomeCriteria\" Then 'Check for some criteria\n        sht.Cells(j, 1).Value = x(i)\n        j = j + 1\n    End If\nNext i\nEnd Sub\n</code></pre>\n\n<p>So what it does basically, it opens a user selected txt file and stores it in the variable <code>txt</code>. Do seperate the rows you can use the <code>split</code>-function. Now each line is stored in an array <code>x</code>. You could go trough the array/each line and take out the ones you want. To check if a specific word is in a line, use the <code>InStr</code>-function. </p>\n"}], "owner": {"reputation": 3, "user_id": 8259821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d1f096371a8051d38ef2c5dd10ba554?s=128&d=identicon&r=PG&f=1", "display_name": "S.SCH", "link": "https://stackoverflow.com/users/8259821/s-sch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 44942665, "answer_count": 1, "score": 0, "last_activity_date": 1499329655, "creation_date": 1499265316, "last_edit_date": 1499279609, "question_id": 44929212, "link": "https://stackoverflow.com/questions/44929212/want-to-import-bits-a-couple-of-rows-of-an-txt-to-excel", "title": "Want to import bits (a couple of rows) of an .txt to excel", "body": "<p>Hey so i found a specific query to import a file into excel from a specific row and delete the following datga each time you open it again. but is it also pssible to stop adding rows at a specific line? and is it possible to leave some rows out if there for example is a specific word in that line?</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub Sample()\r\n    With ActiveSheet.QueryTables.Add(Connection:= _\r\n        \"TEXT;C:\\Users\\sample.txt\", Destination:=Range(\"$A$1\") _\r\n        )\r\n        .Name = \"Sample\"\r\n        .FieldNames = True\r\n        .RowNumbers = False\r\n        .FillAdjacentFormulas = False\r\n        .PreserveFormatting = True\r\n        .RefreshOnFileOpen = False\r\n        .RefreshStyle = xlInsertDeleteCells\r\n        .SavePassword = False\r\n        .SaveData = True\r\n        .AdjustColumnWidth = True\r\n        .RefreshPeriod = 0\r\n        .TextFilePromptOnRefresh = False\r\n        .TextFilePlatform = 437\r\n        .TextFileStartRow = 1\r\n        .TextFileParseType = xlDelimited\r\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\r\n        .TextFileConsecutiveDelimiter = False\r\n        .TextFileTabDelimiter = True\r\n        .TextFileSemicolonDelimiter = False\r\n        .TextFileCommaDelimiter = True\r\n        .TextFileSpaceDelimiter = False\r\n        .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1)\r\n        .TextFileTrailingMinusNumbers = True\r\n        .Refresh BackgroundQuery:=False\r\n        \r\n    End With\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1499265273, "post_id": 44929115, "comment_id": 76833893, "body": "You  need to avoid from selecting and activating."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8259815, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/872b4884e0971640e010b4262efe0a5a?s=128&d=identicon&r=PG&f=1", "display_name": "MAJ10", "link": "https://stackoverflow.com/users/8259815/maj10"}, "edited": false, "score": 0, "creation_date": 1499266284, "post_id": 44929407, "comment_id": 76834726, "body": "Masoud, thank you so much! I was looking into the Option Explicit but was unsure since I&#39;ve never tried it before. Really appreciate your help.   One question:   After taking your approach, the values I need copy beneath my formatted cells, not within them (regardless its great that it works!). But, would this be occurring if my formatted cells are protected?"}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 27, "user_id": 8259815, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/872b4884e0971640e010b4262efe0a5a?s=128&d=identicon&r=PG&f=1", "display_name": "MAJ10", "link": "https://stackoverflow.com/users/8259815/maj10"}, "edited": false, "score": 0, "creation_date": 1499266376, "post_id": 44929407, "comment_id": 76834812, "body": "@MAJ10 I am not sure if I got your question. <i>After taking your approach, the values I need copy beneath my formatted cells, not within them (regardless its great that it works!)</i> What do you mean?"}, {"owner": {"reputation": 27, "user_id": 8259815, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/872b4884e0971640e010b4262efe0a5a?s=128&d=identicon&r=PG&f=1", "display_name": "MAJ10", "link": "https://stackoverflow.com/users/8259815/maj10"}, "edited": false, "score": 0, "creation_date": 1499266689, "post_id": 44929407, "comment_id": 76835093, "body": "On sheet 2, I&#39;ve formatted the entire sheet already so that it isn&#39;t just a blank worksheet. For some reason, the values are pasted into Sheet 2 starting at row 30.   Rows 1 to 29 on Sheet 2 have formatting. I was hoping to understand how to get the values pasted starting at Row 10 instead of Row 30.   Hope this makes sense... thank you!!"}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 27, "user_id": 8259815, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/872b4884e0971640e010b4262efe0a5a?s=128&d=identicon&r=PG&f=1", "display_name": "MAJ10", "link": "https://stackoverflow.com/users/8259815/maj10"}, "edited": false, "score": 0, "creation_date": 1499266802, "post_id": 44929407, "comment_id": 76835202, "body": "@MAJ10 is this always gonna start at row 10? And they are only formatted but not filled, not even with spaces, right?"}, {"owner": {"reputation": 27, "user_id": 8259815, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/872b4884e0971640e010b4262efe0a5a?s=128&d=identicon&r=PG&f=1", "display_name": "MAJ10", "link": "https://stackoverflow.com/users/8259815/maj10"}, "edited": false, "score": 0, "creation_date": 1499267072, "post_id": 44929407, "comment_id": 76835414, "body": "Yes always at row 10 on sheet 2. They are only formatted, and are completely empty."}], "tags": [], "owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "is_accepted": true, "score": 0, "last_activity_date": 1499267363, "last_edit_date": 1499267363, "creation_date": 1499265740, "answer_id": 44929407, "question_id": 44929115, "link": "https://stackoverflow.com/questions/44929115/excel-vba-copying-columns-that-match-a-condition-from-one-worksheet-to-a-forma/44929407#44929407", "title": "EXCEL VBA - Copying columns that match a condition from one worksheet to a formatted worksheet", "body": "<p>Run-time error mostly happens due to not properly addressing cells. If you use explicit coding you are less likely to get these errors and also your code would be easily legible. Also use comments.</p>\n\n<pre><code>Option Explicit\n\nSub Report ()\n\n 'Declare variables\n  Dim name as String\n  Dim wsh1 As Worksheet, wsh2 As Worksheet\n  Dim erow As Long, i as Long\n\n 'Set the sheets\n  Set wsh1 = ThisWorkbook.Worksheets(\"Sheet 1\")\n  Set wsh2 = ThisWorkbook.Worksheets(\"Sheet 2\")\n\n 'clean destination worksheet\n  wsh2.Range(\"A10:N29\").ClearContents\n\n  name = wsh2.Range(\"B5\").Value 'condition for copying\n\n 'loop over reference sheet\n  For i = 2 To wsh1.Range(\"B\" &amp; Rows.Count).End(xlUp).Row \n\n    'Check if the row meets the condition\n    If wsh1.Cells(i, 1) = name Then \n\n      wsh1.Range(wsh1.Cells(i, 2), wsh1.Cells(i, 25)).Copy 'copy the row\n\n      erow = wsh2.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row 'find last row in wsh2 \n\n      wsh2.Cells(erow, 1).PasteSpecial xlPasteFormulasAndNumberFormats 'paste only values\n\n    End If\n\n  Next i\n\nEnd Sub\n</code></pre>\n\n<h1>Update:</h1>\n\n<p>As OP mentioned that it should be always at row 10, then this would be a better approach than using last row:</p>\n\n<p>At the beginning of the code and outside the for loop define <code>erow = 10</code>. Then your if-block should be like this:</p>\n\n<pre><code>If wsh1.Cells(i, 1) = name Then 'Check if the row meets the condition\n\n  wsh1.Range(wsh1.Cells(i, 2), wsh1.Cells(i, 25)).Copy 'copy the row\n\n  wsh2.Cells(erow, 1).PasteSpecial xlPasteFormulasAndNumberFormats 'paste only values\n\n  erow = erow + 1\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 8259815, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/872b4884e0971640e010b4262efe0a5a?s=128&d=identicon&r=PG&f=1", "display_name": "MAJ10", "link": "https://stackoverflow.com/users/8259815/maj10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1015, "favorite_count": 0, "accepted_answer_id": 44929407, "answer_count": 1, "score": 2, "last_activity_date": 1499268939, "creation_date": 1499265084, "last_edit_date": 1499268939, "question_id": 44929115, "link": "https://stackoverflow.com/questions/44929115/excel-vba-copying-columns-that-match-a-condition-from-one-worksheet-to-a-forma", "title": "EXCEL VBA - Copying columns that match a condition from one worksheet to a formatted worksheet", "body": "<p>I'm very familiar with <code>vlookup</code>, pivot tables, but feel like this can be accomplished with <code>VBA</code>.</p>\n\n<p>Here is what I'm trying to do:</p>\n\n<p><code>Sheet 1</code>: data sheet with headers. \n<code>Sheet 2</code>: summary sheet that is formatted with a specific look and data can only be pasted into the sheet starting at <code>row 10</code>. </p>\n\n<ul>\n<li>In <code>sheet 2, B5</code>, has a drop down list that allows you to select a name. </li>\n<li>I want someone to be able to check if the value in <code>Sheet 2 B5</code>, matches up <code>Sheet 1 Column A</code>.</li>\n<li>then the code will go back to the data sheet (<code>sheet 1</code>) and check in <code>column A</code> if it matches <code>Sheet 2 B5</code>. </li>\n<li>If <code>Sheet 2 B5</code>, matches <code>Sheet 1</code> <code>Column A</code>, then copy <code>Sheet 1</code> columns <code>B, C, D, E, H, I, J, K, L, M, N, R, S, T, U, V, W, X, Y</code>, that match <code>Sheet 2 B5</code> value, INTO <code>sheet 2</code> starting at <code>row 10</code>. </li>\n</ul>\n\n<p>other notes\n- Formats from <code>Sheet 1</code> cannot be copied into <code>Sheet 2</code>. I just need the contents. \n- the button to run the code is on <code>sheet 2</code>. (thus <code>sheet 2</code> is the active sheet at the time the macro runs). </p>\n\n<p>My code so far...</p>\n\n<pre><code>Sub Report ()\nDim finalrow As Integer, i as Integer, name as String\nSheets(\"Sheet 2\").Range(\"A10:N29\").ClearContents\nname = Sheets(\"Sheet 2\").Range(\"B5\").Value\nFor i = 2 To Sheets(\"Sheet 1\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nIf Cells(i, 1) = name Then\nRange(Cells(i, 2), Cells(i, 25)).Select\nSelection.Copy\nWorksheets(\"Sheet 2\").Select\nerow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\nActiveSheet.Cells(erow, 1).Select\nActiveSheet.PasteSpecial xlPasteFormulasAndNumberFormats\nEnd If\nNext i\nEnd Sub\n</code></pre>\n\n<p>But I keep getting </p>\n\n<blockquote>\n  <p>runtime error 9. </p>\n</blockquote>\n"}, {"tags": ["sql", "vba", "excel"], "comments": [{"owner": {"reputation": 35510, "user_id": 3706016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqmW0.jpg?s=128&g=1", "display_name": "jarlh", "link": "https://stackoverflow.com/users/3706016/jarlh"}, "edited": false, "score": 0, "creation_date": 1499265200, "post_id": 44929114, "comment_id": 76833826, "body": "General GROUP BY tip: &quot;If a GROUP BY clause is specified, each column reference in the SELECT list must either identify a grouping column or be the argument of a set function.&quot;"}, {"owner": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1499265608, "post_id": 44929114, "comment_id": 76834157, "body": "Perhaps you mean <code>ORDER BY [&#39;Code&#39;]</code>? grouping by implies aggregation (min/max/avg/count) which you&#39;re doing none. or distinct to eliminate duplicates?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1499265862, "post_id": 44929114, "comment_id": 76834344, "body": "And why is the field quoted? Is there really quotes in that column header."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1499266102, "post_id": 44929114, "comment_id": 76834551, "body": "About @xQbert&#39;s comment: <a href=\"https://stackoverflow.com/a/164544/1188513\">stackoverflow.com/a/164544/1188513</a>"}, {"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "reply_to_user": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1499266350, "post_id": 44929114, "comment_id": 76834789, "body": "@xQbert I wanted to sum by a var, but I have 50 column headers, maybe a subtotal is easier"}, {"owner": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 1, "creation_date": 1499266421, "post_id": 44929114, "comment_id": 76834866, "body": "what SQL engine is this?  would an windowfunction/analytic work to get the &quot;sum&quot; w/o any group by?  Such as <code>sum(var) over (partition by unique key&#47;columns)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1499265634, "post_id": 44929308, "comment_id": 76834173, "body": "I see, makes sense when you put it like that"}, {"owner": {"reputation": 35510, "user_id": 3706016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqmW0.jpg?s=128&g=1", "display_name": "jarlh", "link": "https://stackoverflow.com/users/3706016/jarlh"}, "edited": false, "score": 0, "creation_date": 1499266181, "post_id": 44929308, "comment_id": 76834627, "body": "Why GROUP BY when no aggregate functions are involved, instead of a simple SELECT DISTINCT?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 35510, "user_id": 3706016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqmW0.jpg?s=128&g=1", "display_name": "jarlh", "link": "https://stackoverflow.com/users/3706016/jarlh"}, "edited": false, "score": 0, "creation_date": 1499266247, "post_id": 44929308, "comment_id": 76834691, "body": "@jarlh <a href=\"https://stackoverflow.com/a/164544/1188513\">because it makes absolutely no difference whatsoever</a> and that&#39;s what the OP had."}, {"owner": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1499266526, "post_id": 44929308, "comment_id": 76834949, "body": "@Mat&#39;s mug for SQL server, oracle that&#39;s true.  for mySQL it&#39;s not. and even in SQL server and oracle, more complex queries may result in different execution plans where the group by and distinct use result in different plans.  (we don&#39;t know the engine here though it&#39;s implied it&#39;s a MSFT product)"}, {"owner": {"reputation": 35510, "user_id": 3706016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqmW0.jpg?s=128&g=1", "display_name": "jarlh", "link": "https://stackoverflow.com/users/3706016/jarlh"}, "edited": false, "score": 0, "creation_date": 1499266528, "post_id": 44929308, "comment_id": 76834951, "body": "Well, that&#39;s a matter of taste. OP has 50 columns."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1499266695, "post_id": 44929308, "comment_id": 76835100, "body": "@xQbert my bad, per the connection string it would seem the source is an Excel worksheet, so the &quot;engine&quot; is the <code>Microsoft.ACE.OLEDB.12.0</code> provider."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 35510, "user_id": 3706016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqmW0.jpg?s=128&g=1", "display_name": "jarlh", "link": "https://stackoverflow.com/users/3706016/jarlh"}, "edited": false, "score": 0, "creation_date": 1499266752, "post_id": 44929308, "comment_id": 76835164, "body": "@jarlh OP is asking why they can&#39;t <code>GROUP BY</code> with <code>SELECT *</code>. Answering &quot;use distinct instead&quot; doesn&#39;t help OP understand."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1499267088, "last_edit_date": 1499267088, "creation_date": 1499265522, "answer_id": 44929308, "question_id": 44929114, "link": "https://stackoverflow.com/questions/44929114/group-by-sql-query-in-vba/44929308#44929308", "title": "Group by SQL query in VBA", "body": "<blockquote>\n  <p>Cannot group on Fields selected with '*'</p>\n</blockquote>\n\n<p>Pretty explicit: you can't <code>GROUP BY</code> when you do <code>SELECT *</code>. Specify the field list explicitly.</p>\n\n<pre><code>SELECT [Code$], [Foobar] FROM [Holdings$] WHERE [Holdings$].['Code$'] ='%91' GROUP BY [Code$], [Foobar]\n</code></pre>\n\n<p>Note that all fields in the <code>SELECT</code> clause that aren't aggregates, must appear in the <code>GROUP BY</code> clause.</p>\n\n<p>If there is no need to aggregate anything, you can remove the <code>GROUP BY</code> clause and do <code>SELECT DISTINCT</code> instead.</p>\n"}], "owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2181, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499267088, "creation_date": 1499265084, "last_edit_date": 1531164843, "question_id": 44929114, "link": "https://stackoverflow.com/questions/44929114/group-by-sql-query-in-vba", "title": "Group by SQL query in VBA", "body": "<p>I have a query where I would like to consolidate by a Code that has two rows in the initial tab, however I keep getting an error Cannot group on Fields selected with '*'. Any ideas</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub get_code()    \n   OptimizeVBA True: ShDel (\"Workings\")    \n   Dim cn As ADODB.Connection\n   Set cn = New ADODB.Connection\n\n   With cn\n       .Provider = \"Microsoft.ACE.OLEDB.12.0\"\n       .ConnectionString = \"Data Source=\" &amp; ThisWorkbook.FullName &amp; \";\" &amp; _\n        \"Extended Properties=\"\"Excel 12.0 Macro;IMEX=1;HDR=YES\"\";\"\n       .Open\n   End With\n\n   Dim rs As ADODB.Recordset\n   Set rs = New ADODB.Recordset\n\n   rs.Open \"SELECT * FROM [Holdings$] WHERE [Holdings$].['Code$'] ='%91' GROUP BY ['Code']\", cn\n\n   Dim fld As ADODB.Field\n   Dim i As Integer\n\n   Sheets.Add.name = \"Workings\"\n   With ThisWorkbook.Worksheets(\"Workings\")\n      i = 0\n      For Each fld In rs.Fields\n         i = i + 1\n         .Cells(1, i).Value = fld.name\n       Next fld\n       .Cells(2, 1).CopyFromRecordset rs\n       .UsedRange.Columns.AutoFit\n   End With\n\n   rs.Close\n   cn.Close\n   OptimizeVBA False\nEnd Sub\n</code></pre>\n\n<p>Optimize just optimizes the workbook and SHdel deletes the sheet. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1499264386, "post_id": 44928753, "comment_id": 76833185, "body": "Why copy then delete? Why not just copy what you want? In any event, if you show the relevant code then it would be easier for us to suggest how to improve it."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 3, "creation_date": 1499265183, "post_id": 44928753, "comment_id": 76833810, "body": "Just add a formula in Column A to display the row number if there&#39;s data in an adjacent cell. No need for VBA. Or even type &quot;1&quot; in the first cell and auto-fill"}], "answers": [{"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 1, "last_activity_date": 1499265229, "creation_date": 1499265229, "answer_id": 44929178, "question_id": 44928753, "link": "https://stackoverflow.com/questions/44928753/macro-code-to-number-lines-based-on-if-there-is-data/44929178#44929178", "title": "Macro Code to Number Lines based on if there is Data", "body": "<p>You may try something like this...</p>\n\n<p>After deleting rows, run the following code which will add the sequence number in column A starting from row2.</p>\n\n<pre><code>Sub SqNumber()\nDim lr As Long\nlr = Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\nWith Range(\"A2:A\" &amp; lr)\n    .Formula = \"=Row()-1\"\n    .Value = .Value\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1499265633, "creation_date": 1499265633, "answer_id": 44929356, "question_id": 44928753, "link": "https://stackoverflow.com/questions/44928753/macro-code-to-number-lines-based-on-if-there-is-data/44929356#44929356", "title": "Macro Code to Number Lines based on if there is Data", "body": "<p>Use union  method.  You collect range and at the last line,  delete them.</p>\n\n<pre><code>Sub test()\n    Dim rngU As Range\n    Dim i As Integer\n\n    For i = 1 To 100\n        If Range(\"a\" &amp; i) = \"\" Then\n            If rngU Is Nothing Then\n                Set rngU = Range(\"a\" &amp; i)\n            Else\n                Set rngU = Union(rngU, Range(\"a\" &amp; i))\n            End If\n        End If\n    Next i\n    If rngU Is Nothing Then\n    Else\n        rngU.EntireRow.Delete 'rngu is collected ranges.\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 8249871, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/557665bcb6fb5814625d8c99421aedea?s=128&d=identicon&r=PG&f=1", "display_name": "Bsmith", "link": "https://stackoverflow.com/users/8249871/bsmith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1499285416, "creation_date": 1499264184, "last_edit_date": 1499285416, "question_id": 44928753, "link": "https://stackoverflow.com/questions/44928753/macro-code-to-number-lines-based-on-if-there-is-data", "title": "Macro Code to Number Lines based on if there is Data", "body": "<p>I am newish at VBA but I cannot figure out how to make this work. I am copying a ton of data from a another Excel sheet and then deleting the unneeded rows. The problem is that I need my data numbered in column A and when I delete the row it skips numbers. I want a macro that will number my data after I delete the unneeded lines. I do need it to stop when my data stops but the number of lines will be different each time. Any tips? Thank you.</p>\n"}, {"tags": ["excel", "vba", "connection"], "owner": {"reputation": 11, "user_id": 8259283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ecc9cbe8db9ef26f7d2af0b4272e7e4?s=128&d=identicon&r=PG&f=1", "display_name": "frobeniusabnorm", "link": "https://stackoverflow.com/users/8259283/frobeniusabnorm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 2, "answer_count": 0, "score": 1, "last_activity_date": 1499264173, "creation_date": 1499264173, "question_id": 44928749, "link": "https://stackoverflow.com/questions/44928749/data-connection-between-excel-workbooks-file-opens-when-refreshing-connections", "title": "Data connection between excel workbooks: File opens when refreshing connections", "body": "<p>I\u2019m attempting to migrate an existing excel sheet from using links to using data connections to other excel workbooks (Excel 2010).  Upon switching my first couple cells, I refreshed the connection to test it out, and while the cells populated just as I\u2019d hoped, excel actually opened the sheet I was connecting to on top of the sheet I was working on.  I did see a suggestion somewhere that implied making it a shared workbook would help, but to make the data connections work as desired, I had to create a table on a background tab, so sharing the workbook is not possible.</p>\n\n<p>Is there a way to suppress the sheet I\u2019m connecting to from opening up?  I don\u2019t want to go too far down this rabbithole if it\u2019s always going to do this.</p>\n\n<p>Bonus:  VBA code for automatically refreshing links every few minutes when the sheet is open, if it\u2019s possible (rather than having the user press a button at will), may prevent me from having to migrate over to using connections to begin with.  I\u2019ve just not had much luck finding any that might work so far.</p>\n\n<p>Please let me know if you require further clarification!  Thanks!</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1499264247, "post_id": 44928684, "comment_id": 76833049, "body": "If your host is Excel, <code>Selection</code> is referring to what&#39;s selected <i>in Excel</i>... but that <code>With Selection</code> block isn&#39;t doing anything, just remove it. Your life would be easier if you added a reference to the Microsfoft Word type library, and worked with a <code>Word.Application</code> and <code>Word.Document</code> instead of an <code>Object</code>."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 8160629, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e132917d0ec1161e492987ede766ea26?s=128&d=identicon&r=PG&f=1", "display_name": "Jmaragno", "link": "https://stackoverflow.com/users/8160629/jmaragno"}, "edited": false, "score": 0, "creation_date": 1499265073, "post_id": 44928878, "comment_id": 76833720, "body": "Hi Busse, that is where I was running into trouble, I do not want it to open a new document everytime, but to reference the document that I already have open. Sorry I am fairly new to VBA and am still learning my way around"}, {"owner": {"reputation": 823, "user_id": 7746454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95207c62ad1aed75ade3f53fb7216308?s=128&d=identicon&r=PG&f=1", "display_name": "Busse", "link": "https://stackoverflow.com/users/7746454/busse"}, "reply_to_user": {"reputation": 29, "user_id": 8160629, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e132917d0ec1161e492987ede766ea26?s=128&d=identicon&r=PG&f=1", "display_name": "Jmaragno", "link": "https://stackoverflow.com/users/8160629/jmaragno"}, "edited": false, "score": 0, "creation_date": 1499267494, "post_id": 44928878, "comment_id": 76835742, "body": "Don&#39;t apologize, live and learn! I think I misunderstood the question though."}], "tags": [], "owner": {"reputation": 823, "user_id": 7746454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95207c62ad1aed75ade3f53fb7216308?s=128&d=identicon&r=PG&f=1", "display_name": "Busse", "link": "https://stackoverflow.com/users/7746454/busse"}, "is_accepted": false, "score": 0, "last_activity_date": 1499274212, "last_edit_date": 1499274212, "creation_date": 1499264474, "answer_id": 44928878, "question_id": 44928684, "link": "https://stackoverflow.com/questions/44928684/referencing-already-opened-word-document-in-vba/44928878#44928878", "title": "Referencing already opened word document in VBA", "body": "<p>Are you saying you already have the document open when you run this every time?  The way you wrote the code, it will do this:</p>\n\n<p>1) Open new blank Microsoft Word process</p>\n\n<p>2) In the new process, opens the workbook you have chosen</p>\n\n<p>3) Makes the new process the active window</p>\n\n<p>4) <code>does stuff</code></p>\n\n<p>If you want it to attach to the file you <em>already</em> have open, you would need to do <code>GetObject</code> instead of <code>CreateObject</code>. So change:</p>\n\n<pre><code>Set objWord = CreateObject(\"Word.Application\")\n</code></pre>\n\n<p>To </p>\n\n<pre><code>Set objWord = GetObject(, \"Word.Application\")\n</code></pre>\n\n<p>This will attach to the currently open process, then open the workbook in that process. However, it will still open up a fresh copy of that document each time, because that's what you're telling it to do.</p>\n"}, {"tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": true, "score": 0, "last_activity_date": 1499265566, "creation_date": 1499265566, "answer_id": 44929323, "question_id": 44928684, "link": "https://stackoverflow.com/questions/44928684/referencing-already-opened-word-document-in-vba/44929323#44929323", "title": "Referencing already opened word document in VBA", "body": "<p>Try this:  </p>\n\n<pre><code>With objWord \n\n   .Selection.MoveDown count:=6\n   .Selection.MoveRight count:=5\n   .Selection.TypeText Text:=\"Repair and Calibration\"\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 8160629, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e132917d0ec1161e492987ede766ea26?s=128&d=identicon&r=PG&f=1", "display_name": "Jmaragno", "link": "https://stackoverflow.com/users/8160629/jmaragno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3840, "favorite_count": 0, "accepted_answer_id": 44929323, "answer_count": 2, "score": 0, "last_activity_date": 1499274212, "creation_date": 1499264021, "question_id": 44928684, "link": "https://stackoverflow.com/questions/44928684/referencing-already-opened-word-document-in-vba", "title": "Referencing already opened word document in VBA", "body": "<p>I am using Excel VBA to open a word Template and it populates the template with information from an excel spreadsheet. From there, I have a button on the spreadsheet that I want to then populate another line in the word document whenever it is clicked. The problem I am encountering is that when I run the button macro it just opens up another word document and pastes the button information instead of doing it on the already opened document. I will attach my code below and I believe it is an easy fix I just can't seem to find a way around it.</p>\n\n<pre><code>Sub RepairCal()\n\nDim objWord As Object\nDim objDoc As Object\n\n    Set objWord = CreateObject(\"Word.Application\")\n    objWord.Visible = True\n    Set objDoc = objWord.Documents.Open(\"C:\\Users\\z003narc\\Documents\\Gage Lab Form Template.docm\")\n\nobjWord.Activate\n\nWith Selection\n\n   objWord.ActiveDocument.Selection.MoveDown count:=6\n   objWord.ActiveDocument.Selection.MoveRight count:=5\n   objWord.ActiveDocument.Selection.TypeText Text:=\"Repair and Calibration\"\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "powershell", "ado", "powershell-4.0", "vba"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1499263237, "post_id": 44928323, "comment_id": 76832230, "body": "Possibly useful: <a href=\"https://stackoverflow.com/questions/536636/write-array-to-excel-range\" title=\"write array to excel range\">stackoverflow.com/questions/536636/write-array-to-excel-rang&zwnj;&#8203;e</a>"}, {"owner": {"reputation": 9170, "user_id": 5039142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rm38D.png?s=128&g=1", "display_name": "G42", "link": "https://stackoverflow.com/users/5039142/g42"}, "edited": false, "score": 1, "creation_date": 1499263327, "post_id": 44928323, "comment_id": 76832288, "body": "Yes. For example, you could use <code>Export-CSV</code>. And if you need to use Excel functions, open the file in Excel."}, {"owner": {"reputation": 105, "user_id": 2474322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ffa8742a52b7622f3459e9616ead1c3c?s=128&d=identicon&r=PG", "display_name": "VSMK", "link": "https://stackoverflow.com/users/2474322/vsmk"}, "reply_to_user": {"reputation": 9170, "user_id": 5039142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rm38D.png?s=128&g=1", "display_name": "G42", "link": "https://stackoverflow.com/users/5039142/g42"}, "edited": false, "score": 0, "creation_date": 1499770762, "post_id": 44928323, "comment_id": 77038742, "body": "@gms0ulman export-csv did the trick, only thing is file size is huge"}], "answers": [{"tags": [], "owner": {"reputation": 10390, "user_id": 1980228, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/l13Ys.jpg?s=128&g=1", "display_name": "AdamL", "link": "https://stackoverflow.com/users/1980228/adaml"}, "is_accepted": false, "score": 0, "last_activity_date": 1499265761, "creation_date": 1499265761, "answer_id": 44929418, "question_id": 44928323, "link": "https://stackoverflow.com/questions/44928323/performance-increase-for-powershell-dataset-to-excel/44929418#44929418", "title": "Performance increase for PowerShell dataset to Excel", "body": "<p>You shoud try <a href=\"https://github.com/RamblingCookieMonster/PSExcel\" rel=\"nofollow noreferrer\">PSExcel</a> module. There's no need to create COM object and even have Excel installed. Your example would look like this and be lightning fast: </p>\n\n<pre><code>$dataset.Tables[0] | \nSelect-Object ID,Name,Age | \nExport-XLSX -Path $FullName -AutoFit -WorksheetName 'MyData'\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 2474322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ffa8742a52b7622f3459e9616ead1c3c?s=128&d=identicon&r=PG", "display_name": "VSMK", "link": "https://stackoverflow.com/users/2474322/vsmk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 355, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1499265761, "creation_date": 1499263002, "last_edit_date": 1531161705, "question_id": 44928323, "link": "https://stackoverflow.com/questions/44928323/performance-increase-for-powershell-dataset-to-excel", "title": "Performance increase for PowerShell dataset to Excel", "body": "<p>I have a PowerShell script which pulls data from DB and pushes it to a excel sheet. I am facing slowness (45 mins approx) while copying the records in the dataset to the excel sheet as the number of records exceed 200K. And I am trying to loop them one by one using the below snippet, which takes more time. Is there a way in which I can transfer the data from dataset to excel more efficiently?</p>\n\n<pre><code>   $cells=$Worksheet.Cells\n   $row=1\n   foreach ($rec in $dataset.Tables[0].Rows)\n        {\n            $row++\n            $col=1\n            $cells.item($Row,$col)=$USR.ID\n            $col++\n            $cells.item($Row,$col)=$USR.Name\n            $col++\n            $cells.item($Row,$col)=$USR.Age\n            $col++\n        }\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1499262982, "post_id": 44928208, "comment_id": 76832041, "body": "Try saving the file as an .xls to be certain that it isnt a macro issue. If the file still hangs as a non-macro enabled file (make sure you close and re-open after saving) then it is a formula issue. If the file doesn&#39;t still hang it is a macro issue. My experience with calculations isn&#39;t too broad, but if you are having it calculate in a loop like that then either an event is triggering (likely a worksheet event) or your formulas are volatile (any time one value changes, all associated values must recalculate. This is different from Excel&#39;s standard &#39;dirty cells only&#39; approach."}, {"owner": {"reputation": 31, "user_id": 8259541, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qZ3dQmBTrdI/AAAAAAAAAAI/AAAAAAAAAws/tX4isE9y4xM/photo.jpg?sz=128", "display_name": "Archie Wood", "link": "https://stackoverflow.com/users/8259541/archie-wood"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1499264904, "post_id": 44928208, "comment_id": 76833606, "body": "Unfortunately i&#39;m working in a 64bit .xlsb file, so saving as an xls isn&#39;t an option, as the sheets aren&#39;t large enough to hold where my data is. There are plenty of volatile functions [INDIRECT() mainly] in the file, so that is worthy of investigation. How would I diagnose if it is an event triggering?"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1499266452, "post_id": 44928208, "comment_id": 76834893, "body": "Aside from saving it as a non macro file you could do &#39;Application.EnableEvents = False&#39; in the immediate window. This should turn off all events. There are also security settings, or manually checking every single folder in the VB project and adding breakpoints."}, {"owner": {"reputation": 31, "user_id": 8259541, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qZ3dQmBTrdI/AAAAAAAAAAI/AAAAAAAAAws/tX4isE9y4xM/photo.jpg?sz=128", "display_name": "Archie Wood", "link": "https://stackoverflow.com/users/8259541/archie-wood"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 1, "creation_date": 1499273272, "post_id": 44928208, "comment_id": 76839585, "body": "Thanks for all the help. The issue turned out to be a volatile action that a macro was triggering. I had a macro that looped through hiding empty rows, but hiding a row is volatile, so then triggers a new calculation before the next run through the loop. The loop itself was 500 iterations, so that meant 500 sets of 3 second calculations! Happy to mark as answer if you rephrase to focus on volatile actions!"}, {"owner": {"reputation": 31, "user_id": 8259541, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qZ3dQmBTrdI/AAAAAAAAAAI/AAAAAAAAAws/tX4isE9y4xM/photo.jpg?sz=128", "display_name": "Archie Wood", "link": "https://stackoverflow.com/users/8259541/archie-wood"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1499273624, "post_id": 44928208, "comment_id": 76839779, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/bb687891(v=office.15).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/bb687891(v=office.15).aspx</a>"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 8259541, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qZ3dQmBTrdI/AAAAAAAAAAI/AAAAAAAAAws/tX4isE9y4xM/photo.jpg?sz=128", "display_name": "Archie Wood", "link": "https://stackoverflow.com/users/8259541/archie-wood"}, "is_accepted": false, "score": 1, "last_activity_date": 1500297722, "creation_date": 1500297722, "answer_id": 45145466, "question_id": 44928208, "link": "https://stackoverflow.com/questions/44928208/excel-automatic-calculation-crashes-but-manual-calculation-works/45145466#45145466", "title": "Excel automatic calculation crashes, but manual calculation works", "body": "<p>The issue turned out to be a volatile action that a macro was triggering. I had a macro that looped through hiding empty rows, but hiding a row is volatile, so then triggers a new calculation before the next run through the loop. The loop itself was 500 iterations, so that meant 500 sets of 3 second calculations! </p>\n\n<p>See this link for more on volatile actions:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/bb687891(v=office.15).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/bb687891(v=office.15).aspx</a></p>\n"}], "owner": {"reputation": 31, "user_id": 8259541, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qZ3dQmBTrdI/AAAAAAAAAAI/AAAAAAAAAws/tX4isE9y4xM/photo.jpg?sz=128", "display_name": "Archie Wood", "link": "https://stackoverflow.com/users/8259541/archie-wood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2044, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1500297722, "creation_date": 1499262738, "last_edit_date": 1531161705, "question_id": 44928208, "link": "https://stackoverflow.com/questions/44928208/excel-automatic-calculation-crashes-but-manual-calculation-works", "title": "Excel automatic calculation crashes, but manual calculation works", "body": "<p>I have a relatively large (7MB) but more importantly formula and macro heavy excel file that I have been developing recently. \nFor the end user it must be able to be used in Automatic Calculation mode. </p>\n\n<p><strong>While calculating the whole sheet in Manual Calculation mode using F9 (Calculate Now) will work and calculate in ~10 seconds, but when I turn it onto Automatic mode, it will calculate repeatedly</strong> (i.e reaches 100% and then immediately starts again from 0%) and so freezes indefinitely.</p>\n\n<p>So far I have tried: </p>\n\n<ol>\n<li>Putting break points in all the VBA macros to see if it is hanging inside a macro</li>\n<li>Removing all of the macros from the file (I was worried one of them was being triggered to run repeatedly in automatic mode)</li>\n</ol>\n\n<p>but neither has worked leading me to wonder if the issue is not in fact VBA related.</p>\n\n<p>Does anyone have any ideas about:</p>\n\n<ul>\n<li>What might be causing this?</li>\n<li>How I might diagnose the cause?</li>\n</ul>\n\n<p>Happy to give more context if helpful. I am a relatively experienced excel user, and while generally don't write VBA macros from scratch am pretty confident at re-purposing code I inherit / find online. I am using a relatively powerful 6 core machine, but have tested it on others to the same results.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 823, "user_id": 7746454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95207c62ad1aed75ade3f53fb7216308?s=128&d=identicon&r=PG&f=1", "display_name": "Busse", "link": "https://stackoverflow.com/users/7746454/busse"}, "edited": false, "score": 1, "creation_date": 1499262847, "post_id": 44928127, "comment_id": 76831930, "body": "Your logic is off to a good start.  What I would encourage you do, since you state you&#39;re new to VBA is: Enable the Developer Tab under Options -&gt; Customize Ribbon and check Developer.  From there, your Record Macro button will be available, next to &quot;Ready&quot; in the bottom left hand corner.  Press that, and do what you want it to do.  What this will do is record your actions and place them into VBA so you can read and understand them. Then hit Alt + F11, or under Developer Tab go to Visual Basic, which takes you to the editor to see the code. Do you have any code already you can share?"}, {"owner": {"reputation": 1, "user_id": 8259408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94b587350d26004281c90ef4c6b57f20?s=128&d=identicon&r=PG&f=1", "display_name": "canyoudigits", "link": "https://stackoverflow.com/users/8259408/canyoudigits"}, "reply_to_user": {"reputation": 823, "user_id": 7746454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95207c62ad1aed75ade3f53fb7216308?s=128&d=identicon&r=PG&f=1", "display_name": "Busse", "link": "https://stackoverflow.com/users/7746454/busse"}, "edited": false, "score": 0, "creation_date": 1499264468, "post_id": 44928127, "comment_id": 76833244, "body": "ill give what i have but it was just to test if my thought process was sound    Sub TESTTEST()  Dim SrchRng As Range, cel As Range  Set SrchRng = Range(&quot;B6:C6&quot;) For Each cel In SrchRng      If cel.Value &lt;&gt; &quot;&quot; Then         cel.Offset(-1, 3).Value = cel.Value     End If Next cel  End Sub  im lookin mainly for is it an IF then statement to then trigger it to Find what i need and move it where its needed"}], "owner": {"reputation": 1, "user_id": 8259408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94b587350d26004281c90ef4c6b57f20?s=128&d=identicon&r=PG&f=1", "display_name": "canyoudigits", "link": "https://stackoverflow.com/users/8259408/canyoudigits"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499268488, "creation_date": 1499262546, "last_edit_date": 1499268488, "question_id": 44928127, "link": "https://stackoverflow.com/questions/44928127/excel-vba-if-cell-contains-text-copy-paste-to-another-row-uneven-spacing", "title": "Excel VBA- if cell contains text copy paste to another row (uneven spacing)", "body": "<p>im relatively New to VBA and ive been asked to come up with a Macro(or in the terms given to me Automate) to filter all the rows in my workbook that contain \"Total\" &amp; \"Average\" over a month long period and adjust the positions of 2 cells to be in line with another row.Now i can normally Filter what i need filtered but the problem lies in how i need to format it Exported. i need it looking from this</p>\n\n<p>e.g</p>\n\n<pre><code> COL1       |   COL2   |    COL3   |  COL4\nReport Date:| xx/xx/xx |   (BLANK) | (BLANK)\n-------------\nService Group:| Repayments |\n-------------\nTotal    xx | xx    | xx\n-----------\nAverage     |  xx   |    xx\n</code></pre>\n\n<p>To this.</p>\n\n<pre><code>   COL1     | COL2     |    COL3       | COL4  |\nReport Date:| xx/xx/xx | Service Group:| Repayments \n--------\nTotal       |  xx      |   xx          |  xx\n--------\nAverage     |  xx      |   xx          |  xx\n</code></pre>\n\n<p>the problem im having (besides being a completely new to VBA) is how to have it be \"Automated\" to which I had the idea of assigning a Macro to a Button which when pressed would cut Paste (then remove the blank space)every instance of  (Service Group:) &amp; (Repayments) up 1 row and over 3 columns\n so for another Example: after the filter the rows would be Numbered variously so Starting on Position: B6 &amp; C6 MOVE  Up one and Over three to Position E5 &amp; F5</p>\n\n<p>Sorry for the Long winded convoluted explanation I tried to TLDR but i couldnt think of a way to better describe it. edit 1. Also the data is nonsequential</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 199, "user_id": 4415301, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/p2GZU.jpg?s=128&g=1", "display_name": "Obfuscated", "link": "https://stackoverflow.com/users/4415301/obfuscated"}, "reply_to_user": {"reputation": 867, "user_id": 2770438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8219814e55b3ab73a24b7f24fdf8eb73?s=128&d=identicon&r=PG&f=1", "display_name": "jmdon", "link": "https://stackoverflow.com/users/2770438/jmdon"}, "edited": false, "score": 0, "creation_date": 1499263473, "post_id": 44928088, "comment_id": 76832408, "body": "Not a duplicate there. I can store the active cell before a cell change event, but I need to store it before a &quot;double click&quot; event."}, {"owner": {"reputation": 867, "user_id": 2770438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8219814e55b3ab73a24b7f24fdf8eb73?s=128&d=identicon&r=PG&f=1", "display_name": "jmdon", "link": "https://stackoverflow.com/users/2770438/jmdon"}, "edited": false, "score": 0, "creation_date": 1499265053, "post_id": 44928088, "comment_id": 76833713, "body": "I&#39;m trying to cancel the flag, but don&#39;t seem able to.."}], "answers": [{"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499264583, "post_id": 44928682, "comment_id": 76833341, "body": "Almost similar answers. +1 for hiding <code>pPrevious</code>, I like and usually apply the good practice of hiding variables as much as possible. However I&#39;d prefer <code>Set pPrevious = Target</code>.I also  showed more detail as to how to process the <code>BeforeDoubleClick</code>. :)"}, {"owner": {"reputation": 867, "user_id": 2770438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8219814e55b3ab73a24b7f24fdf8eb73?s=128&d=identicon&r=PG&f=1", "display_name": "jmdon", "link": "https://stackoverflow.com/users/2770438/jmdon"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1499264999, "post_id": 44928682, "comment_id": 76833668, "body": "+1 back at you, your answer is more helpful to the OP directly as I was relying on the link to explain the rest!"}], "tags": [], "owner": {"reputation": 867, "user_id": 2770438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8219814e55b3ab73a24b7f24fdf8eb73?s=128&d=identicon&r=PG&f=1", "display_name": "jmdon", "link": "https://stackoverflow.com/users/2770438/jmdon"}, "is_accepted": false, "score": 1, "last_activity_date": 1499264017, "creation_date": 1499264017, "answer_id": 44928682, "question_id": 44928088, "link": "https://stackoverflow.com/questions/44928088/remember-cell-selected-before-double-click/44928682#44928682", "title": "Remember cell selected before double click", "body": "<p><a href=\"https://stackoverflow.com/questions/19179756/previously-active-cell\">Using the method here</a> you can do as follows</p>\n\n<pre><code>Public PreviousActiveCell As Range\n\nPrivate Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\n    MsgBox (\"Previous selection: \" &amp; PreviousActiveCell.Value &amp; vbNewLine &amp; _\n    \"Double clicked selection: \" &amp; Target.Value)\n\n\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    Static pPrevious As Range\n    Set PreviousActiveCell = pPrevious\n    Set pPrevious = ActiveCell\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 2, "last_activity_date": 1499264326, "creation_date": 1499264326, "answer_id": 44928798, "question_id": 44928088, "link": "https://stackoverflow.com/questions/44928088/remember-cell-selected-before-double-click/44928798#44928798", "title": "Remember cell selected before double click", "body": "<p>Well, it's a bit more complicated than the \"duplicate thread\" because the <code>SelectionChange</code> event is invoked prior to the <code>BeforeDoubleClick</code> event, so the former will update the last selection to the new one before the latter gets hand.</p>\n\n<p>What you need is to go \"one step further\" in saving the selections, by actually saving both:</p>\n\n<ul>\n<li>The current selection</li>\n<li>The previous selection</li>\n</ul>\n\n<p>Something like this should work</p>\n\n<pre><code>' Code module of your worksheet\nOption Explicit\nPrivate lastSelection As Range, beforeLastSelection As Range\n\nPrivate Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n  ' Your Code for this event, i.e.\n  If Target.Address = \"$P$1\" Then\n    ' Some code ...\n     Cancel = True\n     If Not beforeLastSelection Is Nothing Then beforeLastSelection.Select\n  End If\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n  Set beforeLastSelection = lastSelection\n  Set lastSelection = Target\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 199, "user_id": 4415301, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/p2GZU.jpg?s=128&g=1", "display_name": "Obfuscated", "link": "https://stackoverflow.com/users/4415301/obfuscated"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 931, "favorite_count": 0, "accepted_answer_id": 44928798, "answer_count": 2, "score": 2, "last_activity_date": 1499264326, "creation_date": 1499262448, "last_edit_date": 1531164843, "question_id": 44928088, "link": "https://stackoverflow.com/questions/44928088/remember-cell-selected-before-double-click", "title": "Remember cell selected before double click", "body": "<p>I have an Excel sheet that has a <strong>doubleclick</strong> event in cell \"P1\" (runs a macro).</p>\n\n<p>I may have cell \"J30\" (or any other cell) selected before I <strong>doubleclick</strong> \"P1\"\nHow can I remember, and return to the cell \"J30\" after the \"P1\" <strong>doubleclick</strong>?</p>\n\n<p>Storing the active cell doesn't work because the first click in the doubleclick sequence, selects \"P1\".</p>\n\n<p>I also tried rightclick on \"P1\", but it also selects \"P1\" before running the event.</p>\n"}, {"tags": ["vba", "ms-access", "concatenation"], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 4648996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1622a53e00c95bbc524eb86e41d6b4af?s=128&d=identicon&r=PG&f=1", "display_name": "FoolzRailer", "link": "https://stackoverflow.com/users/4648996/foolzrailer"}, "is_accepted": true, "score": 0, "last_activity_date": 1499330881, "creation_date": 1499330881, "answer_id": 44944001, "question_id": 44927689, "link": "https://stackoverflow.com/questions/44927689/concatenate-two-different-cell-strings-based-on-id-using-allen-browne-concatrel/44944001#44944001", "title": "Concatenate two different cell strings, based on ID using Allen Browne ConcatRelated()", "body": "<p>Seemed I had it right, but a dynamic parameterized query beforehand was the issue. Removed that and it works. </p>\n"}], "owner": {"reputation": 63, "user_id": 4648996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1622a53e00c95bbc524eb86e41d6b4af?s=128&d=identicon&r=PG&f=1", "display_name": "FoolzRailer", "link": "https://stackoverflow.com/users/4648996/foolzrailer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 44944001, "answer_count": 1, "score": 0, "last_activity_date": 1499330881, "creation_date": 1499261402, "last_edit_date": 1499321231, "question_id": 44927689, "link": "https://stackoverflow.com/questions/44927689/concatenate-two-different-cell-strings-based-on-id-using-allen-browne-concatrel", "title": "Concatenate two different cell strings, based on ID using Allen Browne ConcatRelated()", "body": "<p>I'm trying to use the Allen Brownes ConcatRelated, but not sure if that is needed for this or not.</p>\n\n<p>I have a database with pipes, and their ids, in this I also have a column with the amount of observations on a giving pipe. These observations are on the same pipe but in different rows. I would like to concatenate this into one cell.</p>\n\n<p>To start of with I have two identical set up queries, with the same columns and types in them, these I join in a union query.</p>\n\n<p>Then I want to create a query based on that Union where i concatenate the aforementioned rows.</p>\n\n<p>Probably easier to show in a picture:\n<a href=\"https://i.stack.imgur.com/xdQ8j.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xdQ8j.png\" alt=\"enter image description here\"></a></p>\n\n<p>Union query is EksportOverblik, where I would like to concatenate the cells Antal observationer if they have the same delledning.</p>\n\n<p>This is what I tried so far.</p>\n\n<pre><code>Concatrelated(\"Antal observationer fordelt p\u00e5 kriterie/type\";\"[EksportOverblik]\";\"DelledningsID = \" &amp; [DelledningsID])\n</code></pre>\n\n<p>Also tried</p>\n\n<pre><code>ConcatRelated(\"[Antal observationer fordelt p\u00e5 kriterie/type]\";\"[EksportOverblik]\";\"DelledningsID = \" &amp; [EksportOverblik].[DelledningsID])\n</code></pre>\n\n<p>and</p>\n\n<pre><code>ConcatRelated(\"[Antal observationer fordelt p\u00e5 kriterie/type]\";\"[EksportOverblik]\";\"DelledningsID\";[EksportOverblik].[DelledningsID])\n</code></pre>\n\n<p>Basically all the ones with the same DelledningsID need to have their Antal observationer fordelt p\u00e5 kriterie/type concatenated into one. </p>\n\n<p>I'm getting Error 3070: The Microsoft Access database engine does not recognize '383' as a valid field name or expression. </p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 324, "user_id": 6645482, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tsdqr.jpg?s=128&g=1", "display_name": "Nathan Van Dyken", "link": "https://stackoverflow.com/users/6645482/nathan-van-dyken"}, "edited": false, "score": 3, "creation_date": 1499262710, "post_id": 44927483, "comment_id": 76831831, "body": "You tagged this question with both <code>excel-vba</code> and <code>excel-formula</code>.  Are you looking for a solution that uses either/both methods, or only one? Also, could you post a screenshot illustrating what you need to make it easier to visualize?"}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1499263709, "post_id": 44927483, "comment_id": 76832580, "body": "I&#39;m happy to help you through this but without example data and expected outcome it is hard to do, a simple mock up of fake data and the expected outcome in a screenshot will suffice. You can probably do this with a singe <code>SUMPRODUCT()</code> formula, <code>SUM() IF()</code> array formula or an <code>INDEX(), MATCH()</code> if you want a visual breakdown before running the total."}], "answers": [{"tags": [], "owner": {"reputation": 669, "user_id": 6754179, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2646872bfa0b8caf0db917b9afde5920?s=128&d=identicon&r=PG&f=1", "display_name": "ERT", "link": "https://stackoverflow.com/users/6754179/ert"}, "is_accepted": false, "score": -1, "last_activity_date": 1499291754, "creation_date": 1499291754, "answer_id": 44936620, "question_id": 44927483, "link": "https://stackoverflow.com/questions/44927483/find-min-value-between-a-variable-range-of-cells-in-two-columns-that-contain-tru/44936620#44936620", "title": "Find MIN value between a variable range of cells in two columns that contain TRUE", "body": "<p>This is a nice problem for us to look at.  I am assuming you are trading, and are looking at some sort of movement indicators at certain points in time (maybe some obscure Greeks or other functions rooted in advanced statistical analysis).  If you are looking to implement this in real-time, I highly recommend using some other programming languages (R is a great statistical programming language for the analysis of stock movement and rebalancing portfolios each day, as long as it is not time-sensitive to the nanosecond).  Speak with some of your colleagues who know HFT guys, they would be able to help you out with algorithmic trading.</p>\n\n<p>However, assuming you are doing this analysis for long-term trading strategies, not HFT, we need a bit of clarification, however...</p>\n\n<pre><code>date  time  open  high  low  close  condition1  condition2  \nxxxx  xxxx  xxxx  xxxx  xxxx xxxx   true \nxxxx  xxxx  xxxx  xxxx  xxxx xxxx                        \nxxxx  xxxx  xxxx  xxxx  xxxx xxxx                         \nxxxx  xxxx  xxxx  xxxx  xxxx xxxx                true\n</code></pre>\n\n<p>You gave us this sample data.  You want the number of rows between the <code>TRUE</code> values of columns <code>condition1</code> and <code>condition2</code>.  In this case, it should return either <code>2</code> or <code>4</code> ... which of these is correct?  This will affect the writing of the code.  </p>\n\n<p>Also, what if your data looks like this:</p>\n\n<pre><code>date  time  open  high  low  close  condition1  condition2  \nxxxx  xxxx  xxxx  xxxx  xxxx xxxx                 true\nxxxx  xxxx  xxxx  xxxx  xxxx xxxx                        \nxxxx  xxxx  xxxx  xxxx  xxxx xxxx                         \nxxxx  xxxx  xxxx  xxxx  xxxx xxxx     true    \n</code></pre>\n\n<p>In this case, do you still want to return the minimum value?  Or are you only concerned with the first case, where <code>condition1</code> is met, and <em>then</em> <code>condition2</code> is met some time after that?</p>\n\n<p>Also, what if this event happens:</p>\n\n<pre><code>date  time  open  high  low  close  condition1  condition2  \n    xxxx  xxxx  xxxx  xxxx  xxxx xxxx   true \n    xxxx  xxxx  xxxx  xxxx  xxxx xxxx             true           \n    xxxx  xxxx  xxxx  xxxx  xxxx xxxx                         \n    xxxx  xxxx  xxxx  xxxx  xxxx xxxx                \n</code></pre>\n\n<p>Would you like to return value <code>0</code>, or do you want the program to skip over this?</p>\n\n<p>I am sorry for all of the questions, but we need to know about these corner cases if we are to help you with your VBA-related request.</p>\n\n<p>Finally, do you have any VBA experience?  Have you attempted to write any yourself at this point?  If so, it would be great for you to include this to show some research and effort on your end, and for us to use as a basis to help you.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 8047228, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b9b72f2fe3d776fa2a0d2a2c6247ffc5?s=128&d=identicon&r=PG&f=1", "display_name": "MARCO SEOANE", "link": "https://stackoverflow.com/users/8047228/marco-seoane"}, "is_accepted": false, "score": 0, "last_activity_date": 1499324046, "last_edit_date": 1499324046, "creation_date": 1499322523, "answer_id": 44941302, "question_id": 44927483, "link": "https://stackoverflow.com/questions/44927483/find-min-value-between-a-variable-range-of-cells-in-two-columns-that-contain-tru/44941302#44941302", "title": "Find MIN value between a variable range of cells in two columns that contain TRUE", "body": "<p>thank you for the interest. i plan to attatch a copy of the spreadsheet i was trying to execute this idea on, im just not around that laptop at the moment. first things first, not really anything complicated on the level of what you described. dont want to trade 'live' or anything super in-depth. just want to be able to do some data collection on price behaviour on the fly. ill add alot of comments on the spreadsheet i attatch so you can get the jist of it. and on the subject of what if the conditions switch. the second condition will be reliant on the first to show itself as true. so the only other permutation will be that condition 2 doesnt show itself. when i get around my other laptop i will add alot of comments to the spreadsheet explaining everything in fine detail and attatch it. sorry no VBA experience, although running into these problems is making me heavily consider it. I usually went about collecting the info i would like to by hand, but gathering a big sample size is tedious work. thanks again.</p>\n\n<p>and on the other question you asked, i dont want to find the number of rows inbetween the range, i want to be able to specify that range in =MIN() calculation in another column.</p>\n\n<p>the first condition will trigger true if price has broken the high price in a column i have in the 10:00 row which is a =MAX() calculation from 6:00-10:00 giving me the four hour high. if any of the sequential prices in the high column are >= to the 4h high price condition1 prints true. then if any of the sequential low prices after this column has printed true are &lt;= the 6-10 high price - 0.0005 (5 points) another condition will hit True, with a third condition tracking this condition if its True and any of the sequential high prices reach back to the =max() high from 6-10 that condition will print True. </p>\n\n<p>i then want to find the minimum low value that falls between where my first and last condition are true. if they are not, do nothing. and like i explained before all conditions will rely on each other to be active before the other can check for its own criteria. so the only permutations are them 'not' being active as opposed to being shuffled around in a different order </p>\n\n<p>hopefully this explains it a lil before i can provide my spreadsheet</p>\n"}], "owner": {"reputation": 21, "user_id": 8047228, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b9b72f2fe3d776fa2a0d2a2c6247ffc5?s=128&d=identicon&r=PG&f=1", "display_name": "MARCO SEOANE", "link": "https://stackoverflow.com/users/8047228/marco-seoane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1499324046, "creation_date": 1499260918, "last_edit_date": 1531161705, "question_id": 44927483, "link": "https://stackoverflow.com/questions/44927483/find-min-value-between-a-variable-range-of-cells-in-two-columns-that-contain-tru", "title": "Find MIN value between a variable range of cells in two columns that contain TRUE", "body": "<p>Sorry if I'm not being super clear! I'm not very adept with Excel but have been making use of it lately for some analysis on financial data. I have a normal OHLC set of data and two other columns where I have some IF statements printing True or False.</p>\n\n<p>How would I accomplish the following:</p>\n\n<p>I want to find the minimum value in one of the OHLC columns that is in a range between where one column has a True value and the other has a True value? This range will be variable and changing depending on the distance between the two trues in each column, if they are there.</p>\n\n<p>I do not need to continually do this, just on a day by day basis. I only need a formula to select this range going back, for example, where the day in my time-series begins at 10:00 each day.</p>\n\n<p>sorry for being unclear, imagine this.</p>\n\n<pre><code>date  time  open  high  low  close  condition1  condition2  \nxxxx  xxxx  xxxx  xxxx  xxxx xxxx   true \nxxxx  xxxx  xxxx  xxxx  xxxx xxxx                         &lt;--------this range\nxxxx  xxxx  xxxx  xxxx  xxxx xxxx                         &lt;--------i want min \nxxxx  xxxx  xxxx  xxxx  xxxx xxxx                true\n</code></pre>\n\n<p>but of course this range is variable each day, the conditions may be spaced out differently or might not have (2) true's but if it does. i want to know how to specify whatever range of cells is inbetween these two values </p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 2, "creation_date": 1499261955, "post_id": 44927231, "comment_id": 76831289, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/32118072/too-few-parameters-expected-1-recordset-issue\">Too few parameters Expected 1, recordset issue</a>"}], "answers": [{"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1499261987, "post_id": 44927373, "comment_id": 76831310, "body": "This is not the issue here."}, {"owner": {"reputation": 107, "user_id": 6104146, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10154083379249365/picture?type=large", "display_name": "Steve O&#39;Dea", "link": "https://stackoverflow.com/users/6104146/steve-odea"}, "edited": false, "score": 0, "creation_date": 1499262533, "post_id": 44927373, "comment_id": 76831698, "body": "Hi Andre, thanks for this. I&#39;m pretty new to VBA coding, so I&#39;m afraid that your response means very little to me.  Could you bridge the gap and flesh out your explanation for me so I might have a better chance of understanding it?  Thanks"}, {"owner": {"reputation": 107, "user_id": 6104146, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10154083379249365/picture?type=large", "display_name": "Steve O&#39;Dea", "link": "https://stackoverflow.com/users/6104146/steve-odea"}, "edited": false, "score": 0, "creation_date": 1499262638, "post_id": 44927373, "comment_id": 76831767, "body": "The problem is is that the integer values could change depending on what the is set in [Frame64]"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 107, "user_id": 6104146, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10154083379249365/picture?type=large", "display_name": "Steve O&#39;Dea", "link": "https://stackoverflow.com/users/6104146/steve-odea"}, "edited": false, "score": 0, "creation_date": 1499262684, "post_id": 44927373, "comment_id": 76831801, "body": "@SteveO&#39;Dea: The answer and explanation are in the link Andr&#233; provided."}, {"owner": {"reputation": 107, "user_id": 6104146, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10154083379249365/picture?type=large", "display_name": "Steve O&#39;Dea", "link": "https://stackoverflow.com/users/6104146/steve-odea"}, "edited": false, "score": 0, "creation_date": 1499275786, "post_id": 44927373, "comment_id": 76840956, "body": "Thanks folks, it looks like the threads are similar, although I like Kostas&#39; solution below. Thanks for the input"}], "tags": [], "owner": {"reputation": 712, "user_id": 3243922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFTEb.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3243922/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1499260557, "creation_date": 1499260557, "answer_id": 44927373, "question_id": 44927231, "link": "https://stackoverflow.com/questions/44927231/openrecordset-not-recognisng-query-criteria/44927373#44927373", "title": "OpenRecordset not recognisng query criteria", "body": "<p>This may sound pretty stupid but the easiest way to solve this is to create two constants for the dbOpenDynamic and dbSeeChanges values and set their values to the right integer values. You can of course also just type the relevant integer values in the OpenRecordset call.</p>\n"}, {"comments": [{"owner": {"reputation": 107, "user_id": 6104146, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10154083379249365/picture?type=large", "display_name": "Steve O&#39;Dea", "link": "https://stackoverflow.com/users/6104146/steve-odea"}, "edited": false, "score": 0, "creation_date": 1499275662, "post_id": 44928471, "comment_id": 76840887, "body": "Hi Kostas, this makes sense to me now. I wasn&#39;t sure of the syntax, but you explained this beautifully. Thanks so much"}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": true, "score": 0, "last_activity_date": 1499263430, "creation_date": 1499263430, "answer_id": 44928471, "question_id": 44927231, "link": "https://stackoverflow.com/questions/44927231/openrecordset-not-recognisng-query-criteria/44928471#44928471", "title": "OpenRecordset not recognisng query criteria", "body": "<p>You need to open the Recordset through a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822070.aspx\" rel=\"nofollow noreferrer\">QueryDef</a>.</p>\n\n<pre><code>Sub Whatever()\n    Dim db As Database\n    Dim qdf As QueryDef\n    Dim rs As Recordset\n\n    Set db = CurrentDb()\n    Set qdf = db.QueryDefs(\"qryMergeEzineCompleteMerges\")\n\n   'add any parameters here\n    With qdf\n        .Parameters(\"[parameter1]\").Value = value1\n        .Parameters(\"[parameter2]\").Value = value2\n    End With\n\n    Set rs = qdf.OpenRecordset(dbOpenDynaset)\n\n    '...\n\n    rs.Close\n    Set rs = Nothing\n    qdf.Close\n    Set qdf = Nothing\n    Set db = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 6104146, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10154083379249365/picture?type=large", "display_name": "Steve O&#39;Dea", "link": "https://stackoverflow.com/users/6104146/steve-odea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 481, "favorite_count": 0, "accepted_answer_id": 44928471, "answer_count": 2, "score": 0, "last_activity_date": 1594651030, "creation_date": 1499260167, "last_edit_date": 1594651030, "question_id": 44927231, "link": "https://stackoverflow.com/questions/44927231/openrecordset-not-recognisng-query-criteria", "title": "OpenRecordset not recognisng query criteria", "body": "<p>I have developed an Access Database query which references an object on a form in order to dynamically filter the data. The criteria upon which the query is filtered is as follows:</p>\n\n<pre><code>[Forms]![frmMain]![NavigationSubform].[Form]![Frame64]\n</code></pre>\n\n<p>Where [frame64] is where the user chooses one of two options on a form.</p>\n\n<p>Whilst this query runs fine in Access, I want to use this query in a piece of VBA code, but the problem is, when I try to open the record set, VBA won't allow me.</p>\n\n<pre><code>Dim db As Database\nDim rs As Recordset    \n\n\nSet db = CurrentDb\nSet rs = db.OpenRecordset(\"qryMergeEzineCompleteMerges\", dbOpenDynamic, dbSeeChanges)\n</code></pre>\n\n<p>Through my research, I have discovered that it is because VBA doesn't recognise the query criteria I have defined as it refers to a form.</p>\n\n<p>Can anyone please show me how I can reference this recordset in VBA so that it filters by the criteria I have stipulated in the query itself?</p>\n\n<p>Many thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499262721, "post_id": 44927225, "comment_id": 76831844, "body": "Would you be more specific on how it <i>&quot;doesn&#39;t work&quot;</i>? does it raise a runtime error? or does it just do nothing? Also you can try to add some <code>Debug.Print strFile</code> inside the <code>If</code> bloc where the WB succeeds to open (that is, after the line <code>If (Not wb Is Nothing) Then</code>), and check the immediate window to see if you opened successfully any workbooks."}, {"owner": {"reputation": 1, "user_id": 7683247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca0f2a6cc8b988652b4512436c0465fa?s=128&d=identicon&r=PG&f=1", "display_name": "lil", "link": "https://stackoverflow.com/users/7683247/lil"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499268211, "post_id": 44927225, "comment_id": 76836243, "body": "There is no runtime error however I noticed line <code>strFile = Dir(strDataPath &amp; &quot;*\\.xls?&quot;)</code> causes a problem, when ran without debug it returns empty string, but when I insert breakpoint on it, it works fine. I tried changing filter to &quot;.xls&quot;(when strDataPath included &quot;\\&quot; at the end already) or &quot;\\.xls&quot;(both with .xls files in given folder) and it returns empty string as well in this case."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499271910, "post_id": 44927225, "comment_id": 76838765, "body": "Try to minimize the code to an <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> that isolates the problem and focuses on the failure of the <code>Dir</code> function. There are chances that you will spot the problem, and if not, post the MCVE here and include as much information as possible, especially the used path and the file names in that folder."}], "owner": {"reputation": 1, "user_id": 7683247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca0f2a6cc8b988652b4512436c0465fa?s=128&d=identicon&r=PG&f=1", "display_name": "lil", "link": "https://stackoverflow.com/users/7683247/lil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499268501, "creation_date": 1499260153, "last_edit_date": 1499268501, "question_id": 44927225, "link": "https://stackoverflow.com/questions/44927225/sub-that-unprotects-selected-workbook-only-works-in-step-by-step-debuger", "title": "Sub that unprotects selected workbook only works in step by step debuger", "body": "<p>I have a VBA procedure that unprotects excel workbooks from given path, but it seems to work only in debug mode, when I am stepping through it.\nI was trying to force doing events before key lines, but it doesn't help.</p>\n\n<p>I'm running Excel 2016 on Windows 10.\nWould anyone advise what can I do with it please?</p>\n\n<pre><code>Public Sub UnprotectWorkbooks(strDataPath As String, blnOpen As Boolean)\n    Application.DisplayAlerts = False\n    Dim passArray As Variant\n    passArray = ThisWorkbook.Sheets(\"Passwords\").Range(\"B3:C10\").Value\n    Dim FSO As New Scripting.FileSystemObject\n\n    Dim i As Long, j As Long\n    Dim wb As Workbook\n    Set wb = Nothing\n    Dim strFile As String, strExtension As String, strBaseName As String\n\n    strFile = Dir(strDataPath &amp; \"\\*.xls?\")\n    Dim lFileFormatNum As Long\n\n    Do While strFile &lt;&gt; \"\"\n        For j = LBound(passArray, 2) To UBound(passArray, 2)\n            For i = LBound(passArray, 1) To UBound(passArray, 1)\n                Set wb = Workbooks.Open(Filename:=strDataPath &amp; \"\\\" &amp; strFile, Password:=passArray(i, j))\n                If (Not wb Is Nothing) Then\n                    If wb.Name = strFile Then GoTo NextXls\n                End If\n            Next i\n        Next j\n    NextXls:          \n        wb.SaveAs Filename:=strDataPath &amp; FSO.GetBaseName(strFile) &amp; \".xlsx\", FileFormat:=51, Password:=\"\"\n        strFile = Dir\n        If blnOpen = False Then wb.Close\n    Loop\n\n    Set FSO = Nothing\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>Edit: I noticed line <code>strFile = Dir(strDataPath &amp; \"\\*.xls?\")</code> causes a problem, when ran without debug it returns empty string, but when I insert breakpoint on it, it works fine. I tried changing filter to \"*.xls\"(when strDataPath included \"\\\" at the end already) or \"*.xls\"(both with .xls files in given folder) and it returns empty string as well in this case.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1499264961, "post_id": 44928129, "comment_id": 76833638, "body": "Note: a similar function <code>IsError</code> is available in VBA, no need to prefix it with <code>Application.WorksheetFunction.</code>"}, {"owner": {"reputation": 41, "user_id": 7710175, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-mNgwNtUXmcI/AAAAAAAAAAI/AAAAAAAARjA/_TQ5KEJTfyI/photo.jpg?sz=128", "display_name": "Mike S", "link": "https://stackoverflow.com/users/7710175/mike-s"}, "edited": false, "score": 0, "creation_date": 1499265050, "post_id": 44928129, "comment_id": 76833708, "body": "Hmmm.. still is copying the errors. Is that because the values are actually formulas and not just &quot;N/A&quot;?"}, {"owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "reply_to_user": {"reputation": 41, "user_id": 7710175, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-mNgwNtUXmcI/AAAAAAAAAAI/AAAAAAAARjA/_TQ5KEJTfyI/photo.jpg?sz=128", "display_name": "Mike S", "link": "https://stackoverflow.com/users/7710175/mike-s"}, "edited": false, "score": 0, "creation_date": 1499266177, "post_id": 44928129, "comment_id": 76834622, "body": "@MikeS - can you  provide a sample of the data?"}, {"owner": {"reputation": 41, "user_id": 7710175, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-mNgwNtUXmcI/AAAAAAAAAAI/AAAAAAAARjA/_TQ5KEJTfyI/photo.jpg?sz=128", "display_name": "Mike S", "link": "https://stackoverflow.com/users/7710175/mike-s"}, "edited": false, "score": 0, "creation_date": 1499268853, "post_id": 44928129, "comment_id": 76836695, "body": "of course... try this link <a href=\"https://drive.google.com/file/d/0B2M8DnCQpk3URk92T2NlaDNlVkE/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/0B2M8DnCQpk3URk92T2NlaDNlVkE/&hellip;</a>"}, {"owner": {"reputation": 41, "user_id": 7710175, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-mNgwNtUXmcI/AAAAAAAAAAI/AAAAAAAARjA/_TQ5KEJTfyI/photo.jpg?sz=128", "display_name": "Mike S", "link": "https://stackoverflow.com/users/7710175/mike-s"}, "edited": false, "score": 0, "creation_date": 1499282385, "post_id": 44928129, "comment_id": 76844626, "body": "Yes, either a value from the lookup or #N/A and sometimes 0 for some reason"}, {"owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "edited": false, "score": 0, "creation_date": 1499282566, "post_id": 44928129, "comment_id": 76844752, "body": "I&#39;ve updated my answer with code that works on the sample data you gave me regardless of if there is anything in the columns or not"}, {"owner": {"reputation": 41, "user_id": 7710175, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-mNgwNtUXmcI/AAAAAAAAAAI/AAAAAAAARjA/_TQ5KEJTfyI/photo.jpg?sz=128", "display_name": "Mike S", "link": "https://stackoverflow.com/users/7710175/mike-s"}, "edited": false, "score": 0, "creation_date": 1499693727, "post_id": 44928129, "comment_id": 77000719, "body": "Works great!! One question, What does X = 10 to 2 Step -1 do?"}, {"owner": {"reputation": 41, "user_id": 7710175, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-mNgwNtUXmcI/AAAAAAAAAAI/AAAAAAAARjA/_TQ5KEJTfyI/photo.jpg?sz=128", "display_name": "Mike S", "link": "https://stackoverflow.com/users/7710175/mike-s"}, "edited": false, "score": 0, "creation_date": 1499693822, "post_id": 44928129, "comment_id": 77000793, "body": "Also, how would I Iterate through multiple columns? Is that the X = 10 to 2 Step -1 statement?"}, {"owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "reply_to_user": {"reputation": 41, "user_id": 7710175, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-mNgwNtUXmcI/AAAAAAAAAAI/AAAAAAAARjA/_TQ5KEJTfyI/photo.jpg?sz=128", "display_name": "Mike S", "link": "https://stackoverflow.com/users/7710175/mike-s"}, "edited": false, "score": 0, "creation_date": 1499694286, "post_id": 44928129, "comment_id": 77001131, "body": "@MikeS - In this case, yes.  the line of code <code>X = 10 to 2 Step -1</code> counts down from 10 to 2 by subtracting 1 each time.  using the value of <code>X</code> in the line of code <code>oRng1.Offset(0, X).Value</code> references the cell offset.  In this case when <b>X = 10</b> the column referenced is <b>K</b> and as <b>X</b> counts down we are moving backwards through the columns  X = 10 = K, X = 9 = J, X = 8 = I,...., X = 2 = C"}], "tags": [], "owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1499282637, "last_edit_date": 1499282637, "creation_date": 1499262549, "answer_id": 44928129, "question_id": 44927210, "link": "https://stackoverflow.com/questions/44927210/vba-excel-2010-if-error-like-n-a-then-move-to-next-row/44928129#44928129", "title": "VBA (excel 2010) if error (like #N/A) then move to next row", "body": "<p>You can use <code>Application.WorksheetFunction.IsError</code> to check the formula result to see if it is an error.  In which case your code would look like this (edited to make use of the <code>IsError()</code> function mentioned in the comments</p>\n\n<pre><code>    Sub MakeSummary2()\n\n\n    Dim oRng1 As Range\n    Dim oRng2 As Range\n    Dim oWS1 As Worksheet\n    Dim oWS2 As Worksheet\n    Dim X As Integer\n\n    ' Initial cell to check\n    Set oWS1 = ThisWorkbook.Worksheets(\"Master\")\n    Set oRng1 = oWS1.Range(\"A2\")\n\n    ' Initial cell to store\n    Set oWS2 = ThisWorkbook.Worksheets(\"Summary\")\n    Set oRng2 = oWS2.Range(\"A2\")\n\n\n    ' Clear original data on Summary\n\n    oWS2.Cells.Clear\n\n    ' Look for IPs on \"Master\", then put in to \"Summary\"\n    ' If value in cell is #N/A or 0, then skip to next cell\n\n    Do Until IsEmpty(oRng1)\n        If IsError(oRng1.Offset(0, 1).Value) Then\n            For X = 10 To 2 Step -1\n                If Not IsError(oRng1.Offset(0, X).Value) Then\n                    If oRng1.Offset(0, X).Value &lt;&gt; \"\" Or oRng1.Offset(0, X).Value &lt;&gt; 0 Then\n                        oRng2.Value = oRng1.Value\n                        oRng2.Offset(0, 1).Value = oRng1.Offset(0, X).Value\n                        Set oRng2 = oRng2.Offset(1, 0)\n                        Exit For\n                    End If\n                End If\n            Next X\n            If X = 1 And oRng2.Value = \"\" Then\n                oRng2.Value = oRng1.Value\n                oRng2.Offset(0, 1).Value = \"No Data\"\n                Set oRng2 = oRng2.Offset(1, 0)\n            End If\n        Else\n            oRng2.Value = oRng1.Value\n            oRng2.Offset(0, 1).Value = oRng1.Offset(0, X).Value\n            Set oRng2 = oRng2.Offset(1, 0)\n        End If\n        Set oRng1 = oRng1.Offset(1, 0) ' Move to next row to check\n    Loop\nEnd Sub\n</code></pre>\n\n<p>This will place the value of \"No Data\" in column B in the event that all of the data in columns C:K are either errors, empty, or 0's</p>\n"}], "owner": {"reputation": 41, "user_id": 7710175, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-mNgwNtUXmcI/AAAAAAAAAAI/AAAAAAAARjA/_TQ5KEJTfyI/photo.jpg?sz=128", "display_name": "Mike S", "link": "https://stackoverflow.com/users/7710175/mike-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 903, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1499282637, "creation_date": 1499260108, "last_edit_date": 1499260235, "question_id": 44927210, "link": "https://stackoverflow.com/questions/44927210/vba-excel-2010-if-error-like-n-a-then-move-to-next-row", "title": "VBA (excel 2010) if error (like #N/A) then move to next row", "body": "<p>Experts!</p>\n\n<p>I am trying to automate a manual process and am running into (I'm sure) an easy fix. There are about 8 columns that may contain the results of an index/match formula that I need to copy into column B. For example, Column 'A' is an IP address, and column 'B' needs to have a value from one of the columns \"C\" through \"K\". The logic needs to first look in 'K' then move descending towards 'C', checking if the value is first an error (like #N/A or 0). If no error exists then copy that value into a summary sheet. I think my real obstacle is that I cannot get the logic right to check for an error. It either does nothing (which I suspect I am just exiting the loop) or it just copies everything regardless. Assistance is greatly appreciated!</p>\n\n<pre><code>Sub MakeSummary()\n    Dim oRng1 As Range, oRng2 As Range\n    Dim oWS1 As Worksheet, oWS2 As Worksheet, i As Long\n\n    ' Initial cell to check\n    Set oWS1 = ThisWorkbook.Worksheets(\"Master\")\n    Set oRng1 = oWS1.Range(\"A1\")\n\n    ' Initial cell to store\n    Set oWS2 = ThisWorkbook.Worksheets(\"Summary\")\n    Set oRng2 = oWS2.Range(\"A1\")\n\n    ' Clear original data on Summary\n    i = 0\n    Do Until IsEmpty(oRng2.Offset(i, 0))\n        oRng2.Offset(i, 0).EntireRow.ClearContents\n        i = i + 1\n    Loop\n\n    ' Look for IPs on \"Master\", then put in to \"Summary\"\n    ' If value in cell is #N/A or 0, then skip to next cell\n\n    Do Until IsEmpty(oRng1)\n                If oRng1.Value = Application.WorksheetFunction.IsNA(oRng1.Formula) Then\n                Set oRng2 = oRng2.Offset(0, 1)\n                Else\n                oRng2.Value = oRng1.Offset(0, 1).Value ' IPs\n                oRng2.Offset(0, 1).Value = oRng1.Offset(0, 2).Value ' 1st Match\n                oRng2.Offset(0, 2).Value = oRng1.Offset(0, 3).Value ' 2nd Match\n                Set oRng2 = oRng2.Offset(1, 0) ' Move to next row to store\n\n        Set oRng1 = oRng1.Offset(1, 0) ' Move to next row to check\n\n    Loop\n\n\n    ' Clean up\n    Set oRng1 = Nothing\n    Set oWS1 = Nothing\n    Set oRng2 = Nothing\n    Set oWS2 = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 196, "user_id": 3432330, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DkR82.png?s=128&g=1", "display_name": "mheim", "link": "https://stackoverflow.com/users/3432330/mheim"}, "edited": false, "score": 0, "creation_date": 1565946592, "post_id": 44927672, "comment_id": 101510446, "body": "Just to be clear, this will remove any pre-existing richt text formatting from the cell, only applying the new rich text format to the new line"}], "tags": [], "owner": {"reputation": 867, "user_id": 2770438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8219814e55b3ab73a24b7f24fdf8eb73?s=128&d=identicon&r=PG&f=1", "display_name": "jmdon", "link": "https://stackoverflow.com/users/2770438/jmdon"}, "is_accepted": true, "score": 1, "last_activity_date": 1499261350, "creation_date": 1499261350, "answer_id": 44927672, "question_id": 44927189, "link": "https://stackoverflow.com/questions/44927189/excel-vba-append-formatted-text-to-cell/44927672#44927672", "title": "Excel VBA - append formatted text to cell", "body": "<p>The following will insert \"my text\" into range A1, you can adapt it as you need.</p>\n\n<p>It works as follows:</p>\n\n<ol>\n<li>Get the current number of characters in Range A1 (lOldTextLen)</li>\n<li>Insert two line breaks and \"my text\" into Range A1</li>\n<li><p>Update the characters in Range A1 to font size 8, starting from the end of the previous text (using lOldTextLen)</p>\n\n<pre><code>Dim sText As String \nDim lOldTextLen As Long\n\nsText = \"my text\"\nlOldTextLen = Len(Range(\"a1\"))\n\nRange(\"a1\").Value = Range(\"a1\").Value &amp; vbNewLine &amp; vbNewLine &amp; sText\n\nRange(\"a1\").Characters(lOldTextLen + 1).Font.Size = 8\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 3041, "user_id": 5012854, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh5.googleusercontent.com/-3yud0cij0J8/AAAAAAAAAAI/AAAAAAAAA7c/KPT7qK4SBFc/photo.jpg?sz=128", "display_name": "davideghz", "link": "https://stackoverflow.com/users/5012854/davideghz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 477, "favorite_count": 0, "accepted_answer_id": 44927672, "answer_count": 1, "score": 0, "last_activity_date": 1499261350, "creation_date": 1499260052, "last_edit_date": 1531164843, "question_id": 44927189, "link": "https://stackoverflow.com/questions/44927189/excel-vba-append-formatted-text-to-cell", "title": "Excel VBA - append formatted text to cell", "body": "<p>I need to add a \"padding-bottom\" to a cell in VBA.</p>\n\n<p>A way to get what I need might be to append to a cell a char  with smaller font size (let's say a small dot) in a new line.</p>\n\n<p>How can I achieve this in VBA?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1499258784, "post_id": 44926671, "comment_id": 76828794, "body": "Probably......."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 4, "creation_date": 1499259220, "post_id": 44926671, "comment_id": 76829157, "body": "Humans click buttons, computers just run the script directly. Check out <a href=\"https://stackoverflow.com/questions/19536241/calling-excel-macros-from-powershell-with-arguments\">this question to run an excel macro from powershell</a>"}, {"owner": {"reputation": 113, "user_id": 7976039, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a9e4a754b32d927a48ffa51f3864f068?s=128&d=identicon&r=PG&f=1", "display_name": "Steff", "link": "https://stackoverflow.com/users/7976039/steff"}, "edited": false, "score": 0, "creation_date": 1499259736, "post_id": 44926671, "comment_id": 76829611, "body": "I i run the macro like this, a &quot;browse file box&quot; pops up and i have to select files. How do I handle this?"}], "answers": [{"tags": [], "owner": {"reputation": 130, "user_id": 7251782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1518894864803633/picture?type=large", "display_name": "Tommy Lee Jones w Sciganym", "link": "https://stackoverflow.com/users/7251782/tommy-lee-jones-w-sciganym"}, "is_accepted": false, "score": 0, "last_activity_date": 1499331753, "last_edit_date": 1499331753, "creation_date": 1499259511, "answer_id": 44926977, "question_id": 44926671, "link": "https://stackoverflow.com/questions/44926671/click-vba-button-in-excel-using-powershell/44926977#44926977", "title": "Click VBA button in excel using powershell", "body": "<p>Provide macro name hidden inside this button, as an argument of cmd command.</p>\n\n<p>Steps for you:</p>\n\n<ol>\n<li>get macro name (main sub) from VBA project.</li>\n<li>get path of excel application on your system.</li>\n<li>get path of excel file where VBA macro is stored.</li>\n</ol>\n\n<p>Try running with Powershell:</p>\n\n<pre><code>\"path_to_excel_app\" \"path_to_excel_file_with_macro\" /x macro_name\n</code></pre>\n\n<p>Here is my working exaple with MS access:</p>\n\n<pre><code>\"C:\\Program Files (x86)\\Microsoft Office\\Office15\\MSACCESS.EXE\" \"R:\\path_to_macro_file\\AccessFileWithMacro.accdb\" /x macroName\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 8285094, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p6Cyc.jpg?s=128&g=1", "display_name": "Diego Montero", "link": "https://stackoverflow.com/users/8285094/diego-montero"}, "is_accepted": true, "score": 0, "last_activity_date": 1518022759, "creation_date": 1518022759, "answer_id": 48669319, "question_id": 44926671, "link": "https://stackoverflow.com/questions/44926671/click-vba-button-in-excel-using-powershell/48669319#48669319", "title": "Click VBA button in excel using powershell", "body": "<p>You only need to run this PS </p>\n\n<pre><code># start Excel\n$excel = New-Object -comobject Excel.Application\n#open file\n$FilePath = 'FilePath'\n$workbook = $excel.Workbooks.Open($FilePath)\n##If you will like to check what is happend\n$excel.Visible = $true\n## Here you can \"click\" the button\n$app = $excel.Application\n$app.Run(\"MacroName\")\n\n       ##The macro name is the trigger of your button\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 7976039, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a9e4a754b32d927a48ffa51f3864f068?s=128&d=identicon&r=PG&f=1", "display_name": "Steff", "link": "https://stackoverflow.com/users/7976039/steff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1349, "favorite_count": 0, "accepted_answer_id": 48669319, "answer_count": 2, "score": 0, "last_activity_date": 1518022759, "creation_date": 1499258732, "last_edit_date": 1531161705, "question_id": 44926671, "link": "https://stackoverflow.com/questions/44926671/click-vba-button-in-excel-using-powershell", "title": "Click VBA button in excel using powershell", "body": "<p>I need to automate something in excel. The first step should be to run a macro that is started by clicking a VBA-Button. Is there a way I can click a VBA-Button using Powershell?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1499259082, "post_id": 44926695, "comment_id": 76829031, "body": "Thank you for the Response. End if should be  before the last line ? am i correct ?"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1499259127, "post_id": 44926695, "comment_id": 76829076, "body": "i mean, before ths line ? ws.Range(&quot;E&quot; &amp; i &amp; &quot;:F&quot; &amp; i).NumberFormat = &quot;0%&quot;"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1499259264, "post_id": 44926695, "comment_id": 76829196, "body": "If i Do like yours, then i am not able to print the values in my result sht"}, {"owner": {"reputation": 823, "user_id": 7746454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95207c62ad1aed75ade3f53fb7216308?s=128&d=identicon&r=PG&f=1", "display_name": "Busse", "link": "https://stackoverflow.com/users/7746454/busse"}, "reply_to_user": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1499259317, "post_id": 44926695, "comment_id": 76829245, "body": "I put the End If after your If statements which increase your count variables. By placing it right after those statements, the only thing that won&#39;t happen if the column is blank is it won&#39;t try to count things in those columns, then it will continue and check the next J. If you put it later in the code, it will skip past everything else and potentially error since it won&#39;t pick up the <code>next j</code>"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1499259409, "post_id": 44926695, "comment_id": 76829324, "body": "So, how do i do ? @busse"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1499259502, "post_id": 44926695, "comment_id": 76829407, "body": "By end if , before nextj , it is not printing the values in sht2."}], "tags": [], "owner": {"reputation": 823, "user_id": 7746454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95207c62ad1aed75ade3f53fb7216308?s=128&d=identicon&r=PG&f=1", "display_name": "Busse", "link": "https://stackoverflow.com/users/7746454/busse"}, "is_accepted": false, "score": 0, "last_activity_date": 1499258776, "creation_date": 1499258776, "answer_id": 44926695, "question_id": 44926609, "link": "https://stackoverflow.com/questions/44926609/check-for-empty-cel-and-then-count-the-value-in-the-column-and-paste-it-to-anoth/44926695#44926695", "title": "check for empty cel and then count the value in the column and paste it to another sheet", "body": "<p>The <code>GoTo nextrow</code> is looking for a line label titled <code>nextrow</code>.  That's how the GoTo command is built and operates.  For what you are trying to accomplish, try this instead:</p>\n\n<pre><code>If ws.Range(\"AA\" &amp; i) &lt;&gt; \"\" Then \n    If ws.Range(\"A\" &amp; i) = Range(\"AX\" &amp; j) And Range(\"T\" &amp; j) = 1 Then cntT = cntT + 1\n    If ws.Range(\"A\" &amp; i) = Range(\"AX\" &amp; j) And Range(\"U\" &amp; j) = 1 Then cntu = cntu + 1\nEnd If\n</code></pre>\n\n<p>This way it says, if the column is <em>NOT</em> blank, then <code>do stuff</code>, otherwise go to <code>next j</code></p>\n\n<p>If you want to use the GoTo Command in the future you can use line numbers (like <code>GoTo 0</code> which should take you back to the beginning of the code) or you can create a line label by placing <code>nextrow:</code> on an empty line.  Then when you call <code>GoTo nextrow</code> it will go to that line, and proceed from there.</p>\n"}], "owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499258776, "creation_date": 1499258572, "question_id": 44926609, "link": "https://stackoverflow.com/questions/44926609/check-for-empty-cel-and-then-count-the-value-in-the-column-and-paste-it-to-anoth", "title": "check for empty cel and then count the value in the column and paste it to another sheet", "body": "<p>I am having two sht, sht1 as BW and sht2 as result. </p>\n\n<p>I want to Count the number of 1's in column T and U of sht1, according to the week in column AX and print the Counted values in the result sheet, looking into the same week. </p>\n\n<p>I took the advice of an expert in the Forum and completed till this. </p>\n\n<p>I want an if condition, in such a way that, if the column AA is empty, then i should not Count the 1's in column T and U, it should be skipped. </p>\n\n<p>I introduced this code of line in my existing code after j=2;  and got an error</p>\n\n<blockquote>\n  <p>error Label not defined`,</p>\n</blockquote>\n\n<pre><code> If ws.Range(\"AA\" &amp; i) = \"\" Then \nGoTo nextrow \n</code></pre>\n\n<p>could someone help, how i should execute this condition ?\nhere is my code; </p>\n\n<pre><code>Sub results()\n\nDim i As Integer, j As Integer, cntT As Integer, cntu As Integer, ws As Worksheet\nSet ws = Sheets(\"Result\")\nSheets(\"BW\").Select\nFor i = 2 To WorksheetFunction.CountA(ws.Columns(1))\ncntT = 0\ncntu = 0\nIf ws.Range(\"A\" &amp; i) = Val(Format(Now, \"ww\")) Then Exit For\nNext i\n\nFor j = 2 To WorksheetFunction.CountA(Columns(50))\n\nIf ws.Range(\"A\" &amp; i) = Range(\"AX\" &amp; j) And Range(\"T\" &amp; j) = 1 Then cntT = cntT + 1\nIf ws.Range(\"A\" &amp; i) = Range(\"AX\" &amp; j) And Range(\"U\" &amp; j) = 1 Then cntu = cntu + 1\n\nNext j\nIf cntT &lt;&gt; 0 Then ws.Range(\"B\" &amp; i) = cntT\nIf cntu &lt;&gt; 0 Then ws.Range(\"C\" &amp; i) = cntu\nIf cntT + cntu &lt;&gt; 0 Then\nws.Range(\"D\" &amp; i) = cntT + cntu\nws.Range(\"E\" &amp; i) = cntT / (cntT + cntu)\nws.Range(\"F\" &amp; i) = cntu / (cntT + cntu)\nEnd If\nws.Range(\"E\" &amp; i &amp; \":F\" &amp; i).NumberFormat = \"0%\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 1, "creation_date": 1499259189, "post_id": 44926523, "comment_id": 76829132, "body": "Don&#39;t wrap the parameter in brackets.  have a look here: <a href=\"https://stackoverflow.com/questions/5413765/what-are-the-rules-governing-usage-of-brackets-in-vba-function-calls\" title=\"what are the rules governing usage of brackets in vba function calls\">stackoverflow.com/questions/5413765/&hellip;</a>"}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "reply_to_user": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1499259980, "post_id": 44926523, "comment_id": 76829787, "body": "@sous2817, Ok. But it doesn&#39;t seem to explain why in the first case it workes fine (see edit)."}], "answers": [{"comments": [{"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 1, "creation_date": 1499259091, "post_id": 44926795, "comment_id": 76829040, "body": "Excuse me, did you change anything?"}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1499259291, "post_id": 44926795, "comment_id": 76829220, "body": "Thank you, that worked. However it-s just a simplified example of a bigger program, I would really rather use function, why isn&#39;t this possible here and if there some other way arounf it?"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "reply_to_user": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1499261272, "post_id": 44926795, "comment_id": 76830724, "body": "@Ans: you can use function."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 1, "creation_date": 1499261405, "post_id": 44926795, "comment_id": 76830834, "body": "@Ans A <code>Function</code> should return something, a <code>Sub</code> should be a procedure with no return value. <i>Theoretically</i> there&#39;s nothing stopping you from using them interchangeably - but it&#39;s bad practice and confusing to do so in VBA"}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1499259027, "creation_date": 1499259027, "answer_id": 44926795, "question_id": 44926523, "link": "https://stackoverflow.com/questions/44926523/excel-vba-runtime-error-424-object-required-when-assigning-range-variable/44926795#44926795", "title": "Excel vba runtime error 424 Object required when assigning Range variable", "body": "<p>Your code woubl to be lik this.</p>\n\n<pre><code>Sub testFunc(aCol As Range)\n    Dim i As Integer\n    i = 0\n    For Each cell In aCol\n        cell.Value = i\n        i = i + 1\n    Next\nEnd Sub\n\n\nSub testSub()\n    Dim aRange As Range\n    Set aRange = ThisWorkbook.Sheets(\"Sheet1\").Range(\"A1:A16\")\n\n    testFunc aRange    '&lt;---- error\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1510592805, "last_edit_date": 1510592805, "creation_date": 1510592294, "answer_id": 47269636, "question_id": 44926523, "link": "https://stackoverflow.com/questions/44926523/excel-vba-runtime-error-424-object-required-when-assigning-range-variable/47269636#47269636", "title": "Excel vba runtime error 424 Object required when assigning Range variable", "body": "<p>Parentheses around an expression are causing the expression to be evaluated <strong>as a value</strong> and passed <code>ByVal</code> to the procedure invoked.</p>\n\n<blockquote>\n<pre><code>testFunc (ThisWorkbook.Sheets(\"Sheet2\").Range(\"A1:A16\"))   '&lt;--- this works fine\n</code></pre>\n</blockquote>\n\n<p>No, it doesn't work fine, not with <code>aCol As Range</code> in the signature of <code>testFunc</code> - for the exact same reason as the line underneath it. A <code>Range</code> object has a <em>default member</em> that points to its <code>.Value</code>. When you do this:</p>\n\n<pre><code>DoSomething (SomeRange)\n</code></pre>\n\n<p>What's really happening is this:</p>\n\n<pre><code>DoSomething (SomeRange.Value)\n</code></pre>\n\n<p>The parentheses are telling VBA to <em>evaluate the expression as a value</em>, <strong>before</strong> passing the result <strong>by value</strong> (<code>ByVal</code>) of that expression to the procedure being invoked, <em>regardless</em> of the implicit <code>ByRef</code> modifier in the procedure's signature.</p>\n\n<p>Problem is, given a 16-cell <code>Range</code>, <code>Range.Value</code> is a 2D array - and given a single-cell <code>Range</code>, <code>Range.Value</code> is a <code>Variant</code> that contains that cell's value, <em>and that can't possibly be coerced into a <code>Range</code> object instance</em>, so it's impossible that the code you have here \"works fine\": it's an <em>object required</em> error, because the procedure is expecting a <code>Range</code> and you're giving it a <code>Variant</code> that contains a 2D array.</p>\n\n<hr>\n\n<h3>Why your \"works fine\" code isn't really working</h3>\n\n<p>The only way <code>testFunc (ThisWorkbook.Sheets(\"Sheet2\").Range(\"A1:A16\"))</code> could possibly work, is if <code>testFunc</code> had this signature (which, I suspect it did at one point before you ultimately asked this question):</p>\n\n<pre><code>Function testFunc(aCol)\n</code></pre>\n\n<p>Or the explicit equivalent:</p>\n\n<pre><code>Public Function testFunc(ByRef aCol As Variant) As Variant\n</code></pre>\n\n<p>And because a 2D array <em>can</em> be iterated with a <code>For Each</code> loop (<a href=\"http://analystcave.com/vba-for-loop-vs-for-each-loop/\" rel=\"nofollow noreferrer\">albeit very inefficiently</a>), and it's possible that the entire <code>A1:A16</code> range contains values that <em>can</em> be coerced into valid <code>Integer</code> values, \"works fine\" indeed... except you're <strong>updating an in-memory copy of the data, not the cells themselves</strong> - so it wasn't quite \"works fine\", was more like \"doesn't crash\".</p>\n\n<p>Here's a MCVE:</p>\n\n<pre><code>Private Function DoSomething(ByRef foo As Range)\nEnd Function\n\nPublic Sub Test()\n    DoSomething (Range(\"A1\").Value)\nEnd Sub\n</code></pre>\n\n<p>Calling <code>Test</code> throws run-time error 424 \"Object Required\".</p>\n\n<pre><code>Public Function DoSomething(ByRef foo As Range)\nEnd Function\n\nPublic Sub Test()\n    DoSomething (Range(\"A1:A100\").Value)\nEnd Sub\n</code></pre>\n\n<p>Calling <code>Test</code> throws the same run-time error 424 \"Object Required\".</p>\n\n<p>Now remove the <code>As Range</code> declaration:</p>\n\n<pre><code>Public Function DoSomething(ByRef foo As Variant)\n    Debug.Print TypeName(foo)\nEnd Function\n\nPublic Sub Test()\n    DoSomething (Range(\"A1:A100\").Value)\nEnd Sub\n</code></pre>\n\n<p>Invoking <code>Test</code> prints <code>Variant()</code> to the <em>immediate pane</em> (Ctrl+G). Now make the range contain just one single cell:</p>\n\n<pre><code>Public Function DoSomething(ByRef foo As Variant)\n    Debug.Print TypeName(foo)\nEnd Function\n\nPublic Sub Test()\n    DoSomething (Range(\"A1\").Value)\nEnd Sub\n</code></pre>\n\n<p>Invoking <code>Test</code> prints whatever data type the value of cell A1 holds. If it's text, it prints <code>String</code>. If it's a number, it prints <code>Double</code>. If it's a date, it prints <code>Date</code>. If it's a cell error (e.g. <code>#NA</code>, <code>#VALUE!</code>, etc.), it prints <code>Error</code>.</p>\n\n<p>Note that the results are identical for all of the above, whether you specify <code>.Value</code> explicitly or not, because omitting <code>.Value</code> boils down to implicitly specifying it.</p>\n\n<p>Also note that passing an array <code>ByVal</code> is illegal. What's being passed to the function here is a <strong>copy</strong> of <em>a pointer to the beginning of the array</em> - the <code>Variant</code> array isn't storing the array itself, just a pointer to its actual location: that's why &amp; how you can legally pass a variant array by value.</p>\n\n<hr>\n\n<h3>Why the variable is blowing up too</h3>\n\n<p>The 2nd line is throwing the same error, for the same reason:</p>\n\n<blockquote>\n<pre><code>testFunc (aRange)    '&lt;---- error\n</code></pre>\n</blockquote>\n\n<p>You're implicitly doing this:</p>\n\n<pre><code>testFunc aRange.Value\n</code></pre>\n\n<p>Because that's what the parentheses do: they tell VBA to <em>evaluate the expression as a value, and pass it as such</em>.</p>\n\n<p>So you're passing a 2D variant array to a procedure that's expecting a <code>Range</code>.</p>\n\n<p>This is different, and correct:</p>\n\n<pre><code>testFunc aRange\n</code></pre>\n\n<p>Note the lack of parentheses: now you're passing the <code>Range</code> object reference to a procedure that accepts a <code>Range</code> object reference, <code>ByRef</code> (although that modifier is implicit and a more semantically correct way to do it would be to pass the object reference <code>ByVal</code>).</p>\n\n<hr>\n\n<h3>So how do I tell when the arguments are being evaluated as a value?</h3>\n\n<p>When you invoke a <code>Function</code> procedure, you're normally interested in its <em>return value</em>:</p>\n\n<pre><code>result = MsgBox(\"Confirm?\", vbYesNo)\n</code></pre>\n\n<p>The VBA automatically positions the opening parenthesis immediately after the function's identifier - no whitespace.</p>\n\n<p>When you invoke a <code>Function</code> procedure without capturing its return value, you must omit the parentheses:</p>\n\n<pre><code>MsgBox \"Confirm?\", vbYesNo\n</code></pre>\n\n<p>Note that this would be a compile error:</p>\n\n<pre><code>MsgBox (\"Confirm?\", vbYesNo)\n</code></pre>\n\n<p>Because the expression <code>(\"Confirm?\", vbYesNo)</code> cannot be evaluated as a value and passed as such to the first parameter of the procedure.</p>\n\n<p>That's easy though - <code>MsgBox</code> has multiple parameters. People get confused when there's only one parameter - because then this <em>looks</em> legal:</p>\n\n<pre><code>testFunc (aRange)\n</code></pre>\n\n<p><strong>Notice the whitespace: it shouldn't be there</strong>. That's the VBE telling you <em>\"these parentheses are NOT part of the function call, they're part of the argument you're going pass to that function, and if whatever is in these parentheses can't be evaluated as a value at run-time, expect trouble\"</em>.</p>\n\n<hr>\n\n<p>If your <code>testFunc</code> procedure isn't <em>returning a value</em>, then it shouldn't be a <code>Function</code> in the first place - it should be a <code>Sub</code> procedure. Functions take input and return a value, Subs <em>do something</em>, which usually entails side-effects, e.g. actual cell values being modified.</p>\n"}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4574, "favorite_count": 0, "accepted_answer_id": 47269636, "answer_count": 2, "score": 0, "last_activity_date": 1510592805, "creation_date": 1499258307, "last_edit_date": 1499259556, "question_id": 44926523, "link": "https://stackoverflow.com/questions/44926523/excel-vba-runtime-error-424-object-required-when-assigning-range-variable", "title": "Excel vba runtime error 424 Object required when assigning Range variable", "body": "<p>I have this code that consists of a function and subroutine that uses that function. Function takes a column as an argument and alters each of that column cell's content. </p>\n\n<pre><code>Function testFunc(aCol As Range)\n    Dim i As Integer\n    i = 0\n    For Each cell In aCol\n        cell.Value = i\n        i = i + 1\n    Next\nEnd Function\n\n\nSub testSub()\n    Dim aRange As Range\n    Set aRange = ThisWorkbook.Sheets(\"Sheet1\").Range(\"A1:A16\")\n\n    testFunc (ThisWorkbook.Sheets(\"Sheet2\").Range(\"A1:A16\"))   '&lt;--- this works fine\n    testFunc (aRange)    '&lt;---- error\nEnd Sub\n</code></pre>\n\n<p>The <code>Runtime error '424' Object required\"| arises on line</code>testFunc (aRange)`. I'm not sure what's wrong, I assign variable through 'Set' and it's supposed to work fine.</p>\n\n<p>Also, I tried passing the range directly to the function, without storing it in the variable first and it workes perfectly. <strong>Why</strong>?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 8218639, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b8766fe708ad55ba2d3c131116a40e58?s=128&d=identicon&r=PG&f=1", "display_name": "Antti", "link": "https://stackoverflow.com/users/8218639/antti"}, "edited": false, "score": 0, "creation_date": 1499258947, "post_id": 44926559, "comment_id": 76828916, "body": "Hi, this solved my challenge, but then there appeared a new one. Do you have any ideas how to hide rows from 50 at the end of the document. In my excel user creates and deletes rows which make hidden rows visible. The reason for question is that excel start to complain memory amount."}], "tags": [], "owner": {"reputation": 823, "user_id": 7746454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95207c62ad1aed75ade3f53fb7216308?s=128&d=identicon&r=PG&f=1", "display_name": "Busse", "link": "https://stackoverflow.com/users/7746454/busse"}, "is_accepted": true, "score": 1, "last_activity_date": 1499258431, "creation_date": 1499258431, "answer_id": 44926559, "question_id": 44926441, "link": "https://stackoverflow.com/questions/44926441/type-mismatch-trying-to-hide-rows-using-vba/44926559#44926559", "title": "&quot;type mismatch&quot; trying to hide rows using vba", "body": "<p>I see one issue right off the bat.  When you are doing your <code>ActiveSheet.Rows(\"startRow:endRow\").EntireRow.Hidden = True</code> you are not calling those variables, you are stating them as strings.</p>\n\n<p>Try this instead:</p>\n\n<p><code>ActiveSheet.Rows(startrow &amp; \":\" &amp; endrow).EntireRow.Hidden = True</code></p>\n\n<p>This way, you are properly calling the variables, and the only \"string\" is the : (colon).</p>\n\n<p>Also, next time you ask please make sure you explain if you are receiving an error, or just not achieving the results you desire.  I am guessing you are getting a <em>type mismatch</em> error with this, but I cannot be sure.  This helps everyone better assist you.</p>\n"}, {"tags": [], "owner": {"reputation": 95, "user_id": 8218639, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b8766fe708ad55ba2d3c131116a40e58?s=128&d=identicon&r=PG&f=1", "display_name": "Antti", "link": "https://stackoverflow.com/users/8218639/antti"}, "is_accepted": false, "score": 0, "last_activity_date": 1499274428, "creation_date": 1499274428, "answer_id": 44932178, "question_id": 44926441, "link": "https://stackoverflow.com/questions/44926441/type-mismatch-trying-to-hide-rows-using-vba/44932178#44932178", "title": "&quot;type mismatch&quot; trying to hide rows using vba", "body": "<p>This code solved my challenge, but is there cleaner way to define last row of the excel, like this way?</p>\n\n<blockquote>\n  <p>endRow = 1048576</p>\n</blockquote>\n\n<pre><code>Public Function keepAdditionalRowsHidden()\n\n        Dim startRow As Long\n        Dim endRow As Long\n\n        startRow = ER.row + 1\n\n        endRow = 1048576 ' last row of the excel\n\n        ActiveSheet.Rows(startRow &amp; \":\" &amp; endRow).EntireRow.Hidden = True\nEnd Functioncode here\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 8218639, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b8766fe708ad55ba2d3c131116a40e58?s=128&d=identicon&r=PG&f=1", "display_name": "Antti", "link": "https://stackoverflow.com/users/8218639/antti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 44926559, "answer_count": 2, "score": 0, "last_activity_date": 1499274428, "creation_date": 1499258096, "last_edit_date": 1499273686, "question_id": 44926441, "link": "https://stackoverflow.com/questions/44926441/type-mismatch-trying-to-hide-rows-using-vba", "title": "&quot;type mismatch&quot; trying to hide rows using vba", "body": "<p>What I want to do is hide rows so my interface is lighter but I get the following error message when I i compile my code:</p>\n\n<blockquote>\n  <p>Type mismatch (Error 13)</p>\n</blockquote>\n\n<pre><code>Public Function keepAdditionalRowsHidden()\n\nDim startRow As Long\nDim lastrow As Long\n\nDim startRowString As String\nDim endRowString As String\n\nstartRow = 40\nlastrow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).row\n\nstartRowString = CStr(startRow)\nendRowString = CStr(lastrow)\n\nActiveSheet.Rows(\"startRow:endRow\").EntireRow.Hidden = True\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499256239, "post_id": 44925508, "comment_id": 76826737, "body": "Note that your current <code>SaveAs</code> is just saving the file as a tab-delimited text file, but with a file extension of <code>.csv</code>, which will confuse people who expect that it is a comma-separated values file."}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1499256298, "post_id": 44925641, "comment_id": 76826792, "body": "The existing <code>SaveAs</code> is already saving it as tab-delimited (because that was how it was opened), so you might have to expand the answer to tell the OP how to save as a csv file."}, {"owner": {"reputation": 823, "user_id": 7746454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95207c62ad1aed75ade3f53fb7216308?s=128&d=identicon&r=PG&f=1", "display_name": "Busse", "link": "https://stackoverflow.com/users/7746454/busse"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499256731, "post_id": 44925641, "comment_id": 76827148, "body": "Good catch, didn&#39;t notice it was opening that way.  Updated my answer."}, {"owner": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "edited": false, "score": 0, "creation_date": 1499260149, "post_id": 44925641, "comment_id": 76829899, "body": "@Busse Thank you so much for you wonderful and detailed answer. Not only has it worked like a charm but you have given me some extra learning which is really useful."}, {"owner": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "edited": false, "score": 0, "creation_date": 1499260710, "post_id": 44925641, "comment_id": 76830320, "body": "I have one final question surrounding this routine if you can help? After running this, I am left with the original CSV file open that was created from the original text file, is there a way to overwrite the filename of the original text document to include !DNU! so once the macro is executed, users will know not to select it again? Does that make sense?"}, {"owner": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "edited": false, "score": 0, "creation_date": 1499260768, "post_id": 44925641, "comment_id": 76830360, "body": "Also is there a simple line of code which will close any other workbooks still open except the workbook where the macro lives?"}, {"owner": {"reputation": 823, "user_id": 7746454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95207c62ad1aed75ade3f53fb7216308?s=128&d=identicon&r=PG&f=1", "display_name": "Busse", "link": "https://stackoverflow.com/users/7746454/busse"}, "edited": false, "score": 1, "creation_date": 1499262316, "post_id": 44925641, "comment_id": 76831553, "body": "Glad it helped.  Please mark it as the correct answer :)  As for your other question(s), once you open the file you can just <code>ActiveWorkbook.SaveAs</code> at the beginning and change the FileName to whatever you want, then when you do your Saves later in the code they will rename the file to what you would like.  Best thing to do would be to store the activeworkbook as a variable (<code>Dim wb as Workbook, wb = Activeworkbook</code> and then after you&#39;re done saving, do <code>wb.Close SaveChanges:=False</code>)"}, {"owner": {"reputation": 823, "user_id": 7746454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95207c62ad1aed75ade3f53fb7216308?s=128&d=identicon&r=PG&f=1", "display_name": "Busse", "link": "https://stackoverflow.com/users/7746454/busse"}, "edited": false, "score": 1, "creation_date": 1499262535, "post_id": 44925641, "comment_id": 76831699, "body": "For your second question, you can do something like <code>For Each Book in Workbooks</code> and then <code>If Book.Name &lt;&gt; &quot;Insert Workbook Name or Variable Here&quot; Then</code> <code>Book.Close SaveChanges:=False</code> <code>End If</code> <code>Next</code>  Each of those should go on separate lines, comments don&#39;t allow me to format very well."}, {"owner": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "edited": false, "score": 0, "creation_date": 1499263085, "post_id": 44925641, "comment_id": 76832132, "body": "@Busse Your closing of the workbooks comment makes perfect sense and has done the trick. Overwriting the original file name seems more tricky, the SaveAs function allows me to create another copy with what ever I choose but does not overwrite the original file name. Each time this macro is used, the file being selected at the start will have a different name, I need to be able to keep that name, add !DNU! and save and close. Is that even possible?"}, {"owner": {"reputation": 823, "user_id": 7746454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95207c62ad1aed75ade3f53fb7216308?s=128&d=identicon&r=PG&f=1", "display_name": "Busse", "link": "https://stackoverflow.com/users/7746454/busse"}, "edited": false, "score": 0, "creation_date": 1499264124, "post_id": 44925641, "comment_id": 76832917, "body": "You already do that actually. Your variable, sheetname, is the current workbooks name.  Just do: <code>ActiveWorkbook.SaveAs (&quot;FILE LOCATION HERE&quot; &amp; sheetname &amp; &quot;!DNU!.txt&#47;csv&#47;whateverfileextensionyouwant&quot;)</code>"}, {"owner": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "edited": false, "score": 0, "creation_date": 1499265774, "post_id": 44925641, "comment_id": 76834277, "body": "@Busse Thank you for that, I am not sure if I am putting that line of code in the right place though as it doesn&#39;t seem to do anything at all! I have put it after the first active file save as. &#39;Save active file as...     ActiveWorkbook.SaveAs (&quot;S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment Limited\\BACS File Original\\&quot; &amp; _     fileName &amp; &quot;.CSV&quot;), FileFormat:=xlCSV &#39;Rename the original text file     ActiveWorkbook.SaveAs (&quot;S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment Limited&quot; &amp; sheetName &amp; &quot;!DNU!&quot; &amp; &quot;.txt&quot;)"}, {"owner": {"reputation": 823, "user_id": 7746454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95207c62ad1aed75ade3f53fb7216308?s=128&d=identicon&r=PG&f=1", "display_name": "Busse", "link": "https://stackoverflow.com/users/7746454/busse"}, "edited": false, "score": 0, "creation_date": 1499266014, "post_id": 44925641, "comment_id": 76834483, "body": "Put it before the first save as. You said you just want to rename the original, Right?"}, {"owner": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "edited": false, "score": 0, "creation_date": 1499266398, "post_id": 44925641, "comment_id": 76834841, "body": "@Busse I am sorry to say it doesn&#39;t do anything even if I move it to where you suggested. I just need to get the filename overwritten successfully and you will have helped me gain some serious brownie points!"}, {"owner": {"reputation": 823, "user_id": 7746454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95207c62ad1aed75ade3f53fb7216308?s=128&d=identicon&r=PG&f=1", "display_name": "Busse", "link": "https://stackoverflow.com/users/7746454/busse"}, "edited": false, "score": 0, "creation_date": 1499267004, "post_id": 44925641, "comment_id": 76835362, "body": "Can you post this as a separate question and I&#39;ll post a solution there. We&#39;re getting away from the initial question and I&#39;d rather they be separate."}], "tags": [], "owner": {"reputation": 823, "user_id": 7746454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95207c62ad1aed75ade3f53fb7216308?s=128&d=identicon&r=PG&f=1", "display_name": "Busse", "link": "https://stackoverflow.com/users/7746454/busse"}, "is_accepted": true, "score": 3, "last_activity_date": 1499257123, "last_edit_date": 1499257123, "creation_date": 1499255968, "answer_id": 44925641, "question_id": 44925508, "link": "https://stackoverflow.com/questions/44925508/save-as-csv-and-txt/44925641#44925641", "title": "Save as .CSV and .txt", "body": "<p>After you save it as a <code>.csv</code> file, just re-do the same code but instead of <code>.csv</code> change it to <code>.txt</code></p>\n\n<p>But that won't necessarily change the type of file.  After your <code>Activeworkbook.SaveAs</code> command, add <code>FileFormat:= xlTextWindows</code>. This will actually save it as a textfile.</p>\n\n<p>It should look like: </p>\n\n<p><code>ActiveWorkbook.SaveAs (\"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment \n  Limited\\\" &amp; MySaveFile), FileFormat:= xlTextWindows</code></p>\n\n<p>I would recommend also looking up the multiple different types of \"FileFormats\" when it comes to saving workbooks, just to familiarize yourself with them.  Just search Excel FileFormats, and you should be able to find information about all of them.</p>\n\n<p>Update:</p>\n\n<p>As mentioned in the comments, your CSV file you are saving may not be actually saving as comma delimited.  To do so, similarly to what I said above, you can change the fileformat of your initial save to <code>xlCSV</code>. This can be achieved by adding <code>FileFormat:= xlcsv</code> to the end of your first <code>ActiveWorkbook.SaveAs</code></p>\n\n<p>FileFormats are required when you are actually interested in changing the filetype and not just the extension.  Here is the link to the MSDN site explaining all the different formats. <a href=\"https://msdn.microsoft.com/VBA/Excel-VBA/articles/xlfileformat-enumeration-excel\" rel=\"nofollow noreferrer\">MSDN XLFileFormats</a>.  Instead of using the text <code>xlCSV</code> or <code>xlTextWindows</code> you can also use the numeric values assigned to those formats.  Instead of <code>FileFormat:= xlCSV</code> you can do <code>FileFormat:= 6</code> or for <code>xlTextWindows</code> you can do <code>FileFormat:= 20</code></p>\n"}], "owner": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1009, "favorite_count": 0, "accepted_answer_id": 44925641, "answer_count": 1, "score": 2, "last_activity_date": 1499257123, "creation_date": 1499255612, "question_id": 44925508, "link": "https://stackoverflow.com/questions/44925508/save-as-csv-and-txt", "title": "Save as .CSV and .txt", "body": "<p>I am sure this is straightforward but is baffling me beyond belief. I have written the below code. You can see in to places that I am saving My pay final and Non-mypay Final as CSV files. Is there a way I can get the files to save as txt files as well. Ideally with the same location if possible? As always, your help is greatly appreciated.</p>\n\n<pre><code> Option Explicit\n\n Sub BACSConversion()\n\n Dim MyNewBook As String\n Dim MySaveFile As String\n Dim fileToOpen As Variant\n Dim fileName As String\n Dim sheetName As String\n Dim rCopy As Range\n\n 'Turn off display alerts\n Application.DisplayAlerts = False\n 'Turn off screen updates\n Application.ScreenUpdating = False\n\n 'Ensures that the file open directory is always the same\n  ChDir \"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment Limited\\\"\n\n 'Opens the folder to location to select txt file\n  fileToOpen = Application.GetOpenFilename(\"Text Files (*.txt), *.txt\")\n    If fileToOpen &lt;&gt; False Then\n    Workbooks.OpenText fileName:=fileToOpen, _\n    DataType:=xlDelimited, Tab:=True\n    End If\n 'Creates the file name based on txt file name\n  fileName = Mid(fileToOpen, InStrRev(fileToOpen, \"\\\") + 1)\n 'Creates the sheet name based on the active txt file\n  sheetName = Left(ActiveWorkbook.Name, Len(ActiveWorkbook.Name) - 4)\n\n 'Save active file as...\n  ActiveWorkbook.SaveAs (\"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment \n  Limited\\BACS File Original\\\" &amp; _\n  fileName &amp; \".CSV\")\n\n 'Selects all data in column A and copies to clipboard\n  Set rCopy = Range(\"A1\", Range(\"A1\").End(xlDown))\n\n 'Open the original document where the BACS file is located\n   Workbooks.Open \"S:\\Accounts (New)\\Management Information \n (Analysis)\\Phil Hanmore - Analysis\\bacs conversation calc.xlsx\"\n 'Selects the worksheet called \"Original\"\n  Sheets(\"Original\").Range(\"A:A\").ClearContents\n\n 'Paste selected values from previous sheet\n  rCopy.Copy\n  Sheets(\"Original\").Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n\n 'Selects appropriate worksheet - Non-MyPayFINAL\n   Sheets(\"Non-MyPay FINAL\").Select\n\n  'Selects all data in column A and copies to clipboard\n   Range(\"A1\", Range(\"A1\").End(xlDown)).Select\n  Selection.Copy\n\n  'Add a new workbook\n   Workbooks.Add\n 'Paste selected values from previous sheet\n  Selection.PasteSpecial Paste:=xlPasteValues\n\n 'Build SaveAs file name\n  MySaveFile = Format(Now(), \"DDMMYYYY\") &amp; \"NonMyPayFINAL\" &amp; \".CSV\"\n 'Save template file as...\n  ActiveWorkbook.SaveAs (\"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment \n  Limited\\\" &amp; MySaveFile)\n 'Close the new saved file\n   ActiveWorkbook.Close\n\n 'Selects appropriate worksheet - MyPayFINAL\n   Sheets(\"MyPay FINAL\").Select\n\n 'Selects all data in column A and copies to clipboard\n Range(\"A1\", Range(\"A1\").End(xlDown)).Select\n Selection.Copy\n\n 'Add a new workbook\n  Workbooks.Add\n 'Paste selected values from previous sheet\n Selection.PasteSpecial Paste:=xlPasteValues\n\n 'Build SaveAs file name\n  MySaveFile = Format(Now(), \"DDMMYYYY\") &amp; \"MyPayFINAL\" &amp; \".CSV\"\n 'Save template file as...\n  ActiveWorkbook.SaveAs (\"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment \n  Limited\\\" &amp; MySaveFile)\n  'Close the new saved file\n   ActiveWorkbook.Close\n 'Close original source workbook (template)\n  Workbooks(\"bacs conversation calc\").Close\n\n 'Turn on display alerts\nApplication.DisplayAlerts = True\n 'Turn on screen updates\nApplication.ScreenUpdating = True\n\n End Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1499258812, "post_id": 44925418, "comment_id": 76828813, "body": "Am I correct in assuming you want the following result: <code>Client | Prospect | Region</code>, where Region is either Highveld, Eastern, Northern or Africa?"}, {"owner": {"reputation": 53, "user_id": 5244559, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2m_ddNGSdgk/AAAAAAAAAAI/AAAAAAAAB2o/tjyrEJ4rlL4/photo.jpg?sz=128", "display_name": "4shg85", "link": "https://stackoverflow.com/users/5244559/4shg85"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1499264196, "post_id": 44925418, "comment_id": 76832996, "body": "Hi! No, what i need to see is just which one of these 8 fields had data in it. So in otherwords, I need a field to update, for instance, Client, with the data that is in either Client_Highveld or Client_Africa or Client_Eastern or Client_Norther etc"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1499266174, "post_id": 44925418, "comment_id": 76834619, "body": "Please edit (see link below tags) your post and illustrate your point with example data as your explanation is not too clear."}, {"owner": {"reputation": 53, "user_id": 5244559, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2m_ddNGSdgk/AAAAAAAAAAI/AAAAAAAAB2o/tjyrEJ4rlL4/photo.jpg?sz=128", "display_name": "4shg85", "link": "https://stackoverflow.com/users/5244559/4shg85"}, "edited": false, "score": 0, "creation_date": 1499267607, "post_id": 44925418, "comment_id": 76835814, "body": "Thank you, i have done that"}], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1499259309, "creation_date": 1499259309, "answer_id": 44926902, "question_id": 44925418, "link": "https://stackoverflow.com/questions/44925418/return-a-non-empty-string-from-range-of-cells-in-access-2016/44926902#44926902", "title": "Return a non empty string from range of cells in Access 2016", "body": "<p>You can solve this problem without touching VBA, using only the power of SQL. Try the following query:</p>\n\n<pre><code>  SELECT Highveld_Client AS Client, Highveld_Prospect AS Prospect, \"Highveld\" As Region\n  From MyTable\n  WHERE Highveld_Client IS NOT NULL OR Highveld_Prospect IS NOT NULL\nUNION ALL\n  SELECT Eastern_Client AS Client, Eastern_Prospect AS Prospect, \"Eastern\" As Region\n  From MyTable\n  WHERE Eastern_Client IS NOT NULL OR Eastern_Prospect IS NOT NULL\nUNION ALL\n  SELECT Northern_Client AS Client, Northern_Prospect AS Prospect, \"Northern\" As Region\n  From MyTable\n  WHERE Northern_Client IS NOT NULL OR Northern_Prospect IS NOT NULL\nUNION ALL\n  SELECT Africa_Client AS Client, Africa_Prospect AS Prospect, \"Africa\" As Region\n  From MyTable\n  WHERE Africa_Client IS NOT NULL OR Africa_Prospect IS NOT NULL\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5244559, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2m_ddNGSdgk/AAAAAAAAAAI/AAAAAAAAB2o/tjyrEJ4rlL4/photo.jpg?sz=128", "display_name": "4shg85", "link": "https://stackoverflow.com/users/5244559/4shg85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499267578, "creation_date": 1499255398, "last_edit_date": 1499267578, "question_id": 44925418, "link": "https://stackoverflow.com/questions/44925418/return-a-non-empty-string-from-range-of-cells-in-access-2016", "title": "Return a non empty string from range of cells in Access 2016", "body": "<p>So I have inherited an Access 2016 DB that needs some tweaking, and I need help as I am familiar with Access, but I am not the best (not by far, or at all) :) </p>\n\n<p>The db is setup as follows: \nData is linked to 4 SQL Server Databases that imports two tables from each db, one being Clients and One Being Prospective Clients (this is for lookup purposes as the client wants to do nothing manually). In the only table that is updated in Access, there are 8 columns, one being the Client and One being the Prospective Client from each SQL Database. Looking like this: </p>\n\n<p>Highveld_Client | Highveld_Prospect | Eastern_Client | Eastern_Prospect | Northern_Client | Northern_Prospect | Africa_Client | Africa_Prospect</p>\n\n<p>Each of these is a drop down box and looks up the right data. But this makes for a very tedious report (as you can well imagine). What I am thinking is to have a field update automatically based on which one of these fields is not empty. </p>\n\n<p>What I need is, exactly, the following: </p>\n\n<p><strong>Of the 8 fields shown above, only 1 will ever bill filled.\nI need to automatically update a new field with the data from whichever one of these fields is filled.</strong>  </p>\n\n<p>For the love of me, I cannot seem to find a place that will guide me properly on how to do this. I have spent days scouring tutorials and forums, and nada. I know that if i need this done, it will more than likely be a VBA Code, but then it's not going to happen, knowing me, I will end up deploying a nuclear missile or something disastrous. </p>\n\n<p>Thank you in advance, you'll never know how much all your help on these forums helps, or is appreciated. </p>\n"}, {"tags": ["excel", "vba", "syntax-error", "non-ascii-characters", "excel-2016"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1499253897, "post_id": 44924847, "comment_id": 76825088, "body": "Try changing the <code>On Error Resume Next</code> to <code>On Error GoTo 0</code> and see which line it errors on. Also check your data types of <code>Condition</code> are you sure it&#39;s passing a <code>String</code>/<code>Integer</code> and not an <code>Object</code>/<code>Array</code>?"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1499254022, "post_id": 44924847, "comment_id": 76825180, "body": "You are having two <code>For i = 1 to CriteriaRange.Count</code>&#39;s I suggest removing the last."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 3, "creation_date": 1499254220, "post_id": 44924847, "comment_id": 76825335, "body": "If you use the version of the code from the site you took it from, you will find that your bugs will disappear."}, {"owner": {"reputation": 741, "user_id": 1280840, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/aX6eR.jpg?s=128&g=1", "display_name": "DJDave", "link": "https://stackoverflow.com/users/1280840/djdave"}, "edited": false, "score": 0, "creation_date": 1499256976, "post_id": 44924847, "comment_id": 76827333, "body": "Pardon me, but they do not. I think you mean it worked for you when you tried it. I believe I have just found the problem - the space characters are not seen as regular spaces in my environment (which is not unusual - Excel 2016 on a regular Dell laptop). When I delete the indentation spaces and replace them using space bar, my syntax problems disappear. When I turn on Hidden Characters when viewing the text in Word, the indentation spaces appear as circles, not dots."}], "answers": [{"comments": [{"owner": {"reputation": 741, "user_id": 1280840, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/aX6eR.jpg?s=128&g=1", "display_name": "DJDave", "link": "https://stackoverflow.com/users/1280840/djdave"}, "edited": false, "score": 0, "creation_date": 1499259999, "post_id": 44924967, "comment_id": 76829796, "body": "Sorry for the red herrings - I don&#39;t know how I failed to copy the code properly, clearly the changes you suggested were needed in what I posted but were not the problem I was stuck on (as neither was there in my VBA version). As I said in response to YowE3K, I have now identified the problem as being the indentation space characters. There is no &quot;test case&quot; as such - I just pasted the code from the website into VBA and the lines I stated were highlighted in red"}, {"owner": {"reputation": 741, "user_id": 1280840, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/aX6eR.jpg?s=128&g=1", "display_name": "DJDave", "link": "https://stackoverflow.com/users/1280840/djdave"}, "edited": false, "score": 0, "creation_date": 1499260045, "post_id": 44924967, "comment_id": 76829827, "body": "If I fix the question (i.e. implement your suggestions) your answer won&#39;t make much sense anymore - what should I do? I think the eventual solution might be of use to someone, I can&#39;t believe my environment is unique (it&#39;s pretty vanilla in fact) and an error you CAN&#39;T SEE is pretty hard to figure (at least for my sparrow brain)"}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "reply_to_user": {"reputation": 741, "user_id": 1280840, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/aX6eR.jpg?s=128&g=1", "display_name": "DJDave", "link": "https://stackoverflow.com/users/1280840/djdave"}, "edited": false, "score": 0, "creation_date": 1499263017, "post_id": 44924967, "comment_id": 76832068, "body": "@DJDave Good find!  Please don&#39;t add the working version to the question, for exactly your reasoning.  Instead, post what worked for you as an additional <i>answer</i>, and then accept it a week from now when the system will let you.  In the meantime, I added a workaround based on your discovery for the benefit of future readers."}, {"owner": {"reputation": 741, "user_id": 1280840, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/aX6eR.jpg?s=128&g=1", "display_name": "DJDave", "link": "https://stackoverflow.com/users/1280840/djdave"}, "edited": false, "score": 0, "creation_date": 1499264260, "post_id": 44924967, "comment_id": 76833064, "body": "More than happy to accept your answer - thanks for your patience."}], "tags": [], "owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "is_accepted": true, "score": 1, "last_activity_date": 1499262904, "last_edit_date": 1499262904, "creation_date": 1499254026, "answer_id": 44924967, "question_id": 44924847, "link": "https://stackoverflow.com/questions/44924847/unexpected-syntax-error-when-copying-excel-vba-code-from-a-web-site/44924967#44924967", "title": "Unexpected syntax error when copying Excel VBA code from a Web site", "body": "<h2>Edit 2</h2>\n\n<p>As the OP discovered, copying and pasting from the Web site gives a bunch of non-breaking spaces:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Lyyfy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Lyyfy.png\" alt=\"enter image description here\"></a></p>\n\n<p>On my test case (Excel 2013, Win7), those paste in fine, and Excel doesn't barf.  However, the OP's installation (Excel 2016) can't handle them.</p>\n\n<p>To change those:</p>\n\n<ul>\n<li>Paste the code into Word.  </li>\n<li>Do a Find/Replace to change <code>^s</code> (nonbreaking spaces, <code>ChrW(160)</code>) to a single space (<code></code>).  </li>\n<li>Copy from Word to Excel.</li>\n</ul>\n\n<h2>Original</h2>\n\n<p>All I had to do to get it to compile was:</p>\n\n<ul>\n<li>Comment out the second <code>For i=...</code> line</li>\n<li>Change <code>Exit Function</code> on the last line to <code>End Function</code>.</li>\n</ul>\n\n<p>Haven't tested it, though.  Would you please edit your question to add the test case you are trying?</p>\n\n<p><strong>Edit</strong> @YowE3K beat me to it &mdash; there are some copy-and-paste errors in the code in your question.  Recopy from the site and you should be OK!</p>\n"}, {"tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": false, "score": 0, "last_activity_date": 1499254026, "creation_date": 1499254026, "answer_id": 44924968, "question_id": 44924847, "link": "https://stackoverflow.com/questions/44924847/unexpected-syntax-error-when-copying-excel-vba-code-from-a-web-site/44924968#44924968", "title": "Unexpected syntax error when copying Excel VBA code from a Web site", "body": "<p>Testing on Excel 2010 there are 2 errors to solve:</p>\n\n<ol>\n<li><p>You have <code>For i = 1 To CriteriaRange.Count</code> twice - you need to delete the second one. This seems it must be a typing error or something</p></li>\n<li><p>The function should end with <code>End Function</code></p></li>\n</ol>\n\n<p>Working code with corrections:</p>\n\n<pre><code>Function ConcatenateIf(CriteriaRange As Range, Condition As Variant, ConcatenateRange As Range, Optional Separator As String = \",\") As Variant\n\n    Dim xResult As String\n\n    On Error Resume Next\n\n    If CriteriaRange.Count &lt;&gt; ConcatenateRange.Count Then\n        ConcatenateIf = CVErr(xlErrRef)\n        Exit Function\n    End If\n\n    For i = 1 To CriteriaRange.Count\n        If CriteriaRange.Cells(i).Value = Condition Then\n            xResult = xResult &amp; Separator &amp; ConcatenateRange.Cells(i).Value\n        End If\n    Next i\n\n    If xResult &lt;&gt; \"\" Then\n        xResult = VBA.Mid(xResult, VBA.Len(Separator) + 1)\n    End If\n\n    ConcatenateIf = xResult\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 741, "user_id": 1280840, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/aX6eR.jpg?s=128&g=1", "display_name": "DJDave", "link": "https://stackoverflow.com/users/1280840/djdave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 742, "favorite_count": 0, "accepted_answer_id": 44924967, "answer_count": 2, "score": 0, "last_activity_date": 1499263178, "creation_date": 1499253692, "last_edit_date": 1499263178, "question_id": 44924847, "link": "https://stackoverflow.com/questions/44924847/unexpected-syntax-error-when-copying-excel-vba-code-from-a-web-site", "title": "Unexpected syntax error when copying Excel VBA code from a Web site", "body": "<p>I was looking for a function to conditionally concatenate a range of cells in Excel. This function</p>\n\n<pre><code>Function ConcatenateIf(CriteriaRange As Range, Condition As Variant, ConcatenateRange As Range, Optional Separator As String = \",\") As Variant\n\nDim xResult As String\nOn Error Resume Next\nIf CriteriaRange.Count &lt;&gt; ConcatenateRange.Count Then\n\u00a0\u00a0\u00a0\u00a0ConcatenateIf = CVErr(xlErrRef)\n\u00a0\u00a0\u00a0\u00a0Exit Function\nEnd If\nFor i = 1 To CriteriaRange.Count\n\u00a0\u00a0\u00a0\u00a0If CriteriaRange.Cells(i).Value = Condition Then\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0xResult = xResult &amp; Separator &amp; ConcatenateRange.cells(i).Value\n\u00a0\u00a0\u00a0\u00a0End If\nFor i = 1 To CriteriaRange.Count\nNext i\nIf xResult &lt;&gt; \"\" Then\n\u00a0\u00a0\u00a0\u00a0xResult = VBA.Mid(xResult, VBA.Len(Separator) + 1)\nEnd If\nConcatenateIf = xResult\nExit Function\n</code></pre>\n\n<p>from <a href=\"https://www.extendoffice.com/documents/excel/2723-excel-concatenate-based-on-criteria.html\" rel=\"nofollow noreferrer\">https://www.extendoffice.com/documents/excel/2723-excel-concatenate-based-on-criteria.html</a> looked just the ticket. Comments suggested it had worked for other coders.</p>\n\n<p>However, when I paste it into a VBA module in Excel2016, there are syntax errors which I can't figure out. \"Exit Function\" on line 7 can be resolved by deleting \"Function\". The call of \"Exit Function\" at the end doesn't register as an error but can removed as superfluous. But</p>\n\n<pre><code>If CriteriaRange.Cells(i).Value = Condition Then\n</code></pre>\n\n<p>is highlighted as a syntax error (and the matching \"End If\"). If I simply use \"If true Then\", the error doesn't go away, which suggests looking at the previous line </p>\n\n<pre><code>For i = 1 To CriteriaRange.Count\n</code></pre>\n\n<p>and I tried \"For i = 1 To 8\" but that doesn't fix it either. I just can't see what it wrong?</p>\n\n<p>Further to the helpful responses, here is a screenshot of a direct paste into VBA</p>\n\n<p><a href=\"https://i.stack.imgur.com/yifUk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yifUk.png\" alt=\"shows red syntax error highlights in original code from site\"></a></p>\n\n<p>and here is a screenshot of the \"dodgy\" space characters as seen in Word</p>\n\n<p><a href=\"https://i.stack.imgur.com/o107J.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/o107J.png\" alt=\"shows spaces-as-circles with Hidden Chars on in Word\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3249, "user_id": 7147233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/94f37773a80589840319d063ee51ab16?s=128&d=identicon&r=PG&f=1", "display_name": "WhatsThePoint", "link": "https://stackoverflow.com/users/7147233/whatsthepoint"}, "edited": false, "score": 0, "creation_date": 1499252197, "post_id": 44924127, "comment_id": 76823959, "body": "it depends do you always want it after the <code>E</code> or in place number 6?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1499252479, "post_id": 44924127, "comment_id": 76824154, "body": "^^ or before the <code>F</code>? or in the middle?  or 3 characters after a <code>C</code>?  or ....?  (Oops - I just noticed that there are <b>two</b> spaces in the &quot;output&quot; string - so that means all my theories are wrong.)"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1499253770, "post_id": 44924127, "comment_id": 76825004, "body": "Do you need a VBA solution or a formula?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8258572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d5a2504e8200759dad9790f6fcd5f78?s=128&d=identicon&r=PG&f=1", "display_name": "Huwatski", "link": "https://stackoverflow.com/users/8258572/huwatski"}, "edited": false, "score": 0, "creation_date": 1499257309, "post_id": 44924971, "comment_id": 76827587, "body": "Hi Rik thanks for the answer. What i need is the vba solution."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 1, "user_id": 8258572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d5a2504e8200759dad9790f6fcd5f78?s=128&d=identicon&r=PG&f=1", "display_name": "Huwatski", "link": "https://stackoverflow.com/users/8258572/huwatski"}, "edited": false, "score": 0, "creation_date": 1499257587, "post_id": 44924971, "comment_id": 76827814, "body": "See Edit. It&#39;s the exact same in VBA as with regular formula&#39;s."}], "tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": false, "score": 0, "last_activity_date": 1499257569, "last_edit_date": 1499257569, "creation_date": 1499254040, "answer_id": 44924971, "question_id": 44924127, "link": "https://stackoverflow.com/questions/44924127/how-to-add-space-in-a-string-in-excel-vba/44924971#44924971", "title": "How to add space in a string in excel vba?", "body": "<p>One formula to insert a space:\n<code>=LEFT(A1,5)&amp;\" \"&amp;RIGHT(A1,LEN(A1)-5)</code> to insert a space after the 5th position. (<code>ABCDE FGHIJK</code>)</p>\n\n<p>One to insert 2 spaces as per example:\n<code>=LEFT(A1,5)&amp;\" \"&amp;MID(A1,6,2)&amp;\" \"&amp;RIGHT(A1,LEN(A1)-7)</code>\nInput <code>ABCDEFGHIJK</code>, result <code>ABCDE FG HIJK</code></p>\n\n<p>In short: Use <code>=LEFT()</code>, <code>=RIGHT()</code> and <code>=MID()</code> to get parts of your string and concatenate the parts and your spaces.</p>\n\n<p><strong>Edit:</strong>\nIn VBA:</p>\n\n<pre><code>Public Function StringWithSpaces(inpStr As String) As String\n    StringWithSpaces = Left(inpStr, 5) &amp; \" \" &amp; Mid(inpStr, 6, 2) &amp; \" \" &amp; Right(inpStr, Len(inpStr) - 7)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8258572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d5a2504e8200759dad9790f6fcd5f78?s=128&d=identicon&r=PG&f=1", "display_name": "Huwatski", "link": "https://stackoverflow.com/users/8258572/huwatski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 7678, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1499257569, "creation_date": 1499251684, "last_edit_date": 1531164843, "question_id": 44924127, "link": "https://stackoverflow.com/questions/44924127/how-to-add-space-in-a-string-in-excel-vba", "title": "How to add space in a string in excel vba?", "body": "<p>how can i add space in this example string? </p>\n\n<p>Input value in cell A1 is <code>ABCDEFGHIJK</code> and will be paste in another cell B1 with a format of <code>ABCDE FG HIJK</code>.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1, "user_id": 8258595, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213126023122389/picture?type=large", "display_name": "Jeew", "link": "https://stackoverflow.com/users/8258595/jeew"}, "edited": false, "score": 0, "creation_date": 1499251398, "post_id": 44923989, "comment_id": 76823384, "body": "image can be found on &#39;enter image description here&#39; <a href=\"https://i.stack.imgur.com/zEus5.jpg\" rel=\"nofollow noreferrer\">i.stack.imgur.com/zEus5.jpg</a>"}], "answers": [{"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 0, "last_activity_date": 1499252293, "creation_date": 1499252293, "answer_id": 44924365, "question_id": 44923989, "link": "https://stackoverflow.com/questions/44923989/macro-or-loop-to-conditional-formatting/44924365#44924365", "title": "Macro or Loop to conditional formatting", "body": "<p>Follow these steps...</p>\n\n<ol>\n<li>Select the range C2:F2 and press Ctrl+C to copy it.</li>\n<li>Now select the range C3:F792.</li>\n<li>Right click on any of the selected cells --> Choose Paste Special --> Select the radio button for Formats and click on OK.</li>\n</ol>\n\n<p>If you want to do this programmatically, you may try something like this...</p>\n\n<pre><code>Sub CopyConditionalFormatting()\nDim rng As Range\nSet rng = Range(\"C3:F792\")\nRange(\"C2:F2\").Copy\nrng.PasteSpecial xlPasteFormats\nApplication.CutCopyMode = 0\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8258595, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213126023122389/picture?type=large", "display_name": "Jeew", "link": "https://stackoverflow.com/users/8258595/jeew"}, "edited": false, "score": 0, "creation_date": 1499397858, "post_id": 44925177, "comment_id": 76899305, "body": "Thanks for the reply. but this is not really what I was expecting. To be more clear on this I will explain it little more. From C2:F2 the icon is based on the value of C2. When D3:F3 the icon is based on the value of D3. similarly for others too. In the method you explained, the icon is always based on the value C2.Thanks"}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1499254679, "creation_date": 1499254679, "answer_id": 44925177, "question_id": 44923989, "link": "https://stackoverflow.com/questions/44923989/macro-or-loop-to-conditional-formatting/44925177#44925177", "title": "Macro or Loop to conditional formatting", "body": "<p>Or you might even try Conditional Formatting:</p>\n\n<p>[<img src=\"https://i.stack.imgur.com/dULnD.jpg\" alt=\"SO4492989 example[1]\"></p>\n"}], "owner": {"reputation": 1, "user_id": 8258595, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213126023122389/picture?type=large", "display_name": "Jeew", "link": "https://stackoverflow.com/users/8258595/jeew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 279, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1499254679, "creation_date": 1499251329, "last_edit_date": 1499251984, "question_id": 44923989, "link": "https://stackoverflow.com/questions/44923989/macro-or-loop-to-conditional-formatting", "title": "Macro or Loop to conditional formatting", "body": "<p><a href=\"https://i.stack.imgur.com/zEus5.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zEus5.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I need to repeat shown the conditional formatting to all the rows. There are lot of rows. The conditional icon is based on the first value of the cell and others shows according to it. How to achieve all this in one go.\nMy data ranging from C2:F792.</p>\n"}, {"tags": ["vba", "event-handling"], "comments": [{"owner": {"reputation": 867, "user_id": 2770438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8219814e55b3ab73a24b7f24fdf8eb73?s=128&d=identicon&r=PG&f=1", "display_name": "jmdon", "link": "https://stackoverflow.com/users/2770438/jmdon"}, "edited": false, "score": 0, "creation_date": 1499261569, "post_id": 44923960, "comment_id": 76830965, "body": "Thanks for the upvote, please mark the answer as complete if it solved your problem."}], "answers": [{"tags": [], "owner": {"reputation": 867, "user_id": 2770438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8219814e55b3ab73a24b7f24fdf8eb73?s=128&d=identicon&r=PG&f=1", "display_name": "jmdon", "link": "https://stackoverflow.com/users/2770438/jmdon"}, "is_accepted": false, "score": 2, "last_activity_date": 1499253106, "last_edit_date": 1499253106, "creation_date": 1499252055, "answer_id": 44924267, "question_id": 44923960, "link": "https://stackoverflow.com/questions/44923960/enable-event-handler/44924267#44924267", "title": "Enable event handler?", "body": "<p>To add an event handler for selection change on Sheet 1, ensure you are in the module for the correct sheet and use the below code:</p>\n\n<p><a href=\"https://i.stack.imgur.com/sCUQ2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sCUQ2.png\" alt=\"Ensure the correct sheet is selected\"></a></p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\nEnd Sub\n</code></pre>\n\n<p>To add an event handler for the entire workbook to get a selection change in any sheet, ensure you are in the ThisWorkbook module and use the below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/SAnyd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SAnyd.png\" alt=\"Thisworkbook\"></a></p>\n\n<pre><code>Private Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 3238187, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/fccc039c84166be8ca97df14e5d8d762?s=128&d=identicon&r=PG&f=1", "display_name": "user3238187", "link": "https://stackoverflow.com/users/3238187/user3238187"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499253106, "creation_date": 1499251232, "question_id": 44923960, "link": "https://stackoverflow.com/questions/44923960/enable-event-handler", "title": "Enable event handler?", "body": "<p>Fellow sufferers</p>\n\n<p>I wish to use event handling when someone selects a cell. I made an eventhandler function which starts like:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n</code></pre>\n\n<p>The eventhandler does not get called when i change cell. Do I need to enable event handling or what am I doing wrong?</p>\n\n<p>BW Peter Bunde Hansen</p>\n"}, {"tags": ["excel", "vba", "error-handling", "textbox", "userform"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1499251975, "post_id": 44923941, "comment_id": 76823793, "body": "have you tried <code>IF</code> and <code>+</code> handling the <code>.hide</code>?"}, {"owner": {"reputation": 2222, "user_id": 1498401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41de959f8403da285e0a23aabe603c6?s=128&d=identicon&r=PG", "display_name": "tinamou", "link": "https://stackoverflow.com/users/1498401/tinamou"}, "edited": false, "score": 0, "creation_date": 1499252012, "post_id": 44923941, "comment_id": 76823823, "body": "did you tried: <code>If (textbox1 + textbox2 + textbox3) = 1 Then</code>?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499253596, "post_id": 44923941, "comment_id": 76824874, "body": "If the values have to be <b>between 0.0 and 1.0</b> you may want to rethink placing the values into Integer variables, which will make anything less than 0.50000 equal 0 and anything between 0.50000 and 1.49999 equal to 1. So 0.4 + 0.35 + 0.25 will be equivalent to 0 + 0 + 0 which won&#39;t sum to 1. (Perhaps use Double, or Currency if you don&#39;t allow more than 4 decimal digits.)"}, {"owner": {"reputation": 3, "user_id": 8258554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aab1d2a63100ee21fd89b29756b43d42?s=128&d=identicon&r=PG&f=1", "display_name": "A.Desai", "link": "https://stackoverflow.com/users/8258554/a-desai"}, "edited": false, "score": 0, "creation_date": 1499258958, "post_id": 44923941, "comment_id": 76828926, "body": "Thank you. I changed it to Currency and used the if statement and it worked!"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8258554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aab1d2a63100ee21fd89b29756b43d42?s=128&d=identicon&r=PG&f=1", "display_name": "A.Desai", "link": "https://stackoverflow.com/users/8258554/a-desai"}, "edited": false, "score": 0, "creation_date": 1499331822, "post_id": 44925889, "comment_id": 76864097, "body": "Thank you so much for going through that to help me out. Your code is indeed much cleaner and more logical. Your explanation also helped ALOT - I am quite new to VBA. Thank you!!!  Only problem I have when I replace my code with yours: It only adds the sum of the second decimal place - not the whole number. I&#39;m attaching a photo so show you what I mean. <a href=\"https://i.stack.imgur.com/SE6rL.jpg\" rel=\"nofollow noreferrer\">link</a>  I&#39;m not sure how to fix this."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 3, "user_id": 8258554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aab1d2a63100ee21fd89b29756b43d42?s=128&d=identicon&r=PG&f=1", "display_name": "A.Desai", "link": "https://stackoverflow.com/users/8258554/a-desai"}, "edited": false, "score": 0, "creation_date": 1499340182, "post_id": 44925889, "comment_id": 76869952, "body": "@A.Desai Try the updated code (I just changed the declaration type of Inputs from <code>Double</code> to <code>Variant</code>). I hadn&#39;t realized that the default value of a <code>Double</code> array is 0 (in a <code>Variant</code> array it is <code>Empty</code>) and because of this, the invalid input check was satisfied by the 0, despite the input of 1.5 being invalid. You should now properly be alerted if you enter a number over 1."}, {"owner": {"reputation": 3, "user_id": 8258554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aab1d2a63100ee21fd89b29756b43d42?s=128&d=identicon&r=PG&f=1", "display_name": "A.Desai", "link": "https://stackoverflow.com/users/8258554/a-desai"}, "edited": false, "score": 0, "creation_date": 1501061366, "post_id": 44925889, "comment_id": 77607474, "body": "Sorry about the delayed response. I tried the new code and it now works perfectly!! Thank you so much for all your help"}], "tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": true, "score": 0, "last_activity_date": 1499340069, "last_edit_date": 1499340069, "creation_date": 1499256593, "answer_id": 44925889, "question_id": 44923941, "link": "https://stackoverflow.com/questions/44923941/vba-how-can-i-give-an-error-code-based-on-the-sum-of-my-textbox-values-ina-use/44925889#44925889", "title": "VBA - How can I give an error code based on the sum of my textbox values ina user form?", "body": "<p>I took some liberties in answering your questions because I saw opportunities to improve your code versus just getting you to the answer. The code below should be easier to read/manage and I hope it will help you in writing better code in the future below. Code first, and then I will explain the process:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim Inputs(1 To 3) As Variant\n    Dim Total As Double\n\n    ' It is better to anticipate errors (check the values that could cause an error) than it is to\n    ' use a GoTo block that catches everything.\n    ' On Error GoTo errHandler\n\n    Inputs(1) = GetInputFromTextbox(UserForm1.textbox1)\n    Inputs(2) = GetInputFromTextbox(UserForm1.textbox2)\n    Inputs(3) = GetInputFromTextbox(UserForm1.textbox3)\n\n    ' Handle the errors all in the same block (simply for readability)\n    If IsEmpty(Inputs(1)) Then\n        InvalidInput \"Textbox1\"\n        UserForm1.Hide\n    ElseIf IsEmpty(Inputs(2)) Then\n        InvalidInput \"Textbox2\"\n        UserForm1.Hide\n    ElseIf IsEmpty(Inputs(3)) Then\n        InvalidInput \"Textbox3\"\n        UserForm1.Hide\n    Else\n        ' This will only execute if the three previous inputs are valid\n        Total = Application.WorksheetFunction.Sum(Inputs)\n        If Total &lt;&gt; 1 Then\n            TotalInputsInvalid Total\n        End If\n    End If\n\nEnd Sub\n\n' Define the function as a variant so it can return a null value\n' This is important since the user could enter a 0 value and the default return of\n' the function, if defined as a numeric type, would be 0. This would, in turn, prevent error handling.\nPrivate Function GetInputFromTextbox(ByVal InputMember As Object) As Variant\n    If IsNumeric(InputMember.Value) Then\n        If CDbl(InputMember.Value) &lt; 1 Then\n            GetInputFromTextbox = Round(CDbl(InputMember.Value), 2)\n        End If\n    End If\n\n    ' Notice that, if the conditions for a valid input are not met, nothing happens.\n    ' This allows us to handle errors within the calling routine.\nEnd Function\n\n\n\n' This will alert the user if the input given is invalid.\nPrivate Sub InvalidInput(ByVal MemberName As String)\n    MsgBox \"There is an invalid input in \" &amp; MemberName &amp; \". Please enter value between 0.0 and 1.0.\"\nEnd Sub\n\n\nPrivate Sub TotalInputsInvalid(ByVal TotalValue As Double)\n    MsgBox \"The total value of all inputs must equal 1. The current total is \" &amp; Round(TotalValue, 2) &amp; \". Please adjust the inputs accordingly.\"\nEnd Sub\n</code></pre>\n\n<p>First of all, I have defined one variable for the input values. The main benefit to this is that your code is cleaner and makes more sense. Having variables such as Foo1, Foo2, Foo3, etc. makes your code a little bit messier. An array can make this process easier, especially if this application has to scale to accomodate more textboxes.</p>\n\n<p>Also notice that, per YowE3k's suggestion, I have declared the array as an array of <code>double</code>s, and likewise with <code>Total</code>. <code>Double</code>s allow floating point precision whereas <code>Long</code>s and <code>Integer</code>s only allow whole numbers (sidenote on this, never use <code>Integer</code>. Get in the habit of only using Longs for anything you would use an Int for).</p>\n\n<p>Next, I have defined a function that gets the clean input from the textbox. This is a good habit to get into. Keep in mind that a copy-paste now inevitably means additional debugging/fixing time later. There are rare cases where is it somewhat unavoidable for the current circumstances, but more often than not a Function or Sub will do wonders.</p>\n\n<p>In the case of the function I have defined, it first checks for a numeric input (avoiding the Type Mismatch error) and then checks to ensure the value is not greater than 1. If both of these conditions succeed then it returns the value (rounded to the second decimal place), else it returns nothing.</p>\n\n<p>I use this function to get all three values, and then I test the validity of all three values in the same If/ElseIf block. This will ensure all three values are valid before performing the final check.</p>\n\n<p>In the final check, it ensures that the total is equal to 1, and if it is then nothing happens. If it isn't, it alerts the user that the inputs are invalid.</p>\n\n<p>The process here is to use functions to return values, and then to use logic to handle errors. This is far more effective than GoTo blocks, and it makes debugging code much easier (at least in my experience).</p>\n\n<p>If you have any questions, please ask. Best of luck!</p>\n\n<p><strong>EDIT:</strong> Changed declaration of Inputs from Double to Variant. The Double type automatically sets the base values to 0 versus allowing <code>Empty</code>. This in turn prevents checking invalid values vs. zeroes. The Variant type fixes this.</p>\n"}], "owner": {"reputation": 3, "user_id": 8258554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aab1d2a63100ee21fd89b29756b43d42?s=128&d=identicon&r=PG&f=1", "display_name": "A.Desai", "link": "https://stackoverflow.com/users/8258554/a-desai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "accepted_answer_id": 44925889, "answer_count": 1, "score": 0, "last_activity_date": 1499340069, "creation_date": 1499251177, "question_id": 44923941, "link": "https://stackoverflow.com/questions/44923941/vba-how-can-i-give-an-error-code-based-on-the-sum-of-my-textbox-values-ina-use", "title": "VBA - How can I give an error code based on the sum of my textbox values ina user form?", "body": "<p>So I currently have a userform with 3 input boxes and a save button.\nThe three inputs have to be between 0.0 and 1.0, which is what I have done using the code below.</p>\n\n<p>I now need the sum of those 3 inputs to equal 1. If the sum of those inputs is not equal to 1 I want to display an error message upon the click of the save button.</p>\n\n<p>Really stuck on this and have tried a couple of different methods which havent worked.</p>\n\n<p>Is there any way to do this?</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim textbox1 As Integer\nDim textbox2 As Integer\nDim textbox3 As Integer\n\nOn Error GoTo errHandler\ntextbox1 = CInt(UserForm1.textbox1.Value)\nIf textbox1 &gt; 1 Then\n    MsgBox \"Invalid Input, Please enter value between 0.0 and 1.0\"\nElse\n    UserForm1.Hide\nEnd If\n\nOn Error GoTo errHandler\ntextbox2 = CInt(UserForm1.textbox2.Value)\nIf textbox2 &gt; 1 Then\n    MsgBox \"Invalid Input, Please enter value between 0.0 and 1.0\"\nElse\n    UserForm1.Hide\nEnd If\nExit Sub\n\nOn Error GoTo errHandler\ntextbox3 = CInt(UserForm1.textbox3.Value)\nIf textbox3 &gt; 1 Then\n    MsgBox \"Invalid Input, Please enter value between 0.0 and 1.0\"\nElse\n    UserForm1.Hide\nEnd If\nExit Sub\nerrHandler:\nMsgBox Err.Description\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 2, "last_activity_date": 1499250520, "creation_date": 1499250520, "answer_id": 44923668, "question_id": 44923585, "link": "https://stackoverflow.com/questions/44923585/random-variable-not-being-updated-in-vba-excel/44923668#44923668", "title": "Random Variable not being updated in VBA Excel", "body": "<p>You are currently only calculating <code>LWeekDay</code> once, and then using that value for every cell.</p>\n\n<p>I assume you want to assign a new value every time through the loop:</p>\n\n<pre><code>Randomize\nFor Y = 3 To 10\n   For X = 2 To 8\n       LWeekDay = Int((400 - 150 + 1) * Rnd + 200)\n       LWeekEnd = Int((600 - 200 + 1) * Rnd + 200)\n       Cells(Y, X) = LWeekDay\n   Next X\nNext Y\n</code></pre>\n"}], "owner": {"reputation": 247, "user_id": 5813258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/25d663db6208911cf87130549426b695?s=128&d=identicon&r=PG&f=1", "display_name": "M.Ustun", "link": "https://stackoverflow.com/users/5813258/m-ustun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499250520, "creation_date": 1499250291, "question_id": 44923585, "link": "https://stackoverflow.com/questions/44923585/random-variable-not-being-updated-in-vba-excel", "title": "Random Variable not being updated in VBA Excel", "body": "<p>While running this code to randomize some values I find that the all the cells have the same number. I believe I'm missing a standard concept but I can't seem to wrap my head around the issue.</p>\n\n<pre><code>Randomize\nLWeekDay = Int((400 - 150 + 1) * Rnd + 200)\nLWeekEnd = Int((600 - 200 + 1) * Rnd + 200)\n\n\nFor Y = 3 To 10\n\n   For X = 2 To 8\n       Cells(Y, X) = LWeekDay\n   Next X\nNext Y\n</code></pre>\n"}, {"tags": ["vba", "outlook", "outlook-2010", "outlook-2013", "outlook-2016"], "comments": [{"owner": {"reputation": 77, "user_id": 7932154, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9f069878c0f3061a4e21eadc1f7bb139?s=128&d=identicon&r=PG", "display_name": "Rachael", "link": "https://stackoverflow.com/users/7932154/rachael"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499251135, "post_id": 44923509, "comment_id": 76823194, "body": "Hey, yes unfortunately I have tried it - it is the addon for an app i use called Nitro (it&#39;s a PDF converter)."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499251648, "post_id": 44923509, "comment_id": 76823580, "body": "(a) The reference to &quot;current mode&quot; might indicate some sort of &quot;safe mode&quot;, or &quot;compatibility mode&quot; - does anything show in the title bar?  (b) Is it only rules which run macros that cause problems?  E.g. can you create (and run) a rule to simply move a message to another folder?"}, {"owner": {"reputation": 77, "user_id": 7932154, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9f069878c0f3061a4e21eadc1f7bb139?s=128&d=identicon&r=PG", "display_name": "Rachael", "link": "https://stackoverflow.com/users/7932154/rachael"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499252994, "post_id": 44923509, "comment_id": 76824512, "body": "Hi, yes - it seems to be that I can create as many rules as i want - it is just running scripts that I am unable to do. There is no indication that I am running outlook any differently than I had done before. It is not in safe mode - and when i change the compatibility it does not open."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499253483, "post_id": 44923509, "comment_id": 76824799, "body": "That certainly makes me think that macros have been disabled.  Check the Trust Settings (File / Options / Trust Center / Trust Center Settings / Macro Settings) and see whether it is set to &quot;Disable all macros without notification&quot; or something."}, {"owner": {"reputation": 77, "user_id": 7932154, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9f069878c0f3061a4e21eadc1f7bb139?s=128&d=identicon&r=PG", "display_name": "Rachael", "link": "https://stackoverflow.com/users/7932154/rachael"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499257821, "post_id": 44923509, "comment_id": 76827996, "body": "Hi - I have updated my main post with trust centre settings. I think it looks like it should? Can you think of anything else? Thank you for all your help so far!"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1499283212, "post_id": 44923509, "comment_id": 76845122, "body": "Delete all your Error&#39;ed rules-"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499283758, "post_id": 44923509, "comment_id": 76845411, "body": "^^ or at least see whether you can run a completely new rule using a new macro, and whether you can run a new rule using an old macro."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1499304323, "post_id": 44923509, "comment_id": 76853015, "body": "i just posted a short code for you to try"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1499304378, "post_id": 44923509, "comment_id": 76853027, "body": "one thing has crossed my mind ... were you working on some code when you had the crash? /// i wonder if it is possible that there is some code running when email arrives, and that code is cancelling the &quot;new mail&quot; event in the system (intercepting the event)"}, {"owner": {"reputation": 77, "user_id": 7932154, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9f069878c0f3061a4e21eadc1f7bb139?s=128&d=identicon&r=PG", "display_name": "Rachael", "link": "https://stackoverflow.com/users/7932154/rachael"}, "edited": false, "score": 0, "creation_date": 1499324610, "post_id": 44923509, "comment_id": 76859521, "body": "YowE3K - I am unable to create or edit rules with macros in them. However I will try again once I delete my current errored macros."}, {"owner": {"reputation": 77, "user_id": 7932154, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9f069878c0f3061a4e21eadc1f7bb139?s=128&d=identicon&r=PG", "display_name": "Rachael", "link": "https://stackoverflow.com/users/7932154/rachael"}, "edited": false, "score": 0, "creation_date": 1499324625, "post_id": 44923509, "comment_id": 76859529, "body": "jsotola - I will have a go, thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1499304276, "creation_date": 1499304276, "answer_id": 44938368, "question_id": 44923509, "link": "https://stackoverflow.com/questions/44923509/outlook-2013-run-a-script-rule-has-disappeared/44938368#44938368", "title": "Outlook 2013 &#39;Run a script&#39; rule has disappeared", "body": "<p>here is a quick and dirty test to check whether vba code runs at all when email arrives</p>\n\n<p>put it into \"ThisOutLookSession\" which is under  \"Microsoft Office Outlook Objects\"</p>\n\n<p>then send yourself an email ... if vba runs then you should see a popup</p>\n\n<p>it will not solve your problem, but it will provide more info to help narrow down the cause</p>\n\n<pre><code>Private Sub Application_NewMailEx(ByVal EntryIDCollection As String)\n    MsgBox \"you have mail\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 256, "user_id": 4478549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWBio.jpg?s=128&g=1", "display_name": "Mike Dubs", "link": "https://stackoverflow.com/users/4478549/mike-dubs"}, "is_accepted": false, "score": 3, "last_activity_date": 1501789953, "creation_date": 1501789953, "answer_id": 45493415, "question_id": 44923509, "link": "https://stackoverflow.com/questions/44923509/outlook-2013-run-a-script-rule-has-disappeared/45493415#45493415", "title": "Outlook 2013 &#39;Run a script&#39; rule has disappeared", "body": "<p>I encountered this issue after a Windows Update. Here's what fixed it for me:</p>\n\n<p>Save everything below the === line as a .reg file and then double-click it to run and launch (or manually add it your registry via regedit). You should probably backup your registry first to be safe and please note that this was the correct location for my Office 2013 installation (yours may be different).\nOffice 2013 = 15.0\nOffice 2016 = 16.0 </p>\n\n<p>Save using Notepad as a .reg file to double-click and upload to your system's registry (Office 2013). I hope this helps someone else! -Mike</p>\n\n<p>===</p>\n\n<p>Windows Registry Editor Version 5.00</p>\n\n<p>[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\15.0\\Outlook\\Security]\n\"EnableUnsafeClientMailRules\"=dword:00000001</p>\n"}, {"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1518576504, "creation_date": 1518576504, "answer_id": 48778903, "question_id": 44923509, "link": "https://stackoverflow.com/questions/44923509/outlook-2013-run-a-script-rule-has-disappeared/48778903#48778903", "title": "Outlook 2013 &#39;Run a script&#39; rule has disappeared", "body": "<p>Or you can create <strong><em><code>.reg file</code></em></strong> Open Notepad and save-as <strong><em><code>.reg</code></em></strong></p>\n\n<p><em>Outlook 2010</em></p>\n\n<pre><code>Windows Registry Editor Version 5.00\n\n[HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Office\\14.0\\Outlook\\Security]\n\"EnableUnsafeClientMailRules\"=dword:00000001\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p><em>For <strong><code>Outlook 2013</code></strong> use <code>\\Office\\15.0\\</code> and <strong><code>Outlook 2016</code></strong> <code>\\Office\\16.0\\</code></em></p>\n</blockquote>\n"}], "owner": {"reputation": 77, "user_id": 7932154, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9f069878c0f3061a4e21eadc1f7bb139?s=128&d=identicon&r=PG", "display_name": "Rachael", "link": "https://stackoverflow.com/users/7932154/rachael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6525, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1592872676, "creation_date": 1499250096, "last_edit_date": 1592872676, "question_id": 44923509, "link": "https://stackoverflow.com/questions/44923509/outlook-2013-run-a-script-rule-has-disappeared", "title": "Outlook 2013 &#39;Run a script&#39; rule has disappeared", "body": "<p>I have some rules for work in outlook 2013 - however following my laptop crashing the other day, I can no longer run any rules, they simply do not work (I don't even get a debug notification). Upon checking my macros, I found that when I tried to click on any scripts I have and I keep getting the message 'This action is not available in the current mode'. \nThe option to create a new script has disappeared from the rule list too.</p>\n\n<p>So far I have tried:\n-Using the outlook 2016 fix by running the registry fix DWORD 1 (There is nothing out there for 2013). I have restarted my Pc and it still has not changed a thing.\n-System restore to a previous date. This has literally changed nothing.</p>\n\n<p>I'm a little stuck. I have attached screenshots to further explain exactly what I am experiencing.</p>\n\n<p>Thanks,</p>\n\n<p>Rachael</p>\n\n<p><strong>Some information has been whited out due to confidentiality.</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/wPqeM.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wPqeM.jpg\" alt=\"1\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/BFLzj.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BFLzj.jpg\" alt=\"2\"></a></p>\n\n<p>Trust Centre Settings: </p>\n\n<p><a href=\"https://i.stack.imgur.com/oLQ2p.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oLQ2p.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "selenium", "selenium-webdriver", "selenium-chromedriver"], "comments": [{"owner": {"reputation": 1543, "user_id": 4321213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eb8ee864f581864dd312055a2da8e42?s=128&d=identicon&r=PG&f=1", "display_name": "Breaks Software", "link": "https://stackoverflow.com/users/4321213/breaks-software"}, "edited": false, "score": 0, "creation_date": 1499430248, "post_id": 44923496, "comment_id": 76915971, "body": "Please show us your code that sets up the Capabilities for your ChromeDriver.  This is where you are already setting up that flag."}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1499456477, "post_id": 44923496, "comment_id": 76932266, "body": "<code>Please explain how can i apply the answer mention in above link into my VBA code.</code> If you want a VBA answer, why the VB.NET tag?"}], "answers": [{"tags": [], "owner": {"reputation": 415, "user_id": 5622941, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/RmDhX.png?s=128&g=1", "display_name": "dey.shin", "link": "https://stackoverflow.com/users/5622941/dey-shin"}, "is_accepted": false, "score": 2, "last_activity_date": 1499448505, "creation_date": 1499448505, "answer_id": 44976609, "question_id": 44923496, "link": "https://stackoverflow.com/questions/44923496/handling-in-webdriver-using-chromeoptions/44976609#44976609", "title": "Handling In Webdriver Using Chromeoptions", "body": "<p>I could not find documentation for SeleniumWrapper. So, I <em>assumed</em> that <code>SeleniumWrapper.WebDriver.Start</code> doesn't handle any `ChromeOptions' related arguments.</p>\n\n<p>If the above assumption is true, one cannot apply <a href=\"http://www.abodeqa.com/tag/how-to-remove-you-are-using-an-unsupported-command-line-flag-ignore-certificate-errors-stability-and-security-will-suffer/\" rel=\"nofollow noreferrer\">the given solution in C#</a>. </p>\n\n<p>Instead, you may try the following: (I referenced <a href=\"https://stackoverflow.com/questions/25112574/selenium-with-chrome-shows-console-window-of-chrome-driver-get-page-complete-e\">this</a>)</p>\n\n<pre><code>Imports OpenQA.Selenium\nImports OpenQA.Selenium.Chrome\n\n...\n...\n\nPublic Sub key()\n\n  Dim service As OpenQA.Selenium.Chrome.ChromeDriverService = OpenQA.Selenium.Chrome.ChromeDriverService.CreateDefaultService()\n\n  Dim chromeOptions As New OpenQA.Selenium.Chrome.ChromeOptions()\n  chromeOptions.AddExcludedArgument(\"ignore-certifcate-errors\")\n  chromeOptions.AddArgument(\"test-type\")\n\n  Dim driver As IWebDriver = New ChromeDriver(service, chromeOptions)\n  driver.Navigate().GoToUrl(\"https://google.com/\")\n\n  driver.Quit()\n\nEnd Sub\n</code></pre>\n\n<p>I added couple lines from my experience running Selenium in C#. </p>\n\n<p>Please provide where <code>SeleniumWrapper</code> with its documentation to determine if one can/cannot set <code>ChromeOptions</code> for <code>SeleniumWrapper</code>.</p>\n"}], "owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 945, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1499632122, "creation_date": 1499250068, "last_edit_date": 1499632122, "question_id": 44923496, "link": "https://stackoverflow.com/questions/44923496/handling-in-webdriver-using-chromeoptions", "title": "Handling In Webdriver Using Chromeoptions", "body": "<p>I am facing the error in chrome which is <strong>\"You Are Using An Unsupported Command-Line Flag \u2013Ignore-Certificate-Errors. Stability And Security Will Suffer.\"</strong> for my below selenium code.</p>\n\n<pre><code>Public Sub key()\n  Dim selenium As New SeleniumWrapper.WebDriver  \n  selenium.Start \"chrome\", \"https://google.com/\"\nselenium.stop\nEnd Sub\n</code></pre>\n\n<p>I have searched the same error solution in below link.</p>\n\n<p><a href=\"http://www.abodeqa.com/tag/how-to-remove-you-are-using-an-unsupported-command-line-flag-ignore-certificate-errors-stability-and-security-will-suffer/\" rel=\"noreferrer\">http://www.abodeqa.com/tag/how-to-remove-you-are-using-an-unsupported-command-line-flag-ignore-certificate-errors-stability-and-security-will-suffer/</a></p>\n\n<p>Please explain how can i apply the answer mention in above link into my VBA code.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 7410870, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/1429588963726841/picture?type=large", "display_name": "Stan", "link": "https://stackoverflow.com/users/7410870/stan"}, "edited": false, "score": 0, "creation_date": 1499253251, "post_id": 44923629, "comment_id": 76824665, "body": "When I try this I get a subscript out of range error, I edited my question with this part. Also I need to store the values of x and y so I can&#39;t do it completely like u proposed."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 95, "user_id": 7410870, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/1429588963726841/picture?type=large", "display_name": "Stan", "link": "https://stackoverflow.com/users/7410870/stan"}, "edited": false, "score": 0, "creation_date": 1499253327, "post_id": 44923629, "comment_id": 76824702, "body": "@Stan are trying to copy whole columns ? and also store them in array called <code>x</code> and <code>y</code> ?"}, {"owner": {"reputation": 95, "user_id": 7410870, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/1429588963726841/picture?type=large", "display_name": "Stan", "link": "https://stackoverflow.com/users/7410870/stan"}, "edited": false, "score": 0, "creation_date": 1499253443, "post_id": 44923629, "comment_id": 76824770, "body": "No I don&#39;t want to copy whole columns. Only rows with a specific value in column A."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 95, "user_id": 7410870, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/1429588963726841/picture?type=large", "display_name": "Stan", "link": "https://stackoverflow.com/users/7410870/stan"}, "edited": false, "score": 0, "creation_date": 1499253836, "post_id": 44923629, "comment_id": 76825051, "body": "@Stan and where is that part of the code ? Where is the <code>If</code> criteria ?"}, {"owner": {"reputation": 95, "user_id": 7410870, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/1429588963726841/picture?type=large", "display_name": "Stan", "link": "https://stackoverflow.com/users/7410870/stan"}, "edited": false, "score": 0, "creation_date": 1499254225, "post_id": 44923629, "comment_id": 76825338, "body": "Updated my code. I didn&#39;t want to put too much code in my question to keep my question specified to where the problem is."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1499250419, "creation_date": 1499250419, "answer_id": 44923629, "question_id": 44923474, "link": "https://stackoverflow.com/questions/44923474/vba-obtaining-values-from-a-workbook-and-put-them-in-another-workbook/44923629#44923629", "title": "VBA obtaining values from a workbook and put them in another workbook", "body": "<p>How about like this, first set the <code>wb</code> and <code>wb2</code> objects outside the loop, and after just set the values directly between workbook.</p>\n\n<pre><code>Set wb2 = Workbooks.Open(\"...\")\nSet wb = Workbooks.Open(\"...\")\n\nFor i = 2 To LastRow\n    wb.Worksheets(\"...\").Cells(i, 2).Value = wb2.Worksheets(\"...\").Cells(i, 2).Value\n    wb.Worksheets(\"...\").Cells(i, 3).Value = wb2.Worksheets(\"...\").Cells(i, 3).Value\nNext i\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 7410870, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/1429588963726841/picture?type=large", "display_name": "Stan", "link": "https://stackoverflow.com/users/7410870/stan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499254168, "creation_date": 1499250017, "last_edit_date": 1499254168, "question_id": 44923474, "link": "https://stackoverflow.com/questions/44923474/vba-obtaining-values-from-a-workbook-and-put-them-in-another-workbook", "title": "VBA obtaining values from a workbook and put them in another workbook", "body": "<p>I'm having trouble putting values from one workbook to another.</p>\n\n<p>Right now it works, but as you can probably see in the code below, it constantly opens one workbook after the second one until the loop ends. So my question: how can I do this without opening the workbooks all the time?</p>\n\n<p>Code:</p>\n\n<pre><code>For i = 2 To LastRow\nSet wb2 = Workbooks.Open(\"...\")\nWith Worksheets(\"...\")\n    x = .Cells(i, 2).Value\n    y = .Cells(i, 3).Value\nEnd With\n\nIf variable1 = variable2 Then\nSet wb = Workbooks.Open(\"...\")\nWith Worksheets(\"...\")        \n    .Cells(i, 2).Value = x\n    .Cells(i, 3).Value = y    \nEnd With\nEnd If\n\nNext i\n</code></pre>\n\n<p>The following code gives me an error: Subscript out of range at <code>x = wb2.WorkSheets(\"...\").Cells(i, 2).Value</code></p>\n\n<pre><code>Set wb2 = Workbooks.Open(\"...\")\nSet wb = Workbooks.Open(\"...\")\nFor i = 2 To LastRow\n    x = wb2.WorkSheets(\"...\").Cells(i, 2).Value\n    y = wb2.WorkSheets(\"...\").Cells(i, 3).Value\nIf variable1 = variable2 Then\n    wb.WorkSheets(\"...\").Cells(i, 2).Value = x\n    wb.WorkSheets(\"...\").Cells(i, 3).Value = y\nEnd If\n\nNext i\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 867, "user_id": 2770438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8219814e55b3ab73a24b7f24fdf8eb73?s=128&d=identicon&r=PG&f=1", "display_name": "jmdon", "link": "https://stackoverflow.com/users/2770438/jmdon"}, "edited": false, "score": 0, "creation_date": 1499249897, "post_id": 44923346, "comment_id": 76822301, "body": "will the target file always be an Excel workbook?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1499250215, "post_id": 44923346, "comment_id": 76822534, "body": "Sounds like you want to use <a href=\"https://msdn.microsoft.com/VBA/Excel-VBA/articles/application-filedialog-property-excel\" rel=\"nofollow noreferrer\"><code>Application.FileDialog</code></a>"}, {"owner": {"reputation": 65, "user_id": 7888139, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F9Onh.jpg?s=128&g=1", "display_name": "prerna arora", "link": "https://stackoverflow.com/users/7888139/prerna-arora"}, "edited": false, "score": 0, "creation_date": 1499250283, "post_id": 44923346, "comment_id": 76822582, "body": "yes ... but it wont be a &quot;xlsm&quot; type it will be an &quot;xlsx&quot; extension"}], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1499250213, "creation_date": 1499250213, "answer_id": 44923562, "question_id": 44923346, "link": "https://stackoverflow.com/questions/44923346/calling-an-excel-file-via-a-macro/44923562#44923562", "title": "Calling an excel file via a macro", "body": "<p>Use <code>Application.FileDialog</code>, there are lot's of examples in SO and elsewhere on the internet, for example <a href=\"https://stackoverflow.com/questions/21723223/open-a-workbook-using-filedialog-and-manipulate-it\">here</a></p>\n"}, {"tags": [], "owner": {"reputation": 867, "user_id": 2770438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8219814e55b3ab73a24b7f24fdf8eb73?s=128&d=identicon&r=PG&f=1", "display_name": "jmdon", "link": "https://stackoverflow.com/users/2770438/jmdon"}, "is_accepted": false, "score": 0, "last_activity_date": 1499250388, "creation_date": 1499250388, "answer_id": 44923621, "question_id": 44923346, "link": "https://stackoverflow.com/questions/44923346/calling-an-excel-file-via-a-macro/44923621#44923621", "title": "Calling an excel file via a macro", "body": "<p>The below will open and set wkbFileToOpen, you will then be able to use this as your workbook to manipulate.</p>\n\n<pre><code>Dim vFileToOpen As Variant\nDim wkbFileToOpen As Workbook\n\n'Ask the user to select the file, you can change your desired file extensions and file types\nvFileToOpen = Application.GetOpenFilename(\"Excel Files (*.xls),*.xls,\", 1, \"Select the workbook\", , False)\n\n'if the user cancels, then vFileToOpen will be false, so we need to check there's a value\nIf Not vFileToOpen Then\n\n    Workbooks.Open vFileToOpen\n    Set wkbFileToOpen = ActiveWorkbook\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 7888139, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F9Onh.jpg?s=128&g=1", "display_name": "prerna arora", "link": "https://stackoverflow.com/users/7888139/prerna-arora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1499250388, "creation_date": 1499249756, "question_id": 44923346, "link": "https://stackoverflow.com/questions/44923346/calling-an-excel-file-via-a-macro", "title": "Calling an excel file via a macro", "body": "<p>I want to create a macro that pulls a file by allowing the user to browse and locate the file from his/her local and then perform some functions on the pulled file.</p>\n\n<p>I am not sure how to incorporate the browsing file feature in the macro.</p>\n"}, {"tags": ["vba", "excel", "wildcard"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1499249775, "post_id": 44923112, "comment_id": 76822205, "body": "Not sure I understand, you are getting an error message ? not getting the expected result ? it will be a little hard to help without seeing a sample of your data, and where do you set and init the array <code>groupnames</code>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1499250839, "post_id": 44923112, "comment_id": 76822983, "body": "@ShaiRado I think he expected 96 returns maximum, but found 500."}, {"owner": {"reputation": 3, "user_id": 8258383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PdCLTumMzzo/AAAAAAAAAAI/AAAAAAAAAF4/FZ8APxQ7Gaw/photo.jpg?sz=128", "display_name": "Suborits P&#233;ter", "link": "https://stackoverflow.com/users/8258383/suborits-p%c3%a9ter"}, "edited": false, "score": 0, "creation_date": 1499328564, "post_id": 44923112, "comment_id": 76862007, "body": "i have one column with datas. this datas i read to an array. i want to find every cell this string [BLOCKED] . for example one cell have &quot;[BLOCKED] - xyz.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 3, "user_id": 8258383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PdCLTumMzzo/AAAAAAAAAAI/AAAAAAAAAF4/FZ8APxQ7Gaw/photo.jpg?sz=128", "display_name": "Suborits P&#233;ter", "link": "https://stackoverflow.com/users/8258383/suborits-p%c3%a9ter"}, "edited": false, "score": 0, "creation_date": 1499334207, "post_id": 44923494, "comment_id": 76865734, "body": "What does <i>doesn-&#39;t work</i> mean?  If it means you are getting the same result as before (500 matches) then you have a problem other than what you have stated. If you mean something else, understand I cannot read your mind.  Please read  <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a> as I cannot reproduce any error based on what you have provided."}, {"owner": {"reputation": 3, "user_id": 8258383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PdCLTumMzzo/AAAAAAAAAAI/AAAAAAAAAF4/FZ8APxQ7Gaw/photo.jpg?sz=128", "display_name": "Suborits P&#233;ter", "link": "https://stackoverflow.com/users/8258383/suborits-p%c3%a9ter"}, "edited": false, "score": 0, "creation_date": 1499335318, "post_id": 44923494, "comment_id": 76866598, "body": "sorry.., i mean i have 0 match. if i just finding blocked i got 100matches so the code other parts is ok"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 3, "user_id": 8258383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PdCLTumMzzo/AAAAAAAAAAI/AAAAAAAAAF4/FZ8APxQ7Gaw/photo.jpg?sz=128", "display_name": "Suborits P&#233;ter", "link": "https://stackoverflow.com/users/8258383/suborits-p%c3%a9ter"}, "edited": false, "score": 0, "creation_date": 1499336374, "post_id": 44923494, "comment_id": 76867321, "body": "I will review after you have updated your question to provide an example that demonstrates the problem."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 3, "user_id": 8258383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PdCLTumMzzo/AAAAAAAAAAI/AAAAAAAAAF4/FZ8APxQ7Gaw/photo.jpg?sz=128", "display_name": "Suborits P&#233;ter", "link": "https://stackoverflow.com/users/8258383/suborits-p%c3%a9ter"}, "edited": false, "score": 0, "creation_date": 1499338934, "post_id": 44923494, "comment_id": 76869091, "body": "@SuboritsP&#233;ter Oh, and even though you entered word blocked incorrectly, <code>&quot;*[[]BLOCKED[]]*&quot;</code> vs <code>&quot;*[[]BLOCKED]*&quot;</code>, it definitely matches <code>blah blah [BLOCKED] blah blah</code> when that word is in a worksheet cell."}, {"owner": {"reputation": 3, "user_id": 8258383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PdCLTumMzzo/AAAAAAAAAAI/AAAAAAAAAF4/FZ8APxQ7Gaw/photo.jpg?sz=128", "display_name": "Suborits P&#233;ter", "link": "https://stackoverflow.com/users/8258383/suborits-p%c3%a9ter"}, "edited": false, "score": 0, "creation_date": 1499341206, "post_id": 44923494, "comment_id": 76870619, "body": "&quot;<i>[[]BLOCKED]</i>&quot; i used this for matching and firstly when i run don&#39;t work 0 match but i don&#39;t know how i run macro sencondly it is working and i&#39;ve got the correct matches so thank you very much for helping"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 3, "user_id": 8258383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PdCLTumMzzo/AAAAAAAAAAI/AAAAAAAAAF4/FZ8APxQ7Gaw/photo.jpg?sz=128", "display_name": "Suborits P&#233;ter", "link": "https://stackoverflow.com/users/8258383/suborits-p%c3%a9ter"}, "edited": false, "score": 0, "creation_date": 1499341411, "post_id": 44923494, "comment_id": 76870774, "body": "Looks like you  omitted the asterisks in your first try and included them in your second"}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 0, "last_activity_date": 1499250056, "creation_date": 1499250056, "answer_id": 44923494, "question_id": 44923112, "link": "https://stackoverflow.com/questions/44923112/excel-vba-finding-with-like-or-regex/44923494#44923494", "title": "excel vba finding with like or regex", "body": "<p>The syntax of your <strong>Like</strong>  operation is incorrect.  Use:</p>\n\n<pre><code>... Like \"*[[]BLOCKED]*\"\n</code></pre>\n\n<p><strong>[...]</strong> is a Character class.  So, the way you have it written in your question, it will find any single character in the set of BLOCKED.  That is not what you want, apparently.</p>\n\n<p>To match the <strong>[</strong> character, you enclose it within a character class, as I have shown.  To match the <strong>]</strong> character, it must be outside of a character class.</p>\n"}, {"comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1499337896, "post_id": 44946475, "comment_id": 76868332, "body": "This belongs as an update to your question (edit your question to include this) as it is not an answer to your question.  Also, I do not have a tool to convert the screenshot of your Excel page to a usable Excel worksheet. What tool do you use to accomplish that conversion?"}], "tags": [], "owner": {"reputation": 3, "user_id": 8258383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PdCLTumMzzo/AAAAAAAAAAI/AAAAAAAAAF4/FZ8APxQ7Gaw/photo.jpg?sz=128", "display_name": "Suborits P&#233;ter", "link": "https://stackoverflow.com/users/8258383/suborits-p%c3%a9ter"}, "is_accepted": false, "score": 0, "last_activity_date": 1499337149, "creation_date": 1499337149, "answer_id": 44946475, "question_id": 44923112, "link": "https://stackoverflow.com/questions/44923112/excel-vba-finding-with-like-or-regex/44946475#44946475", "title": "excel vba finding with like or regex", "body": "<p>here is my code</p>\n\n<pre><code>Sub blocked()\n\nDim SfileUsers As String\nDim path As String\nDim pathread As String\nDim sFileread As String\nDim lastrow As Long\nDim keres() As Variant\nDim groupadd() As String\nDim groupnames(4) As String\nDim groupsum(4) As Long\n\n\n\n\npath = \"C:\\Users\\uids9282\\Desktop\\\"\nSfileUsers = \"Users.xlsx\"\nWorkbooks.Open path &amp; SfileUsers\nDim hossz As Long\nhossz = Sheets(1).Cells(Rows.Count, 1).End(xlUp).Row\nReDim keres(hossz)\nReDim groupadd(hossz)\nFor i = 2 To hossz\nkeres(i) = Sheets(1).Cells(i, 2).Value\ngroupadd(i) = Sheets(1).Cells(i, 4).Value\nNext i\n\n\n'f\u00e1jlmegnyit\u00e1s\npathread = \"C:\\Users\\uids9282\\Desktop\\20170703\\\"\nsFileread = \"open.xml\"\n        If Dir(pathread &amp; sFileread) = sFileread Then\n            Workbooks.Open pathread &amp; sFileread\n            lastrow = Workbooks(sFileread).Sheets(1).Cells(Rows.Count, 1).End(xlUp).Row\n\n            Else\n            MsgBox (\"Nincs ilyen nev\u0171 excel t\u00e1bl\u00e1zat. K\u00e9rem pr\u00f3b\u00e1lkozzon \u00fajra\")\n        End If\n\n'groupok hozz\u00e1ad\u00e1sa a f\u00e1jlhoz\nDim user As String\nFor j = 2 To hossz\n    For i = 2 To lastrow\n    user = Trim(Cells(i, 5).Value)\n        If user = keres(j) Then\n            Cells(i, 12).Value = groupadd(j)\n        End If\n    Next i\nNext j\n\n'group szumm\u00e1z\u00e1sa \u00e9s \u00e1t\u00edr\u00e1sa\nThisWorkbook.Activate\nFor i = 2 To 6\ngroupnames(i - 2) = Cells(i, 1).Value\nNext i\nWorkbooks(sFileread).Activate\nFor j = 0 To 4\n    For i = 2 To lastrow\n        If Cells(i, 12).Value = groupnames(j) And Cells(i, 8).Value Like \"*[[]BLOCKED[]]*\" Then 'itt van benne a hiba!!         groupsum(j) = groupsum(j) + 1\n        End If\n    Next i\nNext j\nThisWorkbook.Activate\nFor j = 2 To 6\n    Cells(j, 4).Value = groupsum(j - 2)\nNext j\n\nWorkbooks(SfileUsers).Close SaveChanges:=False\nWorkbooks(sFileread).Close SaveChanges:=True\n\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/if3jj.jpg\" rel=\"nofollow noreferrer\">this is my excel file where i want to searching</a></p>\n"}], "owner": {"reputation": 3, "user_id": 8258383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PdCLTumMzzo/AAAAAAAAAAI/AAAAAAAAAF4/FZ8APxQ7Gaw/photo.jpg?sz=128", "display_name": "Suborits P&#233;ter", "link": "https://stackoverflow.com/users/8258383/suborits-p%c3%a9ter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 44923494, "answer_count": 2, "score": 0, "last_activity_date": 1521619183, "creation_date": 1499249165, "last_edit_date": 1521619183, "question_id": 44923112, "link": "https://stackoverflow.com/questions/44923112/excel-vba-finding-with-like-or-regex", "title": "excel vba finding with like or regex", "body": "<p>I'm writing a VBA program.\nI have a problem with finding this string <code>[BLOCKED]</code> in one column</p>\n\n<pre><code>For j = 0 To 4\n    For i = 2 To lastrow\n        If Cells(i, 12).Value = groupnames(j) And Cells(i, 8).Value Like \"*\" &amp; \"[BLOCKED]\" &amp; \"*\" Then\n            groupsum(j) = groupsum(j) + 1\n        End If\n    Next i\nNext j\n</code></pre>\n\n<p>The problem is I have 96 cells for this string but the program found 500 how can I do this to going work?<br>\nThanks for help</p>\n"}, {"tags": ["excel", "data-comparison", "vba"], "comments": [{"owner": {"reputation": 187, "user_id": 7240351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08f022d85c0352244628cabc55dcb16a?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej Lipinski", "link": "https://stackoverflow.com/users/7240351/maciej-lipinski"}, "edited": false, "score": 0, "creation_date": 1499250723, "post_id": 44923077, "comment_id": 76822895, "body": "What have you done so far? Where are you stuck?"}, {"owner": {"reputation": 244, "user_id": 8219745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/461a5f5a7698d5fdb33a067c662a5c50?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok", "link": "https://stackoverflow.com/users/8219745/ashok"}, "reply_to_user": {"reputation": 187, "user_id": 7240351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08f022d85c0352244628cabc55dcb16a?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej Lipinski", "link": "https://stackoverflow.com/users/7240351/maciej-lipinski"}, "edited": false, "score": 0, "creation_date": 1499252320, "post_id": 44923077, "comment_id": 76824041, "body": "@MaciejLipinski i googled but  couldn&#39;t found the way to which formula should use in the coding. still now i am in the first line"}, {"owner": {"reputation": 187, "user_id": 7240351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08f022d85c0352244628cabc55dcb16a?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej Lipinski", "link": "https://stackoverflow.com/users/7240351/maciej-lipinski"}, "edited": false, "score": 0, "creation_date": 1499252978, "post_id": 44923077, "comment_id": 76824501, "body": "You could try to do it with nested loops. For each row in the old workbook, check if there&#39;s an identical row in the new workbook. If there isn&#39;t, it means it was deleted.  Then do the same again but have the outer loop go over the new workbook and the inner go over the outer loop. The unmatched rows are the added rows. It&#39;s not very efficient but for 400 rows it&#39;ll do."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 187, "user_id": 7240351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08f022d85c0352244628cabc55dcb16a?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej Lipinski", "link": "https://stackoverflow.com/users/7240351/maciej-lipinski"}, "edited": false, "score": 1, "creation_date": 1499254252, "post_id": 44923077, "comment_id": 76825354, "body": "@MaciejLipinski You might want to load the records into some array before taking that approach, unless you have a few minutes to spare each time you make the comparison.  You also might want to add a unique key helper column and check on that one instead of all fields in all rows. If it&#39;s 400 rows, sure, but when comparing 10K+ rows, nested loops come straight out of hell."}, {"owner": {"reputation": 187, "user_id": 7240351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08f022d85c0352244628cabc55dcb16a?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej Lipinski", "link": "https://stackoverflow.com/users/7240351/maciej-lipinski"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1499255115, "post_id": 44923077, "comment_id": 76825950, "body": "@RikSportel agreed, I suggested this approach because it&#39;s not very complicated to implement and it&#39;s a starting point for OP. Once it&#39;s operational you could optimize it as you said. OP didn&#39;t say what was the basis for row comparison so perhaps checking all fields is not necessary."}, {"owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 0, "creation_date": 1499345467, "post_id": 44923077, "comment_id": 76873833, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/11753724/excel-vba-compare-rows-of-two-workbooks-and-replace\">Excel vba, compare rows of two workbooks and replace</a>"}], "owner": {"reputation": 244, "user_id": 8219745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/461a5f5a7698d5fdb33a067c662a5c50?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok", "link": "https://stackoverflow.com/users/8219745/ashok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499345446, "creation_date": 1499249069, "last_edit_date": 1531161705, "question_id": 44923077, "link": "https://stackoverflow.com/questions/44923077/vba-excel-how-to-get-the-deleted-row-and-added-row-in-latest-excel-file-while", "title": "VBA Excel : How to get the deleted row and added row in latest excel file while comparing with old file", "body": "<p>I am struggling with writing a vba code for getting the deleted rows data and added rows data in latest excel file while comparing with old excel file. </p>\n\n<p>example: latest workbook(WB) have 405 rows of data and old workbook(WB) have 400 rows of data. the factor is - <code>might have added 5 rows in latest WB</code> or <code>might have deleted 2 rows and added 7 rows in latest WB</code> . if it is added (row was added in latest WB), have to get the added rows data from latest WB, if it is deleted(the rows was deleted in latest WB), have to get the deleted rows data from old WB . Please help me.</p>\n"}, {"tags": ["excel", "vba", "variables", "object", "block"], "answers": [{"comments": [{"owner": {"reputation": 643, "user_id": 4932012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JEtGx.png?s=128&g=1", "display_name": "Matti VM", "link": "https://stackoverflow.com/users/4932012/matti-vm"}, "edited": false, "score": 0, "creation_date": 1502871554, "post_id": 44926314, "comment_id": 78374872, "body": "I only tried the first approach and it worked for so long I thought it was fixed until I got the error again. Now I&#39;m going to add the second approach. (You forgot a &#39;)&#39; after &#39;Application.Wait(Now + TimeValue(&quot;00:00:02&quot;)&#39;. I can not edit it because I have to add or change at least 6 characters.)"}], "tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": true, "score": 0, "last_activity_date": 1503315345, "last_edit_date": 1503315345, "creation_date": 1499257719, "answer_id": 44926314, "question_id": 44922881, "link": "https://stackoverflow.com/questions/44922881/vba-excel-error-91-object-variable-or-with-block-variable-not-set/44926314#44926314", "title": "VBA EXCEL error 91 object variable or with block variable not set", "body": "<p>There are some cases where you can encounter an issue like this (where F8 always works, but a normal run doesn't) if the object return, in whatever way, isn't fully <em>connected</em>. It is difficult to say for certain if this is the case, and I have only encountered this when I am setting an object to something that has it's own process for initializing, and when this process is outside of the control of the VBA routine. </p>\n\n<p>For your problem, specifically, there are a couple of approaches you can take:</p>\n\n<pre><code>Set varListingIDElement = html.getElementById(\"listing\")\nIf Not varListingIDEElement is Nothing Then\n    varShopName = getXPathElement(\"/table/tbody/tr[1]/td[1]/p/a\", varListingIDElement).innerText\nEnd If\n</code></pre>\n\n<p>The above approach should prevent the error entirely, but it also means varShopName may not be set.</p>\n\n<p>On the other hand:</p>\n\n<pre><code>Set varListingIDElement = html.getElementById(\"listing\")\n\nApplication.Wait(Now + TimeValue(\"00:00:03\"))\n\nvarShopName = getXPathElement(\"/table/tbody/tr[1]/td[1]/p/a\", varListingIDElement).innerText\n</code></pre>\n\n<p>This will force the application to wait three seconds between the initial setting of the variable, and the final calling of the variable. You could use this approach if it is indeed an issue of the prior process not finishing before the new one begins. You could also combine this approach with the first to get the best of both.</p>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 643, "user_id": 4932012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JEtGx.png?s=128&g=1", "display_name": "Matti VM", "link": "https://stackoverflow.com/users/4932012/matti-vm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1055, "favorite_count": 1, "accepted_answer_id": 44926314, "answer_count": 1, "score": 0, "last_activity_date": 1503315345, "creation_date": 1499248548, "question_id": 44922881, "link": "https://stackoverflow.com/questions/44922881/vba-excel-error-91-object-variable-or-with-block-variable-not-set", "title": "VBA EXCEL error 91 object variable or with block variable not set", "body": "<p>Hi I have this weird problem where I get error 91 (\"object variable or with block variable not set\"). I do not always get the error when I run the script, only now and then (random). I have tried to do as much as I can without success.</p>\n\n<p>I am scraping a site to get the most recent prices of some pc components. </p>\n\n<p>In order to do that I made a script and call the script sequentially multiple times for different parts. The error is not related to a specific part. I get the error randomly on all the parts. Sometimes I can do all the calls without any errors.</p>\n\n<p>The script (not the full script, only what you need):</p>\n\n<pre><code>Sub ImportUrlData(url As String)\n\n    Dim ie As InternetExplorer\n    Dim html As HTMLDocument\n    Dim varListingIDElement As IHTMLElement\n    Dim varShopName As String\n    varShopName = \"\"\n\n    Set ie = New InternetExplorer\n    ie.Visible = False\n    ie.navigate url\n\n    Do While ie.readyState &lt;&gt; READYSTATE_COMPLETE\n        DoEvents\n    Loop\n\n    Set html = ie.document\n\n    Set varListingIDElement = html.getElementById(\"listing\")\n    varShopName = getXPathElement(\"/table/tbody/tr[1]/td[1]/p/a\", varListingIDElement).innerText\n</code></pre>\n\n<p>I always get the error on this last line:</p>\n\n<pre><code>varShopName = getXPathElement(\"/table/tbody/tr[\" &amp; count &amp; \"]/td[1]/p/a\", varListingIDElement).innerText\n</code></pre>\n\n<p>(The error is not occurring inside the 'getXPathElement' function, so no need to show that too. If you do want to take a look at it just ask and I'll post it here in an edit.)</p>\n\n<p>When I debug from start to end with F8 I never get the error. Is it possible that the next call already starts before the previous one isn't finished yet?</p>\n\n<p>Thanks in advance!</p>\n\n<p>(Sorry if there are some dutch words I have overseen.)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1499247935, "post_id": 44922343, "comment_id": 76820821, "body": "@pnuts, I will make sure, hereafter i look into the tags carefully before i do."}, {"owner": {"reputation": 867, "user_id": 2770438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8219814e55b3ab73a24b7f24fdf8eb73?s=128&d=identicon&r=PG&f=1", "display_name": "jmdon", "link": "https://stackoverflow.com/users/2770438/jmdon"}, "edited": false, "score": 0, "creation_date": 1499247943, "post_id": 44922343, "comment_id": 76820826, "body": "How do you know where the ID is in sht1 in comparison to sht4?"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 867, "user_id": 2770438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8219814e55b3ab73a24b7f24fdf8eb73?s=128&d=identicon&r=PG&f=1", "display_name": "jmdon", "link": "https://stackoverflow.com/users/2770438/jmdon"}, "edited": false, "score": 0, "creation_date": 1499248030, "post_id": 44922343, "comment_id": 76820885, "body": "the id in sht4, is in column E and the id in sht 1 is in column N"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1499248273, "post_id": 44922343, "comment_id": 76821064, "body": "I will do it shortly. Once i am finished with this Task."}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1499252358, "post_id": 44922343, "comment_id": 76824074, "body": "I am unable to understand your question. You are saying <code>i look into the corresponding values in sht 2, and paste them in sht3</code> and you have done that. So now  <code>look into the column E in sht4, and paste the corresponding ID from sht1</code> should also be doable. Though to understand your problem completely, sample data and desired output will be helpful."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1499252983, "post_id": 44922343, "comment_id": 76824505, "body": "@Mrig, Is it possible, i could edit the question, right now the idea is different."}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1499253020, "post_id": 44922343, "comment_id": 76824527, "body": "Will be better if you can edit the question."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1499253061, "post_id": 44922343, "comment_id": 76824553, "body": "Ya, i will do it now. But it will be different from this  ? is that ok ?"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1499253264, "post_id": 44922343, "comment_id": 76824671, "body": "You can write <b>EDIT</b> and add whatever you want to under it, leaving the already existing question as it is."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1499253996, "post_id": 44922343, "comment_id": 76825163, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/148405/discussion-between-mikz-and-mrig\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1499248328, "post_id": 44922673, "comment_id": 76821117, "body": "but how does this, return my value from sheet1 ?"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1499248419, "post_id": 44922673, "comment_id": 76821192, "body": "also, i dont want to look into sht2 here. all i have to do now, is .. consider column E of sheet4, and take the matching data of column a , b, c , d and so on from sht1 and paste them in sht4."}], "tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": false, "score": 0, "last_activity_date": 1499248071, "creation_date": 1499248071, "answer_id": 44922673, "question_id": 44922343, "link": "https://stackoverflow.com/questions/44922343/vba-using-offset/44922673#44922673", "title": "VBA , Using offset", "body": "<p>Why not just use <code>Cells(i, 4).Value = rng.Cells(i, 6).Value</code> ? \nAlso get rid of the<code>.Select</code></p>\n\n<pre><code>Sub nlookup()\ndim sht as Worksheet\nDim i As Long\nDim totalrows As Long\nDim rng As Range\n\ntotalrows = Sheets(\"sht1\").UsedRange.Rows.Count\nSet sht = Worksheets(\"sht4\")\n\nFor i = 5 To totalrows\nSet rng = Sheets(\"sht2\").UsedRange.Find(sht.Cells(i, 5).Value)\n'If it is found put its value on the destination sheet\nIf Not rng Is Nothing Then\nsht.Cells(i, 6).Value = rng.Value\nsht.Cells(i, 1).Value = rng.Cells(i, 1).Value\nsht.Cells(i, 2).Value = rng.Cells(i, 16).Value\nsht.Cells(i, 3).Value = rng.Cells(i, 4).Value\nsht.Cells(i, 4).Value = rng.Cells(i, 6).Value\nsht.Cells(i, 12).Value = rng.Cells(i, 20).Value\nsht.Cells(i, 13).Value = rng.Cells(i, 22).Value\nEnd If\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 1, "last_activity_date": 1499260462, "creation_date": 1499260462, "answer_id": 44927326, "question_id": 44922343, "link": "https://stackoverflow.com/questions/44922343/vba-using-offset/44927326#44927326", "title": "VBA , Using offset", "body": "<p>The code will consider the following as discussed in chat:</p>\n\n<ol>\n<li>Data should be copied from <code>sht1</code> to <code>sht4</code> on Id's in both sheets </li>\n<li>Id's are in <code>Column L</code> and <code>Column E</code> for <code>sht1</code> and <code>sht4</code> respectively </li>\n<li>Columns to be copy from <code>sht1</code> to <code>sht4</code> as <code>A-&gt;A</code>, <code>B-&gt;C</code>,<code>C-&gt;D</code>,<code>I-&gt;L</code>,<code>J-&gt;M</code>,<code>O-&gt;B</code> </li>\n<li><p>Data in <code>sht1</code> and <code>sht4</code> starts from <code>Row 5</code> and <code>Row 2</code> respectively</p>\n\n<pre><code>Sub Demo()\n    Dim srcLastRow As Long, destLastRow As Long\n    Dim srcWS As Worksheet, destWS As Worksheet\n    Dim i As Long, j As Long\n\n    Application.ScreenUpdating = False\n\n    Set srcWS = ThisWorkbook.Sheets(\"Sht1\")\n    Set destWS = ThisWorkbook.Sheets(\"Sht4\")\n    srcLastRow = srcWS.Cells(srcWS.Rows.Count, \"L\").End(xlUp).Row\n    destLastRow = destWS.Cells(destWS.Rows.Count, \"E\").End(xlUp).Row\n\n    For i = 2 To destLastRow\n        For j = 5 To srcLastRow\n            If destWS.Cells(i, \"E\").Value = srcWS.Cells(j, \"L\").Value Then\n                destWS.Cells(i, \"A\") = srcWS.Cells(j, \"A\")\n                destWS.Cells(i, \"B\") = srcWS.Cells(j, \"O\")\n                destWS.Cells(i, \"C\") = srcWS.Cells(j, \"B\")\n                destWS.Cells(i, \"D\") = srcWS.Cells(j, \"C\")\n                destWS.Cells(i, \"L\") = srcWS.Cells(j, \"I\")\n                destWS.Cells(i, \"M\") = srcWS.Cells(j, \"J\")\n            End If\n        Next j\n    Next i\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 44927326, "answer_count": 2, "score": 0, "last_activity_date": 1499260462, "creation_date": 1499247202, "last_edit_date": 1499255628, "question_id": 44922343, "link": "https://stackoverflow.com/questions/44922343/vba-using-offset", "title": "VBA , Using offset", "body": "<p>I am having 4 sht, sht1, sht2, sht3 and sht4. </p>\n\n<p>I am copying the columns E and F from sht 1 to sht3. and then i look into  the corresponding values in sht 2, and paste them in sht3.</p>\n\n<p>I then lookinto in my sht3, if the column \"G\" has \"NO\"; then i copy the corresponding rows to sht4. </p>\n\n<p>till, this i have completed coding. </p>\n\n<p>I wanted to look into the column E in sht4, and paste the corresponding ID from sht1. Could someone tell, how i could do it ? </p>\n\n<p>EDIT. </p>\n\n<p>In sht3, i have the rows filled only when there is Id in column F. </p>\n\n<p>In few cases, i dont have column F,means there is no ID. </p>\n\n<p>so, i copy them to sht4. Now i have in sht4, column E Filled. I want to look into the relevant Information of those ID in sht1. I want the Information from each and every column in sht1, except E .</p>\n\n<p>I know we can use Offset, but how do I use it in this case,\nI have tried the following code</p>\n\n<pre><code>Sub nlookup()\nDim i As Long\nDim totalrows As Long\nDim rng As Range\nSheets(\"sht1\").Select\ntotalrows = ActiveSheet.UsedRange.Rows.Count\nSheets(\"sht4\").Select\nFor i = 5 To totalrows\nSet rng = Sheets(\"sht2\").UsedRange.Find(Cells(i, 5).Value)\n'If it is found put its value on the destination sheet\nIf Not rng Is Nothing Then\nCells(i, 6).Value = rng.Value\nCells(i, 1).Value = rng.Offset(0, 0).Value\nCells(i, 2).Value = rng.Offset(0, 14).Value\nCells(i, 3).Value = rng.Offset(0, 1).Value\nCells(i, 4).Value = rng.Offset(0, 2).Value\nCells(i, 12).Value = rng.Offset(0, 8).Value\nCells(i, 13).Value = rng.Offset(0, 9).Value\nEnd If\nNext\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>Set rng = Sheets(\"sht2\").UsedRange.Find(Cells(i, 5).Value), there is no Need of looking into this line, i beleive.</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/KT377.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KT377.png\" alt=\"Image of sht4. which is extracted from sht3. \"></a>\n<a href=\"https://i.stack.imgur.com/sjwmj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sjwmj.png\" alt=\"Image of sht1\"></a></p>\n"}, {"tags": ["vba", "excel", "datepicker", "textbox"], "comments": [{"owner": {"reputation": 3556, "user_id": 5300473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/88eaa2b57410990d33dfa1b9330b77ae?s=128&d=identicon&r=PG", "display_name": "Spitzbueb", "link": "https://stackoverflow.com/users/5300473/spitzbueb"}, "edited": false, "score": 1, "creation_date": 1499247784, "post_id": 44922320, "comment_id": 76820707, "body": "Could you show us your attempt? Some code?"}, {"owner": {"reputation": 33, "user_id": 8258142, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45179928ec44082755a72d4e2cc2c7cf?s=128&d=identicon&r=PG&f=1", "display_name": "agatha", "link": "https://stackoverflow.com/users/8258142/agatha"}, "reply_to_user": {"reputation": 3556, "user_id": 5300473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/88eaa2b57410990d33dfa1b9330b77ae?s=128&d=identicon&r=PG", "display_name": "Spitzbueb", "link": "https://stackoverflow.com/users/5300473/spitzbueb"}, "edited": false, "score": 0, "creation_date": 1499252439, "post_id": 44922320, "comment_id": 76824123, "body": "Thanks Werenerson...I&#39;ve deleted my attempts thus far...but i was trying to modify the following code which i found online to no availa...i guess it was wrong..Sub textboxes() With Sheets(&quot;Sheet1&quot;)     .TextBox2 = WeekNum(.TextBox1) End With End Sub  Function WeekNum(D As Date) As Integer      WeekNum = CInt(Format(D, &quot;ww&quot;, 2)) End Function"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8258142, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45179928ec44082755a72d4e2cc2c7cf?s=128&d=identicon&r=PG&f=1", "display_name": "agatha", "link": "https://stackoverflow.com/users/8258142/agatha"}, "edited": false, "score": 0, "creation_date": 1499252746, "post_id": 44922873, "comment_id": 76824345, "body": "thank you jmdon...should this be added under the following part of my code? Private Sub DTPicker3_CallbackKeyDown(ByVal KeyCode As Integer, ByVal Shift As Integer, ByVal CallbackField As String, CallbackDate As Date)  End Sub"}, {"owner": {"reputation": 867, "user_id": 2770438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8219814e55b3ab73a24b7f24fdf8eb73?s=128&d=identicon&r=PG&f=1", "display_name": "jmdon", "link": "https://stackoverflow.com/users/2770438/jmdon"}, "reply_to_user": {"reputation": 33, "user_id": 8258142, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45179928ec44082755a72d4e2cc2c7cf?s=128&d=identicon&r=PG&f=1", "display_name": "agatha", "link": "https://stackoverflow.com/users/8258142/agatha"}, "edited": false, "score": 0, "creation_date": 1499253003, "post_id": 44922873, "comment_id": 76824516, "body": "Is your date picker a combo box, it should go in the Change event of your date picker inside your UserForm module, eg: Private Sub ComboBox1_Change() End Sub"}, {"owner": {"reputation": 33, "user_id": 8258142, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45179928ec44082755a72d4e2cc2c7cf?s=128&d=identicon&r=PG&f=1", "display_name": "agatha", "link": "https://stackoverflow.com/users/8258142/agatha"}, "edited": false, "score": 0, "creation_date": 1499337777, "post_id": 44922873, "comment_id": 76868237, "body": "hi jmdon...so this worked great when my date completed field has a value but for entries where this should be left blank the datepicker seems impractical so i&#39;ve resorted to using a textbox instead so that the coordinators can manually update the field...now the problem is the functions you provided no longer work..i&#39;ve tried using cdate to convert the text but i keep getting an error :( my attempt is below:"}, {"owner": {"reputation": 33, "user_id": 8258142, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45179928ec44082755a72d4e2cc2c7cf?s=128&d=identicon&r=PG&f=1", "display_name": "agatha", "link": "https://stackoverflow.com/users/8258142/agatha"}, "edited": false, "score": 0, "creation_date": 1499337785, "post_id": 44922873, "comment_id": 76868246, "body": "Private Sub DateCompleted_Change() Dim dDT As Date dDT = CDate(Me.DateCompleted.Value) TextBox1.Value = dDT  WeekNumTxt.Value = DatePart(&quot;ww&quot;, TextBox1.Value, vbMonday, vbFirstJan1) MonthNumTxt.Value = Format(TextBox1.Value, &quot;mm&quot;) YearTxt.Value = Format(TextBox1.Value, &quot;yyyy&quot;) End Sub When i run the macro it says run-tim error: 13 type mismatch...can you enlighten me further? thanks so much!"}, {"owner": {"reputation": 867, "user_id": 2770438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8219814e55b3ab73a24b7f24fdf8eb73?s=128&d=identicon&r=PG&f=1", "display_name": "jmdon", "link": "https://stackoverflow.com/users/2770438/jmdon"}, "reply_to_user": {"reputation": 33, "user_id": 8258142, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45179928ec44082755a72d4e2cc2c7cf?s=128&d=identicon&r=PG&f=1", "display_name": "agatha", "link": "https://stackoverflow.com/users/8258142/agatha"}, "edited": false, "score": 0, "creation_date": 1499345676, "post_id": 44922873, "comment_id": 76874013, "body": "It is likely that if DateCompleted is changed but the value is blank, the rest of the code won&#39;t work as it can&#39;t convert a blank string to a date. You can try surrounding the code so it will only attempt to convert the dates if the date picker has a value. with an IF statement, eg: If DateCompleted.Value &lt;&gt; &quot;&quot; Then. In the Else you can set your textbox values to blank if required, so if the date picker is blank the rest of the text boxes will update to blank."}, {"owner": {"reputation": 33, "user_id": 8258142, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45179928ec44082755a72d4e2cc2c7cf?s=128&d=identicon&r=PG&f=1", "display_name": "agatha", "link": "https://stackoverflow.com/users/8258142/agatha"}, "edited": false, "score": 0, "creation_date": 1499411340, "post_id": 44922873, "comment_id": 76904051, "body": "Thnka jmdon...im still trying to learn vba so I&#39;m not entirely sure how to do this...i have instead created a workaround by adding an invisible textbox which then takes the value of the datepicker when it is changed...thank you so much for your help!"}], "tags": [], "owner": {"reputation": 867, "user_id": 2770438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8219814e55b3ab73a24b7f24fdf8eb73?s=128&d=identicon&r=PG&f=1", "display_name": "jmdon", "link": "https://stackoverflow.com/users/2770438/jmdon"}, "is_accepted": true, "score": 0, "last_activity_date": 1499248541, "creation_date": 1499248541, "answer_id": 44922873, "question_id": 44922320, "link": "https://stackoverflow.com/questions/44922320/identify-week-number-month-number-year-from-datepicker-control-in-vba-userform/44922873#44922873", "title": "Identify Week Number, Month Number, Year from DatePicker control in VBA userform", "body": "<p>To get the week number use the below. The third and fourth arguments allow you to dictate the first day/first week of the year.</p>\n\n<pre><code>TextBoxWeek.Value =  DatePart(\"ww\", TextBoxDatePicker.Value, vbMonday, vbFirstJan1 )\n</code></pre>\n\n<p>Month:</p>\n\n<pre><code>TextBoxMonth.Value = format(TextBoxDatePicker.value,\"mm\")\n</code></pre>\n\n<p>Year: (you can also use \"yy\" to get the shorthand date eg. '17' rather than '2017')</p>\n\n<pre><code>TextBoxYear.Value = format(TextBoxDatePicker.value, \"yyyy\") \n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8258142, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45179928ec44082755a72d4e2cc2c7cf?s=128&d=identicon&r=PG&f=1", "display_name": "agatha", "link": "https://stackoverflow.com/users/8258142/agatha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1246, "favorite_count": 0, "accepted_answer_id": 44922873, "answer_count": 1, "score": 0, "last_activity_date": 1499248541, "creation_date": 1499247133, "question_id": 44922320, "link": "https://stackoverflow.com/questions/44922320/identify-week-number-month-number-year-from-datepicker-control-in-vba-userform", "title": "Identify Week Number, Month Number, Year from DatePicker control in VBA userform", "body": "<p>I have been trying to make my user form work by getting codes everywhere. I don't have any experience in VBA so the code that I have are patches from different sources.</p>\n\n<p>I have a datepicker control in my user form and i'd like to get the corresponding week number, month number and year based on the date that is chosen from the datepicker control box and populate the corresponding textboxes for each</p>\n\n<p><a href=\"https://i.stack.imgur.com/uIRv5.png\" rel=\"nofollow noreferrer\">datepicker and textbox dependencies</a>.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 2, "creation_date": 1499247424, "post_id": 44922273, "comment_id": 76820437, "body": "Looks like your <code>Params.FileName</code> doesn&#39;t include the full path to the CSV file."}, {"owner": {"reputation": 167, "user_id": 8258123, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FofQH.jpg?s=128&g=1", "display_name": "Azog the Debugger", "link": "https://stackoverflow.com/users/8258123/azog-the-debugger"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1499247773, "post_id": 44922273, "comment_id": 76820699, "body": "That was my first thought as well, but I tried to write it directly into the method as well and got the same Error"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1499248170, "post_id": 44922273, "comment_id": 76820990, "body": "Can you <code>Debug.Print Params.FileName</code> and give me the result? The problem should be there, don&#39;t know any other way to throw that error. Also, try omitting as many parameters as possible to debug, such as <code>Params.SpecificationName</code> and <code>Params.HasFieldNames</code>"}, {"owner": {"reputation": 167, "user_id": 8258123, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FofQH.jpg?s=128&g=1", "display_name": "Azog the Debugger", "link": "https://stackoverflow.com/users/8258123/azog-the-debugger"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1499250770, "post_id": 44922273, "comment_id": 76822924, "body": "Same Result when putting it like this: DoCmd.TransferText acImportDelim, , params.TableName, params.FileName |   Debug.Print Params.FilenName:         C:\\Users\\aaa\\Desktop\\aaaviezev01.bgtvie.jc.local-Cl-20170605&zwnj;&#8203;0505.csv *  *The a&#39;s are for blurring out information"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1499251714, "post_id": 44922273, "comment_id": 76823627, "body": "There are hidden characters in your filename (if you just copy-pasted it). Copy-pasting it to the immediate window returns aaaviezev01.bgtvie.jc.local-Cl-20170605??0505. Weirdly, windows does accept renaming a file to that name (as far as I know, it shouldn&#39;t). Rename the file first, and then import it."}, {"owner": {"reputation": 167, "user_id": 8258123, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FofQH.jpg?s=128&g=1", "display_name": "Azog the Debugger", "link": "https://stackoverflow.com/users/8258123/azog-the-debugger"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1499251819, "post_id": 44922273, "comment_id": 76823691, "body": "I select the file over a file dialog, I will try renaming it and state the result later"}, {"owner": {"reputation": 167, "user_id": 8258123, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FofQH.jpg?s=128&g=1", "display_name": "Azog the Debugger", "link": "https://stackoverflow.com/users/8258123/azog-the-debugger"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1499251961, "post_id": 44922273, "comment_id": 76823784, "body": "It worked perfectly, thank you alot :)"}], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1499257985, "creation_date": 1499257985, "answer_id": 44926401, "question_id": 44922273, "link": "https://stackoverflow.com/questions/44922273/runtime-error-3011-in-access/44926401#44926401", "title": "Runtime Error 3011 in Access", "body": "<p>A more full answer:</p>\n\n<p>The filename contained non-ASCII characters. Multiple Access functions can't handle this properly. The solution is to rename any file with non-ASCII characters to something that doesn't include these characters.</p>\n\n<p>Some useful helper functions:</p>\n\n<p>Test if a string contains non-ASCII characters and return true if it does, false if it doesn't (can be used to throw descriptive errors in this case).</p>\n\n<pre><code>Public Function StringContainsNonASCII(str As String) As Boolean\n    Dim i As Integer\n    'Default is false\n    StringContainsNonASCII = False\n    'Remove question marks\n    str = Replace(str, \"?\", \"\")\n    For i = 1 To Len(str)\n        'Search for question marks\n        If Asc(Mid(str, i, 1)) = 63 Then\n            StringContainsNonASCII = True\n            Exit Function\n        End If\n    Next i\nEnd Function\n</code></pre>\n\n<p>Strip non-ASCII characters from a string</p>\n\n<pre><code>Public Function RemoveNonASCII(str As String) As String\n    Dim i As Integer\n    For i = 1 To Len(str)\n        'Append the question marks\n        If Mid(str, i, 1) = \"?\" Then\n            RemoveNonASCII = RemoveNonASCII &amp; \"?\"\n        End If\n        'Append anything that isn't a questionmark\n        If Asc(Mid(str, i, 1)) &lt;&gt; 63 Then\n            RemoveNonASCII = RemoveNonASCII &amp; Chr(Asc(Mid(str, i, 1)))\n        End If\n    Next i\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 8258123, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FofQH.jpg?s=128&g=1", "display_name": "Azog the Debugger", "link": "https://stackoverflow.com/users/8258123/azog-the-debugger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4844, "favorite_count": 0, "accepted_answer_id": 44926401, "answer_count": 1, "score": 0, "last_activity_date": 1594654327, "creation_date": 1499247028, "last_edit_date": 1594654327, "question_id": 44922273, "link": "https://stackoverflow.com/questions/44922273/runtime-error-3011-in-access", "title": "Runtime Error 3011 in Access", "body": "<p>I just try to import a .csv file with vba.\nI use the DoCmd.TransferText method with custom specs. I tried to import the file with the wizard, with the same specs and it works perfectly fine.</p>\n\n<p>But when I start the vba I get this error Message:</p>\n\n<p><a href=\"https://i.stack.imgur.com/mSRgJ.png\" rel=\"nofollow noreferrer\">Sorry, it is in german, but I think one can read the essentials</a></p>\n\n<p>Here is the part of my code, where I call up the method:</p>\n\n<pre><code>Public Function ImportFileToTable(params As ImportFileToTableParams) As ImportFileToTableResult\n    'TODO: Import a CSV File into the selected table\n    Dim result As New ImportFileToTableResult\n\n    On Error GoTo ImportFail\n    DoCmd.TransferText acImportDelim, params.SpecificationName, params.TableName, params.FileName, params.HasFieldNames\n\n    result.Success = True\n    Set ImportFileToTable = result\n    Exit Function\n\nImportFail:\n    result.Success = False\n    result.ErrorMessage = \"There was an error importing the File\"\n    Set ImportFileToTable = result\nEnd Function\n</code></pre>\n\n<p>My Database is on a Network-Drive, but I tried to copy it on my local drive and it had the same otcome. I also experimented with the File Location.</p>\n\n<p>The Software I am using is:\n    -Microsoft Access 2013</p>\n\n<p>Thank you all in adnvance :)</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 1, "creation_date": 1499250283, "post_id": 44921441, "comment_id": 76822583, "body": "One thought:  in your event handler, check to see if the name or id of the currently selected shape is the same as one stored in a global or static variable; if so, exit sub ... don&#39;t respond to the selection change. Otherwise store the name of the new selection and respond to the selection change as appropriate."}, {"owner": {"reputation": 105, "user_id": 7373202, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dcaeb3d2fe3206462b3bab3d8d4e5eb6?s=128&d=identicon&r=PG&f=1", "display_name": "Andi", "link": "https://stackoverflow.com/users/7373202/andi"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1499757037, "post_id": 44921441, "comment_id": 77029401, "body": "Thank you, that idea helped a lot. I store the string in the placeholder elements in global variables and only check the image for availability when the string (=file name) has changed. Works great!"}], "owner": {"reputation": 105, "user_id": 7373202, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dcaeb3d2fe3206462b3bab3d8d4e5eb6?s=128&d=identicon&r=PG&f=1", "display_name": "Andi", "link": "https://stackoverflow.com/users/7373202/andi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 229, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593730198, "creation_date": 1499244907, "last_edit_date": 1593730198, "question_id": 44921441, "link": "https://stackoverflow.com/questions/44921441/powerpoint-vba-event-handler", "title": "PowerPoint VBA Event Handler", "body": "<p>I am currently working on a macro that automatically imports images, charts,... into PowerPoint using VBA. To do so the file name of the image/chart that needs to be put on the slide is written in the placeholder as</p>\n\n<pre><code>&lt;filename.png&gt;\n</code></pre>\n\n<p>Whenever this text is changed by the user I want an event to be triggered that checks if the image with this name exists. If not I want to give out an error.</p>\n\n<p>Now I have a problem with the events I use. I am currently using</p>\n\n<pre><code>WindowSelectionChange\n</code></pre>\n\n<p>which activates whenever I select anything on the slide. But after clicking on a placeholder containing the &lt;...> the event is always triggered several times (at least 4 times) and I only wanted it to be triggered when the text in the placeholder is changed.\nDoes anyone have an idea how to solve this problem?</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 3017, "user_id": 7677308, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a54022f2dbc33f5b2941520aaf231b35?s=128&d=identicon&r=PG&f=1", "display_name": "SilverNak", "link": "https://stackoverflow.com/users/7677308/silvernak"}, "edited": false, "score": 3, "creation_date": 1499244754, "post_id": 44921000, "comment_id": 76818393, "body": "Where is the code?"}, {"owner": {"reputation": 3, "user_id": 8256240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b402d8c0838f1d3f49837f2ad84efd39?s=128&d=identicon&r=PG&f=1", "display_name": "A.eyo", "link": "https://stackoverflow.com/users/8256240/a-eyo"}, "reply_to_user": {"reputation": 3017, "user_id": 7677308, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a54022f2dbc33f5b2941520aaf231b35?s=128&d=identicon&r=PG&f=1", "display_name": "SilverNak", "link": "https://stackoverflow.com/users/7677308/silvernak"}, "edited": false, "score": 0, "creation_date": 1499251104, "post_id": 44921000, "comment_id": 76823172, "body": "@SilverNak i have included the code thanks in anticipation for your assistance"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1499254046, "post_id": 44921000, "comment_id": 76825194, "body": "@A.eyo - When  <code>Cell C6</code> is clicked <code>Sub AccessControl1()</code> changes the colour of <code>Cell E6</code> to <code>RGB(154, 205, 50)</code> but after that <code>Sub AccountManagement2()</code> is called and colour of <code>Cell E6</code> changes back to <code>RGB(255, 255, 255)</code> i.e. <code>White</code>. What exactly are you trying?"}, {"owner": {"reputation": 3, "user_id": 8256240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b402d8c0838f1d3f49837f2ad84efd39?s=128&d=identicon&r=PG&f=1", "display_name": "A.eyo", "link": "https://stackoverflow.com/users/8256240/a-eyo"}, "reply_to_user": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1499255614, "post_id": 44921000, "comment_id": 76826332, "body": "@Mrig yes that where am having issues.. its douing that because Accountmanager is overiding that particular cell because both accesscontrol and accountmanagement have E6 in common.. i just want when i click on C6 accesscontrol1() including the color of CellE6 to display"}, {"owner": {"reputation": 3, "user_id": 8256240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b402d8c0838f1d3f49837f2ad84efd39?s=128&d=identicon&r=PG&f=1", "display_name": "A.eyo", "link": "https://stackoverflow.com/users/8256240/a-eyo"}, "reply_to_user": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1499255722, "post_id": 44921000, "comment_id": 76826409, "body": "@Mrig is there a way you could help in tackling this issue"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1499255886, "post_id": 44921000, "comment_id": 76826521, "body": "You&#39;ll have to explain when do you want <code>Sub AccessControl1()</code>, <code>Sub AccessControl2()</code>, <code>Sub AccountManagement1()</code> and <code>Sub AccountManagement1()</code> to be executed."}, {"owner": {"reputation": 3, "user_id": 8256240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b402d8c0838f1d3f49837f2ad84efd39?s=128&d=identicon&r=PG&f=1", "display_name": "A.eyo", "link": "https://stackoverflow.com/users/8256240/a-eyo"}, "reply_to_user": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1499256316, "post_id": 44921000, "comment_id": 76826803, "body": "@Mrig you know Cell E6 is common in both Sub AccessControl1(), and Sub AccountManagement1() i would love that particular cell to display at all times when clicked on either C6 or C7"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1499256326, "post_id": 44921000, "comment_id": 76826812, "body": "So if I am right, on clicking <code>Cell E6</code> <code>Call AccessControl1</code> alone should be executed and when <code>Cell C7</code> is clicked you want <code>Call AccessControl2</code> followed by <code>AccountManagement</code> to be execute. Am I right?"}, {"owner": {"reputation": 3, "user_id": 8256240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b402d8c0838f1d3f49837f2ad84efd39?s=128&d=identicon&r=PG&f=1", "display_name": "A.eyo", "link": "https://stackoverflow.com/users/8256240/a-eyo"}, "reply_to_user": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1499256739, "post_id": 44921000, "comment_id": 76827155, "body": "@Mrig So if I am right, on clicking Cell C6 Call AccessControl1 alone should be executed and when Cell C7 is clicked you want Call AccessControl2 followed by AccountManagement1 to be execute. Am I right? \u2013 Yes you are"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1499256933, "post_id": 44921000, "comment_id": 76827301, "body": "@A.eyo - See my answer."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8256240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b402d8c0838f1d3f49837f2ad84efd39?s=128&d=identicon&r=PG&f=1", "display_name": "A.eyo", "link": "https://stackoverflow.com/users/8256240/a-eyo"}, "edited": false, "score": 0, "creation_date": 1499257396, "post_id": 44926020, "comment_id": 76827653, "body": "thank you very much but theres just this slight issue  1) when i tried to click on C6 again C7 remained constant"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 3, "user_id": 8256240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b402d8c0838f1d3f49837f2ad84efd39?s=128&d=identicon&r=PG&f=1", "display_name": "A.eyo", "link": "https://stackoverflow.com/users/8256240/a-eyo"}, "edited": false, "score": 0, "creation_date": 1499257438, "post_id": 44926020, "comment_id": 76827692, "body": "@A.eyo - What&#39;s the issue?"}, {"owner": {"reputation": 3, "user_id": 8256240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b402d8c0838f1d3f49837f2ad84efd39?s=128&d=identicon&r=PG&f=1", "display_name": "A.eyo", "link": "https://stackoverflow.com/users/8256240/a-eyo"}, "edited": false, "score": 0, "creation_date": 1499259686, "post_id": 44926020, "comment_id": 76829560, "body": "when i clicked on C6 it still did not show me the Cell E6 plus when i clicked backwards meanining ( click C6, Click C7 then click C6 again) noticed all of C7 colours where just there... normaly its suppose to return to white.. Default which is Accountmanagement2().."}, {"owner": {"reputation": 3, "user_id": 8256240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b402d8c0838f1d3f49837f2ad84efd39?s=128&d=identicon&r=PG&f=1", "display_name": "A.eyo", "link": "https://stackoverflow.com/users/8256240/a-eyo"}, "edited": false, "score": 0, "creation_date": 1499260501, "post_id": 44926020, "comment_id": 76830169, "body": "i dont know plus you know its just only two cells(C6 and C7) with 4 macros(accesscontrol1() accesscontrol2() Accountmanagement1 Accountmanagement2() Imagine having more than a hundred cells to click and a hundred * 2 Macros... whats your advice?"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 3, "user_id": 8256240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b402d8c0838f1d3f49837f2ad84efd39?s=128&d=identicon&r=PG&f=1", "display_name": "A.eyo", "link": "https://stackoverflow.com/users/8256240/a-eyo"}, "edited": false, "score": 0, "creation_date": 1499261272, "post_id": 44926020, "comment_id": 76830722, "body": "@A.eyo - Can you please explain a bit what exactly you want to do on clicking <code>Cell C6</code>, <code>Cell C7</code> and any other cell."}, {"owner": {"reputation": 3, "user_id": 8256240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b402d8c0838f1d3f49837f2ad84efd39?s=128&d=identicon&r=PG&f=1", "display_name": "A.eyo", "link": "https://stackoverflow.com/users/8256240/a-eyo"}, "edited": false, "score": 0, "creation_date": 1499262708, "post_id": 44926020, "comment_id": 76831829, "body": "Cell C6, C7, C8, C9 C10 are named respectively Accesscontrol and account manager Fire extinguisher, Intrusion Detection and Intrusion Prevention"}, {"owner": {"reputation": 3, "user_id": 8256240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b402d8c0838f1d3f49837f2ad84efd39?s=128&d=identicon&r=PG&f=1", "display_name": "A.eyo", "link": "https://stackoverflow.com/users/8256240/a-eyo"}, "edited": false, "score": 0, "creation_date": 1499263386, "post_id": 44926020, "comment_id": 76832342, "body": "@Mirag Its about Mapping i have this Cells namely Cell C6, C7, C8, C9 C10 are named respectively Accesscontrol and account manager Fire extinguisher, Intrusion Detection and Intrusion Prevention. I ham mapping them to various Companies onCell E6, G10, H11, F9 etc with names on the cells like chevron, Exonmobile, Total, Reds and greens etc.... now if i click on C6, all the companies that have thesecurity stuff will be coloured, meanining E6, G10 H11 F9 etc that is mapped to C6 will be coloured , while other companies Cells that dont have Accesscontrol will be white"}], "tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 0, "last_activity_date": 1499256917, "creation_date": 1499256917, "answer_id": 44926020, "question_id": 44921000, "link": "https://stackoverflow.com/questions/44921000/excelvba-issues-with-if-else-statement/44926020#44926020", "title": "ExcelVBA issues with IF else statement", "body": "<p>As per the comment</p>\n\n<blockquote>\n  <p>on clicking Cell C6 Call AccessControl1 alone should be executed and when Cell C7 is clicked you want Call AccessControl2 followed by AccountManagement1 to be execute. Am I right? \u2013 Yes </p>\n</blockquote>\n\n<p>Change your <code>Worksheet_SelectionChange</code> to the following:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Excel.Range)\n    If Target.Address = \"$C$6\" Then\n        Call AccessControl1\n    ElseIf Target.Address = \"$C$7\" Then\n        Call AccessControl2\n        Call AccountManagement1\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8256240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b402d8c0838f1d3f49837f2ad84efd39?s=128&d=identicon&r=PG&f=1", "display_name": "A.eyo", "link": "https://stackoverflow.com/users/8256240/a-eyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 44926020, "answer_count": 1, "score": -1, "last_activity_date": 1593677291, "creation_date": 1499243752, "last_edit_date": 1593677291, "question_id": 44921000, "link": "https://stackoverflow.com/questions/44921000/excelvba-issues-with-if-else-statement", "title": "ExcelVBA issues with IF else statement", "body": "<p>i am new to excel VBA\ni am currently working on a mapping using excel vba. the concept is if i click on cell c6 it colors the various cell boxes applicable to it same goes to cell C7. Both C6 and C7 have a common cell mapping which is cell E6 But now i noticed that when i click on Cell C6, this cell E6 doesnt show case its colour but when i click on C7 the colour on this cell E6 shows the color which means my C7 if else statement has overriden the C6 on that common cell E6 please how can i fix this so that when i click on them individually they return the color shows. \nBelow is my code:    </p>\n\n<pre><code>Sub AccessControl1()\nRange(\"C6\").Interior.Color = RGB(255, 255, 0)\nRange(\"D13\").Interior.Color = RGB(154, 205, 50)\n\nRange(\"E6\").Interior.Color = RGB(154, 205, 50)\n\nRange(\"F6\").Interior.Color = RGB(154, 205, 50)\nRange(\"AC6\").Interior.Color = RGB(154, 205, 50)\nRange(\"BH6\").Interior.Color = RGB(154, 205, 50)\nRange(\"DL7\").Interior.Color = RGB(154, 205, 50)\nRange(\"DF9\").Interior.Color = RGB(154, 205, 50)\nRange(\"DF6\").Interior.Color = RGB(255, 20, 147)\nRange(\"DA7\").Interior.Color = RGB(255, 20, 147)\nRange(\"DB23\").Interior.Color = RGB(255, 20, 147)\nRange(\"DF212\").Interior.Color = RGB(255, 20, 147)\nRange(\"DA215\").Interior.Color = RGB(255, 20, 147)\n\nEnd Sub\nSub AccessControl2()\nRange(\"C6\").Interior.Color = RGB(255, 255, 255)\nRange(\"D13\").Interior.Color = RGB(255, 255, 255)\n\nRange(\"E6\").Interior.Color = RGB(255, 255, 255)\n\nRange(\"F6\").Interior.Color = RGB(255, 255, 255)\nRange(\"AC6\").Interior.Color = RGB(255, 255, 255)\nRange(\"BH6\").Interior.Color = RGB(255, 255, 255)\nRange(\"DL7\").Interior.Color = RGB(255, 255, 255)\nRange(\"DF9\").Interior.Color = RGB(255, 255, 255)\nRange(\"DF6\").Interior.Color = RGB(255, 255, 255)\nRange(\"DA7\").Interior.Color = RGB(255, 255, 255)\nRange(\"DB23\").Interior.Color = RGB(255, 255, 255)\nRange(\"DF212\").Interior.Color = RGB(255, 255, 255)\nRange(\"DA215\").Interior.Color = RGB(255, 255, 255)\nEnd Sub\nSub AccountManagement1()\nRange(\"C7\").Interior.Color = RGB(255, 255, 0)\n\nRange(\"E6\").Interior.Color = RGB(154, 205, 50)\n\nRange(\"AE13\").Interior.Color = RGB(154, 205, 50)\nRange(\"AF6\").Interior.Color = RGB(154, 205, 50)\nRange(\"AG13\").Interior.Color = RGB(154, 205, 50)\nRange(\"AI6\").Interior.Color = RGB(154, 205, 50)\nRange(\"AJ13\").Interior.Color = RGB(154, 205, 50)\nRange(\"DA189\").Interior.Color = RGB(255, 20, 147)\nRange(\"DC195\").Interior.Color = RGB(255, 20, 147)\nRange(\"DA192\").Interior.Color = RGB(255, 20, 147)\nEnd Sub\nSub AccountManagement2()\nRange(\"C7\").Interior.Color = RGB(255, 255, 255)\n\nRange(\"AE13\").Interior.Color = RGB(255, 255, 255)\nRange(\"AF6\").Interior.Color = RGB(255, 255, 255)\n\nRange(\"E6\").Interior.Color = RGB(255, 255, 255)\n\nRange(\"AG13\").Interior.Color = RGB(255, 255, 255)\nRange(\"AI6\").Interior.Color = RGB(255, 255, 255)\nRange(\"AJ13\").Interior.Color = RGB(255, 255, 255)\nRange(\"DA189\").Interior.Color = RGB(255, 255, 255)\nRange(\"DC195\").Interior.Color = RGB(255, 255, 255)\nRange(\"DA192\").Interior.Color = RGB(255, 255, 255)\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Excel.Range)\nIf Target.Address = \"$C$6\" Then\n    Call AccessControl1\nElse\n    Call AccessControl2\nEnd If\nIf Target.Address = \"$C$7\" Then\n    Call AccountManagement1\nElse\n    Call AccountManagement2\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "performance", "excel-formula"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1499243933, "post_id": 44920998, "comment_id": 76817812, "body": "Use <code>worksheetfunction.match</code>"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 1, "creation_date": 1499244368, "post_id": 44920998, "comment_id": 76818116, "body": "Aside from the question - Is there a reason you need this (ahum) <code>BetterSearch</code> function in VBA?  You basically wrote a poorly performing version of a basic Vlookup or Index/Match."}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1499245733, "post_id": 44920998, "comment_id": 76819048, "body": "@Rik Sportel, I need it because Vlookup has a maximum number of symbols it takes in and looks for, while my funtion doesn&#39;t have that flaw. And I said in the question, betterSearch executes <b>fast</b> when I call it myself! The real problem is why it slows down in the macros."}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1499247497, "post_id": 44920998, "comment_id": 76820486, "body": "Check the time it needs to open the workbooks only."}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "reply_to_user": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1499249719, "post_id": 44920998, "comment_id": 76822158, "body": "@UGP, It&#39;s relatively small. I have GUI that tells me when each operation starts, the look up of values consumes most of the time."}], "answers": [{"comments": [{"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 1, "creation_date": 1499245810, "post_id": 44921410, "comment_id": 76819120, "body": "Thank you for response. But I still want to know why the results of the same function <b>differ</b>, the question was about that, not about optimizing the function."}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1499687098, "post_id": 44921410, "comment_id": 76995687, "body": "I decided to follow your advice on optimizing my function, but, unfortunatelly, your code gives a <code>type mismatch</code> error on the <code>Set FndRng...</code> line..."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1499244846, "creation_date": 1499244846, "answer_id": 44921410, "question_id": 44920998, "link": "https://stackoverflow.com/questions/44920998/difference-in-function-performance-between-calling-manually-or-through-mac/44921410#44921410", "title": "Difference in function performance between calling manually (&#39;=&#39;) or through macros", "body": "<p>You can use the <code>Find</code> function, and use the <code>MatchCase:=False</code> so it will be case-insensitive.</p>\n\n<p>It will be much faster than looping through your Column.</p>\n\n<p><strong>Code</strong> </p>\n\n<pre><code>Function betterSearch(searchCell As Range, aCol As Range, bCol As Range) As String\n\n    Dim FndRng  As Range\n\n    Set FndRng = aCol.Find(what:=LCase(searchCell.Value), LookIn:=xlValues, lookat:=xlWhole, _\n                            searchorder:=xlRows, searchdirection:=xlNext, MatchCase:=False)\n    If Not FndRng Is Nothing Then ' Find was successful\n        betterSearch = bCol.Cells(FndRng.Row, 1)\n    Else\n        betterSearch = \"Not found\"\n    End If\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1499670365, "post_id": 44922243, "comment_id": 76984901, "body": "Thank you. Tour answer really helped. I created <code>Range</code> variables and replaced <code>Range(&quot;I:I&quot;)</code> with <code>Range(&quot;I2:I1200&quot;)</code>. The performance improved greatly. However, it&#39;s still much slower than it would have been if I manually recakculated each value... I wonder if there is something else that could be done?"}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1499673636, "post_id": 44922243, "comment_id": 76986738, "body": "It looks rather suspicious - when I lookup only 5-10 values it goes super fast, while increasing the number of lookup values seem to increase the required time exponentially."}], "tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1499246957, "creation_date": 1499246957, "answer_id": 44922243, "question_id": 44920998, "link": "https://stackoverflow.com/questions/44920998/difference-in-function-performance-between-calling-manually-or-through-mac/44922243#44922243", "title": "Difference in function performance between calling manually (&#39;=&#39;) or through macros", "body": "<p>Probably has something to do with using entire column ranges. <br>I think when calling the function from a macro you are forcing Excel to transfer a million values to VBA for each full column reference (transferring data from Excel to VBA is very slow). <br>When calling the function from the worksheet you are only transferring a range object which you then loop on cell by cell so the amount of data transferred to VBA is probably hundreds of thousands times less (depending how far down the range you have to go to find a match).</p>\n\n<p>Try Setting range variables in your macro for the full column references and then passing the range variables instead of Range(I:I) to BetterSearch</p>\n"}, {"tags": [], "owner": {"reputation": 128, "user_id": 4982363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/375a52e3176382bd3fa9e2229b959f2c?s=128&d=identicon&r=PG&f=1", "display_name": "Stiebl", "link": "https://stackoverflow.com/users/4982363/stiebl"}, "is_accepted": false, "score": 0, "last_activity_date": 1547758521, "creation_date": 1547758521, "answer_id": 54244136, "question_id": 44920998, "link": "https://stackoverflow.com/questions/44920998/difference-in-function-performance-between-calling-manually-or-through-mac/54244136#54244136", "title": "Difference in function performance between calling manually (&#39;=&#39;) or through macros", "body": "<p>The reason is, because you loop through the cells of a range in a macro. This is terribly slow in comparison to arrays. \nEach cell.value call is slowing down. In Excel itselfe this slowdown is not so much because the Range objects are objects of the application itselfe.</p>\n\n<p>It is slower to pass all needed data at once from the Application to VBA than to pass many times only little data.</p>\n\n<p>If you rewrite your code litte bit it will be fast idependent from where you call it.</p>\n\n<p>First store the searchValue in a variable. So you dont need to evaluate the formula for every single call. In your code the search value is evaluated for every comparison but this makes no sence because it will not change.</p>\n\n<p>Second store the values of the aCol Range in an variant array. This is done once very fast for the whole column. After that you can compare every single value in the column really fast (faster than the Find or Match function <a href=\"https://fastexcel.wordpress.com/2011/10/26/match-vs-find-vs-variant-array-vba-performance-shootout/\" rel=\"nofollow noreferrer\">Performance comparison of Find / Match / Variant-Array</a>)</p>\n\n<p>Here is your changed code </p>\n\n<pre><code>Function betterSearch(searchCell As Range, aCol As Range, bCol As Range)\n    Dim searchVal as String\n    Dim colVals() as Variant\n    Dim r as Long\n    searchVal = LCase(searchCell.Value)\n    colVals = aCol.Value    ' Read data of whole column only once\n    For r = 1 to Ubound(colVals,1)\n        If LCase(colVals(r,1)) = searchVal Then\n                betterSearch = bCol.Cells(r, 1)\n                Exit For\n        End If\n        betterSearch = \"Not found\"\n    Next \nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1258, "favorite_count": 0, "accepted_answer_id": 44922243, "answer_count": 3, "score": 1, "last_activity_date": 1555543714, "creation_date": 1499243748, "last_edit_date": 1555543714, "question_id": 44920998, "link": "https://stackoverflow.com/questions/44920998/difference-in-function-performance-between-calling-manually-or-through-mac", "title": "Difference in function performance between calling manually (&#39;=&#39;) or through macros", "body": "<p>I wrote a lookup function. Its performance differs <strong>dramatically</strong> depending whether or not I call it by hand on worksheet itself <strong>(through '=')</strong> or through <strong>macros</strong>.</p>\n\n<p>My macro does the following:</p>\n\n<pre><code>Function betterSearch(searchCell As Range, aCol As Range, bCol As Range)\n    For Each cell In aCol\n        If LCase(cell.Value) = LCase(searchCell.Value) Then\n            betterSearch = bCol.Cells(cell.row, 1)\n            Exit For\n        End If\n        betterSearch = \"Not found\"\n    Next\nEnd Function\n</code></pre>\n\n<p>The macro opens resultsWorkbook and dataWorkbook and then performs a search of the four values in column A from resultWorkbook in dataWorkbook and returns corresponding data from some other column of dataWorkbook.</p>\n\n<pre><code>'...opening resultWorkbook and dataWorkbook\nFor aRow = 6 To 9\n    resultWorkbook.Worksheets(\"B3\").Cells(aRow, 125).Value = _\n            betterSearch(resultWorkbook.Worksheets(\"B3\").Cells(aRow, 1) _\n            , dataWorkbook.Worksheets(\"page 1\").Range(\"A:A\") _\n            , dataWorkbook.Worksheets(\"page 1\").Range(\"Z:Z\"))\n\n         resultWorkbook.Worksheets(\"B3\").Cells(aRow, 126).Value = _\n            betterSearch(resultWorkbook.Worksheets(\"B3\").Cells(aRow, 1) _\n            , dataWorkbook.Worksheets(\"page 1\").Range(\"A:A\") _\n            , dataWorkbook.Worksheets(\"page 1\").Range(\"I:I\"))\nNext aRow\n</code></pre>\n\n<p>It's really slow - takes <strong>minutes</strong> for 1 file. But when I open that file manually and type in the formula and hit Enter it calculates <strong>instantly</strong> (so in that regard my function <strong>doesn't need</strong> optimizing - it already calculates <strong>fast</strong> but just in the worksheet, not inside the macros).</p>\n\n<p>I'm <strong>not looking</strong> to optimize the function. I want to <em>understand</em> <strong>why</strong> this difference in performance happens. I have <code>Application.Calculation = xlCalculationManual</code> both for the main application and invisible application that runs along and does all the work:  <code>ExcelApp.Calculation = xlCalculationManual</code> and it seems to be changing the workbooks' states to manual but the slow performance is there as if the workbooks were still automatic.</p>\n"}]