[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1515628921, "post_id": 48197793, "comment_id": 83377086, "body": "Your code hid my sheets in the copy."}, {"owner": {"reputation": 23, "user_id": 6814859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7249c38794074f9244f7547990211a9?s=128&d=identicon&r=PG&f=1", "display_name": "AlivePresumably", "link": "https://stackoverflow.com/users/6814859/alivepresumably"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1515629003, "post_id": 48197793, "comment_id": 83377116, "body": "Hm. Definitely unhidden on mine. I&#39;ve ran it a few times, and each time once I open it back up the first sheet is unhidden."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1515629121, "post_id": 48197793, "comment_id": 83377156, "body": "Try being explicit with the workbook, instead of using <code>ActiveWindow</code>, or just <code>Sheets(i)</code>.  Without that, <code>Sheets()</code> will refer to whatever workbook is open, which may not be the one you&#39;re expecting."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1515629387, "post_id": 48197793, "comment_id": 83377232, "body": "<code>False</code> is not an explicitly correct value for the <code>Visible</code> property. Try <code>xlSheetHidden</code> or <code>xlSheetVeryHidden</code>. Why do you select the sheets and then hide them in a group? Since you already address each one, just set each one&#39;s <code>Visible</code> property."}, {"owner": {"reputation": 23, "user_id": 6814859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7249c38794074f9244f7547990211a9?s=128&d=identicon&r=PG&f=1", "display_name": "AlivePresumably", "link": "https://stackoverflow.com/users/6814859/alivepresumably"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1515630825, "post_id": 48197793, "comment_id": 83377629, "body": "@BruceWayne Changing to explicit references here (provided I touched all my bases as seen in the edit above) unfortunately didn&#39;t work. Variatus: K. Davis was able to provide me with a working answer for what I have, but I will try that, thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6814859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7249c38794074f9244f7547990211a9?s=128&d=identicon&r=PG&f=1", "display_name": "AlivePresumably", "link": "https://stackoverflow.com/users/6814859/alivepresumably"}, "edited": false, "score": 2, "creation_date": 1515630688, "post_id": 48198067, "comment_id": 83377596, "body": "Ha, success! Perfect! Thank you, and everyone else, who took time out of their day to help me!"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 2, "last_activity_date": 1515629492, "creation_date": 1515629492, "answer_id": 48198067, "question_id": 48197793, "link": "https://stackoverflow.com/questions/48197793/when-saving-a-copy-of-a-workbook-sheet-becomes-unhidden/48198067#48198067", "title": "When saving a copy of a workbook, sheet becomes unhidden", "body": "<p>The reason this happens is due to your <code>sheets.copy</code> selecting the <em>hidden</em> sheet1. I modified your code to activate the last sheet # in your workbook after you copy your sheets.</p>\n\n<pre><code>Sub MyVBA()\n\n    Dim ws As Worksheet, i As Long\n    Dim wsName As Variant\n\n    'The string in quotes is what name the report should save and email as.\n    wsName = \"My Workbook - \"\n\n    ActiveWorkbook.Save\n\n    'Saves a master copy\n    'Name the first and last of the backend sheets you want to hide before saving a master. It will hide everything in between.\n\n    Dim LastSht As Long\n    LastSht = ThisWorkbook.Sheets.Count\n\n    For i = Sheets(\"Sheet1\").Index To Sheets(\"Sheet5\").Index\n        Sheets(i).Select Replace:=False\n    Next i\n    ActiveWindow.SelectedSheets.Visible = False\n\n    ThisWorkbook.Sheets.Copy\n    Sheets(LastSht).Activate\n    With ActiveWorkbook\n        .SaveAs ThisWorkbook.path &amp; \"\\\" &amp; wsName &amp; Format(Date, \"yyyy-mm-dd\") &amp; \".xlsx\", FileFormat:=51\n        .Close\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6814859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7249c38794074f9244f7547990211a9?s=128&d=identicon&r=PG&f=1", "display_name": "AlivePresumably", "link": "https://stackoverflow.com/users/6814859/alivepresumably"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 48198067, "answer_count": 1, "score": 2, "last_activity_date": 1515634076, "creation_date": 1515627328, "last_edit_date": 1515634076, "question_id": 48197793, "link": "https://stackoverflow.com/questions/48197793/when-saving-a-copy-of-a-workbook-sheet-becomes-unhidden", "title": "When saving a copy of a workbook, sheet becomes unhidden", "body": "<p>I am saving a copy of a workbook as a non-macro enabled workbook with some of the backend sheets hidden. I prefer to keep the backend sheets in the workbook for record keeping. </p>\n\n<p>The first sheet in the workbook is one of the hidden sheets, here named \"Sheet1\". For some reason, when I open a copy of the newly saved workbook, it's not hidden anymore. I can even see that it was correctly hidden after the VBA saves if I add a breakpoint between saving and closing.</p>\n\n<p>Any help with figuring this out is appreciated!</p>\n\n<pre><code>Sub MyVBA()\n\n        Dim ws As Worksheet\n        Dim wsName As Variant\n\n        'The string in quotes is what name the report should save and email as.\n        wsName = \"My Workbook - \"\n\n            ActiveWorkbook.Save\n\n            'Saves a master copy\n            'Name the first and last of the backend sheets you want to hide before saving a master. It will hide everything in between.\n                For i = Sheets(\"Sheet1\").Index To Sheets(\"Sheet5\").Index\n                    Sheets(i).Select Replace:=False\n                Next i\n                ActiveWindow.SelectedSheets.Visible = False\n\n            ThisWorkbook.Sheets.Copy\n            With ActiveWorkbook\n                .SaveAs ThisWorkbook.Path &amp; \"\\\" &amp; wsName &amp; Format(Date, \"yyyy-mm-dd\") &amp; \".xlsx\", FileFormat:=51\n                .Close\n            End With\n\n    End Sub\n</code></pre>\n\n<p><strong><em>EDIT:</em></strong></p>\n\n<p>I tested it out with explicit references, and I'm getting the same issue.</p>\n\n<pre><code>            For i = Sheets(\"Data\").Index To Sheets(\"Key\").Index\n                Sheets(i).Select Replace:=False\n            Next i\n            Workbooks(\"Test.xlsm\").Windows(1).SelectedSheets.Visible = False\n\n        Workbooks(\"Test.xlsm\").Sheets.Copy\n        With ActiveWorkbook\n            .SaveAs Workbooks(\"Test.xlsm\").Path &amp; \"\\\" &amp; wsName &amp; Format(Date, \"yyyy-mm-dd\") &amp; \".xlsx\", FileFormat:=51\n            .Close\n        End With\n</code></pre>\n"}, {"tags": ["windows", "vba", "vbscript"], "comments": [{"owner": {"reputation": 532, "user_id": 8994815, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/8994815/acatinlove"}, "edited": false, "score": 0, "creation_date": 1515628911, "post_id": 48197598, "comment_id": 83377082, "body": "<code>CreateObject(&quot;Wscript.Shell&quot;).Run &quot;explorer.exe \\\\127.0.0.1&quot;</code>"}, {"owner": {"reputation": 91, "user_id": 6003207, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e4f2597a46fb264edcaff707f3ac86d9?s=128&d=identicon&r=PG&f=1", "display_name": "Sn_Srm", "link": "https://stackoverflow.com/users/6003207/sn-srm"}, "reply_to_user": {"reputation": 532, "user_id": 8994815, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/8994815/acatinlove"}, "edited": false, "score": 0, "creation_date": 1515632972, "post_id": 48197598, "comment_id": 83378161, "body": "Sorry if I wasn&#39;t being too clear before, I want to open the sharepoint library in the windows explorer as view as a list of folders"}, {"owner": {"reputation": 532, "user_id": 8994815, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/8994815/acatinlove"}, "edited": false, "score": 0, "creation_date": 1515639574, "post_id": 48197598, "comment_id": 83379543, "body": "Put your URL in instead."}], "owner": {"reputation": 91, "user_id": 6003207, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e4f2597a46fb264edcaff707f3ac86d9?s=128&d=identicon&r=PG&f=1", "display_name": "Sn_Srm", "link": "https://stackoverflow.com/users/6003207/sn-srm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 216, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515632924, "creation_date": 1515625849, "last_edit_date": 1515632924, "question_id": 48197598, "link": "https://stackoverflow.com/questions/48197598/is-it-possible-to-programmatically-open-share-point-library-in-explorer-view-usi", "title": "Is it possible to programmatically open share point library in explorer view using vbscript / vba? If yes, how?", "body": "<p>I can open IE object with VB script and navigate to the sharepoint URL and open it in the web view but I want to automate viewing the sharepoint library in the windows explorer view (as a list of folders) using the UNC path with VBscript/VBA and I am not sure how to approach it.</p>\n"}, {"tags": ["vba", "excel", "ribbon"], "comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 1, "creation_date": 1515656692, "post_id": 48197573, "comment_id": 83384951, "body": "Have a look at the <code>InvalidateControl</code> method: <a href=\"https://msdn.microsoft.com/en-us/vba/office-shared-vba/articles/iribbonui-invalidatecontrol-method-office\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/office-shared-vba/articles/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2682, "user_id": 9059424, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ez4b8InqhCI/AAAAAAAAAAI/AAAAAAAAAWE/IY8n6L2OBQk/photo.jpg?sz=128", "display_name": "aduguid", "link": "https://stackoverflow.com/users/9059424/aduguid"}, "is_accepted": true, "score": 3, "last_activity_date": 1516373633, "last_edit_date": 1516373633, "creation_date": 1515752975, "answer_id": 48224306, "question_id": 48197573, "link": "https://stackoverflow.com/questions/48197573/disable-ribbon-button-in-excel/48224306#48224306", "title": "Disable Ribbon button in Excel", "body": "<p>You have to invalidate the control to change the visibility or enabled properties.</p>\n\n<pre><code>Public calcState As Boolean\n\nDim MyRibbon As IRibbonUI\n\nSub ToggleCalcClicked(control As IRibbonControl, pressed As Boolean)\n\n  calcState = Not calcState\n  Worksheets(\"Setup\").Range(\"L47\").Value = calcState\n\n  ChangeCalcState\n  MyRibbon.InvalidateControl(\"ButtonCalc\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4335025, "user_type": "registered", "profile_image": "https://graph.facebook.com/1236528296/picture?type=large", "display_name": "Chris Shaw", "link": "https://stackoverflow.com/users/4335025/chris-shaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1963, "favorite_count": 0, "accepted_answer_id": 48224306, "answer_count": 1, "score": 2, "last_activity_date": 1516373633, "creation_date": 1515625694, "question_id": 48197573, "link": "https://stackoverflow.com/questions/48197573/disable-ribbon-button-in-excel", "title": "Disable Ribbon button in Excel", "body": "<p>I'm trying to make it so that a custom button is disabled depending on the toggle state of another custom button on the Excel ribbon. I have a button defined in my ribbons' XML as follows:</p>\n\n<pre><code>&lt;button id=\"ButtonCalc\" label=\"Re-Calculate\" size=\"large\" onAction=\"calc\" image=\"Calculate\" getEnabled=\"disableRefresh\"/&gt;\n</code></pre>\n\n<p>The call-back for the getEnabled tag is:</p>\n\n<pre><code>'Callback for ButtonCalc getEnabled\nSub disableRefresh(control As IRibbonControl, ByRef enabled)\n\nIf calcState Then\n\n    enabled = True\n\nElse\n    enabled = False\n\nEnd If\nEnd Sub\n</code></pre>\n\n<p>The term \"calcstate\" is a boolean operation controlled by the toggle button:</p>\n\n<pre><code>&lt;toggleButton id=\"ButtonMode\" label=\"Light Mode\" size=\"large\" onAction=\"ToggleCalcClicked\" image=\"Mode\" getPressed=\"checkLight\"/&gt;\n</code></pre>\n\n<p>VBA for this part:</p>\n\n<pre><code>Public calcState As Boolean\n\nDim MyRibbon As IRibbonUI\n\nSub ToggleCalcClicked(control As IRibbonControl, pressed As Boolean)\n\ncalcState = Not calcState\nWorksheets(\"Setup\").Range(\"L47\").Value = calcState\n\nCall ChangeCalcState\n\nEnd Sub\n</code></pre>\n\n<p>Everything works, except the button for Re-calculate is permanently disabled. What have I done wrong?</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 6686, "user_id": 9086466, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JI5yN.png?s=128&g=1", "display_name": "Ctznkane525", "link": "https://stackoverflow.com/users/9086466/ctznkane525"}, "edited": false, "score": 0, "creation_date": 1515625861, "post_id": 48197544, "comment_id": 83376248, "body": "Your y calculation looks odd...can u explain"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1515626946, "post_id": 48197544, "comment_id": 83376572, "body": "Comment out the <code>On Error Resume Next</code> and see where the real errors are"}, {"owner": {"reputation": 11, "user_id": 9201070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9dcefa6e22b7e54fd9bc9f9956dc74?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott James Burton", "link": "https://stackoverflow.com/users/9201070/elliott-james-burton"}, "edited": false, "score": 0, "creation_date": 1515632191, "post_id": 48197544, "comment_id": 83377980, "body": "Ctznkane25- The y variable gives a new row on each day an email is sent. There is probably an easier way to do it. It the case above it is 5, tomorrow it will be 6."}, {"owner": {"reputation": 11, "user_id": 9201070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9dcefa6e22b7e54fd9bc9f9956dc74?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott James Burton", "link": "https://stackoverflow.com/users/9201070/elliott-james-burton"}, "edited": false, "score": 0, "creation_date": 1515632230, "post_id": 48197544, "comment_id": 83377989, "body": "Tim Williams- Good idea, I will try that 1st thing tomorrow."}], "answers": [{"comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1515988023, "post_id": 48202564, "comment_id": 83496022, "body": "@ElliottJamesBurton if this was helpful please mark the answer- thanks"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1515659901, "last_edit_date": 1515659901, "creation_date": 1515658936, "answer_id": 48202564, "question_id": 48197544, "link": "https://stackoverflow.com/questions/48197544/determine-value-of-cell-in-excel-from-outlook/48202564#48202564", "title": "Determine value of cell in Excel from Outlook", "body": "<p><em>To simply check if cell value is empty from Outlook, you can use <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/isempty-function\" rel=\"nofollow noreferrer\"><strong>IsEmpty Function</strong></a></em></p>\n\n<pre><code>Set rCell = Sht.Range(\"A1\")\nIf Not IsEmpty(rCell.value) Then\n    Debug.Print rCell.value\nEnd If\n</code></pre>\n\n<p><em>Or another Example to Avoid Empty Spaces</em></p>\n\n<pre><code>Set rCell = Sht.Range(\"A1\")\nIf Not Len(Trim(rCell.value)) = 0 Then\n    Debug.Print rCell.value\nEnd If\n</code></pre>\n\n<p><em>Here is full Example from Outlook that will open Excel file or reopen Excel file</em></p>\n\n<pre><code>Option Explicit\nPublic Sub Example()\n    Dim xlApp As Excel.Application\n    Dim Book As Excel.Workbook\n    Dim Sht As Excel.Worksheet\n    Dim xlStarted As Boolean\n    Dim FilePath As String\n    Dim rCell As Range\n\n'   // File Path\n    FilePath = \"C:\\Temp\\Book1.xlsm\"\n\n    On Error Resume Next\n    Set xlApp = GetObject(, \"Excel.Application\")\n    If Err &lt;&gt; 0 Then\n        Set xlApp = New Excel.Application\n            xlStarted = True\n    End If\n    On Error GoTo 0\n\n'   // Open Workbook, Sheet1 to get data\n    Set Book = xlApp.Workbooks.Open(FilePath)\n    Set Sht = Book.Sheets(\"Sheet1\")\n\n'   // Set range variable\n    Set rCell = Sht.Range(\"A1\")\n    If Not Len(Trim(rCell.value)) = 0 Then\n        Debug.Print rCell.value ' Immediate Window\n    End If\n\n    Set rCell = Sht.Range(\"A1\")\n    If Not IsEmpty(rCell.value) Then\n        Debug.Print rCell.value ' Immediate Window\n    End If\n\n'   // Close &amp; SaveChanges\n    Book.Close SaveChanges:=True\n    If xlStarted Then\n        xlApp.Quit\n    End If\n\n    Set xlApp = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9201070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9dcefa6e22b7e54fd9bc9f9956dc74?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott James Burton", "link": "https://stackoverflow.com/users/9201070/elliott-james-burton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 710, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593154784, "creation_date": 1515625584, "last_edit_date": 1593154784, "question_id": 48197544, "link": "https://stackoverflow.com/questions/48197544/determine-value-of-cell-in-excel-from-outlook", "title": "Determine value of cell in Excel from Outlook", "body": "<p>I am using Outlook VBA to find if a cell is empty on an Excel sheet.</p>\n\n<p>The code will write content from email in the cells but fails to register any values in the cell.</p>\n\n<p>After the normal Outlook VBA setup with MAPI etc., the code is:   </p>\n\n<pre><code>Dim xlapp As Excel.Application\nDim xlwb As Excel.Workbook\nDim xlws As Excel.Worksheet\nDim x, y As Long          \nDim Iscellempty As Boolean\nDim Budapest As Range\nIscellempty = False\n</code></pre>\n\n<p>This opens the file but will not reopen if open already</p>\n\n<pre><code>Set xlapp = GetObject(, \"excel.application\")\nOn Error Resume Next        \nSet xlwb = xlapp.Workbooks(\"Excel test.xlsm\")    \nIf xlwb Is Nothing Then      \n    xlapp.Workbooks.Open (\"U:\\Workarea\\Automation Tool\\AmendCancel report\\Excel test.xlsm\")      \n    Set xlwb = xlapp.Workbooks(\"Excel test.xlsm\")\n   Else   \nEnd If\n\nSet xlws = xlwb.Sheets(1)    \nIf xlwb Is Nothing Then\n    MsgBox \"Required file is not available\"\nEnd If\n\nx = 2\ny = CLng(Date) - 43105\n</code></pre>\n\n<p>This next part is the issue. When hovering the cursor over 'Budapest' it will always say 'Nothing' (and it fails to say anything at all when adding .value</p>\n\n<pre><code>Set Budapest = xlws.Cells(y, 3)\nDo\nWith xlwb.Worksheets(1) etc....\n</code></pre>\n\n<p>The If statement following this fails to trigger giving the same output regardless of the cell being empty or not.</p>\n"}, {"tags": ["vba", "excel", "messagebox"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 2, "creation_date": 1515623751, "post_id": 48197181, "comment_id": 83375464, "body": "You get the respond by <code>Answer = MsgBox(...)</code>."}, {"owner": {"reputation": 39, "user_id": 9034763, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/133453167341658/picture?type=large", "display_name": "Tom Stone", "link": "https://stackoverflow.com/users/9034763/tom-stone"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1515624413, "post_id": 48197181, "comment_id": 83375713, "body": "Where would I put that?"}], "answers": [{"comments": [{"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1515625155, "post_id": 48197402, "comment_id": 83375989, "body": "correct!  That is what you get for looking at one screen and typing in another."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515625182, "post_id": 48197402, "comment_id": 83376003, "body": "take @YowE3K&#39;s advice.  He is much better than I."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515625770, "post_id": 48197402, "comment_id": 83376211, "body": "I guess I should point out that there was nothing particularly wrong with <code>Dim Answer As Integer</code> (all the enum values are below 7, so it would happily convert the <code>MsgBox</code> result to an integer), but using the correct enum type allows Intellisense to work better - i.e. when you start typing the line of code <code>If Answer = </code> then it will prompt you with all the valid values to choose from."}, {"owner": {"reputation": 39, "user_id": 9034763, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/133453167341658/picture?type=large", "display_name": "Tom Stone", "link": "https://stackoverflow.com/users/9034763/tom-stone"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515626647, "post_id": 48197402, "comment_id": 83376485, "body": "@YowE3K Just to make sure that I have this correct; because I used it as an integer, I should have it checked as the numerical value of vbYes (6), instead of simply vbYes?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 39, "user_id": 9034763, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/133453167341658/picture?type=large", "display_name": "Tom Stone", "link": "https://stackoverflow.com/users/9034763/tom-stone"}, "edited": false, "score": 1, "creation_date": 1515629754, "post_id": 48197402, "comment_id": 83377346, "body": "@TomStone No, <code>vbYes</code> is an enum value which has a value of 6.  So you can compare the enum value with the integer value quite happily, VBA will do a type conversion as required.  So <code>Answer = 6</code> will be the same as <code>Answer = vbYes</code>.  It&#39;s just that, if you declare <code>Answer</code> as a <code>VbMsgBoxResult</code> then Intellisense makes your work easier for you when you are typing your code - it will let you select the <code>vbYes</code> from a list rather than having to manually type it (as you undoubtedly had to do when you declared <code>Answer</code> as <code>Integer</code>).  And using the correct type helps prevent other coding mistakes."}], "tags": [], "owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "is_accepted": false, "score": 1, "last_activity_date": 1515625334, "last_edit_date": 1515625334, "creation_date": 1515624785, "answer_id": 48197402, "question_id": 48197181, "link": "https://stackoverflow.com/questions/48197181/message-box-answer-being-ignored/48197402#48197402", "title": "Message Box Answer Being Ignored?", "body": "<p>Here are the two pieces tripping you up.\nAt the top during declarations.</p>\n\n<pre><code>Dim answer As VbMsgBoxResult\n</code></pre>\n\n<p>When you go to query the user for an answer:</p>\n\n<pre><code>answer = MsgBox (\"Would you like to Print a Compact Version of this Estimate?\", vbYesNo, \"Print Dialogue\")\n</code></pre>\n\n<p>Then run your code based on </p>\n\n<pre><code>If answer = vbYes Then\n'your code for yes\nElse 'assumes it was no.\n'your code for no\nEnd if\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 9034763, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/133453167341658/picture?type=large", "display_name": "Tom Stone", "link": "https://stackoverflow.com/users/9034763/tom-stone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1515651105, "creation_date": 1515623530, "last_edit_date": 1515651105, "question_id": 48197181, "link": "https://stackoverflow.com/questions/48197181/message-box-answer-being-ignored", "title": "Message Box Answer Being Ignored?", "body": "<p>I have an ActiveX command box that is supposed to print a report. Users are given the option to print a compact version. If yes, the code is supposed to hide some rows and set a sheet to Portrait orientation. If no, the report is printed using the defaults of the sheets.</p>\n\n<p>As of now, no matter what you click, the full report is printed using the defaults of the sheets, instead of the coded parameters. How can I fix this?</p>\n\n<pre><code>Private Sub SummarizedReport_Click()\n\nApplication.ScreenUpdating = False\n\nDim Answer As Integer\n\nActiveWorkbook.Unprotect\n\n\nMsgBox \"Would you like to Print a Compact Version of this Estimate?\", vbYesNo + vbQuestion, \"Print Dialogue\"\n\n    If Answer = vbYes Then\n\n        Worksheets(\"SUMMARY\").Unprotect\n        Worksheets(\"SUMMARY\").Rows(\"F:I\").Hidden = True\n        Worksheets(\"SUMMARY\").PageSetup.Orientation = xlPortrait\n        Worksheets(\"SUMMARY\").PageSetup.PaperSize = xlPaperLetter\n\nSheets(\"Cover Page\").Visible = -1\n\nActiveWorkbook.Sheets(Array(\"Cover Page\", \"SUMMARY\")).Select\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, IgnorePrintAreas:=False, OpenAfterPublish:=True\n\n        Sheets(\"Cover Page\").Visible = 2\n\n    Sheets(\"SUMMARY\").Rows(\"F:I\").Hidden = False\n    Sheets(\"SUMMARY\").Protect\n\n\n    Else\n\n        Sheets(\"Cover Page\").Visible = -1\n\nActiveWorkbook.Sheets(Array(\"Cover Page\", \"SUMMARY\")).Select\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=True\n\n        Sheets(\"Cover Page\").Visible = 2\n\n    End If\n\nActiveWorkbook.Protect\n\nWorksheets(\"Control\").Activate\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "for-loop"], "comments": [{"owner": {"reputation": 248, "user_id": 8131936, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/a969359221040fb8213ff372360018f4?s=128&d=identicon&r=PG&f=1", "display_name": "Salek", "link": "https://stackoverflow.com/users/8131936/salek"}, "edited": false, "score": 0, "creation_date": 1515619853, "post_id": 48196308, "comment_id": 83373782, "body": "didnt you try to copy data via VB, not setting a formula? like     &#39;Sheet2.Cells(1 +ii, 1) = Sheet1.Cells(r,c)&#39; having Sheets 1 and 2 as worksheer, r for row and c for column?"}, {"owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 0, "creation_date": 1515622690, "post_id": 48196308, "comment_id": 83375054, "body": "Can we assume that (1) there is no whitespace between values within the rows, (2) there are no empty rows, and (3) all info starts in column A for each row that has data?"}, {"owner": {"reputation": 3, "user_id": 9200659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0cebbe48f50f08bdf23d2d4dbda8909?s=128&d=identicon&r=PG&f=1", "display_name": "Cormac", "link": "https://stackoverflow.com/users/9200659/cormac"}, "reply_to_user": {"reputation": 248, "user_id": 8131936, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/a969359221040fb8213ff372360018f4?s=128&d=identicon&r=PG&f=1", "display_name": "Salek", "link": "https://stackoverflow.com/users/8131936/salek"}, "edited": false, "score": 0, "creation_date": 1515664656, "post_id": 48196308, "comment_id": 83389355, "body": "@Salek yes this is one option but as stated in the queston ideally I would like the links present."}, {"owner": {"reputation": 3, "user_id": 9200659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0cebbe48f50f08bdf23d2d4dbda8909?s=128&d=identicon&r=PG&f=1", "display_name": "Cormac", "link": "https://stackoverflow.com/users/9200659/cormac"}, "reply_to_user": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 0, "creation_date": 1515664784, "post_id": 48196308, "comment_id": 83389455, "body": "@Taelsin (1) yes there&#39;s no whitespace between values in the rows(but I don&#39;t see how this would affect the script)(2) There&#39;s no empty rows(Again don&#39;t see what bearing this would have)(3)Info starts from coloumn H but can easily adjust to this by altering the I value in the script above"}, {"owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 0, "creation_date": 1515699041, "post_id": 48196308, "comment_id": 83410774, "body": "@Cormac They&#39;re mostly used for a stop condition when doing what chillin suggested as a more efficient solution in his answer. If the data is packed nicely (whitespace only at the end of rows and columns) then you can use empty cells as a signal to move on to the next row."}], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1515627469, "post_id": 48197047, "comment_id": 83376715, "body": "Which Excel version is that?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1515638154, "post_id": 48197047, "comment_id": 83379238, "body": "@pnuts your correct friend - But OP is asking to <b>create a VBA script to achieve this</b>"}, {"owner": {"reputation": 3, "user_id": 9200659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0cebbe48f50f08bdf23d2d4dbda8909?s=128&d=identicon&r=PG&f=1", "display_name": "Cormac", "link": "https://stackoverflow.com/users/9200659/cormac"}, "edited": false, "score": 0, "creation_date": 1515664922, "post_id": 48197047, "comment_id": 83389550, "body": "@sam Yes I don&#39;t &quot;need&quot; to use VBA but doing it this way would be quite labour intensive as this task will be repeated regularly and I&#39;m dealing with data sets on the scale of hundreds of rows so the more I can automate the process the better"}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1515622823, "creation_date": 1515622823, "answer_id": 48197047, "question_id": 48196308, "link": "https://stackoverflow.com/questions/48196308/how-do-i-get-a-function-in-excel-to-stack-data-arranged-across-in-several-rows-t/48197047#48197047", "title": "How do I get a function in excel to stack data arranged across in several rows to stack in a single coloumn on another worksheet", "body": "<p>You don't need VBA for this. You can do it with a few clicks. Do like this:  </p>\n\n<ol>\n<li>Select the data range</li>\n<li>Go to the Data tab and click <em>From Table/Range</em></li>\n<li>Ok the range</li>\n<li>In the new window that opens, select all columns</li>\n<li>Go to the Transform tab</li>\n<li>Click <em>Unpivot columns</em></li>\n<li>Back to the Home tab and click <em>Close and load</em></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": true, "score": 1, "last_activity_date": 1515628700, "last_edit_date": 1515628700, "creation_date": 1515628393, "answer_id": 48197929, "question_id": 48196308, "link": "https://stackoverflow.com/questions/48196308/how-do-i-get-a-function-in-excel-to-stack-data-arranged-across-in-several-rows-t/48197929#48197929", "title": "How do I get a function in excel to stack data arranged across in several rows to stack in a single coloumn on another worksheet", "body": "<p>See if this works for you:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\nWith thisworkbook\n\n' The first cell to stack downward from (will include the cell you specify), plus sheet name.'\nDim OutputSheetRange as range\nSet OutputSheetRange = .worksheets(\"Sheet2\").range(\"A1\")\n\n' Change this to the worksheet containing the cells that need to be stacked.'\nWith .Worksheets(\"Sheet1\")\n\n Dim FormulaPrefix as string\n    FormulaPrefix = \"='\" &amp; .name &amp; \"'!\"\n\n' Code assumes range below, but change to whatever you need.'\nWith .range(\"A1:D4\")\n\nDim RowCount as long\nRowCount = .rows.count\n\nDim ColumnCount as long\nColumnCount = .columns.count\n\nDim ColumnIndex as long\nDim RowIndex as long\nDim OutputIndex as long\n\nOutputIndex = 0\n\n\n\nFor ColumnIndex = 1 to ColumnCount\nFor RowIndex = 1 to RowCount\n\nOutputSheetRange.offset(OutputIndex,0).formula = FormulaPrefix &amp; .cells(rowindex,columnindex).address\nOutputIndex = OutputIndex + 1\n\nNext RowIndex\nNext Columnindex\n\nEnd With\n\nEnd with\n\nEnd Sub\n</code></pre>\n\n<p>This code might take a while for larger data sets (assuming it works). It would be far more efficient to read the input range into a two dimensional array, stack the values within memory, then write stacked values back to the sheet in a single operation -- but this wouldn't preserve any links/update upon recalculation.</p>\n"}], "owner": {"reputation": 3, "user_id": 9200659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0cebbe48f50f08bdf23d2d4dbda8909?s=128&d=identicon&r=PG&f=1", "display_name": "Cormac", "link": "https://stackoverflow.com/users/9200659/cormac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 48197929, "answer_count": 2, "score": 0, "last_activity_date": 1515628700, "creation_date": 1515619497, "question_id": 48196308, "link": "https://stackoverflow.com/questions/48196308/how-do-i-get-a-function-in-excel-to-stack-data-arranged-across-in-several-rows-t", "title": "How do I get a function in excel to stack data arranged across in several rows to stack in a single coloumn on another worksheet", "body": "<p>I've been attempting to pull a large amount of data currently arranged in rows into a separate worksheet in excel and have it stack into a single coloumn such that I can upload to microstrategy to analyse.\nIdeally I want</p>\n\n<pre><code>a1  b1  c1  d1  \na2  b2  c2  d2  \na3  b3  c3  d3  \n</code></pre>\n\n<p>to become</p>\n\n<pre><code>a1\nb1\nc1\nd1\na2\nb2\nc2\nd2\na3\nb3\nc3\nd3\n</code></pre>\n\n<p>I have some quite large data sets and would need to do this regularly so was hoping to create a VBA script to achieve this that could be easily modified and applied to other worksheets. I also would prefer not to copy and paste values but have links to the other worksheet so when the source is updated so is the destination. I've got as far as managing to get \n<code>\na1\nb1\nc1\nd1\n</code>\nUsing the following code</p>\n\n<pre><code>Sub test()\n\nDim i As Integer, ii As Integer\nDim ws As Worksheet\n\nSet ws = Worksheets(\"sheet2\") \n\nFor i = 1 To 4\n\n    ws.Cells(1 +ii, 1).FormulaR1C1 = \"='Sheet1'!R1C\" &amp; i\n\n     ii = ii + 1\n\n Next\n\nEnd Sub\n</code></pre>\n\n<p>My problem arises when trying to formulate a loop to factor in the change of rows. My attempts so far have proved fruitless and frustrating; I've managed to get a diagonal of a1 b2 c3 or a stack of a1 b2 a3 b4 a5 b6 but can't seem to achieve the desired result. I feel it's not incredibly difficult but formulating the correct loop has evaded me so far. Any help would be greatly appreciated. Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1515621967, "post_id": 48196260, "comment_id": 83374762, "body": "Is that a typo here on SO, or also in the code? It looks like you have <code>.End(x1Up)</code> (note the number 1).  Try <code>erow = DestSh.Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Offset(1, 0).Row</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1515623745, "post_id": 48196260, "comment_id": 83375460, "body": "@BruceWayne you&#39;re a erow! (sorry - I&#39;m a dad, I&#39;m allowed)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515624024, "post_id": 48196260, "comment_id": 83375573, "body": "@Mat&#39;sMug - ...how can we move to dock a user&#39;s reputation? Just curious....totally unrelated to Excellent puns.  ;)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1515625748, "post_id": 48196260, "comment_id": 83376203, "body": "@BruceWayne to be honest, I primarily aimed to highlight the poor &amp; inconsistent naming in this code... but then, couldn&#39;t resist that one... sorry again!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515627090, "post_id": 48196260, "comment_id": 83376608, "body": "@Mat&#39;sMug - Better a e-row than an e-ror!"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1515637195, "creation_date": 1515637195, "answer_id": 48198917, "question_id": 48196260, "link": "https://stackoverflow.com/questions/48196260/merge-data-from-multiple-tabs-to-one-master-tab/48198917#48198917", "title": "Merge Data From multiple tabs to one master tab", "body": "<p>These kinds of questions come up all the time.  As always, try something like this.....</p>\n\n<pre><code>Sub Basic_Example_1()\n    Dim MyPath As String, FilesInPath As String\n    Dim MyFiles() As String\n    Dim SourceRcount As Long, Fnum As Long\n    Dim mybook As Workbook, BaseWks As Worksheet\n    Dim sourceRange As Range, destrange As Range\n    Dim rnum As Long, CalcMode As Long\n\n    'Fill in the path\\folder where the files are\n    MyPath = \"C:\\Users\\Ron\\test\"\n\n    'Add a slash at the end if the user forget it\n    If Right(MyPath, 1) &lt;&gt; \"\\\" Then\n        MyPath = MyPath &amp; \"\\\"\n    End If\n\n    'If there are no Excel files in the folder exit the sub\n    FilesInPath = Dir(MyPath &amp; \"*.xl*\")\n    If FilesInPath = \"\" Then\n        MsgBox \"No files found\"\n        Exit Sub\n    End If\n\n    'Fill the array(myFiles)with the list of Excel files in the folder\n    Fnum = 0\n    Do While FilesInPath &lt;&gt; \"\"\n        Fnum = Fnum + 1\n        ReDim Preserve MyFiles(1 To Fnum)\n        MyFiles(Fnum) = FilesInPath\n        FilesInPath = Dir()\n    Loop\n\n    'Change ScreenUpdating, Calculation and EnableEvents\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    'Add a new workbook with one sheet\n    Set BaseWks = Workbooks.Add(xlWBATWorksheet).Worksheets(1)\n    rnum = 1\n\n    'Loop through all files in the array(myFiles)\n    If Fnum &gt; 0 Then\n        For Fnum = LBound(MyFiles) To UBound(MyFiles)\n            Set mybook = Nothing\n            On Error Resume Next\n            Set mybook = Workbooks.Open(MyPath &amp; MyFiles(Fnum))\n            On Error GoTo 0\n\n            If Not mybook Is Nothing Then\n\n                On Error Resume Next\n\n                With mybook.Worksheets(1)\n                    Set sourceRange = .Range(\"A1:C1\")\n                End With\n\n                If Err.Number &gt; 0 Then\n                    Err.Clear\n                    Set sourceRange = Nothing\n                Else\n                    'if SourceRange use all columns then skip this file\n                    If sourceRange.Columns.Count &gt;= BaseWks.Columns.Count Then\n                        Set sourceRange = Nothing\n                    End If\n                End If\n                On Error GoTo 0\n\n                If Not sourceRange Is Nothing Then\n\n                    SourceRcount = sourceRange.Rows.Count\n\n                    If rnum + SourceRcount &gt;= BaseWks.Rows.Count Then\n                        MsgBox \"Sorry there are not enough rows in the sheet\"\n                        BaseWks.Columns.AutoFit\n                        mybook.Close savechanges:=False\n                        GoTo ExitTheSub\n                    Else\n\n                        'Copy the file name in column A\n                        With sourceRange\n                            BaseWks.cells(rnum, \"A\"). _\n                                    Resize(.Rows.Count).Value = MyFiles(Fnum)\n                        End With\n\n                        'Set the destrange\n                        Set destrange = BaseWks.Range(\"B\" &amp; rnum)\n\n                        'we copy the values from the sourceRange to the destrange\n                        With sourceRange\n                            Set destrange = destrange. _\n                                            Resize(.Rows.Count, .Columns.Count)\n                        End With\n                        destrange.Value = sourceRange.Value\n\n                        rnum = rnum + SourceRcount\n                    End If\n                End If\n                mybook.Close savechanges:=False\n            End If\n\n        Next Fnum\n        BaseWks.Columns.AutoFit\n    End If\n\nExitTheSub:\n    'Restore ScreenUpdating, Calculation and EnableEvents\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = CalcMode\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>I use the first worksheet of each workbook in my example (index 1). Change the worksheet index or fill in a sheet name: mybook.Worksheets(\"YourSheetName\"). And change the range A1:C1 to your range</p>\n\n<pre><code>With mybook.Worksheets(1)\n    Set SourceRange = .Range(\"A1:C1\")\nEnd With\n</code></pre>\n\n<p>If you want to copy all cells from the worksheet or from A2 till the last cell on the worksheet.Then replace the code above with this</p>\n\n<pre><code>With mybook.Worksheets(1)\n    FirstCell = \"A2\"\n    Set SourceRange = .Range(FirstCell &amp; \":\" &amp; RDB_Last(3, .Cells))\n    'Test if the row of the last cell &gt;= then the row of the FirstCell\n    If RDB_Last(1, .Cells) &lt; .Range(FirstCell).Row Then\n         Set SourceRange = Nothing\n    End If\nEnd With\n</code></pre>\n\n<p><a href=\"https://www.rondebruin.nl/win/s3/win008.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s3/win008.htm</a></p>\n"}], "owner": {"reputation": 11, "user_id": 9199379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81cff8fd2a79026e5d9102d6d305d409?s=128&d=identicon&r=PG&f=1", "display_name": "Lucy ", "link": "https://stackoverflow.com/users/9199379/lucy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 242, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1515637195, "creation_date": 1515619243, "last_edit_date": 1515621811, "question_id": 48196260, "link": "https://stackoverflow.com/questions/48196260/merge-data-from-multiple-tabs-to-one-master-tab", "title": "Merge Data From multiple tabs to one master tab", "body": "<p>I try to merge the data from multiple tabs to one master tab. Since the concepts in those tabs constantly updated every day (always adding the new information), I want to make sure my master tab is always up to date, and include all updated concepts. </p>\n\n<p>Below is the coding I came up with in VBA. However, I could not run it in Excel since the coding  <strong><code>erow = DestSh.Range(\"A\" &amp; Rows.Count).End(x1UP).Offset(1, 0).Row</code></strong>   was always showed a debug issue. </p>\n\n<p>How can I fix this?</p>\n\n<pre><code>Sub MergeDataFromWorksheets()\n    Dim sh As Worksheet\n    Dim DestShe As Worksheet\n    Dim erow As Long, lrowsh As Long, Startrow As Long\n    Dim CopyRng As Range\n    Startrow = 2\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    'Delete the sheet \"MyMergeSheet\"\n    Application.DisplayAlerts = False\n    On Error Resume Next\n    ActiveWorkbook.Worksheets(\"MyMergeSheet\").Delete\n    On Error GoTo 0\n    Application.DisplayAlerts = True\n\n    'Add a worksheet with the name \"MyMergeSheet\"\n    Set DestSh = ActiveWorkbook.Worksheets.Add\n    DestSh.Name = \"MyMergeSheet\"\n    'loop through all worksheets and copy the data to the DestSh\n    For Each sh In ActiveWorkbook.Worksheets\n        If shtName &lt;&gt; DestSh.Name Then\n            'Find the next blank or empty row on the DestSh\n            erow = DestSh.Range(\"A\" &amp; Rows.Count).End(x1UP).Offset(1, 0).Row\n            'Find the last row with data in the Sheet\n             lrowsh = sh.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n            Set CopyRng = sh.Range(sh.Rows(Startrow), sh.Rows(lrowsh))\n\n            'copies values/formats\n            CopyRng.Copy\n            With DestSh.Cells(erow, 1)\n                .PasteSpecial x1PasteValues\n                .PasteSepcial x1PasteFormates\n                Application.CutCopyMode = faluse\n\n            End With\n\n        End If\n    Next\n\n    DestSh.Cells(1, 1) = \"Current Period Update\"\n    DestSh.Cells(1, 2) = \"Deficiency Reference #\"\n    DestSh.Cells(1, 3) = \"Audit Report Number\"\n    DestSh.Cells(1, 4) = \"IA Reference #\"\n    DestSh.Cells(1, 5) = \"Identifier\"\n    DestSh.Cells(1, 6) = \"Control Matrix Ref. #\"\n    DestSh.Cells(1, 7) = \"Category\"\n    DestSh.Cells(1, 8) = \"Region\"\n    DestSh.Cells(1, 9) = \"Location\"\n    DestSh.Cells(1, 10) = \"Control Activity\"\n    'AutoFit the column width in the DestSh sheet\n    DestSh.Columns.AutoFit\n\n    With Application\n        .ScreeUpdating = True\n        .EnableEvents = True\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "environ"], "comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1515619065, "post_id": 48195982, "comment_id": 83373455, "body": "User = Environ$(&quot;UserName&quot;), gets username of person/machine running code"}], "answers": [{"tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 0, "last_activity_date": 1515620585, "creation_date": 1515620585, "answer_id": 48196571, "question_id": 48195982, "link": "https://stackoverflow.com/questions/48195982/using-environ-userprofile-vba-save-to-path/48196571#48196571", "title": "Using Environ$(\u201cUSERPROFILE\u201d) VBA save to path", "body": "<p>This is just an example of what it could look like:</p>\n\n<pre><code>    Const FILE_SUFFIX As String = \"\\Box\\Etc\\Whatever\\\"\n    Dim userPath As String\n\n    userPath = Environ(\"UserProfile\")\n\n    strPDFOutPath  = userPath &amp; FILE_SUFFIX &amp; &amp; .Cells(llRow, 14).Value &amp; \"_\" &amp; .Cells(llRow, 3).Value &amp; \"_\" &amp; \"file\" &amp; \".pdf\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8616713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/830a133752ae1923809f1fbcb4343f41?s=128&d=identicon&r=PG&f=1", "display_name": "fogharty", "link": "https://stackoverflow.com/users/8616713/fogharty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4281, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515620585, "creation_date": 1515617992, "question_id": 48195982, "link": "https://stackoverflow.com/questions/48195982/using-environ-userprofile-vba-save-to-path", "title": "Using Environ$(\u201cUSERPROFILE\u201d) VBA save to path", "body": "<p>I am new to VBA, so apologies for my ignorance.\nI have a very complicated macro in Excel 2016 that I need to edit.\nIt is related to <a href=\"https://stackoverflow.com/questions/47316486/export-data-from-excel-to-pdf-form-without-saving-it-as-csv-or-other-file-first?noredirect=1#comment81584538_47316486\">this previous discussion</a></p>\n\n<p>I need to change the output save path of a created .pdf. Right now it is using the Excel location as a starting point, (ThisWorkbook.Path) and was saved into that same folder. </p>\n\n<p>But now it needs to save to a different folder which will be on a shared Box drive. The path will change depending on who is accessing the file.</p>\n\n<p>So how should I use Environ$ to indicate that <strong>C:\\Users\\johnsmith</strong>\\Box\\etc. etc.  will change and everything after \\Box\\etc. etc. is constant?\nIt is using values from the Excel spreadsheet to make up the new file name.</p>\n\n<p>Here's the bit I need to edit:</p>\n\n<pre><code>With shDetail\n        If llRow - 3 &lt; 10 Then\n            strPDFOutPath = ThisWorkbook.Path &amp; \"\\2018 Payments\\0\" &amp; .Cells(llRow, 14).Value &amp; \"_\" &amp; .Cells(llRow, 3).Value &amp; \"_\" &amp; \"file\" &amp; \".pdf\"\n        Else\n            strPDFOutPath = ThisWorkbook.Path &amp; \"\\2018 Payments\\\" &amp; .Cells(llRow, 14).Value &amp; \"_\" &amp; .Cells(llRow, 3).Value &amp; \"_\" &amp; \"file\" &amp; \".pdf\"\n        End If\n    End With\n\n    'Save the form as new PDF file.\n    objAcroPDDoc.Save 1, strPDFOutPath\n</code></pre>\n\n<p>So should it be</p>\n\n<pre><code> strPDFOutPath = Environ$(\u201cUSERPROFILE\u201d) &amp; Box\\Folder1\\Folder2\\Folder3\\0\" &amp; .Cells(llRow, 14).Value &amp; \"_\" &amp; .Cells(llRow, 3).Value &amp; \"_\" &amp; \"file\" &amp; \".pdf\"\n        Else\n            strPDFOutPath = Environ$(\u201cUSERPROFILE\u201d) &amp; Box\\Folder1\\Folder2\\Folder3\" &amp; .Cells(llRow, 14).Value &amp; \"_\" &amp; .Cells(llRow, 3).Value &amp; \"_\" &amp; \"file\" &amp; \".pdf\"\n</code></pre>\n\n<p>?</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9200673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de6a77fe7289339441375fbd5f0c221e?s=128&d=identicon&r=PG&f=1", "display_name": "Rebecca Lambert", "link": "https://stackoverflow.com/users/9200673/rebecca-lambert"}, "edited": false, "score": 0, "creation_date": 1515701183, "post_id": 48196868, "comment_id": 83411814, "body": "Thanks. I got a bit side-tracked, but I&#39;ll try to test within the week and let you know how it goes."}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1515621904, "creation_date": 1515621904, "answer_id": 48196868, "question_id": 48195951, "link": "https://stackoverflow.com/questions/48195951/auto-fill-numbering-in-a-column-of-excel-based-on-the-value-of-another-column-dy/48196868#48196868", "title": "Auto-fill numbering in a column of Excel based on the value of another column dynamically", "body": "<p>This is untested, but may help.</p>\n\n<pre><code>Dim RwNum As Integer\nDim lCol As Integer\n\nlCol = Worksheets(\"Sheet1\").Cells(1, Columns.Count).End(xlToLeft)\n\nRwNum = Range(\"Ref Cell\") 'the cell that gives you the 2%\n\nSheets(\"Sheet1\").Range(\"A1\").AutoFilter Field:=x, Criteria1:=\"Yes\", Operator:=xlFilterValues 'Field \"x\" is the \"Yes\" column\n\nSheets(\"Sheet1\").Range(Cells(1, 1), Cells(RwNum, lCol)).SpecialCells(xlCellTypeVisible).Copy Destination:=Sheets(\"Sheetx\").Range(\"A1\") 'sheetx would be a blank worksheet; this will give you a listing of the 2%.\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9200673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de6a77fe7289339441375fbd5f0c221e?s=128&d=identicon&r=PG&f=1", "display_name": "Rebecca Lambert", "link": "https://stackoverflow.com/users/9200673/rebecca-lambert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515621904, "creation_date": 1515617869, "last_edit_date": 1531161705, "question_id": 48195951, "link": "https://stackoverflow.com/questions/48195951/auto-fill-numbering-in-a-column-of-excel-based-on-the-value-of-another-column-dy", "title": "Auto-fill numbering in a column of Excel based on the value of another column dynamically", "body": "<p>Firstly, let me try to explain what it is I'm trying to accomplish (lest anyone has any better suggestions). </p>\n\n<p>I have a set of data that will come to me with any number of rows and values each month. Without the ability to be specific, I'll come up with a general example: Let's say these are people looking for jobs, so the data will change every month. In this dataset, I have a flag that indicates whether or not they're \"interested\" in the specific job I'm hiring for (again, this is a fake example, so I'm sure there are tools that actually do this, just go with it). I am only allowed to take a certain percentage of the entire pool of applicants and I want to take that percentage from only the \"interested\" parties, but the count of \"interested\" parties are greater than that percentage. Let's say my total number of people is 100000 and the interested number is 7000, but I can only take 2% of the total population. </p>\n\n<p>So, I created a cell that gives me what the 2% is. I figured that I would try to auto-fill a line number only on the rows where the \"Interested\" flag is \"Yes\" (all other rows would be 0 or N/A) and, when the auto-fill gets to be the same number as my fixed cell giving my 2% (2000), then it stops filling in the numbers (or makes them 0 or N/A - whatever). Then I can filter by that column.</p>\n\n<p>I can do VBA or formula or whatever you can think of, I just don't know how to accomplish this. </p>\n\n<p>For reference, this article seemed to be very close, but didn't have the specified reference to a value from another column: <a href=\"https://stackoverflow.com/questions/27828504/vba-to-auto-fill-specific-number-of-rows\">VBA to Auto Fill Specific Number of Rows</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1515617619, "post_id": 48195752, "comment_id": 83372759, "body": "<code>Set OBJFolder = objFSO.getfolder(Sheets(&quot;Sheet1&quot;).Range(&quot;A3&quot;).Value)</code> is hardcoded to reference <code>A3</code> everytime. Is this what you want or do you want it to reference <code>B3 ... C3 ... D3 ... </code> on each loop?"}, {"owner": {"reputation": 3, "user_id": 9189284, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7WISMtgX40Y/AAAAAAAAAAI/AAAAAAAABU8/dRTOZKae9b4/photo.jpg?sz=128", "display_name": "Felix Gutierrez", "link": "https://stackoverflow.com/users/9189284/felix-gutierrez"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1515618368, "post_id": 48195752, "comment_id": 83373127, "body": "Indeed I would need the A3 reference to increment on each loop across row 3 I am unsure how to make the reference relative."}], "answers": [{"tags": [], "owner": {"reputation": 105, "user_id": 6376513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/392eb14b9411c54d0611093019fb222e?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen Flynn", "link": "https://stackoverflow.com/users/6376513/stephen-flynn"}, "is_accepted": true, "score": 1, "last_activity_date": 1515618828, "creation_date": 1515618828, "answer_id": 48196173, "question_id": 48195752, "link": "https://stackoverflow.com/questions/48195752/vba-loop-macro-across-columns/48196173#48196173", "title": "VBA Loop macro across columns", "body": "<p>I have not tried this, but I think using the Offset function will give you the cell relative to the current cell you are calculating from.</p>\n\n<pre><code>Private Sub PrintFolders()\n    Dim objFSO As Object\n    Dim OBJFolder As Object\n    Dim objSubFolder As Object\n    Dim i As Integer\n\n        Dim rCell As Range\n        Dim rRng As Range\n\n        Set rRng = Sheet1.Range(\"A4:BZ4\")\n\n        For Each rCell In rRng.Cells\n    Application.StatusBar = \"\"\n    'Create an instance of the FileSystemObject\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    'Get the folder object\n    Set OBJFolder = objFSO.getfolder(rCell.Offset(-1, 0).Value)\n    i = i + 1\n\n    'loops through each folder in the directory and prints their names and path\n    On Error GoTo handleCancel\n\n    For Each objSubFolder In OBJFolder.SubFolders\n    If InStr(1, objSubFolder.Name, \"Plans\", vbTextCompare) &gt; 0 Or InStr(1, objSubFolder.Name, \"Sketches\", vbTextCompare) &gt; 0 Then\n    Application.StatusBar = objSubFolder.Path &amp; \" \" &amp; objSubFolder.Name\n        'print folder path\n        Cells(1 + 3, i) = objSubFolder.Path\n        i = i\n    Else\n\n    End If\n\n    Next objSubFolder\n    Next rCell\n    handleCancel:\n    If Err = 18 Then\n     MsgBox \"You cancelled\"\n    End If\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9189284, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7WISMtgX40Y/AAAAAAAAAAI/AAAAAAAABU8/dRTOZKae9b4/photo.jpg?sz=128", "display_name": "Felix Gutierrez", "link": "https://stackoverflow.com/users/9189284/felix-gutierrez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 48196173, "answer_count": 1, "score": 0, "last_activity_date": 1515618828, "creation_date": 1515617045, "question_id": 48195752, "link": "https://stackoverflow.com/questions/48195752/vba-loop-macro-across-columns", "title": "VBA Loop macro across columns", "body": "<p>Good Afternoon,</p>\n\n<p>I have a worksheet that runs multiple macros.</p>\n\n<p>module #1 lists the sub folders of a master directory across columns on row 3. (Works Correctly)</p>\n\n<p>module #2 lists a specific sub folder from the resulting folder from module #1 based on keywords, the result is printed to row 4. This module functions correctly for column A, though I have been unsuccesful in repeating the calculation across the columns based on a reletive cell reference across row 3. What the code is doing is returning the correct result to A4, and then prints the same result to B4,C4... i cant seem to modify this code to consider the row 3 result for each column.</p>\n\n<pre><code>Private Sub PrintFolders()\nDim objFSO As Object\nDim OBJFolder As Object\nDim objSubFolder As Object\nDim i As Integer\n\n    Dim rCell As Range\n    Dim rRng As Range\n\n    Set rRng = Sheet1.Range(\"A4:BZ4\")\n\n    For Each rCell In rRng.Cells\nApplication.StatusBar = \"\"\n'Create an instance of the FileSystemObject\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\n'Get the folder object\nSet OBJFolder = objFSO.getfolder(Sheets(\"Sheet1\").Range(\"A3\").Value)\ni = i + 1\n\n'loops through each folder in the directory and prints their names and path\nOn Error GoTo handleCancel\n\nFor Each objSubFolder In OBJFolder.SubFolders\nIf InStr(1, objSubFolder.Name, \"Plans\", vbTextCompare) &gt; 0 Or InStr(1, objSubFolder.Name, \"Sketches\", vbTextCompare) &gt; 0 Then\nApplication.StatusBar = objSubFolder.Path &amp; \" \" &amp; objSubFolder.Name\n    'print folder path\n    Cells(1 + 3, i) = objSubFolder.Path\n    i = i\n\nElse\nEnd If\n\nNext objSubFolder\nNext rCell\nhandleCancel:\nIf Err = 18 Then\n MsgBox \"You cancelled\"\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>any assistance is very appreciated.</p>\n"}, {"tags": ["vba", "multidimensional-array"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1515615993, "post_id": 48195504, "comment_id": 83371953, "body": "You dont have a question?"}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 0, "creation_date": 1515623119, "post_id": 48195504, "comment_id": 83375227, "body": "Maybe post it on codereview. Also, do you not need to clear the error after using <code>On Error GoTo</code>? I would have thought that even though <code>VBA.Strings.Join()</code> can&#39;t handle multidimensional arrays, joining an array of arrays would be a more efficient workaround to this limitation than recursively calling the Arr2Str function and using the concatenation operator <code>&amp;</code> (which creates copies of the string each time due to string handling in VBA). I could be wrong though."}, {"owner": {"reputation": 1, "user_id": 9200408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/731f5b77df43e194aa9dccef32cb1dcc?s=128&d=identicon&r=PG&f=1", "display_name": "F. Heinemann", "link": "https://stackoverflow.com/users/9200408/f-heinemann"}, "edited": false, "score": 0, "creation_date": 1515628247, "post_id": 48195504, "comment_id": 83376912, "body": "Yes, I did not optimize the handling of errors. Likewise, one has to incorporate the checking of the array on different data types. Sure, the recursion produces something like that; but I also want to have a string at the end. I just posted the code because I can not find such a feature on the internet right now - but maybe I&#39;m an inefficient Google user."}], "owner": {"reputation": 1, "user_id": 9200408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/731f5b77df43e194aa9dccef32cb1dcc?s=128&d=identicon&r=PG&f=1", "display_name": "F. Heinemann", "link": "https://stackoverflow.com/users/9200408/f-heinemann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515615910, "creation_date": 1515615910, "question_id": 48195504, "link": "https://stackoverflow.com/questions/48195504/vba-walk-through-multidimensional-array-dimensions-limited-by-system-only", "title": "VBA walk through multidimensional array (dimensions limited by system only!)", "body": "<p>Via Google I found no function that can emit a multidimensional array as structured text. VBA arrays behave somewhat bulky in this respect, if you want to iterate through a multidimensional array.\nCorrective suggestions, answers and / or comments are welcome.</p>\n\n<p>So here's my Code suggestion - For free private Use (not excessively tested!):</p>\n\n<pre><code>'**********************************************************************************************************\n' Helper-Function: emits a multidimensional array as structured text (c) 2018 F. Heinemann, Freiburg, Germany\nFunction Arr2Str(ByVal aArr As Variant, Optional ByVal nLevel As Long = 0, Optional ByVal nMaxDim As Long = 0) As String\n   Dim cRet As String\n   Dim nI, nK  As Long\n   Dim nCount1 As Long\n\n   On Error Resume Next\n   Arr2Str = \"\"\n   cRet = \"\"\n   nMaxDim = MaxUboundFH(aArr)\n   nCount1 = UboundFH(aArr, nMaxDim)\n   If nCount1 = -1 Then\n      Debug.Print \"Error: wrong MaxDim! [\" &amp; CStr(nMaxDim) &amp; \"]\"\n      Exit Function\n   End If\n   For nI = LBound(aArr) To UBound(aArr)\n      cRet = cRet &amp; Space(nLevel) &amp; \"- \" &amp; \"[\" &amp; nI &amp; \"]: \" &amp; aArr(nI) &amp; vbCrLf\n      If Err.Number = 0 Then\n         GoTo NextIteration_nI\n      End If\n      nCount1 = UboundFH(aArr, nMaxDim)\n      For nK = 0 To nCount1 + 1\n         If IsArrayFH(aArr, nI, nK) = True Then\n            cRet = cRet &amp; Arr2Str(aArr(nI, nK), nLevel + 1, nMaxDim - 1)\n         Else\n            cRet = cRet &amp; Space(nLevel) &amp; \"- \" &amp; \"[\" &amp; nI &amp; \"]: \" &amp; aArr(nI, nK) &amp; vbCrLf\n         End If\n      Next nK\nNextIteration_nI:\n   Next nI\n   Arr2Str = cRet\nEnd Function\n\nFunction MaxUboundFH(ByRef aArr As Variant) As Long\n   Dim nI, nDimGet As Long\n\n   MaxUboundFH = 1\n   On Error GoTo MaxUboundFH_Error\n\n   For nI = 2 To 64\n      nDimGet = UBound(aArr, nI)\n      MaxUboundFH = nI\n      Exit Function\n   Next nI\n\n   Exit Function\nMaxUboundFH_Error:\n\nEnd Function\n\nFunction UboundFH(ByRef aArr As Variant, ByVal nDim As Long) As Long\n   Dim nDimGet As Long\n\n   UboundFH = -1\n   On Error GoTo UboundFH_Error\n   nDimGet = UBound(aArr, nDim)\n   UboundFH = nDimGet\n   Exit Function\n\nUboundFH_Error:\n   UboundFH = -1\nEnd Function\n\nFunction IsArrayFH(ByRef aArr As Variant, ByVal nIndex1 As Long, ByVal nIndex2 As Long) As Boolean\n\n   IsArrayFH = False\n   On Error GoTo IsArrayFH_Error\n   If IsArray(aArr(nIndex1, nIndex2)) = True Then\n      IsArrayFH = True\n      Exit Function\n   End If\nIsArrayFH_Error:\n   IsArrayFH = False\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515616370, "post_id": 48195500, "comment_id": 83372139, "body": "I&#39;ll ask the easy question before I look into your code in too much detail ... do you definitely have something in columns BA to CR?  And do you actually have situations where there are five consecutive rows with the same value in column D?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1515616421, "post_id": 48195500, "comment_id": 83372162, "body": "Do those 4 lines actually execute?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515616823, "post_id": 48195500, "comment_id": 83372345, "body": "&quot;I am attempting to move ranges of cells to one row, but different columns.&quot; Are you sure you have your assignment statements the right way around, i.e. are you trying to copy things from BA:BK of the 5th row to AN:AX of the 1st row, from BL:BV of the 5th row to AN:AX of the second row, etc (which is what you are doing), or are you trying to go the other way and move everything from the first 4 rows into the 5th row?"}, {"owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515616825, "post_id": 48195500, "comment_id": 83372349, "body": "@YowE3K it is columns AN:AX, and yes I do. I do have situations like this, yes."}, {"owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515617226, "post_id": 48195500, "comment_id": 83372532, "body": "@YowE3K .... You were exactly right. I had it as RANGE1.VALUE = RANGE2.VALUE, not RANGE2.VALUE = RANGE1.value. Nailed it, amirite?!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1515617471, "post_id": 48195500, "comment_id": 83372674, "body": "@Gregory Yep - once you said you didn&#39;t have data in columns BA:CR, that it was in AN:AX, it became fairly obvious that you were just writing things back to front.  (I&#39;m guessing you probably had lines like <code>Range(Cells(i, 40), Cells(i, 50)).Copy Range(Cells(i + 4, 53), Cells(i + 4, 63))</code> and you forgot that is written as <code>source.Copy destination</code> while an assignment is <code>destination = source</code>, and therefore edited the lines without remembering to switch the two sides.)"}, {"owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515618907, "post_id": 48195500, "comment_id": 83373386, "body": "That&#39;s exactly right @YowE3K. Appreciate your insight."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1515617091, "creation_date": 1515617091, "answer_id": 48195768, "question_id": 48195500, "link": "https://stackoverflow.com/questions/48195500/range1-value-range2-value-not-populating/48195768#48195768", "title": "Range1.Value = Range2.Value not populating", "body": "<p>In Visual Basic the statement</p>\n\n<pre><code>a = b\n</code></pre>\n\n<p>modifies <code>a</code> so that it is given the value of <code>b</code>.  It doesn't change <code>b</code> to be the value of <code>a</code>.</p>\n\n<hr>\n\n<p>Based on your comment that your data is in AN:AX, it therefore seems like you intended to use:</p>\n\n<pre><code>Range(Cells(i + 4, 53), Cells(i + 4, 63)).Value = Range(Cells(i + 0, 40), Cells(i + 0, 50)).Value\nRange(Cells(i + 4, 64), Cells(i + 4, 74)).Value = Range(Cells(i + 1, 40), Cells(i + 1, 50)).Value\nRange(Cells(i + 4, 75), Cells(i + 4, 85)).Value = Range(Cells(i + 2, 40), Cells(i + 2, 50)).Value\nRange(Cells(i + 4, 86), Cells(i + 4, 96)).Value = Range(Cells(i + 3, 40), Cells(i + 3, 50)).Value\n</code></pre>\n"}], "owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 48195768, "answer_count": 1, "score": 0, "last_activity_date": 1515617091, "creation_date": 1515615897, "question_id": 48195500, "link": "https://stackoverflow.com/questions/48195500/range1-value-range2-value-not-populating", "title": "Range1.Value = Range2.Value not populating", "body": "<p>I am attempting to move ranges of cells to one row, but different columns. The code worked fine when I was copy/pasting, but the sheet slowed down dramatically. This method seems to work faster, though the actual cells are not populating. Code below:</p>\n\n<pre><code>lastRow = Cells.Find(What:=\"*\", _\n                After:=Range(\"A1\"), _\n                LookAt:=xlPart, _\n                LookIn:=xlFormulas, _\n                SearchOrder:=xlByRows, _\n                SearchDirection:=xlPrevious, _\n                MatchCase:=False).Row\n\n    For i = 2 To lastRow\n        If Cells(i, 4).Value = Cells(i + 1, 4).Value Then                   '1st if\n            Debug.Print Cells(i, 4).Value &amp; \"  \" &amp; Cells(i + 1, 4).Value\n\n            If Cells(i, 4).Value = Cells(i + 2, 4).Value Then           '2nd if\n                Debug.Print Cells(i, 4).Value &amp; \"    \" &amp; Cells(i + 2, 4).Value\n\n                If Cells(i, 4).Value = Cells(i + 3, 4).Value Then       '3rd if\n                    Debug.Print Cells(i, 4).Value &amp; \"    \" &amp; Cells(i + 3, 4).Value\n\n                    If Cells(i, 4).Value = Cells(i + 4, 4).Value Then       '4th if\n                        Debug.Print Cells(i, 4).Value &amp; \"    \" &amp; Cells(i + 4, 4).Value\n\n                        If Cells(i, 4).Value = Cells(i + 5, 4).Value Then       '5th if\n\n                            Debug.Print Cells(i, 4).Value &amp; \"    \" &amp; Cells(i + 5, 4).Value\n\n                        Else '~~~~~&gt;RANGE1.VALUE = RANGE2.VALUE BELOW\n\n                                Cells(i + 4, 52).Value = 5\n                                Range(Cells(i, 40), Cells(i, 50)).Value = Range(Cells(i + 4, 53), Cells(i + 4, 63)).Value\n                                Range(Cells(i + 1, 40), Cells(i + 1, 50)).Value = Range(Cells(i + 4, 64), Cells(i + 4, 74)).Value\n                                Range(Cells(i + 2, 40), Cells(i + 2, 50)).Value = Range(Cells(i + 4, 75), Cells(i + 4, 85)).Value\n                                Range(Cells(i + 3, 40), Cells(i + 3, 50)).Value = Range(Cells(i + 4, 86), Cells(i + 4, 96)).Value\n\n                                i = i + 4\n\n                             End If\n</code></pre>\n"}, {"tags": ["excel", "vba", "schedule"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515615814, "post_id": 48195242, "comment_id": 83371849, "body": "It&#39;s not particularly clear what you mean by &quot;multiple loans&quot; with respect to your data layout.  Where is the information for the other loans - on other sheets (i.e. you just want to do what you are doing in your current code, but using multiple sheets), or in other columns (in which case, where are you putting the output, or do you just want the single &quot;total&quot; output)?"}, {"owner": {"reputation": 1, "user_id": 9200553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f12034d721425a9c5fb752dd3b386595?s=128&d=identicon&r=PG&f=1", "display_name": "brendan Dunphy", "link": "https://stackoverflow.com/users/9200553/brendan-dunphy"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515618447, "post_id": 48195242, "comment_id": 83373165, "body": "So I Have one sheet with loan information, for simplicity just say 2 loans  The info for the first one is: Term     Rate        Balance 360          5%           100,000 360          6%            100,000  I am trying to take the info from this sheet, amortize the loans and show the totals outputs in the aggregate for the loan pool. Example: the PMT in period 1, would be the combined Payment of each loan."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515622099, "post_id": 48195242, "comment_id": 83374805, "body": "I will post an answer, but it is a <b>guess</b> based on a <b>possible</b> data layout you might be using."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1515622104, "creation_date": 1515622104, "answer_id": 48196912, "question_id": 48195242, "link": "https://stackoverflow.com/questions/48195242/vba-loan-amortizing/48196912#48196912", "title": "VBA Loan Amortizing", "body": "<p>Assuming that information for your multiple loans are in rows 1 to 3 of columns B, C, D, etc, then you are probably wanting to just loop over those columns:</p>\n\n<pre><code>Option Explicit\n\nSub LoanAmort()\n    Dim Rate As Double, Term As Long, OrigBal As Double, Payment As Double\n    Dim lastCol As Long\n    Dim colNum As Long\n    Dim rowNum As Long\n    Dim OutputRow As Long\n    Dim BeginBal As Double, Interest As Double, Principal As Double, EndBal As Double\n\n    'Declare output Rows\n    OutputRow = 7\n\n    With Worksheets(\"Sheet1\") ' I'm lazy and don't want to keep typing Worksheets(\"Sheet1\")\n\n        'Delete all previous information\n        .Range(.Cells(OutputRow + 1, 1), .Cells(10000, 6)).ClearContents\n\n        'Find last column\n        lastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n\n        'Loop through each column\n        For colNum = 2 To lastCol\n            'telling VBA where these variables are\n            Rate = .Cells(1, colNum).Value\n            Term = .Cells(2, colNum).Value\n            OrigBal = .Cells(3, colNum).Value\n\n            'Calc PMT\n            Payment = Pmt((Rate / 12), Term, -OrigBal)\n\n            'Fill in rows\n            BeginBal = OrigBal\n\n            For rowNum = 1 To Term\n                Interest = BeginBal * (Rate / 12)\n                Principal = Payment - Interest\n                EndBal = BeginBal - Principal\n\n                'populate the cells\n\n                .Cells(OutputRow + rowNum, 1).Value = rowNum\n                .Cells(OutputRow + rowNum, 2).Value = .Cells(OutputRow + rowNum, 2).Value + BeginBal\n                .Cells(OutputRow + rowNum, 3).Value = .Cells(OutputRow + rowNum, 3).Value + Payment\n                .Cells(OutputRow + rowNum, 4).Value = .Cells(OutputRow + rowNum, 4).Value + Interest\n                .Cells(OutputRow + rowNum, 5).Value = .Cells(OutputRow + rowNum, 5).Value + Principal\n                .Cells(OutputRow + rowNum, 6).Value = .Cells(OutputRow + rowNum, 6).Value + EndBal\n\n                BeginBal = EndBal\n            Next\n        Next\n\n        'Formatting\n        .Range(.Cells(OutputRow + 1, 2), .Cells(OutputRow + Term, 6)).NumberFormat = \"$#,###.#0\"\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9200553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f12034d721425a9c5fb752dd3b386595?s=128&d=identicon&r=PG&f=1", "display_name": "brendan Dunphy", "link": "https://stackoverflow.com/users/9200553/brendan-dunphy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 543, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1515622104, "creation_date": 1515614741, "question_id": 48195242, "link": "https://stackoverflow.com/questions/48195242/vba-loan-amortizing", "title": "VBA Loan Amortizing", "body": "<p>I have seen on here how to Amortize a single Loan through this website and I was able to get it to work using the code below. But I am now trying to amortize multiple loans at the same time and produce the aggregate information at the end. I couldn't find anything online on how to do this, any ideas on where to start?</p>\n\n<p>Thanks in Advance</p>\n\n<pre><code>Sub LoanAmort()\n\n'take user inputs from top of the sheet Rate, Term, Orignal\n'declares these as variables\n\nDim Rate, Term, Orignal, Payment\n\n'telling VBA where these variables are\n\nRate = Sheets(\"Sheet1\").Range(\"B1\").Value\nTerm = Sheets(\"Sheet1\").Range(\"B2\").Value\nOrigBal = Sheets(\"Sheet1\").Range(\"B3\").Value\n\n'Calc PMT\nPayment = PMT((Rate / 12), Term, -OrigBal)\n\n'Declare the outputs\n\nDim BeginBal, Interest, Principal, EndBal\n\n'Declare output Rows\n\nOutputRow = 7\n\n'Delete all previous information\n\nRange(Cells(OutputRow + 1, 1), Cells(10000, 6)).Select\nSelection.ClearContents\n\n'Fill in rows\n\nBeginBal = OrigBal\n\nFor rowNum = 1 To Term\n    Interest = BeginBal * (Rate / 12)\n    Principal = Payment - Interest\n    EndBal = BeginBal - Principal\n\n    'populate the cells\n\n    Cells(OutputRow + rowNum, 1).Value = rowNum\n    Cells(OutputRow + rowNum, 2).Value = BeginBal\n    Cells(OutputRow + rowNum, 3).Value = Payment\n    Cells(OutputRow + rowNum, 4).Value = Interest\n    Cells(OutputRow + rowNum, 5).Value = Principal\n    Cells(OutputRow + rowNum, 6).Value = EndBal\n\n       BeginBal = EndBal\n    Next rowNum\n'Formatting\n\n    Range(Cells(OutputRow + 1, 2), Cells(OutputRow + Term, 6)).Select\n    Selection.NumberFormat = \"$#,###.#0\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "scope"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1515614810, "post_id": 48195104, "comment_id": 83371336, "body": "Remove the qualifiers. You&#39;re trying to access a private field through the class&#39; public interface, which you should be doing with <code>Me</code> as a qualifier, not the default instance of the form - lose that habit, <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">it <i>will</i> bite you in the rear end</a>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515618538, "post_id": 48195104, "comment_id": 83373211, "body": "Does <code>clsGame</code> not have a <code>Walk</code> public method? Exactly what code gets highlighted when you get the compile error? FWIW compile error and &quot;when I put a watch on variables&quot; can&#39;t be in the same sentence: if the code can be debugged, then it compiles. If it doesn&#39;t compile, it can&#39;t be debugged."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515618701, "post_id": 48195104, "comment_id": 83373294, "body": "Also FWIW all these assumptions you&#39;re making about the context/scope are erroneous and distract from the actual problem."}, {"owner": {"reputation": 23, "user_id": 7554555, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6IQwsRx41vU/AAAAAAAAAAI/AAAAAAAAAHU/LtmApYjKamQ/photo.jpg?sz=128", "display_name": "JackyD", "link": "https://stackoverflow.com/users/7554555/jackyd"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515619637, "post_id": 48195104, "comment_id": 83373689, "body": "That was a stupid oversight on my part, the walk method was private. Thanks for the help! (And for pointing out my issues with how I was calling my form)."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515620926, "post_id": 48195104, "comment_id": 83374310, "body": "For the record, editing the question like you did makes my answer look like it&#39;s making up code..."}, {"owner": {"reputation": 23, "user_id": 7554555, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6IQwsRx41vU/AAAAAAAAAAI/AAAAAAAAAHU/LtmApYjKamQ/photo.jpg?sz=128", "display_name": "JackyD", "link": "https://stackoverflow.com/users/7554555/jackyd"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515622106, "post_id": 48195104, "comment_id": 83374809, "body": "I wasn&#39;t sure how would be best to update it. In the future would it be better to have to seperate code blocks (the original and the edited) or to explain what changes I had made in text? Or is there a different standard to how that&#39;s best done?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515622444, "post_id": 48195104, "comment_id": 83374948, "body": "Since SO is a Q&amp;A site and not a debugging service (millions of people google their problems and land here, every day), ideally a Q&amp;A should remain consistent at all times. The question you asked originally was a legitimate bug that could bite anyone, and its solution is below. The updated issue about method not being found would be a separate thing that <i>could</i> be its own question (though of little value), but anyone reading the comments would pick up the solution to that secondary problem. Hence, I&#39;ve rolled back the last edit. Cheers!"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7554555, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6IQwsRx41vU/AAAAAAAAAAI/AAAAAAAAAHU/LtmApYjKamQ/photo.jpg?sz=128", "display_name": "JackyD", "link": "https://stackoverflow.com/users/7554555/jackyd"}, "edited": false, "score": 0, "creation_date": 1515615695, "post_id": 48195328, "comment_id": 83371774, "body": "Changing it to public and/or dropping the qualifier/using Me makes no apparent difference. I still receive the out of context error."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 23, "user_id": 7554555, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6IQwsRx41vU/AAAAAAAAAAI/AAAAAAAAAHU/LtmApYjKamQ/photo.jpg?sz=128", "display_name": "JackyD", "link": "https://stackoverflow.com/users/7554555/jackyd"}, "edited": false, "score": 0, "creation_date": 1515615760, "post_id": 48195328, "comment_id": 83371814, "body": "@JackyD I assumed that code was in the code-behind of <code>frmZombieRun</code>. Is it? Also exactly what is &quot;out of context&quot; error? This answer covers the question you asked, with the information you provided. If something&#39;s missing, please edit your question to include it."}, {"owner": {"reputation": 23, "user_id": 7554555, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6IQwsRx41vU/AAAAAAAAAAI/AAAAAAAAAHU/LtmApYjKamQ/photo.jpg?sz=128", "display_name": "JackyD", "link": "https://stackoverflow.com/users/7554555/jackyd"}, "edited": false, "score": 0, "creation_date": 1515618263, "post_id": 48195328, "comment_id": 83373073, "body": "My apologies, I&#39;m referring to the compile error: method or data member not found. And yes, this is the code-behind for frmZombieRun."}, {"owner": {"reputation": 23, "user_id": 7554555, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6IQwsRx41vU/AAAAAAAAAAI/AAAAAAAAAHU/LtmApYjKamQ/photo.jpg?sz=128", "display_name": "JackyD", "link": "https://stackoverflow.com/users/7554555/jackyd"}, "edited": false, "score": 1, "creation_date": 1515620053, "post_id": 48195328, "comment_id": 83373870, "body": "And that&#39;s the issue right there. The walk method was Private which I completely overlooked."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1515615088, "creation_date": 1515615088, "answer_id": 48195328, "question_id": 48195104, "link": "https://stackoverflow.com/questions/48195104/vba-private-object-out-scope-in-same-form/48195328#48195328", "title": "VBA Private Object Out Scope in Same Form", "body": "<p>Because it's <em>not</em> in scope.</p>\n\n<p>The <code>gameSession</code> field is <code>Private</code>, which means it's only accessible to <em>this instance</em> of the form.</p>\n\n<p>If you made it <code>Public</code>, your code would compile and probably work, until you changed how the form is shown, from this:</p>\n\n<pre><code>frmZombieRun.Show ' off the default instance\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>With New frmZombieRun\n    .Show ' not off the default instance\nEnd With\n</code></pre>\n\n<p>Referring to the default instance in a form's code-behind <em>will</em> cause problems, sooner or later. Read more about it <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">here</a> (disclaimer: I wrote that article).</p>\n\n<p>Use <code>Me</code> instead, to refer to <em>the current instance</em>:</p>\n\n<pre><code>[Call] Me.gameSession.Walk 'note: Call is redundant/deprecated/obsolete\n</code></pre>\n\n<p>But that breaks encapsulation, that field <em>should</em> probably be <code>Private</code> like you have it, i.e. not accessible from the form's public interface. So, drop the qualifier and access your private field directly:</p>\n\n<pre><code>[Call] gameSession.Walk\n</code></pre>\n\n<p>You'll also need to do the same for the initialization handler:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n   Set gameSession = New clsGame\nEnd Sub\n</code></pre>\n\n<p>Consider dropping the <code>frm</code> and <code>cls</code> pseudo-Hungarian prefixes, they're not buying you anything.</p>\n"}], "owner": {"reputation": 23, "user_id": 7554555, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6IQwsRx41vU/AAAAAAAAAAI/AAAAAAAAAHU/LtmApYjKamQ/photo.jpg?sz=128", "display_name": "JackyD", "link": "https://stackoverflow.com/users/7554555/jackyd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 1, "accepted_answer_id": 48195328, "answer_count": 1, "score": 2, "last_activity_date": 1515622458, "creation_date": 1515614056, "last_edit_date": 1531164843, "question_id": 48195104, "link": "https://stackoverflow.com/questions/48195104/vba-private-object-out-scope-in-same-form", "title": "VBA Private Object Out Scope in Same Form", "body": "<p>I'm trying to learn VBA by writing a simple game but I'm running into issues with the scope of my objects.  When the main form is opened I want a new instance of the gameSession class to be initialized. Then, when the user clicks a button, I want to use that instance. But even though my object is declared at the top of the form it appears that it isn't included in the scope of the forms procedures. How do I get each procedure to recognize the same instance of the object?</p>\n\n<pre><code>Option Explicit\n\nPrivate gameSession As clsGame\n\nPrivate Sub btnWalk_Click()\n   Call frmZombieRun.gameSession.Walk\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n   Set frmZombieRun.gameSession = New clsGame\nEnd Sub\n</code></pre>\n\n<p>If I put a watch on the variables I see that each instance of gameSession has a different context (frmZombieRun, frmZombieRun.btnWalk_Click, and frmZombieRun.UserForm_Initialize) and therefore is out of context when I reach the btnWalk routine.</p>\n\n<p>I get a compile error: Method or data member not found.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515614166, "post_id": 48194912, "comment_id": 83370995, "body": "<a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">This tutorial</a> I wrote a few months ago should help you get away from procedural and closer to actual object-oriented code. Good luck!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515614483, "post_id": 48194912, "comment_id": 83371168, "body": "Uh, <i>you</i> just stripped the formatting and now your post looks like a wall of code again. See <a href=\"https://stackoverflow.com/editing-help\">editing help</a> for everything you need to know about Markdown."}, {"owner": {"reputation": 1, "user_id": 9198474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f54e7d1ca53ceb8fe124d3cd2cea262?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Riley", "link": "https://stackoverflow.com/users/9198474/michael-riley"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515618257, "post_id": 48194912, "comment_id": 83373064, "body": "Thank you, Mat&#39;s Mug!  It looks very interesting - I&#39;m looking forward to reading through it completely!"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515614291, "post_id": 48194979, "comment_id": 83371065, "body": "<code>vbModal</code> would be the default for <code>.Show</code> though"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515614372, "post_id": 48194979, "comment_id": 83371111, "body": "Assuming <code>frm.ShowModal</code> is set to True, which it is by default."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 1, "last_activity_date": 1515613588, "creation_date": 1515613588, "answer_id": 48194979, "question_id": 48194912, "link": "https://stackoverflow.com/questions/48194912/interaction-between-user-forms/48194979#48194979", "title": "interaction between user forms", "body": "<p>Open Userform2 modally instead. </p>\n\n<pre><code>Userform2.Show vbModal\n</code></pre>\n\n<p>Userform2 will display overtop of Userform1 then, and return control to Userform1 once it's unloaded.</p>\n"}], "owner": {"reputation": 1, "user_id": 9198474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f54e7d1ca53ceb8fe124d3cd2cea262?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Riley", "link": "https://stackoverflow.com/users/9198474/michael-riley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515614702, "creation_date": 1515613299, "last_edit_date": 1531164843, "question_id": 48194912, "link": "https://stackoverflow.com/questions/48194912/interaction-between-user-forms", "title": "interaction between user forms", "body": "<p>I'm a novice at VBA programming who is currently undertaking an effort to understand the VBA code written by someone else who is no longer available to ask questions.  There are several dozen pages of code - however, the part that's causing some concern for me right now can be described as follows:</p>\n\n<p>There are 2 user forms.  The program flow should be that UserForm1 asks for an account number, and then UserForm2 displays that account's information.  Once the account information has been processed, then control should be returned to UserForm1 so that another account number can be obtained (or the program exited).</p>\n\n<p>But within UserForm1 there's a call to UserForm2, and within UserForm2 there's a call to UserForm1.  I'm finding that highly problematic and would like some advice on how to handle this situation appropriately.  I've found plenty of information on the Internet regarding the creation and use of user forms, but nothing yet pertaining to the interaction between 2 user forms like this (with the exception of the article on this website entitled:  VBA: Using Multiple User Forms, which makes me believe that perhaps UserForm1 should be \u201chidden\u201d (i.e., UserForm1.hide) as opposed to being \u201cunloaded\u201d \u2013 I believe I can still use the \u201cmodal\u201d mode, as opposed to the \u201cmodeless\u201d mode which was suggested by the second response to the article).  But this back-and-forth calling still has me somewhat confused\u2026.  Like I said, I\u2019m a novice, so I\u2019m somewhat limited in my understanding at this point.</p>\n\n<p>Since the code is rather lengthy, I hope the following description will suffice.</p>\n\n<pre><code>Sub1\n    call to Sub2\nSub2\n    launches UserForm1 (unloads UserForm1 before launching UserForm2)\n        launches UserForm2 (unloads UserForm2 before launching UserForm1)\n    launches UserForm2 (unloads UserForm2 before launching UserForm1)\n        launches UserForm1 (unloads UserForm1 before launching UserForm2)\n</code></pre>\n\n<p>Now perhaps I'm just being too procedural in my thinking, but it would make more sense to me to compartmentalize the launching of UserForm1 &amp; UserForm2 so there's not this back-and-forth calling going on.  If someone could please correct me if my assumption is wrong, or offer some assistance if my assumption is correct, that would be greatly appreciated!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1531, "user_id": 4645236, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QVYcq.jpg?s=128&g=1", "display_name": "hellyale", "link": "https://stackoverflow.com/users/4645236/hellyale"}, "edited": false, "score": 0, "creation_date": 1515612347, "post_id": 48194581, "comment_id": 83370067, "body": "try removing the <code>.Value</code> from <code>strArray.Contains(Cells(i, 1).Value)</code>"}, {"owner": {"reputation": 55, "user_id": 7495284, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-pbzJ960k3sw/AAAAAAAAAAI/AAAAAAAATvY/vhDp06aUK-0/photo.jpg?sz=128", "display_name": "Tom&#225;\u0161 Hobza", "link": "https://stackoverflow.com/users/7495284/tom%c3%a1%c5%a1-hobza"}, "reply_to_user": {"reputation": 1531, "user_id": 4645236, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QVYcq.jpg?s=128&g=1", "display_name": "hellyale", "link": "https://stackoverflow.com/users/4645236/hellyale"}, "edited": false, "score": 0, "creation_date": 1515612481, "post_id": 48194581, "comment_id": 83370127, "body": "Still the same. Could it be syntax or somtehing? I really don&#39;t know."}, {"owner": {"reputation": 1531, "user_id": 4645236, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QVYcq.jpg?s=128&g=1", "display_name": "hellyale", "link": "https://stackoverflow.com/users/4645236/hellyale"}, "edited": false, "score": 0, "creation_date": 1515612533, "post_id": 48194581, "comment_id": 83370155, "body": "I think your strArray is not initialized properly, but it has been a long time since I touched vb. Still scratching my head"}, {"owner": {"reputation": 1531, "user_id": 4645236, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QVYcq.jpg?s=128&g=1", "display_name": "hellyale", "link": "https://stackoverflow.com/users/4645236/hellyale"}, "edited": false, "score": 0, "creation_date": 1515612621, "post_id": 48194581, "comment_id": 83370201, "body": "<code>ReDim strArray(1 To TotalRows)</code> might need to be just <code>ReDim strArray(TotalRows)</code>"}, {"owner": {"reputation": 55, "user_id": 7495284, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-pbzJ960k3sw/AAAAAAAAAAI/AAAAAAAATvY/vhDp06aUK-0/photo.jpg?sz=128", "display_name": "Tom&#225;\u0161 Hobza", "link": "https://stackoverflow.com/users/7495284/tom%c3%a1%c5%a1-hobza"}, "reply_to_user": {"reputation": 1531, "user_id": 4645236, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QVYcq.jpg?s=128&g=1", "display_name": "hellyale", "link": "https://stackoverflow.com/users/4645236/hellyale"}, "edited": false, "score": 0, "creation_date": 1515612659, "post_id": 48194581, "comment_id": 83370227, "body": "Me too. Now I love python or javascript (i code in those) even more, because they make sense and they&#39;re so easy compared to vb."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1515612820, "post_id": 48194581, "comment_id": 83370288, "body": "@Tom&#225;\u0161Hobza <a href=\"https://medium.com/javascript-non-grata/the-top-10-things-wrong-with-javascript-58f440d6b3d8\" rel=\"nofollow noreferrer\">Javascript makes sense? Well that&#39;s new...</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1531, "user_id": 4645236, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QVYcq.jpg?s=128&g=1", "display_name": "hellyale", "link": "https://stackoverflow.com/users/4645236/hellyale"}, "edited": false, "score": 2, "creation_date": 1515612904, "post_id": 48194581, "comment_id": 83370343, "body": "@hellyale arrays aren&#39;t objects, they don&#39;t have members. Hence, <code>someArray.Whatever</code> is an <i>invalid qualifier</i>, because <code>.Whatever</code> can&#39;t legally be qualified with an array."}, {"owner": {"reputation": 1531, "user_id": 4645236, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QVYcq.jpg?s=128&g=1", "display_name": "hellyale", "link": "https://stackoverflow.com/users/4645236/hellyale"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515613066, "post_id": 48194581, "comment_id": 83370436, "body": "@Mat&#39;sMug Ahh... I thought the qualifier was the thing before the <code>.</code> that&#39;s why I was thinking the problem was the array. Thanks"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515613105, "post_id": 48194581, "comment_id": 83370452, "body": "well the qualifier <i>is</i> the thing before the dot... that&#39;s exactly what I said ;-)"}, {"owner": {"reputation": 55, "user_id": 7495284, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-pbzJ960k3sw/AAAAAAAAAAI/AAAAAAAATvY/vhDp06aUK-0/photo.jpg?sz=128", "display_name": "Tom&#225;\u0161 Hobza", "link": "https://stackoverflow.com/users/7495284/tom%c3%a1%c5%a1-hobza"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515613170, "post_id": 48194581, "comment_id": 83370480, "body": "@Mat&#39;sMug well sepends what you do. Things like Node.js is like way out of my level, but have you heard about p5.js? It&#39;s really really simple."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515613225, "post_id": 48194581, "comment_id": 83370514, "body": "@Tom&#225;\u0161Hobza let&#39;s not pollute the comment thread with an off-topic discussion about JS, but the mere fact that a new JS framework appears every other week should be a sign of something!"}, {"owner": {"reputation": 55, "user_id": 7495284, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-pbzJ960k3sw/AAAAAAAAAAI/AAAAAAAATvY/vhDp06aUK-0/photo.jpg?sz=128", "display_name": "Tom&#225;\u0161 Hobza", "link": "https://stackoverflow.com/users/7495284/tom%c3%a1%c5%a1-hobza"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515613238, "post_id": 48194581, "comment_id": 83370522, "body": "@Mat&#39;sMug So how can I find if that value is in that array?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515613284, "post_id": 48194581, "comment_id": 83370546, "body": "Like answers are saying: by iterating the array. Or... hmm, you&#39;re in Excel, correct? I have a more elegant solution, hold on.."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515614029, "post_id": 48194581, "comment_id": 83370927, "body": "For the record, your array is never populated, so even if <code>.Contains</code> worked, it would always return <code>False</code>. There also appears to be an <i>off-by-one</i> error with your loop."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515614362, "post_id": 48194581, "comment_id": 83371105, "body": "@Mat&#39;sMug <code>strArray(i) = Cells(i, 1).Value</code> would have been populating the array (if the <code>Contains</code> had worked), but would have been leaving &quot;gaps&quot; (i.e. if cell A10 was the same value as cell A6 then <code>strArray(10)</code> would be <code>&quot;&quot;</code>, and then <code>strArray(11)</code> would be the value from cell A11 assuming it was not a duplicate of something)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515614414, "post_id": 48194581, "comment_id": 83371138, "body": "@YowE3K right - that&#39;s what I get for skim-reading :)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515614497, "post_id": 48194581, "comment_id": 83371176, "body": "@Mat&#39;sMug Almost certainly wasn&#39;t the intended action of the code (the OP probably needs a second counter - one for iterating the rows, and one to keep track of what index to populate in the array), but that&#39;s another question."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515614610, "post_id": 48194581, "comment_id": 83371231, "body": "@Mat&#39;sMug I hope you only deleted your answer while reworking it to cater for those gaps - the <code>Application.Match</code> solution is a good way of creating a &quot;contains&quot; function."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515614685, "post_id": 48194581, "comment_id": 83371265, "body": "@YowE3K yeah, but then realized it&#39;s not at all what OP meant to be doing!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1515615345, "post_id": 48194581, "comment_id": 83371594, "body": "@Mat&#39;sMug I suspect that copying the data to a temporary location, performing a &quot;RemoveDuplicates&quot;, and then loading the result into <code>strArray</code> might actually be the simplest way :D"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 7495284, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-pbzJ960k3sw/AAAAAAAAAAI/AAAAAAAATvY/vhDp06aUK-0/photo.jpg?sz=128", "display_name": "Tom&#225;\u0161 Hobza", "link": "https://stackoverflow.com/users/7495284/tom%c3%a1%c5%a1-hobza"}, "edited": false, "score": 0, "creation_date": 1515612891, "post_id": 48194782, "comment_id": 83370330, "body": "Thanks, it solves this part, but I don&#39;t really know if it helps, because i need to have them in some kind of order. I&#39;m not sure, but dictonaries don&#39;t have indexes right?"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 55, "user_id": 7495284, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-pbzJ960k3sw/AAAAAAAAAAI/AAAAAAAATvY/vhDp06aUK-0/photo.jpg?sz=128", "display_name": "Tom&#225;\u0161 Hobza", "link": "https://stackoverflow.com/users/7495284/tom%c3%a1%c5%a1-hobza"}, "edited": false, "score": 0, "creation_date": 1515612986, "post_id": 48194782, "comment_id": 83370389, "body": "Correct, dictionaries have keys (string)."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 55, "user_id": 7495284, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-pbzJ960k3sw/AAAAAAAAAAI/AAAAAAAATvY/vhDp06aUK-0/photo.jpg?sz=128", "display_name": "Tom&#225;\u0161 Hobza", "link": "https://stackoverflow.com/users/7495284/tom%c3%a1%c5%a1-hobza"}, "edited": false, "score": 0, "creation_date": 1515613097, "post_id": 48194782, "comment_id": 83370449, "body": "You can still use a numeric value as key but you will have to convert it to string <code>CStr(Number)</code>."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1515613772, "post_id": 48194782, "comment_id": 83370783, "body": "Dictionaries are allowed to have numeric keys.  The key can actually be just about anything.  (I had one question which was caused because they were doing something like <code>If Not objDict.Exists(Cells(i, 1)) Then objDict.Add Cells(i, 1), vbNullString</code> and they were wondering why <b>every</b> cell&#39;s value was added even though there were duplicate values.  The problem was that the key was the <code>Range</code> objects and <code>Cells(5, 1)</code>, for instance, was a different object to <code>Cells(6, 1)</code>, even if the two cells had the same <code>Value</code> property, i.e. the <code>.Value</code> needed to be explicitly used for the key.)"}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1515612894, "last_edit_date": 1515612894, "creation_date": 1515612725, "answer_id": 48194782, "question_id": 48194581, "link": "https://stackoverflow.com/questions/48194581/invalid-qualifier-error-with-array-contains/48194782#48194782", "title": "&quot;invalid qualifier&quot; error with array.Contains", "body": "<p>There is no <code>.Contains</code> method in VBA.</p>\n\n<p>You can achieve the same thing using a <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/dictionary-object\" rel=\"nofollow noreferrer\">Dictionary</a> object which has the <code>.Exist</code> function to check if a Key exists or not.</p>\n\n<pre><code>Dim objDict As Object\nSet objDict = CreateObject(\"Scripting.Dictionary\")\nDim TotalRows As Long\nDim i As Long\n\nTotalRows = Rows(Rows.Count).End(xlUp).Row\n\nFor i = 2 To TotalRows\n    If Not objDict.Exists(Cells(i, 1).Value) Then\n        objDict.Add Cells(i, 1).Value, vbNullString\n    End If\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 7495284, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-pbzJ960k3sw/AAAAAAAAAAI/AAAAAAAATvY/vhDp06aUK-0/photo.jpg?sz=128", "display_name": "Tom&#225;\u0161 Hobza", "link": "https://stackoverflow.com/users/7495284/tom%c3%a1%c5%a1-hobza"}, "edited": false, "score": 0, "creation_date": 1515613507, "post_id": 48194799, "comment_id": 83370655, "body": "Thanks a lot. I had on my mind that I would go through it with a for loop, but I didn&#39;t know how. Thanks"}], "tags": [], "owner": {"reputation": 145, "user_id": 8972359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe81755a07f76574d252cd0c2db4e6c?s=128&d=identicon&r=PG&f=1", "display_name": "R.Laney", "link": "https://stackoverflow.com/users/8972359/r-laney"}, "is_accepted": true, "score": 2, "last_activity_date": 1515612786, "creation_date": 1515612786, "answer_id": 48194799, "question_id": 48194581, "link": "https://stackoverflow.com/questions/48194581/invalid-qualifier-error-with-array-contains/48194799#48194799", "title": "&quot;invalid qualifier&quot; error with array.Contains", "body": "<p>The variable strArray is a plain array of type string not a List or other object so it doesn't have a \"Contains\" method you will have to do something like:</p>\n\n<pre><code>Dim strArray() As String\nDim TotalRows As Long\nDim i As Long\n\nTotalRows = Rows(Rows.Count).End(xlUp).Row\nReDim strArray(1 To TotalRows)\n\nFor i = 2 To TotalRows\n    Dim x As Long\n    Dim contains As Boolean\n    contains = False\n    For x = LBound(strArray) To UBound(strArray)\n        If strArray(x) = Cells(i, 1).Value Then\n            contains = True\n        End If\n    Next\n    If Not contains Then\n        strArray(i) = Cells(i, 1).Value\n    End If\nNext\n</code></pre>\n\n<p>Note that Lbound and Ubound will get the upper and lower bound of the array which can change because you Redim the array.  You could also just use 1 to TotalRows since you \"know\" the size of the array but since I don't know how complex your actual code is I include Lbaound and Ubound in case you need them in your actual code.</p>\n"}], "owner": {"reputation": 55, "user_id": 7495284, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-pbzJ960k3sw/AAAAAAAAAAI/AAAAAAAATvY/vhDp06aUK-0/photo.jpg?sz=128", "display_name": "Tom&#225;\u0161 Hobza", "link": "https://stackoverflow.com/users/7495284/tom%c3%a1%c5%a1-hobza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 0, "accepted_answer_id": 48194799, "answer_count": 2, "score": 1, "last_activity_date": 1515613963, "creation_date": 1515611830, "last_edit_date": 1515613963, "question_id": 48194581, "link": "https://stackoverflow.com/questions/48194581/invalid-qualifier-error-with-array-contains", "title": "&quot;invalid qualifier&quot; error with array.Contains", "body": "<p>my father wanted a macro in Excel, but for that kind of problem he needs Visual Basic. I decided to help him, but I never wrote a Visual Basic code so I was kind of putting the code together from internet forums and mnsd, but then I ran into this problem and I don't know how to solve it.</p>\n\n<pre><code>    Dim strArray() As String\n    Dim TotalRows As Long\n    Dim i As Long\n\n    TotalRows = Rows(Rows.Count).End(xlUp).Row\n    ReDim strArray(1 To TotalRows)\n\n    For i = 2 To TotalRows\n        If Not strArray.Contains(Cells(i, 1).Value) Then\n            strArray(i) = Cells(i, 1).Value\n        End If\n    Next\n</code></pre>\n\n<p>This is only a part of the code, but here is the bug. \nIt show an error that says </p>\n\n<blockquote>\n  <p>\"Invalid qualifier\"</p>\n</blockquote>\n\n<p>and highlights <code>strArray</code> in <code>strArray.Contains(Cells...</code>. I can't solve it so I'm asking here. I think that there is a really easy solution, but I wasn't able to find it online.</p>\n\n<p>Thanks in advice\nTomas</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1344, "user_id": 8521346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5adedecc5904449d9b448df60d69f5fc?s=128&d=identicon&r=PG&f=1", "display_name": "Bigbob556677", "link": "https://stackoverflow.com/users/8521346/bigbob556677"}, "edited": false, "score": 0, "creation_date": 1515612051, "post_id": 48194558, "comment_id": 83369913, "body": "Is the value of semimoleeftover possibly greater than the number of days in a month? and is DueDate declared as a &quot;Date&quot; type?"}, {"owner": {"reputation": 21, "user_id": 7406425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efb46679ef8951446ed3d9c23afa2de2?s=128&d=identicon&r=PG&f=1", "display_name": "Ojay", "link": "https://stackoverflow.com/users/7406425/ojay"}, "reply_to_user": {"reputation": 1344, "user_id": 8521346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5adedecc5904449d9b448df60d69f5fc?s=128&d=identicon&r=PG&f=1", "display_name": "Bigbob556677", "link": "https://stackoverflow.com/users/8521346/bigbob556677"}, "edited": false, "score": 0, "creation_date": 1515612693, "post_id": 48194558, "comment_id": 83370241, "body": "No and yes. The value of semimoleftover if you look is DaysToAdd Mod 15 where DaysToAdd = 25 in the example I&#39;m using, which makes semimoleftover = 10. DueDate is declared as Dim DueDate as Date at the top."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1515614012, "post_id": 48194558, "comment_id": 83370920, "body": "I can not replicate your problem, but this is what DateSerial is defined as - Returns a Date value representing a specified year, month, and day, with the time information set to midnight (00:00:00)."}, {"owner": {"reputation": 21, "user_id": 7406425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efb46679ef8951446ed3d9c23afa2de2?s=128&d=identicon&r=PG&f=1", "display_name": "Ojay", "link": "https://stackoverflow.com/users/7406425/ojay"}, "edited": false, "score": 0, "creation_date": 1515701439, "post_id": 48194558, "comment_id": 83411932, "body": "Thanks for your time mooseman...I actually figured it out on my own. Yes, it was returning correct value I was just overriding it with other lines from my code beneath it."}], "owner": {"reputation": 21, "user_id": 7406425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efb46679ef8951446ed3d9c23afa2de2?s=128&d=identicon&r=PG&f=1", "display_name": "Ojay", "link": "https://stackoverflow.com/users/7406425/ojay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1515613864, "creation_date": 1515611738, "last_edit_date": 1515613864, "question_id": 48194558, "link": "https://stackoverflow.com/questions/48194558/vba-dateserial-function-returning-1200-am-even-though-the-3-inputs-are-correct", "title": "VBA DateSerial function returning 12:00 AM even though the 3 inputs are correct", "body": "<p>Can someone please look at this piece of VBA code and tell me how its possible for VBA to return 12:00 am for DateSerial?</p>\n\n<pre><code>            If CurrentDay &lt;= 15 And DaysToAdd &lt;= 15 Then\n                DueDate = DateSerial(Year(Today), Month(Today), DaysToAdd)\n            ElseIf CurrentDay &lt;= 15 And DaysToAdd &gt; 15 Then                                           \n                If (DaysToAdd / 15) &gt; 1 Then\n                    semimoleftover = DaysToAdd Mod 15\n                Else\n                    semimoleftover = 0\n                End If\n                DueDate = DateSerial(Year(Today), Month(Today), semimoleftover + 15)\n            End If\n</code></pre>\n\n<p>Variable semimoleftover is an integer value, and Today is a date variable with today's date. I'm baffled why vba would return 12:00 am when the inputs seem to be correct. What's even more confounding is I had this exact code before and it was returning the date with no issues before. Any help would be appreciated. Thank you! EDIT: I solved this on my own. DateSerial was producing the correct value it's just that I had another line of code that was overriding my DueDate value later.</p>\n"}, {"tags": ["excel", "import", "ms-word", "bookmarks", "vba"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 7648504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ba976dd64539f4931f610898d762500?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude", "link": "https://stackoverflow.com/users/7648504/the-dude"}, "edited": false, "score": 0, "creation_date": 1515612459, "post_id": 48194662, "comment_id": 83370118, "body": "Thanks for the reply, I had it as .text (for both ws.range and wddoc.bookmarks) before, it still was giving me the same error. The bookmark is a selection, or at least should be."}, {"owner": {"reputation": 181, "user_id": 6850280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525e4db5ded7a05307f423fd469f935e?s=128&d=identicon&r=PG&f=1", "display_name": "matt2103", "link": "https://stackoverflow.com/users/6850280/matt2103"}, "reply_to_user": {"reputation": 35, "user_id": 7648504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ba976dd64539f4931f610898d762500?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude", "link": "https://stackoverflow.com/users/7648504/the-dude"}, "edited": false, "score": 0, "creation_date": 1515612838, "post_id": 48194662, "comment_id": 83370304, "body": "Try: ws.Range(&quot;H&quot; &amp; (nextRow.Row)).Value = wdDoc.Bookmarks(&quot;Named_Insured&quot;).Range.Text"}, {"owner": {"reputation": 181, "user_id": 6850280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525e4db5ded7a05307f423fd469f935e?s=128&d=identicon&r=PG&f=1", "display_name": "matt2103", "link": "https://stackoverflow.com/users/6850280/matt2103"}, "reply_to_user": {"reputation": 35, "user_id": 7648504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ba976dd64539f4931f610898d762500?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude", "link": "https://stackoverflow.com/users/7648504/the-dude"}, "edited": false, "score": 1, "creation_date": 1515612896, "post_id": 48194662, "comment_id": 83370334, "body": "I think the issue you&#39;re having is that the first section needs to be written for Excel (which typically uses .Value) and the second portion needs to be written for Word (which doesn&#39;t use .Value at all)"}, {"owner": {"reputation": 35, "user_id": 7648504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ba976dd64539f4931f610898d762500?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude", "link": "https://stackoverflow.com/users/7648504/the-dude"}, "edited": false, "score": 0, "creation_date": 1515613769, "post_id": 48194662, "comment_id": 83370780, "body": "Originally that&#39;s how I had it (I just reversed the export code). I&#39;ve gone through just about every combination since then and every time I hit this wall."}, {"owner": {"reputation": 181, "user_id": 6850280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525e4db5ded7a05307f423fd469f935e?s=128&d=identicon&r=PG&f=1", "display_name": "matt2103", "link": "https://stackoverflow.com/users/6850280/matt2103"}, "reply_to_user": {"reputation": 35, "user_id": 7648504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ba976dd64539f4931f610898d762500?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude", "link": "https://stackoverflow.com/users/7648504/the-dude"}, "edited": false, "score": 0, "creation_date": 1515614580, "post_id": 48194662, "comment_id": 83371217, "body": "Just edited my answer after troubleshooting and testing on my own.  Your wdDoc object wasn&#39;t working quite right--basically just switch it out for ActiveDocument and the code should work just fine."}, {"owner": {"reputation": 35, "user_id": 7648504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ba976dd64539f4931f610898d762500?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude", "link": "https://stackoverflow.com/users/7648504/the-dude"}, "edited": false, "score": 0, "creation_date": 1515617969, "post_id": 48194662, "comment_id": 83372921, "body": "This edit seems to be the right path to go, however, it&#39;s telling me no activate document is set and breaking on the same line. Did you call/open the document in another way?"}, {"owner": {"reputation": 35, "user_id": 7648504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ba976dd64539f4931f610898d762500?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude", "link": "https://stackoverflow.com/users/7648504/the-dude"}, "edited": false, "score": 1, "creation_date": 1515618861, "post_id": 48194662, "comment_id": 83373374, "body": "Got it, for anyone else in the future looking for answers I changed the   <code>set wdDoc = Createobject</code>   and everything after it to   <code>Set wdDoc = Documents.Open(Filename:=wdFileName)</code>"}], "tags": [], "owner": {"reputation": 181, "user_id": 6850280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525e4db5ded7a05307f423fd469f935e?s=128&d=identicon&r=PG&f=1", "display_name": "matt2103", "link": "https://stackoverflow.com/users/6850280/matt2103"}, "is_accepted": true, "score": 1, "last_activity_date": 1515614494, "last_edit_date": 1515614494, "creation_date": 1515612191, "answer_id": 48194662, "question_id": 48194469, "link": "https://stackoverflow.com/questions/48194469/importing-word-bookmarks-to-excel/48194662#48194662", "title": "Importing Word Bookmarks to Excel", "body": "<p>Step 1: In the VBA window, click on \"Tools\" then \"References\" and make sure that there is a checkbox next to \"Microsoft Word xx.0 Object Library\"</p>\n\n<p>Step 2: Change the problem line to-</p>\n\n<pre><code>ws.Range(\"H\" &amp; (nextRow.Row)).Value = _\nActiveDocument.Bookmarks(\"Name_Insured\").Range.Text\n</code></pre>\n\n<p>Step 3: Change the last line to-</p>\n\n<pre><code>ActiveDocument.Close SaveChanges:=False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1515637342, "creation_date": 1515637342, "answer_id": 48198932, "question_id": 48194469, "link": "https://stackoverflow.com/questions/48194469/importing-word-bookmarks-to-excel/48198932#48198932", "title": "Importing Word Bookmarks to Excel", "body": "<p>You could use Bookmarks, like this.</p>\n\n<pre><code>Sub PushToWord()\n\nDim objWord As New Word.Application\nDim doc As Word.Document\nDim bkmk As Word.Bookmark\nsWdFileName = Application.GetOpenFilename(, , , , False)\nSet doc = objWord.Documents.Open(sWdFileName)\nOn Error Resume Next\n\n    ActiveDocument.Variables(\"BrokerFirstName\").Value = Range(\"B1\").Value\n    ActiveDocument.Variables(\"BrokerLastName\").Value = Range(\"B2\").Value\n    ActiveDocument.Fields.Update\n\nOn Error Resume Next\nobjWord.Visible = True\n\nEnd Sub\n</code></pre>\n\n<p>Or, use DocVariables, as such.</p>\n\n<pre><code>Sub PushToWord()\n\nDim objWord As New Word.Application\nDim doc As Word.Document\nDim bkmk As Word.Bookmark\nsWdFileName = Application.GetOpenFilename(, , , , False)\nSet doc = objWord.Documents.Open(sWdFileName)\n'On Error Resume Next\n\nobjWord.ActiveDocument.variables(\"BrokerFirstName\").Value = Range(\"BrokerFirstName\").Value\nobjWord.ActiveDocument.variables(\"BrokerLastName\").Value = Range(\"BrokerLastName\").Value\nobjWord.ActiveDocument.variables(\"Ryan\").Value = Range(\"Ryan\").Value\n\n\nobjWord.ActiveDocument.Fields.Update\n\n'On Error Resume Next\nobjWord.Visible = True\n\nEnd Sub\n</code></pre>\n\n<p>BTW, you run these code samples from Excel, not from Word.</p>\n"}], "owner": {"reputation": 35, "user_id": 7648504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ba976dd64539f4931f610898d762500?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude", "link": "https://stackoverflow.com/users/7648504/the-dude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1061, "favorite_count": 0, "accepted_answer_id": 48194662, "answer_count": 2, "score": 1, "last_activity_date": 1515650670, "creation_date": 1515611326, "last_edit_date": 1531161705, "question_id": 48194469, "link": "https://stackoverflow.com/questions/48194469/importing-word-bookmarks-to-excel", "title": "Importing Word Bookmarks to Excel", "body": "<p>I am trying to import Word Bookmarks into specific Excel cells from a selected Word document. I have one macro that takes the excel data and fills it into a Word template. I need to also be able to take that word document and import it back into Excel. This is what I have so far:</p>\n\n<pre><code>Sub Import()\nDim wdDoc As Object\nDim wdFileName As Variant\nDim ws As Worksheet\nDim nextRow As Range\n\nwdFileName = Application.GetOpenFilename(\"Word files,*.doc;*.docx\", , _\n\"Browse for document\") 'dialog box\n    If wdFileName = False Then\n        MsgBox \"No File Selected.\"\n        Exit Sub\n    Else\n        Set wdDoc = CreateObject(\"Word.Application\")\n        wdDoc.Visible = True\n            On Error Resume Next\n        wdDoc.Documents.Open Filename:=wdFileName\n            On Error GoTo 0\n        wdDoc.Documents(wdFileName).Activate\n            On Error GoTo 0\n    End If\n\n\nWith wdDoc 'start import\n\nSet ws = ThisWorkbook.Sheets(\"Sheet1\")\nSet nextRow = Cells(Rows.Count, \"B\").End(xlUp).Offset(1)\n\nws.Range(\"H\" &amp; (nextRow.Row)).Value2 = wdDoc.Bookmarks(\"Bookmark1\").Range.Value2\n\nEnd With\nwdDoc.Close SaveChanges:=False\nEnd Sub\n</code></pre>\n\n<p>I'm getting \"Run-Time:438 / Object doesn't support this property or method\" on the line \"ws.Range(\"H\" &amp; (nextRow.Row)).Value2 = wdDoc.Bookmarks(\"Named_Insured\").Range.Value2\"</p>\n\n<p>What am I overlooking here?</p>\n"}, {"tags": ["arrays", "vba", "algorithm", "matrix"], "comments": [{"owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 2, "creation_date": 1515611148, "post_id": 48194403, "comment_id": 83369494, "body": "Why are you shuffling 250 times? Implement a <a href=\"https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle\" rel=\"nofollow noreferrer\">correct shuffle</a> and execute it once. Adding iterations doesn&#39;t make it &quot;more random&quot;."}, {"owner": {"reputation": 11, "user_id": 9189711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/319d70995e62efb2f354e7c39d1c373a?s=128&d=identicon&r=PG&f=1", "display_name": "John Analytics", "link": "https://stackoverflow.com/users/9189711/john-analytics"}, "reply_to_user": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 0, "creation_date": 1515611476, "post_id": 48194403, "comment_id": 83369657, "body": "As you can see I want to populate a 100,000x250 matrix which is why I need to shuffle the array 250 times.  The first loop is used to increment the columns of the matrix."}, {"owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 0, "creation_date": 1515611904, "post_id": 48194403, "comment_id": 83369852, "body": "Oh I see what you&#39;re doing now. Yes, you can set up a 2d array and assign it to a range. Example: <a href=\"https://stackoverflow.com/questions/34733061/excel-vba-assign-values-of-2d-array-to-range-of-cells\" title=\"excel vba assign values of 2d array to range of cells\">stackoverflow.com/questions/34733061/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1531971"}, "edited": false, "score": 1, "creation_date": 1515612019, "post_id": 48194403, "comment_id": 83369898, "body": "This question is best answered by someone (probably you) running some benchmarks and seeing where the actual hotspots are. Without knowing <i>where</i> the time is spent your guesses are probably wrong."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1515612240, "post_id": 48194403, "comment_id": 83370010, "body": "Taking the cell-writing instruction out of the outer loop would probably speed this up by an order of magnitude already. Populate one single 2D array, drop it onto the worksheet <i>once</i>."}, {"owner": {"reputation": 11, "user_id": 9189711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/319d70995e62efb2f354e7c39d1c373a?s=128&d=identicon&r=PG&f=1", "display_name": "John Analytics", "link": "https://stackoverflow.com/users/9189711/john-analytics"}, "reply_to_user": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 0, "creation_date": 1515612475, "post_id": 48194403, "comment_id": 83370126, "body": "@Blorgbeard Correct me if I am wrong but you are suggesting that I first create a 100,000x250 array and then shuffle it?"}, {"owner": {"reputation": 11, "user_id": 9189711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/319d70995e62efb2f354e7c39d1c373a?s=128&d=identicon&r=PG&f=1", "display_name": "John Analytics", "link": "https://stackoverflow.com/users/9189711/john-analytics"}, "edited": false, "score": 0, "creation_date": 1515612643, "post_id": 48194403, "comment_id": 83370219, "body": "@jdv each iteration of i takes 0.3seconds i.e. more than a minute for 250 columns and I need to run this simulation several times which is why it is not ideal"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1531971"}, "edited": false, "score": 0, "creation_date": 1515612797, "post_id": 48194403, "comment_id": 83370283, "body": "You need to know what in the loop is taking so long, otherwise unrolling selectively may do nothing. Benchmark and keep doing so so you can see the how things change as you tweak the code. Related: <a href=\"https://stackoverflow.com/q/7103552/1531971\">stackoverflow.com/q/7103552/1531971</a>"}, {"owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 0, "creation_date": 1515613589, "post_id": 48194403, "comment_id": 83370693, "body": "No, I&#39;m suggesting you create a 100000x250 array, populate it via shuffling the source array repeatedly, and then assign it to a range."}, {"owner": {"reputation": 11, "user_id": 9189711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/319d70995e62efb2f354e7c39d1c373a?s=128&d=identicon&r=PG&f=1", "display_name": "John Analytics", "link": "https://stackoverflow.com/users/9189711/john-analytics"}, "reply_to_user": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 0, "creation_date": 1515613896, "post_id": 48194403, "comment_id": 83370847, "body": "@Blorgbeard oh I see yea this would actually be much faster! I am not sure how to implement this though .... Assuming I define the array as      myArray = Range(&quot;A1:A100000&quot;).Value  How should I proceed to augment the array from (100000,1) to (100000,250)? Thanks a lot!!"}, {"owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 0, "creation_date": 1515615800, "post_id": 48194403, "comment_id": 83371841, "body": "I&#39;d make a new array <code>Dim output(100000,250) as Integer</code> and fill that up, then <code>Range(whatever) = output</code> at the end."}, {"owner": {"reputation": 11, "user_id": 9189711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/319d70995e62efb2f354e7c39d1c373a?s=128&d=identicon&r=PG&f=1", "display_name": "John Analytics", "link": "https://stackoverflow.com/users/9189711/john-analytics"}, "reply_to_user": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 0, "creation_date": 1515620302, "post_id": 48194403, "comment_id": 83374000, "body": "@Blorgbeard Populating the new 100000x250 array still requires me to go through two For statements though correct?     For x = 1 to 100000         For y = 1 to 250           output(x,y) = 1 (for example)"}, {"owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 0, "creation_date": 1515622714, "post_id": 48194403, "comment_id": 83375064, "body": "Yes, but that&#39;s fine. Nested loops are &quot;slow&quot; only because the number of iterations is high. There&#39;s no way around the fact that you have to write 100000x250 integers. A single loop from 0 to (100000*250) would be about the same speed as the nested loops. The point is that you&#39;d only only writing to the Excel sheet once - that&#39;s the slow bit."}, {"owner": {"reputation": 11, "user_id": 9189711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/319d70995e62efb2f354e7c39d1c373a?s=128&d=identicon&r=PG&f=1", "display_name": "John Analytics", "link": "https://stackoverflow.com/users/9189711/john-analytics"}, "reply_to_user": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 0, "creation_date": 1515623196, "post_id": 48194403, "comment_id": 83375256, "body": "@Blorgbeard makes sense and it already looks like my code runs much faster! Thanks a lot!"}, {"owner": {"reputation": 11, "user_id": 9189711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/319d70995e62efb2f354e7c39d1c373a?s=128&d=identicon&r=PG&f=1", "display_name": "John Analytics", "link": "https://stackoverflow.com/users/9189711/john-analytics"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515623227, "post_id": 48194403, "comment_id": 83375265, "body": "@Mat&#39;sMug I just realized you had suggested the same thing - thanks a lot!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515623543, "post_id": 48194403, "comment_id": 83375382, "body": "No problem. May I suggest to get rid of the type hint characters? <code>1</code> and <code>-1</code> would work exactly the same as <code>1&amp;</code> and <code>-1&amp;</code>, without the need to look twice to see the literal integer value. Also I don&#39;t see a need for reversing that loop at all, why would the bottom-to-top matter, if the thing is <i>shuffling</i> (unless I missed something)? Reduce the useless cognitive load on that code, it&#39;ll be easier to maintain."}, {"owner": {"reputation": 11, "user_id": 9189711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/319d70995e62efb2f354e7c39d1c373a?s=128&d=identicon&r=PG&f=1", "display_name": "John Analytics", "link": "https://stackoverflow.com/users/9189711/john-analytics"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515623899, "post_id": 48194403, "comment_id": 83375523, "body": "@Mat&#39;sMug I set this up for an earlier version of the script and it made sense at the time but you&#39;re completely right thanks for the tips!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515624032, "post_id": 48194403, "comment_id": 83375579, "body": "My pleasure - one last nitpick: <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indentation</a> could be more consistent ;-)"}], "owner": {"reputation": 11, "user_id": 9189711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/319d70995e62efb2f354e7c39d1c373a?s=128&d=identicon&r=PG&f=1", "display_name": "John Analytics", "link": "https://stackoverflow.com/users/9189711/john-analytics"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1515610959, "creation_date": 1515610959, "question_id": 48194403, "link": "https://stackoverflow.com/questions/48194403/vba-faster-performance-array-shuffling-algorithm", "title": "vba faster performance array shuffling algorithm", "body": "<p>I am running the below algorithm on an array of 100k items (I would like to expand it to 1m if possible) and am facing performance issues. I would like to reduce the processing time down to a few seconds. I am pretty sure the first loop is causing the code to slow down. Is it possible to automatically shuffle the array 250 times, to populate a matrix and then simply paste it? - instead of going through 250 separate connections between vba and excel.</p>\n\n<pre><code>For a = 0 To 249        \n        For i = UBound(myArray , 1) To 1&amp; Step -1&amp;\n                NewRow= Int(Rnd() * i) + 1&amp;\n                temp = myArray (i, 1)\n                myArray (i, 1) = myArray (NewRow, 1)\n                myArray(NewRow, 1) = temp\n        Next i            \n    Range(Cells(1, a + 1), Cells(LastRow, a + 1)).Value = myArray                     \nNext a\n</code></pre>\n\n<p>any help is appreciated!!\nThanks! \nJohn</p>\n"}, {"tags": ["excel", "loops", "adobe", "acrobat", "vba"], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 8370017, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/df8436a149272ffa90ed97977aa62101?s=128&d=identicon&r=PG&f=1", "display_name": "kroy2008", "link": "https://stackoverflow.com/users/8370017/kroy2008"}, "edited": false, "score": 0, "creation_date": 1516203804, "post_id": 48274146, "comment_id": 83594699, "body": "when I add the Application.Wait command between SelectAll and Copy it ends up pasting the Application.Wait command into A1 of my sheet, instead of the contents of the PDF...where have I gone wrong here?"}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "reply_to_user": {"reputation": 165, "user_id": 8370017, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/df8436a149272ffa90ed97977aa62101?s=128&d=identicon&r=PG&f=1", "display_name": "kroy2008", "link": "https://stackoverflow.com/users/8370017/kroy2008"}, "edited": false, "score": 0, "creation_date": 1516204464, "post_id": 48274146, "comment_id": 83595150, "body": "It&#39;s probably because you just copied it from this question and it is still in your clipboard. That could mean that <code>oPDFApp.MenuItemExecute (&quot;Copy&quot;)</code> does not register properly or something similar. When debugging through your code (using F8), do you see the Acrobat application appear on screen?"}], "tags": [], "owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "is_accepted": false, "score": 0, "last_activity_date": 1516118467, "last_edit_date": 1516118467, "creation_date": 1516077148, "answer_id": 48274146, "question_id": 48193973, "link": "https://stackoverflow.com/questions/48193973/loop-not-opening-pdfs-so-copy-paste-to-excel-fails-i-think/48274146#48274146", "title": "Loop not opening PDFs...so copy/Paste to Excel fails (I think)", "body": "<p>If you want to make sure to generate an error when the opening operation does not succeed, I would add the following at the end of TroubleshootingOpeningPDFLoop:</p>\n\n<pre><code>If oPDDoc is nothing then\n    Debug.Assert False\nEnd If\n</code></pre>\n\n<p>If this doesn't return an error, that means that the file is open in the application, but that it is not visible. It could be caused by the fact that you are using a PDDoc instead of an AVDoc. So, switching the 2 might allow you to see it when debugging.</p>\n\n<p>As of your main problem, it might be due to the fact that Acrobat does not process the commands fast enough and you need to include some waiting time in your code to let Acrobat enough time to process the command. For example, you could have: </p>\n\n<pre><code>'Copy all using Acrobat menu\noPDFApp.MenuItemExecute (\"SelectAll\")\nApplication.Wait TimeSerial(Hour(Now()), Minute(Now()), Second(Now()) + 1)\noPDFApp.MenuItemExecute (\"Copy\")\n</code></pre>\n\n<p>Which will make VBA wait one second before running the next command.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9368793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0383ad2d94446e44b1d575404eeaa?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Middelburg", "link": "https://stackoverflow.com/users/9368793/peter-middelburg"}, "is_accepted": false, "score": 1, "last_activity_date": 1518775925, "creation_date": 1518775925, "answer_id": 48824416, "question_id": 48193973, "link": "https://stackoverflow.com/questions/48193973/loop-not-opening-pdfs-so-copy-paste-to-excel-fails-i-think/48824416#48824416", "title": "Loop not opening PDFs...so copy/Paste to Excel fails (I think)", "body": "<p>I am having cut/copy - paste troubles lately (runtime error 1004)\nUsing the latest Excel but also working on \"ancient\" applications.\nWhat did the trick for me was working with the original \"given\" name\n(Sheet1,Sheet2 etc. As soon as I added/renamed the same sheets, the runtime errors came back.</p>\n"}], "owner": {"reputation": 165, "user_id": 8370017, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/df8436a149272ffa90ed97977aa62101?s=128&d=identicon&r=PG&f=1", "display_name": "kroy2008", "link": "https://stackoverflow.com/users/8370017/kroy2008"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 532, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1518775925, "creation_date": 1515609070, "last_edit_date": 1531161705, "question_id": 48193973, "link": "https://stackoverflow.com/questions/48193973/loop-not-opening-pdfs-so-copy-paste-to-excel-fails-i-think", "title": "Loop not opening PDFs...so copy/Paste to Excel fails (I think)", "body": "<p><strong>Apologies in advance for the length of this post, but I wanted to describe my issues in detail in the hopes one of you VBA masters can assist</strong></p>\n\n<p><strong>Goal</strong></p>\n\n<ol>\n<li>Loop through all PDFs in a folder </li>\n<li>For each PDF:select all/copy/paste into Excel</li>\n<li>Call a separate macro to convert the pasted data into something\nlegible.</li>\n</ol>\n\n<p><strong>Background</strong>\nThe below sub [CopyPDFtoExcel()] worked yesterday but is now failing on the ActiveSheet.Paste line with the </p>\n\n<blockquote>\n  <p>\"Runtime error '1004' Paste method of Worksheet class failed\".</p>\n</blockquote>\n\n<p>If I step though (via <kbd>F8</kbd>), it appears to NOT be actually opening the PDF, and therefor is unable to select all/copy/paste, producing the Runtime error. However, I do not get an error dialog, which I would think I would get (from the <code>Debug.Assert False</code>) if it can't find the file.</p>\n\n<p>My fName's are defined as variable via a named range called <code>path2008</code>. These file paths were derived by running <code>PullFilePathsforPDFs()</code>, which spits out the full file path for each PDF in my folder. Then, I have selected those file paths and given it a name, in this case <code>path2008</code>, which is for 13 different PDFs. <em>NOTE: There are actually 250+ PDFs in this folder but I selected a subset for testing, hence the 13 associated with <code>path2008</code>.</em></p>\n\n<p><strong>What I have done so far</strong></p>\n\n<ol>\n<li><p>Tested the file path for each PDF in the path2008 range by using the\n(cumbersome non-looping) ActiveWorkbook.FollowHyperlink method,\nwhich successfully opens all the PDFs. So, I'm pretty confident the\nfile paths are correct.</p>\n\n<pre><code>'ActiveWorkbook.FollowHyperlink \"file path here\" \n</code></pre></li>\n<li><p>Stripped out the select all/copy/paste VBA code, leaving just the\nloop [See the sub TroubleshootingOpeningPDFLoop()]. When I step\nthrough the FIRST time the yellow line goes from the Set oPDDoc =\noAVDoc.GetPDDoc line to the End If....presumabley meaning it found a\nfile during the first loop (though I do not see the PDF open). On\nthe SECOND (and all subsequent loops) it goes to Else then\nDebug.Assert False (but no error dialog appears).</p></li>\n<li><p>Restarted Excel and Acrobat, same issue</p></li>\n<li><p>Restarted computer, same issue</p></li>\n<li><p>Recreated a new workbook, same issue</p></li>\n</ol>\n\n<p>Main code</p>\n\n<pre><code>Sub CopyPDFtoExcel()\nDim fName       As Variant\nDim wbPayroll As Excel.Workbook\nDim wsConvert       As Excel.Worksheet\nDim oPDFApp     As AcroApp\nDim oAVDoc      As AcroAVDoc\nDim oPDDoc      As AcroPDDoc\n\nSet wbPayroll = Workbooks(\"Payroll.xlsm\")\nSet wsConvert= wbPayroll.Sheets(\"Convert\")\n\nSet oPDFApp = CreateObject(\"AcroExch.App\")\nSet oAVDoc = CreateObject(\"AcroExch.AVDoc\")\nSet oPDDoc = CreateObject(\"AcroExch.PDDoc\")\n\n'Open the PDF file. The AcroAVDoc.Open function returns a true/false \nFor Each fName In Range(\"path2008\")\nIf oAVDoc.Open(fName.Text, \"\") = True Then\n    Set oPDDoc = oAVDoc.GetPDDoc\nElse\n    Debug.Assert False\nEnd If\n\n'Copy all using Acrobat menu\noPDFApp.MenuItemExecute (\"SelectAll\")\noPDFApp.MenuItemExecute (\"Copy\")\n\n'Paste into Convert sheet\nwbPayroll.Activate\nwsConvert.Cells(1, 1).Select\nActiveSheet.Paste 'It worked yesterday, but now error on this line with below error\n'Runtime error '1004' Paste method of Worksheet class failed\n\noAVDoc.Close (1)    '(1)=Do not save changes\n'oPDDoc.Close\nCall ConversionMacro\nNext\n\n'Clean up\nSet wbTransfer = Nothing\nSet wsNew = Nothing\nSet oPDFApp = Nothing\nSet oAVDoc = Nothing\nSet oPDDoc = Nothing\nEnd Sub\n</code></pre>\n\n<p>My effort to isolate the PDF open failure problem</p>\n\n<pre><code>Sub TroubleshootingOpeningPDFLoop()\nDim fName       As Variant\nDim wbPayroll As Excel.Workbook\nDim wsConvert       As Excel.Worksheet\nDim oPDFApp     As AcroApp\nDim oAVDoc      As AcroAVDoc\nDim oPDDoc      As AcroPDDoc\n\n'Define your spreadsheet\nSet wbPayroll = Workbooks(\"Payroll.xlsm\")\nSet wsConvert= wbPayroll.Sheets(\"Convert\")\n\n'Instantiate Acrobat Objects\nSet oPDFApp = CreateObject(\"AcroExch.App\")\nSet oAVDoc = CreateObject(\"AcroExch.AVDoc\")\nSet oPDDoc = CreateObject(\"AcroExch.PDDoc\")\n\n'Open the PDF file. The AcroAVDoc.Open function returns a true/false \nFor Each fName In Range(\"path2008\")\nIf oAVDoc.Open(fName.Text, \"\") = True Then\n    Set oPDDoc = oAVDoc.GetPDDoc\nElse\n    Debug.Assert False\nEnd If\nNext\nEnd Sub\n</code></pre>\n\n<p>Sub used to pull the file paths</p>\n\n<pre><code>Sub PullFilePathsforPDFs()\nDim objFSO As Object\nDim objFolder As Object\nDim objFile As Object\nDim i As Long\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\n'Get the folder object\nSet objFolder = objFSO.GetFolder(\"D:\\Stuff\\MoreStuff\") 'all PDFs I need are stored here\ni = 1\nFor Each objFile In objFolder.Files\nCells(i + 1, 1) = objFile.Name\nCells(i + 1, 2) = objFile.Path\ni = i + 1\nNext objFile\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1515610270, "post_id": 48193906, "comment_id": 83369077, "body": "Try <code>If Link.innerText Like &quot;Demographic and Housing*&quot; Then</code>"}, {"owner": {"reputation": 26, "user_id": 9200119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ff019ff196dfefac8945452258d04b0?s=128&d=identicon&r=PG&f=1", "display_name": "Huan Qu", "link": "https://stackoverflow.com/users/9200119/huan-qu"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1515613747, "post_id": 48193906, "comment_id": 83370771, "body": "Sorry it doesn&#39;t work..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1515614319, "post_id": 48193906, "comment_id": 83371081, "body": "Can you show the rest of your code where you&#39;re loading the page?  If you put a break on the line <code>Link.Click</code> does it even get there?"}, {"owner": {"reputation": 26, "user_id": 9200119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ff019ff196dfefac8945452258d04b0?s=128&d=identicon&r=PG&f=1", "display_name": "Huan Qu", "link": "https://stackoverflow.com/users/9200119/huan-qu"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1515614670, "post_id": 48193906, "comment_id": 83371254, "body": "Please see my entire code , everything works untill this clicking link action"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1515615193, "post_id": 48193906, "comment_id": 83371511, "body": "What search value are you entering?"}, {"owner": {"reputation": 26, "user_id": 9200119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ff019ff196dfefac8945452258d04b0?s=128&d=identicon&r=PG&f=1", "display_name": "Huan Qu", "link": "https://stackoverflow.com/users/9200119/huan-qu"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1515618597, "post_id": 48193906, "comment_id": 83373245, "body": "Any city would work. I have &quot;Draper City&quot; in my cell A2"}], "answers": [{"comments": [{"owner": {"reputation": 26, "user_id": 9200119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ff019ff196dfefac8945452258d04b0?s=128&d=identicon&r=PG&f=1", "display_name": "Huan Qu", "link": "https://stackoverflow.com/users/9200119/huan-qu"}, "edited": false, "score": 0, "creation_date": 1515625387, "post_id": 48197222, "comment_id": 83376076, "body": "OMG I spend so many hours on this... I cannot thank you more!!! Thank you!!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1515623752, "creation_date": 1515623752, "answer_id": 48197222, "question_id": 48193906, "link": "https://stackoverflow.com/questions/48193906/vba-click-on-hyperlink-on-website/48197222#48197222", "title": "vba click on hyperlink on website", "body": "<p>This worked for me: the page is not fully loaded when you populate the links collection, so you need to add a short wait just before that.</p>\n\n<pre><code>Sub SearchBot()\n\n    Dim objIE As InternetExplorer\n    Dim aEle As Object 'HTMLLinkElement\n    Dim y As Integer\n    Dim result As String\n    Dim Link As Object\n    Dim ElementCol As Object\n\n    Set objIE = New InternetExplorer\n    objIE.Visible = True\n    objIE.navigate \"https://factfinder.census.gov/faces/nav/jsf/pages/community_facts.xhtml\"\n\n    WaitFor objIE\n\n    objIE.document.getElementById(\"cfsearchtextbox\").Value = \"Draper City\"\n    objIE.document.getElementById(\"communityfactssubmit\").Click\n\n    WaitFor objIE\n    Application.Wait Now + TimeSerial(0, 0, 2) '&lt;&lt;&lt;&lt;&lt;&lt; wait 2 sec\n\n    Set ElementCol = objIE.document.getElementsByTagName(\"a\")\n    For Each Link In ElementCol\n        Debug.Print Link.innerText\n        If Link.innerText Like \"Demographic and Housing Estimates*\" Then\n            Link.Click\n            Exit For\n        End If\n    Next Link\n\nEnd Sub\n\n'utility Sub: wait for page to load\nSub WaitFor(IE As Object)\n    While IE.readyState &lt;&gt; 4\n        DoEvents\n    Wend\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 26, "user_id": 9200119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ff019ff196dfefac8945452258d04b0?s=128&d=identicon&r=PG&f=1", "display_name": "Huan Qu", "link": "https://stackoverflow.com/users/9200119/huan-qu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2121, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1515623752, "creation_date": 1515608745, "last_edit_date": 1592644375, "question_id": 48193906, "link": "https://stackoverflow.com/questions/48193906/vba-click-on-hyperlink-on-website", "title": "vba click on hyperlink on website", "body": "<p>Hi I am trying to click on a hyperlink on a webpage: <a href=\"https://factfinder.census.gov/faces/nav/jsf/pages/community_facts.xhtml\" rel=\"nofollow noreferrer\">https://factfinder.census.gov/faces/nav/jsf/pages/community_facts.xhtml</a></p>\n<p>I want to click on the link:</p>\n<blockquote>\n<p>2016 American Community Survey</p>\n<p><strong>Demographic and Housing Estimates (Age, Sex, Race, Households and Housing, ...)</strong></p>\n</blockquote>\n<p>I have tried</p>\n<pre><code>   'start a new subroutine called SearchBot\n    Sub SearchBot()\n\n'dimension (declare or set aside memory for) our variables\nDim objIE As InternetExplorer 'special object variable representing the IE browser\nDim aEle As HTMLLinkElement 'special object variable for an &lt;a&gt; (link) element\nDim y As Integer 'integer variable we'll use as a counter\nDim result As String 'string variable that will hold our result link\nDim Link As Object\nDim ElementCol As Object\n\n'initiating a new instance of Internet Explorer and asigning it to objIE\nSet objIE = New InternetExplorer\n\n'make IE browser visible (False would allow IE to run in the background)\nobjIE.Visible = True\n\n'navigate IE to this web page (a pretty neat search engine really)\nobjIE.navigate &quot;https://factfinder.census.gov/faces/nav/jsf/pages/community_facts.xhtml&quot;\n\n'wait here a few seconds while the browser is busy\nWhile objIE.readyState &lt;&gt; 4\nDoEvents\nWend\n\n'in the search box put cell &quot;A2&quot; value\nobjIE.document.getElementById(&quot;cfsearchtextbox&quot;).Value = _\n  Sheets(&quot;Sheet1&quot;).Range(&quot;A2&quot;).Value\n\n'click the 'Add/Remove Geographies' button\nobjIE.document.getElementById(&quot;communityfactssubmit&quot;).Click\n\n'wait here a few seconds while the browser is busy\nWhile objIE.readyState &lt;&gt; 4\nDoEvents\nWend\n\n \n    Set ElementCol = objIE.document.getElementsByTagName(&quot;a&quot;)\n    For Each Link In ElementCol\n    If Link.innerHTML = &quot;Demographic and Housing Estimates (Age, Sex, Race,Households and Housing, ...)&quot; Then\n        Link.Click\n    End If\n    Next Link\n</code></pre>\n<p>It doesn't work. But I can click on link such as &quot;Feedback&quot;, &quot;FAQs&quot; using this method. Please help. Thank you!!!</p>\n<p>Here is the path to the link, I don't know if I can just use this to grab the link instead of trying to locate the text</p>\n<h1>cf-content &gt; div:nth-child(2) &gt; div.links &gt; ul:nth-child(4) &gt; li &gt; div &gt; a</h1>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1515608804, "post_id": 48193849, "comment_id": 83368279, "body": "See this: <a href=\"https://stackoverflow.com/questions/44992958/inputbox-cancel-different-from-vbnullstring-null/44993848#44993848\" title=\"inputbox cancel different from vbnullstring null\">stackoverflow.com/questions/44992958/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "edited": false, "score": 0, "creation_date": 1515608878, "post_id": 48193884, "comment_id": 83368329, "body": "Thanks this worked like a charm. I am fairly new at VBA,  If you use an input box in this instance where you want a number returned to use later on in the code, do you always need to do something like this?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "edited": false, "score": 0, "creation_date": 1515609034, "post_id": 48193884, "comment_id": 83368432, "body": "If you are askinig if an <code>InputBox</code> always returns a <code>String</code> the answer is yes. It&#39;s up to  you to validate it if you are expecting a numeric value."}, {"owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "edited": false, "score": 0, "creation_date": 1515609109, "post_id": 48193884, "comment_id": 83368472, "body": "Right so if I am expecting a number to use later one, i need to convert it when using it"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "edited": false, "score": 0, "creation_date": 1515609178, "post_id": 48193884, "comment_id": 83368520, "body": "Right, either that or have another variable that is an <code>Integer</code> and after you validate that it&#39;s numeric, set the <code>Integer</code> to <code>Val(x)</code> and you dont have to user <code>Val</code> over and over then."}, {"owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "edited": false, "score": 0, "creation_date": 1515610030, "post_id": 48193884, "comment_id": 83368954, "body": "Awesome Idea!  Thanks"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1515610224, "post_id": 48193884, "comment_id": 83369049, "body": "Nice answer, upvoted. Also, the &quot;User Cancelled&quot; box is misleading. <code>If StrPtr(x) = 0 Then</code> would be the correct condition for displaying such a msgbox."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1515612153, "post_id": 48193884, "comment_id": 83369964, "body": "The more I look at all the validations and possible edge cases, the more this looks like a job for a dedicated, properly unit-tested function..."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1515612260, "post_id": 48193884, "comment_id": 83370022, "body": "@Mat&#39;sMug I wouldnt use an InputBox at all for this. I would make a Userform with a combobox and populate it with all the valid sheet numbers, or better yet, sheet names."}, {"owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "edited": false, "score": 0, "creation_date": 1515612296, "post_id": 48193884, "comment_id": 83370036, "body": "Ha, yea that a little bit above my vba skill right now"}, {"owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515612463, "post_id": 48193884, "comment_id": 83370121, "body": "@Mat&#39;sMug what is strptr?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "edited": false, "score": 0, "creation_date": 1515612520, "post_id": 48193884, "comment_id": 83370145, "body": "@RPr it&#39;s an undocumented/hidden function that returns a memory offset for a string pointer =)  its little brothers are <code>VarPtr</code> and <code>ObjPtr</code>, respectively for getting the memory offset to a variable and an object pointer. You will find them in the Object Browser (F2) under the VBA standard library, in a module named <code>_HiddenModule</code>, only visible if you toggle the &quot;Show hidden members&quot; option from the object browser&#39;s context menu. <code>StrPtr(vbNullString)</code> returns <code>0</code>; <code>StrPtr(&quot;&quot;)</code> returns an address."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 2, "last_activity_date": 1515610677, "last_edit_date": 1515610677, "creation_date": 1515608659, "answer_id": 48193884, "question_id": 48193849, "link": "https://stackoverflow.com/questions/48193849/vba-input-box-cancel-and-variable-setting/48193884#48193884", "title": "VBA input Box- cancel and Variable Setting", "body": "<p><code>InputBox</code> returns a <code>String</code>, so <code>Dim x as String</code></p>\n\n<p>Then once you have validated that it is numeric and within the correct range, use it as a number like this:</p>\n\n<pre><code>Worksheets(Val(x)).Activate\n</code></pre>\n\n<p>And do the same for your checks:</p>\n\n<pre><code>ElseIf Val(x) = 0 Then\n</code></pre>\n\n<p>Also, to critique your code a bit, what happens if the user enters -1? Technically, that's numeric, but not valid.  </p>\n\n<p>instead of <code>ElseIf Val(x) = 0 Then</code> you should use</p>\n\n<pre><code>ElseIf Val(x) &lt; 1 Then\n</code></pre>\n\n<p>What about if they enter 1.5? You may want to also include a check for it being an integer:</p>\n\n<pre><code>If IsNumeric(x) Then\n  If Val(x) &lt;&gt; Int(x) Then\n    MsgBox \"Please enter an Integer\"\n  End If\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1515608669, "creation_date": 1515608669, "answer_id": 48193888, "question_id": 48193849, "link": "https://stackoverflow.com/questions/48193849/vba-input-box-cancel-and-variable-setting/48193888#48193888", "title": "VBA input Box- cancel and Variable Setting", "body": "<p>The reason you are getting an error is because when a use clicks cancel on an inputbox, the input box outputs an empty <strong><em>string</em></strong> - but the problem is your <code>Integer</code> declaration cannot accept a string.</p>\n\n<p>So you could do something along the lines of:</p>\n\n<pre><code>On Error Resume Next\nx = InputBox(\"Please Input The Sheet Number\")\nOn Error Goto 0\n</code></pre>\n\n<p>And if an error occurs when passing the inputbox to <code>x</code>, then <code>x = 0</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": false, "score": 0, "last_activity_date": 1515609990, "creation_date": 1515609990, "answer_id": 48194164, "question_id": 48193849, "link": "https://stackoverflow.com/questions/48193849/vba-input-box-cancel-and-variable-setting/48194164#48194164", "title": "VBA input Box- cancel and Variable Setting", "body": "<p>Although I do not have much knowledge on vba core functionality, I've tried to modify your existing code to work the way you wanted. Give this a go:</p>\n\n<pre><code>Public Sub Summary_select()\n     Dim x As String\n\n     x = InputBox(\"Please Input The Sheet Number\")\n\n     If Not IsNumeric(x) Then\n        MsgBox (\"User Cancelled\")\n     ElseIf x = 0 Then\n        MsgBox (\"User Entered an Invalid Number of sheets\")\n     ElseIf x &gt; Sheets.Count Then\n        MsgBox (\"User Entered an Invalid Number of sheets\")\n     Else\n        Sheets(\"Sheet\" &amp; x).Activate\n        Range(\"A1\").Select\n     End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 912, "favorite_count": 0, "accepted_answer_id": 48193884, "answer_count": 3, "score": 0, "last_activity_date": 1515610677, "creation_date": 1515608514, "question_id": 48193849, "link": "https://stackoverflow.com/questions/48193849/vba-input-box-cancel-and-variable-setting", "title": "VBA input Box- cancel and Variable Setting", "body": "<p>Below is my code. I am writing a Macro to go on a button on the first page of an excel report that will take users to different tabs in the report based on the number they use. The issue is if I use the integer variable, if a user cancels the box or hits the x a error occurs. The numbers work fine in regards to the sheets with this. However, if i dim it as Variant an error no longer occurs, but then the numbers input no longer work. For ex. 3 brings up the invalid sheet box even if there are 8 sheets in the workbook. I think the variant is causing the input numbers to be a different format from integer? I think I can use the on error resume, but I was just wondering what that would look like. Or if there is another way to do this without using that method</p>\n\n<pre><code>Public Sub Summary_select()\n\n     Dim x As Integer\n\n\n     x = InputBox(\"Please Input The Sheet Number\")\n\n\n     If Not (IsNumeric(x)) Then\n     MsgBox (\"User Cancelled\")\n     ElseIf x = 0 Then\n     MsgBox (\"User Entered an Invalid Number of sheets\")\n     ElseIf x &gt; Sheets.Count Then\n     MsgBox (\"User Entered an Invalid Number of sheets\")\n     Else\n     Sheets(x).Activate\n     Range(\"A1\").Select\n     End If\n\n     End Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1515607985, "post_id": 48193639, "comment_id": 83367820, "body": "Do you mean this? <code>rs!AccountNumber = actNo</code> Also, you are missing an <code>End If</code>"}], "answers": [{"comments": [{"owner": {"reputation": 221, "user_id": 2528708, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/27b2312693fb922b7cdf95e0815cdd8d?s=128&d=identicon&r=PG", "display_name": "Kambiz", "link": "https://stackoverflow.com/users/2528708/kambiz"}, "edited": false, "score": 0, "creation_date": 1515608606, "post_id": 48193750, "comment_id": 83368166, "body": "I have done that (right after Else).  But the form does not refresh (in spite of Me.Refresh).  Every other field keeps showing the data from the last record."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 221, "user_id": 2528708, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/27b2312693fb922b7cdf95e0815cdd8d?s=128&d=identicon&r=PG", "display_name": "Kambiz", "link": "https://stackoverflow.com/users/2528708/kambiz"}, "edited": false, "score": 1, "creation_date": 1515609063, "post_id": 48193750, "comment_id": 83368451, "body": "@Kambiz Try <code>Me.Requery</code>"}, {"owner": {"reputation": 221, "user_id": 2528708, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/27b2312693fb922b7cdf95e0815cdd8d?s=128&d=identicon&r=PG", "display_name": "Kambiz", "link": "https://stackoverflow.com/users/2528708/kambiz"}, "edited": false, "score": 0, "creation_date": 1515609409, "post_id": 48193750, "comment_id": 83368633, "body": "Did nt help much, even though I remembered I used Requery with success in the past.  It creates a new record with the new AccountNumber, but it also change the AccountNumber of the record that the form was showing too! Also, I get the error of &quot;Update or CancelUpdate without AddNew or Edit&quot; frequently."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1515616014, "post_id": 48193750, "comment_id": 83371970, "body": "My best bet would be that you cannot use <code>!</code> with <code>With</code>. Try <code>rs!AccountNumber</code> as the proposed answer actually suggest and unlike what you have actually done."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1515608162, "creation_date": 1515608162, "answer_id": 48193750, "question_id": 48193639, "link": "https://stackoverflow.com/questions/48193639/how-do-i-look-up-for-a-particular-value-in-an-access-form-record-and-if-not-fou/48193750#48193750", "title": "How do I look up for a particular value in an Access Form record, and if not found, add a new record with that value?", "body": "<p>Here is how you add a new record to your recordset:</p>\n\n<pre><code>.AddNew\nrs!AccountNumber = actNo\n.Update\n</code></pre>\n\n<p>Alternatively:</p>\n\n<pre><code>.AddNew\n.Fields(\"AccountNumber\") = actNo\n.Update\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1515675392, "creation_date": 1515675392, "answer_id": 48207648, "question_id": 48193639, "link": "https://stackoverflow.com/questions/48193639/how-do-i-look-up-for-a-particular-value-in-an-access-form-record-and-if-not-fou/48207648#48207648", "title": "How do I look up for a particular value in an Access Form record, and if not found, add a new record with that value?", "body": "<p>Use the <em>RecordsetClone</em>:</p>\n\n<pre><code>Private Sub myTextBox_Exit(Cancel As Integer)\n\n    Dim rs As DAO.Recordset\n    Dim actNo As String\n\n    actNo = Me!AccountNumber.Value\n\n    Set rs = Me.RecordsetClone\n\n    With rs\n        .FindFirst \"AccountNumber = '\" &amp; actNo &amp; \"'\"\n        If .NoMatch Then\n            .AddNew\n                !AccountNumber.Value = actNo\n            .Update\n        End If\n        Me.Bookmark = .Bookmark\n    End With\n\n    rs.Close\n    Set rs = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 221, "user_id": 2528708, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/27b2312693fb922b7cdf95e0815cdd8d?s=128&d=identicon&r=PG", "display_name": "Kambiz", "link": "https://stackoverflow.com/users/2528708/kambiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1515675392, "creation_date": 1515607749, "last_edit_date": 1515609234, "question_id": 48193639, "link": "https://stackoverflow.com/questions/48193639/how-do-i-look-up-for-a-particular-value-in-an-access-form-record-and-if-not-fou", "title": "How do I look up for a particular value in an Access Form record, and if not found, add a new record with that value?", "body": "<p>I have been looking for a solution in many different places, but have not been able to find a clean answer.</p>\n\n<p>I need my Access program to look up for a particular value, based on entry in a text box, if found, go to that record (easy part), and if not, add a new record for that particular value being assigned to the respective field. </p>\n\n<pre><code>Private Sub myTextBox_Exit(Cancel As Integer)\nDim db As Database\nDim rs As Recordset\ndim actNo as String\n\nSet db = CurrentDb\nactNo = Me.AccountNumber\n\nSet rs = CurrentDb.OpenRecordset(Name:=\"myClients\", Type:=RecordsetTypeEnum.dbOpenDynaset)\n\nWith rs\n    .FindFirst \"AccountNumber = '\" &amp; actNo &amp; \"'\"\n    If Not .NoMatch Then\n        Me.Bookmark = .Bookmark\n    Else  \n ' This is where it gets tricky.  Tried many of the variations below, none \n ' works.\n    .AddNew\n    !AccountNumber= actNo\n    .Update\n    Me.Refresh\n\n    ' Neither something like:\n    DoCmd.RunCommand acCmdRecordsGoToNew\n    End If\nEnd With\n\nCleanup:\nrs.Close\ndb.Close\nSet rs = Nothing\nSet db = Nothing\nEnd Sub\n</code></pre>\n\n<p>Help much appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1228"}, "edited": false, "score": 2, "creation_date": 1515605689, "post_id": 48193044, "comment_id": 83366585, "body": "THE FIRST THING YOU NEED TO DO IS <a href=\"https://stackoverflow.com/posts/48193044/edit\">edit</a> AND FIX YOUR TITLE"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1515606276, "post_id": 48193044, "comment_id": 83366887, "body": "Is the line in your image the line that is highlighted when you right-click the button and select <code>Inspect</code>?"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1515609713, "post_id": 48193044, "comment_id": 83368801, "body": "Yes, it&#39;s exactly how you say."}], "answers": [{"comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1515667814, "post_id": 48193383, "comment_id": 83391529, "body": "Omg!!! it worked!!!! Thanks Davis. I guess i got obssesed with the DIV element, because looking at the HTML code i did not see any &quot;onclick&quot; event or a href on th button and I ignored it."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 2, "last_activity_date": 1515606803, "creation_date": 1515606803, "answer_id": 48193383, "question_id": 48193044, "link": "https://stackoverflow.com/questions/48193044/simulate-click-event-on-a-div-element/48193383#48193383", "title": "Simulate Click event on a DIV element", "body": "<p>You didn't specify if the highlighted portion was the html code for the button or not, but it appears from looking at it that it isn't. </p>\n\n<p>You can grab the class name for your button. The name may or may not be unique, and it's difficult to know that without seeing the entire html code, but you can set the <code>btn</code> variable below to the first instance of that class name. If there are multiple class names in your html code, then you will need to use a <code>For Each...Next</code> statement to iterate through them (unless you know the instance number off hand).</p>\n\n<p>So we will go with the first instance of your class, hence the reason for the <code>(0)</code> appended on the end.</p>\n\n<pre><code>Sub Test()\n\n    Dim ie As New InternetExplorer, HTMLDoc As HTMLDocument, btn As Object\n    ie.navigate Url 'whatever this may be\n\n    ' Some code to wait for your page to fully load\n\n    Set HTMLDoc = ie.document\n    Set btn = HTMLDoc.getElementsByClassName(\"btn btn-default ladda-button\")(0)\n    btn.Click\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2292, "favorite_count": 0, "accepted_answer_id": 48193383, "answer_count": 1, "score": 3, "last_activity_date": 1544488076, "creation_date": 1515605629, "last_edit_date": 1531164843, "question_id": 48193044, "link": "https://stackoverflow.com/questions/48193044/simulate-click-event-on-a-div-element", "title": "Simulate Click event on a DIV element", "body": "<p>I cannot simulate a click event on a div element. The HTML code is this one:</p>\n\n<pre><code>&lt;div id=\"export\" data-export=\"true\" data-timespan=\"\"&gt;\n    &lt;button class=\"btn btn-default ladda-button\" type=\"button\" data-style=\"expand-right\" data-spinner-color=\"#8899a6\"&gt;\n      &lt;span class=\"Icon Icon--featherDownload\"&gt;&lt;/span&gt;\n      &lt;span class=\"ladda-label\"&gt;\n        Exportar datos\n      &lt;/span&gt;\n    &lt;span class=\"ladda-spinner\"&gt;&lt;/span&gt;&lt;/button&gt;\n  &lt;div class=\"hidden error server Callout Callout--danger\"&gt;\n    &lt;p&gt;Ocurri\u00f3 un problema al exportar tus datos, int\u00e9ntalo de nuevo m\u00e1s tarde.&lt;/p&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>In the webpage, is just a button that downloads a file when clicked. There is no URL. But after checking the code, is the div element what triggers the click event. Look the image.</p>\n\n<p><a href=\"https://i.stack.imgur.com/DtRiN.jpg\" rel=\"nofollow noreferrer\">Click to see image</a></p>\n\n<p>That \"g.handle\" triggers a js.file form the website.</p>\n\n<p>My vba code works perfect for doing other stuff in the website, but I cannot accomplish this task.</p>\n\n<p>I've tried all this options:</p>\n\n<pre><code>Set div = HTMLDoc.getElementById(\"export\")\ndiv.FireEvent (\"onclick\")\ndiv.Click\n\n\nHTMLDoc.all.Item\nCall HTMLDoc.parentWindow.execScript(\"g.handle\", \"JavaScript\")\n</code></pre>\n\n<p>Nothing works. I'm kind of blocked right now and I have no idea of how to proceed. Maybe this has no solution? I have almost no idea of HTML and I have 0 idea of Javascript. But it must have a solution, because if I do it manually, i click on that DIV, wait some seconds and download my file.</p>\n\n<p>Thanks in advance. Any help is welcome.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2454, "user_id": 8784938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753bb55c80a644f950a41ae11cfbe48c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperStew", "link": "https://stackoverflow.com/users/8784938/superstew"}, "edited": false, "score": 2, "creation_date": 1515604344, "post_id": 48192682, "comment_id": 83365812, "body": "Can you clarify your question?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1515604696, "post_id": 48192682, "comment_id": 83366006, "body": "Seems like they have a formula like <code>=A55*B66</code> and they want to convert it to <code>=$A$55*B66</code>   Similar question: <a href=\"https://stackoverflow.com/questions/40232315/convert-only-a-fraction-of-formula-to-absolute-reference-from-relative-reference\" title=\"convert only a fraction of formula to absolute reference from relative reference\">stackoverflow.com/questions/40232315/&hellip;</a>\\"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1515604913, "post_id": 48192682, "comment_id": 83366129, "body": "If the formulas in question are always products of two cells then this is somewhat trivial (split the formula on <code>*</code>, modify the first address, rejoin with <code>*</code>). Otherwise, you would need to clarify."}, {"owner": {"reputation": 2454, "user_id": 8784938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753bb55c80a644f950a41ae11cfbe48c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperStew", "link": "https://stackoverflow.com/users/8784938/superstew"}, "edited": false, "score": 2, "creation_date": 1515604919, "post_id": 48192682, "comment_id": 83366131, "body": "Ahh. Hardly seems like the kind of thing to use vba for."}, {"owner": {"reputation": 75, "user_id": 6400007, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4a93b122e7054fd0c048a444857d1408?s=128&d=identicon&r=PG&f=1", "display_name": "user24", "link": "https://stackoverflow.com/users/6400007/user24"}, "edited": false, "score": 0, "creation_date": 1515605290, "post_id": 48192682, "comment_id": 83366365, "body": "John Coleman, I think you are on the right track. Can you show how to split it and only work on the first part?"}], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 1, "last_activity_date": 1515606331, "creation_date": 1515606331, "answer_id": 48193251, "question_id": 48192682, "link": "https://stackoverflow.com/questions/48192682/apply-excel-macro-to-first-part-of-equation/48193251#48193251", "title": "Apply excel macro to first part of equation", "body": "<p>Here is a somewhat ad-hoc answer which works in the special case of formulas which are the product of two cells:</p>\n\n<pre><code>Sub Absolute()\n    Dim cell As Range\n    Dim factors As Variant\n    For Each cell In Selection\n        If cell.HasFormula And cell.Formula Like \"*[*]*\" Then\n            factors = Split(cell.Formula, \"*\")\n            factors(0) = Range(factors(0)).Address\n            cell.Formula = \"=\" &amp; Join(factors, \"*\")\n        End If\n    Next cell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 6400007, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4a93b122e7054fd0c048a444857d1408?s=128&d=identicon&r=PG&f=1", "display_name": "user24", "link": "https://stackoverflow.com/users/6400007/user24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 48193251, "answer_count": 1, "score": 0, "last_activity_date": 1515617513, "creation_date": 1515604218, "last_edit_date": 1515617513, "question_id": 48192682, "link": "https://stackoverflow.com/questions/48192682/apply-excel-macro-to-first-part-of-equation", "title": "Apply excel macro to first part of equation", "body": "<p>How can I change the excel vba macro below to only work on the first part of A55*B66 and leave B66 as variable?</p>\n\n<pre><code>Sub Absolute()\n'$A$1\nDim cell As Range\nFor Each cell In Selection\n    If cell.HasFormula Then\n        cell.Formula = Application.ConvertFormula(cell.Formula, _\n        xlA1, xlA1, xlAbsolute)\n    End If\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy-paste"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1515604812, "post_id": 48192496, "comment_id": 83366073, "body": "Presumably you mean A2 and then C2 (not B2) as your range is two columns wide?"}], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1515604649, "post_id": 48192755, "comment_id": 83365978, "body": "With this offset you would never fill out column A."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1515605030, "post_id": 48192755, "comment_id": 83366192, "body": "Do you really use Excel 2003 (judging from the IV column)? I am afraid to ask why, because I might know the reason..."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1515605989, "post_id": 48192755, "comment_id": 83366733, "body": "You are right about that column A issue. I think the bigger takeaway is the <code>.End()</code> method, the redundant copy and pasting, the use of variables to handle dynamically determined things in VBA and the like. The <code>IV</code> is just my old school lizard brain writing code without thinking about nicer ways of doing it like <code>Columns.Count</code>. That being said, I do still know someone that has retained an XP laptop so they can use Access 2003 o_0"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1515606919, "post_id": 48192755, "comment_id": 83367263, "body": "I am  commenting the negative parts only \u263a Tester&#39;s mentality. I know some people supporting applications on 2003, thought you were one of them. Cheers \u263a"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 1, "last_activity_date": 1515604669, "last_edit_date": 1515604669, "creation_date": 1515604514, "answer_id": 48192755, "question_id": 48192496, "link": "https://stackoverflow.com/questions/48192496/copy-paste-range-from-one-worksheet-to-next-available-column-in-another-workshee/48192755#48192755", "title": "Copy/paste range from one worksheet to next available column in another worksheet", "body": "<p>Your code is odd</p>\n\n<p>This line <code>Sheets(\"Sheet1\").Range(\"A2:B10\").Copy  Destination:=Sheets(\"Sheet2\").Range(\"A2\")</code> is copying and pasting all in one line. So your subsequent lines where you <code>.copy</code> <code>.activate</code> <code>.select</code> and <code>.paste</code> are redundant. Your first line already did all of this.</p>\n\n<p>You need to identify the last used column in Row \"A\" of Sheet2. To do this you can use the <code>.End()</code> method of a range to find the first occupied cell in the row. Then use that cell as your copy <code>Destination</code>:</p>\n\n<pre><code> Sub sbCopyRangeToAnotherSheet()\n\n     'Declare a variable to hold the cell to which we will paste the data\n     Dim pasteCell as Range\n\n     'Set the variable to the first empty cell in Row 2\n     Set pasteCell = Sheets(\"Sheet2\").Range(\"IV2\").end(xlToLeft).Offset(,1)\n\n     'Copy and paste\n     Sheets(\"Sheet1\").Range(\"A2:B10\").Copy  Destination:=pasteCell\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 9199671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5504f47e8361eb63c95216e63f3cdd9?s=128&d=identicon&r=PG&f=1", "display_name": "P. Saha", "link": "https://stackoverflow.com/users/9199671/p-saha"}, "edited": false, "score": 1, "creation_date": 1515611164, "post_id": 48192767, "comment_id": 83369500, "body": "Thanks a lot for your help! Really appreciate it. Learned a lot from this."}, {"owner": {"reputation": 37, "user_id": 9199671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5504f47e8361eb63c95216e63f3cdd9?s=128&d=identicon&r=PG&f=1", "display_name": "P. Saha", "link": "https://stackoverflow.com/users/9199671/p-saha"}, "edited": false, "score": 0, "creation_date": 1515611287, "post_id": 48192767, "comment_id": 83369567, "body": "Your comment about Range.End(xlToLeft).Column makes sense to me.   Question for you in regards to pasting values, would I be able to use &quot;.PasteSpecial Paste:=xlPasteFormats&quot; or &quot;.Value&quot; in any part of this script? I tried playing around with it, but can&#39;t seem to figure it out. Thanks again!"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 37, "user_id": 9199671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5504f47e8361eb63c95216e63f3cdd9?s=128&d=identicon&r=PG&f=1", "display_name": "P. Saha", "link": "https://stackoverflow.com/users/9199671/p-saha"}, "edited": false, "score": 0, "creation_date": 1515612582, "post_id": 48192767, "comment_id": 83370175, "body": "@P.Saha - you are welcome. Concerning the pasting of the values, probably the best way to learn a bit is simply to record a macro and see the code there. In my code remove the part <code>destination := target</code> and on the next line add <code>target.PasteSpecial Paste:= xlPasteFormats</code>, it should work. Glad I could help - <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>"}, {"owner": {"reputation": 37, "user_id": 9199671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5504f47e8361eb63c95216e63f3cdd9?s=128&d=identicon&r=PG&f=1", "display_name": "P. Saha", "link": "https://stackoverflow.com/users/9199671/p-saha"}, "edited": false, "score": 1, "creation_date": 1515614052, "post_id": 48192767, "comment_id": 83370943, "body": "Used &quot;target.PasteSpecial (xlPasteValues)&quot; after struggling with the syntax and it worked.Thanks again! Very helpful and again helped me learn."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 0, "last_activity_date": 1515604933, "last_edit_date": 1515604933, "creation_date": 1515604573, "answer_id": 48192767, "question_id": 48192496, "link": "https://stackoverflow.com/questions/48192496/copy-paste-range-from-one-worksheet-to-next-available-column-in-another-workshee/48192767#48192767", "title": "Copy/paste range from one worksheet to next available column in another worksheet", "body": "<p>This is something that will do the job without using <code>Active</code> and <code>Select</code>:</p>\n\n<pre><code>Option Explicit\n\nSub TestMe()\n\n    Dim ws1         As Worksheet\n    Dim ws2         As Worksheet        \n    Dim source      As Range\n    Dim target      As Range        \n    Dim lastColumn  As Long\n\n    Set ws1 = Worksheets(1)\n    Set ws2 = Worksheets(2)\n\n    With ws2\n        lastColumn = .Cells(2, .Columns.Count).End(xlToLeft).Column\n        If WorksheetFunction.CountA(.Columns(1)) &gt; 0 Then\n            lastColumn = lastColumn + 1\n        End If\n    End With\n\n    Set source = ws1.Range(\"A2:A10\")\n    Set target = ws2.Cells(2, lastColumn)\n\n    source.Copy destination:=target\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n\n<p>The trickiest part in the code is to start writing on the correct column on the target worksheet. If the worksheet is empty, then the correct column is the first one. In every other case, the correct column is the last column + 1.</p>\n\n<p>The standard way of finding last used column - <code>Range.End(xlToLeft).Column</code> would always return the first column as a last used column, w/o paying attention whether it is used or not. Thus you need some kind of a check, to know whether it is empty or not: <code>WorksheetFunction.CountA(.Columns(1)) &gt; 0</code></p>\n"}], "owner": {"reputation": 37, "user_id": 9199671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5504f47e8361eb63c95216e63f3cdd9?s=128&d=identicon&r=PG&f=1", "display_name": "P. Saha", "link": "https://stackoverflow.com/users/9199671/p-saha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35728, "favorite_count": 1, "accepted_answer_id": 48192767, "answer_count": 2, "score": 0, "last_activity_date": 1570482962, "creation_date": 1515603600, "last_edit_date": 1570482962, "question_id": 48192496, "link": "https://stackoverflow.com/questions/48192496/copy-paste-range-from-one-worksheet-to-next-available-column-in-another-workshee", "title": "Copy/paste range from one worksheet to next available column in another worksheet", "body": "<p>I am trying to copy a range of data from one worksheet into another worksheet in the same workbook.</p>\n\n<p>So copy range(\"A2:B10\") in Sheet1 then paste in (\"A2\") in Sheet2. </p>\n\n<p>Each time the macro is run, I would like the values in (\"Sheet 1\").Range(\"A2:B10\") to be pasted in consecutive columns, so in the second run, in <s>\"B2\"</s> \"C2\" in Sheet 2. </p>\n\n<p>I have the first part, but struggling with the 2nd part:</p>\n\n<pre><code>Sub sbCopyRangeToAnotherSheet()\n'Set range\nSheets(\"Sheet1\").Range(\"A2:B10\").Copy  Destination:=Sheets(\"Sheet2\").Range(\"A2\")\n'Copy the data\nSheets(\"Sheet1\").Range(\"A2:B10\").Copy\n'Activate the destination worksheet\nSheets(\"Sheet2\").Activate\n'Select the target range\nRange(\"A2\").Select\n'Paste in the target destination\nActiveSheet.Paste\n\nApplication.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1515602797, "post_id": 48192182, "comment_id": 83364917, "body": "PLease edit your post, remove the current code. Paste your code again, select it and click the {} button."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515606594, "post_id": 48192182, "comment_id": 83367073, "body": "FWIW <code>UsedRange</code> isn&#39;t a reliable way to get the number of rows with data on a worksheet."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6494891, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/daf936656edc5b9f5c71330bac9e1081?s=128&d=identicon&r=PG&f=1", "display_name": "icittar", "link": "https://stackoverflow.com/users/6494891/icittar"}, "edited": false, "score": 0, "creation_date": 1515766936, "post_id": 48192340, "comment_id": 83438037, "body": "Thank you for replying. How can I fix the issue?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5293664"}, "is_accepted": false, "score": 0, "last_activity_date": 1515603071, "creation_date": 1515603071, "answer_id": 48192340, "question_id": 48192182, "link": "https://stackoverflow.com/questions/48192182/record-moves-to-a-wrong-row-on-another-excel-sheet/48192340#48192340", "title": "Record moves to a wrong row on another Excel sheet", "body": "<p>The problem looks like you aren't resetting J when you move from one worksheet to the next. So if you first sheet had 652 rows, it will place the last row on line 653 (J + 1 = 653). But, when you start moving rows on the second sheet, it will start placing them at 654 (653 + 1 = 654). </p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 6494891, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/daf936656edc5b9f5c71330bac9e1081?s=128&d=identicon&r=PG&f=1", "display_name": "icittar", "link": "https://stackoverflow.com/users/6494891/icittar"}, "edited": false, "score": 0, "creation_date": 1515610935, "post_id": 48192373, "comment_id": 83369396, "body": "Thank you for your help! But unfortunately it didn&#39;t work. I have only 5 rows in &quot;Scheduled Shipments&quot; sheet and 212 in &quot;Completed Shipments&quot; sheet. For some reason the row moves to row # 654. I just created a new workbook, with 3 rows on one sheet and 3 on the second one and used adjusted code (according to your advice), it moved the row to row #5 on the second sheet, not row #4 as it was supposed to be. Please help."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 31, "user_id": 6494891, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/daf936656edc5b9f5c71330bac9e1081?s=128&d=identicon&r=PG&f=1", "display_name": "icittar", "link": "https://stackoverflow.com/users/6494891/icittar"}, "edited": false, "score": 0, "creation_date": 1515612397, "post_id": 48192373, "comment_id": 83370090, "body": "@icittar - take a look again, I have uncommented <code>J</code> in my code. In general, try debugging with F8, the problem should be easy to solve."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1515612365, "last_edit_date": 1515612365, "creation_date": 1515603190, "answer_id": 48192373, "question_id": 48192182, "link": "https://stackoverflow.com/questions/48192182/record-moves-to-a-wrong-row-on-another-excel-sheet/48192373#48192373", "title": "Record moves to a wrong row on another Excel sheet", "body": "<p>Try to add the following part into your into your code, removing the commented lines as shown:</p>\n\n<pre><code>    'Your previous code ---^\n    For K = 1 To xRg.Count\n        If CStr(xRg(K).Value) = \"Completed\" Then\n            xRg(K).EntireRow.Copy Destination:=Worksheets(\"Completed Shipments\").Range(\"A\" &amp; J + 1)\n            'xRg(K).EntireRow.Delete \n            'If CStr(xRg(K).Value) = \"Completed\" Then\n            '    K = K - 1\n            'End If\n            J = J + 1\n        End If\n    Next\n    'this is the new code ---v\n    For K = xRg.Count To 1 Step -1\n        If CStr(xRg(K).Value) = \"Completed\" Then\n            xRg(K).EntireRow.Delete\n        End If\n    Next K\n    'end of the new code ---^\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Whenever you are feeling that the code you are writing does not do what it intends to do, it is a good idea to simplify. </p>\n\n<p>In this case, you may split the task into two sub-tasks:</p>\n\n<ul>\n<li>Copy the rows with \"Completed\" to a specific worksheet</li>\n<li>Delete the rows with the word \"Completed\"</li>\n</ul>\n\n<p>Note that in order to delete rows correctly from a worksheet, it is a better idea to loop from the bottom and not from the top, thus the loop is reversed.</p>\n"}], "owner": {"reputation": 31, "user_id": 6494891, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/daf936656edc5b9f5c71330bac9e1081?s=128&d=identicon&r=PG&f=1", "display_name": "icittar", "link": "https://stackoverflow.com/users/6494891/icittar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1515612365, "creation_date": 1515602511, "last_edit_date": 1515604657, "question_id": 48192182, "link": "https://stackoverflow.com/questions/48192182/record-moves-to-a-wrong-row-on-another-excel-sheet", "title": "Record moves to a wrong row on another Excel sheet", "body": "<p>I have a macro that moves row from one sheet to another one once I time the word \"Completed\" in a certain field. \nThe problem is that it moves row into a wrong place. I have 212 rows on another worksheet, the next row should be moved row #213 on another sheet, but it moves all the way to the row #654. \nPlease help me to resove the issue, so each row will move to the next available row on another worksheet.</p>\n\n<p>Here is my VBA code:</p>\n\n<pre><code>Sub Autoupdating()\n'Move shipments once completed\n    Dim xRg As Range\n    Dim xCell As Range\n    Dim I As Long\n    Dim J As Long\n    Dim K As Long\n    I = Worksheets(\"Scheduled Shipments\").UsedRange.Rows.Count\n    J = Worksheets(\"Completed Shipments\").UsedRange.Rows.Count\n    If J = 1 Then\n       If Application.WorksheetFunction.CountA(Worksheets(\"Completed Shipments\").UsedRange) = 0 Then J = 0\n    End If\n    Set xRg = Worksheets(\"Scheduled Shipments\").Range(\"G1:G\" &amp; I)\n    On Error Resume Next\n    Application.ScreenUpdating = False\n    For K = 1 To xRg.Count\n        If CStr(xRg(K).Value) = \"Completed\" Then\n            xRg(K).EntireRow.Copy Destination:=Worksheets(\"Completed Shipments\").Range(\"A\" &amp; J + 1)\n            xRg(K).EntireRow.Delete\n            If CStr(xRg(K).Value) = \"Completed\" Then\n                K = K - 1\n            End If\n            J = J + 1\n        End If\n    Next\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1515603857, "post_id": 48192142, "comment_id": 83365552, "body": "If the invocation needs to be conditional, why not <i>make it</i> conditional? <code>If MsgBox(&quot;Send email?&quot;, vbYesNo) = vbYes Then...</code>"}, {"owner": {"reputation": 125, "user_id": 4401862, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/634d63df41ccfca67948b273ed60fcbf?s=128&d=identicon&r=PG&f=1", "display_name": "ella", "link": "https://stackoverflow.com/users/4401862/ella"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515618717, "post_id": 48192142, "comment_id": 83373305, "body": "@Mat&#39;sMug thanks Mat - if you don&#39;t mind me asking how to display the full content of your message.."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515618836, "post_id": 48192142, "comment_id": 83373363, "body": "Well the ellipsis stands for the code you&#39;re currently running unconditionally: <code>Sheets(&quot;Result&quot;).main</code> (&#39;call&#39; is redundant/useless/obsolete)"}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 4401862, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/634d63df41ccfca67948b273ed60fcbf?s=128&d=identicon&r=PG&f=1", "display_name": "ella", "link": "https://stackoverflow.com/users/4401862/ella"}, "edited": false, "score": 0, "creation_date": 1515618761, "post_id": 48192396, "comment_id": 83373326, "body": "Thank you. Button wont be an option because i want to run the macro from command line"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1515618967, "post_id": 48192396, "comment_id": 83373414, "body": "Hmm then a msgbox isn&#39;t ideal at all. I&#39;d research to see if there&#39;s a way to specify conditional compilation arguments from command-line (possibly not). Basically Excel automation without a UI isn&#39;t a recommended scenario. Good luck!"}, {"owner": {"reputation": 125, "user_id": 4401862, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/634d63df41ccfca67948b273ed60fcbf?s=128&d=identicon&r=PG&f=1", "display_name": "ella", "link": "https://stackoverflow.com/users/4401862/ella"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515627166, "post_id": 48192396, "comment_id": 83376625, "body": "@Mat&#39;sMug thanks, yeah i agree. Initially used powershell to generate the excel report but there are lots of reformatting to do based on values which needs to be done with html while composing the email body(not attachment). so I turned to VBA instead."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 2, "last_activity_date": 1515613413, "last_edit_date": 1515613413, "creation_date": 1515603249, "answer_id": 48192396, "question_id": 48192142, "link": "https://stackoverflow.com/questions/48192142/how-to-open-an-excel-without-running-the-workbooks-open-macro-in-it/48192396#48192396", "title": "How to open an excel without running the Workbooks.Open macro in it", "body": "<ol>\n<li>Open the Excel Application.</li>\n<li>Go to File ~ Open, or File ~ Recent.</li>\n<li>Hold <kbd>Shift</kbd> while opening your file.</li>\n</ol>\n\n<p><strong>NB:</strong>  This won't work by just selecting the Excel workbook to open.<br>\nYou need to open Excel first and then open the workbook. </p>\n\n<p><strong>Edit:</strong>  </p>\n\n<blockquote>\n  <p>My concern is , that main function will send email out.</p>\n</blockquote>\n\n<p>Don't add your code to the <code>Workbook_Open</code> event, add it to the click event of a button instead - it'll never send out emails until you press the button then.</p>\n"}, {"tags": [], "owner": {"reputation": 419, "user_id": 327025, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0af1c17bab06cbff4af660b9aba739f6?s=128&d=identicon&r=PG", "display_name": "WhyGeeEx", "link": "https://stackoverflow.com/users/327025/whygeeex"}, "is_accepted": false, "score": 0, "last_activity_date": 1598967086, "creation_date": 1598967086, "answer_id": 63688759, "question_id": 48192142, "link": "https://stackoverflow.com/questions/48192142/how-to-open-an-excel-without-running-the-workbooks-open-macro-in-it/63688759#63688759", "title": "How to open an excel without running the Workbooks.Open macro in it", "body": "<p>I've found the following works for me in Office 365 (maybe other versions of Excel too) -</p>\n<ol>\n<li>Open Excel directly, do not double-click a workbook to start Excel</li>\n<li>File/Open/Browse</li>\n<li>Navigate to the workbook you want to open, single click on it</li>\n<li>Click the dropdown next to Open, and Open in Protected View</li>\n</ol>\n<p>If you want to edit further at that point, you'll have to click Enable Editing on the popup that should appear just under your menu bar.  When I do that, I have macros that try to run right away, but they fail, and I can edit the VBA.  YMMV there.</p>\n<p><a href=\"https://i.stack.imgur.com/6ocva.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6ocva.jpg\" alt=\"enter image description here\" /></a></p>\n"}], "owner": {"reputation": 125, "user_id": 4401862, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/634d63df41ccfca67948b273ed60fcbf?s=128&d=identicon&r=PG&f=1", "display_name": "ella", "link": "https://stackoverflow.com/users/4401862/ella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7806, "favorite_count": 0, "accepted_answer_id": 48192396, "answer_count": 2, "score": 3, "last_activity_date": 1598967086, "creation_date": 1515602349, "last_edit_date": 1515604681, "question_id": 48192142, "link": "https://stackoverflow.com/questions/48192142/how-to-open-an-excel-without-running-the-workbooks-open-macro-in-it", "title": "How to open an excel without running the Workbooks.Open macro in it", "body": "<p>I have a  vba code that calls my procedure whenever openning that excel.</p>\n\n<pre><code>Sub WorkBook_Open()\nCall Sheets(\"Result\").main\nEnd Sub\n</code></pre>\n\n<p>My concern is , that main function will send email out. So in future if I want to edit that excel, how can i open it without triggering the call?</p>\n\n<p>My initial intention was to use command line to run the vba function everyday and send that report automatically</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1515602455, "post_id": 48192100, "comment_id": 83364707, "body": "You won&#39;t be able to do this from a UDF I&#39;m afraid. Better to use a normal macro that populates the right cells with the random numbers somehow."}], "answers": [{"tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1515611765, "creation_date": 1515611765, "answer_id": 48194567, "question_id": 48192100, "link": "https://stackoverflow.com/questions/48192100/how-not-to-reload-an-excel-addin/48194567#48194567", "title": "How not to reload an excel Addin", "body": "<p>You can store the value of <code>AlreadyRandomized</code> variable to a <a href=\"https://msdn.microsoft.com/en-us/VBA/Excel-VBA/articles/workbook-customdocumentproperties-property-excel\" rel=\"nofollow noreferrer\">CustomDocumentProperty</a> and read/set its value accordingly. </p>\n\n<pre><code>Public Sub T()\n\n    Dim p As Object\n    Set p = CustomPropertyByName(\"AlreadyRandomized\")\n\n    If Not CBool(p.Value) Then 'Randomize\n\n    p.Value = True 'Randomized\nEnd Sub\n</code></pre>\n\n<p>Two helper functions, one creates the property if it doesn't exist and returns a reference to it and the second simply checks if the property exists.</p>\n\n<pre><code>'CustomPropertyByName()\nPublic Function CustomPropertyByName(ByVal propertyName As String) As Object\n    If Not PropertyExists(propertyName) Then\n        ThisWorkbook.CustomDocumentProperties.Add Name:=propertyName, _\n                                                  LinkToContent:=False, _\n                                                  Type:=msoPropertyTypeNumber, _\n                                                  Value:=0\n    End If\n    Set CustomPropertyByName = ThisWorkbook.CustomDocumentProperties(propertyName)\nEnd Function\n</code></pre>\n\n<p><br></p>\n\n<pre><code>'PropertyExists()\nPrivate Function PropertyExists(ByVal propertyName As String) As Boolean\n    Dim p As Object\n    For Each p In ThisWorkbook.CustomDocumentProperties\n       If p.Name = propertyName Then\n           PropertyExists = True\n           Exit Function\n       End If\n    Next p\nEnd Function\n</code></pre>\n\n<p><br>\nNote: A runtime error occurs if you try to access a <code>CustomDocumentProperty</code> that doesn't exist.</p>\n"}], "owner": {"reputation": 1, "user_id": 9199623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd3361df0d41689005d3bbf7c9ea11c3?s=128&d=identicon&r=PG&f=1", "display_name": "Kyokura", "link": "https://stackoverflow.com/users/9199623/kyokura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515611765, "creation_date": 1515602216, "last_edit_date": 1515603961, "question_id": 48192100, "link": "https://stackoverflow.com/questions/48192100/how-not-to-reload-an-excel-addin", "title": "How not to reload an excel Addin", "body": "<p>I have built an Excel Macro (as an Excel Addin) to randomly generate numbers.\nI built it because the rand() function on excel keep generating new numbers at each action in the Excel file. So I tried to build something that \"freeze\" the formula once it has generated a number.\nIt works pretty well but when I close the file and reopen it, the numbers change.</p>\n\n<p>How can I fix that ?\nI have tried something like : If current cell = Blank ==> generate, otherwise exit function. But it doesn't work.</p>\n\n<p>Here is the code I'm using :</p>\n\n<pre><code> Function RandomFreeze()\n\nStatic AlreadyRandomized As Boolean\n\nAlreadyRandomized = False\nStatic Low As Double\nStatic High As Double\nLow = 1\nHigh = 100000000\n\nIf Worksheets(\"Sheet1\").Range(\"A1\") = \"\" Then\n\n    If AlreadyRandomized = False Then\n    RandomFreeze = Int(Rnd * (High + 1 - Low)) + Low\n    AlreadyRandomized = True\n    End If\n\nElse\nMsgBox \"Erreur\"\nAlreadyRandomized = True\nEnd If\n\n\n\nEnd Function\n</code></pre>\n\n<p>Any help with this issue will be appreciated.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["excel", "vba", "pdf"], "comments": [{"owner": {"reputation": 8754, "user_id": 6719819, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/HmF9I.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/6719819/daniel"}, "edited": false, "score": 0, "creation_date": 1515604107, "post_id": 48191958, "comment_id": 83365691, "body": "Please post what you have tried so far."}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1515601800, "creation_date": 1515601800, "answer_id": 48191974, "question_id": 48191958, "link": "https://stackoverflow.com/questions/48191958/how-do-i-get-my-excel-to-pdf-creation-code-to-ignore-the-first-worksheet/48191974#48191974", "title": "How do I get my excel to PDF creation code to ignore the first worksheet?", "body": "<p>Then check the name using an IF statement:</p>\n\n<pre><code>If ws.Name &lt;&gt; \"PurchaseOrderForm\" Then\n\n  ' do stuff\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8695038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fbe5ccb766e601f24daa501456e0c91?s=128&d=identicon&r=PG&f=1", "display_name": "ottokatz", "link": "https://stackoverflow.com/users/8695038/ottokatz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515601800, "creation_date": 1515601738, "question_id": 48191958, "link": "https://stackoverflow.com/questions/48191958/how-do-i-get-my-excel-to-pdf-creation-code-to-ignore-the-first-worksheet", "title": "How do I get my excel to PDF creation code to ignore the first worksheet?", "body": "<p>I have an excel file that generates order forms based on a template. When these order forms are approved they are all turned into PDFs. I would like to find a way to alter my convert to pdf code to ignore the template.</p>\n\n<pre><code>    Sub SavePDF()\n\nDim ws As Worksheet\n\nFor Each ws In Worksheets\nws.Select\n\n PO = Range(\"C14\").Value\n Supplier = Range(\"B4\").Value\n\n\n    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=\"Z:\\Purchase Order Forms\\Forms\\\" &amp; PO, Quality _\n    :=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False _\n    , OpenAfterPublish:=False\n\nNext ws\n\nEnd Sub\n</code></pre>\n\n<p>The template tab is called \"PurchaseOrderForm\" and the other tabs are all called <em>OrderNumber</em>&amp;<em>UserName</em> </p>\n\n<p>Cheers for any help.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 3, "creation_date": 1515600845, "post_id": 48191581, "comment_id": 83363597, "body": "First recommendation: Never use <code>On Error Resume Next</code> - instead, test for the condition which you think could error."}, {"owner": {"reputation": 21, "user_id": 9168325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/453aace0f193d258349a9b96fe33fa1e?s=128&d=identicon&r=PG&f=1", "display_name": "Gary Ziabek", "link": "https://stackoverflow.com/users/9168325/gary-ziabek"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1515601008, "post_id": 48191581, "comment_id": 83363711, "body": "Makes sense braX. No doubt in this condition with large data and folder creations it will be easy to miss a mistake of some sort."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1515601336, "post_id": 48191581, "comment_id": 83363948, "body": "Try it without the parenthesis: <code>MkDir ActiveWorkbook.Path &amp; &quot;\\&quot; &amp; Rng(r, c)</code> (also,  your question is a bit unclear) Are you asking about how to make it work without Selection? or asking why it&#39;s not creating the directory?"}, {"owner": {"reputation": 21, "user_id": 9168325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/453aace0f193d258349a9b96fe33fa1e?s=128&d=identicon&r=PG&f=1", "display_name": "Gary Ziabek", "link": "https://stackoverflow.com/users/9168325/gary-ziabek"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1515601896, "post_id": 48191581, "comment_id": 83364335, "body": "Brilliant, that worked, Thankyou. I agree, I&#39;ll update my question with edit."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1515653903, "post_id": 48191581, "comment_id": 83383664, "body": "@GaryZiabek Note that <code>Dim maxRows, maxCols, r, c As Integer</code> will only declare <code>c</code> as <code>Integer</code> the others remain <code>Variant</code>. You need to specify a type for <b>every</b> variable! Also <a href=\"https://stackoverflow.com/a/26409520/3219613\">always use <code>Long</code> instead of <code>Integer</code></a> especially when dealing with row counts (Excel has more rows than <code>Integer</code> can handle): <code>Dim maxRows As Long, maxCols As Long, r As Long, c As Long</code>"}], "owner": {"reputation": 21, "user_id": 9168325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/453aace0f193d258349a9b96fe33fa1e?s=128&d=identicon&r=PG&f=1", "display_name": "Gary Ziabek", "link": "https://stackoverflow.com/users/9168325/gary-ziabek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 295, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515653770, "creation_date": 1515600545, "last_edit_date": 1515653770, "question_id": 48191581, "link": "https://stackoverflow.com/questions/48191581/check-if-folder-exists-if-not-create-one-for-data-range-with-file-name-derived", "title": "Check if folder exists, if not create one for data range with file name derived from concatenated cell", "body": "<p>Your help thus far is much appreciated. My journey into Excel VBA continues.</p>\n\n<p>My next challenge is creating a folder in a specific destination. The data I'm creating it from is column B which gains a couple lines each week. The routine I'm looking to create would ideally run through all rows starting C2 and create a folder for all new if one hasn't already been created previously. </p>\n\n<p>I've been playing with the below code but it requires me to select the cells I want to create folders for manually and also will not create a folder of my concatenated cell name for some reason?</p>\n\n<pre><code>Sub MakeMyFolder()\n    Dim Rng As Range\n    Dim maxRows, maxCols, r, c As Integer\n\n    Set Rng = Selection\n    maxRows = Rng.Rows.Count\n    maxCols = Rng.Columns.Count\n\n    For c = 1 To maxCols\n        r = 1\n        Do While r &lt;= maxRows\n            If Len(Dir(ActiveWorkbook.Path &amp; \"\\\" &amp; Rng(r, c), vbDirectory)) = 0 Then\n                MkDir (ActiveWorkbook.Path &amp; \"\\\" &amp; Rng(r, c))\n                On Error Resume Next\n            End If\n            r = r + 1\n        Loop\n    Next c  \nEnd Sub\n</code></pre>\n\n<p>I should add my concatenated file names take the form off \"123 - test\"</p>\n\n<p>My question is how can I make the routine work without selection? My data is from C2 to last line of data in Column C. </p>\n\n<p>Your help is always appreciated.</p>\n"}, {"tags": ["php", "mysql", "vba", "winhttp"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 1863829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5766755865c2416be8b367857f54bb2?s=128&d=identicon&r=PG", "display_name": "alexolb", "link": "https://stackoverflow.com/users/1863829/alexolb"}, "is_accepted": false, "score": 0, "last_activity_date": 1572947700, "creation_date": 1572947700, "answer_id": 58708739, "question_id": 48191161, "link": "https://stackoverflow.com/questions/48191161/winhttprequest-post/58708739#58708739", "title": "WinHttpRequest POST", "body": "<p>This is not very elegant but it worked for me when I had similar issues. It is simply a function that will manually go from 1251 into Unicode. This one works for Russian and Ukrainian but according to which language you are working with there may be different characters and you would need to add them to the if statement. Also consider adding an else if that throws a question mark in case the character you are looking for is not found. </p>\n\n<pre><code>Public Function AsciitoUni(base_cell As String) As String\n\nAsciitoUni = \"\"\n\nFor i = 1 To Len(base_cell)\n\nDim s As String\nDim u As Integer\nDim a As Integer\n\n\ns = Mid(base_cell, i, 1)\na = Asc(s)\n\nIf (a &lt;= 127) Then\nu = a\nElseIf (a &gt;= 192) And (a &lt;= 255) Then\nu = a + 848\nElseIf (a = 184) Then\nu = 1105\nElseIf (a = 186) Then\nu = 1108\nElseIf (a = 179) Then\nu = 1110\nElseIf (a = 191) Then\nu = 1111\nElseIf (a = 168) Then\nu = 1025\nElseIf (a = 170) Then\nu = 1028\nElseIf (a = 178) Then\nu = 1030\nElseIf (a = 175) Then\nu = 1031\nElseIf (a = 185) Then\nu = 8470\nEnd If\n\nAsciitoUni = AsciitoUni &amp; ChrW(u)\n\nNext\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 381, "user_id": 3305711, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/741ea709d41589cfb406d193f25ef989?s=128&d=identicon&r=PG&f=1", "display_name": "user3305711", "link": "https://stackoverflow.com/users/3305711/user3305711"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 868, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1572947700, "creation_date": 1515599195, "last_edit_date": 1515611382, "question_id": 48191161, "link": "https://stackoverflow.com/questions/48191161/winhttprequest-post", "title": "WinHttpRequest POST", "body": "<p>I'm trying to read data from my online mySQL server using WinHttpRequest in VBA. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim objHTTP As New WinHttp.WinHttpRequest\nWith objHTTP\n    .Open \"POST\", \"http://www.dname.com/ruski/php/getNewestPID.php\", True\n    .SetRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded; charset=\"\"UTF-8\"\"\"\n    .Send \"PID=\" &amp; lngPID\n    .WaitForResponse\n    Debug.Print .ResponseText\nEnd With\n</code></pre>\n\n<pre class=\"lang-php prettyprint-override\"><code>&lt;?php\n$PID = $_POST['PID'];\n\nrequire_once ('config.php'); \n\nif(!$PID&gt;0){\n    die(\"##### Error: getNewestPID failed - PID='\" . $PID . \"'  #####\");\n}\n\n$phrases = mysql_query(\"SELECT * FROM phrases WHERE (PID &gt; '$PID')\");\n\nif(!$phrases){\n    die(\"##### Error: getNewestPID SELECT failed - PID=\" . $PID . \" - \" . mysql_error() . \"  #####\");\n}\n\nmysql_close($db);\n\necho \"data=\";\nwhile($row = mysql_fetch_array($phrases)) {\n    echo $row[0] . \"|\" . $row[1] . \"|\" . $row[2] . \"|\" . $row[3];\n}\n?&gt;\n</code></pre>\n\n<p>All works well, but cyrillic text is returned like: </p>\n\n<p>data=21361|105||\u00d0?\u00d0\u00b0\u00d0\u00bb\u00d1?\u00d1?\u00d0\u00b8\u00d0\u00ba \u00d0\u00b8\u00d0\u00b3\u00d1?\u00d0\u00b0\u00d0\u00b5\u00d1? \u00d0\u00bd\u00d0\u00b0 \u00d1\u00d0\u00ba\u00d1?\u00d0\u00b8\u00d0\u00bf\u00d0\u00ba\u00d0\u00b5 \u00d0\u00b2 \u00d1\u00d0\u00b2\u00d0\u00be\u00d0\u00b5\u00d0\u00b9 \u00d0\u00ba\u00d0\u00be\u00d0\u00bc\u00d0\u00bd\u00d0\u00b0\u00d1?\u00d0</p>\n\n<p>My db uses UTF-8 Unicode. I know cyrillic works in tables and forms, but views junk in the VB editor.</p>\n\n<p>I tried this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set FileStream = CreateObject(\"ADODB.Stream\")\nFileStream.Open\nFileStream.Type = 1 'Binary\nFileStream.Write objHTTP.ResponseBody\nFileStream.Position = 0\nFileStream.Type = 2 'adTypeText\nFileStream.Charset = \"Windows-1251\"  ' https://msdn.microsoft.com/en-us/library/ms526296(v=exchg.10).aspx\nstrText = FileStream.ReadText\nFileStream.Close\n</code></pre>\n\n<p>ending up with junk in the record:</p>\n\n<p>\u0420\u045a\u0420\u00b0\u0420\u00bb\u0421\u040a\u0421\u2021\u0420\u0451\u0420\u0454 \u0420\u0451\u0420\u0456\u0421\u0402\u0420\u00b0\u0420\u00b5\u0421\u201a \u0420\u0405\u0420\u00b0 \u0421\u0403\u0420\u0454\u0421\u0402\u0420\u0451\u0420\u0457\u0420\u0454\u0420\u00b5 \u0420\u0406 \u0421\u0403\u0420\u0406\u0420\u0455\u0420\u00b5\u0420\u2116 \u0420\u0454\u0420\u0455\u0420\u0458\u0420\u0405\u0420\u00b0\u0421\u201a\u0420\u00b5.</p>\n\n<p>The best result is with:</p>\n\n<p>mb_convert_encoding($row[3], \"Windows-1251\", \"UTF-8\")</p>\n\n<p>\u00cc\u00e0\u00eb\u00fc\u00f7\u00e8\u00ea \u00e8\u00e3\u00f0\u00e0\u00e5\u00f2 \u00ed\u00e0 \u00f1\u00ea\u00f0\u00e8\u00ef\u00ea\u00e5 \u00e2 \u00f1\u00e2\u00ee\u00e5\u00e9 \u00ea\u00ee\u00ec\u00ed\u00e0\u00f2\u00e5.</p>\n"}, {"tags": ["vba", "catia"], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 8971281, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/68f4975afaca0fed18dc2bd4c294dd6a?s=128&d=identicon&r=PG&f=1", "display_name": "Laurens Ruben", "link": "https://stackoverflow.com/users/8971281/laurens-ruben"}, "edited": false, "score": 0, "creation_date": 1515612646, "post_id": 48193887, "comment_id": 83370221, "body": "Yes I had already figured I&#39;d need to save all lower level parts first and then work my way up. I did not expect an entire script to be supplied to me with just this one question. If this works I&#39;d be very grateful indeed. I&#39;ll test it tomorrow morning."}, {"owner": {"reputation": 107, "user_id": 8971281, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/68f4975afaca0fed18dc2bd4c294dd6a?s=128&d=identicon&r=PG&f=1", "display_name": "Laurens Ruben", "link": "https://stackoverflow.com/users/8971281/laurens-ruben"}, "edited": false, "score": 0, "creation_date": 1515655603, "post_id": 48193887, "comment_id": 83384421, "body": "So I&#39;ve pasted your code in the VBA environment I use to make macros for CATIA. The first thing I notice is the very first line appears red and the macro won&#39;t run. I delete the first set of dashes and I&#39;m immediately prompted with &quot;Compile error: Expected: end of statement&quot;, the word &quot;definition&quot; is highlighted. I delete &quot;definition&quot; and the remaining dashes in the first block of code until I no longer encounter prompts. I try to run the code and again I&#39;m prompted: &quot;Invalid outside procedure&quot;, clsSaveInfo is highlighted. How does this &quot;class&quot; and &quot;definition&quot; thing work?."}, {"owner": {"reputation": 107, "user_id": 8971281, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/68f4975afaca0fed18dc2bd4c294dd6a?s=128&d=identicon&r=PG&f=1", "display_name": "Laurens Ruben", "link": "https://stackoverflow.com/users/8971281/laurens-ruben"}, "edited": false, "score": 0, "creation_date": 1515657935, "post_id": 48193887, "comment_id": 83385484, "body": "Alright so I figure I need to create a Class module and declare the variables &quot;level&quot; and &quot;prod&quot; in this new Class module and name the module &quot;clsSaveInfo&quot;. I&#39;m still missing something though since I immediately get a prompt &quot;User defined type not defined&quot;. Which I assume is because the declaration of &quot;level&quot; and &quot;prod&quot; didnt push through to the normal module&#39;s subs."}, {"owner": {"reputation": 107, "user_id": 8971281, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/68f4975afaca0fed18dc2bd4c294dd6a?s=128&d=identicon&r=PG&f=1", "display_name": "Laurens Ruben", "link": "https://stackoverflow.com/users/8971281/laurens-ruben"}, "edited": false, "score": 0, "creation_date": 1515757504, "post_id": 48193887, "comment_id": 83432753, "body": "In my previous comment: &quot;Which I assume is because the declaration of &quot;level&quot; and &quot;prod&quot; didnt push through to the normal module&#39;s subs&quot;. This was incorrect, the problem was that I hadn&#39;t loaded the required library for using &quot;Scripting.Dictionary&quot;. I solved this by running CATIA &amp; VB as administrator, going to Tools -&gt; References and checking the box for &quot;Microsoft Scripting Library&quot;. Now the script works for 99% as intended. There is 1 thing that doesn&#39;t work as I would like it to, all items in the tree are being saved as .CATPoduct while it should save the lowest level items as .CATPart."}, {"owner": {"reputation": 107, "user_id": 8971281, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/68f4975afaca0fed18dc2bd4c294dd6a?s=128&d=identicon&r=PG&f=1", "display_name": "Laurens Ruben", "link": "https://stackoverflow.com/users/8971281/laurens-ruben"}, "edited": false, "score": 0, "creation_date": 1515757562, "post_id": 48193887, "comment_id": 83432786, "body": "More details on this issue soon."}, {"owner": {"reputation": 107, "user_id": 8971281, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/68f4975afaca0fed18dc2bd4c294dd6a?s=128&d=identicon&r=PG&f=1", "display_name": "Laurens Ruben", "link": "https://stackoverflow.com/users/8971281/laurens-ruben"}, "edited": false, "score": 0, "creation_date": 1516028526, "post_id": 48193887, "comment_id": 83513932, "body": "None of the part files had an output of &quot;Part&quot; for the suffix."}, {"owner": {"reputation": 107, "user_id": 8971281, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/68f4975afaca0fed18dc2bd4c294dd6a?s=128&d=identicon&r=PG&f=1", "display_name": "Laurens Ruben", "link": "https://stackoverflow.com/users/8971281/laurens-ruben"}, "edited": false, "score": 0, "creation_date": 1516028951, "post_id": 48193887, "comment_id": 83514205, "body": "I assume this has something to do with Catia first placing the step equivalent of a part in a catia product file before converting it to a catia part file. Anyway, I solved this by changing the line  &quot;If TypeName(info.prod) = &quot;Part&quot; Then&quot; to &quot;If Right(partProd.ReferenceProduct.Parent.FullName, 7) = &quot;CATPart&quot; Then&quot; And moved the declaration of &quot;partProd&quot; to above this line."}, {"owner": {"reputation": 107, "user_id": 8971281, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/68f4975afaca0fed18dc2bd4c294dd6a?s=128&d=identicon&r=PG&f=1", "display_name": "Laurens Ruben", "link": "https://stackoverflow.com/users/8971281/laurens-ruben"}, "edited": false, "score": 0, "creation_date": 1516029028, "post_id": 48193887, "comment_id": 83514255, "body": "I have some additional issues related to this question, see: <a href=\"https://stackoverflow.com/questions/48264708/catia-vba-enable-use-of-scripting-dictionary-in-catscript\" title=\"catia vba enable use of scripting dictionary in catscript\">stackoverflow.com/questions/48264708/&hellip;</a> Many thanks for helping me out with this script, it&#39;s invaluable to me not only for what it does but also for what it teaches me."}, {"owner": {"reputation": 107, "user_id": 8971281, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/68f4975afaca0fed18dc2bd4c294dd6a?s=128&d=identicon&r=PG&f=1", "display_name": "Laurens Ruben", "link": "https://stackoverflow.com/users/8971281/laurens-ruben"}, "edited": false, "score": 0, "creation_date": 1516110481, "post_id": 48193887, "comment_id": 83549164, "body": "One last hurdle to go before I can make a batch out of this code you gave me. See: <a href=\"https://stackoverflow.com/questions/48282675/catia-vba-to-catscript-for-type-collection\" title=\"catia vba to catscript for type collection\">stackoverflow.com/questions/48282675/&hellip;</a>"}], "tags": [], "owner": {"reputation": 821, "user_id": 6937632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a1554053245e86d609b83f201aa6bf8?s=128&d=identicon&r=PG&f=1", "display_name": "C R Johnson", "link": "https://stackoverflow.com/users/6937632/c-r-johnson"}, "is_accepted": true, "score": 1, "last_activity_date": 1515608663, "creation_date": 1515608663, "answer_id": 48193887, "question_id": 48190554, "link": "https://stackoverflow.com/questions/48190554/catia-vba-saving-specific-parts-or-products-from-a-stp-file-as-catpart-and-or/48193887#48193887", "title": "Catia VBA Saving specific parts or products from a .stp file as .CATPart and/or .CATProduct", "body": "<p>The Product at the root of the tree can be saved as a CATProduct document.\nAny sub-products within the tree can also be saved as a CATProduct. \nThe Parts, which are the leaves of the tree can be saved as CATParts. </p>\n\n<p>You can save the root Product like this:</p>\n\n<pre><code>Dim rootProdDoc As ProductDocument\nset rootProdDoc = CATIA.ActiveDocument\nrootProdDoc.SaveAs \"C:\\Temp\\\" &amp; rootProd.PartNumber &amp; \".CATProduct\"\n</code></pre>\n\n<p>However, when you do this, CATIA will complain that \"This activates other save operations, do you want to continue?\" It does this because the Parts are not yet saved.  Answering yes CATIA will save your assembly and all the parts. However because you are not in control of the part saving it will preclude you  from setting the names for those documents you want. </p>\n\n<p>And because you have to answer a dialog, it will prevent you from making a batch program. </p>\n\n<p>The right way to do this is to first save the leaf documents and then work \"up\" the tree the root level by level. Then everything will be saved when you need it to be.</p>\n\n<pre><code>----------Class clsSaveInfo definition--------------\n\nPublic level As Integer\nPublic prod As Product\n\n\n-----------------(module definition)--------------- \n\nOption Explicit\n\n\nSub CATMain()\n\n    CATIA.DisplayFileAlerts = False\n\n    'get the root product\n    Dim rootProd As Product\n    Set rootProd = CATIA.ActiveDocument.Product\n\n    'make a dictionary to track product structure\n    Dim docsToSave As Scripting.Dictionary\n    Set docsToSave = New Scripting.Dictionary\n\n    'some parameters\n    Dim level As Integer\n    Dim maxLevel As Integer\n\n    'read the assembly\n    level = 0\n    Call slurp(level, rootProd, docsToSave, maxLevel)\n\n    Dim i\n    Dim kx As String\n    Dim info As clsSaveInfo\n\n    Do Until docsToSave.count = 0\n        Dim toRemove As Collection\n        Set toRemove = New Collection\n        For i = 0 To docsToSave.count - 1\n           kx = docsToSave.keys(i)\n\n           Set info = docsToSave.item(kx)\n\n           If info.level = maxLevel Then\n                Dim suffix As String\n               If TypeName(info.prod) = \"Part\" Then\n                    suffix = \".CATPart\"\n               Else\n                    suffix = \".CATProduct\"\n                End If\n                Dim partProd As Product\n                Set partProd = info.prod\n                Dim partDoc As Document\n                Set partDoc = partProd.ReferenceProduct.Parent\n                partDoc.SaveAs (\"C:\\Temp\\\" &amp; partProd.partNumber &amp; suffix)\n                toRemove.add (kx)\n            End If\n\n        Next\n\n     'remove the saved products from the dictionary\n        For i = 1 To toRemove.count\n            docsToSave.Remove (toRemove.item(i))\n        Next\n\n        'decrement the level we are looking for\n        maxLevel = maxLevel - 1\n    Loop\n\n\nEnd Sub\n\n\nSub slurp(ByVal level As Integer, ByRef aProd As Product, ByRef allDocs As Scripting.Dictionary, ByRef maxLevel As Integer)\n\n'increment the level\n    level = level + 1\n\n'track the max level\n    If level &gt; maxLevel Then maxLevel = level\n\n 'see if the part is already in the save list, if not add it\n    If allDocs.Exists(aProd.partNumber) = False Then\n        Dim info As clsSaveInfo\n        Set info = New clsSaveInfo\n        info.level = level\n        Set info.prod = aProd\n        Call allDocs.add(aProd.partNumber, info)\n    End If\n\n'slurp up children\n    Dim i\n    For i = 1 To aProd.products.count\n        Dim subProd As Product\n        Set subProd = aProd.products.item(i)\n        Call slurp(level, subProd, allDocs, maxLevel)\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 8971281, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/68f4975afaca0fed18dc2bd4c294dd6a?s=128&d=identicon&r=PG&f=1", "display_name": "Laurens Ruben", "link": "https://stackoverflow.com/users/8971281/laurens-ruben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2281, "favorite_count": 2, "accepted_answer_id": 48193887, "answer_count": 1, "score": 0, "last_activity_date": 1515608663, "creation_date": 1515597480, "question_id": 48190554, "link": "https://stackoverflow.com/questions/48190554/catia-vba-saving-specific-parts-or-products-from-a-stp-file-as-catpart-and-or", "title": "Catia VBA Saving specific parts or products from a .stp file as .CATPart and/or .CATProduct", "body": "<p>I have an .stp file, exported with a different CAD-software, which I can open with CATIA.\nCATIA will then list the product/part tree as if it were a native CATIA .CATProduct.</p>\n\n<p>My goal is to automate opening such an .stp file with CATIA and saving all contained parts/products with a name that is extracted from one of the UserRefProperties in each of these parts/products.\nTherefore I want to create a macro with VBA which when completed will run in batch mode.</p>\n\n<p>My first problem arises when I try to save the parts/products in this .stp file, Catia's save function handles my file as desired and will save each part/product as a separate file.\nHowever, using VBA I can't seem to be able to save any of these parts/products since the .ExportData and .SaveAs methods only seem to work on .PartDocument or .ProductDocument objects instead of the objects which I've been trying to save:\n.Product objects.</p>\n\n<p>Example of what I'm trying to do:</p>\n\n<pre><code>Sub catmain()\n\nDim oProdDoc As ProductDocument\nSet oProdDoc = CATIA.ActiveDocument\n\nDim oRootProd As Product\nSet oRootProd = oProdDoc.Product\n\nDim oInstances As Products\nSet oInstances = oRootProd.Products\n\nFor k = 1 To oInstances.Count\n\nDim oInst As Product\nSet oInst = oInstances.Item(k)\n\noInst.ExportData \"X:\\path\", \".CATPart\"\n\nnext\n\nend sub\n</code></pre>\n\n<p>If CATIA can save my .stp file's contents as desired, surely I can do the same with VBA, right?</p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "drag-and-drop"], "comments": [{"owner": {"reputation": 609, "user_id": 8453036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/369b931407d4e81468045e4084aa357c?s=128&d=identicon&r=PG&f=1", "display_name": "R. Roe", "link": "https://stackoverflow.com/users/8453036/r-roe"}, "edited": false, "score": 2, "creation_date": 1515597855, "post_id": 48190552, "comment_id": 83361438, "body": "Have you tried using a <code>foreach</code> loop.  <code>foreach file in Data.Files</code>..."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 2, "creation_date": 1515598054, "post_id": 48190552, "comment_id": 83361594, "body": "Drag and drop onto a userform? Learned something new today. Thanks."}, {"owner": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "reply_to_user": {"reputation": 609, "user_id": 8453036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/369b931407d4e81468045e4084aa357c?s=128&d=identicon&r=PG&f=1", "display_name": "R. Roe", "link": "https://stackoverflow.com/users/8453036/r-roe"}, "edited": false, "score": 0, "creation_date": 1515598814, "post_id": 48190552, "comment_id": 83362133, "body": "@R.Roe Thanks for your answer. I think I&#39;ve managed to do it with a for each. I&#39;ll keep you updated whenever I&#39;m done (Success or not)."}], "answers": [{"tags": [], "owner": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "is_accepted": true, "score": 1, "last_activity_date": 1515661702, "last_edit_date": 1515661702, "creation_date": 1515603217, "answer_id": 48192384, "question_id": 48190552, "link": "https://stackoverflow.com/questions/48190552/drag-and-drop-multiple-files-to-userform/48192384#48192384", "title": "Drag and drop multiple files to Userform", "body": "<p>Thanks to @R.Roe's comment, I managed to do what I wanted :</p>\n\n<pre><code>Dim x, y As Integer\nDim PathTable As String\nDim FilePath As Variant\n\nPrivate Sub TreeView1_OLEDragDrop(Data As MSComctlLib.DataObject, Effect As Long, Button As Integer, Shift As Integer, x As Single, y As Single)\nDim i As Integer\n\nWorkbooks(Wb).Activate\n\n'Counting file paths I dropped\nFor Each FilePath In Data.Files()\n    i = i + 1\nNext FilePath\n\n'Redim my table\nReDim PathTable(i)\n\ni = 1\n\n'Adding data to my table\nFor x = 0 To UBound(PathTable) - 1\n    PathTable(x) = Data.Files(i)\n    i = i + 1\nNext x\n\n'Just to make sure it works\nFor x = 0 To UBound(PathTable) - 1\n    MsgBox PathTable(x)\nNext x\n\nEnd Sub\n</code></pre>\n\n<p>Cheers!</p>\n"}], "owner": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1785, "favorite_count": 0, "accepted_answer_id": 48192384, "answer_count": 1, "score": 3, "last_activity_date": 1554788901, "creation_date": 1515597464, "last_edit_date": 1554788901, "question_id": 48190552, "link": "https://stackoverflow.com/questions/48190552/drag-and-drop-multiple-files-to-userform", "title": "Drag and drop multiple files to Userform", "body": "<p>I am trying to drag and drop more than one file on a Userform to get their paths. I managed it with one file thanks to <a href=\"https://stackoverflow.com/questions/20569959/vba-drag-and-drop-file-to-user-form-to-get-filename-and-path\">this</a>.</p>\n\n<p>When I change <code>FilePath = Data.files(1)</code> to <code>FilePath = Data.Files(2)</code> or <code>(i)</code>, I get a message \"Table Expected\". Should I create a Table and Redim it?</p>\n\n<p>My work so far:</p>\n\n<p><strong>This one does the job (opening the file and copying it into a selected sheet)</strong></p>\n\n<pre><code>Dim Wb, FilePath As String\nDim WbIni, WbCib As Workbook\n\nPrivate Sub CommandButton2_Click()\n\nIf FilePath = vbNullString Then\n    MsgBox \"Aucun fichier n'a \u00e9t\u00e9 import\u00e9\", vbCritical, \"Anomalie\"\n    Unload UserForm1\n    Exit Sub\nEnd If\n\nSet WbCib = Workbooks.Open(Filename:=FilePath)\nMsgBox WbCib.Name\n\ni = WbCib.ActiveSheet.Range(\"A1\").End(xlDown).Row\nWbCib.ActiveSheet.Range(\"A1:A\" &amp; i).Copy\nActiveSheet.Paste Destination:=WbIni.Worksheets(\"Target\").Range(\"A1:A\" &amp; i)\nWbIni.Sheets(\"Target\").Activate\nWbCib.Close\n\nUnload UserForm1\n\nEnd Sub\n</code></pre>\n\n<p><strong>This one initializes my TreeView for the drag and drop</strong></p>\n\n<pre><code>Private Sub UserForm_Initialize()\nWb = ThisWorkbook.Name\nSet WbIni = ActiveWorkbook\n\nTreeView1.OLEDropMode = ccOLEDropManual\nEnd Sub\n</code></pre>\n\n<p><strong>This one gives me the file path. I think I need to loop it.</strong></p>\n\n<pre><code>Private Sub TreeView1_OLEDragDrop(Data As MSComctlLib.DataObject, Effect As Long, Button As Integer, Shift As Integer, x As Single, y As Single)\n\n    FilePath = Data.Files(1)\n    Workbooks(Wb).Activate\n\n    MsgBox FilePath\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13, "user_id": 9195580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b967863b4deceaaad37fa246cfc3584?s=128&d=identicon&r=PG&f=1", "display_name": "Yuqian", "link": "https://stackoverflow.com/users/9195580/yuqian"}, "edited": false, "score": 0, "creation_date": 1515597223, "post_id": 48190466, "comment_id": 83360985, "body": "The code i got the error is Set SC = .SlicerCaches.Add(pvt, &quot;JobGroup&quot;)"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9195580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b967863b4deceaaad37fa246cfc3584?s=128&d=identicon&r=PG&f=1", "display_name": "Yuqian", "link": "https://stackoverflow.com/users/9195580/yuqian"}, "edited": false, "score": 0, "creation_date": 1515683880, "post_id": 48190629, "comment_id": 83401728, "body": "I found the runtime error message when i test the code but it shows Automation error (Error 440) after i hit help. Is the  registry problem ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 13, "user_id": 9195580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b967863b4deceaaad37fa246cfc3584?s=128&d=identicon&r=PG&f=1", "display_name": "Yuqian", "link": "https://stackoverflow.com/users/9195580/yuqian"}, "edited": false, "score": 0, "creation_date": 1516300808, "post_id": 48190629, "comment_id": 83641924, "body": "Great it worked. I tested with that method and worked for me. Glad to know it."}, {"owner": {"reputation": 13, "user_id": 9195580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b967863b4deceaaad37fa246cfc3584?s=128&d=identicon&r=PG&f=1", "display_name": "Yuqian", "link": "https://stackoverflow.com/users/9195580/yuqian"}, "edited": false, "score": 0, "creation_date": 1516310567, "post_id": 48190629, "comment_id": 83646763, "body": "But new problem just come up. The method worked once then failed again when i created another slicer. I tried to create it manually and recorded it as a macro but still same error. Do you know other method to create a slicer by VBA? Thanks!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": true, "score": 0, "last_activity_date": 1515597686, "creation_date": 1515597686, "answer_id": 48190629, "question_id": 48190466, "link": "https://stackoverflow.com/questions/48190466/methods-add-of-object-slicercaches-failed-error/48190629#48190629", "title": "Methods &#39;add&#39; of object &#39;SlicerCaches&#39; failed error", "body": "<p><code>SlicerCaches.Add</code> is not available at Office 2016.</p>\n\n<p>Try with</p>\n\n<pre><code>Set SC = .SlicerCaches.Add2(pvt, \"JobGroup\")\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9195580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b967863b4deceaaad37fa246cfc3584?s=128&d=identicon&r=PG&f=1", "display_name": "Yuqian", "link": "https://stackoverflow.com/users/9195580/yuqian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 815, "favorite_count": 0, "accepted_answer_id": 48190629, "answer_count": 1, "score": 1, "last_activity_date": 1515598925, "creation_date": 1515597169, "last_edit_date": 1515598925, "question_id": 48190466, "link": "https://stackoverflow.com/questions/48190466/methods-add-of-object-slicercaches-failed-error", "title": "Methods &#39;add&#39; of object &#39;SlicerCaches&#39; failed error", "body": "<p>So I created two pivot tables from the same source. What i want to do is to create a <code>SlicerCache</code> to connect these two tables together. The code run successfully in <strong>Excel 2010</strong> and <strong>Excel 2013</strong> but failed in <strong>Excel 2016</strong>. </p>\n\n<p>Here is my code to create the first pivot table:</p>\n\n<pre><code>Sub OneYearTrend(wb As Workbook, wk As Worksheet)\nWith wb\n    Dim pvc As PivotCache\n    'Creat pivotcache\n    Set pvc = .PivotCaches.Create(xlDatabase, wk.Range(\"A1\").CurrentRegion, xlPivotTableVersion14)\n    Dim pvt As PivotTable\n\n\n    'Create pivot table for new hire and separation\n\n    Set pvt = pvc.CreatePivotTable(TableDestination:=.Worksheets(\"Dashboard\").Range(\"M6\"), _\n                            TableName:=\"OneYear_pvTbl_InOut\")\n    With pvt\n\n        With .PivotFields(\"Type\")\n            .Orientation = xlColumnField\n            .Position = 1\n            .PivotItems(\"Total Workforce\").Visible = False\n            .PivotItems(\"NEW HIRES\").Caption = \"In\"\n            .PivotItems(\"SEPARATIONS\").Caption = \"Out\"\n        End With\n        With .PivotFields(\"JobGroup\")\n            .Orientation = xlPageField\n            .Position = 1\n            .EnableMultiplePageItems = True\n        End With\n</code></pre>\n\n<p>Code to create the second pivot table:</p>\n\n<pre><code>Set pvt = pvc.CreatePivotTable(TableDestination:=.Worksheets(\"Dashboard\").Range(\"AA1\"), _\n                        TableName:=\"OneYear_pvTbl_Sparkline\")\n\n    With pvt\n\n        With .PivotFields(\"ExtractDate\")\n            .Orientation = xlRowField\n            .Position = 1\n        End With\n        .AddDataField .PivotFields(\"White\"), \" White\", xlSum\n        .AddDataField .PivotFields(\"Black\"), \" Black\", xlSum\n        .AddDataField .PivotFields(\"Hispanic\"), \" Hispanic\", xlSum\n        .AddDataField .PivotFields(\"Asian\"), \" Asian\", xlSum\n        .AddDataField .PivotFields(\"AmericanIndian\"), \" AmericanIndian\", xlSum\n        .AddDataField .PivotFields(\"Male\"), \" Male\", xlSum\n        .AddDataField .PivotFields(\"Female\"), \" Female\", xlSum\n        .AddDataField .PivotFields(\"Total\"), \" Total\", xlSum\n    End With\n</code></pre>\n\n<p>Here is the code i got problem:\n    'Create a hidden slicer to connect all pivot tables</p>\n\n<pre><code>    Dim SC As SlicerCache\n    **Set SC = .SlicerCaches.Add(pvt, \"JobGroup\")**\n    SC.Slicers.Add wk, , \"JobGroup\", \"JobGroup\", 50, 1000, 150, 200\n\n    SC.PivotTables.AddPivotTable .Worksheets(\"Dashboard\").PivotTables(\"OneYear_pvTbl_InOut\")\n</code></pre>\n\n<p>I got an error message: </p>\n\n<blockquote>\n  <p>run-time error'-2147418113'(8000ffff)':\n  Methods 'add' of object 'SlicerCaches' failed</p>\n</blockquote>\n\n<p>Anyone can help?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1515597824, "post_id": 48190363, "comment_id": 83361412, "body": "you will have to be sure this path is right:  fPath = &quot;C:\\Users\\jchase.BRYCEWORLD\\Desktop\\Test\\&quot;            &#39;remember final \\ in this string&quot;"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1515597846, "post_id": 48190363, "comment_id": 83361431, "body": "you will have to be sure this filename is right:  fName = Dir(fPath &amp; &quot;*New BM Analysis 3.xls&quot;)"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1515597912, "post_id": 48190363, "comment_id": 83361478, "body": "This is going to kick back out to the calling code to handle the error, make sure you have it handled in the calling code that you have not posted:  On Error GoTo 0"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1515597961, "post_id": 48190363, "comment_id": 83361520, "body": "you will have to be sure the workbook your code is in has this worksheet and worksheet name: Set wsMaster = ThisWorkbook.Sheets(&quot;BM Condition&quot;)    &#39;sheet report is built into"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1515597974, "post_id": 48190363, "comment_id": 83361532, "body": "What errors are you getting?  More info needed"}, {"owner": {"reputation": 107, "user_id": 6312731, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cdb0c839823d711c3087d3040060340a?s=128&d=identicon&r=PG&f=1", "display_name": "J Chase", "link": "https://stackoverflow.com/users/6312731/j-chase"}, "reply_to_user": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1515599675, "post_id": 48190363, "comment_id": 83362779, "body": "i have an &#39;error 52&#39; in this line:  fName = Dir(fPath &amp; &quot;<i>.xlsm</i>&quot;)        &#39;listing of desired files, edit filter as desired i am realizing i need to call this in the sheet i want to write to though, and i need to call it in the sheet im reading and have it then write to the master sheet"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1515625106, "post_id": 48190363, "comment_id": 83375967, "body": "that line is going after a very specific filename.  your fpath declared above must be correct and the, &quot;.xlsm&quot; is looking for a file with no name, that wont do, you need to provide the file name &quot;myProject.xlsm&quot; for instance.  If you want code to open the file search option and select the file and the path as well instead of hard coding it would like like this answer in the get and open file section."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1515625512, "post_id": 48190363, "comment_id": 83376118, "body": "Example Answer that opens the file browser to get the path and the name here -&gt; <a href=\"https://stackoverflow.com/a/48177526/8716187\">stackoverflow.com/a/48177526/8716187</a>"}], "owner": {"reputation": 107, "user_id": 6312731, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cdb0c839823d711c3087d3040060340a?s=128&d=identicon&r=PG&f=1", "display_name": "J Chase", "link": "https://stackoverflow.com/users/6312731/j-chase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 414, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515601720, "creation_date": 1515596881, "last_edit_date": 1515601720, "question_id": 48190363, "link": "https://stackoverflow.com/questions/48190363/macro-to-copy-certain-cells-from-one-workbook-to-another-and-append-data", "title": "Macro to copy certain cells from one workbook to another and append data", "body": "<p>I am trying to create a macro to copy certain cells from one workbook to another. I need to append the new data to data that has already been transferred. I am trying to modify this code to do so, but am not having success:</p>\n\n<pre><code>Sub Consolidate()\n'Author:     Jerry Beaucaire'\n'Date:       9/15/2009     (2007 compatible)  (updated 4/29/2011)\n'Summary:    Merge files in a specific folder into one master sheet (stacked)\n'            Moves imported files into another folder\n' Edited/altered by Jay Chase 6/9/2017\n\nDim fName As String, fPath As String, fPathDone As String\nDim LR As Long, NR As Long\nDim wbData As Workbook, wsMaster As Worksheet\n\n'Setup\n    Application.ScreenUpdating = False  'speed up macro execution\n    Application.EnableEvents = False    'turn off other macros for now\n    Application.DisplayAlerts = False   'turn off system messages for now\n\n    Set wsMaster = ThisWorkbook.Sheets(\"BM Condition\")    'sheet report is built into\n\nWith wsMaster\n    If MsgBox(\"Clear the old data first?\", vbYesNo) = vbYes Then\n        .UsedRange.Offset(1).EntireRow.Clear\n        NR = 2\n    Else\n        NR = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row + 1    'appends data to existing data\n    End If\n\n'Path and filename (edit this section to suit)\n    fPath = \"C:\\Users\\jchase.BRYCEWORLD\\Desktop\\Test\\\"            'remember final \\ in this string\"\n    fPathDone = fPath &amp; \"Imported\\\"     'remember final \\ in this string\n    On Error Resume Next\n        MkDir fPathDone                 'creates the completed folder if missing\n    On Error GoTo 0\n    fName = Dir(fPath &amp; \"*New BM Analysis 3.xls\")        'listing of desired files, edit filter as desired\n\n'Import a sheet from found files\n    Do While Len(fName) &gt; 0\n        If fName &lt;&gt; ThisWorkbook.Name Then              'don't reopen this file accidentally\n            Set wbData = Workbooks.Open(fPath &amp; fName)  'Open file\n\n        'This is the section to customize, replace with your own action code as needed\n            LR = Range(\"A\" &amp; Rows.Count).End(xlUp).Row  'Find last row\n            Range(\"P14:S\" &amp; LR).EntireRow.Copy .Range(\"A\" &amp; NR)\n            wbData.Close False                                'close file\n            NR = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row + 1  'Next row\n            Name fPath &amp; fName As fPathDone &amp; fName           'move file to IMPORTED folder\n        End If\n        fName = Dir                                       'ready next filename\n    Loop\nEnd With\n\nErrorExit:    'Cleanup\n    ActiveSheet.Columns.AutoFit\n    Application.DisplayAlerts = True         'turn system alerts back on\n    Application.EnableEvents = True          'turn other macros back on\n    Application.ScreenUpdating = True        'refreshes the screen\nEnd Sub\n</code></pre>\n\n<p>I have little experience with VBA. Any help with how or why or why not I can do this is appreciated. I am still experimenting; if I have any breakthroughs I will update. </p>\n\n<p>EDIT: so i have realized this code has to be called from the workbook i want to write to, but i need to call it from the workbook i am reading from. Is there a way to modify this script to do so?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1515597191, "post_id": 48190302, "comment_id": 83360956, "body": "I would say no chance if you cannot change the original code. A workaround could be waiting for the MsgBox (a defined amount of time) and use <a href=\"https://msdn.microsoft.com/en-us/library/office/ff821075.aspx\" rel=\"nofollow noreferrer\">SendKeys</a> to send a Enter. But this is no proper solution and could fail in many cases."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 2, "creation_date": 1515597221, "post_id": 48190302, "comment_id": 83360981, "body": "If you can&#39;t change the function code or there is no argument to set an OK, I guess this is not possible."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1515597664, "post_id": 48190302, "comment_id": 83361298, "body": "You will have to modify or add to the code, you aren&#39;t going to be able to wave a wand at this one."}, {"owner": {"reputation": 53, "user_id": 6796900, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/81af22df9ed34d3a740429fb4f653bfb?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/6796900/felipe"}, "edited": false, "score": 0, "creation_date": 1515598628, "post_id": 48190302, "comment_id": 83362003, "body": "OK, thanks for all your answers"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1515598971, "creation_date": 1515598971, "answer_id": 48191092, "question_id": 48190302, "link": "https://stackoverflow.com/questions/48190302/calling-a-function-from-macro-on-a-different-document-with-msgbox/48191092#48191092", "title": "Calling a function from macro on a different document with MsgBox", "body": "<p>Anything is possible... but you <em>probably</em> don't want to go there.</p>\n\n<p><a href=\"https://github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">Rubberduck</a> (a VBE add-in OSS project I manage) uses <a href=\"http://easyhook.github.io/index.html\" rel=\"nofollow noreferrer\">EasyHook</a> to hook into <code>vbe7.dll</code> and intercept calls to <code>rtcMsgBox</code>, the internal function that gets called when VBA code invokes the <code>MsgBox</code> function.</p>\n\n<p>This allows Rubberduck unit tests to setup a return value for the <code>MsgBox</code> function, without ever displaying an actual message box:</p>\n\n<pre><code>Fakes.MsgBox.Returns vbOk\nDoSomething ' procedure under test, invokes a MsgBox that needs to say \"Ok\"\n</code></pre>\n\n<p>The hook is only enabled while a Rubberduck unit test is running though, so you couldn't use this API for what you need - but Rubberduck is open-source, and you could fork it and tweak it (it's written in C#) so that its <code>Fakes</code> API can be used in production code via a modified API that lets the client VBA code toggle the hook on and off.</p>\n\n<p>Or you could write some fiendish Win32 API code and implement something similar.</p>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 53, "user_id": 6796900, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/81af22df9ed34d3a740429fb4f653bfb?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/6796900/felipe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1515598971, "creation_date": 1515596704, "last_edit_date": 1515596986, "question_id": 48190302, "link": "https://stackoverflow.com/questions/48190302/calling-a-function-from-macro-on-a-different-document-with-msgbox", "title": "Calling a function from macro on a different document with MsgBox", "body": "<p>Im calling a macro from another macro and it is working well im using</p>\n\n<pre><code>Application.Run(\"'name of the file'!function to call\")\n</code></pre>\n\n<p>But the problem is that the function i need to call have a MsgBox and it expect the user to give the OK.</p>\n\n<p>How can i send the OK by default? i cant change the original code.</p>\n\n<p>Thanks for all your help</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2016"], "comments": [{"owner": {"reputation": 1179, "user_id": 4687466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ce36551a4b92edd40ac7b0c353a4e22?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Makarov", "link": "https://stackoverflow.com/users/4687466/mike-makarov"}, "edited": false, "score": 2, "creation_date": 1515596572, "post_id": 48190209, "comment_id": 83360561, "body": "Why not implement it through the sql query? Max() over your column where column &gt;= xy000000 and column &lt;= xy999999."}, {"owner": {"reputation": 843, "user_id": 1936588, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/22a788eff656461afb21f08e3c3a815c?s=128&d=identicon&r=PG", "display_name": "bd528", "link": "https://stackoverflow.com/users/1936588/bd528"}, "reply_to_user": {"reputation": 1179, "user_id": 4687466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ce36551a4b92edd40ac7b0c353a4e22?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Makarov", "link": "https://stackoverflow.com/users/4687466/mike-makarov"}, "edited": false, "score": 0, "creation_date": 1515596843, "post_id": 48190209, "comment_id": 83360719, "body": "@MikeMakarov Yes, this works. If you put as answer, I&#39;ll accept. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 1179, "user_id": 4687466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ce36551a4b92edd40ac7b0c353a4e22?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Makarov", "link": "https://stackoverflow.com/users/4687466/mike-makarov"}, "is_accepted": true, "score": 2, "last_activity_date": 1515597056, "creation_date": 1515597056, "answer_id": 48190423, "question_id": 48190209, "link": "https://stackoverflow.com/questions/48190209/finding-highest-value-in-field-where-first-2-numbers-match/48190423#48190423", "title": "Finding highest value in field where first 2 numbers match", "body": "<p>As discussed in comments, the approach may be changed to simplify the task. Just use the sql query, a prototype with <code>x</code> and <code>y</code> being the key numbers:\n<code>select Max(your_column ) from your_table where your_column &gt;= xy000000 and your_column &lt;= xy999999</code></p>\n"}], "owner": {"reputation": 843, "user_id": 1936588, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/22a788eff656461afb21f08e3c3a815c?s=128&d=identicon&r=PG", "display_name": "bd528", "link": "https://stackoverflow.com/users/1936588/bd528"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 48190423, "answer_count": 1, "score": 0, "last_activity_date": 1594638446, "creation_date": 1515596389, "last_edit_date": 1594638446, "question_id": 48190209, "link": "https://stackoverflow.com/questions/48190209/finding-highest-value-in-field-where-first-2-numbers-match", "title": "Finding highest value in field where first 2 numbers match", "body": "<p>In Access 2016 VBA, I have a field that holds 8 digit numbers.</p>\n\n<p>I need to find the highest numbers where the first 2 digits match. Some sample data :-</p>\n\n<pre><code>Dim tempsalesref As Double\n\ntempsalesref = 34\n\n34000001\n34000002\n34000003\n</code></pre>\n\n<p>So in this case my query would be based on 34, and the value to be returned, as it's the highest, would be 34000003.</p>\n\n<p>Is it possible to do this?</p>\n"}, {"tags": ["vba", "matlab", "excel", "activex"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515597363, "post_id": 48190180, "comment_id": 83361086, "body": "How are you writing to the files? Are you using Excel&#39;s object model? If so, then you can access the <code>Workbook</code>&#39;s <code>VBProject</code> and it should be smooth sailing from there. If not, your current solution seems reasonable."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1515597385, "post_id": 48190180, "comment_id": 83361097, "body": "That said this question seems <i>too broad</i> to be a good fit for this site."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1515604279, "post_id": 48190180, "comment_id": 83365776, "body": "Your &quot;ugly&quot; workaround is often the most workable solution if you have multiple users: VBA access to alter the VBProject requires the &quot;trust access to VBProject&quot; setting, which is typically <i>not</i> enabled..."}, {"owner": {"reputation": 3166, "user_id": 28406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd70bd2239c046e2f68e6ef886af2e71?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/28406/adrian"}, "edited": false, "score": 0, "creation_date": 1515662373, "post_id": 48190180, "comment_id": 83387802, "body": "[trite comment] a better and more flexible solution is to avoid Excel completely and do all your data processing in MATLAB [/trite comment]"}, {"owner": {"reputation": 5254, "user_id": 24447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da74b7df5db7590fc140329c62b3e498?s=128&d=identicon&r=PG", "display_name": "nekomatic", "link": "https://stackoverflow.com/users/24447/nekomatic"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1516033826, "post_id": 48190180, "comment_id": 83517149, "body": "@TimWilliams ...and for very good reasons..."}, {"owner": {"reputation": 43, "user_id": 9199087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d82a4b5e710e18b79120006f998e4d3?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz", "link": "https://stackoverflow.com/users/9199087/lutz"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1516103723, "post_id": 48190180, "comment_id": 83544792, "body": "@Mat&#39;sMug I add the data to the Excel files with <code>writeable(mydata,filepath)</code> and start the macro with <code>Excel = actxserver(&#39;Excel.Application&#39;)</code> <code>Excel.Run(&#39;mymacro&#39;)</code>  To access the VBProject I disable the security settings mentioned by @TimWilliams  To open the VBProject <code>Workbooks = Excel.Workbooks</code> <code>Workbook=Workbooks.Open(file)</code> <code>Workbook.VBProject</code> but from this point I&#39;m lost."}], "answers": [{"tags": [], "owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "is_accepted": true, "score": 1, "last_activity_date": 1517234672, "last_edit_date": 1517234672, "creation_date": 1516166279, "answer_id": 48294047, "question_id": 48190180, "link": "https://stackoverflow.com/questions/48190180/can-matlab-write-a-macro-in-an-excel-file-via-activex/48294047#48294047", "title": "Can Matlab write a macro in an Excel file via ActiveX?", "body": "<p>Once you have allowed programmatical access to the VBA Project, I would suggest to write your macro to a text file (*.txt or *.bas) and then run the command that would import this text file has a VBA code module. For example:</p>\n\n<pre><code>DataFileName = 'D:\\Test\\DataFile.xlsm';\nCodeFileName = 'D:\\Test\\CodeFile.txt';\n\nExcel = actxserver('Excel.Application');\nWorkbooks = Excel.Workbooks;\nWorkbook=Workbooks.Open(DataFileName);\n\n% Make Excel visible (Optional)\nExcel.visible = 1;\n\n%% Import the code\nImport(Workbook.VBProject.VBComponents,CodeFileName);\n\n%% Save\nExcel.Application.DisplayAlerts = 0; %Avoid overwrite warning\nSaveAs(Workbook,DataFileName);\nExcel.Application.DisplayAlerts = 1;\n\n%% Close Excel\nQuit(Excel);\ndelete(Excel);\n</code></pre>\n\n<p>In this case, <code>CodeFile.txt</code> could look like this:</p>\n\n<pre><code>Attribute VB_Name = \"ModuleName\"\nOption Explicit\n\nSub SomeMacro()\n\n    Msgbox \"From MATLAB, with love...\"\n\nEnd Sub\n</code></pre>\n\n<p>Here, the line <code>Attribute VB_Name = ...</code> is essential and will determine the name of the module. For <code>Option Explicit</code>, it is not mandatory, but it's <a href=\"http://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">good practice</a>.</p>\n"}], "owner": {"reputation": 43, "user_id": 9199087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d82a4b5e710e18b79120006f998e4d3?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz", "link": "https://stackoverflow.com/users/9199087/lutz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1181, "favorite_count": 0, "accepted_answer_id": 48294047, "answer_count": 1, "score": 4, "last_activity_date": 1517234672, "creation_date": 1515596298, "question_id": 48190180, "link": "https://stackoverflow.com/questions/48190180/can-matlab-write-a-macro-in-an-excel-file-via-activex", "title": "Can Matlab write a macro in an Excel file via ActiveX?", "body": "<p>There are several posts and instructions how to run Excel macros with Matlab via ActiveX. But is it possible to write such a macro with Matlab into an Excel file?</p>\n\n<p>Background: I wrote a Matlab tool which exports data into Excel files. These Excel files should have a specific macro included which is dependend on the containing data.</p>\n\n<p>Well there is an ugly workaround: I can create Excel templates with the specific macro already included. Then the respective template is copied and filled with the export data. But maybe there is a better and more flexible solution to this problem...</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1515595816, "post_id": 48189972, "comment_id": 83360021, "body": "<code>=ROUND(I3,4)&lt;&gt;ROUND(F3,4)</code> for example. 2nd argument is digit precision."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9168627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d9e05db2564d06182dd81f0af12194?s=128&d=identicon&r=PG&f=1", "display_name": "mikerosd", "link": "https://stackoverflow.com/users/9168627/mikerosd"}, "edited": false, "score": 0, "creation_date": 1515596774, "post_id": 48190015, "comment_id": 83360682, "body": "It did not work. for example for values: 456 and 381"}, {"owner": {"reputation": 25, "user_id": 9168627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d9e05db2564d06182dd81f0af12194?s=128&d=identicon&r=PG&f=1", "display_name": "mikerosd", "link": "https://stackoverflow.com/users/9168627/mikerosd"}, "edited": false, "score": 0, "creation_date": 1515596984, "post_id": 48190015, "comment_id": 83360812, "body": "why did you put 0,5"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 25, "user_id": 9168627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d9e05db2564d06182dd81f0af12194?s=128&d=identicon&r=PG&f=1", "display_name": "mikerosd", "link": "https://stackoverflow.com/users/9168627/mikerosd"}, "edited": false, "score": 0, "creation_date": 1515597501, "post_id": 48190015, "comment_id": 83361184, "body": "@mikerosd - All values with a difference below <code>0.5</code> will be considered equal. You may put <code>0.2</code> or anything that suits you."}, {"owner": {"reputation": 4326, "user_id": 8370633, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/gxmCt.png?s=128&g=1", "display_name": "ImaginaryHuman072889", "link": "https://stackoverflow.com/users/8370633/imaginaryhuman072889"}, "reply_to_user": {"reputation": 25, "user_id": 9168627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d9e05db2564d06182dd81f0af12194?s=128&d=identicon&r=PG&f=1", "display_name": "mikerosd", "link": "https://stackoverflow.com/users/9168627/mikerosd"}, "edited": false, "score": 1, "creation_date": 1515597589, "post_id": 48190015, "comment_id": 83361239, "body": "@mikerosd You may have to put <code>=ABS(I3-F3)&gt;0.5</code> instead of <code>=ABS(I3-F3)&gt;0,5</code> depending on which version of Excel you have."}, {"owner": {"reputation": 25, "user_id": 9168627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d9e05db2564d06182dd81f0af12194?s=128&d=identicon&r=PG&f=1", "display_name": "mikerosd", "link": "https://stackoverflow.com/users/9168627/mikerosd"}, "edited": false, "score": 0, "creation_date": 1515597718, "post_id": 48190015, "comment_id": 83361338, "body": "right, but it is not highlighting red when that difference is more, where 456 and 381 are way off"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 25, "user_id": 9168627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d9e05db2564d06182dd81f0af12194?s=128&d=identicon&r=PG&f=1", "display_name": "mikerosd", "link": "https://stackoverflow.com/users/9168627/mikerosd"}, "edited": false, "score": 0, "creation_date": 1515597995, "post_id": 48190015, "comment_id": 83361544, "body": "@mikerosd - first write the formula in Excel and see whether it evaluates to <code>TRUE</code> or <code>FALSE</code>. If it gives an error, write the formula as proposed by ImaginaryHuman072889 in the comment above."}, {"owner": {"reputation": 25, "user_id": 9168627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d9e05db2564d06182dd81f0af12194?s=128&d=identicon&r=PG&f=1", "display_name": "mikerosd", "link": "https://stackoverflow.com/users/9168627/mikerosd"}, "edited": false, "score": 0, "creation_date": 1515598161, "post_id": 48190015, "comment_id": 83361663, "body": "now I&#39;m getting true. but when I put it into excel conditional formatting, nothing happens"}, {"owner": {"reputation": 25, "user_id": 9168627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d9e05db2564d06182dd81f0af12194?s=128&d=identicon&r=PG&f=1", "display_name": "mikerosd", "link": "https://stackoverflow.com/users/9168627/mikerosd"}, "edited": false, "score": 0, "creation_date": 1515598247, "post_id": 48190015, "comment_id": 83361733, "body": "also I can&#39;t put 0,5 into regular formula, only conditional formatting works with it"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 25, "user_id": 9168627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d9e05db2564d06182dd81f0af12194?s=128&d=identicon&r=PG&f=1", "display_name": "mikerosd", "link": "https://stackoverflow.com/users/9168627/mikerosd"}, "edited": false, "score": 0, "creation_date": 1515598651, "post_id": 48190015, "comment_id": 83362015, "body": "@mikerosd - so your two comments are exactly the opposite. In general, try to write <code>0.5</code>, as far as you are probably using English/American language settings."}, {"owner": {"reputation": 25, "user_id": 9168627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d9e05db2564d06182dd81f0af12194?s=128&d=identicon&r=PG&f=1", "display_name": "mikerosd", "link": "https://stackoverflow.com/users/9168627/mikerosd"}, "edited": false, "score": 0, "creation_date": 1515603040, "post_id": 48190015, "comment_id": 83365057, "body": "When I want to copy formula for multiple entries, I use applies to: =<code>$I$3:$K$449</code>. is that correct"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1515598676, "last_edit_date": 1515598676, "creation_date": 1515595833, "answer_id": 48190015, "question_id": 48189972, "link": "https://stackoverflow.com/questions/48189972/excel-conditional-formatting-and-rounding-issues/48190015#48190015", "title": "Excel Conditional Formatting and Rounding Issues", "body": "<p>You should consider the absolute difference between the two numbers. If it is in a given range, which is acceptable, you may consider them equal. Thus, this is the formula that you need:</p>\n\n<pre><code>=ABS(I3-F3)&gt;0,5 '0.5 if you are using \".\" as a decimal separator\n</code></pre>\n\n<p>It will consider 233.4 and 233.6 as similar values. <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/abs-function\" rel=\"nofollow noreferrer\">MSDN ABS</a></p>\n\n<hr>\n\n<p>In general, if you write <code>=ABS(I3-F3)&gt;0,5</code> in Excel it should evaluate to <code>TRUE</code> or <code>FALSE</code>. If it does not, probably the comma is the problem, thus change the comma with a dot - <code>.</code>.</p>\n"}], "owner": {"reputation": 25, "user_id": 9168627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d9e05db2564d06182dd81f0af12194?s=128&d=identicon&r=PG&f=1", "display_name": "mikerosd", "link": "https://stackoverflow.com/users/9168627/mikerosd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1622, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1515598676, "creation_date": 1515595723, "last_edit_date": 1531161705, "question_id": 48189972, "link": "https://stackoverflow.com/questions/48189972/excel-conditional-formatting-and-rounding-issues", "title": "Excel Conditional Formatting and Rounding Issues", "body": "<p>I am trying to find a way to use excel formatting to show the color red when a specific cell is not equal to another cell. However, there are times when the value is off by two or three numbers due to how excel rounds(ex: 593=594, 593=592).Is there a way to use excel formatting or any other way to make it so if the value of the cell is very close to the targeted cell, it will not result in the cell being formatted to red. Anyway this the simple formula I am working with along with example:</p>\n\n<pre><code>=I3&lt;&gt;F3\nEX:\n\n**I**    **F**\n593       594\n</code></pre>\n\n<p>Essentially the F cell will be highlighted in red but because the difference is negligible,\n     I don't want to highlight red. At most, I would like to have a difference of more than 3, where the cell won't highlight red.  </p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1515746221, "post_id": 48217824, "comment_id": 83425987, "body": "Thanks for your contribution. I know about Rubberduck and am actually using it (although maybe less than I should). I do not quite understand your train of thought here: In what way do you envision RD to help me get those OptionNames? Or did you think more along the lines of RD being able to export settings? As far as I know, it doesn&#39;t currently support anything like that. (But I may be missing something.)"}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1515746665, "post_id": 48217824, "comment_id": 83426237, "body": "I&#39;m not sure I made sufficiently clear in my question that the decomposition and recomposition of my DB (including tables, queries, forms, modules, relations) is already working (seemingly) flawlessly. The only thing missing is the transfer of DB-specific settings (which in my case are required for the DB to function correctly). Do you think I should add that information to the question to make it more clear?"}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "reply_to_user": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 1, "creation_date": 1515790560, "post_id": 48217824, "comment_id": 83450284, "body": "A quick web search didn&#39;t reveal any more information on Access GetOptions other than the link you provided. You probably will have to code them yourself in your solution. I mentioned RubberDuck simply because it seems like a promising project that could do this in the future, but it doesn&#39;t do it now."}], "tags": [], "owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "is_accepted": false, "score": 0, "last_activity_date": 1515716361, "creation_date": 1515716361, "answer_id": 48217824, "question_id": 48189687, "link": "https://stackoverflow.com/questions/48189687/how-to-backup-export-my-current-databases-settings/48217824#48217824", "title": "How to backup/export my current database&#39;s settings?", "body": "<p>This is not a trivial problem. It's not particularly difficult technically, but there is a lot of work involved in making this work right. The scripts you reference are a starting point.</p>\n\n<p>It's not the comprehensive solution you are seeking (yet), but look at <a href=\"http://rubberduckvba.com/\" rel=\"nofollow noreferrer\" title=\"Rubberduck\">Rubberduck</a></p>\n"}], "owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1515716361, "creation_date": 1515594750, "question_id": 48189687, "link": "https://stackoverflow.com/questions/48189687/how-to-backup-export-my-current-databases-settings", "title": "How to backup/export my current database&#39;s settings?", "body": "<p>I want to be able to put all of my database's settings, table layouts, queries forms - in short: everything that is relevant for its structure and behavior - into text files. This is of course to enable me to then track changes via SVN.</p>\n\n<p><a href=\"https://stackoverflow.com/a/35501159/7778672\">This answer</a> offers a great base in that the scripts export/import all database objects as well as relations. I've added support for references, so the reference to my VBA-library DB doesn't get lost on reassembling the DB from text files.</p>\n\n<p>Now to correctly reproduce the DB's behavior, I need to somehow carry over its settings (File - Options - Current Database) as well. There is <a href=\"https://msdn.microsoft.com/en-us/VBA/access-vba/articles/set-options-from-visual-basic\" rel=\"nofollow noreferrer\">this article in the MSDN</a> that lists <em>some</em> of the arguments available to <code>Application.GetOption(OptionName as String)</code>. But this list doesn't seem to be exhaustive with respect to the options available in MS Access 2013. (And I'd like to avoid having to hardcode every option's name...)</p>\n\n<p><strong>Is there a list of <code>OptionNames</code> for use with <code>Application.GetOption</code> available via VBA? Or is there another way to export or backup options? Is there a definitive list of all options' names?</strong></p>\n\n<hr>\n\n<h3>Notes</h3>\n\n<ul>\n<li>I'd prefer to somehow obtain a list of available options at runtime, so I can setup the procedure once and forget about it.</li>\n<li>If that's not possible, I'd likely resort to hardcoding the <code>OptionNames</code> I deem relevant. It's just neither elegant nor maintenance-free...</li>\n<li>The first link's accepted answer advises to check in the stripped-down database stub as well to preserve settings. This would be my last resort, as versioning binary files is - in my opinion - ugly and impractical at best.</li>\n</ul>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1515593803, "post_id": 48189287, "comment_id": 83358578, "body": "Welcome to SO, I could not find a clear question, can you modify your post and define a question to   solve? Please read&gt; <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a>"}, {"owner": {"reputation": 3, "user_id": 9075312, "user_type": "registered", "profile_image": "https://graph.facebook.com/1765438596814199/picture?type=large", "display_name": "Ashutosh Patel", "link": "https://stackoverflow.com/users/9075312/ashutosh-patel"}, "edited": false, "score": 0, "creation_date": 1515594510, "post_id": 48189287, "comment_id": 83359078, "body": "What i want is: 1) Ask user to select an excel file. 2) copy data from a required column. 3) Ask user to select another excel file where he want to save it. 4) And paste the copied data from first excel"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515612863, "post_id": 48189287, "comment_id": 83370318, "body": "FWIW - Your code works for me.  Are you sure you had data in cells B1:B6 of the first file you opened?"}], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 8715744, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/450e92c8b232664f04994a34ef97b1a3?s=128&d=identicon&r=PG&f=1", "display_name": "JayyM", "link": "https://stackoverflow.com/users/8715744/jayym"}, "edited": false, "score": 0, "creation_date": 1515594568, "post_id": 48189614, "comment_id": 83359128, "body": "As far as I understood your question, I came up with this solution. If this isn&#39;t solving your query, kindly elaborate your problem briefly."}, {"owner": {"reputation": 3, "user_id": 9075312, "user_type": "registered", "profile_image": "https://graph.facebook.com/1765438596814199/picture?type=large", "display_name": "Ashutosh Patel", "link": "https://stackoverflow.com/users/9075312/ashutosh-patel"}, "edited": false, "score": 0, "creation_date": 1515596047, "post_id": 48189614, "comment_id": 83360194, "body": "Thank you.The script  runs fine but only problem is data is not getting copied at all."}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1515596107, "post_id": 48189614, "comment_id": 83360237, "body": "It&#39;s missing a &quot; in the range A1:A6."}, {"owner": {"reputation": 3, "user_id": 9075312, "user_type": "registered", "profile_image": "https://graph.facebook.com/1765438596814199/picture?type=large", "display_name": "Ashutosh Patel", "link": "https://stackoverflow.com/users/9075312/ashutosh-patel"}, "edited": false, "score": 0, "creation_date": 1515596326, "post_id": 48189614, "comment_id": 83360382, "body": "Yaa, i corrected it and after that only ran the script, but the data was not getting copied."}, {"owner": {"reputation": 3, "user_id": 9075312, "user_type": "registered", "profile_image": "https://graph.facebook.com/1765438596814199/picture?type=large", "display_name": "Ashutosh Patel", "link": "https://stackoverflow.com/users/9075312/ashutosh-patel"}, "edited": false, "score": 0, "creation_date": 1515596756, "post_id": 48189614, "comment_id": 83360667, "body": "Hi both, thank you for the help, the code works fine. (I did some cosmetic mistake in my  code)"}], "tags": [], "owner": {"reputation": 159, "user_id": 8715744, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/450e92c8b232664f04994a34ef97b1a3?s=128&d=identicon&r=PG&f=1", "display_name": "JayyM", "link": "https://stackoverflow.com/users/8715744/jayym"}, "is_accepted": true, "score": -1, "last_activity_date": 1515596744, "last_edit_date": 1515596744, "creation_date": 1515594491, "answer_id": 48189614, "question_id": 48189287, "link": "https://stackoverflow.com/questions/48189287/interactive-copy-paste-from-one-excel-to-another/48189614#48189614", "title": "Interactive copy paste from one excel to another", "body": "<pre><code>Sub foo3()\n\nDim x as Workbook\nDim y as Workbook\nDim xName as String\nDim yName as String\n\nxName = Application.GetOpenFileName()\nyName = Application.GetOpenFileName()\n\nSet x = Workbooks.Open(xName)\nSet y = Workbooks.Open(yName)\n\ny.Sheets(\"sheetname\").Range(\"A1:A6\").Value = x.Sheets(\"sheetname\").Range(\"B1:B6\").Value\n\nx.Close\n\nEnd Sub\n</code></pre>\n\n<p>I hope this works.</p>\n\n<p>Else, try this one:</p>\n\n<pre><code>Sub foo3()\n\nDim x as Workbook\nDim y as Workbook\nDim xName as String\nDim yName as String\n\nxName = Application.GetOpenFileName()\nyName = Application.GetOpenFileName()\n\nSet x = Workbooks.Open(xName)\nSet y = Workbooks.Open(yName)\n\nx.Sheets(\"sheetname\").Range(\"B1:B6\").Cells.Copy y.Sheets(\"sheetname\").Range(\"A1:A6\").Cells.PasteSpecial xlPasteAll\n\nx.Close\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9075312, "user_type": "registered", "profile_image": "https://graph.facebook.com/1765438596814199/picture?type=large", "display_name": "Ashutosh Patel", "link": "https://stackoverflow.com/users/9075312/ashutosh-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 48189614, "answer_count": 1, "score": -2, "last_activity_date": 1515596744, "creation_date": 1515593463, "last_edit_date": 1515594792, "question_id": 48189287, "link": "https://stackoverflow.com/questions/48189287/interactive-copy-paste-from-one-excel-to-another", "title": "Interactive copy paste from one excel to another", "body": "<p>I am using the below code to copy paste the content from one excel to another . However no data is being copied. \nPlease help.</p>\n\n<pre><code>Sub foo3()\nDim x As Workbook\nDim y As Workbook\nDim vals As Variant\n\npath1 = Application.GetOpenFilename()\npath2 = Application.GetSaveAsFilename()\n\n'## Open both workbooks first:\nSet x = Workbooks.Open(path1)\nSet y = Workbooks.Open(path2)\n\n'Store the value in a variable:\nvals = x.Sheets(\"sheetname\").Range(\"B1:B6\").Value\n\n'Use the variable to assign a value to the other file/sheet:\ny.Sheets(\"sheetname\").Range(\"A1:A6\").Value = vals\n\n'Close x:\nx.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 1, "creation_date": 1515593140, "post_id": 48189158, "comment_id": 83358186, "body": "it&#39;s name not names"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 1, "creation_date": 1515593294, "post_id": 48189158, "comment_id": 83358274, "body": "@HarassedDad You may want to post that as the answer. Thats almost certainly the souce of the issue."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 2, "creation_date": 1515593473, "post_id": 48189158, "comment_id": 83358370, "body": "Also worth noting that Exists_Counter will never be <code>&gt;1</code> since worksheets <b>must</b> have a unique name, and you aren&#39;t looping through workbooks (you&#39;re using an implicit call to <code>ActiveWorkbook</code>. Additionally, your <code>Next I</code> probably should be <code>Next i</code>. Finally, I strongly recommend not using underscores (<code>_</code>) in naming as these have special meaning to the interpreter. They are used for events, and interface implementation. Use <code>CamelCase</code> or <code>pascalCase</code> instead."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1515594553, "post_id": 48189158, "comment_id": 83359114, "body": "And the reason you are getting the <code>Argument not optional</code> error is because <code>Names</code> is a valid member of the <code>Worksheets</code> object. VBA is expecting arguments against the <code>Names</code> member though :)"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1515594606, "post_id": 48189158, "comment_id": 83359164, "body": "And there are lot of sources with better code for this task, i.e. <a href=\"http://codevba.com/excel/sheet_exists.htm#.WlYjNbAiGUk\" rel=\"nofollow noreferrer\">codevba.com/excel/sheet_exists.htm#.WlYjNbAiGUk</a> or <a href=\"https://www.extendoffice.com/documents/excel/1743-excel-check-if-a-sheet-exists.html\" rel=\"nofollow noreferrer\">extendoffice.com/documents/excel/&hellip;</a>"}], "owner": {"reputation": 3, "user_id": 8836578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1380530d1dbc223fe10b9d014457d885?s=128&d=identicon&r=PG&f=1", "display_name": "O.r.A.j.C", "link": "https://stackoverflow.com/users/8836578/o-r-a-j-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 950, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515593909, "creation_date": 1515593025, "last_edit_date": 1531164843, "question_id": 48189158, "link": "https://stackoverflow.com/questions/48189158/runtime-error-449-argument-not-optional", "title": "Runtime error 449 Argument not optional", "body": "<p>Have the below code</p>\n\n<pre><code>    For i = 1 To Worksheets.Count\n        If Worksheets(i).Names = Var_Name Then\n            Exists = True\n            Exists_Counter = Exists_Counter + 1\n        End If\n    Next I\n</code></pre>\n\n<p>It keeps giving me </p>\n\n<blockquote>\n  <p>runtime error 449</p>\n</blockquote>\n\n<p>whenever I run it. I have no idea how to fix it any idea?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 267, "user_id": 7272497, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/1ROoc.jpg?s=128&g=1", "display_name": "mgri", "link": "https://stackoverflow.com/users/7272497/mgri"}, "edited": false, "score": 0, "creation_date": 1515595254, "post_id": 48189173, "comment_id": 83359644, "body": "Thanks for your interest. Does the first part of your answer suppose that I already know the specific parameters I want to copy? In this case, it would be difficult to apply since I don&#39;t know how many parameters are set in the starting column (since it is not created by me)."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 267, "user_id": 7272497, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/1ROoc.jpg?s=128&g=1", "display_name": "mgri", "link": "https://stackoverflow.com/users/7272497/mgri"}, "edited": false, "score": 0, "creation_date": 1515595470, "post_id": 48189173, "comment_id": 83359779, "body": "@mgri - the parameters of a column (which is a Range object) are not that many. And the ones that you are easily visible are about 3-4. Probably the best case scenario is to loop through the cells, remember each NumberFormat in a array. Then copying the formats and looping once again, assigning to the correct format. A bit more code + a bit slower probably, but a secure solution."}, {"owner": {"reputation": 267, "user_id": 7272497, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/1ROoc.jpg?s=128&g=1", "display_name": "mgri", "link": "https://stackoverflow.com/users/7272497/mgri"}, "edited": false, "score": 0, "creation_date": 1515595827, "post_id": 48189173, "comment_id": 83360026, "body": "I am not a skilled VBA user, I will try to do more researches on the issue and will report the results if I get some news. Btw, I don&#39;t know how many style parameters are customized in the starting column, but I am sure they are the same for all the cells in that columns. +1 in the meanwhile for the tip."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1515594711, "last_edit_date": 1515594711, "creation_date": 1515593081, "answer_id": 48189173, "question_id": 48189050, "link": "https://stackoverflow.com/questions/48189050/maintaining-destination-data-format-when-copying-style-in-vba/48189173#48189173", "title": "Maintaining destination data format when copying style in VBA?", "body": "<p>You may try to take only the values of the specific parameters, which you are interested in (E.g., style, Interior Color, Font Color etc.)</p>\n\n<p>The following works only when the whole column has the same format, as far as I did not to loop through every cell:</p>\n\n<pre><code>Option Explicit\n\nSub TestMe()\n\n    Dim colFrom     As Long\n    Dim colTo       As Long\n\n    colFrom = 1\n    colTo = 5\n    CopyFullFontAndInterior colFrom, colTo\n\nEnd Sub\n\nSub CopyFullFontAndInterior(colFrom As Long, colTo As Long, Optional wsN As Long = 1)\n\n    Dim copyFrom    As Range\n    Dim copyTo      As Range\n\n    With Worksheets(1)\n        Set copyFrom = .Range(.Cells(1, colFrom), .Cells(2 ^ 20, colFrom))\n        Set copyTo = .Range(.Cells(1, colTo), .Cells(2 ^ 20, colTo))\n    End With\n\n    copyTo.Style = copyFrom.Style\n    If copyFrom.Interior.Color &gt; 0 Then copyTo.Interior.Color = copyFrom.Interior.Color\n    If copyFrom.Font.Color &gt; 0 Then copyTo.Font.Color = copyFrom.Font.Color\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>A possible workaround is to save the format of a given cell of the column in a variable and to use it after the <code>.PasteSpecial</code>:</p>\n\n<pre><code>Sub TestMe()\n\n    Dim saveOurFormat As String\n\n    saveOurFormat = Columns(5).Cells(2).NumberFormat\n    Columns(\"A\").Copy\n    Columns(5).PasteSpecial Paste:=xlPasteFormats\n    Columns(5).NumberFormat = saveOurFormat\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 267, "user_id": 7272497, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/1ROoc.jpg?s=128&g=1", "display_name": "mgri", "link": "https://stackoverflow.com/users/7272497/mgri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1515594711, "creation_date": 1515592619, "question_id": 48189050, "link": "https://stackoverflow.com/questions/48189050/maintaining-destination-data-format-when-copying-style-in-vba", "title": "Maintaining destination data format when copying style in VBA?", "body": "<p>I am trying to copy the style from a specific column (formatted as <strong>Text</strong> starting from its second row) to another column (formatted as <strong>Date</strong> starting from its second row). Both columns stores values.</p>\n\n<p>I am able to copy-and-paste the style to the destination column:</p>\n\n<pre><code>.Columns(\"A\").Copy '# \"A\" is the starting column\n.Columns(dest_col).PasteSpecial Paste:=xlPasteFormats '# dest_col is the destination column\n</code></pre>\n\n<p>but this code also formats it as a Text column, while I want to keep its original formatting (i.e. Date starting from the second row).</p>\n\n<p>Is there any option I can use to prevent this behavior?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1515592120, "post_id": 48188875, "comment_id": 83357488, "body": "Where is the code you have already tried and where is the error you are experiencing?"}, {"owner": {"reputation": 114, "user_id": 3294310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dgtaj.jpg?s=128&g=1", "display_name": "PonderingPanda", "link": "https://stackoverflow.com/users/3294310/ponderingpanda"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1515593379, "post_id": 48188875, "comment_id": 83358320, "body": "Thank you BraX for your interest. I have not tied anything yet. I have made an efficient vba code to build the lists in worksheet1 and worksheet 2 from ugly tables, but now i&#39;m stuck... If you have an idea, just let me know, and i&#39;ll try to make a code with it !"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1515593854, "post_id": 48188875, "comment_id": 83358628, "body": "Are you hiring a programmer?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1515593961, "post_id": 48188875, "comment_id": 83358708, "body": "How much are you paying us to write all the code for you without putting any effort into it yourself?"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1515594408, "post_id": 48188875, "comment_id": 83359011, "body": "To be clear @Annick what they mean is SO is not a &#39;Please write this code for me&#39; site. While you are asking for advice on where to start, generally SO is for programmers who have code written, but are having a hard time in understanding why it won&#39;t work. That said, I provided a non-VBA answer that should get you pointed in the right direction. If you <b>need</b> a VBA solution, you&#39;ll need to do your research and learn the fundamentals first."}, {"owner": {"reputation": 114, "user_id": 3294310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dgtaj.jpg?s=128&g=1", "display_name": "PonderingPanda", "link": "https://stackoverflow.com/users/3294310/ponderingpanda"}, "edited": false, "score": 0, "creation_date": 1515595635, "post_id": 48188875, "comment_id": 83359897, "body": "I&#39;m sorry if i have hurt anybody on this forum. I didn&#39;t ask anybody to write a code, i was asking for suggestions, ideas or guidelines in order to know where to start. When i said &quot;I need a VBA solution&quot; it did not mean &quot;I need someone else to provide me with a vba code&quot;, it just meant that i couln&#39;d use a buch of formulas or any manual steps, that&#39;s all. Maybe the word &quot;solution&quot; is not well chosen (English is not my native language)."}], "answers": [{"comments": [{"owner": {"reputation": 114, "user_id": 3294310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dgtaj.jpg?s=128&g=1", "display_name": "PonderingPanda", "link": "https://stackoverflow.com/users/3294310/ponderingpanda"}, "edited": false, "score": 0, "creation_date": 1515606905, "post_id": 48189552, "comment_id": 83367255, "body": "Thank you Brandon Barney for your insight. It is true that my place is not here since I am not a programmer, but I have seen many other Stack Overflow user ask novice questions, and get advice. I have to write simple VBA code for Excel or Word every now and then, so I don&#39;t do it instinctively. In this case, I was so sure I needed a result table with 4 columns, that i was somehow afraid to do a double vlookup or something like that. I didn&#39;t think of creating a UniqueID as you suggested. When you pointed that out to me, it became much easier, and now my code is done and works fine."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 114, "user_id": 3294310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dgtaj.jpg?s=128&g=1", "display_name": "PonderingPanda", "link": "https://stackoverflow.com/users/3294310/ponderingpanda"}, "edited": false, "score": 0, "creation_date": 1515607923, "post_id": 48189552, "comment_id": 83367787, "body": "@Annick I am glad it worked out, and I completely agree that this is a place for beginners. At the same time though, that comes with some caution. Its easy to give you the tools you need to be dangerous. Its difficult to give you the tools you need to be successful as a programmer (at least within the scope of an answer). I highly recommend developing your formula skills <b>as much as possible</b> before tackling VBA, if not purely because, without doing so, <i>everything</i> will be a VBA problem. I am <b>still</b> digging myself out of that hole, and I generally consider myself decent at VBA."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 114, "user_id": 3294310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dgtaj.jpg?s=128&g=1", "display_name": "PonderingPanda", "link": "https://stackoverflow.com/users/3294310/ponderingpanda"}, "edited": false, "score": 0, "creation_date": 1515607976, "post_id": 48189552, "comment_id": 83367814, "body": "So nowadays I am far more likely to look at reasonable formula solutions first, before looking at VBA, despite how easy it <i>can</i> be to use VBA to solve a problem, it doesnt mean we always should. Best of luck in your development though. Learning Vlookups was a game changer for me :)."}, {"owner": {"reputation": 114, "user_id": 3294310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dgtaj.jpg?s=128&g=1", "display_name": "PonderingPanda", "link": "https://stackoverflow.com/users/3294310/ponderingpanda"}, "edited": false, "score": 0, "creation_date": 1515608643, "post_id": 48189552, "comment_id": 83368186, "body": "Yes, Vlookup is a powerful formula. I knew i could use it in this case, but I needed to automate this task as much as possible, since I am expected to process similar workbooks regularly, 5 or 6 at a time. Thank you again for your time, Brandon."}], "tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": true, "score": 1, "last_activity_date": 1515594299, "creation_date": 1515594299, "answer_id": 48189552, "question_id": 48188875, "link": "https://stackoverflow.com/questions/48188875/merge-two-excel-tables-using-vba/48189552#48189552", "title": "Merge two Excel tables (using VBA)", "body": "<p>While this could be solved with VBA, you're likely to be better off using formulas (unless you must do this very frequently). The VBA solution will require some know-how, and even more if you want to be able to maintain the solution.</p>\n\n<p>An Excel formula would be quite simple. First, create a <code>UniqueID</code> column:</p>\n\n<pre><code>UniqueID        From     To     Value\nItaly_Japan     Italy    Japan  1000  \nFrance_Japan    France   Japan  500   \nCanada_Japan    Canada   Japan  0     \nFrance_Italy    France   Italy  700\nCanada_France   Canada   France     \n</code></pre>\n\n<p>You would do the same thing for both tables. Next, get all of the unique <code>UniqueID</code>'s. For this, you could use <code>Data</code> > <code>Remove Duplicates</code>, just be sure to make a copy before removing duplicates, otherwise you are removing records from your source. Put this list of UniqueID's into a new <code>Table</code>. Keep in mind that all of this will be easier if all of your data is in <code>Table</code> format (you'll see a <code>Table</code> tab in the ribbon when inside of the table range.</p>\n\n<p>If you need to format your data as a table, go to the worksheet, press <code>CTRL+HOME</code> (this goes to the very first cell). If your first cell is in another location, just navigate there instead. If your table is the only data on the worksheet, try using <code>CTRL+SHIFT+END</code> from here to highlight to the last used cell. Otherwise, a combination of <code>CTRL+SHIFT+RIGHT</code> and <code>CTRL+SHIFT+DOWN</code> will get you what you need. Finally, <strong>name your table</strong> for the love of all that is excel, this one simple habit saves a ton of time. For my example I will assume that you have a <code>Primary</code> and <code>Secondary</code> table.</p>\n\n<p>Our formula in our combined table would then look something like this:</p>\n\n<p><code>=IfError(Vlookup([UniqueID], Primary, Column(Primary[Value]), False), \"\")</code></p>\n\n<p>Or, if your <code>Primary</code> table doesn't start in the first column, use this:</p>\n\n<p><code>=IfError(Vlookup([UniqueID], Primary, 4, False), \"\")</code></p>\n\n<p>The difference here is that the former will change the index as the column is moved, the latter will not, and must be edited if the table is edited.</p>\n\n<p>Do the same thing in your next column for the other table:</p>\n\n<p><code>=IfError(Vlookup([UniqueID], Secondary, Column(Primary[Value]), False), \"\")</code></p>\n\n<p><code>=IfError(Vlookup([UniqueID], Secondary, 4, False), \"\")</code></p>\n\n<p>This will 'merge' the two sets based on the shared <code>UniqueID</code> and will leave blanks if the record doesn't exist. Learning how to do this <em>may</em> be less convenient than the learning how to do it in VBA, but I would strongly dissuade you from trying to learn VBA if you can't use an implementation like this.</p>\n\n<p>To be clear, the reason why the formula approach is ideal in this instance is that the task you are asking for help with is <strong>very</strong> simple, and you would be better developing your Excel skills since, doing so, will allow you to solve similar tasks <strong>much faster</strong> in the future. Even a novice could implement this solution within 15 minutes or so, where it would easily take you days to learn a scalable VBA solution.</p>\n"}], "owner": {"reputation": 114, "user_id": 3294310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dgtaj.jpg?s=128&g=1", "display_name": "PonderingPanda", "link": "https://stackoverflow.com/users/3294310/ponderingpanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4065, "favorite_count": 0, "accepted_answer_id": 48189552, "answer_count": 1, "score": -1, "last_activity_date": 1515608184, "creation_date": 1515592082, "last_edit_date": 1515608184, "question_id": 48188875, "link": "https://stackoverflow.com/questions/48188875/merge-two-excel-tables-using-vba", "title": "Merge two Excel tables (using VBA)", "body": "<p>I have been trying to figure out how to merge two tables from the same workbook into a third one using VBA. Example :</p>\n\n<p>Worksheet1:</p>\n\n<pre><code>From     To     Value\nItaly    Japan  1000\nFrance   Japan  500\nCanada   Japan  0\nFrance   Italy  700\n</code></pre>\n\n<p>Worksheet2:</p>\n\n<pre><code>From     To     Value\nItaly    Japan  5555\nFrance   Japan  1111\nCanada   Japan  777\nCanada   France 333\n</code></pre>\n\n<p>Disired output (worksheet3):</p>\n\n<pre><code>From     To     Value1  Value2\nItaly    Japan  1000    5555\nFrance   Japan  500     1111\nCanada   Japan  0       777\nFrance   Italy  700\nCanada   France         333\n</code></pre>\n\n<p>I would need a VBA solution since the original tables are about 400 rows long, and I would need to perform the same operation for several workbooks. I would be very grateful for any suggestion regarding this problem !</p>\n\n<h2>Edit:</h2>\n\n<p>In case it is of interest to anyone, I managed to make a working code. Worksheet1 was a nickname for \"List Import\" and Worksheet2 is \"List Export\". In both sheets, I inserted a column (C) that states both countries. I used that new column and the values to build the table in Worksheet3 (now \"Combolist\").</p>\n\n<pre><code>Sub combolist()\n    Dim lastRowImp As Long, lastRowExp As Long, startPaste As Long, endPaste As Long\n    Dim ws As Worksheet, Lookup_Range As Range, i As Integer\n    Dim lastRow As Long\n\n    lastRowImp = Sheets(\"List Import\").Cells(Rows.Count, 1).End(xlUp).Row\n    lastRowExp = Sheets(\"List Export\").Cells(Rows.Count, 1).End(xlUp).Row\n    startPaste = lastRowImp + 1\n    endPaste = lastRowImp + lastRowExp - 1\n\n    'add a new sheet and headers\n    Worksheets.Add(After:=Worksheets(Worksheets.Count)).Name = \"Combolist\"\n    Sheets(\"Combolist\").Range(\"B1\") = \"Import\"\n    Sheets(\"Combolist\").Range(\"C1\") = \"Export\"\n    Sheets(\"Combolist\").Range(\"C1\").EntireRow.Font.Bold = True\n\n    'copy flows from import and export list\n    Sheets(\"Combolist\").Range(\"A1:A\" &amp; lastRowImp) = Sheets(\"List Import\").Range(\"C1:C\" &amp; lastRowImp).Value\n    Sheets(\"Combolist\").Range(\"A\" &amp; startPaste &amp; \":A\" &amp; endPaste) = Sheets(\"List Export\").Range(\"C2:C\" &amp; lastRowExp).Value\n\n    'remove duplicates\n    lastRow = Sheets(\"Combolist\").Cells(Rows.Count, 1).End(xlUp).Row\n    Sheets(\"Combolist\").Range(Cells(1, 1), Cells(lastRow, 1)).RemoveDuplicates Columns:=Array(1), Header:=xlYes\n\n    Set ws = ActiveWorkbook.Sheets(\"Combolist\")\n    lastRow = Sheets(\"Combolist\").Cells(Rows.Count, 1).End(xlUp).Row\n\n    'populate Import values\n    Set Lookup_Range = Sheets(\"List Import\").Range(\"C1:D\" &amp; lastRowImp)\n\n    With ws\n        For i = 2 To lastRow\n            On Error Resume Next\n                If Application.WorksheetFunction.VLookup(ws.Cells(i, 1), Lookup_Range, 2, False) = \"\" Then\n                ws.Cells(i, 2) = 0\n                Else\n                ws.Cells(i, 2) = Application.WorksheetFunction.VLookup(ws.Cells(i, 1), Lookup_Range, 2, False)\n                End If\n        Next i\n    End With\n\n    'populate Export values\n    Set Lookup_Range = Sheets(\"List Export\").Range(\"C1:D\" &amp; lastRowExp)\n\n    With ws\n        For i = 2 To lastRow\n            On Error Resume Next\n                If Application.WorksheetFunction.VLookup(ws.Cells(i, 1), Lookup_Range, 2, False) = \"\" Then\n                ws.Cells(i, 3) = 0\n                Else\n                ws.Cells(i, 3) = Application.WorksheetFunction.VLookup(ws.Cells(i, 1), Lookup_Range, 2, False)\n                End If\n        Next i\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 181, "user_id": 7494999, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a63802a30fa3b20a36b1843de6adb821?s=128&d=identicon&r=PG&f=1", "display_name": "DL1", "link": "https://stackoverflow.com/users/7494999/dl1"}, "edited": false, "score": 0, "creation_date": 1515592637, "post_id": 48188811, "comment_id": 83357863, "body": "Thank u Alex P for the edited version! Sloopy of me. How did u do to add the nicer looking tables?"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1515596094, "post_id": 48188811, "comment_id": 83360224, "body": "I normally use this site: <a href=\"https://ozh.github.io/ascii-tables/\" rel=\"nofollow noreferrer\">https://ozh.github.io/ascii-tables/</a>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1515596109, "post_id": 48188811, "comment_id": 83360238, "body": "From your example it looks as if all the headers match. I think you could do this with Index and Match formulae rather than VBA."}, {"owner": {"reputation": 181, "user_id": 7494999, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a63802a30fa3b20a36b1843de6adb821?s=128&d=identicon&r=PG&f=1", "display_name": "DL1", "link": "https://stackoverflow.com/users/7494999/dl1"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1515656564, "post_id": 48188811, "comment_id": 83384898, "body": "This did the trick! Thank you @SJR"}], "owner": {"reputation": 181, "user_id": 7494999, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a63802a30fa3b20a36b1843de6adb821?s=128&d=identicon&r=PG&f=1", "display_name": "DL1", "link": "https://stackoverflow.com/users/7494999/dl1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515595681, "creation_date": 1515591861, "last_edit_date": 1515595681, "question_id": 48188811, "link": "https://stackoverflow.com/questions/48188811/vba-find-matching-headername-and-rowname-in-separate-sheets", "title": "VBA find matching headername and rowname in separate sheets", "body": "<p>It's been a while since my last VBA explorations and I have googled around for a couple of hours now without any specific luck I am afraid.  </p>\n\n<p>I have 2 sheets. </p>\n\n<p><strong>TargetSheet</strong></p>\n\n<pre><code>      2008 | 2009 | 2010 | 2011 | 2012 | 2013 | 2014 ...  \nRowX  \nRowY\n</code></pre>\n\n<p><strong>Data</strong></p>\n\n<pre><code>      2008 | 2009 | 2010 | 2011 | 2012 | 2013 | 2014 ...           \nRowX\nRowY                        \n</code></pre>\n\n<p>I am looking for a way to first search for matching <code>HeaderName</code> between <code>TargetSheet</code> and <code>Data</code>, <code>2008</code> etc and then matching Row Names, <code>RowX</code> etc. </p>\n\n<p>When I find a matching header name and row name I want to print the value that is found in <code>Data</code> to <code>TargetSheet</code>. </p>\n\n<p>I have not gotten very far unfortunately but what I have found and started editing is this below. I can find my values in sheet <code>Data</code> but the rest I don't really know how to sort out. Maybe some of you can help point me in the right direction? My code is pretty much crap at the moment.  </p>\n\n<pre><code>Sub match()\n    Application.ScreenUpdating = False\n\n    With Worksheets(\"Data\")\n        lastxvar = .Range(\"C1\").End(xlToRight).Column\n\n        For i = 3 To lastxvar\n            Debug.Print lastxvar\n\n            x = .Cells(1, i).value\n            Debug.Print x\n\n            findcol = 0\n\n            On Error Resume Next\n            '(LastxVar2) Tried Specifing what range i want to look for value X in (Dosnt seem to work).\n            LastxVar2 = TargetSheet.Range(\"B1\").End(xlToRight).Column\n\n            findcol = Application.match(x, Worksheets(\"\u00b4TargetSheet\").LastxVar2)\n            findcol2 = Application.match(x, Worksheets(\"Data\").x, 0)\n            Debug.Print findcol\n            On Error GoTo 0\n\n            If Not IsError(findcol) Then\n                ' If value X is found in Range LastxVar2 then print Value in coresponding row match to TargetSheet\n                .Cells(1, i).Copy Worksheets(\"Data\").Cells(2, findcol)\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>Any help is greatly appreciated. </p>\n"}, {"tags": ["xml", "vba", "import"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1515591479, "post_id": 48188617, "comment_id": 83357080, "body": "I want to help but the document is just a fragment, ConnectiveDevice does not appear in document"}, {"owner": {"reputation": 35, "user_id": 8790130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N5ewL.jpg?s=128&g=1", "display_name": "aliciavika", "link": "https://stackoverflow.com/users/8790130/aliciavika"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1515592494, "post_id": 48188617, "comment_id": 83357763, "body": "I want take only PartNumber=&quot;DTRxxxxxxxxxxx&quot;, how ?"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1515592570, "post_id": 48188617, "comment_id": 83357813, "body": "Use <code>[@PartNumber=&#39;DTRxxxxxxxxxxx&#39;]</code> at the end of the XPath."}], "answers": [{"tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 0, "last_activity_date": 1515592488, "creation_date": 1515592488, "answer_id": 48189008, "question_id": 48188617, "link": "https://stackoverflow.com/questions/48188617/vba-wrong-value-from-import-xml-file/48189008#48189008", "title": "VBA Wrong value from import xml file", "body": "<p>Here you go. </p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\n    Dim xmldoc As MSXML2.DOMDocument60\n    Set xmldoc = New MSXML2.DOMDocument60\n\n    xmldoc.LoadXML \"&lt;ConnectiveDevice Tag='foo'&gt;&lt;PinList&gt;&lt;Pin Tag='bar'&gt;&lt;a&gt;&lt;b&gt;&lt;c&gt;&lt;PartNumberList&gt;\" &amp; _\n        \"&lt;PartNumber PartNumber='DTRxxxxxxxxxxx' Cost='0' Description='Test' Manual='No' Mass='0.216' MountedOnHarness='Yes' PN_Source='WH' PN_Status='OK' PN_Type='Contact' PN_Version='1' Quantity='1' UnitType='Unit' /&gt;\" &amp; _\n        \"&lt;/PartNumberList&gt;&lt;/c&gt;&lt;/b&gt;&lt;/a&gt;&lt;/Pin&gt;&lt;/PinList&gt;&lt;/ConnectiveDevice&gt;\"\n\n    Debug.Assert xmldoc.parseError.ErrorCode = 0\n\n    Dim ForDTRFromTag, ForDTRFromPinTag, y, x, myCheck, CableFrom\n    ForDTRFromTag = \"foo\"\n    ForDTRFromPinTag = \"bar\"\n\n    Dim xmlNodeListPin As MSXML2.IXMLDOMNodeList\n    'Set xmlNodeListPin = xmldoc.SelectNodes(\"//ConnectiveDevice[@Tag='\" &amp; ForDTRFromTag &amp; \"']/PinList/Pin[@Tag='\" &amp; ForDTRFromPinTag &amp; \"']/*/*/*/PartNumberList/PartNumber[@PartNumber]\")\n    Set xmlNodeListPin = xmldoc.SelectNodes(\"//ConnectiveDevice[@Tag='\" &amp; ForDTRFromTag &amp; \"']/PinList/Pin[@Tag='\" &amp; ForDTRFromPinTag &amp; \"']/*/*/*/PartNumberList/PartNumber[@PartNumber]\")\n\n\n    If xmlNodeListPin.Length = 0 Then\n        Debug.Print \"bad xpath not no nodes found!\"\n        Stop\n    Else\n        On Error Resume Next\n        Dim xmlNodePin As MSXML2.IXMLDOMNode\n        For Each xmlNodePin In xmlNodeListPin\n            'Debug.Print xmlNode.BaseName\n            Dim myAtr As MSXML2.IXMLDOMAttribute\n            For Each myAtr In xmlNodePin.Attributes\n                If myAtr.Name = \"PartNumber\" Then\n                'If myAtr.BaseName = \"Description\" Then pnv = myAtr.Text\n                    'Debug.Print myAtr.BaseName &amp; \": \" &amp; myAtr.Text\n                    'Sheets(\"WL-test1\").Cells(y, x).Value = myAtr.Text\n\n                    Debug.Print myAtr.NodeValue\n                End If\n            Next myAtr\n            x = x + 1\n            myCheck = 0\n        Next xmlNodePin\n        x = x + myCheck * (UBound(CableFrom) + 1)\n        myCheck = 1\n    End If\n\n    '*****\n    '*\n    '*   OR with a single line ...\n    '*\n    '*****\n    Dim xmlPartNumber As MSXML2.IXMLDOMAttribute\n    Set xmlPartNumber = xmldoc.SelectSingleNode(\"//ConnectiveDevice[@Tag='\" &amp; ForDTRFromTag &amp; \"']/PinList/Pin[@Tag='\" &amp; ForDTRFromPinTag &amp; \"']/*/*/*/PartNumberList/PartNumber/@PartNumber\")\n\n    Debug.Print xmlPartNumber.nodeTypedValue\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 8790130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N5ewL.jpg?s=128&g=1", "display_name": "aliciavika", "link": "https://stackoverflow.com/users/8790130/aliciavika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515592488, "creation_date": 1515591189, "last_edit_date": 1515591396, "question_id": 48188617, "link": "https://stackoverflow.com/questions/48188617/vba-wrong-value-from-import-xml-file", "title": "VBA Wrong value from import xml file", "body": "<p>From XML:</p>\n\n<pre><code>&lt;PartNumberList&gt;\n&lt;PartNumber PartNumber=\"DTRxxxxxxxxxxx\" Cost=\"0\" Description=\"Test\" Manual=\"No\" Mass=\"0.216\" MountedOnHarness=\"Yes\" PN_Source=\"WH\" PN_Status=\"OK\" PN_Type=\"Contact\" PN_Version=\"1\" Quantity=\"1\" UnitType=\"Unit\" /&gt;\n&lt;/PartNumberList&gt;\n</code></pre>\n\n<p>I want to pull it DTRxxxxxxxxxxx out into the spreadsheet but every time excel give me last atribute \"unit\"</p>\n\n<p>This is my part of code from vba:</p>\n\n<pre><code>Set xmlNodeListPin = xmldoc.SelectNodes(\"//ConnectiveDevice[@Tag='\" &amp; ForDTRFromTag &amp; \"']/PinList/Pin[@Tag='\" &amp; ForDTRFromPinTag &amp; \"']/*/*/*/PartNumberList/PartNumber[@PartNumber]\")\n        On Error Resume Next\n        For Each xmlNodePin In xmlNodeListPin\n            'Debug.Print xmlNode.BaseName\n            For Each myAtr In xmlNodePin.Attributes\n            'If myAtr.BaseName = \"Description\" Then pnv = myAtr.Text\n                'Debug.Print myAtr.BaseName &amp; \": \" &amp; myAtr.Text\n                Sheets(\"WL-test1\").Cells(y, x).Value = myAtr.Text\n            Next myAtr\n            x = x + 1\n            myCheck = 0\n        Next xmlNodePin\n        x = x + myCheck * (UBound(CableFrom) + 1)\n        myCheck = 1\n</code></pre>\n\n<p>Any ideas?</p>\n\n<p>Some code to generate the document</p>\n\n<pre><code>Sub Test()\n\n    Dim oDOC As MSXML2.DOMDocument60\n    Set oDOC = New MSXML2.DOMDocument60\n\n    oDOC.LoadXML \"&lt;PartNumberList&gt;\" &amp; _\n        \"&lt;PartNumber PartNumber='DTRxxxxxxxxxxx' Cost='0' Description='Test' Manual='No' Mass='0.216' MountedOnHarness='Yes' PN_Source='WH' PN_Status='OK' PN_Type='Contact' PN_Version='1' Quantity='1' UnitType='Unit' /&gt;\" &amp; _\n        \"&lt;/PartNumberList&gt;\"\n\n    Debug.Assert oDOC.parseError.ErrorCode = 0\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 1, "creation_date": 1515590232, "post_id": 48188285, "comment_id": 83356275, "body": "Please read&gt; <a href=\"https://meta.stackoverflow.com/questions/284236/why-is-can-someone-help-me-not-an-actual-question\">Why is \u201cCan someone help me?\u201d not an actual question?</a>"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 1, "creation_date": 1515594511, "post_id": 48188285, "comment_id": 83359080, "body": "@DavidG. Unless the question was edited between when we both read it, I have to disagree. This is a perfectly acceptable question regarding Excel (though it may be easily solved with a Google search)."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7174468, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0a7ff69830412a6f74c26722bcba7664?s=128&d=identicon&r=PG&f=1", "display_name": "crismon17", "link": "https://stackoverflow.com/users/7174468/crismon17"}, "edited": false, "score": 0, "creation_date": 1515599689, "post_id": 48188842, "comment_id": 83362794, "body": "I&#39;ve tried that as a shim, it still breaks active x controls"}], "tags": [], "owner": {"reputation": 609, "user_id": 8453036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/369b931407d4e81468045e4084aa357c?s=128&d=identicon&r=PG&f=1", "display_name": "R. Roe", "link": "https://stackoverflow.com/users/8453036/r-roe"}, "is_accepted": false, "score": 2, "last_activity_date": 1515591994, "creation_date": 1515591994, "answer_id": 48188842, "question_id": 48188285, "link": "https://stackoverflow.com/questions/48188285/excel-trust-center-breaking-documents/48188842#48188842", "title": "Excel Trust Center Breaking Documents", "body": "<p>Yes, you can in <code>Trust Center Settings</code> under the <code>Trusted Locations</code> tab you can trust a location, or a single file by hitting the <code>Add new location...</code> button and adding the location to the folder or files you want to trust.</p>\n"}], "owner": {"reputation": 1, "user_id": 7174468, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0a7ff69830412a6f74c26722bcba7664?s=128&d=identicon&r=PG&f=1", "display_name": "crismon17", "link": "https://stackoverflow.com/users/7174468/crismon17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515591994, "creation_date": 1515589977, "question_id": 48188285, "link": "https://stackoverflow.com/questions/48188285/excel-trust-center-breaking-documents", "title": "Excel Trust Center Breaking Documents", "body": "<p>We have staff that use a from created by a state government office. It is full of VBA code, smaller macros, and active x controls. This document changes often and does not have a publisher certificate. When a user opens the document and allows the code to run it bugs out. (formatting is wrong on newly created sheets etc). I have contacted the document creators and they claim it's \"system corruption\" but I doubt this to be the case since this occurs on every single copy of excel 2010 we have. My fix has be to disable the trust center almost entirely. This is really not acceptance and what I would like to ask is there any way to set excel to both trust and enable documents from either a certain site or with a name containing an phrase or a name? </p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1515589876, "post_id": 48188135, "comment_id": 83356095, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10951687/how-to-search-for-string-in-an-array\">How to search for string in an array</a>"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1515590735, "post_id": 48188135, "comment_id": 83356627, "body": "Have you checked if the values are really equal? Look especially to blanks, tabs and other special chars and lower vs upper writing. Also, check the size of the Array (maybe with a <code>Debug.print</code> statement). If <code>valToBeFound</code> is in the array, it will return true."}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1515591584, "post_id": 48188135, "comment_id": 83357150, "body": "@FunThomas Yeah, I am trying to avoid that by running a trial with much less data, only 20*20, where I can see where everything goes. Still the same result for some reason. I am also checking the variable explorer, and the value is there."}], "answers": [{"comments": [{"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1515590165, "post_id": 48188275, "comment_id": 83356232, "body": "Thanks for the answer. That was the first post I came to when searching for this issue. I also tried the function proposed on the first answer of that post. Same result."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 0, "last_activity_date": 1515589939, "creation_date": 1515589939, "answer_id": 48188275, "question_id": 48188135, "link": "https://stackoverflow.com/questions/48188135/checking-if-one-string-is-in-a-row-and-using-application-vlookup-to-retrieve-co/48188275#48188275", "title": "Checking if one string is in a row, and using application.vlookup to retrieve coordinates", "body": "<p>Why don't you try the following function?</p>\n\n<pre><code>Sub Test()\n  Dim arr As Variant\n  arr = Split(\"abc,def,ghi,jkl\", \",\")\n  Debug.Print IsInArray(\"ghi\", arr)\nEnd Sub\n</code></pre>\n\n<p>Looks that your function is not working properly.\n<a href=\"https://stackoverflow.com/questions/10951687/how-to-search-for-string-in-an-array\">How to search for string in an array</a></p>\n"}, {"comments": [{"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1515591650, "post_id": 48188693, "comment_id": 83357185, "body": "Thanks for the answer. Although the trial run is done with a simplified data sample, the final run will contain lots of data, so I am aiming to use arrays when possible, and avoid selections."}, {"owner": {"reputation": 377, "user_id": 8249645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83ce2465fde8b4c0779205788997b91f?s=128&d=identicon&r=PG", "display_name": "sporc", "link": "https://stackoverflow.com/users/8249645/sporc"}, "reply_to_user": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "edited": false, "score": 0, "creation_date": 1515591879, "post_id": 48188693, "comment_id": 83357327, "body": "You also make a &quot;selection&quot; with <code>ilist = wb.Sheets(&quot;B&quot;).Range(&quot;B1:&quot; &amp; lastColLetter &amp; &quot;1&quot;)</code>, thought it would be the same. Regarding lots of data i think the solution <code>For Each element In arr</code> is slower than <code>Selection.Find</code>, but i am not sure about this"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1515592039, "post_id": 48188693, "comment_id": 83357423, "body": "@sporc The OP is specifically talking about <code>.Select</code> which is the selection he refers to.  Pointing to a range is not a &quot;selection&quot;.  See this post for more information.  It is bad practice to ever use or recommend <code>.Select</code> or <code>.Activate</code> in any Excel VBA code: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 377, "user_id": 8249645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83ce2465fde8b4c0779205788997b91f?s=128&d=identicon&r=PG", "display_name": "sporc", "link": "https://stackoverflow.com/users/8249645/sporc"}, "edited": false, "score": 0, "creation_date": 1515592761, "post_id": 48188693, "comment_id": 83357948, "body": "Okay, I wasn&#39;t aware of this. I edited the <code>.Activate</code> and <code>.Select</code>. Maybe it&#39;s better this way.."}], "tags": [], "owner": {"reputation": 377, "user_id": 8249645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83ce2465fde8b4c0779205788997b91f?s=128&d=identicon&r=PG", "display_name": "sporc", "link": "https://stackoverflow.com/users/8249645/sporc"}, "is_accepted": false, "score": -1, "last_activity_date": 1515592775, "last_edit_date": 1515592775, "creation_date": 1515591457, "answer_id": 48188693, "question_id": 48188135, "link": "https://stackoverflow.com/questions/48188135/checking-if-one-string-is-in-a-row-and-using-application-vlookup-to-retrieve-co/48188693#48188693", "title": "Checking if one string is in a row, and using application.vlookup to retrieve coordinates", "body": "<p>Instead of your \"IsInArray\" Function you could use something like this:</p>\n\n<pre><code>    '...\n\n    'If IsInArray(i_number, ilist) = True Then\n    Set cell = wb.Sheets(\"B\").Range(Cells(1, 2), Cells(lastcol, 1)).Find(What:=i_number, After:=ActiveCell, LookIn:=xlFormulas, _\n        LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n        MatchCase:=False, SearchFormat:=False)\n    If Not(cell Is Nothing) Then\n        ifinalmatch = Application.HLookup(i_number, wb.Sheets(\"A\").UsedRange, lastRow, False) 'column\n    End If\n\n    '...\n</code></pre>\n"}], "owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1515592775, "creation_date": 1515589380, "question_id": 48188135, "link": "https://stackoverflow.com/questions/48188135/checking-if-one-string-is-in-a-row-and-using-application-vlookup-to-retrieve-co", "title": "Checking if one string is in a row, and using application.vlookup to retrieve coordinates", "body": "<p><strong>Scenario:</strong> I am building a code that reads some inputs from a worksheet, find the equivalents in other two worksheets and, if the data is available, performs some operations with it.</p>\n\n<p><strong>Data:</strong></p>\n\n<pre><code>Worksheet 1 (CAs):\n\nname    ident    date       value1    value2\nC       xxx      xx/xx/xx    5000      100\nT       YYY      xx/xx/xx    1000      101\n\nand so on, there are more than 2 thousand identifiers (ident) in sheets A and B, while in sheet CAs only 10 of those appear.\n\nWorksheet 2 (A): Monthly dates\n             Ident 1     Ident 2    ...    Ident N     row number\n20/01/01      1            1                  1             2\n20/02/01      1            1                  1             3\n20/03/01      1            1                  1             4\n...\n20/12/12      1            1                  1             N-1 \ncol number    2            3                  N              N\n\nWorksheet 3 (B): Daily dates\n             Ident 1     Ident 2    ...    Ident N     row number\n01/01/01      1            1                  1             2\n02/01/01      1            1                  1             3\n03/01/01      1            1                  1             4\n...\n12/12/12      1            1                  1             N-1 \ncol number    2            3                  N              N\n</code></pre>\n\n<p><strong>What the code does:</strong> It reads sheet 1, get date and identifier, uses a lookup procedure to find the coordinates of that ident and date in the other sheets and gets the data at the intersection point.</p>\n\n<p><strong>Problem:</strong> For some reason, when I input an identifier for my IsInArray function to read, it always return False, despite it surely being in the identifiers arrays.</p>\n\n<p><strong>Question:</strong> Any ideas what I am doing wrong here?</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Sub Calculations()\n\nDim lrow As Long, i_number As String, lastRow As Long, lastCol As Long, datefinalmatch As Long, datefinalmatch2 As Long, z1 As Long, ifinalmatch As Long\nDim lastColLetter As String, a As String\nDim p_number As Variant, amount_number As Variant, aaa As Long, bbb As Long\nDim date_number As Date\nDim wb As Workbook\nDim ilist As Variant\n\nSet wb = ThisWorkbook\n\n    For lrow = 2 To wb.Sheets(\"CAs\").UsedRange.Rows.count\n\n        i_number = wb.Sheets(\"CAs\").Range(\"B\" &amp; lrow).Value\n        date_number = wb.Sheets(\"CAs\").Range(\"C\" &amp; lrow)\n        p_number = wb.Sheets(\"CAs\").Cells(lrow, 5)\n        amount_number = wb.Sheets(\"CAs\").Range(\"D\" &amp; lrow)\n\n        lastRow = wb.Sheets(\"A\").Cells(Rows.count, 2).End(xlUp).Row\n        lastCol = wb.Sheets(\"A\").Cells(2, Columns.count).End(xlToLeft).Column\n        lastColLetter = Col_Letter(lastCol)\n        ilist = wb.Sheets(\"B\").Range(\"B1:\" &amp; lastColLetter &amp; \"1\")\n\n        datefinalmatch = Application.VLookup(wb.Sheets(\"CAs\").Cells(lrow, 3), wb.Sheets(\"AMT\").UsedRange, lastCol, True) + 1 'row\n        If IsInArray(i_number, ilist) = True Then\n        ifinalmatch = Application.HLookup(i_number, wb.Sheets(\"A\").UsedRange, lastRow, False) 'column\n\n'other sheets date row finder\n        datefinalmatch2 = Application.VLookup(wb.Sheets(\"CAs\").Cells(lrow, 3), wb.Sheets(\"B\").UsedRange, lastCol, True) + 1 'row\n        End If\n    Next lrow \n\nEnd Sub\n\nPrivate Function IsInArray(valToBeFound As String, arr As Variant) As Boolean\nDim element As Variant\n    For Each element In arr\n        If element = valToBeFound Then\n            IsInArray = True\n            Exit Function\n        End If\n    Next element\nEnd Function\n\nFunction Col_Letter(lngCol As Long) As String\n    Dim vArr\n    vArr = Split(Cells(1, lngCol).Address(True, False), \"$\")\n    Col_Letter = vArr(0)\nEnd Function\n</code></pre>\n\n<p><strong>OBS:</strong> The code runs smoothly with no errors. When running it line by line, I see that the function is always returning false, and that is prompting the next row and eventually the end of the code, without it making any actual changes (with I omitted for brevity purposes)</p>\n\n<p><strong>OBS2:</strong> There are some variables that are declared but not used. They are used for the calculations in another part of the code. That is why I removed the Option Explicit from the top.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4956, "user_id": 5762332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhBOT.jpg?s=128&g=1", "display_name": "Magnetron", "link": "https://stackoverflow.com/users/5762332/magnetron"}, "edited": false, "score": 4, "creation_date": 1515588515, "post_id": 48187754, "comment_id": 83355277, "body": "Don&#39;t post code as image, post as text and format as code. Many of us can&#39;t open external links and they may break over time. Also, it&#39;s hard to try your code as it is, as text we can copy and paste to try to help you."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1515588726, "post_id": 48187754, "comment_id": 83355403, "body": "And what is your actual question? Where did you get stuck or errors? What does already work and what does not?"}, {"owner": {"reputation": 15, "user_id": 9198458, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214844597289707/picture?type=large", "display_name": "user9198458", "link": "https://stackoverflow.com/users/9198458/user9198458"}, "edited": false, "score": 0, "creation_date": 1515590343, "post_id": 48187754, "comment_id": 83356346, "body": "Sorry guys, i have made the edits, i am new to this forum so dont get how the formatting works"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9198458, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214844597289707/picture?type=large", "display_name": "user9198458", "link": "https://stackoverflow.com/users/9198458/user9198458"}, "edited": false, "score": 0, "creation_date": 1515626448, "post_id": 48190380, "comment_id": 83376440, "body": "Thanks mate! I will give it a go and let you know how it works"}, {"owner": {"reputation": 15, "user_id": 9198458, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214844597289707/picture?type=large", "display_name": "user9198458", "link": "https://stackoverflow.com/users/9198458/user9198458"}, "edited": false, "score": 0, "creation_date": 1515627550, "post_id": 48190380, "comment_id": 83376734, "body": "Hey thanks for the response, I just gave it a go and it worked well. However, is there a way to make it so that each tab is just one player and all their yearly tables are on the same sheet. For example in one sheet called &quot;Dan Butler&quot; we have his 2017 stats and 2018 stats side by side, then the macro will make a Jack Riewoldt sheet with his stats from 2007-18 in the sheet."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 15, "user_id": 9198458, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214844597289707/picture?type=large", "display_name": "user9198458", "link": "https://stackoverflow.com/users/9198458/user9198458"}, "edited": false, "score": 0, "creation_date": 1515654077, "post_id": 48190380, "comment_id": 83383752, "body": "@user9198458 this would me much more to code and is to broad to answer here. It would be possible but a completely new approach. If this answer solved your original question please consider marking it as a solution."}, {"owner": {"reputation": 15, "user_id": 9198458, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214844597289707/picture?type=large", "display_name": "user9198458", "link": "https://stackoverflow.com/users/9198458/user9198458"}, "edited": false, "score": 0, "creation_date": 1515670760, "post_id": 48190380, "comment_id": 83393310, "body": "thanks for your help, would you have any idea on how i could get started on that? Yep answered part of it defitnetly and was the most helpful here, just couldnt get it exactly the way i wanted"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1515596923, "creation_date": 1515596923, "answer_id": 48190380, "question_id": 48187754, "link": "https://stackoverflow.com/questions/48187754/how-to-make-add-queries-to-new-sheets-depending-on-the-name-on-vba-excel/48190380#48190380", "title": "How to make add queries to new sheets depending on the name? On VBA Excel", "body": "<p>The simplest way would be to use a separate procedure which adds one sheet at once and fill it with data. Then a second procedure loops through the data.</p>\n\n<p><code>AddConnection</code> adds a new sheet with the data loaded from the given parameters.</p>\n\n<p><code>GetAllUrls</code> loops through the data and calls <code>AddConnection</code>.</p>\n\n<p>You would probably need to adjust the <code>For</code> loops to your needs and data source if your data is not in <code>A1:C14</code> but I think the principle is clear.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub GetAllUrls()\n    Dim wsURL As Worksheet\n    Set wsURL = ThisWorkbook.Worksheets(\"URL\") 'here we define the urls worksheet\n\n    Dim i As Long\n    For i = 1 To 14 'we assume the data is in A1 to C14 (A=name, B=surname, C=year)\n        AddConnection wsURL.Cells(i, 1), wsURL.Cells(i, 2), wsURL.Cells(i, 3)\n    Next i\nEnd Sub\n\nPublic Sub AddConnection(Name, Surname, Year)\n    Dim ws As Worksheet\n\n    Set ws = ThisWorkbook.Worksheets.add(After:=ActiveSheet) 'add a new sheet\n    ws.Name = Left(Name &amp; \" \" &amp; Surname &amp; \" \" &amp; Year, 31) 'rename sheet (sheet names must be max 31 characters)\n\n    With ws.QueryTables.add(Connection:= _\n        \"URL;http://www.fanfooty.com.au/players/year.php?firstname=\" &amp; Name &amp; \"&amp;surname=\" &amp; Surname &amp; \"&amp;year=\" &amp; Year _\n        , Destination:=Range(\"$A$1\"))\n        .Name = Name &amp; \" \" &amp; Surname &amp; \" \" &amp; Year\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .BackgroundQuery = True\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .WebSelectionType = xlAllTables\n        .WebFormatting = xlWebFormattingNone\n        .WebPreFormattedTextToColumns = True\n        .WebConsecutiveDelimitersAsOne = True\n        .WebSingleBlockTextImport = False\n        .WebDisableDateRecognition = False\n        .WebDisableRedirections = False\n        .Refresh BackgroundQuery:=False\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9198458, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214844597289707/picture?type=large", "display_name": "user9198458", "link": "https://stackoverflow.com/users/9198458/user9198458"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 48190380, "answer_count": 1, "score": -1, "last_activity_date": 1515596923, "creation_date": 1515588173, "last_edit_date": 1515591002, "question_id": 48187754, "link": "https://stackoverflow.com/questions/48187754/how-to-make-add-queries-to-new-sheets-depending-on-the-name-on-vba-excel", "title": "How to make add queries to new sheets depending on the name? On VBA Excel", "body": "<p>I was wondering how I would go about making a macros which reads off a list of specific URL variables and makes a data query and a new sheet for a different name.</p>\n\n<p>For example in my url tab I have this:</p>\n\n<pre><code>Dan     Butler      2017\nDan     Butler      2018\nJack    Riewoldt    2007\nJack    Riewoldt    2008\nJack    Riewoldt    2009\nJack    Riewoldt    2010\nJack    Riewoldt    2011\nJack    Riewoldt    2012\nJack    Riewoldt    2013\nJack    Riewoldt    2014\nJack    Riewoldt    2015\nJack    Riewoldt    2016\nJack    Riewoldt    2017\nJack    Riewoldt    2018\n</code></pre>\n\n<p>The URL I have is this: <a href=\"http://www.fanfooty.com.au/players/year.php?firstname=Dylan&amp;surname=Grimes&amp;year=2018\" rel=\"nofollow noreferrer\">http://www.fanfooty.com.au/players/year.php?firstname=<strong>Dylan</strong>&amp;surname=<strong>Grimes</strong>&amp;year=<strong>2018</strong></a></p>\n\n<p>As you can see the only variables are the first and last name and the year.</p>\n\n<p>I want it so the macro will make a new sheet for each new name and add tables to that sheet for each year. It should only make a new sheet for each new name it encounters.</p>\n\n<p>What I currently have is this:</p>\n\n<pre><code>Sub Macro1()\nDim URL As Range\nFor Each URL In Range(\"a200:a211\").Cells\n    With ActiveSheet.QueryTables.Add(Connection:= _\n        \"URL;http://www.fanfooty.com.au/players/year.phpfirstname=Shaun&amp;surname=Grigg&amp;year=\" &amp; URL &amp; \"\" _\n        , Destination:=Range(\"$a$5\"))\n        .Name = \"Shaun Grigg\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .BackgroundQuery = True\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .WebSelectionType = xlSpecifiedTables\n        .WebTables = \"1\"\n        .WebFormatting = xlWebFormattingNone\n        .WebPreFormattedTextToColumns = True\n        .WebConsecutiveDelimitersAsOne = True\n        .WebSingleBlockTextImport = False\n        .WebDisableDateRecognition = False\n        .WebDisableRedirections = False\n        .Refresh BackgroundQuery:=False\n    End With\n\n    With ActiveSheet\n        Range(\"R:S\").EntireColumn.Insert\n    End With\nNext\nEnd sub\n</code></pre>\n\n<p>So far the only thing I could get is one sheet and getting all the tables for a player to appear, but I cannot do multiple players at once with one macro.</p>\n\n<p>And the way I get different players is to manually add a sheet and adjust the url myself.</p>\n\n<p>Thanks guys</p>\n"}, {"tags": ["ms-access", "vba", "caa"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9198090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6500ac26114e8e121cd1ecaf9ee7308c?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub Z", "link": "https://stackoverflow.com/users/9198090/jakub-z"}, "edited": false, "score": 0, "creation_date": 1515591030, "post_id": 48188032, "comment_id": 83356804, "body": "WORKS. in use looks like:         Length3.Value = Forms(&quot;Assembly_formname&quot;).Controls(&quot;BODY.A&quot;).Value"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 0, "last_activity_date": 1515589031, "creation_date": 1515589031, "answer_id": 48188032, "question_id": 48187428, "link": "https://stackoverflow.com/questions/48187428/vba-macro-for-reading-cell-values-from-linked-tables/48188032#48188032", "title": "VBA macro for reading cell values from linked tables", "body": "<p>As I understand, <code>Body.A</code> and <code>Part.A</code> are names of controls.</p>\n\n<p>While you usually can refer to controls by just stating their name, this doesn't work if they have characters that aren't allowed in a variable name like a dot or a a space.</p>\n\n<p>You can refer to them explicitly through the controls collection.</p>\n\n<pre><code>lenght3.value = Me.Controls(\"Body.A\").Value\n</code></pre>\n\n<p>I'm not familiar with CAA or CATIA, though, so I might have overlooked something obvious on that part.</p>\n"}], "owner": {"reputation": 3, "user_id": 9198090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6500ac26114e8e121cd1ecaf9ee7308c?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub Z", "link": "https://stackoverflow.com/users/9198090/jakub-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 48188032, "answer_count": 1, "score": 0, "last_activity_date": 1515589031, "creation_date": 1515586964, "last_edit_date": 1515587477, "question_id": 48187428, "link": "https://stackoverflow.com/questions/48187428/vba-macro-for-reading-cell-values-from-linked-tables", "title": "VBA macro for reading cell values from linked tables", "body": "<p>I have Access application that stores CAD model parameters and connects via VBA macros to CATIA to input that parameters values into real model (CAA Automation)</p>\n\n<p>This is how simplified relations looks:\n<a href=\"https://i.stack.imgur.com/Xxv1G.png\" rel=\"nofollow noreferrer\">Database relationships</a></p>\n\n<p>There are different forms for body, part and assembly.\nIn assembly form when there is the same name of parameter in liked tables control source is being named Body.A an Part.A, when different control source is as the name of parameter (B1, D)</p>\n\n<p>definition is made for each lenght</p>\n\n<pre><code>set lenghtX = parametersX.Item(\"CATIA parameter name\") \n'type is lenght, so program CATIA and it's method doesn't matter\n</code></pre>\n\n<p>so reading and sending values by</p>\n\n<pre><code>lenght1.value = B1\n'left side lenght in CATIA\n'ride side control source name in MS Access\n</code></pre>\n\n<p>or</p>\n\n<pre><code>lenght2.value = D\n</code></pre>\n\n<p>WORKS</p>\n\n<p>but to read from linked (by it's control source name, how it was done in code before)</p>\n\n<pre><code>lenght3.value = Body.A\n</code></pre>\n\n<p>or</p>\n\n<pre><code>lenght4.value = Part.A\n</code></pre>\n\n<p>NOT</p>\n\n<p>does anybody now how to get values from linked tables?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 4, "creation_date": 1515587027, "post_id": 48187298, "comment_id": 83354390, "body": "You should (1) <a href=\"https://stackoverflow.com/posts/48187298/edit\">edit</a> your tags and make clear if you use <code>vb.net</code> <b>OR</b> <code>vba</code> <b>OR</b> <code>vb6</code> these 3 are totally different languages and you need to decide for one of them. (2) You should show what you already tried to achieve your goal."}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 1, "creation_date": 1515637849, "post_id": 48187298, "comment_id": 83379174, "body": "Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and take the <a href=\"https://stackoverflow.com/tour\">tour</a> and do not spam tags.  Each comes with a little text indicating what each is used for."}], "answers": [{"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1515589424, "creation_date": 1515589424, "answer_id": 48188144, "question_id": 48187298, "link": "https://stackoverflow.com/questions/48187298/assigning-a-spin-button-to-view-multiple-images-using-image-control/48188144#48188144", "title": "Assigning a spin button to view multiple images using image control", "body": "<p>If you use the listbox change event, then you can use the spin button to change the listbox.</p>\n\n<pre><code> Private Sub ListBox1_Change()\n    On Error Resume Next\n    Image1.Picture = LoadPicture(\"S:\\Stairs\\Stair Pics\\\" &amp; ListBox1)\nEnd Sub\n\nPrivate Sub SpinButton1_Change()\n    ListBox1.ListIndex = SpinButton1.Value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 4073922, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vccjgv5ygXI/AAAAAAAAAAI/AAAAAAAAAJU/oMgFSUjr3jw/photo.jpg?sz=128", "display_name": "swapnil bhalerao", "link": "https://stackoverflow.com/users/4073922/swapnil-bhalerao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 264, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1515659381, "creation_date": 1515586510, "last_edit_date": 1531164843, "question_id": 48187298, "link": "https://stackoverflow.com/questions/48187298/assigning-a-spin-button-to-view-multiple-images-using-image-control", "title": "Assigning a spin button to view multiple images using image control", "body": "<p>Below is code from module, whenever I select a row of list box it shows the image with path which is available on list-box index (lisRow, X) on my image control box, I am looking for a solution where I will be able to change value x to 1,2,3 or 4 using a spin button. (image path is currently on column B for multiple images it will take cell C, D or E.. so I will be able to see multiple images on image control)</p>\n\n<pre><code>'------------------------------------------------------\nSub ListBox_Click()\nLisRow = UserForm2.ListBox2.ListIndex\nPictureName = UserForm2.ListBox2.List(LisRow, X)\n\nWith UserForm2\n  .txt_LastName.Value = .ListBox2.List(LisRow, 0)\n  .txt_FirstName.Value = .ListBox2.List(LisRow, X)\n  .Image1.Picture = LoadPicture(PictureName)\n\nEnd With\nEnd Sub\n'------------------------------------------------------\n</code></pre>\n"}, {"tags": ["vba", "excel", "scope"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1515585664, "post_id": 48186994, "comment_id": 83353520, "body": "&quot;I&#39;ve made a class with a method that&#39;s public since another class calls this method.&quot; - it would be helpful to give the code for this one."}, {"owner": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 1, "creation_date": 1515585734, "post_id": 48186994, "comment_id": 83353559, "body": "I usually like the idea of small classes, but it sounds like <code>Class1</code> and <code>Class2</code> are tightly coupled. Perhaps the methods could be moved into 1 class, then just make the &quot;semi-private&quot; methods <code>private</code>. It would improve cohesion."}, {"owner": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 0, "creation_date": 1515585790, "post_id": 48186994, "comment_id": 83353592, "body": "If moving things to 1 class is painful, you should probably leave the methods public. What harm can it cause?"}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1515589829, "post_id": 48186994, "comment_id": 83356076, "body": "The <a href=\"http://www.cpearson.com/excel/scope.aspx\" rel=\"nofollow noreferrer\">friend access modifier</a> limits accessibility to calls from within the same workbook.  Not sure if that helps here."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1515599618, "post_id": 48186994, "comment_id": 83362741, "body": "@destination-data That would only prevent other projects from using the class, and not other modules or classes from using the class."}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1515589202, "post_id": 48187814, "comment_id": 83355720, "body": "But shouldn&#39;t you in <code>SmallClass1</code> hand <code>var3</code> through to the <code>BigOne</code> like let <code>BigOne.var3 = v</code> and get <code>var3 = BigOne.var3</code>? Otherwise this makes not much sense or am I completely wrong?"}, {"owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1515589859, "post_id": 48187814, "comment_id": 83356090, "body": "You are right, just edited my answer. Anyway, my proposal is to have class that contains all properties and function and class that creates object of the first class and use some of the properties and functions."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 1, "creation_date": 1515599459, "post_id": 48187814, "comment_id": 83362634, "body": "I would avoid the word <code>Inherit</code> since VBA doesn&#39;t support <code>Inheritance</code> and your example is instead exposing members through its own methods, but not inheriting the class. The distinction being that if I add <code>Sub Foo</code> to <code>BigClass</code> I must also add <code>Sub Foo</code> to <code>SmallClass</code>."}], "tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": false, "score": 0, "last_activity_date": 1515589933, "last_edit_date": 1515589933, "creation_date": 1515588346, "answer_id": 48187814, "question_id": 48186994, "link": "https://stackoverflow.com/questions/48186994/can-i-make-methods-visible-to-some-classes-but-not-others/48187814#48187814", "title": "Can I make methods visible to some classes but not others", "body": "<p>You may create the class that contains all properties and methods, name it BigClass:</p>\n\n<pre><code>Option Explicit\n\nDim i1 As Integer\nDim i2 As Integer\nDim i3 As Integer\n\n\nProperty Let var1(v As Integer)\n    i1 = v\nEnd Property\n\nProperty Get var1() As Integer\n    var1 = i1\nEnd Property\n\nProperty Let var2(v As Integer)\n    i2 = v\nEnd Property\n\nProperty Get var2() As Integer\n    var2 = i2\nEnd Property\n\nProperty Let var3(v As Integer)\n    i3 = v\nEnd Property\n\nProperty Get var3() As Integer\n    var3 = i3\nEnd Property\n</code></pre>\n\n<p>Then you can make classes that inherits BigClass methods, but not necessary all of them. For example, SmallClass1 that will use only var3 variable. </p>\n\n<pre><code>Option Explicit\n\nDim BigOne As BigClass\n\nPrivate Sub Class_Initialize()\n    Set BigOne = New BigClass\nEnd Sub\n\nPrivate Sub Class_Terminate()\n    Set BigOne = Nothing\nEnd Sub\n\nProperty Let var3(v As Integer)\n    BigOne.var3 = v\nEnd Property\n\nProperty Get var3() As Integer\n    var3 = BigOne.var3\nEnd Property\n</code></pre>\n\n<p>Then you can create SmallClass2 that use var2 and var1 but not var3. You get the point. </p>\n"}, {"tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 0, "last_activity_date": 1515590720, "creation_date": 1515590720, "answer_id": 48188492, "question_id": 48186994, "link": "https://stackoverflow.com/questions/48186994/can-i-make-methods-visible-to-some-classes-but-not-others/48188492#48188492", "title": "Can I make methods visible to some classes but not others", "body": "<p>An clear example would be involved and lengthy and I have deposited one on my blog here <a href=\"http://exceldevelopmentplatform.blogspot.com/2018/01/vba-difference-between-friend-and.html\" rel=\"nofollow noreferrer\">VBA - Difference between Friend and Public with inter project references.</a></p>\n\n<p>Essentially you use the Friend keyword but nothing happens until you split your code across workbooks which itself brings issues such as Instancing and factory functions.  Example given should work though.  Enjoy!</p>\n"}, {"tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": false, "score": 2, "last_activity_date": 1515599332, "creation_date": 1515599332, "answer_id": 48191201, "question_id": 48186994, "link": "https://stackoverflow.com/questions/48186994/can-i-make-methods-visible-to-some-classes-but-not-others/48191201#48191201", "title": "Can I make methods visible to some classes but not others", "body": "<p>Instead of getting complicated with it, and using a roundabout approach, just use the tools meant for the job:</p>\n\n<p><strong>Class Module IFoo</strong></p>\n\n<pre><code>Public Sub Bar()\n    ' Interface methods are empty\nEnd Sub\n</code></pre>\n\n<p><strong>Class Module Foo</strong></p>\n\n<pre><code>Private Type TFoo\n    Baz As String\nEnd Type\n\nPrivate this As TFoo\n\nImplements IFoo\n\nPrivate Sub Class_Initialize()\n    this.Baz = \"I am a class that implements IFoo.\"\nEnd Sub\n\nPrivate Sub IFoo_Bar()\n    ' Do Something\n    Debug.Print this.Baz\nEnd Sub\n</code></pre>\n\n<p><strong>Module Baz</strong></p>\n\n<pre><code>Sub RunBaz()\n    Dim MyFoo As IFoo\n\n    ' Note that this WILL NOT work. Nothing happens.\n    Set MyFoo = New IFoo\n    Debug.Print MyFoo.Bar\n\n    ' Set MyFoo to be equal to a Foo (which implements IFoo)\n    Set MyFoo = New Foo\n    Debug.Print MyFoo.Baz\nEnd Sub\n</code></pre>\n\n<p>This makes the methods only visible when the methods are being accessed through an interface which makes them public. Therefore, in order to use the methods in <code>Foo</code> we must first create an instance of <code>Foo</code> using an <code>IFoo</code> variable type.</p>\n\n<p>Then, it is as simple as creating a new class which creates a <code>Foo</code> from an <code>IFoo</code> for its own use.</p>\n\n<p><strong>Class Module IImportantWorker</strong></p>\n\n<pre><code>Public Sub DoSomethingImportant()\n\nEnd Sub\n</code></pre>\n\n<p><strong>Class Module ImportantWorker</strong></p>\n\n<pre><code>Private Type TImportantWorker\n    Implementation As IFoo\nEnd Type\n\nPrivate this As TImportantWorker\n\nImplements IImportantWorker\n\nPrivate Sub Class_Initialize()\n    Set this.Implementation = New Foo\nEnd Sub\n\nPublic Sub IImportantWorker_DoSomethingImportant()\n    this.Implementation.Bar\nEnd Sub\n</code></pre>\n\n<p>You could get fancy from here and make a property of Foo that is exposed by <code>IFoo</code> that tells it whether or not it can work. This would have to be exposed through the IFoo interface (or, alternatively a separate interface so that the two interfaces must be used in conjunction).</p>\n\n<p>Without <em>locking</em> the class (which I wouldnt recommend anyways, it seems foolish and pointless) <code>Foo</code> will still allow <code>Bar</code> if it is created as a <code>IFoo</code>. But if you just make <code>Foo = New Foo</code> then <code>Foo</code> will do nothing (or rather, expose nothing).</p>\n\n<p>For additional resources, I highly recommend reading these excellent posts that go into greater depth about the processes:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/31858094/is-vba-an-oop-language-and-does-it-support-polymorphism/31861832#31861832\">Is VBA an OOP language, and does it support polymorphism?</a></p>\n\n<p><a href=\"https://rubberduckvba.wordpress.com/2016/06/16/oop-vba-pt-1-debunking-stuff/\" rel=\"nofollow noreferrer\">https://rubberduckvba.wordpress.com/2016/06/16/oop-vba-pt-1-debunking-stuff/</a></p>\n\n<p><a href=\"https://rubberduckvba.wordpress.com/2016/07/05/oop-vba-pt-2-factories-and-cheap-hotels/\" rel=\"nofollow noreferrer\">https://rubberduckvba.wordpress.com/2016/07/05/oop-vba-pt-2-factories-and-cheap-hotels/</a></p>\n"}], "owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 2, "answer_count": 3, "score": 1, "last_activity_date": 1515599332, "creation_date": 1515585514, "last_edit_date": 1531164843, "question_id": 48186994, "link": "https://stackoverflow.com/questions/48186994/can-i-make-methods-visible-to-some-classes-but-not-others", "title": "Can I make methods visible to some classes but not others", "body": "<p>Quite simple; I've made a class with a method that's public since another class calls this method.</p>\n\n<p>I would like the method only to show up on intellisense in the 2nd class which holds some special reference to the 1st one. Any other class or module should not be able to see the method.</p>\n\n<p>Something along the lines of</p>\n\n<pre><code>Semi-Private (except for Class2) Sub ...\n</code></pre>\n\n<p>in the method of Class1, or in Class2</p>\n\n<pre><code>Can See Semi-Private methods of Class1\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 1780, "user_id": 6335604, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/068ef1e6d109c41402e390f6fe3df5d2?s=128&d=identicon&r=PG", "display_name": "svgrafov", "link": "https://stackoverflow.com/users/6335604/svgrafov"}, "edited": false, "score": 1, "creation_date": 1515586427, "post_id": 48186753, "comment_id": 83354011, "body": "Stackoverflow does not write code for you. Show an attempt to solve the problem first."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1515689129, "post_id": 48186753, "comment_id": 83405324, "body": "Or, at the very least, give examples of what properties you want to access for what kinds of content controls..."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1515606953, "last_edit_date": 1515606953, "creation_date": 1515587852, "answer_id": 48187655, "question_id": 48186753, "link": "https://stackoverflow.com/questions/48186753/extracting-the-content-control-property-from-a-word-document-using-excel-vba/48187655#48187655", "title": "Extracting the Content Control property from a Word document using Excel VBA", "body": "<p>As a starter: Consider that there are a large number of <code>ContentControl Properties</code> (Word) so being more specific in your question would help and definitely showing an attempt to code it.</p>\n\n<p>The list given here <a href=\"https://msdn.microsoft.com/en-us/library/office/dn320579.aspx\" rel=\"nofollow noreferrer\">ContentControl Properties (Word)</a> outlines the different properties and gives an indication of the read write status.  I am not going to post a summary of the link, but will point out, it details what you can see in the object browser in a more legible fashion.</p>\n\n<p>This <a href=\"https://gregmaxey.com/word_tip_pages/content_controls.html\" rel=\"nofollow noreferrer\">article</a> gives general descriptions and limitations for each of the types. It is more descriptive of the actual usage of the controls and might aid you in refining your code.</p>\n\n<p><a href=\"https://i.stack.imgur.com/2Pkrl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2Pkrl.png\" alt=\"Top rows of document\"></a></p>\n\n<p>You can loop over controls as a collection. I have written this for implementation within Word; the link you gave shows you how to implement this in Excel referencing Word.</p>\n\n<pre><code>Public Sub test()\n\nDim ContentControl As ContentControl\n\nFor Each ContentControl In ThisDocument.ContentControls\n\n   Debug.Print ContentControl.Type\n\nNext ContentControl\n\nEnd Sub\n</code></pre>\n\n<p>You could write some code that after you have checked the types present (as above) then writes out the properties (where applicable) to a text file or a worksheet.</p>\n\n<p>Probably the best way to go about exploring this would be to open the object browser and read the associated information against each member of the class and write your code in the context of that.</p>\n\n<p><a href=\"https://i.stack.imgur.com/hCpUx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hCpUx.png\" alt=\"Object browser\"></a></p>\n\n<p>If you want to access the controls in the same way as the link you provided, have a look at the available <a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/wdcontentcontroltype-enumeration-word\" rel=\"nofollow noreferrer\">WdContentControlType Enumeration</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/hFS15.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hFS15.png\" alt=\"Enumerations\"></a></p>\n\n<p>Here is a simple example of retrieving an item (adapting code by @DavidZemens from your <a href=\"https://stackoverflow.com/questions/28684664/extracting-the-company-property-from-a-word-document-using-excel-vba\">link</a> and from <a href=\"https://wordmvp.com/FAQs/MacrosVBA/MixedDocProps.htm\" rel=\"nofollow noreferrer\">Astrid</a>. Gives you a starter for 10 on how to access from Excel. Note this is tailored to a particular enumeration (<code>8</code> for <code>wdContentControlCheckBox</code>), which returns a boolean; this is why understanding better your objectives and seeing your attempt would help.</p>\n\n<pre><code>Option Explicit\n\nPublic cc As Object\n\nPublic Sub Testing()\n\n  Dim PropVal As Boolean\n  Const wdContentControlCheckBox As Long = 8\n\n  PropVal = ReadProp(wdContentControlCheckBox, \"C:\\Users\\User\\Desktop\\Test.docm\")\n\n  MsgBox PropVal\n\nEnd Sub\n\nFunction ReadProp(ByVal sPropName As Long, ByVal FileName As String) As Boolean\n\n    Dim wdApp As Object 'Word.Application\n    Dim doc As Object 'Word.Document\n\n    Set wdApp = CreateObject(\"Word.Application\")\n    Set doc = wdApp.Documents.Open(FileName, ReadOnly:=True)\n\n    Dim bCustom As Boolean\n    Dim sValue As String\n\n    On Error GoTo ErrHandlerReadProp\n  'Try the built-in properties first\n  'An error will occur if the property doesn't exist\n    sValue = doc.BuiltinDocumentProperties(sPropName).Value\n    ReadProp = CBool(sValue)\n\nExit Function\n\nContinueCustom:\n  bCustom = True\n\nCustom:\n  sValue = doc.CustomDocumentProperties(sPropName).Value\n  ReadProp = CBool(sValue)\n  Exit Function\n\nErrHandlerReadProp:\n  Err.Clear\n  'The boolean bCustom has the value False, if this is the first\n  'time that the errorhandler is runned\n  If Not bCustom Then\n    'Continue to see if the property is a custom documentproperty\n    Resume ContinueCustom\n  Else\n    'The property wasn't found, return an empty string\n   ' ReadProp = \"\" ''Commented out by QHarr\n    Msgbox \"Property not found\"\n    Exit Function\n  End If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5456328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UI5cb.jpg?s=128&g=1", "display_name": "Qadeer", "link": "https://stackoverflow.com/users/5456328/qadeer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1679, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1515606953, "creation_date": 1515584704, "question_id": 48186753, "link": "https://stackoverflow.com/questions/48186753/extracting-the-content-control-property-from-a-word-document-using-excel-vba", "title": "Extracting the Content Control property from a Word document using Excel VBA", "body": "<p>My question is somewhat similar to this post <a href=\"https://stackoverflow.com/questions/28684664/extracting-the-company-property-from-a-word-document-using-excel-vba\">Extracting the Company property from a Word document using Excel VBA</a></p>\n\n<p>I am looking to extract the <strong>Content Control Properties</strong> instead of BuiltinDocumentProperties of MSWord.</p>\n\n<p>I'm novice in VBA, any code snippet that can extract the Content Control Property from MS Word Document, will be of great help to me.</p>\n\n<p>Thanks in Advance!</p>\n"}, {"tags": ["vba", "class", "module"], "comments": [{"owner": {"reputation": 3492, "user_id": 4416512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bPAgK.jpg?s=128&g=1", "display_name": "Aron", "link": "https://stackoverflow.com/users/4416512/aron"}, "edited": false, "score": 1, "creation_date": 1515587130, "post_id": 48186739, "comment_id": 83354466, "body": "It would be helpful if you post your code. Please review <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>"}, {"owner": {"reputation": 1, "user_id": 9198157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1777870008ed4967cbb1b95f4e0b5020?s=128&d=identicon&r=PG&f=1", "display_name": "CJF", "link": "https://stackoverflow.com/users/9198157/cjf"}, "reply_to_user": {"reputation": 3492, "user_id": 4416512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bPAgK.jpg?s=128&g=1", "display_name": "Aron", "link": "https://stackoverflow.com/users/4416512/aron"}, "edited": false, "score": 0, "creation_date": 1515589297, "post_id": 48186739, "comment_id": 83355785, "body": "Hi Aron, made and edit"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9198157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1777870008ed4967cbb1b95f4e0b5020?s=128&d=identicon&r=PG&f=1", "display_name": "CJF", "link": "https://stackoverflow.com/users/9198157/cjf"}, "edited": false, "score": 0, "creation_date": 1515678268, "post_id": 48188938, "comment_id": 83397851, "body": "Thank you for your answer @destination-data much apreciated"}, {"owner": {"reputation": 1, "user_id": 9198157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1777870008ed4967cbb1b95f4e0b5020?s=128&d=identicon&r=PG&f=1", "display_name": "CJF", "link": "https://stackoverflow.com/users/9198157/cjf"}, "edited": false, "score": 0, "creation_date": 1515681889, "post_id": 48188938, "comment_id": 83400353, "body": "could you elaborate a bit further concerning my data? I&#39;m assuming I should increase the scope of inputComboH, but where do I do this?  Again, the Userform_initialize calls the module that assigns the class module.  Should I also change the scope of the Sub?"}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "reply_to_user": {"reputation": 1, "user_id": 9198157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1777870008ed4967cbb1b95f4e0b5020?s=128&d=identicon&r=PG&f=1", "display_name": "CJF", "link": "https://stackoverflow.com/users/9198157/cjf"}, "edited": false, "score": 0, "creation_date": 1515682373, "post_id": 48188938, "comment_id": 83400706, "body": "Because <code>collInputCombo</code> contains all of your <code>inputComboH</code> classes it is important that remains in scope.  The moment VBA destroys it you will lose your classes, and their events.  Declare <code>collInputCombo</code> outside of any subs/funcs.  Example: <code>Private collInputCombo As Collection</code>.  Assuming this is inside a module.  If in a class it can be more complex."}], "tags": [], "owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "is_accepted": false, "score": 0, "last_activity_date": 1515592592, "last_edit_date": 1515592592, "creation_date": 1515592274, "answer_id": 48188938, "question_id": 48186739, "link": "https://stackoverflow.com/questions/48186739/click-event-in-class-module-not-firing-2-0/48188938#48188938", "title": "Click Event in Class Module Not Firing 2.0", "body": "<p><code>Option Explicit</code> should be placed at the top of every module/class.  It prevents you from using undeclared variables.  Without <code>Option Explicit</code> this code is valid.  </p>\n\n<pre><code>Sub Example1()\n\n    ' Ctrl + G will open the immediate window, if closed.\n    ' You'll need this to view the output.\n    myMessage = \"Hello World\"\n    Debug.Print myMessage\nEnd Sub\n</code></pre>\n\n<p>Although you never explicitly declare <code>myMessage</code> it is created for you.  </p>\n\n<p>Adding <code>Option Explicit</code> prevents the same code from running.  You'll get an error:</p>\n\n<blockquote>\n  <p>Compile error:</p>\n  \n  <p>Variable not defined</p>\n</blockquote>\n\n<pre><code>Option Explicit\n\nSub Example1()\n\n    ' To fix add \"Dim myMessage As String\" above this line.\n    ' The next line is responsible for the error.\n    myMessage = \"Hello World\"\n    Debug.Print myMessage\nEnd Sub\n</code></pre>\n\n<p>This helps you to avoid subtle errors.  In this example, without option explicit, a typo creates two variables.</p>\n\n<pre><code>' myCounter and myCount are meant to be the same\n' variable.  The user forgot/mistyped the name the\n' second time around, leading to an infinite loop.\n'\n' You can run this code.\n' Press Cntrl + Break to pause/reset to stop.\nSub Exmaple2()\n\n    myCounter = 1\n    Do\n        Debug.Print myCounter\n        myCount = myCount + 1    ' This line contains our \"error\"\n        DoEvents\n    Loop Until myCounter = 100\nEnd Sub\n</code></pre>\n\n<p>You can automatically add option explicit to every module (which is a good idea) from the options menu (Tools >> Options >> Require Variable Declaration).</p>\n\n<p>Your second question is about <a href=\"https://en.wikipedia.org/wiki/Scope_(computer_science)\" rel=\"nofollow noreferrer\">scope</a>.  Scope controls how variables can be accessed, and long they live for.  A variable leaves scope when then is no longer a valid way to access it.  At this point, the variable is destroyed (that might not always be technically true but for practical pruposes this is ok).  </p>\n\n<p>Variables declared within a sub/function have local scope.  That means they can only be accessed only within the declaring procedure.  When the procedure ends they can no longer be accessed and so are destroyed.  Once destroyed any value they held is lost (this is why your events won't fire - the objects that contain the events are lost).</p>\n\n<pre><code>' At the end of this sub, i will always equal 1,\n' regardless of the number of times you execute it.\n' This is because i is created each time you call the sub, and destroyed when it ends.\n' Each new verson of i has a default value of 0, to which we add one.\nSub Example2()\n\n    Dim i As Integer\n    i = i + 1\n    Debug.Print i\nEnd Sub\n</code></pre>\n\n<p>Now let's declare <code>i</code> at the module/class level.  With module scope, the variable will survive until the entire module leaves scope.  That will occur when:</p>\n\n<ul>\n<li>The user presses reset.</li>\n<li>The <code>End</code> command is encountered.</li>\n<li>The parent workbook is closed.</li>\n<li>In the case of classes; the class leaves scope.</li>\n</ul>\n\n<p>Example:</p>\n\n<pre><code>' i is declared at the module/class level.\n' It's value is maintained between calls to Example3.\nPrivate i As Integer\n\n' Each call to this sub will increment i by 1.\n' Call 1 will output 1.\n' Call 2 will output 2.\n' etc\nSub Example3()\n\n    i = i + 1\n    Debug.Print i\nEnd Sub\n</code></pre>\n\n<p>Scope is a big topic and can be confusing at first. Most <a href=\"https://www.amazon.co.uk/s/ref=nb_sb_noss?url=search-alias%3Daps&amp;field-keywords=wrox+vba&amp;rh=i%3Aaps%2Ck%3Awrox+vba\" rel=\"nofollow noreferrer\">VBA books</a> cover this.</p>\n"}], "owner": {"reputation": 1, "user_id": 9198157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1777870008ed4967cbb1b95f4e0b5020?s=128&d=identicon&r=PG&f=1", "display_name": "CJF", "link": "https://stackoverflow.com/users/9198157/cjf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515592592, "creation_date": 1515584657, "last_edit_date": 1515589269, "question_id": 48186739, "link": "https://stackoverflow.com/questions/48186739/click-event-in-class-module-not-firing-2-0", "title": "Click Event in Class Module Not Firing 2.0", "body": "<p>I have a similar question as described in the follow link: <a href=\"https://stackoverflow.com/questions/46777898/click-event-in-class-module-not-firing\">Click Event in Class Module Not Firing</a></p>\n\n<p>(Don't have the rep to comment there and ask for clarification, so made a new question)</p>\n\n<p>My set up is as follows:</p>\n\n<p>Userform_Initialize makes a Call to a Sub in a Module that creates ComboBoxes for this Userform, these ComboBoxes get set to a Class Module.</p>\n\n<p>If I understand the answer given in the link correctly, the connection between the ComboBox and the Class Module is forgotten before the userform is shown and therefore the action doesn't fire. Unfortunately, I can't get it to work.</p>\n\n<p>I was wondering if someone could specify the answer given in the link. Where do I put the \"Option Explicit\" and \"Private clsLabel As UserFormLabelLink\"? I've tried several locations, but every time I get a different error (Compile errors).</p>\n\n<p>(When I put a UserForm.Show in the module, which creates those ComboBoxes, the action does fire, but this creates an 91 Error at a later stage of the Userform.)</p>\n\n<p>If someone could help it would be much appreciated!</p>\n\n<p>EDIT - Here's the code</p>\n\n<p>Module</p>\n\n<pre><code>Dim inputComboH As cComboHandler\nSet collInputCombo = New Collection\nDim userformCombo As ComboBox\n\nSet userformCombo = UserForm1.MultiPage1.Page1.Controls(\"Frame1\").Add(\"Forms.ComboBox.1\")\n            With userformCombo\n                .Name = \"ComboBox\"\n                'Add items to the combobox\n                For k = 0 To 5\n                    .AddItem \"Item\" &amp; k\n                Next k\n\n\n                    Set inputComboH = New cComboHandler\n                    Set inputComboH.inputComboH = userformCombo\n                    collInputCombo.Add inputComboH\n\n\n            End With\n</code></pre>\n\n<p>Class Module cComboHandler</p>\n\n<pre><code>Public WithEvents inputComboH As MSForms.ComboBox\nPublic Sub inputComboH_Click()\n    MsgBox \"Clicked\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1515584620, "post_id": 48186595, "comment_id": 83352894, "body": "May we see your current code, or the relevant part of it, edited into your question? Code formatting tools are available in the editor."}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 8932748, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YS9hkVSN7j0/AAAAAAAAAAI/AAAAAAAAC8Q/FrEa_krEalM/photo.jpg?sz=128", "display_name": "Cedric Vongheer", "link": "https://stackoverflow.com/users/8932748/cedric-vongheer"}, "is_accepted": true, "score": 1, "last_activity_date": 1515584844, "creation_date": 1515584844, "answer_id": 48186798, "question_id": 48186595, "link": "https://stackoverflow.com/questions/48186595/looping-through-a-dataset-in-a-vba-macro/48186798#48186798", "title": "Looping through a dataset in a VBA Macro", "body": "<p>I'm not sure I understand but if you simply want to Loop it I guess something like this would work:</p>\n\n<pre><code>Sub Transfer()\n\nDim i As Integer\nDim Rows As Integer\n\n    Rows = Worksheets(\"November\").Range(\"A2\", Worksheets(\"November\").Range(\"A2\").End(xlDown)).Rows.Count\n\n    For i = 1 To Rows\n\n        Worksheets(\"Generators\").Range(\"D15\") = Worksheets(\"November\").Cells(i + 1, 1)\n\n        PDF_Create()\n\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>In this example Code You would have a Title in A1 and then the data begins in A2 with no blank Values. It will then Change the number in D15 accordingly and then you can input your PDF_Create Function.</p>\n"}], "owner": {"reputation": 3, "user_id": 9198171, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155080806746641/picture?type=large", "display_name": "Jon", "link": "https://stackoverflow.com/users/9198171/jon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "accepted_answer_id": 48186798, "answer_count": 1, "score": 0, "last_activity_date": 1515592677, "creation_date": 1515584209, "last_edit_date": 1515592677, "question_id": 48186595, "link": "https://stackoverflow.com/questions/48186595/looping-through-a-dataset-in-a-vba-macro", "title": "Looping through a dataset in a VBA Macro", "body": "<p>I have a range of data in column A on worksheet \"November\", I'm trying to make a loop that will extract one cell at a time, input it in another worksheet \"Generator\" Cell.D15 run a simple macro to save the worksheet into PDF and then loop back.</p>\n\n<p>My PDF macro works fine but I'm having trouble with the loop process.</p>\n"}, {"tags": ["excel", "range", "copying", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1515584124, "post_id": 48186394, "comment_id": 83352649, "body": "You can&#39;t use Union on different sheets."}, {"owner": {"reputation": 1, "user_id": 9198135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c126805f33086a402ebcba4d69691958?s=128&d=identicon&r=PG&f=1", "display_name": "Hin899", "link": "https://stackoverflow.com/users/9198135/hin899"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1515584227, "post_id": 48186394, "comment_id": 83352701, "body": "What&#39;s the best way to do this then? I need to copy the ranges from both sheet 1 &amp; 2."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1515584268, "post_id": 48186394, "comment_id": 83352721, "body": "Have you tried looking? Eg. <a href=\"https://stackoverflow.com/questions/25801941/vba-how-to-combine-two-ranges-on-different-sheets-into-one-to-loop-through\" title=\"vba how to combine two ranges on different sheets into one to loop through\">stackoverflow.com/questions/25801941/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1515637036, "creation_date": 1515637036, "answer_id": 48198901, "question_id": 48186394, "link": "https://stackoverflow.com/questions/48186394/copying-multiple-ranges-and-sheets/48198901#48198901", "title": "Copying Multiple Ranges and Sheets", "body": "<p>I think this will do what you want.</p>\n\n<pre><code>Set CopyRng = sh.Range(\"A1:G1\")\n\nSub CopyRangeFromMultiWorksheets()\n    Dim sh As Worksheet\n    Dim DestSh As Worksheet\n    Dim Last As Long\n    Dim CopyRng As Range\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    'Delete the sheet \"RDBMergeSheet\" if it exist\n    Application.DisplayAlerts = False\n    On Error Resume Next\n    ActiveWorkbook.Worksheets(\"RDBMergeSheet\").Delete\n    On Error GoTo 0\n    Application.DisplayAlerts = True\n\n    'Add a worksheet with the name \"RDBMergeSheet\"\n    Set DestSh = ActiveWorkbook.Worksheets.Add\n    DestSh.Name = \"RDBMergeSheet\"\n\n    'loop through all worksheets and copy the data to the DestSh\n    For Each sh In ActiveWorkbook.Worksheets\n        If sh.Name &lt;&gt; DestSh.Name Then\n\n            'Find the last row with data on the DestSh\n            Last = LastRow(DestSh)\n\n            'Fill in the range that you want to copy\n            Set CopyRng = sh.Range(\"A1:G1\")\n\n            'Test if there enough rows in the DestSh to copy all the data\n            If Last + CopyRng.Rows.Count &gt; DestSh.Rows.Count Then\n                MsgBox \"There are not enough rows in the Destsh\"\n                GoTo ExitTheSub\n            End If\n\n            'This example copies values/formats, if you only want to copy the\n            'values or want to copy everything look at the example below this macro\n            CopyRng.Copy\n            With DestSh.Cells(Last + 1, \"A\")\n                .PasteSpecial xlPasteValues\n                .PasteSpecial xlPasteFormats\n                Application.CutCopyMode = False\n            End With\n\n            'Optional: This will copy the sheet name in the H column\n            DestSh.Cells(Last + 1, \"H\").Resize(CopyRng.Rows.Count).Value = sh.Name\n\n        End If\n    Next\n\nExitTheSub:\n\n    Application.Goto DestSh.Cells(1)\n\n    'AutoFit the column width in the DestSh sheet\n    DestSh.Columns.AutoFit\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9198135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c126805f33086a402ebcba4d69691958?s=128&d=identicon&r=PG&f=1", "display_name": "Hin899", "link": "https://stackoverflow.com/users/9198135/hin899"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 789, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515637036, "creation_date": 1515583575, "last_edit_date": 1531164843, "question_id": 48186394, "link": "https://stackoverflow.com/questions/48186394/copying-multiple-ranges-and-sheets", "title": "Copying Multiple Ranges and Sheets", "body": "<p>I am trying to copy multiple ranges from workbook into one sheet into another. I have tried to use MyMultipleRange but keep getting a message of \"Method 'Union' of object_'Global' failed.</p>\n\n<pre><code>Function WorkbookName() As String\n    WorkbookName = ThisWorkbook.Name\nEnd Function\n\nSub dataimport()\n    Dim i As Integer\n    Dim Data\n\n    Workbooks(WorkbookName).Activate\n    Sheets(\"Input\").Select\n    Datapath = Cells(15, 4)\n    Data = Cells(15, 3)\n\n    Application.Workbooks.Open (Datapath)\n\n    Dim r1, r2, myMultipleRange As Range\n    Set r1 = Sheets(\"Sheet1\").Range(\"A1:Ak518\")\n    Set r2 = Sheets(\"Sheet2\").Range(\"B2:J10\")\n    Set myMultipleRange = Union(r1, r2)\n\n    Workbooks(WorkbookName).Activate\n    Sheets(\"Sheet5\").Select\n    Range(\"A1:Ak600\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n\n     Workbooks(Data).Close savechanges:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1515591017, "post_id": 48186148, "comment_id": 83356792, "body": "Instead of <code>Case y = 1</code> you instead can just use <code>Case 1</code> (etc)"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1515601209, "post_id": 48186148, "comment_id": 83363857, "body": "InputBox returns a string, not a long so you&#39;ll need to either use CLng(InputBox(&quot;etc&quot;)) or dim Y as a string and later use Select Case Y ... Case is = 1 etc.  And since users are users, ALWAYS include a Case Else so you can apply a default color or show them a message."}, {"owner": {"reputation": 49, "user_id": 8380992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/279a24af1f7465007a55f3d733b61b78?s=128&d=identicon&r=PG&f=1", "display_name": "Gerald Tow", "link": "https://stackoverflow.com/users/8380992/gerald-tow"}, "edited": false, "score": 0, "creation_date": 1515628136, "post_id": 48186148, "comment_id": 83376881, "body": "Thanks Steve for your comment. I revised my code with your comment and it works beautifully now. I realize I also missed out an End select to close the select case too."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1515686519, "post_id": 48186148, "comment_id": 83403531, "body": "@GeraldTow It&#39;s a good idea always to hit the compile button before running any code. It won&#39;t catch all errors but it&#39;ll trap a lot of the &quot;stupid human tricks&quot; ones."}], "owner": {"reputation": 49, "user_id": 8380992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/279a24af1f7465007a55f3d733b61b78?s=128&d=identicon&r=PG&f=1", "display_name": "Gerald Tow", "link": "https://stackoverflow.com/users/8380992/gerald-tow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 311, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1515628299, "creation_date": 1515582741, "last_edit_date": 1515628299, "question_id": 48186148, "link": "https://stackoverflow.com/questions/48186148/using-select-case-on-power-point", "title": "Using select case on Power point", "body": "<p>I'm trying to use vba to insert a textbox and prompt user to type a selection i.e 1-3 and use select case to execute the corresponding code that will change the textbox fill and font color as I have stated. </p>\n\n<p>I'm not too sure what I should put after Select Case, currently I putting Select case y which I think may be the reason my code is not working.</p>\n\n<p>Appreciate if anyone can try to spot my mistake and help me turn it into a working code. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Insert_Textbox()\n\nDim sld As slide, sh As Shape, cursh As Shape\nDim y As Long\n\nDim chtcolor01 As Long, chtcolor02 As Long, chtcolor03 As Long, w As Long, b As Long\n\nw = RGB(250, 250, 250)\nb = RGB(0, 0, 0)\n\nchtcolor01 = RGB(250, 0, 0)\nchtcolor02 = RGB(0, 250, 0)\nchtcolor03 = RGB(0, 0, 250)\n\n\nSet sld = Application.ActiveWindow.View.slide\nSet sh = sld.shapes.AddShape(Type:=msoShapeRectangle, _\nLeft:=50, Top:=50, Width:=150, Height:=50) 'this shape will now be called sh\n\nWith sh\ny = InputBox(\"Please select a number between 1 to 3 for the color for your textboxes\", \"Choose your color!\")\n\nSelect Case y\nCase y = 1\n\n.Fill.ForeColor.RGB = chtcolor01\n.textFrame.TextRange.Font.Color.RGB = b\n.Line.Visible = msoFalse 'remove border\n\ny = 2\n.Fill.ForeColor.RGB = chtcolor02\n.textFrame.TextRange.Font.Color.RGB = b\n.Line.Visible = msoFalse 'remove border\n\ny = 3\n.Fill.ForeColor.RGB = chtcolor02\n.textFrame.TextRange.Font.Color.RGB = w\n.Line.Visible = msoFalse 'remove border\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>The following is the revised code with Steve help. Hope others may find it useful too.</p>\n\n<pre><code>Sub Insert_Textbox()\n\nDim sld As slide, sh As shape, cursh As shape\nDim Y As String\n\nDim chtcolor01 As Long, chtcolor02 As Long, chtcolor03 As Long, w As Long, b As Long\n\nw = RGB(250, 250, 250)\nb = RGB(0, 0, 0)\n\nchtcolor01 = RGB(250, 0, 0)\nchtcolor02 = RGB(0, 250, 0)\nchtcolor03 = RGB(0, 0, 250)\n\n\nSet sld = Application.ActiveWindow.View.slide\nSet sh = sld.Shapes.AddShape(Type:=msoShapeRectangle, _\nLeft:=50, Top:=50, Width:=150, Height:=50) 'this shape will now be called sh\n\nWith sh\nY = InputBox(\"Please select a number between 1 to 3 for the color for your textboxes\", \"Choose your color!\")\n\nSelect Case Y\nCase Is = 1\n\n.Fill.ForeColor.RGB = chtcolor01\n.TextFrame.TextRange.Font.Color.RGB = b\n.Line.Visible = msoFalse 'remove border\n\nCase Is = 2\n.Fill.ForeColor.RGB = chtcolor02\n.TextFrame.TextRange.Font.Color.RGB = b\n.Line.Visible = msoFalse 'remove border\n\nCase Is = 3\n.Fill.ForeColor.RGB = chtcolor02\n.TextFrame.TextRange.Font.Color.RGB = w\n.Line.Visible = msoFalse 'remove border\n\nCase Else\nMsgBox (\"The number you typed is invalid, please try again\")\n\nEnd Select\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 8591599, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/7d0e1fcdda3ee34866d0975fcd997873?s=128&d=identicon&r=PG&f=1", "display_name": "jufg", "link": "https://stackoverflow.com/users/8591599/jufg"}, "edited": false, "score": 0, "creation_date": 1515583169, "post_id": 48186241, "comment_id": 83352145, "body": "Hi Vityata, thanks for the response, I&#39;m still getting a <code>compile error: Argument not optional</code> error though"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1515583226, "post_id": 48186241, "comment_id": 83352174, "body": "I was wondering about your original response. The parameter to the NINOFunction function is not optional. <a href=\"https://stackoverflow.com/posts/48186241/edit\">edit</a> Your last reponse looks like a call to a procedure; not a function."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1515583910, "post_id": 48186241, "comment_id": 83352545, "body": "@Jeeped - yup true. I have simply started to remove parenthesis everywhere in <code>Subs</code> since the last week, thus this new habit results in flaws like the one above."}, {"owner": {"reputation": 99, "user_id": 8591599, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/7d0e1fcdda3ee34866d0975fcd997873?s=128&d=identicon&r=PG&f=1", "display_name": "jufg", "link": "https://stackoverflow.com/users/8591599/jufg"}, "edited": false, "score": 1, "creation_date": 1515583993, "post_id": 48186241, "comment_id": 83352584, "body": "Excellent thanks Vityata, I was wondering why they were all returning False, didn&#39;t realise I hadn&#39;t updated the Variable name at the end!!"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1515583659, "last_edit_date": 1515583659, "creation_date": 1515583003, "answer_id": 48186241, "question_id": 48186050, "link": "https://stackoverflow.com/questions/48186050/using-function-within-vba-sub/48186241#48186241", "title": "Using Function within VBA Sub", "body": "<p>Your compilation error is \"Argument is not optional\". This is quite good error message. Thus write <code>x = NINOFunction(arg)</code> and put an argument <code>sInp</code>.</p>\n\n<p>Something like <code>x = NINOFunction (\"something\")</code></p>\n\n<p>or probably you need:</p>\n\n<p><code>x = NINOFunction (NINumber)</code></p>\n\n<p>Furthermore, your function always returns <code>False</code>, because this is the default value of the Boolean function. You may consider fixing it like this:</p>\n\n<pre><code>Function NINOFunction(sInp As String) As Boolean\n    Const s1 As String = \"[AaBbCcEeGgHhJjKkLlMmNnOoPpRrSsTtWwXxYyZz]\"\n    Const s2 As String = \"[AaBbCcEeGgHhJjKkLlMmNnPpRrSsTtWwXxYyZz]\"\n    Const s3 As String = \"######\"\n    Const s4 As String = \"[AaBbCcDd]\"\n\n    NINOFunction = sInp Like s1 &amp; s2 &amp; s3 &amp; s4\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4956, "user_id": 5762332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhBOT.jpg?s=128&g=1", "display_name": "Magnetron", "link": "https://stackoverflow.com/users/5762332/magnetron"}, "edited": false, "score": 0, "creation_date": 1515583536, "post_id": 48186287, "comment_id": 83352337, "body": "And, of course, replace &quot;something&quot; with the desired input string."}, {"owner": {"reputation": 99, "user_id": 8591599, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/7d0e1fcdda3ee34866d0975fcd997873?s=128&d=identicon&r=PG&f=1", "display_name": "jufg", "link": "https://stackoverflow.com/users/8591599/jufg"}, "edited": false, "score": 0, "creation_date": 1515584057, "post_id": 48186287, "comment_id": 83352614, "body": "Thanks Magnetron, I was unaware that I had to assign the function like that, but it makes perfect sense!"}], "tags": [], "owner": {"reputation": 4956, "user_id": 5762332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhBOT.jpg?s=128&g=1", "display_name": "Magnetron", "link": "https://stackoverflow.com/users/5762332/magnetron"}, "is_accepted": false, "score": 0, "last_activity_date": 1515583189, "creation_date": 1515583189, "answer_id": 48186287, "question_id": 48186050, "link": "https://stackoverflow.com/questions/48186050/using-function-within-vba-sub/48186287#48186287", "title": "Using Function within VBA Sub", "body": "<p><code>NINOFunction</code> takes 1 argument, which is a string, but you didn't pass any. Try <code>x = NINOFunction(\"something\")</code></p>\n"}], "owner": {"reputation": 99, "user_id": 8591599, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/7d0e1fcdda3ee34866d0975fcd997873?s=128&d=identicon&r=PG&f=1", "display_name": "jufg", "link": "https://stackoverflow.com/users/8591599/jufg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 48186241, "answer_count": 2, "score": 1, "last_activity_date": 1515587282, "creation_date": 1515582471, "last_edit_date": 1515587282, "question_id": 48186050, "link": "https://stackoverflow.com/questions/48186050/using-function-within-vba-sub", "title": "Using Function within VBA Sub", "body": "<p>I'm trying to run a function within my Sub but am getting a compile error on the line <code>x = NINOFunction()</code> and am not sure how to get it working.</p>\n\n<pre><code>Sub CheckNINO()\n    Dim NINumber As Range, NINumbers As Range\n    Dim Usdrws As Long, x As Boolean\n\n    Usdrws = Worksheets(\"EeeDetails\").Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n    Set NINumbers = Worksheets(\"EeeDetails\").Range(\"Q2:Q\" &amp; Usdrws)\n\n    For Each NINumber In NINumbers\n        x = NINOFunction(NINumber.Value)\n        If x = False Then\n            Range(NINumber).Copy Destination:=Worksheets(\"Validation\").Cells(2, x)\n        End If\n    Next\nEnd Sub\n\nFunction NINOFunction(sInp As String) As Boolean\n    Const s1 As String = \"[AaBbCcEeGgHhJjKkLlMmNnOoPpRrSsTtWwXxYyZz]\"\n    Const s2 As String = \"[AaBbCcEeGgHhJjKkLlMmNnPpRrSsTtWwXxYyZz]\"\n    Const s3 As String = \"######\"\n    Const s4 As String = \"[AaBbCcDd]\"\n\n    NINO = sInp Like s1 &amp; s2 &amp; s3 &amp; s4\nEnd Function\n</code></pre>\n\n<p>The function is tested and works with a Boolean result. </p>\n\n<p>If the result is False I want to copy the row across to a separate sheet.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1515582812, "post_id": 48186036, "comment_id": 83351935, "body": "You can use <code>Sheets(&quot;Sheet1&quot;).cells(rng.row,1).resize(,12).Copy Sheets(&quot;ASD 5P&quot;).Cells(x, 1)</code>."}, {"owner": {"reputation": 5, "user_id": 9198009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2aa21505d5b7eea430ff02802e92dcc?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/9198009/steve"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1515583114, "post_id": 48186036, "comment_id": 83352116, "body": "Can you please advise where I fit this into my code please? Sorry, I&#39;m new to VBA and don&#39;t want to ruin what I&#39;ve done so far."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1515583227, "post_id": 48186036, "comment_id": 83352177, "body": "I am just replacing your current <code>rng.EntireRow.Copy ...</code> lines."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1515583324, "post_id": 48186036, "comment_id": 83352232, "body": "By the way, I&#39;m not sure you need two loops, you could do both checks in one."}, {"owner": {"reputation": 5, "user_id": 9198009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2aa21505d5b7eea430ff02802e92dcc?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/9198009/steve"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1515583386, "post_id": 48186036, "comment_id": 83352257, "body": "That&#39;s it. Thank you!!!"}, {"owner": {"reputation": 5, "user_id": 9198009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2aa21505d5b7eea430ff02802e92dcc?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/9198009/steve"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1515583614, "post_id": 48186036, "comment_id": 83352385, "body": "If you can recommend how to do both checks in one, that would be great. I also need to ensure that I don&#39;t end up with duplicates appearing in the destination sheets, so each person only gets added once to each list."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9198009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2aa21505d5b7eea430ff02802e92dcc?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/9198009/steve"}, "edited": false, "score": 1, "creation_date": 1515584610, "post_id": 48186531, "comment_id": 83352889, "body": "Thank you for your help."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1515583992, "creation_date": 1515583992, "answer_id": 48186531, "question_id": 48186036, "link": "https://stackoverflow.com/questions/48186036/vba-code-to-copy-columns-al-only-to-another-sheet-not-entire-column/48186531#48186531", "title": "VBA code to copy columns A:L only to another sheet (not entire column)", "body": "<p>Suggested re-write (too long to fit in the comments!). Am also not sure you need to remove duplicates in your loop, but have left in as not sure what it does.</p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target As Range)\n\nDim KeyCells As Range\nDim LastRow As Long\nDim x As Long, y As Long\nDim rng As Range\n\nSet KeyCells = Range(\"K:L\")\n\nIf Not Application.Intersect(KeyCells, Range(Target.Address)) Is Nothing Then\n    Application.ScreenUpdating = False\n    LastRow = Sheets(\"Sheet1\").Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n    x = 3: y = 3\n\n    For Each rng In Sheets(\"Sheet1\").Range(\"K3:K\" &amp; LastRow)\n        If rng = \"Yes\" Then\n            Sheets(\"Sheet1\").Cells(rng.Row, 1).Resize(, 12).Copy Sheets(\"ASD 5P\").Cells(x, 1)\n            x = x + 1\n            ActiveSheet.Range(\"A3:Q200\").RemoveDuplicates Columns:=Array(4, 5, 6), Header:=xlNo\n        End If\n        If rng.Offset(, 1) = \"Yes\" Then\n            Sheets(\"Sheet1\").Cells(rng.Row, 1).Resize(, 12).Copy Sheets(\"ASD PD\").Cells(y, 1)\n            y = y + 1\n            ActiveSheet.Range(\"A3:Q200\").RemoveDuplicates Columns:=Array(4, 5, 6), Header:=xlNo\n        End If\n    Next rng\n    Application.ScreenUpdating = True\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 8578628, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PHFZb.jpg?s=128&g=1", "display_name": "Michael Reichel", "link": "https://stackoverflow.com/users/8578628/michael-reichel"}, "edited": false, "score": 0, "creation_date": 1515588898, "post_id": 48187894, "comment_id": 83355526, "body": "I just rechecked your code and realized that I shouldn&#39;t have removed the second loop.    The Range(...).Copy bit can be used for both loops though."}], "tags": [], "owner": {"reputation": 11, "user_id": 8578628, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PHFZb.jpg?s=128&g=1", "display_name": "Michael Reichel", "link": "https://stackoverflow.com/users/8578628/michael-reichel"}, "is_accepted": false, "score": 0, "last_activity_date": 1515588614, "creation_date": 1515588614, "answer_id": 48187894, "question_id": 48186036, "link": "https://stackoverflow.com/questions/48186036/vba-code-to-copy-columns-al-only-to-another-sheet-not-entire-column/48187894#48187894", "title": "VBA code to copy columns A:L only to another sheet (not entire column)", "body": "<p>Give this a try:  </p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target As Range)\n  Dim KeyCells As Range\n\n  Set KeyCells = Range(\"K:L\")\n\n  If Not Application.Intersect(KeyCells, Range(Target.Address)) _\n       Is Nothing Then\n\n  Application.ScreenUpdating = False\n  Dim LastRow As Long\n  LastRow = Sheets(\"Sheet1\").Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n  Dim x As Long\n  x = 3\n  Dim rng As Range\n  For Each rng In Sheets(\"Sheet1\").Range(\"K3:L\" &amp; LastRow)\n      If rng = \"Yes\" Then\n          Range(\"A\" &amp; rng.row &amp; \":L\" &amp; rng.row).Copy Sheets(\"ASD 5P\").Cells(x, 1)\n          x = x + 1\n          ActiveSheet.Range(\"A3:Q200\").RemoveDuplicates Columns:=Array(4, 5, 6), Header:=xlNo\n      End If\n  Next rng\n  Application.ScreenUpdating = True\n\n  End If\n  End Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9198009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2aa21505d5b7eea430ff02802e92dcc?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/9198009/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 48186531, "answer_count": 2, "score": 0, "last_activity_date": 1515588614, "creation_date": 1515582429, "last_edit_date": 1515582857, "question_id": 48186036, "link": "https://stackoverflow.com/questions/48186036/vba-code-to-copy-columns-al-only-to-another-sheet-not-entire-column", "title": "VBA code to copy columns A:L only to another sheet (not entire column)", "body": "<p>I have a spreadsheet where I enter a persons details in columns A-J and then indicate Yes in column K if he/she is referred for ASD 5P or column L for ASD PD. When I enter 'Yes' in one or both of those columns, I want to copy columns A:L of that row over to the relevant tab. I have the following code which copies the entire row over, but I want it to stop at column L. Here is the code I've been using (copied and adapted from various sites). Can anyone help me to amend this please?!?\n<img src=\"https://i.stack.imgur.com/e6h0v.jpg\" alt=\"This is what my spreadsheet looks like\"></p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target As Range)\n    Dim KeyCells As Range\n\n    Set KeyCells = Range(\"K:L\")\n\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) _\n           Is Nothing Then\n\n    Application.ScreenUpdating = False\n    Dim LastRow As Long\n    LastRow = Sheets(\"Sheet1\").Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n    Dim x As Long\n    x = 3\n    Dim rng As Range\n    For Each rng In Sheets(\"Sheet1\").Range(\"K3:K\" &amp; LastRow)\n        If rng = \"Yes\" Then\n            rng.EntireRow.Copy Sheets(\"ASD 5P\").Cells(x, 1)\n            x = x + 1\n            ActiveSheet.Range(\"A3:Q200\").RemoveDuplicates Columns:=Array(4, 5, 6), Header:=xlNo\n        End If\n    Next rng\n    Application.ScreenUpdating = True\n\n\n    Application.ScreenUpdating = False\n    LastRow = Sheets(\"Sheet1\").Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n    x = 3\n    For Each rng In Sheets(\"Sheet1\").Range(\"L3:L\" &amp; LastRow)\n        If rng = \"Yes\" Then\n            rng.EntireRow.Copy Sheets(\"ASD PD\").Cells(x, 1)\n            x = x + 1\n            ActiveSheet.Range(\"A3:Q200\").RemoveDuplicates Columns:=Array(4, 5, 6), Header:=xlNo\n        End If\n    Next rng\n    Application.ScreenUpdating = True\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "32bit-64bit"], "comments": [{"owner": {"reputation": 132, "user_id": 8988624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c37c08fab3084b272ef09fdfe48d72a3?s=128&d=identicon&r=PG", "display_name": "prextor", "link": "https://stackoverflow.com/users/8988624/prextor"}, "edited": false, "score": 0, "creation_date": 1515586935, "post_id": 48185934, "comment_id": 83354333, "body": "I&#39;m using also a 32-Bit system and I have recognized: even windows is giving the error, that excel is not responding, it will finish eventually (but that might be just in my case). If you want to avoid Excel crashing, split the code into several subprocedures. Call them manually or interrupt the execution between every code with a MsgBox."}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 8230239, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cf35ef455d362c71f2c943d98afe3c76?s=128&d=identicon&r=PG&f=1", "display_name": "SCW", "link": "https://stackoverflow.com/users/8230239/scw"}, "edited": false, "score": 0, "creation_date": 1515602275, "post_id": 48188885, "comment_id": 83364582, "body": "thanks for your help, this is much appreciated. As I justed started with VBA, I haven&#39;t yet come across arrays. I do understand the logic behind calling individual arrays, however, I don&#39;t get it to work. I have now written with two if-else statements what you suggested and added the code to my original post. However, I get the error &quot;End with without with&quot; when running it. I wonder whether the code is actually meant to appear in the same module? Or one after the other, and if so how do I do this?"}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "reply_to_user": {"reputation": 155, "user_id": 8230239, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cf35ef455d362c71f2c943d98afe3c76?s=128&d=identicon&r=PG&f=1", "display_name": "SCW", "link": "https://stackoverflow.com/users/8230239/scw"}, "edited": false, "score": 0, "creation_date": 1515662217, "post_id": 48188885, "comment_id": 83387712, "body": "@SCW You just need to put a <code>End With</code> statement before sub ends."}, {"owner": {"reputation": 155, "user_id": 8230239, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cf35ef455d362c71f2c943d98afe3c76?s=128&d=identicon&r=PG&f=1", "display_name": "SCW", "link": "https://stackoverflow.com/users/8230239/scw"}, "edited": false, "score": 0, "creation_date": 1515662847, "post_id": 48188885, "comment_id": 83388111, "body": "Hi, @Ans, I still get the same error in the same line if I add an additional &quot;End with&quot; in the second-to-last line, i.e. it complains that there is an &quot;End with&quot; that does not have a &quot;with&quot;.  There is however a &quot;With &quot; command in line 7, no? I assumed that the &quot;with...end with&quot; command would work like brackets? Thanks!"}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "reply_to_user": {"reputation": 155, "user_id": 8230239, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cf35ef455d362c71f2c943d98afe3c76?s=128&d=identicon&r=PG&f=1", "display_name": "SCW", "link": "https://stackoverflow.com/users/8230239/scw"}, "edited": false, "score": 0, "creation_date": 1515663418, "post_id": 48188885, "comment_id": 83388509, "body": "@SCW Could you send me your file with code? Or wait, you say there&#39;s extra <code>end with</code>, so just delete the extra one."}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "reply_to_user": {"reputation": 155, "user_id": 8230239, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cf35ef455d362c71f2c943d98afe3c76?s=128&d=identicon&r=PG&f=1", "display_name": "SCW", "link": "https://stackoverflow.com/users/8230239/scw"}, "edited": false, "score": 0, "creation_date": 1515663732, "post_id": 48188885, "comment_id": 83388721, "body": "@SCW I took a look at your edit with array code. It looks there&#39;s something a bit off about that also - you see, you say in code <code>With dataWorkbook...</code> and then use <code>ws.Cells</code>. I suggest googling a couple of <code>With</code> examples. It&#39;s quite simple - when you put <code>With &#39;something&#39;</code> you no longer need to use <code>&#39;something&#39;.Cells</code> syntax. My code was just an example with different names, for example you seem to have named your workbook as <code>ws</code>, while I named it <code>dataWorkbook</code>. If that is so, after <code>With ws</code> you just use <code>.Cells</code> and vba would understand you mean cells inside <code>ws</code> workbook."}, {"owner": {"reputation": 155, "user_id": 8230239, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cf35ef455d362c71f2c943d98afe3c76?s=128&d=identicon&r=PG&f=1", "display_name": "SCW", "link": "https://stackoverflow.com/users/8230239/scw"}, "edited": false, "score": 0, "creation_date": 1515754960, "post_id": 48188885, "comment_id": 83431314, "body": "Hello @Ans. I understand with...end with now, and I understand the idea of an array. I also managed to load my data into an array (see my edit) . But then I don&#39;t know what to do with my array called &quot;Chinese&quot;. I was that stuck that I now have written a new code 8 times (for Column 1-1000, 1001-2000 etc). Not elegant, and takes time, but at least it works :/"}], "tags": [], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "is_accepted": false, "score": 1, "last_activity_date": 1515594000, "last_edit_date": 1515594000, "creation_date": 1515592094, "answer_id": 48188885, "question_id": 48185934, "link": "https://stackoverflow.com/questions/48185934/excel-table-too-big-for-vba-code-simplify-code/48188885#48188885", "title": "Excel table too big for VBA code - simplify code?", "body": "<p>I didn't look closely at your code, but you seem to be checking a <code>cell.value</code> and are iterating over <code>8000</code> columns. A rule of thumb regarding this is iterating directly through cells in a worksheet via vba is extremely slow and inefficient. You must first load your data into array like this:</p>\n\n<pre><code>Dim firstRow As Long\nDim lastRow As Long\n\nfirstRow = 1\nlastRow = 37\n\nDim tableArray() As Variant\nDim k As Long\n\nWith dataWorkbook.Worksheets(\"YOUR_SHEET_NAME\")\n\ntableArray = .Range(.Cells(firstRow, 1), _\n                            .Cells(lastRow, 8000)).value\n</code></pre>\n\n<p>Then you do all the iterating within vba: over array:</p>\n\n<pre><code>For k = 1 To 8000 'for each column in the table\n\nIf tableArray(4, k) = \"Author\" Then\n   ...\nElse\n   'edit the existing array: tableArray, not a worksheet!\nEnd If\n\nNext\n</code></pre>\n\n<p>Then after you're finished with editing the <code>tableArray</code> and have its final version you can load it into worksheet in one go:</p>\n\n<pre><code>Dim worksheetRange As Range\nSet worksheetRange = .Range(.Cells(firstRow, 1), _\n                            .Cells(lastRow, 8000))\nworksheetRange.value = tableArray\n\nEnd With\n</code></pre>\n\n<p>If you have any questions feel free to ask. I've been dealing with big tables for a while myself, so I know the pain.</p>\n"}], "owner": {"reputation": 155, "user_id": 8230239, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cf35ef455d362c71f2c943d98afe3c76?s=128&d=identicon&r=PG&f=1", "display_name": "SCW", "link": "https://stackoverflow.com/users/8230239/scw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1515753457, "creation_date": 1515582085, "last_edit_date": 1515753457, "question_id": 48185934, "link": "https://stackoverflow.com/questions/48185934/excel-table-too-big-for-vba-code-simplify-code", "title": "Excel table too big for VBA code - simplify code?", "body": "<p>I have an Excel table with 37 rows and 8000 columns. The table is not intuitive in that an observation is found in a column, rather than a row. As you can see, the structure is like this:  Category (Title) - Entry - Category (Author)- Entry etc. etc.. Eventually, I want a nice cleaned up data-set which has categories in row 1 and observations in the remaining rows. </p>\n\n<p><a href=\"https://i.stack.imgur.com/fX02Y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fX02Y.png\" alt=\"enter image description here\"></a></p>\n\n<p>The first problem I had is that not all observations include all categories: Columns 1-5 do not contain \"Funding\" (F12 category name, F13 content). Now I managed to compile my very first VBA code with the help of @Xabier, which inserts two blank cells and shifts the rest below if for instance row 12 does not contain \"Funding\". I have done this for all category lines.I have tried the code on fewer observations and it seemed to be working. \n<a href=\"https://i.stack.imgur.com/F2fK1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F2fK1.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is the code:</p>\n\n<pre><code>Sub foo()\nDim ws As Worksheet: Set ws = Sheets(\"Sheet2\")\n'declare and set your Sheet above\n'lastrow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n'find the last row with data on Column A\n\nFor i = 1 To 8000 'loop from column 1 to last\n    If Not ws.Cells(2, i).Value = \"Title\" Then 'if category is not found,\n        ws.Cells(2, i).Insert Shift:=xlDown 'insert a blank cell in column i\n        ws.Cells(2, i).Insert Shift:=xlDown 'again insert a second blank cell in column i\n    End If\nNext i\n\nFor i = 1 To 8000 'loop from column 1 to last\n    If Not ws.Cells(4, i).Value = \"Author\" Then 'if category is not found,\n        ws.Cells(4, i).Insert Shift:=xlDown 'insert a blank cell in column i\n        ws.Cells(4, i).Insert Shift:=xlDown 'again insert a second blank cell in column i\n    End If\nNext i\n\nFor i = 1 To 8000 'loop from column 1 to last\n    If Not ws.Cells(6, i).Value = \"Unit\" Then 'if category is not found,\n        ws.Cells(6, i).Insert Shift:=xlDown 'insert a blank cell in column i\n        ws.Cells(6, i).Insert Shift:=xlDown 'again insert a second blank cell in column i\n    End If\nNext i\n\nFor i = 1 To 8000 'loop from column 1 to last\n    If Not ws.Cells(8, i).Value = \"Keyword\" Then 'if category is not found,\n        ws.Cells(8, i).Insert Shift:=xlDown 'insert a blank cell in column i\n        ws.Cells(8, i).Insert Shift:=xlDown 'again insert a second blank cell in column i\n    End If\nNext i\n\nFor i = 1 To 8000 'loop from column 1 to last\n    If Not ws.Cells(10, i).Value = \"Abstract\" Then 'if category is not found,\n        ws.Cells(10, i).Insert Shift:=xlDown 'insert a blank cell in column i\n        ws.Cells(10, i).Insert Shift:=xlDown 'again insert a second blank cell in column i\n    End If\nNext i\n\nFor i = 1 To 8000 'loop from column 1 to last\n    If Not ws.Cells(12, i).Value = \"Funding\" Then 'if category is not found,\n        ws.Cells(12, i).Insert Shift:=xlDown 'insert a blank cell in column i\n        ws.Cells(12, i).Insert Shift:=xlDown 'again insert a second blank cell in column i\n    End If\nNext i\n\nFor i = 1 To 8000 'loop from column 1 to last\n    If Not ws.Cells(14, i).Value = \"Source\" Then 'if category is not found,\n        ws.Cells(14, i).Insert Shift:=xlDown 'insert a blank cell in column i\n        ws.Cells(14, i).Insert Shift:=xlDown 'again insert a second blank cell in column i\n    End If\nNext i\n\nFor i = 1 To 8000 'loop from column 1 to last\n    If Not ws.Cells(16, i).Value = \"Date\" Then 'if category is not found,\n        ws.Cells(16, i).Insert Shift:=xlDown 'insert a blank cell in column i\n        ws.Cells(16, i).Insert Shift:=xlDown 'again insert a second blank cell in column i\n    End If\nNext i\n\nFor i = 1 To 8000 'loop from column 1 to last\n    If Not ws.Cells(18, i).Value = \"Page\" Then 'if category is not found,\n        ws.Cells(18, i).Insert Shift:=xlDown 'insert a blank cell in column i\n        ws.Cells(18, i).Insert Shift:=xlDown 'again insert a second blank cell in column i\n    End If\nNext i\n\nFor i = 1 To 8000 'loop from column 1 to last\n    If Not ws.Cells(20, i).Value = \"ISSN\" Then 'if category is not found,\n        ws.Cells(20, i).Insert Shift:=xlDown 'insert a blank cell in column i\n        ws.Cells(20, i).Insert Shift:=xlDown 'again insert a second blank cell in column i\n    End If\nNext i\n\nFor i = 1 To 8000 'loop from column 1 to last\n    If Not ws.Cells(22, i).Value = \"CN\" Then 'if category is not found,\n        ws.Cells(22, i).Insert Shift:=xlDown 'insert a blank cell in column i\n        ws.Cells(22, i).Insert Shift:=xlDown 'again insert a second blank cell in column i\n    End If\nNext i\n\nFor i = 1 To 8000 'loop from column 1 to last\n    If Not ws.Cells(24, i).Value = \"Language\" Then 'if category is not found,\n        ws.Cells(24, i).Insert Shift:=xlDown 'insert a blank cell in column i\n        ws.Cells(24, i).Insert Shift:=xlDown 'again insert a second blank cell in column i\n    End If\nNext i\n\nFor i = 1 To 8000 'loop from column 1 to last\n    If Not ws.Cells(26, i).Value = \"ClassificationNumber\" Then 'if category is not found,\n        ws.Cells(26, i).Insert Shift:=xlDown 'insert a blank cell in column i\n        ws.Cells(26, i).Insert Shift:=xlDown 'again insert a second blank cell in column i\n    End If\nNext i\n\nFor i = 1 To 8000 'loop from column 1 to last\n    If Not ws.Cells(28, i).Value = \"DOI\" Then 'if category is not found,\n        ws.Cells(28, i).Insert Shift:=xlDown 'insert a blank cell in column i\n        ws.Cells(28, i).Insert Shift:=xlDown 'again insert a second blank cell in column i\n    End If\nNext i\n\nFor i = 1 To 8000 'loop from column 1 to last\n    If Not ws.Cells(30, i).Value = \"TimesCited\" Then 'if category is not found,\n        ws.Cells(30, i).Insert Shift:=xlDown 'insert a blank cell in column i\n        ws.Cells(30, i).Insert Shift:=xlDown 'again insert a second blank cell in column i\n    End If\nNext i\n\nFor i = 1 To 8000 'loop from column 1 to last\n    If Not ws.Cells(32, i).Value = \"Citesothers\" Then 'if category is not found,\n        ws.Cells(32, i).Insert Shift:=xlDown 'insert a blank cell in column i\n        ws.Cells(32, i).Insert Shift:=xlDown 'again insert a second blank cell in column i\n    End If\nNext i\n\nFor i = 1 To 8000 'loop from column 1 to last\n    If Not ws.Cells(34, i).Value = \"CitedReferences\" Then 'if category is not found,\n        ws.Cells(34, i).Insert Shift:=xlDown 'insert a blank cell in column i\n        ws.Cells(34, i).Insert Shift:=xlDown 'again insert a second blank cell in column i\n    End If\nNext i\n\nFor i = 1 To 8000 'loop from column 1 to last\n    If Not ws.Cells(36, i).Value = \"Citedby\" Then 'if category is not found,\n        ws.Cells(36, i).Insert Shift:=xlDown 'insert a blank cell in column i\n        ws.Cells(36, i).Insert Shift:=xlDown 'again insert a second blank cell in column i\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>However, with the bigger dataset, Excel eventually crashes, after running a while. While I have a Windows 10 64 Bit version, I only have Excel with 32 bit, as I need to work with my university's computer. Now I suspect that it might have something to do with that. However, the university does not want to reinstall the programm as 64 bit version. \nIs there anyway in which I can fix my problem through making the code easier, or breaking it up into pieces? I am very inexperienced, so I am not sure whether and if so how that would even work.\nAny help appreciated! </p>\n\n<p>Edit: Trying to get it done with arrays: </p>\n\n<pre><code>Sub dd()\nDim firstRow As Long\nDim lastRow As Long\n\nfirstRow = 1\nlastRow = 37\n\nDim tableArray() As Variant\nDim k As Long\n\nWith dataWorkbook.Worksheets(\"Sheet2\")\n\ntableArray = .Range(.Cells(firstRow, 1), _\n                            .Cells(lastRow, 8000)).Value\n\nFor k = 1 To 8000 'for each column in the table\n\nIf tableArray(4, k) = \"Author\" Then\nElse\n    ws.Cells(4, k).Insert Shift:=xlDown 'insert a blank cell in column i\n    ws.Cells(4, k).Insert Shift:=xlDown 'again insert a second blank cell in column i\n\nEnd If\n\nIf tableArray(6, k) = \"Keyword\" Then\nElse\n    ws.Cells(6, k).Insert Shift:=xlDown 'insert a blank cell in column i\n    ws.Cells(6, k).Insert Shift:=xlDown 'again insert a second blank cell in column i\n\nEnd If\n\nDim worksheetRange As Range\nSet worksheetRange = .Range(.Cells(firstRow, 1), _\n                            .Cells(lastRow, 8000))\nworksheetRange.Value = tableArray\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Edit: Loading my data into an array</p>\n\n<pre><code> Sub dynamicMultidimensionalArray()\n    Dim Chinese() As Variant\n    Dim Dimension1 As Long, dimension2 As Long\n\n    Dimension1 = Range(\"A1\").End(xlDown).Row + 1\n    dimension2 = Range(\"A1\").End(xlToRight).Column\n    ReDim Chinese(0 To Dimension1, 0 To dimension2)\n\n\n\n\n    For Dimension1 = LBound(Chinese, 1) To UBound(Chinese, 1)\n        For dimension2 = LBound(Chinese, 2) To UBound(Chinese, 2)\n            Chinese(Dimension1, dimension2) = Range(\"A1\").Offset(Dimension1, dimension2).Value\n        Next dimension2\n    Next Dimension1\n</code></pre>\n"}, {"tags": ["vba", "excel", "search", "replace"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 3, "creation_date": 1515581840, "post_id": 48185830, "comment_id": 83351429, "body": "You don&#39;t need VBA, just use Find and Replace from the sheet."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1515582094, "creation_date": 1515582094, "answer_id": 48185939, "question_id": 48185830, "link": "https://stackoverflow.com/questions/48185830/vba-delete-spaces-within-a-string/48185939#48185939", "title": "VBA delete spaces within a string", "body": "<p>Try like this:</p>\n\n<p><code>LastRowSource = 10000.</code>\nIf it works, then the problem is the way you are setting the last row. Thus, add the <code>LastRow()</code> function to your code, it should work:</p>\n\n<pre><code>LastRowSource = LastRow ws1\n\nFunction LastRow(sh As Worksheet)\n    On Error Resume Next\n    LastRow = sh.Cells.Find(What:=\"*\", _\n                            After:=sh.Range(\"A1\"), _\n                            Lookat:=xlPart, _\n                            LookIn:=xlFormulas, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Row\n    On Error GoTo 0\nEnd Function\n</code></pre>\n\n<p>Function from here - <a href=\"https://www.rondebruin.nl/win/s9/win005.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s9/win005.htm</a></p>\n"}, {"tags": [], "owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1515582135, "creation_date": 1515582135, "answer_id": 48185948, "question_id": 48185830, "link": "https://stackoverflow.com/questions/48185830/vba-delete-spaces-within-a-string/48185948#48185948", "title": "VBA delete spaces within a string", "body": "<p>If you need to do this programmatically then, recording a Macro using the Replace dialog generates this code:</p>\n\n<pre><code>Sub Macro1()\n    Selection.Replace What:=\" \", Replacement:=\"\", LookAt:=xlPart, _\n        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n        ReplaceFormat:=False\nEnd Sub\n</code></pre>\n\n<p>Substitute your range for <code>Selection</code>. You do not need to iterate each cell.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9103716"}, "edited": false, "score": 0, "creation_date": 1515582610, "post_id": 48185980, "comment_id": 83351833, "body": "how do i specify this to work on the whole worksheet? @Rory"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1515606686, "post_id": 48185980, "comment_id": 83367126, "body": "Just: <code>ws1.Cells.Replace &quot; &quot;, vbnullstring, xlpart</code>"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1515582236, "creation_date": 1515582236, "answer_id": 48185980, "question_id": 48185830, "link": "https://stackoverflow.com/questions/48185830/vba-delete-spaces-within-a-string/48185980#48185980", "title": "VBA delete spaces within a string", "body": "<p>You don't need to loop:</p>\n\n<pre><code>With ws1\n    .Range(\"B2\", .Cells(.rows.count, \"B\").End(xlUp)).Replace \" \", vbnullstring, xlpart\nEnd With\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9103716"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5471, "favorite_count": 0, "accepted_answer_id": 48185980, "answer_count": 3, "score": 0, "last_activity_date": 1515582236, "creation_date": 1515581723, "question_id": 48185830, "link": "https://stackoverflow.com/questions/48185830/vba-delete-spaces-within-a-string", "title": "VBA delete spaces within a string", "body": "<p>I want to be able to delete all of the spaces from a group of cells so that the cell contents result in just being a string of information that I want. I have come up with a code but it doesn't work and I can't figure out whether I have to use a replace function or not</p>\n\n<p>My code is:</p>\n\n<pre><code>Sub Tester()\n\nDim SearchString As String\nDim cell As Range\nDim LastRowSource As Long\nDim ws1 As Worksheet\n\nSet ws1 = ActiveWorkbook.ActiveSheet\n\nSearchString = \" \" 'look for strings containing ( )\n\nWith ws1\n\n    LastRowSource = .Cells.Find(\" \", [B2], , , xlByRows, xlPrevious).Row\n\n    For Each cell In .Range(\"B2:B\" &amp; LastRowSource)\n\n            If InStr(cell.Value, SearchString) &gt; 0 Then\n                cell.Value = Replace(\" \", \"\")\n         End If\n    Next cell\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 180, "user_id": 7888468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1dbb8c45b688f2c3eed33666db917ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Sacramento", "link": "https://stackoverflow.com/users/7888468/markus-sacramento"}, "edited": false, "score": 0, "creation_date": 1515582875, "post_id": 48185942, "comment_id": 83351967, "body": "Yes that&#180;s almost all I wanted, thanks! Two more questings though.  Is it possible to clear the cell in ColumnC so that the Dropdown is gone if I delete the value in A? I&#180;ve tried &quot;If IsEmpty(columnAcell.Value) Then columnAcell.Offset(0, 2).ClearContents&quot; but the dropdown is still there but blank.  Can I make No as standard value so it is set the moment the dropdown is created for that row?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 180, "user_id": 7888468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1dbb8c45b688f2c3eed33666db917ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Sacramento", "link": "https://stackoverflow.com/users/7888468/markus-sacramento"}, "edited": false, "score": 0, "creation_date": 1515583184, "post_id": 48185942, "comment_id": 83352154, "body": "I&#39;ve amended the code above to set the value ot No (as per Variatus). The second bit goes in the sheet module and will clear C if A is cleared. The first bit though is not dynamic so you might want to make that a similar event module."}, {"owner": {"reputation": 180, "user_id": 7888468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1dbb8c45b688f2c3eed33666db917ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Sacramento", "link": "https://stackoverflow.com/users/7888468/markus-sacramento"}, "edited": false, "score": 0, "creation_date": 1515583602, "post_id": 48185942, "comment_id": 83352375, "body": "Perfect thanks!  The only issue now is that when I deleted the last instance of value in ColumnA it place a dropdown in ColumnC Row 1 where I have the header. It doesn&#180;t mather which row I delete the value in Column A."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 180, "user_id": 7888468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1dbb8c45b688f2c3eed33666db917ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Sacramento", "link": "https://stackoverflow.com/users/7888468/markus-sacramento"}, "edited": false, "score": 0, "creation_date": 1515583765, "post_id": 48185942, "comment_id": 83352481, "body": "I&#39;m not sure I follow. Are you saying that when you delete a value in col A, it adds a dropdown in col C? Do you have any other code present?"}, {"owner": {"reputation": 180, "user_id": 7888468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1dbb8c45b688f2c3eed33666db917ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Sacramento", "link": "https://stackoverflow.com/users/7888468/markus-sacramento"}, "edited": false, "score": 0, "creation_date": 1515584142, "post_id": 48185942, "comment_id": 83352660, "body": "I updated my question with all my code. When I delete a vlue in A Col it removes the dropdown i C Col but when the last value in A Col is deleted it creates a Dropdown in C Col row 1 which is the header."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 180, "user_id": 7888468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1dbb8c45b688f2c3eed33666db917ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Sacramento", "link": "https://stackoverflow.com/users/7888468/markus-sacramento"}, "edited": false, "score": 0, "creation_date": 1515584565, "post_id": 48185942, "comment_id": 83352868, "body": "Sounds odd. Have a small change to my change event code, can you see if that makes a difference."}, {"owner": {"reputation": 180, "user_id": 7888468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1dbb8c45b688f2c3eed33666db917ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Sacramento", "link": "https://stackoverflow.com/users/7888468/markus-sacramento"}, "edited": false, "score": 0, "creation_date": 1515584868, "post_id": 48185942, "comment_id": 83353036, "body": "No sorry. It failes to remove the dropdown if I mark multiple in A Col. And Header is changed to a dropdown when I remove the last one in A Col."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 180, "user_id": 7888468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1dbb8c45b688f2c3eed33666db917ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Sacramento", "link": "https://stackoverflow.com/users/7888468/markus-sacramento"}, "edited": false, "score": 0, "creation_date": 1515584908, "post_id": 48185942, "comment_id": 83353069, "body": "Does it matter irrespective of where the last value is in column A?"}, {"owner": {"reputation": 180, "user_id": 7888468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1dbb8c45b688f2c3eed33666db917ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Sacramento", "link": "https://stackoverflow.com/users/7888468/markus-sacramento"}, "edited": false, "score": 0, "creation_date": 1515584972, "post_id": 48185942, "comment_id": 83353098, "body": "Yes no mather where the last value is in column A"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 180, "user_id": 7888468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1dbb8c45b688f2c3eed33666db917ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Sacramento", "link": "https://stackoverflow.com/users/7888468/markus-sacramento"}, "edited": false, "score": 0, "creation_date": 1515585142, "post_id": 48185942, "comment_id": 83353200, "body": "Just noticed a small typo in DVraschwab which may cause the problem (though I doubt it). Can you try (should be &lt;&gt; instead of &gt;)."}, {"owner": {"reputation": 180, "user_id": 7888468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1dbb8c45b688f2c3eed33666db917ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Sacramento", "link": "https://stackoverflow.com/users/7888468/markus-sacramento"}, "edited": false, "score": 0, "creation_date": 1515585961, "post_id": 48185942, "comment_id": 83353695, "body": "I changed to &lt;&gt; instead of &gt; here: If r.Value &lt;&gt; vbNullString Then. Still same issue. I can&#180;t remove multiple at the same time and the last one I remove changes header to a dropdown."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 180, "user_id": 7888468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1dbb8c45b688f2c3eed33666db917ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Sacramento", "link": "https://stackoverflow.com/users/7888468/markus-sacramento"}, "edited": false, "score": 0, "creation_date": 1515586143, "post_id": 48185942, "comment_id": 83353808, "body": "I&#39;ll have to look at later. In the meantime, set a breakpoint and step through the code and see if you can work out what&#39;s happening. Nothing jumps out at me."}, {"owner": {"reputation": 180, "user_id": 7888468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1dbb8c45b688f2c3eed33666db917ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Sacramento", "link": "https://stackoverflow.com/users/7888468/markus-sacramento"}, "edited": false, "score": 0, "creation_date": 1515670682, "post_id": 48185942, "comment_id": 83393268, "body": "I&#180;ve tried multipple things know and found out that even if I remove the code that it would clear C cell when A i cleared the problem occures. When I delete the last value in A it creates a dropdown list in C1. I also notised that if I change the value in the dropdown to &quot;Yes&quot; for some rows and then add more  values in A Column it will change back to &quot;No&quot;. Is it possible to add some check that if C contains value then don&#180;t overwrite?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 180, "user_id": 7888468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1dbb8c45b688f2c3eed33666db917ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Sacramento", "link": "https://stackoverflow.com/users/7888468/markus-sacramento"}, "edited": false, "score": 0, "creation_date": 1515674167, "post_id": 48185942, "comment_id": 83395350, "body": "I saw that you had accepted the answer and assumed you had sorted it. I suggest you start a new question, post all the code you have and outline the problem as above, and all steps you have taken to identify any problems, even if unsuccessful."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1515585099, "last_edit_date": 1515585099, "creation_date": 1515582098, "answer_id": 48185942, "question_id": 48185675, "link": "https://stackoverflow.com/questions/48185675/excel-vba-dropdownlist-per-row-if-value-in-acolumn/48185942#48185942", "title": "Excel VBA dropdownlist per row if value in AColumn", "body": "<p>Do you mean like this? You basically just need a loop added to your code to check column A.</p>\n\n<pre><code>    Sub DVraschwab()\n\n    Dim myList As String, r As Range\n\n    myList = \"Yes,No\"\n\n    For Each r In Range(\"A2\", Range(\"A\" &amp; Rows.Count).End(xlUp))\n        If r.Value &lt;&gt; vbNullString Then\n            With r.Offset(, 2).Validation\n                .Delete\n                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Formula1:=myList\n            End With\n            r.Offset(, 2).Value = Split(myList, \",\")(1)\n        End If\n    Next r\n\n    End Sub\n\n'this in the relevant sheet module\n\n    Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Column = 1 and target.row&gt;1 Then\n        If Target.Value = vbNullString Then\n            Target.Offset(, 2).Clear\n        End If\n    End If\n\n    End Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 180, "user_id": 7888468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1dbb8c45b688f2c3eed33666db917ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Sacramento", "link": "https://stackoverflow.com/users/7888468/markus-sacramento"}, "edited": false, "score": 0, "creation_date": 1515583301, "post_id": 48186163, "comment_id": 83352220, "body": "This one doesn&#180;t create a dropdown. Nothing happends when I ad values in A column."}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1515582792, "creation_date": 1515582792, "answer_id": 48186163, "question_id": 48185675, "link": "https://stackoverflow.com/questions/48185675/excel-vba-dropdownlist-per-row-if-value-in-acolumn/48186163#48186163", "title": "Excel VBA dropdownlist per row if value in AColumn", "body": "<p>This code will set the validation and write the default value in each cell.</p>\n\n<pre><code>Sub DVraschwab()\n    ' 10 Jan 2018\n\n    Const MyList As String = \"Yes,No\"\n\n    Dim Rl As Long, R As Long\n\n    With Worksheets(\"Duplicates\")            ' replace with your sheet's name\n        ' change column from \"A\" if not applicable\n        Rl = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        For R = 2 To Rl\n            With .Cells(R, 3).Validation\n                .Delete\n                .Add Type:=xlValidateList, _\n                     AlertStyle:=xlValidAlertStop, _\n                     Formula1:=MyList\n            End With\n            .Cells(R, 3).Value = Split(MyList, \",\")(1)\n        Next R\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 180, "user_id": 7888468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1dbb8c45b688f2c3eed33666db917ee6?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Sacramento", "link": "https://stackoverflow.com/users/7888468/markus-sacramento"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 48185942, "answer_count": 2, "score": 0, "last_activity_date": 1515585983, "creation_date": 1515581247, "last_edit_date": 1515585983, "question_id": 48185675, "link": "https://stackoverflow.com/questions/48185675/excel-vba-dropdownlist-per-row-if-value-in-acolumn", "title": "Excel VBA dropdownlist per row if value in AColumn", "body": "<p>I\u00b4ve been searching for a solution to create a dropdownlist in ColumnC (with start from row 2) if there is value in ColumnA same row.<br>\nBut all I was able to find is how to create one dropdownlist using VBA.</p>\n\n<pre><code>Sub DVraschwab()\n  Dim myList$, i%\n  myList = \"\"\n  For i = 1 To 7\n      myList = myList &amp; \"ListItem\" &amp; i &amp; \",\"\n  Next i\n  myList = Mid(myList, 1, Len(myList) - 1)\n  With Range(\"A5\").Validation\n      .Delete\n      .Add _\n      Type:=xlValidateList, _\n      AlertStyle:=xlValidAlertStop, _\n      Formula1:=myList\n  End With\nEnd Sub\n</code></pre>\n\n<p>Is this possible? And how should I begin?</p>\n\n<p>The dropdownlist should contain \"Yes\" and \"No\" and No would be standard.</p>\n\n<p>This is code that execute when I have written anythins in A Col:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n  If Intersect(Target, Me.Range(\"A:A\")) Is Nothing Then Exit Sub\n  Application.EnableEvents = False 'to prevent endless loop\n  On Error GoTo Finalize 'to re-enable the events\n\n  For Each columnAcell In Target.Cells\n      columnAcell.Offset(0, 3) = Mid(columnAcell, 2, 3)\n      If IsEmpty(columnAcell.Value) Then columnAcell.Offset(0, 4).ClearContents\n  Next\n\n  Application.ScreenUpdating = False\n\n  Dim w1 As Worksheet, w2 As Worksheet\n  Dim c As Range, FR As Variant\n\n  Set w1 = Workbooks(\"Excel VBA Test.xlsm\").Worksheets(\"AP_Input\")\n  Set w2 = Workbooks(\"Excel VBA Test.xlsm\").Worksheets(\"Datakom\")\n\n  For Each c In w1.Range(\"D2\", w1.Range(\"D\" &amp; Rows.Count).End(xlUp))\n      FR = Application.Match(c, w2.Columns(\"A\"), 0)\n      If IsNumeric(FR) Then c.Offset(, 1).Value = w2.Range(\"B\" &amp; FR).Value\n  Next c\n\n  Call Modul1.DVraschwab\n      If Target.Column = 1 Then\n      If Target.Value = vbNullString Then\n          Target.Offset(, 2).Clear\n      End If\n  End If\n\n  Finalize:\n  Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>The module I call is the dropdown you helped me with:</p>\n\n<pre><code>Sub DVraschwab()\n  Dim myList As String, r As Range\n\n  myList = \"Yes,No\"\n\n  For Each r In Range(\"A2\", Range(\"A\" &amp; Rows.Count).End(xlUp))\n      If r.Value &lt;&gt; vbNullString Then\n          With r.Offset(, 2).Validation\n              .Delete\n              .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Formula1:=myList\n          End With\n          r.Offset(, 2).Value = Split(myList, \",\")(1)\n      End If\n  Next r\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "formatting"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1515580406, "post_id": 48185265, "comment_id": 83350551, "body": "Is the 30 a fixed value or can the number of rows vary depending on certain conditions?"}, {"owner": {"reputation": 27, "user_id": 6555986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989aec4d2cc3a6f411dc25c04b07d44?s=128&d=identicon&r=PG&f=1", "display_name": "CTH", "link": "https://stackoverflow.com/users/6555986/cth"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1515580575, "post_id": 48185265, "comment_id": 83350647, "body": "It&#39;s always 30!"}, {"owner": {"reputation": 395, "user_id": 4967730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2de2164be5e2a579e3245e856694659?s=128&d=identicon&r=PG&f=1", "display_name": "Ames", "link": "https://stackoverflow.com/users/4967730/ames"}, "edited": false, "score": 0, "creation_date": 1515581139, "post_id": 48185265, "comment_id": 83350983, "body": "does it stop when it finds &quot;TRUE&quot; or &quot;FALSE&quot; or continue looking. If the first is true, why don&#39;t you color the whole thing first, then start uncolor the array from &quot;TRUE&quot; / &quot;FALSE&quot;"}, {"owner": {"reputation": 27, "user_id": 6555986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989aec4d2cc3a6f411dc25c04b07d44?s=128&d=identicon&r=PG&f=1", "display_name": "CTH", "link": "https://stackoverflow.com/users/6555986/cth"}, "edited": false, "score": 0, "creation_date": 1515581303, "post_id": 48185265, "comment_id": 83351087, "body": "It shouldn&#39;t stop when finding a case - in the array it will find hundreds of &quot;FALSE&quot; and &quot;TRUE&quot; - and it should color each and everyone one accordingly."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1515593516, "post_id": 48185265, "comment_id": 83358384, "body": "@CTH, added a fast approach via a datafield array."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 6555986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989aec4d2cc3a6f411dc25c04b07d44?s=128&d=identicon&r=PG&f=1", "display_name": "CTH", "link": "https://stackoverflow.com/users/6555986/cth"}, "edited": false, "score": 0, "creation_date": 1515580699, "post_id": 48185388, "comment_id": 83350724, "body": "This is not that helpful - as my data set is approxiately 30,000 columns x 300 rows. But thanks."}, {"owner": {"reputation": 600, "user_id": 6777125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wgsOB.jpg?s=128&g=1", "display_name": "Krunal Shah", "link": "https://stackoverflow.com/users/6777125/krunal-shah"}, "reply_to_user": {"reputation": 27, "user_id": 6555986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989aec4d2cc3a6f411dc25c04b07d44?s=128&d=identicon&r=PG&f=1", "display_name": "CTH", "link": "https://stackoverflow.com/users/6555986/cth"}, "edited": false, "score": 1, "creation_date": 1515581660, "post_id": 48185388, "comment_id": 83351307, "body": "hey @CTH ,your excel sheet contains true false value in a single column only or it can be anywhere in the sheet ? .. if its in a single column then no matter how many data u have it will work :)"}, {"owner": {"reputation": 27, "user_id": 6555986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989aec4d2cc3a6f411dc25c04b07d44?s=128&d=identicon&r=PG&f=1", "display_name": "CTH", "link": "https://stackoverflow.com/users/6555986/cth"}, "edited": false, "score": 0, "creation_date": 1515592383, "post_id": 48185388, "comment_id": 83357674, "body": "The TRUE/FALSE values are located in 5-6 different rows."}], "tags": [], "owner": {"reputation": 600, "user_id": 6777125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wgsOB.jpg?s=128&g=1", "display_name": "Krunal Shah", "link": "https://stackoverflow.com/users/6777125/krunal-shah"}, "is_accepted": false, "score": 0, "last_activity_date": 1515580424, "creation_date": 1515580424, "answer_id": 48185388, "question_id": 48185265, "link": "https://stackoverflow.com/questions/48185265/vba-excel-format-range-when-value-is-found/48185388#48185388", "title": "VBA Excel Format Range when value is found", "body": "<p>The code that I posted should only highlight cells in column B whose value is different from the corresponding cell in column A. I tested it and it worked OK.</p>\n\n<p>If you want to try conditional formatting:</p>\n\n<p>Select column B, or the part of column B that you want to colour conditionally. </p>\n\n<p>In the following, I will assume that B1 is the active cell within the selection.</p>\n\n<p>On the Home tab of the ribbon, click Conditional Formatting > New Rule...</p>\n\n<p>Select \"Use a formula to determine which cells to format\".\nEnter the formula =B1&lt;>A1</p>\n\n<p>If the active cell is not in row 1, adjust the formula accordingly. For example, if the active cell within the selection is B3, use =B3&lt;>A3</p>\n\n<p>Click Format...</p>\n\n<p>Activate the Fill tab.</p>\n\n<p>Select the desired fill colour.</p>\n\n<p>Click OK until all dialogs have closed.</p>\n\n<p>Change some values in column A and/or B to see the result.</p>\n\n<p>Refer - <a href=\"https://social.technet.microsoft.com/Forums/ie/en-US/2fffa4d8-bbba-473b-9346-5fce8f0728a8/using-vba-to-change-a-cell-colour-based-on-the-information-in-a-different-cell-excel-2010?forum=excel\" rel=\"nofollow noreferrer\">https://social.technet.microsoft.com/Forums/ie/en-US/2fffa4d8-bbba-473b-9346-5fce8f0728a8/using-vba-to-change-a-cell-colour-based-on-the-information-in-a-different-cell-excel-2010?forum=excel</a></p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 6555986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989aec4d2cc3a6f411dc25c04b07d44?s=128&d=identicon&r=PG&f=1", "display_name": "CTH", "link": "https://stackoverflow.com/users/6555986/cth"}, "edited": false, "score": 0, "creation_date": 1515581386, "post_id": 48185524, "comment_id": 83351141, "body": "It&#39;s an array of approx. 300 rows x 3000 columns. The TRUE/FALSE statement will always be in pre-defined rows, and it should always color the 30 cells directly above the statement."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1515580868, "creation_date": 1515580868, "answer_id": 48185524, "question_id": 48185265, "link": "https://stackoverflow.com/questions/48185265/vba-excel-format-range-when-value-is-found/48185524#48185524", "title": "VBA Excel Format Range when value is found", "body": "<p>First you need to check whether the row of the cell is higher than 30 and then it you can offset to change the color:</p>\n\n<p>Thus instead of this line: <code>cell.Interior.ColorIndex = cell_colour</code>\nwrite this:</p>\n\n<pre><code>If cell.Row &gt; 30 Then cell.Offset(-30, 0).Interior.ColorIndex = cell_colour\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1515584951, "last_edit_date": 1515584951, "creation_date": 1515582589, "answer_id": 48186096, "question_id": 48185265, "link": "https://stackoverflow.com/questions/48185265/vba-excel-format-range-when-value-is-found/48186096#48186096", "title": "VBA Excel Format Range when value is found", "body": "<p>I would do this with <strong><em>conditional formatting</em></strong></p>\n\n<p>Mark all your data and press \"Conditional Formatting\". Enter 2 rules with <em>Use a formula...</em>\nFirst rule is for TRUE. Assuming that you start with Col A:</p>\n\n<pre><code>=COUNTIF(A2:A31;TRUE)\n</code></pre>\n\n<p>The second rule is similar, just exchange <em>TRUE</em> by <em>FALSE</em>. Below the formula, press the \"Format\" button to set the color.</p>\n\n<p>Explanation:\nI reverted the logic: Instead of searching for TRUE/FALSE and then format the cells above, I look for every cell if it has at least one entry TRUE resp. FALSE in the next 30 cells. However, I have to admit I don't know how fast Excel can handle such a large amount of data. </p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 6555986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989aec4d2cc3a6f411dc25c04b07d44?s=128&d=identicon&r=PG&f=1", "display_name": "CTH", "link": "https://stackoverflow.com/users/6555986/cth"}, "edited": false, "score": 0, "creation_date": 1515595485, "post_id": 48186710, "comment_id": 83359792, "body": "I like this approach a lot. However, I am having problems adapting it to my needs.  If I want to specify that the range is from E5:196 and all rows to the right of this with data - how would you go about it?"}, {"owner": {"reputation": 27, "user_id": 6555986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989aec4d2cc3a6f411dc25c04b07d44?s=128&d=identicon&r=PG&f=1", "display_name": "CTH", "link": "https://stackoverflow.com/users/6555986/cth"}, "edited": false, "score": 0, "creation_date": 1515595883, "post_id": 48186710, "comment_id": 83360060, "body": "I&#39;m getting a &quot;Subscript out of range error 9&quot; message in the          If LCase(v(i, 1)) = &quot;TRUE&quot; Then     &#39; search string &quot;true&quot;  Seems like this is to due with the ranging still."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 27, "user_id": 6555986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989aec4d2cc3a6f411dc25c04b07d44?s=128&d=identicon&r=PG&f=1", "display_name": "CTH", "link": "https://stackoverflow.com/users/6555986/cth"}, "edited": false, "score": 0, "creation_date": 1515605213, "post_id": 48186710, "comment_id": 83366321, "body": "@CTH, ad) An Error 9 occurs when an array element isn&#39; t addressed within the the defined array ranges, in my tests, however, everything ran well. - So did you change or misspell above code, did you refert to <code>v(i, 1)</code> as a 2-dimensioned array (as it refers to one column only, the 2nd index value is always 1)? At which <code>i</code>value do you have issues. You could insert a temporary <code>Debug.Print &quot;i=&quot; &amp; i, &quot;array items count from &quot; &amp; LBound(v,1) &amp; &quot; To &quot; &amp; UBound(v,1)</code>  after the <code>For ...</code> loop to get the last valid index number or use an Error Handler to check that."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 27, "user_id": 6555986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989aec4d2cc3a6f411dc25c04b07d44?s=128&d=identicon&r=PG&f=1", "display_name": "CTH", "link": "https://stackoverflow.com/users/6555986/cth"}, "edited": false, "score": 0, "creation_date": 1515605576, "post_id": 48186710, "comment_id": 83366521, "body": "@CTH, by the way  the <code>LCase</code> function converts to lower case, so you would have to check for <code>If LCase(v(i, 1)) = &quot;true&quot;</code> or, using upper case <code>If UCase(v(i, 1)) = &quot;TRUE&quot;</code> to get any result. I used <code>InStr</code> to combine both search strings within one Statement."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 27, "user_id": 6555986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989aec4d2cc3a6f411dc25c04b07d44?s=128&d=identicon&r=PG&f=1", "display_name": "CTH", "link": "https://stackoverflow.com/users/6555986/cth"}, "edited": false, "score": 0, "creation_date": 1515607249, "post_id": 48186710, "comment_id": 83367449, "body": "@CTH, ad your first question in comment: if you want to get the sheet&#39;s last column number and you have titles in the first row you can use <code>ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column</code>. Then you can define a new range, - Sure you find a solution at SO or ask a new question that meets SO rules (cf. How to create a Minimal, Complete, and Verifiable example (MCVE) at <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>)"}, {"owner": {"reputation": 27, "user_id": 6555986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989aec4d2cc3a6f411dc25c04b07d44?s=128&d=identicon&r=PG&f=1", "display_name": "CTH", "link": "https://stackoverflow.com/users/6555986/cth"}, "edited": false, "score": 0, "creation_date": 1515612468, "post_id": 48186710, "comment_id": 83370124, "body": "I appreciate that this might be a very basic question - but while I may have gotten this to work, it only seems to apply to the C column (in your example).   What I am trying to do is have it search for all instances where the word TRUE or FALSE would appear. In my current setup, the words appear in rows 35, 67, 99, 131, 163 and 195.  They appear in every single column in these lines - until, say column BXR.  I&#39;m sorry to bother you again with this, but can you suggest a way to adapt to something like this?"}, {"owner": {"reputation": 27, "user_id": 6555986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989aec4d2cc3a6f411dc25c04b07d44?s=128&d=identicon&r=PG&f=1", "display_name": "CTH", "link": "https://stackoverflow.com/users/6555986/cth"}, "edited": false, "score": 0, "creation_date": 1515673328, "post_id": 48186710, "comment_id": 83394812, "body": "Hi again, I will mark this as an answer - and ask a new question to address something I can&#39;t get to work. Thanks again!"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 27, "user_id": 6555986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989aec4d2cc3a6f411dc25c04b07d44?s=128&d=identicon&r=PG&f=1", "display_name": "CTH", "link": "https://stackoverflow.com/users/6555986/cth"}, "edited": false, "score": 1, "creation_date": 1515683659, "post_id": 48186710, "comment_id": 83401583, "body": "@CTH, glad it worked. As to your question: If you want to broaden the search array, just define <code>v = ws.Range(&quot;C1:BRX&quot; &amp; n).Value</code>, insert a sub-loop <code>For j=1 to UBound(v, 2)&#39; after </code>For i=2 to n` and don&#39;t refer to <code>v(i, 1)</code>  (= only first column), but write <code>v(i, j)</code> to your condition in the next code line. See my hint above to get flexible range dimensions."}, {"owner": {"reputation": 27, "user_id": 6555986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989aec4d2cc3a6f411dc25c04b07d44?s=128&d=identicon&r=PG&f=1", "display_name": "CTH", "link": "https://stackoverflow.com/users/6555986/cth"}, "edited": false, "score": 0, "creation_date": 1515843138, "post_id": 48186710, "comment_id": 83461146, "body": "Thanks again - this was exactly what I was trying to adapt."}], "tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1515594274, "last_edit_date": 1515594274, "creation_date": 1515584559, "answer_id": 48186710, "question_id": 48185265, "link": "https://stackoverflow.com/questions/48185265/vba-excel-format-range-when-value-is-found/48186710#48186710", "title": "VBA Excel Format Range when value is found", "body": "<p><strong>Using a datafield array</strong></p>\n\n<p>Looping through a range is always time consuming; this should speed it up. </p>\n\n<p><em>Caveat:</em> Formatting single cells can maximize file size, so at least I reformat the whole column C to <code>xlColorIndexNone</code>.  </p>\n\n<pre><code>Option Explicit\n\nPublic Sub Mark30CellsAbove()\nDim ws   As Worksheet\nSet ws = ThisWorkbook.Worksheets(\"MySheet\")\nDim v    As Variant\nDim i    As Long, j As Long, n As Long, m As Long, r As Long\nDim Rng  As Range\nDim t    As Double\n' stop watch\n  t = Timer\n' get last row in column C\n  n = ws.Range(\"C\" &amp; ws.Rows.Count).End(xlUp).Row\n' get values to one based 2dim array\n  v = ws.Range(\"C1:C\" &amp; n).Value\n' clear existing colors over the WHOLE column to minimize file size\n  ws.Range(\"C:C\").Interior.ColorIndex = xlColorIndexNone\n' loop through C2:Cn and mark 30 rows before found condition\n  For i = 2 To n\n      ' check condition, find string \"true\" or \"false\"\n        If InStr(\".true.false.\", \".\" &amp; LCase(v(i, 1)) &amp; \".\") &gt; 0 Then\n\n            ' set range block - fixed rows count 30 above found cell\n            If i &lt; 32 Then      ' only in case of less than 30 rows\n               Set rng = ws.Range(\"C2:C\" &amp; (i - 1))\n            Else\n               Set rng = ws.Range(\"C\" &amp; (i - 30) &amp; \":C\" &amp; (i - 1))\n            End If\n            rng.Interior.ColorIndex = 4\n\n        End If\n  Next i\n  MsgBox \"Time needed: \" &amp; Format(Timer - t, \"0.00\") &amp; \" seconds.\"\nEnd Sub\n</code></pre>\n\n<p>Of course you could also loop within <code>If</code> - <code>EndIf</code>, just to see this slower method:</p>\n\n<pre><code>        If InStr(\".true.false.\", \".\" &amp; LCase(v(i, 1)) &amp; \".\") &gt; 0 Then\n\n            ' Always avoid to loop through a range\n            ' For j = i - 1 To i - 30 Step -1\n                ' If j &lt; 2 Then Exit For      ' optional escape if one line under title row\n                ' ws.Cells(j, 3).Interior.ColorIndex = 4\n            ' Next\n         End If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": false, "score": 0, "last_activity_date": 1515584748, "creation_date": 1515584748, "answer_id": 48186766, "question_id": 48185265, "link": "https://stackoverflow.com/questions/48185265/vba-excel-format-range-when-value-is-found/48186766#48186766", "title": "VBA Excel Format Range when value is found", "body": "<p>This may be done without VBA. You should set up two conditional formatting with formulas. First:</p>\n\n<pre><code>=COUNTIF(OFFSET(INDIRECT(ADDRESS(ROW(), COLUMN())),1,0,29,1), \"TRUE\")&gt;0\n</code></pre>\n\n<p>and the same for false. To highlight the cell you just need to use Highlight Cell Rules (the top option for CF).</p>\n"}], "owner": {"reputation": 27, "user_id": 6555986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989aec4d2cc3a6f411dc25c04b07d44?s=128&d=identicon&r=PG&f=1", "display_name": "CTH", "link": "https://stackoverflow.com/users/6555986/cth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1197, "favorite_count": 0, "accepted_answer_id": 48186710, "answer_count": 5, "score": 1, "last_activity_date": 1515594274, "creation_date": 1515580069, "last_edit_date": 1515580286, "question_id": 48185265, "link": "https://stackoverflow.com/questions/48185265/vba-excel-format-range-when-value-is-found", "title": "VBA Excel Format Range when value is found", "body": "<p>I'm trying to implement a macro that looks for the words \"TRUE\" and \"FALSE\" in a huge array of data - and then, when found, changes the color of the cells above it. </p>\n\n<p>Specifically, I would like it to color not the TRUE/FALSE-cell, but the 30 cells directly above it. This is where things get tricky... I hope someone can help.</p>\n\n<p>I've tried adapting the below code, but mostly I'm adding it as inspiration at this point. </p>\n\n<pre><code>Sub ChangeColor()\n    lRow = Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n    Set MR = Range(\"C2:C\" &amp; lRow)\n    For Each cell In MR\n        Select Case cell.Value\n            Case \"Yes\"\n                cell_colour = 4\n            Case \"y\"\n                cell_colour = 4\n            Case Else\n                cell_colour = 3\n            End Select\n        cell.Interior.ColorIndex = cell_colour\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 3, "creation_date": 1515577518, "post_id": 48184392, "comment_id": 83348628, "body": "You won&#39;t be able to. What you can do is take the output of your recording and modify it to be applicable elsewhere"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1515577862, "post_id": 48184392, "comment_id": 83348871, "body": "Why use a macro to enter that formula?  Why not just fill the formula all the way down in advance?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1515578120, "post_id": 48184392, "comment_id": 83349028, "body": "Please see <a href=\"https://stackoverflow.com/help/on-topic\">help center</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5088447, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9FMEXO_3mL0/AAAAAAAAAAI/AAAAAAAAvko/d4AjcN956L8/photo.jpg?sz=128", "display_name": "Paul", "link": "https://stackoverflow.com/users/5088447/paul"}, "is_accepted": false, "score": 0, "last_activity_date": 1540567388, "last_edit_date": 1540567388, "creation_date": 1515579252, "answer_id": 48185012, "question_id": 48184392, "link": "https://stackoverflow.com/questions/48184392/how-to-record-a-macro-in-excel-that-works-on-any-number-of-rows/48185012#48185012", "title": "How to record a macro in Excel that works on any number of rows?", "body": "<p>You might be able to do that using the <code>OFFSET()</code> formula and avoiding a macro.  </p>\n\n<pre><code>OFFSET(reference, rows, cols, [height], [width])\n</code></pre>\n\n<p>These two give the same result.  </p>\n\n<pre><code>=SUM(B2:C2)\n=SUM(OFFSET(B2,0,0,1,2))\n</code></pre>\n\n<p>You could count the rows in the table and use that to feed the height of your <code>OFFSET</code> formula. </p>\n\n<pre><code>=SUM(OFFSET(B2,0,0,1,COUNT(B:B))\n</code></pre>\n"}], "owner": {"reputation": 4743, "user_id": 1697709, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ce4707be88278549d13843ce0d95fdd9?s=128&d=identicon&r=PG", "display_name": "Gergely", "link": "https://stackoverflow.com/users/1697709/gergely"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1540567388, "creation_date": 1515577327, "last_edit_date": 1515592235, "question_id": 48184392, "link": "https://stackoverflow.com/questions/48184392/how-to-record-a-macro-in-excel-that-works-on-any-number-of-rows", "title": "How to record a macro in Excel that works on any number of rows?", "body": "<p>I have recorded a macro in Excel that sums B2 and C2 into D2. I clicked on the lower right corner of D2 to extend the computation onto all rows.</p>\n\n<p>Now, when I use this macro on other tables, it computes always the same number of rows as in the original table.</p>\n\n<p>How can I record the macro so that it recognizes the height of the table and acts accordingly?</p>\n\n<p>Is this possible without VBA programming?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1515576664, "post_id": 48184152, "comment_id": 83348049, "body": "What criteria would make it automatic? Seems to me when a cell changes and your sheet name is updated in the process, it&#39;s automatic."}, {"owner": {"reputation": 45, "user_id": 9102830, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155131652447546/picture?type=large", "display_name": "DFH", "link": "https://stackoverflow.com/users/9102830/dfh"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1515576954, "post_id": 48184152, "comment_id": 83348240, "body": "Problem is that the &quot;Private Sub Workbook_SheetChange&quot; only works when the cell input is changed by entering the cell and changing the input, however, my cells are changed based on input in other cells, hence the &quot;Private Sub Workbook_SheetChange&quot; does not recognize the change."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 9102830, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155131652447546/picture?type=large", "display_name": "DFH", "link": "https://stackoverflow.com/users/9102830/dfh"}, "edited": false, "score": 0, "creation_date": 1515594700, "post_id": 48184379, "comment_id": 83359225, "body": "Probably a stupid question: How do I add this code? As a module and call it when I run the &quot;addList&quot; macro, or?"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 45, "user_id": 9102830, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155131652447546/picture?type=large", "display_name": "DFH", "link": "https://stackoverflow.com/users/9102830/dfh"}, "edited": false, "score": 0, "creation_date": 1515595002, "post_id": 48184379, "comment_id": 83359463, "body": "This will NOT work in a standard module. You will need to put it in your sheet&#39;s object module. Easiest way to do this is by Right-Clicking the tab on your sheet then click view code."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 2, "last_activity_date": 1515577761, "last_edit_date": 1515577761, "creation_date": 1515577287, "answer_id": 48184379, "question_id": 48184152, "link": "https://stackoverflow.com/questions/48184152/automatically-change-sheet-names/48184379#48184379", "title": "Automatically change sheet names", "body": "<p>There are a few ways you can handle that. One way is to combine <code>Worksheet_Activate</code> with <code>Worksheet_Calculate</code>, and throw in a public variable.</p>\n\n<p>When you first open up your worksheet, you will automatically set the variable, and the variable will set with every change as well.</p>\n\n<pre><code>Option Explicit\n\nPublic myVar As Variant\n\nPrivate Sub Worksheet_Activate()\n\n    'Set the public variable\n    myVar = Range(\"B33\").Value\n\nEnd Sub\n\nPrivate Sub Worksheet_Calculate()\n\n    If myVar &lt;&gt; Range(\"B33\").Value Then\n        sh.Name = ...\n        myVar = Range(\"B33\")\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>You can also set the variable when you open the workbook with <code>Workbook_Open</code> as well. Really just depends on your particular needs.</p>\n"}], "owner": {"reputation": 45, "user_id": 9102830, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155131652447546/picture?type=large", "display_name": "DFH", "link": "https://stackoverflow.com/users/9102830/dfh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1515584329, "creation_date": 1515576480, "last_edit_date": 1515584329, "question_id": 48184152, "link": "https://stackoverflow.com/questions/48184152/automatically-change-sheet-names", "title": "Automatically change sheet names", "body": "<p>The following code adds/deletes sheets and inserts a list of all the sheet names while making them hyperlinks:</p>\n\n<p><a href=\"https://stackoverflow.com/a/48159499/9102830\">https://stackoverflow.com/a/48159499/9102830</a></p>\n\n<p>The following code changes the sheet name depending on several cell names:</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\nIf Target.Address(0, 0) = \"C13\" Then\n    Sh.Name = Sh.Range(\"B33\").Value + \"_\" + Sh.Range(\"C13\").Value + \"_\" + Sh.Range(\"C22\").Value + \"_N01\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>The questions are:</p>\n\n<ol>\n<li>Instead of changing when the cell input changes, can this be done automatically?</li>\n<li>Could it be a part of the \"Sub add_sheet\" code? Like, if I add a sheet, it should be named depending on the cells, and since it is copied and the cells are the same, the name will obviously be taken, in which case the name should be \"N02\" instead of \"N01\" (instead of the default \"(2)\" that Excel does). </li>\n<li>Finally, when/if the cells are changed, so that the sheet name is not equal to a previous sheet name, could it automatically go back to \"N01\"?</li>\n</ol>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1515576147, "post_id": 48183546, "comment_id": 83347678, "body": "Perhaps you could <b><i>map</i></b> the OneDrive folder so it behaves as a local drive."}, {"owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1515576343, "post_id": 48183546, "comment_id": 83347811, "body": "Is that possible to do using VBA? There will be a lot o fusers having to do it manually otherwise"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1515577299, "post_id": 48183546, "comment_id": 83348458, "body": "Should be possible, yes. The exact method would depend on your Windows version, etc, but probably the easiest way would be to figure out [with a Google search] how to map a drive letter to OneDrive via the command prompt, and then use <code>Shell</code> to execute the command if/when necessary."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1515581953, "post_id": 48183546, "comment_id": 83351494, "body": "I think your answer is here: <a href=\"https://stackoverflow.com/a/42840430/78522\">stackoverflow.com/a/42840430/78522</a> Not need to map if you can get the UNC (which is an HTTPS address)"}], "answers": [{"tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 0, "last_activity_date": 1515861626, "creation_date": 1515861626, "answer_id": 48241969, "question_id": 48183546, "link": "https://stackoverflow.com/questions/48183546/save-files-to-onedrive-using-access-vba/48241969#48241969", "title": "Save files to OneDrive using Access VBA", "body": "<p>Note that your variable <code>stFileName</code> contains the directory path not a filename, and so the <code>kill</code> expression is targeting the directory.</p>\n\n<hr>\n\n<p>However, instead of testing for and deleting the file, how about using the <code>overwrite</code> argument for the <code>CopyFile</code> method, e.g.:</p>\n\n<pre><code>Dim objFSO As New FileSystemObject\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nobjFSO.CopyFile \"C:\\Test File.txt\", \"C:\\Users\\\" &amp; Environ(\"UserName\") &amp; \"\\OneDrive - Company\", True\nSet objFSO = Nothing\n</code></pre>\n\n<p>You'll need to add a reference to Microsoft Scripting Runtime in your project to enable the <code>objFSO</code> variable in my example to be defined using early binding.</p>\n"}], "owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4778, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515861626, "creation_date": 1515574427, "question_id": 48183546, "link": "https://stackoverflow.com/questions/48183546/save-files-to-onedrive-using-access-vba", "title": "Save files to OneDrive using Access VBA", "body": "<p>Our systems are changing over to cloud storage to our personal drives will be vanishing soon, therefore I need to save save applications to users OneDrives.</p>\n\n<p>This is new territory for me and what I am reading online is not making much sense. </p>\n\n<p><strong>This is what I have so far:</strong></p>\n\n<pre><code>Set FileSystemObject = CreateObject(\"Scripting.FileSystemObject\")\nDim FileExistsbol As Boolean\nDim stFileName As String\nDim CopyFrom As String\nDim CopyTo As String\n\nstFileName = \"C:\\Users\\\" &amp; Environ(\"UserName\") &amp; \"\\OneDrive - Company\"\nstFileName = Trim(stFileName)\nFileExistsbol = dir(stFileName) &lt;&gt; vbNullString\n\nIf FileExistsbol Then\n Kill stFileName\n CopyFrom = \"C:\\Test File.txt\"\n CopyTo = \"C:\\Users\\\" &amp; Environ(\"UserName\") &amp; \"\\OneDrive - Company\"\n FileSystemObject.CopyFile CopyFrom, CopyTo\nElse\n CopyFrom = \"C:\\Test File.txt\"\n CopyTo = \"C:\\Users\\\" &amp; Environ(\"UserName\") &amp; \"\\OneDrive - Company\"\n FileSystemObject.CopyFile CopyFrom, CopyTo\nEnd If\n</code></pre>\n\n<p>This code has previously worked for copying to local drives, but believe its not working on this occasion because the new drives its trying to copy to is web based.</p>\n\n<p><strong>Error:</strong>\nNo error is actually being populated</p>\n\n<p>Any help is appreciated</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 5, "creation_date": 1515574218, "post_id": 48183441, "comment_id": 83346549, "body": "<code>copyArr</code> is <code>Nothing</code>. Even if it was not, you would not be able to assign its cells with <code>Set</code>. If you meant <code>copyArr</code> to be an array of <code>Range</code>s, declare it as an array and redim it to have dimensions. If you meant <code>copyArr</code> to be a range and assign values to individual cells of that range, assign it to a range first and then do not use <code>Set</code> when assigning cell values."}, {"owner": {"reputation": 409, "user_id": 8903456, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bbe11a345fff0041ef48da36cd75dbc2?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/8903456/max"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1515582829, "post_id": 48183441, "comment_id": 83351947, "body": "@GSerg thanks for the explanation. Making things clear now."}], "answers": [{"tags": [], "owner": {"reputation": 1131, "user_id": 5793276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13c6f48c0b69a432e49bbfc7e944ec6e?s=128&d=identicon&r=PG&f=1", "display_name": "Dr Yunke", "link": "https://stackoverflow.com/users/5793276/dr-yunke"}, "is_accepted": true, "score": 0, "last_activity_date": 1515581547, "creation_date": 1515581547, "answer_id": 48185781, "question_id": 48183441, "link": "https://stackoverflow.com/questions/48183441/vba-runtime-error-91-when-already-used-set/48185781#48185781", "title": "VBA Runtime error 91 when already used SET?", "body": "<p><code>Set</code> assigns an object reference to a variable. </p>\n\n<blockquote>\n  <p>wbworksheet2.Cells(1, lastcol)</p>\n</blockquote>\n\n<p>returns an object <code>Range</code>, not an array.</p>\n\n<p>Additionally, by your worksheets names, I am guessing you may want to copy and paste the values, so you can replace the last line with something like</p>\n\n<pre><code>   'clear any thing on clipboard to maximize available memory \n   Application.CutCopyMode = False \n\n   'copy the range from source book \n   wbkworksheet2.Cells(1, lastcol).Copy \n\n   'paste the data on the target book \n   wbkworksheet1.Range(\"A1\").PasteSpecial \n</code></pre>\n"}], "owner": {"reputation": 409, "user_id": 8903456, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bbe11a345fff0041ef48da36cd75dbc2?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/8903456/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "accepted_answer_id": 48185781, "answer_count": 1, "score": 1, "last_activity_date": 1515581547, "creation_date": 1515574007, "last_edit_date": 1515577232, "question_id": 48183441, "link": "https://stackoverflow.com/questions/48183441/vba-runtime-error-91-when-already-used-set", "title": "VBA Runtime error 91 when already used SET?", "body": "<p>I'm getting </p>\n\n<blockquote>\n  <p>Runtime Error '91': Object variable or with block variable not set</p>\n</blockquote>\n\n<p>when I already used the <code>set</code> keyword. I read this <a href=\"https://stackoverflow.com/questions/349613/what-does-the-keyword-set-actually-do-in-vba\">old post</a> that says <code>set</code> <strong>is used to assign a reference to an object</strong>. What does it really meaning?</p>\n\n<p>Also read about <a href=\"https://stackoverflow.com/questions/18927297/vba-run-time-error-91\">POST A</a> &amp; <a href=\"https://stackoverflow.com/questions/32779188/runtime-error-91-when-set-value-for-sheet-rangeaddress\">POST B</a> but no much help.</p>\n\n<pre><code>Dim strPath2 As String\nDim wbkWorkbook1 As Workbook\nDim wbkWorkbook2 As Workbook\nDim wbkWorksheet1 As Worksheet\nDim wbkworksheet2 As Worksheet\n\nDim rng As Range\nDim copyArr As Range\nDim lastcol As Integer\n\n'define paths and filenames\nstrPath = \"C:\\Users\\Account\\Desktop\\test.csv\"\n\n'open files\nSet wbkWorkbook1 = ThisWorkbook\nSet wbkWorkbook2 = Workbooks.Open(strPath)\nSet wbkWorksheet1 = wbkWorkbook1.Worksheets(\"paste\")\nSet wbkworksheet2 = wbkWorkbook2.Worksheets(\"copy\")\n\nDim i As Long\n\n'Get all columns\nWith wbkworksheet2\n    lastcol = .Cells(1, .Columns.Count).End(xlToLeft).Column\nEnd With\n\nSet copyArr(i) = wbkworksheet2.Cells(1, lastcol) ' Error\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 2397, "user_id": 9038475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7f74f49de917e716f4d679473e70f4?s=128&d=identicon&r=PG&f=1", "display_name": "Geshode", "link": "https://stackoverflow.com/users/9038475/geshode"}, "edited": false, "score": 0, "creation_date": 1515573747, "post_id": 48183346, "comment_id": 83346259, "body": "What have you tried to achieve your wanted results? What has your research concerning your problem shown? Can you provide code of your tries? <a href=\"https://stackoverflow.com/help/how-to-ask\">How do I ask a good question</a> and <a href=\"https://meta.stackoverflow.com/questions/261592/how-much-research-effort-is-expected-of-stack-overflow-users\">How much research effort is expected</a> might be helpful to improve your question."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 2, "creation_date": 1515574624, "post_id": 48183346, "comment_id": 83346830, "body": "Yes <code>Select Case</code> is probably what you are after."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 2, "creation_date": 1515574730, "post_id": 48183346, "comment_id": 83346887, "body": "And I have never seen someone indent every <code>Else If</code>. That&#39;s...interesting."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1515579981, "post_id": 48183346, "comment_id": 83350263, "body": "@John, Added a method using a datafield array which allows you to use a one liner to assign the wanted sheet name."}, {"owner": {"reputation": 73, "user_id": 9177662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/676fe695fafe582e6e14ab6ac0b98696?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9177662/john"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1515589362, "post_id": 48183346, "comment_id": 83355818, "body": "@T.M. Thanks - that looks even better as I don&#39;t need to hardcode the sheet names  - and I&#39;m guessing it&#39;s simpler code. Just need to work out how to reference a separate workbook in the code rather than &#39;ThisWorkbook&#39; - struggling with that since moving to excel Mac. Appreciate you taking the time to answer"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1515590706, "post_id": 48183346, "comment_id": 83356604, "body": "Use <code>Workbooks</code>(index), where <i>index</i> is the workbook name (or index number), to return a single Workbook object. You have to use <code>Set</code> for assigning it to an object variable, e.g. <code>Dim oWb As Workbook</code> and <code>Set oWb = Workbooks(&quot;MyWorkbookName&quot;)</code>; then you get the workbook name via <code>oWb.Name</code>. See MS help at <a href=\"https://msdn.microsoft.com/en-us/library/office/aa224504(v=office.11).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>  - <i>Attention</i>: don&#39;t confound WorkBook as type and the <code>Workbooks</code> property."}, {"owner": {"reputation": 73, "user_id": 9177662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/676fe695fafe582e6e14ab6ac0b98696?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9177662/john"}, "edited": false, "score": 0, "creation_date": 1515601521, "post_id": 48183346, "comment_id": 83364088, "body": "That&#39;s perfect. Thanks for your help."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 9177662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/676fe695fafe582e6e14ab6ac0b98696?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9177662/john"}, "edited": false, "score": 0, "creation_date": 1515576237, "post_id": 48183708, "comment_id": 83347734, "body": "Thanks - really appreciated."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 3, "last_activity_date": 1515575862, "last_edit_date": 1515575862, "creation_date": 1515575049, "answer_id": 48183708, "question_id": 48183346, "link": "https://stackoverflow.com/questions/48183346/streamline-if-statements/48183708#48183708", "title": "Streamline if statements", "body": "<p>When you are comparing multiple options to a single variant (in your case <code>a</code>), it is much simpler while also improving readability by using <code>Select Case</code> rather than <code>If...Then</code>.</p>\n\n<p>Take a look:</p>\n\n<pre><code>Sub test()\n\n    Select Case a\n        Case 1\n            SheetName = \"E0\"\n        Case 2\n            SheetName = \"E1\"\n        Case 3\n            SheetName = \"E2\"\n        Case 4\n            SheetName = \"E3\"\n        Case 5\n            SheetName = \"EC\"\n        Case 6\n            SheetName = \"SC0\"\n        Case 7\n            SheetName = \"SC1\"\n        Case 8\n            SheetName = \"SC2\"\n        Case 9\n            SheetName = \"SC3\"\n        Case 10\n            SheetName = \"D1\"\n        Case 11\n            SheetName = \"D2\"\n        Case 12\n            SheetName = \"SP1\"\n        Case 13\n            SheetName = \"SP2\"\n        Case 14\n            SheetName = \"I1\"\n        Case 15\n            SheetName = \"I2\"\n        Case 16\n            SheetName = \"F1\"\n        Case 17\n            SheetName = \"F2\"\n        Case 18\n            SheetName = \"N1\"\n        Case 19\n            SheetName = \"B1\"\n        Case 20\n            SheetName = \"P1\"\n        Case 21\n            SheetName = \"T1\"\n        Case 22\n            SheetName = \"G1\"\n    End Select\n\nEnd Sub\n</code></pre>\n\n<p>I should probably add that <code>Select Case</code> can also be used in this syntax as well <em>(wouldn't work in your instance, but something to keep in mind in the future)</em>:</p>\n\n<pre><code>Select Case a\n    Case 1 To 5\n        sheetname = \"E0\"\n    Case 6, 8 To 9\n        sheetname = \"E1\"\n    Case 7\n        sheetname = \"E2\"\n    Case Else\n        sheetname = \"Blah\"\nEnd Select\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": true, "score": 2, "last_activity_date": 1515579752, "creation_date": 1515579752, "answer_id": 48185163, "question_id": 48183346, "link": "https://stackoverflow.com/questions/48183346/streamline-if-statements/48185163#48185163", "title": "Streamline if statements", "body": "<p><strong>No <code>If</code> or <code>Case</code> needed using a datafield array</strong></p>\n\n<p>You could store all your sheet names listed in a work sheet to a one based 2-dim datafield array. This allows you to get the nth sheetname by one code line: <code>SheetName = v(n, 1)</code> (or <code>SheetName = v(a, 1)</code> as in your example). </p>\n\n<pre><code>Sub test()\nDim a         As Integer\nDim sheetname As String\nDim v         ' variant, receives 2-dim data field contents\nDim ws As Worksheet\nSet ws = ThisWorkbook.Worksheets(\"MySheetNameList\") ' &lt;&lt; change to sheet where you store your sheet names\n' create one based 2-dim datafield array from your sheetname list\n' (assuming start in cell A2, omitting title row)\n  v = ws.Range(\"A2:A\" &amp; ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row)\n' ... example value for a\n  a = 22\n' assign sheet name avoiding any IF, CASE or SWITCH\n  sheetname = v(a, 1)       ' get e.g. 22nd item (\n  Debug.Print a, sheetname\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 9177662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/676fe695fafe582e6e14ab6ac0b98696?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9177662/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 48185163, "answer_count": 2, "score": 1, "last_activity_date": 1593675496, "creation_date": 1515573684, "last_edit_date": 1593675496, "question_id": 48183346, "link": "https://stackoverflow.com/questions/48183346/streamline-if-statements", "title": "Streamline if statements", "body": "<p>I have several if statements ike the one below. Am assuming that this is a really bad/ long handed way of coding but not sure what I should be doing differently. Anyone got any suggestions?</p>\n\n<p>Thanks </p>\n\n<pre><code>For a = 1 To Leagues\n     If a = 1 Then\n    SheetName = \"E0\"\n    ElseIf a = 2 Then\n        SheetName = \"E1\"\n     ElseIf a = 3 Then\n        SheetName = \"E2\"\n      ElseIf a = 4 Then\n        SheetName = \"E3\"\n       ElseIf a = 5 Then\n        SheetName = \"EC\"\n        ElseIf a = 6 Then\n            SheetName = \"SC0\"\n         ElseIf a = 7 Then\n            SheetName = \"SC1\"\n          ElseIf a = 8 Then\n            SheetName = \"SC2\"\n           ElseIf a = 9 Then\n            SheetName = \"SC3\"\n            ElseIf a = 10 Then\n                SheetName = \"D1\"\n             ElseIf a = 11 Then\n                SheetName = \"D2\"\n              ElseIf a = 12 Then\n                SheetName = \"SP1\"\n               ElseIf a = 13 Then\n                SheetName = \"SP2\"\n                ElseIf a = 14 Then\n                    SheetName = \"I1\"\n                 ElseIf a = 15 Then\n                    SheetName = \"I2\"\n                  ElseIf a = 16 Then\n                    SheetName = \"F1\"\n                   ElseIf a = 17 Then\n                    SheetName = \"F2\"\n                    ElseIf a = 18 Then\n                        SheetName = \"N1\"\n                     ElseIf a = 19 Then\n                        SheetName = \"B1\"\n                      ElseIf a = 20 Then\n                        SheetName = \"P1\"\n                       ElseIf a = 21 Then\n                        SheetName = \"T1\"\n                        ElseIf a = 22 Then\n                        SheetName = \"G1\"\n    End If\n</code></pre>\n"}, {"tags": ["vba", "excel", "find"], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 8861443, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3e2672bda4638b69d413e68a34fbf350?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick S", "link": "https://stackoverflow.com/users/8861443/patrick-s"}, "edited": false, "score": 0, "creation_date": 1515574684, "post_id": 48183493, "comment_id": 83346864, "body": "With the last statement you gave me, <code>cl = Left(cl, Len(cl)-1)</code> this codeline, will delete the last character, I assume? Just a quick bonus question, I would like to know, if so I can search for if the last characters in a cell is a letter, then delete all of the letters on the end, even if there\u2019s more than one :)"}, {"owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "reply_to_user": {"reputation": 155, "user_id": 8861443, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3e2672bda4638b69d413e68a34fbf350?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick S", "link": "https://stackoverflow.com/users/8861443/patrick-s"}, "edited": false, "score": 0, "creation_date": 1515575627, "post_id": 48183493, "comment_id": 83347363, "body": "To check if the character is a letter, you may use AscW function. It returns between 65 and 122 if the argument is a letter of standard Latin charset."}, {"owner": {"reputation": 132, "user_id": 8988624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c37c08fab3084b272ef09fdfe48d72a3?s=128&d=identicon&r=PG", "display_name": "prextor", "link": "https://stackoverflow.com/users/8988624/prextor"}, "reply_to_user": {"reputation": 155, "user_id": 8861443, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3e2672bda4638b69d413e68a34fbf350?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick S", "link": "https://stackoverflow.com/users/8861443/patrick-s"}, "edited": false, "score": 0, "creation_date": 1515576329, "post_id": 48183493, "comment_id": 83347797, "body": "@PatrickS: If you have several letters at the end, you will need a loop through the string in the cell and use the AscW function, to check if the current letter is a letter or number. In this case, you might want to consider the <code>MID</code>, <code>LEFT</code> and <code>RIGHT</code> functions as well as <code>LEN</code> (which is already shown in MarcinSzaleniec answer). You need to adjust the if statement as well."}, {"owner": {"reputation": 155, "user_id": 8861443, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3e2672bda4638b69d413e68a34fbf350?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick S", "link": "https://stackoverflow.com/users/8861443/patrick-s"}, "reply_to_user": {"reputation": 132, "user_id": 8988624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c37c08fab3084b272ef09fdfe48d72a3?s=128&d=identicon&r=PG", "display_name": "prextor", "link": "https://stackoverflow.com/users/8988624/prextor"}, "edited": false, "score": 0, "creation_date": 1515582294, "post_id": 48183493, "comment_id": 83351671, "body": "@Prextor Ah, okay... Then it sounds like the answer of MarcinSzaleniec is the &quot;easiest&quot; way after all :)"}], "tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": false, "score": 0, "last_activity_date": 1515574215, "creation_date": 1515574215, "answer_id": 48183493, "question_id": 48183292, "link": "https://stackoverflow.com/questions/48183292/excel-vba-to-sum-up-a-based-on-almost-the-same-description/48183493#48183493", "title": "Excel VBA to sum up a based on almost the same description", "body": "<p>To find values with the letter on the end:</p>\n\n<pre><code>Dim rng as Range\ndim cl as Range\n\nset rng = /define your column with data here/\nfor each cl in rng\nIf Right(cl, 1) = \"A\" Or Right(cl, 1) =\"B\" Then\n    'Do whatever you want to\nEnd If\n</code></pre>\n\n<p>In place of the comment inside the loop you could delete the last character:</p>\n\n<pre><code>cl = Left(cl, Len(cl)-1))\n</code></pre>\n\n<p>and then, in the next step, sum or delete, as you wish. </p>\n"}], "owner": {"reputation": 155, "user_id": 8861443, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3e2672bda4638b69d413e68a34fbf350?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick S", "link": "https://stackoverflow.com/users/8861443/patrick-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515574215, "creation_date": 1515573466, "question_id": 48183292, "link": "https://stackoverflow.com/questions/48183292/excel-vba-to-sum-up-a-based-on-almost-the-same-description", "title": "Excel VBA to sum up a based on almost the same description", "body": "<p><strong>My issue:</strong></p>\n\n<p>I have some data, whereas the base of the value is the same, but in the end, it could be somethign else, like:</p>\n\n<p>V573589<br>\nV574695<br>\nV574695A<br>\nV574695B</p>\n\n<p><strong>Goal:</strong></p>\n\n<p>I want a macro to identify, when it finds either \"A\" or \"B\" in the end of the cell, and delete the \"A\" and \"B\" in the end. On top of that, I want it to either delete the first rows with the value same description, or it could sum the 3 values.</p>\n\n<p>At the moment I have tried with .Find(\"B\",Lookat:=xlPart)... But without any luck :(</p>\n"}, {"tags": ["vba", "excel", "formula"], "comments": [{"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1515573773, "post_id": 48183252, "comment_id": 83346279, "body": "I think a screenshot of the data set and giving a clearer view of what you&#39;re inputting into your UDF variables and what you&#39;re expecting to output would be helpful."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1515574145, "post_id": 48183252, "comment_id": 83346515, "body": "This looks more like a helper function than  udf to return a unique list. Clarify your situation with sample data together with expected results. <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 31, "user_id": 8103280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a1dff8c8fa9cef7fb9c4bc9fd2c7811?s=128&d=identicon&r=PG&f=1", "display_name": "HammerUser", "link": "https://stackoverflow.com/users/8103280/hammeruser"}, "edited": false, "score": 0, "creation_date": 1515575081, "post_id": 48183252, "comment_id": 83347052, "body": "i added some clarification, if you have better solution don&#39;t hesitate to post easier one (i&#39;m vba noob)"}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1515574874, "creation_date": 1515574874, "answer_id": 48183659, "question_id": 48183252, "link": "https://stackoverflow.com/questions/48183252/vba-excel-function-find-all-unique-values-and-put-in-one/48183659#48183659", "title": "vba excel function find all unique values and put in one", "body": "<p>You can check if it <code>Contains</code> the value.  </p>\n\n<p>I don't know what your arguments do so I created a sample function instead. \nObviously this will need updating to suit your needs. </p>\n\n<pre><code>Sub Test1()\n\n    Debug.Print ALookUps\n\nEnd Sub\n\nPublic Function ALookUps() As String\n\n    Dim rng As Range, rCell As Range\n\n    Set rng = Sheet1.Range(\"A1:A10\")\n\n    With CreateObject(\"System.Collections.ArrayList\")\n        For Each rCell In rng\n            If Not .contains(rCell.Value) Then\n                .Add rCell.Value\n            End If\n        Next rCell\n\n        If .Count &gt; 0 Then\n            .Sort\n            ALookUps = Join(.toarray, vbCrLf)\n        End If\n    End With\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8103280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a1dff8c8fa9cef7fb9c4bc9fd2c7811?s=128&d=identicon&r=PG&f=1", "display_name": "HammerUser", "link": "https://stackoverflow.com/users/8103280/hammeruser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 1, "accepted_answer_id": 48183659, "answer_count": 1, "score": 1, "last_activity_date": 1515578702, "creation_date": 1515573300, "last_edit_date": 1515578702, "question_id": 48183252, "link": "https://stackoverflow.com/questions/48183252/vba-excel-function-find-all-unique-values-and-put-in-one", "title": "vba excel function find all unique values and put in one", "body": "<p>I have code that find all values, sorts then put it one cell, but i have no idea how to remove duplicates.</p>\n\n<pre><code>Public Function ALookUps(ByVal myVal, Rng As Range, ByVal ref As Long) As String\nDim a, i As Long\na = Rng.Value\nWith CreateObject(\"System.Collections.ArrayList\")\n    For i = 1 To UBound(a, 1)\n        If a(i, 1) = myVal Then .Add a(i, ref) 'the linie i tried change\n    Next\n    If .Count &gt; 0 Then .Sort: ALookUps = Join(.ToArray, vbCrLf)\nEnd With\nEnd Function\n</code></pre>\n\n<p>I did tray to add another condition, but it gave me error :</p>\n\n<pre><code>If (a(i, 1) = myVal And (a(i, ref) &lt;&gt; a(i - 1, ref))) Then .Add a(i, ref)\n</code></pre>\n\n<p>could you tell me what i did wrong and how to fix it?</p>\n\n<p>What I'm trying to do:\nI have a table with multiple values, and different parameter(already a pivot) and i need to connect them based on key world in another table.\nSo i try to do</p>\n\n<p>Look up in table for input value (a) create  array/list of unique values and put this to one cell with specific separator.</p>\n\n<p>I fonud other function, i put in another column. Can this be combined in one function?</p>\n\n<pre><code>Public Function UniqueParts(separator As String, toParse As String) As String\nDim d As New Scripting.Dictionary, part As Variant, i As Integer\nFor Each part In Split(toParse, separator)\n    d(part) = 1\nNext\nUniqueParts = Join(d.Keys, separator)\nEnd Function\n</code></pre>\n\n<p>i</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31, "user_id": 3718445, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/QyytR.png?s=128&g=1", "display_name": "Amir", "link": "https://stackoverflow.com/users/3718445/amir"}, "edited": false, "score": 0, "creation_date": 1515572667, "post_id": 48183083, "comment_id": 83345685, "body": "I asked my question here:  <a href=\"https://www.mrexcel.com/forum/excel-questions/1037840-change-cell-format-within-functions.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>  but I didn&#39;t get my answer"}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1515573019, "post_id": 48183083, "comment_id": 83345870, "body": "You cannot change cell format by using function."}, {"owner": {"reputation": 31, "user_id": 3718445, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/QyytR.png?s=128&g=1", "display_name": "Amir", "link": "https://stackoverflow.com/users/3718445/amir"}, "reply_to_user": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1515576488, "post_id": 48183083, "comment_id": 83347919, "body": "is there any library to do this?"}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1515577269, "post_id": 48183083, "comment_id": 83348429, "body": "You can format the cell using standard functionality to suit your needs. Can you explain the trouble you are facing currently?"}, {"owner": {"reputation": 31, "user_id": 3718445, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/QyytR.png?s=128&g=1", "display_name": "Amir", "link": "https://stackoverflow.com/users/3718445/amir"}, "reply_to_user": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1515577522, "post_id": 48183083, "comment_id": 83348632, "body": "I explained in next comment. <code>if my function return string I can&#39;t use my date normally. for example I can&#39;t use date filter or I can&#39;t add or subtract some days to it</code>"}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1515578375, "post_id": 48183083, "comment_id": 83349215, "body": "You will have to use a sheet based event like <code>Worksheet_Change</code> to handle formatting perhaps then."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 3718445, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/QyytR.png?s=128&g=1", "display_name": "Amir", "link": "https://stackoverflow.com/users/3718445/amir"}, "edited": false, "score": 0, "creation_date": 1515576231, "post_id": 48183173, "comment_id": 83347731, "body": "thanks but if my function return string I can&#39;t use my date normally. for example I can&#39;t use date filter or I can&#39;t add or subtract some days to it"}], "tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": false, "score": 0, "last_activity_date": 1515572995, "creation_date": 1515572995, "answer_id": 48183173, "question_id": 48183083, "link": "https://stackoverflow.com/questions/48183083/change-cell-format-within-functions-in-excel-vba/48183173#48183173", "title": "change cell format within functions in excel VBA", "body": "<p>You cannot change format of the cell with the function. You either need a subroutine or function that returns string. For instance:</p>\n\n<pre><code>Function ggg(rng As Range) As String\n    ggg = Format(rng.Value, \"yyyy-mm-dd\")\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 3718445, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/QyytR.png?s=128&g=1", "display_name": "Amir", "link": "https://stackoverflow.com/users/3718445/amir"}, "edited": false, "score": 0, "creation_date": 1515601685, "post_id": 48185177, "comment_id": 83364194, "body": "thanks but I don&#39;t have right to add code out of modules"}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "reply_to_user": {"reputation": 31, "user_id": 3718445, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/QyytR.png?s=128&g=1", "display_name": "Amir", "link": "https://stackoverflow.com/users/3718445/amir"}, "edited": false, "score": 0, "creation_date": 1515648390, "post_id": 48185177, "comment_id": 83381570, "body": "@amiroo I do not understand your comment but that is what I could think of. Hopefully, someone else will be able to help you."}], "tags": [], "owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "is_accepted": false, "score": 0, "last_activity_date": 1515579779, "creation_date": 1515579779, "answer_id": 48185177, "question_id": 48183083, "link": "https://stackoverflow.com/questions/48183083/change-cell-format-within-functions-in-excel-vba/48185177#48185177", "title": "change cell format within functions in excel VBA", "body": "<p>Right click on the sheet tab and choose \"View Code\". Paste below provided code.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim cel As Range\n    For Each cel In Target.Cells\n        If cel.HasFormula And (InStr(1, cel.Formula, \"=ggg(\", vbTextCompare) = 1) Then\n            cel.NumberFormat = \"dd-mm-yyyy\"\n        End If\n    Next cel\nEnd Sub\n</code></pre>\n\n<p>And see if it helps your cause or not!</p>\n"}], "owner": {"reputation": 31, "user_id": 3718445, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/QyytR.png?s=128&g=1", "display_name": "Amir", "link": "https://stackoverflow.com/users/3718445/amir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 594, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1515579779, "creation_date": 1515572614, "question_id": 48183083, "link": "https://stackoverflow.com/questions/48183083/change-cell-format-within-functions-in-excel-vba", "title": "change cell format within functions in excel VBA", "body": "<p>I wrote a function in excel vba. return value of the function is date, but function just return value of date in cell</p>\n\n<p>how can I change format of cell to date (short date is preferred) </p>\n\n<p>this is my code</p>\n\n<pre><code>Function ggg(rng As Range) As Date\nggg = rng.value - 466699\nggg = CDate(ggg)\nEnd Function\n</code></pre>\n"}, {"tags": ["string", "excel", "vba"], "comments": [{"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1515573246, "post_id": 48183061, "comment_id": 83345974, "body": "You say the last six characters don&#39;t differ. So you&#39;re always going to want to select <code>\u2019</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 1, "last_activity_date": 1515573288, "last_edit_date": 1515573288, "creation_date": 1515572770, "answer_id": 48183122, "question_id": 48183061, "link": "https://stackoverflow.com/questions/48183061/selecting-a-specific-character-from-a-vba-string/48183122#48183122", "title": "Selecting a specific character from a VBA string", "body": "<pre><code>Sub test()\n\n    Dim myStr As String\n\n    myStr = \"A = 1/2\"\" NPT\"\n\n    myStr = Split(myStr, \"\"\"\")(0)\n    myStr = Split(myStr, \"= \")(1)\n\n    MsgBox myStr\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9197229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1496d79a1b38ee7a1ef9a424a507a958?s=128&d=identicon&r=PG&f=1", "display_name": "Remips", "link": "https://stackoverflow.com/users/9197229/remips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 48183122, "answer_count": 1, "score": 0, "last_activity_date": 1515573288, "creation_date": 1515572529, "last_edit_date": 1531164843, "question_id": 48183061, "link": "https://stackoverflow.com/questions/48183061/selecting-a-specific-character-from-a-vba-string", "title": "Selecting a specific character from a VBA string", "body": "<p>How do I select a specific character from a string in VBA? The strings first characters always differ but the last 6 does not. </p>\n\n<p>Say the string is: A = 1/2\u2019\u2019 NPT</p>\n\n<p>Here I would like to get the \u2018 closest to 2.</p>\n\n<p>If the string is: A = 1-1/2\u2019\u2019 NPT </p>\n\n<p>I would still want the \u2018 closest to 2.</p>\n\n<p>Any help would be appreciated!\n- Remi</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1515572530, "post_id": 48183020, "comment_id": 83345617, "body": "What error do you get and in which line?"}, {"owner": {"reputation": 133, "user_id": 8674336, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/e98e54e12ecc096c09664a2785312cfc?s=128&d=identicon&r=PG&f=1", "display_name": "saurabh255", "link": "https://stackoverflow.com/users/8674336/saurabh255"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1515572595, "post_id": 48183020, "comment_id": 83345647, "body": "i got error here onwards- N = Sheets(&quot;EXR_extract_EX&quot;).Cells(Rows.Count, &quot;A:AU&quot;).End(xlUp).Row   Set r1 = Sheets(&quot;EXR_extract_EX&quot;).Range(&quot;A:AU&quot; &amp; N)      --object  defined error.  @Peh"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1515572812, "post_id": 48183020, "comment_id": 83345754, "body": "<code>Range(&quot;A:AU&quot; &amp; N)</code> is not a valid range it should be either <code>Range(&quot;A:AU&quot;)</code> for the full column or something like <code>Range(&quot;A&quot; &amp; N &amp; &quot;:AU&quot; &amp; N)</code>. I also recommend to use the full file path in <code>Workbooks.Open</code> and specify the workbook for Sheets otherwise you will run into issues. Also the <code>UnattendedData.xlsm</code> doesn&#39;t need to be opened, because this is already opened as you run the code from this file as you wrote."}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1515580833, "last_edit_date": 1515580833, "creation_date": 1515573623, "answer_id": 48183324, "question_id": 48183020, "link": "https://stackoverflow.com/questions/48183020/how-to-copy-all-column-data-from-one-excel-to-another-excel-sheet/48183324#48183324", "title": "How to copy all column data from one excel to another excel sheet", "body": "<ol>\n<li>You don'n need to open <code>UnattendedData.xlsm</code>. If this is the workbook you run the code from it is already opened.</li>\n<li>Use the full path for <code>Workbooks.Open</code> otherwise you will run into issues.</li>\n<li>Use <code>Worksheets</code> instead of <code>Sheets</code> whenever possible. <code>Sheets</code> also contains charts etc.</li>\n<li>If you use <code>Worksheets</code> or <code>Sheets</code> always specify the workbook like <code>wb.Worksheets(\u2026)</code>. Otherwise Excel guesses a workbook and might fail.</li>\n</ol>\n\n<p>The actual issue in your code is that <code>Range(\"A:AU\" &amp; N)</code> is no valid range. E.g. for <code>N=15</code> this results in <code>\"A:AU15\"</code> which is invalid. It should be either <code>\"A15:AU15\"</code> or <code>\"A:AU\"</code>.</p>\n\n<p>I doubt there is a big advantage in performance using one or the other if the rest of the column is empty anyway, so I would just copy the whole columns.</p>\n\n<hr>\n\n<p>Example:</p>\n\n<pre><code>Option Explicit 'make sure all variables have to be declared correctly\n\nPublic Sub CopyRanges()\n    Dim wb As Workbook\n    Set wb = Workbooks.Open(\"C:\\YOUR_FULL_PATH_HERE\\01_Tool\\Data\\EXRData_08.01.2018.xlsx\")\n\n    Dim shtSource As Worksheet\n    Set shtSource = wb.Worksheets(\"EXR_extract_EX\")\n                   '^-- Always specify a wb for a sheet\n\n    Dim shtDestination As Worksheet\n    Set shtDestination = ThisWorkbook.Worksheets(\"RawData\")\n                         '^-- here we specify the workbook we are running  the code in\n    'copy the ranges\n    shtSource.Range(\"A:AU\").Copy shtDestination.Range(\"A:AU\")\n\n    wb.Close SaveChanges:=False 'don't forget to close the workbook\nEnd Sub\n</code></pre>\n\n<p>Note that if you need the path relative to the path of <code>ThisWorkbook</code> you can use something like</p>\n\n<pre><code>ThisWorkbook.Path &amp; \"\\01_Tool\\Data\\EXRData_08.01.2018.xlsx\"\n</code></pre>\n\n<p>If it is in the same base path but different sub folders you could walk backwards with <code>\\..\\</code> to get out of the subfolders like </p>\n\n<pre><code>ThisWorkbook.Path &amp; \"\\..\\..\\01_Tool\\Data\\EXRData_08.01.2018.xlsx\"\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 8674336, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/e98e54e12ecc096c09664a2785312cfc?s=128&d=identicon&r=PG&f=1", "display_name": "saurabh255", "link": "https://stackoverflow.com/users/8674336/saurabh255"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 48183324, "answer_count": 1, "score": 0, "last_activity_date": 1515580833, "creation_date": 1515572350, "last_edit_date": 1515572453, "question_id": 48183020, "link": "https://stackoverflow.com/questions/48183020/how-to-copy-all-column-data-from-one-excel-to-another-excel-sheet", "title": "How to copy all column data from one excel to another excel sheet", "body": "<p>I am trying to copy all column data from column <strong>range A:AU</strong> of one excel to another excel in same range of column <strong>A:AU</strong> in which i have written the code .</p>\n\n<p>Both excel are placed at different locations in my computer and i have written my vba code in the excel where i want to paste data,  not in the excel from where i am copying the data.</p>\n\n<p>name of excel from where i am copying the data is <strong>\"EXRData_08.01.2018.xlsx\"</strong>  and sheet name is <strong>\"EXR_extract_EX\"</strong></p>\n\n<p>&amp; the name of excel where i want to paste the data and where i have written my vba code is <strong>\"UnattendedData.xlsm\"</strong> and sheet name is <strong>\"RawData\"</strong> .</p>\n\n<p>I am trying to copy entire column content from <strong>range A:AU</strong> from first excel and paste it into same <strong>range of A:AU</strong> in another excel where code is present but i am getting error and it is not running . kindly help me regarding this.</p>\n\n<p>below is my code-</p>\n\n<pre><code>Sub panos()\n  Dim r1 As Range, r2 As Range, N As Long\n\n  Workbooks.Open \"\\01_Tool\\Data\\EXRData_08.01.2018.xlsx\"\n  N = Sheets(\"EXR_extract_EX\").Cells(Rows.Count, \"A:AU\").End(xlUp).Row\n  Set r1 = Sheets(\"EXR_extract_EX\").Range(\"A:AU\" &amp; N)\n\n  Workbooks.Open \"_Master\\Saurabh\\UnattendedData.xlsm\"\n  Set r2 = Sheets(\"RawData\").Range(\"A:AU\")\n\n  r1.Copy r2\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 1, "last_activity_date": 1515573685, "last_edit_date": 1515573685, "creation_date": 1515573287, "answer_id": 48183245, "question_id": 48182872, "link": "https://stackoverflow.com/questions/48182872/need-a-method-for-storing-obscenely-long-numbers-in-number-format-not-scientifi/48183245#48183245", "title": "Need a method for storing obscenely long numbers in number format (not scientific)", "body": "<p>You can achieve that <strong>specific</strong> calculation using <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/decimal-data-type\" rel=\"nofollow noreferrer\"><code>Decimal</code></a> data types and a modification to the calculation routine:</p>\n\n<pre><code>Private Sub Cmd_Click()\n\n Dim bits As Integer\n Dim out As Variant\n Dim i As Long\n bits = 64\n out = CDec(1)\n For i = 1 to bits - 1\n     out = out * 2\n Next\n\n Txt_Output.Value = out\n\nEnd Sub\n</code></pre>\n\n<p>By forcing <code>out</code> to be a <code>Variant/Decimal</code>, the calculation does not lose precision as it is being calculated.  However some things, such as <code>CDec(2) ^ CDec(63)</code> would still lose precision as the calculation would be done using an intermediate <code>Double</code> precision, so you will need to be very careful as to what calculations you do.</p>\n\n<p>This might give you clues as to how to generalise that method to achieve what you need.</p>\n\n<p>If you have 64-bit Excel, you can use the <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/longlong-data-type\" rel=\"nofollow noreferrer\">LongLong</a> data type.</p>\n"}], "owner": {"reputation": 11, "user_id": 8578628, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PHFZb.jpg?s=128&g=1", "display_name": "Michael Reichel", "link": "https://stackoverflow.com/users/8578628/michael-reichel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1515585678, "creation_date": 1515571792, "last_edit_date": 1515585678, "question_id": 48182872, "link": "https://stackoverflow.com/questions/48182872/need-a-method-for-storing-obscenely-long-numbers-in-number-format-not-scientifi", "title": "Need a method for storing obscenely long numbers in number format (not scientific)", "body": "<p>How would I go about storing a very large number in number format and not scientific.<br>\nPlease bear in mind that the number I will be storing is too big for the <strong>Long</strong> data type.<br>\nI've set it as a <strong>String</strong>.<br>\nI have a userform with a command button and a textbox.\nBelow is the sample code:</p>\n\n<pre><code>Private Sub Cmd_Click()\n\n Dim bits As Integer\n Dim out As String\n\n bits = 64\n out = 2 ^ (bits - 1)\n\n Txt_Output.Value = out\n\nEnd Sub\n</code></pre>\n\n<p>The above will return: 9.22337203685478E+18.\nBut I want 9223372036854775807.<br>\nCan anyone explain how to avoid this?  </p>\n\n<p>Thanks in advance.    </p>\n\n<p><em>P.S. I'm hoping to avoid having to use an array.</em></p>\n"}, {"tags": ["vba", "excel", "row"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1515570017, "post_id": 48182337, "comment_id": 83344423, "body": "That looks great!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1515570034, "post_id": 48182337, "comment_id": 83344435, "body": "@Jeeped of course you are correct it was too early :( corrected it."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1515570206, "last_edit_date": 1515570206, "creation_date": 1515569458, "answer_id": 48182337, "question_id": 48182221, "link": "https://stackoverflow.com/questions/48182221/store-a-cells-value-to-a-new-row-in-a-specific-column-every-time-that-cell-chan/48182337#48182337", "title": "Store a cell&#39;s value to a new row in a specific column every time that cell changes", "body": "<p>You just need to check if the changed cell is C5 and if so then find the last used cell in column A and write the value below:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Address = \"$C$5\" Then 'check if changed cell is C5\n        Dim lRow As Long\n        lRow = Range(\"A\" &amp; Cells.Rows.Count).End(xlUp).Row 'find last used row in column A\n\n        Application.EnableEvents = False 'prevent triggering another change event\n        Cells(lRow + 1, \"A\").Value = Target.Value 'write value in column A\n        Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>Note that I added a <code>Application.EnableEvents = False</code> to prevent triggering another <code>Change</code> event by adding the value to column A.</p>\n\n<p><em>Note: I recommend to <a href=\"https://stackoverflow.com/a/26409520/3219613\">always use <code>Long</code> instead of <code>Integer</code></a> especially when using it for row counting. Excel has more rows than Integer can handle.</em></p>\n"}, {"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1515569825, "creation_date": 1515569825, "answer_id": 48182417, "question_id": 48182221, "link": "https://stackoverflow.com/questions/48182221/store-a-cells-value-to-a-new-row-in-a-specific-column-every-time-that-cell-chan/48182417#48182417", "title": "Store a cell&#39;s value to a new row in a specific column every time that cell changes", "body": "<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim tgt As Range\n    Set tgt = Range(\"C5\")\n    If Intersect(Target, tgt) Is Nothing Then Exit Sub\n    Application.EnableEvents = False\n    Cells(LastRow, 1) = Target.Value\n    Application.EnableEvents = True    \n\nEnd Sub\n\nFunction LastRow(Optional ByVal ws As Worksheet = ActiveSheet, Optional ByVal col As Variant = \"A\") As Long\n    With ws\n        LastRow = .Cells(.rows.Count, col).End(xlUp).Row\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6913581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/985fecc3c2cb4ecde4f8eb5e3ef29412?s=128&d=identicon&r=PG&f=1", "display_name": "Ievgen Sein", "link": "https://stackoverflow.com/users/6913581/ievgen-sein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 1, "accepted_answer_id": 48182337, "answer_count": 2, "score": 0, "last_activity_date": 1515570206, "creation_date": 1515568979, "last_edit_date": 1515569722, "question_id": 48182221, "link": "https://stackoverflow.com/questions/48182221/store-a-cells-value-to-a-new-row-in-a-specific-column-every-time-that-cell-chan", "title": "Store a cell&#39;s value to a new row in a specific column every time that cell changes", "body": "<p>In my nonworking example I use the cell C5 as the cell to enter a value. \nWhat I am trying to do is: Every time a new value is entered into the cell C5, that value should be stored in the column A starting from A1 and onwards. </p>\n\n<p><em>(For example: I enter number 1.205 - it gets stored in A1, then I enter number 1.572 - it gets stored in A2, and so on).</em></p>\n\n<p>I know that my method is probably far from correct, so any help is appreciated. I have tried a few different ways to achieve this, but I can't get it to work, maximum I have achieved is being able to store up until the 2nd row of column A. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim SourceCell As Range\n    Dim CheckCell As Range\n    Dim I As Integer\n\n    I = 1\n    Set SourceCell = Range(\"C5\")\n    Set CheckCell = Range(\"A\" &amp; I)\n\n    If IsEmpty(CheckCell) Then\n        CheckCell.Value = SourceCell         \n    ElseIf Not IsEmpty(CheckCell) Then\n        I = I + 1\n        Set CheckCell = Range(\"A\" &amp; I)\n        CheckCell.Value = SourceCell   \n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1515570362, "post_id": 48182214, "comment_id": 83344577, "body": "Look into <a href=\"https://msdn.microsoft.com/en-us/library/office/aa219843(v=office.11).aspx\" rel=\"nofollow noreferrer\">file pickers</a> with .doc* file mask to list only Word documents. Capture the user the selection and pass that to the code which opens the Word document. Then, depending on what you actually want to transfer from the Word doc try <a href=\"https://www.google.co.uk/search?q=copying+text+from+word+to+excel&amp;oq=Copying+text+from+word&amp;aqs=chrome.0.0j69i57j0l4.7006j0j4&amp;sourceid=chrome&amp;ie=UTF-8\" rel=\"nofollow noreferrer\">google</a> and see which options suit. Post back with code and any specific problems."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1515570454, "post_id": 48182214, "comment_id": 83344615, "body": "Opening Word from Excel <a href=\"https://social.msdn.microsoft.com/Forums/en-US/d543bf7f-49f0-4192-a050-e582ed47ced2/opening-a-word-document-from-an-excel-vba-module?forum=isvvba\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/en-US/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 639, "user_id": 8282103, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71ad01e7729a22c4ab2c96ff8c9f022f?s=128&d=identicon&r=PG&f=1", "display_name": "Gen Tan", "link": "https://stackoverflow.com/users/8282103/gen-tan"}, "edited": false, "score": 0, "creation_date": 1515573831, "post_id": 48182849, "comment_id": 83346315, "body": "Thank you. I will try implementing this with Rich Text Content Control as the user input in Word, so that I can directly reference the RTCC object instead of having to loop through paragraphs to detect where user input begins and ends. (Would this be a smarter way to approach the problem?) Will update when I encounter troubles."}], "tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": false, "score": 1, "last_activity_date": 1515571717, "creation_date": 1515571717, "answer_id": 48182849, "question_id": 48182214, "link": "https://stackoverflow.com/questions/48182214/populate-an-excel-sheet-with-data-from-word/48182849#48182849", "title": "Populate an excel sheet with data from Word", "body": "<p>If you want to take values from Word to Excel using the button in the Excel spreadsheet, you need to control Word from Excel. There are two ways, early and late binding. Early binding is easier, so let's begin with it. \nIn Excel VBA editor, click Tools menu, then open References. Find Microsoft Word XX Object Library and tick it. You can now use Word controls in Excel VBA Editor. </p>\n\n<p>Declare variables:</p>\n\n<pre><code>Sub DateFromWord()\n\nDim appW As Word.Application\nDim ADoc As Document\nDim ph As Paragraph\nDim strR(1) As String\nDim i As Integer\n</code></pre>\n\n<p>and then set ADoc as your <em>opened</em> Word document.</p>\n\n<pre><code>Set appW = GetObject(, \"Word.Application\")\nSet ADoc = ActiveDocument\n</code></pre>\n\n<p>This is very simple way. I have assumed that you have only one Word document and you have it opened. It would be more sophisticated if you wanted to choose docs from file or something. But you have asked how to approach the problem, not the tailored solution, haven't you?</p>\n\n<p>Then you may loop through paragraphs in your document. </p>\n\n<pre><code>For Each ph In ADoc.Paragraphs\n  'Do something\nNext ph\n</code></pre>\n\n<p>What you should to inside the loop? My suggestion is to check, if there is \":\" in the paragraph. If it is, then before it you have either \"custoemr id\" or \"customer name\" and after it you have actual name or id. The loop should be like this:</p>\n\n<pre><code>For Each ph In ADoc.Paragraphs\n    If InStr(ph.Range, \":\") Then\n        For i = 0 To 1\n            strR(i) = Split(ph.Range, \":\")(i)\n        Next i\n        Debug.Print strR(0) &amp; \"    \" &amp; strR(1)\n    End If\nNext ph\n</code></pre>\n\n<p>Instead of debug.print you should put values in cells of the Excel or do whatever you want with those string. Any questions?</p>\n"}], "owner": {"reputation": 639, "user_id": 8282103, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71ad01e7729a22c4ab2c96ff8c9f022f?s=128&d=identicon&r=PG&f=1", "display_name": "Gen Tan", "link": "https://stackoverflow.com/users/8282103/gen-tan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1103, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1515571717, "creation_date": 1515568961, "question_id": 48182214, "link": "https://stackoverflow.com/questions/48182214/populate-an-excel-sheet-with-data-from-word", "title": "Populate an excel sheet with data from Word", "body": "<p>I have a word document, which looks like this:</p>\n\n<pre><code>Customer name: _____\n\nCustomer ID: _____\n\n[Button] \"Click here to add another customer\"\n</code></pre>\n\n<p>Users will fill in the customer name and customer ID. </p>\n\n<p>I have a separate excel workbook. It looks like this:</p>\n\n<pre><code>Customer Name:\n\nCustomer ID:\n</code></pre>\n\n<p>I want to add a button on the Excel sheet: When I press the button, a pop up box will appear, asking me From which file I want to extract data from. I will select the word document, and the Excel sheet will be auto populated from the data in the Word document.</p>\n\n<p>I have tried experimenting with Word's Quickparts -> fields -> database. But I only managed to extract data from excel into the word document.</p>\n\n<p>How should I approach this problem? Any functions I am missing?</p>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1515568998, "post_id": 48181904, "comment_id": 83343963, "body": "Just replace with <code>()</code> (not with <code>vbNullString</code>)."}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1515602348, "post_id": 48181904, "comment_id": 83364633, "body": "As Wiktor said, just replace with (): <code>CleanStr = .Replace(strIn, &quot;()&quot;)</code> or use Gurman&#39;s pattern."}], "answers": [{"comments": [{"owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "reply_to_user": {"reputation": 171, "user_id": 8970437, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1063a778c6c628f0914448c9a39c8201?s=128&d=identicon&r=PG&f=1", "display_name": "Link", "link": "https://stackoverflow.com/users/8970437/link"}, "edited": false, "score": 0, "creation_date": 1515638332, "post_id": 48181925, "comment_id": 83379280, "body": "@Link Please select it as the answer if it worked for you"}], "tags": [], "owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "is_accepted": true, "score": 0, "last_activity_date": 1515567692, "creation_date": 1515567692, "answer_id": 48181925, "question_id": 48181904, "link": "https://stackoverflow.com/questions/48181904/vba-excel-and-regexp/48181925#48181925", "title": "VBA Excel and Regexp", "body": "<p>It is happening because <code>\\(</code> and <code>\\)</code> in your pattern matches the opening and closing parenthesis.</p>\n\n<p>Use this as pattern instead:</p>\n\n<p><code>[^()]*(?=\\))</code></p>\n\n<p><a href=\"https://regex101.com/r/we2FYT/2\" rel=\"nofollow noreferrer\">Click for Demo</a></p>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n<li><code>[^()]*</code> - matches 0+ occurrences of any character that is nether a <code>(</code> nor a <code>)</code></li>\n<li><code>(?=\\))</code> - Positive lookahead to make sure that the above match must be followed by a closing parenthesis <code>)</code></li>\n</ul>\n"}], "owner": {"reputation": 171, "user_id": 8970437, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1063a778c6c628f0914448c9a39c8201?s=128&d=identicon&r=PG&f=1", "display_name": "Link", "link": "https://stackoverflow.com/users/8970437/link"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 48181925, "answer_count": 1, "score": 0, "last_activity_date": 1515567692, "creation_date": 1515567561, "question_id": 48181904, "link": "https://stackoverflow.com/questions/48181904/vba-excel-and-regexp", "title": "VBA Excel and Regexp", "body": "<p>Can you please check my code and see why it is not giving me what I want. I think it is because of the pattern but I am not so sure.</p>\n\n<pre><code>    Function CleanStr(strIn As String) As String\n    Dim objRegex As Object\n    Set objRegex = CreateObject(\"vbscript.regexp\")\n    With objRegex\n      .Pattern = \"\\([^)]*\\)\"\n      .Global = True\n      CleanStr = .Replace(strIn, vbNullString)\n    End With\n    End Function\n</code></pre>\n\n<p>What I want my code to do is clean the string inside a parentheses. So given something like \"values(delete)\" I want it to become \"values()\" only. But what my code does is also delete the parentheses thus making it \"values\".</p>\n\n<p>Anyone knows why this is happening?</p>\n\n<p>Thanks for the help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1515565127, "post_id": 48181290, "comment_id": 83342497, "body": "You can use the <code>Worksheet_Change</code> event and just display the message box if <code>Target</code> is the cell (or part of the range) that you are interested in.  There are many, many, many examples available, both here on Stack Overflow and elsewhere, to show you how to do this."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1515567770, "post_id": 48181290, "comment_id": 83343426, "body": "Keep in mind, <code>Worksheet_Change</code> will only work if you physically change the contents of the target cell(s), otherwise if your cell&#39;s value changes based on a formula, you might need to look at the <code>Worksheet_Calculate</code> event."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 1, "creation_date": 1515567974, "post_id": 48181290, "comment_id": 83343515, "body": "@L42 - FWIW, that &quot;duplicate&quot; has a terrible accepted answer.  I don&#39;t know whether things were different back in 2009 (I don&#39;t think it was), but everything stated in the answer is inaccurate now."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1515571233, "post_id": 48181290, "comment_id": 83344988, "body": "@L42 I have just VTCed with that new link - it looks <b>much</b> better (and much closer to this question) than the first link you had.  Not sure what will happen when the question does get closed - maybe it will list both duplicates, or maybe it will list the old one (which is currently 2 votes, versus the single vote on the new one)."}, {"owner": {"reputation": 895, "user_id": 8481983, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh6.googleusercontent.com/-ALWCIu8IaFw/AAAAAAAAAAI/AAAAAAAAAGQ/wdhvrNd_6_M/photo.jpg?sz=128", "display_name": "Jaydeep Bobade", "link": "https://stackoverflow.com/users/8481983/jaydeep-bobade"}, "edited": false, "score": 0, "creation_date": 1515575103, "post_id": 48181290, "comment_id": 83347065, "body": "i am using worksheet_change but that is heavy function means it every times execute when i am changing any cell of specific sheet"}, {"owner": {"reputation": 895, "user_id": 8481983, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh6.googleusercontent.com/-ALWCIu8IaFw/AAAAAAAAAAI/AAAAAAAAAGQ/wdhvrNd_6_M/photo.jpg?sz=128", "display_name": "Jaydeep Bobade", "link": "https://stackoverflow.com/users/8481983/jaydeep-bobade"}, "edited": false, "score": 0, "creation_date": 1515575129, "post_id": 48181290, "comment_id": 83347079, "body": "i need only for specific range or specific cell"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515608665, "post_id": 48181290, "comment_id": 83368202, "body": "@JaydeepBobade If you check out the linked questions you will see that the first one shows how to do something <b>only</b> if the specific cell D2 was changed, and the second one shows how to do something <b>only</b> if the specific cell H5 was changed."}], "owner": {"reputation": 895, "user_id": 8481983, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh6.googleusercontent.com/-ALWCIu8IaFw/AAAAAAAAAAI/AAAAAAAAAGQ/wdhvrNd_6_M/photo.jpg?sz=128", "display_name": "Jaydeep Bobade", "link": "https://stackoverflow.com/users/8481983/jaydeep-bobade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3796, "favorite_count": 0, "closed_date": 1515574664, "answer_count": 0, "score": 0, "last_activity_date": 1515575263, "creation_date": 1515564690, "last_edit_date": 1531164843, "question_id": 48181290, "link": "https://stackoverflow.com/questions/48181290/cell-change-event-in-excel-vba", "closed_reason": "Duplicate", "title": "Cell change event in Excel VBA", "body": "<p>I want to prompt the message box after the changing value of specific cell value.</p>\n\n<p>I am using sheet change event but i want to do it manually using macro or instead of sheet change event is there any event like cell change event only for specific rangename.</p>\n\n<p>i am already  using worksheet_change i need event for a specific cell or specific range name. </p>\n\n<p>can anyone suggest me macro or event for cell change?</p>\n\n<p>Thanks in advance </p>\n"}, {"tags": ["excel", "pivot-table", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1515564930, "post_id": 48181244, "comment_id": 83342436, "body": "Perhaps show your table and your expected outcome and describe what you have tried so far? And if there is code, include enough to be a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>"}, {"owner": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1515566984, "post_id": 48181244, "comment_id": 83343111, "body": "Is there an easier way to create a slicer to invert data from ascending to descending.  I thought it would be easy to have a slicer for sorting from largest to smallest and vice versa."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1515567093, "post_id": 48181244, "comment_id": 83343158, "body": "Hi, why don&#39;t you do sorting via the pivottable? You could tie this to a button. A slicer is to <a href=\"https://support.office.com/en-us/article/Use-slicers-to-filter-data-249F966B-A9D5-4B0F-B31A-12651785D29D\" rel=\"nofollow noreferrer\">&quot;slice&quot;</a> not sort. To that end, you could record a macro doing the sort ascending and descending on the field of interest then link that code to <a href=\"https://support.office.com/en-us/article/add-a-check-box-or-option-button-form-controls-9f201e46-8f6b-4a9d-a320-f44b28088cb0\" rel=\"nofollow noreferrer\">option buttons</a>, for example, with labels sort ascending/descending."}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "edited": false, "score": 1, "creation_date": 1515598576, "post_id": 48182378, "comment_id": 83361962, "body": "Slicers are not for sorting. Try an implementation such as i have given in the answer. With a few lines of code changed you could tie this to different kinds of buttons. Or even look into linking to a change event."}, {"owner": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "edited": false, "score": 0, "creation_date": 1515609489, "post_id": 48182378, "comment_id": 83368686, "body": "Is it possible to tie the slicer buttons to the action of sorting?  I have tried identifying the slicer name and filed/item without success."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "edited": false, "score": 1, "creation_date": 1515609848, "post_id": 48182378, "comment_id": 83368874, "body": "Slicers filter on existing fields i.e. items in your backing data. Slicer changes can be captured especially via associated pivottable update events. So you could try and hook in to that but i really can&#39;t see why you would want to do this. Simply target the source pivot - it is much easier and designed with sorting functionality."}, {"owner": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "edited": false, "score": 0, "creation_date": 1515612102, "post_id": 48182378, "comment_id": 83369933, "body": "I created a new table with 3 rows.  1. Gains - Losses 2. Gains 3. Losses  Then a created a slicer from that, but it is tied to no data.  I was attempting to use VBA to link it to another pivot table sort order.  If Slicer_Gains_Losses.slicer.field (&quot;Gains&quot;) = True then sort ascending type statement."}, {"owner": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "edited": false, "score": 0, "creation_date": 1515612430, "post_id": 48182378, "comment_id": 83370105, "body": "I appreciate your time and Sub above.  I have other slicers on the dashboard and was hoping to be consistent.  Thank you again for your code and discussion."}, {"owner": {"reputation": 399, "user_id": 7251685, "user_type": "registered", "accept_rate": 47, "profile_image": "https://lh5.googleusercontent.com/-cjqIiIyHfBQ/AAAAAAAAAAI/AAAAAAAANac/Wi8QkjBn3YQ/photo.jpg?sz=128", "display_name": "Dumitru Daniel", "link": "https://stackoverflow.com/users/7251685/dumitru-daniel"}, "edited": false, "score": 0, "creation_date": 1587741506, "post_id": 48182378, "comment_id": 108637397, "body": "Is it possible to use a repeated invisible character like Unichar(12288), and set it to repeat x1,x2 .... depending on the order you want? I tried with 12288 and even though it&#39;s vizible in the filder, the Slicer ignores it, but maybe there is a different invizible character that i&#39;m missing."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1515569657, "creation_date": 1515569657, "answer_id": 48182378, "question_id": 48181244, "link": "https://stackoverflow.com/questions/48181244/is-it-possible-to-have-a-pivot-table-slicer-sort-largest-to-smallest/48182378#48182378", "title": "Is it possible to have a pivot table slicer sort largest to smallest?", "body": "<p>Here is an example using Option buttons to sort the backing table instead. A slicer is meant to <strong>filter</strong> your data not to order it. When you add the form control radio/option buttons you need to edit the text, as shown in my image, and then right click each one and associate each button with the macro <code>CheckOptions</code>. Here the field being sorted is <code>[Value1]</code> which you would change as appropriate. Your data needs to be set up as a table, as shown in the image.</p>\n\n<p>I have used a suggestion by <a href=\"http://&#39;https://stackoverflow.com/questions/30657944/detect-if-a-form-control-option-button-is-selected-in-vba\" rel=\"nofollow noreferrer\">@L42</a> to do a check on which option button called the macro.</p>\n\n<p>The sort order enumerations are given <a href=\"http://&#39;https://msdn.microsoft.com/en-us/vba/excel-vba/articles/xlsortorder-enumeration-excel\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/6OztD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6OztD.png\" alt=\"Table set up and form control option buttons\"></a></p>\n\n<p>Code to go in a standard module:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub CheckOptions()                        \n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim targetTable As ListObject\n\n    Set wb = ThisWorkbook\n    Set ws = wb.Worksheets(\"Sheet1\") 'Change as appropriate\n    Set targetTable = ws.ListObjects(\"Table1\")\n\n    Select Case Application.Caller\n\n    Case \"Option Button 1\"\n\n        SortTable targetTable, 2\n\n    Case \"Option Button 2\"\n\n        SortTable targetTable, 1\n\n    End Select\nEnd Sub\n\nPrivate Sub SortTable(ByRef targetTable As ListObject, ByVal myOrder As Byte) 'https://msdn.microsoft.com/en-us/vba/excel-vba/articles/xlsortorder-enumeration-excel\n\n    With targetTable.Sort\n\n        .SortFields.Clear\n\n        .SortFields.Add _\n        Key:=Range(\"Table1[[#All],[Value1]]\"), SortOn:=xlSortOnValues, order:= _\n                   myOrder, DataOption:=xlSortNormal\n\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1681, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1515612699, "creation_date": 1515564398, "last_edit_date": 1531161705, "question_id": 48181244, "link": "https://stackoverflow.com/questions/48181244/is-it-possible-to-have-a-pivot-table-slicer-sort-largest-to-smallest", "title": "Is it possible to have a pivot table slicer sort largest to smallest?", "body": "<p>I have created a new table with Gain and Loss.  My goal is to have gain sort the table from largest to smallest &amp; Loss sort smallest to largest.  I have tried some vba, but unable to sort the value.</p>\n\n<pre><code>Sub Macro1() \n\nDim wb As Workbook \nDim ws As Worksheet \nDim targetTable As ListObject \nSet wb = ThisWorkbook \nSet ws = wb.Worksheets(\"Project Dash\") \n\nIf Worksheets(\"Project Dash\").SlicerCaches(\"Slicer_Gains__Losses\") .SlicerItems(\"Gai\u200c\u200bns\").Selected = True Then \n\n    ActiveSheet.PivotTables(\"ProjectGain20\").PivotFields(\"Projec\u200c\u200bt\").AutoSort _ xlDescending, \"Sum of Work Variance\", ActiveSheet.PivotTables(\"ProjectGain20\"). _ PivotColumnAxis.PivotLines(1), 1 \n\nEnd If \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "wildcard"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1515556217, "post_id": 48179966, "comment_id": 83340047, "body": "<code>vFilesPath</code> or <code>FilesPath</code>?  Your code sample and your description use two different names."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1515556352, "post_id": 48179966, "comment_id": 83340074, "body": "if you add a line <code>MsgBox vFilesPath</code>, does it list the correct folder?  (Also note that if the workbook is not yet saved then <code>ActiveWorkbook.Path</code> returns nothing."}, {"owner": {"reputation": 630, "user_id": 1856283, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/JU551.jpg?s=128&g=1", "display_name": "Oliver Drummond", "link": "https://stackoverflow.com/users/1856283/oliver-drummond"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1515556604, "post_id": 48179966, "comment_id": 83340137, "body": "Sorry about the sample/description, it was a typo here."}, {"owner": {"reputation": 630, "user_id": 1856283, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/JU551.jpg?s=128&g=1", "display_name": "Oliver Drummond", "link": "https://stackoverflow.com/users/1856283/oliver-drummond"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1515556642, "post_id": 48179966, "comment_id": 83340146, "body": "Yes, if I MsgBox vFilesPath, it shows the full path. (The workbook is already saved as well)."}, {"owner": {"reputation": 630, "user_id": 1856283, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/JU551.jpg?s=128&g=1", "display_name": "Oliver Drummond", "link": "https://stackoverflow.com/users/1856283/oliver-drummond"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1515556911, "post_id": 48179966, "comment_id": 83340204, "body": "By the way, not sure if this is relevant, but I&#39;m using Excel for Mac OS."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1515556925, "post_id": 48179966, "comment_id": 83340211, "body": "Can you give an example of what Dir(vFilesPath &amp; &quot;filename.txt&quot;) returns when it &quot;works&quot;?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 3, "creation_date": 1515557009, "post_id": 48179966, "comment_id": 83340223, "body": "It is relevant that you&#39;re on a Mac since Mac&#39;s don&#39;t use wildcards like windows.  See this: <a href=\"https://stackoverflow.com/a/10046053/8112776\">stackoverflow.com/a/10046053/8112776</a>  -- I think that link is only partly relevant to the issue; I&#39;m not a Mac user but I know they do handle file searches differently."}, {"owner": {"reputation": 630, "user_id": 1856283, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/JU551.jpg?s=128&g=1", "display_name": "Oliver Drummond", "link": "https://stackoverflow.com/users/1856283/oliver-drummond"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1515558612, "post_id": 48179966, "comment_id": 83340566, "body": "Thanks, Ashleedawg. That was indeed the problem. Do you mind posting that as an answer so I can mark it as solved?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1515559408, "post_id": 48179966, "comment_id": 83340783, "body": "Glad you got it figured out.  (Posted, thanks!)"}], "answers": [{"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1528962641, "post_id": 48180426, "comment_id": 88707166, "body": "@Oliver  - Don&#39;t forget to <b><code>\u2713 Accept</code></b> an answer that helped solve your problem\u2026 You&#39;ll get <b><code>+2</code></b> reputation, and the answer&#39;s author gets <b><code>+15</code></b> rep.  When you&#39;ve reached 15 reputation, you can <i>also</i> <b><code>\u25b2 Upvote</code></b> any answers that are helpful, which also rewards the authors <b>plus</b> your feedback in the form of votes <i>benefits the <a href=\"https://stackoverflow.com\">Stack Overflow</a> community as a whole!</i>"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 2, "last_activity_date": 1515559342, "creation_date": 1515559342, "answer_id": 48180426, "question_id": 48179966, "link": "https://stackoverflow.com/questions/48179966/wildcards-not-working-on-excel-15-vba-dir/48180426#48180426", "title": "Wildcards Not Working on Excel 15 VBA Dir()", "body": "<p>It <em>is</em> relevant that you're on a Mac since Mac's don't use wildcards like Windows.</p>\n\n<p>You'll need a different approach or a new (re-worded) question for more information about handling the Mac file system with VBA.  </p>\n\n<p><a href=\"https://stackoverflow.com/a/10046053/8112776\">This</a> should help get you started.</p>\n\n<p><sub>(Posted as an answer by O.P. request.)  <strong>:-)</strong></sub></p>\n"}], "owner": {"reputation": 630, "user_id": 1856283, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/JU551.jpg?s=128&g=1", "display_name": "Oliver Drummond", "link": "https://stackoverflow.com/users/1856283/oliver-drummond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1515559342, "creation_date": 1515555668, "last_edit_date": 1515556525, "question_id": 48179966, "link": "https://stackoverflow.com/questions/48179966/wildcards-not-working-on-excel-15-vba-dir", "title": "Wildcards Not Working on Excel 15 VBA Dir()", "body": "<p>I've been trying to do something REALLY simple here but, for whatever the reason, it's not working. </p>\n\n<p>All that I'm trying to do is to get all the .txt files from a specific directory using a wildcard.</p>\n\n<p>Here is the full code that I'm using:</p>\n\n<pre><code>Sub RenameFiles()\n\n    'Variables Declaration\n    Dim vSpreadsheetPath As String\n    Dim vFolderName As String\n    Dim vFilesPath As String\n    Dim vFile As String\n    Dim vRow As Long\n    Dim vFilter As String\n\n    'Getting the vFile path\n    vSpreadsheetPath = ActiveWorkbook.Path\n    vFolderName = \"COMBINED FOLDER\"\n    vFilter = \"*.txt\"\n    vFilesPath = vSpreadsheetPath &amp; Application.PathSeparator &amp; vFolderName &amp; Application.PathSeparator\n\n    vFile = Dir(vFilesPath &amp; vFilter)\n    MsgBox (vFile)\n\nEnd Sub\n</code></pre>\n\n<p>But nothing shows in the result.</p>\n\n<p>The weirdest thing is:\nIf I use</p>\n\n<pre><code>file = Dir(vFilesPath &amp; \"filename.txt\")\n</code></pre>\n\n<p>It works</p>\n\n<p>But if I try to use any Wildcard, like the one bellow, it doesn't.</p>\n\n<pre><code>file = Dir(vFilesPath &amp; \"filename.t*\")\n</code></pre>\n\n<p>Any idea of what I might be doing wrong?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 532, "user_id": 8994815, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/8994815/acatinlove"}, "edited": false, "score": 0, "creation_date": 1515553144, "post_id": 48179277, "comment_id": 83339409, "body": "Record clicking it and see. <code>Alt + T, M, R</code> repeat to stop recording. Press Alt + F11 and look at the macro Excel wrote. While there press F2 to view all methods/properties/functions/constants/etc."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 532, "user_id": 8994815, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/8994815/acatinlove"}, "edited": false, "score": 0, "creation_date": 1515553738, "post_id": 48179277, "comment_id": 83339520, "body": "@ACatInLove Unfortunately, AFAIK MS Access doesn&#39;t have a VBA code recorder.  (Have to be careful - can&#39;t call it a &quot;macro recorder&quot; because Access has macros as well as VBA, so Access developers think of something else when they hear &quot;macro&quot;.)"}, {"owner": {"reputation": 532, "user_id": 8994815, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/8994815/acatinlove"}, "edited": false, "score": 0, "creation_date": 1515554237, "post_id": 48179277, "comment_id": 83339634, "body": "There still object browser."}], "answers": [{"comments": [{"owner": {"reputation": 383, "user_id": 1932539, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7f8ec3b9f74420eda78bb6ec4866671c?s=128&d=identicon&r=PG", "display_name": "NWdev", "link": "https://stackoverflow.com/users/1932539/nwdev"}, "edited": false, "score": 0, "creation_date": 1515681666, "post_id": 48195078, "comment_id": 83400185, "body": "Excellent this was <i>exactly</i> what I was looking for! Thank you."}], "tags": [], "owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "is_accepted": true, "score": 3, "last_activity_date": 1515613970, "creation_date": 1515613970, "answer_id": 48195078, "question_id": 48179277, "link": "https://stackoverflow.com/questions/48179277/how-to-trigger-the-access-ribbons-create-table-design-button-via-vba/48195078#48195078", "title": "How to trigger the Access Ribbon&#39;s Create &#39;Table Design&#39; button via vba?", "body": "<p>What you want is <code>DoCmd.RunCommand acCmdNewObjectDesignTable</code>.</p>\n\n<p>Here is some documentation: <a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/application-runcommand-method-access\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/access-vba/articles/application-runcommand-method-access</a></p>\n"}], "owner": {"reputation": 383, "user_id": 1932539, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7f8ec3b9f74420eda78bb6ec4866671c?s=128&d=identicon&r=PG", "display_name": "NWdev", "link": "https://stackoverflow.com/users/1932539/nwdev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 48195078, "answer_count": 1, "score": 0, "last_activity_date": 1594638442, "creation_date": 1515549853, "last_edit_date": 1594638442, "question_id": 48179277, "link": "https://stackoverflow.com/questions/48179277/how-to-trigger-the-access-ribbons-create-table-design-button-via-vba", "title": "How to trigger the Access Ribbon&#39;s Create &#39;Table Design&#39; button via vba?", "body": "<p><strong>Background</strong></p>\n\n<p>Developing an application used by internal data managers (familiar w/ database schema &amp; table design). One portion of the application includes a CSV import functionality with mapping between the CSV's \"columns\" and those of existing tables.</p>\n\n<p>Users will also want to create new tables to import into. To make this as user friendly as possible, I'd like to include a button which opens a new (but not yet created) table in design view like the \"Table Design\" button found in the Access database ribbon (see below).</p>\n\n<p><a href=\"https://i.stack.imgur.com/nUJRS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nUJRS.png\" alt=\"enter image description here\"></a></p>\n\n<p>While I know the user can go to the ribbon and click the button, having it trigger from a button on the form makes it clearer for the user working with the CSV imports/import mapping.</p>\n\n<p><strong>Problem</strong></p>\n\n<p>Is there a direct command for triggering the \"Table Design\" button (or its action/function) via vba?</p>\n\n<p>Perhaps something on the order of </p>\n\n<p><code>DoCmd.OpenForm \"Table Design\", acNormal</code></p>\n\n<p>Or something that will trigger the action of the typical MS Access button visible on the \"Create\" tab?</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1515550435, "post_id": 48179171, "comment_id": 83338764, "body": "Check <a href=\"https://stackoverflow.com/questions/175170/how-do-i-slice-an-array-in-excel-vba\">how to slice array here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1515551788, "post_id": 48179226, "comment_id": 83339095, "body": "I think it should be <code>Application.WorksheetFunction.Index(myArray, 0, 2)</code>. Else it will return only the first elements."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 2, "creation_date": 1515551993, "post_id": 48179226, "comment_id": 83339141, "body": "I dunno, I ran the code and it put all the first rank elements of a single second rank into my destination."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 1, "creation_date": 1515554393, "post_id": 48179226, "comment_id": 83339670, "body": "Yeah, run that same code too and get all the 1st element only on the destination cells. What I did is: <code>.Range(&quot;A2&quot;).Resize(UBound(myArray, 1)) = application.index(myArray, Evaluate(&quot;ROW(1:&quot; &amp; UBound(myArray, 1) &amp; &quot;)&quot;), 2)</code> to make it work. Anyways, if it works for the OP then no worries ;)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1515574871, "post_id": 48179226, "comment_id": 83346965, "body": "Thanks for the confirmation @sktneer. L42 is probably right from his/her perspective; we are just tackling two different sets of data from two different sides since the OP supplied none at all to support his/her claim."}, {"owner": {"reputation": 457, "user_id": 8032508, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/TxIiB.jpg?s=128&g=1", "display_name": "Jwok", "link": "https://stackoverflow.com/users/8032508/jwok"}, "edited": false, "score": 0, "creation_date": 1515613924, "post_id": 48179226, "comment_id": 83370858, "body": "Thanks all, this is very helpful. Is there any way to do something like <code>range = application.index(myArray,0, 2-3)</code> ?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 3, "last_activity_date": 1515549533, "last_edit_date": 1515549533, "creation_date": 1515549256, "answer_id": 48179226, "question_id": 48179171, "link": "https://stackoverflow.com/questions/48179171/paste-only-specific-indexes-of-2-d-array-in-vba/48179226#48179226", "title": "Paste only specific indexes of 2-d Array in VBA", "body": "<p>You cannot do this in one step but you can do it in two.</p>\n\n<pre><code>.Range(\"A2\").Resize(UBound(myArray, 1)) = application.index(myArray, 0, 2)\n.Range(\"C2\").Resize(UBound(myArray, 1)) = application.index(myArray, 0, 3)\n</code></pre>\n"}], "owner": {"reputation": 457, "user_id": 8032508, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/TxIiB.jpg?s=128&g=1", "display_name": "Jwok", "link": "https://stackoverflow.com/users/8032508/jwok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1515549533, "creation_date": 1515548690, "question_id": 48179171, "link": "https://stackoverflow.com/questions/48179171/paste-only-specific-indexes-of-2-d-array-in-vba", "title": "Paste only specific indexes of 2-d Array in VBA", "body": "<p>I have a 2-day array like the following:</p>\n\n<pre><code>myArray(1 to 100, 1 to 3)\n</code></pre>\n\n<p>My normal way to paste an array is like this:</p>\n\n<pre><code>With ActiveWorkbook.Worksheets(\"Semesters\")\n\nIf IsEmpty(.Range(\"A2\")) Then\n    .Activate\n    .Range(\"A2\", \"C2\").Resize(UBound(myArray)).Value = myArray\nElse\n    .Activate\n    .Range(\"A1\").End(xlDown).Offset(1, 0).Activate\n    Range(ActiveCell, ActiveCell.Offset(0, 2)).Resize(UBound(myArray)).Value = myArray\nEnd If\n\nEnd With\n</code></pre>\n\n<p>But this pastes the entire array. I want to paste all of the first dimension, but only values at index 2 and 3 of the second dimension. Can this be done without creating another array that filters out index 1 of dimension 2, and if so, how?</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 164, "user_id": 4335303, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/uz8t3.jpg?s=128&g=1", "display_name": "Ugur", "link": "https://stackoverflow.com/users/4335303/ugur"}, "edited": false, "score": 0, "creation_date": 1515568078, "post_id": 48179893, "comment_id": 83343560, "body": "I just noticed that I had forgotton to say what the replacement would be. I edited the question. I&#39;ll try to customize your answer. If I can&#39;t, I&#39;ll write a comment. Thanks."}, {"owner": {"reputation": 164, "user_id": 4335303, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/uz8t3.jpg?s=128&g=1", "display_name": "Ugur", "link": "https://stackoverflow.com/users/4335303/ugur"}, "edited": false, "score": 0, "creation_date": 1515571789, "post_id": 48179893, "comment_id": 83345247, "body": "Hey, thanks! I managed this part, but I cannot make it look for &quot;____________&quot; (a total of 12 underscores) with the same purpose: replace &quot;a ____________&quot; with &quot;a(n) ____________&quot;. Any ideas?"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 164, "user_id": 4335303, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/uz8t3.jpg?s=128&g=1", "display_name": "Ugur", "link": "https://stackoverflow.com/users/4335303/ugur"}, "edited": false, "score": 1, "creation_date": 1515575161, "post_id": 48179893, "comment_id": 83347097, "body": "I have modified my answer above to include solutions for searching for underscores."}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": true, "score": 1, "last_activity_date": 1515575130, "last_edit_date": 1515575130, "creation_date": 1515555060, "answer_id": 48179893, "question_id": 48179145, "link": "https://stackoverflow.com/questions/48179145/word-vba-conditional-find-and-replace/48179893#48179893", "title": "word vba conditional find and replace", "body": "<p>Please try the code below. It takes a slightly different approach because it looks for \"---- \" instead of the \"a\" or \"an\".</p>\n\n<pre><code>Sub ConditionalReplace()\n    ' 10 Jan 2018\n\n    Dim Pos As Long\n    Dim n As Integer\n\n    With Selection\n        .HomeKey Unit:=wdStory\n        .Find.Text = \"---- \"\n\n        Do While .Find.Execute = True\n            Pos = .Start + 1\n            .Collapse wdCollapseStart\n            .MoveStart wdWord, -1\n            If (StrComp(Trim(.Text), \"a\", vbTextCompare) = 0) Or _\n               (StrComp(Trim(.Text), \"an\", vbTextCompare) = 0) Then\n               .Delete\n               n = n + 1\n            End If\n            .SetRange Pos, ActiveDocument.Characters.Count\n        Loop\n        .HomeKey Unit:=wdStory\n    End With\n    MsgBox n &amp; \" replacements were made.\"\nEnd Sub\n</code></pre>\n\n<p>In order to look for another marker, for example, a string consisting of 12 underscores, modify the line <code>.Find.Text = \"---- \"</code> to become</p>\n\n<pre><code>.Find.Text = \"____________\"\n</code></pre>\n\n<p>If you can't be sure how many underscores there will be consider the code snippet below which will find occurrences of six underscores followed by any other text including, but not limited to, another 6 or 4 underscores.</p>\n\n<pre><code>.Find.MatchWildcards = True\n.Find.Text = \"______*\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 2, "last_activity_date": 1515648980, "creation_date": 1515648980, "answer_id": 48200389, "question_id": 48179145, "link": "https://stackoverflow.com/questions/48179145/word-vba-conditional-find-and-replace/48200389#48200389", "title": "word vba conditional find and replace", "body": "<p>You don't need a macro for this; it can all be done with a <em>wildcard</em> Find/Replace, where:</p>\n\n<p>Find = [an]{1,2}( [_]{1,})</p>\n\n<p>Replace = a(n)\\1</p>\n\n<p>Of course, it can also be done with a <em>wildcard</em> Find/Replace macro:</p>\n\n<pre><code>Sub Demo()\nWith ActiveDocument.Range.Find\n  .ClearFormatting\n  .Replacement.ClearFormatting\n  .Text = \"[an]{1,2}( [_]{1,})\"\n  .Replacement.Text = \"a(n)\\1\"\n  .Forward = True\n  .Wrap = wdFindContinue\n  .Format = False\n  .MatchWildcards = True\n  .Execute Replace:=wdReplaceAll\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 164, "user_id": 4335303, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/uz8t3.jpg?s=128&g=1", "display_name": "Ugur", "link": "https://stackoverflow.com/users/4335303/ugur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1717, "favorite_count": 0, "accepted_answer_id": 48179893, "answer_count": 2, "score": 0, "last_activity_date": 1593889046, "creation_date": 1515548480, "last_edit_date": 1593889046, "question_id": 48179145, "link": "https://stackoverflow.com/questions/48179145/word-vba-conditional-find-and-replace", "title": "word vba conditional find and replace", "body": "<p>I'm trying to get MSWord's vba to replace one word: \"an\" with \"a(n)\" if the next word is \"---- \". I managed to write this, but it doesn't seem to work. Any ideas why? (I also need to do the same for the word \"a\" with the same condition as well, but couldn't get the first one done yet, so..)\nBy the way, I don't have a set range, I need to scan all the document..</p>\n\n<pre><code>Sub Makro1()\nWith Selection\n  Set Rng = .Range\n  With .Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Text = \"an\"\n    .Forward = True\n    .Wrap = wdFindStop\n    .MatchCase = False\n    .MatchWholeWord = True\n    .MatchWildcards = False\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\n    .Execute\n  End With\n  Do While .Find.Found\n    If Selection.Next(Unit:=wdWord, Count:=1) = \"---- \" Then\n    .Find.Replacement.Text = \"a(n)\"\n    End If\n    .Find.Execute\n  Loop\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1515548090, "post_id": 48179042, "comment_id": 83338287, "body": "Exactly. With <code>dim arr(0 to 4)</code> the ubound is 4. To <i>&#39;Shrink the array by one, removing the last one&#39;</i> you redim to 1 less than the ubound while preserving the existing values."}, {"owner": {"reputation": 409, "user_id": 8903456, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bbe11a345fff0041ef48da36cd75dbc2?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/8903456/max"}, "edited": false, "score": 0, "creation_date": 1515548126, "post_id": 48179042, "comment_id": 83338294, "body": "Alright, if I understood correctly, the <code>len()</code> returns <code>Long</code> and that causes the error.  Thanks for the explanation"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 409, "user_id": 8903456, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bbe11a345fff0041ef48da36cd75dbc2?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/8903456/max"}, "edited": false, "score": 1, "creation_date": 1515548268, "post_id": 48179042, "comment_id": 83338327, "body": "The size of an array is the UBound; the number of cells in a range is the Count; the number of elements in a html collection is the length. They cannot seem to agree on anything."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 3, "creation_date": 1515548868, "post_id": 48179042, "comment_id": 83338463, "body": "@Jeeped There <b>is</b> a reason why <code>UBound</code> and <code>Count</code> aren&#39;t the same - imagine an arr declared as <code>Dim arr(8 To 20)</code> - if a <code>Count</code> property existed you would expect it to return 13, but you still need to know that the <code>UBound</code> is 20 and that the <code>LBound</code> is 8."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1515547937, "last_edit_date": 1515547937, "creation_date": 1515547638, "answer_id": 48179042, "question_id": 48179004, "link": "https://stackoverflow.com/questions/48179004/excel-vba-type-mismatch-when-redim-arr/48179042#48179042", "title": "Excel VBA - Type mismatch when redim arr", "body": "<p>The Len (or Length) of an array is its Upper Boundary. To decrease the size of the array by 1,</p>\n\n<pre><code>ReDim Preserve arr(UBound(arr) - 1)\n</code></pre>\n\n<p>Conversely, the beginning of an array is the LBound or lower boundary. This is usually 0 (zero) or 1 (one) and in a two-dimensioned array you can specify the rank.</p>\n"}], "owner": {"reputation": 409, "user_id": 8903456, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bbe11a345fff0041ef48da36cd75dbc2?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/8903456/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1736, "favorite_count": 0, "accepted_answer_id": 48179042, "answer_count": 1, "score": 1, "last_activity_date": 1515547937, "creation_date": 1515547227, "question_id": 48179004, "link": "https://stackoverflow.com/questions/48179004/excel-vba-type-mismatch-when-redim-arr", "title": "Excel VBA - Type mismatch when redim arr", "body": "<p>I had an dynamic array where is value is from the worksheet.\nIf condition is meet, I would like to delete the element that meet the condition. The code was from <a href=\"https://stackoverflow.com/questions/7000334/deleting-elements-in-an-array-if-element-is-a-certain-value-vba\">this post</a> but it is returning </p>\n\n<blockquote>\n  <p>Type Mismatch </p>\n</blockquote>\n\n<p>on <code>ReDim Preserve arr(Len(arr) - 1)</code> </p>\n\n<pre><code>Sub arrtest()\nDim arr As Variant\nDim i As Integer\n\nReDim arr(1 To 1)\n\nDim cnt As Long\ncnt = 0\n\nFor i = 1 To Cells(Rows.Count, \"L\").End(xlUp).Row\n\n    If Cells(i, \"A\").Value = \"-2\" Then\n        cnt = cnt + 1\n        ReDim Preserve arr(1 To cnt)\n        arr(cnt) = Cells(i, \"A\").Value\n    End If\n\nNext i\n\n    For i = 1 To cnt\n        Debug.Print \"This is arr: \"; arr(i)\n\n     If arr(i) = \"TEST\" Then\n      Call DeleteElementAt(i, arr)\n      Debug.Print \"This is new arr: \"; arr(i)\n      Else\n      Debug.Print \"Nothing is deleted\"\n      End If\n    Next\n\nEnd Sub\n\nPublic Sub DeleteElementAt(ByVal index As Integer, ByRef arr As Variant)\n       Dim i As Integer\n\n        ' Move all element back one position\n        For i = index + 1 To UBound(arr)\n            arr(i - 1) = arr(i)\n        Next\n        ' Shrink the array by one, removing the last one\n        ReDim Preserve arr(Len(arr) - 1)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2007"], "answers": [{"comments": [{"owner": {"reputation": 170, "user_id": 4221011, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh5.googleusercontent.com/-qPQKMMbAg3k/AAAAAAAAAAI/AAAAAAAAAn8/BiIbI_tGzmw/photo.jpg?sz=128", "display_name": "rellik", "link": "https://stackoverflow.com/users/4221011/rellik"}, "edited": false, "score": 0, "creation_date": 1515544574, "post_id": 48178653, "comment_id": 83337438, "body": "Thank you for your reply. Yes, I did try range(&quot;B:B,D:D&quot;) but my problem is then every time any change to column D it will run the code for column B as well. is there a way to use select case *****something****** to identify the column?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1515546123, "last_edit_date": 1515546123, "creation_date": 1515544145, "answer_id": 48178653, "question_id": 48178632, "link": "https://stackoverflow.com/questions/48178632/multiple-range-intersect-in-excel-vba/48178653#48178653", "title": "Multiple Range Intersect in excel VBA", "body": "<p>Change the first Intersect to,</p>\n\n<pre><code>If Intersect(Target, Range(\"B:B, D:D\")) Is Nothing Then Exit Sub\n</code></pre>\n\n<p>... and lose the second. Parse each cell in Target (there can be more than 1) so you don't crash on things like,</p>\n\n<pre><code>If Target = \"\" Then Exit Sub\n</code></pre>\n\n<p>Here is my rewrite using standard Worksheet_Change boilerplate code. <strong>Note that <em>lc</em> does not appear to have a value</strong>.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    'COULD NOT FIND ANY CODE TO ASSIGN A VALUE TO lc\n    'myDate ALSO APPEARS TO BE A PUBLIC PREDEFINED VAR\n\n    If Not Intersect(Target, Range(\"B:B, D:D\")) Is Nothing Then\n        On Error GoTo safe_exit\n        With Application\n            .EnableEvents = False\n            .ScreenUpdating = False\n            Dim lc As Long, trgt As Range, ws1 As Worksheet\n            Set ws1 = ThisWorkbook.Worksheets(\"Lists\")\n            For Each trgt In Intersect(Target, Range(\"B:B, D:D\"))\n                If trgt &lt;&gt; vbNullString Then\n                    Select Case trgt.Column\n                        Case 2   'column B\n                            Cells(trgt.Row, lc + 1) = trgt.Row - 1\n                            Cells(trgt.Row, lc + 3) = Format(myDate, \"dd-mmm-yyyy\")\n                            Cells(trgt.Row, lc + 4) = .VLookup(trgt, ws1.Range(\"A2:C29\").Value, 3, False)\n                            Cells(trgt.Row, lc + 5) = 7.6\n                            Cells(trgt.Row, lc + 7) = .VLookup(trgt, ws1.Range(\"A2:C29\").Value, 2, False)\n                            Cells(trgt.Row, lc + 8) = Format(myDate, \"dddd\")\n                            Cells(trgt.Row, lc + 10) = WORKCODE(trgt.Row, lc + 4)  '&lt;~~??????????\n                        Case 4   'column D\n                            'do something else\n                    End Select\n                End If\n                MsgBox \"Row: \" &amp; Target.Row &amp; \"Column: \" &amp; lc\n            Next trgt\n            Set ws1 = Nothing\n        End With\n    End If\n\nsafe_exit:\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>You also might want to switch vlookup to an index/match and catch the result in a variant which can be tested for no match error.</p>\n"}, {"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1515547478, "last_edit_date": 1515547478, "creation_date": 1515545619, "answer_id": 48178829, "question_id": 48178632, "link": "https://stackoverflow.com/questions/48178632/multiple-range-intersect-in-excel-vba/48178829#48178829", "title": "Multiple Range Intersect in excel VBA", "body": "<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim lc As Long\n    Dim TEMPVAL As String\n    Dim ws1, ws2 As Worksheet\n    Dim myDay As String\n    Set ws1 = ThisWorkbook.Sheets(\"Lists\")\n    myDay = Format(myDate, \"dddd\")\n\n    'If Intersect(Target, Range(\"B:B\")) Is Nothing Then Exit Sub\n    If Target = \"\" Then Exit Sub\n    If Target.Column = 2 Then\n        If Target = \"\" Then Exit Sub\n        MsgBox \"Row: \" &amp; Target.Row &amp; \"Column: \" &amp; lc\n        With Application\n          '.EnableEvents = False\n          .ScreenUpdating = False\n            Cells(Target.Row, lc + 1) = Target.Row - 1\n            Cells(Target.Row, lc + 3) = Format(Date, \"dd-MMM-yyyy\")\n            Cells(Target.Row, lc + 4) = Application.WorksheetFunction.VLookup(Target, ws1.Range(\"A2:C29\"), 3, False)\n            Cells(Target.Row, lc + 5) = 7.6\n            Cells(Target.Row, lc + 7) = Application.WorksheetFunction.VLookup(Target, ws1.Range(\"A2:C29\"), 2, False)\n            Cells(Target.Row, lc + 8) = myDay\n            Cells(Target.Row, lc + 10) = WORKCODE(Target.Row, lc + 4)\n          .EnableEvents = True\n          .ScreenUpdating = True\n        End With\n\n    ElseIf Target.Column = 4 Then\n    'If Intersect(Target, Range(\"D2:D5002\")) Is Nothing Then Exit Sub\n    'If Target = \"\" Then Exit Sub\n        MsgBox \"Row: \" &amp; Target.Row &amp; \"Column: \" &amp; lc\n        With Application\n          '.EnableEvents = False\n          .ScreenUpdating = False\n            Cells(Target.Row, lc + 10) = WORKCODE(Target.Row, lc + 4)\n          '.EnableEvents = True\n          .ScreenUpdating = True\n        End With\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 170, "user_id": 4221011, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh5.googleusercontent.com/-qPQKMMbAg3k/AAAAAAAAAAI/AAAAAAAAAn8/BiIbI_tGzmw/photo.jpg?sz=128", "display_name": "rellik", "link": "https://stackoverflow.com/users/4221011/rellik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7550, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1515547478, "creation_date": 1515543987, "question_id": 48178632, "link": "https://stackoverflow.com/questions/48178632/multiple-range-intersect-in-excel-vba", "title": "Multiple Range Intersect in excel VBA", "body": "<p>Why does this not work?\nI'm trying to get excel to check for any changes in column B and D if column B has changed then do some actions and so on.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim lc As Long\nDim TEMPVAL As String\nDim ws1, ws2 As Worksheet\nDim myDay As String\nSet ws1 = ThisWorkbook.Sheets(\"Lists\")\nmyDay = Format(myDate, \"dddd\")\nIf Intersect(Target, Range(\"B:B\")) Is Nothing Then Exit Sub\nIf Target = \"\" Then Exit Sub\nMsgBox \"Row: \" &amp; Target.Row &amp; \"Column: \" &amp; lc\nWith Application\n  .EnableEvents = False\n  .ScreenUpdating = False\n    Cells(Target.Row, lc + 1) = Target.Row - 1\n    Cells(Target.Row, lc + 3) = Format(myDate, \"dd-MMM-yyyy\")\n    Cells(Target.Row, lc + 4) = Application.WorksheetFunction.VLookup(Target, ws1.Range(\"A2:C29\").Value, 3, False)\n    Cells(Target.Row, lc + 5) = 7.6\n    Cells(Target.Row, lc + 7) = Application.WorksheetFunction.VLookup(Target, ws1.Range(\"A2:C29\").Value, 2, False)\n    Cells(Target.Row, lc + 8) = myDay\n    Cells(Target.Row, lc + 10) = WORKCODE(Target.Row, lc + 4)\n  .EnableEvents = True\n  .ScreenUpdating = True\nEnd With\nIf Intersect(Target, Range(\"D2:D5002\")) Is Nothing Then Exit Sub\nIf Target = \"\" Then Exit Sub\nMsgBox \"Row: \" &amp; Target.Row &amp; \"Column: \" &amp; lc\nWith Application\n  .EnableEvents = False\n  .ScreenUpdating = False\n    Cells(Target.Row, lc + 10) = WORKCODE(Target.Row, lc + 4)\n  .EnableEvents = True\n  .ScreenUpdating = True\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Excel run the first intersec and exit the sub.\nwhy doesnt it run the second intersect?\nThanks in Advance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 731, "user_id": 5613367, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-ZDZV06Q_DNI/AAAAAAAAAAI/AAAAAAAAAH8/yz_JRBIXnoM/photo.jpg?sz=128", "display_name": "Pat Jones", "link": "https://stackoverflow.com/users/5613367/pat-jones"}, "edited": false, "score": 0, "creation_date": 1515544877, "post_id": 48178571, "comment_id": 83337506, "body": "It&#39;s not clear what you are trying to compare. <code>Row1length</code> and <code>Row2length</code> are both set to the same thing. And, in the actual comparison test, you are referencing <code>Cells(1, i)</code> which would work with only the first row in two different worksheets. Please give at least one specific example so that we can understand better what you&#39;re trying to do."}, {"owner": {"reputation": 33, "user_id": 4957617, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wncSuY46gOE/AAAAAAAAAAI/AAAAAAAAALY/E9uVUF7FPZ0/photo.jpg?sz=128", "display_name": "Kaivan Shah", "link": "https://stackoverflow.com/users/4957617/kaivan-shah"}, "reply_to_user": {"reputation": 731, "user_id": 5613367, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-ZDZV06Q_DNI/AAAAAAAAAAI/AAAAAAAAAH8/yz_JRBIXnoM/photo.jpg?sz=128", "display_name": "Pat Jones", "link": "https://stackoverflow.com/users/5613367/pat-jones"}, "edited": false, "score": 0, "creation_date": 1515601034, "post_id": 48178571, "comment_id": 83363730, "body": "Hi Pat, thanks for responding. I should have been more clear. I want to compare the last two rows in the same sheet. When I compare I want to check if the values have a standard deviation of more than 0.5. If it does than report it or turn it into some color."}, {"owner": {"reputation": 731, "user_id": 5613367, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-ZDZV06Q_DNI/AAAAAAAAAAI/AAAAAAAAAH8/yz_JRBIXnoM/photo.jpg?sz=128", "display_name": "Pat Jones", "link": "https://stackoverflow.com/users/5613367/pat-jones"}, "edited": false, "score": 0, "creation_date": 1515612323, "post_id": 48178571, "comment_id": 83370052, "body": "I replicated your code and it worked fine for me. The only thing that I did differently was to initialize the boolean prior to the loop: <code>Match = True</code>."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4957617, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wncSuY46gOE/AAAAAAAAAAI/AAAAAAAAALY/E9uVUF7FPZ0/photo.jpg?sz=128", "display_name": "Kaivan Shah", "link": "https://stackoverflow.com/users/4957617/kaivan-shah"}, "edited": false, "score": 0, "creation_date": 1515613417, "post_id": 48180047, "comment_id": 83370601, "body": "Thanks variatus. That worked perfectly! I need to iterate through each column and calculate Std Deviation for all the values in that column. How do I go about that?"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 33, "user_id": 4957617, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wncSuY46gOE/AAAAAAAAAAI/AAAAAAAAALY/E9uVUF7FPZ0/photo.jpg?sz=128", "display_name": "Kaivan Shah", "link": "https://stackoverflow.com/users/4957617/kaivan-shah"}, "edited": false, "score": 0, "creation_date": 1515629042, "post_id": 48180047, "comment_id": 83377132, "body": "The fastest way is to accept the answer which you received and start a new thread with your new question."}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1515556337, "creation_date": 1515556337, "answer_id": 48180047, "question_id": 48178571, "link": "https://stackoverflow.com/questions/48178571/compare-selective-cells-of-two-rows-and-calculate-deviation-using-macros-in-exce/48180047#48180047", "title": "Compare selective cells of two rows and calculate deviation using macros in excel", "body": "<p>This code will loop through all the rows in the sheet and compare the first with the second, marking cells which have different values.</p>\n\n<pre><code>Sub CheckIt()\n\n    Const FirstDataRow As Long = 2          ' change as required\n\n    Dim Rl As Long, Cl As Long\n    Dim R As Long, C As Long\n\n    With Worksheets(\"Sheet1\")               ' change the sheet name\n        Rl = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        Cl = .Cells(FirstDataRow, .Columns.Count).End(xlToLeft).Column\n        For R = FirstDataRow To Rl Step 2\n            For C = 1 To Cl\n                If (.Cells(R, C).Value) &lt;&gt; (Cells(R + 1, C).Value) Then\n                    Range(.Cells(R, C), Cells(R + 1, C)).Interior.Color = vbYellow\n                End If\n            Next C\n        Next R\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4957617, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wncSuY46gOE/AAAAAAAAAAI/AAAAAAAAALY/E9uVUF7FPZ0/photo.jpg?sz=128", "display_name": "Kaivan Shah", "link": "https://stackoverflow.com/users/4957617/kaivan-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515601162, "creation_date": 1515543456, "last_edit_date": 1515601162, "question_id": 48178571, "link": "https://stackoverflow.com/questions/48178571/compare-selective-cells-of-two-rows-and-calculate-deviation-using-macros-in-exce", "title": "Compare selective cells of two rows and calculate deviation using macros in excel", "body": "<p>I am pretty new to macros. Just need to do this small task at work.\nOverview: I am running two different recipes/programs to generate data.</p>\n\n<p><a href=\"https://i.stack.imgur.com/TcumJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TcumJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Every alternate row is a reading generated from different recipe. I want to compare the last two rows in the same sheet. If the values have a standard deviation of more than 0.5, I need to report or change the colors of the cells. How do I do that?</p>\n\n<p>I wrote the following but it did not work for me:</p>\n\n<pre><code>Sub checkit()\nRow1length = Worksheets(\"Sheet1\").Cells(1, Columns.Count).End(xlToLeft).Column\n\nFor i = 1 To Row1length\n    If Worksheets(\"Sheet1\").Cells(7, i).Value &lt;&gt; Worksheets(\"Sheet1\").Cells(8, i) Then\n        Match = False\n            Exit For\n    End If\nNext\n\nIf Match = True Then\n    Debug.Print \"match\"\nElse\n    Debug.Print \"not match\"\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 2509872, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0d3951d8ad77217cef1295c53ecdfa7c?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/2509872/greg"}, "edited": false, "score": 0, "creation_date": 1515600376, "post_id": 48178547, "comment_id": 83363287, "body": "For a &quot;match&quot; to occur the entire row must contain these 6 strings. If I iterate one element at a time then the result would give false matches as these 6 strings may be in the range &quot;shtTigers&quot; but not on the same row."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "reply_to_user": {"reputation": 63, "user_id": 2509872, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0d3951d8ad77217cef1295c53ecdfa7c?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/2509872/greg"}, "edited": false, "score": 0, "creation_date": 1515608080, "post_id": 48178547, "comment_id": 83367862, "body": "Then just add a counter, as above"}], "tags": [], "owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "is_accepted": false, "score": 0, "last_activity_date": 1515608069, "last_edit_date": 1515608069, "creation_date": 1515543263, "answer_id": 48178547, "question_id": 48178479, "link": "https://stackoverflow.com/questions/48178479/vba-match-6-criteria/48178547#48178547", "title": "VBA match 6 Criteria", "body": "<p>Match requires a single lookup value but you're trying to pass the whole array. Iterate one element at at time instead:</p>\n\n<pre><code>Dim counter as Integer\n\n    For x = 0 to 5\n         If Not IsError(Application.Match(arrCompare(x), shtTigers, 0)) Then\n              counter = counter + 1\n         End If\n    Next x\n\nIf counter = 6 Then Debug.Print \"Matches found\"\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 2509872, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0d3951d8ad77217cef1295c53ecdfa7c?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/2509872/greg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515608069, "creation_date": 1515542695, "last_edit_date": 1515571337, "question_id": 48178479, "link": "https://stackoverflow.com/questions/48178479/vba-match-6-criteria", "title": "VBA match 6 Criteria", "body": "<p>The script fills an array from a sheet called \"Tigers\" with 6 strings. Then it is supposed to compare that array to a differnt sheet titled \"Elephants\" and tell me if it finds an exact match. The troublesome code is found at the Application.Match method</p>\n\n<p>Any help understanding how to correctly script a match with multiple values would be appreciated.</p>\n\n<pre><code>Sub matchData()\n\nDim arrCompare(5) As Variant\nDim intRow As Integer\nDim varRes As Variant\n\nSet sht = ActiveSheet\nSet shtTigers = Worksheets(\"Tigers\").Range(\"A2:A100\")\nSet shtElephants = Worksheets(\"Elephants\").Range(\"A2:A100\")\n\nSheets(\"Elephants\").Activate\n\nFor intRow = 2 To 100\n\narrCompare(0) = Worksheets(\"Elephants\").Cells(intRow, 1).Value      \narrCompare(1) = Worksheets(\"Elephants\").Cells(intRow, 2).Value      \narrCompare(2) = Worksheets(\"Elephants\").Cells(intRow, 4).Value      \narrCompare(3) = Worksheets(\"Elephants\").Cells(intRow, 5).Value      \narrCompare(4) = Worksheets(\"Elephants\").Cells(intRow, 7).Value      \narrCompare(5) = Worksheets(\"Elephants\").Cells(intRow, 9).Value      \n\n'compare all 6 strings in array against Elephant sheet rows for a match\nvarRes = Application.Match(arrCompare(), shtTigers, 0)\n\n'also tried\n'varRes = Application.Match(((arrCompare(0))*((arrCompare(1))*((arrCompare(2)) * ((arrCompare(3)) * ((arrCompare(4)) * ((arrCompare(5))*((arrCompare(6)),shtTigers, 0)\n\n'messagebox just gives a Error 13 or 2042 for varRes\nMsgBox (\"varRes = \" &amp; varRes)\n\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1515536749, "post_id": 48177482, "comment_id": 83335219, "body": "There is no <code>WorksheetFunction.Offset</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515537548, "post_id": 48177482, "comment_id": 83335511, "body": "look for <code>Range.Offset</code>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1515538471, "post_id": 48177482, "comment_id": 83335826, "body": "To be clear there is an Excel function called <code>OFFSET</code> that can be used be directly in cell editing. However, this function is not exposed as a member in the vba <code>WorksheetFunction</code> object."}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1515540135, "post_id": 48177709, "comment_id": 83336358, "body": "<code>Resize</code>, not <code>Offset</code>"}], "tags": [], "owner": {"reputation": 3180, "user_id": 5730949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d17b1b9a3df216418c9db9c4cbf93ce?s=128&d=identicon&r=PG&f=1", "display_name": "isaace", "link": "https://stackoverflow.com/users/5730949/isaace"}, "is_accepted": false, "score": 2, "last_activity_date": 1515603206, "last_edit_date": 1515603206, "creation_date": 1515537700, "answer_id": 48177709, "question_id": 48177482, "link": "https://stackoverflow.com/questions/48177482/running-excels-offset-using-worksheetfunction-causes-error-438/48177709#48177709", "title": "Running Excel&#39;s OFFSET using WorkSheetFunction causes error 438", "body": "<p>This should work:</p>\n\n<pre><code>Set r = Worksheets(\"MAIN\").Range(\"H85\").Resize(1, 2)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 4, "last_activity_date": 1515540629, "last_edit_date": 1515540629, "creation_date": 1515538695, "answer_id": 48177885, "question_id": 48177482, "link": "https://stackoverflow.com/questions/48177482/running-excels-offset-using-worksheetfunction-causes-error-438/48177885#48177885", "title": "Running Excel&#39;s OFFSET using WorkSheetFunction causes error 438", "body": "<p>To mimic <code>=OFFSET(rng, offR, offC, sizeR, sizeC)</code> you can use either or both of: </p>\n\n<pre><code>rng.Offset(offR, offC) \n</code></pre>\n\n<p>and </p>\n\n<pre><code>rng.Resize(sizeR, sizeC) \n</code></pre>\n\n<p>or combined:</p>\n\n<pre><code>    rng.Offset(offR, offC).Resize(sizeR, sizeC)\n</code></pre>\n\n<p>Since you're not actually offsetting here, you only need: </p>\n\n<pre><code>Set r = Worksheets(\"MAIN\").Range(\"H85\").Resize(1, 2)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 5563200, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-R05BdgIhku0/AAAAAAAAAAI/AAAAAAAAB98/z4W4ypOwi9U/photo.jpg?sz=128", "display_name": "Dimitar Stratiev", "link": "https://stackoverflow.com/users/5563200/dimitar-stratiev"}, "edited": false, "score": 0, "creation_date": 1515568079, "post_id": 48178106, "comment_id": 83343561, "body": "Thanks for everyone&#39;s input! I chose the answer above as the best answer because it is very detailed and provides not only alternatives to how to solve the problem, but also gives references to verify that VBA doesn&#39;t support Excel&#39;s OFFSET."}], "tags": [], "owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "is_accepted": true, "score": 1, "last_activity_date": 1515642296, "last_edit_date": 1515642296, "creation_date": 1515540183, "answer_id": 48178106, "question_id": 48177482, "link": "https://stackoverflow.com/questions/48177482/running-excels-offset-using-worksheetfunction-causes-error-438/48178106#48178106", "title": "Running Excel&#39;s OFFSET using WorkSheetFunction causes error 438", "body": "<p>Error 438 stands for: <strong>Object doesn't support this property or method.</strong> \n(It might be worth to comment out the <code>On Error Resume Next</code> when you are debugging in order to have this information.)</p>\n\n<p>This means that the method <code>Offset</code> is not supported by the object <code>WorksheetFunction</code>. This can be a little surprising since it does not appear on the list of functions that are not available in VBA according to Microsoft (<a href=\"https://support.microsoft.com/en-gb/help/213660/not-all-excel-worksheet-functions-are-supported-as-methods-of-the-appl\" rel=\"nofollow noreferrer\">See list</a>).</p>\n\n<p>However, it is indeed not available since it's not part of the methods listed here: </p>\n\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff822194(v=office.14).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff822194(v=office.14).aspx</a> (Office 2010)</li>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheetfunction-object-excel\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheetfunction-object-excel</a> (Office 365)</li>\n</ul>\n\n<p><strong>Alternatives:</strong>\nAs already suggested by Tim Williams, using the <code>Resize</code> method of the <code>Range</code> Object is the easiest way to do what you are trying to do, but if you prefer to use the <code>Offset</code> method, you could use:</p>\n\n<pre><code>   Dim r As Range, s As Range\n   Set s = Worksheets(\"MAIN\").Range(\"H85\")\n   Set r = Range(s, s.Offset(0, 1))\n</code></pre>\n\n<p>or alternatively, you can use the <code>Evaluate</code> function like this:</p>\n\n<pre><code>Set r = Application.Evaluate(\"Offset('MAIN'!H5, 0, 0, 1, 2)\")\n</code></pre>\n\n<p>But this one would be a little bit slower.</p>\n"}], "owner": {"reputation": 21, "user_id": 5563200, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-R05BdgIhku0/AAAAAAAAAAI/AAAAAAAAB98/z4W4ypOwi9U/photo.jpg?sz=128", "display_name": "Dimitar Stratiev", "link": "https://stackoverflow.com/users/5563200/dimitar-stratiev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 0, "accepted_answer_id": 48178106, "answer_count": 3, "score": 0, "last_activity_date": 1515642296, "creation_date": 1515536478, "last_edit_date": 1515546386, "question_id": 48177482, "link": "https://stackoverflow.com/questions/48177482/running-excels-offset-using-worksheetfunction-causes-error-438", "title": "Running Excel&#39;s OFFSET using WorkSheetFunction causes error 438", "body": "<p>My main goal is to create a named range that automatically resizes. </p>\n\n<p>A common way to do this is to use the <code>OFFSET</code> formula in Excel and dynamically determine the height and/or width parameter values using <code>CountA</code>. I would like to do this using VBA. For simplicity purposes, I took a step back and focused just on getting <code>OFFSET</code> to run and return a range. I have the following code:</p>\n\n<pre><code>Public Function testfn()\n   Dim r As Range\n   On Error Resume Next\n   Set r = WorksheetFunction.Offset(Worksheets(\"MAIN\").Range(\"H85\"), 0, 0, 1, 2)\n   Debug.Print Err.Number\n End Function\n</code></pre>\n\n<p>The output in the console is <code>438</code>. I'm not really sure what's causing it because I have specified the starting reference explicitly and the rest of the values are hard-coded integers. </p>\n\n<p>Can you please point out what exactly is causing the error? Could it be that it's not actually possible to call this function using VBA?</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 1, "creation_date": 1515536728, "post_id": 48177437, "comment_id": 83335210, "body": "Yes, you can do that. Write an aggregate query that counts the number of records matching your new record. If that count is &gt; 0 then you inform the user. Use Dlookup to do the work for you. You don&#39;t need a Recordset object or anything that complicated."}, {"owner": {"reputation": 43, "user_id": 9017062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-w_MBXm4bvUk/AAAAAAAAAAI/AAAAAAAAAXw/occAeJNEVXE/photo.jpg?sz=128", "display_name": "OneLineAtTheTime", "link": "https://stackoverflow.com/users/9017062/onelineatthetime"}, "reply_to_user": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1515537108, "post_id": 48177437, "comment_id": 83335365, "body": "I think you are on the right track here. Though untrained I think I can figure it out. If you&#39;re into SO points might wanna put your comment in the answers so I can upvote it"}, {"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 2, "creation_date": 1515537591, "post_id": 48177437, "comment_id": 83335525, "body": "Use DCount followed by a message. You could even use the result returned by the DCount as a condition to run or not run your query."}, {"owner": {"reputation": 43, "user_id": 9017062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-w_MBXm4bvUk/AAAAAAAAAAI/AAAAAAAAAXw/occAeJNEVXE/photo.jpg?sz=128", "display_name": "OneLineAtTheTime", "link": "https://stackoverflow.com/users/9017062/onelineatthetime"}, "edited": false, "score": 0, "creation_date": 1515537897, "post_id": 48177437, "comment_id": 83335635, "body": "Yes I think so. If I was to do that I could probably get rid of the second where condition in the query I posted above."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 9017062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-w_MBXm4bvUk/AAAAAAAAAAI/AAAAAAAAAXw/occAeJNEVXE/photo.jpg?sz=128", "display_name": "OneLineAtTheTime", "link": "https://stackoverflow.com/users/9017062/onelineatthetime"}, "edited": false, "score": 0, "creation_date": 1515537565, "post_id": 48177530, "comment_id": 83335519, "body": "I should share that my query is fired in VBA but uses a DoCmd.OpenQuery that calls a SQL query so I do get the dialog as you correctly indicate. However if I count records it shouldn&#39;t work because the record will be there, whether the user attempted a duplicate or not... I think I should run a SELECT IN query before the above SQL is called to verify if the record is there already and if there exit the sub."}, {"owner": {"reputation": 19, "user_id": 4496629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/385e6d6fc715e1a458e3c7793e61d47a?s=128&d=identicon&r=PG&f=1", "display_name": "Donald Varona", "link": "https://stackoverflow.com/users/4496629/donald-varona"}, "reply_to_user": {"reputation": 43, "user_id": 9017062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-w_MBXm4bvUk/AAAAAAAAAAI/AAAAAAAAAXw/occAeJNEVXE/photo.jpg?sz=128", "display_name": "OneLineAtTheTime", "link": "https://stackoverflow.com/users/9017062/onelineatthetime"}, "edited": false, "score": 0, "creation_date": 1515541210, "post_id": 48177530, "comment_id": 83336653, "body": "Yes, this is exactly what I mean-- run the select test query before you run the insert query.  Is that what you&#39;re saying?  You count the records from the select test query so see if it already exists; if there are none, you can safely insert without worry.  If there are some, then alert the user and don&#39;t do the insert."}, {"owner": {"reputation": 43, "user_id": 9017062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-w_MBXm4bvUk/AAAAAAAAAAI/AAAAAAAAAXw/occAeJNEVXE/photo.jpg?sz=128", "display_name": "OneLineAtTheTime", "link": "https://stackoverflow.com/users/9017062/onelineatthetime"}, "edited": false, "score": 0, "creation_date": 1515616857, "post_id": 48177530, "comment_id": 83372364, "body": "Yes correct. I ended up removing the record from the listbox I was using as recordsource thereby preventing duplicates but your suggestion was correct."}], "tags": [], "owner": {"reputation": 19, "user_id": 4496629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/385e6d6fc715e1a458e3c7793e61d47a?s=128&d=identicon&r=PG&f=1", "display_name": "Donald Varona", "link": "https://stackoverflow.com/users/4496629/donald-varona"}, "is_accepted": false, "score": 0, "last_activity_date": 1515536753, "creation_date": 1515536753, "answer_id": 48177530, "question_id": 48177437, "link": "https://stackoverflow.com/questions/48177437/msgbox-and-sql-insert-into-query/48177530#48177530", "title": "MsgBox and SQL &#39;Insert Into&#39; query", "body": "<p>MS Access is notoriously simplistic in how it handles records.  For example, you can call an insert from VBA (Database.Execute \"insert...\") and it might silently fail to insert; you have to go verify yourself that what you wanted written was actually inserted.  (The DoSQL action will pop up dialogs, however.)</p>\n\n<p>Since you are using VBA, I'd recommend that you first do the test in SQL yourself.  Either create a query object or execute the query text that selects whether the record exists (Recordset.RecordCount > 0), and then pop up a dialog informing the user about it.  You can't write this into the query text.</p>\n\n<p>Note that you might have to do a .MoveLast and .MoveFirst to get the actual record count, depending on the recordset type.</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 9017062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-w_MBXm4bvUk/AAAAAAAAAAI/AAAAAAAAAXw/occAeJNEVXE/photo.jpg?sz=128", "display_name": "OneLineAtTheTime", "link": "https://stackoverflow.com/users/9017062/onelineatthetime"}, "edited": false, "score": 0, "creation_date": 1515681935, "post_id": 48195798, "comment_id": 83400387, "body": "yes this is it. I removed the records from the source in this specific case but what you outline would be the correct way to check if the record is there and provide a message box before the user takes action."}], "tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": true, "score": 2, "last_activity_date": 1515617228, "creation_date": 1515617228, "answer_id": 48195798, "question_id": 48177437, "link": "https://stackoverflow.com/questions/48177437/msgbox-and-sql-insert-into-query/48195798#48195798", "title": "MsgBox and SQL &#39;Insert Into&#39; query", "body": "<p>This is how I would go about it:</p>\n\n<pre><code>If Nz(DLookup(\"Counterparty ID\",\"Netting_Determinations_List\",\"[Counterparty ID]=\" &amp; strCriteria),0)=0 then\n--Record does not exists, insert\nelse\n--record exists notify user\nend if\n</code></pre>\n\n<p>Don't bother trying to find out if a record was inserted. Much easier to check for the record first and take action accordingly.</p>\n"}], "owner": {"reputation": 43, "user_id": 9017062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-w_MBXm4bvUk/AAAAAAAAAAI/AAAAAAAAAXw/occAeJNEVXE/photo.jpg?sz=128", "display_name": "OneLineAtTheTime", "link": "https://stackoverflow.com/users/9017062/onelineatthetime"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "accepted_answer_id": 48195798, "answer_count": 2, "score": 0, "last_activity_date": 1515617228, "creation_date": 1515536191, "question_id": 48177437, "link": "https://stackoverflow.com/questions/48177437/msgbox-and-sql-insert-into-query", "title": "MsgBox and SQL &#39;Insert Into&#39; query", "body": "<p>In a MS-Access DB I have the below SQL query fired from a VBA module that appends a record given the conditions stated in the WHERE clause. My question is, can I insert a MsgBox that informs the user if the record already exists or weather is a new record? Currently the query will append a record if the value for the field called 'Counterparty ID' is already in the destination table, and won't if not. While the mechanics are correct, I would like to notify the user whether he/she has tried to insert a duplicate record. Is this somehow possible? I assume it would have to happen within the query itself.</p>\n\n<pre><code>\"INSERT INTO Netting_Determinations_List ([Counterparty ID], [Counterparty Name], [Counterparty Type], [Counterparty Subtype],[DTCC_AVOX_Registered_LEI_CICI], \" &amp; _\n        \"[Data Point 1],[Data Point 2],[Data Point 3],[Data Point 4],[Data Point 5], [Matrix Legal Form], [Matrix Governing/Authorizing Power], \" &amp; _\n        \"[OnBoardings Color Determination], [Matrix Clarification],  [Audit_Append_User], [Audit_Append_Date], [Audit_Append_Time]) \" &amp; _\n        \"SELECT Repository_Redux.[Counterparty ID], Repository_Redux.[Counterparty Name], Repository_Redux.[Counterparty Type], Repository_Redux.[Counterparty Subtype], Repository_Redux.[DTCC_AVOX_Registered_LEI_CICI], \" &amp; _\n        \"[Forms]![Frm_Master_Form]![Txt_Input_1] AS [Data Point 1], [Forms]![Frm_Master_Form]![Txt_Input_2] AS [Data Point 2], \" &amp; _\n        \"[Forms]![Frm_Master_Form]![Txt_Input_3] AS [Data Point 3], [Forms]![Frm_Master_Form]![Txt_Input_4] AS [Data Point 4], \" &amp; _\n        \"[Forms]![Frm_Master_Form]![Txt_Input_5] AS [Data Point 5], [Forms]![Frm_Master_Form]![Cbo_LegalForm] AS [Matrix Legal Form], \" &amp; _\n        \"[Forms]![Frm_Master_Form]![Cbo_Status] AS [Matrix Governing/Authorizing Power], [Forms]![Frm_Master_Form]![Txt_Color] AS [OnBoardings Color Determination], \" &amp; _\n        \"[Forms]![Frm_Master_Form]![Txt_Matrix_Clarification] AS [Matrix Clarification], '\" &amp; strUsername &amp; \"' AS [Audit_Append_User], \" &amp; _\n        \"'\" &amp; StrDate &amp; \"' AS [Audit_Append_Date], '\" &amp; StrTime &amp; \"' AS [Audit_Append_Time] FROM Repository_Redux \" &amp; _\n        \"WHERE Repository_Redux.[Counterparty ID] IN (\" &amp; strCriteria &amp; \") AND NOT EXISTS (SELECT [Counterparty ID] FROM Netting_Determinations_List WHERE [Counterparty ID] = (\" &amp; strCriteria &amp; \"))\"\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1515535712, "post_id": 48177314, "comment_id": 83334830, "body": "<code>VBCRLF</code> or <code>chr(13)</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515535794, "post_id": 48177314, "comment_id": 83334864, "body": "If the values have been entered into the TextBox with a <code>vbNewLine</code> separator, use <code>Split(text, vbNewLine)</code>."}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515535879, "post_id": 48177314, "comment_id": 83334896, "body": "@YowE3K will this work for copy pasting from a notepad as well? What if I copy the text directly from another spreadsheet and paste it directly in there too?"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515536234, "post_id": 48177314, "comment_id": 83335035, "body": "@YowE3K Also, that worked perfect actually... maybe a little bit more research on my part and I probably wouldn&#39;t have had to waste your time. Could have thought I tried everything at that point! Appreciate your help! Please post an answer here so i can mark as answered"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515536305, "post_id": 48177314, "comment_id": 83335057, "body": "Notepad probably uses CR/LF as line separators (that&#39;s fairly standard for text files on Windows systems) so I would specifically use <code>vbCrLf</code> for that, but <code>vbCrLf</code> and <code>vbNewLine</code> are both <code>x0D0A</code> in Windows."}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1515536668, "post_id": 48177314, "comment_id": 83335184, "body": "Tested with copying from Notepad and copying straight from Excel and both work using <code>vbNewLine</code>"}, {"owner": {"reputation": 532, "user_id": 8994815, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/8994815/acatinlove"}, "edited": false, "score": 0, "creation_date": 1515544579, "post_id": 48177314, "comment_id": 83337441, "body": "It depends on the source of the text and the options. There are two text edit controls in Windows, the standard edit control and the rich edit control (that cam mimic an edit control). Edit controls use CRLF. Rich Edit controls use CR by default but the programmer can say use CRLF. Edit controls ignores CR (it becomes a zero width character) unless it precedes a LF. Coping and pasting from richedit or internet can paste CR that notepad ignores. However VBScript does break lines on CR causing bugs that you can&#39;t see, what looks like one line of code to you is two broken lines to VBS."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1515536899, "post_id": 48177505, "comment_id": 83335280, "body": "The awesome thing about <code>vbNewLine</code>, is that if you run your code on a Mac, it won&#39;t break :-)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515540445, "post_id": 48177505, "comment_id": 83336441, "body": "@Mat&#39;sMug But who would be silly enough to run their code on a Mac?!?!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1515541261, "post_id": 48177505, "comment_id": 83336674, "body": "<i>Raises hand</i> no idea, but if portability is a concern, it&#39;s good to know ;-)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515543303, "post_id": 48177505, "comment_id": 83337191, "body": "@Mat&#39;sMug I knew there was a difference between Mac and Windows, and thought it was <code>vbNewLine</code> that was the constant that was os-dependent, so made sure I said &quot;normally equivalent to ...&quot; in the answer.     (Sane people &quot;normally&quot; use Windows!)  Out of curiosity, what does a Mac use?  Is it just a LF?  (I&#39;ll update the answer to add a note to that effect if you let me know.  Or you can update it if your like.)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515543518, "post_id": 48177505, "comment_id": 83337235, "body": "Good question. They<i>forced me</i> to make my code work on a Mac, no worries... I can find out for sure tomorrow, ...IIRC it&#39;s <code>vbLf</code>, but don&#39;t quote me on that (MSDN has all the info)"}, {"owner": {"reputation": 113, "user_id": 4019094, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Vd8QzlfS03s/AAAAAAAAAAI/AAAAAAAACBI/Dpq0XJ69oLQ/photo.jpg?sz=128", "display_name": "Jaco-Ben Vosloo", "link": "https://stackoverflow.com/users/4019094/jaco-ben-vosloo"}, "edited": false, "score": 0, "creation_date": 1566458418, "post_id": 48177505, "comment_id": 101664170, "body": "This solution did not work for me, as my text used <code>vbLf</code>. I would prefer the solution presented by @user6576927 and simply add all the possible combinations of line breaks (For Mac and Windows). That way I never have to worry about the OS or the string format."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 7, "last_activity_date": 1515536580, "creation_date": 1515536580, "answer_id": 48177505, "question_id": 48177314, "link": "https://stackoverflow.com/questions/48177314/using-split-as-newline-delimiter-vba/48177505#48177505", "title": "Using Split() as NewLine Delimiter VBA", "body": "<p>If your TextBox has been set up to separate values using <code>vbNewLine</code> then use <code>vbNewLine</code> as your separator in the <code>Split</code> function, i.e. <code>Split(text, vbNewLine)</code>.</p>\n\n<p><code>vbNewLine</code> is normally equivalent to <code>Chr(13) &amp; Chr(10)</code> (i.e. a CR/LF combination).  This will therefore be the same as <code>vbCrLf</code>, so all the following should work:</p>\n\n<pre><code>data = Split(frmDeleteLines.textData, vbNewLine)\ndata = Split(frmDeleteLines.textData, vbCrLf)\ndata = Split(frmDeleteLines.textData, Chr(13) &amp; Chr(10))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1515601913, "post_id": 48178570, "comment_id": 83364352, "body": "This is actually very helpful too, thank you for your input"}, {"owner": {"reputation": 113, "user_id": 4019094, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Vd8QzlfS03s/AAAAAAAAAAI/AAAAAAAACBI/Dpq0XJ69oLQ/photo.jpg?sz=128", "display_name": "Jaco-Ben Vosloo", "link": "https://stackoverflow.com/users/4019094/jaco-ben-vosloo"}, "edited": false, "score": 0, "creation_date": 1566458288, "post_id": 48178570, "comment_id": 101664097, "body": "This is a great solution as you can cater for all possible line breaks in the text."}, {"owner": {"reputation": 196, "user_id": 3432330, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DkR82.png?s=128&g=1", "display_name": "mheim", "link": "https://stackoverflow.com/users/3432330/mheim"}, "edited": false, "score": 1, "creation_date": 1592476873, "post_id": 48178570, "comment_id": 110442020, "body": "Shouldn&#39;t the first line be <code>Function splitLineBreaks(ByVal str As String) As Variant</code> At least for me, it fails to compile if the return value is String instead of Variant."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6576927"}, "is_accepted": false, "score": 7, "last_activity_date": 1515544123, "last_edit_date": 1515544123, "creation_date": 1515543428, "answer_id": 48178570, "question_id": 48177314, "link": "https://stackoverflow.com/questions/48177314/using-split-as-newline-delimiter-vba/48178570#48178570", "title": "Using Split() as NewLine Delimiter VBA", "body": "<p>You can accomplish this in function form:</p>\n\n<pre><code>Function splitLineBreaks(ByVal str As String) As String\n    str = Replace(str, vbCrLf, vbCr)\n    str = Replace(str, vbLf, vbCr)\n    splitLineBreaks = Split(str, vbCr)\nEnd Function\n</code></pre>\n\n<p>The history of these constants come from the type writer days;  </p>\n\n<p><code>vbCr</code> is <em>Carriage Return</em> (would return the head to the start of the typewriter)<br>\n<code>vbLF</code> is <em>Line Feed</em> (would move the page one line up)<br>\nand often times these two would be combined because it only made sense, into:<br>\n<code>vbCrLf</code> is <em>Carriage Return/Line Feed</em>  </p>\n\n<p>Depending on the software you are using, each one of these might do exactly the same thing, or maybe not. But it's always a good idea to check for all these constants when you are looking for your new lines.</p>\n"}], "owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19274, "favorite_count": 0, "accepted_answer_id": 48177505, "answer_count": 2, "score": 6, "last_activity_date": 1515544123, "creation_date": 1515535427, "last_edit_date": 1531164843, "question_id": 48177314, "link": "https://stackoverflow.com/questions/48177314/using-split-as-newline-delimiter-vba", "title": "Using Split() as NewLine Delimiter VBA", "body": "<p><strong>INTRODUCTION</strong></p>\n\n<p>I'm trying to delete a line, and if that value from this line is found in the array.</p>\n\n<p>The values are being entered into a TextBox on a Userform with each value separated by the <code>NewLine</code> character.</p>\n\n<p>I think I've managed to pinpoint that the logic is faulty in the <code>Split()</code> function. From the research online, I've seen people using...</p>\n\n<pre><code>Split(text, Chr(10))\nSplit(text, Chr(16))\nSplit(text, vbLf)\n</code></pre>\n\n<p>None of these values (<code>Chr(10)</code>,<code>Chr(16)</code>,<code>vbLf</code>) seem to be working as intended... What seems to be happening is that it will find the <code>NewLine</code> character but it's not removing it from the string and keeping the value when placed into the array.</p>\n\n<p><strong>CODE</strong></p>\n\n<p>Filling in the data...</p>\n\n<pre><code>data() = Split(frmDeleteLines.textData, Chr(10))\n''''' Also tested Chr(16) and vbLf\n</code></pre>\n\n<p>Deleting the lines...</p>\n\n<pre><code>Private Sub DeleteLines(textArr() As String, column As Long)\n\n   Dim LR As Long\n\n   LR = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).row\n\n   With ActiveSheet\n      For i = LR To 3 Step -1\n         If Not (SearchArray(.Cells(i, column), textArr())) Then '&lt;--- Call search array\n            .Cells(i, column).EntireRow.Delete 'Delete row if found\n         End If\n      Next i\n   End With\n\nEnd Sub\n</code></pre>\n\n<p>Searching the array with the compared value...</p>\n\n<pre><code>Private Function SearchArray(searchValue As String, textArr() As String) As Boolean\n\n   SearchArray = False\n\n   For i = LBound(textArr()) To UBound(textArr())\n      Debug.Print \"Comparing: \"\n      Debug.Print \"   ARR: \" &amp; textArr(i)\n      Debug.Print \"   VAL: \" &amp; searchValue\n      If (searchValue = textArr(i)) Then\n         SearchArray = True\n         Debug.Print \"       DONT DELETE!!!!!\"\n         Exit For\n      End If\n   Next i\n\nEnd Function\n</code></pre>\n\n<p>The <code>Debug.Print</code> were for debugging purposes and that's what made me believe the <code>Split()</code> function wasn't doing as intended... To my understand the delimiter in the <code>Split()</code> function will not be included in the array it's being placed in. Maybe there's something more to it for the <code>NewLine</code> value?</p>\n\n<p><strong>INPUT</strong></p>\n\n<pre><code>123456\n789456\n456123\n456789\n</code></pre>\n\n<p><strong>COMPARED VALUES</strong></p>\n\n<pre><code> |_____A____|_____B____|_____C____|\n1|  123456  |   BLAH   |   BLAH   |\n2|  487964  |   BLAH   |   BLAH   |\n3|  456123  |   BLAH   |   BLAH   |\n4|  753496  |   BLAH   |   BLAH   |\n</code></pre>\n\n<p><strong>FINAL RESULT</strong></p>\n\n<pre><code> |_____A____|_____B____|_____C____|\n1|  123456  |   BLAH   |   BLAH   |\n2|          |          |          |\n3|          |          |          |\n4|          |          |          |\n</code></pre>\n\n<p>In theory it should be keeping rows <code>1</code> and <code>3</code> but it's deleting all of them...</p>\n\n<p>When I viewed the immediate window, I noticed that the values being output were as follows...</p>\n\n<pre><code>Comparing: \n   ARR: 123456\n   VAL: 123456\nComparing: \n   ARR: 789456\n\n   VAL: 123456\nComparing: \n   ARR: 456123\n\n   VAL: 123456\nComparing: \n   ARR: 456789\n   VAL: 123456\n</code></pre>\n\n<p><strong>QUESTION AT HAND</strong></p>\n\n<p>Is it my logic that is incorrect? Or is there something funky going on with the <code>Split()</code> function in conjunction with the <code>NewLine</code> value?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1515533727, "post_id": 48176775, "comment_id": 83333975, "body": "You&#39;d see that error if there was no sheet with that name.  Does that sheet exist in every workbook?  FYI you have two <code>ws.Range(...).Copy</code> in a row there - the first line will have no effect.  Also you&#39;re not altering the opened workbooks, so you can use <code>wb.Close False</code>"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1515534612, "post_id": 48176775, "comment_id": 83334357, "body": "@TimWilliams Does that error normally come up with a missing sheet? If I try accessing a sheet that doesn&#39;t exist, I generally get a <code>Subscript Out of Range Error 9</code> type error. This reported error code seems to popup when trying to access a sheet in an unopened workbook. But his code doesn&#39;t throw an error when opening the workbook (so it should be open). As an example, if you <code>Set wb = Workbooks.Open... wb.Close Set ws = wb.Worksheets(&quot;Sheet1&quot;)</code> you&#39;d get the referenced error."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1515534620, "post_id": 48176775, "comment_id": 83334360, "body": "might be an idea to also add <code>Dim ws as Worksheet</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1515534884, "post_id": 48176775, "comment_id": 83334482, "body": "When it breaks on the error is the workbook open, and does it have a sheet with that name?  It&#39;s easy to check..."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 2, "creation_date": 1515536232, "post_id": 48176775, "comment_id": 83335033, "body": "^^^^ Declare your ws as a worksheet.  It might have to be active to set it.  You don&#39;t have to worry about your master you already set it when active."}, {"owner": {"reputation": 47, "user_id": 1787011, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3fc66d89d703a531980412533b1f2698?s=128&d=identicon&r=PG", "display_name": "APW", "link": "https://stackoverflow.com/users/1787011/apw"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1515591240, "post_id": 48176775, "comment_id": 83356931, "body": "@TimWilliams I just updated my code. I have confirmed that the workbook I am opening has a sheet named &quot;Project Log&quot;"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 1, "creation_date": 1515597154, "post_id": 48176775, "comment_id": 83360930, "body": "Look at the code below, the important steps are setting your current workbook, getting a filename, opening that workbook and then setting it.  Now you have two workbook references and likely at least 2 worksheet references.  You can set the second workbook after opening it, it wont do this right if you don&#39;t open it first IMHO."}], "answers": [{"tags": [], "owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "is_accepted": true, "score": 2, "last_activity_date": 1515536724, "creation_date": 1515536724, "answer_id": 48177526, "question_id": 48176775, "link": "https://stackoverflow.com/questions/48176775/vba-run-time-automation-error-code-execution-has-been-interrupted/48177526#48177526", "title": "VBA: Run-Time Automation Error - &quot;Code execution has been interrupted&quot;", "body": "<pre><code>   Dim Finfo As String\n    Dim FilterIndex As Long\n    Dim Title As String\n    Dim CopyBook As Workbook\n    Dim CopySheet As Worksheet\n    Dim ForecastFileName As Variant \n    Dim MasterSheet AS Worksheet\n\nSet MasterSheet = ThisWorkbook.Worksheets(\"Yoursheetname\")\n'now you can always use master sheet after you set copybook \n\n  'Set up file filter\n    Finfo = \"Excel Files (*.xls*),*.xls*\"\n    'Set filter index to Excel Files by default in case more are added\n    FilterIndex = 1\n    ' set Caption for dialogue box\n    Title = \"Hey there!, select a file\"\n\n    'get the Forecast Filename\n    ForecastFileName = Application.GetOpenFilename(Finfo, FilterIndex, Title)\n\n'Change this according to what you need for workbook and worksheet names\nWorkbooks.Open (ForecastFileName)\nSet CopyBook = ActiveWorkbook\nSet CopySheet = CopyBook.Worksheets(1)\n\n'Do your code, remember to close\n\nCopyBook.Close savechanges:=False 'Not needed now\n</code></pre>\n\n<p>You might want to check for the ForecastFileName being False, that is when the users x's out, you will also want to do a little validation the wb sheet is in the right format by checking column headers ect or you will wind up crashing.</p>\n"}], "owner": {"reputation": 47, "user_id": 1787011, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3fc66d89d703a531980412533b1f2698?s=128&d=identicon&r=PG", "display_name": "APW", "link": "https://stackoverflow.com/users/1787011/apw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 904, "favorite_count": 0, "accepted_answer_id": 48177526, "answer_count": 1, "score": 1, "last_activity_date": 1551375396, "creation_date": 1515532621, "last_edit_date": 1551375396, "question_id": 48176775, "link": "https://stackoverflow.com/questions/48176775/vba-run-time-automation-error-code-execution-has-been-interrupted", "title": "VBA: Run-Time Automation Error - &quot;Code execution has been interrupted&quot;", "body": "<p>I'm attempting to write a program to loop through a directory of excel files and copy a range into a \"Master Workbook\". When I run the program I am prompted with \"Code execution has been interrupted\". If I select continue the code will successfully run but then a \"run-time error '-2147221080' Automation error\" appears. </p>\n\n<p>The line that causes the error is:</p>\n\n<pre><code> Set ws = wb.Worksheets(\"Project Log\")\n</code></pre>\n\n<p>My question is, why is this line causing the error and or is there a way to bypass the error prompt so that my code will successfully run?</p>\n\n<pre><code> Sub FileCompiler()\n Dim folderPath As String\n Dim Filename As String\n Dim wb As Workbook\n Dim Masterwb As Workbook\n Dim ws as Worksheet\n'set workbook in which data will be copied to\nSet Masterwb = ActiveWorkbook\n\n'declare path\n'folderPath = \"C:MyPath\\\"\n\nIf Right(folderPath, 1) &lt;&gt; \"\\\" Then folderPath = folderPath &amp; \"\\\"\n\n'compile directory data to master spreadsheet\nFilename = Dir(folderPath &amp; \"*.xls*\")\nDo While Filename &lt;&gt; \"\"\n    Application.ScreenUpdating = False\n    Set wb = Workbooks.Open(folderPath &amp; Filename)\n    Set ws = wb.Worksheets(\"Project Log\")\n    ws.Range(ws.Cells(2, \"C\"), ws.Cells(2, \"C\")).Copy\n    Masterwb.Worksheets(\"Staging\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial\n    ws.Range(ws.Cells(7, \"A\"), ws.Cells(Rows.Count, \"K\").End(xlUp)).Copy\n    Masterwb.Worksheets(\"Staging\").Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial\n    wb.Close True\n    Filename = Dir\nLoop\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1515532125, "post_id": 48176590, "comment_id": 83333259, "body": "The number you are trying to trap is <code>-2147188160</code> and you only test for <code>-2147024809</code> That&#39;s why you don&#39;t get a message?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1515532532, "post_id": 48176590, "comment_id": 83333452, "body": "@ScottHoltzman Okay that was my bad - okay I swapped the number to -2147024809 and now I&#39;m not catching the error at all. I also can&#39;t place <code>-2147188160 (80048240)</code> in there without getting a compile error... so how should I try to catch this?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1515532732, "post_id": 48176590, "comment_id": 83333534, "body": "Where&#39;s the code that actually generates the error? Do you not want to <i>avoid</i> throwing that error?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515532880, "post_id": 48176590, "comment_id": 83333600, "body": "@Mat&#39;sMug I went ahead and added it"}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1515543626, "post_id": 48176590, "comment_id": 83337246, "body": "For testing add MsgBox Err.Number to your Handle"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 1, "creation_date": 1515601436, "post_id": 48176590, "comment_id": 83364026, "body": "&gt;&gt; so you are creating four powerpoint instances   Not so. PPT only allows one instance of itself, except in certain instances where MS breaks the rules."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515617516, "post_id": 48176590, "comment_id": 83372698, "body": "@YowE3K Thanks for your comment YowE3K - yes, as Steve said I&#39;m only using one instance of PowerPoint, and opening, saving and closing a new presentation within it each time until the end when I quit the one instance."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515617659, "post_id": 48176590, "comment_id": 83372784, "body": "@dwirony You should still move the <code>Set PPT = New PowerPoint.Application</code> to before the loop - just in case MS ever fixes that issue and <b>does</b> allow new <code>PowerPoint.Application</code> instances to be created."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515617734, "post_id": 48176590, "comment_id": 83372812, "body": "@YowE3K Done - thanks for that suggestion"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1515718577, "post_id": 48176590, "comment_id": 83418145, "body": "You might try using <code>sourcerange.CopyPicture</code> instead of <code>sourcerange.Copy</code>.  Or check here: <a href=\"https://stackoverflow.com/questions/20139130/error-when-pasting-slide-the-specified-data-type-is-unavailable\" title=\"error when pasting slide the specified data type is unavailable\">stackoverflow.com/questions/20139130/&hellip;</a>  or here <a href=\"https://stackoverflow.com/questions/18851609/copy-from-excel-to-powerpoint-error\" title=\"copy from excel to powerpoint error\">stackoverflow.com/questions/18851609/&hellip;</a>"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1515764220, "post_id": 48176590, "comment_id": 83436488, "body": "@TimWilliams Hi Tim - by chance <code>.Copy</code> to <code>.CopyPicture</code> my new inconsistent error <code>CopyPicture method of range class failed</code>, but thanks for that suggestion! Also, I&#39;ve tried <code>DoEvents</code> but still receive the my original error - and I&#39;m sure the <code>Wait</code> solution would work, but I&#39;m not satisified with that as a true soluiton..."}], "answers": [{"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1515617552, "post_id": 48178629, "comment_id": 83372721, "body": "Thank you for your answer - I believe my initial finding was due to a mispelling in the <code>Err.Number</code>. I&#39;m still particularly interested in catching and fixing this specific error for the time being."}], "tags": [], "owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "is_accepted": false, "score": 0, "last_activity_date": 1515642060, "last_edit_date": 1515642060, "creation_date": 1515543983, "answer_id": 48178629, "question_id": 48176590, "link": "https://stackoverflow.com/questions/48176590/trying-to-use-handling-to-catch-run-time-error-2147188160-80048240/48178629#48178629", "title": "Trying to use handling to catch Run-time error -2147188160 (80048240)", "body": "<p>This could be due to the fact that another error with another error number is raised while the macro runs. To avoid missing this error, you can add a different message if the number is not the one you want.</p>\n\n<pre><code>Handle:\nIf Err.Number = -2147188160 Then\n    PPT.Quit\n    MsgBox \"Hey look I broke!\"\nelse\n    MsgBox(\"Run-time error '\" &amp; Err.Number &amp; \"': \" &amp; Err.Description, vbCritical, \"Error\")\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1516026895, "post_id": 48256312, "comment_id": 83512999, "body": "Thanks for your answer - when trying to use this I&#39;m getting the error &quot;Vba compile error function or interface marked as restricted, or the function uses an automation type not supported in Visual Basic&quot;."}, {"owner": {"reputation": 6686, "user_id": 9086466, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JI5yN.png?s=128&g=1", "display_name": "Ctznkane525", "link": "https://stackoverflow.com/users/9086466/ctznkane525"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1516026972, "post_id": 48256312, "comment_id": 83513042, "body": "you mind showing the full code you are using...once its included into it...where&#39;s the error pointing to?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1516028728, "post_id": 48256312, "comment_id": 83514025, "body": "Yes I&#39;ll post the updated code. I get the compile error and it highlights <code>Sub KillProcess(ByVal app As PowerPoint.Application</code>, and the highlighted part of that sub is <code>.hwnd</code> in <code>windowProcessId = ProcIDFromWnd(app.ActiveWindow.hwnd)</code>"}, {"owner": {"reputation": 6686, "user_id": 9086466, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JI5yN.png?s=128&g=1", "display_name": "Ctznkane525", "link": "https://stackoverflow.com/users/9086466/ctznkane525"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1516041795, "post_id": 48256312, "comment_id": 83521100, "body": "for whatever reason...ppt doesnt have the hwnd property...had to do this a bit differently...please see the update @dwirony"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1516043556, "post_id": 48256312, "comment_id": 83521908, "body": "@Ctnzkane525 Fantastic!!! This works perfectly - such a great solution, thank you for help! This is going to make my automatic PowerPoint creation damn near flawless now!"}, {"owner": {"reputation": 6686, "user_id": 9086466, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JI5yN.png?s=128&g=1", "display_name": "Ctznkane525", "link": "https://stackoverflow.com/users/9086466/ctznkane525"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1516043971, "post_id": 48256312, "comment_id": 83522096, "body": "glad to help you out"}], "tags": [], "owner": {"reputation": 6686, "user_id": 9086466, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JI5yN.png?s=128&g=1", "display_name": "Ctznkane525", "link": "https://stackoverflow.com/users/9086466/ctznkane525"}, "is_accepted": true, "score": 1, "last_activity_date": 1516041771, "last_edit_date": 1516041771, "creation_date": 1515984167, "answer_id": 48256312, "question_id": 48176590, "link": "https://stackoverflow.com/questions/48176590/trying-to-use-handling-to-catch-run-time-error-2147188160-80048240/48256312#48256312", "title": "Trying to use handling to catch Run-time error -2147188160 (80048240)", "body": "<p>If the PowerPoint isn't quitting, it is probably due to some open references sitting out there.  You are in a weird state due to the error so I recommend you kill the process associated with the main window handle (wouldn't recommend this in an abnormal state).</p>\n\n<p>In this case, you'll need to know which PPT processes were started by the automation and kill those.</p>\n\n<p>This process gets the process at the start (PPT only) and the processes at the end, and kills the new one.</p>\n\n<pre><code>Public PpProcesses() As Integer\n\nSub GeneratePowerPoints()\n\n\n    Call SaveProcesses\n\n'For using powerpoint\nDim dummyfile As String\nDim PPT As PowerPoint.Application\nDim myPresentation As PowerPoint.Presentation\nDim MySlide As Object\nDim MyShape As Object\n\nDim j As Long, allhotels() As Variant, sourcerange As Range, sourcebook As String\nDim d As Date, e As Date, f As Date, lastmonth As String, twomonthsago As String, threemonthsago As String\n\n'Get some month names\nd = DateAdd(\"m\", -1, Now)\ne = DateAdd(\"m\", -2, Now)\nf = DateAdd(\"m\", -3, Now)\nlastmonth = Format(d, \"mmmm\")\ntwomonthsago = Format(e, \"mmmm\")\nthreemonthsago = Format(f, \"mmmm\")\n\nsourcebook = \"BT Strat Sheet.xlsm\"\nallhotels = Array(\"SBH\", \"WBOS\", \"WBW\", \"WCP\")\ndummyfile = \"P:\\BT\\BT 2017\\BT Strategy Meetings\\2017\\Hotel Strat Meeting Dummy File.pptx\"\n\nOn Error GoTo Handle\nFor j = 0 To 3\n\n    Set PPT = New PowerPoint.Application\n    PPT.Visible = True\n    PPT.Presentations.Open Filename:=dummyfile\n\n    'SLIDE ONE\n    Set sourcerange = Workbooks(sourcebook).Worksheets(allhotels(j)).Range(\"A2:J21\")\n    sourcerange.Copy\n    PPT.ActivePresentation.Slides(1).Shapes.PasteSpecial DataType:=2\n    Set MyShape = PPT.ActivePresentation.Slides(1).Shapes(PPT.ActivePresentation.Slides(1).Shapes.Count)\n\n    'Set size\n    MyShape.Left = 152\n    MyShape.Top = 152\n    MyShape.Height = 500\n    MyShape.Width = 650\n\n    'SLIDE TWO\n    Set sourcerange = Workbooks(sourcebook).Worksheets(allhotels(j)).Range(\"A82:J91\")\n    sourcerange.Copy\n    PPT.ActivePresentation.Slides(2).Shapes.PasteSpecial DataType:=2\n    Set MyShape = PPT.ActivePresentation.Slides(2).Shapes(PPT.ActivePresentation.Slides(2).Shapes.Count)\n\n    'Set size\n    MyShape.Left = 152\n    MyShape.Top = 92\n    MyShape.Height = 500\n    MyShape.Width = 650\n\n    'SLIDE TWO\n    Set sourcerange = Workbooks(sourcebook).Worksheets(allhotels(j)).Range(\"A94:J103\")\n    sourcerange.Copy\n    PPT.ActivePresentation.Slides(2).Shapes.PasteSpecial DataType:=2\n    Set MyShape = PPT.ActivePresentation.Slides(2).Shapes(PPT.ActivePresentation.Slides(2).Shapes.Count)\n\n    'Set size\n    MyShape.Left = 152\n    MyShape.Top = 300\n    MyShape.Height = 500\n    MyShape.Width = 650\n\n    'SLIDE THREE\n    Set sourcerange = Workbooks(sourcebook).Worksheets(allhotels(j)).Range(\"A24:J43\")\n    sourcerange.Copy\n    PPT.ActivePresentation.Slides(3).Shapes.PasteSpecial DataType:=2\n    Set MyShape = PPT.ActivePresentation.Slides(3).Shapes(PPT.ActivePresentation.Slides(3).Shapes.Count)\n\n    'Set size\n    MyShape.Left = 152\n    MyShape.Top = 152\n    MyShape.Height = 500\n    MyShape.Width = 650\n\n    'SLIDE FOUR\n    Set sourcerange = Workbooks(sourcebook).Worksheets(allhotels(j)).Range(\"A58:J67\")\n    sourcerange.Copy\n    PPT.ActivePresentation.Slides(4).Shapes.PasteSpecial DataType:=2\n    Set MyShape = PPT.ActivePresentation.Slides(4).Shapes(PPT.ActivePresentation.Slides(4).Shapes.Count)\n\n    'Set size\n    MyShape.Left = 152\n    MyShape.Top = 120\n    MyShape.Height = 500\n    MyShape.Width = 650\n\n    'SLIDE FOUR\n    Set sourcerange = Workbooks(sourcebook).Worksheets(allhotels(j)).Range(\"A46:J55\")\n    sourcerange.Copy\n    PPT.ActivePresentation.Slides(4).Shapes.PasteSpecial DataType:=2\n    Set MyShape = PPT.ActivePresentation.Slides(4).Shapes(PPT.ActivePresentation.Slides(4).Shapes.Count)\n\n    'Set size\n    MyShape.Left = 152\n    MyShape.Top = 335\n    MyShape.Height = 500\n    MyShape.Width = 650\n\n    'SLIDE FIVE\n    Set sourcerange = Workbooks(sourcebook).Worksheets(allhotels(j)).Range(\"A70:J79\")\n    sourcerange.Copy\n    PPT.ActivePresentation.Slides(5).Shapes.PasteSpecial DataType:=2\n    Set MyShape = PPT.ActivePresentation.Slides(5).Shapes(PPT.ActivePresentation.Slides(5).Shapes.Count)\n\n    'Set size\n    MyShape.Left = 152\n    MyShape.Top = 152\n    MyShape.Height = 500\n    MyShape.Width = 650\n\n    'Find and replace month placeholders\n    'Straight boilerplate\n    Dim sld As Slide, shp As PowerPoint.Shape, i As Long\n\n    For Each sld In PPT.ActivePresentation.Slides\n        For Each shp In sld.Shapes\n            If shp.HasTextFrame Then\n                If shp.TextFrame.HasText Then\n                    shp.TextFrame.TextRange.Text = Replace(shp.TextFrame.TextRange.Text, \"LastMonth\", lastmonth)\n                End If\n            End If\n        Next shp\n    Next sld\n\n    For Each sld In PPT.ActivePresentation.Slides\n        For Each shp In sld.Shapes\n            If shp.HasTextFrame Then\n                If shp.TextFrame.HasText Then\n                    shp.TextFrame.TextRange.Text = Replace(shp.TextFrame.TextRange.Text, \"TwoMonthsAgo\", twomonthsago)\n                End If\n            End If\n        Next shp\n    Next sld\n\n    For Each sld In PPT.ActivePresentation.Slides\n        For Each shp In sld.Shapes\n            If shp.HasTextFrame Then\n                If shp.TextFrame.HasText Then\n                    shp.TextFrame.TextRange.Text = Replace(shp.TextFrame.TextRange.Text, \"ThreeMonthsAgo\", threemonthsago)\n                End If\n            End If\n        Next shp\n    Next sld\n\n    'Save it\n    PPT.ActivePresentation.SaveAs \"P:\\BT\\BT File Drop-off Location\\\" &amp; allhotels(j) &amp; \" \" &amp; lastmonth &amp; \" Strat Meeting.pptx\"\n\n    'Close it\n    PPT.ActivePresentation.Close\nNext j\n\n'Exit PowerPoint\nPPT.Quit\nExit Sub\n\nHandle:\nMsgBox Err.Number\nCall KillProcess\nMsgBox \"Hey look I broke!\"\n\nEnd Sub\n\n\nPublic Sub SaveProcesses()\n\n    ReDim PpProcesses(1 To 1)\n\n    Dim oServ As Object\n    Dim cProc As Variant\n    Dim oProc As Object\n\n    Set oServ = GetObject(\"winmgmts:\")\n    Set cProc = oServ.ExecQuery(\"Select * from Win32_Process\")\n\n    For Each oProc In cProc\n\n        If UCase(oProc.Name) = \"POWERPNT.EXE\" Or UCase(oProc.Name) = \"POWERPNT\" Then\n\n            ReDim Preserve PpProcesses(1 To UBound(PpProcesses) + 1)\n            PpProcesses(UBound(PpProcesses)) = oProc.ProcessId\n\n        End If\n    Next\n\nEnd Sub\n\nSub KillProcess()\n\n    Dim index As Integer\n    index = -1\n\n    Dim oServ As Object\n    Dim cProc As Variant\n    Dim oProc As Object\n\n    Set oServ = GetObject(\"winmgmts:\")\n    Set cProc = oServ.ExecQuery(\"Select * from Win32_Process\")\n\n    For Each oProc In cProc\n\n         If UCase(oProc.Name) = \"POWERPNT.EXE\" Or UCase(oProc.Name) = \"POWERPNT\" Then\n\n\n            For i = LBound(PpProcesses) To UBound(PpProcesses)\n                If PpProcesses(i) = oProc.ProcessId Then\n                    index = i\n                    Exit For\n                End If\n            Next i\n\n            If index &gt;= 0 Then\n                'MsgBox (\"Process Found \" &amp; oProc.ProcessId)\n            Else\n                oProc.Terminate\n            End If\n         End If\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 627, "favorite_count": 0, "accepted_answer_id": 48256312, "answer_count": 2, "score": 2, "last_activity_date": 1516041771, "creation_date": 1515531752, "last_edit_date": 1516028946, "question_id": 48176590, "link": "https://stackoverflow.com/questions/48176590/trying-to-use-handling-to-catch-run-time-error-2147188160-80048240", "title": "Trying to use handling to catch Run-time error -2147188160 (80048240)", "body": "<p>I am trying to use <code>On Error GoTo Handle</code> to catch an inconsistent </p>\n\n<blockquote>\n  <p>Run-time error -2147188160 (80048240)</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/osHsc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/osHsc.png\" alt=\"enter image description here\"></a></p>\n\n<p>My code generates 4 powerpoints from an excel template, saves them and closes them. Here is my experimental error handling at the bottom:</p>\n\n<pre><code>'Exit PowerPoint\nPPT.Quit\nExit Sub\n\nHandle:\nIf Err.Number = -2147188160 Then\n    PPT.Quit\n    MsgBox \"Hey look I broke!\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>But in my testing, when I hit the error I don't get any error message, but my code doesn't run either. This leads me to believe that I <em>am</em> catching the error, but something else isn't firing. I've tried addressing the root cause of the error before but the solution has been to just add <code>Application.Wait</code> throughout my code, which I feel is unnecessary.</p>\n\n<p>In a perfect world I just want to catch the error, close PowerPoint and have it instantly run the code over again. Any insight?</p>\n\n<p>Full subroutine for those interested - The place of the error is inconsistent:</p>\n\n<pre><code>Public Declare Function GetWindowThreadProcessId Lib \"user32\" _\n      (ByVal hwnd As Long, lpdwprocessid As Long) As Long\nSub GeneratePowerPoints()\n\n'For using powerpoint\nDim dummyfile As String\nDim PPT As PowerPoint.Application\nDim myPresentation As PowerPoint.Presentation\nDim MySlide As Object\nDim MyShape As Object\n\nDim j As Long, allhotels() As Variant, sourcerange As Range, sourcebook As String\nDim d As Date, e As Date, f As Date, lastmonth As String, twomonthsago As String, threemonthsago As String\n\n'Get some month names\nd = DateAdd(\"m\", -1, Now)\ne = DateAdd(\"m\", -2, Now)\nf = DateAdd(\"m\", -3, Now)\nlastmonth = Format(d, \"mmmm\")\ntwomonthsago = Format(e, \"mmmm\")\nthreemonthsago = Format(f, \"mmmm\")\n\nsourcebook = \"BT Strat Sheet.xlsm\"\nallhotels = Array(\"SBH\", \"WBOS\", \"WBW\", \"WCP\")\ndummyfile = \"P:\\BT\\BT 2017\\BT Strategy Meetings\\2017\\Hotel Strat Meeting Dummy File.pptx\"\n\nOn Error GoTo Handle\nFor j = 0 To 3\n\n    Set PPT = New PowerPoint.Application\n    PPT.Visible = True\n    PPT.Presentations.Open Filename:=dummyfile\n\n    'SLIDE ONE\n    Set sourcerange = Workbooks(sourcebook).Worksheets(allhotels(j)).Range(\"A2:J21\")\n    sourcerange.Copy\n    PPT.ActivePresentation.Slides(1).Shapes.PasteSpecial DataType:=2\n    Set MyShape = PPT.ActivePresentation.Slides(1).Shapes(PPT.ActivePresentation.Slides(1).Shapes.Count)\n\n    'Set size\n    MyShape.Left = 152\n    MyShape.Top = 152\n    MyShape.Height = 500\n    MyShape.Width = 650\n\n    'SLIDE TWO\n    Set sourcerange = Workbooks(sourcebook).Worksheets(allhotels(j)).Range(\"A82:J91\")\n    sourcerange.Copy\n    PPT.ActivePresentation.Slides(2).Shapes.PasteSpecial DataType:=2\n    Set MyShape = PPT.ActivePresentation.Slides(2).Shapes(PPT.ActivePresentation.Slides(2).Shapes.Count)\n\n    'Set size\n    MyShape.Left = 152\n    MyShape.Top = 92\n    MyShape.Height = 500\n    MyShape.Width = 650\n\n    'SLIDE TWO\n    Set sourcerange = Workbooks(sourcebook).Worksheets(allhotels(j)).Range(\"A94:J103\")\n    sourcerange.Copy\n    PPT.ActivePresentation.Slides(2).Shapes.PasteSpecial DataType:=2\n    Set MyShape = PPT.ActivePresentation.Slides(2).Shapes(PPT.ActivePresentation.Slides(2).Shapes.Count)\n\n    'Set size\n    MyShape.Left = 152\n    MyShape.Top = 300\n    MyShape.Height = 500\n    MyShape.Width = 650\n\n    'SLIDE THREE\n    Set sourcerange = Workbooks(sourcebook).Worksheets(allhotels(j)).Range(\"A24:J43\")\n    sourcerange.Copy\n    PPT.ActivePresentation.Slides(3).Shapes.PasteSpecial DataType:=2\n    Set MyShape = PPT.ActivePresentation.Slides(3).Shapes(PPT.ActivePresentation.Slides(3).Shapes.Count)\n\n    'Set size\n    MyShape.Left = 152\n    MyShape.Top = 152\n    MyShape.Height = 500\n    MyShape.Width = 650\n\n    'SLIDE FOUR\n    Set sourcerange = Workbooks(sourcebook).Worksheets(allhotels(j)).Range(\"A58:J67\")\n    sourcerange.Copy\n    PPT.ActivePresentation.Slides(4).Shapes.PasteSpecial DataType:=2\n    Set MyShape = PPT.ActivePresentation.Slides(4).Shapes(PPT.ActivePresentation.Slides(4).Shapes.Count)\n\n    'Set size\n    MyShape.Left = 152\n    MyShape.Top = 120\n    MyShape.Height = 500\n    MyShape.Width = 650\n\n    'SLIDE FOUR\n    Set sourcerange = Workbooks(sourcebook).Worksheets(allhotels(j)).Range(\"A46:J55\")\n    sourcerange.Copy\n    PPT.ActivePresentation.Slides(4).Shapes.PasteSpecial DataType:=2\n    Set MyShape = PPT.ActivePresentation.Slides(4).Shapes(PPT.ActivePresentation.Slides(4).Shapes.Count)\n\n    'Set size\n    MyShape.Left = 152\n    MyShape.Top = 335\n    MyShape.Height = 500\n    MyShape.Width = 650\n\n    'SLIDE FIVE\n    Set sourcerange = Workbooks(sourcebook).Worksheets(allhotels(j)).Range(\"A70:J79\")\n    sourcerange.Copy\n    PPT.ActivePresentation.Slides(5).Shapes.PasteSpecial DataType:=2\n    Set MyShape = PPT.ActivePresentation.Slides(5).Shapes(PPT.ActivePresentation.Slides(5).Shapes.Count)\n\n    'Set size\n    MyShape.Left = 152\n    MyShape.Top = 152\n    MyShape.Height = 500\n    MyShape.Width = 650\n\n    'Find and replace month placeholders\n    'Straight boilerplate\n    Dim sld As Slide, shp As PowerPoint.Shape, i As Long\n\n    For Each sld In PPT.ActivePresentation.Slides\n        For Each shp In sld.Shapes\n            If shp.HasTextFrame Then\n                If shp.TextFrame.HasText Then\n                    shp.TextFrame.TextRange.Text = Replace(shp.TextFrame.TextRange.Text, \"LastMonth\", lastmonth)\n                End If\n            End If\n        Next shp\n    Next sld\n\n    For Each sld In PPT.ActivePresentation.Slides\n        For Each shp In sld.Shapes\n            If shp.HasTextFrame Then\n                If shp.TextFrame.HasText Then\n                    shp.TextFrame.TextRange.Text = Replace(shp.TextFrame.TextRange.Text, \"TwoMonthsAgo\", twomonthsago)\n                End If\n            End If\n        Next shp\n    Next sld\n\n    For Each sld In PPT.ActivePresentation.Slides\n        For Each shp In sld.Shapes\n            If shp.HasTextFrame Then\n                If shp.TextFrame.HasText Then\n                    shp.TextFrame.TextRange.Text = Replace(shp.TextFrame.TextRange.Text, \"ThreeMonthsAgo\", threemonthsago)\n                End If\n            End If\n        Next shp\n    Next sld\n\n    'Save it\n    PPT.ActivePresentation.SaveAs \"P:\\BT\\BT File Drop-off Location\\\" &amp; allhotels(j) &amp; \" \" &amp; lastmonth &amp; \" Strat Meeting.pptx\"\n\n    'Close it\n    PPT.ActivePresentation.Close\nNext j\n\n'Exit PowerPoint\nPPT.Quit\nExit Sub\n\nHandle:\nCall KillProcess(PPT)\nMsgBox \"Hey look I broke!\"\n\nEnd Sub\nSub KillProcess(ByVal app As PowerPoint.Application)\n\n    ' This is OK Here, Because We Can Assume If We Get No Handle Back, There's No Handle To Cleanup\n    ' Don't Normally Do This\n    On Error Resume Next\n\n    Dim windowProcessId As Long\n    windowProcessId = ProcIDFromWnd(app.ActiveWindow.hwnd)\n\n    Dim oServ As Object\n    Dim cProc As Variant\n    Dim oProc As Object\n\n    Set oServ = GetObject(\"winmgmts:\")\n    Set cProc = oServ.ExecQuery(\"Select * from Win32_Process Where ProcessId=\" &amp; windowProcessId)\n\n    For Each oProc In cProc\n\n          MsgBox \"Killing Process \" &amp; windowProcessId   ' used to display a message for testing pur\n          errReturnCode = oProc.Terminate()\n    Next\n\nEnd Sub\nFunction ProcIDFromWnd(ByVal hwnd As Long) As Long\n   Dim idProc As Long\n\n   ' Get PID for this HWnd\n   GetWindowThreadProcessId hwnd, idProc\n   ProcIDFromWnd = idProc\nEnd Function\n</code></pre>\n\n<p>EDIT: After the suggestion of Absinthe I was able to debug.print to confirm the error number is indeed -2147188160. I am now able to successsfully run code only if that error occurs, however I can't get PowerPoint to quit - I have to close PowerPoint myself and then I can see the <code>MsgBox</code> is up on my excel screen:</p>\n\n<pre><code>'Exit PowerPoint\nPPT.Quit\nExit Sub\n\nHandle:\nDebug.Print Err.Number\nIf Err.Number = -2147188160 Then\nPPT.Quit\nMsgBox \"Oh look I broke!\"\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1515531490, "post_id": 48176512, "comment_id": 83332977, "body": "Replace <code>Value1 = Application ...</code> by <code>Set Value1 = Application ...</code> (but then why call it a &quot;Value&quot; when you really want a <i>Range</i>?) You could make it even clearer by using a <code>Range</code> variable rather than a <code>Variant</code>."}, {"owner": {"reputation": 81, "user_id": 8907155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97066eee1516b5a283090d5a5d6d710a?s=128&d=identicon&r=PG&f=1", "display_name": "T Doe", "link": "https://stackoverflow.com/users/8907155/t-doe"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1515531595, "post_id": 48176512, "comment_id": 83333035, "body": "Range is probably a better tag. Your code fixes my problem. Thank you!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1515533127, "post_id": 48176512, "comment_id": 83333715, "body": "You typically don&#39;t <i>want</i> to <code>Select</code> a cell though. Doing that typically implies that you&#39;re working off <code>Selection</code> and <code>ActiveCell</code>, which is what the macro recorder does: such code is extremely frail and bug-prone."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1515533805, "post_id": 48176512, "comment_id": 83334009, "body": "FWIW - You have a typo as well - <code>Value.Select</code> should be <code>Value1.Select</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1515533879, "post_id": 48176512, "comment_id": 83334045, "body": "@YowE3K ha, totally missed that! <code>Option Explicit</code> FTW"}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 8907155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97066eee1516b5a283090d5a5d6d710a?s=128&d=identicon&r=PG&f=1", "display_name": "T Doe", "link": "https://stackoverflow.com/users/8907155/t-doe"}, "edited": false, "score": 0, "creation_date": 1515534054, "post_id": 48176981, "comment_id": 83334124, "body": "Awesome! That is super helpful. Does the (Range) Type record the contents of the cell as the range or the cell address?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 81, "user_id": 8907155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97066eee1516b5a283090d5a5d6d710a?s=128&d=identicon&r=PG&f=1", "display_name": "T Doe", "link": "https://stackoverflow.com/users/8907155/t-doe"}, "edited": false, "score": 0, "creation_date": 1515534141, "post_id": 48176981, "comment_id": 83334151, "body": "@TDoe <code>Range.Address</code> gives you the address; <code>Range.Value</code> gives you its value, <code>Range.Value2</code> gives you more precision when <code>.Value</code> is a <code>Date</code> or <code>Currency</code>. Basically a <code>Range</code> represents any cell, or any group of cells."}, {"owner": {"reputation": 81, "user_id": 8907155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97066eee1516b5a283090d5a5d6d710a?s=128&d=identicon&r=PG&f=1", "display_name": "T Doe", "link": "https://stackoverflow.com/users/8907155/t-doe"}, "edited": false, "score": 0, "creation_date": 1515534483, "post_id": 48176981, "comment_id": 83334300, "body": "oh okay. Functionally then, does that look like      Dim x as excel.Range.address"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 81, "user_id": 8907155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97066eee1516b5a283090d5a5d6d710a?s=128&d=identicon&r=PG&f=1", "display_name": "T Doe", "link": "https://stackoverflow.com/users/8907155/t-doe"}, "edited": false, "score": 0, "creation_date": 1515534647, "post_id": 48176981, "comment_id": 83334373, "body": "No, <code>Address</code> is a member call, you invoke it on an instance of a <code>Range</code>, e.g. <code>MsgBox Value1.Address</code>. It&#39;s a <code>String</code> value. You can lookup all the members in the <i>object browser</i> (F2)."}, {"owner": {"reputation": 81, "user_id": 8907155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97066eee1516b5a283090d5a5d6d710a?s=128&d=identicon&r=PG&f=1", "display_name": "T Doe", "link": "https://stackoverflow.com/users/8907155/t-doe"}, "edited": false, "score": 0, "creation_date": 1515536010, "post_id": 48176981, "comment_id": 83334945, "body": "ahhh it all makes sense now very cool! thank you so much for the help!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1515533635, "creation_date": 1515533635, "answer_id": 48176981, "question_id": 48176512, "link": "https://stackoverflow.com/questions/48176512/how-do-you-make-a-variable-your-active-cell/48176981#48176981", "title": "How do you make a variable your active cell?", "body": "<p><code>Range</code> is an object type. When assigning <em>object references</em> in VBA, the <code>Set</code> keyword is required.</p>\n\n<blockquote>\n<pre><code>Value1 = ...\n</code></pre>\n</blockquote>\n\n<p>This works, only because <code>Value1</code> is declared as a <code>Variant</code> (and thus can be literally <em>anything</em>) - what's happening is that it's being assigned to whatever <em>the value</em> of the selected cell(s) is.</p>\n\n<p>That's because the <code>Range</code> class has a <em>default property</em> that essentially points to its <code>Value</code> member.</p>\n\n<p>This <em>default property</em> makes this code:</p>\n\n<pre><code>Debug.Print ActiveSheet.Range(\"A1\")\n</code></pre>\n\n<p>Equivalent to this code:</p>\n\n<pre><code>Debug.Print ActiveSheet.Range(\"A1\").Value\n</code></pre>\n\n<p>So when you assign a <code>Variant</code> without the <code>Set</code> keyword, you're not assigning an <em>object reference</em>, therefore you're assigning a <em>value</em>. If the type (<code>Range</code>) didn't have a <em>default member</em>, the statement would raise a run-time error.</p>\n\n<p>In other words you're looking at a <code>Variant/String</code>, or a <code>Variant/Double</code>, or a <code>Variant/Error</code>, depending on the content of the cell. And you can't invoke <code>.Select</code> on any of these!</p>\n\n<p>The solution is therefore to <code>Set</code> the <code>Value1</code> reference:</p>\n\n<pre><code>Set Value1 = ...\n</code></pre>\n\n<p>That way you're assigning to the <em>object reference</em>, not to whatever the value of its <em>default property</em> is.</p>\n\n<p>Declaring the variable <code>As Excel.Range</code> would have made VBA better understand your intent:</p>\n\n<pre><code>Dim Value1 As Excel.Range\nValue1 = ...\n</code></pre>\n\n<p>This would have raised run-time error 91 \"Object reference (or With block variable) not Set\", because you can't assign to the default member of an object reference that's set to <code>Nothing</code> (which is what an unset object reference will be).</p>\n"}], "owner": {"reputation": 81, "user_id": 8907155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97066eee1516b5a283090d5a5d6d710a?s=128&d=identicon&r=PG&f=1", "display_name": "T Doe", "link": "https://stackoverflow.com/users/8907155/t-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1360, "favorite_count": 0, "accepted_answer_id": 48176981, "answer_count": 1, "score": 2, "last_activity_date": 1515533635, "creation_date": 1515531357, "last_edit_date": 1531164843, "question_id": 48176512, "link": "https://stackoverflow.com/questions/48176512/how-do-you-make-a-variable-your-active-cell", "title": "How do you make a variable your active cell?", "body": "<p>I have used an input box to define a variant as a cell value</p>\n\n<pre><code>sub practice()\n\nDim Value1 as Variant\n\n'Get Input Values\nValue1 = Application.InputBox(prompt:=\"Click Cell Value\", Title:=\"Specify \nRange\", Type:=8)\n\n'Select Variable as the ActiveCell\nValue.Select\n\nEnd Sub\n</code></pre>\n\n<p>The error occurs when I try to select the variable as the activecell. Any ideas how I can do this?</p>\n"}, {"tags": ["vba", "excel", "ms-access"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1515531538, "post_id": 48176417, "comment_id": 83333002, "body": "If I understand you correctly, the names are all being printed, but the only cell receiving a value is B2?"}, {"owner": {"reputation": 23, "user_id": 8261326, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d87d1de53237de2eb501b6aa758c496d?s=128&d=identicon&r=PG&f=1", "display_name": "Gator", "link": "https://stackoverflow.com/users/8261326/gator"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1515531781, "post_id": 48176417, "comment_id": 83333111, "body": "Not quite, so, the &quot;jc_C2ComplaintCountbyLot10&quot; is a query in the database. It&#39;s just a big table basically that I could just copy and paste manually but I can save time making a macro. What&#39;s happening when I press my nifty little button right now is, it only returns the very first cell in the table from the database into A1 on my excel spreadsheet."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1515532568, "post_id": 48176417, "comment_id": 83333469, "body": "Try <code>Set rs = cn.Execute(sql)</code> instead of <code>CreateObject</code> and <code>rs.Open</code>. Also you&#39;ll want screenupdating turned on at least until it works. And welcome to VBA! You&#39;ll want to learn how to <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indent your code</a> BTW =)"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1515535208, "post_id": 48176417, "comment_id": 83334617, "body": "I agree with Matt."}, {"owner": {"reputation": 23, "user_id": 8261326, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d87d1de53237de2eb501b6aa758c496d?s=128&d=identicon&r=PG&f=1", "display_name": "Gator", "link": "https://stackoverflow.com/users/8261326/gator"}, "edited": false, "score": 0, "creation_date": 1515594189, "post_id": 48176417, "comment_id": 83358863, "body": "Alright, I deleted or at least commented out quite a bit of things that I originally had. Basically I made a string for the sql and connection path and also tried the rs = cn.Execute(strSql) , the code runs without errors but nothing is getting into my excel spreadsheet?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8261326, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d87d1de53237de2eb501b6aa758c496d?s=128&d=identicon&r=PG&f=1", "display_name": "Gator", "link": "https://stackoverflow.com/users/8261326/gator"}, "edited": false, "score": 0, "creation_date": 1515594225, "post_id": 48177400, "comment_id": 83358884, "body": "Could you explain to me what this line &quot;Worksheets(&quot;mtrInteraction&quot;).Range(&quot;I2:P25&quot;).ClearContents&quot; and this line &quot; Set placementRange = Worksheets(&quot;mtrInteraction&quot;).Range(&quot;I2&quot;)&quot; do? I tried to just use your code as a template basically whilst plugging in what I needed to change and I don&#39;t think the data from the query is getting to the spreadsheet."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "reply_to_user": {"reputation": 23, "user_id": 8261326, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d87d1de53237de2eb501b6aa758c496d?s=128&d=identicon&r=PG&f=1", "display_name": "Gator", "link": "https://stackoverflow.com/users/8261326/gator"}, "edited": false, "score": 0, "creation_date": 1515596626, "post_id": 48177400, "comment_id": 83360598, "body": "sure the placement range is where I want the table copied into the worksheet &quot;mtrInteraction&quot;, you will have a different worksheet name and likely want the upper left corner of the table to be somewhere else, change it accordingly.  The clear is just to clear that area prior, you may want a bigger range.  So I clear the range and then copy to that range.  That is it.  Clear and Copy the recordset."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "reply_to_user": {"reputation": 23, "user_id": 8261326, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d87d1de53237de2eb501b6aa758c496d?s=128&d=identicon&r=PG&f=1", "display_name": "Gator", "link": "https://stackoverflow.com/users/8261326/gator"}, "edited": false, "score": 0, "creation_date": 1515596991, "post_id": 48177400, "comment_id": 83360814, "body": "I added some comments to the answer for you.  You have to update the path, the worksheet name, and your table name, and the placement range, you don&#39;t have to clear before copy but what if the data is a different size?  You will want to clear the a range first."}, {"owner": {"reputation": 23, "user_id": 8261326, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d87d1de53237de2eb501b6aa758c496d?s=128&d=identicon&r=PG&f=1", "display_name": "Gator", "link": "https://stackoverflow.com/users/8261326/gator"}, "edited": false, "score": 0, "creation_date": 1515597875, "post_id": 48177400, "comment_id": 83361454, "body": "I&#39;ve done all of that I believe, say my excel sheet is blank right now so clear contents would essentially be doing nothing, correct? The placement range is what I&#39;m a little confused about still, how come it&#39;s just passing a cell and not a range (Range(&quot;I2&quot;))? Is that just saying where you want the top left corner of the table to be placed? I&#39;ll repost my code if it helps, update rather."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "reply_to_user": {"reputation": 23, "user_id": 8261326, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d87d1de53237de2eb501b6aa758c496d?s=128&d=identicon&r=PG&f=1", "display_name": "Gator", "link": "https://stackoverflow.com/users/8261326/gator"}, "edited": false, "score": 0, "creation_date": 1515598302, "post_id": 48177400, "comment_id": 83361770, "body": "If it is a blank sheet then no need to clear.  Just comment out that line with a &#39; and it won&#39;t be used. yes it is only specifying the top left corner anchor cell of the copy. Why?  This helps to avoid range size mismatches on copy paste, if you specify ranges and they are not the same size you get subscript errors, if their is data in your range you can get errors, this basically prevents a bunch of errors."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "reply_to_user": {"reputation": 23, "user_id": 8261326, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d87d1de53237de2eb501b6aa758c496d?s=128&d=identicon&r=PG&f=1", "display_name": "Gator", "link": "https://stackoverflow.com/users/8261326/gator"}, "edited": false, "score": 0, "creation_date": 1515598314, "post_id": 48177400, "comment_id": 83361778, "body": "I dont mean to be confusing using only one cell and range, you could also call it placementCells As Cell and then use .Cells(1,1) this is Row/Col format with Cells, modify it for the cell you want, more understandable/readable to use the range and the Col name/Row number I think, you know exactly where the table copy anchor is going to be."}, {"owner": {"reputation": 23, "user_id": 8261326, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d87d1de53237de2eb501b6aa758c496d?s=128&d=identicon&r=PG&f=1", "display_name": "Gator", "link": "https://stackoverflow.com/users/8261326/gator"}, "edited": false, "score": 0, "creation_date": 1515598696, "post_id": 48177400, "comment_id": 83362055, "body": "I updated my code, everything you&#39;re saying is making sense to me, was just making sure I had it right. Nothing&#39;s getting pasted into the spreadsheet I&#39;m calling. With the code I had before, it would output the very first cell in the table I wanted, not the whole range."}], "tags": [], "owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "is_accepted": false, "score": 1, "last_activity_date": 1515596902, "last_edit_date": 1515596902, "creation_date": 1515535953, "answer_id": 48177400, "question_id": 48176417, "link": "https://stackoverflow.com/questions/48176417/how-can-i-copy-a-query-from-a-microsoft-access-database-into-an-excel-spreadsh/48177400#48177400", "title": "How can I &quot;copy&quot; a query from a microsoft access database into an excel spreadsheet using microsoft vba?", "body": "<p>Here is something similar grabbing the whole table, I do not bring in the field names they are already there.  Don't forget when you do this the IDs are coming with the table field data.</p>\n\n<pre><code>Private Sub getDataTable_Click()\n    Dim conn As Object ' connection\n    Dim rs As Object 'record set\n    Dim strSql As String\n    Dim strConnection As String\n    Dim placementRange As Range\n</code></pre>\n\n<p>'UPDATE THIS FOR YOUR WORKSHEET AND RANGE IF YOU WANT TO CLEAR BEFORE COPY</p>\n\n<pre><code>Worksheets(\"mtrInteraction\").Range(\"I2:P25\").ClearContents\n\n    Set conn = CreateObject(\"ADODB.Connection\")\n\n    'update this for the workbook,worksheet, and range where you want it\n</code></pre>\n\n<p>'UPDATE THIS FOR THE SHEET AND THE RANGE WHERE YOU WANT THE TABLE, UPPER LEFT CORNER</p>\n\n<pre><code>Set placementRange = Worksheets(\"mtrInteraction\").Range(\"I2\")\n</code></pre>\n\n<p>'UPDATE THIS FOR YOUR PATH AND DB NAME</p>\n\n<pre><code>'Build your connection and path\nstrConnection = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n    \"Data Source=C:\\yourpath\\yourpath\\updatethis.accdb\"\n</code></pre>\n\n<p>'UPDATE THIS FOR YOUR QUERY, TABLE NAME IS ALL YOU HAVE TO CHANGE TO COPY THE WHOLE TABLE, THE DB NAME IS SPECIFIED IN THE CONNECTION ABOVE      </p>\n\n<p>'Make your sql query to select all from YOUR table name  </p>\n\n<pre><code>strSql = \"SELECT * FROM tbl_MTR;\"\n\n    'open it you might want an error handler here\n    conn.Open strConnection\n\n    'get the recordset\n    Set rs = conn.Execute(strSql)\n\n    'copy your recordset in\n    placementRange.CopyFromRecordset rs\n\n    rs.Close\n    Set rs = Nothing\n    conn.Close\n    Set conn = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Here is the same thing in a stub that has the field name you want and a data value in a cell for specific targeting:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim inputSheet As Worksheet\nDim fieldSTR As String\nDim placementRange As Range\n\nDim rs As Object 'record set\n\nDim conn As Object\nDim strQuery As String\n\nDim myDB As String\n\nSet inputSheet = ThisWorkbook.Worksheets(\"Sheet1\")\nSet placementRange = inputSheet.Range(\"E2\")\n\nfieldSTR = CStr(inputSheet.Cells(3, 3).Value) 'C3 cell\nmyDB = \"C:\\yourpath\\yourpath\\updatethis.accdb\"\n\nSet conn = CreateObject(\"ADODB.Connection\")\n\n    With conn\n        .Provider = \"Microsoft.ACE.OLEDB.12.0\"    'For *.ACCDB Databases\n        .ConnectionString = myDB\n        .Open\n    End With\n\n\nstrQuery = \"SELECT * FROM \" &amp; _\n            \"tbl_test WHERE Color = \" &amp; \"'\" &amp; fieldSTR &amp; \"'\" &amp; \";\"\n\n'The below gives the same result as * but you could limit the fields returned as well\n'tbl_test.ID, tbl_test.Color, tbl_test.number\n\nMsgBox (strQuery)\n\nSet rs = conn.Execute(strQuery)\n\nplacementRange.CopyFromRecordset rs\n\nrs.Close\nSet rs = Nothing\nconn.Close\nSet conn = Nothing\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/xzwUL.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xzwUL.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 148, "user_id": 6178591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/082baa8d47affb1e993301612d427b9a?s=128&d=identicon&r=PG&f=1", "display_name": "Julen", "link": "https://stackoverflow.com/users/6178591/julen"}, "is_accepted": false, "score": 0, "last_activity_date": 1515537512, "creation_date": 1515537512, "answer_id": 48177677, "question_id": 48176417, "link": "https://stackoverflow.com/questions/48176417/how-can-i-copy-a-query-from-a-microsoft-access-database-into-an-excel-spreadsh/48177677#48177677", "title": "How can I &quot;copy&quot; a query from a microsoft access database into an excel spreadsheet using microsoft vba?", "body": "<p>This code works for me, it's stripped bare so it may not compile cleanly:</p>\n\n<pre><code>Sub LoadRecordset(Sheet1 As Worksheet, query As String)\n    Dim cnpubs As ADODB.Connection\n    Dim rsPubs As ADODB.Recordset\n\n    Set cnpubs = New ADODB.Connection\n    cnpubs.ConnectionString = \"Driver={SQL Server};Server=TESTDS;Database=TEST1;UID=sa;PWD=WERQEWDS\"\n    cnpubs.Open\n\n    Set rsPubs = New ADODB.Recordset\n\n    With rsPubs\n        .ActiveConnection = cnpubs\n        .Open query\n        fldCount = .Fields.Count\n        iRow = 1\n        Sheet1.Rows(iRow &amp; \":\" &amp; Rows.Count).Delete\n        For iCol = 0 To fldCount - 1\n            Sheet1.Cells(iRow, iCol + 1).Value = .Fields(iCol).Name\n        Next\n        iRow = iRow + 1\n        Sheet1.Range(\"A\" &amp; iRow).CopyFromRecordset rsPubs\n        .Close\n    End With\n    cnpubs.Close\n    Set rsPubs = Nothing\n    Set cnpubs = Nothing\n\n   Sheet1.Cells.EntireColumn.AutoFit\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8261326, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d87d1de53237de2eb501b6aa758c496d?s=128&d=identicon&r=PG&f=1", "display_name": "Gator", "link": "https://stackoverflow.com/users/8261326/gator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1515604101, "creation_date": 1515530853, "last_edit_date": 1515604101, "question_id": 48176417, "link": "https://stackoverflow.com/questions/48176417/how-can-i-copy-a-query-from-a-microsoft-access-database-into-an-excel-spreadsh", "title": "How can I &quot;copy&quot; a query from a microsoft access database into an excel spreadsheet using microsoft vba?", "body": "<p>Hopefully the question I'm asking is clear and to be honest I'm also new to using Microsoft VBA (literally started trying to use it today). I'm trying to \"grab\" a query/data table from a Microsoft Access Database and I'm having difficulty understanding the syntax and exactly what commands do. At the moment it appears I'm getting into the query, but only returning the very first cell of the data table with the code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Select_From_Access()\nDim cn As Object\nDim rs As Object\nDim strSql As String\nDim strConnection As String\nDim placementRange As Range\n\n'DescriptionErrorByLot is the worksheet I want to put the table in, the range A1:Z44 is what would hypothetically be cleared\n'if it needed to be once there is data there and needs to be updated\nWorksheets(\"DescriptionErrorByLot\").Range(\"A1:Z44\").ClearContents\n\nSet cn = CreateObject(\"ADODB.Connection\")\n\n'This is where I want the query (table) to be placed?\nSet placementRange = Worksheets(\"DescriptionErrorByLot\").Range(\"A1\")\n\n'Connection string containing provider and file path to the database\nstrConnection = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n    \"Data Source=C:\\Users\\sjevne\\Desktop\\Database.accdb\"\n\n'Selecting the whole table from the query \"jc_C2ComplaintCountbyLot10\"? This is the queries name in the database\n'To better explain what I'm talking about, there's buttons I can click on in the access database inside of the\n'Reports section (click 'Reports' button) and then I click another button \"Description errors by lot\" and then\n'A table/query with the name jc_C2ComplaintCountbyLot10 is open\n\nstrSql = \"SELECT * FROM jc_C2ComplaintCountByLot10;\"\n\ncn.Open strConnection\n\nSet rs = cn.Execute(strSql)\n\nplacementRange.CopyFromRecordset rs\n\nrs.Close\nSet rs = Nothing\ncn.Close\nSet cn = Nothing\nEnd Sub\n</code></pre>\n\n<p>Basically all I'm wondering right now is, what's actually allowing me to return the first cell in the data table I'm interested in? and how can I extend the range to grab the whole thing, obviously?\nAny help would be much appreciated! Thanks in advance. </p>\n\n<p><em>EDIT 1</em> : Code</p>\n\n<p><em>EDIT 2</em> : I've been playing around with the code again, when I tried changing the SELECT * FROM to an existing connection that I was previously using to the database query that I want, and it said something about multi-valued cells and not being able to get data from a different database. (This connection to the worksheet was previously used to make an automated table, so as database table values changed, the spreadsheet did. All I'm trying to do now is just 'copy and paste' using a macro since the previous method is no longer available, sadly.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1515531119, "post_id": 48176396, "comment_id": 83332808, "body": "Does the result need to be dynamic (if new data is added in ColD for example) ?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1515531201, "post_id": 48176396, "comment_id": 83332844, "body": "@TimWilliams I can see one of your formulas is about to be posted!! :D"}, {"owner": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1515531319, "post_id": 48176396, "comment_id": 83332903, "body": "@TimWilliams yes because it will be copied down &quot;x&quot; amount of rows depending on source data"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515531685, "post_id": 48176396, "comment_id": 83333076, "body": "@carter Tim is asking whether the formula in the existing cells need to automatically update if new data is added to column D.  So when you first set the formula in AB2 it might be <code>=N2&#47;$D$25</code> but then, if you add something in $D$26, do you want the formula to automatically be equivalent to <code>=N2&#47;$D$26</code>.  (Tim is good at creating formulas that will pick up the last value in a column, without VBA involvement.)"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "edited": false, "score": 0, "creation_date": 1515531165, "post_id": 48176459, "comment_id": 83332828, "body": "I had tried that and kept getting error 1004. Just tried again to confirm."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "edited": false, "score": 0, "creation_date": 1515531442, "post_id": 48176459, "comment_id": 83332958, "body": "@carter Answer fixed - had forgotten that you were setting <code>PLVlast</code> to an A1 notation address"}, {"owner": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "edited": false, "score": 0, "creation_date": 1515531811, "post_id": 48176459, "comment_id": 83333125, "body": "Perfect - Thank you! Would it be easier to not use R1C1?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "edited": false, "score": 0, "creation_date": 1515532109, "post_id": 48176459, "comment_id": 83333247, "body": "@carter - Answer edited to show A1 notation method, and also how to apply the formula to multiple rows"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "edited": false, "score": 0, "creation_date": 1515532330, "post_id": 48176459, "comment_id": 83333353, "body": "@carter - BTW, is your AB2 cell on the &quot;Summary&quot; sheet too?  If it is, you should really use <code>Sheets(&quot;Summary&quot;).Range(&quot;AB2&quot;)</code>.  If it isn&#39;t, you will need to change the formula to refer to the sheet - e.g. <code>... &#47;Summary!&quot; &amp; PLVlast ...</code>."}, {"owner": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "edited": false, "score": 1, "creation_date": 1515534580, "post_id": 48176459, "comment_id": 83334344, "body": "it wasn&#39;t, and I did need to change the formula to  <code>Range(&quot;AB2&quot;).FormulaR1C1 = &quot;=(RC[-3]&#47;&quot; &amp; &quot;Summary!&quot; &amp; MLVlast &amp; &quot;)&quot;</code>. Your solution got me there though - thanks again"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1515532050, "last_edit_date": 1515532050, "creation_date": 1515531058, "answer_id": 48176459, "question_id": 48176396, "link": "https://stackoverflow.com/questions/48176396/using-named-address-within-vba-formula/48176459#48176459", "title": "Using named address within VBA formula", "body": "<p>You want to use the value of the <code>PLVlast</code> variable, not the variable name.  And you also need to set <code>PLVlast</code> to have an R1C1 address format if you intend to use its value in an R1C1 formula:</p>\n\n<pre><code>PLVlast = Sheets(\"Summary\").Range(\"D\" &amp; Sheets(\"Summary\").Rows.Count).End(xlUp).Address(ReferenceStyle:=xlR1C1)\n\nRange(\"AB2\").FormulaR1C1 = \"=(RC[-14]/\" &amp; PLVlast &amp; \")\"\n</code></pre>\n\n<hr>\n\n<p>Or, if you want to use A1 notation throughout:</p>\n\n<pre><code>PLVlast = Sheets(\"Summary\").Range(\"D\" &amp; Sheets(\"Summary\").Rows.Count).End(xlUp).Address\n\nRange(\"AB2\").Formula = \"=(N2/\" &amp; PLVlast &amp; \")\"\n</code></pre>\n\n<hr>\n\n<p>Or, if you want to apply this formula to all cells in column AB, down to the row before the last one in column D (I'm assuming that is some sort of total row):</p>\n\n<pre><code>Dim lastRow As Long\nlastRow = Sheets(\"Summary\").Range(\"D\" &amp; Sheets(\"Summary\").Rows.Count).End(xlUp).Row\n\nRange(\"AB2\").Resize(lastRow - 2, 1).Formula = \"=(N2/D$\" &amp; lastRow &amp; \")\"\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 48176459, "answer_count": 1, "score": 0, "last_activity_date": 1544513377, "creation_date": 1515530715, "last_edit_date": 1544513377, "question_id": 48176396, "link": "https://stackoverflow.com/questions/48176396/using-named-address-within-vba-formula", "title": "Using named address within VBA formula", "body": "<p>I currently have the following named address: </p>\n\n<pre><code>PLVlast = Sheets(\"Summary\").Range(\"D\" &amp; Cells.Rows.Count).End(xlUp).Address\n</code></pre>\n\n<p>I want to divide a cell (N2) by that address. AB2 will have the result.</p>\n\n<pre><code>Range(\"AB2\") = \"=(RC[-14]/PLVlast)\"\n</code></pre>\n\n<p>The error: Excel formula in AB2 shows the following</p>\n\n<pre><code>=(N2/PLVlast)\n</code></pre>\n\n<p>What am I missing here?</p>\n"}, {"tags": ["excel", "excel-formula", "formula", "vba"], "comments": [{"owner": {"reputation": 703, "user_id": 3872061, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UaioG.jpg?s=128&g=1", "display_name": "fpierrat", "link": "https://stackoverflow.com/users/3872061/fpierrat"}, "edited": false, "score": 0, "creation_date": 1515531147, "post_id": 48176389, "comment_id": 83332822, "body": "I&#39;m not sure i plainly understood your needs. Maybe you should have a look at the &quot;vlookup&quot; function, or search on keywpord &quot;pivot table&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9195242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef8bb7c80af98d03a05b3c46e100400c?s=128&d=identicon&r=PG&f=1", "display_name": "Jarrod Wronski", "link": "https://stackoverflow.com/users/9195242/jarrod-wronski"}, "edited": false, "score": 0, "creation_date": 1515532625, "post_id": 48176524, "comment_id": 83333486, "body": "Can you explain a little, I&#39;m not sure what all the functions are doing but have an idea and would like to understand more.  I&#39;m not quite sure what you mean by fill down, will I have to put this in for every row on the output sheet (Sheet 2)?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 3, "user_id": 9195242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef8bb7c80af98d03a05b3c46e100400c?s=128&d=identicon&r=PG&f=1", "display_name": "Jarrod Wronski", "link": "https://stackoverflow.com/users/9195242/jarrod-wronski"}, "edited": false, "score": 0, "creation_date": 1515542421, "post_id": 48176524, "comment_id": 83337001, "body": "1. google <i>excel fill down</i>. 2. I&#39;m not here to rewrite documentation (which it appears you haven&#39;t bothered to read) nor be your personal tutor. Read the documentation at support.office.com and if you have a <b>specific</b> question on a point you do not understand, then post a comment back here."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1515531409, "creation_date": 1515531409, "answer_id": 48176524, "question_id": 48176389, "link": "https://stackoverflow.com/questions/48176389/excel-finding-data-in-a-column-then-posting-the-data-in-an-adjoining-column/48176524#48176524", "title": "Excel, Finding Data in a Column, then posting the data in an adjoining column", "body": "<p>try,</p>\n\n<pre><code>=index(sheet1!b:b, aggregate(15, 6, row($3:$6)/(sheet1!a$3:a$6=\"ppg\"), row(1:1)))\n</code></pre>\n\n<p>fill down for second, third, etc.</p>\n"}], "owner": {"reputation": 3, "user_id": 9195242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef8bb7c80af98d03a05b3c46e100400c?s=128&d=identicon&r=PG&f=1", "display_name": "Jarrod Wronski", "link": "https://stackoverflow.com/users/9195242/jarrod-wronski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "accepted_answer_id": 48176524, "answer_count": 1, "score": 0, "last_activity_date": 1515565040, "creation_date": 1515530692, "last_edit_date": 1531161705, "question_id": 48176389, "link": "https://stackoverflow.com/questions/48176389/excel-finding-data-in-a-column-then-posting-the-data-in-an-adjoining-column", "title": "Excel, Finding Data in a Column, then posting the data in an adjoining column", "body": "<p><a href=\"https://i.stack.imgur.com/8LhZT.png\" rel=\"nofollow noreferrer\">Excel Visual Example</a></p>\n\n<p>I am looking to setup a formula to search Sheet 1, Column A for a specific term, in this case \"PPG\", then write the data from Column B of Sheet 1 into Column A of Sheet 2.  </p>\n\n<p>Sheet 2, shows the list I would like to have displayed.  How do I write a formula to pull the data from \"Sheet 1\", find the instances of PPG, pull the data in Column B and write then in Column A of \"Sheet 2\", then go to the subsequent lines to find other instances?  Do I need to write a Macro to run?</p>\n\n<p>I have \n=IF(A3=PPG,\"B3\",\"\") however I'm not sure how to write it to find the next instance so if I have several lines between PPG data, it doesn't show up in the output.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1515530112, "post_id": 48176248, "comment_id": 83332320, "body": "So you want to know how to use <code>cell.Offset(1, 0)</code>?  (e.g. <code>something = cell.Offset(1, 0).Value</code>?)"}, {"owner": {"reputation": 129, "user_id": 7411007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-hzWvqCSpVb0/AAAAAAAAAAI/AAAAAAAAARQ/5KNIxE2AA4s/photo.jpg?sz=128", "display_name": "DINESHKUMAR PALANISAMY", "link": "https://stackoverflow.com/users/7411007/dineshkumar-palanisamy"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1515530263, "post_id": 48176248, "comment_id": 83332391, "body": "Yes, I think so.@YowE3K"}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 2, "last_activity_date": 1515530361, "creation_date": 1515530361, "answer_id": 48176320, "question_id": 48176248, "link": "https://stackoverflow.com/questions/48176248/vba-code-to-find-a-specific-value-and-copy-value-in-subsequent-cell-in-the-colum/48176320#48176320", "title": "vba code to find a specific value and copy value in subsequent cell in the column and paste in a new sheet", "body": "<p>To reference the cell which is one row below, and zero columns to the right of, the cell referred to by your <code>cell</code> variable you can use <code>cell.Offset(1, 0)</code>.</p>\n\n<p>(Obviously, this can only be done if <code>cell</code> isn't <code>Nothing</code>, so needs to be used only in the <code>Else</code> leg of your code's <code>If</code> statement.)</p>\n"}], "owner": {"reputation": 129, "user_id": 7411007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-hzWvqCSpVb0/AAAAAAAAAAI/AAAAAAAAARQ/5KNIxE2AA4s/photo.jpg?sz=128", "display_name": "DINESHKUMAR PALANISAMY", "link": "https://stackoverflow.com/users/7411007/dineshkumar-palanisamy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515530361, "creation_date": 1515530025, "question_id": 48176248, "link": "https://stackoverflow.com/questions/48176248/vba-code-to-find-a-specific-value-and-copy-value-in-subsequent-cell-in-the-colum", "title": "vba code to find a specific value and copy value in subsequent cell in the column and paste in a new sheet", "body": "<p>I have a excel sheet with some data. In Column A, it has set of data, my objective is to copy the cell value below the cell which contains its value as \"Line\".</p>\n\n<pre><code>Columns(\"B:B\").Select\nSet cell = Selection.Find(What:=\"line\", After:=ActiveCell, LookIn:=xlFormulas, _\n        LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n        MatchCase:=False, SearchFormat:=False)\n\nIf cell Is Nothing Then\n    'do it something\n\nElse\n    'do it another thing\nEnd If\n</code></pre>\n\n<p>But it is used to find only the cell value which contains as Line.</p>\n"}, {"tags": ["excel", "userform", "bloomberg", "vba"], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 7375650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70ad9918c333b02d7fdb1d86aada54e?s=128&d=identicon&r=PG&f=1", "display_name": "mattsurw", "link": "https://stackoverflow.com/users/7375650/mattsurw"}, "is_accepted": false, "score": 2, "last_activity_date": 1515529073, "creation_date": 1515529073, "answer_id": 48176055, "question_id": 48175804, "link": "https://stackoverflow.com/questions/48175804/allow-streaming-data-in-vba-userform/48176055#48176055", "title": "Allow streaming data in VBA UserForm", "body": "<p>Figured it out. I can use the .ControlSource property of the TextBox to link the TextBox to the streaming data. Here is what the working code looks like:</p>\n\n<pre><code>Private Sub MonitorOnly_Click()\n\nSheets(\"Log\").Activate\n\nOTCBid.ControlSource = \"=C3\"\nOTCAsk.ControlSource = \"=D3\"\nOTCBidSize.ControlSource = \"=F3\"\nOTCAskSize.ControlSource = \"=E3\"\n\nICEBid.ControlSource = \"=C4\"\nICEAsk.ControlSource = \"=D4\"\nICEBidSize.ControlSource = \"=F4\"\nICEAskSize.ControlSource = \"=E4\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 7375650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70ad9918c333b02d7fdb1d86aada54e?s=128&d=identicon&r=PG&f=1", "display_name": "mattsurw", "link": "https://stackoverflow.com/users/7375650/mattsurw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1515529073, "creation_date": 1515527936, "last_edit_date": 1531164843, "question_id": 48175804, "link": "https://stackoverflow.com/questions/48175804/allow-streaming-data-in-vba-userform", "title": "Allow streaming data in VBA UserForm", "body": "<p>I have built a UserForm that I would like to stream some market data I'm pulling from Bloomberg into an Excel sheet. I launch the UserForm, and it displays the correct initial data, but when the data updates in the spreadsheet, it does not update in the UserForm TextBox. This makes sense, but I'm looking for a workaround. Is there some way to allow it to stream this data and update in real time? Or should I be using something other than a TextBox?</p>\n\n<p>Any help is appreciated.</p>\n\n<p>Here is the code I'm using to paint the initial values:</p>\n\n<pre><code>Private Sub MonitorOnly_Click()\n\nSheets(\"Log\").Activate\n\nOTCBid.Text = Range(\"C3\")\nOTCAsk.Text = Range(\"D3\")\nOTCBidSize.Text = Range(\"E3\")\nOTCAskSize.Text = Range(\"F3\")\n\nICEBid.Text = Range(\"C5\")\nICEAsk.Text = Range(\"D5\")\nICEBidSize.Text = Range(\"E5\")\nICEAskSize.Text = Range(\"F5\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "max", "repeat"], "answers": [{"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1515528833, "creation_date": 1515528833, "answer_id": 48176001, "question_id": 48175755, "link": "https://stackoverflow.com/questions/48175755/extracting-maximum-values-of-an-array-with-repeated-ocurrences-in-excels-vba/48176001#48176001", "title": "Extracting maximum values of an array with repeated ocurrences in Excel&#39;s VBA", "body": "<p>This can be done completely without VBA.  Using your sample data, in cell J1 I used this formula to get the number of unique names in column B:</p>\n\n<pre><code>=SUMPRODUCT((B2:B10&lt;&gt;\"\")/COUNTIF(B2:B10,B2:B10&amp;\"\"))\n</code></pre>\n\n<p>In cell F2 and copied down to F6 is this formula to extract those unique names:</p>\n\n<pre><code>=IF(ROW(F1)&gt;$J$1,\"\",INDEX($B$2:$B$10,MATCH(0,INDEX(COUNTIF(F$1:F1,$B$2:$B$10),),0)))\n</code></pre>\n\n<p>In cell G2 and copied over and down to H6 is this formula to pull the maximum time values for each unique name:</p>\n\n<pre><code>=IF($F2=\"\",\"\",MAX(INDEX(($B$2:$B$10=$F2)*C$2:C$10,)))\n</code></pre>\n\n<p>The table populated on the right (columns F, G, and H) is the result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/h2hw7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/h2hw7.png\" alt=\"enter image description here\"></a></p>\n\n<p>Alternately, this can be easily done with a pivot table.  Select your original data in columns B, C, and D and go to Insert -> Pivot Table.  I selected to put it on the same worksheet, but you could put it on a new worksheet if preferred.  And then it will come up asking for your Pivot Table fields, set those up like shown (note that you will need to change the values from Count to Max):</p>\n\n<p><a href=\"https://i.stack.imgur.com/LVnGX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LVnGX.png\" alt=\"enter image description here\"></a></p>\n\n<p>And then you'll have a pivot table showing the same results:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6GhxG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6GhxG.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 7803350, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/69b6f2d0e1442cbef1c97ab53d72e2e5?s=128&d=identicon&r=PG&f=1", "display_name": "alosc", "link": "https://stackoverflow.com/users/7803350/alosc"}, "edited": false, "score": 0, "creation_date": 1515537980, "post_id": 48176075, "comment_id": 83335672, "body": "I misswrited,my code had at the end of the while thef expression j=j+1"}, {"owner": {"reputation": 69, "user_id": 9157188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1XYpg.png?s=128&g=1", "display_name": "Relajadito", "link": "https://stackoverflow.com/users/9157188/relajadito"}, "reply_to_user": {"reputation": 51, "user_id": 7803350, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/69b6f2d0e1442cbef1c97ab53d72e2e5?s=128&d=identicon&r=PG&f=1", "display_name": "alosc", "link": "https://stackoverflow.com/users/7803350/alosc"}, "edited": false, "score": 0, "creation_date": 1515699817, "post_id": 48176075, "comment_id": 83411127, "body": "but also with &quot;j=j+1&quot; at the end of &quot;while&quot; you could enter into a eternal loop"}], "tags": [], "owner": {"reputation": 69, "user_id": 9157188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1XYpg.png?s=128&g=1", "display_name": "Relajadito", "link": "https://stackoverflow.com/users/9157188/relajadito"}, "is_accepted": false, "score": 0, "last_activity_date": 1515530396, "last_edit_date": 1515530396, "creation_date": 1515529147, "answer_id": 48176075, "question_id": 48175755, "link": "https://stackoverflow.com/questions/48175755/extracting-maximum-values-of-an-array-with-repeated-ocurrences-in-excels-vba/48176075#48176075", "title": "Extracting maximum values of an array with repeated ocurrences in Excel&#39;s VBA", "body": "<p>1.- You declare \"j=2\" but never change it, I think you must \"navegate\" thru rows from 2 to 10, isn't it?</p>\n\n<p>2.- When you enter the \"while\" statement you never change conditions so ... it will repeat forever</p>\n\n<p>I'm not sure what you must obtain, so please expose a sample of it</p>\n\n<p>+++++ You must delete \"-\" values from your table</p>\n\n<pre><code>dim i as integer, j as integer\nFor i=2 to 4\n    For j=2 to 10\n        if Cells(i,6)=Cells(j,2) then\n            if Cells(j,3) &gt; Cells(i,7) then\n                Cells(i,7) = Cells(j,3)\n            end if \n            if Cells(j,4) &gt; Cells(i,8) then\n                Cells(i,8) = Cells(j,4)\n            end if\n        end if\n    Next j\nNext i\n</code></pre>\n\n<p>+++++ You must delete \"-\" values from your table</p>\n"}], "owner": {"reputation": 51, "user_id": 7803350, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/69b6f2d0e1442cbef1c97ab53d72e2e5?s=128&d=identicon&r=PG&f=1", "display_name": "alosc", "link": "https://stackoverflow.com/users/7803350/alosc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 550, "favorite_count": 0, "accepted_answer_id": 48176001, "answer_count": 2, "score": 2, "last_activity_date": 1515530396, "creation_date": 1515527735, "last_edit_date": 1515528752, "question_id": 48175755, "link": "https://stackoverflow.com/questions/48175755/extracting-maximum-values-of-an-array-with-repeated-ocurrences-in-excels-vba", "title": "Extracting maximum values of an array with repeated ocurrences in Excel&#39;s VBA", "body": "<p>I have a table which has repeated indexes as in the picture: <img src=\"https://i.stack.imgur.com/2QMVS.png\" alt=\"\"></p>\n\n<p>I want to get the highest value of each of Time 1 / Time 2 for each index (\"Apple\",\"Banana\",...)</p>\n\n<p>My code goes as follows:</p>\n\n<pre><code>dim i as integer, j as integer\nFor i=2 to 4\n      j=2\n      While Cells(i,6)=Cells(j,2)\n          if Cells(j,3) &gt; Cells(i,7) then\n              Cells(i,7) = Cells(j,3)\n          end if \n          if Cells(j,4) &gt; Cells(i,8) then\n              Cells(i,8) = Cells(j,4)\n          end if\n       Wend\nNext i\n</code></pre>\n\n<p>So the idea is to iterate through the unique names, and then go through each occurence of the name and check wether it's bigger than the currently stored time.</p>\n\n<p>I know there's some syntax error, since whenever I run the code it doesn't alter my worksheet, I couldn't really find documentation on how to replace values in VBA.</p>\n\n<p>So I was wondering if there is a simpler way of doing this, and/or asking for help to get proper syntax going.</p>\n"}]