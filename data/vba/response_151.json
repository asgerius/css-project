[{"tags": ["vba", "visual-studio"], "answers": [{"tags": [], "owner": {"reputation": 4705, "user_id": 746461, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/cab04a8efb05937830be8df8a033e5fd?s=128&d=identicon&r=PG", "display_name": "Gqqnbig", "link": "https://stackoverflow.com/users/746461/gqqnbig"}, "is_accepted": true, "score": 0, "last_activity_date": 1523657499, "creation_date": 1523657499, "answer_id": 49825764, "question_id": 47563697, "link": "https://stackoverflow.com/questions/47563697/dte-executecommand-edit-find-cannot-find-quotation-marks/49825764#49825764", "title": "dte.ExecuteCommand &quot;Edit.Find&quot; cannot find quotation marks?", "body": "<p>The parameters that <code>dte.ExecuteCommand</code> accepts are what we can input in Visual Studio's Command Window.</p>\n\n<p><a href=\"https://i.stack.imgur.com/TTqlP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TTqlP.png\" alt=\"enter image description here\"></a></p>\n\n<p>Command Window gives the same error as the OP found.</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/visualstudio/ide/reference/command-window#escape-characters\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/visualstudio/ide/reference/command-window#escape-characters</a> states the escape character is <kbd>^</kbd>, thus you have to use <code>dte.ExecuteCommand \"Edit.Find\", \"^\"\"\"</code> in order to find <code>\"</code>.</p>\n\n<p>As of all parameters of <code>Edit.Find</code>, see <a href=\"https://docs.microsoft.com/en-us/visualstudio/ide/reference/find-command\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/visualstudio/ide/reference/find-command</a></p>\n"}], "owner": {"reputation": 4705, "user_id": 746461, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/cab04a8efb05937830be8df8a033e5fd?s=128&d=identicon&r=PG", "display_name": "Gqqnbig", "link": "https://stackoverflow.com/users/746461/gqqnbig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 49825764, "answer_count": 1, "score": 0, "last_activity_date": 1523657499, "creation_date": 1511998951, "question_id": 47563697, "link": "https://stackoverflow.com/questions/47563697/dte-executecommand-edit-find-cannot-find-quotation-marks", "title": "dte.ExecuteCommand &quot;Edit.Find&quot; cannot find quotation marks?", "body": "<pre><code>MSVS_versions = Array _\n( _\n    \"VisualStudio.DTE.7\", _\n    \"VisualStudio.DTE.7.1\", _\n    \"VisualStudio.DTE.8.0\", _\n    \"VisualStudio.DTE.9.0\", _\n    \"VisualStudio.DTE.10.0\", _\n    \"VisualStudio.DTE.11.0\", _\n    \"VisualStudio.DTE.12.0\", _\n    \"VisualStudio.DTE.14.0\" _\n)\n\nFor each version in MSVS_versions\n    Err.Clear\n    Set dte = getObject(,version)\n    If Err.Number = 0 Then\n        Exit For\n    End If\nNext\n\nIf Err.Number &lt;&gt; 0 Then\n    Set dte = WScript.CreateObject(\"VisualStudio.DTE\")\n    Err.Clear\nEnd If\n\n\ndte.MainWindow.Activate\ndte.MainWindow.Visible = True\ndte.UserControl = True\n\ndte.ItemOperations.OpenFile filename\nif keyword is not nothing then\n    dte.ExecuteCommand \"Edit.Find\", \"\"\"\"\nend if\n</code></pre>\n\n<p>I have this vba code. I'm interested in the second last line. I want to find a quotation mark in the current docurnet. When I run the code, Visual Studio tells me </p>\n\n<pre><code>---------------------------\nMicrosoft Visual Studio\n---------------------------\nThe search pattern is invalid.\n---------------------------\nOK   \n---------------------------\n</code></pre>\n\n<p>How do I search quotation marks?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 200, "user_id": 6781241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d008add7dd029016e745cff48553ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Robbie", "link": "https://stackoverflow.com/users/6781241/robbie"}, "edited": false, "score": 0, "creation_date": 1511999275, "post_id": 47563668, "comment_id": 82085424, "body": "Try <code>Cells(r, 1).value</code>"}, {"owner": {"reputation": 15, "user_id": 8951759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da872f8f661ec6aaa8e46a2b5bc11307?s=128&d=identicon&r=PG&f=1", "display_name": "YellowSkin", "link": "https://stackoverflow.com/users/8951759/yellowskin"}, "reply_to_user": {"reputation": 200, "user_id": 6781241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d008add7dd029016e745cff48553ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Robbie", "link": "https://stackoverflow.com/users/6781241/robbie"}, "edited": false, "score": 0, "creation_date": 1511999654, "post_id": 47563668, "comment_id": 82085534, "body": "Tried it, unfortunately doesn&#39;t work. Maybe good to add (will add to opening post too) is that I only get the error when the condition is true."}, {"owner": {"reputation": 2725, "user_id": 600852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4df664e18a3fa18d23c6f42d7565b18c?s=128&d=identicon&r=PG", "display_name": "kurdtpage", "link": "https://stackoverflow.com/users/600852/kurdtpage"}, "edited": false, "score": 0, "creation_date": 1511999815, "post_id": 47563668, "comment_id": 82085587, "body": "Have you tried double equals: <code>If Worksheets(&quot;csvFile&quot;).Cells(r, 1) == &quot;#N&#47;A&quot; Then</code>"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 2725, "user_id": 600852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4df664e18a3fa18d23c6f42d7565b18c?s=128&d=identicon&r=PG", "display_name": "kurdtpage", "link": "https://stackoverflow.com/users/600852/kurdtpage"}, "edited": false, "score": 0, "creation_date": 1511999903, "post_id": 47563668, "comment_id": 82085622, "body": "@kurdtpage That isn&#39;t how comparisons work in VBA."}, {"owner": {"reputation": 200, "user_id": 6781241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d008add7dd029016e745cff48553ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Robbie", "link": "https://stackoverflow.com/users/6781241/robbie"}, "edited": false, "score": 0, "creation_date": 1512000068, "post_id": 47563668, "comment_id": 82085680, "body": "I need to stop commenting before coffee... Possible duplicate of <a href=\"https://stackoverflow.com/questions/4624861/excel-vba-interpret-n-a-values\">Excel VBA - Interpret &quot;N/A&quot; Values</a>"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8951759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da872f8f661ec6aaa8e46a2b5bc11307?s=128&d=identicon&r=PG&f=1", "display_name": "YellowSkin", "link": "https://stackoverflow.com/users/8951759/yellowskin"}, "edited": false, "score": 0, "creation_date": 1512000491, "post_id": 47563837, "comment_id": 82085789, "body": "Thank you, this seems to work. I&#39;ll test it a little more."}, {"owner": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "reply_to_user": {"reputation": 15, "user_id": 8951759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da872f8f661ec6aaa8e46a2b5bc11307?s=128&d=identicon&r=PG&f=1", "display_name": "YellowSkin", "link": "https://stackoverflow.com/users/8951759/yellowskin"}, "edited": false, "score": 0, "creation_date": 1512000733, "post_id": 47563837, "comment_id": 82085857, "body": "Don&#39;t know what I&#39;m doing differently, but it deletes the row for me."}, {"owner": {"reputation": 15, "user_id": 8951759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da872f8f661ec6aaa8e46a2b5bc11307?s=128&d=identicon&r=PG&f=1", "display_name": "YellowSkin", "link": "https://stackoverflow.com/users/8951759/yellowskin"}, "edited": false, "score": 0, "creation_date": 1512025935, "post_id": 47563837, "comment_id": 82092994, "body": "I was mistaken, it does so for me too. Thanks!"}], "tags": [], "owner": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "is_accepted": true, "score": 1, "last_activity_date": 1512000034, "creation_date": 1512000034, "answer_id": 47563837, "question_id": 47563668, "link": "https://stackoverflow.com/questions/47563668/vba-if-statement-in-for-loop/47563837#47563837", "title": "VBA: If statement in for loop", "body": "<p>Give this try:</p>\n\n<pre><code>If WorksheetFunction.IsNA(Worksheets(\"csvFile\").Cells(r, 1)) Then\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1512032743, "last_edit_date": 1512032743, "creation_date": 1512032171, "answer_id": 47569352, "question_id": 47563668, "link": "https://stackoverflow.com/questions/47563668/vba-if-statement-in-for-loop/47569352#47569352", "title": "VBA: If statement in for loop", "body": "<p>In order to see if a cell contains <code>#NA</code> you need to trap this type of error, which is a 2-Steps <code>If</code>.</p>\n\n<p>Also, allways loop backwards when deleting <code>Rows</code>, use <code>For r = lastRow2 To 3 Step -1</code>.</p>\n\n<p>Try the code below, explanations inside the code's comments:</p>\n\n<pre><code>Option Explicit\n\nSub DelNARows()\n\nDim lastRow2 As Long\nDim r As Long\nDim CellVal As Variant\n\nWith Worksheets(\"csvFile\") ' use with statement to qualify all Range, Rows and Cells object nested inside\n    lastRow2 = .Cells(.Rows.Count, 1).End(xlUp).Row\n\n    For r = lastRow2 To 3 Step -1 ' always loop backward when deleting rows\n        ' trap #NA error section\n        On Error Resume Next\n        CellVal = .Cells(r, 1).Value\n        On Error GoTo 0\n\n        If IsError(CellVal) Then\n            If CellVal = CVErr(xlErrNA) Then ' check if current error if xlErrNA (2042)\n                .Rows(r).Delete\n            End If\n        End If\n    Next r\nEnd With\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Edit 1</strong>: a faster way to delete multiple rows, is to delete all the rows at one shot, not one-by-one. You can achieve that by merging all the rows to be deleted in a <code>DelRng</code> (it's a <code>Range</code> object which is combined from all the rows that needs to be deleted).</p>\n\n<p><strong><em>Code</em></strong></p>\n\n<pre><code>For r = lastRow2 To 3 Step -1\n    ' trap #NA error section\n    On Error Resume Next\n    CellVal = .Cells(r, 1).Value\n    On Error GoTo 0\n\n    Dim DelRng As Range ' define a new range to save all the rows to delete\n\n    If IsError(CellVal) Then\n        If CellVal = CVErr(xlErrNA) Then ' check if current error if xlErrNA (2042)\n            If Not DelRng Is Nothing Then\n                Set DelRng = Application.Union(DelRng, .Rows(i))\n            Else\n                Set DelRng = .Rows(i)\n            End If\n        End If\n    End If\nNext r\n\n' delete the entire rows at once\nIf Not DelRng Is Nothing Then DelRng.Delete\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8951759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da872f8f661ec6aaa8e46a2b5bc11307?s=128&d=identicon&r=PG&f=1", "display_name": "YellowSkin", "link": "https://stackoverflow.com/users/8951759/yellowskin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 47563837, "answer_count": 2, "score": 0, "last_activity_date": 1512032743, "creation_date": 1511998739, "last_edit_date": 1512031952, "question_id": 47563668, "link": "https://stackoverflow.com/questions/47563668/vba-if-statement-in-for-loop", "title": "VBA: If statement in for loop", "body": "<p>I seem to get a mismatch error when trying to write an if statement in a for loop.</p>\n\n<p>This is the piece of code where I get the error. Note, I only get the error when the IF condition is true. </p>\n\n<pre><code>Dim lastRow2 As Long\nlastRow2 = Worksheets(\"csvFile\").Cells(rows.Count, 1).End(xlUp).Row\n\nDim r As Integer\nFor r = 3 To lastRow2\n    If Worksheets(\"csvFile\").Cells(r, 1) = \"#N/A\" Then\n        rows(r).EntireRow.delete\n    End If\nNext r\n</code></pre>\n\n<p>So the goal is to delete the row where in the first cell <code>\"#N/A\"</code> is entered as a value. </p>\n\n<p>Hope you guys can help and loads of thanks in advance. </p>\n"}, {"tags": ["arrays", "excel", "vba", "variant"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1511998180, "post_id": 47563499, "comment_id": 82085051, "body": "So if the Target is just one cell, don&#39;t run the macro? Just add <code>If target.count = 1 Then Exit Sub</code> to the top"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1512002061, "post_id": 47563499, "comment_id": 82086187, "body": "Use another function to count the number of dimensions: <a href=\"https://stackoverflow.com/questions/6901991/how-to-return-the-number-of-dimensions-of-a-variant-variable-passed-to-it-in-v\">How to return the number of dimensions of a (Variant) variable passed to it in VBA</a>"}, {"owner": {"reputation": 69, "user_id": 8358987, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/725f25469668eac1eceba65e33bde1bb?s=128&d=identicon&r=PG&f=1", "display_name": "mpmcderm", "link": "https://stackoverflow.com/users/8358987/mpmcderm"}, "edited": false, "score": 0, "creation_date": 1512009670, "post_id": 47563499, "comment_id": 82088034, "body": "thanks for the &quot;target.count&quot; I forgot that targets are ranges. thank you"}], "answers": [{"tags": [], "owner": {"reputation": 69, "user_id": 8358987, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/725f25469668eac1eceba65e33bde1bb?s=128&d=identicon&r=PG&f=1", "display_name": "mpmcderm", "link": "https://stackoverflow.com/users/8358987/mpmcderm"}, "is_accepted": true, "score": 1, "last_activity_date": 1512076544, "creation_date": 1512076544, "answer_id": 47582748, "question_id": 47563499, "link": "https://stackoverflow.com/questions/47563499/single-dimension-variant-arrays-vba/47582748#47582748", "title": "Single Dimension Variant Arrays VBA", "body": "<p>I set up a if then statement to run one way if target.count =1 and another if target.count>1</p>\n"}], "owner": {"reputation": 69, "user_id": 8358987, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/725f25469668eac1eceba65e33bde1bb?s=128&d=identicon&r=PG&f=1", "display_name": "mpmcderm", "link": "https://stackoverflow.com/users/8358987/mpmcderm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 47582748, "answer_count": 1, "score": 1, "last_activity_date": 1512076544, "creation_date": 1511997693, "last_edit_date": 1511998143, "question_id": 47563499, "link": "https://stackoverflow.com/questions/47563499/single-dimension-variant-arrays-vba", "title": "Single Dimension Variant Arrays VBA", "body": "<p>In general I have a good macro for change management for a single value and now can write one for an multi dimensional array but need to be able to differential between without the use of error handling. </p>\n\n<p>Is there any other work around for when the target is only one cell? the error handling below handles the issue but I consider it to be \"sloppy.\" \nSuggestions are appreciated on a better method. </p>\n\n<pre><code>Sub Dims(target As Variant)\n\nDim varData As Variant\nDim i As Integer\nDim j As Integer\n\nvarData = target\n\nOn Error GoTo Err\n\nFor i = 1 To UBound(varData, 1)\n    For j = 1 To UBound(varData, 2)\n        Debug.Print i, j, varData(i, j)\n    Next j\nNext i\n\nErr:\nIf Err.Number = 13 Then\n    Debug.Print target.Value\nElseIf Err.Number &lt;&gt; 0 Then\n    MsgBox \"Error \" &amp; Err.Number &amp; \" just occured.\"\nElseIf Err.Number &lt;&gt; 13 And Err.Number &lt;&gt; 0 Then\n    Debug.Print \"Err No.= \"; Err.Number\nElse\n    Debug.Print \"No Error\"\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 12208, "user_id": 5510627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8210c2e2a5900d874c81a557c0f9f789?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5510627/matt"}, "edited": false, "score": 0, "creation_date": 1511999718, "post_id": 47563469, "comment_id": 82085548, "body": "just looks like you need to remove the () around <code>(Tuteurs INNER JOIN Tarifs_17_18 ON Tuteurs.ID_Tuteur = Tarifs_17_18.TuteurID_Trf)</code>"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1512026170, "post_id": 47563469, "comment_id": 82093123, "body": "Try removing <code>dbSeeChanges</code>."}], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 7216983, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10154282987959472/picture?type=large", "display_name": "Houcine Adsens", "link": "https://stackoverflow.com/users/7216983/houcine-adsens"}, "is_accepted": false, "score": 0, "last_activity_date": 1512035565, "creation_date": 1512035565, "answer_id": 47570441, "question_id": 47563469, "link": "https://stackoverflow.com/questions/47563469/openrecordset-with-multiple-tables-access-2016/47570441#47570441", "title": "Openrecordset With Multiple Tables, Access 2016", "body": "<p>I Found the Solution,\nMy recordset is not in scope and My variables are declared outside My procedure.\nSolution found by @Moke123.</p>\n"}], "owner": {"reputation": 27, "user_id": 7216983, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10154282987959472/picture?type=large", "display_name": "Houcine Adsens", "link": "https://stackoverflow.com/users/7216983/houcine-adsens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 259, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594638740, "creation_date": 1511997437, "last_edit_date": 1594638740, "question_id": 47563469, "link": "https://stackoverflow.com/questions/47563469/openrecordset-with-multiple-tables-access-2016", "title": "Openrecordset With Multiple Tables, Access 2016", "body": "<p>I am getting an \"Object variable or With block variable not set (Error 91)\" error with the following code:</p>\n\n<pre><code>Dim db As Database\nDim rs As Recordset\n\nPrivate Sub Form_Load()\n\n    Dim mySQL As String\n    mySQL = \"SELECT Tuteurs.ID_Tuteur, Tarifs_17_18.*, Paiements_17_18.* \" &amp; _\n            \"FROM (Tuteurs INNER JOIN Tarifs_17_18 ON Tuteurs.ID_Tuteur = Tarifs_17_18.TuteurID_Trf) \" &amp; _\n            \"INNER JOIN Paiements_17_18 ON Tuteurs.ID_Tuteur = Paiements_17_18.TuteurID_Pmt \" &amp; _\n            \"WHERE ID_Tuteur =\" &amp; [Forms]![Eleves]![TuteurID_Elv]\n\n    Set db = CurrentDb\n    Set rs = db.OpenRecordset(mySQL, dbOpenDynaset, dbSeeChanges)\n    rs.MoveFirst\nEnd Sub\n\nPrivate Sub btn_Enregistrer_Click()\n\n    Dim totIns As Integer\n    totIns = DSum(\"Montant\", \"Paiements_17_18\", \"[Mois_Regle]='Inscription'\")\n\n    If totIns = rs!Tarif_Inscription Then\n        MsgBox \"Yes\" &amp; totIns &amp; \" = \" &amp; rs!Tarif_Inscription\n    Else\n        MsgBox \"No\" &amp; totIns &amp; \" # \" &amp; rs!Tarif_Inscription\n    End If\nEnd Sub\n</code></pre>\n\n<p><code>totIns</code> is working very well but <code>rs!Tarif_Inscription</code> is the missing object variable.</p>\n\n<p><code>[Tarif_Inscription]</code> is a field in the <code>[Tarifs_17_18]</code> Table.</p>\n\n<p>Any Help Please?</p>\n"}, {"tags": ["excel", "vba", "unique"], "answers": [{"tags": [], "owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "is_accepted": true, "score": 0, "last_activity_date": 1511999793, "last_edit_date": 1511999793, "creation_date": 1511998726, "answer_id": 47563665, "question_id": 47563281, "link": "https://stackoverflow.com/questions/47563281/vba-copying-unique-values-into-different-sheet/47563665#47563665", "title": "VBA - copying unique values into different sheet", "body": "<p>This will do what you want:</p>\n\n<pre><code>Sub testy()\n    Dim wks As Worksheet, base As Worksheet\n    Dim n As Long, i As Long, m As Long\n    Dim rng As Range\n\n    Set wks = ThisWorkbook.Worksheets(2) 'Change \"2\" with your input sheet name\n    Set base = ThisWorkbook.Worksheets(1) 'Change \"1\" with your output sheet name\n\n    n = base.Cells(base.Rows.Count, \"A\").End(xlUp).Row\n    m = wks.Cells(wks.Rows.Count, \"A\").End(xlUp).Row\n\n    For i = 2 To m\n        On Error Resume Next\n        If IsError(WorksheetFunction.Match(wks.Cells(i, 9), base.Range(\"I:I\"), 0)) Then\n            Set rng = wks.Cells(i, 1).Resize(1, 9) 'Change 9 with your input range column count\n            n = n + 1\n            base.Cells(n, 1).Resize(rng.Rows.Count, rng.Columns.Count).Value = rng.Value\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9028251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/988ca9148a5072d62327f357893b4403?s=128&d=identicon&r=PG&f=1", "display_name": "Biggusdoggus", "link": "https://stackoverflow.com/users/9028251/biggusdoggus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 965, "favorite_count": 0, "accepted_answer_id": 47563665, "answer_count": 1, "score": 0, "last_activity_date": 1511999793, "creation_date": 1511996384, "last_edit_date": 1511996902, "question_id": 47563281, "link": "https://stackoverflow.com/questions/47563281/vba-copying-unique-values-into-different-sheet", "title": "VBA - copying unique values into different sheet", "body": "<p>Hoping you can help, please!</p>\n\n<p>So I have 2 worksheets, 1 &amp; 2. Sheet1 has already existing data, Sheet2 is used to dump raw data into. This is updated daily, and the data dump includes both data from previous days, as well as new data. The new data may include rows relating to interactions that may have happened earlier in the month, not just the previous day. So the data is not \"date sequential\".</p>\n\n<p>There are 9 columns of data, with a unique identifier in column I.</p>\n\n<p>What I'm needing to happen is when running the macro, it looks in column I in Sheet1 and Sheet2, and only copies and pastes rows where the unique identifier in Sheet 2 doesn't already exist in Sheet1. And pastes them from the last empty row onwards in Sheet1.   </p>\n\n<p>What I currently have is this - it's all I could find online:</p>\n\n<pre><code>Sub CopyData()\n\nApplication.ScreenUpdating = False\n\nDim LastRow As Long\nLastRow = Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\nDim rng As Range\nDim foundVal As Range\nFor Each rng In Sheets(\"Sheet2\").Range(\"A1:I\" &amp; LastRow)\n    Set foundVal = Sheets(\"Sheet1\").Range(\"I:I\").Find(rng, LookIn:=xlValues, LookAt:=xlWhole)\n    If foundVal Is Nothing Then\n        rng.EntireRow.Copy Sheets(\"Sheet1\").Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0)\n    End If\nNext rng\nApplication.ScreenUpdating = True \nEnd Sub\n</code></pre>\n\n<p>But it's just not working - not only does it not recognise if the value in column I already exists, it's copying and pasting only the first 2 rows from Sheet2, but duplicating them 8 times each!</p>\n\n<p>Apologies in advance, I'm a real VBA novice, and just can't work out where it's all going wrong. I would appreciate any assistance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1511999722, "post_id": 47563085, "comment_id": 82085549, "body": "I have placed an answer in terms of better handling of conditions not being met, but its hard to diagnose errors on <code>Split2(h)</code> or even <code>Split1(h)</code> when we can&#39;t see how they are defined."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1512004615, "post_id": 47563085, "comment_id": 82086864, "body": "&quot;and then user Resume to proceed.&quot; - so why did you use <code>GoTo ErrProceed</code> instead of <code>Resume ErrProceed</code>?  Using <code>GoTo</code> leaves you in error handling mode and unable to capture any subsequent errors (i.e. the second error you come up against will just give an error, such as &quot;subscript out of range&quot;).  Using <code>Resume</code> resumes code execution, allowing your <code>On Error</code> to again trap errors."}, {"owner": {"reputation": 1, "user_id": 9022852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30d897b8f01e2afe84a2f68c065af375?s=128&d=identicon&r=PG&f=1", "display_name": "L&#225;szl&#243; Poroszkai", "link": "https://stackoverflow.com/users/9022852/l%c3%a1szl%c3%b3-poroszkai"}, "edited": false, "score": 0, "creation_date": 1512056970, "post_id": 47563085, "comment_id": 82111660, "body": "I have added an Update trying to clarify things. Basically the first Split I use to iterate is longer than the 2nd, so this causes out of range error. I&#39;d like to capture this as this is exactly one of those input data issues I&#39;d like to catch (but there are some other issues I also need to capture). After this I&#39;d like to jump out of that loop to avoid noting the same out of range error report repeatedly."}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1511999595, "creation_date": 1511999595, "answer_id": 47563780, "question_id": 47563085, "link": "https://stackoverflow.com/questions/47563085/excel-vba-on-error-error/47563780#47563780", "title": "Excel VBA On Error error", "body": "<p>The short and quick version is that VBA Error Handling Routine's only handle errors in the actual code execution, they do not fire when conditions expressed by the code are not met. </p>\n\n<p>In your case, you do not need any error handling at all. In most cases it is actually best to avoid <code>On Error GoTo ...</code>. There are cases where it's inevitable, but they are rare.</p>\n\n<p>Try this <code>IF THEN ELSE</code> block:</p>\n\n<pre><code>If Sheets(\"SpecificSheet\").Cells(j, 1).Value = Split1(h) And Sheets(\"SpecificSheet\").Cells(j, 2).Value = Split2(h) Then\n    DependencyOk = DependencyOk + 1\nElse\n    Sheets(\"Issues\").Cells(x, 1) = \"IssueDescription\"\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9022852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30d897b8f01e2afe84a2f68c065af375?s=128&d=identicon&r=PG&f=1", "display_name": "L&#225;szl&#243; Poroszkai", "link": "https://stackoverflow.com/users/9022852/l%c3%a1szl%c3%b3-poroszkai"}, "is_accepted": false, "score": 0, "last_activity_date": 1512060337, "creation_date": 1512060337, "answer_id": 47578449, "question_id": 47563085, "link": "https://stackoverflow.com/questions/47563085/excel-vba-on-error-error/47578449#47578449", "title": "Excel VBA On Error error", "body": "<p>Actually I have just found the issue. It was caused by a \":\" left after an If statement a few rows earlier. I still don't really understand what it did, but I suggest not to reproduce it :)</p>\n"}, {"tags": [], "owner": {"reputation": 56, "user_id": 10386378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9681681f0a5529206f2b64e97dac786f?s=128&d=identicon&r=PG&f=1", "display_name": "Moxtheox", "link": "https://stackoverflow.com/users/10386378/moxtheox"}, "is_accepted": false, "score": 1, "last_activity_date": 1537448010, "creation_date": 1537448010, "answer_id": 52425646, "question_id": 47563085, "link": "https://stackoverflow.com/questions/47563085/excel-vba-on-error-error/52425646#52425646", "title": "Excel VBA On Error error", "body": "<p>You have an issue with your syntax.  The proper Error statement syntax is:</p>\n\n<pre><code>On Error GoTo &lt;string&gt;\nOn Error Resume Next\nOn Error GoTo 0\n</code></pre>\n\n<p>When using <code>On Error GoTo &lt;string&gt;</code> there is no \":\" at the end.  The \":\" doesn't come into play until you create the target location. Example:</p>\n\n<pre><code>On Error GoTo Here\n'// ---- Do something ---- //\nHere:\n'// ---- Handle the error ---- //\n</code></pre>\n\n<p>If you use <code>On Error Resume Next</code>, then you're telling the machine to ignore errors and proceed on to the next line of code.</p>\n\n<p>When you use<code>On Error Return To 0</code>, VBA will reset its error handling back to default.  It's a good habit when using  <code>On Error Resume Next</code> to insert <code>On Error Return To 0</code> as soon as you no longer need it.  <code>On Error Resume Next</code> has a real potential to break your code and make it behave strangely.  Not to mention debugging can be a real nightmare.  Check out the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/on-error-statement\" rel=\"nofollow noreferrer\">VBA manual from Microsoft</a> for a more detailed explanation.</p>\n\n<p>Finally, if your question is answered, you should mark it as answered.</p>\n\n<p><a href=\"/questions/tagged/vba-excel\" class=\"post-tag\" title=\"show questions tagged &#39;vba-excel&#39;\" rel=\"tag\">vba-excel</a><a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged &#39;vba&#39;\" rel=\"tag\">vba</a><a href=\"/questions/tagged/excel\" class=\"post-tag\" title=\"show questions tagged &#39;excel&#39;\" rel=\"tag\">excel</a></p>\n"}], "owner": {"reputation": 1, "user_id": 9022852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30d897b8f01e2afe84a2f68c065af375?s=128&d=identicon&r=PG&f=1", "display_name": "L&#225;szl&#243; Poroszkai", "link": "https://stackoverflow.com/users/9022852/l%c3%a1szl%c3%b3-poroszkai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1537448010, "creation_date": 1511995391, "last_edit_date": 1531164843, "question_id": 47563085, "link": "https://stackoverflow.com/questions/47563085/excel-vba-on-error-error", "title": "Excel VBA On Error error", "body": "<p>I am rather new at programming, and while learning Python also started experimenting with Excel VBA. I have an issue with the last one.</p>\n\n<p>I have some large Excel sheets and tried to validate that data in specific columns matches data on another sheet in certain columns as they will be supposed to relate to each other by these values (and will be connected by a third value). To make this a bit more difficult, both of these columns may contain more than one value separated by \"|\". So, I have split these values in a list and I try to iterate through them to make sure all these values are set correctly, the connection will work fine.</p>\n\n<p>All is fine as long as all is fine :) I have however an issue where there are two values in one of those columns and only one in the other. I would like this discrepancy to be noted on a sheet and then proceed to the next item.</p>\n\n<p>The way that seemed to be applicable for me is to use \"On Error GoTo ErrHandler\", then note error on another sheet, and then user Resume  to proceed.</p>\n\n<p>Here is what I came up with:</p>\n\n<pre><code>            For h = 0 To UBound(Split1())\n                 For j = 1 To GetMaxRow(\"SpecificSheet\", A)\n                     On Error GoTo ErrHandler:\n                        If Sheets(\"SpecificSheet\").Cells(j, 1).Value = Split1(h) And Sheets(\"SpecificSheet\").Cells(j, 2).Value = Split2(h) Then\n                                DependencyOk = DependencyOk + 1\n                        End If\n                    Next j\n            Next h\nErrProceed:\n</code></pre>\n\n<p>Also ErrHandler is:</p>\n\n<pre><code>ErrHandler:\n        Sheets(\"Issues\").Cells(x, 1) = \"IssueDescription\"\n    GoTo ErrProceed\n</code></pre>\n\n<p>It stops at line 2 with Subscript out of range for Split2(h) rather than moving on to ErrHandler and then ErrProceed. I have the feeling this must be something very obvious but I am just unable to get this working, and I am not able to find other way (like a try/except) in Excel VBA.</p>\n\n<p>UPDATE:</p>\n\n<p>Trying to clarify things a bit. The root of the issue is, that the Split2 list is shorter than Split1 - which is an issue with the input data and I'd like to capture this. I get the Split values from cells, where the values are separated by \"|\" characters:</p>\n\n<pre><code>    CellValue = Sheets(\"SomeSheet\").Cells(RowNumber, ColumNumber)\n    CellValueSplit() = Split(CellValue, \"|\")\n</code></pre>\n\n<p>And then iterate as:</p>\n\n<pre><code>   For h = 0 To UBound(Split1())\n</code></pre>\n\n<p>So as Split1 moves on to the for example 3rd value, Split2 throws error and script stops. The best I was able to do so far was, that I let it proceed with the loop, but as this is a rather large sheet, it will fill the same error report ca. 200k times in this case, which I'd like to avoid. So I'd prefer it to proceed from after this loop once it hits out of range error, and proceed examining the next value.</p>\n\n<p>Thank you for your help so far and in advance!</p>\n"}, {"tags": ["vba", "combobox", "onclick"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5432053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbcee496f27a177664ec76c65a758da8?s=128&d=identicon&r=PG&f=1", "display_name": "Fireblade", "link": "https://stackoverflow.com/users/5432053/fireblade"}, "edited": false, "score": 0, "creation_date": 1512319577, "post_id": 47591377, "comment_id": 82199302, "body": "It&#39;s the opposite. I want to validate the combobox content only when I click it or when I press the Enter, and not when I update the content."}, {"owner": {"reputation": 416, "user_id": 7564178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-q75MbZldt14/AAAAAAAAAAI/AAAAAAAAYPU/6QHQkGiKJYs/photo.jpg?sz=128", "display_name": "Harshit kyal", "link": "https://stackoverflow.com/users/7564178/harshit-kyal"}, "reply_to_user": {"reputation": 1, "user_id": 5432053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbcee496f27a177664ec76c65a758da8?s=128&d=identicon&r=PG&f=1", "display_name": "Fireblade", "link": "https://stackoverflow.com/users/5432053/fireblade"}, "edited": false, "score": 1, "creation_date": 1512450651, "post_id": 47591377, "comment_id": 82251452, "body": "@Fireblade then write your code on enter event of combo box."}], "tags": [], "owner": {"reputation": 416, "user_id": 7564178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-q75MbZldt14/AAAAAAAAAAI/AAAAAAAAYPU/6QHQkGiKJYs/photo.jpg?sz=128", "display_name": "Harshit kyal", "link": "https://stackoverflow.com/users/7564178/harshit-kyal"}, "is_accepted": false, "score": 0, "last_activity_date": 1512124118, "creation_date": 1512124118, "answer_id": 47591377, "question_id": 47563082, "link": "https://stackoverflow.com/questions/47563082/access-form-vba-combobox-click-event/47591377#47591377", "title": "Access form VBA ComboBox click event", "body": "<p>You can set your validation on update property of combo box. So whenever you change your combo box content it automatically checks for the validation.</p>\n"}], "owner": {"reputation": 1, "user_id": 5432053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbcee496f27a177664ec76c65a758da8?s=128&d=identicon&r=PG&f=1", "display_name": "Fireblade", "link": "https://stackoverflow.com/users/5432053/fireblade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 389, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512124118, "creation_date": 1511995383, "question_id": 47563082, "link": "https://stackoverflow.com/questions/47563082/access-form-vba-combobox-click-event", "title": "Access form VBA ComboBox click event", "body": "<p>I have Access form with comboboxes, textboxes and buttons. In the comboboxes I have the LimitToList property set to false, because in some situations I need to add some texto, and because of that, I need to validate the content of the comboxes and I'm using the OnClick event.\nHowever if I change the text in the combobox and the click on the \"Exit\" or \"New\" button, it fires the OnClick event.\nI would like to know if it's possible to the OnClick event only fires when I really click on a line of the combobox or press the Enter key, instead of firing when I click other button after changing the texto of the combobox.</p>\n\n<p>Thanks :)</p>\n"}, {"tags": ["excel", "foreach", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1511996494, "post_id": 47562799, "comment_id": 82084473, "body": "In other words, are you looking to just shift the information down a cell? I can&#39;t quite tell what you&#39;re trying to do if not..."}, {"owner": {"reputation": 67, "user_id": 6770993, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/XHGV2.jpg?s=128&g=1", "display_name": "mrkrister", "link": "https://stackoverflow.com/users/6770993/mrkrister"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1512033752, "post_id": 47562799, "comment_id": 82096960, "body": "@BruceWayne  Yes, the last bit was part of the example, an attempt to make it look like the sheet in the steps of &quot;For Each&quot;. So before running the sub A1=a, A2=b, A3=c, A4=d(the selected area) and A5=x. The result  should be A1=x, A2=a, A3=b, A4=c, A5=d. And since every loop starts from the top, my idea was to shift the values between A1 &amp; A5 then A2 &amp; A5 then A3 &amp; A5 then A4 &amp; A5 and after select A2:A5 . The result i get now is A1:A4= x and A5=a"}], "owner": {"reputation": 67, "user_id": 6770993, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/XHGV2.jpg?s=128&g=1", "display_name": "mrkrister", "link": "https://stackoverflow.com/users/6770993/mrkrister"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511996384, "creation_date": 1511993996, "last_edit_date": 1531161705, "question_id": 47562799, "link": "https://stackoverflow.com/questions/47562799/for-each-exchanging-values-moving-segment-of-content", "title": "for each, exchanging values / moving segment of content", "body": "<p>So I wanted to move contents of two parallell but not connected ranges down, cell by cell, so I wrote an earlier and more detailed version of the following code and somehow i got it to work but now it doesn't. </p>\n\n<pre><code>Sub movedown()\nDim r As Range, r1 As Range, r2 As Range, r3 As Range, r4 As Range\nDim rc As Integer, str$\n\nSet r = Intersect(Selection.EntireRow, Range(\"A:D\"))\nrc = r.Rows.Count\nSet r1 = r.Columns(1)'for column A\nSet r2 = r.Columns(4)'for column D\nSet r3 = r1.Cells(1, 1).Offset(rc)'offsets to the cell beneath the selection\nSet r4 = r2.Cells(1, 1).Offset(rc)'offsets to the cell beneath the selection\n\nFor Each c In r1\n    str = r3.Value\n    r3.Value = c.Value\n    c.Value = str\nNext c\n\nFor Each c In r2\n    str = r4.Value\n    r4.Value = c.Value\n    c.Value = str\nNext c\n\nr.Offset(1).Select\nEnd Sub\n</code></pre>\n\n<p>Example: (selected Range = A1:A4)\nThe idea was to exchange cell values between cells 1 and 5, then 2 and 5, then 3 and 5, then 4 and 5 and then move to the next range.</p>\n\n<pre><code>step  0 1 2 3 4\nA1    a x x x x    \nA2    b b a a a     \nA3    c c c b b     \nA4    d d d d c     \nA5    x a b c d \n</code></pre>\n"}, {"tags": ["html", "excel", "web-scraping", "vba"], "answers": [{"tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": false, "score": 0, "last_activity_date": 1511995161, "last_edit_date": 1511995161, "creation_date": 1511994283, "answer_id": 47562861, "question_id": 47562728, "link": "https://stackoverflow.com/questions/47562728/selecting-internet-explorer-li-object-from-ul-using-excel-vba/47562861#47562861", "title": "Selecting Internet Explorer &lt;li&gt; Object From &lt;ul&gt; Using Excel VBA", "body": "<p>Try this to get what you want:</p>\n\n<pre><code>IE.document.getElementsByClassName(\"selected\")(0).NextSibling.getAttribute (\"title\")\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 4761399, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/53473bdbc239b59e4933931371c495d7?s=128&d=identicon&r=PG&f=1", "display_name": "Shawn007", "link": "https://stackoverflow.com/users/4761399/shawn007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 726, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1511995161, "creation_date": 1511993638, "last_edit_date": 1531164843, "question_id": 47562728, "link": "https://stackoverflow.com/questions/47562728/selecting-internet-explorer-li-object-from-ul-using-excel-vba", "title": "Selecting Internet Explorer &lt;li&gt; Object From &lt;ul&gt; Using Excel VBA", "body": "<p>I am trying to get the second option (the non-default option) to select (as in physically highlight) in IE from Excel VBA. I have tried numerous methods (by tag, by class, etc). Any ideas are appreciated. There are no IDs to go on, the code below is complete. It is a non-public website, however the source below is representative of the issue. My Google/searches here did not yield results. Please ask any follow-up needed.</p>\n\n<pre><code>&lt;ul&gt;\n&lt;li class=\"selected\" title=\"Not What I Need\"&lt;/li&gt;\n&lt;li title=\"What I Need\"&lt;/li&gt;\n&lt;/ul&gt;\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1511993892, "post_id": 47562650, "comment_id": 82083386, "body": "There&#39;s no <code>Debug.Print</code> how is this showing in immediate window? If you&#39;re removed it, please put it back in so we know where you&#39;re debugging"}, {"owner": {"reputation": 3, "user_id": 8549934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03694173bc282a5e8e1696f1cab6a12?s=128&d=identicon&r=PG&f=1", "display_name": "B.C", "link": "https://stackoverflow.com/users/8549934/b-c"}, "reply_to_user": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1511994025, "post_id": 47562650, "comment_id": 82083458, "body": "I am calling the function in the immediate window ?indexfind(plan)"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1511994105, "post_id": 47562650, "comment_id": 82083498, "body": "Try putting <code>Debug.Print Plannumber</code> after that variable is set, maybe you&#39;re getting improper extraction of your number?"}, {"owner": {"reputation": 3, "user_id": 8549934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03694173bc282a5e8e1696f1cab6a12?s=128&d=identicon&r=PG&f=1", "display_name": "B.C", "link": "https://stackoverflow.com/users/8549934/b-c"}, "reply_to_user": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1511994220, "post_id": 47562650, "comment_id": 82083548, "body": "I just tried debugging all variables. They are returning the corerct values."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1511994288, "post_id": 47562650, "comment_id": 82083572, "body": "Put a break point on Workbooks.Open, then use function is worksheet and  step thru to see how far you can get to. Will advice to Open workbook with ReadOnly option. You will use this function just once in the workbook right?"}, {"owner": {"reputation": 3, "user_id": 8549934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03694173bc282a5e8e1696f1cab6a12?s=128&d=identicon&r=PG&f=1", "display_name": "B.C", "link": "https://stackoverflow.com/users/8549934/b-c"}, "edited": false, "score": 0, "creation_date": 1511994347, "post_id": 47562650, "comment_id": 82083591, "body": "Though i do notice there is a space in front of the plannumber maybe this has something to do with it? This is odd because using Val should only return numbers and no spaces.."}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1511994413, "post_id": 47562650, "comment_id": 82083618, "body": "I&#39;d suggest an <code>On Error GoTo</code> segment and try outputting the error message with <code>Str(Err.Number)</code> &amp; <code>Err.Description</code>."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1511994533, "post_id": 47562650, "comment_id": 82083670, "body": "Is <code>indexfind</code> decelared in a standard module?"}, {"owner": {"reputation": 3, "user_id": 8549934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03694173bc282a5e8e1696f1cab6a12?s=128&d=identicon&r=PG&f=1", "display_name": "B.C", "link": "https://stackoverflow.com/users/8549934/b-c"}, "edited": false, "score": 0, "creation_date": 1511994578, "post_id": 47562650, "comment_id": 82083694, "body": "yes it is a standard module"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1511994660, "post_id": 47562650, "comment_id": 82083736, "body": "You probably don&#39;t need to <code>Workbooks(&quot;PLANINDE.xls&quot;).Worksheets(&quot;Index&quot;).Activate</code>, which might be triggering other code. Calculation might be kicking in too, when you open workbooks."}, {"owner": {"reputation": 3, "user_id": 8549934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03694173bc282a5e8e1696f1cab6a12?s=128&d=identicon&r=PG&f=1", "display_name": "B.C", "link": "https://stackoverflow.com/users/8549934/b-c"}, "edited": false, "score": 0, "creation_date": 1511994676, "post_id": 47562650, "comment_id": 82083746, "body": "Maldred- I do not get any errors from the debugger when I call it in the immediate window. Im not sure what you are asking, can you please clarify."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1511994713, "post_id": 47562650, "comment_id": 82083765, "body": "You should also try to avoid using <code>Val</code> as it is not  locale aware - you&#39;d be better off using <code>CDbl</code>"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1511994909, "post_id": 47562650, "comment_id": 82083843, "body": "Put <code>On Error Goto ErrHandler</code> before <code>Workbooks.Open (&quot;File Path&quot;)</code> and then create an error message at then end; something like... <code>ErrHandler: Debug.print &quot;Error Code: &quot; &amp; Str(Err.Number) &amp; Chr(13) &amp; &quot;Description: &quot; &amp; Err.Description</code>. If this doesn&#39;t output any error messages then it seems there are some hidden characters some where and it might be best to parse the input manually rather than using <code>VAL()</code>"}, {"owner": {"reputation": 3, "user_id": 8549934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03694173bc282a5e8e1696f1cab6a12?s=128&d=identicon&r=PG&f=1", "display_name": "B.C", "link": "https://stackoverflow.com/users/8549934/b-c"}, "edited": false, "score": 0, "creation_date": 1511995451, "post_id": 47562650, "comment_id": 82084052, "body": "ThuderFrame- I changed Val to using CDbl(Plan). It is doign the same thing, it is able to extract the plannumber properly but still has a space infront for some reason."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1511995644, "post_id": 47562650, "comment_id": 82084121, "body": "The structure of your function is not good for what you want, for example, you have used <code>workbook activate</code> which does not make sense if you want to simply open a workbook (rather visible or in background), extract the data you need, close it and show it where it was called"}, {"owner": {"reputation": 3, "user_id": 8549934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03694173bc282a5e8e1696f1cab6a12?s=128&d=identicon&r=PG&f=1", "display_name": "B.C", "link": "https://stackoverflow.com/users/8549934/b-c"}, "edited": false, "score": 0, "creation_date": 1511995661, "post_id": 47562650, "comment_id": 82084125, "body": "Maldred- i did what you suggested. here is what i get: Error Code:  0 Description:"}, {"owner": {"reputation": 3, "user_id": 8549934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03694173bc282a5e8e1696f1cab6a12?s=128&d=identicon&r=PG&f=1", "display_name": "B.C", "link": "https://stackoverflow.com/users/8549934/b-c"}, "edited": false, "score": 0, "creation_date": 1511995709, "post_id": 47562650, "comment_id": 82084142, "body": "Ibo- I&#39;ve commented out the Activate part. it is still causing the same problem"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1511995836, "post_id": 47562650, "comment_id": 82084193, "body": "I don&#39;t think <code>Plannumber</code> should be a <code>Double</code>. It is not a good idea to match <code>Double</code> types due to precision issues."}, {"owner": {"reputation": 3, "user_id": 8549934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03694173bc282a5e8e1696f1cab6a12?s=128&d=identicon&r=PG&f=1", "display_name": "B.C", "link": "https://stackoverflow.com/users/8549934/b-c"}, "edited": false, "score": 0, "creation_date": 1511995865, "post_id": 47562650, "comment_id": 82084208, "body": "Maldred- When i call the function in a work sheet i do get an error Error Code:  9 Description: Subscript out of range  However when i call it in the immediate window it does not give an error and it returns the proper values."}, {"owner": {"reputation": 3, "user_id": 8549934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03694173bc282a5e8e1696f1cab6a12?s=128&d=identicon&r=PG&f=1", "display_name": "B.C", "link": "https://stackoverflow.com/users/8549934/b-c"}, "edited": false, "score": 0, "creation_date": 1511995921, "post_id": 47562650, "comment_id": 82084234, "body": "ja27- should I change it to integer instead? what do you suggest?"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1511995966, "post_id": 47562650, "comment_id": 82084260, "body": "you have used <code>If d Is Nothing Then</code>, that is a wrong line, <code>is nothing</code> should be used only for objects. The Excel FIND function returns the position (as a number) of one text string inside another, if not found it returns #VALUE. So you should use isnumeric/isnumber function or iserror function"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1511996205, "post_id": 47562650, "comment_id": 82084356, "body": "ignore my last comment, now I can see that you have used FIND worksheet function to find the value of the cell. It is still the same mistake, you should not use <code>is nothing</code> to compare"}, {"owner": {"reputation": 3, "user_id": 8549934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03694173bc282a5e8e1696f1cab6a12?s=128&d=identicon&r=PG&f=1", "display_name": "B.C", "link": "https://stackoverflow.com/users/8549934/b-c"}, "edited": false, "score": 0, "creation_date": 1511996230, "post_id": 47562650, "comment_id": 82084364, "body": "Thank you for your help everyone. I have to leave for now and will continue with this tomorrow."}, {"owner": {"reputation": 3, "user_id": 8549934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03694173bc282a5e8e1696f1cab6a12?s=128&d=identicon&r=PG&f=1", "display_name": "B.C", "link": "https://stackoverflow.com/users/8549934/b-c"}, "edited": false, "score": 0, "creation_date": 1512052422, "post_id": 47562650, "comment_id": 82108622, "body": "Ibo- what do you suggest I use instead of Is Nothing? What I am trying to do there is create an if statement where If (d is blank) then Do this. How else can i achieve that?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8549934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03694173bc282a5e8e1696f1cab6a12?s=128&d=identicon&r=PG&f=1", "display_name": "B.C", "link": "https://stackoverflow.com/users/8549934/b-c"}, "edited": false, "score": 0, "creation_date": 1512052528, "post_id": 47563429, "comment_id": 82108693, "body": "So there is no way to do this on excel? I have a list of plan numbers and I need to fill a column with information from another sheet. Do you know any way I can quickly achieve this rather than doing it manually?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 8549934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03694173bc282a5e8e1696f1cab6a12?s=128&d=identicon&r=PG&f=1", "display_name": "B.C", "link": "https://stackoverflow.com/users/8549934/b-c"}, "edited": false, "score": 0, "creation_date": 1512060375, "post_id": 47563429, "comment_id": 82113933, "body": "You can use a Sub instead of a function, and run it from a button on the worksheet.  Then you&#39;re not opening and closing the file for every value to be looked up."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1512003861, "last_edit_date": 1512003861, "creation_date": 1511997194, "answer_id": 47563429, "question_id": 47562650, "link": "https://stackoverflow.com/questions/47562650/function-works-in-immediate-window-but-not-in-worksheet/47563429#47563429", "title": "Function works in immediate window but not in worksheet?", "body": "<p>Your code cannot work as a function called directly from a worksheet.  VBA UDF's are restricted as to what they can do.</p>\n\n<p><a href=\"https://support.microsoft.com/en-us/help/170787/description-of-limitations-of-custom-functions-in-excel\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/170787/description-of-limitations-of-custom-functions-in-excel</a></p>\n"}], "owner": {"reputation": 3, "user_id": 8549934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03694173bc282a5e8e1696f1cab6a12?s=128&d=identicon&r=PG&f=1", "display_name": "B.C", "link": "https://stackoverflow.com/users/8549934/b-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 776, "favorite_count": 0, "accepted_answer_id": 47563429, "answer_count": 1, "score": 0, "last_activity_date": 1512042935, "creation_date": 1511993267, "last_edit_date": 1512042935, "question_id": 47562650, "link": "https://stackoverflow.com/questions/47562650/function-works-in-immediate-window-but-not-in-worksheet", "title": "Function works in immediate window but not in worksheet?", "body": "<p>I am trying to make a public function which looks up a user supplied number in a different workbook and extract information from it. The user will give a plan number (which is really a string with a number in it) and the function will look up this number in another workbook to collect a file number and a crossing associated with the plan number.Right now I have this function working when it is called in the immediate window but it will return #VALUE! when called on in a worksheet. Here is what i have.</p>\n\n<pre><code>Public Function indexfind(Plan As String) As String\n    Dim wks As Worksheet\n    Dim d As Range\n    Dim filenumber As String\n    Dim crossing As String\n    Dim Plannumber As Double\n    Plannumber = Val(Left(Plan, 4))\n\n    Workbooks.Open (\"File Path\")\n    Workbooks(\"PLANINDE.xls\").Worksheets(\"Index\").Activate\n    Set wks = Workbooks(\"PLANINDE.xls\").Worksheets(\"Index\")\n    Set d = wks.Range(\"G:G\").Find(Plannumber, , xlValues)\n\n    If d Is Nothing Then\n        indexfind = \"Plan Does Not Exist\"\n        Workbooks(\"PLANINDE.xls\").Close (False)\n    Exit Function\n    End If\n\n    filenumber = wks.Cells(d.Row, 2).Value\n    crossing = wks.Cells(d.Row, 3).Value\n\n    Workbooks(\"PLANINDE.xls\").Close (False)\n\n    Debug.Print filenumber\n    Debug.Print crossing\n    Debug.Print Plannumber\n\n    indexfind = \"No Plan Folder. File Number:\" &amp; filenumber &amp; \" crossing:\" &amp; crossing\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "date", "complete"], "comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 1, "creation_date": 1511996394, "post_id": 47562603, "comment_id": 82084435, "body": "I have a suggestion: Insert an Excel table, then you will have access to its auto filter easily, filter the columns as you want and then copy the visible cells of the table body into a new sheet."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1512041705, "post_id": 47562603, "comment_id": 82101860, "body": "Is there actually a sheet called &quot;Assets Info&quot; as well as &quot;Asset Info&quot; ? This would be a different error code none the less. And please use Option Explicit at the top of your code."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8958952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110baf17379dbe8e3ecd617f5083cffe?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian L ", "link": "https://stackoverflow.com/users/8958952/adrian-l"}, "edited": false, "score": 0, "creation_date": 1512051462, "post_id": 47572418, "comment_id": 82107978, "body": "The change works for a few of the asset but i get an error code for"}, {"owner": {"reputation": 3, "user_id": 8958952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110baf17379dbe8e3ecd617f5083cffe?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian L ", "link": "https://stackoverflow.com/users/8958952/adrian-l"}, "edited": false, "score": 0, "creation_date": 1512051507, "post_id": 47572418, "comment_id": 82108012, "body": "Do While Worksheets(&quot;Asset Info&quot;).Cells(x, 12) &lt;&gt; &quot;&quot; this part of the code which tell me a mismatch error run time error 13"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 3, "user_id": 8958952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110baf17379dbe8e3ecd617f5083cffe?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian L ", "link": "https://stackoverflow.com/users/8958952/adrian-l"}, "edited": false, "score": 0, "creation_date": 1512053317, "post_id": 47572418, "comment_id": 82109196, "body": "Updated my answer to reflect your comments."}, {"owner": {"reputation": 3, "user_id": 8958952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110baf17379dbe8e3ecd617f5083cffe?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian L ", "link": "https://stackoverflow.com/users/8958952/adrian-l"}, "edited": false, "score": 0, "creation_date": 1512137724, "post_id": 47572418, "comment_id": 82147953, "body": "I changed the part of the code as suggested but the command doesnt even run. I put the new code in the original post. @Xabier"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 3, "user_id": 8958952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110baf17379dbe8e3ecd617f5083cffe?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian L ", "link": "https://stackoverflow.com/users/8958952/adrian-l"}, "edited": false, "score": 0, "creation_date": 1512138142, "post_id": 47572418, "comment_id": 82148223, "body": "Sorry just noticed I missed the cell reference on the IF statement, please have a look at my updated answer,.."}, {"owner": {"reputation": 3, "user_id": 8958952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110baf17379dbe8e3ecd617f5083cffe?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian L ", "link": "https://stackoverflow.com/users/8958952/adrian-l"}, "edited": false, "score": 0, "creation_date": 1512139863, "post_id": 47572418, "comment_id": 82149323, "body": "I changed the cell reference and when i go to execute the button nothing happens."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 3, "user_id": 8958952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110baf17379dbe8e3ecd617f5083cffe?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian L ", "link": "https://stackoverflow.com/users/8958952/adrian-l"}, "edited": false, "score": 0, "creation_date": 1512140375, "post_id": 47572418, "comment_id": 82149695, "body": "You mistyped the following: If Worksheets(&quot;Assest Info&quot;).Cells(x, 12).Value &lt;&gt; &quot;&quot; &gt; start And  Worksheets(&quot;Assest Info&quot;).Cells(x, 12).Value &lt;&gt; &quot;&quot; &lt; enddt Then"}, {"owner": {"reputation": 3, "user_id": 8958952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110baf17379dbe8e3ecd617f5083cffe?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian L ", "link": "https://stackoverflow.com/users/8958952/adrian-l"}, "edited": false, "score": 0, "creation_date": 1512141232, "post_id": 47572418, "comment_id": 82150227, "body": "I changed the mistype but it still won&#39;t run for some reason"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 3, "user_id": 8958952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110baf17379dbe8e3ecd617f5083cffe?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian L ", "link": "https://stackoverflow.com/users/8958952/adrian-l"}, "edited": false, "score": 0, "creation_date": 1512142317, "post_id": 47572418, "comment_id": 82150951, "body": "I&#39;ve updated my answer with the full code, I&#39;ve tried and tested it and it works for me, please give it a try and let me know how you get on..."}, {"owner": {"reputation": 3, "user_id": 8958952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110baf17379dbe8e3ecd617f5083cffe?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian L ", "link": "https://stackoverflow.com/users/8958952/adrian-l"}, "edited": false, "score": 0, "creation_date": 1512142649, "post_id": 47572418, "comment_id": 82151183, "body": "Run Time error &quot;1004&quot;: Application defined or object defined error for the LastRow=Worksheets(&quot;Asset Info&quot;)......"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 3, "user_id": 8958952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110baf17379dbe8e3ecd617f5083cffe?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian L ", "link": "https://stackoverflow.com/users/8958952/adrian-l"}, "edited": false, "score": 0, "creation_date": 1512142970, "post_id": 47572418, "comment_id": 82151415, "body": "Adrian, please try replacing your code with my updated answer, where you have Worksheets(&quot;Assest Info&quot;) should be written as Sheets(&quot;Assest Info&quot;)"}, {"owner": {"reputation": 3, "user_id": 8958952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110baf17379dbe8e3ecd617f5083cffe?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian L ", "link": "https://stackoverflow.com/users/8958952/adrian-l"}, "edited": false, "score": 0, "creation_date": 1512143395, "post_id": 47572418, "comment_id": 82151699, "body": "Let me send you a copy of the workbook to see what the may problem may be. My spelling of the sheets are correct so Im lost where the problem may lie"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 3, "user_id": 8958952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110baf17379dbe8e3ecd617f5083cffe?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian L ", "link": "https://stackoverflow.com/users/8958952/adrian-l"}, "edited": false, "score": 0, "creation_date": 1512143486, "post_id": 47572418, "comment_id": 82151756, "body": "Before you do that @Adrian, please try replacing the code for your command button with my answer, as I&#39;ve updated it and it should work for you now... Also instead of Worksheets(&quot;Asset Info&quot;) it should be Sheets(&quot;Asset Info&quot;), as well as a couple more syntax errors you had in your code."}, {"owner": {"reputation": 3, "user_id": 8958952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110baf17379dbe8e3ecd617f5083cffe?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian L ", "link": "https://stackoverflow.com/users/8958952/adrian-l"}, "edited": false, "score": 0, "creation_date": 1512143685, "post_id": 47572418, "comment_id": 82151869, "body": "I forget to mention on the last comment that i did replace my code with your code and nothing unfortunately."}, {"owner": {"reputation": 3, "user_id": 8958952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110baf17379dbe8e3ecd617f5083cffe?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian L ", "link": "https://stackoverflow.com/users/8958952/adrian-l"}, "edited": false, "score": 0, "creation_date": 1512144279, "post_id": 47572418, "comment_id": 82152297, "body": "Still nothing unfortunately"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 3, "user_id": 8958952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110baf17379dbe8e3ecd617f5083cffe?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian L ", "link": "https://stackoverflow.com/users/8958952/adrian-l"}, "edited": false, "score": 0, "creation_date": 1512144422, "post_id": 47572418, "comment_id": 82152378, "body": "Well there must be something else at play here because the code in my answer worked for me, so I&#39;m at a loss at the moment... Send us a copy of your workbook and I will give it a try..."}, {"owner": {"reputation": 3, "user_id": 8958952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110baf17379dbe8e3ecd617f5083cffe?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian L ", "link": "https://stackoverflow.com/users/8958952/adrian-l"}, "edited": false, "score": 0, "creation_date": 1512144667, "post_id": 47572418, "comment_id": 82152538, "body": "How do i go about that im new to stack overflow and i dont see an option to atttach a file"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 3, "user_id": 8958952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110baf17379dbe8e3ecd617f5083cffe?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian L ", "link": "https://stackoverflow.com/users/8958952/adrian-l"}, "edited": false, "score": 0, "creation_date": 1512144759, "post_id": 47572418, "comment_id": 82152595, "body": "Upload the workbook to something like Google Drive or Dropbox and then include that link in your comment..."}, {"owner": {"reputation": 3, "user_id": 8958952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110baf17379dbe8e3ecd617f5083cffe?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian L ", "link": "https://stackoverflow.com/users/8958952/adrian-l"}, "edited": false, "score": 0, "creation_date": 1512145332, "post_id": 47572418, "comment_id": 82152919, "body": "<a href=\"https://drive.google.com/file/d/0BzF5FppySheBRXJVLXltTVdyejZtRHUzRU9iWDMwa0hER29B/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/&hellip;</a>"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 3, "user_id": 8958952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110baf17379dbe8e3ecd617f5083cffe?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian L ", "link": "https://stackoverflow.com/users/8958952/adrian-l"}, "edited": false, "score": 0, "creation_date": 1512145877, "post_id": 47572418, "comment_id": 82153273, "body": "Your error was not with the code I gave you but with the VLookup on the column L, I&#39;ve now fixed that and you can find the spreadsheet on the following link: <a href=\"https://drive.google.com/open?id=1aYbSZ-6nQoX6mLJ6clHMUTFv_mxa1DWN\" rel=\"nofollow noreferrer\">drive.google.com/open?id=1aYbSZ-6nQoX6mLJ6clHMUTFv_mxa1DWN</a>"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 3, "user_id": 8958952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110baf17379dbe8e3ecd617f5083cffe?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian L ", "link": "https://stackoverflow.com/users/8958952/adrian-l"}, "edited": false, "score": 0, "creation_date": 1512147030, "post_id": 47572418, "comment_id": 82153901, "body": "No worries, just to be clear, you were trying to lookup values that were giving you #N/A, then you were trying to check if this value falls between two dates, as such the error occurred, by wrapping you Vlookup with IFerror, then you can alter the result of #N/A to NULL, this will help you when checking if this falls between two dates... Anyways happy to help! :)"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1512142277, "last_edit_date": 1512142277, "creation_date": 1512041422, "answer_id": 47572418, "question_id": 47562603, "link": "https://stackoverflow.com/questions/47562603/if-then-statement-with-dates/47572418#47572418", "title": "If Then Statement with dates", "body": "<p>I have now tried and tested the following code and it should do what you expect it to:</p>\n\n<pre><code>Sheets(\"Paste2\").Rows(\"2:1000\").Delete\n\nDim erow As Long, start As Date, enddt As Date\n\nLastRow = Sheets(\"Asset Info\").Cells(Sheets(\"Asset Info\").Rows.Count, \"L\").End(xlUp).Row\n\nFor x = 2 To LastRow\n    start = DateValue(\"October 1,2016\")\n    enddt = DateValue(\"October 31,2016\")\n\n    If Sheets(\"Asset Info\").Cells(x, 12).Value &gt; start And Sheets(\"Asset Info\").Cells(x, 12).Value &lt; enddt Then\n        Sheets(\"Asset Info\").Rows(x).Copy\n        erow = Sheets(\"Paste2\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n        Sheets(\"Paste2\").Paste Destination:=Sheets(\"Paste2\").Rows(erow)\n   End If\nNext x\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8958952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/110baf17379dbe8e3ecd617f5083cffe?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian L ", "link": "https://stackoverflow.com/users/8958952/adrian-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1915, "favorite_count": 0, "accepted_answer_id": 47572418, "answer_count": 1, "score": 0, "last_activity_date": 1512142277, "creation_date": 1511992938, "last_edit_date": 1531164843, "question_id": 47562603, "link": "https://stackoverflow.com/questions/47562603/if-then-statement-with-dates", "title": "If Then Statement with dates", "body": "<p>I am programming a command button so that it may give me the assets that were sold between two dates.</p>\n\n<p><strong>A run time error 13: mismatch</strong> currently appears when i run the code. </p>\n\n<p>I changed the <code>If Then</code> statement  but i still get the same error. Below is an example of what i am trying to accomplish with the button. I want the code to look through all the dates in the sheet. Then those rows that are in-between the two dates are to be copied then pasted into another sheet.</p>\n\n<pre><code>| Asset#    | Asset Name S# | Sold     |\n|-----------|---------------|----------|\n| 4555#1202 | Scissor Lift  | 12/15/12 |\n| 4898#1204 | Light Tower   | 11/12/15 |\n</code></pre>\n\n<p>This is the code I'm running for the command button:</p>\n\n<pre><code>Private Sub CommandButton9_Click() \n\n    Worksheets(\"Paste2\").Rows(\"2:1000\").Delete\n\n    Dim erow As Long, start As Date, enddt As Date\n\n    x = 2\n\n    '*The 12 represents the column which contains the date for when the asset was sold*\n\n    Do While Worksheets(\"Asset Info\").Cells(x, 12) &lt;&gt; \"\"\n\n        start = DateValue(\"October 1,2016\")\n        enddt = DateValue(\"October 31,2016\")\n\n        If Worksheets(\"Asset Info\").Range(\"L1:L2500\") &gt; start And Worksheets(\"Asset Info\").Range(\"L1:L2500\") &lt; enddt Then  '*This is where the error occurs in the code*        \n\n            Worksheets(\"Asset Info\").Rows(x).Copy\n            Worksheets(\"Paste2\").Activate\n\n            erow = Worksheets(\"Paste2\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row        \n            ActiveSheet.Paste Destination:=Worksheets(\"Paste2\").Rows(erow)    \n        End If\n\n        Worksheets(\"Paste2\").Activate       \n        x = x + 1    \n\n    Loop    \n\n    Worksheets(\"Paste2\").Activate\nEnd Sub\n</code></pre>\n\n<p>Any suggestions will greatly be appreciated.</p>\n\n<p><a href=\"https://i.stack.imgur.com/H5coP.png\" rel=\"nofollow noreferrer\">an example of sheet im trying to copy </a></p>\n\n<p>Other form for the command button </p>\n\n<pre><code>`Worksheets(\"Paste2\").Rows(\"2:1000\").Delete\n\n\nDim erow As Long, LastRow As Long, start As Date, enddt As Date\n\nLastRow = Workheets(\"Asset Info\").Cells(Workheets(\"Asset Info\").Rows.Count, \"L\").End(xlUp).Row\n\nFor x = 2 To LastRow\n\n    start = DateValue(\"October 1,2016\")\n    enddt = DateValue(\"October 31,2016\")\n\n    If Worksheets(\"Asset Info\").Cells(x, 12).Value &lt;&gt; \"\" &gt; start And Worksheets(\"Asset Info\").Cells(x, 12).Value &lt;&gt; \"\" &lt; enddt Then\n\n\n        Worksheets(\"Asset Info\").Rows(x).Copy\n        Worksheets(\"Paste2\").Activate\n\n        erow = Worksheets(\"Paste2\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n\n        ActiveSheet.Paste Destination:=Worksheets(\"Paste2\").Rows(erow)\n\n   End If\nNext x\n\nEnd Sub`\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 1, "creation_date": 1511992869, "post_id": 47562410, "comment_id": 82082955, "body": "What code have you tried?  You will need to determine what shapes().Fill.Backcolor will equal your &quot;Pink&quot;, &quot;Yellow&quot;, &quot;Blue&quot;, etc....   Try to search Google for &quot;vba for each shape in worksheet&quot; to get a loop through your shapes."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1511996477, "post_id": 47562410, "comment_id": 82084467, "body": "It is an easy code, but have you started anything yourself?"}, {"owner": {"reputation": 31, "user_id": 8817363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df1321cb63741d4d318413391ca207e9?s=128&d=identicon&r=PG&f=1", "display_name": "Wiz Lee", "link": "https://stackoverflow.com/users/8817363/wiz-lee"}, "edited": false, "score": 0, "creation_date": 1512248862, "post_id": 47562410, "comment_id": 82183422, "body": "I already add in my code as above post."}, {"owner": {"reputation": 31, "user_id": 8817363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df1321cb63741d4d318413391ca207e9?s=128&d=identicon&r=PG&f=1", "display_name": "Wiz Lee", "link": "https://stackoverflow.com/users/8817363/wiz-lee"}, "edited": false, "score": 0, "creation_date": 1512248938, "post_id": 47562410, "comment_id": 82183457, "body": "My code only can count the color in the shape."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 8817363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df1321cb63741d4d318413391ca207e9?s=128&d=identicon&r=PG&f=1", "display_name": "Wiz Lee", "link": "https://stackoverflow.com/users/8817363/wiz-lee"}, "edited": false, "score": 0, "creation_date": 1512248653, "post_id": 47574502, "comment_id": 82183368, "body": "Hi Zsmaster, I did tried your code in my excel workbook, but cannot automatic get the count number unless I press the run button and another problem is if I did not blank the count cell and straight away press the run button, the count number will not tally."}, {"owner": {"reputation": 1540, "user_id": 5829910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/abHFX.jpg?s=128&g=1", "display_name": "Zsmaster", "link": "https://stackoverflow.com/users/5829910/zsmaster"}, "reply_to_user": {"reputation": 31, "user_id": 8817363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df1321cb63741d4d318413391ca207e9?s=128&d=identicon&r=PG&f=1", "display_name": "Wiz Lee", "link": "https://stackoverflow.com/users/8817363/wiz-lee"}, "edited": false, "score": 0, "creation_date": 1512465071, "post_id": 47574502, "comment_id": 82257817, "body": "Try to attach the function to an event, so you don&#39;t need to push a button. You need blank the count cell before run the function."}, {"owner": {"reputation": 31, "user_id": 8817363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df1321cb63741d4d318413391ca207e9?s=128&d=identicon&r=PG&f=1", "display_name": "Wiz Lee", "link": "https://stackoverflow.com/users/8817363/wiz-lee"}, "edited": false, "score": 0, "creation_date": 1512467643, "post_id": 47574502, "comment_id": 82259414, "body": "Is that any code can auto count without blank the cell?"}, {"owner": {"reputation": 1540, "user_id": 5829910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/abHFX.jpg?s=128&g=1", "display_name": "Zsmaster", "link": "https://stackoverflow.com/users/5829910/zsmaster"}, "reply_to_user": {"reputation": 31, "user_id": 8817363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df1321cb63741d4d318413391ca207e9?s=128&d=identicon&r=PG&f=1", "display_name": "Wiz Lee", "link": "https://stackoverflow.com/users/8817363/wiz-lee"}, "edited": false, "score": 0, "creation_date": 1512468306, "post_id": 47574502, "comment_id": 82259809, "body": "Try to add this to the beginning of the code: Range(&quot;C:C&quot;).Clear"}, {"owner": {"reputation": 31, "user_id": 8817363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df1321cb63741d4d318413391ca207e9?s=128&d=identicon&r=PG&f=1", "display_name": "Wiz Lee", "link": "https://stackoverflow.com/users/8817363/wiz-lee"}, "edited": false, "score": 0, "creation_date": 1512471369, "post_id": 47574502, "comment_id": 82261890, "body": "Its work, but when refresh on second time the count number will change, and come to 3rd time only back to the right figure."}], "tags": [], "owner": {"reputation": 1540, "user_id": 5829910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/abHFX.jpg?s=128&g=1", "display_name": "Zsmaster", "link": "https://stackoverflow.com/users/5829910/zsmaster"}, "is_accepted": true, "score": 4, "last_activity_date": 1512048063, "creation_date": 1512048063, "answer_id": 47574502, "question_id": 47562410, "link": "https://stackoverflow.com/questions/47562410/how-can-i-count-the-number-of-specific-shapes-with-different-color-in-excel/47574502#47574502", "title": "How can I count the number of specific shapes with different color in excel", "body": "<p>Try the following code:</p>\n\n<pre><code>Sub GetShapeProperties()\n    Dim sShapes As Shape, lLoop As Long, lastRow As Long, i As Long, find As Boolean\n    Dim wsStart As Worksheet\n\n    Set wsStart = ActiveSheet\n\n    'Loop through all shapes on active sheet\n    For Each sShapes In wsStart.Shapes\n        lastRow = ActiveSheet.UsedRange.Rows.Count\n        'Increment Variable lLoop for row numbers\n        lLoop = lLoop + 1\n        i = 2\n        With sShapes\n            'Add shape properties\n            find = False\n\n            Do While find = False\n                If (wsStart.Cells(i, 1).Value = MySplitFunction(.Name)(0)) Then\n                    If (wsStart.Cells(i, 2).Value = .Fill.ForeColor.RGB) Then\n                        find = True\n                        lLoop = lLoop - 1\n                    End If\n                End If\n\n                If i &gt; lLoop Then\n                    find = True\n                End If\n\n                i = i + 1\n            Loop\n\n            wsStart.Cells(i - 1, 1).Value = MySplitFunction(.Name)(0)\n            wsStart.Cells(i - 1, 2).Value = .Fill.ForeColor.RGB\n            wsStart.Cells(i - 1, 2).Interior.Color = .Fill.ForeColor.RGB\n            wsStart.Cells(i - 1, 3).Value = wsStart.Cells(i - 1, 3).Value + 1\n        End With\n    Next sShapes\nEnd Sub\n\nFunction MySplitFunction(s As String) As String()\n    Dim temp As String\n\n    Do\n      temp = s\n      s = Replace(s, \"  \", \" \") 'remove multiple white spaces\n    Loop Until temp = s\n\n    MySplitFunction = Split(Trim(s), \" \") 'trim to remove starting/trailing space\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/AC2P5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AC2P5.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 31, "user_id": 8817363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df1321cb63741d4d318413391ca207e9?s=128&d=identicon&r=PG&f=1", "display_name": "Wiz Lee", "link": "https://stackoverflow.com/users/8817363/wiz-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1660, "favorite_count": 0, "accepted_answer_id": 47574502, "answer_count": 1, "score": 2, "last_activity_date": 1512248753, "creation_date": 1511992095, "last_edit_date": 1512248753, "question_id": 47562410, "link": "https://stackoverflow.com/questions/47562410/how-can-i-count-the-number-of-specific-shapes-with-different-color-in-excel", "title": "How can I count the number of specific shapes with different color in excel", "body": "<p>I have searched on Google but I still cannot find a solution. I am looking for some VBA code to count on different shape with different color in excel.</p>\n\n<p>Example: I have 5 rectangle shapes and 3 square shapes in sheet1.\n2 rectangle shapes in yellow, 3 rectangle shapes in blue.\n1 square shape in pink, 2 square shapes in yellow.\nI need a VBA code to count the shapes in number with different color in cell A1 (Rectangle in yellow color), A2 (Rectangle in blue color), B1 (square in pink color), B2 (square in yellow color).</p>\n\n<pre><code>Private Sub Worksheet_Activate()\nDim shp As Shape\nDim shprange As ShapeRange\nDim CountyellowShape As Long\nDim CountpinkShape As Long\nDim CountblueShape As Long\n\nFor Each shp In Sheet1.Shapes\n\n    If shp.Type = msoGroup Then\n        Set shprange = shp.Ungroup\n        Set oMyGroup = shprange.Group\n\n        If shprange.Fill.ForeColor.RGB = RGB(255, 255, 0) Then CountChildShapeYELLOW = CountChildShapeYELLOW + 1\n        If shprange.Fill.ForeColor.RGB = RGB(255, 153, 153) Then CountChildShapePINK = CountChildShapePINK + 1\n        If shprange.Fill.ForeColor.RGB = RGB(0, 176, 240) Then CountChildShapeBLUE = CountChildShapeBLUE + 1\n\n    End If\nNext shp\n\nFor Each shp In Sheet1.Shapes\n    If shp.Fill.ForeColor.RGB = RGB(255, 255, 0) Then CountShapeYELLOW = CountShapeYELLOW + 1\n    If shp.Fill.ForeColor.RGB = RGB(255, 155, 153) Then CountShapePINK = CountShapePINK + 1\n    If shp.Fill.ForeColor.RGB = RGB(0, 176, 240) Then CountShapeBLUE = CountShapeBLUE + 1\nNext shp\n\nSheet1.Cells(1, 1) = CountShapeYELLOW + CountChildShapeYELLOW\nSheet1.Cells(2, 1) = CountShapePINK + CountChildShapePINK\nSheet1.Cells(3, 1) = CountShapeBLUE + CountChildShapeBLUE\n\nEnd Sub\n</code></pre>\n\n<p>Thanking in advance.\nWiz Lee</p>\n"}, {"tags": ["vba", "ms-office", "ms-word"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1511989970, "post_id": 47561828, "comment_id": 82081554, "body": "Did you tried recording a macro and modify the code? I use it several times to know the code lines that makes an specific action."}, {"owner": {"reputation": 470, "user_id": 5587480, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/pRrp7.png?s=128&g=1", "display_name": "john c. j.", "link": "https://stackoverflow.com/users/5587480/john-c-j"}, "edited": false, "score": 0, "creation_date": 1511990741, "post_id": 47561828, "comment_id": 82081924, "body": "@DavidG. Good idea. I updated the post."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1511990980, "post_id": 47561828, "comment_id": 82082029, "body": "microsoft notepad does not behave in that way. this feature is useful in programming editors, not so much in word processors where indentation is done by paragraph.   .... you could have a macro that inserts a tab at the beginning of every selected line."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1511991022, "post_id": 47561828, "comment_id": 82082052, "body": "Try <code>Selection.Paragraphs.LeftIndent = 72</code>"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1511991104, "post_id": 47561828, "comment_id": 82082081, "body": "examine the <code>selection</code> object tree in the Watch window.  one of its properties may be a collection of lines  .... if there is such a collection, then you could iterate through the collection and add a tab to the beginning of each of the lines"}, {"owner": {"reputation": 470, "user_id": 5587480, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/pRrp7.png?s=128&g=1", "display_name": "john c. j.", "link": "https://stackoverflow.com/users/5587480/john-c-j"}, "edited": false, "score": 0, "creation_date": 1511991212, "post_id": 47561828, "comment_id": 82082127, "body": "@DavidG. It indents using Word&#39;s build-in indentation. That&#39;s mean, after such code block will be someday copied to IDE, indentation will be lost."}, {"owner": {"reputation": 470, "user_id": 5587480, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/pRrp7.png?s=128&g=1", "display_name": "john c. j.", "link": "https://stackoverflow.com/users/5587480/john-c-j"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1511991242, "post_id": 47561828, "comment_id": 82082147, "body": "@jsotola Very interesting. Thank you!"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1511991361, "post_id": 47561828, "comment_id": 82082194, "body": "or <code>paragraphs</code> collection as answered below"}], "answers": [{"comments": [{"owner": {"reputation": 470, "user_id": 5587480, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/pRrp7.png?s=128&g=1", "display_name": "john c. j.", "link": "https://stackoverflow.com/users/5587480/john-c-j"}, "edited": false, "score": 0, "creation_date": 1511994826, "post_id": 47562202, "comment_id": 82083820, "body": "\u0421ould you please explain, why it works a bit strange for non-selected lines? That&#39;s what I mean: <a href=\"https://i.imgur.com/QjBdoIv.png\" rel=\"nofollow noreferrer\">link</a>. If I put the caret to some already indented line, indentation will be performed with caret moving. But if put the caret in the very beginning of the line, the caret will not be moved. Why?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 470, "user_id": 5587480, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/pRrp7.png?s=128&g=1", "display_name": "john c. j.", "link": "https://stackoverflow.com/users/5587480/john-c-j"}, "edited": false, "score": 0, "creation_date": 1512001404, "post_id": 47562202, "comment_id": 82086001, "body": "@johnc.j. If the cursor is in front of the paragraph, then inserting a tab in front of the paragraph is inserting it after the cursor. (Or think of it in terms of characters - if you insert a character &quot;t&quot; into the string &quot;cpppp&quot; just before the first &quot;p&quot;, you end up with &quot;ctpppp&quot;, i.e. &quot;c&quot; is not moved).  But if the cursor is in the middle of the paragraph, then inserting the tab in front of the paragraph moves the cursor.  (Again with characters, inserting a &quot;t&quot; before the first &quot;p&quot; in &quot;ppcpp&quot; gives &quot;tppcpp&quot;, i.e. the &quot;c&quot; has been moved with the rest of the characters.)"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 2, "last_activity_date": 1511991253, "creation_date": 1511991253, "answer_id": 47562202, "question_id": 47561828, "link": "https://stackoverflow.com/questions/47561828/indent-multiple-lines-the-same-way-as-plain-text-editor/47562202#47562202", "title": "Indent multiple lines the same way as plain text editor", "body": "<p>Insert a tab character at the start of each paragraph in the selection:</p>\n\n<pre><code>Sub Indentator()\n    Dim para As Paragraph\n    For Each para In Selection.Paragraphs\n        para.Range.InsertBefore vbTab\n    Next\nEnd Sub\n</code></pre>\n\n<p>(This assumes that each of your code \"lines\" is a new \"paragraph\" in Word, which it usually would be if you are intending to copy/paste this to/from actual code.)</p>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": true, "score": 1, "last_activity_date": 1511998098, "creation_date": 1511998098, "answer_id": 47563560, "question_id": 47561828, "link": "https://stackoverflow.com/questions/47561828/indent-multiple-lines-the-same-way-as-plain-text-editor/47563560#47563560", "title": "Indent multiple lines the same way as plain text editor", "body": "<p>If the macros are named <code>IncreaseIndent</code> and <code>DecreaseIndent</code>, they can be run using the Increase and Decrease Indent buttons on the Home tab. </p>\n\n<pre><code>Sub IncreaseIndent()\n    If Selection.Start = Selection.End Then\n        Selection.InsertBefore vbTab\n        Selection.Start = Selection.End\n    Else\n        Dim p As Paragraph\n        For Each p In Selection.Paragraphs\n            p.Range.InsertBefore vbTab\n        Next\n    End If\nEnd Sub\n\nSub DecreaseIndent()\n    If Selection.Start = Selection.Paragraphs(1).Range.Start Then\n        Selection.Start = Selection.Start + 1\n    End If\n    Dim p As Paragraph, c As Range\n    For Each p In Selection.Paragraphs\n        Set c = p.Range.Characters(1)\n        If c.Text = vbTab Then c.Delete\n    Next\nEnd Sub\n</code></pre>\n\n<p>Reference <a href=\"https://wordmvp.com/FAQs/MacrosVBA/InterceptSavePrint.htm\" rel=\"nofollow noreferrer\">https://wordmvp.com/FAQs/MacrosVBA/InterceptSavePrint.htm</a></p>\n"}], "owner": {"reputation": 470, "user_id": 5587480, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/pRrp7.png?s=128&g=1", "display_name": "john c. j.", "link": "https://stackoverflow.com/users/5587480/john-c-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1122, "favorite_count": 1, "accepted_answer_id": 47563560, "answer_count": 2, "score": 1, "last_activity_date": 1511998098, "creation_date": 1511989721, "last_edit_date": 1511991566, "question_id": 47561828, "link": "https://stackoverflow.com/questions/47561828/indent-multiple-lines-the-same-way-as-plain-text-editor", "title": "Indent multiple lines the same way as plain text editor", "body": "<p>Sometimes I have code blocks in my Word documents, and I want to work with them without copying to plain text editor.</p>\n\n<p>Namely, I want to have an ability to indent/unindent multiple lines of code using \"Tab\" character. This task is very simple in any plain text editor or IDE, but for the sake of clarity, I will show it here. Tabs are shown as black arrows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/QTZ7k.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QTZ7k.png\" alt=\"enter image description here\"></a></p>\n\n<ol>\n<li>Initial state</li>\n<li>Using the Shift key or mouse, I selected a part of JavaScript function</li>\n<li>Then I pressed Tab key on my keyboard</li>\n<li>Selected lines were indented by inserting tab character on each line.</li>\n</ol>\n\n<p>How it could be done with VBA?</p>\n\n<p>Since I don't post any code (as evidence of my own efforts), I don't expect to get something completely working. But at least, I hope to get an understanding \"how\" it could be done.</p>\n\n<hr>\n\n<p>As David suggested, I recorded a macro. Here how it looks:</p>\n\n<pre><code>Sub Indentator()\n    Selection.TypeText Text:=vbTab\nEnd Sub\n</code></pre>\n\n<p>The problem is, that I don't understand how to get it work for multiple lines. If I select them, this macro (and it was not surprise for me) just inserts \"Tab\" instead of selection.</p>\n\n<p><a href=\"https://i.stack.imgur.com/sIP33.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sIP33.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "edited": false, "score": 0, "creation_date": 1511999414, "post_id": 47561928, "comment_id": 82085464, "body": "And please note Access is not multithreadable, so you don&#39;t rely have anything running in &#39;background&#39;"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1511990049, "creation_date": 1511990049, "answer_id": 47561928, "question_id": 47561423, "link": "https://stackoverflow.com/questions/47561423/ms-access-database-monitor-query/47561928#47561928", "title": "MS Access database monitor query", "body": "<p>No, there isn't. An Access database is a file, not a server. Any profiling needs to be done by the application executing the query.</p>\n\n<p><a href=\"https://stackoverflow.com/q/8631975/7296893\">This question</a> has some answers on how to get the total time a query is running, but you're likely limited to that. <a href=\"https://stackoverflow.com/a/28370097/7296893\">This answer</a> shows you how to get the execution plan for queries, but it requires registry tweaking</p>\n"}], "owner": {"reputation": 315, "user_id": 6923139, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/c4f55643b357a8a86f6c54263ea56301?s=128&d=identicon&r=PG&f=1", "display_name": "programer Anel", "link": "https://stackoverflow.com/users/6923139/programer-anel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 47561928, "answer_count": 1, "score": 0, "last_activity_date": 1511990049, "creation_date": 1511987945, "question_id": 47561423, "link": "https://stackoverflow.com/questions/47561423/ms-access-database-monitor-query", "title": "MS Access database monitor query", "body": "<p>I have the application which use my locally stored access database.</p>\n\n<p>One option is very interesting to me. I would love to know which query is run in background to get data on that option. </p>\n\n<p>Something like </p>\n\n<pre><code>Query sniff\nQuery profiller\nQuery monitor\n</code></pre>\n\n<p>Is there any way to extract that query ?</p>\n"}, {"tags": ["excel", "vba", "macos", "excel-formula", "excel-2016"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 2, "creation_date": 1511987900, "post_id": 47561375, "comment_id": 82080469, "body": "Welcome to SO, I could not find a clear question (this is not a &quot;code for me&quot; site), can you modify your post and define a question to solve? Please read&gt; <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a>"}, {"owner": {"reputation": 11, "user_id": 9027845, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sHTGXG-yyA4/AAAAAAAAAAI/AAAAAAAAAk8/DxmMGBIBjzo/photo.jpg?sz=128", "display_name": "Lisa Jey Davis", "link": "https://stackoverflow.com/users/9027845/lisa-jey-davis"}, "edited": false, "score": 0, "creation_date": 1511988221, "post_id": 47561375, "comment_id": 82080626, "body": "Done. Not looking for free coding. Looking for specific suggestions to approach."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511988667, "post_id": 47561375, "comment_id": 82080863, "body": "Do you have a &quot;master list&quot; sheet for each &quot;company&quot;, or does &quot;A1&quot; mean &quot;row 1&quot;, etc?"}, {"owner": {"reputation": 11, "user_id": 9027845, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sHTGXG-yyA4/AAAAAAAAAAI/AAAAAAAAAk8/DxmMGBIBjzo/photo.jpg?sz=128", "display_name": "Lisa Jey Davis", "link": "https://stackoverflow.com/users/9027845/lisa-jey-davis"}, "edited": false, "score": 0, "creation_date": 1511989056, "post_id": 47561375, "comment_id": 82081061, "body": "Dang it... Editing.  Sorry about that."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511989574, "post_id": 47561375, "comment_id": 82081331, "body": "Ahh - that data layout looks more usable! (I hate sheets which have fields in rows instead of columns. My brain doesn&#39;t work that way. :D)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511989727, "post_id": 47561375, "comment_id": 82081426, "body": "Your problem with auto-populating this is that you are going to have to handle not just the case when someone enters &quot;Architect&quot; into (for instance) cell C5 (at which time you need the information from row 5 copied to the Architect sheet) but also the case when someone changes cell E10 from &quot;Architect&quot; to &quot;Designer&quot; (at which time you need to update the Architect sheet to remove the information for this company, and update the Designer sheet to add the information).  It is going to be much easier to just recreate all the &quot;specialty&quot; sheets after all updates in one editing session are completed"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511990058, "post_id": 47561375, "comment_id": 82081596, "body": "Or, alternatively, why not just create the &quot;specialty&quot; sheet when someone wants the information.  I.e. have a single sheet (in addition to the master sheet) where the user enters the speciality that they are interested in (perhaps in cell A1) and then a <code>Worksheet_Change</code> event then takes that information and populates the sheet with details of companies matching that speciality."}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 1, "creation_date": 1511990829, "post_id": 47561375, "comment_id": 82081960, "body": "This sounds like it&#39;d be best to use MS Access instead"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1511991576, "post_id": 47561375, "comment_id": 82082291, "body": "@Maldred LOL - any time someone says &quot;I am trying to create a xyz database in Excel&quot;, that&#39;s the first thing I think of too."}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511991803, "post_id": 47561375, "comment_id": 82082403, "body": "@YowE3K With all the back and forth of data with this question, it seems most fitting... However sometimes it&#39;s not always available unfortunately lol"}, {"owner": {"reputation": 11, "user_id": 9027845, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sHTGXG-yyA4/AAAAAAAAAAI/AAAAAAAAAk8/DxmMGBIBjzo/photo.jpg?sz=128", "display_name": "Lisa Jey Davis", "link": "https://stackoverflow.com/users/9027845/lisa-jey-davis"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511991938, "post_id": 47561375, "comment_id": 82082465, "body": "@YowE3K I will probably have drop down lists in the Specialty columns"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511992053, "post_id": 47561375, "comment_id": 82082532, "body": "Whether the value is changed via the user typing something in, or by the user selecting something via a drop-down list, doesn&#39;t really affect the fact that the value has changed and the old value is no longer applicable and the new value is."}, {"owner": {"reputation": 11, "user_id": 9027845, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sHTGXG-yyA4/AAAAAAAAAAI/AAAAAAAAAk8/DxmMGBIBjzo/photo.jpg?sz=128", "display_name": "Lisa Jey Davis", "link": "https://stackoverflow.com/users/9027845/lisa-jey-davis"}, "edited": false, "score": 0, "creation_date": 1511992121, "post_id": 47561375, "comment_id": 82082558, "body": "I think there should be some kind of a thing where I can say &quot;if B1, C1, D1, E1, F1 = Architect, then_______&quot; but not sure that works with a separate sheet, and how to tell it to add the information I require. Another board suggested this query, which only works in Google Docs:    =query(Sheet1!;B2:G2&quot;select A where B=&#39;Architect&#39; OR C=&#39;Architect&#39; OR D=&#39;Architect&#39; OR E=&#39;Architect&#39; OR F=Architect&quot;;1)"}, {"owner": {"reputation": 11, "user_id": 9027845, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sHTGXG-yyA4/AAAAAAAAAAI/AAAAAAAAAk8/DxmMGBIBjzo/photo.jpg?sz=128", "display_name": "Lisa Jey Davis", "link": "https://stackoverflow.com/users/9027845/lisa-jey-davis"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511992308, "post_id": 47561375, "comment_id": 82082660, "body": "Also @YowE3K, if the data on the master sheet is accurate, and the formula or code is correct in each row of subsequent sheets, then is data changes on the master sheet, each subsequent sheet should change, accordingly, correct? I guess it would create too many blank lines, where none of the requested data exists,,, ugh...  perhaps Access is the correct tool. I just hate it. I prefer FM Pro"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511992326, "post_id": 47561375, "comment_id": 82082669, "body": "You could certainly write an SQL query to do that against your master list, but my main question is why you would want to do that <b>before</b> someone looks at the other sheets?  (&quot;If a tree falls in a forest, and no-one is there, does it make a sound?&quot;, i.e. what does it matter what is on the &quot;Architect&quot; sheet unless someone wants to look at it?)  When someone wants to know what architects there are, provide the information to them at that time."}, {"owner": {"reputation": 11, "user_id": 9027845, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sHTGXG-yyA4/AAAAAAAAAAI/AAAAAAAAAk8/DxmMGBIBjzo/photo.jpg?sz=128", "display_name": "Lisa Jey Davis", "link": "https://stackoverflow.com/users/9027845/lisa-jey-davis"}, "edited": false, "score": 0, "creation_date": 1511992426, "post_id": 47561375, "comment_id": 82082727, "body": "The master list is there in no particular order (as it is entered) and many consultants do a myriad of things, &quot;architect of record,&quot; &quot;architectural design&quot; &quot;feasibility studies&quot; etc... There would be sheets for each of those, so when we need to send an RFP to all of the vendors who provide feasibility studies, we go to that sheet."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511992517, "post_id": 47561375, "comment_id": 82082776, "body": "All I am suggesting is that, when you want to send an RFP to all of the vendors who provide feasibility studies, you type in &quot;Feasibility Studies&quot; (or, preferably, select that from a drop-down) and let the macro give you back a list of all the people that do feasibility studies.  Don&#39;t try to produce the list before it is needed - it gets too complicated."}, {"owner": {"reputation": 11, "user_id": 9027845, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sHTGXG-yyA4/AAAAAAAAAAI/AAAAAAAAAk8/DxmMGBIBjzo/photo.jpg?sz=128", "display_name": "Lisa Jey Davis", "link": "https://stackoverflow.com/users/9027845/lisa-jey-davis"}, "edited": false, "score": 0, "creation_date": 1511992853, "post_id": 47561375, "comment_id": 82082948, "body": "I missed where you said to do a macro. I have a master list started, just haven&#39;t gotten feedback as to whether it requires more information (i.e. cell phone numbers etc). I am confused though. Where would you put the macro? I like the idea of just having a macro on the main sheet, with a drop down - and when &quot;feasability study&quot; is selected, it auto filters only those who have that in their row... Is that what you mean?"}, {"owner": {"reputation": 11, "user_id": 9027845, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sHTGXG-yyA4/AAAAAAAAAAI/AAAAAAAAAk8/DxmMGBIBjzo/photo.jpg?sz=128", "display_name": "Lisa Jey Davis", "link": "https://stackoverflow.com/users/9027845/lisa-jey-davis"}, "edited": false, "score": 0, "creation_date": 1511993011, "post_id": 47561375, "comment_id": 82083010, "body": "Also - to your question about when someone updates the master sheet... I&#39;m still not clear how, if the Architect sheet has the coding that is looking for architects.... if someone changes cell E2 from Architect to Designer, how that wouldn&#39;t be reflected and automatically change the &quot;Architect&quot; sheet?  Do you understand what I&#39;m saying?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511993079, "post_id": 47561375, "comment_id": 82083052, "body": "I would have a master list sheet, and a &quot;Query&quot; sheet.  On the &quot;Query&quot; sheet, I would let the user choose something in cell A1 (or wherever looks nice) and then have a <code>Worksheet_Change</code> event in the &quot;Query&quot; sheet that does something if cell A1 is changed.  The &quot;something&quot; could probably be something as simple as looping through every row on the master sheet and, if it finds the value from A1 in columns B:K of the master sheet, copy the info from that row of the master list to the &quot;Query&quot; sheet in the next available row."}, {"owner": {"reputation": 11, "user_id": 9027845, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sHTGXG-yyA4/AAAAAAAAAAI/AAAAAAAAAk8/DxmMGBIBjzo/photo.jpg?sz=128", "display_name": "Lisa Jey Davis", "link": "https://stackoverflow.com/users/9027845/lisa-jey-davis"}, "edited": false, "score": 0, "creation_date": 1511993159, "post_id": 47561375, "comment_id": 82083097, "body": "ahhhh... I like that!!! I knew this was the right place! Now to research how to do a query sheet! LOL"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511993308, "post_id": 47561375, "comment_id": 82083153, "body": "It is almost impossible to have formulas that will populate values on a sheet that picks values from another sheet and not leave blank rows.  (Sure the Architect sheet could have a formula in A2 which says <code>=IF(OR(Master!B2=&quot;Architect&quot;,Master!C2=&quot;Architect&quot;,Master!D2&zwnj;&#8203;=&quot;Architect&quot;,...,Mas&zwnj;&#8203;ter!K2=&quot;Architect&quot;),&zwnj;&#8203;Master!A2,&quot;&quot;)</code> but I think you want the first row in the Architect sheet to have the first <b>matching</b> row from the master list, and the second row in the Architect sheet to have the second <b>matching</b> row, etc.)"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1511993781, "post_id": 47561375, "comment_id": 82083337, "body": "This should move to chat, and once resolved, please post an answer here as I&#39;d love to see what the end result is"}, {"owner": {"reputation": 11, "user_id": 9027845, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sHTGXG-yyA4/AAAAAAAAAAI/AAAAAAAAAk8/DxmMGBIBjzo/photo.jpg?sz=128", "display_name": "Lisa Jey Davis", "link": "https://stackoverflow.com/users/9027845/lisa-jey-davis"}, "edited": false, "score": 0, "creation_date": 1511995981, "post_id": 47561375, "comment_id": 82084266, "body": "Will do... I am still working with our IT solutions at my office however, to enable my use of queries, and external database solutions. If/when I have resolved what I&#39;m doing, I will post it here."}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511994316, "post_id": 47562806, "comment_id": 82083582, "body": "Note:  I have no idea whether all that code is valid on the Mac version of Excel.  It seems fairly basic, so I don&#39;t <b>think</b> you would have any problems with it."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1511994024, "creation_date": 1511994024, "answer_id": 47562806, "question_id": 47561375, "link": "https://stackoverflow.com/questions/47561375/how-to-auto-populate-a-names-list-to-one-sheet-based-on-data-in-another-sheet-in/47562806#47562806", "title": "How to auto-populate a names list to one sheet based on data in another sheet in Excel for Mac 2016", "body": "<p>Potential \"Query\" sheet <code>Worksheet_Change</code> event (i.e. this code should be pasted into the code module of the actual sheet you use for the \"querying\"):</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Intersect(Target, Range(\"A1\")) Is Nothing Then Exit Sub\n    On Error GoTo ReEnableEvents\n    Application.EnableEvents = False\n    Dim lastRow As Long\n    Dim r As Long\n    Dim c As Long\n    Dim newRow As Long\n    Dim Speciality As String\n    Speciality = Range(\"A1\").Value\n    'clear existing data\n    lastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n    If lastRow &gt; 2 Then ' Assume headings are on row 2\n        Rows(\"3:\" &amp; lastRow).ClearContents\n    End If\n    'find new data\n    newRow = 2\n    With Worksheets(\"MasterList\")\n        For r = 2 To .Cells(.Rows.Count, \"A\").End(xlUp).Row\n            For c = 2 To 11 ' loop through the speciality columns\n                If .Cells(r, c).Value = Speciality Then\n                    newRow = newRow + 1\n                    Cells(newRow, \"A\").Value = .Cells(r, \"A\").Value\n                    Cells(newRow, \"B\").Value = .Cells(r, \"L\").Value\n                    Cells(newRow, \"C\").Value = .Cells(r, \"M\").Value\n                    Cells(newRow, \"D\").Value = .Cells(r, \"N\").Value\n                    Cells(newRow, \"E\").Value = .Cells(r, \"O\").Value\n                    Cells(newRow, \"F\").Value = .Cells(r, \"P\").Value\n                    Cells(newRow, \"G\").Value = .Cells(r, \"Q\").Value                        \n                    Exit For\n                End If\n            Next\n        Next\n    End With\nReEnableEvents:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>This assumes that cell A1 of the \"Query\" sheet is the value you want to look for (i.e. the \"Speciality\"), that row 2 of that sheet will have headings, and that rows 3 onward will be populated with the results.</p>\n\n<p>I haven't tested it, but it should be close to what you need.</p>\n"}], "owner": {"reputation": 11, "user_id": 9027845, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sHTGXG-yyA4/AAAAAAAAAAI/AAAAAAAAAk8/DxmMGBIBjzo/photo.jpg?sz=128", "display_name": "Lisa Jey Davis", "link": "https://stackoverflow.com/users/9027845/lisa-jey-davis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1329, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1593675599, "creation_date": 1511987718, "last_edit_date": 1593675599, "question_id": 47561375, "link": "https://stackoverflow.com/questions/47561375/how-to-auto-populate-a-names-list-to-one-sheet-based-on-data-in-another-sheet-in", "title": "How to auto-populate a names list to one sheet based on data in another sheet in Excel for Mac 2016", "body": "<p>I searched the other pages that seemed to be answering the question. I have tried to do this using the if-then formula between sheets, but it doesn't work well with multiple cells / columns. I can't figure it out. </p>\n\n<p>I saw somewhere that a person suggested a query (but that was for use in Google and doesn't work in Excel). Any suggestions on how to best do this? </p>\n\n<p>I am trying to create a consultant database in Excel. We use consultants on projects, and various consultants perform X number of jobs. </p>\n\n<p><strong>Sheet 1 would be the master list with the following data</strong></p>\n\n<p>A1 - Company Name </p>\n\n<p>B1 - Specialty 1 </p>\n\n<p>C1 - Specialty 2</p>\n\n<p>D1 - Specialty 3</p>\n\n<p>(and so forth - probably up to 10 specialties), Then </p>\n\n<p>L1 - Key Contacts</p>\n\n<p>M1 - Email 1</p>\n\n<p>N1 - Email 2</p>\n\n<p>O1 - Email 3</p>\n\n<p>P1 - Email 4</p>\n\n<p>Q1 - Previous Projects</p>\n\n<p>and so on (there may be cell phone numbers and more added)</p>\n\n<p><strong>Sheet 2 and beyond would populate based on specialty.</strong> </p>\n\n<p>Let's say Sheet 2 is called Architects.  If one of the specialties matches \"Architect\", I'd want it to provide me the following on the Architects sheet (sheet 2): </p>\n\n<p>A1 Company Name</p>\n\n<p>B1 Key Contacts</p>\n\n<p>C1 Email1</p>\n\n<p>D1 Email2</p>\n\n<p>E1 Email3</p>\n\n<p>F1 Email4</p>\n\n<p>G1 Previous Projects</p>\n\n<p>Can someone please help me figure out how to auto populate? As the master sheet changes, it will be imperative I don't have to constantly update the other sheets. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 3, "creation_date": 1511987646, "post_id": 47561338, "comment_id": 82080322, "body": "So, what is your question? Please read&gt; <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a>"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1511990660, "post_id": 47561338, "comment_id": 82081887, "body": "why are you even asking? why does your code change the value in a cell and then does <b>not</b> change the color right after?"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1511991078, "post_id": 47561338, "comment_id": 82082068, "body": "This code is very sloppy... You should create a variable for your WS, I&#39;m seeing a few typos with <code>Sheets(&quot;Sheet2&quot;)</code> (maybe?) in here that may be causing issues. I&#39;m not surprised you&#39;re having issues with this code"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 0, "last_activity_date": 1511987764, "creation_date": 1511987764, "answer_id": 47561386, "question_id": 47561338, "link": "https://stackoverflow.com/questions/47561338/modify-macro-to-highlight-overwritten-cell/47561386#47561386", "title": "Modify macro to highlight overwritten cell", "body": "<p>You can find several ways to highlight a cell in</p>\n\n<blockquote>\n  <p><a href=\"http://www.excel-easy.com/vba/examples/highlight-active-cell.html\" rel=\"nofollow noreferrer\">http://www.excel-easy.com/vba/examples/highlight-active-cell.html</a></p>\n</blockquote>\n\n<pre><code>Cells.Interior.ColorIndex = 0\n\nCells(i, columnNumberValue).Interior.ColorIndex = 37\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8479751, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/787a95115dcfe1290d52c40d6ccc7f4c?s=128&d=identicon&r=PG&f=1", "display_name": "Wendi", "link": "https://stackoverflow.com/users/8479751/wendi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1511988186, "creation_date": 1511987587, "last_edit_date": 1511988186, "question_id": 47561338, "link": "https://stackoverflow.com/questions/47561338/modify-macro-to-highlight-overwritten-cell", "title": "Modify macro to highlight overwritten cell", "body": "<p>I would like to modify the VBA code below so that if the macro overwrites a cell then it will be highlighted so we can go back and check it. For example: if we had the word \u2018cardboard\u2019 before the word \u2018car\u2019 the program overwrites the answer to cardboard with the answer to car given that it has the same letters so it shows up in our filter, I want this cell to be highlighted so that we know it changed an answer. </p>\n\n<p>Thank you so much for your help!</p>\n\n<pre><code>Sub filter()\n\nDim i As Integer\nDim lastrow As Long\nDim rng As Range\nDim lastrows As Long\nDim rngs As Range\n\nApplication.ScreenUpdating = False\n\nSet rng = Sheets(\"Sheet2\").Cells\nSet rngs = Sheets(\"Sheet1\").Cells\n\nlastrow = rng.Find(what:=\"*\", after:=rng.Cells(1), lookat:=xlPart, \nLookIn:=xlFormulas, Searchorder:=xlByRows, searchdirection:=xlPrevious, \nMatchCase:=False).Row\nlastrows = rngs.Find(what:=\"*\", after:=rngs.Cells(1), lookat:=xlPart, \nLookIn:=xlFormulas, Searchorder:=xlByRows, searchdirection:=xlPrevious, \nMatchCase:=False).Row\n\nIf (Sheets(\"Sheet2\").AutoFilterMode And Sheets(\"Sheet2\").FilterMode) Or \nSheets(\"Sheet2\").FilterMode Then\nSheets(\"Sheets2\").ShowAllData\nEnd If\n\nFor i = 3 To lastrows\nsearchfor = Sheets(\"Sheet1\").Range(\"A\" &amp; i).Value\nCategory = Sheets(\"Sheet1\").Range(\"B\" &amp; i).Value\n\nSheets(\"Sheet2\").Range(\"$A$2:A\" &amp; lastrow).AutoFilter field:=1, \nCriteria1:=\"=*\" &amp; searchfor &amp; \"*\"\n\nWith Sheets(\"Sheet2\")\n    headerrow = .AutoFilter.Range(1).Row\n    lastfilterrow = .Range(Split(.AutoFilter.Range.Address, \":\")(1)).Row\n    getfilteredrangetoprow = .Range(.Rows(headerrow + 1), \n.Rows(Rows.Count)).SpecialCells(xlCellTypeVisible)(1).Row\n    If getfilteredrangetoprow = lastfilterrow + 1 Then \ngetfilteredrangetoprow = 0\nEnd With\n\nIf getfilteredrangetoprow &lt;&gt; 0 Then\n    For Each Cell In Sheets(\"Sheet2\").Range(\"b3:b\" &amp; \nlastrow).SpecialCells(xlCellTypeVisible)\n        Cell.FormulaR1C1 = Category\n    Next Cell\n    End If\n\nNext i\n\nIf (Sheets(\"Sheet2\").AutoFilterMode And Sheets(\"sheet2\").FilterMode) Or \nSheets(\"sheet2\").FilterMode Then\nSheets(\"Sheet2\").ShowAllData\nEnd If\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 4572, "user_id": 2445415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc71bb0d143a5595e296f0264dc4eb16?s=128&d=identicon&r=PG", "display_name": "Jakob Busk S&#248;rensen", "link": "https://stackoverflow.com/users/2445415/jakob-busk-s%c3%b8rensen"}, "edited": false, "score": 1, "creation_date": 1511989204, "post_id": 47561201, "comment_id": 82081139, "body": "Doesn&#39;t record set use stuff like <code>.MoveNext</code> to change rows? And the number in the bracket to index the row item (column)?"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 4572, "user_id": 2445415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc71bb0d143a5595e296f0264dc4eb16?s=128&d=identicon&r=PG", "display_name": "Jakob Busk S&#248;rensen", "link": "https://stackoverflow.com/users/2445415/jakob-busk-s%c3%b8rensen"}, "edited": false, "score": 1, "creation_date": 1511990194, "post_id": 47561201, "comment_id": 82081664, "body": "@Noceo, that is called a <code>record field</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "is_accepted": true, "score": 0, "last_activity_date": 1511989456, "creation_date": 1511989456, "answer_id": 47561765, "question_id": 47561201, "link": "https://stackoverflow.com/questions/47561201/vba-loop-through-recordset-fails/47561765#47561765", "title": "VBA - Loop through Recordset fails", "body": "<p>Just got the answer, it needs the <code>.movenext</code></p>\n\n<p>Here goes the code,</p>\n\n<pre><code>With rs\n\n Do Until rs.EOF\n\n     ReqValue = rs.Fields(0).Value\n\n     If ReqValue &lt;&gt; \"\" Then\n\n                With RequiredReportType.RT_ListBox\n\n                        .AddItem ReqValue\n\n                End With\n\n            End If\n\n\n     rs.MoveNext\n\n Loop\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 47561765, "answer_count": 1, "score": 2, "last_activity_date": 1511989456, "creation_date": 1511987106, "last_edit_date": 1511988416, "question_id": 47561201, "link": "https://stackoverflow.com/questions/47561201/vba-loop-through-recordset-fails", "title": "VBA - Loop through Recordset fails", "body": "<p>I have a requirement where in I am looping through a record set without using EOF.\nBut it fails to pick up the 2nd element, saying it couldn't find it in the collection.</p>\n\n<p>This is my code:</p>\n\n<pre><code>Set rs = db.OpenRecordSet(strSQL)\n Debug.Print (rs(0)) 'Works\n Debug.Print (rs(1)) 'Says Item cannot be found\n</code></pre>\n\n<p>But rs.RecordCount gives an value of 2</p>\n\n<p>I am trying to get those values and add it to a listbox</p>\n\n<pre><code>Total1 = rs.RecordCount\nTotal2 = Total1 - 1\n\n\nIf Total1 &gt; 0 Then\n    For j = 0 To Total2\n        Value = rs(j) ' fails when j = 1\n            If Value &lt;&gt; \"\" Then                \n                With RequiredReportType.RT_ListBox\n                    .AddItem Value\n                End With\n            End If\n        Value = \"\"     \n    Next\nEnd If\n</code></pre>\n\n<p>Please help me with this.</p>\n"}, {"tags": ["vba", "combobox"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511987374, "post_id": 47561049, "comment_id": 82080194, "body": "Do you have any <code>Change</code> events linked to your comboboxes?  E.g. Do you have a <code>CBForm_Change</code> that will be fired when you set <code>CBForm.ListIndex = 0</code>?  If so, what does the code do?"}, {"owner": {"reputation": 19, "user_id": 7427591, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/696233257221022/picture?type=large", "display_name": "Martin", "link": "https://stackoverflow.com/users/7427591/martin"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511989047, "post_id": 47561049, "comment_id": 82081054, "body": "I tested it and I found out, that it is caused by ControlSource value. I set up there cell where should be value written. If it is empty it works, so I think I will put into code where will be value written instead of setting it directly in combobox."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 7427591, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/696233257221022/picture?type=large", "display_name": "Martin", "link": "https://stackoverflow.com/users/7427591/martin"}, "edited": false, "score": 0, "creation_date": 1511987546, "post_id": 47561153, "comment_id": 82080269, "body": "It didn&#39;t work as well. It works if I am stepping process, but as soon as I am trying to run it, it will change only default value for first combobox."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 19, "user_id": 7427591, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/696233257221022/picture?type=large", "display_name": "Martin", "link": "https://stackoverflow.com/users/7427591/martin"}, "edited": false, "score": 0, "creation_date": 1511987829, "post_id": 47561153, "comment_id": 82080416, "body": "Try @YowE3K suggestion. Something is wrong with your user form. You can try this code in a new UserForm and it should works."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 0, "last_activity_date": 1511986915, "creation_date": 1511986915, "answer_id": 47561153, "question_id": 47561049, "link": "https://stackoverflow.com/questions/47561049/vba-default-value-for-multiple-combo-boxes/47561153#47561153", "title": "VBA default value for multiple combo boxes", "body": "<p>Not sure why it's not working... but try the next.\nCreate a procedure in your <code>UserForm</code> code to set the initial values:</p>\n\n<pre><code>Private Sub InitializeCombos()\n    CBForm.ListIndex = 0\n    CBERP.ListIndex = 0\n    CBCountry.ListIndex = 0\nEnd Sub\n</code></pre>\n\n<p>Then, call your procedure at <code>UserForm_Initialize</code></p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    Call InitializeCombos\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 7427591, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/696233257221022/picture?type=large", "display_name": "Martin", "link": "https://stackoverflow.com/users/7427591/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1511986915, "creation_date": 1511986517, "last_edit_date": 1511986695, "question_id": 47561049, "link": "https://stackoverflow.com/questions/47561049/vba-default-value-for-multiple-combo-boxes", "title": "VBA default value for multiple combo boxes", "body": "<p>I would like to ask you to help me set up default value for multiple comboboxes. I used code below, but it will change only default value of first combobox. When I close it and open 2nd time, 2nd value will be changed to default, 3rd time, 3 value and so on. \nI need to change all default values of all my comboboxes in userform within initialization.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    CBForm.ListIndex = 0\n    CBERP.ListIndex = 0\n    CBCountry.ListIndex = 0\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1511987334, "post_id": 47560878, "comment_id": 82080167, "body": "what are the exact issues you are having?"}, {"owner": {"reputation": 21, "user_id": 8642998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/456f8997b0327f4b89c0c1d4a8fdb07b?s=128&d=identicon&r=PG&f=1", "display_name": "S.MART", "link": "https://stackoverflow.com/users/8642998/s-mart"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1511987641, "post_id": 47560878, "comment_id": 82080317, "body": "my code is prompting to enter the name of the new file, i need to make sure it automatically enters the name of the original xlsm file. user should not be able to rename the file."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1511987666, "post_id": 47560878, "comment_id": 82080335, "body": "see my answer below"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8642998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/456f8997b0327f4b89c0c1d4a8fdb07b?s=128&d=identicon&r=PG&f=1", "display_name": "S.MART", "link": "https://stackoverflow.com/users/8642998/s-mart"}, "edited": false, "score": 0, "creation_date": 1511989052, "post_id": 47561462, "comment_id": 82081057, "body": "yeah this works great! it created the copy i needed, the only thing is that it automatically saves in the same folder as the original. how can i changed it so prompts me to select where do i want to save it? is that possible"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 21, "user_id": 8642998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/456f8997b0327f4b89c0c1d4a8fdb07b?s=128&d=identicon&r=PG&f=1", "display_name": "S.MART", "link": "https://stackoverflow.com/users/8642998/s-mart"}, "edited": false, "score": 0, "creation_date": 1512017500, "post_id": 47561462, "comment_id": 82089977, "body": "Replace &quot;Activeworkbook.Path&quot; with &quot;C:\\Folder\\SubFolder\\&quot; using the quotations. Replace the Drive letter, folder and subfolder names with where you want to save the file."}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": true, "score": 1, "last_activity_date": 1511988487, "last_edit_date": 1511988487, "creation_date": 1511988091, "answer_id": 47561462, "question_id": 47560878, "link": "https://stackoverflow.com/questions/47560878/how-to-convert-from-xlsm-to-xlsx-keeping-the-same-name/47561462#47561462", "title": "How to convert from xlsm to xlsx keeping the same name", "body": "<p>I think you only want to add a .xlxs copy not write over your macro enabled workbook. Try the below line of code, it should work, put your workbook name in \"put Workbook name here\", the file left open will be the .xlsx file.</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nActiveWorkbook.SaveAs Filename:=ActiveWorkbook.Path &amp; \"\\\" &amp; \"Put Workbook Name here\" &amp; \".xlsx\", FileFormat:=51, Password:=\"\", WriteResPassword:=\"\", _\nReadOnlyRecommended:=False, CreateBackup:=False\n\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 8642998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/456f8997b0327f4b89c0c1d4a8fdb07b?s=128&d=identicon&r=PG&f=1", "display_name": "S.MART", "link": "https://stackoverflow.com/users/8642998/s-mart"}, "edited": false, "score": 0, "creation_date": 1511996316, "post_id": 47562372, "comment_id": 82084413, "body": "Thank you, this code its great! it does exactly what i need but not sure why im getting an error message when I try to open the new file. it says &quot;excel cannot open the file &quot;filename.xlsx&quot; because the file format or file extension is not valid. verify that the file has not been corrupted and that the file extension matches the format of the file.&quot; Not sure how solve this issue."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1512017826, "post_id": 47562372, "comment_id": 82090072, "body": "Because a . is needed before the &quot;xlsx&quot; change it to &quot;.xlsx&quot;"}], "tags": [], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "is_accepted": false, "score": 1, "last_activity_date": 1511991933, "creation_date": 1511991933, "answer_id": 47562372, "question_id": 47560878, "link": "https://stackoverflow.com/questions/47560878/how-to-convert-from-xlsm-to-xlsx-keeping-the-same-name/47562372#47562372", "title": "How to convert from xlsm to xlsx keeping the same name", "body": "<p>You need to create FolderPicker Function:</p>\n\n<pre><code>Sub changeext()\nDim objFolder As Object, objFSO As Object\n\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objFolder = objFSO.GetFolder(ChooseFolder)\n\nThisWorkbook.SaveCopyAs Filename:=objFolder &amp; \"\\\" &amp; Left(ThisWorkbook.Name, Len(ThisWorkbook.Name) - 4) &amp; \"xlsx\"\n\nEnd Sub\n\nFunction ChooseFolder() As String\nDim fldr As FileDialog\nDim sItem As String\n\nSet fldr = Application.FileDialog(msoFileDialogFolderPicker)\nWith fldr\n    .Title = \"Select a Folder to save down the copy of this workbook\"\n    .AllowMultiSelect = False\n    .InitialFileName = strPath\n    If .Show &lt;&gt; -1 Then GoTo NextCode\n    sItem = .SelectedItems(1)\nEnd With\n\nNextCode:\n    ChooseFolder = sItem\n    Set fldr = Nothing\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8642998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/456f8997b0327f4b89c0c1d4a8fdb07b?s=128&d=identicon&r=PG&f=1", "display_name": "S.MART", "link": "https://stackoverflow.com/users/8642998/s-mart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2028, "favorite_count": 0, "accepted_answer_id": 47561462, "answer_count": 2, "score": 0, "last_activity_date": 1511991933, "creation_date": 1511985901, "last_edit_date": 1511987122, "question_id": 47560878, "link": "https://stackoverflow.com/questions/47560878/how-to-convert-from-xlsm-to-xlsx-keeping-the-same-name", "title": "How to convert from xlsm to xlsx keeping the same name", "body": "<p>how can I change the format from <code>xlsm</code> to <code>xlsx</code>. I need a script that will save a copy of the <code>xlsm</code> file with  <code>xlsx</code> extension,  but doesn't ask user to input file name, it needs to keep the original name, the only thing the user needs to do is select where to save the file. </p>\n\n<pre><code>Sub changeext()\n\nDim s_as As String\n\ns_as = ThisWorkbook.FullName\n\ns_as = Left(s_as, InStrRev(s_as, \".\") - 1) &amp; \".xlsx\"\n\nThisWorkbook.SaveAs FileName:=s_as\n\nApplication.DisplayAlerts = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "copy", "range", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": true, "score": 1, "last_activity_date": 1511987396, "last_edit_date": 1511987396, "creation_date": 1511986723, "answer_id": 47561104, "question_id": 47560820, "link": "https://stackoverflow.com/questions/47560820/delete-within-a-range-without-deleting-on-sheet/47561104#47561104", "title": "Delete within a Range, without deleting on Sheet", "body": "<p>This procedure can help you to find empty columns.</p>\n\n<pre><code>Sub FindBlankColumns()\n'Step1:  Declare your variables.\n    Dim MyRange As Range\n    Dim iCounter As Long\n'Step 2:  Define the target Range. Change to fit your needs\n    Set MyRange = ActiveSheet.UsedRange\n\n'Step 3:  Start reverse looping through the range.\n'You can modify this according to your needs.\n    For iCounter = MyRange.Columns.Count To 1 Step -1\n\n'Step 4: If entire column is empty then do some stuff.\n       If Application.CountA(Columns(iCounter).EntireColumn) = 0 Then\n\n          ' Insert your code here to do what you want with empty column.\n\n       End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 787, "user_id": 4110765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4452a8699825258c201dba1594b278d9?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Armstrong", "link": "https://stackoverflow.com/users/4110765/jack-armstrong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 47561104, "answer_count": 1, "score": 0, "last_activity_date": 1511987396, "creation_date": 1511985659, "last_edit_date": 1531164843, "question_id": 47560820, "link": "https://stackoverflow.com/questions/47560820/delete-within-a-range-without-deleting-on-sheet", "title": "Delete within a Range, without deleting on Sheet", "body": "<p>I apologize for the poor question name, if anybody has better suggestions at the end of this, let me know. </p>\n\n<p>I have a range, say A1:M4 with the months in row 1 and a total for each row in column M. For each cell, there are values except for the months that have not yet happened. So if in November, everything up to November is filled in and December, column L, is empty and column M has the total from Jan to Nov (col A to col L). Another example, if in May, Jan, Feb, March, April and May and filled in, but not the other months, and column M has the total. </p>\n\n<p>I want to create code that copies all the values up to the current month including the total for each row and paste into a powerpoint (I know how to copy and paste into a ppt). How do I copy this?</p>\n\n<p>Current code:</p>\n\n<pre><code>rng=Range(\"a1\",Range(\"a1\").End(xldown).End(xlright))\n</code></pre>\n\n<p>Copies the entire range. How do I delete the columns without values in it. I thought of creating a count to count the values from column A to L, but having trouble incorporating how to remove the difference between total columns and filled in columns</p>\n"}, {"tags": ["vba", "excel", "conditional-formatting"], "comments": [{"owner": {"reputation": 2456, "user_id": 1754307, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/7170dd9a6ce7317ab73835c15ef1d9f7?s=128&d=identicon&r=PG", "display_name": "smackenzie", "link": "https://stackoverflow.com/users/1754307/smackenzie"}, "edited": false, "score": 0, "creation_date": 1511986117, "post_id": 47560807, "comment_id": 82079631, "body": "You could do this with conditional formatting alone, why do you wish to use VBA?"}, {"owner": {"reputation": 23, "user_id": 8895366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dd98fc29d8478ee3118a79404f6ec0c?s=128&d=identicon&r=PG&f=1", "display_name": "coffee123", "link": "https://stackoverflow.com/users/8895366/coffee123"}, "reply_to_user": {"reputation": 2456, "user_id": 1754307, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/7170dd9a6ce7317ab73835c15ef1d9f7?s=128&d=identicon&r=PG", "display_name": "smackenzie", "link": "https://stackoverflow.com/users/1754307/smackenzie"}, "edited": false, "score": 0, "creation_date": 1511986866, "post_id": 47560807, "comment_id": 82079981, "body": "I am not able to do it with CF either..."}], "answers": [{"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1511986879, "creation_date": 1511986879, "answer_id": 47561145, "question_id": 47560807, "link": "https://stackoverflow.com/questions/47560807/how-can-i-incorporate-multiple-conditions-in-highlighting-cells-of-a-column-in-v/47561145#47561145", "title": "How can I incorporate multiple conditions in highlighting cells of a column in VBA?", "body": "<p>I have tried and tested the following and it does as you ask:</p>\n\n<pre><code>Sub foo()\nDim val As Variant\nDim ColumnNumber As Long\nSet val = Sheet1.Rows(1).Find(\"FCCR\", lookat:=xlWhole)\nColumnNumber = val.Column\nLastRow = Sheet1.Cells(Sheet1.Rows.Count, ColumnNumber).End(xlUp).Row\nFor i = 1 To LastRow\n    If Sheet1.Cells(i, 12).Value = \"\" Then 'Change the number 12 to reflect the column which might be empty\n        If Sheet1.Cells(i, ColumnNumber).Value &lt; 1 Then\n            Sheet1.Cells(i, ColumnNumber).Interior.ColorIndex = 3 '3 is equals to red\n        End If\n    End If\n\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2456, "user_id": 1754307, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/7170dd9a6ce7317ab73835c15ef1d9f7?s=128&d=identicon&r=PG", "display_name": "smackenzie", "link": "https://stackoverflow.com/users/1754307/smackenzie"}, "is_accepted": false, "score": 0, "last_activity_date": 1511987204, "creation_date": 1511987204, "answer_id": 47561226, "question_id": 47560807, "link": "https://stackoverflow.com/questions/47560807/how-can-i-incorporate-multiple-conditions-in-highlighting-cells-of-a-column-in-v/47561226#47561226", "title": "How can I incorporate multiple conditions in highlighting cells of a column in VBA?", "body": "<p>You can use conditional formatting for this, using a formula?</p>\n\n<p><a href=\"https://i.stack.imgur.com/VZFfN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VZFfN.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 69, "user_id": 8372214, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hOFR1.png?s=128&g=1", "display_name": "EndUserAbuser", "link": "https://stackoverflow.com/users/8372214/enduserabuser"}, "edited": false, "score": 0, "creation_date": 1511987859, "post_id": 47561242, "comment_id": 82080442, "body": "I would clear all highlights in that row at the beginning of this subroutine ^^"}, {"owner": {"reputation": 23, "user_id": 8895366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dd98fc29d8478ee3118a79404f6ec0c?s=128&d=identicon&r=PG&f=1", "display_name": "coffee123", "link": "https://stackoverflow.com/users/8895366/coffee123"}, "edited": false, "score": 0, "creation_date": 1512152250, "post_id": 47561242, "comment_id": 82156768, "body": "Hey, How would you alter the Find part to Find the Column header given that instead of &quot;FCCR&quot; it was &quot;Fixed-Cash Coverage Ratio &quot;%&quot;&quot;"}, {"owner": {"reputation": 23, "user_id": 8895366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dd98fc29d8478ee3118a79404f6ec0c?s=128&d=identicon&r=PG&f=1", "display_name": "coffee123", "link": "https://stackoverflow.com/users/8895366/coffee123"}, "edited": false, "score": 0, "creation_date": 1512152297, "post_id": 47561242, "comment_id": 82156791, "body": "Is there a way to target just part of that header? something like Find(Left 5 characters ...&quot;Fixed&quot;) Or something like that?"}, {"owner": {"reputation": 69, "user_id": 8372214, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hOFR1.png?s=128&g=1", "display_name": "EndUserAbuser", "link": "https://stackoverflow.com/users/8372214/enduserabuser"}, "reply_to_user": {"reputation": 23, "user_id": 8895366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dd98fc29d8478ee3118a79404f6ec0c?s=128&d=identicon&r=PG&f=1", "display_name": "coffee123", "link": "https://stackoverflow.com/users/8895366/coffee123"}, "edited": false, "score": 0, "creation_date": 1512486213, "post_id": 47561242, "comment_id": 82271504, "body": "Set ratioHeader = ActiveSheet.Rows(1).Find(&quot;Fixed-Cash Coverage Ratio&quot;, lookat:=xlPart)"}], "tags": [], "owner": {"reputation": 69, "user_id": 8372214, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hOFR1.png?s=128&g=1", "display_name": "EndUserAbuser", "link": "https://stackoverflow.com/users/8372214/enduserabuser"}, "is_accepted": false, "score": 0, "last_activity_date": 1511987578, "last_edit_date": 1511987578, "creation_date": 1511987243, "answer_id": 47561242, "question_id": 47560807, "link": "https://stackoverflow.com/questions/47560807/how-can-i-incorporate-multiple-conditions-in-highlighting-cells-of-a-column-in-v/47561242#47561242", "title": "How can I incorporate multiple conditions in highlighting cells of a column in VBA?", "body": "<p>Try something like this? I put it into an Active-X control button but you could do it on worksheet_change if you wanted. Its a bit long winded compared to what you will probably find from other users</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim fccrHeader As Range\nDim col, otherCol, row As Integer\n\nSet fccrHeader = ActiveSheet.Rows(1).Find(\"FCCR\", lookat:=xlWhole)\ncol = fccrHeader.Column\notherCol = 7  ' comment column\n\nFor row = 2 To 10 'end of data constant or use search\n   If Cells(row, col).Value &lt; 1 And Cells(row, otherCol).Value = \"\" Then\n       'also highlights if both are empty, add that logic to check for \"\"\n\n       With Cells(row, col).Interior\n           .Pattern = xlSolid\n           .PatternColorIndex = xlAutomatic\n           .Color = 255\n           .TintAndShade = 0\n           .PatternTintAndShade = 0\n       End With\n    End If\nNext row\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8895366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dd98fc29d8478ee3118a79404f6ec0c?s=128&d=identicon&r=PG&f=1", "display_name": "coffee123", "link": "https://stackoverflow.com/users/8895366/coffee123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 47561145, "answer_count": 3, "score": 1, "last_activity_date": 1511987578, "creation_date": 1511985630, "question_id": 47560807, "link": "https://stackoverflow.com/questions/47560807/how-can-i-incorporate-multiple-conditions-in-highlighting-cells-of-a-column-in-v", "title": "How can I incorporate multiple conditions in highlighting cells of a column in VBA?", "body": "<p>I have a sheet with multiple columns of data in excel and I want to highlight in red the cells of one particular column named \"FCCR\" if the number is &lt; 1.0 and the contents of another column (meant to explain why something is &lt;1.0) are empty.</p>\n\n<p>I am thinking I locate the FCCR Column using some logic like: </p>\n\n<pre><code>Dim fccrHeader as Range\n\nSet fccrHeader = ActiveSheet.Rows(1).Find(\"FCCR\", lookat:=xlWhole)\n</code></pre>\n\n<p>Where I am stuck is in thinking about how to highlight the cell IF and only IF the FCCR value is less than 1.0 AND the comment column is empty. Do I have the right idea for looking up the FCCR column header? Thanks so much in advance.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9027572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/018353136d73a50724795c7d6b56a967?s=128&d=identicon&r=PG&f=1", "display_name": "user9027572", "link": "https://stackoverflow.com/users/9027572/user9027572"}, "edited": false, "score": 0, "creation_date": 1512059623, "post_id": 47561455, "comment_id": 82113487, "body": "Siddharth, this is great and did exactly what we wanted it to. To further modify."}, {"owner": {"reputation": 13, "user_id": 9027572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/018353136d73a50724795c7d6b56a967?s=128&d=identicon&r=PG&f=1", "display_name": "user9027572", "link": "https://stackoverflow.com/users/9027572/user9027572"}, "edited": false, "score": 0, "creation_date": 1512060224, "post_id": 47561455, "comment_id": 82113851, "body": "How would you suggest we further modify this to insert additional text boxes from cells in the same data range i.e. &quot;company name&quot; into the same chart, as well as, insert a picture from a cell value on the same row as the current chart data into a chart shape? We can get the shape created but the UserPicture (Range(&quot;F2&quot;)) wont work for some reason. We can only get it to work with a manually entered file path. Thanks again."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 13, "user_id": 9027572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/018353136d73a50724795c7d6b56a967?s=128&d=identicon&r=PG&f=1", "display_name": "user9027572", "link": "https://stackoverflow.com/users/9027572/user9027572"}, "edited": false, "score": 0, "creation_date": 1512060794, "post_id": 47561455, "comment_id": 82114185, "body": "Different question = Different Post :)"}, {"owner": {"reputation": 13, "user_id": 9027572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/018353136d73a50724795c7d6b56a967?s=128&d=identicon&r=PG&f=1", "display_name": "user9027572", "link": "https://stackoverflow.com/users/9027572/user9027572"}, "edited": false, "score": 0, "creation_date": 1512064062, "post_id": 47561455, "comment_id": 82116238, "body": "Ah, no worries. Will do."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1511988075, "creation_date": 1511988075, "answer_id": 47561455, "question_id": 47560417, "link": "https://stackoverflow.com/questions/47560417/need-vba-excel-chart-code-to-include-title-and-legend-label/47561455#47561455", "title": "Need VBA excel chart code to include Title and Legend label", "body": "<p>To add a <code>Title</code>, use <code>.HasTitle = True</code> and then set the text using <code>.ChartTitle.Text</code></p>\n\n<p>To add the legend use <code>.HasLegend = True</code>. But then this is not enough. You need to set the source data to inculde the header row so that the series names can be automatically captured by the code.</p>\n\n<p>Is this what you are trying?</p>\n\n<pre><code>Sub AutoCreateCharts()\n    Dim i As Long, LastRow As Long, LastColumn As Long\n    Dim chrt As Chart\n    Dim rng As Range\n\n    LastRow = Sheets(\"Sheet1\").Range(\"A3000\").End(xlUp).Row\n    LastColumn = Sheets(\"Sheet1\").Range(\"A1\").End(xlToRight).Column\n\n    For i = 2 To LastRow\n        Set chrt = Sheets(\"Sheet2\").Shapes.AddChart.Chart\n\n        chrt.ChartType = xlDoughnut\n        chrt.HasLegend = True '&lt;~~ Add the legend\n\n        With Sheets(\"Sheet1\")\n            '~~&gt; Include the First row in the source data\n            chrt.SetSourceData Source:=Union(.Range(.Cells(1, 2), .Cells(1, LastColumn)), _\n                                             .Range(.Cells(i, 2), .Cells(i, LastColumn)))\n\n            chrt.HasTitle = True '&lt;~~ Add the Chart Title\n            chrt.ChartTitle.Text = .Cells(i, 1).Value '&lt;~~ Set the text\n        End With\n\n        chrt.ChartArea.Left = 1\n        chrt.ChartArea.Top = (a - 2) * chrt.ChartArea.Height\n    Next\nEnd Sub\n</code></pre>\n\n<p><strong>Data</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/wvKjB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wvKjB.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Screenshot</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/qQ6rL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qQ6rL.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 9027572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/018353136d73a50724795c7d6b56a967?s=128&d=identicon&r=PG&f=1", "display_name": "user9027572", "link": "https://stackoverflow.com/users/9027572/user9027572"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1300, "favorite_count": 1, "accepted_answer_id": 47561455, "answer_count": 1, "score": 1, "last_activity_date": 1512037926, "creation_date": 1511984001, "last_edit_date": 1512037926, "question_id": 47560417, "link": "https://stackoverflow.com/questions/47560417/need-vba-excel-chart-code-to-include-title-and-legend-label", "title": "Need VBA excel chart code to include Title and Legend label", "body": "<p>The below code generates individual doughnut charts for all rows of data but we need it to include the first cell in each row as the title and the column headers for the corresponding Legend labels. We're not experienced in VBA and have tried to tweak it unsuccessfully. Our end users have Excel 2010 if that matters. I'm hoping this is an easy fix/edit. Anyone able to assist??</p>\n\n<p>Sample Data:</p>\n\n<p>Name----Data1----Data2----Data3</p>\n\n<p>John____23______32_____14</p>\n\n<p>Terry___456_____125_____104</p>\n\n<p>Mike____109______6______98</p>\n\n<p>Code:</p>\n\n<pre><code>Sub AutoCreateCharts()\n    Dim i As Long\n    Dim LastRow As Long\n    Dim LastColumn As Long\n    Dim chrt As Chart\n    LastRow = Sheets(\"Sheet1\").Range(\"A3000\").End(xlUp).Row\n    LastColumn = Sheets(\"Sheet1\").Range(\"A1\").End(xlToRight).Column\n\n    For a = 2 To LastRow\n        Sheets(\"Sheet2\").Select\n        Set chrt = Sheets(\"Sheet2\").Shapes.AddChart.Chart\n        chrt.ChartType = xlDoughnut\n        With Sheets(\"Sheet1\")\n            chrt.SetSourceData Source:=.Range(.Cells(a, 2), .Cells(a, LastColumn))\n        End With\n\n        chrt.ChartArea.Left = 1\n        chrt.ChartArea.Top = (a - 2) * chrt.ChartArea.Height\n    Next    \nEnd Sub \n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1511989701, "post_id": 47560267, "comment_id": 82081403, "body": "the example you gave above is a value assignment. it is not pasting."}, {"owner": {"reputation": 21, "user_id": 8729285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/156d4664a8af0bd2761f079fe9e810f4?s=128&d=identicon&r=PG&f=1", "display_name": "alphatrader", "link": "https://stackoverflow.com/users/8729285/alphatrader"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1511990704, "post_id": 47560267, "comment_id": 82081910, "body": "Yeah, that&#39;s what I meant. My b"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1511993265, "post_id": 47560267, "comment_id": 82083138, "body": "Suppose the last array row in your example should be indexed <code>myArray(1, 1) = 12345</code>. (Note: I added a third array row in my answer just to point out the proceding to extract a column from a 3x2 instead of 2x2 array; so you have to write to A1:A3 instead of A1:A2)"}], "answers": [{"tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1511987219, "creation_date": 1511987219, "answer_id": 47561236, "question_id": 47560267, "link": "https://stackoverflow.com/questions/47560267/how-do-i-paste-one-part-of-a-2d-array-in-vba/47561236#47561236", "title": "How do I paste one part of a 2D Array in VBA?", "body": "<p><strong>Method</strong></p>\n\n<p>You can use <code>Application.Index</code> to get the column values out of your array and write them back to range. </p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Sub testArCol2Row()\nDim myArray(0 To 2, 0 To 1)\nDim ws   As Worksheet\nSet ws = ThisWorkbook.Worksheets(\"MySheet\")\nDim j As Long           ' Column number -- ONE BASED !!\nj = 2                   ' &lt;&lt;&lt;    change column number here\n' example data\n  myArray(0, 0) = 69\n  myArray(1, 0) = 70\n  myArray(2, 0) = 71\n  myArray(0, 1) = 1234\n  myArray(1, 1) = 12345\n  myArray(2, 1) = 123456\n' a) write both columns to range (just to compare values)\n  ws.Range(\"E1:F3\") = myArray\n' get 2nd column into Array\n  v = Application.Index(myArray, , j)\n' b) write ONLY 2nd column (j=2) to range (column number -- ONE based if using index function)\n  ws.Range(\"A1:A3\") = v\nEnd Sub\n</code></pre>\n\n<p><strong>Hint</strong></p>\n\n<p>You can change the row - column order using <code>Application.Transpose</code></p>\n"}], "owner": {"reputation": 21, "user_id": 8729285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/156d4664a8af0bd2761f079fe9e810f4?s=128&d=identicon&r=PG&f=1", "display_name": "alphatrader", "link": "https://stackoverflow.com/users/8729285/alphatrader"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 891, "favorite_count": 0, "accepted_answer_id": 47561236, "answer_count": 1, "score": 1, "last_activity_date": 1511987219, "creation_date": 1511983419, "last_edit_date": 1531164843, "question_id": 47560267, "link": "https://stackoverflow.com/questions/47560267/how-do-i-paste-one-part-of-a-2d-array-in-vba", "title": "How do I paste one part of a 2D Array in VBA?", "body": "<p>If I have an 2D array as such:</p>\n\n<pre><code>        myArray(0, 0) = 69\n        myArray(1, 0) = 69\n        myArray(0, 1) = 1234\n        myArray(0, 1) = 12345\n</code></pre>\n\n<p>Is there a way to paste only myArray( , 1) into Range(\"A1:A2\") without using loops? I know you can paste like </p>\n\n<blockquote>\n  <p>Range(\"A1:B2\") = myArray</p>\n</blockquote>\n\n<p>super easily.</p>\n\n<p>I'll be having over 170,000 array columns so I prefer not using loops as it would take me over 35 minutes each time\nI prefer keeping the dimensions and not changing the 2D array into two 1D arrays and pasting like that.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1511988719, "post_id": 47560264, "comment_id": 82080890, "body": "what does <code>required changes</code> even mean? .... you said nothing about what the code does when you run it  ....  you said nothing about any errors .... <code>i have a car, can you make the required changes to it?</code> ... see? ...  a pretty useless question."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1511988740, "post_id": 47560264, "comment_id": 82080900, "body": "single-step your code using the F8 key and watch the &quot;selection&quot; on the worksheet. you will see the problem"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9027547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8df08047b7e612396abbe7833aa30d05?s=128&d=identicon&r=PG&f=1", "display_name": "SNEHA", "link": "https://stackoverflow.com/users/9027547/sneha"}, "edited": false, "score": 0, "creation_date": 1512066370, "post_id": 47560781, "comment_id": 82117656, "body": "Wonderful..thanks for the code.However I wonder for what the below  commands used as just using &quot;.ThemeColor = xlThemeColorLight1&quot; is giving the required results. .Pattern = xlSolid                 .PatternColorIndex = xlAutomatic  .TintAndShade = 0                 .PatternTintAndShade = 0"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 13, "user_id": 9027547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8df08047b7e612396abbe7833aa30d05?s=128&d=identicon&r=PG&f=1", "display_name": "SNEHA", "link": "https://stackoverflow.com/users/9027547/sneha"}, "edited": false, "score": 0, "creation_date": 1512066574, "post_id": 47560781, "comment_id": 82117770, "body": "@SNEHA I just copied those statements from your original code - why did <b>you</b> have them there??"}, {"owner": {"reputation": 13, "user_id": 9027547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8df08047b7e612396abbe7833aa30d05?s=128&d=identicon&r=PG&f=1", "display_name": "SNEHA", "link": "https://stackoverflow.com/users/9027547/sneha"}, "edited": false, "score": 0, "creation_date": 1512217664, "post_id": 47560781, "comment_id": 82174115, "body": "sorry but I recorded a macros to make a chess board and used these statements from there, I still could not understand their utility. Still learning..."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 13, "user_id": 9027547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8df08047b7e612396abbe7833aa30d05?s=128&d=identicon&r=PG&f=1", "display_name": "SNEHA", "link": "https://stackoverflow.com/users/9027547/sneha"}, "edited": false, "score": 0, "creation_date": 1512234262, "post_id": 47560781, "comment_id": 82179039, "body": "@SNEHA There are <b>lots</b> of different options that can be used when formatting cells - colour, pattern colour, pattern style, etc.  The macro recorder would have used the options necessary to give you what you asked for but if, for example, you know that your cell already is set to have a solid pattern, you won&#39;t need to set that option again and can leave it out of your code."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 2, "last_activity_date": 1511985519, "creation_date": 1511985519, "answer_id": 47560781, "question_id": 47560264, "link": "https://stackoverflow.com/questions/47560264/excel-vba-making-a-chess-board/47560781#47560781", "title": "Excel VBA - Making a chess board", "body": "<p>I can never remember which corner has the dark colour and which has the light colour on a chess board but, if the following code does it back to front, just change <code>If (I + J) Mod 2 = 0 Then</code> to <code>If (I + J) Mod 2 &lt;&gt; 0 Then</code>:</p>\n\n<pre><code>Sub COLOR()\n\n    Dim origin As Range\n    Set origin = ActiveCell\n\n    Dim I As Long\n    Dim J As Long\n\n    For I = 0 To 9\n        For J = 0 To 9\n            With origin.Offset(I, J).Interior\n                .Pattern = xlSolid\n                .PatternColorIndex = xlAutomatic\n\n                If (I + J) Mod 2 = 0 Then\n                    .ThemeColor = xlThemeColorLight1\n                Else\n                    .ThemeColor = xlThemeColorDark1\n                End If\n\n                .TintAndShade = 0\n                .PatternTintAndShade = 0\n            End With\n        Next J\n    Next I\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9027547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8df08047b7e612396abbe7833aa30d05?s=128&d=identicon&r=PG&f=1", "display_name": "SNEHA", "link": "https://stackoverflow.com/users/9027547/sneha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2763, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1599817741, "creation_date": 1511983402, "last_edit_date": 1531164843, "question_id": 47560264, "link": "https://stackoverflow.com/questions/47560264/excel-vba-making-a-chess-board", "title": "Excel VBA - Making a chess board", "body": "<p>I am trying to make a 10*10 chess board in excel starting from whichever cell I am on, using black and white color. Have tried the following code but need further help. Can some one please help me to run it with required changes.  </p>\n\n<pre><code>Sub COLOR()\n\nDim I As Long\nDim J As Long\n\nFor I = 1 To 10\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorLight1\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n\n    For J = 1 To 10\n        ActiveCell.Offset(1, 0).Range(\"A1\").Select\n        With Selection.Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .ThemeColor = xlThemeColorDark1\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n    Next J\nNext I\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 8067912, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1825007607526211/picture?type=large", "display_name": "Hadrien Berthier", "link": "https://stackoverflow.com/users/8067912/hadrien-berthier"}, "edited": false, "score": 0, "creation_date": 1511984231, "post_id": 47560232, "comment_id": 82078655, "body": "When I print this number it print 16331 for 1 selected row on excel. I think this represent the number of cells in my row when I select 2 rows it print 32662."}, {"owner": {"reputation": 2207, "user_id": 8357864, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4fe690b4dfe322a7c5b9d8ba23b3bd05?s=128&d=identicon&r=PG&f=1", "display_name": "LetEpsilonBeLessThanZero", "link": "https://stackoverflow.com/users/8357864/letepsilonbelessthanzero"}, "reply_to_user": {"reputation": 175, "user_id": 8067912, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1825007607526211/picture?type=large", "display_name": "Hadrien Berthier", "link": "https://stackoverflow.com/users/8067912/hadrien-berthier"}, "edited": false, "score": 0, "creation_date": 1512413560, "post_id": 47560232, "comment_id": 82238402, "body": "Oh, I see now what you&#39;re trying to do. I&#39;ve edited my comment to make this work how you want."}], "tags": [], "owner": {"reputation": 2207, "user_id": 8357864, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4fe690b4dfe322a7c5b9d8ba23b3bd05?s=128&d=identicon&r=PG&f=1", "display_name": "LetEpsilonBeLessThanZero", "link": "https://stackoverflow.com/users/8357864/letepsilonbelessthanzero"}, "is_accepted": false, "score": 1, "last_activity_date": 1512423259, "last_edit_date": 1512423259, "creation_date": 1511983288, "answer_id": 47560232, "question_id": 47560086, "link": "https://stackoverflow.com/questions/47560086/count-selected-rows-after-auto-filter/47560232#47560232", "title": "Count selected rows after auto filter", "body": "<p>Well, the following would work <strong>if</strong> your selection was contiguous:</p>\n\n<pre><code>Selection.Columns(1).SpecialCells(xlCellTypeVisible).Count\n</code></pre>\n\n<p>However, from your screenshot I can see that your selections may be non-contiguous ranges (aka multiple areas selected), so you can use this function I created as a starting point:</p>\n\n<pre><code>Function countVisibleSelectedRows()\n    Dim count As Integer\n    count = 0\n    For Each Area In Selection.Areas\n        count = count + Area.Columns(1).SpecialCells(xlCellTypeVisible).count\n    Next\n    countVisibleSelectedRows = count\nEnd Function\n</code></pre>\n\n<p>When you have multiple ranges selected, Excel calls each of those ranges an \"area\". In this function, we loop over each \"area\" in the Selection.Areas collection.</p>\n"}, {"comments": [{"owner": {"reputation": 175, "user_id": 8067912, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1825007607526211/picture?type=large", "display_name": "Hadrien Berthier", "link": "https://stackoverflow.com/users/8067912/hadrien-berthier"}, "edited": false, "score": 0, "creation_date": 1511986582, "post_id": 47560721, "comment_id": 82079854, "body": "Thanks for the answer, Yeah I wasn&#39;t clear on how I use it. the thing is that I have a button to filter my table and then I want to select some rows and click on one button to copy those rows to another sheet with some specific column only and modifying them a bit I don&#39;t want to filter and count the selected rows in the same vba macro. I will add more description to my post"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1511985289, "creation_date": 1511985289, "answer_id": 47560721, "question_id": 47560086, "link": "https://stackoverflow.com/questions/47560086/count-selected-rows-after-auto-filter/47560721#47560721", "title": "Count selected rows after auto filter", "body": "<p>It depends on how you are using it. This works just fine for me</p>\n\n<pre><code>'~~&gt; Remove any filters\nActiveSheet.AutoFilterMode = False\n\n'~~&gt; Specifying the complete address is the key part\nWith Range(\"A1:C6\") '&lt;~~ Filter, offset(to exclude headers)\n    .AutoFilter Field:=YOURFIELDNUMBER, Criteria1:=YOURCRITERIA\n    Debug.Print .Offset(1, 0).SpecialCells(xlCellTypeVisible).Rows.Count\nEnd With\n\n'~~&gt; Remove any filters\nActiveSheet.AutoFilterMode = False\n</code></pre>\n\n<p><strong>Test</strong></p>\n\n<pre><code>Sub Sample()\n    '~~&gt; Remove any filters\n    ActiveSheet.AutoFilterMode = False\n\n    With Range(\"A1:C6\") '&lt;~~ Filter, offset(to exclude headers)\n        .AutoFilter Field:=1, Criteria1:=\"Sid\"\n        MsgBox .Offset(1, 0).SpecialCells(xlCellTypeVisible).Rows.Count\n    End With\n\n    '~~&gt; Remove any filters\n    ActiveSheet.AutoFilterMode = False\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/aaq7T.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aaq7T.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 251, "user_id": 6451218, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a0578b1c77c327c900a26f0f02328fc?s=128&d=identicon&r=PG&f=1", "display_name": "XLmatters", "link": "https://stackoverflow.com/users/6451218/xlmatters"}, "is_accepted": false, "score": 1, "last_activity_date": 1589382952, "creation_date": 1589382952, "answer_id": 61778303, "question_id": 47560086, "link": "https://stackoverflow.com/questions/47560086/count-selected-rows-after-auto-filter/61778303#61778303", "title": "Count selected rows after auto filter", "body": "<p>I know this is a late post to this question, but maybe this will help someone in the future.  I find the following code snippet works well to count the number of visible rows in a range after being filtered.</p>\n\n<pre><code>Sub CountVisibleRows()\n'only count the visible rows in the range\n\nDim lRow As Long, vis_lr As Long, DstWs As Worksheet\n\nSet DstWs = ActiveSheet\n\nlRow = DstWs.UsedRange.Rows.Count\n'vis_lr = DstWs.Range(\"B2:B\" &amp; lRow).SpecialCells(xlCellTypeVisible).Count   'doesn't seem to work with non-contiguous rows\n\nWith DstWs\nvis_lr = Application.WorksheetFunction.Subtotal(3, Range(\"B2:B\" &amp; lRow))\nEnd With\n\nDebug.Print vis_lr\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 8067912, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1825007607526211/picture?type=large", "display_name": "Hadrien Berthier", "link": "https://stackoverflow.com/users/8067912/hadrien-berthier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10313, "favorite_count": 0, "accepted_answer_id": 47560721, "answer_count": 3, "score": 0, "last_activity_date": 1594624330, "creation_date": 1511982692, "last_edit_date": 1594624330, "question_id": 47560086, "link": "https://stackoverflow.com/questions/47560086/count-selected-rows-after-auto-filter", "title": "Count selected rows after auto filter", "body": "<p>When my data are raw and unfiltered I can select them and <code>Selection.Rows.Count</code> returns the valid number.</p>\n<p>After the AutoFilter it returns a number as if I selected the rows that were not visible, even though <code>Selection.Copy</code> does not copy other than selected rows.</p>\n<p>How do I get the valid count of selected rows?</p>\n<p>I tried <code>Selection.SpecialCells(xlCellTypeVisible).Rows.Count</code>.</p>\n<p><strong>EDIT</strong></p>\n<p>I use filter in another macro and then select by hand rows I want to add to another sheet.</p>\n<p>I did two buttons, one to filter my table and the second to move selected rows to another sheet.</p>\n<pre><code>Sub ajout_commande()\nSet DataSheet = ThisWorkbook.Worksheets(&quot;Prepa Commandes&quot;)\nDim a As Range, b As Range\nSet a = Selection\ni = 0\ns = Selection.SpecialCells(xlCellTypeVisible).Count\nFor Each b In a.Rows\n    i = i + 1\n    DataSheet.Cells(6, 1).EntireRow.Insert\n    DataSheet.Range(&quot;A1:Z1&quot;).Copy DataSheet.Cells(6, 1).EntireRow\nNext\n\nDim r1 As Range, r2 As Range, r3 As Range\nLet copyrange1 = &quot;E1&quot; &amp; &quot;:&quot; &amp; &quot;I&quot; &amp; i\nLet copyrange2 = &quot;BK1&quot; &amp; &quot;:&quot; &amp; &quot;BM&quot; &amp; i\nSet r1 = a.Range(copyrange1)\nSet r2 = a.Range(copyrange2)\nSet r3 = Union(r1, r2)\n\nr3.Copy\nDataSheet.Cells(6, 1).PasteSpecial xlPasteValues\nMsgBox s &amp; &quot; and &quot; &amp; i\n\nEnd Sub\n</code></pre>\n<p>Here my table is filtered and I want to add selected rows to another sheet but the Selection.Rows.Count returns more rows than I selected because it counts the non visible rows, even though <code>Selection.copy</code> works.<br />\n<a href=\"https://i.stack.imgur.com/T2pht.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/T2pht.png\" alt=\"enter image description here\" /></a></p>\n<p>For this example Selection.Rows.Count = 28 because of non visible rows between rows 10 and 20, 21 and 25 etc.</p>\n<p>Is there a function to get the number I want (on this image 16)?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 4630, "user_id": 8039298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2363b72429d221115bec666a43fa402c?s=128&d=identicon&r=PG&f=1", "display_name": "Barns", "link": "https://stackoverflow.com/users/8039298/barns"}, "edited": false, "score": 1, "creation_date": 1511982465, "post_id": 47559952, "comment_id": 82077692, "body": "Why even make it a combobox if the user shouldn&#39;t access it or be able to change the value. Just use a TextBox and present the value you want displayed?"}, {"owner": {"reputation": 653, "user_id": 7254514, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/713bdcd9918ad0f7168a58281fe85046?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Guarro", "link": "https://stackoverflow.com/users/7254514/luca-guarro"}, "reply_to_user": {"reputation": 4630, "user_id": 8039298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2363b72429d221115bec666a43fa402c?s=128&d=identicon&r=PG&f=1", "display_name": "Barns", "link": "https://stackoverflow.com/users/8039298/barns"}, "edited": false, "score": 0, "creation_date": 1511982555, "post_id": 47559952, "comment_id": 82077731, "body": "Well there are a variety of options the user can select. There is just this one that it cannot that the program has to detect. If this option were to be set, then it will be locked and can only be unset programatically."}, {"owner": {"reputation": 653, "user_id": 7254514, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/713bdcd9918ad0f7168a58281fe85046?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Guarro", "link": "https://stackoverflow.com/users/7254514/luca-guarro"}, "reply_to_user": {"reputation": 4630, "user_id": 8039298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2363b72429d221115bec666a43fa402c?s=128&d=identicon&r=PG&f=1", "display_name": "Barns", "link": "https://stackoverflow.com/users/8039298/barns"}, "edited": false, "score": 0, "creation_date": 1511982829, "post_id": 47559952, "comment_id": 82077852, "body": "I suppose I could add the item, select it immediately, then lock it. When it needs to be unset I can unlock it, set the value to the default, and remove the item from the combobox."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511983361, "post_id": 47559952, "comment_id": 82078160, "body": "If you know that the program has to use a certain value, just ignore whatever value is in the combobox and use the value you need to use instead."}, {"owner": {"reputation": 653, "user_id": 7254514, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/713bdcd9918ad0f7168a58281fe85046?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Guarro", "link": "https://stackoverflow.com/users/7254514/luca-guarro"}, "edited": false, "score": 0, "creation_date": 1511983586, "post_id": 47559952, "comment_id": 82078284, "body": "I do not want this one particular option to be visible from the drop down menu. It should just be automatically selected based on certain criteria of the form but in no way should the user be able to select it himself."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 1, "creation_date": 1511983691, "post_id": 47559952, "comment_id": 82078340, "body": "why should it be in the combo box then?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511983793, "post_id": 47559952, "comment_id": 82078406, "body": "It sounds like you just want an <code>If</code> statement in your code - i.e. <code>If need_to_use_specific_value Then use_value = specific_value Else use_value = combobox.Value</code> (or something like that)"}, {"owner": {"reputation": 653, "user_id": 7254514, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/713bdcd9918ad0f7168a58281fe85046?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Guarro", "link": "https://stackoverflow.com/users/7254514/luca-guarro"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1511984091, "post_id": 47559952, "comment_id": 82078582, "body": "@jsotola It needs to be in the combo box because it is related to all the other items in the combo box. When this particular value is set, I want it to be &quot;illegal&quot; to try and select another value for the combobox."}, {"owner": {"reputation": 653, "user_id": 7254514, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/713bdcd9918ad0f7168a58281fe85046?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Guarro", "link": "https://stackoverflow.com/users/7254514/luca-guarro"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511984211, "post_id": 47559952, "comment_id": 82078645, "body": "@YowE3K Can I give a value that does not exist inside of the combobox? How would I make it a two column value?"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1511984335, "post_id": 47559952, "comment_id": 82078715, "body": "does that mean that the combo box is disabled completely when the value is set?"}, {"owner": {"reputation": 653, "user_id": 7254514, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/713bdcd9918ad0f7168a58281fe85046?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Guarro", "link": "https://stackoverflow.com/users/7254514/luca-guarro"}, "edited": false, "score": 0, "creation_date": 1511984409, "post_id": 47559952, "comment_id": 82078753, "body": "Yeah the value is locked in"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511984633, "post_id": 47559952, "comment_id": 82078857, "body": "It would really help if you showed the code you are using that is making use of the combobox&#39;s value."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1511984634, "post_id": 47559952, "comment_id": 82078858, "body": "set the combobox <code>enabled</code> property to false to disable the combobox"}], "answers": [{"tags": [], "owner": {"reputation": 726, "user_id": 8786602, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VvBoB.jpg?s=128&g=1", "display_name": "Wellspring", "link": "https://stackoverflow.com/users/8786602/wellspring"}, "is_accepted": false, "score": 0, "last_activity_date": 1511995973, "last_edit_date": 1511995973, "creation_date": 1511984770, "answer_id": 47560612, "question_id": 47559952, "link": "https://stackoverflow.com/questions/47559952/combo-box-with-option-that-can-only-be-selected-programatically-and-not-by-the-u/47560612#47560612", "title": "Combo Box with option that can only be selected programatically and not by the user in VBA Access", "body": "<p>This situation seems very strange, and I would never want it in my app... but accepting for the moment that the approach desired is correct and good, and a solution is needed...</p>\n\n<p>You can bind to the data source table field (since you're in MS Access I assume bound forms, though that's not guaranteed) via a hidden control (textbox, I'll assume) that we'll call txtYouNoSeeMe.</p>\n\n<p>Let's refer to the value you want to let the system select (but not the user) as NoPickMe. </p>\n\n<p>Now you need to give your user the ability to select \"most options\" -- set up that combobox (cboYesYouSeeMe) as necessary and leave it unbound. NoPickMe is not an option on that list.</p>\n\n<p>Finally, you will sadly have to wrap some logic into handling AfterUpdate events for cboYesYouSeeMe. When you wish to permit the user to select an option in cboYesYouSeeMe, you need to then transport the value selected over to your HIDDEN bound control txtYouNoSeeMe. Do that in the AfterUpdate event.</p>\n\n<p>When you wish to have the system pick that \"hidden\" value NoPickMe (that the user should not see) so be it... place that value into the hidden txtYouNoSeeMe. I have no idea what you're going want to display (in such cases) in cboYesYouSeeMe.</p>\n\n<p>When the record saves, txtYouNoSeeMe drives the value saved to the database. If no database is involved, then just ignore my references to data binding.</p>\n\n<p>This solution works, though I may have forgotten to explain a detail or two. Hopefully you get the idea.</p>\n"}, {"tags": [], "owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "is_accepted": false, "score": 1, "last_activity_date": 1512043749, "creation_date": 1512043749, "answer_id": 47573167, "question_id": 47559952, "link": "https://stackoverflow.com/questions/47559952/combo-box-with-option-that-can-only-be-selected-programatically-and-not-by-the-u/47573167#47573167", "title": "Combo Box with option that can only be selected programatically and not by the user in VBA Access", "body": "<p>You could add an \"on change\" event to the combo box. Lets say the option which can only be chosen programmatically is \"Program only item\". I have also assumed that you have a previous field in the form which we can move the focus back to. You haven't mentioned what the criteria for this option is so for arguments sake I will presume that the previous field has to be 1 not 0 (you will have to alter the if...then clause to suit your criteria).</p>\n\n<pre><code>private sub cbo_list_change()\n\nif me.cbo_list.value \"Program  only item\" then\n  if me.chk_previous.value = 0 then \n    msgbox \"This item cannot be selected. Please select an alternative item\", vbOKOnly\n    me.cbo_list.value =\"\"\n    chk_previous.setFocus\n  end if\nend if\n\nEnd sub\n</code></pre>\n\n<p>You will be able to use <code>me.cbo_list.value=\"program only option\"</code> in a different event when the criteria is met. </p>\n"}, {"tags": [], "owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "is_accepted": true, "score": 1, "last_activity_date": 1512048899, "creation_date": 1512048899, "answer_id": 47574766, "question_id": 47559952, "link": "https://stackoverflow.com/questions/47559952/combo-box-with-option-that-can-only-be-selected-programatically-and-not-by-the-u/47574766#47574766", "title": "Combo Box with option that can only be selected programatically and not by the user in VBA Access", "body": "<p>You should try to move business logic out of your forms. You need two functions for this task.</p>\n\n<pre><code>Function SelectAndLock(ByRef SelectPicker As ComboBox, Id As Long)\n\n    Dim SQL_GET As String\n    SQL_GET = \"SELECT ID, Text From ComboBoxValues WHERE [ID] = \" &amp; Id\n\n    SelectPicker.RowSourceType = \"Table/Query\"\n    SelectPicker.RowSource = SQL_GET\n    SelectPicker.Value = Id\n    SelectPicker.enabled = False\n\nEnd Function\n\nFunction PopulateSelectPicker(ByRef SelectPicker As ComboBox)\n\n    Dim SQL_GET As String\n    SQL_GET = \"SELECT ID, Text From ComboBoxValues WHERE [ID] not in (your system ids);\"\n\n    SelectPicker.RowSourceType = \"Table/Query\"\n    SelectPicker.RowSource = SQL_GET\n    SelectPicker.Value = \"\" ' or null if your field is nullable\n    SelectPicker.enabled = True\n\nEnd Function\n</code></pre>\n\n<p>Now if your model has dedected the \"system\" condition, you would call</p>\n\n<pre><code>call SelectAndLock(SelectPicker,id)\n</code></pre>\n\n<p>Which would select the id that the system choses and locks the combobox.</p>\n\n<p>any other condition or by default, simply call </p>\n\n<pre><code>call PopulateSelectPicker(SelectPicker)\n</code></pre>\n\n<p>Which would list all options except the system ids user shouldn't see.</p>\n\n<p><strong>This is just a concept. Adapt it as you require.</strong></p>\n"}], "owner": {"reputation": 653, "user_id": 7254514, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/713bdcd9918ad0f7168a58281fe85046?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Guarro", "link": "https://stackoverflow.com/users/7254514/luca-guarro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 47574766, "answer_count": 3, "score": 0, "last_activity_date": 1512048899, "creation_date": 1511982179, "question_id": 47559952, "link": "https://stackoverflow.com/questions/47559952/combo-box-with-option-that-can-only-be-selected-programatically-and-not-by-the-u", "title": "Combo Box with option that can only be selected programatically and not by the user in VBA Access", "body": "<p>I have a combobox that has a special requirement. It needs to have an item that can only be selected by the program (based on certain criteria detected) and cannot be selected by the user itself. Is there any way to do this in VBA Access? </p>\n\n<p>I found  <a href=\"https://stackoverflow.com/questions/19402747/disable-or-hide-options-in-combo-box-vba-excel\">this solution</a> but it is somewhat of a workaround which I will do if there is not a better alternative. What I want is for the option to not even be visible.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511980955, "post_id": 47559316, "comment_id": 82076917, "body": "Please read the tag&#39;s descriptions before using them - [macros] says &quot;<i>DO NOT USE for VBA / MS-Office languages. Use the respective [vba] tags instead.</i> and [word] says &quot;<i>Important: This is NOT about Microsoft Word or text editing</i>&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "is_accepted": false, "score": 1, "last_activity_date": 1512026086, "creation_date": 1512026086, "answer_id": 47567836, "question_id": 47559316, "link": "https://stackoverflow.com/questions/47559316/macro-to-insert-a-cross-reference-based-on-selection/47567836#47567836", "title": "Macro to insert a cross reference based on selection", "body": "<p>Yes it is totally possible... </p>\n\n<p>But as this is not a code writing service I'll give you (an example of) the key elements:</p>\n\n<pre><code>' Check if a reference exists\nIf instr(lcase(selection.Sentences(1).Text), \"refer to clause\") then\n\n' Figure out the reference number...\n(see here: https://stackoverflow.com/questions/15369485/how-to-extract-groups-of-numbers-from-a-string-in-vba)\n\n' Get a list of available references\nrefList = ActiveDocument.GetCrossReferenceItems(wdRefTypeNumberedItem)\n\n' Add the reference\nselection.InsertCrossReference(wdRefTypeNumberedItem ,wdNumberFullContext, xxxxxx...\n</code></pre>\n\n<p>Perhaps see how far you can get and post back with more specific and focused questions :)</p>\n"}, {"comments": [{"owner": {"reputation": 31619, "user_id": 20479, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/61396c69040bbc56dbad1c5c71ac27d2?s=128&d=identicon&r=PG", "display_name": "Rhubarb", "link": "https://stackoverflow.com/users/20479/rhubarb"}, "edited": false, "score": 0, "creation_date": 1592852518, "post_id": 47571177, "comment_id": 110568122, "body": "fantastic thankyou! One note: probably makes no diff, but I changed ReferenceType to wdRefTypeHeading in the first line of InsertCrossReference to match the change in GetCrossReferenceItems"}, {"owner": {"reputation": 178, "user_id": 2571786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78b6f57c01e5c217aebf32bf03948161?s=128&d=identicon&r=PG", "display_name": "GMCB", "link": "https://stackoverflow.com/users/2571786/gmcb"}, "edited": false, "score": 0, "creation_date": 1596958623, "post_id": 47571177, "comment_id": 111973635, "body": "@variatus, This is a great and useful answer. Any tips on what could be changed to match Table/Figures type cross-referenced? Ideally, I could get: &quot;Only label and Number&quot; as well as &quot;Entire caption&quot;."}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": true, "score": 6, "last_activity_date": 1512037749, "creation_date": 1512037749, "answer_id": 47571177, "question_id": 47559316, "link": "https://stackoverflow.com/questions/47559316/macro-to-insert-a-cross-reference-based-on-selection/47571177#47571177", "title": "Macro to insert a cross reference based on selection", "body": "<p>This code will - conditionally - do what you want.</p>\n\n<pre><code>Sub InsertCrossRef()\n\n    Dim RefList As Variant\n    Dim LookUp As String\n    Dim Ref As String\n    Dim s As Integer, t As Integer\n    Dim i As Integer\n\n    On Error GoTo ErrExit\n    With Selection.Range\n        ' discard leading blank spaces\n        Do While (Asc(.Text) = 32) And (.End &gt; .Start)\n            .MoveStart wdCharacter\n        Loop\n        ' discard trailing blank spaces, full stops and CRs\n        Do While ((Asc(Right(.Text, 1)) = 46) Or _\n                  (Asc(Right(.Text, 1)) = 32) Or _\n                  (Asc(Right(.Text, 1)) = 11) Or _\n                  (Asc(Right(.Text, 1)) = 13)) And _\n                  (.End &gt; .Start)\n            .MoveEnd wdCharacter, -1\n        Loop\n\nErrExit:\n        If Len(.Text) = 0 Then\n            MsgBox \"Please select a reference.\", _\n                   vbExclamation, \"Invalid selection\"\n            Exit Sub\n        End If\n\n        LookUp = .Text\n    End With\n    On Error GoTo 0\n\n    With ActiveDocument\n        ' Use WdRefTypeHeading to retrieve Headings\n        RefList = .GetCrossReferenceItems(wdRefTypeNumberedItem)\n        For i = UBound(RefList) To 1 Step -1\n            Ref = Trim(RefList(i))\n            If InStr(1, Ref, LookUp, vbTextCompare) = 1 Then\n                s = InStr(2, Ref, \" \")\n                t = InStr(2, Ref, Chr(9))\n                If (s = 0) Or (t = 0) Then\n                    s = IIf(s &gt; 0, s, t)\n                Else\n                    s = IIf(s &lt; t, s, t)\n                End If\n                If LookUp = Left(Ref, s - 1) Then Exit For\n            End If\n        Next i\n\n        If i Then\n            Selection.InsertCrossReference ReferenceType:=\"Numbered item\", _\n                                           ReferenceKind:=wdNumberFullContext, _\n                                           ReferenceItem:=CStr(i), _\n                                           InsertAsHyperlink:=True, _\n                                           IncludePosition:=False, _\n                                           SeparateNumbers:=False, _\n                                           SeparatorString:=\" \"\n        Else\n            MsgBox \"A cross reference to \"\"\" &amp; LookUp &amp; \"\"\" couldn't be set\" &amp; vbCr &amp; _\n                   \"because a paragraph with that number couldn't\" &amp; vbCr &amp; _\n                   \"be found in the document.\", _\n                   vbInformation, \"Invalid cross reference\"\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>Here are the conditions:-</p>\n\n<ol>\n<li>There are \"Numbered Items\" and \"Headings\" in a document. You asked for Headings. I did Numbered Items because I don't have that style on my PC. However, on my PC \"Headings\" <em>are</em> numbered items. If the code doesn't work on your documents, exchange <code>wdRefTypeNumberedItem</code> for <code>wdRefTypeHeading</code> at the marked line in the code.</li>\n<li>I presumed a numbering format like \"1\" \"1.1\", \"1.1.1\". If you have anything different, perhaps \"1.\" \"1.1.\", \"1.1.1.\", the code will need to be tweaked. The key points are that the code will look for either a space or a tab following the number. If it is followed by a period or closing bracket or a dash it won't work. Also, if you happen to select \"1.2.\" (with the final full stop) in the text the code will ignore the full stop and look for a reference \"1.2\". Note that the code is insensitive to casual mistakes in the selection. It will remove any leading or trailing spaces as well as accidentally included carriage returns or paragraph marks - and full stops.</li>\n</ol>\n\n<p>The code will replace the selection you make with its own (identical) text. This may cause existing formatting to change. In fact the inserted Reference Field takes the text from the target. I didn't quite figure out which format it applies, the target's or the one being replaced. I didn't deal with this problem, if it is one. </p>\n\n<p>Please take a look at the properties of the cross reference the code inserts. You will see that <code>InsertAsHyperlink</code> is True. You can set it to False, if you prefer. <code>IncludePosition</code> is False. If you set this property to True you would see \"above\" or \"below\" added to the number the code replaces.</p>\n"}], "owner": {"reputation": 23, "user_id": 9027322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1749b8fcbb28fe70a0512ce7a27e984?s=128&d=identicon&r=PG&f=1", "display_name": "J. Hick", "link": "https://stackoverflow.com/users/9027322/j-hick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2678, "favorite_count": 1, "accepted_answer_id": 47571177, "answer_count": 2, "score": 2, "last_activity_date": 1613679523, "creation_date": 1511979676, "last_edit_date": 1593763910, "question_id": 47559316, "link": "https://stackoverflow.com/questions/47559316/macro-to-insert-a-cross-reference-based-on-selection", "title": "Macro to insert a cross reference based on selection", "body": "<p>I currently work for a company which uses a set house-style for its documents.  This includes multi-levelled numbered headings built in to our Word template. I.e.</p>\n\n<ol>\n<li>Heading 1</li>\n</ol>\n\n<p>1.1 Heading 2</p>\n\n<p>1.1.1 Heading 3</p>\n\n<p>etc...</p>\n\n<p>A large part of our current task involves adding in cross references to other parts in the document.  This can be quite time consuming when the doc runs to several hundred pages with around 10 references on each page. </p>\n\n<p>What I was wondering was if a macro could be set up to add a x-ref based on whatever is highlighted by the cursor.  I.e. if you had a sentence that read \"please refer to clause 3.2\" you could highlight the \"3.2\" part, run the macro and have the x-ref linked to heading 3.2 be inserted.</p>\n\n<p>Not sure if this is even possible but would be grateful for any advice.</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 7598809, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4ab0a2cf0c9f59823a6fa4e2a5c7f5e0?s=128&d=identicon&r=PG&f=1", "display_name": "eM_Sk", "link": "https://stackoverflow.com/users/7598809/em-sk"}, "edited": false, "score": 0, "creation_date": 1512228594, "post_id": 47561016, "comment_id": 82177213, "body": "Hi again, so with all you advices I managed to fix my code so It works now, but I have one more issue to solve. What if, let&#39;s say I would like to copy two different ranges from sheet &quot;B&quot;, for example not only A1:Q1, but also T1:X5. So the final code should work like It copy specific range from sheet &quot;A&quot; to sheet called check_data, then from sheet called &quot;B&quot; it should copy range A1:Q1 but also I would like it to copy from the same sheet another range, lets say T1:X5 to this check_data sheet (still under already copied ranges)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1512240150, "post_id": 47561016, "comment_id": 82180743, "body": "you can use Union to combine ranges."}, {"owner": {"reputation": 731, "user_id": 5613367, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-ZDZV06Q_DNI/AAAAAAAAAAI/AAAAAAAAAH8/yz_JRBIXnoM/photo.jpg?sz=128", "display_name": "Pat Jones", "link": "https://stackoverflow.com/users/5613367/pat-jones"}, "edited": false, "score": 0, "creation_date": 1512240931, "post_id": 47561016, "comment_id": 82181003, "body": "Short documentation on Union <a href=\"http://www.informit.com/articles/article.aspx?p=2021718&amp;seqNum=11\" rel=\"nofollow noreferrer\">here</a>. You could also just do two successive <code>Select</code> and <code>Selection.Paste</code> operations, but I think Union is cleaner."}, {"owner": {"reputation": 43, "user_id": 7598809, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4ab0a2cf0c9f59823a6fa4e2a5c7f5e0?s=128&d=identicon&r=PG&f=1", "display_name": "eM_Sk", "link": "https://stackoverflow.com/users/7598809/em-sk"}, "edited": false, "score": 0, "creation_date": 1512245251, "post_id": 47561016, "comment_id": 82182288, "body": "Thanks all for your input, but can I manipulate this new range somehow? because right now i got this new range: <a href=\"https://i.imgur.com/DKtS4ET.png\" rel=\"nofollow noreferrer\">i.imgur.com/DKtS4ET.png</a> - and i would like to copy it to a new sheet one under another"}, {"owner": {"reputation": 731, "user_id": 5613367, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-ZDZV06Q_DNI/AAAAAAAAAAI/AAAAAAAAAH8/yz_JRBIXnoM/photo.jpg?sz=128", "display_name": "Pat Jones", "link": "https://stackoverflow.com/users/5613367/pat-jones"}, "edited": false, "score": 0, "creation_date": 1512247857, "post_id": 47561016, "comment_id": 82183100, "body": "If you require that level of control then I would just do two successive <code>Select</code> and <code>Selection.Paste</code> operations..."}], "tags": [], "owner": {"reputation": 731, "user_id": 5613367, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-ZDZV06Q_DNI/AAAAAAAAAAI/AAAAAAAAAH8/yz_JRBIXnoM/photo.jpg?sz=128", "display_name": "Pat Jones", "link": "https://stackoverflow.com/users/5613367/pat-jones"}, "is_accepted": true, "score": 0, "last_activity_date": 1511986373, "creation_date": 1511986373, "answer_id": 47561016, "question_id": 47559259, "link": "https://stackoverflow.com/questions/47559259/how-to-loop-through-sheet-and-copy-some-specific-range/47561016#47561016", "title": "How to loop through sheet and copy some specific range", "body": "<p>A couple of things here. Always fully specify both the workbook and worksheets with objects, and preprend methods like <code>Sheets</code> with those objects, like this:</p>\n\n<pre><code>Dim wb As Workbook\nDim ws1 As Worksheet\nDim ws2 As Worksheet\n\nSet wb = ThisWorkbook\n\nws1 = wb.Sheets(\"A\")\nws2 = wb.Sheets(\"Check_data\")\n\nws1.Range(\"A1:Q1\").Select\nws1.Range(Selection, Selection.End(xlDown)).Select\nSelection.Copy\n</code></pre>\n\n<p>...and same thing when you are ready to paste, except that you need to <em>explicitly activate</em> the sheet that you are pasting into:</p>\n\n<pre><code>ws2.Activate\n\nIf ws2.Range(\"A1\") = \"\" Then\n    ws2.Range(\"A1\").Select\n    Selection.Paste\nElse\n    Selection.End(xlDown).Offset(1, 0).Select\n    Selection.Paste\nEnd If\n</code></pre>\n\n<p>Obviously, this isn't your entire code snippet rewritten, but it's the direction that you want to head in.</p>\n"}], "owner": {"reputation": 43, "user_id": 7598809, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4ab0a2cf0c9f59823a6fa4e2a5c7f5e0?s=128&d=identicon&r=PG&f=1", "display_name": "eM_Sk", "link": "https://stackoverflow.com/users/7598809/em-sk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 47561016, "answer_count": 1, "score": 0, "last_activity_date": 1512228238, "creation_date": 1511979437, "last_edit_date": 1512228238, "question_id": 47559259, "link": "https://stackoverflow.com/questions/47559259/how-to-loop-through-sheet-and-copy-some-specific-range", "title": "How to loop through sheet and copy some specific range", "body": "<p>So I would like my code to loop through sheets, depend on sheet name I would like to copy different range (if sheet will not be listed i want just to skip it) (lets say i know number/adress of the columns i would like to copy (number of rows might be different, depends on the orginal file i got) and i would like to copy all of these ranges one under another into sheet called check_data with additional column to the right saying from which sheet this part is comming from. I'm stuck sometimes this part of code works but it seems like it doesnt loop through the sheets.</p>\n\n<p>So far i got this (but im totally new to vba)</p>\n\n<pre><code>Sub Copy_data()\n\nDim wb As Workbook\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim ws3 As Worksheet\n\n\nSet wb = ActiveWorkbook\n\nSet ws1 = wb.Sheets(\"A\")\nSet ws2 = wb.Sheets(\"B\")\nSet ws3 = wb.Sheets(\"Check_data\")\n\n\nFor Each ws In Worksheets\n\nIf ws.Name = \"A\" Then\nws1.Activate\nws1.Range(\"A1:Q1\").Select\nws1.Range(Selection, Selection.End(xlDown)).Select\nSelection.Copy\nws3.Select\n    If ws3.Range(\"A1\") = \"\" Then\n       ws3.Range(\"A1\").Select\n       ActiveSheet.Paste\n    Else\n        Selection.End(xlDown).Offset(1, 0).Select\n        ActiveSheet.Paste\n    End If\n\nElseIf ws.Name = \"B\" Then\nws2.Activate\nws2.Range(\"A1:Q1\").Select\nws2.Range(Selection, Selection.End(xlDown)).Select\nSelection.Copy\nws3.Select\n    If ws3.Range(\"A1\") = \"\" Then\n        ws3.Range(\"A1\").Select\n        ActiveSheet.Paste\n    Else\n        Selection.End(xlDown).Offset(1, 0).Select\n        ActiveSheet.Paste\n    End If\nElse\nEnd If\nNext ws\n\nEnd Sub\n</code></pre>\n\n<p>Thanks for any suggestions</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 1, "creation_date": 1511979649, "post_id": 47559187, "comment_id": 82076273, "body": "this approach prevents you from selecting non-adjacent cells from the same row/column. Still, +1"}, {"owner": {"reputation": 397, "user_id": 7787878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VkW4.jpg?s=128&g=1", "display_name": "E. Merckx", "link": "https://stackoverflow.com/users/7787878/e-merckx"}, "reply_to_user": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 0, "creation_date": 1511980236, "post_id": 47559187, "comment_id": 82076574, "body": "Worked like a charm! And @FernandoJ.Rivera, you&#39;re right... I&#39;m still looking for a work-around, but it hasn&#39;t been a major issue as of yet for my case."}, {"owner": {"reputation": 397, "user_id": 7787878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VkW4.jpg?s=128&g=1", "display_name": "E. Merckx", "link": "https://stackoverflow.com/users/7787878/e-merckx"}, "edited": false, "score": 0, "creation_date": 1511981028, "post_id": 47559187, "comment_id": 82076945, "body": "Small change to get the exact behavior I was expecting: Replace <code>.Line.Weight = Rwt</code> and <code>.Line.Weight = Cwt</code> with <code>.Line.Weight = a.Height</code> and <code>.Line.Weight = a.Width</code>, respectively."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1511981033, "post_id": 47559187, "comment_id": 82076948, "body": "++nice one :) FOr non adjacent cells, there is a different approach@E.Merckx"}, {"owner": {"reputation": 397, "user_id": 7787878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VkW4.jpg?s=128&g=1", "display_name": "E. Merckx", "link": "https://stackoverflow.com/users/7787878/e-merckx"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1511981912, "post_id": 47559187, "comment_id": 82077370, "body": "@SiddharthRout What would be a better approach for non-adjacent cells? I&#39;m always interested in hearing alternative methods."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 397, "user_id": 7787878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VkW4.jpg?s=128&g=1", "display_name": "E. Merckx", "link": "https://stackoverflow.com/users/7787878/e-merckx"}, "edited": false, "score": 0, "creation_date": 1511982254, "post_id": 47559187, "comment_id": 82077559, "body": "@E.Merckx: Before I confirm, Is <a href=\"https://i.stack.imgur.com/Ossir.png\" rel=\"nofollow noreferrer\">THIS</a> how it should look like when you select <code>F10</code> then select <code>H6</code>"}, {"owner": {"reputation": 397, "user_id": 7787878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VkW4.jpg?s=128&g=1", "display_name": "E. Merckx", "link": "https://stackoverflow.com/users/7787878/e-merckx"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1511982586, "post_id": 47559187, "comment_id": 82077745, "body": "@SiddharthRout Yes, I believe so. I&#39;m only looking at the case where I have both cells selected. (i.e. click <code>F10</code>, hold ctrl, click <code>H6</code>)."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 397, "user_id": 7787878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VkW4.jpg?s=128&g=1", "display_name": "E. Merckx", "link": "https://stackoverflow.com/users/7787878/e-merckx"}, "edited": false, "score": 0, "creation_date": 1511982887, "post_id": 47559187, "comment_id": 82077881, "body": "yup that is what I meant.. @E.Merckx. Quick quesiton. Would you be selecting more than 2 cells?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1511982904, "post_id": 47559187, "comment_id": 82077889, "body": "@TimWilliams: I am sorry to hijack this"}, {"owner": {"reputation": 397, "user_id": 7787878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VkW4.jpg?s=128&g=1", "display_name": "E. Merckx", "link": "https://stackoverflow.com/users/7787878/e-merckx"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1511983093, "post_id": 47559187, "comment_id": 82078013, "body": "@SiddharthRout Yes, potentially."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1511989568, "post_id": 47559187, "comment_id": 82081327, "body": "@SiddharthRout - no problem.  The more the merrier."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 6, "last_activity_date": 1511981964, "last_edit_date": 1511981964, "creation_date": 1511979172, "answer_id": 47559187, "question_id": 47558928, "link": "https://stackoverflow.com/questions/47558928/selection-crosshair-for-non-adjacent-cell-selection/47559187#47559187", "title": "Selection Crosshair for Non-Adjacent Cell Selection", "body": "<p>Something like this:</p>\n\n<p>EDIT: added different colors for up to 3 distinct areas</p>\n\n<pre><code>Private Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\n\n    Dim On_Off As Boolean\n    On_Off = True\n    If On_Off = False Then Exit Sub\n\n    Dim Sht As Worksheet\n    Dim Rng As Range, a As Range, c As Range, i As Long\n    Set Sht = ActiveSheet\n    Set Rng = Selection\n    Dim Shp As Shape\n    Dim Clrs\n    Dim RWt As Double\n    Dim CWt As Double\n    Dim Trns As Double\n\n    Clrs = Array(vbRed, vbYellow, vbGreen)\n    Trns = 0.85\n\n    For Each Shp In Sht.Shapes\n        If Shp.Name Like \"RowLine*\" Or Shp.Name Like \"ColLine*\" Then\n            Shp.Delete\n        End If\n    Next Shp\n\n    For Each a In Rng.Areas\n        i = i + 1\n        Debug.Print a.Address(False, False, xlA1)\n\n        With Sht.Shapes.AddConnector(msoConnectorStraight, 0, _\n            a.Top + a.Height / 2, 10000, a.Top + a.Height / 2)\n            .Name = \"RowLine\" &amp; i\n            .Line.ForeColor.RGB = Clrs(i Mod 3)\n            .Line.Transparency = Trns\n            .Line.Weight = a.Height\n        End With\n\n        With Sht.Shapes.AddConnector(msoConnectorStraight, _\n            a.Left + a.Width / 2, 0, a.Left + a.Width / 2, 10000)\n            .Name = \"ColLine\" &amp; i\n            .Line.ForeColor.RGB = Clrs(i Mod 3)\n            .Line.Transparency = Trns\n            .Line.Weight = a.Width\n        End With\n\n    Next a\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 397, "user_id": 7787878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VkW4.jpg?s=128&g=1", "display_name": "E. Merckx", "link": "https://stackoverflow.com/users/7787878/e-merckx"}, "edited": false, "score": 0, "creation_date": 1511986047, "post_id": 47560465, "comment_id": 82079591, "body": "Thanks for the alternate approach! Tim&#39;s approach is more suitable for my current application, but I will likely use this in the future. Is there a way to enable copy/cut with this method?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 397, "user_id": 7787878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VkW4.jpg?s=128&g=1", "display_name": "E. Merckx", "link": "https://stackoverflow.com/users/7787878/e-merckx"}, "edited": false, "score": 0, "creation_date": 1511986118, "post_id": 47560465, "comment_id": 82079633, "body": "<code>Is there a way to enable copy&#47;cut with this method?</code> I am sure that can be managed"}, {"owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 1, "creation_date": 1511996704, "post_id": 47560465, "comment_id": 82084553, "body": "Very nice, I wouldn&#39;t have thought to use the selection highlighting as markers. However, this only works with point selection (selecting single cells), it doesn&#39;t work when selecting adjacent ranges."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 1, "creation_date": 1512007178, "post_id": 47560465, "comment_id": 82087454, "body": "@FernandoJ.Rivera: Yes this is just a sample code. It does not handle ranges with more rows and columns. It can however be tweaked to handle those as well."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 5, "last_activity_date": 1511984182, "creation_date": 1511984182, "answer_id": 47560465, "question_id": 47558928, "link": "https://stackoverflow.com/questions/47558928/selection-crosshair-for-non-adjacent-cell-selection/47560465#47560465", "title": "Selection Crosshair for Non-Adjacent Cell Selection", "body": "<blockquote>\n  <p>The code works for most selection sets, except for non-adjacent cell selections. For non-adjacent cells, it only highlights the first cell in the selection. Ex: If I select F10 then select H6, I expect two crosshairs: one centered at F10, and another centered at H6</p>\n</blockquote>\n\n<p>The approach you are currently following will not work when you have to select the <code>non-adjacent</code> cell in the same row as the shape will block the cell by superimposing itself.</p>\n\n<p><strong>Alternative Approach</strong></p>\n\n<p>The logic can be best explained by a question. </p>\n\n<p>What happens when you record a macro and then select <code>Col F</code> and then <code>Row 10</code> and then <code>Col H</code> and <code>Row 6</code>?</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ossir.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/Ossir.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is exactly what you want to happen when you select <code>F10</code> and then select <code>H6</code> using the <kbd>Ctrl</kbd> key.</p>\n\n<p>If you look at the code the macro recorder created, you will see </p>\n\n<pre><code>Range(\"F:F,10:10,H:H,6:6\").Select\n</code></pre>\n\n<p>And this is where the entire logic is based on.</p>\n\n<p><strong>Code</strong></p>\n\n<p>I have not done any error handling. I am sure you can take care of it.</p>\n\n<pre><code>Option Explicit\n\nDim addr As String\n\nPrivate Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\n    Dim aCell As Range, CompleteSelection As Range, LastCell As Range\n    Dim sTemp As String\n    Dim col As Long, rw As Long\n    Dim MyAr\n\n    '~~&gt; Check if what the user selected is a valid range\n    If TypeName(Selection) &lt;&gt; \"Range\" Then Exit Sub\n\n    Set CompleteSelection = Nothing\n    If Selection.Cells.Count = 1 Then addr = \"\"\n\n    If InStr(1, Target.Address, \",\") Then\n        MyAr = Split(Target.Address, \",\")\n        sTemp = MyAr(UBound(MyAr))\n        Set aCell = Range(sTemp)\n    Else\n        Set aCell = Target\n    End If\n\n    Set LastCell = aCell\n\n    col = aCell.Column: rw = aCell.Row\n\n    sTemp = Split(Cells(, col).Address, \"$\")(1) &amp; \":\" &amp; _\n               Split(Cells(, col).Address, \"$\")(1) &amp; \",\" &amp; _\n               rw &amp; \":\" &amp; rw\n\n    If addr = \"\" Then\n        addr = sTemp\n    Else\n        addr = addr &amp; \",\" &amp; sTemp\n    End If\n\n    Set CompleteSelection = Range(addr)\n\n    Application.EnableEvents = False\n    If Not CompleteSelection Is Nothing Then CompleteSelection.Select\n    LastCell.Activate\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 397, "user_id": 7787878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VkW4.jpg?s=128&g=1", "display_name": "E. Merckx", "link": "https://stackoverflow.com/users/7787878/e-merckx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 47559187, "answer_count": 2, "score": 4, "last_activity_date": 1579883560, "creation_date": 1511978271, "last_edit_date": 1579883560, "question_id": 47558928, "link": "https://stackoverflow.com/questions/47558928/selection-crosshair-for-non-adjacent-cell-selection", "title": "Selection Crosshair for Non-Adjacent Cell Selection", "body": "<p><strong>Background:</strong> I have a large Excel worksheet in which I created a \"crosshair\" for easy comparisons between data in the same row and column as the currently selected cell. Most \"crosshair\" navigation tricks I have seen use <a href=\"https://stackoverflow.com/questions/35817040/easy-navigation-in-excel-within-the-same-row-with-the-aid-of-a-hairline-cross/\">formatting</a>, which would either delete or overwrite my existing conditional formatting. My work-around was to use a transparent line to highlight the row and column of the currently selected cell. </p>\n\n<p><strong>Problem:</strong> The code works for most selection sets, except for non-adjacent cell selections. For non-adjacent cells, it only highlights the first cell in the selection. <em>Ex:</em> If I select <code>F10</code> then select <code>H6</code>, I expect two crosshairs: one centered at <code>F10</code>, and another centered at <code>H6</code>. Instead, there is a single crosshair centered at <code>F10</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/vzCcy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vzCcy.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Question:</strong> Is there a way to create a selection crosshair which will work for non-adjacent cell selections?</p>\n\n<p><strong>Current Code:</strong></p>\n\n<pre><code>Private Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\n\n    Dim On_Off As Boolean\n    On_Off = True\n    If On_Off = False Then Exit Sub\n\n    Dim Sht As Worksheet\n    Dim Rng As Range\n    Set Sht = ActiveSheet\n    Set Rng = Selection\n    Dim Shp As Shape\n    Dim Clr As Long\n    Dim RWt As Double\n    Dim CWt As Double\n    Dim Trns As Double\n\n    Clr = RGB(100, 20, 180)\n    Trns = 0.85\n    RWt = Rng.Height\n    CWt = Rng.Width\n\n    Debug.Print Rng.Address(False, False, xlA1)\n\n    For Each Shp In Sht.Shapes\n        If Shp.Name = \"RowLine\" Or Shp.Name = \"ColLine\" Then\n            Shp.Delete\n        End If\n    Next Shp\n\n    With Sht.Shapes.AddConnector(msoConnectorStraight, 0, _\n        Rng.Top + Rng.Height / 2, 10000, Rng.Top + Rng.Height / 2)\n        .Name = \"RowLine\"\n        .Line.ForeColor.RGB = Clr\n        .Line.Transparency = Trns\n        .Line.Weight = RWt\n    End With\n\n    With Sht.Shapes.AddConnector(msoConnectorStraight, _\n        Rng.Left + Rng.Width / 2, 0, Rng.Left + Rng.Width / 2, 10000)\n        .Name = \"ColLine\"\n        .Line.ForeColor.RGB = Clr\n        .Line.Transparency = Trns\n        .Line.Weight = CWt\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "internationalization", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1511979016, "post_id": 47558866, "comment_id": 82075971, "body": "That sounds incredibly frustrating. Ive never used international versions but are English commands allowed on either of those versions?  You fill a column with a VBA Macro?  I think you&#39;re mixing your terms up What is the name of the Macro you developed?  There are certain names you can&#39;t use, and the <code>NOM</code> error indicates either a bad name or an unknown name. I don&#39;t think you are using VALUTA/DEVISE incorrectly.  CURRENCY is not the name of an English function.Could you edit your Question to add your code?  Also, Google to find the syntax (how to use)VALUTA &amp; DEVISE and post the links here?"}, {"owner": {"reputation": 145, "user_id": 8641641, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/9e06fe9d06f851652a86733373fa54e4?s=128&d=identicon&r=PG", "display_name": "JSP", "link": "https://stackoverflow.com/users/8641641/jsp"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1512062628, "post_id": 47558866, "comment_id": 82115365, "body": "Thank you very much. The code is very simple:         &#39; Fetch values and convert to &quot;text&#39; with two decimals (works as written above)        ActiveSheet.Range(&quot;AL13:AL129&quot;).Formula = &quot;=DEVISE(C13)&quot;        ActiveSheet.Range(&quot;AM13:AM129&quot;).Formula = &quot;=DEVISE(F14)&quot;  The Swedish version (works nicely in my Mac):         ActiveSheet.Range(&quot;AL13:AL129&quot;).Formula = &quot;=VALUTA(C13)&quot;        ActiveSheet.Range(&quot;AM13:AM129&quot;).Formula = &quot;= VALUTA(F14)&quot; Be so kind as to have a look here: <a href=\"https://fr.excel-translator.de/translator/\" rel=\"nofollow noreferrer\">fr.excel-translator.de/translator</a>"}], "answers": [{"tags": [], "owner": {"reputation": 145, "user_id": 8641641, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/9e06fe9d06f851652a86733373fa54e4?s=128&d=identicon&r=PG", "display_name": "JSP", "link": "https://stackoverflow.com/users/8641641/jsp"}, "is_accepted": false, "score": 0, "last_activity_date": 1512919632, "creation_date": 1512919632, "answer_id": 47740312, "question_id": 47558866, "link": "https://stackoverflow.com/questions/47558866/multi-language-excel-vba-macro-french-english-swedish/47740312#47740312", "title": "Multi-language Excel VBA Macro (French / English / Swedish)", "body": "<p>I found a way to do it. The code uses ROUNDDOWN() to 2 decimals [which is OK but not really want I wanted] which also works in French Excel, rather than DEVISE(). After that I use concatenation to get the values of with two decimals. If I do not use ROUNDDOWN(), the result will be \"Place: 2.34567\". So this is what I have now:</p>\n\n<p><code>ActiveSheet.Range(\"A5\").Formula = \"= LOOKUP(2,1/(H:H&gt;1),H:H)\"\n    ActiveSheet.Range(\"AJ138\")=ROUNDDOWN(A5,2)\n    ActiveSheet.Range(\"AQ13:AQ129\").Formula = \"=\"\"Place: \"\"&amp;AJ13&amp;\"</code></p>\n\n<p>That is the best I can do. Thank you all for responding. I will post another question, how to get the address found by the lookup function.</p>\n"}], "owner": {"reputation": 145, "user_id": 8641641, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/9e06fe9d06f851652a86733373fa54e4?s=128&d=identicon&r=PG", "display_name": "JSP", "link": "https://stackoverflow.com/users/8641641/jsp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 783, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1512919632, "creation_date": 1511978030, "last_edit_date": 1531164843, "question_id": 47558866, "link": "https://stackoverflow.com/questions/47558866/multi-language-excel-vba-macro-french-english-swedish", "title": "Multi-language Excel VBA Macro (French / English / Swedish)", "body": "<p>Good evening!</p>\n\n<p>I have developed a macro in English on a Swedish Mac. The macro runs on a a Mac used in France with Excel in French. All the Subroutines work very well... but one. I used the formula \"=VALUTA(123,4567)\" [Swedish for currency] so that it should truncate to 2 decimals and then convert to text. The corresponding French formula is \"=DEVISE(123,4567)\", which I now use. I fill a whole column with this formula with the VBA-macro but the result is \"NOM?\" [name?]; one would think Excel does not recognize DEVISE().</p>\n\n<p>However, and this is the real question, if I mark any of these cells and press RETURN (manually, that is) it recognizes the formula and prints 123,45!!!</p>\n\n<p>I am quite frustrated. Any pointers towards a solution would be greatly appreciated. Thank you.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1511979198, "post_id": 47558821, "comment_id": 82076060, "body": "You need a randomly chosen file?? Um, why?"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 1, "creation_date": 1511992367, "post_id": 47558821, "comment_id": 82082692, "body": "what do you mean by sheet1? Is sheet1 the name of the tab, or you mean the 1st tab among all the tabs in the Excel file?"}], "answers": [{"comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1511979227, "post_id": 47559147, "comment_id": 82076078, "body": "<code>Set Sht = wb.Worksheets(1)</code> can result in a wrong assignment if the name of the sheets is not as default names assigned by Excel itself."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1511979289, "post_id": 47559147, "comment_id": 82076109, "body": "@Ibo did you read the comments inside my code ? I gave him 2 options, as I am not sure if the PO meant &quot;Sheet1&quot;, or the first Sheet (index wize)"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 1, "creation_date": 1511979489, "post_id": 47559147, "comment_id": 82076197, "body": "Both of us can see his level from what he is asking and how he describes his need, so it is better to keep it simple for him until he learns about the index and the code name of sheet etc, however, I am not saying your answer is wrong, it can just be confusing for him"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1511979015, "creation_date": 1511979015, "answer_id": 47559147, "question_id": 47558821, "link": "https://stackoverflow.com/questions/47558821/open-a-excel-file-and-activate-sheet-1-to-run-macros/47559147#47559147", "title": "Open a Excel file and Activate sheet 1 to run macros", "body": "<p>There is no need to <code>Activate</code> \"Sheet1\" in order to run Macros on it.</p>\n\n<p>If you must <code>Activate</code> it, use :</p>\n\n<pre><code>Set wb = Workbooks.Open(fNameAndPath)\n\n' Option 1: set the first sheet (index)\nSet Sht = wb.Worksheets(1) \n' Option 2: set the sheet named \"Sheet1\"\nSet Sht = wb.Worksheets(\"Sheet1\")    \n\nSht.Activate ' &lt;-- Not sure why you would need to Activate it ?\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511982199, "post_id": 47559158, "comment_id": 82077533, "body": "If this is going to work on a &quot;random&quot; (i.e. user-selected) file, there is a very high probability that there won&#39;t be a sheet called &quot;Sheet1&quot;.  It therefore seems like the OP is wanting to access the first sheet in the file, so it would probably be best to show how to access <code>Worksheets(1)</code> rather than <code>Worksheets(&quot;Sheet1&quot;)</code>.  (Or show them how to access both ways, so that they can use whichever method is appropriate.)"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511987169, "post_id": 47559158, "comment_id": 82080098, "body": "He says sheet1 and not the first sheet in the OP. The contrary is if he really wants Sheet1 (name of the sheet) and the code chooses the first index then  it can be a problem"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511987774, "post_id": 47559158, "comment_id": 82080389, "body": "The question refers to <code>Sheet1</code> (which would be a <code>CodeName</code>) and also (twice) to Sheet <code>1</code> (which would be an index into the <code>Sheets</code> collection), but doesn&#39;t mention <code>&quot;Sheet1&quot;</code> (which would be a <code>Name</code>), so perhaps giving all three methods and explaining what they do would be the best solution.  (Or perhaps wait until the questioner clarifies which they mean?)"}], "tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": false, "score": 0, "last_activity_date": 1511979047, "creation_date": 1511979047, "answer_id": 47559158, "question_id": 47558821, "link": "https://stackoverflow.com/questions/47558821/open-a-excel-file-and-activate-sheet-1-to-run-macros/47559158#47559158", "title": "Open a Excel file and Activate sheet 1 to run macros", "body": "<p>The code will open the workbook and will assign the opened workbook to wb object. Automatically wb will be the active one, so there is no need to write a code for that. Just to make sure Sheet1 will be activated, you should add:</p>\n\n<pre><code>wb.sheets(\"Sheet1\").activate\n</code></pre>\n\n<p>I did not quite get what you meant by \"I want macros to run on the activated sheet.\" because it depends on the macro that is run. To make sure that the macro will use the active sheet to make changes etc you should use the object <code>activesheet</code> for example you can do this:</p>\n\n<pre><code>Dim ws as worksheet\nset ws=activesheet\n' ...\n' do whatever you want on ws in here\n' ...\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8057520, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c613c6e93726905824a434911ef0323f?s=128&d=identicon&r=PG&f=1", "display_name": "Jenita C", "link": "https://stackoverflow.com/users/8057520/jenita-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4866, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1511981996, "creation_date": 1511977871, "last_edit_date": 1511981996, "question_id": 47558821, "link": "https://stackoverflow.com/questions/47558821/open-a-excel-file-and-activate-sheet-1-to-run-macros", "title": "Open a Excel file and Activate sheet 1 to run macros", "body": "<p>I need to write a VBA code that allows the user to browse and select an Excel file of his choice from a directory and then activate Sheet1 in that Excel file. After that I want macros to run on the activated sheet.</p>\n\n<p>please help from below forward:</p>\n\n<pre><code>Sub GetFile()\nDim fNameAndPath As Variant, wb As Workbook\nDim sht As Worksheet\n\nfNameAndPath = Application.GetOpenFilename(FileFilter:=\"Excel Files (*.XLSX), *.XLSX\", Title:=\"Select File To Be Opened\")\nIf fNameAndPath = False Then Exit Sub\nSet wb = Workbooks.Open(fNameAndPath)\n</code></pre>\n\n<p>From here how to activate the open file, and how to activate Sheet 1 of the open file to run macros?</p>\n"}, {"tags": ["excel", "vba", "ini"], "comments": [{"owner": {"reputation": 1295, "user_id": 4360863, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/heWif.png?s=128&g=1", "display_name": "Philip Brack", "link": "https://stackoverflow.com/users/4360863/philip-brack"}, "edited": false, "score": 0, "creation_date": 1511978384, "post_id": 47558814, "comment_id": 82075627, "body": "Welcome! Please read the <a href=\"https://stackoverflow.com/help/how-to-ask\">how-to-ask</a> article to help us help you. Your question is too broad."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1511979312, "post_id": 47558814, "comment_id": 82076122, "body": "please show us what you have tried?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6765268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HaJKb.jpg?s=128&g=1", "display_name": "Aman Agarawal", "link": "https://stackoverflow.com/users/6765268/aman-agarawal"}, "edited": false, "score": 0, "creation_date": 1512019763, "post_id": 47559364, "comment_id": 82090619, "body": "I want to parse the values and used that keyvalues in my excel code in different modules."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 1, "user_id": 6765268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HaJKb.jpg?s=128&g=1", "display_name": "Aman Agarawal", "link": "https://stackoverflow.com/users/6765268/aman-agarawal"}, "edited": false, "score": 0, "creation_date": 1512020390, "post_id": 47559364, "comment_id": 82090819, "body": "<code>used that keyvalues in my excel code in different modules</code>  In different modules?  Did you mean different <i>workbooks</i>?  Can you provide an example of how you need the data parsed?  Is this for only one INI, or multiple from multiple applications?  What is the purpose? Is it a one time parse job or would it be executed regularly?   Are there any similar existing utilities (or code) that are suitable or that could be adapted?"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1511979885, "creation_date": 1511979885, "answer_id": 47559364, "question_id": 47558814, "link": "https://stackoverflow.com/questions/47558814/what-will-be-the-excel-vba-code-to-get-the-values-from-ini-file/47559364#47559364", "title": "what will be the excel vba code to get the values from .INI file?", "body": "<p>Parsing files in VBA is not a beginner's task.  If you'd like to learn to code there are a lot websites with basic tutorials to get you started.</p>\n\n<p>Whatever it is that you need to get out a .INI file, you can do with Excel, about eight different ways, any of which are going to easier on you.</p>\n\n<p>To open the INI file in Excel, just:</p>\n\n<blockquote>\n  <p>Right Click the file \u2192 Open With \u2192 Excel.</p>\n</blockquote>\n\n<p>If you need any \"parsing\" beyond Find (CTRL+F), Copy (CTRL+C) and Paste (CTRL+V) for such a basic filetype, Google \"Excel text functions\" for some ideas.</p>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 1, "user_id": 6765268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HaJKb.jpg?s=128&g=1", "display_name": "Aman Agarawal", "link": "https://stackoverflow.com/users/6765268/aman-agarawal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 260, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1511979885, "creation_date": 1511977857, "question_id": 47558814, "link": "https://stackoverflow.com/questions/47558814/what-will-be-the-excel-vba-code-to-get-the-values-from-ini-file", "title": "what will be the excel vba code to get the values from .INI file?", "body": "<p>I have an INI file. Now i want to parse that file in excel vba. the code must be worked in excel 2010 or higher version. I tried on google to get the code for this problem but no one can understand full functionality of that code. So please tell me the code to parse the INI file and also give me overview what is actually happening in the code.\nThanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1511977532, "post_id": 47558460, "comment_id": 82075077, "body": "what do you &quot;know is wrong&quot;?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1511977927, "post_id": 47558460, "comment_id": 82075331, "body": "and you&#39;re right, definitely can&#39;t help you calculate something without knowing what we&#39;re working with.  Where do these values come from? (ie., reageant, identifier) Is Julian date based on current date or expiry date.  Where does expiry date come from?  More info and a screen shot might help.  (also check out <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>)You have 2 lines like <b><i>something = something = something</i></b>.  Assign values to only 1 variable."}, {"owner": {"reputation": 19, "user_id": 8349954, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5604dcc225474576f924b0f448bc9044?s=128&d=identicon&r=PG&f=1", "display_name": "L Johnstone", "link": "https://stackoverflow.com/users/8349954/l-johnstone"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1512030324, "post_id": 47558460, "comment_id": 82095185, "body": "@ashleedawg I have edited my question, if you need more info please just let me know.  The date I&#39;m changing to a Julian/ordinal date is an expiry date which can be found on a sheet called CP_Sequencer in cell &quot;S7&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1512037326, "last_edit_date": 1512037326, "creation_date": 1512036620, "answer_id": 47570816, "question_id": 47558460, "link": "https://stackoverflow.com/questions/47558460/creating-a-lot-number-using-julian-ordinal-date-from-a-yyyy-mm-dd-and-concatenat/47570816#47570816", "title": "Creating a lot number using Julian/Ordinal date from a yyyy-mm-dd and concatenate in VBA", "body": "<p>This should return the LotNumber you're after.<br>\nI'm quite not sure what's wrong with your code, but it will be in this line:  </p>\n\n<pre><code>Julian_Day = _\n    ActiveCell.FormulaR1C1 = _\n        \"=VALUE(RIGHT(YEAR('CP sequencer'!R[-24]C[13]),2)&amp;TEXT('CP sequencer'!R[-24]C[13]-DATE(YEAR('CP sequencer'!R[-24]C[13]),1,0),\"\"000\"\"))\"  \n</code></pre>\n\n<p>This is asking the question <strong>is the formula in the activecell the same as the text string \"=VALUE(RIGHT....\"</strong> and place the result in the Julian_Day variable. Pretty much guaranteed that the value won't be the same so <code>FALSE</code> is returned.<br>\nIf you wanted to get the result of the formula using that method you'd need to place the formula in the cell first and then read the result... but I'd advise against using that method.  Easier to reference the values within VBA.</p>\n\n<p>The LotNumber function below should return the value you're after.  You can use it as I have in the Test procedure or as a worksheet function entered directly in a cell:  <code>=LotNumber(A1,B1,C1)</code></p>\n\n<pre><code>Sub Test()\n\n    'Passing values to the LotNumber function.\n    Debug.Print LotNumber(141, 2, DateValue(\"3 January 2019\"))\n\n    'Getting values from Sheet1.\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        Debug.Print LotNumber(.Range(\"A1\"), .Range(\"B1\"), .Range(\"C1\"))\n    End With\n\nEnd Sub\n\nPublic Function LotNumber(Reagent As Long, Identifier As Long, Expiry As Date) As String\n\n    Dim Ordinal As Long\n\n    Ordinal = Expiry - DateSerial(Year(Expiry), 1, 1) + 1\n\n    LotNumber = Format$(Reagent, \"000\") &amp; Identifier &amp; Format$(Ordinal, \"000\") &amp; Right(Format(Expiry, \"yyyy\"), 1)\n\nEnd Function\n</code></pre>\n\n<p><strong>Edit:</strong><br>\nAs an afterthought you could define the LotNumber function as:  </p>\n\n<pre><code>Public Function LotNumber(Expiry As Date, Optional Reagent As Long = 141, Optional Identifier As Long = 2) As String  \n</code></pre>\n\n<p>Using this method you must pass the date to the function, but the <code>Reagent</code> and <code>Identifier</code> will default to <em>141</em> and <em>2</em> if no alternative values are supplied.<br>\nIf entered today (30th November 17) then <code>Debug.Print LotNumber(Date)</code> will return <code>14123347</code>.  As a worksheet function with 3rd Jan 2019 in cell C1:  <code>=LotNumber(C1)</code> will return <em>14120039</em></p>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 8349954, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5604dcc225474576f924b0f448bc9044?s=128&d=identicon&r=PG&f=1", "display_name": "L Johnstone", "link": "https://stackoverflow.com/users/8349954/l-johnstone"}, "edited": false, "score": 0, "creation_date": 1512037825, "post_id": 47570851, "comment_id": 82099562, "body": "I have tried your code I seem to get an error on the following line: <code>.JulDays = Format(ws.Range(&quot;S7&quot;).Value - CDate(&quot;12.31.&quot; &amp; yr - 1), &quot;000&quot;)</code>  I&#39;m quite new to VBA and learning as I go and cant quite spot the error"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 19, "user_id": 8349954, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5604dcc225474576f924b0f448bc9044?s=128&d=identicon&r=PG&f=1", "display_name": "L Johnstone", "link": "https://stackoverflow.com/users/8349954/l-johnstone"}, "edited": false, "score": 0, "creation_date": 1512039221, "post_id": 47570851, "comment_id": 82100358, "body": "Code was working for me. - Does your S7 cell actually contain a date value? Try also to use &quot;/&quot; or &quot;-&quot; instead of points &quot;.&quot; in the <code>CDate</code> portion."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 19, "user_id": 8349954, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5604dcc225474576f924b0f448bc9044?s=128&d=identicon&r=PG&f=1", "display_name": "L Johnstone", "link": "https://stackoverflow.com/users/8349954/l-johnstone"}, "edited": false, "score": 0, "creation_date": 1512040070, "post_id": 47570851, "comment_id": 82100865, "body": "You could try to use <code>DateSerial</code> instead of <code>CDate</code> (cf. @Darren-Bartrup-Cook &#39;s Approach) : <code>.JulDays = Format(ws.Range(&quot;S7&quot;).Value - DateSerial(yr, 1, 1) + 1, &quot;000&quot;)</code> - pay attention to the leading point before <code>.JulDays</code>, too. But check the date value in S7 as well."}, {"owner": {"reputation": 19, "user_id": 8349954, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5604dcc225474576f924b0f448bc9044?s=128&d=identicon&r=PG&f=1", "display_name": "L Johnstone", "link": "https://stackoverflow.com/users/8349954/l-johnstone"}, "edited": false, "score": 0, "creation_date": 1512041062, "post_id": 47570851, "comment_id": 82101471, "body": "The expiry date in cell S7 is calculated using a formula, would this effect the code? The formula takes the min date of 3 individual expiry dates and applies that as the expiry date to a product.  Would I then have to convert the date in S7 so that the cell sees a date value rather than the formula?"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 19, "user_id": 8349954, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5604dcc225474576f924b0f448bc9044?s=128&d=identicon&r=PG&f=1", "display_name": "L Johnstone", "link": "https://stackoverflow.com/users/8349954/l-johnstone"}, "edited": false, "score": 0, "creation_date": 1512054972, "post_id": 47570851, "comment_id": 82110364, "body": "No, if it&#39;s a date (= numeric value)."}], "tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1512036720, "creation_date": 1512036720, "answer_id": 47570851, "question_id": 47558460, "link": "https://stackoverflow.com/questions/47558460/creating-a-lot-number-using-julian-ordinal-date-from-a-yyyy-mm-dd-and-concatenat/47570851#47570851", "title": "Creating a lot number using Julian/Ordinal date from a yyyy-mm-dd and concatenate in VBA", "body": "<p>I assume you want a VBA solution to write back your lot number code to a given cell. Your code includes many errors (references without values, undeclared variables, double assignments and so on). Maybe the code with explainations below will be of some help. I use a type Definition to structure your results and make the code more readable.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit   ' obliges you to declare your variables\n    Type TData     ' declaration head of your module\n        ReagentCode As String   ' 3 dig .. 141\n        ID          As String   ' 1 dig .. 2\n        JulDays     As String   ' 3 dig .. 1-365/366\n        YearDigit   As String   ' 1 dig .. 7 (2017 -&gt; 7)\n    End Type\n\nSub CreateLotNo()\n' Declare variables\n  Dim MyData     As TData\n  Dim yr         As Integer      ' expiry year extracted from cell Sz\n  Dim ws         As Worksheet\n' set fully qualified reference to your worksheet\n  Set ws = ThisWorkbook.Worksheets(\"CP Sequencer\")\n' get expiry year from cell S7\n  yr = Year(ws.Range(\"S7\").Value)   ' expiry year\nWith MyData\n' assign values to MyData\n  .ReagentCode = \"141\"            ' constant\n  .ID = \"2\"                       ' constant\n  ' julian days = expiry date minus last year's ultimo date\n  .JulDays = Format(ws.Range(\"S7\").Value - CDate(\"12.31.\" &amp; yr - 1), \"000\")\n  .YearDigit = Right(yr, 1)       ' last digit of the expiry year\n' write lot number back to cell XY\n  ws.Range(\"F31\").Value = .ReagentCode &amp; .ID &amp; .JulDays &amp; .YearDigit &amp; \"\"\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8349954, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5604dcc225474576f924b0f448bc9044?s=128&d=identicon&r=PG&f=1", "display_name": "L Johnstone", "link": "https://stackoverflow.com/users/8349954/l-johnstone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1512037326, "creation_date": 1511976648, "last_edit_date": 1531164843, "question_id": 47558460, "link": "https://stackoverflow.com/questions/47558460/creating-a-lot-number-using-julian-ordinal-date-from-a-yyyy-mm-dd-and-concatenat", "title": "Creating a lot number using Julian/Ordinal date from a yyyy-mm-dd and concatenate in VBA", "body": "<p>I need to create a lot number which consists of:</p>\n\n<p>Digits: 1,2,3 ----> Three digit reagent code ----> For example:141 (this is a constant)</p>\n\n<p>Digit: 4 ----> Identifier ----> For example: 2 (this is a constant)</p>\n\n<p>Digits: 5,6,7 ----> Julian/Ordinal Calendar day ----> 001-365 (366 for leap year)   </p>\n\n<p>Digit: 8 ----> The last digit of the expiry year ----> 0-9  </p>\n\n<p>Therefore: <strong>14120039</strong> (Expiry date would be <strong>2019-01-03</strong>)</p>\n\n<p>The expiry date can be found on a sheet called \"CP_sequencer\" in cell \"S7\".  This will be in the format yyyy-mm-dd.</p>\n\n<p>The following is the code I\u2019m using so far but I know something is wrong and it may not be the most efficient way of doing things.  There are a few cell references that are correct but I know it may be hard to follow without the actual spreadsheet.</p>\n\n<pre><code>Dim Julian_Day As String\nDim Split_Date As String\nDim valueYear, valueLastDigit As Integer\n\nRange(\"F31\").Select\nJulian_Day = _\n    ActiveCell.FormulaR1C1 = _\n        \"=VALUE(RIGHT(YEAR('CP sequencer'!R[-24]C[13]),2)&amp;TEXT('CP sequencer'!R[-24]C[13]-DATE(YEAR('CP sequencer'!R[-24]C[13]),1,0),\"\"000\"\"))\"\nSplit_Date = _\nRange(\"F31\") = Year(CP_Sequencer.Range(\"S7\"))\n\nRange(\"F31\").Select\nSelect Case Len(value1) 'gives a number depending on the length of the value1\nCase 4 ' e.g., 2017 = 201, 7\n    valueYear = Left(value1, 3) ' 201\n    valueLastDigit = Right(value1, 7) ' 7\nEnd Select\n\nActiveCell.Value = \"1412\" &amp; Julian_Day &amp; valueLastDigit\n</code></pre>\n\n<p>I know something isn't right because at the moment when I run this code the output is <strong>1412False0</strong></p>\n\n<p>Any help would be much appreciated </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1511976354, "post_id": 47558329, "comment_id": 82074411, "body": "Why loop cell by cell? <code>GoTo &gt; Special Cells</code> can be used in VBA: <a href=\"http://www.ozgrid.com/VBA/special-cells.htm\" rel=\"nofollow noreferrer\">ozgrid.com/VBA/special-cells.htm</a>"}, {"owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1511977285, "post_id": 47558329, "comment_id": 82074931, "body": "I think I need to loop cell by cell, because it needs to be checked first to see if the number is between existing numbers (to execute copy/insert script), or the largest (to just be added at the end)."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 1, "creation_date": 1511979735, "post_id": 47558329, "comment_id": 82076311, "body": "there is no need to do everything at once, you are trying to find the place where you should insert the new value in column B, a simpler method is to add it to the end of column B and then sort it as you want"}, {"owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "edited": false, "score": 0, "creation_date": 1511979854, "post_id": 47558329, "comment_id": 82076367, "body": "Ah, I see. I will give it a try."}], "answers": [{"tags": [], "owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "is_accepted": true, "score": 0, "last_activity_date": 1511986248, "creation_date": 1511986248, "answer_id": 47560983, "question_id": 47558329, "link": "https://stackoverflow.com/questions/47558329/searching-for-empty-cells-in-a-loop/47560983#47560983", "title": "Searching for Empty Cells in a Loop", "body": "<p>The issue is that the loop was starting at the first non-blank cells in column B, so it was not possible for that value to be vbnullstring.  Below is working code:</p>\n\n<pre><code>If Target.column = 13 Then\n\n     Dim cell As Long\n     Dim l As Long\n\n     cell = ActiveCell.Row\n\n     If ActiveCell.Value = \"Special\" Then\n         If Sheet12.[B4].Value = vbNullString Then\n             Sheet12.[B4].Value = cell\n         Else\n             With Sheet12\n                 For l = .Cells(rows.count, \"B\").End(xlUp).Row + 1 To 4 Step -1\n                     If .Cells(l, 2).Value = vbNullString And .Cells(l - 1, 2).Value &lt; cell Then\n                         Sheet12.Cells(l, 2).Value = cell\n                         Exit For\n                     ElseIf .Cells(l - 1, 2).Value &gt; cell And .Cells(l - 2, 2).Value &lt; cell Then\n                         Sheet12.Cells(l - 1, 2).EntireRow.Insert shift:=xlDown\n                         Sheet12.Range(\"A3\").EntireRow.Copy Sheet12.Cells(l - 1, 2).EntireRow\n                         Sheet12.Cells(l - 1, 2).Value = cell\n                         Exit For\n                     End If\n                 Next\n             End With\n         End If\n     ElseIf ActiveCell.Value = vbNullString Or ActiveCell.Value = \"Normal\" Then\n             With Sheet12\n                 For l = .Cells(rows.count, \"B\").End(xlUp).Row To 4 Step -1\n                     If .Cells(l, 2).Value = cell Then\n                         .Cells(l, 2).EntireRow.Delete\n                     End If\n                 Next\n             End With\n     End If\n End If\n</code></pre>\n\n<p><strong>Note: this is not the most efficient way to execute, as mentioned in the comments; however, if someone is having a similar issue, I wanted to explain the fix.</strong></p>\n"}], "owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 47560983, "answer_count": 1, "score": 0, "last_activity_date": 1511986248, "creation_date": 1511976141, "question_id": 47558329, "link": "https://stackoverflow.com/questions/47558329/searching-for-empty-cells-in-a-loop", "title": "Searching for Empty Cells in a Loop", "body": "<p>I'm writing a script that if any cell in column M of Sheet2 is changed to \"Special,\" the row number of that cell is copied to column B of Sheet12.  If the the row number is the largest in the column, it is added to the end.  If not, a row is copied from a template row and inserted (along with the row number) so that all the numbers in column B are sequential.</p>\n\n<p>The code for inserting/copying mid-sequence numbers works great, but it isn't working to add the largest number to the end.  I'm not getting an error; it's just not working.  Here's the code (in Sheet2):</p>\n\n<pre><code>If Target.column = 13 Then\n\n    Dim cell As Integer\n    Dim l As Long\n\n    cell = ActiveCell.Row\n\n    If ActiveCell.Value = \"Special\" Then\n        With Sheet12\n            For l = .Cells(rows.count, \"B\").End(xlUp).Row To 3 Step -1\n                If .Cells(l, 2).Value = vbNullString And .Cells(l - 1, 2).Value &lt; cell Then\n                    Sheet12.Cells(l, 2).Value = cell\n                ElseIf .Cells(l, 2).Value &gt; cell And .Cells(l - 1, 2).Value &lt; cell Then\n                    Sheet12.Cells(l, 2).EntireRow.Insert shift:=xlDown\n                    Sheet12.Range(\"A3\").EntireRow.Copy Sheet12.Cells(l, 2).EntireRow\n                    Sheet12.Cells(l, 2).Value = cell\n                End If\n            Next\n        End With\n    End If\nEnd If\n</code></pre>\n\n<p>The portion of the code that needs to be changed is <code>If .Cells(l, 2).Value = vbNullString And .Cells(l - 1, 2).Value &lt; cell Then</code>. I've tried different ways of checking for an empty cell (i.e. isempty(), using \"\", etc.) and referencing the cells differently, with sheet names.  Any ideas? Thanks in advance for your help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 2, "creation_date": 1511978347, "post_id": 47558313, "comment_id": 82075600, "body": "Yes, it&#39;s possible, ya better get started!  :)  Stack Overflow isn&#39;t a &quot;free spreadsheet design service&quot; (although I&#39;m starting to wonder where some people get that idea from)... If you want to learn to work with Excel do some searches on Google for Beginner&#39;s Excel Tutorials and take it from there.  What you&#39;re describing there is very-basic stuff, and is a great place to start.  Check out the <a href=\"https://stackoverflow.com/tour\">tour</a> as well as [how to ask] and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  If you have any <i>specific</i> questions with an issue you tried to solve but can&#39;t, that&#39;s more what this site is for..."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1511979805, "post_id": 47558313, "comment_id": 82076345, "body": "This is a very common question, you will find tens of this questions on Stack Overflow, just search and you will find very similar solutions"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9027042"}, "edited": false, "score": 0, "creation_date": 1511983134, "post_id": 47558313, "comment_id": 82078039, "body": "ok, sorry. I searched so I must have not done a very good job with the search. Thank you both."}], "answers": [{"tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 0, "last_activity_date": 1511985513, "creation_date": 1511985513, "answer_id": 47560780, "question_id": 47558313, "link": "https://stackoverflow.com/questions/47558313/excel-create-master-list-from-worksheets/47560780#47560780", "title": "Excel: Create master list from worksheets", "body": "<p>You can find two approaches from me at <a href=\"https://stackoverflow.com/questions/47277206/combine-multiple-tables-rows-into-master-table\">Combine Multiple Tables Rows Into Master Table</a></p>\n\n<p>One of those uses VBA, the other uses PowerQuery (Excel 2010, 2013) aka \"Get &amp; Transform\" (Excel 2016).</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9027042"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 543, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511985513, "creation_date": 1511976083, "question_id": 47558313, "link": "https://stackoverflow.com/questions/47558313/excel-create-master-list-from-worksheets", "title": "Excel: Create master list from worksheets", "body": "<p>I have a need to create a master list in excel from various lists on other worksheets. The sizes, colors, other attributes will change so this will need to be done on occasion. The example data is:</p>\n\n<p>Worksheet 1 \"Products\" contains:\nProduct Name\nProduct A\nProduct B\nProduct C\nProduct D</p>\n\n<p>Worksheet 2 \"Colors\" contains:\nProduct Color\nRed\nBlue\nOrange\nYellow\nGreen</p>\n\n<p>Worksheet 3 \"Sizes\" contains:\nProduct Size\nX-Small\nSmall\nMedium\nLarge\nX-Large</p>\n\n<p>I need the completed list to look like:</p>\n\n<p>\u2022   Product A   Red X-Small</p>\n\n<p>\u2022   Product A   Red Small</p>\n\n<p>\u2022   Product A   Red Medium</p>\n\n<p>\u2022   Product A   Red Large</p>\n\n<p>\u2022   Product A   Red X-Large</p>\n\n<p>\u2022   Product A   Blue    X-Small</p>\n\n<p>\u2022   Product A   Blue    Small</p>\n\n<p>\u2022   Product A   Blue    Medium</p>\n\n<p>\u2022   Product A   Blue    Large</p>\n\n<p>\u2022   Product A   Blue    X-Large</p>\n\n<p>\u2022   Product A   Orange  X-Small</p>\n\n<p>\u2022   Product A   Orange  Small</p>\n\n<p>\u2022   Product A   Orange  Medium</p>\n\n<p>\u2022   Product A   Orange  Large</p>\n\n<p>\u2022   Product A   Orange  X-Large</p>\n\n<p>\u2022   Product A   Yellow  X-Small</p>\n\n<p>\u2022   Product A   Yellow  Small</p>\n\n<p>\u2022   Product A   Yellow  Medium</p>\n\n<p>\u2022   Product A   Yellow  Large</p>\n\n<p>\u2022   Product A   Yellow  X-Large</p>\n\n<p>\u2022   Product A   Green   X-Small</p>\n\n<p>\u2022   Product A   Green   Small</p>\n\n<p>\u2022   Product A   Green   Medium</p>\n\n<p>\u2022   Product A   Green   Large</p>\n\n<p>\u2022   Product A   Green   X-Large</p>\n\n<p>\u2022   Product B   Red X-Small</p>\n\n<p>\u2022   Product B   Red Small</p>\n\n<p>\u2022   Product B   Red Medium</p>\n\n<p>\u2022   Product B   Red Large</p>\n\n<p>\u2022   ...</p>\n\n<p>\u2022   Product D   Green   Medium</p>\n\n<p>\u2022   Product D   Green   Large</p>\n\n<p>\u2022   Product D   Green   X-Large</p>\n\n<p>Is this possible? Thank you very much in advance!</p>\n"}, {"tags": ["arrays", "vba", "excel", "optimization"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1511976810, "post_id": 47558308, "comment_id": 82074659, "body": "Yes assign the range to an array and then loop through each item in that."}, {"owner": {"reputation": 1, "user_id": 9026913, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1Mt5ing1vXk/AAAAAAAAAAI/AAAAAAAADfA/0wiB-inHjb0/photo.jpg?sz=128", "display_name": "DanTheMan", "link": "https://stackoverflow.com/users/9026913/dantheman"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511978233, "post_id": 47558308, "comment_id": 82075509, "body": "So I adjusted it like so:  <code>i = 0 r = 0 For Each test In data   r = r + 1   If test = CheckValue Then     working1() = Split(lookupRange.Cells(r, 1), &quot;, &quot;)</code> That helped a LOT. Do you see anything else that could be made faster?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511978491, "post_id": 47558308, "comment_id": 82075699, "body": "I meant transfer <code>lookupRange</code> to an array. Every interaction with the worksheet slows things down. If you get stuck, I will post come code later if I get a chance, but there should be plenty of examples online. You only write the results back to the sheet right at the end."}, {"owner": {"reputation": 1, "user_id": 9026913, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1Mt5ing1vXk/AAAAAAAAAAI/AAAAAAAADfA/0wiB-inHjb0/photo.jpg?sz=128", "display_name": "DanTheMan", "link": "https://stackoverflow.com/users/9026913/dantheman"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511982174, "post_id": 47558308, "comment_id": 82077526, "body": "So I updated the code (see original post), and I didn&#39;t see much of a difference in speed. Any other suggestions? To be clear, thank you for the original suggestion, that was huge. Just looking for even more speed now. :) I also used .Value2 instead of .Value as a different post said its faster."}], "answers": [{"comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1511980151, "post_id": 47559134, "comment_id": 82076536, "body": "it is really a good article, but it does not provide an answer to the question. I would have put this in the comments section."}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1511981532, "post_id": 47559134, "comment_id": 82077183, "body": "Not sure why it does not answer the question: the OP wants to speed up the search - the answer is to use variant arrays and the article gives an example of working code to do that. Are you expecting me to rewrite his code for him?"}], "tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1511978975, "creation_date": 1511978975, "answer_id": 47559134, "question_id": 47558308, "link": "https://stackoverflow.com/questions/47558308/find-string-within-an-array-optimization-for-excel-vba/47559134#47559134", "title": "Find string within an array optimization for excel vba", "body": "<p>Using Range.Find is very slow.</p>\n\n<p>Its much faster to use  variant arrays. See my <a href=\"https://fastexcel.wordpress.com/2011/10/26/match-vs-find-vs-variant-array-vba-performance-shootout/\" rel=\"nofollow noreferrer\">Match vs Find vs Variant Array</a></p>\n"}], "owner": {"reputation": 1, "user_id": 9026913, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1Mt5ing1vXk/AAAAAAAAAAI/AAAAAAAADfA/0wiB-inHjb0/photo.jpg?sz=128", "display_name": "DanTheMan", "link": "https://stackoverflow.com/users/9026913/dantheman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 334, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511982104, "creation_date": 1511976059, "last_edit_date": 1511982104, "question_id": 47558308, "link": "https://stackoverflow.com/questions/47558308/find-string-within-an-array-optimization-for-excel-vba", "title": "Find string within an array optimization for excel vba", "body": "<p>I have a piece of code that works for what I need. However, it runs too slow. Through research I found that the \"slowness\" is coming from constantly accessing the workbook and if I could do the operations from an array it should significantly improve performance speed. I haven't been able to find anything to specifically help me through this. So here is what I got.</p>\n\n<p>My code searches for a string (xlpart) within a cell which will have multiple data entries separated by commas. It'll find that instance and all other instances (and their position within the comma delimited string) and then recombine them into a new string that is comma delimited.</p>\n\n<p>So like I said, this works, but when I apply it to 4000 rows it crushes the CPU. I even tried adding in some 'speeding up' ideas I found like .Calculation and .Screenupdating. The problem I see is in the \"Set test =\" line. Is there a way to search through an array, find instances of a string, and extract specific information out? Or am I doing this all wrong?</p>\n\n<pre><code>Function FindRef(lookupValue As Range, lookupRange As Range, resultsRange As Range) As String\nApplication.Calculation = xlCalculationManual\nApplication.ScreenUpdating = False\n\nDim OutputName1 As String\nDim OutputName2 As String\nDim r As Long\nDim test As Range\nDim working1() As String\nDim working2() As String\n\ni = 0\nFor r = 1 To lookupRange.Rows.Count\n  Set test = lookupRange.Cells(r, 1).Find(lookupValue.Value, LookIn:=xlValues, lookat:=xlPart)\n  If Not test Is Nothing Then\n    working1() = Split(lookupRange.Cells(r, 1), \", \")\n    For j = LBound(working1) To UBound(working1)\n      If working1(j) = CheckValue Then\n        working2() = Split(resultsRange.Cells(r, 1), \", \")\n        If UBound(working2) &gt; 0 Then\n          OutputName1 = working2(j)\n        Else\n          OutputName1 = resultsRange.Cells(r, 1)\n        End If\n      End If\n    i = i + 1\n    If i = 1 Then\n      OutputName2 = OutputName1\n    Else\n      OutputName2 = OutputName2 &amp; \", \" &amp; OutputName1\n    End If\n    OutputName1 = \"\"\n    Next j\n  End If\nNext\nFindRef = OutputName2\n\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\nEnd Function\n</code></pre>\n\n<p>Updated code:</p>\n\n<pre><code>Function FindRef(lookupValue As Range, lookupRange As Range, resultsRange As Range) As String\n\nApplication.Calculation = xlCalculationManual\nApplication.ScreenUpdating = False\n\nDim OutputName1 As String\nDim OutputName2 As String\nDim r As Long\nDim test As Variant\nDim working1() As String\nDim working2() As String\nDim CheckValue As String\nDim data() As Variant\nDim data2() As Variant\n\nCheckValue = lookupValue.Value2\ndata = lookupRange.Value2\ndata2 = resultsRange.Value2\n\ni = 0\nr = 0\nFor Each test In data\n  r = r + 1\n  If test = CheckValue Then\n    working1() = Split(data(r, 1), \", \")\n    For j = LBound(working1) To UBound(working1)\n      If working1(j) = CheckValue Then\n        working2() = Split(data2(r, 1), \", \")\n        If UBound(working2) &gt; 0 Then\n          OutputName1 = working2(j)\n        Else\n          OutputName1 = data2(r, 1)\n        End If\n      End If\n    i = i + 1\n    If i = 1 Then\n      OutputName2 = OutputName1\n    Else\n      OutputName2 = OutputName2 &amp; \", \" &amp; OutputName1\n    End If\n    OutputName1 = \"\"\n    Next j\n  End If\nNext\nFindRef = OutputName2\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "variables", "excel-formula", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511975511, "post_id": 47558044, "comment_id": 82073932, "body": "Step through your code and check the value of GPR."}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1511975565, "post_id": 47558044, "comment_id": 82073961, "body": "Try adding <code>Debug.Print GPR</code> and see what the immediate window is displaying as a result"}, {"owner": {"reputation": 3, "user_id": 9026904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b2370e547c8884dd83b4890e0dbd7a1?s=128&d=identicon&r=PG&f=1", "display_name": "D.Mascari", "link": "https://stackoverflow.com/users/9026904/d-mascari"}, "edited": false, "score": 0, "creation_date": 1511975697, "post_id": 47558044, "comment_id": 82074045, "body": "The value of GPR is &quot;=IF(AND(COM_GPR_ACT&lt;&gt;0,OR([@[Vacancy Assumption]]+COM_OCC_ACT&lt;=100%,IFERROR(((COM_VAC_RPTD/COM_GP&zwnj;&#8203;R_RPTD)&gt;[@[Vacancy Assumption]]),FALSE))),0,(COM_RENTS_ACT*COM_NRSF-COM_GPR_ACT&zwnj;&#8203;))&quot; Which in this particular case evaluates to (4,990,716.93).  I want to return the formula in Range(&quot;E6&quot;) and not the value."}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1511975924, "post_id": 47558044, "comment_id": 82074168, "body": "You are declaring <code>Dim GPR As String</code> but looks like you&#39;re trying to set it as an object? <code>.Formula</code> why?"}, {"owner": {"reputation": 3, "user_id": 9026904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b2370e547c8884dd83b4890e0dbd7a1?s=128&d=identicon&r=PG&f=1", "display_name": "D.Mascari", "link": "https://stackoverflow.com/users/9026904/d-mascari"}, "edited": false, "score": 0, "creation_date": 1511976046, "post_id": 47558044, "comment_id": 82074239, "body": "Because [ ].Value gives me (4,990,716.93) and [ ] gives me that as well.  I&#39;m trying to pass the original formula through to the cell."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511976099, "post_id": 47558044, "comment_id": 82074272, "body": "Are <code>COM_GPR_ACT</code> etc named ranges?"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 1, "creation_date": 1511976405, "post_id": 47558044, "comment_id": 82074441, "body": "That still doesn&#39;t make sense... You&#39;re declaring GPR as a string with <code>Dim GPR As String</code> and then the next line you&#39;re trying to set it as an object... but that still doesn&#39;t explain the error that you&#39;re getting. I think there&#39;s more code to this that you should be showing us. Are you sure that&#39;s the line that is receiving this error? According to my tests you should be getting <b>Object required</b>"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1511976570, "post_id": 47558044, "comment_id": 82074528, "body": "Square brackets actually mean Application.Evaluate, so you&#39;re getting a calculation with that string.  See my answer below."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1511976574, "post_id": 47558044, "comment_id": 82074531, "body": "@Maldred - he&#39;s assigning the string to the Formula property of E6. Think that&#39;s ok if it&#39;s a valid formula string."}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1511976701, "post_id": 47558044, "comment_id": 82074599, "body": "Still doesn&#39;t explain the <code>.Formula</code> at the end of that line, that&#39;s still an issue isn&#39;t it? Since that needs to be an object of <code>Range()</code>"}, {"owner": {"reputation": 3, "user_id": 9026904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b2370e547c8884dd83b4890e0dbd7a1?s=128&d=identicon&r=PG&f=1", "display_name": "D.Mascari", "link": "https://stackoverflow.com/users/9026904/d-mascari"}, "edited": false, "score": 0, "creation_date": 1511977124, "post_id": 47558044, "comment_id": 82074837, "body": "Yes, all the values in the formulas are named table values.  I was using Application.Evaluate because I was trying to get rid of the Index/Match formula in the cell and pull the formula from the table into that cell.  Like I said, I&#39;m at a loss.  Normally when using this method I do want the final value but I&#39;m trying to show the formula instead."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1511977665, "post_id": 47558044, "comment_id": 82075166, "body": "@Maldred - ok I had missed that Formula on the end. So the first bit must return a cell reference which contains a formula for this to work."}], "answers": [{"tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 1, "last_activity_date": 1511978175, "last_edit_date": 1511978175, "creation_date": 1511976211, "answer_id": 47558357, "question_id": 47558044, "link": "https://stackoverflow.com/questions/47558044/declare-formula-as-variable-in-vba-2010/47558357#47558357", "title": "Declare Formula as Variable in vba 2010", "body": "<p>Ok, quite funky requirement there.  One approach is to do the following.</p>\n\n<ol>\n<li>Go to Menu and take File->Options, then select the Formulas tab.</li>\n<li>Check the checkbox for R1C1 reference style and click OK to dimiss dialog.</li>\n<li>On the sheet select Name Manager from the Formula ribbon.</li>\n<li>In the name manager define a name called \"ToMyLeft\" and in the Refers to box enter =Sheet1!RC[-1]</li>\n</ol>\n\n<p>Now you have defined a relative name which always points to a cell to the left of the one in which is is used!  Quit funky.  Take some time for that to sink in.</p>\n\n<p>Now you can write formulae like this</p>\n\n<pre><code>=ADDRESS(ROW(ToMyLeft),COLUMN(ToMyLeft))\n</code></pre>\n\n<p>and this will give the address of the cell to the left which is a cell address.  So this returns $F$6 when executed in the cell F7.  This should give you a hook to the ultimate formula's home.  You will still need some VBA function to execute it though such like.</p>\n\n<pre><code>Option Explicit\n\nFunction FunkyIndirectFunctionEval(ByVal sCellAddress As String)\n\n    Dim ws As Excel.Worksheet\n    Set ws = ActiveSheet '&lt;--- if you workbook spans several sheets you'll need to handle the sheets, second param?\n\n\n    Dim rng As Excel.Range\n    Set rng = ws.Range(sCellAddress)\n\n    Dim vEval As Variant\n    FunkyIndirectFunctionEval = Application.Evaluate(rng.Formula)\n\nEnd Function\n</code></pre>\n\n<p>But this will have formula context problems because one is stripping out the formula from its context.  I have not tried this, I'd say chance of success 25%!</p>\n\n<p>Don't forget to change back the RC reference to A1 reference in the Options dialog.</p>\n"}, {"tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1511981298, "creation_date": 1511981298, "answer_id": 47559705, "question_id": 47558044, "link": "https://stackoverflow.com/questions/47558044/declare-formula-as-variable-in-vba-2010/47559705#47559705", "title": "Declare Formula as Variable in vba 2010", "body": "<p>This should work if it is a valid formula in cell E6, so I suspect there is a problem with the formula.</p>\n\n<p>Probably the error is that you are using unqualified structured table references like [@[Vacancy Instruction]] - try prefixing them with the table name.</p>\n"}], "owner": {"reputation": 3, "user_id": 9026904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b2370e547c8884dd83b4890e0dbd7a1?s=128&d=identicon&r=PG&f=1", "display_name": "D.Mascari", "link": "https://stackoverflow.com/users/9026904/d-mascari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1714, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1511981298, "creation_date": 1511975085, "last_edit_date": 1531161705, "question_id": 47558044, "link": "https://stackoverflow.com/questions/47558044/declare-formula-as-variable-in-vba-2010", "title": "Declare Formula as Variable in vba 2010", "body": "<p>I have been racking my brain for 2 days on why I can't get this to work so after years of searching threads, I'm posting my first question.</p>\n\n<p>I have formulas stored in a table in a workbook.  The table is named Adjustments.  On another worksheet in the same workbook, I'm looking up the formulas based on loan numbers.  Before I copy the worksheet and save it as a separate document I want to replace the lookup formula with the formula it looks up and leave as an active formula instead of just the value it evaluates to.    </p>\n\n<p>The lookup formula currently in cell E6 is:\n=(INDEX(Adjustments,MATCH(Loan_No,Adjustments[Loan No],0),COLUMN(Adjustments[GPR Adj])))</p>\n\n<p>The formula that is referencing is:</p>\n\n<p>=IF(AND(COM_GPR_ACT&lt;>0,OR([@[Vacancy Assumption]]+COM_OCC_ACT&lt;=100%,IFERROR(((COM_VAC_RPTD/COM_GPR_RPTD)>[@[Vacancy Assumption]]),FALSE))),0,(COM_RENTS_ACT*COM_NRSF-COM_GPR_ACT))</p>\n\n<p>I want to replace the Index/Match formula with the formula in the cell that it is looking up.</p>\n\n<p>Here is the code that I was trying to use.</p>\n\n<pre><code>Dim GPR As String\nGPR = [INDEX(Adjustments,MATCH(Loan_No,Adjustments[Loan No],0),COLUMN(Adjustments[GPR Adj]))].Formula\nRange(\"E6\").Formula = GPR\n</code></pre>\n\n<p>When I use this I get a Run-Time Error '1004': Application-defined or object defined error.</p>\n\n<p>I have tried changing the evaluate application to .Value but that gives me the final value of both formulas.  It also seems that if I had Excel 2013 I could use [FormulaText(GPR)].</p>\n\n<p>I am trying to avoid doing a copy and pasteformulas because there are about 25 cells that I want to replace and I don't want to slow down the macro since this is only one of several subs that run.  It seems like it should be a simple answer, but I have yet to stumble upon it.  Any help is appreciated!</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013", "recordset"], "owner": {"reputation": 11, "user_id": 7674330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/503fd117790c71b87e54c4e23a6c4b11?s=128&d=identicon&r=PG&f=1", "display_name": "Tona", "link": "https://stackoverflow.com/users/7674330/tona"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 642, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1594638744, "creation_date": 1511975084, "last_edit_date": 1594638744, "question_id": 47558043, "link": "https://stackoverflow.com/questions/47558043/ms-access-2013-vba-to-scan-an-attach-file-to-an-attachment-field-vba-wont-save", "title": "Ms access 2013 vba to scan an attach file to an attachment field. vba won&#39;t save record", "body": "<p>In access 2013, I'm using a form (called \"Table1\") linked to a table that has an attachment field that I'm adding a scanned document (bmp) to.  There are two textboxes that I use to name the scanned document on the form. Everything works if I input the record then hit save and then click my button (called testButton), but if I don't hit save, the attachment saves to the last record or a few records back. I'm pretty sure it's a saving issue, because when I try to scan and attach after the computer has been dormant, it works just fine, I'm guessing autosave. However, if I'm trying to scan multiple records back to back, the attachment goes to the previous record if I don't hit save on the ribbon. I've tried placing </p>\n\n<pre><code>DoCmd.Save acForm, \"Table1\" \n</code></pre>\n\n<p>or </p>\n\n<pre><code>If Me.Dirty Then\nMe.Dirty = False\n\n   MsgBox (\"File Saved\")\n\n   End If\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>DoCmd.RunCommand acCmdSaveRecord\n</code></pre>\n\n<p>at different points in the code to no avail. The DoCmd functions save the record, but start the recordset at the first record, not the one I'm currently inputting. So instead of attaching to the second to last record, it attaches to the first record.</p>\n\n<p>My goal is to be able to hit the button and it work perfectly without having to hit save. I even looked for a code that does exactly what the save button on the ribbon does to no avail.</p>\n\n<p>Here is the current code I'm using.</p>\n\n<pre><code>Option Compare Database\nDim FileLocation As String\nDim diagFile As FileDialog\n\n\n\n\n\n\nPrivate Sub testButton_Click()\n\n'DoCmd.Save acForm, \"Table1\" (Commented out, because it's not working)\n\nDim db As DAO.Database\nDim rsParent As DAO.Recordset2\nDim rsChild As DAO.Recordset2\n\nIf Me.Dirty Then\n\n  Me.Dirty = False\n\n   MsgBox (\"File Saved\")\n\n   End If\n\nMe.testBox = Me.Payment &amp; Me.Merchant ' I use this to see the input on screen\n\n\n\nScanImage\n\nAttachImage\n\n\n\nEnd Sub\n\nPrivate Sub ScanImage()\n\n'This method works, it's the AttachImage that's causing issues.\n\n   Set diagFile = Application.FileDialog(msoFileDialogSaveAs)\n\n   diagFile.Title = \"Save Bitmap File As...\"\n   diagFile.InitialFileName = Me.Payment &amp; \" \" &amp; Me.Merchant &amp; \".bmp\"\n\n   diagFile.Show\n    FileLocation = diagFile.SelectedItems(1)\n\n   Dim scanDiag As New WIA.CommonDialog\n   Dim image As WIA.ImageFile\n\n   Set image = scanDiag.ShowAcquireImage(ScannerDeviceType)\n   image.SaveFile FileLocation\n\n\n\n   MsgBox (\"File Saved\")\n'   MsgBox (CurrentRecord) I used this to see on screen the record I'm inputing\n\n\n\nEnd Sub\n\n Private Sub AttachImage()\n\n\n\n MsgBox (\"Step 1 attaching\") ' I use this and all the MsgBoxes to see where in the code the procedure is.\n\n\n\n\n 'MsgBox (\"Step 2 attaching\")\n\nOn Error GoTo Err_AddImage\nSet db = CurrentDb\nSet rsParent = Me.Recordset\n\nrsParent.Edit\n\nSet rsChild = rsParent.Fields(\"Receipt\").Value\n\n'MsgBox \"Nombre el archivo: \" &amp; rsChild(\"FileName\").Value\n'MsgBox \"Tipo de archivo: \" &amp; rsChild.Fields(\"FileType\").Value\n'MsgBox \"Data del archivo: \" &amp; rsChild.Fields(\"FileData\").Value\n'Do Until rsChild.EOF\n'        For Each fld In rsChild.Fields\n'          Debug.Print fld\n'        Next fld\n'  rsChild.MoveNext\n'  Loop\n\n 'MsgBox (\"Step 3 attaching\")\n\n\nrsChild.AddNew\nrsChild.Fields(\"FileData\").LoadFromFile (\"C:\\Users\\omoawotona\\Desktop\\Receipt Clone\\\" &amp; Me.Payment &amp; \" \" &amp; Me.Merchant &amp; \".bmp\")\n\nrsChild.Update\nrsParent.Update\n\n'MsgBox (\"Step 4 attaching\")\n\n\n\nMe.Refresh\n'MsgBox (\"Step 5 attaching\")\n'MsgBox (\"Attachment done\")\n\nExit_AddImage:\n\nSet rsChild = Nothing\nSet rsParent = Nothing\nExit Sub\n\nErr_AddImage:\n\nIf Err = 3820 Then\nMsgBox (\"File already part of the multi-valued field!\")\nMe.Refresh\nResume Next\n\nElse\nMsgBox \"Some Other Error occured!\", Err.Number, Err.Description\nResume Exit_AddImage\n\nEnd If\n\n\n\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1524450437, "post_id": 47557913, "comment_id": 86961217, "body": "(Don&#39;t forget to <b><code>\u2713 Accept</code></b> an answer that helped solve your problem\u2026 You&#39;ll get <b><code>+2</code></b> repuation, and the answer&#39;s author gets <b><code>+15</code></b> rep.  Once <i>you</i> reach 15 reputation, you can <i>also</i> <b><code>\u25b2 Upvote</code></b> any answers that are helpful, which also rewards the authors <b>and</b> <i>benefits the Stack Overflow community as a whole!)</i>"}], "answers": [{"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 1, "last_activity_date": 1511976058, "creation_date": 1511976058, "answer_id": 47558307, "question_id": 47557913, "link": "https://stackoverflow.com/questions/47557913/macros-formatting-worksheet-as-xlsm-instead-of-pdf/47558307#47558307", "title": "Macros formatting worksheet as xlsm instead of pdf", "body": "<p>Nice try.  :)   but...</p>\n\n<pre><code>Application.Dialogs(xlDialogSendMail).Show\n</code></pre>\n\n<p>...is the VBA equivalent of clicking <code>File</code> \u2192 <code>Send</code> (or <code>Share</code> in some versions), which opens an e-mail message in Microsoft Outlook <strong>with the current workbook attached.</strong>  </p>\n\n<p>You have 2 lines of code there. The first line exports the Active Workbook to a PDF file located at <code>C:\\Users\\ROANDE~1\\AppData\\Local\\Temp\\Purchase Order Turkey MASTER Version 2.pdf</code>.</p>\n\n<p>That is unrelated to the next line (a hint being a fact that the 2nd line doesn't mention a filename, variable, etc.). </p>\n\n<p>I'm always been a fan of the beginner technique of recording a macro doing what you want VBA to do, and then adjust as required, but some things do get missed (or ignored) by the Macro Recorder, probably like in this case.</p>\n\n<p>1st, can you please confirm that the PDF exists (at the path above) and has the correct data that you want to email?  Also which version of Excel are you using?  (next time add the tag for your version when posting your question, like <a href=\"/questions/tagged/excel-2016\" class=\"post-tag\" title=\"show questions tagged &#39;excel-2016&#39;\" rel=\"tag\">excel-2016</a> etc.)</p>\n\n<p>After that's steps verified working, we can move on to emailing the PDF...</p>\n"}], "owner": {"reputation": 41, "user_id": 7115229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c738c1891631fac8ef1ea768e427460?s=128&d=identicon&r=PG&f=1", "display_name": "Ross Anderson", "link": "https://stackoverflow.com/users/7115229/ross-anderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 47558307, "answer_count": 1, "score": 0, "last_activity_date": 1512110753, "creation_date": 1511974555, "last_edit_date": 1531164843, "question_id": 47557913, "link": "https://stackoverflow.com/questions/47557913/macros-formatting-worksheet-as-xlsm-instead-of-pdf", "title": "Macros formatting worksheet as xlsm instead of pdf", "body": "<p>I have created a macro that once a button is clicked on a worksheet a new Outlook email is generated with the worksheet as an attachment.</p>\n\n<p>When recording the macro and then looking at the format in the code it is saying pdf. When I trial the button the attachment is formatted as a xlsm.</p>\n\n<pre><code>Sub email()\n    ActiveWorkbook.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n        \"C:\\Users\\ROANDE~1\\AppData\\Local\\Temp\\Purchase Order Turkey MASTER Version 2.pdf\" _\n        , Quality:=xlQualityStandard, IncludeDocProperties:=False, _\n        IgnorePrintAreas:=False, OpenAfterPublish:=False\n    Application.Dialogs(xlDialogSendMail).Show\nEnd Sub\n</code></pre>\n\n<p>I'm completely new to VBA.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1511974089, "post_id": 47557752, "comment_id": 82073041, "body": "E.g. <code>temp=Freq(1,1).Value2</code> or <code>temp=Freq.Cells(1,2).Value2</code>."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511974421, "post_id": 47557752, "comment_id": 82073259, "body": "Btw your &quot;original&quot; range need not be the appropriate size, eg <code>MsgBox Range(&quot;A1&quot;)(1, 2).Address</code> returns <code>B1</code>."}, {"owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511974454, "post_id": 47557752, "comment_id": 82073288, "body": "@SJR <code>.Value</code> would suffice, fam"}, {"owner": {"reputation": 35, "user_id": 5070337, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153422446792171/picture?type=large", "display_name": "HotFuzz", "link": "https://stackoverflow.com/users/5070337/hotfuzz"}, "edited": false, "score": 1, "creation_date": 1511974501, "post_id": 47557752, "comment_id": 82073321, "body": "Welp, fixes my problem quite easily, thank you for your quick reply"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1511974513, "post_id": 47557752, "comment_id": 82073329, "body": "Or <code>tmp = Freq.Value()(1,1)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 1, "last_activity_date": 1511975394, "creation_date": 1511975394, "answer_id": 47558127, "question_id": 47557752, "link": "https://stackoverflow.com/questions/47557752/how-do-you-access-a-specific-value-for-a-range-object-in-vba/47558127#47558127", "title": "How do you access a specific value for a Range object in VBA?", "body": "<p><code>Range.Value</code> takes one optional argument, so <code>Freq.Value(1,1)</code> is just not correct syntax. </p>\n\n<p>To omit optional argument, you do `Freq.Value()(1,1) per Rory. </p>\n\n<p>Alternatively, cast your <code>Freq.Value</code> to a variant array:</p>\n\n<pre><code>Dim myArray as Variant\nmyArray = Freq.Value\nMsgBox myArray(1,1)\n</code></pre>\n\n<p>The <code>ExcelRangeValueType</code> is given as below, and when omitted will use the default parameter value:</p>\n\n<pre><code>xlRangeValueDefault         10  Default. If the specified Range object is \n                                empty, returns the value Empty (use the \n                                IsEmpty function to test for this case). If \n                                the Range object contains more than one cell, \n                                returns an array of values (use the IsArray \n                                function to test for this case).\nxlRangeValueMSPersistXML    12  Returns the recordset representation of the \n                                specified Range object in an XML format.\nxlRangeValueXMLSpreadsheet  11  Returns the values, formatting, formulas, \n                                and names of the specified Range object in \n                                the XML Spreadsheet format.\n</code></pre>\n\n<p>Related: <a href=\"https://fastexcel.wordpress.com/2017/03/13/excel-range-valuevaluetype-what-is-this-parameter/\" rel=\"nofollow noreferrer\">https://fastexcel.wordpress.com/2017/03/13/excel-range-valuevaluetype-what-is-this-parameter/</a></p>\n"}], "owner": {"reputation": 35, "user_id": 5070337, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153422446792171/picture?type=large", "display_name": "HotFuzz", "link": "https://stackoverflow.com/users/5070337/hotfuzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 550, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511975394, "creation_date": 1511973974, "last_edit_date": 1531161705, "question_id": 47557752, "link": "https://stackoverflow.com/questions/47557752/how-do-you-access-a-specific-value-for-a-range-object-in-vba", "title": "How do you access a specific value for a Range object in VBA?", "body": "<p>Alright,</p>\n\n<p>So here is a snippet of my code I use for statistics analysis. I need my variable \"Freq\" to be defined as a range because I use different excel formulas to speed up the code such as AVERAGE(), STEYX(), DEVSQ(), FORECAST() etc. I'm using VBA to do so because I need to iterate quickly throught a lot of data and feel limited only using Excel formulas.</p>\n\n<pre><code>dim Freq as Range\ndim sht as Worksheet\ndim n as integer\n\nn = sht.Cells(sht.Rows.Count, \"D\").End(xlUp).Row - 1\nSet sht.ThisWorkbook.ActiveSheet\nSet Freq = sht.Range(\"D\" &amp; 2 &amp; \":D\" &amp; n + 1)\n</code></pre>\n\n<p>Later in my code, i want to verify if any value in the \"Freq\" variable is above or below a certain value. I know how to do this by checking each cell in the range, or assign an array for the range, but I feel like having a second variable for the same range of data is reductant and inefficient.</p>\n\n<p>When I look at the \"Freq\" object in VBA, I see a Value2(x,1), x being any number between 1 and n, but I have not found a way to access this value yet. I tried:</p>\n\n<pre><code>tmp=Freq.Value(1)\ntmp=Freq.Value(1,1)\ntmp=Freq.Value2(1)\ntmp=Freq.Value2(1,1)\n</code></pre>\n\n<p>but none of this works.</p>\n\n<p>So, basically my question is: How do you access a specific value for a Range object in VBA?</p>\n\n<p>Any help is greatly appreciated!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1511973835, "post_id": 47557670, "comment_id": 82072865, "body": "Perhaps <code>If Not rngMain.address = &quot;$L$210:$L$217&quot;</code>. Otherwise you are trying to compare values (which won&#39;t work anyway as you have found)."}, {"owner": {"reputation": 13, "user_id": 8995625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75094260243a8484f63b18f7cd00d970?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Fiante", "link": "https://stackoverflow.com/users/8995625/tony-fiante"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511974067, "post_id": 47557670, "comment_id": 82073021, "body": "Perfect, thank you! Do you know the reason why I get &#39;Run-time error 1004&#39;: Application defined or defined object error&#39; when rngMain refers to L210:L217 in the first place?"}, {"owner": {"reputation": 594, "user_id": 1126927, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d6701ce88607ae792d291de20eabf78b?s=128&d=identicon&r=PG", "display_name": "Brownish Monster", "link": "https://stackoverflow.com/users/1126927/brownish-monster"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511974074, "post_id": 47557670, "comment_id": 82073028, "body": "@SJR You beat me to it. +1"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511974202, "post_id": 47557670, "comment_id": 82073120, "body": "Not sure but probably because you cannot compare multiple cells in that way. To compare values you have to loop through each cell."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1511974240, "post_id": 47557670, "comment_id": 82073144, "body": "What&#39;s the purpose of the dynamic range?  And what&#39;s in L210:L217 that&#39;s causing the error?  On which line(s) do you get each of those errors?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1511974637, "post_id": 47557670, "comment_id": 82073416, "body": "I&#39;m gonna take a shot in the dark here: is it a gigantic worksheet of manually entered values and lots of formulas, parts of which sometimes get accidentally or inadvertently overwritten?"}, {"owner": {"reputation": 13, "user_id": 8995625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75094260243a8484f63b18f7cd00d970?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Fiante", "link": "https://stackoverflow.com/users/8995625/tony-fiante"}, "edited": false, "score": 0, "creation_date": 1511974713, "post_id": 47557670, "comment_id": 82073461, "body": "The macro populates a range with a formula. The range it needs to insert a formula into is dependent on how many columns are filled in by the users. There is nothing in L210:L217 before the macro is run."}, {"owner": {"reputation": 13, "user_id": 8995625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75094260243a8484f63b18f7cd00d970?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Fiante", "link": "https://stackoverflow.com/users/8995625/tony-fiante"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1511974781, "post_id": 47557670, "comment_id": 82073499, "body": "@ashleedawg not exactly but the issue is similar I think"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1511976821, "post_id": 47557670, "comment_id": 82074665, "body": "Yeah I get the impression that you&#39;re trying to &quot;put out fires&quot;, as in, avoid issues  &amp; errors caused by another macro, by changing others to just work around it (probably pretty common when we&#39;re first learning to code, I was there once!)  If you don&#39;t know why it&#39;s causing that error there, then that  also implies that you don&#39;t fully understand what this one&#39;s doing either... but that can be a good thing -- it&#39;s not a lot of code, it&#39;s not too late to start fresh.  There are many different ways to do most anything in Excel and/or VBA."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1511977064, "post_id": 47557670, "comment_id": 82074801, "body": "...Your call, of course but if you were to back up a step and explain more about where and when these formulas need to be filled in like this (and why they can&#39;t be there before the manual entry) there&#39;s likely a better way to handle this.  A screen shot of what&#39;s going on (<a href=\"https://stackoverflow.com/posts/47557670/edit\">edit</a>ed onto your question) would be helpful too."}, {"owner": {"reputation": 13, "user_id": 8995625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75094260243a8484f63b18f7cd00d970?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Fiante", "link": "https://stackoverflow.com/users/8995625/tony-fiante"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1512064286, "post_id": 47557670, "comment_id": 82116389, "body": "thanks @ashleedawg. You are right I am just trying my wings with vba. I have managed to get this to work, and whilst it might not be the prettiest solution, I&#39;ll leave it as is as I have got limited time and need to move on to the next issue that needs to be resolved."}], "answers": [{"tags": [], "owner": {"reputation": 594, "user_id": 1126927, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d6701ce88607ae792d291de20eabf78b?s=128&d=identicon&r=PG", "display_name": "Brownish Monster", "link": "https://stackoverflow.com/users/1126927/brownish-monster"}, "is_accepted": false, "score": -1, "last_activity_date": 1511973949, "creation_date": 1511973949, "answer_id": 47557746, "question_id": 47557670, "link": "https://stackoverflow.com/questions/47557670/test-if-dynamic-range-refers-to-a-specific-range/47557746#47557746", "title": "Test IF dynamic range refers to a specific range", "body": "<p>I think you are comparing references there instead of values, you can try:</p>\n\n<pre><code>If Not rngMain.Address = \"$L$210:$L$217\" Then Range(\"L210:L217\").AutoFill Destination:=rngMain, Type:=xlFillDefault\n</code></pre>\n\n<p>But what if they only select a single cell inside that range or if their selection includes part of that range? If you want to, you can also check if their selection intersects with <code>L210:L217</code>:</p>\n\n<pre><code>If Intersect(rngMain,Range(\"L210:L217\")) Is Nothing Then Range(\"L210:L217\").AutoFill Destination:=rngMain, Type:=xlFillDefault\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8995625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75094260243a8484f63b18f7cd00d970?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Fiante", "link": "https://stackoverflow.com/users/8995625/tony-fiante"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1511973949, "creation_date": 1511973677, "last_edit_date": 1531164843, "question_id": 47557670, "link": "https://stackoverflow.com/questions/47557670/test-if-dynamic-range-refers-to-a-specific-range", "title": "Test IF dynamic range refers to a specific range", "body": "<p>I am running a macro which defines a dynamic range. What I am struggling with is incorporating an IF statement that tests if the dynamic range refers to a specific range. I am trying with the below but get 'Run-type error '13': Type-mismatch'. Can someone tell me what's wrong with this?</p>\n\n<pre><code>Sub TestTwo()\n\nDim colRange    As Long\nDim rowRange    As Long\nDim rngMain     As Range\n\nrowRange = 10\n\n   With Worksheets(1)\n    colRange = .Cells(10, 12).End(xlToLeft).Column\n    Set rngMain = .Range(.Cells(rowRange + 200, colRange + 1), .Cells(217, 12))\n    Range(\"L210:L217\").FormulaR1C1 = \"=+R[-60]C-R[-60]C[-1]\"\n    If Not rngMain = Range(\"L210:L217\") Then Range(\"L210:L217\").AutoFill Destination:=rngMain, Type:=xlFillDefault\n   End With\nEnd Sub\n</code></pre>\n\n<p>The reason I want to test what \"rngMain\" refers to is that in case rngMain refers to L210:L217 then I get 'Run-time error 1004': Application defined or defined object error' otherwise the code runs as it should.</p>\n\n<p>Thanks in advance for any help.</p>\n"}, {"tags": ["vba", "excel", "autocad"], "comments": [{"owner": {"reputation": 73682, "user_id": 2097240, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/JskU5.jpg?s=128&g=1", "display_name": "Daniel M&#246;ller", "link": "https://stackoverflow.com/users/2097240/daniel-m%c3%b6ller"}, "edited": false, "score": 0, "creation_date": 1512017982, "post_id": 47557651, "comment_id": 82090113, "body": "<code>Rad(0) &#47; 2</code> is this really a circle with radius = 0?"}, {"owner": {"reputation": 1022, "user_id": 5796526, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/90cyo.jpg?s=128&g=1", "display_name": "CAD Developer", "link": "https://stackoverflow.com/users/5796526/cad-developer"}, "edited": false, "score": 0, "creation_date": 1512033231, "post_id": 47557651, "comment_id": 82096625, "body": "The code seems to be OK, so what is the result You get? only circle without hatch? Any error message?"}, {"owner": {"reputation": 55, "user_id": 9015733, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8a457ae70918a1fe589725de858b3113?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/9015733/chris"}, "edited": false, "score": 0, "creation_date": 1512046157, "post_id": 47557651, "comment_id": 82104493, "body": "I get a circle without a hatch but no error messages"}, {"owner": {"reputation": 55, "user_id": 9015733, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8a457ae70918a1fe589725de858b3113?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/9015733/chris"}, "edited": false, "score": 0, "creation_date": 1512046956, "post_id": 47557651, "comment_id": 82104993, "body": "Rad(0) is an array that I actually appended all my diameters to so the code loops through and each value in the Rad array and divides it by 2 to get the radius instead of the diameter"}, {"owner": {"reputation": 1022, "user_id": 5796526, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/90cyo.jpg?s=128&g=1", "display_name": "CAD Developer", "link": "https://stackoverflow.com/users/5796526/cad-developer"}, "edited": false, "score": 0, "creation_date": 1512112693, "post_id": 47557651, "comment_id": 82133973, "body": "So try to draw the same on modelspace instead of block. Then by select all check (in properties window, if You have 2 or 3 entities selected) Maybe there is the hatch, but invisible. I&#39;m not sure but as I remember in some shademode hatch with pattern &quot;SOLID&quot; is not displayed."}], "answers": [{"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1517766701, "creation_date": 1517766701, "answer_id": 48611221, "question_id": 47557651, "link": "https://stackoverflow.com/questions/47557651/autocad-vba-creating-blocks-with-a-hatch/48611221#48611221", "title": "AutoCAD VBA - Creating Blocks with a Hatch", "body": "<p>there are two faults</p>\n\n<p>1) a <code>Set</code> keyword is missing in <code>hatchObj = blockObj.AddHatch(0, \"Solid\", True)</code></p>\n\n<p>2) the <code>AppendOuterLoop</code> method requires and <em>array of objects</em> for the <code>loop</code> parameter</p>\n\n<p>so the hatch section should be like:</p>\n\n<pre><code>Dim outerLoop(0 To 0) As AcadEntity ' declare the array of objects\nSet outerLoop(0) = blockObj.AddCircle(Center, 10#) ' fill it with a circle object\n'Add hatch to the block\nSet hatchObj = blockObj.AddHatch(0, \"Solid\", True) '\nhatchObj.AppendOuterLoop (outerLoop) 'append the outerloop\nhatchObj.Evaluate\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 9015733, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8a457ae70918a1fe589725de858b3113?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/9015733/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1087, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1517766701, "creation_date": 1511973611, "last_edit_date": 1531164843, "question_id": 47557651, "link": "https://stackoverflow.com/questions/47557651/autocad-vba-creating-blocks-with-a-hatch", "title": "AutoCAD VBA - Creating Blocks with a Hatch", "body": "<p>I am trying to make blocks in AutoCAD that have a circle, number, and solid hatch but I can't seem to get the hatch to work? I'm not sure what I'm doing wrong - any help would be great!      </p>\n\n<pre><code>    ' Create the block\n    insertionPnt(0) = Sheet1.Cells(n, 3)\n    insertionPnt(1) = Sheet1.Cells(n, 4)\n    insertionPnt(2) = 0\n    Set blockObj = ACAD.ActiveDocument.Blocks.Add(insertionPnt, namestr)\n\n\n    'Add the circle to the block\n    center(0) = Sheet1.Cells(n, 3)\n    center(1) = Sheet1.Cells(n, 4)\n    center(2) = 0\n    Set circleObj = blockObj.AddCircle(center, Rad(0) / 2)\n\n    'Add hatch to the block\n    hatchObj = blockObj.AddHatch(0, \"Solid\", True)\n    hatchObj.AppendOuterLoop (circleObj)\n    hatchObj.Evaluate\n\n    'Add text to the block\n    Set blocktext = blockObj.AddText(Nums(0), Coords, 0.5)\n    blocktext.Alignment = acAlignmentMiddleCenter\n    blocktext.TextAlignmentPoint = Coords\n\n    'Insert the block\n    insertionPnt(0) = Sheet1.Cells(n, 3)\n    insertionPnt(1) = Sheet1.Cells(n, 4)\n    Set blockRefObj = ACAD.ActiveDocument.ModelSpace.InsertBlock(insertionPnt, namestr, 1#, 1#, 1#, 0)\n</code></pre>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511973687, "post_id": 47557593, "comment_id": 82072770, "body": "Do you assign a value to <code>fila</code>?"}, {"owner": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511973881, "post_id": 47557593, "comment_id": 82072892, "body": "every value has been assigned correctly, I ran the macro step-by-step and fila has the value I want. The problem is that when I copy the table, I get the 0 on the A &amp; fila (122) cell."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511973966, "post_id": 47557593, "comment_id": 82072949, "body": "Comment out <code>On Error Resume Next</code> and see if there is an error."}, {"owner": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511974401, "post_id": 47557593, "comment_id": 82073244, "body": "Did it, the exact message error is &quot;Error in the Range method of the Worksheet object&quot; (traducted from spanish)."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511974606, "post_id": 47557593, "comment_id": 82073392, "body": "I&#39;m not hopeful but does this make it go away? <code>Set rng = errprov.Range(&quot;A7&quot;, errprov.Range(&quot;A7&quot;).End(xlToRight).End(xlDown))</code> Are there formulas in the cells you are copying?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511974774, "post_id": 47557593, "comment_id": 82073496, "body": "Bit odd that people feel the need to remove the OP expressing gratitude for any help forthcoming. I rejected the edit - presumably somebody else thought differently."}, {"owner": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1511975298, "post_id": 47557593, "comment_id": 82073811, "body": "@SJR Thought the same with the edit request, thought it was some kind of rule or something here, it is my first post. Btw, your solution did not work, thank you very much for trying to help anyways."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1511975405, "post_id": 47557593, "comment_id": 82073866, "body": "The edit was simply for Reputation points, not needed at all! I agree with you @SJR! Very odd indeed."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1511975447, "post_id": 47557593, "comment_id": 82073890, "body": "@Xabier - talk about perverse incentives!"}], "answers": [{"comments": [{"owner": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "edited": false, "score": 0, "creation_date": 1511975050, "post_id": 47557911, "comment_id": 82073645, "body": "Thanks! It worked, partially though. The table was copied to the range i specified, but just the first 2 columns. I think it might be a problem with .End, but when i use Ctrl+Shift+ArrowKey to select the table manually (It is supposed to work the same as .End), I get to select it whole. Any idea why is this happening?"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "edited": false, "score": 0, "creation_date": 1511975402, "post_id": 47557911, "comment_id": 82073864, "body": "When you do it manually are you going right and then down, or down and then right?. Your code is doing the former. Ctrl+Shift+ArrowKey stops just before the first blank cell it encounters so it sounds as if c7 is blank"}, {"owner": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "edited": false, "score": 0, "creation_date": 1511975775, "post_id": 47557911, "comment_id": 82074082, "body": "I&#39;m going right and down manually, that&#39;s the weird part. I&#39;m going to try to do it down and then right in the macro to see if it works then."}, {"owner": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "edited": false, "score": 0, "creation_date": 1511976023, "post_id": 47557911, "comment_id": 82074218, "body": "I get exactly the same partial-table at destination when I do it first down and then right."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 0, "last_activity_date": 1511974539, "creation_date": 1511974539, "answer_id": 47557911, "question_id": 47557593, "link": "https://stackoverflow.com/questions/47557593/copy-a-pivot-table-with-vba/47557911#47557911", "title": "Copy a Pivot Table with VBA", "body": "<pre><code>Set rng = errprov.Range(\"A7\", Range(\"A7\").End(xlToRight).End(xlDown))\n</code></pre>\n\n<p>should be </p>\n\n<pre><code>Set rng = errprov.Range(\"A7:\" &amp; Range(\"A7\").End(xlToRight).End(xlDown).Address)\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1459, "favorite_count": 1, "accepted_answer_id": 47557911, "answer_count": 1, "score": 0, "last_activity_date": 1511974539, "creation_date": 1511973425, "last_edit_date": 1511973933, "question_id": 47557593, "link": "https://stackoverflow.com/questions/47557593/copy-a-pivot-table-with-vba", "title": "Copy a Pivot Table with VBA", "body": "<p>I'm programming an excel macro that is supposed to create tables and graphs in a new summary worksheet, and I'm having a problem in a part where the macro needs to filter a Pivot Table, and then copy/paste it in the summary worksheet. Sounds simple, but for a reason I get just a single cell with value 0 in the destination range. The filtering is done right, however. Here's the part of the code where this happens.</p>\n\n<pre><code>    Dim pt As PivotTable: Set pt = errprov.PivotTables(\"ErroresProveedor\")\n    On Error Resume Next\n    pt.PivotFields(\"DESCRIPCIONESGLOBALES\").ClearAllFilters\n    pt.PivotFields(\"DESCRIPCIONESGLOBALES\").CurrentPage =actual.Range(\"A2\").Value\n    pt.PivotFields(\"DATA DE\").ClearAllFilters\n    pt.PivotFields(\"DATA DE\").CurrentPage = \"SA\"\n\n    'The problem is here\n    Dim rng As Range\n    Set rng = errprov.Range(\"A7\", Range(\"A7\").End(xlToRight).End(xlDown))\n    actual.Activate\n    rng.Copy Range(\"A\" &amp; fila)\n</code></pre>\n\n<p>I get an error with the range property, probably because there's a Pivot Table there, but I have also tried selecting the table as an object with its own method, like I found in other posts, and I get the same result (Single cell with value 0).</p>\n"}, {"tags": ["vba", "for-loop", "mismatch"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1511973584, "post_id": 47557444, "comment_id": 82072719, "body": "check to see if the cell has an error using isError: <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/iserror-function\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/language-reference-vba/articles&zwnj;&#8203;/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1511975379, "last_edit_date": 1511975379, "creation_date": 1511974532, "answer_id": 47557909, "question_id": 47557444, "link": "https://stackoverflow.com/questions/47557444/how-to-make-a-string-accept-an-excel-error-runtime-error-13-mismatch/47557909#47557909", "title": "How to make a string accept an Excel error- runtime error 13- mismatch", "body": "<p>One way around the problem is to use the VARIANT data type to deal with the error.  </p>\n\n<p>As you've found out a STRING variable can't hold an error value, while the VARIANT can.  You can then use code along the lines of:  </p>\n\n<pre><code>IF ISERROR(field) THEN\n   field = NULL  \n   K=1  \nEND IF  \n</code></pre>\n\n<p>A VARIANT can also hold a NULL value.</p>\n\n<p><strong>Edit:</strong>  </p>\n\n<blockquote>\n  <p>I have seen a post about this and the recommended answer was to use\n  If IsError but I need the '#N/A' part of the error as to identify that\n  one has occured, rather than skip the row.  </p>\n</blockquote>\n\n<p>The <code>ISERROR</code> part identifies that an error has occurred.  This line of code on its own won't skip the row; it gives you an opportunity to do something else with the row such as replace the error value with a NULL value or some other required value.</p>\n"}], "owner": {"reputation": 29, "user_id": 8568421, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/634630a7a72cf4f09110d2506bb2a440?s=128&d=identicon&r=PG&f=1", "display_name": "D.Yvel", "link": "https://stackoverflow.com/users/8568421/d-yvel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 47557909, "answer_count": 1, "score": 0, "last_activity_date": 1511975379, "creation_date": 1511972924, "question_id": 47557444, "link": "https://stackoverflow.com/questions/47557444/how-to-make-a-string-accept-an-excel-error-runtime-error-13-mismatch", "title": "How to make a string accept an Excel error- runtime error 13- mismatch", "body": "<p>I am trying to format downloaded data and then insert into SQL. The nature of the data is such that there will be errors such as #NAME?, #N/A Invalid Field etc. I have a variable of data type string which takes the value of a new cell each time a for loop is run. The loop crashes due to a mismatch error occuring when the loop hits a data point with an error in it (found out my message boxing the loop).</p>\n\n<p>Why can a string not accept an error as its value for the string? I have seen a post about this and the recommended answer was to use If IsError but I need the  '#N/A' part of the error as to identify that one has occured, rather than skip the row. Any suggestions would be greatly appreciated! Thanks :) An Extract of the code is below:</p>\n\n<pre><code>'Insert static fields\nDim field As String\n\n        code = \"'\" &amp; tbl.DataBodyRange(i, 1) &amp; \"'\"\n        For j = 2 To 48\n\n            MsgBox (tbl.DataBodyRange(i, j))\n            field = tbl.DataBodyRange(i, j).Value\n            'Recursively going through each cell\n\n            If InStr(field, \"#N\") &lt;&gt; 0 Then\n                field = \"NULL \"\n                k = 1\n</code></pre>\n\n<p>It hits the error at the messagebox first, the message box will display the mismatch error.</p>\n"}, {"tags": ["vba", "excel", "conditional-formatting"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1511972636, "post_id": 47557220, "comment_id": 82072140, "body": "Do you need a macro? Say your column A has the &quot;EBITDA&quot; column that you want to check for amounts under 25M.  In cell A2, you can enter this as the CF formula <code>=AND($A2&lt;25000000,A$1=&quot;EBITDA&quot;)</code> and the applied to range could be <code>=$A$2:$O$1000</code>.  That should check the current row for under 25M, and the column header to see if it&#39;s <code>EBITDA</code>"}, {"owner": {"reputation": 594, "user_id": 1126927, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d6701ce88607ae792d291de20eabf78b?s=128&d=identicon&r=PG", "display_name": "Brownish Monster", "link": "https://stackoverflow.com/users/1126927/brownish-monster"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1511973500, "post_id": 47557220, "comment_id": 82072665, "body": "@BruceWayne But the formula will only check for cells in Column A, shouldn&#39;t the formula be <code>=AND(A2&lt;25000000,A$1=&quot;EBITDA&quot;)</code>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 594, "user_id": 1126927, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d6701ce88607ae792d291de20eabf78b?s=128&d=identicon&r=PG", "display_name": "Brownish Monster", "link": "https://stackoverflow.com/users/1126927/brownish-monster"}, "edited": false, "score": 0, "creation_date": 1511973565, "post_id": 47557220, "comment_id": 82072708, "body": "@BrownishMonster - Oh, good call. If it&#39;s checking for <code>EBITDA</code> as a header, then you can un-anchor the first part."}, {"owner": {"reputation": 13, "user_id": 3728286, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4b2c2e698d224b99dc2d1ac3d8bea5c1?s=128&d=identicon&r=PG&f=1", "display_name": "user273287", "link": "https://stackoverflow.com/users/3728286/user273287"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1511974895, "post_id": 47557220, "comment_id": 82073567, "body": "@BruceWayne do you mean replace the value in the cell with that code and not even use a macro? I&#39;m not sure I understand. Or do you mean to include that logic somewhere in the macro. I feel like there must be some simpler code than what the recording gave me!"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 3728286, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4b2c2e698d224b99dc2d1ac3d8bea5c1?s=128&d=identicon&r=PG&f=1", "display_name": "user273287", "link": "https://stackoverflow.com/users/3728286/user273287"}, "edited": false, "score": 0, "creation_date": 1512152447, "post_id": 47558462, "comment_id": 82156874, "body": "How would you find a column header that was longer and more complex using Find like in your response? Say the header was &quot;Capacity to Repay Outstanding Total  Debt in 7 yrs (%)&quot; Could you use a &quot;LEFT&quot; somehow?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 13, "user_id": 3728286, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4b2c2e698d224b99dc2d1ac3d8bea5c1?s=128&d=identicon&r=PG&f=1", "display_name": "user273287", "link": "https://stackoverflow.com/users/3728286/user273287"}, "edited": false, "score": 0, "creation_date": 1512153842, "post_id": 47558462, "comment_id": 82157602, "body": "You could use <code>lookat:=xlPart</code> if you wanted to search by part of the header."}, {"owner": {"reputation": 13, "user_id": 3728286, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4b2c2e698d224b99dc2d1ac3d8bea5c1?s=128&d=identicon&r=PG&f=1", "display_name": "user273287", "link": "https://stackoverflow.com/users/3728286/user273287"}, "edited": false, "score": 0, "creation_date": 1512165814, "post_id": 47558462, "comment_id": 82162977, "body": "Ok so you can give it any part of the header and xlPart will find it? no matter which part it is? so .Find(&quot;Capaci&quot;, lookat:=xlPart) will find it just the same as .Find(&quot;Capacity to Repay Outstanding Total&quot;, lookat:=xlPart)?"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1511976660, "creation_date": 1511976660, "answer_id": 47558462, "question_id": 47557220, "link": "https://stackoverflow.com/questions/47557220/targeted-conditional-formatting-in-vba/47558462#47558462", "title": "Targeted Conditional Formatting in VBA", "body": "<p>Something like this:</p>\n\n<pre><code>Sub ebitda_check()\n\n    Dim f As Range, sht As Worksheet, rng As Range\n    Set sht = ActiveSheet\n\n    'find the header\n    Set f = sht.Rows(1).Find(\"EBITDA\", lookat:=xlWhole)\n\n    'if found, format the content below the header\n    If Not f Is Nothing Then\n        Set rng = sht.Range(f.Offset(1, 0), sht.Cells(Rows.Count, f.Column).End(xlUp))\n        With rng.FormatConditions.Add(Type:=xlCellValue, Operator:=xlLess, _\n                                          Formula1:=\"=25000000\")\n            .SetFirstPriority\n            With .Interior\n                .PatternColorIndex = xlAutomatic\n                .Color = 255\n                .TintAndShade = 0\n            End With\n            .StopIfTrue = False\n        End With\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 3728286, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4b2c2e698d224b99dc2d1ac3d8bea5c1?s=128&d=identicon&r=PG&f=1", "display_name": "user273287", "link": "https://stackoverflow.com/users/3728286/user273287"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 47558462, "answer_count": 1, "score": 0, "last_activity_date": 1511976660, "creation_date": 1511972164, "last_edit_date": 1511972460, "question_id": 47557220, "link": "https://stackoverflow.com/questions/47557220/targeted-conditional-formatting-in-vba", "title": "Targeted Conditional Formatting in VBA", "body": "<p>I have an Excel sheet with 15 columns of data. I want to check one of the columns, and highlight a cell if it is under 25,000,000. Just recording a macro I can do it and it gives me this code:</p>\n\n<pre><code>Sub ebitda_check() \n    'ebitda &lt; 25MM Macro\n\n    Columns(\"H:H\").Select\n    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlLess, _\n    Formula1:=\"=25000000\"\n\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 255\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\nEnd Sub\n</code></pre>\n\n<p>But this doesn't account for the fact that the column I want to target may move around or be in a different column next time. How can I write something to check, for example, \"if the column header is 'EBITDA', highlight anything under 25,000,000\"?</p>\n"}, {"tags": ["python", "excel", "vba", "csv", "zip"], "comments": [{"owner": {"reputation": 3952, "user_id": 6696657, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c78dbc81728388bd956e9d4f4c1a6759?s=128&d=identicon&r=PG&f=1", "display_name": "MattR", "link": "https://stackoverflow.com/users/6696657/mattr"}, "edited": false, "score": 0, "creation_date": 1511978300, "post_id": 47557057, "comment_id": 82075568, "body": "what is the full error of ` &quot;Excel found unreadable content ...&quot;`? Second, when you open the Excel file is it opened in &quot;recovered&quot; mode? Lastly, is the VBA code the thing that is supplying/writing the data using Named Ranges?"}, {"owner": {"reputation": 181, "user_id": 4998990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d1b6f612c02f769c27ae01cff7c559b?s=128&d=identicon&r=PG", "display_name": "hzpc-joostk", "link": "https://stackoverflow.com/users/4998990/hzpc-joostk"}, "reply_to_user": {"reputation": 3952, "user_id": 6696657, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c78dbc81728388bd956e9d4f4c1a6759?s=128&d=identicon&r=PG&f=1", "display_name": "MattR", "link": "https://stackoverflow.com/users/6696657/mattr"}, "edited": false, "score": 0, "creation_date": 1512118678, "post_id": 47557057, "comment_id": 82136610, "body": "Thanks @MattR. I have included the full error message. Note that I am using Office 2016 for Mac, but it should also (or at least) work for Office for Windows. I have not written VBA code, yet. But it probably will just dump the csv as table, not using named ranges."}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 4998990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d1b6f612c02f769c27ae01cff7c559b?s=128&d=identicon&r=PG", "display_name": "hzpc-joostk", "link": "https://stackoverflow.com/users/4998990/hzpc-joostk"}, "edited": false, "score": 0, "creation_date": 1512144393, "post_id": 47595579, "comment_id": 82152355, "body": "Thanks again @MattR. Unfortunately, this didn&#39;t work, as I want to put the data into a CSV which is added to the Excel archive using an external ZIP program.  The embedded CSV is lost when reading and writing just the Excel data using pandas (great package btw), as openpyxl does not take these additional files into account. I will update my question to enlighten this."}], "tags": [], "owner": {"reputation": 3952, "user_id": 6696657, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c78dbc81728388bd956e9d4f4c1a6759?s=128&d=identicon&r=PG&f=1", "display_name": "MattR", "link": "https://stackoverflow.com/users/6696657/mattr"}, "is_accepted": false, "score": 0, "last_activity_date": 1512138615, "creation_date": 1512138615, "answer_id": 47595579, "question_id": 47557057, "link": "https://stackoverflow.com/questions/47557057/embed-csv-in-excel-and-import-the-data/47595579#47595579", "title": "Embed CSV in Excel and import the data", "body": "<p>so my \"Answer\" here is that this is caused by using Named Ranges, or an underlying table, or an embedded Query/Connection. When you start manipulating this file you will get the error that you are talking about:</p>\n\n<p><a href=\"https://i.stack.imgur.com/FMsh8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FMsh8.png\" alt=\"enter image description here\"></a></p>\n\n<p>There is no harm to the file if you click \"yes\" and open. Excel will open this in Repaired Mode which will require you to re-save the file.</p>\n\n<p>The way I've worked around this is to re-read the \"repaired\" file, in python, and save it as another file or replace it. <em>Essentially</em> just do an extra step of re-reading the data into memory, and write it to a new file. The error will go away. As always, test this method before deploying to production to ensure no records are lost. The way I solve it is with two lines of <code>pandas</code>.</p>\n\n<pre><code>import pandas as pd\nrepair = pd.read_excel('PATH_TO_REPAIR_FILE')\nnew_file = repair.to_excel('PATH_TO_WHERE_NEW_FILE_GOES')\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 4998990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d1b6f612c02f769c27ae01cff7c559b?s=128&d=identicon&r=PG", "display_name": "hzpc-joostk", "link": "https://stackoverflow.com/users/4998990/hzpc-joostk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 504, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512138615, "creation_date": 1511971588, "last_edit_date": 1512118526, "question_id": 47557057, "link": "https://stackoverflow.com/questions/47557057/embed-csv-in-excel-and-import-the-data", "title": "Embed CSV in Excel and import the data", "body": "<p>I wrote a tool that extracts data from a large DB and outputs it to an Excel file along with (conditional) formatting to improve readability. For this I use Python with <code>openpyxl</code> on a Linux machine. It works great, but this package is rather slow for writing Excel.</p>\n\n<p>It seems to be a lot quicker to dump the table as (compressed) csv, import that into Excel and apply formatting there using a macro/vba.</p>\n\n<p>To automate the process I'd like to create an empty Excel file pre-loaded with the required VBA to do the formatting; a template. For every data dump, the data is embedded (compressed using deflate) into the Excel file and loaded into the Workbook upon opening the document (or using a \"LOAD\" button to circumvent macro related security things).</p>\n\n<p>However, just adding some file into the Excel file raises an error when opened: </p>\n\n<blockquote>\n  <p>We found a problem with some content in 'Werkmap1_test_embed.xlsx'. Do you want us to try to recover as much as we can? If you trust the source of this workbook, click Yes.</p>\n</blockquote>\n\n<p>Clicking <code>Yes</code> opens the file and shows some tracing information as XML:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\n&lt;recoveryLog xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\"&gt;\n  &lt;logFileName&gt;Repair Result to Werkmap1_OLE_Word0.xml&lt;/logFileName&gt;\n  &lt;summary&gt;Errors were detected in file '/Users/joostk/mnt/cluster/Werkmap1_OLE_Word.xlsx'&lt;/summary&gt;\n  &lt;additionalInfo&gt;\n      &lt;info&gt;Excel completed file level validation and repair. Some parts of this workbook may have been repaired or discarded.&lt;/info&gt;\n  &lt;/additionalInfo&gt;\n&lt;/recoveryLog&gt;\n</code></pre>\n\n<p>Is it possible to avoid this? How would I embed a file into the Excel ZIP? Do I need to update some file table (which I could not file easily).</p>\n\n<p>When that's done, I'd like to import the data. Can I access files in the Excel ZIP from VBA? I guess not, and I need to extract the data to some temporary path and load it from there. </p>\n\n<p>I have found these helpful answers elsewhere to load ZIP and plain text: </p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/a/35781621/4998990\">https://stackoverflow.com/a/35781621/4998990</a></li>\n<li><a href=\"https://stackoverflow.com/a/11267603/4998990\">https://stackoverflow.com/a/11267603/4998990</a></li>\n</ul>\n\n<p>Many thanks for sharing your thoughts!</p>\n"}, {"tags": ["vba", "excel", "binary", "binary-data"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1511970359, "post_id": 47556583, "comment_id": 82070573, "body": "<code>=DEC2BIN(BIN2DEC(A2)-BIN2DEC(A1))</code>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1511970479, "post_id": 47556583, "comment_id": 82070653, "body": "<code>worksheetfunction.BIN2DEC(&quot;0011&quot;) + worksheetfunction.BIN2DEC(&quot;0011&quot;)</code> then use <code>DEC2BIN</code> to get the result back to binary."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 4, "last_activity_date": 1511978965, "last_edit_date": 1511978965, "creation_date": 1511970559, "answer_id": 47556712, "question_id": 47556583, "link": "https://stackoverflow.com/questions/47556583/how-to-add-or-subtract-binary-numbers-using-vba/47556712#47556712", "title": "How to add or subtract binary numbers using vba?", "body": "<p>With 5-bit binaries in <strong>A1</strong> and <strong>A2</strong>, in another cell enter:</p>\n\n<pre><code>=DEC2BIN(SUM(BIN2DEC(A1),BIN2DEC(A2)))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/9uNZL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9uNZL.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you see, <em>VBA</em> is not required.  If you really need <em>VBA</em> then:</p>\n\n<pre><code>Public Function BinSum(s1 As String, s2 As String) As String\n    With Application.WorksheetFunction\n        BinSum = .Dec2Bin(.Sum(.Bin2Dec(s1), .Bin2Dec(s2)))\n    End With\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 2, "last_activity_date": 1511970636, "creation_date": 1511970636, "answer_id": 47556736, "question_id": 47556583, "link": "https://stackoverflow.com/questions/47556583/how-to-add-or-subtract-binary-numbers-using-vba/47556736#47556736", "title": "How to add or subtract binary numbers using vba?", "body": "<p>Using VBA</p>\n\n<p><code>worksheetfunction.DEC2BIN(worksheetfunction.BIN2DEC(\"0011\") + worksheetfunction.BIN2DEC(\"0011\"))</code></p>\n"}], "owner": {"reputation": 159, "user_id": 8715744, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/450e92c8b232664f04994a34ef97b1a3?s=128&d=identicon&r=PG&f=1", "display_name": "JayyM", "link": "https://stackoverflow.com/users/8715744/jayym"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1197, "favorite_count": 1, "accepted_answer_id": 47556712, "answer_count": 2, "score": 2, "last_activity_date": 1511978965, "creation_date": 1511970148, "last_edit_date": 1531164843, "question_id": 47556583, "link": "https://stackoverflow.com/questions/47556583/how-to-add-or-subtract-binary-numbers-using-vba", "title": "How to add or subtract binary numbers using vba?", "body": "<p>I have a data of 5-bits of binary numbers (10110, 10111, 01011, etc..), which are the data information of transmitted bits in the fiber.\nNow I happened to do is that I need to sum and subtract few binary numbers, and these are high in volume.\nSo as I already have these data in my excel sheet, I was thinking of implementing VBA code to add and subtract the binary numbers.\nI couldn't find any function that sums 1+1=10, I'm just finding that 1+1=2. Also, to subtract, there's a method of 1's and 2's compliment.\nIf there's something which can be done by VBA, kindly help me out. I have tried my best to code, but it sums 1+1=2.\nThanks!</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1514488126, "post_id": 47556576, "comment_id": 82994611, "body": "Try this setup <a href=\"https://stackoverflow.com/a/34871809/4539709\">stackoverflow.com/a/34871809/4539709</a>"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1523565429, "post_id": 47556576, "comment_id": 86625741, "body": "It appears non-cached is necessary when there are shared folders. <a href=\"https://stackoverflow.com/a/49602063\">stackoverflow.com/a/49602063</a> &quot;Keep in mind that by default Outlook caches shared folders in the primary mailbox&#39;s OST file. Subfolders are not cached. Try to disable the shared folder caching in the Exchange account properties dialog.&quot;"}], "owner": {"reputation": 21, "user_id": 9015706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182ebca9a14d5fc526638385ab543aab?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalo", "link": "https://stackoverflow.com/users/9015706/gonzalo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 217, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1593075349, "creation_date": 1511970133, "last_edit_date": 1593075349, "question_id": 47556576, "link": "https://stackoverflow.com/questions/47556576/retrieving-shared-folders-in-cached-mode", "title": "Retrieving shared folders in cached mode", "body": "<p>I have the following code: </p>\n\n<pre><code>Set theInbox = GetFolder(\"SHARED MAILBOX NAME\\Inbox\")\nSet theSub = theInbox.Folders(\"Subfolder Name Here\")\nSet theFolder = theSub.Folders(\"Another Subfolder Name\")\nItem.Move theFolder\n</code></pre>\n\n<p>This is a Shared Mailbox which I use in Cached Mode. Sometimes \"theSub\" fails to retrieve the Subfolder. </p>\n\n<p>If I uncheck the Download Shared Folders option, it works properly, however, Outlook is painfully slow. </p>\n\n<p>How can I retrieve the folders when using cached mode?</p>\n"}, {"tags": ["vba", "hide"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1511969703, "post_id": 47556334, "comment_id": 82070071, "body": "Looks like you&#39;re checking row 1 instead of row 3?"}, {"owner": {"reputation": 61, "user_id": 8953988, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/debb991691bbf1a0e2abedb715c940ce?s=128&d=identicon&r=PG&f=1", "display_name": "Casey M", "link": "https://stackoverflow.com/users/8953988/casey-m"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1511970182, "post_id": 47556334, "comment_id": 82070441, "body": "good point Nathan.   also forgot to add / noticed I need the column checks to start at P to EA and row checks to start at 12 to roughly 100."}, {"owner": {"reputation": 61, "user_id": 8953988, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/debb991691bbf1a0e2abedb715c940ce?s=128&d=identicon&r=PG&f=1", "display_name": "Casey M", "link": "https://stackoverflow.com/users/8953988/casey-m"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1511970223, "post_id": 47556334, "comment_id": 82070469, "body": "just I noticed that it appears to be checking my row with all the 0&#39;s and 1&#39;s going across."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1511970282, "post_id": 47556334, "comment_id": 82070516, "body": "<code>.usedrange.entirerow.hidden=false</code>"}, {"owner": {"reputation": 61, "user_id": 8953988, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/debb991691bbf1a0e2abedb715c940ce?s=128&d=identicon&r=PG&f=1", "display_name": "Casey M", "link": "https://stackoverflow.com/users/8953988/casey-m"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1511970669, "post_id": 47556334, "comment_id": 82070800, "body": "sorry haven&#39;t used usedrange before look useful I&#39;ll look at it  Thanks Nathan ! :)"}], "owner": {"reputation": 61, "user_id": 8953988, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/debb991691bbf1a0e2abedb715c940ce?s=128&d=identicon&r=PG&f=1", "display_name": "Casey M", "link": "https://stackoverflow.com/users/8953988/casey-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 839, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1511976167, "creation_date": 1511969380, "last_edit_date": 1511976167, "question_id": 47556334, "link": "https://stackoverflow.com/questions/47556334/how-to-hide-rows-and-columns-based-on-a-value", "title": "how to hide rows and columns based on a value", "body": "<p>I'm having a bit of difficulty hiding rows and columns together based on cell value. I want to hide any row in column A with a cell value of \"0\" and Hide all columns in row 3 with a cell value of \"0\". There is the added twist of multiple grouping with the rows.</p>\n\n<p>These two codes seem to work independently but not together when everything is ungrouped.</p>\n\n<p>I would like to get them to work together and ungroup everything first because when everything is grouped it misses some \"0\"s.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Hiderandc()\n\n    'this code hides all rows with cell value \"0\"\n    BeginRow = 1\n    EndRow = 100\n    ChkCol = 1\n\n    For RowCnt = BeginRow To EndRow\n        If Cells(RowCnt, ChkCol).Text = \"0\" Then\n            Cells(RowCnt, ChkCol).EntireRow.Hidden = True\n        Else\n            Cells(RowCnt, ChkCol).EntireRow.Hidden = False\n        End If\n    Next RowCnt\n\n    'Description: This macro will loop through a row and\n    'hide the column if the cell in row 1 of the column\n    'has the value of 0.\n\n    Dim c As Range\n\n    For Each c In Rows(\"1:1\").Cells\n        If c.Value = \"0\" Then\n            c.EntireColumn.Hidden = True\n            'You can change the property above to False\n            'to unhide the columns.\n        End If\n    Next c\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "charts", "excel-charts"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1511968974, "post_id": 47556168, "comment_id": 82069509, "body": "(You&#39;re missing <code>End With</code>)"}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1511969027, "post_id": 47556168, "comment_id": 82069553, "body": "@BruceWayne - I apologize, it is extremely unfinished, I was simply providing what I have so far."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511969210, "post_id": 47556168, "comment_id": 82069672, "body": "Presumably you have more than one column if you are intending on plotting on 2 axes? Or will one be left to default to 1,2,3 etc?"}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511969295, "post_id": 47556168, "comment_id": 82069734, "body": "@QHarr - Yes, The X-Axis will be the names of the buildings and the Y-Axis will be the number of times the buildings name was used in a cell within the range"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511969321, "post_id": 47556168, "comment_id": 82069756, "body": "What exactly are you having trouble with?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511969397, "post_id": 47556168, "comment_id": 82069821, "body": "I think your question is going to need more info if you want a decent answer, based on that last comment. Do you mean a histogram by building name? And range being the entire joined dataset? I note your code shows clusteredcolumn."}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511969429, "post_id": 47556168, "comment_id": 82069840, "body": "@SJR -  A method for creating a source data from multiple sheets that are finite"}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511969487, "post_id": 47556168, "comment_id": 82069892, "body": "@QHarr - If I am understanding your questions correctly, yes that is what I am looking for"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1511969677, "post_id": 47556168, "comment_id": 82070050, "body": "If you are certain of sheet order you can loop from 3 to sheets.count (only 2 preceeding worksheets) calling a sub that extracts the required range and pastes to next available row in &quot;master&quot; consolidation range. Then another sub to create the chart. Otherwise loop checking sheet names not like A or B (the two you want to exclude)."}], "answers": [{"comments": [{"owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 0, "creation_date": 1511971376, "post_id": 47556842, "comment_id": 82071289, "body": "How would you plot values stored in an array?"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 0, "creation_date": 1511971515, "post_id": 47556842, "comment_id": 82071380, "body": "Personally I would probably place the values from the array into another Sheet and then use that range to plot the chart, alternatively there are some ways to plot straight from an Array, none of which I have ever used, but this might be of use for you: [link]<a href=\"https://www.daniweb.com/programming/software-development/threads/388319/excel-vba-array-to-range-for-setsourcedata[/link]\" rel=\"nofollow noreferrer\">daniweb.com/programming/software-development/threads/3&zwnj;&#8203;88319/&hellip;</a>"}, {"owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 0, "creation_date": 1511972449, "post_id": 47556842, "comment_id": 82072017, "body": "I&#39;ve just found this Q, might be useful - my first thought was also to transfer the array into a helper sheet, but it seems it can be done directly: <a href=\"https://stackoverflow.com/questions/10570023/create-chart-from-array-data-and-not-range\" title=\"create chart from array data and not range\">stackoverflow.com/questions/10570023/&hellip;</a>"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 0, "last_activity_date": 1511972783, "last_edit_date": 1511972783, "creation_date": 1511970982, "answer_id": 47556842, "question_id": 47556168, "link": "https://stackoverflow.com/questions/47556168/vba-source-data-from-multiple-sheets/47556842#47556842", "title": "VBA - Source data from multiple sheets", "body": "<p>I have the code that would loop through Sheet3 onwards and add all the data from column B (excluding the header) to an array, then you can use the array to plot the values into your chart?</p>\n\n<pre><code>Sub foo()\nDim wb As Workbook\nDim ws As Worksheet\nDim Myarray() As Variant\ny = 0\n\nFor Each ws In ThisWorkbook.Worksheets\n    If ws.Name &lt;&gt; \"Sheet1\" Then\n        If ws.Name &lt;&gt; \"Sheet2\" Then\n             LastRow = ws.Cells(ws.Rows.Count, \"B\").End(xlUp).Row\n             Counter = Counter + LastRow\n             ReDim Preserve Myarray(Counter)\n             For Each cell In ws.Range(\"B2:B\" &amp; LastRow)\n                 Myarray(y) = cell.Value\n                 y = y + 1\n             Next cell\n        End If\n    End If\nNext ws\n</code></pre>\n\n<p>If you then want to write the contents of the array into a helper sheet:</p>\n\n<pre><code>Worksheets.Add(After:=Worksheets(Worksheets.Count)).Name = \"Temp\"\nFor p = 1 To UBound(Myarray)\n    Sheets(\"Temp\").Cells(p, 1).Value = Myarray(p - 1)\nNext p\n</code></pre>\n\n<p>Then find the last row and get the range into SetSourceData to update the chart.</p>\n"}, {"tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 0, "last_activity_date": 1511991456, "creation_date": 1511991456, "answer_id": 47562252, "question_id": 47556168, "link": "https://stackoverflow.com/questions/47556168/vba-source-data-from-multiple-sheets/47562252#47562252", "title": "VBA - Source data from multiple sheets", "body": "<p>If you've got Excel 2016 or later, then the new PowerQuery functionality under the 'Get &amp; Transform' section of the Data tab is perfect for this. (In previous versions, PowerQuery is available as a free addin from Microsoft that you'll have to install).</p>\n\n<p>See the following link for an example of how it can be used to mash up data from multiple worksheets:\n<a href=\"https://stackoverflow.com/questions/47164451/excel-indirect-function-to-read-dates-and-return-dynamic-values/47170312#47170312\">excel indirect function to read dates and return dynamic values</a>\nFrom there, it's a simple task to make a PivotTable and then PivotChart out of it, and it can automatically bring through new worksheets without the user having to make any changes.</p>\n"}, {"tags": [], "owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "is_accepted": true, "score": 0, "last_activity_date": 1512057807, "creation_date": 1512057807, "answer_id": 47577642, "question_id": 47556168, "link": "https://stackoverflow.com/questions/47556168/vba-source-data-from-multiple-sheets/47577642#47577642", "title": "VBA - Source data from multiple sheets", "body": "<p>I was able to simplify the situation by using a hidden sheet</p>\n\n<pre><code>Private Sub Locations()\n\nDim ws As Worksheet, rep As Worksheet, LastRow As Double\nWith ThisWorkbook\n    For n = 1 To Sheets.Count\n        Set ws = Worksheets(n)\n        Set rep = Worksheets(\"Report\")\n        LastRow = rep.Range(\"C1\", rep.Range(\"C1\").End(xlDown)).Rows.Count\n        If IsNumeric(ws.Name) Then\n            If rep.Range(\"C1\") = \"\" Then\n                ws.Range(\"F2\", ws.Range(\"F2\").End(xlDown)).Copy _\n                Destination:=rep.Range(\"C1\")\n            Else:\n                ws.Range(\"F2\", ws.Range(\"F2\").End(xlDown)).Copy _\n                Destination:=rep.Range(\"C\" &amp; LastRow)\n            End If\n        End If\n    Next n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 966, "favorite_count": 1, "accepted_answer_id": 47577642, "answer_count": 3, "score": 0, "last_activity_date": 1512057807, "creation_date": 1511968887, "last_edit_date": 1511969150, "question_id": 47556168, "link": "https://stackoverflow.com/questions/47556168/vba-source-data-from-multiple-sheets", "title": "VBA - Source data from multiple sheets", "body": "<p>I am attempting to create a new chart using source data from multiple sheets.  The data will always be in the same column no matter the sheet.  However, I would like to select the data from <code>Range(\"F2\", Range(\"F2\").End(xlDown))</code> from each of the sheets following the permanent two sheets at the beginning.</p>\n\n<p>The sheets that I want data extracted from will be used as source data for a chart that will be created and deleted as new sheets are added, and the cycle will be repeated.</p>\n\n<p>So, for example, I would like it to grab data from sheets 3 to 52, or however many there are, from the range specified above so it becomes one cohesive source.  I am not sure if there is a nice way to do this without using a hidden sheet.  Thanks in advance.</p>\n\n<pre><code>Private Sub Locations()\nSet Build = Charts.Add(After = Worksheets(\"Report\"))\n    With Build\n        .SetSourceData\n        .ChartType = xlColumnClustered\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": false, "score": 1, "last_activity_date": 1511972476, "creation_date": 1511972476, "answer_id": 47557298, "question_id": 47556158, "link": "https://stackoverflow.com/questions/47556158/how-can-i-reposition-my-custom-command-button-in-my-addins-menu-excel-vba/47557298#47557298", "title": "How can I reposition my custom command button in my AddIns menu (Excel VBA)?", "body": "<p>TO have control over where things go on the ribbon you should be using Ribbon customisation. www.rondebruin.nl has all you need to know about customising the ribbon.</p>\n"}], "owner": {"reputation": 11, "user_id": 8150967, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157499079145327/picture?type=large", "display_name": "Sam Belliveau", "link": "https://stackoverflow.com/users/8150967/sam-belliveau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511972476, "creation_date": 1511968870, "last_edit_date": 1511969054, "question_id": 47556158, "link": "https://stackoverflow.com/questions/47556158/how-can-i-reposition-my-custom-command-button-in-my-addins-menu-excel-vba", "title": "How can I reposition my custom command button in my AddIns menu (Excel VBA)?", "body": "<p>I'm creating a custom command button in the AddIns menu in my excel ribbon. The issue is that my code is creating the button in the bottom left corner of the commandbar (it is correctly being put in the AddIns menu). How can I reposition my command button to be in the top left corner of my AddIns menu?        </p>\n\n<pre><code>Private Sub Workbook_AddinInstall()\n    Dim iContIndex As Integer\n    On Error Resume Next 'Just in case\n\n   'Delete any existing menu item that may have been left\n    Application.CommandBars(\"Worksheet Menu Bar\").Controls(\"Compare\").Delete\n\n    'Pass the Index of the \"Format\" menu item number to a Variable.\n    iContIndex = Application.CommandBars.FindControl(ID:=30006).Index\n\n    'Add the new menu item and Set a CommandBarButton Variable to it.\n    'Use the number passed to our Integer Variable to position it.\n    Set cControl = Application.CommandBars(\"Worksheet Menu Bar\").Controls.Add(Before:=iContIndex)\n    With cControl\n        .FaceId = 585\n        .Caption = \"Compare\"\n        .Style = msoButtonIconAndCaption\n        .OnAction = \"CompareFS\"\n    End With\n\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n"}, {"tags": ["image", "macos", "excel", "insert", "vba"], "comments": [{"owner": {"reputation": 2102, "user_id": 893510, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21372b35fa03e27c3526506c350c11cd?s=128&d=identicon&r=PG", "display_name": "Nicolas", "link": "https://stackoverflow.com/users/893510/nicolas"}, "edited": false, "score": 0, "creation_date": 1518724824, "post_id": 47556091, "comment_id": 84634457, "body": "did you figure this out?"}], "owner": {"reputation": 21, "user_id": 9026376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6650e6bd7164612c59db09f0923f098f?s=128&d=identicon&r=PG&f=1", "display_name": "C Bouwman", "link": "https://stackoverflow.com/users/9026376/c-bouwman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 604, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1533348796, "creation_date": 1511968614, "last_edit_date": 1531161705, "question_id": 47556091, "link": "https://stackoverflow.com/questions/47556091/insert-picture-into-excel-mac-vba", "title": "Insert picture into excel MAC (VBA)", "body": "<p>I'm trying to insert an online image to a cell in an excel worksheet. The code I use works perfectly in Excel 2016 for Windows. But not in Excel 365 for MAC: no pictures are showing (I allready tried to set all MAC security-options to the lowest options).</p>\n\n<p>Who could give me a hint?</p>\n\n<p>Like in my code below, the (dynamic) url is in Sheets(\"grafisch\").Range(\"B87\") and the picture is placed in Sheets(\"Sjabloon\").Range(\"a3\").</p>\n\n<p>The url is basically: \"<a href=\"https://www.adress.com/pict\" rel=\"nofollow noreferrer\">https://www.adress.com/pict</a>\" and it does not end with a filetype like .jpg or .png</p>\n\n<pre><code>Sub Imginsert()\nSheets(\"Sjabloon\").Range(\"a3\").Select\nDim cellValue As String\nDim pic As Picture\ncellValue = Sheets(\"grafisch\").Range(\"B87\").Value\nIf cellValue = \"\" Then Exit Sub\nSet pic = ActiveSheet.Pictures.Insert(cellValue)\npic.Name = \"Picture1\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "function"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511967419, "post_id": 47555591, "comment_id": 82068290, "body": "Call epign(et, ep, fc, ent) remove the brackets for starters"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1511967555, "post_id": 47555591, "comment_id": 82068394, "body": "<code>1</code> Dim resultado As Variant should be declared on top and not in Sub epign( <code>2</code> Debug and check what is the value that you are getting for &quot;resultado = Application.VLookup(ent, myRange, fc, False)&quot; <code>3</code> Check if there is something which is breaking the code"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1511967622, "post_id": 47555591, "comment_id": 82068454, "body": "You need to move <code>Dim resultado As Variant</code> so the variable is declared above both procedures, or just make <code>epign</code> a function."}, {"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 0, "creation_date": 1511967659, "post_id": 47555591, "comment_id": 82068493, "body": "Declaring resultado as public would solve it but there are so many issues at play here. The concept of calling a sub from a function means there can be unexpected behaviour, not to mention you may as well have the logic for calculating the value within the function itself. Finally input aspects such as the filepath really ought to be parameters as they&#39;re likely to change."}, {"owner": {"reputation": 169, "user_id": 4765179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/73d9656254cdbadf55e9b1b1ff6825a8?s=128&d=identicon&r=PG&f=1", "display_name": "Javi", "link": "https://stackoverflow.com/users/4765179/javi"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1511968667, "post_id": 47555591, "comment_id": 82069277, "body": "@SiddharthRout The value for resultado is still Error 2042, even when declaring resultado in Function"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1511968680, "post_id": 47555591, "comment_id": 82069287, "body": "Also ALWAYS use Option Explicit at the top of every code module"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1511970267, "post_id": 47555591, "comment_id": 82070502, "body": "From the documentation: &quot;<i>The #N/A error generally indicates that a formula can\u2019t find what it\u2019s been asked to look for.</i>&quot; So the VLookup fails."}, {"owner": {"reputation": 169, "user_id": 4765179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/73d9656254cdbadf55e9b1b1ff6825a8?s=128&d=identicon&r=PG&f=1", "display_name": "Javi", "link": "https://stackoverflow.com/users/4765179/javi"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1511970869, "post_id": 47555591, "comment_id": 82070950, "body": "@PaulOgilvie I obviously know what is the #N/A error in a VLookup formula. The question is why it does works in a Sub and does not in a function"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1511971732, "post_id": 47555591, "comment_id": 82071525, "body": "Note: in the sub <code>ent = 9992</code> in the Function it is <code>ent = &quot;9992&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1511967592, "post_id": 47555751, "comment_id": 82068426, "body": "In that case it should have a defalut value of <code>0</code> :)"}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1511967627, "last_edit_date": 1511967627, "creation_date": 1511967543, "answer_id": 47555751, "question_id": 47555591, "link": "https://stackoverflow.com/questions/47555591/vba-excel-parameters-in-a-sub-what-is-the-change/47555751#47555751", "title": "vba Excel: Parameters in a sub. What is the change?", "body": "<p><code>epig = resultado</code> is probably the eror: <code>resultado</code> is not a variable of the function and Sub <code>epign</code> doesn't return it. You need a way to communicate the result to the function, which then can return it to the sheet.</p>\n\n<p>In Tools, Options, turn <em>Require Variable Declaration</em> on. That will warn you about these errors.</p>\n\n<p>Now, how to comunicate the result. I suggest you use a global variable <code>resultado</code>, e.g.:</p>\n\n<pre><code>Public resultado As &lt;type&gt;    ' (I cannot see what type it is)\n</code></pre>\n\n<p>Or make it a parameter of the Sub, e.g.:</p>\n\n<pre><code>Sub epign(et As Integer, ep As Integer, fc As Integer, ent As String, ByRef resultado As &lt;type&gt;)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 169, "user_id": 4765179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/73d9656254cdbadf55e9b1b1ff6825a8?s=128&d=identicon&r=PG&f=1", "display_name": "Javi", "link": "https://stackoverflow.com/users/4765179/javi"}, "edited": false, "score": 0, "creation_date": 1511972442, "post_id": 47557076, "comment_id": 82072009, "body": "After the line  <code>resultado = Application.VLookup(ent, myRange, fc, False)</code> the function ends (it even doesn&#39;t go to <code>epig=resultado</code>"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 169, "user_id": 4765179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/73d9656254cdbadf55e9b1b1ff6825a8?s=128&d=identicon&r=PG&f=1", "display_name": "Javi", "link": "https://stackoverflow.com/users/4765179/javi"}, "edited": false, "score": 1, "creation_date": 1511974435, "post_id": 47557076, "comment_id": 82073271, "body": "It looks like the vlookup isn&#39;t returning a result.  Should ent be a string or a long?"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 0, "last_activity_date": 1511971662, "creation_date": 1511971662, "answer_id": 47557076, "question_id": 47555591, "link": "https://stackoverflow.com/questions/47555591/vba-excel-parameters-in-a-sub-what-is-the-change/47557076#47557076", "title": "vba Excel: Parameters in a sub. What is the change?", "body": "<p>To return the result of a function you assign the result to the name of the function. To use a function in your spreadsheet it must be Public and in a normal module (not those attached to workbook or worksheets)  All you need is:</p>\n\n<pre><code> Public Function epig(et As Integer, ep As Integer, fc As Integer, ent As String) As Variant\n Dim resultado As Variant\n Dim myRange As Range\n Ruta = \"C:\\TRABAJO\\MisEstados\\\"\n libro = Ruta + CStr(et) + \"\\\" + CStr(et) + \"-data.xlsx\"\n Nombre = \"'\" + libro + \"'!D_\" + CStr(ep)\n soloLibro = CStr(et) + \"-data.xlsx\"\n ws = \"D\" + CStr(ep)\n resultado = 0\n Set myRange = Workbooks(soloLibro).Worksheets(ws).Range(\"D_\" + CStr(ep))\n resultado = Application.VLookup(ent, myRange, fc, False)\n epig = resultado  'add this line\n\n End Sub\n</code></pre>\n\n<p>You can then enter =epif(4529, 1, 3,9992) into a cell and get a result</p>\n"}], "owner": {"reputation": 169, "user_id": 4765179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/73d9656254cdbadf55e9b1b1ff6825a8?s=128&d=identicon&r=PG&f=1", "display_name": "Javi", "link": "https://stackoverflow.com/users/4765179/javi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 47557076, "answer_count": 2, "score": 0, "last_activity_date": 1511971662, "creation_date": 1511967097, "question_id": 47555591, "link": "https://stackoverflow.com/questions/47555591/vba-excel-parameters-in-a-sub-what-is-the-change", "title": "vba Excel: Parameters in a sub. What is the change?", "body": "<p>I have a sub at Excel like this:</p>\n\n<pre><code>Sub epign()\net = 4529\nep = 1\nfc = 3\nent = 9992\nDim resultado As Variant\nDim myRange As Range\nRuta = \"C:\\TRABAJO\\MisEstados\\\"\nlibro = Ruta + CStr(et) + \"\\\" + CStr(et) + \"-data.xlsx\"\nNombre = \"'\" + libro + \"'!D_\" + CStr(ep)\nsoloLibro = CStr(et) + \"-data.xlsx\"\nws = \"D\" + CStr(ep)\nresultado = 0\nSet myRange = Workbooks(soloLibro).Worksheets(ws).Range(\"D_\" + CStr(ep))\nresultado = Application.VLookup(ent, myRange, fc, False)\nEnd Sub\n</code></pre>\n\n<p>This works great and the result is a positive number.</p>\n\n<p>But, I have tried to use this sub from a function like this:</p>\n\n<pre><code>Function epig(et As Integer, ep As Integer, fc As Integer, ent As String) As Variant\nCall epign(et, ep, fc, ent)\nepig = resultado\nEnd Function\n\nSub epign(et As Integer, ep As Integer, fc As Integer, ent As String)\nDim resultado As Variant\nDim myRange As Range\nRuta = \"C:\\TRABAJO\\MisEstados\\\"\nlibro = Ruta + CStr(et) + \"\\\" + CStr(et) + \"-data.xlsx\"\nNombre = \"'\" + libro + \"'!D_\" + CStr(ep)\nsoloLibro = CStr(et) + \"-data.xlsx\"\nws = \"D\" + CStr(ep)\nresultado = 0\nSet myRange = Workbooks(soloLibro).Worksheets(ws).Range(\"D_\" + CStr(ep))\nresultado = Application.VLookup(ent, myRange, fc, False)\nEnd Sub\n</code></pre>\n\n<p>When trying to use this on an Excel cell:</p>\n\n<pre><code>=epig(4529;1;3;\"9992\")\n</code></pre>\n\n<p>The result is an error 2042.</p>\n\n<p>Why? What is the difference?</p>\n"}, {"tags": ["excel", "vba", "ribbon"], "answers": [{"tags": [], "owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "is_accepted": true, "score": 1, "last_activity_date": 1512473047, "last_edit_date": 1512473047, "creation_date": 1512469169, "answer_id": 47651157, "question_id": 47555468, "link": "https://stackoverflow.com/questions/47555468/text-value-in-custom-ribbon/47651157#47651157", "title": "Text value in custom Ribbon", "body": "<p>You need an editBox-control or labelControl with callbacks to VBA functions, like you have for the onAction-events in your example.</p>\n\n<p>I couldn't get your sample code to work though, so this is a general example. If you want a labelControl, the same <code>getText</code>-sub will work, but the XML-code is different.</p>\n\n<p><strong>XML</strong>:</p>\n\n<pre><code>&lt;editBox id=\"txt1\" getText=\"GetText\" getEnabled=\"GetEnabled' /&gt;\n&lt;labelControl id=\"lbl1\" getLabel=\"GetText\" /&gt;\n</code></pre>\n\n<p><strong>VBA</strong>:</p>\n\n<pre><code>'***** Callback for txt1 getText\nSub GetText(control As IRibbonControl, ByRef returnedVal)\n    '***** Return the value in cell A1 in sheet #1 in the workbook that holds the code\n    returnedVal = ThisWorkbook.Sheets(1).Cells(1, 1).Value\nEnd Sub\n\n'***** Callback for txt1 getEnabled\nSub GetEnabled(control As IRibbonControl, ByRef returnedVal)\n    '***** Return wheter you want the editBox to be enabled or not\n    returnedVal = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 8610459, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb95bd8ea7e1fdd9f2e75ce267c1121e?s=128&d=identicon&r=PG&f=1", "display_name": "Roca", "link": "https://stackoverflow.com/users/8610459/roca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1169, "favorite_count": 1, "accepted_answer_id": 47651157, "answer_count": 1, "score": 4, "last_activity_date": 1512473047, "creation_date": 1511966735, "question_id": 47555468, "link": "https://stackoverflow.com/questions/47555468/text-value-in-custom-ribbon", "title": "Text value in custom Ribbon", "body": "<p>I created a custom ribbon using VBA (not CUSTOM UI EDITOR), I need to have a simple, static text showing value of cell A1, but I cannot find the XML code for that. this is what I have:</p>\n\n<pre><code>Sub LoadCustRibbon()\n\nDim hFile As Long\nDim path As String, fileName As String, ribbonXML As String, user As String\n\nhFile = FreeFile\nuser = Environ(\"Username\")\npath = \"C:\\Users\\\" &amp; user &amp; \"\\AppData\\Local\\Microsoft\\Office\\\"\nfileName = \"Excel.officeUI\"\n\n'ribbonXML = ribbonXML + \"&lt;mso:ribbon startFromScratch='true' /&gt;\" &amp; vbNewLine\n\nribbonXML = \"&lt;customUI      xmlns='http://schemas.microsoft.com/office/2009/07/customui'&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"   &lt;ribbon startFromScratch = 'true'&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"    &lt;qat/&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"    &lt;tabs&gt;\" &amp; vbNewLine\n\n\nribbonXML = ribbonXML + \"      &lt;tab id='Menu' label='Menu' insertBeforeQ='mso:TabFormat'&gt;\" &amp; vbNewLine\n'grupo geral\nribbonXML = ribbonXML + \"        &lt;group id='geral' label='Geral' autoScale='true'&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"          &lt;button id='capa' label='Capa' \" &amp; vbNewLine\nribbonXML = ribbonXML + \"imageMso='RmsNavigationBarHome'      onAction='Capa1'/&gt;\" &amp; vbNewLine\n\n\nribbonXML = ribbonXML + \"          &lt;button id='resumo' label='Resumo' \" &amp; vbNewLine\nribbonXML = ribbonXML + \"imageMso='ChartChangeType'      onAction='resumo1'/&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"        &lt;/group&gt;\" &amp; vbNewLine\n'grupo performance\n\nribbonXML = ribbonXML + \"        &lt;group id='performance' label='Performance' autoScale='true'&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"          &lt;button id='prom' label='Prom' \" &amp; vbNewLine\nribbonXML = ribbonXML + \"imageMso='CopyToPersonalContacts'      onAction='prom1'/&gt;\" &amp; vbNewLine\n\nribbonXML = ribbonXML + \"          &lt;button id='super' label='Super' \" &amp; vbNewLine\nribbonXML = ribbonXML + \"imageMso='WorkgroupAdmin'      onAction='super1'/&gt;\" &amp; vbNewLine\n\nribbonXML = ribbonXML + \"          &lt;button id='ranking' label='Ranking' \" &amp; vbNewLine\nribbonXML = ribbonXML + \"imageMso='Numbering'      onAction='ranking1'/&gt;\" &amp; vbNewLine\n\nribbonXML = ribbonXML + \"        &lt;/group&gt;\" &amp; vbNewLine\n\n\n'Cliente\nribbonXML = ribbonXML + \"        &lt;group id='cliente' label='Cliente' autoScale='true'&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"          &lt;button id='Responsible' label='Responsible' \" &amp; vbNewLine\nribbonXML = ribbonXML + \"imageMso='OrganizationChartInsert'      onAction='responsavel1'/&gt;\" &amp; vbNewLine\n\nribbonXML = ribbonXML + \"          &lt;button id='des' label='Des' \" &amp; vbNewLine\nribbonXML = ribbonXML + \"imageMso='GroupJunkEmail'      onAction='des1'/&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"        &lt;/group&gt;\" &amp; vbNewLine\n\n'relatorios novo\nribbonXML = ribbonXML + \"        &lt;group id='relatorios1' label='Relatorios' autoScale='true'&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"          &lt;button id='an' label='An' \" &amp; vbNewLine\nribbonXML = ribbonXML + \"imageMso='TrustCenter'      onAction='historico1'/&gt;\" &amp; vbNewLine\n\nribbonXML = ribbonXML + \"          &lt;button id='causas' label='Causas' \" &amp; vbNewLine\nribbonXML = ribbonXML + \"imageMso='GroupContactOptions'      onAction='causas1'/&gt;\" &amp; vbNewLine\n\nribbonXML = ribbonXML + \"          &lt;button id='reenvios' label='Reenvios' \" &amp; vbNewLine\nribbonXML = ribbonXML + \"imageMso='ProposeNewTime'      onAction='reenvios1'/&gt;\" &amp; vbNewLine\n\nribbonXML = ribbonXML + \"        &lt;/group&gt;\" &amp; vbNewLine\n\n\n'reenvios\n'ribbonXML = ribbonXML + \"        &lt;group id='reenvios' label='Reenvios' autoScale='true'&gt;\" &amp; vbNewLine\n'ribbonXML = ribbonXML + \"          &lt;button id='reenvios' label='Reenvios' \" &amp; vbNewLine\n'ribbonXML = ribbonXML + \"imageMso='AppointmentColor8'      onAction='reenvios1'/&gt;\" &amp; vbNewLine\n'\n'ribbonXML = ribbonXML + \"        &lt;/group&gt;\" &amp; vbNewLine\n\n\n\nribbonXML = ribbonXML + \"      &lt;/tab&gt;\" &amp; vbNewLine\n'ribbonXML = ribbonXML + \"    &lt;tab mso:tab label ='Inserir' visible='false'&gt;\"\nribbonXML = ribbonXML + \"    &lt;/tabs&gt;\" &amp; vbNewLine\n\nribbonXML = ribbonXML + \"  &lt;/ribbon&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"&lt;/customUI&gt;\"\n\nribbonXML = Replace(ribbonXML, \"\"\"\", \"\")\n\nOpen path &amp; fileName For Output Access Write As hFile\nPrint #hFile, ribbonXML\nClose hFile\n\nEnd Sub\n</code></pre>\n\n<p>All buttons work fine, I have found many codes showing how to add an editable box, but none showing a simple static box showing value from a cell.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511966475, "post_id": 47555305, "comment_id": 82067527, "body": "Use Excel Help and you&#39;ll see that Autofill requires a range, not a sheet (and the destination must include this range)."}], "answers": [{"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1511968227, "post_id": 47555356, "comment_id": 82068951, "body": "++ Long time ago Si put <a href=\"http://www.vbforums.com/showthread.php?511766-Classic-VB-Why-is-using-the-End-statement-(or-VB-s-quot-stop-quot-button)-a-bad-idea\" rel=\"nofollow noreferrer\">THIS</a> alltogether. Interesting read. BTW if the user is looking for last row in a single column then <code>.Find</code> would be an overkill. <code>xlUp</code> will solve the problem... Also check out the use <code>Application.WorksheetFunction.CountA(.Cells)</code> in <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/11169920#11169920\">THIS</a>. Just my 2 cents :)"}, {"owner": {"reputation": 103, "user_id": 8362545, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/665bc493c0750c10499c1898ed39fcd8?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M", "link": "https://stackoverflow.com/users/8362545/dan-m"}, "edited": false, "score": 0, "creation_date": 1511968736, "post_id": 47555356, "comment_id": 82069332, "body": "Thanks for the help - it works a treat! Although, I am still confused as to why my original code was not working on this spreadsheet but was on another..."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 103, "user_id": 8362545, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/665bc493c0750c10499c1898ed39fcd8?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M", "link": "https://stackoverflow.com/users/8362545/dan-m"}, "edited": false, "score": 0, "creation_date": 1511969286, "post_id": 47555356, "comment_id": 82069724, "body": "@DanM because you didn&#39;t qualify <code>Range(&quot;Y2:Y&quot; &amp; LastRow)</code> with <code>Sheet6</code>."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 3, "last_activity_date": 1511967899, "last_edit_date": 1511967899, "creation_date": 1511966421, "answer_id": 47555356, "question_id": 47555305, "link": "https://stackoverflow.com/questions/47555305/vba-compile-error-occurring/47555356#47555356", "title": "VBA Compile Error occurring", "body": "<p>Change:</p>\n\n<pre><code>Sheet6.AutoFill Destination:=Range(\"Y2:Y\" &amp; LastRow)\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>Sheet6.Range(\"Y2\").AutoFill Destination:=Sheet6.Range(\"Y2:Y\" &amp; LastRow)\n</code></pre>\n\n<p><strong>Note</strong>: a \"safer\" way to get the last row, will be using the <code>Find</code> function:</p>\n\n<pre><code>Dim LastCell As Range\nDim LastRow As Long\n\nWith Sheet6\n    Set LastCell = .Cells.Find(What:=\"*\", After:=.Cells(1), Lookat:=xlPart, LookIn:=xlFormulas, _\n                        searchorder:=xlByRows, searchdirection:=xlPrevious, MatchCase:=False)\n    If Not LastCell Is Nothing Then\n        LastRow = LastCell.Row\n    Else\n        MsgBox \"Error! worksheet is empty\", vbCritical\n        Exit Sub\n    End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 8362545, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/665bc493c0750c10499c1898ed39fcd8?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M", "link": "https://stackoverflow.com/users/8362545/dan-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 47555356, "answer_count": 1, "score": 1, "last_activity_date": 1533262107, "creation_date": 1511966229, "last_edit_date": 1533262107, "question_id": 47555305, "link": "https://stackoverflow.com/questions/47555305/vba-compile-error-occurring", "title": "VBA Compile Error occurring", "body": "<p>The code below is meant to run when the Workbook is first opened. </p>\n\n<pre><code>Sub Auto_Open()\n\nDim LastRow As Integer\nLastRow = Sheet6.UsedRange.Rows.Count\n\nActiveWorkbook.RefreshAll\n\nSheet6.AutoFill Destination:=Range(\"Y2:Y\" &amp; LastRow)\n\nEnd Sub\n</code></pre>\n\n<p>It automatically runs a Refresh All to update any queries or formula in the WorkBook and then autofills the list of data in column Y of sheet6 to the last row of data that can be found in the WorkSheet. </p>\n\n<p>When I go to run the code I get a 'Compile Error: Method of data member not found' which highlights.</p>\n\n<pre><code>.Autofill\n</code></pre>\n\n<p>What I don't understand is that this works perfectly well on an identical spreadsheet, not just this one.</p>\n\n<p>I have also tried the following code which doesn't work on this sheet but does on the other.</p>\n\n<pre><code>Sub Auto_Open()\n\nActiveWorkbook.RefreshAll\n\nSheet6.AutoFill_ListSource\n\nEnd Sub\n</code></pre>\n\n<p><em>ListSource is the name of the table in column Y that I am trying to autofill.</em></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1511965677, "post_id": 47555005, "comment_id": 82066986, "body": "<code>He does not need to see the comments for the rows, columns, and sheets he cannot see.</code> If a comment is on a cell which is hidden then the user will not be able to see the comment. This is by default. Or have I misunderstood your question?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1511966068, "post_id": 47555005, "comment_id": 82067236, "body": "Couldn&#39;t you just add an If to your loop to check if the sheet is visible. @SiddharthRout - think he means the code collects comments from sheets which the user should not be able to see."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511966215, "post_id": 47555005, "comment_id": 82067325, "body": "Then simply check if the cell/sheet is hidden or not :) @SJR"}, {"owner": {"reputation": 171, "user_id": 7322437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ea623e19c1c869a4eddcac16c673976?s=128&d=identicon&r=PG&f=1", "display_name": "jallington", "link": "https://stackoverflow.com/users/7322437/jallington"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511966893, "post_id": 47555005, "comment_id": 82067854, "body": "That is correct @SJR and I am terrible with loops and checking sheets but I will give it a try."}, {"owner": {"reputation": 171, "user_id": 7322437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ea623e19c1c869a4eddcac16c673976?s=128&d=identicon&r=PG&f=1", "display_name": "jallington", "link": "https://stackoverflow.com/users/7322437/jallington"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1511966907, "post_id": 47555005, "comment_id": 82067867, "body": "Thank you @SiddharthRout as well"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1511967167, "post_id": 47555005, "comment_id": 82068087, "body": "Hint: Check what does <code>Debug.Print mycell.entirerow.Hidden</code>, <code>Debug.Print mycell.entirecolumn.Hidden</code> and <code>Debug.Print mycell.parent.visible</code> does? ;)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1511967516, "post_id": 47555005, "comment_id": 82068371, "body": "Think you should be able to manage it, but if you try something and it doesn&#39;t work come back."}, {"owner": {"reputation": 171, "user_id": 7322437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ea623e19c1c869a4eddcac16c673976?s=128&d=identicon&r=PG&f=1", "display_name": "jallington", "link": "https://stackoverflow.com/users/7322437/jallington"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511970295, "post_id": 47555005, "comment_id": 82070531, "body": "I added more to the question. Please advise. @SJR"}], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 7322437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ea623e19c1c869a4eddcac16c673976?s=128&d=identicon&r=PG&f=1", "display_name": "jallington", "link": "https://stackoverflow.com/users/7322437/jallington"}, "edited": false, "score": 0, "creation_date": 1511971909, "post_id": 47556863, "comment_id": 82071657, "body": "This is really close to exactly what I need. This prevents hidden sheets. But i need to expand this to rows and columns. When i tried to add an if statement like you did for the row it did not work. What would you recommend? (I am sorry if I am being difficult, I am a self taught novice)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 171, "user_id": 7322437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ea623e19c1c869a4eddcac16c673976?s=128&d=identicon&r=PG&f=1", "display_name": "jallington", "link": "https://stackoverflow.com/users/7322437/jallington"}, "edited": false, "score": 0, "creation_date": 1511972044, "post_id": 47556863, "comment_id": 82071758, "body": "Oh sorry, have I mis-read, it&#39;s not sheets which are hidden but rows/columns?"}, {"owner": {"reputation": 171, "user_id": 7322437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ea623e19c1c869a4eddcac16c673976?s=128&d=identicon&r=PG&f=1", "display_name": "jallington", "link": "https://stackoverflow.com/users/7322437/jallington"}, "edited": false, "score": 0, "creation_date": 1511972079, "post_id": 47556863, "comment_id": 82071782, "body": "it is both actually :)   ..(sheets, rows, and columns)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 171, "user_id": 7322437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ea623e19c1c869a4eddcac16c673976?s=128&d=identicon&r=PG&f=1", "display_name": "jallington", "link": "https://stackoverflow.com/users/7322437/jallington"}, "edited": false, "score": 1, "creation_date": 1511972284, "post_id": 47556863, "comment_id": 82071902, "body": "OK, code amended above, let me know how you get on."}, {"owner": {"reputation": 171, "user_id": 7322437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ea623e19c1c869a4eddcac16c673976?s=128&d=identicon&r=PG&f=1", "display_name": "jallington", "link": "https://stackoverflow.com/users/7322437/jallington"}, "edited": false, "score": 1, "creation_date": 1511972415, "post_id": 47556863, "comment_id": 82071988, "body": "You are a scholar, a saint, and more. Thank you for your assistance. This does exactly what it should now. :D"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1511972262, "last_edit_date": 1511972262, "creation_date": 1511971041, "answer_id": 47556863, "question_id": 47555005, "link": "https://stackoverflow.com/questions/47555005/excel-vba-show-comments-on-new-sheet-if-the-cell-it-is-in-is-visible/47556863#47556863", "title": "Excel VBA, Show comments on new sheet if the cell it is in is visible", "body": "<p>Code amended to cover visible sheets and then cells which are not hidden.</p>\n\n<pre><code>Sub ShowCommentsAllSheets()\n\nApplication.ScreenUpdating = False\n\nDim commrange As Range\nDim mycell As Range\nDim ws As Worksheet\nDim newwks As Worksheet\nDim i As Long\n\nSet newwks = Worksheets.Add\n\nnewwks.Range(\"A1:E1\").Value = _\n  Array(\"Sheet\", \"Address\", \"Name\", \"Value\", \"Comment\")\n\nFor Each ws In ActiveWorkbook.Worksheets\n    If ws.Visible = xlSheetVisible Then\n        On Error Resume Next\n        Set commrange = ws.Cells.SpecialCells(xlCellTypeComments)\n        On Error GoTo 0\n        If Not commrange Is Nothing Then\n            i = newwks.Cells(Rows.Count, 1).End(xlUp).Row\n         For Each mycell In commrange\n            If Not (mycell.EntireRow.Hidden Or mycell.EntireColumn.Hidden) Then\n                With newwks\n                  i = i + 1\n                  On Error Resume Next\n                  .Cells(i, 1).Value = ws.Name\n                  .Cells(i, 2).Value = mycell.Address\n                  .Cells(i, 3).Value = mycell.Name.Name\n                  .Cells(i, 4).Value = mycell.Value\n                  .Cells(i, 5).Value = mycell.Comment.Text\n                End With\n            End If\n         Next mycell\n        End If\n        Set commrange = Nothing\n        End If\nNext ws\n\nnewwks.Cells.WrapText = False\nnewwks.Columns(\"E:E\").Replace What:=Chr(10), _\nReplacement:=\" \", LookAt:=xlPart, _\nSearchOrder:=xlByRows, MatchCase:=False, _\nSearchFormat:=False, ReplaceFormat:=False\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 7322437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ea623e19c1c869a4eddcac16c673976?s=128&d=identicon&r=PG&f=1", "display_name": "jallington", "link": "https://stackoverflow.com/users/7322437/jallington"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 47556863, "answer_count": 1, "score": 0, "last_activity_date": 1511972262, "creation_date": 1511965304, "last_edit_date": 1511971018, "question_id": 47555005, "link": "https://stackoverflow.com/questions/47555005/excel-vba-show-comments-on-new-sheet-if-the-cell-it-is-in-is-visible", "title": "Excel VBA, Show comments on new sheet if the cell it is in is visible", "body": "<p>The title was hard to keep true to what I need in full so please read all the text.</p>\n\n<p>I am trying to use a button to create a sheet that will show users all the comments on all the worksheets in an easy to understand format that basically acts as the highlights of the workbook. </p>\n\n<p>The issue is the code currently shows ALL comments but I only wish for the person to see currently visible comments. What do I mean? Not all users can see all sheets or all columns and rows. Certain data is hidden because it does not pertain to them. I only want them to see data that is currently visible on any sheet they have as visible. </p>\n\n<p>Example (NOT A REAL SITUATION); an excel document has 3 sheets (Sheet1, Sheet2, Sheet3). John logs in (using a Select Case VBA that hides data he does not need) and can see Sheet1 and Sheet2 but cannot see specific rows in each sheet such as Row 2 and column F in Sheet1 and Row 5 and Column K in Sheet2. He does not need to see the comments for the rows, columns, and sheets he cannot see. </p>\n\n<p>How can I alter the code below to only display comments for cells he can see?</p>\n\n<p>Note: I did not create this code, merely adopted it as it <em>almost</em> suits my needs.</p>\n\n<pre><code>    Sub ShowCommentsAllSheets()\n\n  Application.ScreenUpdating = False\n\n  Dim commrange As Range\n  Dim mycell As Range\n  Dim ws As Worksheet\n  Dim newwks As Worksheet\n  Dim i As Long\n\nSet newwks = Worksheets.Add\n\n newwks.Range(\"A1:E1\").Value = _\n     Array(\"Sheet\", \"Address\", \"Name\", \"Value\", \"Comment\")\n\nFor Each ws In ActiveWorkbook.Worksheets\n  On Error Resume Next\n  Set commrange = ws.Cells.SpecialCells(xlCellTypeComments)\n  On Error GoTo 0\n\n  If commrange Is Nothing Then\n\n  Else\n\n    i = newwks.Cells(Rows.Count, 1).End(xlUp).Row\n\n    For Each mycell In commrange\n       With newwks\n         i = i + 1\n         On Error Resume Next\n         .Cells(i, 1).Value = ws.Name\n         .Cells(i, 2).Value = mycell.Address\n         .Cells(i, 3).Value = mycell.Name.Name\n         .Cells(i, 4).Value = mycell.Value\n         .Cells(i, 5).Value = mycell.Comment.Text\n       End With\n    Next mycell\n  End If\n  Set commrange = Nothing\nNext ws\n\n\nnewwks.Cells.WrapText = False\nnewwks.Columns(\"E:E\").Replace What:=Chr(10), _\n  Replacement:=\" \", LookAt:=xlPart, _\n  SearchOrder:=xlByRows, MatchCase:=False, _\n  SearchFormat:=False, ReplaceFormat:=False\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>I believe I need to add this code to fix the problem:</p>\n\n<pre><code>   Comments = 1\n   For Each MyComments In ActiveSheet.Comments\n       If MyComments.Visible = True Then\n           Comments = 0\n       End If\n   Next\n   If Comments = 1 Then\n       Application.DisplayCommentIndicator = xlCommentAndIndicator\n   Else\n       Application.DisplayCommentIndicator = xlCommentIndicatorOnly\n   End If\n</code></pre>\n\n<p>However, I am struggling to fit this into the code. How should I proceed?</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1511964361, "post_id": 47554679, "comment_id": 82066083, "body": "Nice, beat me to it"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": true, "score": 2, "last_activity_date": 1511964342, "creation_date": 1511964342, "answer_id": 47554679, "question_id": 47554639, "link": "https://stackoverflow.com/questions/47554639/vba-creating-series-in-a-chart/47554679#47554679", "title": "VBA: Creating series in a chart", "body": "<p>The problem is you are using the same <code>Ser</code>, so this is replaced.</p>\n\n<pre><code>With ChtObj\n\n    Set Ser = .Chart.SeriesCollection.NewSeries\n\n    With Ser\n    .Name = \"=\" &amp; Dataws.Cells(CurrentRow, 1).Address(False, False, xlA1, xlExternal)\n    .XValues = \"=\" &amp; Dataws.Cells(CurrentRow, 3).Address(False, False, xlA1, xlExternal)\n    .Values = \"=\" &amp; Dataws.Cells(CurrentRow, 4).Address(False, False, xlA1, xlExternal)\n    End With\n'Series LTA\n\n    Set Ser = .Chart.SeriesCollection.NewSeries\n    With Ser\n    .Name = \"LTA_\" &amp; Dataws.Cells(CurrentRow, 1)\n    .XValues = \"=\" &amp; Dataws.Cells(CurrentRow, 3).Address(False, False, xlA1, xlExternal) &amp; \",\" &amp; Dataws.Range(Dataws.Cells(CurrentRow, 14), Dataws.Cells(CurrentRow, 22)).Address(False, False, xlA1, xlExternal)\n    .Values = \"=\" &amp; Dataws.Cells(CurrentRow, 4).Address(False, False, xlA1, xlExternal) &amp; \",\" &amp; Dataws.Range(Dataws.Cells(CurrentRow, 42), Dataws.Cells(CurrentRow, 50)).Address(False, False, xlA1, xlExternal)\n    End With\nEnd With\n</code></pre>\n\n<p>Try defining a new series again or use a different name for Series2.</p>\n"}], "owner": {"reputation": 31, "user_id": 9014543, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a7c8c299bd396ab1926838aaef3e6f3e?s=128&d=identicon&r=PG&f=1", "display_name": "RuilGaga", "link": "https://stackoverflow.com/users/9014543/ruilgaga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 47554679, "answer_count": 1, "score": 0, "last_activity_date": 1512047756, "creation_date": 1511964223, "last_edit_date": 1512047756, "question_id": 47554639, "link": "https://stackoverflow.com/questions/47554639/vba-creating-series-in-a-chart", "title": "VBA: Creating series in a chart", "body": "<p>I am trying to create two different series but if I run the macro the second series keeps overwriting the first one unfortunately. So that at the end, I only have the second series in my chart. Can anyone help?  </p>\n\n<pre><code>     With ChtObj\n    'Series LTU\n        Set Ser = .Chart.SeriesCollection.NewSeries    \n        With Ser\n        .Name = \"=\" &amp; Dataws.Cells(CurrentRow, 1).Address(False, False, xlA1, xlExternal)\n        .XValues = \"=\" &amp; Dataws.Cells(CurrentRow, 3).Address(False, False, xlA1, xlExternal)\n        .Values = \"=\" &amp; Dataws.Cells(CurrentRow, 4).Address(False, False, xlA1, xlExternal)\n        End With\n    'Series LTA\n        With Ser\n        .Name = \"LTA_\" &amp; Dataws.Cells(CurrentRow, 1)\n        .XValues = \"=\" &amp; Dataws.Cells(CurrentRow, 3).Address(False, False, xlA1, xlExternal) &amp; \",\" &amp; Dataws.Range(Dataws.Cells(CurrentRow, 14), Dataws.Cells(CurrentRow, 22)).Address(False, False, xlA1, xlExternal)\n        .Values = \"=\" &amp; Dataws.Cells(CurrentRow, 4).Address(False, False, xlA1, xlExternal) &amp; \",\" &amp; Dataws.Range(Dataws.Cells(CurrentRow, 42), Dataws.Cells(CurrentRow, 50)).Address(False, False, xlA1, xlExternal)\n        End With\n    End With\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "excel", "filtering", "pivot-table"], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 2054711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a7a39c98132964a6bb60065f154e1362?s=128&d=identicon&r=PG", "display_name": "Penfold0101", "link": "https://stackoverflow.com/users/2054711/penfold0101"}, "edited": false, "score": 0, "creation_date": 1511966246, "post_id": 47555220, "comment_id": 82067349, "body": "This doesn&#39;t quite do what i want.....one of the pivot tables does contain the future date. so I want that to total that pivot, but show zero on the tables that do not.  Thank you very much for the help."}, {"owner": {"reputation": 130, "user_id": 8715626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TrjPp.png?s=128&g=1", "display_name": "Nahuatl_C137", "link": "https://stackoverflow.com/users/8715626/nahuatl-c137"}, "reply_to_user": {"reputation": 87, "user_id": 2054711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a7a39c98132964a6bb60065f154e1362?s=128&d=identicon&r=PG", "display_name": "Penfold0101", "link": "https://stackoverflow.com/users/2054711/penfold0101"}, "edited": false, "score": 0, "creation_date": 1511966483, "post_id": 47555220, "comment_id": 82067531, "body": "Oh, ok sorry I might have misunderstood. Depending on where the error is occurring, perhaps a On Error Resume Next would do the trick. Could you specify in your question which line it errors on?"}, {"owner": {"reputation": 87, "user_id": 2054711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a7a39c98132964a6bb60065f154e1362?s=128&d=identicon&r=PG", "display_name": "Penfold0101", "link": "https://stackoverflow.com/users/2054711/penfold0101"}, "edited": false, "score": 0, "creation_date": 1511966580, "post_id": 47555220, "comment_id": 82067606, "body": "i don&#39;t get any errors at all. the pivot table is set to &quot;all&quot; as it cant find my filter. i shall update the post to be a little more clear. TY"}], "tags": [], "owner": {"reputation": 130, "user_id": 8715626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TrjPp.png?s=128&g=1", "display_name": "Nahuatl_C137", "link": "https://stackoverflow.com/users/8715626/nahuatl-c137"}, "is_accepted": false, "score": 0, "last_activity_date": 1511965976, "creation_date": 1511965976, "answer_id": 47555220, "question_id": 47554352, "link": "https://stackoverflow.com/questions/47554352/pivot-table-how-to-use-vba-to-error-check-automatically-filtered-list/47555220#47555220", "title": "Pivot table, how to use VBA to error check automatically filtered list", "body": "<p>Below are two ways to handle this:</p>\n\n<p>You can use Data > Data Validation. In the setup below, the input has to be less than today's date, else it will not allow the input.</p>\n\n<p><a href=\"https://i.stack.imgur.com/y6tXz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/y6tXz.png\" alt=\"enter image description here\"></a></p>\n\n<p>Or, if you are wanting to use VBA, insert the snippet below right after this line:</p>\n\n<p>If Target.Address = \"$C$6\" Then</p>\n\n<pre><code>Dim stkPeriod As Date\n\nstkPeriod = Range(\"C6\")\n\nIf stkPeriod &gt;= Date Then\n\n    MsgBox \"Use a different date range.\"\n    Exit Sub\n\n    ' or you can do something else such as verifying\n    '    that the date is present within your data table etc.\n\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 87, "user_id": 2054711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a7a39c98132964a6bb60065f154e1362?s=128&d=identicon&r=PG", "display_name": "Penfold0101", "link": "https://stackoverflow.com/users/2054711/penfold0101"}, "edited": false, "score": 0, "creation_date": 1511968447, "post_id": 47555540, "comment_id": 82069121, "body": "Thanks for the option, but i don&#39;t have a break in the data.  I hoped rather than pick Raj or Sid, i could automatically pick blank from the row label. Thanks again for the time and effort."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 1, "last_activity_date": 1511966937, "creation_date": 1511966937, "answer_id": 47555540, "question_id": 47554352, "link": "https://stackoverflow.com/questions/47554352/pivot-table-how-to-use-vba-to-error-check-automatically-filtered-list/47555540#47555540", "title": "Pivot table, how to use VBA to error check automatically filtered list", "body": "<blockquote>\n  <p>i just don't know enough VBA to get it to do what i want!</p>\n</blockquote>\n\n<p>I am going to use the below scenario for demonstration. Please undrstand it and apply it for your case as applicable.</p>\n\n<p>Let's say our data and pivot looks like this</p>\n\n<p><a href=\"https://i.stack.imgur.com/5HSe6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5HSe6.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now the logic that we will follow is</p>\n\n<ol>\n<li>Check if the field exists in the pivottable or not</li>\n<li>If it doesn't exists then hide all items except <code>blank</code>. I am assuming that there is a blank item else you will get an error.</li>\n</ol>\n\n<p>Code</p>\n\n<pre><code>Sub Sample()\n    Dim pt As PivotTable\n    Dim pitem As PivotItem\n\n    For Each pt In ActiveSheet.PivotTables\n        If DoesFieldExist(\"MickyMouse\", pt) Then\n\n        Else\n            '~~&gt; it the field doesnt exist\n            For Each pitem In pt.PivotFields(\"Name\").PivotItems\n               If pitem.Value &lt;&gt; \"(blank)\" Then pitem.Visible = False\n            Next\n        End If\n    Next pt\nEnd Sub\n\n'~~&gt; Function to check if a field exists or not in a pivot table\nFunction DoesFieldExist(fld As String, ptbl As PivotTable) As Boolean\n    For Each pf In ptbl.PageFields\n        If pf.Name = fld Then\n            DoesFieldExist = True\n            Exit Function\n        End If\n    Next pf\nEnd Function\n</code></pre>\n\n<p>When you run the above code, since there is no field called \"MickyMouse\", the items will be hidden.</p>\n\n<p><a href=\"https://i.stack.imgur.com/4Ky0x.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4Ky0x.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 87, "user_id": 2054711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a7a39c98132964a6bb60065f154e1362?s=128&d=identicon&r=PG", "display_name": "Penfold0101", "link": "https://stackoverflow.com/users/2054711/penfold0101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1321, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1511969640, "creation_date": 1511963270, "last_edit_date": 1511969640, "question_id": 47554352, "link": "https://stackoverflow.com/questions/47554352/pivot-table-how-to-use-vba-to-error-check-automatically-filtered-list", "title": "Pivot table, how to use VBA to error check automatically filtered list", "body": "<p>i have been using the code below to set all the pivot tables in a report to filter to the same stock period. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)    \n    On Error Resume Next\n    Application.EnableEvents = False\n    Application.ScreenUpdating = False\n\n    Dim WS As Worksheet\n    Dim pt As PivotTable\n    Const strField As String = \"stkperiod\" 'This is the name of the pivot table filed you wish to change\"\n\n    If Target.Address = \"$C$6\" Then    \n        For Each WS In ThisWorkbook.Worksheets\n            For Each pt In WS.PivotTables\n                With pt.PageFields(strField)\n                    .ClearAllFilters\n                    .PivotItems(\"(blank)\").Visible = True\n                    .CurrentPage = Target.Value\n                End With\n            Next pt\n        Next WS\n    End If\n\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True    \nEnd Sub\n</code></pre>\n\n<p>The Code appears to work very well until the stock period is not found. \nif for example i set the stock period to 12/2018 the pivot tables filter is automatically set to \"all\" results as 2018 is a future date and not part of my data set.<br>\nI would much rather the VBA set the filter to be \"Blank\" if the date is not in the list.</p>\n\n<p>The above code does not give me any errors, but my users are getting confused, they think \"wow we have had a good month already and its only the second day of trading!\" what they don't understand is the report is now set to all results for the year. </p>\n\n<p>The tricky part is the date range in the tables is not always the same. if one pivot has a value for 12/2018 i would like to total that pivot and show zero on the others that do not have data for this date. </p>\n\n<p>I assumed if i could make the report pick from the below list, i could make it pick the blank option. \n<a href=\"https://i.stack.imgur.com/7ISsm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7ISsm.png\" alt=\"Pivot Filter\"></a></p>\n\n<p>I though this would be fairly simple.....can't i pre-filter all pivots to be \"blank\" and then after apply my custom filter? but i just don't know enough VBA to get it to do what i want!</p>\n\n<p>Any help you could offer would be amazing, thank you for your time.\nR.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1511962466, "post_id": 47554017, "comment_id": 82064751, "body": "Can you elaborate more on the issue. I&#39;m not quite sure your issue is understandable"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 1, "creation_date": 1511962684, "post_id": 47554017, "comment_id": 82064928, "body": "Maybe could help if you read &gt; <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a>"}, {"owner": {"reputation": 2344, "user_id": 8461786, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/55878061e134ad81c5d169881b3c6d2e?s=128&d=identicon&r=PG&f=1", "display_name": "barciewicz", "link": "https://stackoverflow.com/users/8461786/barciewicz"}, "edited": false, "score": 0, "creation_date": 1511963708, "post_id": 47554017, "comment_id": 82065627, "body": "Thanks, I have edited my question to be more understandable."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1511963831, "post_id": 47554017, "comment_id": 82065713, "body": "what is <code>cell.Style</code> ? what are you trying to achieve ?"}, {"owner": {"reputation": 2344, "user_id": 8461786, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/55878061e134ad81c5d169881b3c6d2e?s=128&d=identicon&r=PG&f=1", "display_name": "barciewicz", "link": "https://stackoverflow.com/users/8461786/barciewicz"}, "edited": false, "score": 0, "creation_date": 1511964087, "post_id": 47554017, "comment_id": 82065899, "body": "It&#39;s like changing cell&#39;s style on the ribbon."}], "answers": [{"comments": [{"owner": {"reputation": 2344, "user_id": 8461786, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/55878061e134ad81c5d169881b3c6d2e?s=128&d=identicon&r=PG&f=1", "display_name": "barciewicz", "link": "https://stackoverflow.com/users/8461786/barciewicz"}, "edited": false, "score": 0, "creation_date": 1511971181, "post_id": 47554702, "comment_id": 82071146, "body": "Thanks Storax, what worked for me was changing &quot;If cell.Value = &quot;Error 2023&quot; in my code to IfError(cell). Therefore marking your answer as best one."}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 1, "last_activity_date": 1511964780, "last_edit_date": 1511964780, "creation_date": 1511964418, "answer_id": 47554702, "question_id": 47554017, "link": "https://stackoverflow.com/questions/47554017/if-and-not-working/47554702#47554702", "title": "If And not working", "body": "<p>Try the following approach</p>\n\n<pre><code>Sub ErrTest()\n    Dim cell As Range\n    Dim errval As String\n    Set cell = Range(\"A1\")\n    If IsError(cell) Then\n        errval = cell.Value\n        Select Case errval\n            Case CVErr(xlErrDiv0)\n                MsgBox \"#DIV/0! error\"\n            Case CVErr(xlErrNA)\n                MsgBox \"#N/A error\"\n            Case CVErr(xlErrName)\n                MsgBox \"#NAME? error\"\n            Case CVErr(xlErrNull)\n                MsgBox \"#NULL! error\"\n            Case CVErr(xlErrNum)\n                MsgBox \"#NUM! error\"\n            Case CVErr(xlErrRef)\n                MsgBox \"#REF! error\"\n            Case CVErr(xlErrValue)\n                MsgBox \"#VALUE! error\"\n            Case Else\n                MsgBox \"This should never happen!!\"\n        End Select\n    End If\nEnd Sub\n</code></pre>\n\n<p>Here is the docu <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/cell-error-values\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/cell-error-values</a></p>\n\n<p>For your situation you could use the following function</p>\n\n<pre><code>Function refError(cell As Range) As Boolean\n    Dim errval As Variant\n    If IsError(cell) Then\n        errval = cell.Value\n        If errval = CVErr(xlErrRef) Then refError = True\n    End If\nEnd Function\n</code></pre>\n\n<p>And your code would be then like</p>\n\n<pre><code>For Each cell In Final.Worksheets(\"PIVOT\").UsedRange.Cells.SpecialCells(xlFormulas)\n    If refError(cell) And cell.Offset(0, -3).Value = \"Gesamtergebnis\" Then cell.Style = \"Bad\"\nNext cell\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 3, "last_activity_date": 1511965157, "last_edit_date": 1511965157, "creation_date": 1511964844, "answer_id": 47554837, "question_id": 47554017, "link": "https://stackoverflow.com/questions/47554017/if-and-not-working/47554837#47554837", "title": "If And not working", "body": "<p>The better way to handle your case is to use <code>SpecialCells</code> with the parameter <code>16</code>. <code>SpecialCells</code> with these arguments lets you select the errors in formulas within a range.</p>\n\n<p>Is this what you are trying?</p>\n\n<pre><code>Sub Sample()\n    Dim ErrRange As Range\n    Dim rng As Range\n    Dim aCell As Range\n\n    Set rng = Final.Worksheets(\"PIVOT\").UsedRange.Cells\n\n    On Error Resume Next\n    Set ErrRange = rng.SpecialCells(xlCellTypeFormulas, 16)\n    On Error GoTo 0\n\n    If Not ErrRange Is Nothing Then\n        For Each aCell In ErrRange\n            If aCell.Offset(, -3).Value = \"Gesamtergebnis\" Then aCell.Style = \"Bad\"\n        Next aCell\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>Screenshot</strong></p>\n\n<p>I am using <code>aCell.Interior.ColorIndex = 3</code> instead of <code>aCell.Style = \"Bad\"</code> for demonstration purpose below. It colors the cell red.</p>\n\n<p><a href=\"https://i.stack.imgur.com/czYDP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/czYDP.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 2344, "user_id": 8461786, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/55878061e134ad81c5d169881b3c6d2e?s=128&d=identicon&r=PG&f=1", "display_name": "barciewicz", "link": "https://stackoverflow.com/users/8461786/barciewicz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 1, "accepted_answer_id": 47554702, "answer_count": 2, "score": 0, "last_activity_date": 1511965157, "creation_date": 1511962136, "last_edit_date": 1511963681, "question_id": 47554017, "link": "https://stackoverflow.com/questions/47554017/if-and-not-working", "title": "If And not working", "body": "<p>The following code excerpt is meant to change a cell's style to \"Bad\" if the cell has a formula error \"#REF!\" and the cell 3 columns left to it HAS NOT \"Gesamtergebnis\" text in it.\nBut why does the following code color also the cell that HAS \"Gesamtergebnis\" written three cells left of it, as if the second part of \"AND\" clause was ignored?</p>\n\n<pre><code>For Each cell In Final.Worksheets(\"PIVOT\").UsedRange.Cells.SpecialCells(xlFormulas)\n    If cell.Value = \"Error 2023\" And cell.Offset(0, -3).Value = \"Gesamtergebnis\" Then cell.Style = \"Bad\"\nNext cell\n</code></pre>\n\n<p>Thanks,\nBartek</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1511961680, "post_id": 47553744, "comment_id": 82064247, "body": "Start with putting Option Explicit at the top of the code and then compiling and see if it flags anything"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511961819, "post_id": 47553744, "comment_id": 82064353, "body": "Target is out of scope for LoopVBA in version 2. It would need to be passed as an expected parameter to LoopVBA"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 3, "creation_date": 1511961971, "post_id": 47553744, "comment_id": 82064434, "body": "You need some <code>Target Practice</code> :D"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1511962049, "post_id": 47553744, "comment_id": 82064488, "body": "Yes you cannot have more than 1 <code>Worksheet_Change</code> event but you can have multiple conditions in 1 <code>Worksheet_Change</code> :) What exactly are you achieve?"}, {"owner": {"reputation": 31, "user_id": 9019920, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ba47f66309da5e73f5a0c2f017b7e17c?s=128&d=identicon&r=PG&f=1", "display_name": "geocc", "link": "https://stackoverflow.com/users/9019920/geocc"}, "edited": false, "score": 0, "creation_date": 1511962686, "post_id": 47553744, "comment_id": 82064931, "body": "@ Siddharth Rout: I just want to call the vba loop code under &quot;Private Sub Worksheet_Change(ByVal Target As Range)&quot; as I did with the other codes I wrote.. How can I set &quot;Target Practice&quot;? Thanks"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1511964338, "post_id": 47553744, "comment_id": 82066067, "body": "Target practice usually refers to any exercise in which projectiles are fired at a specified target. You do not have to throw projectiles but yes, you have to understand what <code>target</code> means here. Why are you using it like <code>TestRow = Target.Row</code>? What kind of object <code>Target</code> is? What error are you getting? Why are you getting the error that you are getting? What is the meaning of that error? How can you resolve that error? Try debugging the code. This is what I meant by <code>Target Practice</code> which I used humorously :) I can give you the code but I doubt you will learn from it :)"}, {"owner": {"reputation": 31, "user_id": 9019920, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ba47f66309da5e73f5a0c2f017b7e17c?s=128&d=identicon&r=PG&f=1", "display_name": "geocc", "link": "https://stackoverflow.com/users/9019920/geocc"}, "edited": false, "score": 0, "creation_date": 1511964813, "post_id": 47553744, "comment_id": 82066402, "body": "I use TestRow = Target.Row in order to get the last edited Row number no matter what cell is next. Same thing for Test.Column. Yes, i might not learn from it as I just started writing VBA code. All i did until now, was based on logical thinking, and as you can see my vba loop code is pretty simple to read and understand. True is that i don&#39;t have the theory knowledge to go behind the meanings. That is why I am asking."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 9019920, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ba47f66309da5e73f5a0c2f017b7e17c?s=128&d=identicon&r=PG&f=1", "display_name": "geocc", "link": "https://stackoverflow.com/users/9019920/geocc"}, "edited": false, "score": 0, "creation_date": 1511962501, "post_id": 47553998, "comment_id": 82064775, "body": "Would you please explain me what &quot;$A$1&quot; stands for? Thanks"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 31, "user_id": 9019920, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ba47f66309da5e73f5a0c2f017b7e17c?s=128&d=identicon&r=PG&f=1", "display_name": "geocc", "link": "https://stackoverflow.com/users/9019920/geocc"}, "edited": false, "score": 0, "creation_date": 1511962685, "post_id": 47553998, "comment_id": 82064930, "body": "It was an example use case for a cell that changed. I have edited it out. The key part, in relation to the likely cause of the object required error is the lack of Target being available to the sub loopvba."}, {"owner": {"reputation": 31, "user_id": 9019920, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ba47f66309da5e73f5a0c2f017b7e17c?s=128&d=identicon&r=PG&f=1", "display_name": "geocc", "link": "https://stackoverflow.com/users/9019920/geocc"}, "edited": false, "score": 0, "creation_date": 1511963774, "post_id": 47553998, "comment_id": 82065674, "body": "So based on what I understood, I put the code like this, but is not working:                                                                                                                               Private Sub Worksheet_Change(ByVal Target As Range)  If Not Application.Intersect(Range(&quot;E11:BL10000&quot;), Target) Is Nothing Then     loopvba Target End If"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 31, "user_id": 9019920, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ba47f66309da5e73f5a0c2f017b7e17c?s=128&d=identicon&r=PG&f=1", "display_name": "geocc", "link": "https://stackoverflow.com/users/9019920/geocc"}, "edited": false, "score": 0, "creation_date": 1511963851, "post_id": 47553998, "comment_id": 82065728, "body": "What error message are you getting and on what line? Use F8 to step through. It may be you have other errors which is why Option Explicit is useful."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 31, "user_id": 9019920, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ba47f66309da5e73f5a0c2f017b7e17c?s=128&d=identicon&r=PG&f=1", "display_name": "geocc", "link": "https://stackoverflow.com/users/9019920/geocc"}, "edited": false, "score": 0, "creation_date": 1511964151, "post_id": 47553998, "comment_id": 82065942, "body": "Did you also amend the loopvba code  signature to Sub loopvba(ByRef Target As Range)? Step through the code with F8 as there may be more than one problem to resolve."}, {"owner": {"reputation": 31, "user_id": 9019920, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ba47f66309da5e73f5a0c2f017b7e17c?s=128&d=identicon&r=PG&f=1", "display_name": "geocc", "link": "https://stackoverflow.com/users/9019920/geocc"}, "edited": false, "score": 0, "creation_date": 1511964293, "post_id": 47553998, "comment_id": 82066034, "body": "If I use F8 and go through the code, I don&#39;t get any error. It might be because I am not calling right loop under Private Sub Worksheet_Change... I posted above how i wrote it."}, {"owner": {"reputation": 31, "user_id": 9019920, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ba47f66309da5e73f5a0c2f017b7e17c?s=128&d=identicon&r=PG&f=1", "display_name": "geocc", "link": "https://stackoverflow.com/users/9019920/geocc"}, "edited": false, "score": 0, "creation_date": 1511964331, "post_id": 47553998, "comment_id": 82066057, "body": "yes, I did this as well: Sub loopvba(ByRef Target As Range)"}, {"owner": {"reputation": 31, "user_id": 9019920, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ba47f66309da5e73f5a0c2f017b7e17c?s=128&d=identicon&r=PG&f=1", "display_name": "geocc", "link": "https://stackoverflow.com/users/9019920/geocc"}, "edited": false, "score": 0, "creation_date": 1511964385, "post_id": 47553998, "comment_id": 82066099, "body": "I think this is what I am using it wrong: Private Sub Worksheet_Change(ByVal Target As Range)  If Not Application.Intersect(Range(&quot;E11:BL10000&quot;), Target) Is Nothing Then     loopvba Target End If"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1511962604, "last_edit_date": 1511962604, "creation_date": 1511962090, "answer_id": 47553998, "question_id": 47553744, "link": "https://stackoverflow.com/questions/47553744/loop-doesnt-work-when-i-call-it-in-private-sub-change/47553998#47553998", "title": "Loop doesn&#39;t work when I call it in Private Sub Change", "body": "<p>Target is out of scope for loopvba in version 2. It would need to be passed as an expected parameter.</p>\n\n<pre><code>Sub loopvba(ByRef Target As Range)\n\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n'code\n\n    loopvba Target\n\n'code\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9019920, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ba47f66309da5e73f5a0c2f017b7e17c?s=128&d=identicon&r=PG&f=1", "display_name": "geocc", "link": "https://stackoverflow.com/users/9019920/geocc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 47553998, "answer_count": 1, "score": 0, "last_activity_date": 1511962604, "creation_date": 1511961288, "question_id": 47553744, "link": "https://stackoverflow.com/questions/47553744/loop-doesnt-work-when-i-call-it-in-private-sub-change", "title": "Loop doesn&#39;t work when I call it in Private Sub Change", "body": "<p>I have this long loop written. If I use the code as it is pasted in (1) works without any problem. The loop code basically takes into consideration multiple  columns which have similar text and sums up the total value of the data in another column. As I said, (1) works without any problem. </p>\n\n<p>(1) </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim TestRow As Integer\n\nDim TestColumn As Integer\n\nDim Sum As Integer\n\nTestRow = Target.Row\n\nTestColumn = Target.Column\n\n    If (TestColumn = 64) Then\n\n\n        If (TestRow &gt; 11) Then\n            Sum = 0\n            EColumnValue = 0\n            FColumnValue = 0\n            IColumnValue = 0\n            APColumnValue = 0\n            AQColumnValue = 0\n\n            For i = TestRow To 11 Step -1\n\n                If (i = TestRow) Then\n\n                    Sum = ThisWorkbook.Sheets(\"New\").Cells(TestRow, 64).Value\n                    EColumnValue = ThisWorkbook.Sheets(\"New\").Cells(TestRow, 5).Value\n                    FColumnValue = ThisWorkbook.Sheets(\"New\").Cells(TestRow, 6).Value\n                    IColumnValue = ThisWorkbook.Sheets(\"New\").Cells(TestRow, 9).Value\n                    APColumnValue = ThisWorkbook.Sheets(\"New\").Cells(TestRow, 42).Value\n                    AQColumnValue = ThisWorkbook.Sheets(\"New\").Cells(TestRow, 43).Value\n                Else\n\n                    If (EColumnValue = ThisWorkbook.Sheets(\"New\").Cells(i, 5).Value) And (FColumnValue = ThisWorkbook.Sheets(\"New\").Cells(i, 6).Value) And (IColumnValue = ThisWorkbook.Sheets(\"New\").Cells(i, 9).Value) And (APColumnValue = ThisWorkbook.Sheets(\"New\").Cells(i, 42).Value) And (AQColumnValue = ThisWorkbook.Sheets(\"New\").Cells(i, 43).Value) Then\n                        Sum = Sum + ThisWorkbook.Sheets(\"New\").Cells(i, 64).Value\n\n                        If (Sum &gt; 100) Then\n                            MsgBox \"Similar values entered in columns E, F, I, AP and AQ equals more then 100\"\n                            MsgBox \"Please re-enter the correct value in column BL\"\n                            ThisWorkbook.Sheets(\"New\").Cells(TestRow, 64).Value = \"\"\n\n                            End If\n                    Else\n\n                    End If\n                End If\n            Next\n\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Instead if I write the code as in (2) I receive the error \"run-time error 424\". </p>\n\n<pre><code>Sub loopvba()\n\nDim TestRow As Integer\nDim TestColumn As Integer\nDim Sum As Integer\n\nTestRow = Target.Row\nTestColumn = Target.Column\n\n    If (TestColumn = 64) Then\n\n\n        If (TestRow &gt; 11) Then\n            Sum = 0\n            EColumnValue = 0\n            FColumnValue = 0\n            IColumnValue = 0\n            APColumnValue = 0\n            AQColumnValue = 0\n\n            For i = TestRow To 11 Step -1\n\n                If (i = TestRow) Then\n\n                    Sum = ThisWorkbook.Sheets(\"New\").Cells(TestRow, 64).Value\n                    EColumnValue = ThisWorkbook.Sheets(\"New\").Cells(TestRow, 5).Value\n                    FColumnValue = ThisWorkbook.Sheets(\"New\").Cells(TestRow, 6).Value\n                    IColumnValue = ThisWorkbook.Sheets(\"New\").Cells(TestRow, 9).Value\n                    APColumnValue = ThisWorkbook.Sheets(\"New\").Cells(TestRow, 42).Value\n                    AQColumnValue = ThisWorkbook.Sheets(\"New\").Cells(TestRow, 43).Value\n                Else\n\n                    If (EColumnValue = ThisWorkbook.Sheets(\"New\").Cells(i, 5).Value) And (FColumnValue = ThisWorkbook.Sheets(\"New\").Cells(i, 6).Value) And (IColumnValue = ThisWorkbook.Sheets(\"New\").Cells(i, 9).Value) And (APColumnValue = ThisWorkbook.Sheets(\"New\").Cells(i, 42).Value) And (AQColumnValue = ThisWorkbook.Sheets(\"New\").Cells(i, 43).Value) Then\n                        Sum = Sum + ThisWorkbook.Sheets(\"New\").Cells(i, 64).Value\n\n                        If (Sum &gt; 100) Then\n                            MsgBox \"Similar values entered in columns E, F, I, AP and AQ equals more then 100\"\n                            MsgBox \"Please re-enter the correct value in column BL\"\n                            ThisWorkbook.Sheets(\"New\").Cells(TestRow, 64).Value = \"\"\n\n                            End If\n                    Else\n\n                    End If\n                End If\n            Next\n\n        End If\n    End If\n\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nCall loopvba\n\nEnd Sub\n</code></pre>\n\n<p>The reason why I don't want to use the first code (1) is because in my worksheet I have other VBAs code working based on <strong>Private Sub Worksheet_Change(ByVal Target As Range)</strong>. Henceforth, I google it and I found out that you cannot have more than 1 <strong>Private Sub Worksheet_Change(ByVal Target As Range)</strong> in your worksheet.</p>\n\n<p>How can i make my loop code to be integrated and work with the other vba codes i wrote under <strong>Private Sub Worksheet_Change(ByVal Target As Range)</strong>. I attached a photo below, so maybe is easier for you to understand my question. Thanks<img src=\"https://i.stack.imgur.com/bvXhh.png\" alt=\"![enter image description here\">]<a href=\"https://i.stack.imgur.com/bvXhh.png\" rel=\"nofollow noreferrer\">1</a></p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 2, "last_activity_date": 1511962564, "creation_date": 1511962564, "answer_id": 47554154, "question_id": 47553719, "link": "https://stackoverflow.com/questions/47553719/how-to-run-a-code-if-in-range-has-non-blank-cell/47554154#47554154", "title": "How to run a code if in range has non blank cell?", "body": "<p>When you are working with <code>.SpecialCells</code>, you have to be careful. It there is no match found you will get an error.</p>\n\n<p>Try it like this (<strong>UNTESTED</strong>)</p>\n\n<pre><code>Sub Sample()\n    Dim rng As Range\n\n    On Error Resume Next\n    Set rng = Range(\"A1\").CurrentRegion.SpecialCells(xlCellTypeBlanks)\n    On Error GoTo 0\n\n    If Not rng Is Nothing Then '&lt;~~ Check if there were blank cells found\n        rng.Value = 0\n        '\n        '~~&gt; Rest of the code\n        '        \n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>Tip:</strong> Also avoid the use of <code>.Activate/.Select</code>. You may want to see <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></p>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 8505098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fef8d3bc3416d1f92817b306ea3d1?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar", "link": "https://stackoverflow.com/users/8505098/khazar"}, "edited": false, "score": 0, "creation_date": 1512023497, "post_id": 47554452, "comment_id": 82091946, "body": "R.Roe, thank your answer.  But I didn&#39;t just copy. I need to find blank cells on range if I have and put something on those blank cells. The code which I wrote works when I have blank cells. But if on range has no blank it gives error. I try to solve it."}], "tags": [], "owner": {"reputation": 609, "user_id": 8453036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/369b931407d4e81468045e4084aa357c?s=128&d=identicon&r=PG&f=1", "display_name": "R. Roe", "link": "https://stackoverflow.com/users/8453036/r-roe"}, "is_accepted": false, "score": 1, "last_activity_date": 1511963596, "creation_date": 1511963596, "answer_id": 47554452, "question_id": 47553719, "link": "https://stackoverflow.com/questions/47553719/how-to-run-a-code-if-in-range-has-non-blank-cell/47554452#47554452", "title": "How to run a code if in range has non blank cell?", "body": "<p>You shouldn't have to worry about whether there are empty cells or not.  If you are trying to copy a <code>UsedRange</code> you could do something as simple as this:</p>\n\n<pre><code>AtiveSheet.Range(\"$A$1:\" &amp; ActiveSheet.UsedRange.Address).copy\n</code></pre>\n\n<p>That will copy every cell in the active sheet whether it's empty or not in the <code>UsedRange</code> which means if you only have one cell populated at <code>d20</code> it will copy everything from <code>A1:D20</code>. </p>\n\n<p>Also I think you might have your if statement backwards I think your if condition should be:</p>\n\n<pre><code>If ActiveCell.CurrentRegion.SpecialCells(xlCellTypeBlanks) = True Then\n</code></pre>\n\n<p>If it finds blank cells then set their value.</p>\n"}], "owner": {"reputation": 83, "user_id": 8505098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fef8d3bc3416d1f92817b306ea3d1?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar", "link": "https://stackoverflow.com/users/8505098/khazar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 717, "favorite_count": 0, "accepted_answer_id": 47554154, "answer_count": 2, "score": 1, "last_activity_date": 1511975987, "creation_date": 1511961186, "last_edit_date": 1531161705, "question_id": 47553719, "link": "https://stackoverflow.com/questions/47553719/how-to-run-a-code-if-in-range-has-non-blank-cell", "title": "How to run a code if in range has non blank cell?", "body": "<p>I got A1:D17 Range. If in my range has blank cells my code works but vice versa it doesn't work. </p>\n\n<p>Please help to find out problem.</p>\n\n<p>And I wrote this code:</p>\n\n<pre><code>Sub Example\n    Workbooks(\"Training_VBA Codes\").Activate\n    Worksheets(\"Practice 4\").Activate\n    Range(\"A1\").Select\n\n    If ActiveCell.CurrentRegion.SpecialCells(xlCellTypeBlanks) = False Then\n\n        ActiveCell.CurrentRegion.SpecialCells(xlCellTypeBlanks).Value = 0\n        Range(ActiveCell, ActiveCell.End(xlDown).End(xlToRight)).Copy\n\n    Else\n\n        Range(ActiveCell, ActiveCell.End(xlDown).End(xlToRight)).Copy\n\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "class"], "comments": [{"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1512251975, "post_id": 47553708, "comment_id": 82184309, "body": "I would recommend to start using some .net language like e.g. c# where you need classes all the time and this way you will &#39;understand&#39; and learn what they are good for and how to identify them. Then when you move back to VBA you will already &#39;know&#39;."}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1512645591, "post_id": 47553708, "comment_id": 82346910, "body": "@dee Thank you! I actually did buy a book entitled <i>The C# Player&#39;s Guide Second Edition</i> and started reading it again. Maybe that will give me some insight on how to make class decisions."}], "answers": [{"comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 1, "creation_date": 1511964525, "post_id": 47553961, "comment_id": 82066190, "body": "But building a library of reusable Functions may also be just as good..."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 2, "last_activity_date": 1511961990, "last_edit_date": 1525816189, "creation_date": 1511961990, "answer_id": 47553961, "question_id": 47553708, "link": "https://stackoverflow.com/questions/47553708/determining-vba-classes/47553961#47553961", "title": "Determining VBA Classes", "body": "<p>When you work with code that can be reusable, this is the perfect time to use classes.</p>\n\n<p>You need to create classes that have procedure to handle errors and possible wrong entries. As much robust you can create your code, your class will work as you expect.\nI worked with PowerPoint and build some classes to manipulate document properties, another to manipulate slides, another to resize shapes.</p>\n\n<p>You can find several classes examples from Chip Pearson site and you can figure out how to make your own classes.</p>\n\n<blockquote>\n  <p><a href=\"http://www.cpearson.com/Downloads/Downloads.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/Downloads/Downloads.aspx</a></p>\n</blockquote>\n\n<p>Hope this helps.</p>\n"}, {"comments": [{"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1511963069, "post_id": 47554130, "comment_id": 82065206, "body": "I actually do have an interface called <code>IShape</code> with a method called <code>Draw</code>. But it is difficult to reach the other properties of each class that are not a part of the interface when looping through a collection of different objects. More generally, I just want to know if there is a method for deciding on classes. It may be too subjective of a question."}], "tags": [], "owner": {"reputation": 482, "user_id": 64100, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FSSa4.png?s=128&g=1", "display_name": "PeterI", "link": "https://stackoverflow.com/users/64100/peteri"}, "is_accepted": false, "score": 1, "last_activity_date": 1511962466, "creation_date": 1511962466, "answer_id": 47554130, "question_id": 47553708, "link": "https://stackoverflow.com/questions/47553708/determining-vba-classes/47554130#47554130", "title": "Determining VBA Classes", "body": "<p>VBA (which is almost the same as Visual Basic 6) doesn't support inheritance.</p>\n\n<p>So you have some options, using Interfaces would the normal way to deal with this, so probably three classes each on which implements the IDrawable interface. You may want to have a base class that deals with these features and have the outer classes call down to the base.</p>\n\n<p>IDrawable might have public members for drawing, position, color and penwidth with the other parameters being part of the individual classes.</p>\n\n<p>In particular you should read up on the Liskov substitution principle. I've seen examples of it using rectangles and squares as examples of what not to do.</p>\n\n<p>See this older question for example <a href=\"https://stackoverflow.com/questions/1030521/is-deriving-square-from-rectangle-a-violation-of-liskovs-substitution-principle\">Is deriving square from rectangle a violation of Liskov&#39;s Substitution Principle?</a></p>\n"}, {"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 0, "last_activity_date": 1511964456, "creation_date": 1511964456, "answer_id": 47554710, "question_id": 47553708, "link": "https://stackoverflow.com/questions/47553708/determining-vba-classes/47554710#47554710", "title": "Determining VBA Classes", "body": "<p>I have been using VBA for over 20 years, and made very little use of class modules.<br>\nThe most useful cases for me were to build classes representing some structured spreadsheets or complex text files (with logical rows spanning over several physical lines) you may have to query or browse.<br>\nYou can then implement a <code>.MoveNext</code> method and some properties like <code>.EoF</code>, <code>.Price</code>, <code>.Rate</code> to read them sequentially, being able to reuse that class everywhere you use that specific input file 'layout', and having the complex logic encapsulated in the class.</p>\n"}], "owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1511964456, "creation_date": 1511961137, "last_edit_date": 1511963946, "question_id": 47553708, "link": "https://stackoverflow.com/questions/47553708/determining-vba-classes", "title": "Determining VBA Classes", "body": "<p>I apologize in advance if this is a \"downvotable\" question but I really need help in understanding how to know what to make classes out of in a VBA project. </p>\n\n<p><em>NOTE</em>: I am not asking how to code a class. I am asking how to determine what to make a class for. </p>\n\n<p><strong>Example</strong></p>\n\n<p>I want to draw shapes on a PowerPoint slide. 2 of the 3 kinds of shapes I need to draw have the same properties and methods. Would I create one class called <code>CShape</code> or 3 classes: <code>CCircle</code>, <code>CSquare</code>, <code>CRectangle</code>? Furthermore, lines are considered shapes in PowerPoint. Should I add a <code>CLine</code> class or just lump everything together in <code>CShape</code>?</p>\n\n<p>I have searched Google for <em>Methodologies on determining classes in VBA</em> and the like but can not find anything. Does anybody out there have a method or way they go about determining how to create classes for their projects (and the reasons behind it)? </p>\n\n<p>Also, I am just getting into classes and interfaces and this is the first project I am using them in. Thanks!</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I did find this: <a href=\"https://stackoverflow.com/questions/118863/when-to-use-a-class-in-vba\">When to use a Class in VBA?</a></p>\n"}, {"tags": ["vba", "excel", "loops", "webpage"], "comments": [{"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1511965147, "post_id": 47553477, "comment_id": 82066622, "body": "Try doevents or application.wait(estimate time taken). You would also need to retrieve the output."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9025677, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ghi1ZOZ-qh8/AAAAAAAAAAI/AAAAAAAAACc/kcaIFS1X-mk/photo.jpg?sz=128", "display_name": "tanvir ahmed", "link": "https://stackoverflow.com/users/9025677/tanvir-ahmed"}, "edited": false, "score": 0, "creation_date": 1511970309, "post_id": 47554982, "comment_id": 82070536, "body": "Hi, Thank you for the idea. I actually didn&#39;t show here date input in order to shorten the code. I used only input variable to show it. BTW, I tried adding your code but no luck."}, {"owner": {"reputation": 130, "user_id": 8715626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TrjPp.png?s=128&g=1", "display_name": "Nahuatl_C137", "link": "https://stackoverflow.com/users/8715626/nahuatl-c137"}, "reply_to_user": {"reputation": 3, "user_id": 9025677, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ghi1ZOZ-qh8/AAAAAAAAAAI/AAAAAAAAACc/kcaIFS1X-mk/photo.jpg?sz=128", "display_name": "tanvir ahmed", "link": "https://stackoverflow.com/users/9025677/tanvir-ahmed"}, "edited": false, "score": 0, "creation_date": 1511970423, "post_id": 47554982, "comment_id": 82070615, "body": "Could you post the entire code, and some test data?"}, {"owner": {"reputation": 3, "user_id": 9025677, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ghi1ZOZ-qh8/AAAAAAAAAAI/AAAAAAAAACc/kcaIFS1X-mk/photo.jpg?sz=128", "display_name": "tanvir ahmed", "link": "https://stackoverflow.com/users/9025677/tanvir-ahmed"}, "edited": false, "score": 0, "creation_date": 1511971339, "post_id": 47554982, "comment_id": 82071271, "body": "Hey bro, the following code worked.  <code>While objIE.Busy         DoEvents Wend</code>  I know this and your code is same but dont know why it did not worked"}, {"owner": {"reputation": 130, "user_id": 8715626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TrjPp.png?s=128&g=1", "display_name": "Nahuatl_C137", "link": "https://stackoverflow.com/users/8715626/nahuatl-c137"}, "reply_to_user": {"reputation": 3, "user_id": 9025677, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ghi1ZOZ-qh8/AAAAAAAAAAI/AAAAAAAAACc/kcaIFS1X-mk/photo.jpg?sz=128", "display_name": "tanvir ahmed", "link": "https://stackoverflow.com/users/9025677/tanvir-ahmed"}, "edited": false, "score": 0, "creation_date": 1511971430, "post_id": 47554982, "comment_id": 82071327, "body": "Perfect! I used to generally use that instead of ReadyState. However, it seems like this sometimes doesn&#39;t work. They are practically the same thing. <a href=\"https://stackoverflow.com/questions/10071048/internet-explorer-automation-busy-v-s-readystate-property\" title=\"internet explorer automation busy v s readystate property\">stackoverflow.com/questions/10071048/&hellip;</a>"}], "tags": [], "owner": {"reputation": 130, "user_id": 8715626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TrjPp.png?s=128&g=1", "display_name": "Nahuatl_C137", "link": "https://stackoverflow.com/users/8715626/nahuatl-c137"}, "is_accepted": true, "score": 0, "last_activity_date": 1511965223, "creation_date": 1511965223, "answer_id": 47554982, "question_id": 47553477, "link": "https://stackoverflow.com/questions/47553477/excel-vba-loop-to-input-data-in-webpage/47554982#47554982", "title": "Excel VBA loop to input data in webpage", "body": "<p>Where is the code to enter the dates? You cannot click without them.</p>\n\n<blockquote>\n  <p>\"then wait for the page to load and input the second date\"</p>\n</blockquote>\n\n<p>you can achieve this by inserting the following between your End If and Loop lines.</p>\n\n<pre><code>    'Allows IE to load\n    While objIE.ReadyState &lt;&gt; 4\n        DoEvents\n    Wend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9025677, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ghi1ZOZ-qh8/AAAAAAAAAAI/AAAAAAAAACc/kcaIFS1X-mk/photo.jpg?sz=128", "display_name": "tanvir ahmed", "link": "https://stackoverflow.com/users/9025677/tanvir-ahmed"}, "edited": false, "score": 0, "creation_date": 1512117957, "post_id": 47578644, "comment_id": 82136266, "body": "Thank you for the response bro, this while loop in my code solved the priblem   <code>While objIE.Busy  DoEvents  Wend</code>"}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1512060958, "creation_date": 1512060958, "answer_id": 47578644, "question_id": 47553477, "link": "https://stackoverflow.com/questions/47553477/excel-vba-loop-to-input-data-in-webpage/47578644#47578644", "title": "Excel VBA loop to input data in webpage", "body": "<p>This shouldn't be too hard.  I went to that URL, hit F12 to see the code behind the site, and started searching for the appropriate ID names ('Principal:', 'Loss Date:', etc).  That's about it.  Run the script to see a working version.  Oh, yeah, set a reference to 'Microsoft Internet Controls' before you run the code.</p>\n\n<pre><code>Sub TryThis()\n\nDim ie As SHDocVw.InternetExplorer\nSet ie = New SHDocVw.InternetExplorer\nie.Visible = True\nie.Navigate \"https://www.askebsa.dol.gov/VFCPCalculator/WebCalculator.aspx\"\n\nDo\nDoEvents\nLoop Until ie.readystate = 4\n'ie READYSTATE has 5 different status codes, here we are using status 4:\n\nCall ie.Document.GetElementByID(\"_ctl0_MainContent_txtPrincipal\").SetAttribute(\"value\", \"100000\")\nCall ie.Document.GetElementByID(\"_ctl0_MainContent_txtLossDateMonth\").SetAttribute(\"value\", \"01\")\nCall ie.Document.GetElementByID(\"_ctl0_MainContent_txtLossDateDay\").SetAttribute(\"value\", \"01\")\nCall ie.Document.GetElementByID(\"_ctl0_MainContent_txtLossDateYear\").SetAttribute(\"value\", \"2016\")\n\nCall ie.Document.GetElementByID(\"_ctl0_MainContent_txtRecoveryDateMonth\").SetAttribute(\"value\", \"01\")\nCall ie.Document.GetElementByID(\"_ctl0_MainContent_txtRecoveryDateDay\").SetAttribute(\"value\", \"01\")\nCall ie.Document.GetElementByID(\"_ctl0_MainContent_txtRecoveryDateYear\").SetAttribute(\"value\", \"2017\")\n\nCall ie.Document.GetElementByID(\"_ctl0_MainContent_txtFinalPaymentMonth\").SetAttribute(\"value\", \"12\")\nCall ie.Document.GetElementByID(\"_ctl0_MainContent_txtFinalPaymentDay\").SetAttribute(\"value\", \"30\")\nCall ie.Document.GetElementByID(\"_ctl0_MainContent_txtFinalPaymentYear\").SetAttribute(\"value\", \"2017\")\n\n'to find the \"&lt;input\u2026\u2026/&gt;\" tag hyper link and to click the button\nSet AllInputs = ie.Document.getelementsbytagname(\"input\") 'you can use any tagname as you wish\n    For Each hyper_link In AllInputs\n        If hyper_link.Name = \"_ctl0:MainContent:cmdCalculate\" Then 'you can use .name, .id etc\n            hyper_link.Click\n            Exit For\n        End If\n    Next\nDo\n\nDoEvents\nLoop Until ie.readystate = 3\nDo\n\nDoEvents\nLoop Until ie.readystate = 4\n\n\nEnd Sub\n</code></pre>\n\n<p>If you want to scrape the results, refresh the URL and do the same as I described above: F12, search for the relevant IDs and/or names, and pull those into a Worksheet in Excel.  I'll leave it to you to figure out that part.  It will be a good learning experience!!!</p>\n"}], "owner": {"reputation": 3, "user_id": 9025677, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ghi1ZOZ-qh8/AAAAAAAAAAI/AAAAAAAAACc/kcaIFS1X-mk/photo.jpg?sz=128", "display_name": "tanvir ahmed", "link": "https://stackoverflow.com/users/9025677/tanvir-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1498, "favorite_count": 1, "accepted_answer_id": 47554982, "answer_count": 2, "score": 0, "last_activity_date": 1512060958, "creation_date": 1511960372, "last_edit_date": 1511969161, "question_id": 47553477, "link": "https://stackoverflow.com/questions/47553477/excel-vba-loop-to-input-data-in-webpage", "title": "Excel VBA loop to input data in webpage", "body": "<p>I have gone through many articles and able to input data in to webpage from excel. Now I am trying to use a loop because I have to entry data for 10 to 50 times in the same page.</p>\n\n<p>Here is the code</p>\n\n<pre><code>Sub vfcp()\n\nSet objIE = CreateObject(\"InternetExplorer.Application\")\nobjIE.Top = 100\nobjIE.Left = 100\nobjIE.Width = 800\nobjIE.Height = 800\nobjIE.AddressBar = 1\nobjIE.StatusBar = 1\nobjIE.Toolbar = 1\nobjIE.Visible = True\n\nDim Input\n\nRange(\"A2\").Select\n\nobjIE.Navigate (\"https://www.askebsa.dol.gov/VFCPCalculator/WebCalculator.aspx\")\n\nDo Until Selection.Offset(0, 0).Value = \"\"\n\n  If objIE.ReadyState = 4 Then\n  Input = Selection.Offset(0, 2).Value\n\n  objIE.document.GetElementByID(\"_ctl0_MainContent_txtPrincipal\").Value = Input\n\n  objIE.document.GetElementByID(\"_ctl0_MainContent_cmdCalculate\").Click\n\n  Selection.Offset(1, 0).Select\n\n  End If\n\nLoop\nEnd Sub\n</code></pre>\n\n<p>The problems in this code is, I have a list of 10 date. the loop inputs the last date of the list. I am trying to input the first date and click submit, then wait for the page to load and input the second date, and stop the loop if there is an empty cell.</p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1511960320, "post_id": 47553384, "comment_id": 82063413, "body": "Why make it complicated? Why not create the same in an excel worsheet and use conditional formatting?"}, {"owner": {"reputation": 53, "user_id": 3643482, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a6dfec29d7341df83bad0eec5b137449?s=128&d=identicon&r=PG&f=1", "display_name": "Flaniganga", "link": "https://stackoverflow.com/users/3643482/flaniganga"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1511960543, "post_id": 47553384, "comment_id": 82063549, "body": "The problem is that the shifts are based on an algorithm on the excel sheet. and we do not want to give the users access to the worksheets."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1511961057, "post_id": 47553384, "comment_id": 82063854, "body": "You do not have to give access to relevant worksheet. Hide them and protect your file. Create a new sheet for this. Just give access to that sheet"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1511961465, "post_id": 47553384, "comment_id": 82064088, "body": "This is a lot of time invested for a task that can be solved in a more simple way. Read something about protect worksheets."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1511961612, "post_id": 47553384, "comment_id": 82064200, "body": "If you still want to go the &quot;Complicated way&quot; then what you need is <a href=\"http://www.siddharthrout.com/2011/08/05/vba-control-arrays/\" rel=\"nofollow noreferrer\">Control Arrays</a>"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 3643482, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a6dfec29d7341df83bad0eec5b137449?s=128&d=identicon&r=PG&f=1", "display_name": "Flaniganga", "link": "https://stackoverflow.com/users/3643482/flaniganga"}, "edited": false, "score": 0, "creation_date": 1512029652, "post_id": 47554215, "comment_id": 82094833, "body": "I have decided to go a different route.. Instead of trying to compile a two scenarios to do the work I have created another button to handle the transfer for example"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 53, "user_id": 3643482, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a6dfec29d7341df83bad0eec5b137449?s=128&d=identicon&r=PG&f=1", "display_name": "Flaniganga", "link": "https://stackoverflow.com/users/3643482/flaniganga"}, "edited": false, "score": 0, "creation_date": 1512043787, "post_id": 47554215, "comment_id": 82103011, "body": "Whatever works. The beautiful (or sometimes frustrating) thing about Excel and VBA is that there can be many different ways to accomplish the exact same task.  I still recommend checking out the links, especially <b><a href=\"http://www.cpearson.com/excel/topic.aspx\" rel=\"nofollow noreferrer\">Chip Pearson&#39;s 600+ copy-and-paste solutions</a></b>; there&#39;s something there to benefit every Excel project and boost your skill level along the way."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 1, "last_activity_date": 1511963781, "last_edit_date": 1525816189, "creation_date": 1511962771, "answer_id": 47554215, "question_id": 47553384, "link": "https://stackoverflow.com/questions/47553384/vba-excel-adding-a-second-set-of-commands-if-textbox-is-changed/47554215#47554215", "title": "VBA Excel : Adding a second set of commands if Textbox is changed", "body": "<p>Wow, that's... um... really something.  You get an '<strong>A</strong>' for for <em>Determination</em>, but a \"<strong>C-</strong>\" for <em>Study Skills</em>.  (I  mean that in the kindest way possible!)  :)</p>\n\n<p>There are <em>a lot</em> of ways to create a dynamic multicolored form like this (with no sensitive code available to the users) and you pretty much picked the hardest and most complicated way.  Unfortunately, complicating simple tasks tends to make them more likely to break in the future for a small reason, and then it can take forever to figure out the problem, if you're baby doesn't crash altogether, losing all your data.</p>\n\n<p>I don't think I've ever seen a <strong>Too Many Variables</strong> error before!  (Even Excel wants you to simplify.)  Sorry if this doesn't qualify as an answer, but I think you're best best it to start over with your formatting in a proper way. </p>\n\n<p>omg, \"5208 lines of code left\")  IF you know exactly how many lines of code you have left, you are being <strong>way</strong> too repetitive!  The whole point of Excel, or VBA, or coding in general, is make the <em>computer</em> do the work!</p>\n\n<p>If you're concerned about learning new Excel features, don't be.  You obviously have some skill &amp; organization to have made it as far as you did on that!  There are some basic things you should teach yourself in Excel...</p>\n\n<h2>Some things to learn, ASAP (you will be <strong>glad you did</strong>!)</h2>\n\n<ul>\n<li><p><a href=\"https://www.techonthenet.com/excel/formulas/case.php\" rel=\"nofollow noreferrer\">Select..Case statements</a> (instead of ElseIf ElseIf ElseIf)</p></li>\n<li><p><a href=\"https://www.homeandlearn.org/with_end_with.html\" rel=\"nofollow noreferrer\">With..End With statements</a> (instead of A1.BackColor A1.BackColor A1.BackColor)</p></li>\n<li><p><a href=\"https://www.howtogeek.com/howto/13780/using-vlookup-in-excel/\" rel=\"nofollow noreferrer\">VLookup</a>  (store reusable values in tables)</p></li>\n<li><p><a href=\"http://www.randomwok.com/excel/how-to-use-index-match/\" rel=\"nofollow noreferrer\">Match / Index</a></p></li>\n<li><p><a href=\"https://analysistabs.com/excel-vba/protect-unprotect-worksheets/\" rel=\"nofollow noreferrer\">Protecting Worksheets in Excel</a></p></li>\n<li><p><a href=\"https://support.office.com/en-us/article/Use-formulas-with-conditional-formatting-fed60dfa-1d3f-4e13-9ecb-f1951ff89d7f\" rel=\"nofollow noreferrer\"><strong>CONDITIONAL FORMATTING!</strong></a>  <sub>(Automatically change a cell's color etc based on a value or a formula.)</sub></p></li>\n<li><p><a href=\"https://excelmacromastery.com/excel-vba-array/\" rel=\"nofollow noreferrer\">Arrays</a>!  Both for <a href=\"http://www.excel-easy.com/vba/array.html\" rel=\"nofollow noreferrer\">storage</a> (like color names and cell trigger values) and <a href=\"http://www.siddharthrout.com/2011/08/05/vba-control-arrays/\" rel=\"nofollow noreferrer\">for control</a>.</p></li>\n<li><p><strong><a href=\"http://www.cpearson.com/excel/events.aspx\" rel=\"nofollow noreferrer\">VBA Events!</a></strong> (Make stuff happen automatically when other stuff happens) --from the <a href=\"http://www.cpearson.com/excel/mainpage.aspx\" rel=\"nofollow noreferrer\">website</a> of <strong>Chip Pearson</strong> (the king of Excel)</p></li>\n<li><p><a href=\"https://support.office.com/en-us/article/Save-all-or-part-of-a-workbook-to-a-static-Web-page-5AD26DEE-8739-4D80-B9D9-CF0530AB1968\" rel=\"nofollow noreferrer\">Making a static web page of an Excel Page</a></p></li>\n<li><p>Some of <a href=\"http://www.brainbell.com/tutorials/ms-office/excel/Hacking_Excel%27s_Built-in_Features.htm\" rel=\"nofollow noreferrer\">Excel's amazing built-in features</a></p></li>\n<li><p><a href=\"https://www.windowscentral.com/microsoft-excel-formulas-and-features-you-need-know\" rel=\"nofollow noreferrer\">Microsoft Excel formulas and features that you need to know</a> </p></li>\n<li><p><a href=\"https://www.excelguru.ca/forums/\" rel=\"nofollow noreferrer\">ExcelGuru Forums</a></p></li>\n<li><p>and even: <a href=\"https://www.google.ca/search?q=excel%20rotating%20schedule\" rel=\"nofollow noreferrer\">Rotating Shift Schedule Templates for Excel</a> (that are ready to use, free, you can adapt as you need, built by professionals)</p></li>\n</ul>\n\n<p><em>Good luck...</em>  Those are some nice color choices!</p>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 3643482, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a6dfec29d7341df83bad0eec5b137449?s=128&d=identicon&r=PG&f=1", "display_name": "Flaniganga", "link": "https://stackoverflow.com/users/3643482/flaniganga"}, "is_accepted": true, "score": 0, "last_activity_date": 1519300788, "creation_date": 1519300788, "answer_id": 48926871, "question_id": 47553384, "link": "https://stackoverflow.com/questions/47553384/vba-excel-adding-a-second-set-of-commands-if-textbox-is-changed/48926871#48926871", "title": "VBA Excel : Adding a second set of commands if Textbox is changed", "body": "<p>The best way to solve this issue is to start creating modules for each \"action\" that you want to do, for example to insure the colors in the textboxes make one Module and call it \"Colour_Text\" as an example is would look something like this </p>\n\n<pre><code>Public Sub Colour_Text1()\nIf PA1.Text = \"S1\" Then\nPA1.BackColor = RGB(0, 32, 96)\nPA1.ForeColor = RGB(255, 255, 255)\nPA1.Font.Bold = True\nElseIf PA1.Text = \"S2\" Then\nPA1.BackColor = RGB(0, 112, 192)\nPA1.ForeColor = RGB(255, 255, 255)\nPA1.Font.Bold = True\n ElseIf PA1.Text = \"S3\" Then\nPA1.BackColor = RGB(189, 215, 238)\nPA1.ForeColor = RGB(0, 0, 0)\nPA1.Font.Bold = True\n ElseIf PA1.Text = \"S4\" Then\nPA1.BackColor = RGB(0, 176, 240)\nPA1.ForeColor = RGB(0, 0, 0)\nPA1.Font.Bold = True\n ElseIf PA1.Text = \"W\" Then\nPA1.BackColor = RGB(60, 60, 60)\nPA1.ForeColor = RGB(255, 255, 255)\nPA1.Font.Bold = True\n ElseIf PA1.Text = \"P\" Then\nPA1.BackColor = RGB(166, 166, 166)\nPA1.ForeColor = RGB(0, 0, 0)\nPA1.Font.Bold = True\n ElseIf PA1.Text = \"A\" Then\nPA1.BackColor = RGB(255, 0, 0)\nPA1.ForeColor = RGB(0, 0, 0)\nPA1.Font.Bold = True\n ElseIf PA1.Text = \"S\" Then\nPA1.BackColor = RGB(169, 208, 142)\nPA1.ForeColor = RGB(0, 0, 0)\nPA1.Font.Bold = True\n ElseIf PA1.Text = \"L\" Then\nPA1.BackColor = RGB(0, 176, 80)\nPA1.ForeColor = RGB(0, 0, 0)\nPA1.Font.Bold = True\n ElseIf PA1.Text = \"F\" Then\nPA1.BackColor = RGB(112, 48, 160)\nPA1.ForeColor = RGB(0, 0, 0)\nPA1.Font.Bold = True\n ElseIf PA1.Text = \"N\" Then\nPA1.BackColor = RGB(255, 125, 125)\nPA1.ForeColor = RGB(0, 0, 0)\nPA1.Font.Bold = True\n ElseIf PA1.Text = \"UL\" Then\nPA1.BackColor = RGB(0, 176, 80)\nPA1.ForeColor = RGB(169, 208, 142)\nPA1.Font.Bold = True\n ElseIf PA1.Text = \"US\" Then\nPA1.BackColor = RGB(169, 208, 142)\nPA1.ForeColor = RGB(255, 0, 0)\nPA1.Font.Bold = True\n ElseIf PA1.Text = \"UN\" Then\nPA1.BackColor = RGB(255, 125, 125)\nPA1.ForeColor = RGB(255, 0, 0)\nPA1.Font.Bold = True\n ElseIf PA1.Text = \"H\" Then\nPA1.BackColor = RGB(255, 192, 0)\nPA1.ForeColor = RGB(255, 0, 0)\nPA1.Font.Bold = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>You then do the same for all the other text boxes, you can then call the module when you change the Text box like this:</p>\n\n<pre><code>Private Sub PA1_Change()\nCall Module1.Colour_Text1\nEnd Sub\n</code></pre>\n\n<p>This way you are only calling small changes thus freeing up your Memory :)</p>\n"}], "owner": {"reputation": 53, "user_id": 3643482, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a6dfec29d7341df83bad0eec5b137449?s=128&d=identicon&r=PG&f=1", "display_name": "Flaniganga", "link": "https://stackoverflow.com/users/3643482/flaniganga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 48926871, "answer_count": 2, "score": 0, "last_activity_date": 1519300788, "creation_date": 1511960023, "last_edit_date": 1512033158, "question_id": 47553384, "link": "https://stackoverflow.com/questions/47553384/vba-excel-adding-a-second-set-of-commands-if-textbox-is-changed", "title": "VBA Excel : Adding a second set of commands if Textbox is changed", "body": "<p>I am busy building a Shift rotation schedule using VBA and Excel\nat the moment I am sitting with a problem\nIn my Userform I have 434 textboxes that give the shift allocation per agent\nas seen below:\n<a href=\"https://i.stack.imgur.com/M4Y2M.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M4Y2M.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now in order to get these colours to change I have a code in every Textbox (Named A1,A2.....A31 then B1, B2,,,,,,B31 etc.)\nthe code goes as follows:</p>\n\n<pre><code>Private Sub A1_Change()\n If A1.Text = \"A\" Then\nA1.BackColor = &amp;H602000\n ElseIf A1.Text = \"B\" Then\nA1.BackColor = &amp;HC07000\n  ElseIf A1.Text = \"C\" Then\nA1.BackColor = &amp;HEED7BD\n  ElseIf A1.Text = \"D\" Then\nA1.BackColor = &amp;HF0B000\n  ElseIf A1.Text = \"W\" Then\nA1.BackColor = &amp;HFF&amp;\n  ElseIf A1.Text = \"M\" Then\nA1.BackColor = &amp;H808080\n  ElseIf A1.Text = \"S\" Then\nA1.BackColor = &amp;HA6A6A6\n  ElseIf A1.Text = \"P\" Then\nA1.BackColor = &amp;H7D7DFF\n  ElseIf A1.Text = \"L\" Then\nA1.BackColor = &amp;HD9D9D9\n  End If\n\nEnd Sub\n</code></pre>\n\n<p>I am trying now to allow the user to edit the shifts manually, Once this is done, they would be able to click on a set button that will copy the data from the Specific Agents row onto the worksheet based on the month selected for example:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\nIf Sheets(3).Range(\"B5\").Text = \"2018-01-01\" Then\nWorksheets(\"LAYOUT\").Activate\nSheets(\"LAYOUT\").Range(B4).Text = A1.Value\nSheets(\"LAYOUT\").Range(C4).Text = A2.Value\nSheets(\"LAYOUT\").Range(D4).Text = A3.Value\nSheets(\"LAYOUT\").Range(E4).Text = A4.Value\nSheets(\"LAYOUT\").Range(F4).Text = A5.Value\n.\n.\n.\n.\nSheets(\"LAYOUT\").Range(AD4).Text = A29.Value\nSheets(\"LAYOUT\").Range(AE4).Text = A30.Value\nSheets(\"LAYOUT\").Range(AF4).Text = A31.Value\n\nElseIf Sheets(3).Range(\"B5\").Text = \"2018-02-01\" Then\nWorksheets(1).Activate\nSheets(\"LAYOUT\").Range(AG4).Text = A1.Value\n.\n.\n.\n.\n.\nSheets(\"LAYOUT\").Range(BJ4).Text = A30.Value\nSheets(\"LAYOUT\").Range(BK4).Text = A31.Value\n\nElseIf Sheets(3).Range(\"B5\").Text = \"2018-03-01\" Then\nWorksheets(1).Activate\nSheets(\"LAYOUT\").Range(BI4).Text = A1.Value\nSheets(\"LAYOUT\").Range(BJ4).Text = A2.Value\n\nect \n</code></pre>\n\n<p>Now when I make a change and click on the CommandButton2\nit does nothing... Where am I going wrong?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 8913753, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-e-EC7POEduY/AAAAAAAAAAI/AAAAAAAAEEw/5HyOswIzk-c/photo.jpg?sz=128", "display_name": "George OST", "link": "https://stackoverflow.com/users/8913753/george-ost"}, "edited": false, "score": 0, "creation_date": 1511962371, "post_id": 47554010, "comment_id": 82064676, "body": "Thank you, Xabier!"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 51, "user_id": 8913753, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-e-EC7POEduY/AAAAAAAAAAI/AAAAAAAAEEw/5HyOswIzk-c/photo.jpg?sz=128", "display_name": "George OST", "link": "https://stackoverflow.com/users/8913753/george-ost"}, "edited": false, "score": 0, "creation_date": 1511963373, "post_id": 47554010, "comment_id": 82065420, "body": "Glad to be able to help.. :)"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 1, "last_activity_date": 1511962115, "creation_date": 1511962115, "answer_id": 47554010, "question_id": 47553369, "link": "https://stackoverflow.com/questions/47553369/add-extra-information-in-a-new-column/47554010#47554010", "title": "Add extra information in a new column", "body": "<p>I've managed to test this out and it works as you expect:</p>\n\n<pre><code>Sub foo()\n Set res = Sheet1.Cells(1, 1).EntireRow.Find(What:=\"Message\", LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlPrevious, MatchCase:=False) 'Find column with header of \"Message\"\n ColumnNumber = res.Column 'Get ColumnNumber\n Columns(ColumnNumber).EntireColumn.Insert 'Insert a new column\n LastRow = Sheet1.Cells(Sheet1.Rows.Count, \"A\").End(xlUp).Row ' Find the last Row on column A\n Sheet1.Cells(1, ColumnNumber).Value = \"Extra Info\" 'add header for new column\n For i = 2 To LastRow 'loop through the sheet to add the extra info\n    If Sheet1.Cells(i, ColumnNumber + 1).Value = \"D1\" Then Sheet1.Cells(i, ColumnNumber).Value = \"AAA\"\n    If Sheet1.Cells(i, ColumnNumber + 1).Value = \"D2\" Then Sheet1.Cells(i, ColumnNumber).Value = \"BBB\"\n    If Sheet1.Cells(i, ColumnNumber + 1).Value = \"D345\" Then Sheet1.Cells(i, ColumnNumber).Value = \"CCC\"\n Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 8913753, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-e-EC7POEduY/AAAAAAAAAAI/AAAAAAAAEEw/5HyOswIzk-c/photo.jpg?sz=128", "display_name": "George OST", "link": "https://stackoverflow.com/users/8913753/george-ost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 0, "accepted_answer_id": 47554010, "answer_count": 1, "score": 1, "last_activity_date": 1511962115, "creation_date": 1511959970, "last_edit_date": 1531164843, "question_id": 47553369, "link": "https://stackoverflow.com/questions/47553369/add-extra-information-in-a-new-column", "title": "Add extra information in a new column", "body": "<p>I want to make a macro to add extra information into my reports.    </p>\n\n<p>Inputs:<br>\n<a href=\"https://i.stack.imgur.com/3nHc3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3nHc3.png\" alt=\"enter image description here\"></a></p>\n\n<p>Outputs:<br>\n<a href=\"https://i.stack.imgur.com/tB4xh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tB4xh.png\" alt=\"enter image description here\"></a></p>\n\n<p>Sometimes the \"Message\" column is not in the same position (can be in B,D or E column). So i was thinking on some steps:<br>\n1. Find the \"Message\" column.<br>\n2. Insert column on left.<br>\n3. Add the extra info based on different cases. (here is the problem)</p>\n\n<pre><code>Sub Extra()\n\n    With Worksheets(1).Range(\"a1:x1\")\n        Set c = .FIND(\"Message\", LookIn:=xlValues)\n        If Not c Is Nothing Then\n           c.EntireColumn.Select\n            Selection.Insert\n            End If\n      End With\n\n    '3rd step\n    Dim d As Range\n     For Each d In Selection\n      Select Case d.Value\n       Case Is = \"D1\"\n       'add text CCC\n\n       Case Is = \"D2\"\n      'add text BBB \n\n       Case Is = \"D345\"\n       'add text CCC\n\n      End Select\n      Next d\n\nEnd sub\n</code></pre>\n\n<p><strong>How can I make this macro?</strong></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8249205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1cccaf1b1c54623dc86954709c26290?s=128&d=identicon&r=PG&f=1", "display_name": "MrJam", "link": "https://stackoverflow.com/users/8249205/mrjam"}, "edited": false, "score": 0, "creation_date": 1511963025, "post_id": 47552812, "comment_id": 82065177, "body": "Hi Rory Thanks for the quick response that worked perfectly :) you are a star you have saved me quite the headache"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 3, "last_activity_date": 1511958220, "creation_date": 1511958220, "answer_id": 47552812, "question_id": 47552571, "link": "https://stackoverflow.com/questions/47552571/vba-change-formula-to-value/47552812#47552812", "title": "vba change formula to value", "body": "<p>You should be able to do this:</p>\n\n<pre><code>With wsWorksheet\n   With .Range(.Cells(lngFirstRow, strCountCol), .Cells(lngLastRow, strCountCol))\n    'Add the count formula\n      .Formula = ConcFormula\n      .Value2 = .Value2\n   End With\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8249205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1cccaf1b1c54623dc86954709c26290?s=128&d=identicon&r=PG&f=1", "display_name": "MrJam", "link": "https://stackoverflow.com/users/8249205/mrjam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1809, "favorite_count": 0, "accepted_answer_id": 47552812, "answer_count": 1, "score": 0, "last_activity_date": 1511958220, "creation_date": 1511957475, "question_id": 47552571, "link": "https://stackoverflow.com/questions/47552571/vba-change-formula-to-value", "title": "vba change formula to value", "body": "<p>I have wrote a sub that uses autofill to set a cell to a countifs formula over a specific range but I cant seem to get it to convert the range from a formula to a value afterwards. </p>\n\n<p>I want to avoid using  Copy, Paste Special to do this. I have tried to use a few different variations of .value = .value but don't seem to be able to get this to work properly, quite often it just sets all the values to 1 which I know is not correct, any help would be greatly appreciated</p>\n\n<p>I have attached a copy of the working code below that sets the cells to the countifs formula to avoid any confusion with the .value = .value mistakes I have made</p>\n\n<p>Thanks</p>\n\n<pre><code>'   wsWorksheet is the worksheet to be used\n'   lngFirstRow is the first row of data\n'   strSourceCol is the letter (e.g. A) of the column to be counted\n'   strCountCol is the letter (e.g. I) of the column to add the count result to\nSub Concurrency(wsWorksheet As Worksheet, lngFirstRow As Long, strSourceCol As String, strCountCol As String)\nDim lngLastRow As Long\nDim strFormula As String\nConst ConcFormula As String = \"=(COUNTIFS(D$1:D1,\"\"&gt;\"\"&amp;C2,A$1:A1,A2))+1\"\n\n'Find the last row of data in the source column\nWith wsWorksheet\n      lngLastRow = .Cells(.Rows.Count, strSourceCol).End(xlUp).Row\n      If lngLastRow &lt; lngFirstRow Then lngLastRow = lngFirstRow\nEnd With\n\n\n'With the first cell on the count column\nWith wsWorksheet.Cells(lngFirstRow, strCountCol)\n    'Add the count formula\n    .Formula = ConcFormula\n    'If there are more rows autofill it down\n    If lngLastRow &gt; lngFirstRow Then\n        .AutoFill Destination:=Range( _\n            .Cells, _\n            .Offset(rowoffset:=lngLastRow - lngFirstRow).Cells), Type:=xlFillDefault\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1511954705, "post_id": 47551605, "comment_id": 82059886, "body": "I&#39;m not sure how we are expected to understand why it&#39;s not working when we don&#39;t know what the problem is?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1511954881, "post_id": 47551605, "comment_id": 82060004, "body": "You want to look for cell &quot;B2&quot; when it&#39;s being modifed, but in your <code>Worksheet_Change</code> event, you are looking for <code>Range(&quot;B10:O10000&quot;)</code>, so &quot;B2&quot; doesn&#39;t trigger the event, since you start looking from row 10 (and not 2)."}, {"owner": {"reputation": 31, "user_id": 9019920, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ba47f66309da5e73f5a0c2f017b7e17c?s=128&d=identicon&r=PG&f=1", "display_name": "geocc", "link": "https://stackoverflow.com/users/9019920/geocc"}, "edited": false, "score": 0, "creation_date": 1511955016, "post_id": 47551605, "comment_id": 82060086, "body": "The problem is that if I write &quot;John&quot; in cell i.e. B2, and cell O2 is empty, it does not turn the cell O2 in red."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1511955058, "post_id": 47551605, "comment_id": 82060114, "body": "@georgec see my comment above, change to <code>If Not Application.Intersect(Range(&quot;B1:O10000&quot;), Target) Is Nothing Then</code>"}, {"owner": {"reputation": 31, "user_id": 9019920, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ba47f66309da5e73f5a0c2f017b7e17c?s=128&d=identicon&r=PG&f=1", "display_name": "geocc", "link": "https://stackoverflow.com/users/9019920/geocc"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1511955131, "post_id": 47551605, "comment_id": 82060156, "body": "@Shai Rado: yes, I changed the rage now to B2:O10000, but still doesn&#39;t work."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1511955189, "post_id": 47551605, "comment_id": 82060188, "body": "@georgec it works for me, maybe you have <code>Application.EnableEvents</code> turned Off. Restart Excel and see if it works"}, {"owner": {"reputation": 31, "user_id": 9019920, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ba47f66309da5e73f5a0c2f017b7e17c?s=128&d=identicon&r=PG&f=1", "display_name": "geocc", "link": "https://stackoverflow.com/users/9019920/geocc"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1511955308, "post_id": 47551605, "comment_id": 82060260, "body": "@Shai Rado: Yes, works now. Thanks :)"}], "answers": [{"tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": true, "score": 2, "last_activity_date": 1511955818, "creation_date": 1511955818, "answer_id": 47552014, "question_id": 47551605, "link": "https://stackoverflow.com/questions/47551605/vba-colour-highlight-based-on-if/47552014#47552014", "title": "VBA colour highlight based on IF", "body": "<p>This can be easily done with conditional formatting. Just pick conditional formatting from Home menu on your ribbon --> new rule -->Use a formula to determine... and type formula</p>\n\n<pre><code>=$B$2&lt;&gt;\"John\"\n</code></pre>\n\n<p>Then you need only set your desired format. You may toggle with $ in formula to allow dragging and copying the format if you need it. </p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 9019920, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ba47f66309da5e73f5a0c2f017b7e17c?s=128&d=identicon&r=PG&f=1", "display_name": "geocc", "link": "https://stackoverflow.com/users/9019920/geocc"}, "edited": false, "score": 0, "creation_date": 1511956620, "post_id": 47552043, "comment_id": 82061001, "body": "Flaniganga: Is because I want to learn VBA and all my work to be coded. Writing even simple codes, might help me to understand faster how codes work generally."}], "tags": [], "owner": {"reputation": 53, "user_id": 3643482, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a6dfec29d7341df83bad0eec5b137449?s=128&d=identicon&r=PG&f=1", "display_name": "Flaniganga", "link": "https://stackoverflow.com/users/3643482/flaniganga"}, "is_accepted": false, "score": 0, "last_activity_date": 1511955932, "creation_date": 1511955932, "answer_id": 47552043, "question_id": 47551605, "link": "https://stackoverflow.com/questions/47551605/vba-colour-highlight-based-on-if/47552043#47552043", "title": "VBA colour highlight based on IF", "body": "<p>Why don't you rather use conditional formatting instead of VBA? \nMight be easier to manage</p>\n"}], "owner": {"reputation": 31, "user_id": 9019920, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ba47f66309da5e73f5a0c2f017b7e17c?s=128&d=identicon&r=PG&f=1", "display_name": "geocc", "link": "https://stackoverflow.com/users/9019920/geocc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 47552014, "answer_count": 2, "score": 0, "last_activity_date": 1511955932, "creation_date": 1511954500, "last_edit_date": 1511954623, "question_id": 47551605, "link": "https://stackoverflow.com/questions/47551605/vba-colour-highlight-based-on-if", "title": "VBA colour highlight based on IF", "body": "<p>So I am trying to run the code below. It should be straight to the point, and I don't understand why it's not working. If cell b2 is \"John\", and cell O2 is empty, then O2 should be red. If O2 is not empty, then it should not be colored. </p>\n\n<p>Any help is must appreciated.</p>\n\n<pre><code>Sub columnO(d As Long)\n\nIf Cells(d, \"B\") = \"John\" And Cells(d, \"O\") = \"\" Then    \n    Cells(d, \"O\").Interior.Color = RGB(255, 0, 0)\nElse\n    Cells(d, \"O\").Interior.Color = RGB(1000, 1000, 1000)\nEnd If\n\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\nIf Not Application.Intersect(Range(\"B10:O10000\"), Target) Is Nothing Then\n    columnO Target.Row\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1511957654, "post_id": 47551566, "comment_id": 82061624, "body": "do you have 46 <code>ContentControls</code> in your document? always? in which line your error pops up?"}, {"owner": {"reputation": 1, "user_id": 9025299, "user_type": "registered", "profile_image": "https://graph.facebook.com/1865097313518559/picture?type=large", "display_name": "Gary Macdonald", "link": "https://stackoverflow.com/users/9025299/gary-macdonald"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1511969214, "post_id": 47551566, "comment_id": 82069675, "body": "yes, I do as it works for every content control up until this number and doesnt throw an error in until theere, is thera wwy to reference content controls by their tags rather than number?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9025299, "user_type": "registered", "profile_image": "https://graph.facebook.com/1865097313518559/picture?type=large", "display_name": "Gary Macdonald", "link": "https://stackoverflow.com/users/9025299/gary-macdonald"}, "edited": false, "score": 0, "creation_date": 1512032280, "post_id": 47567387, "comment_id": 82096129, "body": "I am unsure what this is doing, I want it to delete the content control that it is curreently on if the specific checkbox value is false. BUt i want it to delete the line above and below the content control also so that it will &quot;move it up&quot; so ther are no blank spaces between the paragraphs"}, {"owner": {"reputation": 1, "user_id": 9025299, "user_type": "registered", "profile_image": "https://graph.facebook.com/1865097313518559/picture?type=large", "display_name": "Gary Macdonald", "link": "https://stackoverflow.com/users/9025299/gary-macdonald"}, "edited": false, "score": 0, "creation_date": 1512033843, "post_id": 47567387, "comment_id": 82097016, "body": "Tried this: If cc.Tag = &quot;NS2&quot; Then         If NScb.Value = False Then         With ActiveDocument.ContentControls(ActiveDocument.ContentControl&zwnj;&#8203;s.Count)         ActiveDocument.Range(.Range.Start - 1, .Range.End + 2).Select         Selection.Delete         End With         End If         End If"}, {"owner": {"reputation": 1, "user_id": 9025299, "user_type": "registered", "profile_image": "https://graph.facebook.com/1865097313518559/picture?type=large", "display_name": "Gary Macdonald", "link": "https://stackoverflow.com/users/9025299/gary-macdonald"}, "edited": false, "score": 0, "creation_date": 1512033862, "post_id": 47567387, "comment_id": 82097022, "body": "Assuming that is where i was meant to put it and it doesnt work"}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 1, "user_id": 9025299, "user_type": "registered", "profile_image": "https://graph.facebook.com/1865097313518559/picture?type=large", "display_name": "Gary Macdonald", "link": "https://stackoverflow.com/users/9025299/gary-macdonald"}, "edited": false, "score": 0, "creation_date": 1512041039, "post_id": 47567387, "comment_id": 82101454, "body": "Can you add a bit more code to your question so that it is easier to see what you are doing, will update the answer too."}, {"owner": {"reputation": 1, "user_id": 9025299, "user_type": "registered", "profile_image": "https://graph.facebook.com/1865097313518559/picture?type=large", "display_name": "Gary Macdonald", "link": "https://stackoverflow.com/users/9025299/gary-macdonald"}, "edited": false, "score": 0, "creation_date": 1512051533, "post_id": 47567387, "comment_id": 82108031, "body": "Ah okay, sure what is it you want to see,"}, {"owner": {"reputation": 1, "user_id": 9025299, "user_type": "registered", "profile_image": "https://graph.facebook.com/1865097313518559/picture?type=large", "display_name": "Gary Macdonald", "link": "https://stackoverflow.com/users/9025299/gary-macdonald"}, "edited": false, "score": 0, "creation_date": 1512051653, "post_id": 47567387, "comment_id": 82108113, "body": "Heres an exaplantion of what im doing: Ihave a userform with many fields i then have a for statement that loops through the document, i have if statemts that fill in the fields with the text values, at the end i have some check boxes that i want to enter tesxt if the checkbox is true but delte and move up the blank spaces if it is not, any code you require let me know"}], "tags": [], "owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "is_accepted": false, "score": 0, "last_activity_date": 1512041441, "last_edit_date": 1512041441, "creation_date": 1512024252, "answer_id": 47567387, "question_id": 47551566, "link": "https://stackoverflow.com/questions/47551566/delete-lines-above-contentcontrol-run-time-5941-error-the-requested-member-of/47567387#47567387", "title": "Delete lines above contentcontrol, run time 5941 error - the requested member of the collection does not exist", "body": "<p>I'm going to take a guess that this code is in a loop of some sort... </p>\n\n<p>So what might be happening is that you are looking for the 46th ContentControl then deleting it.  Well... lets say there are 50 ContentControls in your document.</p>\n\n<p>This is a <code>Collection</code> of ContentControls.  Now you delete the 46th ContentControl in your document --> now there are 49 ContentControls in the document. </p>\n\n<p>You can delete ContentControl(46) 3 more times (it's a different one each time) and then you will only have 45 ContentControls.</p>\n\n<p>Now, try to delete ContentControl(46)...   it doesn't exist, there's only 45 left.  VBA tells you this by throwing an error > <code>Requested Member of the Collection does not exist</code> (<em>meaning you asked for ContentControl(46) but it does not exist</em>).</p>\n\n<p>If so there are two ways forward...</p>\n\n<pre><code>With ActiveDocument.ContentControls(ActiveDocument.ContentControls.Count)\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>For i = ActiveDocument.ContentControls.Count to 1 Step -1\n...\n    With ActiveDocument.ContentControls(i)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9025299, "user_type": "registered", "profile_image": "https://graph.facebook.com/1865097313518559/picture?type=large", "display_name": "Gary Macdonald", "link": "https://stackoverflow.com/users/9025299/gary-macdonald"}, "is_accepted": false, "score": 0, "last_activity_date": 1512124075, "creation_date": 1512124075, "answer_id": 47591368, "question_id": 47551566, "link": "https://stackoverflow.com/questions/47551566/delete-lines-above-contentcontrol-run-time-5941-error-the-requested-member-of/47591368#47591368", "title": "Delete lines above contentcontrol, run time 5941 error - the requested member of the collection does not exist", "body": "<pre><code>     If cc.Tag = \"DI\" Then\n    If DIcb.Value = False Then\n    With ActiveDocument.SelectContentControlsByTag(\"DI\").Item(1)\n    ActiveDocument.Range(.Range.Start - 2, .Range.End + 2).Select\n    Selection.Delete\n    End With\n    End If\n    End If\n</code></pre>\n\n<p>Solved above</p>\n"}], "owner": {"reputation": 1, "user_id": 9025299, "user_type": "registered", "profile_image": "https://graph.facebook.com/1865097313518559/picture?type=large", "display_name": "Gary Macdonald", "link": "https://stackoverflow.com/users/9025299/gary-macdonald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1512124075, "creation_date": 1511954358, "last_edit_date": 1511954403, "question_id": 47551566, "link": "https://stackoverflow.com/questions/47551566/delete-lines-above-contentcontrol-run-time-5941-error-the-requested-member-of", "title": "Delete lines above contentcontrol, run time 5941 error - the requested member of the collection does not exist", "body": "<p>I have a user form with check boxes, if the check box is not selected then I want the content control to be deleted and moved up.</p>\n\n<p>I have content controls in my document like so:</p>\n\n<pre><code>Header 1\nBody 1\n\nHeader 2 \nBody 2\n\nHeader 3\nBody 3\n</code></pre>\n\n<p>Each header and body are linked to 1 check box ie header 3 and body 3 should both be deleted and moved up if the checkbox is not ticked</p>\n\n<p>I have this code but am getting an error saying the remeber does not exist but have checked that 100% does by using the same code to just select rather than delete.</p>\n\n<pre><code>    If cc.Tag = \"DER2\" Then\n        If DERcb.Value = False Then\n            With ActiveDocument.ContentControls(46)\n                ActiveDocument.Range(.Range.Start - 1, .Range.End + 2).Select\n                Selection.Delete\n            End With\n        End If\n    End If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1511954336, "post_id": 47551495, "comment_id": 82059674, "body": "On which line is the error?"}, {"owner": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1511955068, "post_id": 47551495, "comment_id": 82060119, "body": "Sorry it is at line <code>LastRow = Cells.Find(What:=&quot;*&quot;, _ </code>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1511955731, "post_id": 47551495, "comment_id": 82060466, "body": "Is the sheet blank when the code runs?"}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 2, "last_activity_date": 1511956179, "creation_date": 1511956179, "answer_id": 47552132, "question_id": 47551495, "link": "https://stackoverflow.com/questions/47551495/excel-vba-run-time-error-91-when-copying-macro-to-new-workbook/47552132#47552132", "title": "Excel VBA Run-time error 91, when copying macro to new workbook", "body": "<p><code>Find</code> returns <code>Nothing</code> when it can't find what you've requested.<br>\nWhen you ask it to find <code>*</code> (anything) on a blank sheet it returns nothing - it couldn't find anything.<br>\nWhen you ask it to return the row number of nothing it gives the error message you're getting.  </p>\n\n<p>To avoid this error pass the result of <code>Find</code> to a range variable:  </p>\n\n<pre><code>Dim rLastRow as Range    \nSet rLastRow = Cells.Find(What:=\"*\", _\n                After:=Range(\"A1\"), _\n                LookAt:=xlPart, _\n                LookIn:=xlFormulas, _\n                SearchOrder:=xlByRows, _\n                SearchDirection:=xlPrevious, _\n                MatchCase:=False)\n</code></pre>\n\n<p>You can then check if the range is nothing before getting the row number:  </p>\n\n<pre><code>If Not rLastRow Is Nothing Then\n    LastRow = rLastRow.Row\nEnd If\n</code></pre>\n\n<p>I'd suggest looking at one of the posts on finding the last cell and pulling the whole thing out to a separate function.<br>\n<a href=\"https://stackoverflow.com/search?q=find+last+cell+vba\">https://stackoverflow.com/search?q=find+last+cell+vba</a> </p>\n\n<p><strong>Edit:</strong>  Also, your <code>Find</code> is only looking at the activesheet.<br>\n<code>LastRow = Thisworkbook.Worksheets(\"Datasheet\").Cells.Find....</code> will always look at the <em>Datasheet</em> in the workbook holding the code.</p>\n"}], "owner": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511956682, "creation_date": 1511954126, "last_edit_date": 1511956682, "question_id": 47551495, "link": "https://stackoverflow.com/questions/47551495/excel-vba-run-time-error-91-when-copying-macro-to-new-workbook", "title": "Excel VBA Run-time error 91, when copying macro to new workbook", "body": "<p>Below code is causing a </p>\n\n<blockquote>\n  <p>run-time error '91': Object variable or With block variable not set</p>\n</blockquote>\n\n<p>This code works fine in the Excel Workbook in which I created it, but when I copy and paste it to another Excel Workbook I get the error.</p>\n\n<p>Error is at line</p>\n\n<pre><code>LastRow = Cells.Find(What:=\"*\", _\n</code></pre>\n\n<p>Does anybody know why?</p>\n\n<p>I have tried to set the variable to a value after it is declared, but this does not solve.</p>\n\n<pre><code> Sub mileStoneDatePivot()\n\n\n Dim r As Long, pasteRowIndex As Long, v() As Long, i As Long\n Dim LastRow As Long\n Dim lCol As Long\n\n'Insert a New Blank Worksheet\nOn Error Resume Next\nApplication.DisplayAlerts = False\nWorksheets(\"PivotTable\").Delete\nSheets.Add Before:=ActiveSheet\nActiveSheet.Name = \"DataSheet\"\nApplication.DisplayAlerts = True\n'Switch off error masking\nOn Error GoTo 0\n\n\n\n 'This sheet is where data should originate\n\n\n   Sheets(\"DCC_AGGREGATOR_FLATFILE\").Rows(\"1\").Copy Sheets(\"DataSheet\").Range(\"A1\")\n\nLastRow = Cells.Find(What:=\"*\", _\n                After:=Range(\"A1\"), _\n                LookAt:=xlPart, _\n                LookIn:=xlFormulas, _\n                SearchOrder:=xlByRows, _\n                SearchDirection:=xlPrevious, _\n                MatchCase:=False).Row\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 2, "creation_date": 1511951900, "post_id": 47550711, "comment_id": 82057992, "body": "How are you running it on the <code>xlsx</code>? If it&#39;s in the same workbook you&#39;ll lose all vba when saving. Also, check that the worksheet you&#39;re changing (if you&#39;re changing it) doesn&#39;t have any protection applied to it"}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 2, "creation_date": 1511952561, "post_id": 47550711, "comment_id": 82058470, "body": "use xlsm rather than xlsx"}, {"owner": {"reputation": 186, "user_id": 7528039, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I1pwD.jpg?s=128&g=1", "display_name": "Kyoujin", "link": "https://stackoverflow.com/users/7528039/kyoujin"}, "edited": false, "score": 0, "creation_date": 1511959739, "post_id": 47550711, "comment_id": 82063063, "body": "As above your first need to get this to Xlsm or Xlsb. Xlsx wont use Macros"}], "owner": {"reputation": 185, "user_id": 8189399, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f3c17f21ec51a2da64aa3a6bf183d881?s=128&d=identicon&r=PG&f=1", "display_name": "yeungcase", "link": "https://stackoverflow.com/users/8189399/yeungcase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 617, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511956489, "creation_date": 1511951805, "last_edit_date": 1511956489, "question_id": 47550711, "link": "https://stackoverflow.com/questions/47550711/excel-vba-permission-denied-error", "title": "Excel VBA Permission Denied Error", "body": "<p>While I would like to run Macro on a xlsx, it prompts out </p>\n\n<blockquote>\n  <p>Permission Denied</p>\n</blockquote>\n\n<p>I already enabled all macro settings in trust center. How come?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 1, "creation_date": 1511952676, "post_id": 47550668, "comment_id": 82058550, "body": "Have you declared the parameters in the crosstab query? - A crosstab has to have the parameters predefined."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 2, "creation_date": 1511953367, "post_id": 47550668, "comment_id": 82059017, "body": "Please share all the relevant code (SQL, setting tempvars, when what happens). Currently, your question contains very little information for us to debug it."}, {"owner": {"reputation": 832, "user_id": 1176482, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c7837deb24bae5b0f96198b03d29ff29?s=128&d=identicon&r=PG", "display_name": "Naz", "link": "https://stackoverflow.com/users/1176482/naz"}, "reply_to_user": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1511953652, "post_id": 47550668, "comment_id": 82059202, "body": "@Minty OK that did it, please add as answer."}], "answers": [{"comments": [{"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1511962950, "post_id": 47551580, "comment_id": 82065124, "body": "Not an answer, rather a suggestion."}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "reply_to_user": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1511963543, "post_id": 47551580, "comment_id": 82065535, "body": "It was the answer - see the comments against the original post."}], "tags": [], "owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "is_accepted": true, "score": 2, "last_activity_date": 1511963609, "last_edit_date": 1511963609, "creation_date": 1511954429, "answer_id": 47551580, "question_id": 47550668, "link": "https://stackoverflow.com/questions/47550668/ms-access-parameter-query-results-in-error/47551580#47551580", "title": "MS Access Parameter Query Results in Error", "body": "<p>A crosstab has to have the parameters predefined. Have you declared the parameters in the crosstab query?</p>\n\n<p>If not you can set them in the Query editor by right click and select Parameters property in the designer.</p>\n"}], "owner": {"reputation": 832, "user_id": 1176482, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c7837deb24bae5b0f96198b03d29ff29?s=128&d=identicon&r=PG", "display_name": "Naz", "link": "https://stackoverflow.com/users/1176482/naz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 1, "accepted_answer_id": 47551580, "answer_count": 1, "score": 1, "last_activity_date": 1511963609, "creation_date": 1511951665, "question_id": 47550668, "link": "https://stackoverflow.com/questions/47550668/ms-access-parameter-query-results-in-error", "title": "MS Access Parameter Query Results in Error", "body": "<p>I have a query that used a field from a form as a parameter in a crosstab query and it worked fine, the contents of the field are like 2017-18 etc. But now I have 2 forms that run the same query and have used TempVars, I have dim/defined the TempVars in the VBA before the query launches and have used the following as a parameter in the query;</p>\n\n<pre><code>[Tempvars]![varFinDate]\n</code></pre>\n\n<p>But when the query runs I get the error message;</p>\n\n<blockquote>\n  <p>The expression is typed incorrectly, or is too complex to be\n  evaluated. For example, a numeric express may contain too many\n  complicated elements. Try simplifying the expression by assigns parts\n  of the express to variables.</p>\n</blockquote>\n\n<p>I have used the same principle on many queries without issue.</p>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 2, "creation_date": 1511975995, "post_id": 47550572, "comment_id": 82074199, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/18063214/how-to-error-handle-1004-error-with-worksheetfunction-vlookup\">How to error handle 1004 Error with WorksheetFunction.VLookup?</a>"}, {"owner": {"reputation": 5523, "user_id": 2594812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc8f4767c6d139bb824167fa04b992e0?s=128&d=identicon&r=PG", "display_name": "Sam Hartman", "link": "https://stackoverflow.com/users/2594812/sam-hartman"}, "edited": false, "score": 1, "creation_date": 1511978531, "post_id": 47550572, "comment_id": 82075723, "body": "No, this doesn&#39;t really look like a duplicate of how to handle error 1004."}], "answers": [{"comments": [{"owner": {"reputation": 169, "user_id": 4765179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/73d9656254cdbadf55e9b1b1ff6825a8?s=128&d=identicon&r=PG&f=1", "display_name": "Javi", "link": "https://stackoverflow.com/users/4765179/javi"}, "edited": false, "score": 0, "creation_date": 1511979493, "post_id": 47551024, "comment_id": 82076198, "body": "Dear ashleedawg, I didn&#39;t asked and ran. I was just trying to solve the problem by myself or asking a different question, as I&#39;m learning more about the problem. Sometimes something does not work as one expects, but does not know exactly what is the question to ask. In my case, I am not very used to program in vba, so don&#39;t know exactly to manage the problems, even to inspect a variable... Sorry about inconvenience and thanks a lot for your help."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 169, "user_id": 4765179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/73d9656254cdbadf55e9b1b1ff6825a8?s=128&d=identicon&r=PG&f=1", "display_name": "Javi", "link": "https://stackoverflow.com/users/4765179/javi"}, "edited": false, "score": 0, "creation_date": 1511980391, "post_id": 47551024, "comment_id": 82076641, "body": "Ok, my bad.  Now you have a solution above (right?) and you know that the first step when you have an error message is to figure out what the error is trying to tell you (with the help of Google).  With the excess info available, effective searching is a skill learned with practice. Believe me, I know what it&#39;s like to not know the right questions to ask, that&#39;s why I re-wrote your question, now you know.  But rest assured, <b>any</b> problem you&#39;re going to have has already been discussed online numerous times so that&#39;s a good starting place. (Not just coding; _any_issue!)  Good luck!"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1511982925, "post_id": 47551024, "comment_id": 82077896, "body": "A very detailed step by step description and helpful recipe."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 3, "last_activity_date": 1511980510, "last_edit_date": 1511980510, "creation_date": 1511952746, "answer_id": 47551024, "question_id": 47550572, "link": "https://stackoverflow.com/questions/47550572/vba-and-vlookup-inserting-the-formula-vs-reading-the-result-of-the-formula/47551024#47551024", "title": "Vba and VLookup: inserting the formula vs reading the result of the formula", "body": "<p><code>Application.WorksheetFunction.VLookup</code> needs a range as the second parameter.  It doesn't know which worksheet or cells to look in.</p>\n\n<p>This is what you're calling it with:  </p>\n\n<pre><code>Application.WorksheetFunction.VLookup(9992, \"'C:\\WORK\\MyEstates\\4529\\4529-data.xlsx'!D_1\", 3, false)\n</code></pre>\n\n<p><del>Try something more like:</p>\n\n<pre><code>Application.WorksheetFunction.VLookup (9992, worksheets(\"Sheet1\").range(\"A1:b10\"),3,FALSE) \n</code></pre>\n\n<p></del>If you need to use a variable then make sure you declare it as a <strong>Range</strong>.</p>\n\n<p><sub>(By the way, that was the first hit on a Google search.)</sub>,</p>\n\n<hr>\n\n<h1><strong>EDIT</strong>:</h1>\n\n<p>I realized afterwards what you're trying to do!  :)</p>\n\n<p>You shared lots of information but it was so convoluted I couldn't understand what the issue was, and the strange syntax (like <code>Range(Cells(1, 1), Cells(1, 1))</code>) and open-ended description (like <code>Everything works</code>) made it more confusing.</p>\n\n<p>Before you get the answer, <strong>I might as well rewrite the question for you</strong>, so you get a better idea how to make it easier on everyone next time.  Rewriting your question took me half the time it did to understand it, plus you would have answered your question <strong>yourself</strong> if you had just <em>Googled the Error</em>.  </p>\n\n<hr>\n\n<hr>\n\n<blockquote>\n  <h2>Error 1004 on WorksheetFunction.VLookup to external named range</h2>\n  \n  <p>Hi!</p>\n  \n  <p>I have a <a href=\"https://support.office.com/en-gb/article/VLOOKUP-function-0bbc8083-26fe-4963-8ab8-93a18ad188a1?CorrelationId=2117f3d1-9e00-4516-a28b-bbf0d0d11dd5&amp;ui=en-US&amp;rs=en-GB&amp;ad=GB&amp;ocmsassetID=HA102752820\" rel=\"nofollow noreferrer\">VLookup</a> formula which returns the expected result from a\n  <a href=\"https://stackoverflow.com/questions/29151593/refer-to-named-range-in-another-excel-workbook\">named range in another workbook</a> when I assign it to a cell using\n  this VBA:</p>\n\n<pre><code>Range(\"A1\").FormulaR1C1 = _\n    \"=VLookup(9992, '*C:\\myPath\\fileName.xlsx'!namedRange*, 3, FALSE)\"\n</code></pre>\n  \n  <p>I can't get the same <code>VLookup</code> formula to work with\n  <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-worksheetfunction-property-excel\" rel=\"nofollow noreferrer\">Application.WorksheetFunction</a> like this:</p>\n\n<pre><code>myResult = Application.WorksheetFunction.VLookup _\n    (9992, \"'C:\\myPath\\fileName.xlsx'!namedRange, 3, FALSE)\"\n</code></pre>\n  \n  <p>VBA stops on the line above with <a href=\"https://i.stack.imgur.com/BqlIO.png\" rel=\"nofollow noreferrer\">this\n  error</a>:</p>\n  \n  <blockquote>\n    <p><strong>Run-time error '1004':</strong></p>\n    \n    <p><strong>Unable to get the VLookup propery of the WorksheetFunction class</strong></p>\n  </blockquote>\n  \n  <p>Next, I looked up the error and <strong>the very first <a href=\"https://www.google.ca/search?q=unable%20to%20get%20the%20vlookup%20property%20of%20the%20worksheetfunction%20class\" rel=\"nofollow noreferrer\">Google search result</a></strong>\n  was <a href=\"https://stackoverflow.com/a/25875275/8112776\">an <strong>existing answer</strong> from Stack Overflow with the solution to my\n  problem</a>.</p>\n  \n  <p>So, I.......</p>\n</blockquote>\n\n<hr>\n\n<hr>\n\n<p>.</p>\n\n<p>I guess that's as far as I can go with the example question since the process of adding a couple links would have answered the question.</p>\n\n<h1>Here's your fix:</h1>\n\n<pre><code>myResult = Application.WorksheetFunction.VLookup _\n    (9992, \"'C:\\WORK\\MyEstates\\4529\\4529-data.xlsx'!D_1\", 3, false)\n</code></pre>\n\n<p>Please read over <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a> and <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a>.  Thanks for your time!</p>\n"}], "owner": {"reputation": 169, "user_id": 4765179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/73d9656254cdbadf55e9b1b1ff6825a8?s=128&d=identicon&r=PG&f=1", "display_name": "Javi", "link": "https://stackoverflow.com/users/4765179/javi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 531, "favorite_count": 0, "accepted_answer_id": 47551024, "answer_count": 1, "score": 0, "last_activity_date": 1529865145, "creation_date": 1511951410, "last_edit_date": 1529865145, "question_id": 47550572, "link": "https://stackoverflow.com/questions/47550572/vba-and-vlookup-inserting-the-formula-vs-reading-the-result-of-the-formula", "title": "Vba and VLookup: inserting the formula vs reading the result of the formula", "body": "<p>I am working in Excel vba and want to read the result of a VLookup formula. </p>\n\n<p>When I insert the formula itself into a cell...</p>\n\n<pre><code>Range(Cells(1, 1), Cells(1, 1)).FormulaR1C1 = \"=VLookup(\" &amp; ent &amp; \", \" &amp; MyName &amp; \", \" &amp; fc &amp; \", FALSE)\"\n</code></pre>\n\n<p>...everything works. But when I try to read the same formula and keep the result into a variable...</p>\n\n<pre><code>MyResult=Application.WorksheetFunction.VLookup(ent, MyName , fc, False)\n</code></pre>\n\n<p>..., id does not work and reports an Error no. 1004. </p>\n\n<p>Any ideas? Just for clarification, these are the arguments of the formula: the range is defined with a name in another workbook. This is not a problem when inserting the formula in \"A1\" cell.</p>\n\n<pre><code>et = 4529\nep = 1\nfc = 3\nent = 9992\nMyRoute = \"C:\\WORK\\MyEstates\\\"\nMyBook = MyRoute + CStr(et) + \"\\\" + CStr(et) + \"-data.xlsx\"\nMyName = \"'\" + MyBook + \"'!D_\" + CStr(ep)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 3, "creation_date": 1511952326, "post_id": 47550530, "comment_id": 82058321, "body": "Use <code>.Find</code>. See <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/11169920#11169920\">THIS</a>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1511952686, "post_id": 47550530, "comment_id": 82058557, "body": "You could try adding: <code>Debug.print .UsedRange.Rows.Count</code> before resetting the variable."}, {"owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1511954208, "post_id": 47550530, "comment_id": 82059592, "body": "saving workbook resets this, but as @SiddharthRout wrote, this is not the best way"}, {"owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1511954513, "post_id": 47550530, "comment_id": 82059767, "body": "@SiddharthRout I know that saving solves but I won&#39;t save while running the macro"}], "answers": [{"comments": [{"owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "edited": false, "score": 0, "creation_date": 1511975764, "post_id": 47551612, "comment_id": 82074076, "body": "Thanks, but this is a workaround and I prefer to use another sheet (I can in this case). Anyway I appreciate (+1)"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1511954510, "creation_date": 1511954510, "answer_id": 47551612, "question_id": 47550530, "link": "https://stackoverflow.com/questions/47550530/specialcellsxllastcell-doesnt-update-after-deleting-rows/47551612#47551612", "title": "SpecialCells(xlLastCell) doesn&#39;t update after deleting rows", "body": "<p>Following @Siddharth Rout comment above, using the <code>Find</code> function is the safest way to get the last row.</p>\n\n<pre><code>StartLastRow = FindLastRow\n\nIf StartLastRow &gt; 24 Then\n    .Cells(StartLastRow, 1).CurrentRegion.EntireRow.Delete\n    StartLastRow = FindLastRow\nEnd If\n\n'=======================================================================\n\nFunction FindLastRow() As Long\n    ' This Function finds the last row in a worksheet, and returns the row number\n    Dim LastCell As Range\n    Set LastCell = Cells.Find(What:=\"*\", After:=Cells(1), Lookat:=xlPart, LookIn:=xlFormulas, _\n                        searchorder:=xlByRows, searchdirection:=xlPrevious, MatchCase:=False)\n    If Not LastCell Is Nothing Then\n        FindLastRow = LastCell.Row\n    Else\n        MsgBox \"Error! worksheet is empty\", vbCritical\n        FindLastRow = -10000\n    End If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 702, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1511954510, "creation_date": 1511951292, "last_edit_date": 1531164843, "question_id": 47550530, "link": "https://stackoverflow.com/questions/47550530/specialcellsxllastcell-doesnt-update-after-deleting-rows", "title": "SpecialCells(xlLastCell) doesn&#39;t update after deleting rows", "body": "<p>I have the following vba code:</p>\n\n<pre><code>StartLastRow = .Cells(1, 1).SpecialCells(xlLastCell).Row\n\nIf StartLastRow &gt; 24 Then\n    .Cells(StartLastRow, 1).CurrentRegion.EntireRow.Delete\n    StartLastRow = .Cells(1, 1).SpecialCells(xlLastCell).Row\nEnd If\n</code></pre>\n\n<p>After deleting rows the value of <code>StartLastRow</code> remains the same.<br>\nHow can I fix it?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1511953634, "post_id": 47550520, "comment_id": 82059193, "body": "Hint: You can check the VAT number before adding to destination sheet using the same functionality you are using."}, {"owner": {"reputation": 1269, "user_id": 6065711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bedb05fd942a5a6acd9870d295d3afd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jochen", "link": "https://stackoverflow.com/users/6065711/jochen"}, "edited": false, "score": 0, "creation_date": 1511958910, "post_id": 47550520, "comment_id": 82062511, "body": "What about copying the range, remove duplicates and then sort?"}], "owner": {"reputation": 21, "user_id": 9025029, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-s2Ztjdc-P1s/AAAAAAAAAAI/AAAAAAAAABM/HB9e8p-pSVE/photo.jpg?sz=128", "display_name": "Volare Informati", "link": "https://stackoverflow.com/users/9025029/volare-informati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1511952415, "creation_date": 1511951277, "last_edit_date": 1511952415, "question_id": 47550520, "link": "https://stackoverflow.com/questions/47550520/vba-search-value-in-a-column-and-reorder-them-in-a-new-column", "title": "VBA - Search value in a column and reorder them in a new column", "body": "<p>in a column I have multiple values (Vat numbers) but not in consecutive rows, for example in A1, A5, A8,...\nI need to copy each value from column A and paste them in a new column but reordered in consecutive rows, for example B1,B2,B3,...</p>\n\n<p>The following macro does this job but only if in the value it is included the symbol \"@\" because it uses the function \"Array\" (if I replace @ with numbers as 1,2,3,4,5,6,7,8,9, I get the same VAT number multiple times and I do not require it).</p>\n\n<pre><code>Sub Copy_To_Another_Sheet_1()\n    Dim FirstAddress As String\n    Dim MyArr As Variant\n    Dim Rng As Range\n    Dim Rcount As Long\n    Dim I As Long\n    Dim NewSh As Worksheet\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n     MyArr = Array(\"@\")\n\n    Set NewSh = Sheets(\"Sheet2\")\n\n    With Sheets(\"Sheet2\").Range(\"A1:A100\")\n\n        Rcount = 0\n\n        For I = LBound(MyArr) To UBound(MyArr)\n\n            'If you use LookIn:=xlValues it will also work with a\n            'formula cell that evaluates to \"@\"\n            'Note : I use xlPart in this example and not xlWhole 'MyArr(I)\n            Set Rng = .Find(What:=MyArr(I), _\n                            After:=.Cells(.Cells.Count), _\n                            LookIn:=xlFormulas, _\n                            LookAt:=xlPart, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlNext, _\n                            MatchCase:=False)\n            If Not Rng Is Nothing Then\n                FirstAddress = Rng.Address\n                Do\n                    Rcount = Rcount + 1\n\n                    NewSh.Range(\"A\" &amp; Rcount).Value = Rng.Value\n\n                    ' Use this if you only want to copy the value\n                    ' NewSh.Range(\"A\" &amp; Rcount).Value = Rng.Value\n\n                    Set Rng = .FindNext(Rng)\n                Loop While Not Rng Is Nothing And Rng.Address &lt;&gt; FirstAddress\n            End If\n        Next I\n    End With\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>Thanks\nMarco</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1511952308, "creation_date": 1511952308, "answer_id": 47550877, "question_id": 47550436, "link": "https://stackoverflow.com/questions/47550436/vba-how-to-create-a-series-in-a-chart-with-more-than-1-x-value/47550877#47550877", "title": "VBA: How to create a series in a chart with more than 1 X value", "body": "<p>The addresses for the <code>XValues</code> need to be comma separated. </p>\n\n<p>The result should look something like: <code>=[Map1]Sheet1!C1,[Map1]Sheet1!N1:V1</code></p>\n\n<hr>\n\n<p>So you need to connect two addresses with <code>&amp; \",\" &amp;</code>.</p>\n\n<pre><code>.XValues = \"=\" &amp; dataws.Cells(CurrentRow, 3).Address(False, False, xlA1, xlExternal) &amp; \",\" &amp; _\n   dataws.Range(dataws.Cells(CurrentRow, 14), dataws.Cells(CurrentRow, 22)).Address(False, False, xlA1, xlExternal)\n</code></pre>\n\n<p>Note that continuous cells can be combined to one range address like:</p>\n\n<pre><code>dataws.Range(dataws.Cells(CurrentRow, 14), dataws.Cells(CurrentRow, 22))\n</code></pre>\n\n<p>which means cell 14 up to cell 22. So you don't need to add them separately.</p>\n"}], "owner": {"reputation": 31, "user_id": 9014543, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a7c8c299bd396ab1926838aaef3e6f3e?s=128&d=identicon&r=PG&f=1", "display_name": "RuilGaga", "link": "https://stackoverflow.com/users/9014543/ruilgaga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 47550877, "answer_count": 1, "score": 0, "last_activity_date": 1511952308, "creation_date": 1511951012, "question_id": 47550436, "link": "https://stackoverflow.com/questions/47550436/vba-how-to-create-a-series-in-a-chart-with-more-than-1-x-value", "title": "VBA: How to create a series in a chart with more than 1 X value", "body": "<p>I am trying to create a new series with VBA that will have more than 1 X-value.</p>\n\n<p>It's no problem when creating a series with only 1 X-value but it doesn't work with more than that. Can anyone help?</p>\n\n<p>Works:</p>\n\n<pre><code>.XValues = \"=\" &amp; Dataws.Cells(CurrentRow, 3).Address(False, False, xlA1, xlExternal)\n</code></pre>\n\n<p>Doesn't work (run time error 1004):</p>\n\n<pre><code>.XValues = \"=\" &amp; Dataws.Cells(CurrentRow, 3) &amp; Dataws.Cells(CurrentRow, 14) &amp; Dataws.Cells(CurrentRow, 15) &amp; Dataws.Cells(CurrentRow, 16) &amp; Dataws.Cells(CurrentRow, 17) &amp; Dataws.Cells(CurrentRow, 18) &amp; Dataws.Cells(CurrentRow, 19) &amp; Dataws.Cells(CurrentRow, 20) &amp; Dataws.Cells(CurrentRow, 21) &amp; Dataws.Cells(CurrentRow, 22).Address(False, False, xlA1, xlExternal)\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1511950957, "post_id": 47550208, "comment_id": 82057309, "body": "Use Data-&gt;Text to Columns"}, {"owner": {"reputation": 5, "user_id": 9019549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09675ae2deec41bf64d363949745a762?s=128&d=identicon&r=PG&f=1", "display_name": "tanu", "link": "https://stackoverflow.com/users/9019549/tanu"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1511951064, "post_id": 47550208, "comment_id": 82057398, "body": "Need to write a vba code for it and text to columns fails in the name@Tom"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1511951093, "post_id": 47550208, "comment_id": 82057416, "body": "Well show the vba code you have tried so far then. SO isn&#39;t a free code writing service"}, {"owner": {"reputation": 5, "user_id": 9019549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09675ae2deec41bf64d363949745a762?s=128&d=identicon&r=PG&f=1", "display_name": "tanu", "link": "https://stackoverflow.com/users/9019549/tanu"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1511951224, "post_id": 47550208, "comment_id": 82057514, "body": "Sorry @tom Sub ExampleSplit1()     Selection.TextToColumns _       Destination:=Range(&quot;A2&quot;), _       DataType:=xlDelimited, _       TextQualifier:=xlDoubleQuote, _       ConsecutiveDelimiter:=False, _       Tab:=True, _       Semicolon:=False, _       Comma:=False, _       Space:=False, _       Other:=True, _       OtherChar:=&quot;-&quot; End Sub"}, {"owner": {"reputation": 1462, "user_id": 2215858, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDGqN.jpg?s=128&g=1", "display_name": "Wisienkas", "link": "https://stackoverflow.com/users/2215858/wisienkas"}, "edited": false, "score": 1, "creation_date": 1511951237, "post_id": 47550208, "comment_id": 82057524, "body": "You might want to use a proper format so it knows how to split, Anita Sabarval contains a space which would be the obvious to split on here, maybe convert it to be CSV(Comma Seperated Values)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1511951296, "post_id": 47550208, "comment_id": 82057566, "body": "Hi Tanu.  If you need to write code there are a lot of great tutorials that you can find on Google to get you started.  Please check out this <a href=\"https://stackoverflow.com/tour\">tour</a> as well as <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  Important stuff... good luck!"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1511951647, "post_id": 47550208, "comment_id": 82057813, "body": "@tanu you said <code>This is my data in excel in one cell</code> . You have one cell of data?"}, {"owner": {"reputation": 5, "user_id": 9019549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09675ae2deec41bf64d363949745a762?s=128&d=identicon&r=PG&f=1", "display_name": "tanu", "link": "https://stackoverflow.com/users/9019549/tanu"}, "reply_to_user": {"reputation": 1462, "user_id": 2215858, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDGqN.jpg?s=128&g=1", "display_name": "Wisienkas", "link": "https://stackoverflow.com/users/2215858/wisienkas"}, "edited": false, "score": 0, "creation_date": 1511952525, "post_id": 47550208, "comment_id": 82058453, "body": "@Wisienkas tryed to do that. Still does not work if my automating it"}, {"owner": {"reputation": 5, "user_id": 9019549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09675ae2deec41bf64d363949745a762?s=128&d=identicon&r=PG&f=1", "display_name": "tanu", "link": "https://stackoverflow.com/users/9019549/tanu"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1511952638, "post_id": 47550208, "comment_id": 82058519, "body": "@ashleedawg I just pasted the code .Thank you"}, {"owner": {"reputation": 5, "user_id": 9019549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09675ae2deec41bf64d363949745a762?s=128&d=identicon&r=PG&f=1", "display_name": "tanu", "link": "https://stackoverflow.com/users/9019549/tanu"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1511952719, "post_id": 47550208, "comment_id": 82058582, "body": "@ashleedawg yes. It&#39;s only in one cell the entire string in A4 and A5"}, {"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1511952724, "post_id": 47550208, "comment_id": 82058587, "body": "Why <code>Space=False</code>? Try using  <code>Space:=True, Other:=False</code>."}, {"owner": {"reputation": 5, "user_id": 9019549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09675ae2deec41bf64d363949745a762?s=128&d=identicon&r=PG&f=1", "display_name": "tanu", "link": "https://stackoverflow.com/users/9019549/tanu"}, "reply_to_user": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1511952773, "post_id": 47550208, "comment_id": 82058623, "body": "@harun24hr when used that, it puts  the name in different columns"}, {"owner": {"reputation": 5, "user_id": 9019549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09675ae2deec41bf64d363949745a762?s=128&d=identicon&r=PG&f=1", "display_name": "tanu", "link": "https://stackoverflow.com/users/9019549/tanu"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1511953985, "post_id": 47550208, "comment_id": 82059427, "body": "@Tom    can an instr function be used and the split it"}, {"owner": {"reputation": 5, "user_id": 9019549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09675ae2deec41bf64d363949745a762?s=128&d=identicon&r=PG&f=1", "display_name": "tanu", "link": "https://stackoverflow.com/users/9019549/tanu"}, "reply_to_user": {"reputation": 1462, "user_id": 2215858, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDGqN.jpg?s=128&g=1", "display_name": "Wisienkas", "link": "https://stackoverflow.com/users/2215858/wisienkas"}, "edited": false, "score": 0, "creation_date": 1511954004, "post_id": 47550208, "comment_id": 82059440, "body": "@Wisienkas can an instr function be used and the split it"}, {"owner": {"reputation": 1462, "user_id": 2215858, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDGqN.jpg?s=128&g=1", "display_name": "Wisienkas", "link": "https://stackoverflow.com/users/2215858/wisienkas"}, "edited": false, "score": 0, "creation_date": 1511954171, "post_id": 47550208, "comment_id": 82059563, "body": "If you have it as CSV excel has a data insert wizard to insert the date.  Under the tab &quot;Data&quot; you&#39;ll fidn the option &quot;From Text/CSV&quot;, Should do the trick"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1511966228, "post_id": 47550208, "comment_id": 82067334, "body": "Why not to use regex?"}, {"owner": {"reputation": 5, "user_id": 9019549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09675ae2deec41bf64d363949745a762?s=128&d=identicon&r=PG&f=1", "display_name": "tanu", "link": "https://stackoverflow.com/users/9019549/tanu"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1511972512, "post_id": 47550208, "comment_id": 82072047, "body": "([a-z ]+?)\\s+(\\d+)\\s+([a-z]+)\\s+([\\d-\\/]+)\\s+([\\w ]+) used this but failes when there is another fied added in the middle like nagpur/opts @omegastripes"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1511972984, "post_id": 47550208, "comment_id": 82072379, "body": "@tanu please give more examples with another possible fields added."}, {"owner": {"reputation": 5, "user_id": 9019549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09675ae2deec41bf64d363949745a762?s=128&d=identicon&r=PG&f=1", "display_name": "tanu", "link": "https://stackoverflow.com/users/9019549/tanu"}, "edited": false, "score": 0, "creation_date": 1512034097, "post_id": 47550208, "comment_id": 82097157, "body": "Panjit 17 Male 17/8 nag/megha Coa no Radhika taruna 18 Femail 18/9 kal/jan+jog ulal No Yala-ii 18 Femail 18/9 hog/log-opt u32 Yes @omegastripeswant it in this format (panjit)(17)(male) (17/8) (nag/megha) (coa)(no) and (radhika tanura)(18)(femail)(18/9)(kal/jan+jog)(ulal)(no)in excel cells"}, {"owner": {"reputation": 5, "user_id": 9019549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09675ae2deec41bf64d363949745a762?s=128&d=identicon&r=PG&f=1", "display_name": "tanu", "link": "https://stackoverflow.com/users/9019549/tanu"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1512034431, "post_id": 47550208, "comment_id": 82097376, "body": "@omegastripes can&#39;t apse a picture in comments. Apologies"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1512046943, "post_id": 47550208, "comment_id": 82104984, "body": "@tanu Please edit the question to add examples and images. Use proper formatting."}, {"owner": {"reputation": 5, "user_id": 9019549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09675ae2deec41bf64d363949745a762?s=128&d=identicon&r=PG&f=1", "display_name": "tanu", "link": "https://stackoverflow.com/users/9019549/tanu"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1512105979, "post_id": 47550208, "comment_id": 82131686, "body": "@omegastripes there is the new image since I can&#39;t display it because it&#39;s the i/p and desired o/p image"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1512111063, "post_id": 47550208, "comment_id": 82133365, "body": "@tanu What does it mean - i/p, o/p?"}, {"owner": {"reputation": 5, "user_id": 9019549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09675ae2deec41bf64d363949745a762?s=128&d=identicon&r=PG&f=1", "display_name": "tanu", "link": "https://stackoverflow.com/users/9019549/tanu"}, "edited": false, "score": 0, "creation_date": 1512114834, "post_id": 47550208, "comment_id": 82134862, "body": "<b>i/p</b> is the <b>raw data</b> and <b>o/p</b> is the <b>desired output</b>"}, {"owner": {"reputation": 5, "user_id": 9019549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09675ae2deec41bf64d363949745a762?s=128&d=identicon&r=PG&f=1", "display_name": "tanu", "link": "https://stackoverflow.com/users/9019549/tanu"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1512114918, "post_id": 47550208, "comment_id": 82134906, "body": "You can click on the hyperlink since\t i/p is the raw data and o/p is the desired output @omegastripes"}], "answers": [{"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1511954039, "post_id": 47551416, "comment_id": 82059463, "body": "Text to Columns on Fixed Width would have worked too I guess.  Anyhow, it was kind of frustrating figuring out what you were talking about, please &#39;Accept&#39; my answer if it&#39;s what you wanted."}, {"owner": {"reputation": 5, "user_id": 9019549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09675ae2deec41bf64d363949745a762?s=128&d=identicon&r=PG&f=1", "display_name": "tanu", "link": "https://stackoverflow.com/users/9019549/tanu"}, "edited": false, "score": 0, "creation_date": 1511954166, "post_id": 47551416, "comment_id": 82059561, "body": "thank you. But, the 2M is getting separated into two columns"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 5, "user_id": 9019549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09675ae2deec41bf64d363949745a762?s=128&d=identicon&r=PG&f=1", "display_name": "tanu", "link": "https://stackoverflow.com/users/9019549/tanu"}, "edited": false, "score": 0, "creation_date": 1511959317, "post_id": 47551416, "comment_id": 82062793, "body": "Not for me.  Same data, same code. (See image above.)  You must have an extra space in there or something.  Anyhow, this is a place for learning, not for free coding.  Analyze the code I gave you, Google every bit of code piece by piece, and you&#39;ll figure it out.  Or if  you don&#39;t want to do that, <b>type <code>2m</code> in the cell</b>.  _(and then push <code>Enter</code>.)"}, {"owner": {"reputation": 5, "user_id": 9019549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09675ae2deec41bf64d363949745a762?s=128&d=identicon&r=PG&f=1", "display_name": "tanu", "link": "https://stackoverflow.com/users/9019549/tanu"}, "edited": false, "score": 0, "creation_date": 1511963415, "post_id": 47551416, "comment_id": 82065448, "body": "can you please help me , if the last name does not exist. Cause the result is absurd,then"}, {"owner": {"reputation": 5, "user_id": 9019549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09675ae2deec41bf64d363949745a762?s=128&d=identicon&r=PG&f=1", "display_name": "tanu", "link": "https://stackoverflow.com/users/9019549/tanu"}, "edited": false, "score": 0, "creation_date": 1515405480, "post_id": 47551416, "comment_id": 83273901, "body": "the date is getting converted after being delimited, could you please help me out with it"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 0, "last_activity_date": 1511959425, "last_edit_date": 1511959425, "creation_date": 1511953875, "answer_id": 47551416, "question_id": 47550208, "link": "https://stackoverflow.com/questions/47550208/how-do-i-separate-the-data-in-a-string-where-the-delimiter-character-is-sometime/47551416#47551416", "title": "How do I separate the data in a string where the delimiter character is sometimes not a delimiter?", "body": "<h1>Here:</h1>\n\n<p>using cell A4 as an example,</p>\n\n<pre><code>Sub ExampleSplit2()\n    Range(\"A4\") = Replace(Range(\"A4\"), \" \", \"_\", 1, 1)\n    Range(\"A4\") = Replace(Range(\"A4\"), \"  \", \" \")\n    Range(\"A4\") = Replace(Range(\"A4\"), \"  \", \" \")\n    Range(\"A4\") = Replace(Range(\"A4\"), \"  \", \" \")\n    Range(\"A4\").TextToColumns Range(\"A4\"), , , , , , , True\n    Range(\"A4\") = Replace(Range(\"A4\"), \"_\", \" \", 1, 1)\nEnd Sub  \n</code></pre>\n\n<p>This will split like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/cLTPG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cLTPG.png\" alt=\"ttc-example\"></a></p>\n\n<hr>\n\n<h2>Additional Information:</h2>\n\n<blockquote>\n  <p><kbd>2</kbd>  <kbd>M</kbd>  <kbd>Enter</kbd></p>\n</blockquote>\n"}], "owner": {"reputation": 5, "user_id": 9019549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09675ae2deec41bf64d363949745a762?s=128&d=identicon&r=PG&f=1", "display_name": "tanu", "link": "https://stackoverflow.com/users/9019549/tanu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 2, "accepted_answer_id": 47551416, "answer_count": 1, "score": 0, "last_activity_date": 1512105918, "creation_date": 1511950438, "last_edit_date": 1512105918, "question_id": 47550208, "link": "https://stackoverflow.com/questions/47550208/how-do-i-separate-the-data-in-a-string-where-the-delimiter-character-is-sometime", "title": "How do I separate the data in a string where the delimiter character is sometimes not a delimiter?", "body": "<h1>Names</h1>\n\n<p>Anita sabarval 90 Female  Nagpur/matheran  17/9  2.0 M Yes<br>\nPrabhal jjitu 70 Male Ista/lonavla 8/9 7M no</p>\n\n<p>This is my data in Excel in one cell of each row.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Y19Be.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y19Be.png\" alt=\"The data format\"></a></p>\n\n<pre>\n Name          age  type     loc             date     sal   given\nAnita sabarval  90  Female  Nagpur/matheran 17/9      2m    Yes\nPrabhal jjitu   70  Male    sta/lonavla     8/9/201   7M    no\n</pre>\n\n<p>The desired output in separate cells of each row.</p>\n\n<p><a href=\"https://i.stack.imgur.com/GH8cX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GH8cX.png\" alt=\"desired o/p\"></a></p>\n\n<pre><code>Note:  \nThe two part name with space between remains together in one cell  \n2.0 M with space between remains together in one cell\n</code></pre>\n\n<p>My attempt so far:</p>\n\n<pre><code>Sub ExampleSplit1()\n    Selection.TextToColumns _\n        Destination:=Range(\"A2\"), _\n        DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, _\n        ConsecutiveDelimiter:=False, _\n        Tab:=True, _\n        Semicolon:=False, _\n        Comma:=False, _\n        Space:=False, _\n        Other:=True, _\n        OtherChar:=\"-\"\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ye7XX.png\" rel=\"nofollow noreferrer\">I/p</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/0BhOJ.png\" rel=\"nofollow noreferrer\">Desired o/p</a></p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 8049476, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TqWg887jaqk/AAAAAAAAAAI/AAAAAAAAC80/4Y6mZabebpo/photo.jpg?sz=128", "display_name": "MICHAEL", "link": "https://stackoverflow.com/users/8049476/michael"}, "edited": false, "score": 0, "creation_date": 1512071960, "post_id": 47550414, "comment_id": 82120704, "body": "&quot;Note that if I is not incremented, all attachements will be placed (replaced)in the same file, so you see only one attachment, which will be the one from the last email in the folder.&quot; ---- this may very well be my problem Paul, as i have tried many variations and gone round in circles, as you&#39;d experience given my self schoolling in vba :)"}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1511950955, "creation_date": 1511950955, "answer_id": 47550414, "question_id": 47550113, "link": "https://stackoverflow.com/questions/47550113/myitems-sort-works-for-one-outlook-subfolder-but-dosnt-on-others/47550414#47550414", "title": "myItems.sort works for one Outlook subfolder but dosnt on others", "body": "<p>I see you sort the folder, take each item and sort the whole folder again. This is probably not what you mean.</p>\n\n<pre><code>myFolder.Items.Sort \"[ReceivedTime]\", True           ' sort folder\n\nFor Each myItem In myFolder.Items                    ' process each item\n    myFolder.Items.Sort \"[ReceivedTime]\", True       ' sort folder again: remove this line\n    If myItem.Attachments.Count &lt;&gt; 0 Then\n        For Each myAttachment In myItem.Attachments\n            I = 1                                     ' shouldn't this be incremented?\n</code></pre>\n\n<p>Note that if <code>I</code> is not incremented, all attachements will be placed (replaced)in the same file, so you see only one attachment, which will be the one from the last email in the folder.</p>\n\n<p>I am not sure what your problem/question is. First, I would remove the 2nd sort command. Re-sorting could mess-up the order in which<code>myItem</code> is obtained form the collection.</p>\n\n<p>But if you want to go into each sub folder, and sub folder, etcetera, you must develop a recursive procedure that sorts a folder, process each item, if item is a folder, descent into sub folder, sort folderr, etc.</p>\n"}, {"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 1, "last_activity_date": 1511975538, "creation_date": 1511975538, "answer_id": 47558167, "question_id": 47550113, "link": "https://stackoverflow.com/questions/47550113/myitems-sort-works-for-one-outlook-subfolder-but-dosnt-on-others/47558167#47558167", "title": "myItems.sort works for one Outlook subfolder but dosnt on others", "body": "<p>myItems.Sort would be fine.</p>\n\n<p>myFolder.Items.Sort despite documentation you may have seen is not valid.</p>\n\n<pre><code>Sub SaveAttachments_RsConfirmation()\n\nDim myOlapp As Outlook.Application\nDim myNameSpace As Outlook.NameSpace\nDim myFolder As Outlook.MAPIFolder\n\nDim myItems As Outlook.items\n\nSet myOlapp = CreateObject(\"Outlook.Application\")\nSet myNameSpace = myOlapp.GetNamespace(\"MAPI\")\nSet myFolder = myNameSpace.GetDefaultFolder(olFolderInbox)\n\nSet myFolder = myFolder.folders(\"Rs.Confirmation\")\n\n' Attempt to sort items in the folder\nmyFolder.items.Sort \"[ReceivedTime]\", True\nDebug.Print myFolder.items(1).Subject\n\n' False should be no different from True\nmyFolder.items.Sort \"[ReceivedTime]\", False\nDebug.Print myFolder.items(1).Subject\n\n' Create a collection of items\nSet myItems = myFolder.items\nmyItems.Sort \"[ReceivedTime]\", True\nDebug.Print myItems(1).Subject\n\n' False should sort opposite to True\nmyItems.Sort \"[ReceivedTime]\", False\nDebug.Print myItems(1).Subject\n\nExitRoutine:\n    Set myOlapp = Nothing\n    Set myNameSpace = Nothing\n    Set myFolder = Nothing\n    Set myItems = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 8049476, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TqWg887jaqk/AAAAAAAAAAI/AAAAAAAAC80/4Y6mZabebpo/photo.jpg?sz=128", "display_name": "MICHAEL", "link": "https://stackoverflow.com/users/8049476/michael"}, "edited": false, "score": 0, "creation_date": 1512071863, "post_id": 47561296, "comment_id": 82120646, "body": "Thanks for your feed back Dmitry. very helpful indeed!!"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1511987403, "creation_date": 1511987403, "answer_id": 47561296, "question_id": 47550113, "link": "https://stackoverflow.com/questions/47550113/myitems-sort-works-for-one-outlook-subfolder-but-dosnt-on-others/47561296#47561296", "title": "myItems.sort works for one Outlook subfolder but dosnt on others", "body": "<p>You are sorting one Items collection, but end up using a completely different object - every time you call MAPIFolder.Items, you get back a brand new COM object that has no knowledge of any other instances. Read the items collection once, store it in a variable, then loop through its items:</p>\n\n<pre><code>set myItems = myFolder.Items\nmyItems.Sort \"[ReceivedTime]\", True\nFor Each myItem In myItems \n  ...\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 8049476, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TqWg887jaqk/AAAAAAAAAAI/AAAAAAAAC80/4Y6mZabebpo/photo.jpg?sz=128", "display_name": "MICHAEL", "link": "https://stackoverflow.com/users/8049476/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 523, "favorite_count": 0, "accepted_answer_id": 47561296, "answer_count": 3, "score": 0, "last_activity_date": 1511987403, "creation_date": 1511950175, "question_id": 47550113, "link": "https://stackoverflow.com/questions/47550113/myitems-sort-works-for-one-outlook-subfolder-but-dosnt-on-others", "title": "myItems.sort works for one Outlook subfolder but dosnt on others", "body": "<p>Can anybody explain where i have gone wrong with the below excel vba? </p>\n\n<p>The code works for one sub folder.(extracts latest attachment) but when applied to another sub folder its extracts information from the oldest email, not the newest.</p>\n\n<p>Is 'myFolder.Items.sort' the right method applied?  </p>\n\n<p>Any feed back would be very much appreciated.  </p>\n\n<pre><code>Sub SaveAttachments_RsConfirmation()\nDim myOlapp As Outlook.Application\nDim myNameSpace As Outlook.Namespace\nDim myFolder As Outlook.MAPIFolder\nDim myItem As Outlook.MailItem\nDim myAttachment As Outlook.Attachment\nDim I As Long\n\nSet myOlapp = CreateObject(\"Outlook.Application\")\nSet myNameSpace = myOlapp.GetNamespace(\"MAPI\")\nSet myFolder = myNameSpace.GetDefaultFolder(olFolderInbox)\nSet myFolder = myFolder.Folders(\"Rs.Confirmation\")\n\n\nmyFolder.Items.Sort \"[ReceivedTime]\", True\n\nFor Each myItem In myFolder.Items\nmyFolder.Items.Sort \"[ReceivedTime]\", True\n    If myItem.Attachments.Count &lt;&gt; 0 Then\n        For Each myAttachment In myItem.Attachments\n\n            I = 1\n            myAttachment.SaveAsFile \"C:\\Del.Gen.v1\\Confirmation.Email\\\" &amp; I &amp; \".txt\"\n            eSender = myItem.SenderEmailAddress\n            dtRecvd = myItem.ReceivedTime\n            dtSent = myItem.CreationTime\n            sSubj = myItem.Subject\n            sMsg = myItem.Body\n\n            Exit For\n        Next\n    End If\nNext\n\n\n\nWorkbooks(\"Del.Gen.v1.xlsm\").Worksheets(\"Sheet4\").Range(\"A1\").Value = eSender\nWorkbooks(\"Del.Gen.v1.xlsm\").Worksheets(\"Sheet4\").Range(\"A2\").Value = dtRecvd\nWorkbooks(\"Del.Gen.v1.xlsm\").Worksheets(\"Sheet4\").Range(\"A3\").Value = dtSent\nWorkbooks(\"Del.Gen.v1.xlsm\").Worksheets(\"Sheet4\").Range(\"A4\").Value = sSubj\nWorkbooks(\"Del.Gen.v1.xlsm\").Worksheets(\"Sheet4\").Range(\"A5\").Value = sMsg\n\n\n\nDebug.Print eSender\nDebug.Print dtRecvd\nDebug.Print dtSent\nDebug.Print sSubj\nDebug.Print sMsg\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1511950294, "post_id": 47549941, "comment_id": 82056817, "body": "It is just a Typo: There is just a <code>\\ </code> missing before <code>SampleLogs</code> I think: <code>ActiveWorkbook.SaveAs FileName:=mFilePath &amp; &quot;\\SampleLogs-&quot; &amp; myDate &amp; &quot;-12352_checked&quot;</code>. So there must be a backslash between the path and the filename."}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1511950445, "post_id": 47549941, "comment_id": 82056925, "body": "Well hot damn, such a tiny mistake makes such a huge difference. Thank you very much for pointing that out! I&#39;d have never figured it out. Can you write it down as an answer so I can give you an upvote?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1511950598, "post_id": 47549941, "comment_id": 82057033, "body": "<code>myDate = Date - 1</code> will also give you error. Also you are not specifying file extension and file format number"}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1511950686, "post_id": 47549941, "comment_id": 82057089, "body": "it saves it as a plain workbook (prompting the user if she wants to save it as a macro free workbook), &#39;myDate = Date-1&#39; works on my end perfectly, there is no problem with the file name."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1511950761, "post_id": 47549941, "comment_id": 82057154, "body": "<code>&quot;\\SampleLogs-&quot; &amp; date - 1 &amp; &quot;-12352_checked&quot;</code> gives you <code>\\SampleLogs-28&#47;11&#47;2017-12352_checked</code> which will create problems becuase of &quot;/&quot;"}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1511951332, "post_id": 47549941, "comment_id": 82057595, "body": "It automatically replaces the <code>&quot;\\&quot;</code> with <code>&quot;-&quot;</code> for some odd reason, like if I run the code it saves the file with the following name <code>SampleLogs-2017-11-28-12352_checked</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1511951522, "post_id": 47549941, "comment_id": 82057718, "body": "No it doesn&#39;t automatically replace. your regional setting is as such..."}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1511951616, "post_id": 47549941, "comment_id": 82057782, "body": "Ah okay, didn&#39;t know that. So would it be fine as is then or should I weave in the <code>Replace</code> function?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1511952153, "post_id": 47549941, "comment_id": 82058193, "body": "Use the Replace. See the edit in my post. Since you are using Inputbox, I ameded the code slightly. You may have to refresh the page."}], "answers": [{"comments": [{"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1511950567, "post_id": 47550218, "comment_id": 82057006, "body": "Yeah this one is a simpler approach, unfortunately the user who&#39;ll be using the macro often checks backlogs so the date she&#39;s reviewing isn&#39;t always today&#39;s or yesterday&#39;s date hence the userinput function"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1511950692, "post_id": 47550218, "comment_id": 82057095, "body": "ok in that case modify the <code>FilePath_B</code>. But notice what i commented under your question"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1511950814, "post_id": 47550218, "comment_id": 82057200, "body": "@Peh: True that.. Fixed :)"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 3, "last_activity_date": 1511952124, "last_edit_date": 1511952124, "creation_date": 1511950460, "answer_id": 47550218, "question_id": 47549941, "link": "https://stackoverflow.com/questions/47549941/trying-to-save-workbook-to-a-folder-specified-by-the-user/47550218#47550218", "title": "Trying to save workbook to a folder specified by the user", "body": "<p>Why make it so complicated? I mean why ask for date when you can get that automatically?</p>\n\n<p>Is this what you are trying (<strong>UNTESTED</strong>)?</p>\n\n<pre><code>Sub PSSaveFile()\n    Dim FilePath_A As String, FilePath_B As String, FilePath_C As String\n    Dim sFile As String\n\n    FilePath_A = \"\\\\sample\\sample_emea\\sec_REPORTS\\APPS\\Reports\\Regional\\sample_security_app\\2017\\\"\n    FilePath_B = Format(Date, \"mm\\dd\")\n    FilePath_C = \"\\SampleLogs-\" &amp; Replace(Date - 1, \"/\", \"-\") &amp; \"-12352_checked.xlsx\"\n\n    sFile = FilePath_A &amp; FilePath_B &amp; FilePath_C\n\n    ActiveWorkbook.SaveAs sFile, 51\nEnd Sub\n</code></pre>\n\n<p><strong>Few things</strong></p>\n\n<ol>\n<li>While naming files avoid the use of special characters like <code>\\ / : * ? \" &lt; &gt; |</code> and hence we use <code>Replace(Date - 1, \"/\", \"-\")</code> in the above code</li>\n<li>Mention the file extention and file format number </li>\n<li>Break your code in easy to understand \"parts\". makes it easier to understand and manage the code.</li>\n</ol>\n\n<blockquote>\n  <p>Yeah this one is a simpler approach, unfortunately the user who'll be using the macro often checks backlogs so the date she's reviewing isn't always today's or yesterday's date hence the userinput function \u2013 Rhyfelwr 14 mins ago </p>\n</blockquote>\n\n<p>Since you are using InputBox you may want to use this</p>\n\n<pre><code>Sub PSSaveFile()\n    Dim FilePath_A As String, FilePath_B As String, FilePath_C As String\n    Dim sFile As String\n    Dim Ret As Variant\n\n    Ret = InputBox(\"Please enter date in mm\\dd format\")\n\n    If Ret = \"\" Then Exit Sub\n\n    FilePath_A = \"\\\\sample\\sample_emea\\sec_REPORTS\\APPS\\Reports\\Regional\\sample_security_app\\2017\\\"\n    FilePath_B = Ret\n\n    '~~&gt; Check if the folder path exists\n    If FileFolderExists(FilePath_A &amp; FilePath_B) Then\n        FilePath_C = \"\\SampleLogs-\" &amp; Replace(Date - 1, \"/\", \"-\") &amp; \"-12352_checked.xlsx\"\n\n        sFile = FilePath_A &amp; FilePath_B &amp; FilePath_C\n\n        ActiveWorkbook.SaveAs sFile, 51\n    Else\n        MsgBox \"The folder path \" &amp; FilePath_A &amp; FilePath_B &amp; \" doesn't exist\"\n    End If\nEnd Sub\n\nPublic Function FileFolderExists(strFullPath As String) As Boolean\n    On Error GoTo Whoa\n    If Not Dir(strFullPath, vbDirectory) = vbNullString Then FileFolderExists = True\nWhoa:\n    On Error GoTo 0\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 47550218, "answer_count": 1, "score": 0, "last_activity_date": 1511952124, "creation_date": 1511949704, "last_edit_date": 1511950232, "question_id": 47549941, "link": "https://stackoverflow.com/questions/47549941/trying-to-save-workbook-to-a-folder-specified-by-the-user", "title": "Trying to save workbook to a folder specified by the user", "body": "<p>Hi there I am trying to make a macro that saves a report to a specific folder. Our folders get generated every day like <code>C://Report_Type/2017/11/10</code> (where <code>/10</code> is the folder I'd want to save the file to). </p>\n\n<p>The code I have prompts the user to provide the date in order to have the folder located, and then it saves the file according to a specified name. </p>\n\n<p>However when I run the macro it saves the file in the <code>C://Report_Type/2017/11</code> root folder ignoring the day based on userinput. Could someone help where I got it wrong? </p>\n\n<p>It's a bit complicated to explain, but if you check the code then it makes sense. </p>\n\n<pre><code>Sub PSSaveFile()\n    Dim myVal2 As Variant\n    Dim myDate As String\n    Dim mFilePath As String\n\n    myVal2 = InputBox(\"Please enter today's date in mm\\dd format\")\n    myDate = Date - 1\n    mFilePath = \"\\\\sample\\sample_emea\\sec_REPORTS\\APPS\\Reports\\Regional\\sample_security_app\\2017\\\" &amp; myVal2\n\n    ActiveWorkbook.SaveAs FileName:=mFilePath &amp; \"SampleLogs-\" &amp; myDate &amp; \"-12352_checked\"\nEnd Sub\n</code></pre>\n\n<p>Thank you for the help in advance!</p>\n"}, {"tags": ["excel", "sftp", "putty", "pscp", "vba"], "comments": [{"owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 0, "creation_date": 1511948882, "post_id": 47549609, "comment_id": 82055870, "body": "Before running <code>pscp</code> make sure that the remote host is exists."}, {"owner": {"reputation": 197, "user_id": 7924696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bac2515dd90a7d382a3fd6af687c3c64?s=128&d=identicon&r=PG&f=1", "display_name": "RPrashant", "link": "https://stackoverflow.com/users/7924696/rprashant"}, "reply_to_user": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 0, "creation_date": 1511949121, "post_id": 47549609, "comment_id": 82056020, "body": "@AlexP Can you elaborate how to do this?(do you mean using ping command or something)"}, {"owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 1, "creation_date": 1511949496, "post_id": 47549609, "comment_id": 82056275, "body": "<code>ping -n 1 -w 100 SRC_IP_HERE &amp;&amp; ...</code>"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1511951396, "post_id": 47549609, "comment_id": 82057641, "body": "<a href=\"https://stackoverflow.com/questions/21020077/ping-ip-address-with-vba-code-and-return-results-in-excel\" title=\"ping ip address with vba code and return results in excel\">stackoverflow.com/questions/21020077/&hellip;</a>"}, {"owner": {"reputation": 197, "user_id": 7924696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bac2515dd90a7d382a3fd6af687c3c64?s=128&d=identicon&r=PG&f=1", "display_name": "RPrashant", "link": "https://stackoverflow.com/users/7924696/rprashant"}, "reply_to_user": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 0, "creation_date": 1511954363, "post_id": 47549609, "comment_id": 82059692, "body": "@AlexP  Thank you so much for your help.  Can we add connect timeout in above code? I have added it in my code, as shown in below but not working.   &quot;cmd.exe /c echo y |&quot;C:\\Program Files (x86)\\PuTTY\\pscp.exe&quot; -sftp <b>-oConnectTimeout = 100</b> -P 22 -l username_here -pw password_here ip_here:path_here &quot; &quot; Destination_path_here"}, {"owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 0, "creation_date": 1511954666, "post_id": 47549609, "comment_id": 82059856, "body": "I don&#39;t know of <code>-oConnectTimeout</code> in <code>pscp</code>."}, {"owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "edited": false, "score": 0, "creation_date": 1511967832, "post_id": 47549609, "comment_id": 82068648, "body": "There&#39;s no <code>-oConnectTimeout</code> in pscp."}, {"owner": {"reputation": 197, "user_id": 7924696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bac2515dd90a7d382a3fd6af687c3c64?s=128&d=identicon&r=PG&f=1", "display_name": "RPrashant", "link": "https://stackoverflow.com/users/7924696/rprashant"}, "reply_to_user": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "edited": false, "score": 0, "creation_date": 1512023426, "post_id": 47549609, "comment_id": 82091927, "body": "@MartinPrikryl Thanks for your help"}], "owner": {"reputation": 197, "user_id": 7924696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bac2515dd90a7d382a3fd6af687c3c64?s=128&d=identicon&r=PG&f=1", "display_name": "RPrashant", "link": "https://stackoverflow.com/users/7924696/rprashant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1181, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1511948720, "creation_date": 1511948720, "last_edit_date": 1531161705, "question_id": 47549609, "link": "https://stackoverflow.com/questions/47549609/how-to-add-connect-timeout-for-putty-sftp-command", "title": "How to add connect timeout for putty sftp command", "body": "<p>Currently I am working in Excel vba. I dont know much about it.</p>\n\n<p>I am doing file transfer operation using putty sftp command,\nI am using below code for the same.\nI have also installed winscp &amp; putty on my pc.</p>\n\n<p>My code is:</p>\n\n<pre><code>Dim shell As Object\nDim command As String\nDim errorCode As Integer\nDim waitOnReturn As Boolean: waitOnReturn = True\nDim windowStyle As Integer: windowStyle = 0\n\nSet shell = VBA.CreateObject(\"WScript.Shell\")\n\ncommand = \"cmd.exe /c echo y |\"C:\\Program Files (x86)\\PuTTY\\pscp.exe\" \n           -sftp -P 22 -l Username_Here -pw Password_Here\n            SRC_IP_Address_Here:File_Path_Here \" \" Destination_Path_Here\n\n' error code is 0 if all ok otherwise 1\nerrorCode = shell.Run(command, windowStyle, waitOnReturn)\n</code></pre>\n\n<p>Above  code works fine if ip address &amp; destination path exists,\nbut if ip address is not reachable in network excel takes 20-30 seconds for response &amp; errorCode  = 1.</p>\n\n<p>Is it possible to modify above code in such a way that it should give me response only within 10 sec?</p>\n\n<p>How can I set putty sftp connection timeout in above code?</p>\n\n<p>I tried following links but not getting any result:</p>\n\n<p><a href=\"https://patrickmn.com/aside/how-to-keep-alive-ssh-sessions/\" rel=\"nofollow noreferrer\">https://patrickmn.com/aside/how-to-keep-alive-ssh-sessions/</a></p>\n\n<p><a href=\"https://www.computerhope.com/unix/sftp.htm\" rel=\"nofollow noreferrer\">https://www.computerhope.com/unix/sftp.htm</a></p>\n\n<p><a href=\"https://library.netapp.com/ecmdocs/ECMP1196993/html/GUID-02FF883B-9913-4137-BC8B-5CB47282B944.html\" rel=\"nofollow noreferrer\">https://library.netapp.com/ecmdocs/ECMP1196993/html/GUID-02FF883B-9913-4137-BC8B-5CB47282B944.html</a></p>\n\n<p><a href=\"https://tartarus.org/~simon/putty-snapshots/htmldoc/Chapter5.html\" rel=\"nofollow noreferrer\">https://tartarus.org/~simon/putty-snapshots/htmldoc/Chapter5.html</a></p>\n"}, {"tags": ["vba", "excel", "hyperlink"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 4, "creation_date": 1511948699, "post_id": 47549544, "comment_id": 82055729, "body": "on which line is the error occuring?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1511949033, "post_id": 47549544, "comment_id": 82055973, "body": "Note: <code>Row_Number</code> and <code>Last_Row</code> should be of type <code>Long</code> not <code>Integer</code>. Excel has more rows than <code>Integer</code> can handle. I recommend to <a href=\"https://stackoverflow.com/a/26409520/3219613\">always use Long instead of Integer</a>!"}], "answers": [{"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1511951072, "post_id": 47550449, "comment_id": 82057405, "body": "Also, please check out the <a href=\"https://stackoverflow.com/tour\">tour</a> as well as <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 1, "user_id": 9024742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa5fc69e985f2025d723a2229f7be8e8?s=128&d=identicon&r=PG&f=1", "display_name": "Guido", "link": "https://stackoverflow.com/users/9024742/guido"}, "edited": false, "score": 1, "creation_date": 1511954466, "post_id": 47550449, "comment_id": 82059737, "body": "Thanx, the soultion was to add an Anchor: &#39;ActiveRow.Range(1, 1).Hyperlinks.Add Anchor:=ActiveRow.Range(1, 1), Address:=Range(&quot;A&quot; &amp; Row_Number).Hyperlinks.Item(1).Address&#39;"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1511951045, "creation_date": 1511951045, "answer_id": 47550449, "question_id": 47549544, "link": "https://stackoverflow.com/questions/47549544/excel-vba-copy-hyperlink-from-a-cell-to-a-column-in-a-table/47550449#47550449", "title": "Excel VBA copy hyperlink from a cell to a column in a table", "body": "<p>Your code has a few issues but without explanation or responses we won't be able to give you a definitive answer.  </p>\n\n<p>I am not convinced that everything is working fine except for adding the hyperlink, but you can confirm that by <strong>commenting out</strong> the line that adds the hyperlink and running your code again.</p>\n\n<pre><code>' ActiveRow.Range(1, 2).Hyperlinks.Add Range(\"A\" &amp; Row_Number ).Hyperlinks.Item(1).Address\n</code></pre>\n\n<p>If the code works fine now, then there could still be a number of issues.</p>\n\n<p>I assume you are probably trying to get a hyperlink from a cell that doesn't <em>have</em> a hyperlink (but I don't know since you didn't share your data.)  If so you can use <code>Hyperlinks.Count</code> to check if there is a usable link.</p>\n\n<p>You are definitely using <code>Hyperlink.Add</code> incorrectly. </p>\n\n<p><strong>Read more</strong> here: <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/hyperlinks-add-method-excel?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/hyperlinks-add-method-excel?f=255&amp;MSPPError=-2147217396</a> and then edit your question to add more information.</p>\n"}], "owner": {"reputation": 1, "user_id": 9024742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa5fc69e985f2025d723a2229f7be8e8?s=128&d=identicon&r=PG&f=1", "display_name": "Guido", "link": "https://stackoverflow.com/users/9024742/guido"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1111, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1511954421, "creation_date": 1511948520, "last_edit_date": 1511954421, "question_id": 47549544, "link": "https://stackoverflow.com/questions/47549544/excel-vba-copy-hyperlink-from-a-cell-to-a-column-in-a-table", "title": "Excel VBA copy hyperlink from a cell to a column in a table", "body": "<p>I would like to copy rows from a source sheet to a target table. Coping the values is no problem. </p>\n\n<p>The column A in the source sheet contains a hyperlink to a website.<br>\nI would like to copy the hyperlink too.</p>\n\n<p>However this code gives an error (type mismatch).</p>\n\n<pre><code>Sub Copy_Hyperlink()\n    Dim ActiveSheet As Worksheet\n    Dim ActiveTable As ListObject\n    Dim Row_Number As Integer\n    Dim Last_Row As Integer\n    Dim ActiveRow As ListRow\n    Dim Hyperlink As Hyperlink\n    Set ActiveSheet = Sheets(\"Sheet2\")\n    Set ActiveTable = ActiveSheet.ListObjects(\"Table1\")\n    Set ActiveSheet = Sheets(\"Sheet1\")    \n\n    ActiveSheet.Activate\n    Last_Row = ActiveSheet.Cells(Cells.Rows.Count, 1).End(xlUp).Row\n\n    For Row_Number = 2 To Last_Row\n        Set ActiveRow = ActiveTable.ListRows.Add\n        ActiveRow.Range(1, 1).Value = Range(\"A\" &amp; Row_Number).Value\n        ActiveRow.Range(1, 2).Value = Range(\"B\" &amp; Row_Number).Value\n        ActiveRow.Range(1, 2).Hyperlinks.Add Range _\n    (\"A\" &amp;   Row_Number).Hyperlinks.Item(1).Address\n    Next Row_Number\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1511949229, "post_id": 47549239, "comment_id": 82056101, "body": "The starting point for any request like this should be &quot;Fire up the macro recorder, perform a filter, and see what code it spits out&quot;."}, {"owner": {"reputation": 429, "user_id": 8841973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/315b8fe679afc0bdbed1296760210350?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/8841973/deepak"}, "reply_to_user": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1511949421, "post_id": 47549239, "comment_id": 82056229, "body": "@jeffreyweir It is like this.   &#39;ActiveSheet.ListObjects(&quot;DataTable&quot;).Range.AutoFilter Field:=6, Criteria1:=  Array(&quot;AT&quot;, &quot;BY&quot;, &quot;DE&quot;, &quot;FI&quot;, &quot;GI&quot;), Operator:=xlFilterValues&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 429, "user_id": 8841973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/315b8fe679afc0bdbed1296760210350?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/8841973/deepak"}, "edited": false, "score": 0, "creation_date": 1511949088, "post_id": 47549703, "comment_id": 82055997, "body": "I don&#39;t need pivot. I need to do in VBA"}], "tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 1, "last_activity_date": 1511948993, "creation_date": 1511948993, "answer_id": 47549703, "question_id": 47549239, "link": "https://stackoverflow.com/questions/47549239/how-to-copy-using-multiple-filter-from-user-inputbox-data-in-excel-vba/47549703#47549703", "title": "How to copy using Multiple filter from user inputbox data in Excel VBA", "body": "<p>Why not simply make a PivotTable out of the data, put the PivotTable in the other sheet, and add a slicer so that users can select the countries that they want? No VBA necessary.</p>\n"}, {"tags": [], "owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "is_accepted": false, "score": 1, "last_activity_date": 1511949537, "creation_date": 1511949537, "answer_id": 47549873, "question_id": 47549239, "link": "https://stackoverflow.com/questions/47549239/how-to-copy-using-multiple-filter-from-user-inputbox-data-in-excel-vba/47549873#47549873", "title": "How to copy using Multiple filter from user inputbox data in Excel VBA", "body": "<p>Use the following sub which take two criteria to filter the table and copy filtered data to <code>sheet2</code>. You can add more criteria as you need.</p>\n\n<pre><code>Sub Filter2Criteria()\nDim str1, str2 As Variant\nDim Tbl As ListObject\nDim FiltRng As Range\nDim RngArea As Range\n\n    Set Tbl = Sheet1.ListObjects(\"DataTable\")\n\n    str1 = Application.InputBox(\"Select the Country Code\")\n    str2 = Application.InputBox(\"Select the Country Code\")\n\n    If str1 = False Then\n        MsgBox \"Please select first Country\", , \"Input\"\n          Exit Sub\n          ElseIf str2 = False Then\n         MsgBox \"Please select second Country\", , \"Input\"\n        Exit Sub\n    End If\n\n    Tbl.Range.AutoFilter Field:=6, Criteria1:=str1, Operator:=xlOr, Criteria2:=str2\n\n    Set FiltRng = Tbl.Range.SpecialCells(xlCellTypeVisible)\n    FiltRng.Copy Sheets(\"Sheet2\").Range(\"A2\")\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 429, "user_id": 8841973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/315b8fe679afc0bdbed1296760210350?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/8841973/deepak"}, "edited": false, "score": 0, "creation_date": 1511954893, "post_id": 47550408, "comment_id": 82060012, "body": "Thank you. Works perfectly."}, {"owner": {"reputation": 1540, "user_id": 5829910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/abHFX.jpg?s=128&g=1", "display_name": "Zsmaster", "link": "https://stackoverflow.com/users/5829910/zsmaster"}, "reply_to_user": {"reputation": 429, "user_id": 8841973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/315b8fe679afc0bdbed1296760210350?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/8841973/deepak"}, "edited": false, "score": 0, "creation_date": 1511955231, "post_id": 47550408, "comment_id": 82060216, "body": "Glad I help you."}], "tags": [], "owner": {"reputation": 1540, "user_id": 5829910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/abHFX.jpg?s=128&g=1", "display_name": "Zsmaster", "link": "https://stackoverflow.com/users/5829910/zsmaster"}, "is_accepted": true, "score": 4, "last_activity_date": 1511950949, "creation_date": 1511950949, "answer_id": 47550408, "question_id": 47549239, "link": "https://stackoverflow.com/questions/47549239/how-to-copy-using-multiple-filter-from-user-inputbox-data-in-excel-vba/47550408#47550408", "title": "How to copy using Multiple filter from user inputbox data in Excel VBA", "body": "<p>You can read from InputBox in a loop. Try the following code.</p>\n\n<pre><code>Sub Macro3()\n    Dim arr() As String\n    Dim size As Long\n    size = 1\n\n    Do\n        str1 = Application.InputBox(\"Select the Country Code\")\n\n        ReDim Preserve arr(size)\n        arr(size) = str1\n        size = size + 1\n    Loop While (str1 &lt;&gt; vbNullString) And (str1 &lt;&gt; False)\n\n    ActiveSheet.Range(\"$A$1:$F$5\").AutoFilter Field:=6, Criteria1:=arr, Operator:=xlFilterValues\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 429, "user_id": 8841973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/315b8fe679afc0bdbed1296760210350?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/8841973/deepak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 827, "favorite_count": 0, "accepted_answer_id": 47550408, "answer_count": 3, "score": 4, "last_activity_date": 1511950949, "creation_date": 1511947667, "question_id": 47549239, "link": "https://stackoverflow.com/questions/47549239/how-to-copy-using-multiple-filter-from-user-inputbox-data-in-excel-vba", "title": "How to copy using Multiple filter from user inputbox data in Excel VBA", "body": "<p><a href=\"https://i.stack.imgur.com/SYywq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SYywq.png\" alt=\"enter image description here\"></a></p>\n\n<p>I would like to get more than 1 input from user via inputbox and filter the table. Only one column is filtered. Then copy the entire row data to another sheet. I used the code below. The problem is it can be used to filter 1 country.</p>\n\n<p>I have plenty of countries in column F. I need to enter 2 or more countries in inputbox. Then copy and paste. I would like to add Loop. But i dont know how. Help me</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim str1 As Variant\nDim Tbl As ListObject\nDim FiltRng As Range\nDim RngArea As Range\n\nSet Tbl = Sheet1.ListObjects(\"DataTable\")\nstr1 = Application.InputBox(\"Select the Country Code\")\n\nIf str1 = False Then\n    MsgBox \"Please select one Country\", , \"Input\"\nExit Sub\n\nElse\n\nTbl.Range.AutoFilter Field:=6, Criteria1:=str1\nFor Each RngArea In Tbl.Range.SpecialCells(xlCellTypeVisible).Rows\n\nIf RngArea.Row &gt; 1 Then\n    If Not FiltRng Is Nothing Then\n        Set FiltRng = Application.Union(FiltRng, RngArea)\n    Else\n        Set FiltRng = RngArea\n    End If\nEnd If\n\nNext RngArea\n\nIf Not FiltRng Is Nothing Then\nFiltRng.Copy Sheets(\"Sheet2\").Range(\"A2\")\nEnd If\n\nEnd If\n\nSheet1.ListObjects(\"DataTable\").Range.AutoFilter Field:=6\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "vbscript"], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": true, "score": 0, "last_activity_date": 1511950328, "creation_date": 1511950328, "answer_id": 47550174, "question_id": 47547711, "link": "https://stackoverflow.com/questions/47547711/how-to-export-message-box-display-data-in-excel-to-access-database-table-using-v/47550174#47550174", "title": "How to export message box display data in excel to access database table using vba", "body": "<p>It seems you want to make an audit/logging function of all changes to a an Excel workbook.</p>\n\n<p>You have two pieces of code, one to identify the change and one to write information to a datbase, an you want to combine this. The resulting functionality wold then be to write every change the user makes to a database.</p>\n\n<p>The code you have should give you enough guidance on the particular VBA statements. I'll limit this solution to the approach.</p>\n\n<p>As you will need the database connection during the whole time the user has the worksheet opened, you should make the database connection in the Workbook Open event:</p>\n\n<pre><code>Public cnn As ADODB.Connection\nPublic MyConn\n\nPrivate Sub Workbook_Open()\n    Set cnn = New ADODB.Connection\n    MyConn = ThisWorkbook.Path &amp; Application.PathSeparator &amp; TARGET_DB\n    With cnn\n        .Provider = \"Microsoft.ACE.OLEDB.12.0\"\n        .Open MyConn\n    End With\nEnd Sub\n</code></pre>\n\n<p>Then you continue in the Change events:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    '.... (your code to get the change)\n\n    Set rst = New ADODB.Recordset\n\n    rst.AddNew                     ' allocate new record\n    rst(j) = Cells(i, j).Value     ' populate the record (this must be your code)\n    rst.Update                     ' update/insert record\n    rst.Close                      ' done record.\nEnd Sub\n</code></pre>\n\n<p>Finally you close the database in the Workbook_BeforeClose event.</p>\n"}], "owner": {"reputation": 133, "user_id": 8674336, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/e98e54e12ecc096c09664a2785312cfc?s=128&d=identicon&r=PG&f=1", "display_name": "saurabh255", "link": "https://stackoverflow.com/users/8674336/saurabh255"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 467, "favorite_count": 0, "accepted_answer_id": 47550174, "answer_count": 1, "score": 0, "last_activity_date": 1511950328, "creation_date": 1511942328, "last_edit_date": 1511942739, "question_id": 47547711, "link": "https://stackoverflow.com/questions/47547711/how-to-export-message-box-display-data-in-excel-to-access-database-table-using-v", "title": "How to export message box display data in excel to access database table using vba", "body": "<p>I have a code in vba through which whenever i will  save any new value in a particular cell it will show in the message box that what was the old value stored in the cell and what was the new value which i have just saved below is the code for that </p>\n\n<pre><code>Option Explicit\n\nDim OldVals As New Dictionary\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim myCell As Range\n\n    For Each myCell In Target\n        If OldVals.Exists(myCell.Address) Then\n           MsgBox \"New value of \" &amp; Replace(myCell.Address, \"$\", \"\") &amp; \" is \" &amp; myCell.Value &amp; \"; old value was \" &amp; OldVals(myCell.Address)\n        Else\n           MsgBox \"No old value for \" + Replace(myCell.Address, \"$\", \"\")\n        End If\n        OldVals(myCell.Address) = myCell.Value\n    Next myCell\n\nEnd Sub\n</code></pre>\n\n<p><strong>the output window of the code will come like this in the picture below --</strong>\n<a href=\"https://i.stack.imgur.com/1Dlkk.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1Dlkk.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><strong>so i want to export the values which was displayed in the message box to the access database table using vba one after the another</strong></p>\n\n<p>however i have written a code to export and save the values of excel sheet cells into access database table the code is below</p>\n\n<pre><code>Const TARGET_DB = \"\\Database3.accdb\"\n    Sub PushTableToAccess()\n    Dim cnn As ADODB.Connection\n    Dim MyConn\n    Dim rst As ADODB.Recordset\n    Dim i As Long, j As Long\n    Dim Rw As Long\n\n    Sheets(\"Sheet1\").Activate\n    Rw = Range(\"A1\").End(xlDown).Row\n\n    Set cnn = New ADODB.Connection\n    MyConn = ThisWorkbook.Path &amp; Application.PathSeparator &amp; TARGET_DB\n\n    With cnn\n    .Provider = \"Microsoft.ACE.OLEDB.12.0\"\n    .Open MyConn\n    End With\n\n\n\n    Set rst = New ADODB.Recordset\n    rst.CursorLocation = adUseServer\n    rst.Open Source:=\"Table1\", ActiveConnection:=cnn, _\n    CursorType:=adOpenDynamic, LockType:=adLockOptimistic, _\n    Options:=adCmdTable\n\n    For i = 2 To Rw\n        rst.AddNew\n        For j = 1 To 3\n            rst(j) = Cells(i, j).Value\n        Next j\n        rst.Update\n    Next i\n\n\n    rst.Close\n    cnn.Close\n    Set rst = Nothing\n    Set cnn = Nothing\n\n    End Sub\n</code></pre>\n\n<p>the above code will export and save all the values in excel cells to access database table .</p>\n\n<p>but i am not sure how to combine both the codes so that  my first code whenever it will display the old and new values of cell and when i click on OK button it will export and save the value displayed in message box <strong>(eg- new value of  A1 is 7 ; old value was 88)</strong>  to access database table one after the another .</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1511939635, "post_id": 47546955, "comment_id": 82050557, "body": "<code>if statement</code> is case sensitive, so <code>CA-DIS</code> not equals <code>ca-dis</code>, did you know about that?"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 1, "creation_date": 1511939677, "post_id": 47546955, "comment_id": 82050578, "body": "use one <code>if&#47;then&#47;else</code> instead of two separate mutually exclusive <code>if</code> statements"}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 1, "creation_date": 1511939724, "post_id": 47546955, "comment_id": 82050590, "body": "answering the second part what you need is probably this line of code: <code>set wbk1 = wb</code>."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1511939814, "post_id": 47546955, "comment_id": 82050638, "body": "Just a Note: &quot;<i>I have some problem on getting a message box</i>&quot; Is not a useful error description. You should always include at least what is going wrong, what did you expect instead and where you got stuck or errors (and which). Otherwise we have to guess what your issue is."}, {"owner": {"reputation": 23, "user_id": 5198560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e24f068d50ee0294099ab426b63b13d?s=128&d=identicon&r=PG&f=1", "display_name": "K Sudhakar", "link": "https://stackoverflow.com/users/5198560/k-sudhakar"}, "edited": false, "score": 0, "creation_date": 1511940126, "post_id": 47546955, "comment_id": 82050773, "body": "Thank you each and everyone who replied to my concern and im really sorry if my words are wrong.. but i still have confuse on set wbk1 = wb but it is not choosing CA-DIS file which i found  i want this to name , i&#39;d request some one to help me out how to activate only &quot;CA-DIS&quot; file while multiple wrkbooks in open"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1511940202, "post_id": 47546955, "comment_id": 82050822, "body": "what are you thinking? ... you will get a popup message for every single worksheet in the workbook. ... what are you going to do if you have 50 worksheets? you will have to close each of those 50 message boxes."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 1, "creation_date": 1511940323, "post_id": 47546955, "comment_id": 82050869, "body": "@jsotola I think this is just a intermediate code or <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to illustrate the issue and will probably replaced by its actual code later."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1511940559, "post_id": 47546955, "comment_id": 82050979, "body": "what does <code>sleeted</code> mean?"}, {"owner": {"reputation": 23, "user_id": 5198560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e24f068d50ee0294099ab426b63b13d?s=128&d=identicon&r=PG&f=1", "display_name": "K Sudhakar", "link": "https://stackoverflow.com/users/5198560/k-sudhakar"}, "edited": false, "score": 0, "creation_date": 1511940573, "post_id": 47546955, "comment_id": 82050986, "body": "Sir/Madam,   i have a file name called &quot;CA-disbursal-DETAILS-281120171156&quot; in this &quot;CA-disbursal-DETAILS-&quot; is a standard word but numeric keeps on change each time i download from the server , so what i want is i want find this workbook using first 6 letters and also i want this work book name is something like wbk1 wbk2 etc.. bcz i do have to match data with multiple workbooks also i have already named them as x wb , y wb etc..."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5198560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e24f068d50ee0294099ab426b63b13d?s=128&d=identicon&r=PG&f=1", "display_name": "K Sudhakar", "link": "https://stackoverflow.com/users/5198560/k-sudhakar"}, "edited": false, "score": 2, "creation_date": 1511940999, "post_id": 47547260, "comment_id": 82051199, "body": "Thank you very much Siddharth Rout sir Also for each and everyone who answered me , I&#39;m expecting everyone&#39;s continued support endeavor...."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 4, "last_activity_date": 1511940656, "creation_date": 1511940656, "answer_id": 47547260, "question_id": 47546955, "link": "https://stackoverflow.com/questions/47546955/find-workbook-by-beginning-of-its-name/47547260#47547260", "title": "Find workbook by beginning of its name", "body": "<p><strong>Untested</strong></p>\n\n<p>Is this what you are trying?</p>\n\n<pre><code>Sub Sample()\n    Dim wb As Workbook\n    Dim WBK1 As Workbook\n\n    For Each wb In Application.Workbooks\n        If UCase(Left(Trim(wb.Name), 6)) = \"CA-DIS\" Then\n            Set WBK1 = wb\n            Exit For\n        End If\n    Next\n\n    If Not WBK1 Is Nothing Then\n        With WBK1\n            '~~&gt; Do what you want\n        End With\n    Else\n        MsgBox \"Workbook CA-DIS not found\"\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<ol>\n<li><code>Trim(wb.Name)</code> trims leading and trailing spaces.</li>\n<li><code>Left(Trim(wb.Name), 6)</code> will give the 6 chars that you are looking for</li>\n<li><code>UCase(Left(Trim(wb.Name), 6))</code> will convert it to Uppercase.</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 5198560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e24f068d50ee0294099ab426b63b13d?s=128&d=identicon&r=PG&f=1", "display_name": "K Sudhakar", "link": "https://stackoverflow.com/users/5198560/k-sudhakar"}, "edited": false, "score": 0, "creation_date": 1511943485, "post_id": 47547879, "comment_id": 82052472, "body": "Sub CopyByHeader()     Dim wb1 As Workbook     Dim Disb As Workbook     For Each wb In Application.Workbooks         If UCase(Left(Trim(wb.Name), 6)) = &quot;CA-DIS&quot; Then                 Set Disb = wb1                 Exit For             End If         Next          &#39; &quot;CA-DIS&quot; WB1 name set as Disb     Dim CurrentWS As Worksheet     Set CurrentWS = ActiveSheet      Dim SourceWS As Worksheet     Set SourceWS = Disb.Worksheets(1) ===&gt;&gt;&gt; here im getting error     Dim SourceHeaderRow As Integer: SourceHeaderRow = 1     Dim SourceCell As Range"}, {"owner": {"reputation": 412, "user_id": 8907742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiXbC.jpg?s=128&g=1", "display_name": "JPR", "link": "https://stackoverflow.com/users/8907742/jpr"}, "reply_to_user": {"reputation": 23, "user_id": 5198560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e24f068d50ee0294099ab426b63b13d?s=128&d=identicon&r=PG&f=1", "display_name": "K Sudhakar", "link": "https://stackoverflow.com/users/5198560/k-sudhakar"}, "edited": false, "score": 0, "creation_date": 1511944346, "post_id": 47547879, "comment_id": 82052923, "body": "After the &quot;for each&quot; loop you should check if the Disb variable is &quot;nothing&quot; (in other words if it &quot;contains&quot; a workbook): just put this after the &quot;for each&quot; loop <code>If Disb Is Nothing Then Exit Sub</code>"}], "tags": [], "owner": {"reputation": 412, "user_id": 8907742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiXbC.jpg?s=128&g=1", "display_name": "JPR", "link": "https://stackoverflow.com/users/8907742/jpr"}, "is_accepted": false, "score": 0, "last_activity_date": 1511946758, "last_edit_date": 1511946758, "creation_date": 1511942895, "answer_id": 47547879, "question_id": 47546955, "link": "https://stackoverflow.com/questions/47546955/find-workbook-by-beginning-of-its-name/47547879#47547879", "title": "Find workbook by beginning of its name", "body": "<pre><code>Sub GetWorkbookByHeader()\n\n    Dim wb As Workbook\n    Dim wbDis As Workbook\n\n    For Each wb In Application.Workbooks\n        If UCase(wb.Name) Like \"CA-DIS*\" Then\n        'OR:' If UCase(Left(Trim(wb.Name), 6)) = \"CA-DIS\" Then\n            Set wbDis = wb\n            Exit For\n        End If\n    Next\n\n    ' Exit if no matching workbook was found.\n    If wbDis Is Nothing Then\n        MsgBox \"No Disb workbook!\"\n        Exit Sub\n    End If\n\n    'We have a matching workbook (stored in wbDis), continue:\n\n    ... ' ===&gt;&gt;&gt; You were getting an error because wbDis was \"nothing\" and therefore did not have a worksheets(1) property.\n\nEnd Sub\n</code></pre>\n\n<p>Adding to Siddharth Rout's Answer:\nYou can also use the \"like\" operator (it is more flexible and more easy to change and tailor to your specific needs):</p>\n\n<pre><code>UCase(wb.Name)) like \"CA-DIS*\" \n</code></pre>\n\n<p><code>*</code> is a wildcard you can use to match any string of characters.</p>\n\n<p>You can also use other wildcards like:</p>\n\n<p><code>?</code> - to match a single character (you can repeat it to match a specific number of characters)</p>\n\n<p><code>[0-9]</code> - to match only numbers (you can restrict the number range further, for instance to match ony numbers from 1 to 3 <code>[1-3]</code>)</p>\n\n<p><code>[A-z]</code> - to match only letters (again you can restrict the range, for instance <code>A-Z</code>for upper case only or <code>[a-z]</code> for lowercase only).</p>\n\n<p>And there are endless combinations for you to match specific paterns like:</p>\n\n<p><code>[a-cA-C]</code> - to match a character in the set {A,B,C,a,b,c}</p>\n\n<p><code>[0-5a-cA-C]</code> - to match a character in the set {1,2,3,4,5,A,B,C,a,b,c}</p>\n\n<p>And you can deny the pattern within the brackets:\n<code>[!a]</code> - Match anything other than 'a'</p>\n\n<p>Don't forget that if you need to match an asterisk (<code>*</code>) or other \"special\" characters you need to enclose them in brackets:\n<code>[*]</code> - Literally matches an asterisk</p>\n\n<p>This really is a powerful tool (and if you ever need more power than this, you can check out Regular Expressions, which can be used in visual basic if you add the appropriate reference).</p>\n\n<p>More info: <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/operators/like-operator\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/operators/like-operator</a></p>\n"}], "owner": {"reputation": 23, "user_id": 5198560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e24f068d50ee0294099ab426b63b13d?s=128&d=identicon&r=PG&f=1", "display_name": "K Sudhakar", "link": "https://stackoverflow.com/users/5198560/k-sudhakar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 47547260, "answer_count": 2, "score": 2, "last_activity_date": 1511946758, "creation_date": 1511939362, "last_edit_date": 1511939912, "question_id": 47546955, "link": "https://stackoverflow.com/questions/47546955/find-workbook-by-beginning-of-its-name", "title": "Find workbook by beginning of its name", "body": "<p>I have some problem on getting a message box</p>\n\n<pre><code>Sub FindingNewWBNAme()\n\n    For Each Wb In Application.Workbooks ' I'm activating all open workbooks\n        If Left(Wb.Name, 6) = \"CA-DIS\" Then ' i want to find particular workbook\n            MsgBox \"Found\"   'Incase find i need found message box\n        End If\n\n        If Left(Wb.Name, 6) &lt;&gt; \"CA-DIS\" Then  'Incase not find i need not found\n            MsgBox \"Not Found\"\n        End If\n\n    Next\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Also I require the workbook to be sleeted with particular name\nlike WBK 1 or WBK2 ... etc..</p>\n\n<p>I'm trying </p>\n\n<pre><code>Dim WB as workbook\nDim WBK1 as workbook\nSet WBK1 = \"CA-DIS\" '----&gt; i have found this name using first 6 letters\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1511938989, "post_id": 47546790, "comment_id": 82050228, "body": "Try to add <code>Application.Calculation = xlCalculationManual</code> at the beginning and <code>Application.Calculation = xlCalculationAutomatic</code> at the end. Additionaly add: <code>Application.screenupdating  = false</code> at the beginning and <code>application.screenupdating = true</code> at the end. What are the results now?"}, {"owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1511939320, "post_id": 47546790, "comment_id": 82050400, "body": "@KazimierzJawor About Calculation Manual, it makes the macro slower, I already tried it. screenupdating  - I have it in my macro, as I said - the part here is in the middle of the code - the code starts in UserForm."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1511939548, "post_id": 47546790, "comment_id": 82050519, "body": "Just in case: Make sure your calculation have the correct direction (from top to bottom and from left to right). E.g If you calculate in A1 <code>=B1+C1</code> (which is from right to left) it is slower than calculating in C1 <code>=A1+B1</code> (which is from left to right). This already slow me off a lot in big and complicated worksheets."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1511940437, "post_id": 47546790, "comment_id": 82050926, "body": "try code like this <code>VacationWS.Range(&quot;G2:G5000&quot;).FormulaR1C1 = &quot;=RC[-3]+RC[-2]-RC[-1]&quot;</code>"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1511941788, "post_id": 47546790, "comment_id": 82051629, "body": "Since your code seems to be working (albeit slowly), you might want to post your question on <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1511944486, "post_id": 47546790, "comment_id": 82052987, "body": "@jsotola I tried it, takes the same time"}, {"owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1511944517, "post_id": 47546790, "comment_id": 82053010, "body": "@VincentG - I posted there too, no answers there too"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1511986402, "post_id": 47546790, "comment_id": 82079757, "body": "i may be wrong on this ..... your formulas refer to whole columns in several places in each formula     ... using FormulaR1C1 hides it at first glance... this is your first formula   <code>=SUMIFS(Visual!C[10],Visual!C[-3],VacationWS!RC[-3],Visual!C&zwnj;&#8203;[5],Lists!R3C3,Visua&zwnj;&#8203;l!C[4],Lists!R2C5)</code>  ............................................................&zwnj;&#8203;....................&zwnj;&#8203;....................&zwnj;&#8203;....................&zwnj;&#8203;....................&zwnj;&#8203;....................&zwnj;&#8203;............. this is the resulting formula in the cell <code>=SUMIFS(Visual!N:N,Visual!A:A,VacationWS!A2,Visual!I:I,Lists&zwnj;&#8203;!$C$3,Visual!H:H,Lis&zwnj;&#8203;ts!$E$2)</code>"}, {"owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1512022781, "post_id": 47546790, "comment_id": 82091675, "body": "@jsotola, yes you are right. what can I do about it? is there a way I could make the calculation and get the answer as value in the worksheet?"}], "answers": [{"comments": [{"owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "edited": false, "score": 0, "creation_date": 1511945633, "post_id": 47548323, "comment_id": 82053688, "body": "Thank you for your answer, I will read now the links you gave me and who knows maybe you will be the one who opened my mind, it is a new model so I am open for changes"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "edited": false, "score": 1, "creation_date": 1511948665, "post_id": 47548323, "comment_id": 82055704, "body": "You should also read up on PowerPivot and PowerQuery. There&#39;s been a quiet revolution going on under Excel&#39;s hood recently. It is now an incredible database/transformation tool. Plenty of great videos on YouTube, and also great content on the web from the likes of Ken Puls, Rob Collie, Jon Acampora, Mike Girvin, and Chandoo. Google them, and prepare to be amazed."}], "tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 2, "last_activity_date": 1511944605, "creation_date": 1511944605, "answer_id": 47548323, "question_id": 47546790, "link": "https://stackoverflow.com/questions/47546790/vba-solution-to-long-time-calculation-of-formulas-when-running-a-macro/47548323#47548323", "title": "VBA Solution To Long Time Calculation of Formulas When Running a Macro", "body": "<p>SUMIFS are computationally expensive, and should be used sparingly. You're putting them into 14 columns and then copying down. If they are all going down 6000 rows then that's a staggering 84,000 SUMIFS. Potentially pointed at pretty sizeable ranges. Train. Wreck.</p>\n\n<p>Get rid of them. Use a PivotTable instead. And you'll see that things will takes mere seconds, not minutes. </p>\n\n<p>I wrote an article on this sometime back at <a href=\"https://chandoo.org/wp/2014/01/17/big-trouble-in-little-spreadsheet/\" rel=\"nofollow noreferrer\">https://chandoo.org/wp/2014/01/17/big-trouble-in-little-spreadsheet/</a> that might be of interest. </p>\n\n<p>And you might also be interested in an answer of mine here at SO some time back, where I compare a whole bunch of different approaches to summing on multiple conditions: <a href=\"https://stackoverflow.com/questions/28745964/optimizing-excel-formulas-sumproduct-vs-sumifs-countifs/32488911#32488911\">Optimizing Excel formulas - SUMPRODUCT vs SUMIFS/COUNTIFS</a></p>\n\n<p>One of those was something called Range Slicing, which will be about the fastest way of doing things if you're determined to use formulas. But while lightning fast, it's tricky to set up and hard for others to get their heads around. Which brings us back to the PivotTable again. PivotTables were designed for just the type of thing you're doing. They are by far a better solution here.</p>\n"}], "owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1511944605, "creation_date": 1511938606, "last_edit_date": 1511941988, "question_id": 47546790, "link": "https://stackoverflow.com/questions/47546790/vba-solution-to-long-time-calculation-of-formulas-when-running-a-macro", "title": "VBA Solution To Long Time Calculation of Formulas When Running a Macro", "body": "<p>I have a file in the size of 13 MB. When I run my macro it calculates the first rows in 3 different worksheets and than I use <code>AutoFill</code> technique to next to 6000 rows and it takes to long time, something between 7-8 minutes. Most of the formulas are simple and should not take to long time, in my opinion. \nSomeone has solution to my problem? Maybe a way that the calculation itself will happen in the module and in the workbook we will see just the result, the values?</p>\n\n<p>My code starts with a <code>userform</code> and then calls to a module, that takes most of the time that the macro runs. as I said each of the 3 sheets includes next to 6000 rows. I want that in the end in the worksheet I I will see just the <code>values</code>.</p>\n\n<pre><code>Sub Formulas()\n\nCall Columns\n\nLR = VacationWS.Cells(Rows.Count, \"A\").End(xlUp).Row\n\nWith VacationWS\n    'Column D\n        MyCol = .Range(\"D2\").Column\n        ColumnSpace = MonthCol - MyCol\n        .Range(\"D2\").FormulaR1C1 = _\n        \"=SUMIFS(Visual!C[\" &amp; ColumnSpace &amp; \"],Visual!C[-3],VacationWS!RC[-3],Visual!C[5],Lists!R3C3,Visual!C[4],Lists!R2C5)\"\n    'Column E\n        MyCol = .Range(\"E2\").Column\n        ColumnSpace = MonthBefore - MyCol\n        .Range(\"E2\").FormulaR1C1 = _\n        \"=SUMIFS(Visual!C[\" &amp; ColumnSpace &amp; \"],Visual!C[-4],VacationWS!RC[-4],Visual!C[4],Lists!R4C3,Visual!C[3],Lists!R5C5)\"\n    'Column F\n        MyCol = .Range(\"F2\").Column\n        ColumnSpace = MonthCol - MyCol\n        .Range(\"F2\").FormulaR1C1 = _\n        \"=SUMIFS(Visual!C[\" &amp; ColumnSpace &amp; \"],Visual!C[-5],VacationWS!RC[-5],Visual!C[3],Lists!R2C3,Visual!C[2],Lists!R2C5)\"\n    'Column G\n        .Range(\"G2\").FormulaR1C1 = \"=RC[-3]+RC[-2]-RC[-1]\"\n    'Column H\n        MyCol = .Range(\"H2\").Column\n        ColumnSpace = MonthCol - MyCol\n        .Range(\"H2\").FormulaR1C1 = _\n        \"=SUMIFS(Visual!C[\" &amp; ColumnSpace &amp; \"],Visual!C[-7],VacationWS!RC[-7],Visual!C[1],Lists!R4C3,Visual!C,Lists!R5C5)\"\n    'Column I\n        .Range(\"I2\").FormulaR1C1 = \"=RC[-1]-RC[-2]\"\n\n    'Delete unnecessary rows\n    .Range(\"D2:I2\").AutoFill Destination:=VacationWS.Range(\"D2:I\" &amp; LR), Type:=xlFillDefault\n    .Range(\"A1:I1\").AutoFilter\n    .Range(\"$A$1:$I$\" &amp; LR).AutoFilter Field:=9, Criteria1:=\"0\"\n     On Error Resume Next\n    .Range(\"A2:I\" &amp; LR).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    .ShowAllData\n\nEnd With\n\n\nWith IllnessWS\n    'Column D\n        MyCol = .Range(\"D2\").Column\n        ColumnSpace = MonthCol - MyCol\n        .Range(\"D2\").FormulaR1C1 = _\n        \"=SUMIFS(Visual!C[\" &amp; ColumnSpace &amp; \"],Visual!C[-3],IllnessWS!RC[-3],Visual!C[5],Lists!R3C3,Visual!C[4],Lists!R3C5)\"\n    'Column E\n        MyCol = .Range(\"E2\").Column\n        ColumnSpace = MonthBefore - MyCol\n        .Range(\"E2\").FormulaR1C1 = _\n        \"=SUMIFS(Visual!C[\" &amp; ColumnSpace &amp; \"],Visual!C[-4],IllnessWS!RC[-4],Visual!C[4],Lists!R4C3,Visual!C[3],Lists!R6C5)\"\n    'Column F\n        MyCol = .Range(\"F2\").Column\n        ColumnSpace = MonthCol - MyCol\n        .Range(\"F2\").FormulaR1C1 = _\n        \"=SUMIFS(Visual!C[\" &amp; ColumnSpace &amp; \"],Visual!C[-5],IllnessWS!RC[-5],Visual!C[3],Lists!R2C3,Visual!C[2],Lists!R3C5)\"\n    'Column G\n        .Range(\"G2\").FormulaR1C1 = \"=RC[-3]+RC[-2]-RC[-1]\"\n    'Column H\n        MyCol = .Range(\"H2\").Column\n        ColumnSpace = MonthCol - MyCol\n        .Range(\"H2\").FormulaR1C1 = _\n        \"=SUMIFS(Visual!C[\" &amp; ColumnSpace &amp; \"],Visual!C[-7],IllnessWS!RC[-7],Visual!C[1],Lists!R4C3,Visual!C,Lists!R6C5)\"\n    'Column I\n        .Range(\"I2\").FormulaR1C1 = \"=RC[-1]-RC[-2]\"\n\n    'Delete unnecessary rows\n    .Range(\"D2:I2\").AutoFill Destination:=IllnessWS.Range(\"D2\", \"I\" &amp; LR), Type:=xlFillDefault\n    .Range(\"A1:I1\").AutoFilter\n    .Range(\"$A$1:$I$\" &amp; LR).AutoFilter Field:=9, Criteria1:=\"0\"\n     On Error Resume Next\n    .Range(\"A2:I\" &amp; LR).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    .ShowAllData\n\n    'Delete what is equal to 90 or more in column H\n    .Range(\"$A$1:$I$\" &amp; LR).AutoFilter Field:=8, Criteria1:=\"&gt;=90\", Operator:=xlAnd\n    .Range(\"A2:I\" &amp; LR).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    .ShowAllData\n\nEnd With\n\n\nWith HealingWS\n    'Column D\n        MyCol = .Range(\"D2\").Column\n        ColumnSpace = MonthCol - MyCol\n        .Range(\"D2\").FormulaR1C1 = _\n        \"=SUMIFS(Visual!C[\" &amp; ColumnSpace &amp; \"],Visual!C[-3],HealingWS!RC[-3],Visual!C[5],Lists!R3C3,Visual!C[4],Lists!R4C5)\"\n    'Column E\n        MyCol = .Range(\"E2\").Column\n        ColumnSpace = MonthBefore - MyCol\n        .Range(\"E2\").FormulaR1C1 = _\n        \"=SUMIFS(Visual!C[\" &amp; ColumnSpace &amp; \"],Visual!C[-4],HealingWS!RC[-4],Visual!C[4],Lists!R4C3,Visual!C[3],Lists!R7C5)\"\n    'Column F\n        .Range(\"F2\").FormulaR1C1 = \"=RC[-1]+RC[-2]\"\n    'Column G\n        MyCol = .Range(\"G2\").Column\n        ColumnSpace = MonthCol - MyCol\n        .Range(\"G2\").FormulaR1C1 = _\n        \"=SUMIFS(Visual!C[\" &amp; ColumnSpace &amp; \"],Visual!C[-6],HealingWS!RC[-6],Visual!C[2],Lists!R4C3,Visual!C[1],Lists!R7C5)\"\n    'Column H\n        .Range(\"H2\").FormulaR1C1 = \"=RC[-1]-RC[-2]\"\n\n    'Delete unnecessary rows\n    .Range(\"D2:H2\").AutoFill Destination:=HealingWS.Range(\"D2:H\" &amp; LR), Type:=xlFillDefault\n    .Range(\"A1:H1\").AutoFilter\n    .Range(\"$A$1:$H$\" &amp; LR).AutoFilter Field:=8, Criteria1:=\"0\"\n     On Error Resume Next\n    .Range(\"A2:H\" &amp; LR).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    .ShowAllData\n\n'Specific for June in HealingWS (Goes to Null)\n    With Lists\n        If MonthName = .Range(\"A7\").Value Then\n            HealingWS.Range(\"E2\").Value = 0\n            HealingWS.Range(\"E2\").AutoFill Destination:=HealingWS.Range(\"E2:E\" &amp; LR), Type:=xlFillDefault\n        End If\n    End With\nEnd With\n\n'January formulas change\nIf MonthName = Lists.Range(\"A2\").Value Then\n    With VacationWS\n        .Range(\"E2\").FormulaR1C1 = _\n        \"=SUMIFS(December!C[7],December!C[-4],VacationWS!RC[-4],December!C[4],Lists!R4C3,December!C[3],Lists!R5C5)\"\n        .Range(\"E2\").AutoFill Destination:=VacationWS.Range(\"E2:E\" &amp; LR), Type:=xlFillDefault\n    End With\n\n    With IllnessWS\n        .Range(\"E2\").FormulaR1C1 = _\n        \"=SUMIFS(December!C[7],December!C[-4],\u00ee\u00e7\u00ec\u00e4!RC[-4],December!C[4],Lists!R4C3,December!C[3],Lists!R6C5)\"\n        .Range(\"E2\").AutoFill Destination:=IllnessWS.Range(\"E2:E\" &amp; LR), Type:=xlFillDefault\n    End With\n\n    With HealingWS\n        .Range(\"E2\").FormulaR1C1 = _\n        \"=SUMIFS(December!C[7],December!C[-4],HealingWS!RC[-4],December!C[4],Lists!R4C3,December!C[3],Lists!R7C5)\"\n        .Range(\"E2\").AutoFill Destination:=HealingWS.Range(\"E2:E\" &amp; LR), Type:=xlFillDefault\n    End With\n\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1511937559, "post_id": 47546194, "comment_id": 82049630, "body": "You formula works for me. Is it anyway possible to solve it without array formula so that I can use it in named range."}, {"owner": {"reputation": 1300, "user_id": 7602468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3XKX5.gif?s=128&g=1", "display_name": "p._phidot_", "link": "https://stackoverflow.com/users/7602468/p-phidot"}, "edited": false, "score": 0, "creation_date": 1532444974, "post_id": 47546194, "comment_id": 89972416, "body": "There is no { } symbol in the formula proposed. Thus, this is NOT an array formula. It is a normal one (individual, cell independent formula). Just change the all reference to J2 (maintaining the $ sign location) will do."}], "tags": [], "owner": {"reputation": 1865, "user_id": 4025652, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/sBr6z.jpg?s=128&g=1", "display_name": "Sixthsense", "link": "https://stackoverflow.com/users/4025652/sixthsense"}, "is_accepted": true, "score": 2, "last_activity_date": 1511935967, "creation_date": 1511935967, "answer_id": 47546194, "question_id": 47545844, "link": "https://stackoverflow.com/questions/47545844/how-to-get-header-row-data-related-to-left-column-name-whose-data-are-not-empty/47546194#47546194", "title": "How to get header row data related to left column name (whose data are not empty)", "body": "<p><strong>In J3 Cell</strong></p>\n\n<pre><code>=IFERROR(INDEX($C$2:$G$2,,SMALL(IF(OFFSET($B$2,MATCH(J$2,$B$3:$B$8,0),1,,5)&lt;&gt;\"\",COLUMN(OFFSET($B$2,MATCH(J$2,$B$3:$B$8,0),1,,5))-2,\"\"),ROWS($1:1))),\"\")\n</code></pre>\n\n<p>Drag the formula down and right</p>\n"}], "owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 47546194, "answer_count": 1, "score": 0, "last_activity_date": 1511935967, "creation_date": 1511934145, "last_edit_date": 1531161705, "question_id": 47545844, "link": "https://stackoverflow.com/questions/47545844/how-to-get-header-row-data-related-to-left-column-name-whose-data-are-not-empty", "title": "How to get header row data related to left column name (whose data are not empty)", "body": "<p>Good day to all! My sample data looks like below screenshot. So, when I will select <code>Harun</code> in <code>J2</code> cell then my expected result is <code>xxx, zzz, ppp</code>. My logic to get result as Harun has value in <code>xxx</code> and <code>zzz</code> and <code>ppp</code> column. With the following array formula I can do that but it is not dynamic. Row (array for index function) is hard-coded here. So, can we make it dynamic so that I can get the all header item when I select any name in <code>J2</code> cell? Appreciate your help.</p>\n\n<pre><code>=INDEX($C$2:$G$2,,SMALL(IF($C$3:$G$3&lt;&gt;\"\",COLUMN($C$3:$G$3),\"\"),ROWS($B$3:$B3))-2)\n</code></pre>\n\n<p><strong><em>Sample Data Screenshot</em></strong><br>\n<a href=\"https://i.stack.imgur.com/HzXCm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HzXCm.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Only excel formula is preferable. If not possible then we can go with VBA.</strong></p>\n"}, {"tags": ["arrays", "excel", "recordset", "vba"], "answers": [{"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 1, "last_activity_date": 1511934812, "creation_date": 1511934812, "answer_id": 47545965, "question_id": 47545667, "link": "https://stackoverflow.com/questions/47545667/convert-recordset-into-an-array/47545965#47545965", "title": "Convert recordset into an array", "body": "<p>If you are using <code>ADODB</code> it is as simple as:</p>\n\n<pre><code>Dim ret As Variant\n\nret = rs.GetRows '~~&gt; assuming rs object is populated and set\n\nDebug.Print Lbound(ret, 1), Ubound(ret, 1) '~~&gt; bounds of 1st dimension\nDebug.Print Lbound(ret, 2), Ubound(ret, 2) '~~&gt; bounds of 2nd dimension\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 8530965, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/04eb060290a063f46fa5ceebe23a67a0?s=128&d=identicon&r=PG&f=1", "display_name": "Surbhi Manocha", "link": "https://stackoverflow.com/users/8530965/surbhi-manocha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2246, "favorite_count": 0, "accepted_answer_id": 47545965, "answer_count": 1, "score": 0, "last_activity_date": 1511935057, "creation_date": 1511933258, "last_edit_date": 1531164843, "question_id": 47545667, "link": "https://stackoverflow.com/questions/47545667/convert-recordset-into-an-array", "title": "Convert recordset into an array", "body": "<p>I would like to convert a recordset <code>rs</code> into an array so that I can use it in further  code. <br> <code>rs</code> can have variable rows and variable columns.</p>\n"}, {"tags": ["vba", "excel", "calculation"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1511929879, "post_id": 47545061, "comment_id": 82047051, "body": "Store the current setting in a global variable and restore the setting when you&#39;re done."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 5341071, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AkBzh.png?s=128&g=1", "display_name": "johs32", "link": "https://stackoverflow.com/users/5341071/johs32"}, "edited": false, "score": 0, "creation_date": 1511937645, "post_id": 47545209, "comment_id": 82049661, "body": "Great, can&#39;t believe I couldn&#39;t find that anywhere. Thank you!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 63, "user_id": 5341071, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AkBzh.png?s=128&g=1", "display_name": "johs32", "link": "https://stackoverflow.com/users/5341071/johs32"}, "edited": false, "score": 2, "creation_date": 1511939068, "post_id": 47545209, "comment_id": 82050265, "body": "@carol @johs32 <code>calcsetting</code> should be at least of type <code>Long</code> or better of type <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/xlcalculation-enumeration-excel?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\"><code>XlCalculation</code></a> (which also enables IntelliSense for this variable). You can see this if you do a <code>Debug.Print VarType(Application.Calculation)</code> it will be <code>3</code> which means <code>Long</code> (according to <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/vartype-function\" rel=\"nofollow noreferrer\">VarType Function</a>). Best Practice: <a href=\"https://stackoverflow.com/a/26409520/3219613\">Avoid Integer and always use Long</a>."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 4, "creation_date": 1511942093, "post_id": 47545209, "comment_id": 82051775, "body": "You may also want to use error handling so that the calculation is restored, even if your other code fails"}], "tags": [], "owner": {"reputation": 441, "user_id": 8492815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f3471534d4aba8f3c18c2ee90416efe?s=128&d=identicon&r=PG&f=1", "display_name": "Carol", "link": "https://stackoverflow.com/users/8492815/carol"}, "is_accepted": true, "score": 5, "last_activity_date": 1511930722, "creation_date": 1511930722, "answer_id": 47545209, "question_id": 47545061, "link": "https://stackoverflow.com/questions/47545061/how-do-i-set-application-calculation-back-as-to-defined-by-user-in-excel-vba/47545209#47545209", "title": "How do I set application calculation back as to defined by user in Excel VBA?", "body": "<p>Store the setting before starting, then restore when finished:</p>\n\n<pre><code>Sub calctest()\nDim calcsetting As Integer\n\n    calcsetting = Application.Calculation\n    ' Put code here\n    Application.Calculation = calcsetting\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 5341071, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AkBzh.png?s=128&g=1", "display_name": "johs32", "link": "https://stackoverflow.com/users/5341071/johs32"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2402, "favorite_count": 0, "accepted_answer_id": 47545209, "answer_count": 1, "score": 6, "last_activity_date": 1511938585, "creation_date": 1511929784, "last_edit_date": 1511938585, "question_id": 47545061, "link": "https://stackoverflow.com/questions/47545061/how-do-i-set-application-calculation-back-as-to-defined-by-user-in-excel-vba", "title": "How do I set application calculation back as to defined by user in Excel VBA?", "body": "<p>I have a rather large workbook, and some users prefer to have automatic calculation on, while others prefer having it off.</p>\n\n<p>Some macros that interact with the sheets are attatched to the workbook. To speed up my VBA code, I set</p>\n\n<pre><code>Application.Calculation = xlManual\n</code></pre>\n\n<p>In the beginning of each workbook.</p>\n\n<p>My question is, how do I revert it back to the way it was in the end of macro?</p>\n\n<p>Right now i'm using</p>\n\n<pre><code>Application.Calculation = xlAutomatic\n</code></pre>\n\n<p>but that overrides the users choice. It's pretty annoying having to change it back to manual every time the macro has run. (Or the other way around, if leaving it at manual.)</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1511950318, "post_id": 47544094, "comment_id": 82056842, "body": "You shouldn&#39;t use <code>Error</code> as variable name - it is part of the VBA language."}], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1511941735, "creation_date": 1511941735, "answer_id": 47547556, "question_id": 47544094, "link": "https://stackoverflow.com/questions/47544094/issue-with-dlookup-when-comparing-strings-in-query/47547556#47547556", "title": "Issue with DLookup when comparing strings in Query", "body": "<p>If the fields are strings in the query, they should be so as well in the <code>DLookUp</code>.</p>\n\n<p>Add parentheses to your <code>DLookUp</code> to avoid the error:</p>\n\n<pre><code>SCount = DLookup(\"[SumOfNumber of Errors]\", \"ErrorsByShift\", \"[Shift] = '\" &amp; s &amp; \"' AND [Type of Error] = '\" &amp; Error &amp; \"'\")\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 5968913, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f6b8b23a767df0afd11546350f21486f?s=128&d=identicon&r=PG&f=1", "display_name": "holi4683", "link": "https://stackoverflow.com/users/5968913/holi4683"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 307, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594638748, "creation_date": 1511922559, "last_edit_date": 1594638748, "question_id": 47544094, "link": "https://stackoverflow.com/questions/47544094/issue-with-dlookup-when-comparing-strings-in-query", "title": "Issue with DLookup when comparing strings in Query", "body": "<p>I am trying to use Dlookup to look up a value in a query using two criteria (\"s\" and \"Error\") to populate variable \"SCount\". s is an integer for shift number, and Error is a string. Both are fields in the query. The Dlookup is pulling from a query which should be strings for the data type, the query is pulling from a table where the fields are strings. So I am not sure why I am getting a mismatch error.</p>\n\n<p>When I run the code I get the error \"Run-time error '3464' Data type mismatch in criteria or expression\". For the the <code>Error</code> in the SCount Dlookup.</p>\n\n<p>Code</p>\n\n<pre><code>Dim Error As String\nDim i As Integer\nDim s As Integer\nDim n As Integer\nDim SCount As Variant\nDim sum As Double\nsum = 0\ni = 1\ns = 1\nn = 1\nDo Until i &gt; 5\nIf Not IsNull(DLookup(\"[Type of Error]\", \"RankedSumOfErrors\", \"[Ranking] = \" &amp; i)) Then\n    Error = DLookup(\"[Type of Error]\", \"RankedSumOfErrors\", \"[Ranking] = \" &amp; i)\n    Me.Controls(\"lbl\" &amp; i &amp; \"\").Caption = Error\n        Do Until s &gt; 3\n            SCount = DLookup(\"[SumOfNumber of Errors]\", \"ErrorsByShift\", \"[Shift] = \" &amp; s &amp; \" AND [Type of Error] = '\" &amp; Error &amp; \"'\")\n            Me.Controls(\"lbls\" &amp; s &amp; \"\").Caption = SCount\n            i = i + 1\n            sum = sum + SCount\n        Loop\n            Me.Controls(\"Total\" &amp; i &amp; \"\").Caption = sum\n            sum = 0\nElse\n    Me.Controls(\"lbl\" &amp; i &amp; \"\").Caption = \"N/A\"\n    i = i + 1\nEnd If\n\nLoop\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1511927520, "post_id": 47544023, "comment_id": 82046396, "body": "If you can add the dll/object into VBE References, you can browse what is available."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1511930448, "post_id": 47544023, "comment_id": 82047196, "body": "Maybe something like this would be useful (assuming you can modify it to work with your specific application)  <a href=\"http://www.northatlantawebdesign.com/index.php/2009/07/14/getting-the-com-object-from-hwnd-using-accessibleobjectfromwindow-in-microsoft-word-2007/\" rel=\"nofollow noreferrer\">northatlantawebdesign.com/index.php/2009/07/14/&hellip;</a>"}], "owner": {"reputation": 189, "user_id": 3597782, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/95331b2d06f87770ae74dec2a74d588a?s=128&d=identicon&r=PG&f=1", "display_name": "razr32", "link": "https://stackoverflow.com/users/3597782/razr32"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 233, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511922093, "creation_date": 1511922093, "last_edit_date": 1531164843, "question_id": 47544023, "link": "https://stackoverflow.com/questions/47544023/vba-getting-object-from-multiple-open-instances-of-attachmate", "title": "VBA Getting Object from Multiple Open Instances of Attachmate?", "body": "<p>Is there any way how to see how many windows are open when selecting from an existing window? I have the following code but it will pretty much only select the last window that was opened.</p>\n\n<pre><code>Dim App As Attachmate_Reflection_Objects_Framework.ApplicationObject\nDim screen As Attachmate_Reflection_Objects_Emulation_IbmHosts.IbmScreen\nDim Terminal As Attachmate_Reflection_Objects_Emulation_IbmHosts.IbmTerminal\nDim Frame As Attachmate_Reflection_Objects.Frame\nDim View As Attachmate_Reflection_Objects.View\n\n\nSet App = GetObject(, \"Attachmate_Reflection_Objects_Framework.ApplicationObject\"\n</code></pre>\n"}, {"tags": ["excel", "immediate-window", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1511919662, "post_id": 47543661, "comment_id": 82044523, "body": "Is it the <i>values</i> in the range that you are trying to print?"}, {"owner": {"reputation": 127, "user_id": 5977580, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10100625512036166/picture?type=large", "display_name": "AP1", "link": "https://stackoverflow.com/users/5977580/ap1"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1511919901, "post_id": 47543661, "comment_id": 82044569, "body": "@JohnColeman Yes, the values in the range."}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 5977580, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10100625512036166/picture?type=large", "display_name": "AP1", "link": "https://stackoverflow.com/users/5977580/ap1"}, "edited": false, "score": 0, "creation_date": 1511920704, "post_id": 47543725, "comment_id": 82044716, "body": "Thank you. That worked for me. I appreciate your help :)"}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 3, "last_activity_date": 1511919828, "creation_date": 1511919828, "answer_id": 47543725, "question_id": 47543661, "link": "https://stackoverflow.com/questions/47543661/how-can-i-print-a-range-variable-in-the-immediate-window-excel-vba/47543725#47543725", "title": "How can I print a range variable in the immediate window? Excel VBA", "body": "<p><code>Range</code> is an object, not a value. To output the values, you can iterate the <code>Range</code>. Another way is to use the <code>Transpose</code> function on a single row or column and then <code>Join</code> to get a <code>String</code> value of the array of values within the <code>Range</code>.</p>\n\n<p>Sample code:</p>\n\n<pre><code>Public Sub getCellData()\n    Dim wb As Workbook: Set wb = ThisWorkbook\n    Dim ws As Worksheet: Set ws = wb.Sheets(1)\n\n    ' you need to prefix Cells with ws. to clarify the reference\n    Dim rng As Range: Set rng = ws.Range(ws.Cells(1, 2), ws.Cells(4, 2))\n\n    ' you cannot debug print the object itself\n    'Debug.Print rng\n\n    ' iterate the range\n    Dim rngCell As Range\n    For Each rngCell In rng\n        Debug.Print rngCell.Value\n    Next rngCell\n\n    ' use the Transpose function for a single row or column\n    Dim strData As String\n    Dim wsf As WorksheetFunction: Set wsf = Application.WorksheetFunction\n    strData = Join(wsf.Transpose(rng.Value), \",\")\n    Debug.Print strData\n\n\nEnd Sub\n</code></pre>\n\n<p>Note I updated your <code>Set rng = ...</code> to:</p>\n\n<pre><code>Set rng = ws.Range(ws.Cells(1, 2), ws.Cells(4, 2))\n</code></pre>\n\n<p>And added <code>ws.</code> as a prefix to <code>Cells</code> in order that the references were explicitly defined.</p>\n"}, {"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 4, "last_activity_date": 1511920270, "creation_date": 1511920270, "answer_id": 47543778, "question_id": 47543661, "link": "https://stackoverflow.com/questions/47543661/how-can-i-print-a-range-variable-in-the-immediate-window-excel-vba/47543778#47543778", "title": "How can I print a range variable in the immediate window? Excel VBA", "body": "<p>You could write a simple sub for something like this:</p>\n\n<pre><code>Sub PrintRange(R As Range, Optional delim As String = \", \")\n    Dim myRow As Range, V As Variant, i As Long\n    For Each myRow In R.Rows\n        ReDim V(1 To myRow.Cells.Count)\n        For i = 1 To myRow.Cells.Count\n            V(i) = myRow.Cells(1, i).Value\n        Next i\n        Debug.Print Join(V, delim)\n    Next myRow\nEnd Sub\n</code></pre>\n\n<p>Then <code>PrintRange rng</code> would work as expected.</p>\n"}], "owner": {"reputation": 127, "user_id": 5977580, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10100625512036166/picture?type=large", "display_name": "AP1", "link": "https://stackoverflow.com/users/5977580/ap1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23497, "favorite_count": 0, "accepted_answer_id": 47543725, "answer_count": 2, "score": 3, "last_activity_date": 1511920270, "creation_date": 1511919204, "last_edit_date": 1531164843, "question_id": 47543661, "link": "https://stackoverflow.com/questions/47543661/how-can-i-print-a-range-variable-in-the-immediate-window-excel-vba", "title": "How can I print a range variable in the immediate window? Excel VBA", "body": "<p>I'm attempting something that should be very simple. However I've just started learning today and and can't quite understand.</p>\n\n<p>This is my code so far:</p>\n\n<pre><code>Public Sub getCellData()\n   Dim wb As Workbook: Set wb = ThisWorkbook\n   Dim ws As Worksheet: Set ws = wb.Sheets(1)\n   Dim rng As Range: Set rng = ws.Range(Cells(1, 2), Cells(4, 2))\n\n   Debug.Print rng\nEnd Sub\n</code></pre>\n\n<p>The data that I'm working with is this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/tTV6y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tTV6y.png\" alt=\"enter image description here\"></a></p>\n\n<p>I keep getting the \"Run-time error '13': Type mismatch\"\nI googled the error and I'm still unsure of how to fix this. I want to print the variable rng in the immediate window.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 212, "user_id": 5849539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pMvPm.png?s=128&g=1", "display_name": "Unencoded", "link": "https://stackoverflow.com/users/5849539/unencoded"}, "edited": false, "score": 0, "creation_date": 1511921590, "post_id": 47543853, "comment_id": 82044913, "body": "Damn I was so close... Thank you very much."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 212, "user_id": 5849539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pMvPm.png?s=128&g=1", "display_name": "Unencoded", "link": "https://stackoverflow.com/users/5849539/unencoded"}, "edited": false, "score": 1, "creation_date": 1511922012, "post_id": 47543853, "comment_id": 82045004, "body": "@Sam3000 And, when you decide that you don&#39;t like having a million cells containing <code>&quot;#N&#47;A&quot;</code>, you might consider changing <code>For Each cell In Range(&quot;C:C&quot;)</code> to <code>For Each cell In .Range(&quot;C1:C&quot; &amp; .Cells(.Rows.Count, &quot;D&quot;).End(xlUp).Row)</code> ;-)"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1511920733, "creation_date": 1511920733, "answer_id": 47543853, "question_id": 47543489, "link": "https://stackoverflow.com/questions/47543489/excel-vba-find-function-not-finding-a-date/47543853#47543853", "title": "Excel VBA .Find Function not finding a date", "body": "<p>Your spreadsheet probably contains actual dates, rather than just text that looks like a date, so convert your string to a date:</p>\n\n<pre><code>Set c = .Range(\"D:D\").Find(CDate(s), LookIn:=xlValues, LookAt:=xlPart)\n</code></pre>\n"}], "owner": {"reputation": 212, "user_id": 5849539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pMvPm.png?s=128&g=1", "display_name": "Unencoded", "link": "https://stackoverflow.com/users/5849539/unencoded"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1339, "favorite_count": 0, "accepted_answer_id": 47543853, "answer_count": 1, "score": 0, "last_activity_date": 1511920733, "creation_date": 1511917793, "last_edit_date": 1511920459, "question_id": 47543489, "link": "https://stackoverflow.com/questions/47543489/excel-vba-find-function-not-finding-a-date", "title": "Excel VBA .Find Function not finding a date", "body": "<p>I am using the following VBA code to select the first instance of each data in a column and copy it to a new column to the left.</p>\n\n<p>For a reason I do not understand, the .Find method does not find any of the dates in my worksheet. </p>\n\n<p>Dates are in the format 03/10/2017  17:05:00</p>\n\n<p>However after closing the macro editor (having used step-into to debug) I can press Ctrl + F and Return to cycle through the dates as expected, the macro even fills the window in!</p>\n\n<p>So I must be missing something, but no errors are being thrown. </p>\n\n<p>c remains undefined.</p>\n\n<p>count = An integer representing the day of the month to cycle through the dates</p>\n\n<p>c = The range where the search string is found (or should be in this case)</p>\n\n<p>d = The kill switch, when the loop eventually causes the script to find the first date that has already been copied to the left d should become 1 and end the loop. Untested due to this error.</p>\n\n<p>cell = used purely to fill remaining cells in the new column with #N/A</p>\n\n<p>As you can probably tell I am very much an amateur here, I welcome and appreciate any assistance or feedback. </p>\n\n<pre><code>Sub LabelMaker()\n'\n' LabelMaker Macro\n'\nDim count As Integer\ncount = 2\nDim c As Range\nDim s As String\nDim d As Integer\nd = 0\nDim cell As Range\nDim ws As Worksheet\nSet ws = ActiveSheet\nWith ws\n    Columns(\"C:C\").Insert Shift:=xlToRight\n    Range(\"C1\") = \"Labels\"\n    Do\n        s = CStr(count) &amp; \"/10/2017\"\n        Set c = .Range(\"D:D\").Find(s, LookIn:=xlValues, LookAt:=xlPart)\n            If Not c Is Nothing Then\n                If IsEmpty((c.Offset(rowOffset:=0, columnOffset:=-1))) Then\n                    c.Copy _\n                        Destination:=c.Offset(rowOffset:=0, columnOffset:=-1)\n                Else\n                    d = 1\n                End If\n            End If\n            count = count + 1\n            If count = 32 Then\n                count = 1\n            End If\n    Loop While d = 0\n    For Each cell In Range(\"C:C\")\n        If IsEmpty(cell) Then\n            cell = \"#N/A\"\n        End If\n    Next\nEnd With\n'\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "email", "screenshot"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1511918567, "post_id": 47543437, "comment_id": 82044221, "body": "Can you share an example of your data/spreadsheet?"}, {"owner": {"reputation": 301, "user_id": 477881, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f863edb8888599ba2bbd671ae4957005?s=128&d=identicon&r=PG", "display_name": "Rya", "link": "https://stackoverflow.com/users/477881/rya"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1511920168, "post_id": 47543437, "comment_id": 82044627, "body": "<a href=\"https://drive.google.com/file/d/1yAJl9PYj4M-RZhdgq4mJo2UgBzG6FD-G/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/1yAJl9PYj4M-RZhdgq4mJo2UgBzG6FD-G/&hellip;</a>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1511924474, "post_id": 47543437, "comment_id": 82045630, "body": "Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. Providing a code dump and telling us what it doesn&#39;t do <i>without actually showing efforts you made to do it</i> is out of scope for SO, especially at the level of complexity you require. You also ask essentially 3 questions in one. I suggest you take it step-by-step and try to code each step. If you got stuck on a specific issue, post a question about that specific problem."}, {"owner": {"reputation": 301, "user_id": 477881, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f863edb8888599ba2bbd671ae4957005?s=128&d=identicon&r=PG", "display_name": "Rya", "link": "https://stackoverflow.com/users/477881/rya"}, "edited": false, "score": 0, "creation_date": 1511934619, "post_id": 47543437, "comment_id": 82048592, "body": "Apologies, and noted Scott"}], "answers": [{"comments": [{"owner": {"reputation": 301, "user_id": 477881, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f863edb8888599ba2bbd671ae4957005?s=128&d=identicon&r=PG", "display_name": "Rya", "link": "https://stackoverflow.com/users/477881/rya"}, "edited": false, "score": 0, "creation_date": 1511938674, "post_id": 47544406, "comment_id": 82050078, "body": "Hi Raquel. Perfect. I used C) and it is working perfectly.  I am just unsure how to get the screenshot piece working"}, {"owner": {"reputation": 250, "user_id": 5281231, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204521605632621/picture?type=large", "display_name": "Raquel Peres da Silva", "link": "https://stackoverflow.com/users/5281231/raquel-peres-da-silva"}, "reply_to_user": {"reputation": 301, "user_id": 477881, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f863edb8888599ba2bbd671ae4957005?s=128&d=identicon&r=PG", "display_name": "Rya", "link": "https://stackoverflow.com/users/477881/rya"}, "edited": false, "score": 0, "creation_date": 1512005971, "post_id": 47544406, "comment_id": 82087211, "body": "Glad to have helped. As for the screenshot issue, I&#39;ve never tried anything like that, but, since you can use the PrtScr key to take a screenshot, I believe Application.SendKeys &lt;whatever the code for PrtScr is&gt; should do the trick. My advice is that you give it a try first and then, if you&#39;re still stuck, post a separate question presenting your code, even if it doesn&#39;t work at all. You&#39;ll probably get more answers this way."}], "tags": [], "owner": {"reputation": 250, "user_id": 5281231, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204521605632621/picture?type=large", "display_name": "Raquel Peres da Silva", "link": "https://stackoverflow.com/users/5281231/raquel-peres-da-silva"}, "is_accepted": false, "score": 0, "last_activity_date": 1511924998, "creation_date": 1511924998, "answer_id": 47544406, "question_id": 47543437, "link": "https://stackoverflow.com/questions/47543437/vba-take-screenshot-of-filtered-excel-and-send-to-each-row-in-iteration/47544406#47544406", "title": "VBA take screenshot of filtered Excel and send to each row in iteration", "body": "<p>It seems to me that you have two questions rolled up in one here: (1) how to loop through the rows of your spreadsheet and (2) how to take a screenshot and insert it into the e-mail. Maybe you should consider posting two separate questions.</p>\n\n<p>With that in mind, I'll address the loop issue. There are many ways to achieve what you want.</p>\n\n<p>A) You could use the row numbers</p>\n\n<pre><code>For i = 7 To 9\n    ResourceName = Cells(i, 4)\n    ResourceEmail = Cells(i, 5)\n    ' The rest of your code here\nNext i\n</code></pre>\n\n<p>B) You could start at the first row and keep moving down until you find an empty cell.</p>\n\n<pre><code>i = 7\nDo Until Cells(i, 4) = \"\"\n    ResourceName = Cells(i, 4)\n    ResourceEmail = Cells(i, 5)\n    ' The rest of your code here\n    i = i + 1\nLoop\n</code></pre>\n\n<p>C) You could give the cells containing the list of resources a name (say, \"resources\") and loop through its rows.</p>\n\n<pre><code>Set MyList = ActiveWorkbook.Names(\"resources\").RefersToRange\nFor Each person In MyList.Rows\n    ResourceName = person.Cells(1, 4)\n    ResourceEmail = person.Cells(1, 5)\n    ' The rest of your code here\nNext person\n</code></pre>\n\n<p>Why don't you choose one method and then we see where we go from there?</p>\n"}], "owner": {"reputation": 301, "user_id": 477881, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f863edb8888599ba2bbd671ae4957005?s=128&d=identicon&r=PG", "display_name": "Rya", "link": "https://stackoverflow.com/users/477881/rya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 552, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1512060012, "creation_date": 1511917424, "last_edit_date": 1512060012, "question_id": 47543437, "link": "https://stackoverflow.com/questions/47543437/vba-take-screenshot-of-filtered-excel-and-send-to-each-row-in-iteration", "title": "VBA take screenshot of filtered Excel and send to each row in iteration", "body": "<p>I want to run a Macro in Excel to loop through a number of rows, apply a filter to a spreadsheet with the name of the person, take a screenshot, and send an Email to that person with the screenshot. </p>\n\n<p>My current code does not iterate through a range (only 1 record), and does not take a screenshot and insert into email.</p>\n\n<p>Would greatly appreciate assistance with this.</p>\n\n<p>My current code:</p>\n\n<pre><code>Sub SendEmailtoEachResource_Click()\n' Macro  - Intended functionality\n' For each person (resource) apply a filter to the 'Allocation'\n' tab, and take a screenshot.  Send an email with the screenshot\n' to each person.\n\n\n\n\n   Dim Resoucename As String\n   Dim ResouceEmail As String\n\n\n   'Current State: Apply filter, and send 1 email to the below details\n   ResourceName = Range(\"D4\")\n   resourceEmail = Range(\"E4\")\n\n\n\n\n   'ACTION - Future State:\n                'For each person in column D\n                'Send email to email address on same row in Coumn E\n   '             ##Start Loop\n\n\n    'Go to Allocation Tab, Apply Filter of resouce name\n    Sheets(\"Allocation\").Select\n    Range(\"A1:BH28\").Select\n    ActiveSheet.Range(\"$A$8:$BI$826\").AutoFilter Field:=5, Criteria1:= _\n        ResourceName\n    ActiveWindow.SmallScroll Down:=-21\n    ActiveWindow.ScrollRow = 9\n    Range(\"A1:BV836\").Select\n\n    '  ACTION: Take Screenshot of filtered results\n\n\n\n'setup email\n Dim aOutlook As Object\n    Dim aEmail As Object\n    Dim outlookResName As String\n    Dim SendAddress As String\n\n\n    Set aOutlook = CreateObject(\"Outlook.Application\")\n    Set aEmail = aOutlook.CreateItem(0)\n    outlookResName = ActiveCell.Value\n    SendAddress = \"me@email.com\"\n    aEmail.To = resourceEmail\n    aEmail.Subject = \"Resource assignment Report for \" &amp; ResourceName\n\n\n\n    aEmail.HTMLBody = \"Your report is below {Insert Screenshot}\"\n    'ACTION: Paste screenshot HERE\n\naEmail.display\n ' Will change to .send when VBA is working fully. This could send ~100 emails\n\n\n\n   '  ## End LOOP\n\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511915594, "post_id": 47543095, "comment_id": 82043446, "body": "@Adeel - And consider <code>ActiveCell.Resize(10, 1).Formula</code> rather than just <code>ActiveCell.Formula</code>"}, {"owner": {"reputation": 41, "user_id": 8529303, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZZeQk.jpg?s=128&g=1", "display_name": "Adeel", "link": "https://stackoverflow.com/users/8529303/adeel"}, "edited": false, "score": 0, "creation_date": 1512070766, "post_id": 47543095, "comment_id": 82120079, "body": "awesome this helped. one line of code to tackle it all, lol. exactly what I was looking to do."}, {"owner": {"reputation": 41, "user_id": 8529303, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZZeQk.jpg?s=128&g=1", "display_name": "Adeel", "link": "https://stackoverflow.com/users/8529303/adeel"}, "edited": false, "score": 0, "creation_date": 1512071301, "post_id": 47543095, "comment_id": 82120353, "body": "@Tim: Thank you. Your keen eye on the missing quotes helped immensely too."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1511914854, "creation_date": 1511914854, "answer_id": 47543095, "question_id": 47543075, "link": "https://stackoverflow.com/questions/47543075/excel-vba-copying-formula-to-any-active-cell/47543095#47543095", "title": "Excel VBA: Copying Formula to any active cell", "body": "<pre><code>ActiveCell.formula = \"=IF(ISBLANK(C5)*ISBLANK(D5),\"\"\"\",IF(ISBLANK(D5),(C5),CONCATENATE(C5,\"\" [\"\", D5, \"\"]\"\")))\" \n</code></pre>\n\n<p>you missed doubling up the first set of embedded quotes.</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 8529303, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZZeQk.jpg?s=128&g=1", "display_name": "Adeel", "link": "https://stackoverflow.com/users/8529303/adeel"}, "edited": false, "score": 0, "creation_date": 1512070458, "post_id": 47548074, "comment_id": 82119917, "body": "Hi,   Thanks for your input but this is sort of reverse of what I am looking to do. Perhaps I should expand on my original request: I am trying to keep it simple to a shortcut key. Let&#39;s says Ctrl+Shift+R would automatically copy the formula (provided in original question) to <b>ANY</b> active cell and then fill it 10 rows below.   Any ideas on that?"}], "tags": [], "owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "is_accepted": false, "score": 0, "last_activity_date": 1511943767, "creation_date": 1511943767, "answer_id": 47548074, "question_id": 47543075, "link": "https://stackoverflow.com/questions/47543075/excel-vba-copying-formula-to-any-active-cell/47548074#47548074", "title": "Excel VBA: Copying Formula to any active cell", "body": "<p>You can use following routine to copy formula from cell to VBE compatible format. See if it helps you:</p>\n\n<pre><code> Public Sub CopyExcelFormulaInVBAFormat()\n Dim strFormula As String\n Dim objDataObj As Object\n\n '\\Check that single cell is selected!\n If Selection.Cells.Count &gt; 1 Then\n     MsgBox \"Select single cell only!\", vbCritical\n     Exit Sub\n End If\n\n 'Check if we are not on a blank cell!\n If Len(ActiveCell.Formula) = 0 Then\n     MsgBox \"No Formula To Copy!\", vbCritical\n     Exit Sub\n End If\n\n 'Add quotes as required in VBE\n strFormula = Chr(34) &amp; Replace(ActiveCell.Formula, Chr(34), Chr(34) &amp; Chr(34)) &amp; Chr(34)\n\n 'This is ClsID of MSFORMS Data Object\n Set objDataObj = CreateObject(\"New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n objDataObj.SetText strFormula, 1\n objDataObj.PutInClipboard\n MsgBox \"VBA Format formula copied to Clipboard!\", vbInformation\n\n Set objDataObj = Nothing\n\n End Sub\n</code></pre>\n\n<p>After inserting this routine. You just need to enter the formula normally in the cell. Then stay on the cell and run this code and it will copy to clipboard. Go to VBE and do CTRL+V to paste the code where required.</p>\n\n<p>Originally posted on:</p>\n\n<p><a href=\"https://chandoo.org/forum/threads/copy-formula-from-excel-to-clipboard-in-vba-compatible-format.35997/\" rel=\"nofollow noreferrer\">https://chandoo.org/forum/threads/copy-formula-from-excel-to-clipboard-in-vba-compatible-format.35997/</a></p>\n"}], "owner": {"reputation": 41, "user_id": 8529303, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZZeQk.jpg?s=128&g=1", "display_name": "Adeel", "link": "https://stackoverflow.com/users/8529303/adeel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 896, "favorite_count": 0, "accepted_answer_id": 47543095, "answer_count": 2, "score": 0, "last_activity_date": 1511943767, "creation_date": 1511914713, "question_id": 47543075, "link": "https://stackoverflow.com/questions/47543075/excel-vba-copying-formula-to-any-active-cell", "title": "Excel VBA: Copying Formula to any active cell", "body": "<p>I am new to VBA coding and hope I can get some assistance here. I am trying to create code that would do the following for ANY cell (without specifying hard coded cell ranges or references):</p>\n\n<ul>\n<li>input a formula in the active cell</li>\n<li>copy it (fill) down 10 rows</li>\n</ul>\n\n<p>In an attempt to insert the formula into the <strong>ActiveCell</strong> I tried:</p>\n\n<pre><code>Sub Test()\nActiveCell.formula = \"=IF(ISBLANK(C5)*ISBLANK(D5),\"\",IF(ISBLANK(D5),(C5),CONCATENATE(C5,\"\" [\"\", D5, \"\"]\"\")))\"\nEnd Sub\n</code></pre>\n\n<p>However, this produces the \n<strong>1004: Application-define or object-defined error</strong></p>\n\n<p>I've tried declaring <strong>Range</strong> objects for <strong>ActiveCell</strong> but still run into errors. </p>\n\n<p>Any help on this would be highly appreciated. </p>\n"}, {"tags": ["vba", "date", "time"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1511914901, "post_id": 47543037, "comment_id": 82043280, "body": "There is no question here"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511915686, "post_id": 47543037, "comment_id": 82043475, "body": "The easy (or silly?) answer is obviously &quot;sometimes&quot; (or is that &quot;some times&quot;?)"}, {"owner": {"reputation": 31, "user_id": 4744044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c2ba50138c16fcd51fbd74f3ab9954eb?s=128&d=identicon&r=PG&f=1", "display_name": "averagescripter", "link": "https://stackoverflow.com/users/4744044/averagescripter"}, "edited": false, "score": 0, "creation_date": 1511915885, "post_id": 47543037, "comment_id": 82043528, "body": "I hit enter when adding tags and accidentally submitted the question before I&#39;d written it"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1511916759, "post_id": 47543037, "comment_id": 82043785, "body": "Change <b>NumberFormat</b> to something like <code>[hh]:mm</code>, this forces the Sum to be in hours as max unit."}, {"owner": {"reputation": 31, "user_id": 4744044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c2ba50138c16fcd51fbd74f3ab9954eb?s=128&d=identicon&r=PG&f=1", "display_name": "averagescripter", "link": "https://stackoverflow.com/users/4744044/averagescripter"}, "edited": false, "score": 0, "creation_date": 1511918183, "post_id": 47543037, "comment_id": 82044139, "body": "Patrick that sounds great, but I can&#39;t see how to do this in VBA, like I can with the cell properties"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511919954, "post_id": 47543037, "comment_id": 82044583, "body": "@averagescripter In VBA you would use <code>someRangeReference.NumberFormat = &quot;[hh]:mm&quot;</code>.  So calculate your total number of days (e.g. <code>1.26</code>, stick that in your output cell, and format that cell - it will then display as <code>30:14</code>.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511920297, "post_id": 47543037, "comment_id": 82044660, "body": "So, in your example, if you calculated 3hrs 52mins (which Excel would treat as 0.161111), 8hrs 2mins (0.334722) and 7hrs 21mins (0.30625) then you just have to take the first number + second number + 3 * third number to get 1.414583, which formatted as &quot;[hh]:mm&quot; displays as <code>33:57</code>."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511921640, "post_id": 47543037, "comment_id": 82044923, "body": "It would be better to show the actual code you are using - it probably only requires a minor tweak, and it&#39;s much easier to make that small change to your code rather than guessing how to best describe the change in English."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511921752, "post_id": 47543037, "comment_id": 82044950, "body": "And don&#39;t work in minutes, just work in days - it saves having to multiply date differences by 1440 to get minutes and then dividing the answers you get by 1440 so that they can be displayed as times."}, {"owner": {"reputation": 31, "user_id": 4744044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c2ba50138c16fcd51fbd74f3ab9954eb?s=128&d=identicon&r=PG&f=1", "display_name": "averagescripter", "link": "https://stackoverflow.com/users/4744044/averagescripter"}, "edited": false, "score": 0, "creation_date": 1511923185, "post_id": 47543037, "comment_id": 82045293, "body": "I have to work in minutes, I added more detail above so hopefully the problem is clearer. I have to calculate one bite at a time because every minute is not equal, some minutes during the day are higher priority than others"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511980752, "post_id": 47543037, "comment_id": 82076817, "body": "But a minute is 1/1440th of a day, and it is just as valid to say some 1/1440ths of a day have a higher priority than others as it is to say some minutes have a higher priority.  It&#39;s just a waste of time to multiply a number by 1440 and then divide it by 1440 later."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4744044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c2ba50138c16fcd51fbd74f3ab9954eb?s=128&d=identicon&r=PG&f=1", "display_name": "averagescripter", "link": "https://stackoverflow.com/users/4744044/averagescripter"}, "edited": false, "score": 0, "creation_date": 1511917233, "post_id": 47543388, "comment_id": 82043920, "body": "Thanks, I get that, but I can&#39;t use that method. In my case, I have to find out the difference in minutes between the down and restore time, and add downtime_minutes x 3 if the downtime happens to occur during a specific time period during the day."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 31, "user_id": 4744044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c2ba50138c16fcd51fbd74f3ab9954eb?s=128&d=identicon&r=PG&f=1", "display_name": "averagescripter", "link": "https://stackoverflow.com/users/4744044/averagescripter"}, "edited": false, "score": 0, "creation_date": 1511919967, "post_id": 47543388, "comment_id": 82044587, "body": "I assume with, for example, <code>event 4 : 17&#47;11&#47;2017 6:15 : 18&#47;11&#47;2017 8:10</code> the first value is the down time and second value is the restore time, so this one was down for almost <b>26 hours</b>, correct?"}, {"owner": {"reputation": 31, "user_id": 4744044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c2ba50138c16fcd51fbd74f3ab9954eb?s=128&d=identicon&r=PG&f=1", "display_name": "averagescripter", "link": "https://stackoverflow.com/users/4744044/averagescripter"}, "edited": false, "score": 0, "creation_date": 1511920436, "post_id": 47543388, "comment_id": 82044678, "body": "Yes, this is just an example, I have hundreds of these lines in a sheet, hence needing to write a macro to avoid hand calculation which is currently the only method we have. There are other details as well, this is a simplified version of the real thing which has lots of factors that contribute to the end result, but the essentials are described in the question"}, {"owner": {"reputation": 31, "user_id": 4744044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c2ba50138c16fcd51fbd74f3ab9954eb?s=128&d=identicon&r=PG&f=1", "display_name": "averagescripter", "link": "https://stackoverflow.com/users/4744044/averagescripter"}, "edited": false, "score": 0, "creation_date": 1511921069, "post_id": 47543388, "comment_id": 82044792, "body": "Even more significantly though, 26 hours crosses over all different time periods where minutes down are not counted (overnight), or they are counted double or triple due to higher priority time."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 31, "user_id": 4744044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c2ba50138c16fcd51fbd74f3ab9954eb?s=128&d=identicon&r=PG&f=1", "display_name": "averagescripter", "link": "https://stackoverflow.com/users/4744044/averagescripter"}, "edited": false, "score": 0, "creation_date": 1511921867, "post_id": 47543388, "comment_id": 82044974, "body": "absolutely, I&#39;m putting together a thorough answer in return for your patience (and afterwards headed to SuperUser to ask for help with my dang laptop, hence the partial posts!)   The amount of data isn&#39;t as important as the format.  Are all the date/time&#39;s in the same format as you posted?"}, {"owner": {"reputation": 31, "user_id": 4744044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c2ba50138c16fcd51fbd74f3ab9954eb?s=128&d=identicon&r=PG&f=1", "display_name": "averagescripter", "link": "https://stackoverflow.com/users/4744044/averagescripter"}, "edited": false, "score": 0, "creation_date": 1511922257, "post_id": 47543388, "comment_id": 82045062, "body": "They are manually entered, it&#39;s hard to enforce but will always be something recognised as a date by Excel. Eg  11/12/2017 14:32   or   02:00 PM 11/12/2017   or some variaton of those. I&#39;m writing another part that will validate correctly formatted dates"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 31, "user_id": 4744044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c2ba50138c16fcd51fbd74f3ab9954eb?s=128&d=identicon&r=PG&f=1", "display_name": "averagescripter", "link": "https://stackoverflow.com/users/4744044/averagescripter"}, "edited": false, "score": 0, "creation_date": 1511923251, "post_id": 47543388, "comment_id": 82045310, "body": "Oh! They are currently something always recognized as dates, perfect. This is highly depended on regional settings.  For example, my Windows &quot;Short Date&quot; regional setting is YYYY-MM-DD and therefore my Excel won&#39;t automatically recognize your example &quot;17/11/2017&quot; without manipulating the text into separate parts (year, month, day, time)."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 31, "user_id": 4744044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c2ba50138c16fcd51fbd74f3ab9954eb?s=128&d=identicon&r=PG&f=1", "display_name": "averagescripter", "link": "https://stackoverflow.com/users/4744044/averagescripter"}, "edited": false, "score": 0, "creation_date": 1511923446, "post_id": 47543388, "comment_id": 82045358, "body": "so therefore could you test with your example data, enter <code>17&#47;11&#47;2017 6:15</code> into A1, enter <code>18&#47;11&#47;2017 8:10</code> into A2, and in A3, enter formula: <code>=(A2-A1)*24*60</code>  You should get a number of minutes.  If it is formatted as a date, right click the cell, Format Cells, Number tab, and choose a <b>Number</b> format.  If that still doesn&#39;t display a number of minutes then Excel may <i>not</i> be recognizing the values as date... <i>yet</i>"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 31, "user_id": 4744044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c2ba50138c16fcd51fbd74f3ab9954eb?s=128&d=identicon&r=PG&f=1", "display_name": "averagescripter", "link": "https://stackoverflow.com/users/4744044/averagescripter"}, "edited": false, "score": 0, "creation_date": 1511923705, "post_id": 47543388, "comment_id": 82045427, "body": "If you&#39;d like to expedite this for both of us, you can send me a worksheet with some actual data, at least a page of varying date entries, and I&#39;ll slap in some formulas (and possibly a VBA function), send it back, and it will be easier to explain afterwards.  (Normally we don&#39;t do this but I see that you&#39;re motivated to get the basics and take over, as opposed to wanting someone else to do your work for you,)"}, {"owner": {"reputation": 31, "user_id": 4744044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c2ba50138c16fcd51fbd74f3ab9954eb?s=128&d=identicon&r=PG&f=1", "display_name": "averagescripter", "link": "https://stackoverflow.com/users/4744044/averagescripter"}, "edited": false, "score": 0, "creation_date": 1511924574, "post_id": 47543388, "comment_id": 82045647, "body": "I see what you&#39;re saying, but I&#39;m purposely staying away from any kind of manual cell entry. I&#39;m writing this for a colleague who needs to be able to click &quot;Run Macro&quot; and then get the answers. This isn&#39;t a one off problem either, it takes up huge man hours every month calculating the down time for hundreds of units, long story short I bet the boss I could write a macro to do it and here we are. I can send you some sanitised sample data and my current messy source"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 31, "user_id": 4744044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c2ba50138c16fcd51fbd74f3ab9954eb?s=128&d=identicon&r=PG&f=1", "display_name": "averagescripter", "link": "https://stackoverflow.com/users/4744044/averagescripter"}, "edited": false, "score": 0, "creation_date": 1511924906, "post_id": 47543388, "comment_id": 82045721, "body": "No cell entry is required, it&#39;s easier to manipulate strings and dates in VBA anyway!  If you&#39;re confident that <i>Excel will recognize the date</i> then I can move to the <i>&quot;which minutes to count&quot;</i> part.  I&#39;m kind of a data geek (ie, do it for fun, lol) and I&#39;ve worked with date/time comparisons to specific sets of rules lots in the past.  (Actually currently have a project for a transit company involving similar logic).  It&#39;s doesn&#39;t have to be your real data, but making sample data that will pass <b>and</b> fail each of the rules, for testing purposes, is sometimes more of a pain than the solution."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 31, "user_id": 4744044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c2ba50138c16fcd51fbd74f3ab9954eb?s=128&d=identicon&r=PG&f=1", "display_name": "averagescripter", "link": "https://stackoverflow.com/users/4744044/averagescripter"}, "edited": false, "score": 0, "creation_date": 1511925303, "post_id": 47543388, "comment_id": 82045817, "body": "I would need a bit of clarification on the rules too...  <code>Weekends are not counted</code>, simple; <code>Only minutes between 6am and 6pm are counted</code>, okay, <b>but</b> <code>Minutes 3X in priority during certain time periods:06:00-07:00, 07:00-09:00, 09:00-10:00, 10:00-14:00</code>, that&#39;s <b>all</b> of 06:00-14:00 that they are 3X?  Or if each period different multiplier?"}, {"owner": {"reputation": 31, "user_id": 4744044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c2ba50138c16fcd51fbd74f3ab9954eb?s=128&d=identicon&r=PG&f=1", "display_name": "averagescripter", "link": "https://stackoverflow.com/users/4744044/averagescripter"}, "edited": false, "score": 0, "creation_date": 1511927146, "post_id": 47543388, "comment_id": 82046319, "body": "I actually don&#39;t have the exact details, I code so that down the track I can add and subtract different priority time periods as SLA changes. The example you quoted was just showing different time periods across the day, as an example, and each would be weighted differently. 7am to 9am would be worth more than 6am to 7am for reasons."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 31, "user_id": 4744044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c2ba50138c16fcd51fbd74f3ab9954eb?s=128&d=identicon&r=PG&f=1", "display_name": "averagescripter", "link": "https://stackoverflow.com/users/4744044/averagescripter"}, "edited": false, "score": 0, "creation_date": 1511932484, "post_id": 47543388, "comment_id": 82047788, "body": "@averagescripter all good, I don&#39;t need your sample data anymore; I posted a new answer (replacing my previous answer[s]; if needed, you can view them in the edit history.  Hope that works for you, let me know if you have questions."}, {"owner": {"reputation": 31, "user_id": 4744044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c2ba50138c16fcd51fbd74f3ab9954eb?s=128&d=identicon&r=PG&f=1", "display_name": "averagescripter", "link": "https://stackoverflow.com/users/4744044/averagescripter"}, "edited": false, "score": 0, "creation_date": 1512966745, "post_id": 47543388, "comment_id": 82452975, "body": "Thanks for your answer and all your hard work helping me out. After reading through the code, it looks like this will only work if start and end times are on the same day... but very often in reality something will go wrong before midnight and be resolved after midnight, or go down on Friday and be back up on Tuesday. I added the code I&#39;ve written that basically eats the time section by section from start to finish. It doesn&#39;t work perfectly due to data types, but I&#39;ll try with integerising like with yours"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1511934055, "last_edit_date": 1511934055, "creation_date": 1511917037, "answer_id": 47543388, "question_id": 47543037, "link": "https://stackoverflow.com/questions/47543037/excel-macro-vba-add-minutes-and-hours-together-where-total-can-exceed-24-hours/47543388#47543388", "title": "Excel Macro VBA: Add minutes and hours together where total can exceed 24 hours", "body": "<p><sub><strong>Edit:</strong> <em>Now that we're on the same page and I have what I think is a workable solution for you, I'll replace my previous answer [re: How Excel dates are related to value (ie., 1 day = 1)] with this one.  The previous answer (and my computer messing up while trying to post it) is viewable in the Edit History.</em></sub></p>\n\n<hr>\n\n<p>So, you need a way to count minutes duration, between two DateTimes, and include or exclude sub-time-ranges based on criteria that might require ongoing adjustment, and you want this in a VBA function for use in automation of downtime data analysis.</p>\n\n<p><strong>Try this:</strong></p>\n\n<pre><code>Option Explicit\n\nFunction MinsBetween(startDateTime As Date, stopDateTime As Date, count_StartTime As Date, count_StopTime As Date) As Long\n\n    Dim startTime As Date, stopTime As Date \n\n    'ignore dates, use only the times\n    startTime = startDateTime - Int(startDateTime)\n    stopTime = stopDateTime - Int(stopDateTime)\n\n    If startTime &gt;= count_StopTime Or stopTime &lt;= count_StartTime Then\n        'entire period falls outside of times to count\n        MinsBetween = 0\n        Exit Function\n    End If\n\n    'make 'adj' times start/end at counted times if necessary\n    startDateTime = IIf(startTime &lt; count_StartTime, count_StartTime, startTime)\n    stopDateTime = IIf(stopTime &gt; count_StopTime, count_StopTime, stopTime)\n\n    'calculate &amp; return minutes between (never return negative number)\n    MinsBetween = Abs(DateDiff(\"n\", startDateTime, stopDateTime))\n\nEnd Function\n</code></pre>\n\n<p>This function counts only the minutes between <code>startDateTime</code> and <code>stopDateTime</code> that also fall between <code>count_StartTime</code> and <code>count_StopTime</code>.</p>\n\n<p><strong>Expects</strong>:\n - <code>count_StartTime</code> &amp; <code>count_StopTime</code> to be an Excel Time (or number between 0 and 1)\n - <code>startDateTime</code> &amp; <code>stopDateTime</code> to be an Excel Time <em>or</em> DateTime.</p>\n\n<p><strong>Returns</strong> a long integer.  Could be referenced in VBA or as a worksheet function.</p>\n\n<p><strong>Example usage:</strong></p>\n\n<blockquote>\n  <p>The outage 'event' occurred from 05:00 to 07:03 on 2017/11/19, but only the times between 6am and 6pm should be counted:</p>\n</blockquote>\n\n<pre><code>Debug.Print MinsBetween(\"2017/11/19 05:00\", \"2017/11/19 07:03\", \"06:00\", \"18:00\") \n</code></pre>\n\n<blockquote>\n  <p>The outage 'event' occurred from 05:00 to 14:12 on 2017/11/19.  The duration that occurred between [peak period] 1pm to 2pm are have higher priority and should be counted as \"<em>double-time</em>\":</p>\n</blockquote>\n\n<pre><code>Debug.Print (2 * MinsBetween(\"2017/11/19 05:00\", \"2017/11/19 14:12\", \"13:00\", \"15:00\") )\n</code></pre>\n\n<p>As weekends are ignored entirely, those reports could be excluded with a simple check like this:</p>\n\n<pre><code>Function isWeekend(wDateTime As Date) As Boolean\n    isWeekend = Weekday(DateValue(wDateTime)) = vbSaturday Or Weekday(DateValue(wDateTime)) = vbSunday\nEnd Function\n</code></pre>\n\n<p>...returns <code>TRUE</code> if the supplied date (or datetime) falls on a weekend, otherwise returns FALSE.</p>\n\n<hr>\n\n<p>You could use a combination of these functions to build sub or worksheet function around your custom criteria and adjust as needed. </p>\n\n<p><strong>For example:</strong></p>\n\n<pre><code>Function DownTimeMinutes(startDateTime As Date, stopDateTime As Date) As Long\n'you could process your custom criteria for each start/stop period here\n\n    Dim dtMinutes As Long\n\n    'for example:\n\n    'IGNORE DOWNTIME ON WEEKENDS\n    If isWeekend(startDateTime) Then\n        'ignore weekeends\n        DownTimeMinutes = 0\n        Exit Function\n    End If\n\n    'COUNT MINUTES BETWEEN 6AM-6PM with \"x1\" multiplier\n    dtMinutes = MinsBetween(startDateTime, stopDateTime, \"06:00\", \"18:00\")\n\n    'DON'T COUNT LUNCH BREAK (or something like that)\n    '(subtract these minutes from total)\n    dtMinutes = dtMinutes - MinsBetween(startDateTime, stopDateTime, \"12:00\", \"12:30\")\n\n    'COUNT MINUTES BETWEEN 14:00-15:00 as \"x3\"\n    '(already counted as \"x1\" so add \"2x these minutes\"\n    dtMinutes = dtMinutes + (2 * MinsBetween(startDateTime, stopDateTime, \"14:00\", \"15:00\"))\n\n    'return adjusted minutes for this downtime event\n    DownTimeMinutes = dtMinutes\n\nEnd Function\n</code></pre>\n\n<hr>\n\n<p><em>Side note:</em> This is the short-story of the long-example I was getting at when I thought part of your issue was trouble converting varying M/D/Y , MM/DD/YY , M-DD-YYYY , etc, manual entries to DateTimes that Excel would recognize regardless of the user's Regional date settings.</p>\n\n<p>As I understand it, you don't need it now but I figured I might as well add it to my answer anyway :</p>\n\n<pre><code>=DATE(MID(RIGHT(LEFT(A1,FIND(\" \",A1)-1),LEN(LEFT(A1,FIND(\" \",A1)-1))-FIND(\"/\",LEFT(A1,FIND(\" \",A1)))),FIND(\"/\",RIGHT(LEFT(A1,FIND(\" \",A1)-1),LEN(LEFT(A1,FIND(\" \",A1)-1))-FIND(\"/\",LEFT(A1,FIND(\" \",A1)))))+1,4),LEFT(RIGHT(LEFT(A1,FIND(\" \",A1)-1),LEN(LEFT(A1,FIND(\" \",A1)-1))-FIND(\"/\",LEFT(A1,FIND(\" \",A1)))),FIND(\"/\",RIGHT(LEFT(A1,FIND(\" \",A1)-1),LEN(LEFT(A1,FIND(\" \",A1)-1))-FIND(\"/\",LEFT(A1,FIND(\" \",A1)))))-1),FIND(\"/\",RIGHT(LEFT(A1,FIND(\" \",A1)-1),LEN(LEFT(A1,FIND(\" \",A1)-1))-FIND(\"/\",LEFT(A1,FIND(\" \",A1))))))+TIMEVALUE(RIGHT(A1,LEN(A1)-FIND(\" \",A1)))\n</code></pre>\n\n<p>Generally I don't condone the use of gigantic formulas (I was more concerned about getting it into a single function that about readability), and there are other ways to deal with date issues caused by Regional differences in shared workbooks (including <a href=\"https://stackoverflow.com/a/11542249/8112776\">Windows API</a>) but in most cases I find text manipulation will do the job too.</p>\n"}], "owner": {"reputation": 31, "user_id": 4744044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c2ba50138c16fcd51fbd74f3ab9954eb?s=128&d=identicon&r=PG&f=1", "display_name": "averagescripter", "link": "https://stackoverflow.com/users/4744044/averagescripter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1880, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512964647, "creation_date": 1511914349, "last_edit_date": 1512964647, "question_id": 47543037, "link": "https://stackoverflow.com/questions/47543037/excel-macro-vba-add-minutes-and-hours-together-where-total-can-exceed-24-hours", "title": "Excel Macro VBA: Add minutes and hours together where total can exceed 24 hours", "body": "<p>hopefully this is a silly question with an easy answer.</p>\n\n<p>I have no choice really what language I use, which is why I'm doing this in Excel with VBA.</p>\n\n<p>I'm basically calculating total downtime hours over a month. I need to add small amounts of minutes together to find out a total that will be over 24 hours of course.</p>\n\n<p>Here is the scenario:</p>\n\n<p>Server A was down for 3 hours and 52 minutes this month.<br>\nServer B was down for 15 hours and 25 minutes this month.</p>\n\n<p>Server B had 7 hours and 23 minutes downtime during a critical period, so this is multplied by 3 to equate it to non-critical downtime.</p>\n\n<p>Server A has: 3 hours 52 minutes at x1<br>\nServer B has: 8 hours 2 minutes at x1<br>\nServer B has: 7 hours 21 minutes at x3</p>\n\n<p>All downtimes and restoration times are manually listed in a sheet in time formats recognised by excel, eg:</p>\n\n<p>event 1  :  19/11/2017 5:00  :  19/11/2017 14:12<br>\nevent 2  :  13/11/2017 6:00  :  13/11/2017 6:40<br>\nevent 3  :  13/11/2017 7:57  :  13/11/2017 9:01<br>\nevent 4  :  17/11/2017 6:15  :  18/11/2017 8:10</p>\n\n<p>Weekends are not counted</p>\n\n<p>Only minutes between 6am and 6pm are counted</p>\n\n<p>Minutes increase in priority during certain time periods:</p>\n\n<p>06:00-07:00, 07:00-09:00, 09:00-10:00, 10:00-14:00</p>\n\n<p>High priority minutes are multiplied to equate peak time usage with lower standard time usage</p>\n\n<p>I'm struggling to find a way to add times together to count hours, excel trys to give answers relative to 01/01/1900 or some \"real\" date.</p>\n\n<p>I'm going the opposite way, I have the real dates, I need to work with the hours between them. Is there a data format that is in plain hours:minutes?</p>\n\n<p>I thought it was obvious but I'll state clearly in case, start time and end times are not necessarily on the same day. They can be any time, any relationship, sometimes start time will be <em>after</em> the end time due to how faults are reported. Obviously that counts as 0 minutes in that case.</p>\n\n<hr>\n\n<p>My current methodology for attacking this problem is: </p>\n\n<ol>\n<li>increase the start time until it becomes valid charge time  </li>\n<li>calculate the minutes until there is a change such as end of day or higher priority time slot, or start time = end time  </li>\n<li>add the calculated minutes to a total  </li>\n<li>increase the start time by the calculated minutes  </li>\n<li><p>start cycle again from the the new 'start time' and loop until there are no minutes remaining between start time and end time  </p>\n\n<pre><code>startof:\n\n'move to start of next chargeable day, if not on a chargeable day\n'eg weekends, public holidays, easy function to write\nDo While testForChargeable() = False\n\n    opnDate = DateAdd(\"d\", 1, opnDate)\n    opnTime = \"06:00\"\n\nLoop\n\n'check if open time is past the end of chargeable time, 18:00\nIf (opnTime &gt;= endofdayTime) Then\n    'move to start of next chargeable day\n    opnDate = DateAdd(\"d\", 1, opnDate)\n    opnTime = \"06:00\"\nEnd If\n\n'check if open time is after close time and fault is excluded\nIf (opnDate &gt;= bisDate) And (opnTime &gt;= bisTime) Then\n    GoTo last\nEnd If\n\n'check if close time is on same day as start time\nIf DateDiff(\"d\", opnDate, bisDate) = 0 Then\n    'if it is, add minutes between opntime and bistime\n    chargeTime = chargeTime + calculateChargeTime(opnTime, bisTime)\n    'calculation ends, loop naturally terminates\nElse\n    'if not, add remaining mintes of day to chargeable time\n    chargeTime = chargeTime + calculateChargeTime(opnTime, endofdayTime)\n    'move to start of next day\n    opnDate = DateAdd(\"d\", 1, opnDate)\n    opnTime = \"06:00\"\n    GoTo startof\nEnd If\n\nlast:\n</code></pre></li>\n</ol>\n\n<p>Cheers</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1511919833, "post_id": 47542794, "comment_id": 82044552, "body": "In order to provide a <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>, please edit your question and post some sample data that can be used to reproduce the problem."}, {"owner": {"reputation": 17, "user_id": 6552125, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3fd6f09dae0d6962b18b43908ff2a256?s=128&d=identicon&r=PG&f=1", "display_name": "GeorgeB22", "link": "https://stackoverflow.com/users/6552125/georgeb22"}, "reply_to_user": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1511920019, "post_id": 47542794, "comment_id": 82044598, "body": "I am not sure what you mean? Should I post screenshots of the different sheets?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1511921252, "post_id": 47542794, "comment_id": 82044843, "body": "Sounds like you are trying to randomise a set of cells value onto another sheet but not on the same row? Use a <a href=\"https://msdn.microsoft.com/en-us/library/x4k5wbx4(v=vs.84).aspx\" rel=\"nofollow noreferrer\">Dictionary</a> or <a href=\"https://msdn.microsoft.com/en-us/library/system.collections.arraylist(v=vs.110).aspx\" rel=\"nofollow noreferrer\">ArrayList</a> object to build up unique list, retrieve from it randomly, if not existed in target worksheet, place it in and remove from Dictionary/ArrayList."}], "answers": [{"tags": [], "owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "is_accepted": false, "score": 0, "last_activity_date": 1511966124, "creation_date": 1511966124, "answer_id": 47555275, "question_id": 47542794, "link": "https://stackoverflow.com/questions/47542794/do-loop-until-2-things-in-column-do-not-equal-pulling-information-from-another/47555275#47555275", "title": "Do loop until 2 things in column do not equal. Pulling information from another sheet", "body": "<p>In your final <code>If..Else</code>, you use <code>RandNumLunch</code> where you should be using <code>RandNumDinner</code>. This means that the whatever happens in between, you set <code>Sheet3.Cells(3, 2)</code> and <code>Sheet3.Cells(4, 2)</code> to the same value, so the final check can never be true. </p>\n"}], "owner": {"reputation": 17, "user_id": 6552125, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3fd6f09dae0d6962b18b43908ff2a256?s=128&d=identicon&r=PG&f=1", "display_name": "GeorgeB22", "link": "https://stackoverflow.com/users/6552125/georgeb22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511966124, "creation_date": 1511912565, "question_id": 47542794, "link": "https://stackoverflow.com/questions/47542794/do-loop-until-2-things-in-column-do-not-equal-pulling-information-from-another", "title": "Do loop until 2 things in column do not equal. Pulling information from another sheet", "body": "<p>I am trying to pull information from another sheet and then have it check to make sure 2 cells in this sheet are not the same. It is for a randomized meal plan, but on the same day you can not eat the same protein (to give you a little background). I have the code checking to see if it can be used during that meal and if it can be it is put into the next sheet. It does this for lunch and dinner. It is getting caught in the do - loop until loop and I am not sure how to solve this. </p>\n\n<p>If you need anymore information I can provide screenshots if this does not make sense.</p>\n\n<pre><code>Do\n\nRandNumLunch = Int((10 - 2 + 1) * Rnd + 2)\n\nDo Until Sheet2.Cells(RandNumLunch, 6) = \"Yes\"\n    If Sheet2.Cells(RandNumLunch, 6) = \"Yes\" Then\n    Else\n    RandNumLunch = Int((10 - 2 + 1) * Rnd + 2)\n    End If\nLoop\n\nIf Sheet2.Cells(RandNumLunch, 6) = \"Yes\" Then\n    Sheet3.Cells(3, 2) = Sheet2.Cells(RandNumLunch, 1)\nEnd If\n\n\n\nRandNumDinner = Int((10 - 2 + 1) * Rnd + 2)\n\nDo Until Sheet2.Cells(RandNumDinner, 7) = \"Yes\"\n    If Sheet2.Cells(RandNumDinner, 7) = \"Yes\" Then\nElse\n    RandNumDinner = Int((10 - 2 + 1) * Rnd + 2)\nEnd If\nLoop\n\nIf Sheet2.Cells(RandNumDinner, 7) = \"Yes\" Then\n    Sheet3.Cells(4, 2) = Sheet2.Cells(RandNumLunch, 1)\nEnd If\n\nLoop Until Sheet3.Cells(4, 2) &lt;&gt; Sheet3.Cells(3, 2)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1511911673, "post_id": 47542353, "comment_id": 82042372, "body": "It is hard to understand what you want to do. Please provide us with some examples showing the input and output"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1511911804, "post_id": 47542353, "comment_id": 82042414, "body": "If you want to paste in the next available <i>blank</i> cell, you can use <code>.Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row + 1</code> where column <b>A</b> would be the row you want to check for next blank cell"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1511912545, "post_id": 47542353, "comment_id": 82042610, "body": "Are you receiving any errors? Where is your code going wrong? I think we need a bit more information here"}, {"owner": {"reputation": 1, "user_id": 9022812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9969f5db8d1a5dfdb2df11730984fe7?s=128&d=identicon&r=PG&f=1", "display_name": "jbakk24", "link": "https://stackoverflow.com/users/9022812/jbakk24"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1511912881, "post_id": 47542353, "comment_id": 82042719, "body": "So really the only part of my code that isn&#39;t working is the For Each N loop.  It does not cycle through the list of Ns, rather it takes the first entry of the list, filters the larger data set using that entry, and then pastes the filtered data to each tab. What I want it to do, is take the first entry of the list, use that as the filter criteria on the larger data set, copy the range of filtered results, and past that range in the next blank cell on a tab that is named like the filter criteria.  Then move to the next criteria in the list and repeat.  Does this help @Ibo and @Maldred?"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1511914068, "post_id": 47542353, "comment_id": 82043059, "body": "use <code>N.value</code> instead of <code>N.Text</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9022812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9969f5db8d1a5dfdb2df11730984fe7?s=128&d=identicon&r=PG&f=1", "display_name": "jbakk24", "link": "https://stackoverflow.com/users/9022812/jbakk24"}, "edited": false, "score": 0, "creation_date": 1511965783, "post_id": 47543358, "comment_id": 82067058, "body": "Don&#39;t believe I can do this as other people will be editing the information that gets copied to their sheets (from the main data table), and once they are done editing, I will then need to recompile the list with their edits."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 1, "user_id": 9022812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9969f5db8d1a5dfdb2df11730984fe7?s=128&d=identicon&r=PG&f=1", "display_name": "jbakk24", "link": "https://stackoverflow.com/users/9022812/jbakk24"}, "edited": false, "score": 0, "creation_date": 1511979858, "post_id": 47543358, "comment_id": 82076372, "body": "OK. In that case I have another solution that I will try to write up today."}], "tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 0, "last_activity_date": 1511916748, "creation_date": 1511916748, "answer_id": 47543358, "question_id": 47542353, "link": "https://stackoverflow.com/questions/47542353/filtering-a-data-set-in-excel-vba-and-pasting-results-into-different-tabs-that-a/47543358#47543358", "title": "FIltering a data set in excel vba and pasting results into different tabs that are named based on filter", "body": "<p>What you are attempting to do using VBA can very easily be accomplished using PivotTables and Slicers. Turn your source data into an Excel Table, make a PivotTable out of it, put the PivotTable in the Inputs tab, set up a Slicer on the field you want to filter on, put the other fields of interest in the PivotTable as row fields, and you're done. No code necessary. Let the application do the work for you. </p>\n"}], "owner": {"reputation": 1, "user_id": 9022812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9969f5db8d1a5dfdb2df11730984fe7?s=128&d=identicon&r=PG&f=1", "display_name": "jbakk24", "link": "https://stackoverflow.com/users/9022812/jbakk24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511916748, "creation_date": 1511909944, "last_edit_date": 1511916522, "question_id": 47542353, "link": "https://stackoverflow.com/questions/47542353/filtering-a-data-set-in-excel-vba-and-pasting-results-into-different-tabs-that-a", "title": "FIltering a data set in excel vba and pasting results into different tabs that are named based on filter", "body": "<p>I am trying to filter a data set in tab \"Expiring Contracts\", filtered on column B (this data set can increase or decrease based at any point). The different filters come from tab \"Inputs\" which can change overtime (increase or decrease). I am trying to paste the results of the filter to separate tabs that are named exactly like the list, BUT I want to paste the values on the next available (blank) cell. This is what I have now:</p>\n\n<pre><code>Sub ParseList2()\n\n    Dim uwname As String\n    Dim lastrowUW As Long\n    Dim lastrow As Long\n    Dim N As Range\n\n    lastrowUW = Sheets(\"Inputs\").Cells(Rows.Count, \"H\").End(xlUp).Row\n\n    For Each N In Sheets(\"Inputs\").Range(\"H2:H\" &amp; lastrowUW).Cells\n        uwname = N.Text\n        Sheets(\"Expiring Contracts\").Range(\"$A:$AA\").AutoFilter Field:=2, \n            Criteria1:=N\n        lastrow = Columns(2).Find(\"*\", SearchDirection:=xlPrevious).Row\n        Range(\"A2:AA\" &amp; lastrow).SpecialCells(xlCellTypeVisible).Select\n        Selection.Copy\n        Sheets(uwname).Select\n        lastrow = Columns(2).Find(\"*\", SearchDirection:=xlPrevious).Row + 1\n        Range(\"A\" &amp; lastrow).Select\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n            :=False, Transpose:=False\n    Next N\n\n    Sheets(\"Expiring Contracts\").AutoFilterMode = False\n\nEnd Sub\n</code></pre>\n\n<p>This worked thanks to some comments below!</p>\n\n<pre><code>Sub ParseList2()\n\nDim uwname As String\nDim lastrowUW As Long\nDim lastrow As Long\nDim N As Range\nDim rng As Range\n\nlastrowUW = Sheets(\"Inputs\").Cells(Rows.Count, \"H\").End(xlUp).Row\n\n\nFor Each N In Sheets(\"Inputs\").Range(\"H2:H22\").Cells\nuwname = N.Value\nSheets(\"Expiring Contracts\").Range(\"$A:$AA\").AutoFilter Field:=2, \nCriteria1:=uwname\n'lastrow = Columns(2).Find(\"*\", SearchDirection:=xlPrevious).Row + 1\nRange(\"A2:AA99999\").SpecialCells(xlCellTypeVisible).Select\nSelection.Copy\nSheets(uwname).Select\nlastrow = Columns(2).Find(\"*\", SearchDirection:=xlPrevious).Row + 1\nRange(\"A\" &amp; lastrow).Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nRange(\"A1\").Select\nSheets(\"Expiring Contracts\").Select\nSheets(\"Expiring Contracts\").AutoFilterMode = False\nRange(\"A1\").Select\nNext N\nSheets(\"Expiring Contracts\").Select\nSheets(\"Expiring Contracts\").AutoFilterMode = False\nRange(\"A1\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "for-loop", "foreach"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1511909203, "post_id": 47542182, "comment_id": 82041568, "body": "first remove the <code>On Error Resume Next</code> run it again and tell us where is errors."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1511909465, "post_id": 47542182, "comment_id": 82041643, "body": "FWIW - Why do you include the <code>.Rows</code> in statements such as <code>Set SummaryLastRow = Summary.Range(&quot;G&quot; &amp; Rows.Count).End(xlUp).Rows</code>?  The <code>Rows</code> property of a single cell will just return the single cell that you started with, so it&#39;s pointless using it."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1511909812, "post_id": 47542182, "comment_id": 82041760, "body": "I think the OP should remove those <code>.Rows</code> and it should work. Possible issue with SummaryLastRow never move inside the loop. Move the <code>Set SummaryLastRow = </code> line inside the For loop."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9022729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e138a46a109f847ef76b542f516d0d7c?s=128&d=identicon&r=PG&f=1", "display_name": "user9022729", "link": "https://stackoverflow.com/users/9022729/user9022729"}, "edited": false, "score": 0, "creation_date": 1511911412, "post_id": 47542407, "comment_id": 82042286, "body": "Hey All,  Thank you so much for the help!  I removed the .rows after SummaryLastRow, removed the if statement, then added SummaryLastRow into the For Each, and it worked perfectly."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1511910224, "creation_date": 1511910224, "answer_id": 47542407, "question_id": 47542182, "link": "https://stackoverflow.com/questions/47542182/for-each-loop-only-running-for-first-variable-in-a-dynamic-set/47542407#47542407", "title": "For Each Loop only running for first variable in a dynamic set", "body": "<p>The problem is that, as soon as you do the first iteration of the loop <code>SummaryLastRow.Offset(1, 0)</code> is no longer <code>Empty</code>, so the other iterations won't do anything.</p>\n\n<p>You need to put the statement setting <code>SummaryLastRow</code> within your loop and, because you <strong>know</strong> that the cell below it will be empty, the <code>If</code> statement then becomes pointless.</p>\n\n<pre><code>Dim Summary As Worksheet\nDim DataCell As Range\nDim DataRange As Range\nDim SummaryLastRow As Range\nDim StartDate As Date\nDim EndDate As Date\nDim NoDays As Integer\n\nWith Worksheets(\"Summary\")\n    Set DataRange = .Range(\"A2\", .Range(\"A\" &amp; .Rows.Count).End(xlUp))\n\n    For Each DataCell In DataRange\n        StartDate = DataCell.Offset(0, 1).Value\n        EndDate = DataCell.Offset(0, 2).Value\n        NoDays = EndDate - StartDate + 1\n        Set SummaryLastRow = .Range(\"G\" &amp; .Rows.Count).End(xlUp)\n        SummaryLastRow.Offset(1, 0) = StartDate\n        SummaryLastRow.Offset(1, 0).Resize(NoDays).DataSeries Rowcol:=xlColumns, Type:=xlChronological, Date:= _\n                  xlMonth, Step:=1, Stop:=EndDate, Trend:=False\n        Range(SummaryLastRow.Offset(1, 0), SummaryLastRow.Offset(1, 0).End(xlDown)).Offset(0, -1).Value = DataCell.Value\n    Next DataCell\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9022729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e138a46a109f847ef76b542f516d0d7c?s=128&d=identicon&r=PG&f=1", "display_name": "user9022729", "link": "https://stackoverflow.com/users/9022729/user9022729"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511910224, "creation_date": 1511909080, "question_id": 47542182, "link": "https://stackoverflow.com/questions/47542182/for-each-loop-only-running-for-first-variable-in-a-dynamic-set", "title": "For Each Loop only running for first variable in a dynamic set", "body": "<p>Thanks in advance for help, I just can't seem to get this working, and I can't figure it out.  I only care about the MONTH and YEAR, not the DAY.  I want to take this data (Col. A,B,C):</p>\n\n<pre><code>Data    Min Date    Max Date\na   4/10/1985   10/30/2012\nb   4/1/1996    11/1/2010\nc   4/1/1997    11/1/2010\nd   4/1/1998    11/1/2010\n</code></pre>\n\n<p>and autofill monthly from min to max date in Columns G, and populate the associated data column a through d  in column H like this:</p>\n\n<pre><code>(Col.H)  (Col.G)\na   4/10/1985\na   5/10/1985\na   6/10/1985\na   7/10/1985\na   8/10/1985\n</code></pre>\n\n<p>So you monthly autofill all of a, autofill all of b, autofill all of c, and autofill all of d, with the a,b,c,d values preceding it.</p>\n\n<p>My code looks like this now, but it is only autofilling for a, and not for the other 3 data points.</p>\n\n<pre><code>Dim Summary As Worksheet\nDim DataCell As Range\nDim DataRange As Range\nDim SummaryLastRow As Range\nDim StartDate As Date\nDim EndDate As Date\nDim NoDays As Integer\n\nSet Summary = Worksheets(\"Summary\")\nSet SummaryLastRow = Summary.Range(\"G\" &amp; Rows.Count).End(xlUp).Rows\nSet DataRange = Summary.Range(Summary.Range(\"A2\"), Summary.Range(\"A\" &amp; Rows.Count).End(xlUp).Rows)\n\nOn Error Resume Next\n    For Each DataCell In DataRange\n        StartDate = DataCell.Offset(0, 1).Value\n        EndDate = DataCell.Offset(0, 2).Value\n        NoDays = EndDate - StartDate + 1\n            If IsEmpty(SummaryLastRow.Offset(1, 0)) Then\n            SummaryLastRow.Offset(1, 0) = StartDate\n                SummaryLastRow.Offset(1, 0).Resize(NoDays).DataSeries Rowcol:=xlColumns, Type:=xlChronological, Date:= _\n                    xlMonth, Step:=1, Stop:=EndDate, Trend:=False\n                    Range(SummaryLastRow.Offset(1, 0), SummaryLastRow.Offset(1, 0).End(xlDown)).Offset(0, -1).Value = DataCell\n            End If\n     Next DataCell\n</code></pre>\n\n<p>Any help would be greatly appreciated!  Thank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1511907935, "post_id": 47541842, "comment_id": 82041079, "body": "Anything of use here: <a href=\"https://stackoverflow.com/questions/13753563/add-modify-delete-calculated-column-formula-in-excel-listobject-table-via-vba\" title=\"add modify delete calculated column formula in excel listobject table via vba\">stackoverflow.com/questions/13753563/&hellip;</a>"}, {"owner": {"reputation": 37, "user_id": 2638725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cf81e398ff0e9c79fc1bb5f5a702eb6?s=128&d=identicon&r=PG", "display_name": "Harry", "link": "https://stackoverflow.com/users/2638725/harry"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511908552, "post_id": 47541842, "comment_id": 82041331, "body": "@QHarr Thanks me for pointing me there, is helpful indeed."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 2638725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cf81e398ff0e9c79fc1bb5f5a702eb6?s=128&d=identicon&r=PG", "display_name": "Harry", "link": "https://stackoverflow.com/users/2638725/harry"}, "edited": false, "score": 0, "creation_date": 1511908795, "post_id": 47542003, "comment_id": 82041421, "body": "added this line before my code, entered my formula code, then used again this line with =True, works wonders! Thanks much."}], "tags": [], "owner": {"reputation": 441, "user_id": 8492815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f3471534d4aba8f3c18c2ee90416efe?s=128&d=identicon&r=PG&f=1", "display_name": "Carol", "link": "https://stackoverflow.com/users/8492815/carol"}, "is_accepted": true, "score": 2, "last_activity_date": 1511908108, "creation_date": 1511908108, "answer_id": 47542003, "question_id": 47541842, "link": "https://stackoverflow.com/questions/47541842/excel-vba-entering-formula-in-table-only-specific-row-not-entire-column/47542003#47542003", "title": "Excel VBA, Entering Formula in Table Only Specific Row, Not Entire Column", "body": "<p>Try:</p>\n\n<pre><code>Application.AutoCorrect.AutoFillFormulasInLists = False\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 2638725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cf81e398ff0e9c79fc1bb5f5a702eb6?s=128&d=identicon&r=PG", "display_name": "Harry", "link": "https://stackoverflow.com/users/2638725/harry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 814, "favorite_count": 0, "accepted_answer_id": 47542003, "answer_count": 1, "score": 1, "last_activity_date": 1511908108, "creation_date": 1511907442, "question_id": 47541842, "link": "https://stackoverflow.com/questions/47541842/excel-vba-entering-formula-in-table-only-specific-row-not-entire-column", "title": "Excel VBA, Entering Formula in Table Only Specific Row, Not Entire Column", "body": "<p>I'm using VBA in Excel to enter a formula in a specific cell within a table, but don't want the entire column to get this formula.</p>\n\n<p>When doing it manually, Excel gives me the option to 'Undo Calculated Column', but not when it's done through code.</p>\n\n<p>My code is as follows:</p>\n\n<pre><code>Dim url As String\nurl=\"https://example.com/myurl\"\n\nThisWorkbook.Worksheets(\"PO Info\").Range(\"E3\").FormulaR1C1 = \"=Hyperlink(\"\"\" &amp; url &amp; \"\"\",\"\"Supplier Portal\"\")\"\n</code></pre>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1511907093, "post_id": 47541751, "comment_id": 82040736, "body": "Should it be &quot;Sheet12&quot;? Also, I am more of a fan of range(&quot;B100000&quot;).end(xlup)"}, {"owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "reply_to_user": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1511907143, "post_id": 47541751, "comment_id": 82040756, "body": "I want it to loop through column M in Sheet2, in order to make a change in Sheet12. @Lowpar"}, {"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1511907209, "post_id": 47541751, "comment_id": 82040785, "body": "Yeha, in your code you have &quot;sheet12&quot; not &quot;Sheet12&quot;, subscript out of range indicates you are not pointing to an available memory node"}, {"owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "reply_to_user": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1511907318, "post_id": 47541751, "comment_id": 82040841, "body": "Oh I see, I did make that change just now (along with the previous correction), but am still receiving the same error. @Lowpar"}, {"owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "reply_to_user": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1511907386, "post_id": 47541751, "comment_id": 82040862, "body": "Out of curiosity, why do you prefer the .end(xlup) approach? Does it have better performance?"}, {"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1511907515, "post_id": 47541751, "comment_id": 82040919, "body": "because it is more robust to missing data within a column."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1511907532, "post_id": 47541751, "comment_id": 82040925, "body": "Is your worksheet named &quot;Sheet12&quot;, or is that just its <code>CodeName</code> property.  (You are using the <code>CodeName</code> &quot;Sheet2&quot;, rather than a sheet name of &quot;Sheet2&quot;, so it seems like you might have proper names allocated to your sheets.)"}, {"owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "edited": false, "score": 0, "creation_date": 1511907704, "post_id": 47541751, "comment_id": 82040986, "body": "You are right - I was using the code name instead of the sheet name.  Thank you!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1511907738, "post_id": 47541751, "comment_id": 82041003, "body": "I think you mean you were using the sheet name instead of the codename, but I get the point."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1511908190, "creation_date": 1511908190, "answer_id": 47542024, "question_id": 47541751, "link": "https://stackoverflow.com/questions/47541751/referencing-outside-sheets-in-module-subscript-out-of-range/47542024#47542024", "title": "Referencing Outside Sheets in Module - Subscript out of Range", "body": "<p>In the statement</p>\n\n<pre><code>Worksheets(\"sheet12\").Range(\"B1\").End(xlDown).Offset(1, 0).Value = l\n</code></pre>\n\n<p>the only thing likely to cause a \"subscript out of range\" error is if you don't have a worksheet with a <code>Name</code> of \"sheet12\".</p>\n\n<p>Considering that you have a <code>With Sheet2</code> statement, it seems likely that \"Sheet12\" is actually the <code>CodeName</code> of your sheet, so your statement should be:</p>\n\n<pre><code>sheet12.Range(\"B1\").End(xlDown).Offset(1, 0).Value = l\n</code></pre>\n\n<hr>\n\n<p>However, as pointed out in comments by @Lowpar, it is better to use <code>End(xlUp)</code> when trying to find the last used row in a column, so that would be better written as:</p>\n\n<pre><code>sheet12.Range(\"B\" &amp; sheet12.Rows.Count).End(xlUp).Offset(1, 0).Value = l\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 47542024, "answer_count": 1, "score": 0, "last_activity_date": 1511908190, "creation_date": 1511907005, "question_id": 47541751, "link": "https://stackoverflow.com/questions/47541751/referencing-outside-sheets-in-module-subscript-out-of-range", "title": "Referencing Outside Sheets in Module - Subscript out of Range", "body": "<p>I'm trying to create a macro such that any time a cell in column M of sheet2 is changed to \"Special\", the row number of that cell is copied into the first blank cell in column B of Sheet12.  Here's what I have so far, currently in Sheet2:</p>\n\n<pre><code>If Target.column = 13 Then\n\n    Dim l As Integer\n\n    With Sheet2\n\n        For l = 3 To 1000\n            If .Cells(l, 13) = \"Special\" Then\n                Worksheets(\"sheet12\").Range(\"B1\").End(xlDown).Offset(1, 0).Value = l\n            End If\n        Next\n\n    End With\n\nEnd If\n</code></pre>\n\n<p>Right now I'm getting a Run-Time error '9': Subscript out of range for line <code>Worksheets(\"sheet12\").Range(\"B1\").End(xlDown).Offset(1, 0).Value = l</code>, but I'm not sure what to change after trying several iterations with the same error.  I know that there are several other questions referring to this type of error, but I couldn't find any that helped with this specific script.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1511907101, "post_id": 47541746, "comment_id": 82040738, "body": "Welcome to Stack Overflow. This is not a code/SQL/regex writing service, where you post a list of your requirements and language of choice and a code monkey churns out code for you. We&#39;re more than happy to help, but we expect you to make an effort to solve the problem yourself first. Once you&#39;ve done so, you can explain the problem you&#39;re having, include the <b>relevant</b> portions of your work, and ask a specific question, and we&#39;ll try to help. Good luck."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511909166, "post_id": 47541746, "comment_id": 82041549, "body": "So if cell A3 contained &quot;Leelee&quot; and A4 contained &quot;Lee&quot;, should A3 be changed to be just &quot;Lee&quot;?  i.e. is case and/or embedded space significant?  And if cell A5 contained &quot;Lee Anne&quot;, should it be left unchanged, or changed to &quot;Anne&quot;, or changed to &quot;Lee&quot;?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1511980043, "post_id": 47541746, "comment_id": 82076471, "body": "Judging by the code, the fact that A2 (and D3) contain &quot;John&quot; has got nothing to do with the question - you are simply trying to remove any duplicated words within each individual cell.  So if A1 had &quot;John John&quot; and A2 had &quot;Mary&quot; (and even if &quot;John&quot; exists in no other cell in the spreadsheet) you would still want A1 to become &quot;John&quot;.  Is that correct?"}, {"owner": {"reputation": 13, "user_id": 9022406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01399dbd950c1a7e515b9fb372186c6c?s=128&d=identicon&r=PG&f=1", "display_name": "Cell", "link": "https://stackoverflow.com/users/9022406/cell"}, "edited": false, "score": 0, "creation_date": 1512023011, "post_id": 47541746, "comment_id": 82091764, "body": "Yes that is correct. I only want to remove words duplicated inside each individual cell."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9022406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01399dbd950c1a7e515b9fb372186c6c?s=128&d=identicon&r=PG&f=1", "display_name": "Cell", "link": "https://stackoverflow.com/users/9022406/cell"}, "edited": false, "score": 0, "creation_date": 1512041878, "post_id": 47568447, "comment_id": 82101949, "body": "This worked like a charm! I salute you sir! Thank you"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1512028536, "creation_date": 1512028536, "answer_id": 47568447, "question_id": 47541746, "link": "https://stackoverflow.com/questions/47541746/delete-duplicates-in-excel-spreadsheet/47568447#47568447", "title": "Delete duplicates in Excel spreadsheet", "body": "<p>As you say, your only problem appears to be the handling of cells which are empty.  That can easily be overcome by simply not processing any cells where the cell doesn't contain a space:</p>\n\n<pre><code>Sub Remove_DupesInString()\n    'this loops through the specified range and erases duplicates\n    Dim starval As String\n    Dim finval As String\n    Dim strarray() As String\n    Dim x As Long\n    Dim y As Long\n    Dim k As Long\n    ' step through each cell in range\n\n    For Each cell In Sheets(5).Range(\"D2:D6507\")\n        finval = \"\" ' erase final value\"\n\n        starval = cell.Value\n        strarray = Split(starval, \" \") 'Seperator is space\n        If UBound(strarray) &gt; LBound(strarray) Then 'i.e. there was a space\n            'Step through length of string and look for duplicate\n            For rw = 0 To UBound(strarray)\n                For k = rw + 1 To UBound(strarray)\n                    If Trim(strarray(k)) = Trim(strarray(rw)) Then\n                        strarray(k) = \"\"  'if duplicate clear array value\n                    End If\n                Next k\n            Next rw\n            ' combine all value in string less duplicate\n            For x = 0 To UBound(strarray)\n                If strarray(x) &lt;&gt; \"\" Then\n                    finval = finval &amp; Trim(strarray(x)) &amp; \", \"\n                End If\n            Next x\n            ' remove last space and comma\n            finval = Trim(finval)\n            finval = Left(finval, Len(finval) - 1)\n            ' Replaces cells with new values\n            cell.Value = finval\n        End If    \n    Next cell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9022406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01399dbd950c1a7e515b9fb372186c6c?s=128&d=identicon&r=PG&f=1", "display_name": "Cell", "link": "https://stackoverflow.com/users/9022406/cell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 47568447, "answer_count": 1, "score": -2, "last_activity_date": 1512028536, "creation_date": 1511906979, "last_edit_date": 1531161705, "question_id": 47541746, "link": "https://stackoverflow.com/questions/47541746/delete-duplicates-in-excel-spreadsheet", "title": "Delete duplicates in Excel spreadsheet", "body": "<p>I'm looking for some sort of macro that deletes duplicate words within cells in a spreadsheet.</p>\n\n<p>For instance, if cell A1 = \"John John\" I would like my macro to delete the duplicate \"John\". In other words A1 will become \"John\".</p>\n\n<p>I have found a set of code that I have tweaked to some degree to fit my needs:</p>\n\n<pre><code>Sub Remove_DupesInString()\n\n'this loops through the specified range and erases duplicates\n\n\nDim starval As String\nDim finval As String\nDim strarray() As String\nDim x As Long\nDim y As Long\nDim k As Long\n' step through each cell in range\n\nFor Each cell In Sheets(5).Range(\"D2:D6507\")\n\n            Erase strarray ' erase array\n            finval = \"\" ' erase final value\"\n\n\n            starval = cell.Value\n\n            strarray = Split(starval, \" \") 'Seperator is space\n\n            'Step through length of string and look for duplicate\n            For rw = 0 To UBound(strarray)\n\n                        For k = rw + 1 To UBound(strarray)\n                                If Trim(strarray(k)) = Trim(strarray(rw)) Then\n                                strarray(k) = \"\"  'if duplicate clear array value\n                                End If\n                         Next k\n            Next rw\n            ' combine all value in string less duplicate\n            For x = 0 To UBound(strarray)\n            If strarray(x) &lt;&gt; \"\" Then\n\n            finval = finval &amp; Trim(strarray(x)) &amp; \", \"\n            End If\n\n            Next x\n             ' remove last space and comma\n             finval = Trim(finval)\n             finval = Left(finval, Len(finval) - 1)\n             ' Replaces cells with new values\n             cell.Value = finval\n\nNext cell\n\nEnd Sub\n</code></pre>\n\n<p>This set of code is sensitive to blank spaces in each cell. If, in cell D2, I have \"John John\" and in cell D3 have \"Mary\" it will produce the following:</p>\n\n<p>D2 = \"John\", D3 = \"Mary\"</p>\n\n<p>It does not seem to work, however, if I have blank cells in the column I'm running my macro in. I have worked around this issue by sorting on the cells with data inside them and only running my macro in this range.\nI've tried tweaking the code further by adding different <code>If</code> cases with <code>isEmpty()</code>. My initial thought was that the the code above would only be executed <code>If not isEmpty() Then</code> but I've had no luck here. I'm not quite sure what to put inside the <code>isEmpty</code> function. Any ideas?</p>\n"}]