[{"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4794222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6585e1951e7cb6dc48266f8407b3440?s=128&d=identicon&r=PG&f=1", "display_name": "EaterOfFromage", "link": "https://stackoverflow.com/users/4794222/eateroffromage"}, "edited": false, "score": 0, "creation_date": 1429202958, "post_id": 29663426, "comment_id": 47499441, "body": "I tried this (slightly modified, changed the ends of the For loops to 500 and 2, respectively), but I get an error of Error &#39;91&#39;: Object variable or With block variable not set&quot; at &quot;If Day(CDate(TargetDay.Cells(row, col).Value)) = DayNum Then&quot;  Also, with 500 rows and 2 columns like, will this cause the function to be heavily resource intensive?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 23, "user_id": 4794222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6585e1951e7cb6dc48266f8407b3440?s=128&d=identicon&r=PG&f=1", "display_name": "EaterOfFromage", "link": "https://stackoverflow.com/users/4794222/eateroffromage"}, "edited": false, "score": 0, "creation_date": 1429224867, "post_id": 29663426, "comment_id": 47511706, "body": "@EaterOfFromage - Unfortunately I can&#39;t replicate an error 91 at all with the code above, even if I intentionally over-run the bounds of the Range (see next comment).  The only error I could coax out was an error 13 (type mismatch) if I put data that couldn&#39;t be cast to a Date inside the target range (fixed above). Did your change effect this line: <code>Set TargetDay = ActiveWorkbook.Sheets(&quot;3-2015&quot;).Range(&quot;A1:B440&quot;)</code>?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 23, "user_id": 4794222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6585e1951e7cb6dc48266f8407b3440?s=128&d=identicon&r=PG&f=1", "display_name": "EaterOfFromage", "link": "https://stackoverflow.com/users/4794222/eateroffromage"}, "edited": false, "score": 0, "creation_date": 1429225006, "post_id": 29663426, "comment_id": 47511742, "body": "@EaterOfFromage - Regarding the For loops - the bounds of the range get set with &quot;A1:B440&quot;, so there isn&#39;t any reason to hard code the loop conditions - with <code>.Rows.Count</code> and <code>.Columns.Count</code> it will traverse whatever range you put in the <code>Set TargetDay</code> line."}, {"owner": {"reputation": 23, "user_id": 4794222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6585e1951e7cb6dc48266f8407b3440?s=128&d=identicon&r=PG&f=1", "display_name": "EaterOfFromage", "link": "https://stackoverflow.com/users/4794222/eateroffromage"}, "edited": false, "score": 0, "creation_date": 1429225130, "post_id": 29663426, "comment_id": 47511791, "body": "I finally got this to work! I had some issues for a while with types being mismatched (The cells in Columns A and B were a mix of Dates, Text, Times, and Blanks). I also realized I&#39;d been misleading in my language, the DayNum variable was in DateValue format, so I had to compare DayNum to DateValue(TargetDay.Cells(row,col).Value)). Thanks for taking me down the right path though, works like a charm now!"}, {"owner": {"reputation": 23, "user_id": 4794222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6585e1951e7cb6dc48266f8407b3440?s=128&d=identicon&r=PG&f=1", "display_name": "EaterOfFromage", "link": "https://stackoverflow.com/users/4794222/eateroffromage"}, "edited": false, "score": 0, "creation_date": 1429225294, "post_id": 29663426, "comment_id": 47511862, "body": "Oh sorry, just missed your comments. I realized the error 91 was a silly error I made, I commented out the Set TargetDay line by accident. And thanks for the tip on the .Rows.Count, that makes sense now."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 23, "user_id": 4794222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6585e1951e7cb6dc48266f8407b3440?s=128&d=identicon&r=PG&f=1", "display_name": "EaterOfFromage", "link": "https://stackoverflow.com/users/4794222/eateroffromage"}, "edited": false, "score": 0, "creation_date": 1429225713, "post_id": 29663426, "comment_id": 47511995, "body": "@EaterOfFromage - Glad it worked for you - I missed your question about performance above - I tested it with 10,000 rows and no matches, still finished in milliseconds."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 0, "last_activity_date": 1429224615, "last_edit_date": 1429224615, "creation_date": 1429145001, "answer_id": 29663426, "question_id": 29663034, "link": "https://stackoverflow.com/questions/29663034/range-find-on-dates-with-custom-number-format/29663426#29663426", "title": "Range.Find on Dates with custom number format", "body": "<p>A bit unclear from the question, so I'm assuming that you have a number in cell I1 and you want to find the first cell with on the same day of the month.  Assuming that's the case, you can just loop through the range and compare against the day directly:</p>\n\n<pre><code>Sub Find_Target()\n    Dim DayNum As Long\n    Dim TargetDay As Range\n    Dim found As Range\n\n    DayNum = Cells(1, 9)\n\n    Set TargetDay = ActiveWorkbook.Sheets(\"3-2015\").Range(\"A1:B440\")\n\n    Dim row As Long, col As Long\n    For row = 1 To TargetDay.Rows.Count\n        For col = 1 To TargetDay.Columns.Count\n            If IsDate(TargetDay.Cells(row, col).Value) Then\n                If Day(CDate(TargetDay.Cells(row, col).Value)) = DayNum Then\n                    Set found = TargetDay.Cells(row, col)\n                    Exit For\n                End If\n            End If\n        Next col\n        If Not found Is Nothing Then Exit For\n    Next row\n\n    If found Is Nothing Then\n        MsgBox \"Nothing found!\"\n    Else\n        found.Select\n    End If\nEnd Sub\n</code></pre>\n\n<p>If I1 is something else, it should be trivial to modify - the key is explicitly treating the cell values as dates in VBA.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 4794222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6585e1951e7cb6dc48266f8407b3440?s=128&d=identicon&r=PG&f=1", "display_name": "EaterOfFromage", "link": "https://stackoverflow.com/users/4794222/eateroffromage"}, "edited": false, "score": 0, "creation_date": 1429202553, "post_id": 29663555, "comment_id": 47499188, "body": "I tried this solution and found that they all returned nothing. It doesn&#39;t seem like changing the data type makes any difference to the result. I tried sDayNum = Format(Cells(1, 9), &quot;mm/dd/yyyy&quot;) as sDayNum = Format(Cells(1, 9), &quot;dddd&quot;) and had no results found either."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 23, "user_id": 4794222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6585e1951e7cb6dc48266f8407b3440?s=128&d=identicon&r=PG&f=1", "display_name": "EaterOfFromage", "link": "https://stackoverflow.com/users/4794222/eateroffromage"}, "edited": false, "score": 0, "creation_date": 1429217875, "post_id": 29663555, "comment_id": 47508660, "body": "@EaterOfFromage - If that didn&#39;t work for you then I strongly suspect that the dates may actually be datetimes, all with different times which essentially changes their value. Honestly, I do test thoroughly before posting. See <a href=\"https://dl.dropboxusercontent.com/u/100009401/Find_dddd_from_General.xlsb\" rel=\"nofollow noreferrer\">this</a> for my sample."}, {"owner": {"reputation": 23, "user_id": 4794222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6585e1951e7cb6dc48266f8407b3440?s=128&d=identicon&r=PG&f=1", "display_name": "EaterOfFromage", "link": "https://stackoverflow.com/users/4794222/eateroffromage"}, "edited": false, "score": 0, "creation_date": 1429222692, "post_id": 29663555, "comment_id": 47510954, "body": "Oh! I didn&#39;t think it would make a difference, but I think the problem may be that the cells with dates in them are determined with a formula. Not all of the cells in that column are though. So LookIn:=xlFormulas may be getting confused on my sheet."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 23, "user_id": 4794222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6585e1951e7cb6dc48266f8407b3440?s=128&d=identicon&r=PG&f=1", "display_name": "EaterOfFromage", "link": "https://stackoverflow.com/users/4794222/eateroffromage"}, "edited": false, "score": 0, "creation_date": 1429224174, "post_id": 29663555, "comment_id": 47511455, "body": "@EaterOfFromage - If the dates are returned by formula then you will have to use a string type var formatted as <i>dddd</i> and <code>LookIn:=xlValues</code>. Revist my sample link for a second <code>Find_Target2</code> as example. Obviously, the problem with this would be more than a single week&#39;s worth of data as you would have two or more possible matches depending on the number of weeks involved. You might want to try a VBA-based single column Vlookup or Index/Match instead."}, {"owner": {"reputation": 23, "user_id": 4794222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6585e1951e7cb6dc48266f8407b3440?s=128&d=identicon&r=PG&f=1", "display_name": "EaterOfFromage", "link": "https://stackoverflow.com/users/4794222/eateroffromage"}, "edited": false, "score": 0, "creation_date": 1429225628, "post_id": 29663555, "comment_id": 47511980, "body": "I managed to sort it out with Comintern&#39;s solution and some modifcations. My first time on the site or really collaborated with anyone about VBA, so I clearly have a few things to learn about how to phrase things and what qualifies as important haha. Thanks!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1429145980, "creation_date": 1429145980, "answer_id": 29663555, "question_id": 29663034, "link": "https://stackoverflow.com/questions/29663034/range-find-on-dates-with-custom-number-format/29663555#29663555", "title": "Range.Find on Dates with custom number format", "body": "<p>You need to <code>.Find</code> for <code>LookAt:=xlFormulas</code> and look for a Date type var, not a Long. Throw the following at your data.</p>\n\n<pre><code>Sub Find_Target()\n    Dim iDayNum As Long, sDayNum As String, dDayNum As Date\n    Dim foundI As Variant, foundS As Variant, foundD As Variant\n    Dim TargetDay As Range\n\n    iDayNum = Cells(1, 9)\n    sDayNum = Format(Cells(1, 9), \"mm/dd/yyyy\")\n    dDayNum = Cells(1, 9)  'I might even use CDate(Cells(1, 9).Value) as a reminder\n\n    Set TargetDay = ActiveWorkbook.Sheets(\"3-2015\").Range(\"A1:B440\")\n\n    Set foundI = TargetDay.Find(iDayNum, LookIn:=xlFormulas, LookAt:=xlWhole)\n    Set foundS = TargetDay.Find(sDayNum, LookIn:=xlFormulas, LookAt:=xlWhole)\n    Set foundD = TargetDay.Find(dDayNum, LookIn:=xlFormulas, LookAt:=xlWhole)\n\n    If foundI Is Nothing Then\n        MsgBox \"As a Long - Nothing found!\"\n    Else\n        MsgBox \"As a Long - Found!\"\n    End If\n    If foundS Is Nothing Then\n        MsgBox \"As a String - Nothing found!\"\n    Else\n        MsgBox \"As a String - Found!\"\n    End If\n    If foundD Is Nothing Then\n        MsgBox \"As a Date - Nothing found!\"\n    Else\n        MsgBox \"As a Date - Found!\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>You should have no problem finding the matching date var no matter whether it is formatted as <em>dddd</em> or anything else.</p>\n"}], "owner": {"reputation": 23, "user_id": 4794222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6585e1951e7cb6dc48266f8407b3440?s=128&d=identicon&r=PG&f=1", "display_name": "EaterOfFromage", "link": "https://stackoverflow.com/users/4794222/eateroffromage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "accepted_answer_id": 29663426, "answer_count": 2, "score": 2, "last_activity_date": 1429319933, "creation_date": 1429142314, "last_edit_date": 1429319933, "question_id": 29663034, "link": "https://stackoverflow.com/questions/29663034/range-find-on-dates-with-custom-number-format", "title": "Range.Find on Dates with custom number format", "body": "<p>Here's the relevant parts of my code I'm having trouble with.</p>\n\n<pre><code>Sub Find_Target()\n\nDim DayNum As Long\nDim TargetName As String\nDim TargetDay As Range\nDim found As Variant\n\nDayNum = Cells(1, 9)\n\nSet TargetDay = ActiveWorkbook.Sheets(\"3-2015\").Range(\"A1:B440\")\nTargetDay.Activate\n\nSet found = TargetDay.Find(DayNum, LookIn:=xlValues)\n\nIf found Is Nothing Then\n    MsgBox \"Nothing found!\"\nElse\n    TargetDay.Select\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Column A contains a mix of merged and unmerged cells. Cells(1, 9) contains a date in general format. Periodically in column A/B will be a merged cell containing that same number, but in custom number format \"dddd\". The find command works if I change the number format to general, but otherwise found is Nothing.</p>\n\n<p>I've tried playing with the FindFormat option, but didn't have any luck there. </p>\n"}, {"tags": ["excel", "visual-c++", "c++-cli", "vba"], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 3042785, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1e697ebc9fb73efdb72a72ef4b9da210?s=128&d=identicon&r=PG&f=1", "display_name": "WizzleWuzzle", "link": "https://stackoverflow.com/users/3042785/wizzlewuzzle"}, "edited": false, "score": 0, "creation_date": 1429201314, "post_id": 29671816, "comment_id": 47498258, "body": "That did not fix the problem."}], "tags": [], "owner": {"reputation": 62, "user_id": 4729191, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JG9Eu.png?s=128&g=1", "display_name": "ExceptionalHandler", "link": "https://stackoverflow.com/users/4729191/exceptionalhandler"}, "is_accepted": false, "score": 1, "last_activity_date": 1429179657, "creation_date": 1429179657, "answer_id": 29671816, "question_id": 29662127, "link": "https://stackoverflow.com/questions/29662127/bstr-value-not-being-returned-correctly-to-excel-from-c-cli-dll/29671816#29671816", "title": "BSTR value not being returned correctly to Excel from C++/CLI DLL", "body": "<p>Writing an intermediate function in your excel's VBA which calls the exported GetData function should fix the problem. \nSomething like:</p>\n\n<pre><code>Private Declare Function GetData Lib \"getpdata.dll\" (ByRef year As Double, ByRef month As Double, ByRef uid As Byte, ByRef pwd As Byte) As String\n\nFunction GetDataEx(ByRef year As Double, ByRef month As Double, ByRef uid As Byte, ByRef pwd As Byte) As String\n     GetDataEx = GetData(year, month, uid, pwd)\nEnd Function\n</code></pre>\n\n<p>In your excel, use the intermediate function in place of the original exported one.  </p>\n"}, {"tags": [], "owner": {"reputation": 145, "user_id": 3042785, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1e697ebc9fb73efdb72a72ef4b9da210?s=128&d=identicon&r=PG&f=1", "display_name": "WizzleWuzzle", "link": "https://stackoverflow.com/users/3042785/wizzlewuzzle"}, "is_accepted": true, "score": 1, "last_activity_date": 1429210418, "creation_date": 1429210418, "answer_id": 29683584, "question_id": 29662127, "link": "https://stackoverflow.com/questions/29662127/bstr-value-not-being-returned-correctly-to-excel-from-c-cli-dll/29683584#29683584", "title": "BSTR value not being returned correctly to Excel from C++/CLI DLL", "body": "<p>Ok, I had been using the Excel VBA MsgBox function to read the string returned from the DLL while I have been writing the DLL. I was unaware until now that MsgBox has a limit of 1024 characters and simply ignores characters after that. The full string is actually being returned, but I was assuming the MsgBox was displaying its full length (as I have been having trouble all along getting more than the first 230 characters of data).</p>\n"}], "owner": {"reputation": 145, "user_id": 3042785, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1e697ebc9fb73efdb72a72ef4b9da210?s=128&d=identicon&r=PG&f=1", "display_name": "WizzleWuzzle", "link": "https://stackoverflow.com/users/3042785/wizzlewuzzle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 519, "favorite_count": 0, "accepted_answer_id": 29683584, "answer_count": 2, "score": 1, "last_activity_date": 1429210526, "creation_date": 1429137412, "last_edit_date": 1531164843, "question_id": 29662127, "link": "https://stackoverflow.com/questions/29662127/bstr-value-not-being-returned-correctly-to-excel-from-c-cli-dll", "title": "BSTR value not being returned correctly to Excel from C++/CLI DLL", "body": "<p>I am writing a C++CLI DLL in Visual Studio 2010 which I expect to return a string to Excel VBA:</p>\n\n<pre><code>    BSTR __stdcall fnGetData (const double *yr, const double *mon, const char *uid, const char *pwd)\n</code></pre>\n\n<p>I have the function working, except that the string ends up getting truncated when returned to Excel. Both the MessageBoxA calls in the code below display correct data (all 8760 characters in a giant messagebox dialog) but the resulting MsgBox in Excel displays only the first 998 characters of those 8760. The entire code block of this function is as follows:</p>\n\n<pre><code>    BSTR __stdcall fnGetData (const double *yr, const double *mon, const char *uid, const char *pwd) {\n        //convert Excel ByRef arguments to useable values\n        string userid(uid);\n        string passwd(pwd);\n        int year = *yr;\n        int month = *mon;\n\n        //transform user and pwd to String\n        System::String ^ UserName = gcnew String(userid.c_str());\n        System::String ^ PassWord = gcnew String(passwd.c_str());\n\n        //call the HTTPWebRequest/Response function on the class\n        htGetData2 ^ h2 = gcnew htGetData2();\n        const char* vCharArray = h2-&gt;GetStuff(year, month, UserName, PassWord);\n        //up to this point everything has worked fine\n        MessageBoxA(0, vCharArray, \"hi1 from fnGetData\", MB_OK | MB_ICONINFORMATION);\n        int retValLen = char_traits&lt;char&gt;::length(vCharArray);\n        //retValLen is 8760\n        BSTR retVal = SysAllocStringByteLen(vCharArray, retValLen);\n        int retValLen2 = SysStringLen(retVal);\n        //retValLen2 is 4380\n        MessageBoxA(0, (LPCSTR)retVal, \"hi2 from fnGetData\", MB_OK | MB_ICONINFORMATION);\n        return retVal;\n    }\n</code></pre>\n\n<p>What am I doing wrong that the BSTR/String in Excel is not the full contents of the data in the vCharArray string? I am not using ATL or MFC, should I retry using those?</p>\n\n<p>The Excel VBA call is:</p>\n\n<pre><code>    Private Declare Function GetData Lib \"getpdata.dll\" (ByRef year As Double, ByRef month As Double, ByRef uid As Byte, ByRef pwd As Byte) As String\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2787, "user_id": 3371361, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e3e2ae2a44ba090e17cca4953dfc73e2?s=128&d=identicon&r=PG", "display_name": "Matt D. Webb", "link": "https://stackoverflow.com/users/3371361/matt-d-webb"}, "edited": false, "score": 0, "creation_date": 1429136280, "post_id": 29661897, "comment_id": 47463387, "body": "What have you tried? Please can you provide some code you have attempted yourself."}, {"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "reply_to_user": {"reputation": 2787, "user_id": 3371361, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e3e2ae2a44ba090e17cca4953dfc73e2?s=128&d=identicon&r=PG", "display_name": "Matt D. Webb", "link": "https://stackoverflow.com/users/3371361/matt-d-webb"}, "edited": false, "score": 0, "creation_date": 1429136628, "post_id": 29661897, "comment_id": 47463521, "body": "added code I have tried."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1429139309, "post_id": 29661897, "comment_id": 47464454, "body": "There are many answers to this now, it would be a good idea to try them all and maybe time them then mark the winner as the accepted answer."}, {"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 0, "creation_date": 1429139554, "post_id": 29661897, "comment_id": 47464543, "body": "So many good answers!!! Thanks guys. I am not sure which one I will choose just yet but I will check mark one of these when I make up my mind. Thanks again."}], "answers": [{"comments": [{"owner": {"reputation": 2787, "user_id": 3371361, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e3e2ae2a44ba090e17cca4953dfc73e2?s=128&d=identicon&r=PG", "display_name": "Matt D. Webb", "link": "https://stackoverflow.com/users/3371361/matt-d-webb"}, "edited": false, "score": 0, "creation_date": 1429137618, "post_id": 29662126, "comment_id": 47463869, "body": "Only just seen your update regarding string variable,"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 1, "creation_date": 1429138952, "post_id": 29662126, "comment_id": 47464319, "body": "Matt you can shorten your code like this:  Dim MyArray as variant  MyArray = Array(43,83,87,91,92,93,98)"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1429139175, "post_id": 29662126, "comment_id": 47464410, "body": "FYI, It was only on the same line for me because it was in a comment, it&#39;s fine as it is but I prefer personally to not use the : and have those two commands on seperate lines. Personal preference, makes no difference to the code though :)"}], "tags": [], "owner": {"reputation": 2787, "user_id": 3371361, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e3e2ae2a44ba090e17cca4953dfc73e2?s=128&d=identicon&r=PG", "display_name": "Matt D. Webb", "link": "https://stackoverflow.com/users/3371361/matt-d-webb"}, "is_accepted": false, "score": 1, "last_activity_date": 1429139090, "last_edit_date": 1429139090, "creation_date": 1429137403, "answer_id": 29662126, "question_id": 29661897, "link": "https://stackoverflow.com/questions/29661897/loop-through-all-numbers-in-a-range-except-a-few/29662126#29662126", "title": "Loop through all numbers in a range except a few", "body": "<p>This is a very crude example but with solve your problem:</p>\n\n<pre><code>Sub ArrayLoopExample()\n\nDim MyArray As Variant: MyArray = Array(43, 83, 87, 91, 92, 93, 98)\n\nFor i = 1 To 99\n    For x = LBound(MyArray) To UBound(MyArray)\n\n        If i = MyArray(x) Then\n\n        'Skip\n\n        Else\n\n        'Some code\n\n        End If\n\n    Next x\nNext i\n\nEnd Sub\n</code></pre>\n\n<p><strong>UPDATE</strong> as per comments below.</p>\n"}, {"comments": [{"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 0, "creation_date": 1429138137, "post_id": 29662133, "comment_id": 47464051, "body": "Clever but I have a question, when i reaches the  number 8 for example  wouldn&#39;t it find &quot;8&quot; in the string and replace it with blank causing the string lengths to not be equal and then fail ?"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 0, "creation_date": 1429138342, "post_id": 29662133, "comment_id": 47464114, "body": "It wraps them in commas to counter this, it doesn&#39;t look for 8 in the string, it looks for ,8, in the string which has had a comma put on the start and end :)."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 0, "creation_date": 1429139040, "post_id": 29662133, "comment_id": 47464353, "body": "If it &quot;doesn&#39;t&quot; find the number the string length is the same which allows it to enter the routine."}, {"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 1, "creation_date": 1429299992, "post_id": 29662133, "comment_id": 47551901, "body": "Winner, winner chicken dinner. I used this. Thank you. I am glad I caught that error and that after my first comment you were able to change it into something that would work for all of my intended uses. Thanks again for making this and thanks again for the quick update and error fix.  :)"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 0, "creation_date": 1429501295, "post_id": 29662133, "comment_id": 47611032, "body": "Glad I could help you :)."}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": true, "score": 1, "last_activity_date": 1429138835, "last_edit_date": 1429138835, "creation_date": 1429137431, "answer_id": 29662133, "question_id": 29661897, "link": "https://stackoverflow.com/questions/29661897/loop-through-all-numbers-in-a-range-except-a-few/29662133#29662133", "title": "Loop through all numbers in a range except a few", "body": "<p>Throw i substituted with nothing at the string length and compare:</p>\n\n<pre><code>Sub LoopSkip()\n     Dim NotUse As String\n     NotUse = \"41,83,87,91,92,93,98\"\n     For i = 1 To 99\n        If Len(\",\" &amp; NotUse &amp; \",\") = Len(Replace(\",\" &amp; NotUse &amp; \",\", \",\" &amp; i &amp; \",\", \"\")) Then\n             'Do Stuff\n         End If\n     Next i\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1429139288, "post_id": 29662166, "comment_id": 47464451, "body": "Filter is available in VBA.  Only problem is that it matches sub-strings and skips 2, 4, and 7 for some reason."}], "tags": [], "owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "is_accepted": false, "score": 1, "last_activity_date": 1429137600, "creation_date": 1429137600, "answer_id": 29662166, "question_id": 29661897, "link": "https://stackoverflow.com/questions/29661897/loop-through-all-numbers-in-a-range-except-a-few/29662166#29662166", "title": "Loop through all numbers in a range except a few", "body": "<p>Smaller code perhaps. If this is useful. </p>\n\n<pre><code>not_use = Split(\"41,83,87,91,92,93,98\",\",\")\nFor i = 1 To 99\n    If UBound(Filter(not_use,CStr(i))) Then MsgBox i\nNext\n</code></pre>\n\n<p>Just realized you were asking for VBA and not VBScript. My bad.</p>\n"}, {"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1429137921, "post_id": 29662175, "comment_id": 47463981, "body": "Jorge, I&#39;ve amended the code formatting in your answer - for future reference, you can highlight the code block and press the <code>{}</code> button in the text editor to do this for you."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1429145042, "post_id": 29662175, "comment_id": 47466217, "body": "Probably the simplest logic to follow."}], "tags": [], "owner": {"reputation": 61, "user_id": 4794112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da15f804a345608093b4cb578ab2724b?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Zald&#237;var", "link": "https://stackoverflow.com/users/4794112/jorge-zald%c3%advar"}, "is_accepted": false, "score": 6, "last_activity_date": 1429138646, "last_edit_date": 1429138646, "creation_date": 1429137627, "answer_id": 29662175, "question_id": 29661897, "link": "https://stackoverflow.com/questions/29661897/loop-through-all-numbers-in-a-range-except-a-few/29662175#29662175", "title": "Loop through all numbers in a range except a few", "body": "<p>You can specify the values to ignore in a more compact way than with your <code>If</code> statements using <code>Select Case</code>:</p>\n\n<pre><code>For i = 1 To 99\n  Select Case i\n  Case 41, 83, 87, 91, 92, 93, 98\n    'Do nothing\n  Case Else\n    'Do stuff\n  End Select\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1429145562, "post_id": 29662216, "comment_id": 47466343, "body": "@brettdj cheers :) I&#39;m a big believer in &quot;don&#39;t re-invent the wheel&quot; so if there&#39;s already a worksheet function to do the job (and it&#39;s quicker), I&#39;ll try and incorporate that somewhere."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 1, "creation_date": 1429146340, "post_id": 29662216, "comment_id": 47466565, "body": "I think <code>Not</code> is redundant but nonetheless deserves a UV even though I&#39;m not a fan of <code>Evaluate</code> function. :)"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1429146649, "post_id": 29662216, "comment_id": 47466649, "body": "@L42 you are absolutely right. Got carried away there, I shall edit and remove the oxymoron at once! However I think the <code>Evaluate</code> method is greatly underrated in VBA and can often save a lot of time <i>if used effectively</i>"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1429146707, "post_id": 29662216, "comment_id": 47466665, "body": "I use it as well. But not if I can get away with it. Based on experience, result can be unpredictable especially if you are to try to evaluate complex formulas within a complex routine."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1429147311, "post_id": 29662216, "comment_id": 47466818, "body": "@L42 I agree when it comes to complex formulae, I would at that point prefer to use a UDF or something - even if it&#39;s just to avoid having to  build the expression with extensive string concatenation!"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 6, "last_activity_date": 1429167479, "last_edit_date": 1429167479, "creation_date": 1429137782, "answer_id": 29662216, "question_id": 29661897, "link": "https://stackoverflow.com/questions/29661897/loop-through-all-numbers-in-a-range-except-a-few/29662216#29662216", "title": "Loop through all numbers in a range except a few", "body": "<p>You could evaluate an expression with a worksheet formula:</p>\n\n<pre><code>not_use$ = \"43,83,87,91,92,93,98\"\n\nFor i = 1 To 99\n    If Application.Evaluate(\"ISERROR(MATCH(\" &amp; i &amp; \",{\" &amp; not_use &amp; \"},0))\") Then\n        '// Do Something\n    End If\nNext i\n</code></pre>\n\n<p>This means the \"test\" is evaluated in one go rather than using multiple criteria or further loops.</p>\n"}, {"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 1, "last_activity_date": 1429146139, "creation_date": 1429146139, "answer_id": 29663581, "question_id": 29661897, "link": "https://stackoverflow.com/questions/29661897/loop-through-all-numbers-in-a-range-except-a-few/29663581#29663581", "title": "Loop through all numbers in a range except a few", "body": "<p>Just a variation on what above answers already does</p>\n\n<pre><code>Dim not_use As Variant, i As Integer\nnot_use = Array(43, 83, 87, 91, 92, 93, 98) ' create an array\n\nFor i = 1 To 99\n    If IsError(Application.Match(i, not_use, 0)) Then\n        ' do some cool stuff\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6292, "favorite_count": 0, "accepted_answer_id": 29662133, "answer_count": 6, "score": 2, "last_activity_date": 1429167479, "creation_date": 1429136197, "last_edit_date": 1429146579, "question_id": 29661897, "link": "https://stackoverflow.com/questions/29661897/loop-through-all-numbers-in-a-range-except-a-few", "title": "Loop through all numbers in a range except a few", "body": "<p>I need to loop through i = 1 to 99 but I want to skip a few specific i values. \nthe numbers I want to skip are 41,83,87,91,92,93,98</p>\n\n<p>I realize I could nest all my actions inside an <code>i &lt;&gt; 41</code>, or <code>i &lt;&gt; 83</code> etc. \nIsn't there an easier way?  Maybe assign a variable to contain values to skip in a <code>CSL</code> and use <code>Split</code>? I don't know my brain isn't working. Please help. </p>\n\n<pre><code>     For i = 1 To 99\n         If i &lt;&gt; 41 And i &lt;&gt; 83 And i &lt;&gt; 87 And i &lt;&gt; 91 _\n         And i &lt;&gt; 92 And i &lt;&gt; 93 And i &lt;&gt; 98 Then\n             'do stuff\n         End If\n     Next i\n</code></pre>\n\n<p>Would prefer to set up a variable like:</p>\n\n<pre><code>    not_use = \"41,83,87,91,92,93,98\"\n</code></pre>\n\n<p>then have some sort of <code>For i = 1 To 99</code> unless in <code>not_use</code>  but there is no way to write that as far as I know. </p>\n"}, {"tags": ["vba", "button"], "answers": [{"tags": [], "owner": {"reputation": 351, "user_id": 2568841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdbea683b77a6c7dcb78587201def050?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/2568841/dan"}, "is_accepted": true, "score": 0, "last_activity_date": 1429150634, "creation_date": 1429150634, "answer_id": 29664242, "question_id": 29661863, "link": "https://stackoverflow.com/questions/29661863/activating-and-deactivating-a-command-button-based-on-a-cell-value/29664242#29664242", "title": "Activating and deactivating a command button based on a cell value", "body": "<p>The issue here looks to be that the cell value isn't actually changing, which is not triggering the macro.</p>\n\n<p>If you change the macro from a Worksheet_Change to a Selection_Change, this macro will be triggered after every user action.  This should solve your issue.</p>\n\n<p>Use the KeyCells.Value instead of the sheet and change the Button name to something more description.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\nDim KeyCells As Range\nSet KeyCells = Sheet8.Range(\"E15\")\n\nIf KeyCells.Value = TRUE Then \n     CommandButton1.Enabled = True\nElse\n     CommandButton1.Enabled = False\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4794037, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HQIu6NkpmF0/AAAAAAAAAAI/AAAAAAAAABE/2lx3CaOig-Q/photo.jpg?sz=128", "display_name": "Derek", "link": "https://stackoverflow.com/users/4794037/derek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4289, "favorite_count": 0, "accepted_answer_id": 29664242, "answer_count": 1, "score": -1, "last_activity_date": 1429151974, "creation_date": 1429136045, "last_edit_date": 1429151974, "question_id": 29661863, "link": "https://stackoverflow.com/questions/29661863/activating-and-deactivating-a-command-button-based-on-a-cell-value", "title": "Activating and deactivating a command button based on a cell value", "body": "<p>I'm relatively new but learning quickly.  I have a cell (Sheet8.Range(\"E15\")) that produces TRUE or FALSE (boolean) based on other conditions.  My goal is that when this cell = TRUE, the button is active.  If cell value changes to FALSE, I want the button to be inactive.  Thanks for the help!</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim KeyCells As Range\nSet KeyCells = Sheet8.Range(\"E15\")\n\nIf Not Application.Intersect(KeyCells, Range(Target.Address)) Is Nothing Then\n\n      If Sheet8.Range(\"E15\").Value = True Then CommandButton1.Enabled = True\n      If Sheet8.Range(\"E15\").Value = False Then CommandButton1.Enabled = False\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2306, "user_id": 927807, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0b184afc5c92f0c333b8d3ea3be93e85?s=128&d=identicon&r=PG", "display_name": "Lee_Str", "link": "https://stackoverflow.com/users/927807/lee-str"}, "edited": false, "score": 0, "creation_date": 1429198504, "post_id": 29663119, "comment_id": 47496219, "body": "Thank you.  I think this might work, but I&#39;m getting the &quot;1004 &quot;unable to get the object property of the oleobject class&quot;&quot; error.  I can&#39;t seem to locate a fix for this.  Any work-arounds?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 2306, "user_id": 927807, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0b184afc5c92f0c333b8d3ea3be93e85?s=128&d=identicon&r=PG", "display_name": "Lee_Str", "link": "https://stackoverflow.com/users/927807/lee-str"}, "edited": false, "score": 0, "creation_date": 1429223866, "post_id": 29663119, "comment_id": 47511360, "body": "That&#39;s odd.  Is it on this statement: <code>Oo.Object.SaveAs2 temp, 10</code>?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 2306, "user_id": 927807, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0b184afc5c92f0c333b8d3ea3be93e85?s=128&d=identicon&r=PG", "display_name": "Lee_Str", "link": "https://stackoverflow.com/users/927807/lee-str"}, "edited": false, "score": 0, "creation_date": 1429225502, "post_id": 29663119, "comment_id": 47511928, "body": "@Lee_Str - Do you have ActiveX controls enabled?"}, {"owner": {"reputation": 2306, "user_id": 927807, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0b184afc5c92f0c333b8d3ea3be93e85?s=128&d=identicon&r=PG", "display_name": "Lee_Str", "link": "https://stackoverflow.com/users/927807/lee-str"}, "edited": false, "score": 0, "creation_date": 1429303038, "post_id": 29663119, "comment_id": 47553419, "body": "Yes, it is on the  <code>Oo.Object.SaveAs2 temp, 10</code> line.  And yes, my ActiveX controls are enabled.  I&#39;m able to use the Button Control just fine."}, {"owner": {"reputation": 2306, "user_id": 927807, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0b184afc5c92f0c333b8d3ea3be93e85?s=128&d=identicon&r=PG", "display_name": "Lee_Str", "link": "https://stackoverflow.com/users/927807/lee-str"}, "edited": false, "score": 0, "creation_date": 1429446394, "post_id": 29663119, "comment_id": 47593142, "body": "Continued to research this and couldn&#39;t found a fix.  Did some research, and found a similar solution.  Merged two and they now work.  thank you for your help Comintern.  You got me on the right path!"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 2306, "user_id": 927807, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0b184afc5c92f0c333b8d3ea3be93e85?s=128&d=identicon&r=PG", "display_name": "Lee_Str", "link": "https://stackoverflow.com/users/927807/lee-str"}, "edited": false, "score": 0, "creation_date": 1429452877, "post_id": 29663119, "comment_id": 47595324, "body": "@Lee_Str - Just for the benefit of others who find this, what was the solution to the 1004 error?"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 0, "last_activity_date": 1429142856, "creation_date": 1429142856, "answer_id": 29663119, "question_id": 29661666, "link": "https://stackoverflow.com/questions/29661666/vba-to-copy-contents-from-embedded-word-document-and-retain-formatting/29663119#29663119", "title": "VBA to Copy Contents from Embedded Word document and retain formatting", "body": "<p>If getting it into HTML will work (Word makes pretty ugly HTML...), you can just save it to a temp file and then pick it back up:</p>\n\n<pre><code>Sub HTMLExport()\n    Dim Oo As OLEObject\n\n    'Search for the embedded Word document\n    For Each Oo In Sheet8.OLEObjects\n        If InStr(1, Oo.progID, \"Word.Document\", vbTextCompare) &gt; 0 Then\n            Dim temp As String\n            'GetSpecialFolder(2) gives the user's temp folder.\n            temp = CreateObject(\"Scripting.FileSystemObject\").GetSpecialFolder(2) &amp; \"\\temp.html\"\n            '10 = wdFormatFilteredHTML\n            Oo.Object.SaveAs2 temp, 10\n\n            'Copy the file contents into cell M1...\n            Dim handle As Integer\n            handle = FreeFile\n            Open temp For Input As handle\n            Sheet8.Range(\"M1\").Value = Input$(LOF(handle), handle)\n            Close handle\n            '...and delete the temp file.\n            Kill temp\n\n            'Select any cell to close the document\n            Sheet8.Range(\"M1\").Select\n            'Done\n            Exit For\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>Note that if you're using this method, you can't open the embedded Word document after you get the OLEObject or Word won't allow you to save it.</p>\n"}], "owner": {"reputation": 2306, "user_id": 927807, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0b184afc5c92f0c333b8d3ea3be93e85?s=128&d=identicon&r=PG", "display_name": "Lee_Str", "link": "https://stackoverflow.com/users/927807/lee-str"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1532, "favorite_count": 0, "accepted_answer_id": 29663119, "answer_count": 1, "score": 0, "last_activity_date": 1429446613, "creation_date": 1429135135, "last_edit_date": 1429446613, "question_id": 29661666, "link": "https://stackoverflow.com/questions/29661666/vba-to-copy-contents-from-embedded-word-document-and-retain-formatting", "title": "VBA to Copy Contents from Embedded Word document and retain formatting", "body": "<p>I'm using <code>Excel 2010</code> with an embedded Word Document.  The Word document is basically a communication template with some formatting (bold / underline / hyperlinks).</p>\n\n<p><strong>Process:</strong>  User opens Excel Document, provides inputs to Excel, and completes template.  There is no interaction between the inputs in Excel and the contents of the template.</p>\n\n<p>I'm trying to build out this process such that once they edit the <code>embedded Word Document</code> the user hits a <code>button</code>. The <code>VBA</code> code would then take the contents of the <code>embedded Word document</code> and paste (formatting and all) it as the body of the email.  The file would attach itself to that email, and off it would go for approval.</p>\n\n<p>I've been able to locate code to get me part of the way there, and to give props where props are due, I located the code <a href=\"http://answers.microsoft.com/en-us/office/forum/office_2007-customize/how-do-i-copy-from-an-embedded-word-object-with-a/ee2b3cce-3171-4b58-9b08-75606ac6e5be\" rel=\"nofollow\">here</a> (see below for the code)</p>\n\n<p>But this doesn't retain the Word Document's Formatting.  Any recommendations?  Maybe if I could extract the Word contents as HTML that would work.  But not sure how to do that.  All help appreciated.</p>\n\n<pre><code>Sub Test()\n  Dim Oo As OLEObject\n  Dim wDoc As Object 'Word.Document\n\n  'Search for the embedded Word document\n  For Each Oo In Sheet8.OLEObjects\n    If InStr(1, Oo.progID, \"Word.Document\", vbTextCompare) &gt; 0 Then\n        'Open the embedded document\n        Oo.Verb xlVerbPrimary\n        'Get the document inside\n        Set wDoc = Oo.Object\n\n        'Copy the contents to cell A1\n        wDoc.Content.Copy\n        With Sheet8.Range(\"M1\")\n            .PasteSpecial xlPasteFormats\n            .PasteSpecial xlPasteValues\n        End With\n\n\n        'Select any cell to close the document\n        Sheet8.Range(\"M1\").Select\n        'Done\n      Exit For\n    End If\n  Next\n  Set wDoc = Nothing\nEnd Sub\n</code></pre>\n\n<p>After reviewing comintern's code, I was getting an error I couldn't solve for.  I went back to the boards and located some additional code.  Merging the two seems to have fixed it.  </p>\n\n<pre><code>Sub HTMLExport()\nDim objOnSheet As oleObject\nDim strFileName As String\nDim sh As Shape\nDim objWord As Object ''Word.Document\nDim objOLE As oleObject\n\nSheet8.Activate\nSet sh = ActiveSheet.Shapes(\"RA_Template\")\nsh.OLEFormat.Activate\nSet objOLE = sh.OLEFormat.Object\nSet objWord = objOLE.Object\n\nActiveSheet.Range(\"M1\").Activate\n\n''Easy enough\nstrFileName = CreateObject(\"Scripting.FileSystemObject\").GetSpecialFolder(2) &amp; \"\\temp.html\"\nobjWord.SaveAs2 Filename:=strFileName, FileFormat:=10  '10=wdFormatFilteredHTML\n\n\n'Copy the file contents into cell M1...\nDim handle As Integer\n    handle = FreeFile\n    Open strFileName For Input As handle\n    Sheet8.Range(\"M1\").Value = Input$(LOF(handle), handle)\n    Close handle\n\n'Delete the Temp File (strFileName)\nKill strFileName\n\n'Select any cell to close the document\nSheet8.Range(\"M1\").Select\n</code></pre>\n\n<p>End Sub`</p>\n"}, {"tags": ["vba", "dictionary", "nested"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 3439506, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1314824117/picture?type=large", "display_name": "Filipe", "link": "https://stackoverflow.com/users/3439506/filipe"}, "edited": false, "score": 0, "creation_date": 1429136831, "post_id": 29661582, "comment_id": 47463591, "body": "The second alternative solves my problem. Since I&#39;m changing the dictionary value I wouldn&#39;t imagine using the keyword Set here."}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 1, "last_activity_date": 1429134731, "creation_date": 1429134731, "answer_id": 29661582, "question_id": 29661469, "link": "https://stackoverflow.com/questions/29661469/changing-dictionary-string-item-to-nested-dictionary-in-vba/29661582#29661582", "title": "Changing dictionary string item to nested dictionary in VBA", "body": "<p>Do you maybe want to have <code>tmpDict</code> as the returning value for the key <code>abc</code>? In that case, you should nest since the beginning:</p>\n\n<pre><code>Dim data, tmpDict As Dictionary\nSet data = New Dictionary\nSet tmpDict = New Dictionary\ndata.Add \"abc\", tmpDict\n</code></pre>\n\n<p>Or, if you want to keep the structure of your code, you should use the keyword <code>Set</code> since you're setting a reference to an object:</p>\n\n<pre><code>Dim data, tmpDict As Dictionary\nSet data = New Dictionary\ndata.Add \"abc\", \"abc\"\nSet tmpDict = New Dictionary\nSet data(\"abc\") = tmpDict\n</code></pre>\n\n<p>I confess I might have misunderstood the question, please tell me in that case and I will edit/remove my answer.</p>\n"}], "owner": {"reputation": 61, "user_id": 3439506, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1314824117/picture?type=large", "display_name": "Filipe", "link": "https://stackoverflow.com/users/3439506/filipe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 29661582, "answer_count": 1, "score": 0, "last_activity_date": 1528704294, "creation_date": 1429134212, "last_edit_date": 1528704294, "question_id": 29661469, "link": "https://stackoverflow.com/questions/29661469/changing-dictionary-string-item-to-nested-dictionary-in-vba", "title": "Changing dictionary string item to nested dictionary in VBA", "body": "<p>after my <a href=\"https://stackoverflow.com/questions/29659656/changing-nested-dictionary-in-vba\" title=\"last venture with dictionaries\">last venture with dictionaries</a> i tried this code:</p>\n\n<pre><code>Dim data, tmpDict As Dictionary\nSet data = New Dictionary\n\ndata.Add \"abc\", \"abc\"\n\nSet tmpDict = New Dictionary\n\ndata(\"abc\") = tmpDict\n</code></pre>\n\n<p>And got a runtime error </p>\n\n<blockquote>\n  <p>error 450 - Wrong number of arguments or invalid property assignment</p>\n</blockquote>\n\n<p><strong>So, here is my question</strong>: how can I change a dictionary item that is a string to another dictionary, so it becomes nested to the first?</p>\n"}, {"tags": ["excel", "ms-access", "vba", "relationship"], "comments": [{"owner": {"reputation": 7095, "user_id": 341950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gnZPp.jpg?s=128&g=1", "display_name": "py2020", "link": "https://stackoverflow.com/users/341950/py2020"}, "edited": false, "score": 0, "creation_date": 1429135064, "post_id": 29661234, "comment_id": 47462886, "body": "Have you tried anything?"}, {"owner": {"reputation": 1, "user_id": 4793846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d686a1d1bea4732aa5010cdffe8203d?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Caldwell", "link": "https://stackoverflow.com/users/4793846/chris-caldwell"}, "reply_to_user": {"reputation": 7095, "user_id": 341950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gnZPp.jpg?s=128&g=1", "display_name": "py2020", "link": "https://stackoverflow.com/users/341950/py2020"}, "edited": false, "score": 0, "creation_date": 1429137715, "post_id": 29661234, "comment_id": 47463908, "body": "I created a 1-M join but I now realize that I have a many-to-many relationship so that&#39;s good. But I still don&#39;t know how to link the applicants table to  other tables so I have the Prim Key and Foreign Key values aligning. Do I have to type the foreign keys in myself to have the records link up?  I have several values in one excel field that need to be broken apart and assigned the PK which will become the FK when moved to other tables."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4793846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d686a1d1bea4732aa5010cdffe8203d?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Caldwell", "link": "https://stackoverflow.com/users/4793846/chris-caldwell"}, "edited": false, "score": 0, "creation_date": 1429136631, "post_id": 29661517, "comment_id": 47463523, "body": "If I separate the data from one excel document into separate tables, how do I automatically create joins based the Primary Key in the Applicants table to he other tables? How do I add ie. the PK 1 for Sue Smith to the FK in the Locations table so I create a link. There could be 5  - one&#39;s of foreign key due to five location choices? I won&#39;t be entering data only separating it and creating a report."}, {"owner": {"reputation": 1, "user_id": 4793846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d686a1d1bea4732aa5010cdffe8203d?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Caldwell", "link": "https://stackoverflow.com/users/4793846/chris-caldwell"}, "edited": false, "score": 0, "creation_date": 1429136794, "post_id": 29661517, "comment_id": 47463578, "body": "I need to somehow a) take out the mutivalued rows of data in one excel field LocationCriteria and have those child records  moved to the Locations table and link up the the Applicants table where they came?  Make Sense?"}], "tags": [], "owner": {"reputation": 31, "user_id": 4782161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94106c71740c05fab17bec60f9849e84?s=128&d=identicon&r=PG&f=1", "display_name": "datahandler", "link": "https://stackoverflow.com/users/4782161/datahandler"}, "is_accepted": false, "score": 0, "last_activity_date": 1429134412, "creation_date": 1429134412, "answer_id": 29661517, "question_id": 29661234, "link": "https://stackoverflow.com/questions/29661234/ms-access-1-to-many-database-from-excel-multivalued-field/29661517#29661517", "title": "MS Access 1-to-many database from Excel multivalued field", "body": "<p>If understand your requirement correctly, I would create 3 tables:</p>\n\n<h2>Applicants</h2>\n\n<p>Id\nFull name\nGrade</p>\n\n<h2>Locations</h2>\n\n<p>Id\nLocation</p>\n\n<h2>ApplicantsToLocations</h2>\n\n<p>Id \nApplicant_Id (foreign key)\nLocation_Id (foreign key)</p>\n\n<p>You would then need to populate the Locations table with unique only locations from the spreadsheet, then populate the Applicants table, and finally ApplicantsToLocations</p>\n"}, {"tags": [], "owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "is_accepted": false, "score": 0, "last_activity_date": 1437134965, "creation_date": 1437134965, "answer_id": 31475539, "question_id": 29661234, "link": "https://stackoverflow.com/questions/29661234/ms-access-1-to-many-database-from-excel-multivalued-field/31475539#31475539", "title": "MS Access 1-to-many database from Excel multivalued field", "body": "<pre><code>            Option Compare Database\n            Option Explicit\n            Option Base 1\n            Dim strInputString As String\n            Dim intNumberOfArrayEntries As Integer\n            Dim strStateArray(6) As String\n\n            ' ***********************************************************************\n            ' Loop Through A Table With A Multi-Value Field\n            ' And Insert Values Into the Multi-Value Field From A\n            ' Parsed Regular Text Field\n            '\n            ' Original code acquired from:\n            ' http://social.msdn.microsoft.com/Forums/office/en-US/384f46cd-2a67-4efa-883e-83004700e144/how-to-import-into-a-table-with-multivalue-fields?forum=accessdev\n            '\n            ' This code will take data from a string field, parse it into an array\n            ' for the multi-valued field, and append it to any existing data in the\n            ' multi-valued field of the same record.\n            '\n            ' This code uses a single recordset to process data, therefore, if you\n            ' wish to use this code, both your string field and your multi-value\n            ' field must be in the same table. (Perhaps import a temporary field?)\n            '\n            ' If you wish to incorporate this into your database, note the following\n            ' changes you should make to the code prior to using it:\n            '   TABLENAME is the table you will be using and holds both your string\n            '       which will be converted and your multi-valued field and the\n            '       multi-valued field\n            '       There are 13 instances of TABLENAME in this code (+ 2 for here/above)\n            '   MULTIVALUEFIELD is the field which holds your multi-valued field and\n            '       after using this code, the items converted to the multi-value\n            '       type will be appended to the items, if any, that are currently\n            '       stored in the given record.\n            '       There are 13 instances of MULTIVALUEFIELD in this code (+ 2 for here/above)\n            '   STRINGFIELD is the field which holds a string of the combined,\n            '       comma-separated values. This field will be broken up into\n            '       individual entries for use in the multi-value field\n            '       There is 1 instances of STRINGFIELD in this code (+ 2 for here/above)\n            '   If you use \"Find and Replace function\" replace each of the above names\n            '   exactly with your appropriate database names and watch for the count\n            '   of changes that it matches the \"# of instances\" for each\n            '\n            ' ***********************************************************************\n\n\n            ' Call this function name to start action\n            Public Function InsertIntoMultiField()\n\n            Dim db As DAO.Database\n\n            ' ***********************************************************************\n            ' Main recordset containing both a multi-value field and string field\n            ' ***********************************************************************\n            Dim TABLENAME As DAO.Recordset2\n            ' ***********************************************************************\n            ' Now Define the Multi-Value Fields as a RecordSet\n            ' ***********************************************************************\n            Dim rsMULTIVALUEFIELD As DAO.Recordset2\n\n            ' ***********************************************************************\n            ' The Values of the Field Are Contained in a Field Object\n            ' Dim fldMULTIVALUEFIELDTemp As DAO.Field2\n            ' ***********************************************************************\n            Dim fldMULTIVALUEFIELD As DAO.Field2\n            Dim i As Integer\n\n            ' ***********************************************************************\n            ' Open the Parent File\n            ' ***********************************************************************\n            Set db = CurrentDb()\n            Set TABLENAME = db.OpenRecordset(\"TABLENAME\")\n\n            ' ***********************************************************************\n            ' Set The Multi-Value Field\n            ' ***********************************************************************\n            Set fldMULTIVALUEFIELD = TABLENAME(\"Applications\")\n\n            ' ***********************************************************************\n            ' Check to Make Sure it is Multi-Value\n            ' ***********************************************************************\n            If Not (fldMULTIVALUEFIELD.IsComplex) Then\n                MsgBox (\"Not A Multi-Value Field\")\n                TABLENAME.Close\n                Set TABLENAME = Nothing\n                Set fldMULTIVALUEFIELD = Nothing\n                Exit Function\n            Else\n                'MsgBox (\"Selected field IS a multi-value field\")\n            End If\n\n            On Error Resume Next\n            ' ***********************************************************************\n            ' Loop Through\n            ' ***********************************************************************\n            Do While Not TABLENAME.EOF\n\n            ' ***********************************************************************\n            ' Parse Regular Text Field into Array For Insertion into Multi-Value\n            ' ***********************************************************************\n                strInputString = TABLENAME!STRINGFIELD\n                Call ParseInputString\n\n            ' ***********************************************************************\n            ' If Entries Are Present, Add Them To The Multi-Value Field\n            ' ***********************************************************************\n                If intNumberOfArrayEntries &gt; 0 Then\n                    Set rsMULTIVALUEFIELD = fldMULTIVALUEFIELD.Value\n                    TABLENAME.Edit\n                    For i = 1 To intNumberOfArrayEntries\n                        rsMULTIVALUEFIELD.AddNew\n                        rsMULTIVALUEFIELD(\"Value\") = strStateArray(i)\n                        rsMULTIVALUEFIELD.Update\n                    Next i\n                    rsMULTIVALUEFIELD.Close\n                    TABLENAME.Update\n                End If\n            TABLENAME.MoveNext\n            Loop\n\n            On Error GoTo 0\n\n            TABLENAME.Close\n            Set TABLENAME = Nothing\n            Set rsMULTIVALUEFIELD = Nothing\n            End Function\n\n            Public Function ParseInputString()\n            Dim intLength As Integer\n            Dim intStartSearch As Integer\n            Dim intNextComma As Integer\n            Dim intStartOfItem As Integer\n            Dim intLengthOfItem As Integer\n            Dim strComma As String\n\n            strComma = \",\"\n            intNumberOfArrayEntries = 0\n            strInputString = Trim(strInputString)\n            intLength = Len(strInputString)\n\n            ' ***********************************************************************\n            ' Skip Zero Length Strings\n            ' ***********************************************************************\n            If intLength = 0 Then\n                Exit Function\n            End If\n\n            ' ***********************************************************************\n            ' Strip Any Leading Comma\n            ' ***********************************************************************\n            If Mid(strInputString, 1, 1) = \",\" Then\n                Mid(strInputString, 1, 1) = \" \"\n                strInputString = Trim(strInputString)\n                intLength = Len(strInputString)\n                If intLength = 0 Then\n                    Exit Function\n                End If\n            End If\n\n            ' ***********************************************************************\n            ' Strip Any Trailing Comma\n            ' ***********************************************************************\n            If Mid(strInputString, intLength, 1) = \",\" Then\n                Mid(strInputString, intLength, 1) = \" \"\n                strInputString = Trim(strInputString)\n                intLength = Len(strInputString)\n                If intLength = 0 Then\n                    Exit Function\n                End If\n            End If\n\n            intStartSearch = 1\n            ' ***********************************************************************\n            ' Loop Through And Parse All the Items\n            ' ***********************************************************************\n            Do\n                intNextComma = InStr(intStartSearch, strInputString, strComma)\n                If intNextComma &lt;&gt; 0 Then\n                    intNumberOfArrayEntries = intNumberOfArrayEntries + 1\n                    intStartOfItem = intStartSearch\n                    intLengthOfItem = intNextComma - intStartOfItem\n                    strStateArray(intNumberOfArrayEntries) = Trim(Mid(strInputString, intStartOfItem, intLengthOfItem))\n                    intStartSearch = intNextComma + 1\n                Else\n                    intNumberOfArrayEntries = intNumberOfArrayEntries + 1\n                    intStartOfItem = intStartSearch\n                    intLengthOfItem = intLength - intStartSearch + 1\n                    strStateArray(intNumberOfArrayEntries) = Trim(Mid(strInputString, intStartOfItem, intLengthOfItem))\n                End If\n\n            Loop Until intNextComma = 0\n\n            End Function\n\n\n            ' ***********************************************************************\n            ' Original code credit to: Rich Locus, Logicwurks, LLC\n            ' From: http://social.msdn.microsoft.com/Forums/office/en-US/384f46cd-2a67-4efa-883e-83004700e144/how-to-import-into-a-table-with-multivalue-fields?forum=accessdev\n            ' Accessed: 23 September 2014\n            ' Edited by: ghost0245 (user - social.msdn.microsoft.com)\n            ' ***********************************************************************\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4793846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d686a1d1bea4732aa5010cdffe8203d?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Caldwell", "link": "https://stackoverflow.com/users/4793846/chris-caldwell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594644112, "creation_date": 1429133195, "last_edit_date": 1594644112, "question_id": 29661234, "link": "https://stackoverflow.com/questions/29661234/ms-access-1-to-many-database-from-excel-multivalued-field", "title": "MS Access 1-to-many database from Excel multivalued field", "body": "<p>VBA for MS Access - Multiple columns of rows with multivalued line feeds of data to separate.</p>\n\n<p>I have an Excel spreadsheet (given to me) with the following fields: <code>ID</code> [number], <code>FullName</code> [txt], <code>Grade</code> [number], <code>LocationCriteria</code> [txt - multivalued field separated by line feeds].</p>\n\n<p>I need to produce a report [in Access] that groups Applicants by Location with the names of the applicants underneath with their grades from highest to lowest.</p>\n\n<p>ie City Name, then below would be the names of the applicants who picked Vancouver..Joe, Mary Sue etc in order of who has the highest grade. The applicant can choose up to eight locations where they would like to work. All of the locations are in one Excel field separated by line breaks. </p>\n\n<p>What is the best way to separate the LocationCriteria field into their own rows or records into another table and match the ID # of the applicant so I have a one to many setup?  </p>\n\n<p>I would then have two tables: PARENT TABLE: tblApplicantInfo [<code>ID</code>, <code>FullName</code>, <code>Grade</code>] and CHILD TABLE: <code>LocationID</code>, <code>ID</code> (Foreign key), <code>Location</code>.  One applicant could be in several groups and situated differently in order depending on their grade.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2126, "user_id": 3076048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6400b93631ba00051f21c5e158f1ed34?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Balhoff", "link": "https://stackoverflow.com/users/3076048/mark-balhoff"}, "edited": false, "score": 0, "creation_date": 1429132652, "post_id": 29661035, "comment_id": 47461663, "body": "Do you know which line it is throwing the error on? Nevermind. I just checked and it crashes for me at the most logical point <code>Set File_Path1 =...</code>."}, {"owner": {"reputation": 55, "user_id": 4793864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3c4a1b7f21204b9ff9a1ddbc9524376?s=128&d=identicon&r=PG&f=1", "display_name": "supernoob", "link": "https://stackoverflow.com/users/4793864/supernoob"}, "reply_to_user": {"reputation": 2126, "user_id": 3076048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6400b93631ba00051f21c5e158f1ed34?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Balhoff", "link": "https://stackoverflow.com/users/3076048/mark-balhoff"}, "edited": false, "score": 0, "creation_date": 1429133305, "post_id": 29661035, "comment_id": 47462038, "body": "You got it...thanks in advance for taking a look at my code."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 4793864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3c4a1b7f21204b9ff9a1ddbc9524376?s=128&d=identicon&r=PG&f=1", "display_name": "supernoob", "link": "https://stackoverflow.com/users/4793864/supernoob"}, "edited": false, "score": 0, "creation_date": 1429228959, "post_id": 29661261, "comment_id": 47512996, "body": "I&#39;ve tweaked the code a bit to get it to do exactly what I want it to do, but it seems to work. Thanks for your help! I&#39;ll post the final code next week so you can take a look at it if you want."}], "tags": [], "owner": {"reputation": 2126, "user_id": 3076048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6400b93631ba00051f21c5e158f1ed34?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Balhoff", "link": "https://stackoverflow.com/users/3076048/mark-balhoff"}, "is_accepted": false, "score": 3, "last_activity_date": 1429203682, "last_edit_date": 1429203682, "creation_date": 1429133284, "answer_id": 29661261, "question_id": 29661035, "link": "https://stackoverflow.com/questions/29661035/vba-compare-cell-values-in-multiple-work-sheets/29661261#29661261", "title": "VBA - Compare Cell Values In Multiple Work Sheets", "body": "<p>Your line:</p>\n\n<pre><code>Set File_Path1 = Workbooks.Open(Filename = \"C:\\Test Files\\Test_File1.csv\")\n</code></pre>\n\n<p>Evaluates the inside as a boolean check of whether some nonexistent <code>Filename</code> variable has the value \"C:\\Test Files\\Test_File1.csv\". Since the new variable <code>Filename</code> has no value, the comparison returns false. You were probably trying to do <code>:=</code> and not <code>=</code>. The <code>:=</code> operator assigns to a method parameter while <code>=</code> either does a boolean evaluation or variable assignment. Any one of the following four lines should fix your error as the first use the <code>:=</code> operator to assign to the Filename parameter and the last two just know that Filename is the default first parameter.</p>\n\n<pre><code>Set File_Path1 = Workbooks.Open(Filename:=\"C:\\Test Files\\Test_File1.csv\")\nSet File_Path1 = Workbooks.Open Filename:=\"C:\\Test Files\\Test_File1.csv\"\nSet File_Path1 = Workbooks.Open(\"C:\\Test Files\\Test_File1.csv\")\nSet File_Path1 = Workbooks.Open \"C:\\Test Files\\Test_File1.csv\"\n</code></pre>\n\n<p>As a side note, this is something to be very careful about in VBA. Put <code>Option Explicit</code> at the top of every module so that it forces you to define your variables. If you do that, your erroring out line would have complained that variable 'Filename' was not defined.</p>\n\n<p>As far as your next line goes:</p>\n\n<pre><code>Set varSheetA = File_Path1.Worksheets(\"Sheet1\").Range(kRange)\n</code></pre>\n\n<p>you have two problems. First, when opening a csv file the tab name is always the same as the filename and NOT Sheet1. Second, <code>kRange</code> is part of the worksheet you started on so to get the comparable range on the new sheet you should use <code>kRange.Address</code>. Those fixes change the above into:</p>\n\n<pre><code>Set varSheetA = File_Path1.Worksheets(\"Test_File1\").Range(kRange.Address)\n</code></pre>\n\n<p>Your loop treats ranges like arrays. The most direct way to fix that is to force them to be arrays by changing the <code>Dim</code> statements (adding parentheses) and the assignment statements for your range variables (removing <code>Set</code> and adding <code>.Value</code>).</p>\n\n<pre><code>Dim varSheetA() As Variant\n...\nvarSheetA = File_Path1.Worksheets(\"Test_File1\").Range(kRange.Address).Value\n...\nIf varSheetA(iRow, 1) = varSheetB(iRow, 1) Then\n</code></pre>\n\n<p>The best alternative method is to never create the range variables in the first place and just grab cells by row and column indices.</p>\n\n<pre><code>Sub CompareLists_2()\n    Dim count As Integer\n    Dim LastRow As Long, iRow As Long\n    Dim MainSht As Worksheet, ws1 As Worksheet, ws2 As Worksheet, ws3 As Worksheet\n\n    Set MainSht = ActiveSheet\n    LastRow = MainSht.Range(\"A\" &amp; Rows.count).End(xlUp).Row\n    Set ws1 = Workbooks.Open(Filename:=\"C:\\Test Files\\Test_File1.csv\").Worksheets(\"Test_File1\")\n    Set ws2 = Workbooks.Open(Filename:=\"C:\\Test Files\\Test_File2.csv\").Worksheets(\"Test_File2\")\n    Set ws3 = Workbooks.Open(Filename:=\"C:\\Test Files\\Test_File3.csv\").Worksheets(\"Test_File3\")\n\n    For iRow = 3 To LastRow\n        count = 1\n        If ws1.Cells(iRow, 1).Value = ws2.Cells(iRow, 1).Value Then\n            count = count + 1\n        Else\n            If ws1.Cells(iRow, 1).Value = ws3.Cells(iRow, 1).Value Then\n                count = count + 1\n            Else\n                If count &lt; 3 Then\n                    MainSht.Cells(iRow, 1).Interior.ColorIndex = 3\n                End If\n            End If\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>Of course as far as I can tell your boolean logic reduces to:</p>\n\n<pre><code>If ws1.Cells(iRow, 1).Value &lt;&gt; ws2.Cells(iRow, 1).Value And ws1.Cells(iRow, 1).Value &lt;&gt; ws3.Cells(iRow, 1).Value And ws2.Cells(iRow, 1).Value &lt;&gt; ws3.Cells(iRow, 1).Value Then\n    MainSht.Cells(iRow, 1).Interior.ColorIndex = 3\nEnd If\n</code></pre>\n\n<p>Revision of boolean logic per comments (though I'm slightly confused on the logic):</p>\n\n<pre><code>If ws1.Cells(iRow, 1).Value &lt;&gt; ws2.Cells(iRow, 1).Value And ws1.Cells(iRow, 1).Value &lt;&gt; ws3.Cells(iRow, 1).Value And ws2.Cells(iRow, 1).Value &lt;&gt; ws3.Cells(iRow, 1).Value Then\n    ws1.Cells(iRow, 1).Interior.ColorIndex = 3\nElseIf ws1.Cells(iRow, 1).Value = ws2.Cells(iRow, 1).Value And ws1.Cells(iRow, 1).Value &lt;&gt; ws3.Cells(iRow, 1).Value Then\n    ws1.Cells(iRow, 1).Interior.ColorIndex = 3\n    ws2.Cells(iRow, 1).Interior.ColorIndex = 3\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 4793864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3c4a1b7f21204b9ff9a1ddbc9524376?s=128&d=identicon&r=PG&f=1", "display_name": "supernoob", "link": "https://stackoverflow.com/users/4793864/supernoob"}, "is_accepted": false, "score": 0, "last_activity_date": 1430140397, "last_edit_date": 1430140397, "creation_date": 1429672202, "answer_id": 29787019, "question_id": 29661035, "link": "https://stackoverflow.com/questions/29661035/vba-compare-cell-values-in-multiple-work-sheets/29787019#29787019", "title": "VBA - Compare Cell Values In Multiple Work Sheets", "body": "<pre><code>Sub CompareLists()\nDim count As Integer\nDim LastRow As Long, iRow As Long\nDim MainSht As Worksheet, ws1 As Worksheet, ws2 As Worksheet, ws3 As Worksheet, ws4 As Worksheet\nDim ws5 As Workbook\nDim var1 As Variant\n\n\nSet ws1 = Workbooks.Open(Filename:=\"C:\\Test Files\\Test_File1.csv\").Worksheets(\"Test_File1\")\nSet ws2 = Workbooks.Open(Filename:=\"C:\\Test Files\\Test_File2.csv\").Worksheets(\"Test_File2\")\nSet ws3 = Workbooks.Open(Filename:=\"C:\\Test Files\\Test_File3.csv\").Worksheets(\"Test_File3\")\n\nSet MainSht = ws1\nLastRow = MainSht.Range(\"A\" &amp; Rows.count).End(xlUp).Row\n\nFor iRow = 3 To LastRow\n    count = 1\n\n    If ws1.Cells(iRow, 1).Value &lt;&gt; ws2.Cells(iRow, 1).Value And ws1.Cells(iRow, 1).Value &lt;&gt; ws3.Cells(iRow, 1).Value Then\n        ws1.Cells(iRow, 1).Interior.ColorIndex = 3\n\n    ElseIf ws1.Cells(iRow, 1).Value = ws2.Cells(iRow, 1).Value And ws1.Cells(iRow, 1).Value &lt;&gt; ws3.Cells(iRow, 1).Value Then\n        ws1.Cells(iRow, 1).Interior.ColorIndex = 6\n        ws2.Cells(iRow, 1).Interior.ColorIndex = 6\n\n    ElseIf ws1.Cells(iRow, 1).Value = ws3.Cells(iRow, 1).Value And ws1.Cells(iRow, 1).Value &lt;&gt; ws2.Cells(iRow, 1).Value Then\n        ws1.Cells(iRow, 1).Interior.ColorIndex = 6\n        ws3.Cells(iRow, 1).Interior.ColorIndex = 6\n    End If\n\n    If ws3.Cells(iRow, 1).Value &lt;&gt; ws2.Cells(iRow, 1).Value And ws3.Cells(iRow, 1).Value &lt;&gt; ws1.Cells(iRow, 1).Value Then\n        ws3.Cells(iRow, 1).Interior.ColorIndex = 3\n    ElseIf ws3.Cells(iRow, 1).Value = ws2.Cells(iRow, 1).Value And ws3.Cells(iRow, 1).Value &lt;&gt; ws1.Cells(iRow, 1).Value Then\n        ws3.Cells(iRow, 1).Interior.ColorIndex = 6\n        ws2.Cells(iRow, 1).Interior.ColorIndex = 6\n    End If\n\n    If ws2.Cells(iRow, 1).Value &lt;&gt; ws3.Cells(iRow, 1).Value And ws2.Cells(iRow, 1).Value &lt;&gt; ws1.Cells(iRow, 1).Value Then\n        ws2.Cells(iRow, 1).Interior.ColorIndex = 3\n\n    End If\n\n\nNext\n\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 4793864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3c4a1b7f21204b9ff9a1ddbc9524376?s=128&d=identicon&r=PG&f=1", "display_name": "supernoob", "link": "https://stackoverflow.com/users/4793864/supernoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1430140397, "creation_date": 1429132469, "last_edit_date": 1531164843, "question_id": 29661035, "link": "https://stackoverflow.com/questions/29661035/vba-compare-cell-values-in-multiple-work-sheets", "title": "VBA - Compare Cell Values In Multiple Work Sheets", "body": "<p>I've tasked myself with building a small QA tool, but the problem is that I'm not terribly familiar with VBA or programming. I want to be able to iterate through a single column within three different .csv files. The cells in these columns should match, and the whole point of the tool is to identify the cells that are the \"odd man out\".</p>\n\n<p>Currently I have some spaghetti code that's giving me an error \"false.xlsx\" not found...please be gentle...</p>\n\n<pre><code>Sub CompareLists()\n\nDim count As Integer\nDim kRange As Range\nDim LastRow As Long\nDim iRow As Long\nDim varSheetA As Variant\nDim varSheetB As Variant\nDim varSheetC As Variant\n\n\nLastRow = Range(\"A\" &amp; Rows.count).End(xlUp).Row\nSet kRange = ActiveSheet.Range(\"A3:A\" &amp; LastRow)\n\n\nSet File_Path1 = Workbooks.Open(Filename = \"C:\\Test Files\\Test_File1.csv\")\nSet varSheetA = File_Path1.Worksheets(\"Sheet1\").Range(kRange)\nSet File_Path2 = Workbooks.Open(Filename = \"C:\\Test Files\\Test_File2.csv\")\nSet varSheetB = File_Path2.Worksheets(\"Sheet1\").Range(kRange)\nSet File_Path3 = Workbooks.Open(Filename = \"C:\\Test Files\\Test_File3.csv\")\nSet varSheetC = File_Path3.Worksheets(\"Sheet1\").Range(kRange)\n\n\nFor iRow = LBound(varSheetA) To UBound(varSheetA)\n    count = 1\n    If varSheetA(iRow) = varSheetB(iRow) Then\n        count = count + 1\n    Else\n    If varSheetA(iRow) = varSheetC(iRow) Then\n        count = count + 1\n    Else\n        If count &lt; 3 Then\n            ActiveCell.Interior.ColorIndex = 3\n        End If\n    End If\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "vbscript", "active-directory"], "comments": [{"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1429131694, "post_id": 29660808, "comment_id": 47461104, "body": "Okay, that&#39;s a nice goal. How are you trying to achieve it?"}, {"owner": {"reputation": 510, "user_id": 2957602, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0bbd9916a7897e575714107d2979f6ef?s=128&d=identicon&r=PG&f=1", "display_name": "C0d1ngJammer", "link": "https://stackoverflow.com/users/2957602/c0d1ngjammer"}, "edited": false, "score": 0, "creation_date": 1429186403, "post_id": 29660808, "comment_id": 47486353, "body": "Have you tried anything?"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 4793120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53b36e281211cb8b04b45bb0cf67d8f2?s=128&d=identicon&r=PG&f=1", "display_name": "esmo1975", "link": "https://stackoverflow.com/users/4793120/esmo1975"}, "edited": false, "score": 0, "creation_date": 1429550141, "post_id": 29674009, "comment_id": 47640562, "body": "The command i am using is &quot;dsquery group -name UIO_GRP_POC_GCE| dsget group -members &gt; C:\\Users\\moscosoe\\memberlist3.txt&quot;, i change that on the code you gave me and worked perfectly, thanks."}], "tags": [], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1429186226, "last_edit_date": 1429186226, "creation_date": 1429185429, "answer_id": 29674009, "question_id": 29660808, "link": "https://stackoverflow.com/questions/29660808/executing-command-lines-from-excel-using-vbscript-or-connecting-to-domain-active/29674009#29674009", "title": "Executing command lines from Excel using VBScript or connecting to domain Active Directory", "body": "<p>I use something like this to run my Ruby scripts from Excel.\nCreate a button and edit the macro behind it.\nReplace the command and script executed with the one you need for your AD search.\nThe example takes the value of cell A2 and uses it as input in the script to produce the output in cell D2.</p>\n\n<pre><code>Sub Knop1_Klikken()\n    Dim objShell As Object\n    Dim objWshScriptExec As Object\n    Dim objStdOut As Object\n    Dim rline As String\n    Dim strline As String\n    Dim arg As String\n    Dim command As String\n\n    arg = Worksheets(\"Blad1\").Range(\"A2\")\n    Set objShell = CreateObject(\"WScript.Shell\")\n    command = \"cmd.exe /S /C ruby \"\"C:\\Users\\Gebruiker\\ruby\\excel\\run.rb\"\" \" &amp; arg\n    Set objWshScriptExec = objShell.Exec(command)\n    Set objStdOut = objWshScriptExec.StdOut\n\n    While Not objStdOut.AtEndOfStream\n        rline = objStdOut.ReadLine\n        If rline &lt;&gt; \"\" Then strline = strline &amp; vbCrLf &amp; rline\n    Wend\n    Worksheets(\"Blad1\").Range(\"D2\") = strline\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 4793120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53b36e281211cb8b04b45bb0cf67d8f2?s=128&d=identicon&r=PG&f=1", "display_name": "esmo1975", "link": "https://stackoverflow.com/users/4793120/esmo1975"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 527, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444951472, "creation_date": 1429131577, "last_edit_date": 1444951472, "question_id": 29660808, "link": "https://stackoverflow.com/questions/29660808/executing-command-lines-from-excel-using-vbscript-or-connecting-to-domain-active", "title": "Executing command lines from Excel using VBScript or connecting to domain Active Directory", "body": "<p>I need to create a function in Excel that allows me to read a value form one cell that contains the name of an Active Directory Group and obtain the members of that group and load that information in another cell.</p>\n"}, {"tags": ["string", "vba", "csv", "ms-word"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1429145759, "post_id": 29660745, "comment_id": 47466396, "body": "Probably not creating any issues (since you presumably only have one file open), but <code>EOF(1)</code> checks a hard-coded file number and you open it as #file_number.  It should be <code>EOF(file_number)</code>."}, {"owner": {"reputation": 892, "user_id": 2883071, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e5ba9b9e7e629478194565fc83b46cda?s=128&d=identicon&r=PG&f=1", "display_name": "user2883071", "link": "https://stackoverflow.com/users/2883071/user2883071"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1429191350, "post_id": 29660745, "comment_id": 47490367, "body": "@Comintern I do have only one file open"}], "answers": [{"comments": [{"owner": {"reputation": 892, "user_id": 2883071, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e5ba9b9e7e629478194565fc83b46cda?s=128&d=identicon&r=PG&f=1", "display_name": "user2883071", "link": "https://stackoverflow.com/users/2883071/user2883071"}, "edited": false, "score": 0, "creation_date": 1429190870, "post_id": 29660835, "comment_id": 47489930, "body": "When I try it this way, even if the word is not found, it does not send the msgbox"}, {"owner": {"reputation": 892, "user_id": 2883071, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e5ba9b9e7e629478194565fc83b46cda?s=128&d=identicon&r=PG&f=1", "display_name": "user2883071", "link": "https://stackoverflow.com/users/2883071/user2883071"}, "edited": false, "score": 0, "creation_date": 1429191308, "post_id": 29660835, "comment_id": 47490336, "body": "I added a <code>Not</code> to the <code>If pos = </code> statement, it makes more sense now, but now it always returns a <code>could not find it</code> message."}], "tags": [], "owner": {"reputation": 1992, "user_id": 2059346, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b1bf47c1c750ebf4d32aadb85222e11?s=128&d=identicon&r=PG", "display_name": "Zammalad", "link": "https://stackoverflow.com/users/2059346/zammalad"}, "is_accepted": false, "score": 2, "last_activity_date": 1429199773, "last_edit_date": 1429199773, "creation_date": 1429131692, "answer_id": 29660835, "question_id": 29660745, "link": "https://stackoverflow.com/questions/29660745/vba-script-always-returns-input-past-end-of-file-error/29660835#29660835", "title": "VBA script always returns Input past end of file error", "body": "<p>It looks like a simple error in your <code>Do While</code> loop. You Check for the EOF instead of not the EOF, as such the loop will never execute since it starts at the BOF.</p>\n\n<p>Something like this should work (my syntax may be slightly off as I haven't used VBA in a while)</p>\n\n<pre><code>Open \"C:\\file1.csv\" For Input As #file_number\nWhile Not EOF(file_number) And found &lt;&gt; False\n    Line Input #file_number, raw_line\n    pos = InStr(raw_line, fireName)\n    If pos &lt;&gt; 0 Then\n        strData() = Split(raw_line, \",\")\n        found = True\n    End If\nWend\nClose #file_number\nIf found = False Then\n    MsgBox \"Could not find it\"\n    Exit Sub\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 892, "user_id": 2883071, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e5ba9b9e7e629478194565fc83b46cda?s=128&d=identicon&r=PG&f=1", "display_name": "user2883071", "link": "https://stackoverflow.com/users/2883071/user2883071"}, "is_accepted": false, "score": 0, "last_activity_date": 1429204042, "last_edit_date": 1429204042, "creation_date": 1429199627, "answer_id": 29679953, "question_id": 29660745, "link": "https://stackoverflow.com/questions/29660745/vba-script-always-returns-input-past-end-of-file-error/29679953#29679953", "title": "VBA script always returns Input past end of file error", "body": "<p>The correct way of typing <code>If pos != 0</code> in VBA is</p>\n\n<pre><code>If pos &lt;&gt; 0\n</code></pre>\n\n<p>Now it works</p>\n"}], "owner": {"reputation": 892, "user_id": 2883071, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e5ba9b9e7e629478194565fc83b46cda?s=128&d=identicon&r=PG&f=1", "display_name": "user2883071", "link": "https://stackoverflow.com/users/2883071/user2883071"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1108, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1429204042, "creation_date": 1429131353, "last_edit_date": 1429196703, "question_id": 29660745, "link": "https://stackoverflow.com/questions/29660745/vba-script-always-returns-input-past-end-of-file-error", "title": "VBA script always returns Input past end of file error", "body": "<p>I have a csv file as such:</p>\n\n<pre><code>hello,world,this\nis,an,example,\nof,the,csv,file\n</code></pre>\n\n<p>The first column will always be unique.</p>\n\n<p>I am getting the user to enter a string which matches an item in the first column, and the script returns the whole line:</p>\n\n<pre><code>Open \"C:\\file1.csv\" For Input As #file_number\nDo While (EOF(1) Or found = False)\n    Line Input #file_number, raw_line\n    pos = InStr(raw_line, fireName)\n    If pos = Not 0 Then\n        strData() = Split(raw_line, \",\")\n        found = True\n    End If\nLoop\nClose #file_number\nIf found = False Then\n    MsgBox \"Could not find it\"\n    Exit Sub\nEnd If\n'REST OF THE CODE\n</code></pre>\n\n<p>But it always sends the message \"could not find it\" and exits.\nBy default, found is a boolean value and is false. </p>\n\n<p>I know it can detect the file as when I changed the read file name, it created a new one (as it does not exist). </p>\n\n<p>EDIT:\nI changed the <code>And</code> to an <code>Or</code> and now I get the error: \n<code>Run-time error 62: input past end of file</code></p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1429132814, "post_id": 29660647, "comment_id": 47461744, "body": "Your code does not do anything with the HTMLBody property, only the plain text Body. What is your code that uses HTMLBody?"}, {"owner": {"reputation": 3, "user_id": 2245045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qzzuS.jpg?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/2245045/andy"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1429133072, "post_id": 29660647, "comment_id": 47461907, "body": "just replace any instance of myItem.Body with myItem.HTMLBody. I tried that method as well and 1)nothing in the body of the text got replaced and 2)the signature disappeared from the message."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 2245045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qzzuS.jpg?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/2245045/andy"}, "edited": false, "score": 0, "creation_date": 1429189004, "post_id": 29661640, "comment_id": 47488411, "body": "Simple Solution! Just changed them to square brackets and it fixed everything. Sometimes we just need a fresh set of eyes. Thanks again."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1429134995, "creation_date": 1429134995, "answer_id": 29661640, "question_id": 29660647, "link": "https://stackoverflow.com/questions/29660647/how-to-keep-formatting-with-replace-function/29661640#29661640", "title": "How to keep formatting with replace function?", "body": "<p>Your HTML body would not have \"&lt;\" and \">\" text characters (as in <code>\"&lt;ProjectName&gt;\"</code>), they will be HTML encoded  - <code>&amp;lt;</code> and <code>&amp;gt;</code></p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 2245045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qzzuS.jpg?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/2245045/andy"}, "edited": false, "score": 0, "creation_date": 1429189066, "post_id": 29662236, "comment_id": 47488457, "body": "Although Dmitry&#39;s solution worked, I did take the time to bookmark your hyperlink and read the passage last night. It was definitely enlightening! Thanks for the reference materials."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1429137869, "creation_date": 1429137869, "answer_id": 29662236, "question_id": 29660647, "link": "https://stackoverflow.com/questions/29660647/how-to-keep-formatting-with-replace-function/29662236#29662236", "title": "How to keep formatting with replace function?", "body": "<p>Outlook uses Word as an email editor. You can use the Word object model for making modifications in the message body, at least the WOM provides a convenient methods for replacing pieces of text. To get things working you need to use the <strong>WordEditor</strong> property of the Inspector class which returns an instance of the Document class from the Word object model. You can find all possible ways of working with item bodies described in the <a href=\"https://msdn.microsoft.com/en-us/library/dd492012%28v=office.12%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Chapter 17: Working with Item Bodies</a> (including the sample code).</p>\n"}], "owner": {"reputation": 3, "user_id": 2245045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qzzuS.jpg?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/2245045/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1722, "favorite_count": 0, "accepted_answer_id": 29661640, "answer_count": 2, "score": 0, "last_activity_date": 1599062338, "creation_date": 1429131037, "last_edit_date": 1599062338, "question_id": 29660647, "link": "https://stackoverflow.com/questions/29660647/how-to-keep-formatting-with-replace-function", "title": "How to keep formatting with replace function?", "body": "<p>I scoured the Outlook VBA section of the site, and could not find anything related.</p>\n<p>I created a template. The formatting is as I want it and the signature auto-populates.</p>\n<p>I created a macro that replaces tags in the message with information entered in Input Boxes.</p>\n<p>I tried using <code>myItem.Body</code> in my replace function. I lose all template and signature formatting.</p>\n<p>I tried using <code>myItem.HTMLBody</code> in my replace function. It does not replace anything in the body and the signature disappears.</p>\n<p>Code (Outlook 2010)</p>\n<pre><code>Sub PopulateTemplate()\nDim myItem As MailItem, oInspector As Inspector\nSet oInspector = Application.ActiveWindow\nSet myItem = oInspector.CurrentItem\n    \n'Provide the email address(es) and populate in the To field\nstrEmailAddr = InputBox(&quot;Enter email address(es), separated by semicolon(;)&quot;)\nmyItem.To = Replace(myItem.To, &quot;&lt;EmailAddr&gt;&quot;, strEmailAddr)\nmyItem.Display\n    \n'Provide the project name and populate in subject and body of email\nstrProjName = InputBox(&quot;Enter the Project Name&quot;)\nmyItem.Subject = Replace(myItem.Subject, &quot;&lt;ProjectName&gt;&quot;, strProjName)\nmyItem.Body = Replace(myItem.Body, &quot;&lt;ProjectName&gt;&quot;, strProjName)\nmyItem.Display\n    \n'Provide the time of day for the greeting and populate in the body of email\nstrTimeofDay = InputBox(&quot;Enter Morning, Afternoon, or Evening&quot;)\nmyItem.Body = Replace(myItem.Body, &quot;&lt;TimeofDay&gt;&quot;, strTimeofDay)\nmyItem.Display\n    \n'Provide the first name for the greeting and populate in body of email\nstrContactName = InputBox(&quot;Enter the First Name for the Greeting&quot;)\nmyItem.Body = Replace(myItem.Body, &quot;&lt;ContactName&gt;&quot;, strContactName)\nmyItem.Display\n    \n'Resolve all recipients (Same as pressing the &quot;Check Names&quot; button)\nCall myItem.Recipients.ResolveAll\n    \n'Free memory\nSet strEmailAddr = Nothing\nSet strProjName = Nothing\nSet strTimeofDay = Nothing\nSet strContactName = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba", "internet-explorer", "ms-access"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 1, "creation_date": 1429134945, "post_id": 29660589, "comment_id": 47462843, "body": "Without testing, I might suggest to see if your <code>getElementsByName(&quot;target&quot;)</code> is getting more than one link, where maybe the first one is not active. Rather than accessing the element with <code>.Item</code>, add an index and try with <code>(1)</code> (which would access the second element got, i.e. the second level of your page)."}, {"owner": {"reputation": 2020, "user_id": 4327668, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ATSJq.png?s=128&g=1", "display_name": "Roman Canlas", "link": "https://stackoverflow.com/users/4327668/roman-canlas"}, "edited": false, "score": 1, "creation_date": 1429134956, "post_id": 29660589, "comment_id": 47462847, "body": "where is the code placed? I suppose its in the 2nd level page?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1429141219, "post_id": 29660589, "comment_id": 47465127, "body": "After the navigation event you still have the same <code>ieDoc</code> reference, which points to a page which is no longer loaded.  You need to refresh that reference <code>Set ieDoc = ie.Document</code> after any navigation is complete."}, {"owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1429188831, "post_id": 29660589, "comment_id": 47488287, "body": "@TimWilliams I apologize, I had a bit of a language failure in my second to last paragraph of the OP :) ...but I&#39;ve tried re-setting ie.doc = ie.document, after the navigation, but without success. I&#39;ve also tried doing so with and without the (I would assume completely superfluous) additional step of setting ieDoc = nothing after the navigation but before the re-set of ieDoc = ie.document. I&#39;m getting the exact same beahvior in all cases."}, {"owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "reply_to_user": {"reputation": 2020, "user_id": 4327668, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ATSJq.png?s=128&g=1", "display_name": "Roman Canlas", "link": "https://stackoverflow.com/users/4327668/roman-canlas"}, "edited": false, "score": 0, "creation_date": 1429188987, "post_id": 29660589, "comment_id": 47488401, "body": "@Roman I&#39;ve got all of this code running in the &quot;OnClick&quot; event of a button in one of my Access forms."}, {"owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1429189436, "post_id": 29660589, "comment_id": 47488739, "body": "@MatteoNNZ I&#39;ve tried playing around with having getElementsByName reference multiple different indices (I&#39;ve looped the index from 0 through 1000, which is &gt;&gt; total number of elements on the page), and am getting the same behavior as above. I&#39;ve also used the debugger to capture the names of all the elements the code can see on (what should have been) the second-level page, and the second-level elements are missing entirely from that list. It doesn&#39;t look like this is a case of trying to point to the wrong index in a set with multiple items. It&#39;s like my code isnt seeing the 2nd page at all."}, {"owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "edited": false, "score": 0, "creation_date": 1429190009, "post_id": 29660589, "comment_id": 47489201, "body": "Thanks to all of you for taking the trouble to respond. I should also apologize, because I realize I&#39;ve left information out of the OP that might have been helpful. I should have mentioned the following: When I take the exact same code that works as expected on the 1st-level page, and I try to duplicate it after the navigation to the 2nd-level page (eg the $ link = ieDoc.Links(i).outerText loop), I am getting run-time error 91 &quot;Object variable or With block variable not set&quot;, although I am at a loss as to what is causing this."}, {"owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "edited": false, "score": 0, "creation_date": 1429191216, "post_id": 29660589, "comment_id": 47490253, "body": "Apologies yet again...I think I&#39;ve found the source of runtime error 91, and it doesn&#39;t look like it has anything to do with the root issue. It&#39;s an artifact of my previously-mentioned poorly-designed loop."}, {"owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "edited": false, "score": 0, "creation_date": 1429191225, "post_id": 29660589, "comment_id": 47490267, "body": "...On the first page, the loop has an exit condition (&quot;Until link = txt&quot;) that is preventing i from attaining a value in excess of the total number of links on the page (hence the runtime error is never being triggered). The same exit condition is present in the code when I try to re-run the same loop on the second-level page, but since I&#39;m not able to get my code to see the elements on the second page, that exit condition is never being met. As a result, the loop index is running past the total number of links on the page. Hence the runtime error."}, {"owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "edited": false, "score": 0, "creation_date": 1429194288, "post_id": 29660589, "comment_id": 47492765, "body": "I believe that this should probably close this topic for now...It&#39;s starting to become clear to me that my issues are all stemming from my lack of familiarity and understanding of the code that is driving the 1st-level webpage. I think the issue is that the links on that page are not actually bringing up a new document, they are simply redefining certain parameters that dictate how the page is displayed. So the 2nd-level page does not actually exist as a distinct HTML document--if that makes sense."}, {"owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "edited": false, "score": 0, "creation_date": 1429194386, "post_id": 29660589, "comment_id": 47492839, "body": "I also now realize that my ReadyState/DoEvents loop is not doing exactly what I thought it was after the navigation. It seems that by calling the first link in the manner that I am doing here, the ie readystate will always be equal to 1 and not 4. Not really a primary point of my issue, but more of a symptom that lets me know I dont understand enough about the objects I am trying to work with here!"}, {"owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "edited": false, "score": 0, "creation_date": 1429194407, "post_id": 29660589, "comment_id": 47492854, "body": "I think I&#39;ve got a bigger set of questions to solve than what I could politely rely on the SO community for help with at this time. :) Thanks again to all of you who took the trouble to comment!"}, {"owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "edited": false, "score": 0, "creation_date": 1429562360, "post_id": 29660589, "comment_id": 47648126, "body": "Problem solved! As expected, my issue was with a general lack of understanding of the code driving the website. All is now well. Thanks again!"}], "answers": [{"tags": [], "owner": {"reputation": 486, "user_id": 3461846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d9b9be4272a419813fa24ea47b6a573?s=128&d=identicon&r=PG&f=1", "display_name": "durbo", "link": "https://stackoverflow.com/users/3461846/durbo"}, "is_accepted": true, "score": 2, "last_activity_date": 1432011515, "last_edit_date": 1495540919, "creation_date": 1432011515, "answer_id": 30317079, "question_id": 29660589, "link": "https://stackoverflow.com/questions/29660589/using-vba-to-navigate-web-page-maniuplate-ie-via-access/30317079#30317079", "title": "Using VBA to navigate web page/ maniuplate IE via Access", "body": "<p>You need to use a combination of @Matteo NNZ and @TimWilliams</p>\n\n<p>If you know the \"id\" name of the element its easier to use getElementsByName(\"target\").</p>\n\n<p>if you don't know the \"id\" then loop anchor elements and search for the correct text. This narrows down to only Link or   elements.</p>\n\n<pre><code>Set Anchors = IeDoc.getElementsByTagName(\"a\")\n</code></pre>\n\n<p>then loop comparing .outertext or whatever sub field you need.</p>\n\n<p>@TimWilliams:\nYou need to load the found URL then set the newly loaded IeDoc inside the loop. Set the \"ie\" object to the new \"ie\" loaded page otherwise the 'ie' object will correctly remain the first page loaded.\nWhen you find your link you need to load the new page as you have already done.    </p>\n\n<pre><code>'' throw away the first page loaded.\nie = nothing \nIeDoc = nothing\n\n'' Set the new page loaded.\nie.navigate newHTML\n\n'wait for browser\nWhile ie.ReadyState &lt;&gt; READYSTATE_COMPLETE\nDoEvents\nWend\n\nSet IeDoc = ie.Document\n</code></pre>\n\n<p>Repeat the process as above for the second page</p>\n\n<p>Here are some other resources about 'parsing HTML in vba':\n<a href=\"http://www.ozgrid.com/forum/showthread.php?t=184695\" rel=\"nofollow noreferrer\">http://www.ozgrid.com/forum/showthread.php?t=184695</a>\n<a href=\"https://stackoverflow.com/questions/25488687/parse-html-content-in-vba\">Parse HTML content in VBA</a></p>\n"}, {"comments": [{"owner": {"reputation": 486, "user_id": 3461846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d9b9be4272a419813fa24ea47b6a573?s=128&d=identicon&r=PG&f=1", "display_name": "durbo", "link": "https://stackoverflow.com/users/3461846/durbo"}, "edited": false, "score": 2, "creation_date": 1435372911, "post_id": 31028921, "comment_id": 50187018, "body": "John, this is not an answer to your question. Help the community by providing a proper answer about how your resolved your problem. Its about helping the people that come after you resolving similar issues."}], "tags": [], "owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "is_accepted": false, "score": 0, "last_activity_date": 1435155004, "creation_date": 1435155004, "answer_id": 31028921, "question_id": 29660589, "link": "https://stackoverflow.com/questions/29660589/using-vba-to-navigate-web-page-maniuplate-ie-via-access/31028921#31028921", "title": "Using VBA to navigate web page/ maniuplate IE via Access", "body": "<p>In this particular case, I was able to resolve the issue on the HTML side of things, although I think in general the answers posted by @Matteo NNZ ,  @TimWilliams , and @durbo would do the trick for just the Access/VBA side of the problem. Thanks again to all who took the time to respond!</p>\n"}], "owner": {"reputation": 181, "user_id": 4584802, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f7c673156c8e86b785cbe54895ae90ac?s=128&d=identicon&r=PG&f=1", "display_name": "John Q. Noob", "link": "https://stackoverflow.com/users/4584802/john-q-noob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19573, "favorite_count": 1, "accepted_answer_id": 30317079, "answer_count": 2, "score": 5, "last_activity_date": 1435155004, "creation_date": 1429130831, "question_id": 29660589, "link": "https://stackoverflow.com/questions/29660589/using-vba-to-navigate-web-page-maniuplate-ie-via-access", "title": "Using VBA to navigate web page/ maniuplate IE via Access", "body": "<p>Hello StackOverflow community,</p>\n\n<p>I have a question about using Access VBA to manipulate IE.</p>\n\n<p>Essentially, I am trying to write code that will open a specific webpage using IE, search that page for a particular link (the name of the target link will depend on the circumstances of the user), navigate to a new page by programmatically clicking that link, and then repeating the process by looking for a specific link/element on the resulting new page.</p>\n\n<p>The display text for the ultimate target link will always be the same, but the page that it resides on will be different in every case.</p>\n\n<p>My issue is with programmatically searching the second-level page for the elements that reside there...my results keep giving me only elements from the first-level page, even after the browser has loaded the new link.</p>\n\n<p>Apologies if I'm doing a poor job describing the context of the question so far.</p>\n\n<p>My code, essentially, is as follows:</p>\n\n<pre><code>Dim ie As Object, ieDoc As HTMLDocument\n\nSet ie = CreateObject(\"InternetExplorer.Application\")\nie.Visible = True\n\nstrHTML = \"http://targetsite.com/first-level_page\"\n\nie.navigate strHTML\n\n'wait for browser\nWhile ie.ReadyState &lt;&gt; READYSTATE_COMPLETE\nDoEvents\nWend\n\n\n'define first-level target link and search for it and then \"click\" it\n\nDim i As Integer\nDim txt As String, link As String, p As String\n\nSet ieDoc = ie.Document\n\ntxt = \"First-Level Target\"\n    Do Until link = txt Or i &gt;= 1000\n    i = i + 1\n    link = ieDoc.Links(i).outerText\nLoop\n\n'I know the above loop is not exactly ideal in its current form, but it does give me a working first attempt at the functionality I'm trying to build.    \n\nieDoc.Links(i).Click\n</code></pre>\n\n<p>So far, so good. The code above works just as intended. It navigates correctly to the desired second-level page in all cases. Where I'm going wrong is when I try to search that second-level page for the final target element:</p>\n\n<pre><code>'wait for browser\nWhile ie.ReadyState &lt;&gt; READYSTATE_COMPLETE\nDoEvents\nWend\n\n'Search for final target element (which always has the same name and anchor text on all second-level pages)\nieDoc.getElementsByName(\"final-target-name\").Item.Click\n</code></pre>\n\n<p>The line above (based on .getElementsByName) works just fine if I try to use it on the first-level page. But it does nothing once I've navigated to any second-level page. I've also tried to replace it with a modified version of the loop above that searches for the link on the first-level page. Same result.</p>\n\n<p>As a troubleshooting step, I've also replaced that line with a debug.print command to simply name all of the elements on the second-level page, and this always returns the element names from the first page instead.</p>\n\n<p>I assume it's clear that I'm somehow failing to correctly update or redefine my HTMLdocument after I've followed the first link. I've setting ieDoc as nothing and then re-setting it as ie.document, but that doesn't work either.</p>\n\n<p>Hopefully there is a simple command or syntax that I'm simply ignorant to. But for the life of me I havent been able to have VBA correctly refer to the HTML elements existing on the page after the first link is clicked.</p>\n\n<p>Thanks in advance for any advice!</p>\n\n<p>~JQN</p>\n"}, {"tags": ["excel", "inputbox", "vba"], "answers": [{"tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 1, "last_activity_date": 1429131420, "creation_date": 1429131420, "answer_id": 29660766, "question_id": 29660230, "link": "https://stackoverflow.com/questions/29660230/inputbox-someone-press-ok-without-entering-anything/29660766#29660766", "title": "Inputbox someone press OK without entering anything", "body": "<p>Below is a sample to get you started:</p>\n\n<pre><code>Sub test()\n    Do\n        var_TauxUS = InputBox(\"Enter here:\")\n\n        If StrPtr(var_TauxUS) = 0 Then\n            Exit Sub\n        End If\n    Loop While var_TauxUS = vbNullString\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 4346787, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100001881520042/picture?type=large", "display_name": "Konsume", "link": "https://stackoverflow.com/users/4346787/konsume"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429148820, "creation_date": 1429129645, "last_edit_date": 1531161705, "question_id": 29660230, "link": "https://stackoverflow.com/questions/29660230/inputbox-someone-press-ok-without-entering-anything", "title": "Inputbox someone press OK without entering anything", "body": "<p>I want to force my users to either enter a value or press cancel.</p>\n\n<p>here is my current code but I can't find how to state the used pressed OK without entering anything.</p>\n\n<p>Thanks</p>\n\n<pre><code>InputBox:\nOn Error GoTo Cancel\nvar_TauxUS = InputBox(\"Veuillez aller sur   www.xe.com   et entrer le taux d'echange US/CAN:\" &amp; vbCrLf &amp; vbCrLf &amp; \"Exemple: 1,26 (avec une virgule)\", \"TAUX US\")  'La variable re\u00e7oit la valeur entr\u00e9e dans l'InputBox\n\n\n    If StrPtr(var_TauxUS) = 0 Then\n        GoTo InputBox\n    ElseIf var_TauxUS &lt;= 1 Then\n        MsgBox \"Vous devez entrer un chiffre plus grand que 1\"\n        GoTo InputBox\n    ElseIf var_TauxUS &gt;= 1.35 Then\n        MsgBox \"Vous devez entrer un chiffre plus petit que 1.36\"\n        GoTo InputBox\n    Else\n        var_TauxUS = var_TauxUS + vECHANGEDEVISE  'Calculer l'\u00e9change de la devise\n        var_US = True\n        MsgBox \"Nous commenceons a updater les prix \u00e0 un taux de \" &amp; var_TauxUS &amp; \" - Merci!\"\n        GoTo Programme\n    End If\n</code></pre>\n\n<p>I tried: </p>\n\n<pre><code>IsEmpty(var_TauxUS)\n\nIf var_TauxUS = \"\" then\n</code></pre>\n\n<p>and it's not working</p>\n"}, {"tags": ["vba", "dom", "xpath", "xml-parsing"], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "edited": false, "score": 0, "creation_date": 1429133521, "post_id": 29660631, "comment_id": 47462150, "body": "Thanks! But what if it was a node AFTER the attribute? From the sample above, say something like <code>&lt;catalog&#47;book&#47;misc&#47;PublishedAuthor[@fName=]&#47;StoreLocation&#47;</code> and <code>&lt;catalog&#47;book&#47;misc&#47;PublishedAuthor[@fName=]&#47;StoreLocations&#47;</code> Where we have StoreLocation and StoreLocation<b>s</b>"}, {"owner": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "edited": false, "score": 0, "creation_date": 1429135957, "post_id": 29660631, "comment_id": 47463248, "body": "Sorry, I meant something more like <code>&lt;catalog&#47;book&#47;misc&#47;PublishedAuthor&#47;area&#47;StoreLocation&#47;</code> and <code>&lt;catalog&#47;book&#47;misc&#47;PublishedAuthors&#47;area&#47;StoreLocation&#47;</code> where there is no direct wild attribute, but inbetween there is a node that slightly differrs (in this case, <b>PublishedAuthors</b> and <b>PublishedAuthor</b>)"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1429130992, "creation_date": 1429130992, "answer_id": 29660631, "question_id": 29660177, "link": "https://stackoverflow.com/questions/29660177/vba-xpath-wildcard-for-letters/29660631#29660631", "title": "VBA Xpath Wildcard For Letters", "body": "<p>If the attribute name can be either <code>Name</code> or <code>fName</code> then you can use:</p>\n\n<pre><code>Sub Tester()\n    Dim doc As New MSXML2.DOMDocument\n    Dim n\n\n    doc.LoadXML Range(\"a1\").Value\n\n    Set n = doc.SelectNodes(\"/catalog/book/misc/PublishedAuthor[@Name='Ralls']|\" &amp; _\n                            \"/catalog/book/misc/PublishedAuthor[@fName='Ralls']\")\n\n    Debug.Print n.Length '&gt;&gt; 2\n\nEnd Sub\n</code></pre>\n\n<p>There's no wildcard available for attribute names.</p>\n"}, {"comments": [{"owner": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "edited": false, "score": 0, "creation_date": 1429158695, "post_id": 29663901, "comment_id": 47469837, "body": "Interesting. I could also technically do <code>&lt;catalog&#47;book&#47;misc&#47;PublishedAuthor&#47;area&#47;[contains[name(),&#39;St&zwnj;&#8203;oreLocation&#39;]&#47;</code> or even <code>&lt;catalog&#47;book&#47;misc&#47;PublishedAuthor&#47;area&#47;[ends-with(name(),&#39;L&zwnj;&#8203;ocation&#39;]&#47;</code> correct?"}, {"owner": {"reputation": 83665, "user_id": 2998271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B7vUA.png?s=128&g=1", "display_name": "har07", "link": "https://stackoverflow.com/users/2998271/har07"}, "reply_to_user": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "edited": false, "score": 1, "creation_date": 1429158990, "post_id": 29663901, "comment_id": 47469922, "body": "<code>contains(name(),&#39;StoreLocation&#39;)</code> should also work, but <code>ends-with()</code> maybe not because it is xpath 2.0 function (AFAIK, most xpath engine/library implements xpath 1.0 only). For reference: <a href=\"http://www.w3.org/TR/xpath/\" rel=\"nofollow noreferrer\">xpath 1.0 spec</a>"}, {"owner": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "edited": false, "score": 0, "creation_date": 1429203953, "post_id": 29663901, "comment_id": 47500073, "body": "Sorry for another question, but I&#39;m having an issue with my context: <code>Set loc = pn.SelectSingleNode(&quot;misc&#47;PublishedAuthor&#47;contains(name(),&#39;S&zwnj;&#8203;toreLocation&#39;)&quot;)</code>  VBA does not seem to like the brackets in this case, and when I remove the brackets VBA does not seem to like the word <b>contains</b>. Any idea why? :( Also, I noticed that a lot of others online don&#39;t use &quot;quotes&quot; when declaring their XPath, is that just for demonstration purposes?"}], "tags": [], "owner": {"reputation": 83665, "user_id": 2998271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B7vUA.png?s=128&g=1", "display_name": "har07", "link": "https://stackoverflow.com/users/2998271/har07"}, "is_accepted": false, "score": 1, "last_activity_date": 1429150223, "last_edit_date": 1429150223, "creation_date": 1429148303, "answer_id": 29663901, "question_id": 29660177, "link": "https://stackoverflow.com/questions/29660177/vba-xpath-wildcard-for-letters/29663901#29663901", "title": "VBA Xpath Wildcard For Letters", "body": "<p>There is no wildcard specifically for letter in XPath. As you probably already realized, the wildcard work for the entire names (element name or attribute name). To match partially in xpath, you may want to consider <code>starts-with()</code> and <code>substring()</code> functions.</p>\n\n<p>Possible alternative for this specific case is using <code>or</code> operator which will save you from writing the same path twice, like when using union (<code>|</code>) operator :</p>\n\n<pre><code>/catalog/book/misc/PublishedAuthor[@fName or @Name]\n</code></pre>\n\n<p>And regarding your comment, you can use <code>starts-with()</code> check against node's <code>name()</code> like so :</p>\n\n<pre><code>/catalog/book/misc/*[starts-with(name(), 'PublishedAuthor')]/area/StoreLocation\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 712, "favorite_count": 1, "accepted_answer_id": 29660631, "answer_count": 2, "score": 0, "last_activity_date": 1429150223, "creation_date": 1429129436, "question_id": 29660177, "link": "https://stackoverflow.com/questions/29660177/vba-xpath-wildcard-for-letters", "title": "VBA Xpath Wildcard For Letters", "body": "<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;catalog&gt;\n&lt;book id=\"Adventure\"&gt;\n   &lt;author&gt;Gambardella, Matthew&lt;/author&gt;\n   &lt;title&gt;XML Developer's Guide&lt;/title&gt;\n   &lt;price&gt;44.95&lt;/price&gt;\n   &lt;misc&gt;\n        &lt;Publisher id=\"5691\"&gt;\n            &lt;PublisherLocation&gt;Los Angeles&lt;/PublisherLocation&gt;\n        &lt;/Publisher&gt;\n        &lt;PublishedAuthor fName=\"Gambardella\"&gt;\n            &lt;StoreLocation&gt;Store B&lt;/StoreLocation&gt;\n        &lt;/PublishedAuthor&gt;\n    &lt;/misc&gt;\n&lt;/book&gt;\n&lt;book id=\"Adventure\"&gt;\n   &lt;author&gt;Ralls, Kim&lt;/author&gt;\n   &lt;title&gt;Midnight Rain&lt;/title&gt;\n   &lt;price&gt;5.95&lt;/price&gt;\n   &lt;misc&gt;\n        &lt;Publisher id=\"4787\"&gt;\n            &lt;PublisherLocation&gt;New York&lt;/PublisherLocation&gt;\n        &lt;/Publisher&gt;\n        &lt;PublishedAuthor Name=\"Ralls\"&gt;\n            &lt;StoreLocation&gt;Store B&lt;/StoreLocation&gt;\n        &lt;/PublishedAuthor&gt;\n    &lt;/misc&gt;\n&lt;/book&gt;\n&lt;/catalog&gt;\n</code></pre>\n\n<p>The path to <strong>PublishedAuthor</strong> is the same for both books with the exception of one character. Is it possible to set a wildcard for this character so that it will accept either XPath?</p>\n\n<p><code>&lt;catalog/book/misc/PublishedAuthor[@fName=]/</code></p>\n\n<p>Yields the exact same result as:</p>\n\n<p><code>&lt;catalog/book/misc/PublishedAuthor[@Name=]/</code></p>\n"}, {"tags": ["excel", "web-scraping", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4793637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/154c48023230a867baf676015afa552b?s=128&d=identicon&r=PG&f=1", "display_name": "cafeconcarne", "link": "https://stackoverflow.com/users/4793637/cafeconcarne"}, "edited": false, "score": 0, "creation_date": 1429199227, "post_id": 29661730, "comment_id": 47496752, "body": "Thank you!  I&#39;ll try to integrate this into my code."}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 0, "last_activity_date": 1429135430, "creation_date": 1429135430, "answer_id": 29661730, "question_id": 29660161, "link": "https://stackoverflow.com/questions/29660161/scraping-all-pages-of-a-paginated-site-in-excel-using-vba/29661730#29661730", "title": "Scraping all pages of a paginated site in Excel using VBA", "body": "<p>I would loop and scrape until I don't find the <code>Next</code> button anymore, which means: </p>\n\n<pre><code>buttonFound = True '&lt;-- False if we don't find --&gt; break the loop\nWhile buttonFound '&lt;-- while we have a \"Next\" button\n\n'scrape data then click next\n\nSet allLinks = ie.getElementsByTagName(\"a\")\nbuttonFound = False\nFor Each btn In allLinks '&lt;-- search the button\n    If btn.innerText = \"Next\"\n        buttonFound = True '&lt;-- if you find it, you will have to look for it next time\n        Set btnNext = btn\n        Exit For\n    End If\nNext btn\n\nbtn.Click '&lt;-- go to next page and try again\nWend\n</code></pre>\n\n<p>I wouldn't rely too much on the URL as it might contain underlying logics from the back-end; rather, approach the problem as a front-end user (i.e. as long as I see the \"Next\" button, I click on it and I scrape the other page).</p>\n"}], "owner": {"reputation": 1, "user_id": 4793637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/154c48023230a867baf676015afa552b?s=128&d=identicon&r=PG&f=1", "display_name": "cafeconcarne", "link": "https://stackoverflow.com/users/4793637/cafeconcarne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1749, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1472091151, "creation_date": 1429129377, "last_edit_date": 1531164843, "question_id": 29660161, "link": "https://stackoverflow.com/questions/29660161/scraping-all-pages-of-a-paginated-site-in-excel-using-vba", "title": "Scraping all pages of a paginated site in Excel using VBA", "body": "<p>I'm trying to scrape web data from a county website using VBA in Excel 2013.  I'm new to this, and feel like my code isn't even worth posting, but I was hoping that I could get some help with my general approach.  </p>\n\n<p>A sample search term has led me to the <a href=\"https://pa_allegheny.uslandrecords.com/palr/controller?commandflag=searchByNameID&amp;optflag=SearchCommand&amp;county=pa003&amp;userid=null&amp;userCategory=7&amp;nameid=935708&amp;partytype=&amp;name=UNIVERSITY%2BPGH%2BTHE%2BCOMWTH%2BSYSTEM%2BHIGHER%2BEDUCATION&amp;officeid=60&amp;fromdate=01/01/1986&amp;todate=04/14/2015&amp;lastname=university\">following URL</a></p>\n\n<p>If I click \"Next\", it takes me <a href=\"https://pa_allegheny.uslandrecords.com/palr/controller?commandflag=searchByNameID&amp;optflag=SearchCommand&amp;county=pa003&amp;userid=null&amp;userCategory=7&amp;nameid=935708&amp;startrow=21&amp;startpage=1&amp;lastpage=10&amp;partytype=&amp;name=UNIVERSITY%2BPGH%2BTHE%2BCOMWTH%2BSYSTEM%2BHIGHER%2BEDUCATION&amp;officeid=60&amp;fromdate=01/01/1986&amp;todate=04/14/2015&amp;lastname=university\">here</a> </p>\n\n<p>I am limited to 20 search results at a time, and it looks like the \"Next\" button will take me to a similar URL, but with the \"&amp;startrow=\" parameter set to 20 greater than the previous page.  </p>\n\n<p>If I want to copy all of the data from all pages, do I need to focus on \"&amp;startrow=\" in order to properly loop?  And if so, what's the best way to do that?</p>\n"}, {"tags": ["vba", "dictionary", "nested"], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 3439506, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1314824117/picture?type=large", "display_name": "Filipe", "link": "https://stackoverflow.com/users/3439506/filipe"}, "is_accepted": true, "score": 0, "last_activity_date": 1429127732, "creation_date": 1429127732, "answer_id": 29659657, "question_id": 29659656, "link": "https://stackoverflow.com/questions/29659656/changing-nested-dictionary-in-vba/29659657#29659657", "title": "Changing nested dictionary in VBA", "body": "<p>The solution can be achieved contracting the last 3 lines in just 1, using:</p>\n\n<pre><code>data.Item(123).Add \"somekey\", 100\n</code></pre>\n\n<p>instead of:</p>\n\n<pre><code>Set tmpDict = data.Item(123)\ntmpDict.Add \"somekey\", 100\ndata.Item(123) = tmpDict\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 3439506, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1314824117/picture?type=large", "display_name": "Filipe", "link": "https://stackoverflow.com/users/3439506/filipe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "accepted_answer_id": 29659657, "answer_count": 1, "score": 0, "last_activity_date": 1429127732, "creation_date": 1429127732, "question_id": 29659656, "link": "https://stackoverflow.com/questions/29659656/changing-nested-dictionary-in-vba", "title": "Changing nested dictionary in VBA", "body": "<p>I was about to ask a question when the solution came in one test. So I'm posting anyway and answering, so others can benefit.</p>\n\n<p><strong>The question was:</strong></p>\n\n<p>I run the code below and get a runtime error 450 - Wrong number of arguments or invalid property assignment</p>\n\n<pre><code>Dim data, tmpDict As Dictionary\nSet data = New Dictionary\nSet tmpDict = New Dictionary\n\ndata.Add 123, tmpDict\n\nSet tmpDict = data.Item(123)\ntmpDict.Add \"somekey\", 100\ndata.Item(123) = tmpDict\n</code></pre>\n\n<p>The error occur in last line. The code was simplified to focus on changing a nested dictionary in an already existing item.</p>\n\n<p>How can I succeed in this?</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "substitution"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1429156713, "post_id": 29659584, "comment_id": 47469326, "body": "I agree with @pnuts. A short VBA code can do what you want in a blink of an eye but of course only if you want to take that route. Also I think an array formula is possible (not really sure), but let me try it first and get back to you."}, {"owner": {"reputation": 11, "user_id": 4793585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2733490e11b0d43589bfbaa34b93e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Bacanu", "link": "https://stackoverflow.com/users/4793585/alex-bacanu"}, "edited": false, "score": 0, "creation_date": 1429217828, "post_id": 29659584, "comment_id": 47508621, "body": "I don&#39;t mind using VBA code, I don&#39;t know why I typed &quot;only by using cells&quot;, my intention was different. If you don&#39;t mind sharing a VBA code, maybe it will suit other people better :). I&#39;ll stick with the solution @mock_blatt posted for now!. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4793585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2733490e11b0d43589bfbaa34b93e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Bacanu", "link": "https://stackoverflow.com/users/4793585/alex-bacanu"}, "edited": false, "score": 0, "creation_date": 1429217925, "post_id": 29662141, "comment_id": 47508683, "body": "Yes the image is legible, your solution works! But as you&#39;ve said, it&#39;s not the most efficient way but it works :) Thank you so much."}], "tags": [], "owner": {"reputation": 945, "user_id": 4778565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebcc04d46859697213ac612773d64673?s=128&d=identicon&r=PG&f=1", "display_name": "mock_blatt", "link": "https://stackoverflow.com/users/4778565/mock-blatt"}, "is_accepted": true, "score": 0, "last_activity_date": 1429137462, "creation_date": 1429137462, "answer_id": 29662141, "question_id": 29659584, "link": "https://stackoverflow.com/questions/29659584/advanced-substitute-in-excel-with-range/29662141#29662141", "title": "Advanced substitute in excel with range", "body": "<p>It sounds like you don't want to use a VBA solution? </p>\n\n<p>If you don't mind moving some stuff around, try this. </p>\n\n<p><img src=\"https://i.stack.imgur.com/z5YAt.png\" alt=\"Using repeated substitute formula, needs to use up a column for each lookup you have. Once you put the formula in correctly in the first cell, you can drag it to the right, and drag the whole thing down. Your desired result will be in the last cell to the right\"></p>\n\n<p>Damn, that image isn't big enough, is it? You can see the layout though. \"Original Text\" is in C1, and the word ID is in A5, and I've numbered D1:I1 1-6. Now paste this formula into D2: =SUBSTITUTE(C2,OFFSET($B$6,D$1-1,0),OFFSET($A$6,D$1-1,0))</p>\n\n<p>And drag it right and drag all the columns down. Your desired output should be in column I. It's not the most computationally efficient, but it's super easy to implement and works with any size lookup table (just drag out more columns and number them) and any number of items in the text fields.</p>\n"}], "owner": {"reputation": 11, "user_id": 4793585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2733490e11b0d43589bfbaa34b93e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Bacanu", "link": "https://stackoverflow.com/users/4793585/alex-bacanu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 1, "accepted_answer_id": 29662141, "answer_count": 1, "score": -1, "last_activity_date": 1429137938, "creation_date": 1429127542, "last_edit_date": 1429137938, "question_id": 29659584, "link": "https://stackoverflow.com/questions/29659584/advanced-substitute-in-excel-with-range", "title": "Advanced substitute in excel with range", "body": "<p>I'm trying to replace 1400 cells with text into cells with ids, I've attached a picture so you can understand it easier. I'm trying to do this only by using cells because I have 1400 cells I need to replace.</p>\n\n<p>I've trying using substitute using a range but I can't seem to make it work.<br>\n<code>=SUBSTITUTE(H2;K2:K999;J2:J999)</code><br><br>\n<img src=\"https://i.stack.imgur.com/oX40N.png\" alt=\"example\"></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1429127705, "post_id": 29659503, "comment_id": 47458814, "body": "Avoid setting the <code>.NumberFormat</code> to full column references. The <code>.UsedRange</code> will adjust accordingly and you will be left with an oversized worksheet with a large filesize. Ctrl+End becomes useless."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1429131577, "post_id": 29659503, "comment_id": 47461031, "body": "@pnuts, i missed that. <code>macros</code> tag has been removed."}], "answers": [{"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 0, "last_activity_date": 1429127546, "creation_date": 1429127546, "answer_id": 29659585, "question_id": 29659503, "link": "https://stackoverflow.com/questions/29659503/macro-for-excel-not-formatting-correctly/29659585#29659585", "title": "Macro for Excel not formatting correctly", "body": "<p>There's a few ways to do mass conversion of a column of text-numbers to numeric-numbers. The quickest, in my experience, is to hit it with the TextToColumns function:</p>\n\n<pre><code> Range(\"D:D\").TextToColumns Destination:=Range(\"D1\"), DataType:=xlFixedWidth, _\n    FieldInfo:=Array(0, 1), TrailingMinusNumbers:=True\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 4792634, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-8956RUF3bCo/AAAAAAAAAAI/AAAAAAAAAQg/22xSBnCHwGc/photo.jpg?sz=128", "display_name": "Sin Chan", "link": "https://stackoverflow.com/users/4792634/sin-chan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 420, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429131535, "creation_date": 1429127281, "last_edit_date": 1429131535, "question_id": 29659503, "link": "https://stackoverflow.com/questions/29659503/macro-for-excel-not-formatting-correctly", "title": "Macro for Excel not formatting correctly", "body": "<p>I am recording a macro. There is a column I am trying to convert to number so I can use formula to calculate.</p>\n\n<p>I use VBA code as follow:</p>\n\n<pre><code>Columns(\"D:D\").NumberFormat=\"0.00\"\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Range(\"D:D\").NumberFormat=\"0.00\"\n</code></pre>\n\n<p>The cell itself is showing Number but I can still see the <code>!</code> sign next to the cell to ask if I want to convert from text to number. </p>\n\n<p>I put my mouse over the cell and the message is <code>The number in the cell is formatted as text or preceded by an apostrophe.</code></p>\n\n<p>I am able to change the cell by click the <code>!</code> and change it from text to number. The formula in cell E works after I did it. I want to know if I can write a line in my macro to change this column D to be a number.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1429198034, "post_id": 29659418, "comment_id": 47495873, "body": "What have you tried?  If you are putting a password back on a sheet, it should be as simple as <code>Sheet1.Protect &quot;password&quot;</code>.  Same story if you want to protect the whole workbook again <code>ThisWorkbook.Protect &quot;Password&quot;</code>.  You just need to get references to the sheet or workbook."}, {"owner": {"reputation": 311, "user_id": 4625094, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3668fc2b694b942575f32afdef39da31?s=128&d=identicon&r=PG&f=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/4625094/rick"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1429204616, "post_id": 29659418, "comment_id": 47500469, "body": "I actually figured it out a couple hours ago. I was activating the wrong workbooks and doing the opposite of what was intended. I suppose I got tunnel vision from looking at it over and over again."}], "owner": {"reputation": 311, "user_id": 4625094, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3668fc2b694b942575f32afdef39da31?s=128&d=identicon&r=PG&f=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/4625094/rick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1429127029, "creation_date": 1429127029, "last_edit_date": 1531161705, "question_id": 29659418, "link": "https://stackoverflow.com/questions/29659418/protect-original-workbook-after-new-workbook-is-created-excel-2010-vba", "title": "Protect original workbook after new workbook is created Excel 2010 VBA", "body": "<p>I have a worksheet that is a template. The purpose of this template is to gather some customer information for billing and once some basic information is put onto it a new workbook is created and is editable for some fine tuning. Once the person is done editing the bill it is printed and saved onto a server.</p>\n\n<p>Now, I am able to do everything I want perfectly fine, however I am having an issue when I try to protect the template after everything is copied to an editable workbook </p>\n\n<p>How can I possibly re-protect the template while leaving the editable version unprotected? It sounds like it would be simple, but it is proving me otherwise.</p>\n\n<p>I can provide any code if needed.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 3, "creation_date": 1429126687, "post_id": 29659206, "comment_id": 47458245, "body": "Why are dates different from sorting any other type of number?"}, {"owner": {"reputation": 25, "user_id": 4777793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-emUhiLN_osw/AAAAAAAAAAI/AAAAAAAAABA/Dl_AOyxnmWc/photo.jpg?sz=128", "display_name": "memed", "link": "https://stackoverflow.com/users/4777793/memed"}, "edited": false, "score": 0, "creation_date": 1429127977, "post_id": 29659206, "comment_id": 47458976, "body": "I have a column contains the date (dd / mm / YYYY)...but I want to apply a function to a table (sheet). This table needs to be sorted by the date in column A that contains dates. So if the sheet is not sorted by increasing date I will have different results."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4777793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-emUhiLN_osw/AAAAAAAAAAI/AAAAAAAAABA/Dl_AOyxnmWc/photo.jpg?sz=128", "display_name": "memed", "link": "https://stackoverflow.com/users/4777793/memed"}, "edited": false, "score": 0, "creation_date": 1429128422, "post_id": 29659543, "comment_id": 47459226, "body": "if I sort my sheet manually my function that does a search against the criterion is always going to take that sort l?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 25, "user_id": 4777793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-emUhiLN_osw/AAAAAAAAAAI/AAAAAAAAABA/Dl_AOyxnmWc/photo.jpg?sz=128", "display_name": "memed", "link": "https://stackoverflow.com/users/4777793/memed"}, "edited": false, "score": 1, "creation_date": 1429129079, "post_id": 29659543, "comment_id": 47459613, "body": "@memed - I&#39;m unclear on your question. If you sort it manually you should already know which column contains the dates you want to sort on."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1429127414, "creation_date": 1429127414, "answer_id": 29659543, "question_id": 29659206, "link": "https://stackoverflow.com/questions/29659206/sort-a-worksheet-using-a-column-of-dates-as-the-primary-key/29659543#29659543", "title": "Sort a worksheet using a column of dates as the primary key", "body": "<p>Assuming that a date can be found (and identified with VBA's <a href=\"https://msdn.microsoft.com/en-us/library/00wf8zk9%28v=vs.90%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">IsDate function</a>) in the second row between column A and the last used column of A1's current region then this should locate the first column with dates and sort in an ascending manner.</p>\n\n<pre><code>Sub sort_by_first_date()\n    Dim iDateCol As Date\n    With ActiveSheet\n        With .Cells(1, 1).CurrentRegion\n            For iDateCol = 1 To .Columns.Count\n                If IsDate(.Cells(2, iDateCol)) Then Exit For\n            Next iDateCol\n            If iDateCol &lt;= .Columns.Count Then  'make sure a column with dates was found\n                .Cells.Sort Key1:=.Columns(iDateCol), Order1:=xlAscending, _\n                            Orientation:=xlTopToBottom, Header:=xlYes\n            End If\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>If you need to look further down that the second row you will need to adjust the conditional statement within the For...Next.</p>\n"}], "owner": {"reputation": 25, "user_id": 4777793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-emUhiLN_osw/AAAAAAAAAAI/AAAAAAAAABA/Dl_AOyxnmWc/photo.jpg?sz=128", "display_name": "memed", "link": "https://stackoverflow.com/users/4777793/memed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1429320200, "creation_date": 1429126354, "last_edit_date": 1429320200, "question_id": 29659206, "link": "https://stackoverflow.com/questions/29659206/sort-a-worksheet-using-a-column-of-dates-as-the-primary-key", "title": "Sort a worksheet using a column of dates as the primary key", "body": "<p>I have a sheet that contains multiple columns; among these columns I have one that contains dates. I want to sort the column that contains the dates and automatically sort the sheet.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3704, "user_id": 1710577, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YoUi5.jpg?s=128&g=1", "display_name": "slayernoah", "link": "https://stackoverflow.com/users/1710577/slayernoah"}, "edited": false, "score": 1, "creation_date": 1429123819, "post_id": 29658413, "comment_id": 47456403, "body": "Could you post your code and mention where you get any error message? otherwise, it will be writing code for a given requirement which is not done on this site"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1429126373, "post_id": 29658413, "comment_id": 47458025, "body": "Have you looked into using perhaps Index/Match with Indirect? Can you post an example table with example output (or where you&#39;d like the output to be)?  here&#39;s a couple of sites: <a href=\"http://www.mrexcel.com/forum/excel-questions/638540-index-indirect-match-functions.html\" rel=\"nofollow noreferrer\">1</a> , <a href=\"http://answers.microsoft.com/en-us/office/forum/office_2010-excel/combine-indirect-and-indexmatch/7fe1042b-bb97-49fc-bfe3-c595113838eb\" rel=\"nofollow noreferrer\">2</a> that may help show indirect with index/match.  You can also enter the index/match as an array formula to use multiple matching criteria."}, {"owner": {"reputation": 41, "user_id": 4783435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f7c3532f1baaeed6dca4c9e5e98ab8d?s=128&d=identicon&r=PG&f=1", "display_name": "wk11", "link": "https://stackoverflow.com/users/4783435/wk11"}, "edited": false, "score": 0, "creation_date": 1429190136, "post_id": 29658413, "comment_id": 47489312, "body": "Thanks for the advice and I apologize for violating protocol. This is my first time posting after reading here a lot. I could not really clean up my code enough to post something understandable. I have been muddling around with programming since (literally) BASIC but never really got into the finer points. I got this working eventually."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 4783435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f7c3532f1baaeed6dca4c9e5e98ab8d?s=128&d=identicon&r=PG&f=1", "display_name": "wk11", "link": "https://stackoverflow.com/users/4783435/wk11"}, "edited": false, "score": 0, "creation_date": 1429126358, "post_id": 29658596, "comment_id": 47458017, "body": "I could use vlookup and would do it that way but would have to supply the column number, which may change. I can use the find function to return a cell, but when I do MyFoundCell.row I get the actual spreadsheet row. I need to find what table row, not absolute row, this is."}], "tags": [], "owner": {"reputation": 303, "user_id": 4430375, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/51ee13ebaef0e2d2b136f5f07b5f5249?s=128&d=identicon&r=PG&f=1", "display_name": "twegner", "link": "https://stackoverflow.com/users/4430375/twegner"}, "is_accepted": false, "score": 0, "last_activity_date": 1429124381, "creation_date": 1429124381, "answer_id": 29658596, "question_id": 29658413, "link": "https://stackoverflow.com/questions/29658413/looking-up-values-in-a-table-with-vba/29658596#29658596", "title": "Looking up values in a table with VBA", "body": "<p>If you are familiar with writing Functions() in vba you could simply have a custom function that contained a few vlookup() functions then organize the output and return it however you want.</p>\n"}], "owner": {"reputation": 41, "user_id": 4783435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f7c3532f1baaeed6dca4c9e5e98ab8d?s=128&d=identicon&r=PG&f=1", "display_name": "wk11", "link": "https://stackoverflow.com/users/4783435/wk11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 238, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1463851588, "creation_date": 1429123749, "question_id": 29658413, "link": "https://stackoverflow.com/questions/29658413/looking-up-values-in-a-table-with-vba", "title": "Looking up values in a table with VBA", "body": "<p>I am trying to lookup values in an excel table using VBA and having trouble getting it all together. I get most of the way there but my code is not worth posting.</p>\n\n<p>What I need to do is write a function with several parameters:\n1. What value to look up\n2. What column name to look this up in\n3. What other column to return the value from</p>\n\n<p>For example, in a table containing Customer_ID, Last_Name, First_Name: pass it \"DoeJohn\", \"Customer_ID\", \"First_Name\" and have it return John. I am not concerned with duplicate values of what I am looking up, finding the first instance is good enough.</p>\n\n<p>The cell it finds may be text, numeric, or date so it needs to return that.\nIf it doesn't find a match it should return something that could never be an actual cell value, and my main program will check for that.</p>\n"}, {"tags": ["ms-access", "database-design", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1429193394, "post_id": 29658176, "comment_id": 47492049, "body": "Any information you want to store so you can retrieve later should go in a table somewhere. If you&#39;re doing balances, it may be better to do a calculated field on a form. A calculated field would not be bound to any field in your table(s), but rather it would use data from your tables in an expression that would calculate the balances while you had the form open."}, {"owner": {"reputation": 43, "user_id": 4793349, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3f524640aae7223660edd7cdd92e5e90?s=128&d=identicon&r=PG&f=1", "display_name": "BrettK", "link": "https://stackoverflow.com/users/4793349/brettk"}, "reply_to_user": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1429212230, "post_id": 29658176, "comment_id": 47505138, "body": "Thanks, that makes sense and that is the direction I am going.  I currently made a transactions table that will hold all the information I want to store.  Now I am working on a query that will sum up &#39;Credits&#39; &amp; &#39;Debits&#39; per account. The expression I have written is - Total Debits: DSum(&quot;[Debit]&quot;,&quot;tblTransactions&quot;,&quot;ClientID =&quot; &amp; [ClientID]).  For some reason it&#39;s not getting formatted as currency like in the table, and when I run the query I can&#39;t sort that column because I get an error message: Syntax error (missing operator) in query expression (&#39;Total Debits&#39;).  Any thoughts?"}, {"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1429264821, "post_id": 29658176, "comment_id": 47528208, "body": "I&#39;d avoid using DSUM in this scenario. Use Totals -&gt; SUM function in your query design and the currency should pull through. It&#39;s accessed in the query design view from the &quot;Design&quot; tab using the &quot;Totals&quot; button (Access 2013). Refer to the screenshot in this article: <a href=\"http://bit.ly/1IRcm5y\" rel=\"nofollow noreferrer\">bit.ly/1IRcm5y</a> ..if you replace the ProductName field with your ClientID field and set the total to &quot;Group By&quot; and then replace the UnitsInStock field with your Debit field and set the total to &quot;Sum&quot; you should get what you&#39;re after (hopefully it&#39;ll sort properly too)."}, {"owner": {"reputation": 43, "user_id": 4793349, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3f524640aae7223660edd7cdd92e5e90?s=128&d=identicon&r=PG&f=1", "display_name": "BrettK", "link": "https://stackoverflow.com/users/4793349/brettk"}, "reply_to_user": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1429296057, "post_id": 29658176, "comment_id": 47549687, "body": "That worked!  They were able to sum correctly and group under each account. I have now setup an expression that can the transaction table."}, {"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1429296326, "post_id": 29658176, "comment_id": 47549840, "body": ":) Great! Glad it worked"}], "owner": {"reputation": 43, "user_id": 4793349, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3f524640aae7223660edd7cdd92e5e90?s=128&d=identicon&r=PG&f=1", "display_name": "BrettK", "link": "https://stackoverflow.com/users/4793349/brettk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1310, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1594644965, "creation_date": 1429123077, "last_edit_date": 1594644965, "question_id": 29658176, "link": "https://stackoverflow.com/questions/29658176/generating-account-balance-in-access-2010", "title": "Generating Account Balance In Access 2010", "body": "<p>This is a higher level question, but it will likely spin into more as I hear back from the group.  </p>\n\n<p>I am looking for the best way to setup Access 2010 to keep track of my client account balances. We sent monthly invoices and they send up a check in return.  I've been scouring the exchange looking for an answer, but haven't quite figured it out yet.  Most say to set up a transaction table, but then how do you find the account balance and where do you put that so it can accessed when generating next months invoice?</p>\n\n<p>My initial thought was to create a table with all the relevant client information; name, address, etc.  Then I will have a table for all my transactions; both in (check rec'd) and out (invoices). </p>\n\n<p>I would set up a form from the transaction table to log the money received, then I would create another form to create invoices, which, upon saving, would log that amount to the transaction table.</p>\n\n<p>It's hard to build something when you just get your mind wrapped around the entire thing.  Any help is appreciated! </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3704, "user_id": 1710577, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YoUi5.jpg?s=128&g=1", "display_name": "slayernoah", "link": "https://stackoverflow.com/users/1710577/slayernoah"}, "edited": false, "score": 0, "creation_date": 1429123539, "post_id": 29657995, "comment_id": 47456229, "body": "If there is more than one instance of a search value on a single sheet, how do you want the user to be able to find the cell that is needed? Do you want the user to click a &#39;Find Next&#39; button, do you want to highlight the cells with matching criteria etc."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4793354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcd92eaf07c905e49e27687962921e2?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4793354/jason"}, "edited": false, "score": 0, "creation_date": 1429125374, "post_id": 29658461, "comment_id": 47457355, "body": "I&#39;m getting a &#39;Variable Not Defined&#39; at firstaddress ="}, {"owner": {"reputation": 23, "user_id": 4793354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcd92eaf07c905e49e27687962921e2?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4793354/jason"}, "edited": false, "score": 0, "creation_date": 1429125610, "post_id": 29658461, "comment_id": 47457510, "body": "Sorry I saw that after. It runs, but after the first search it is just exiting the sub instead of being able to go to the next."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 23, "user_id": 4793354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcd92eaf07c905e49e27687962921e2?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4793354/jason"}, "edited": false, "score": 0, "creation_date": 1429125974, "post_id": 29658461, "comment_id": 47457772, "body": "eh. Sorry about that. I&#39;ve change <code>If not rFound...</code> to <code>While not rFound...</code> to make it loop. You may want something a little spiffier than the <code>MsgBox</code>, but that&#39;s a quick &amp; dirty way to make it pause once it&#39;s move the cursor to the found box. If the user needs to be able to edit cells, then you need to put the <code>Exit Sub</code> back in there, and they&#39;ll need to re-run the macro each time, but it will search from the last found location. Also added a check to make sure it doesn&#39;t loop forever - it exits when it gets back to the first found cell."}, {"owner": {"reputation": 23, "user_id": 4793354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcd92eaf07c905e49e27687962921e2?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4793354/jason"}, "edited": false, "score": 0, "creation_date": 1429126413, "post_id": 29658461, "comment_id": 47458051, "body": "It gets stuck at the &#39;Found One&#39; msgbox and wont allow me to do anything else."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 23, "user_id": 4793354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcd92eaf07c905e49e27687962921e2?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4793354/jason"}, "edited": false, "score": 0, "creation_date": 1429126643, "post_id": 29658461, "comment_id": 47458208, "body": "When you say &quot;stuck&quot;, is that before or after you click the <code>OK</code> button?"}, {"owner": {"reputation": 23, "user_id": 4793354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcd92eaf07c905e49e27687962921e2?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4793354/jason"}, "edited": false, "score": 0, "creation_date": 1429127653, "post_id": 29658461, "comment_id": 47458780, "body": "It&#39;s after I hit &#39;OK&#39;. The msgbox doesn&#39;t go away."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 23, "user_id": 4793354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcd92eaf07c905e49e27687962921e2?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4793354/jason"}, "edited": false, "score": 0, "creation_date": 1429127916, "post_id": 29658461, "comment_id": 47458937, "body": "Ah, my bad. the <code>MsgBox</code> does go away, it&#39;s just that it&#39;s immediately finding the same cell &amp; redisplaying the message. Look at the update to the second <code>.Find()</code> call, specifically, the <code>After</code> parameter."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 23, "user_id": 4793354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcd92eaf07c905e49e27687962921e2?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4793354/jason"}, "edited": false, "score": 0, "creation_date": 1429128532, "post_id": 29658461, "comment_id": 47459289, "body": "If the <code>MsgBox</code> is suitable for giving the user time to look at what was found, you can look into the <a href=\"https://msdn.microsoft.com/en-us/library/aa445082%28v=vs.60%29.aspx\" rel=\"nofollow noreferrer\"><code>Buttons:=</code></a> parameter for some options to get actual feedback. Then, based on the button clicked, either search again, or exit the sub."}, {"owner": {"reputation": 23, "user_id": 4793354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcd92eaf07c905e49e27687962921e2?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4793354/jason"}, "edited": false, "score": 0, "creation_date": 1429129322, "post_id": 29658461, "comment_id": 47459752, "body": "We&#39;re so close FreeMan! It does continue to search once &#39;Ok&#39; is hit, but there is no way to get out of it."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 23, "user_id": 4793354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcd92eaf07c905e49e27687962921e2?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4793354/jason"}, "edited": false, "score": 0, "creation_date": 1429129451, "post_id": 29658461, "comment_id": 47459822, "body": "For now, search til you hit the first one again, then see my <a href=\"http://stackoverflow.com/questions/29657995/findnext-from-inputbox-throughout-workbook/29658461?noredirect=1#comment47459289_29658461\">previous comment</a>."}, {"owner": {"reputation": 23, "user_id": 4793354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcd92eaf07c905e49e27687962921e2?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4793354/jason"}, "edited": false, "score": 0, "creation_date": 1429129980, "post_id": 29658461, "comment_id": 47460123, "body": "Is there a way to search the entire workbook instead of just the first worksheet? Again, I appreciate your help FreeMan."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 23, "user_id": 4793354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcd92eaf07c905e49e27687962921e2?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4793354/jason"}, "edited": false, "score": 0, "creation_date": 1429130471, "post_id": 29658461, "comment_id": 47460414, "body": "Check the updates to the inner <code>While Not...</code> loop. Also, check the last point I just added."}, {"owner": {"reputation": 23, "user_id": 4793354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcd92eaf07c905e49e27687962921e2?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4793354/jason"}, "edited": false, "score": 0, "creation_date": 1429131642, "post_id": 29658461, "comment_id": 47461075, "body": "Any help with the MsgBox? I&#39;m having a hell of a time figuring out where to put everything."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 23, "user_id": 4793354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcd92eaf07c905e49e27687962921e2?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4793354/jason"}, "edited": false, "score": 0, "creation_date": 1429144297, "post_id": 29658461, "comment_id": 47466068, "body": "Why don&#39;t you update your OP. Add your current code - that will make it a lot easier to figure out what&#39;s going on."}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 1, "last_activity_date": 1429130566, "last_edit_date": 1429130566, "creation_date": 1429123917, "answer_id": 29658461, "question_id": 29657995, "link": "https://stackoverflow.com/questions/29657995/findnext-from-inputbox-throughout-workbook/29658461#29658461", "title": "FindNext from InputBox throughout Workbook", "body": "<p>You need to modify your search so your code 'remembers' where it left off, like this:</p>\n\n<pre><code>Option Explicit\n\nDim ws As Worksheet\nDim rFound As Range\nDim strName As String\nStatic First as Range\n\n'On Error Resume Next\nif First is Nothing Then   'we haven't found anything yet\n  Set First = Worksheets(1).Cells(1,1)  'start searching at the beginning\nEnd If\n\nstrName = InputBox(\"Please Enter Search Value.\" &amp; vbNewLine &amp; \"Entry Must Be Exact Cell Value!\", \"Search Value\")\nIf strName = \"\" Then Exit Sub\nFor Each ws In Worksheets\n    With ws.UsedRange\n        Set rFound = .Find(What:=strName, After:=First, LookIn:=xlValues, LookAt:=xlPart)\n        while Not rFound Is Nothing\n            if first is nothing then\n              First = rFound   'store off this address for use in our next search\n            end if\n            if first &lt;&gt; rFound Then    'we've found a NEW instance of the search item\n              firstaddress = rFound.Address\n              Application.Goto rFound, True\n              MsgBox \"Found one!\"\n              Set rFound = .Find(What:=strName, After:=rFound, LookIn:=xlValues, LookAt:=xlPart)\n            else  'we're back at the start, so jump out of the loop\n              set rFound = Nothing\n            End If\n        wEnd\n    End With\nNext ws\nOn Error GoTo 0\n\nMsgBox \"Merchant not found. Please make sure you typed it correctly.\", vbOKOnly + vbCritical, \"Invalid Entry\"\n</code></pre>\n\n<p>A couple of points:</p>\n\n<ul>\n<li>I added <code>Option Explicit</code> which means your code won't run now because you never declared <code>firstaddress</code>. It's vital for your sanity to enable that option from the ribbon: Tools | Options | Editor then check <code>Require Variable Declaration</code></li>\n<li>By declaring <code>First</code> as a <code>Static</code>, it will remain set between calls to your search routine. That way, since we're feeding <code>First</code> into the <code>.Find()</code> function, it will pick up the search where it left off.</li>\n<li>If you need to start the search from the beginning again, you could store off the 'last' search term - if the current term is different from the last term, reset <code>set First = Worksheets(1).Cells(1,1)</code></li>\n<li>Additional note - <code>On Error Resume Next</code> is useful in <strong>very</strong> limited situations. This isn't one of them. It allows you to ignore an error in your code so that you can immediately handle it, which isn't what you want in this situation. The follow up <code>On Error Goto 0</code>, which reenables the default error handling should really never be more than 1 line of code later - not an entire subroutine.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 23, "user_id": 4793354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcd92eaf07c905e49e27687962921e2?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4793354/jason"}, "edited": false, "score": 0, "creation_date": 1429133490, "post_id": 29661175, "comment_id": 47462138, "body": "No worries, and if you wish to do so - here is the MSDN article for reference: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196143.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff196143.aspx</a>"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 23, "user_id": 4793354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcd92eaf07c905e49e27687962921e2?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4793354/jason"}, "edited": false, "score": 0, "creation_date": 1429133596, "post_id": 29661175, "comment_id": 47462190, "body": "Also, FreeMan&#39;s comment about <code>On Error Resume Next</code> - I can&#39;t put enough emphasis on how much you should take note of that."}, {"owner": {"reputation": 23, "user_id": 4793354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcd92eaf07c905e49e27687962921e2?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4793354/jason"}, "edited": false, "score": 0, "creation_date": 1429134276, "post_id": 29661175, "comment_id": 47462548, "body": "Thanks for the tip. I know just enough to be dangerous, but have so much more to learn. Appreciate your assistance guys."}, {"owner": {"reputation": 23, "user_id": 4793354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcd92eaf07c905e49e27687962921e2?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4793354/jason"}, "edited": false, "score": 0, "creation_date": 1429134571, "post_id": 29661175, "comment_id": 47462685, "body": "Actually, it seems to be having the popups twice. I click and its has the same msgbox twice."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 23, "user_id": 4793354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcd92eaf07c905e49e27687962921e2?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4793354/jason"}, "edited": false, "score": 0, "creation_date": 1429135774, "post_id": 29661175, "comment_id": 47463178, "body": "@Jason needed another condition, see edited response"}, {"owner": {"reputation": 23, "user_id": 4793354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcd92eaf07c905e49e27687962921e2?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4793354/jason"}, "edited": false, "score": 0, "creation_date": 1429136073, "post_id": 29661175, "comment_id": 47463294, "body": "That works like a charm now. Once I have landed on the one I want, at what spot in the code would I put the code I need to pull it into a userform? Basically when it says &#39;Match Found&#39; I hit &#39;No&#39; and then it pulls the rowdata."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 23, "user_id": 4793354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcd92eaf07c905e49e27687962921e2?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4793354/jason"}, "edited": false, "score": 0, "creation_date": 1429136731, "post_id": 29661175, "comment_id": 47463555, "body": "Is that within the scope of your question? I would suggest (for continuity of the site&#39;s search facility) for you to either edit the original question, or post that as a separate question."}, {"owner": {"reputation": 23, "user_id": 4793354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcd92eaf07c905e49e27687962921e2?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4793354/jason"}, "edited": false, "score": 0, "creation_date": 1429137542, "post_id": 29661175, "comment_id": 47463848, "body": "Thanks @SOofWXLS. Appreciate your assistance!"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 0, "last_activity_date": 1429135750, "last_edit_date": 1429135750, "creation_date": 1429132923, "answer_id": 29661175, "question_id": 29657995, "link": "https://stackoverflow.com/questions/29657995/findnext-from-inputbox-throughout-workbook/29661175#29661175", "title": "FindNext from InputBox throughout Workbook", "body": "<p>VBA already has a <code>.FindNext()</code> method for this very purpose:</p>\n\n<pre><code>Sub SO()\n\nDim inputString     As String\nDim foundCell       As Excel.Range\nDim wSheet          As Excel.Worksheet\nDim foundAddress    As String\n\ninputString = InputBox(\"Please enter search term:\", \"Search\")\n\nFor Each wSheet In ActiveWorkbook.Worksheets\n    Set foundCell = wSheet.Cells.Find(inputString, , -4163, 2)\n    If Not foundCell Is Nothing Then\n        Application.Goto foundCell, True\n        foundAddress = foundCell.Address\n        If MsgBox(\"Match in \" &amp; wSheet.Name &amp; \" (\" &amp; foundCell.Address &amp; \")\" &amp; vbCrLf &amp; \"Continue?\", 68, \"Match Found\") = vbYes Then\n            Do\n                Set foundCell = wSheet.Cells.FindNext(foundCell)\n                If Not foundCell Is Nothing And Not foundCell.Address = foundAddress Then\n                    Application.Goto foundCell, True\n                Else\n                    Exit Do\n                End If\n\n            Loop While MsgBox(\"Match in \" &amp; wSheet.Name &amp; \" (\" &amp; foundCell.Address &amp; \")\" &amp; vbCrLf &amp; \"Continue?\", 68, \"Match Found\") = vbYes And _\n                    Not foundCell Is Nothing And Not foundCell.Address = foundAddress\n                        Set foundCell = wSheet.Cells.FindNext(foundCell)\n        End If\n    End If\n    If MsgBox(\"All matches in this sheet found - move to next sheet?\", 68, \"Next Sheet?\") = vbNo Then Exit Sub\nNext wSheet\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4793354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dcd92eaf07c905e49e27687962921e2?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4793354/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 29661175, "answer_count": 2, "score": 2, "last_activity_date": 1432357969, "creation_date": 1429122530, "last_edit_date": 1432357969, "question_id": 29657995, "link": "https://stackoverflow.com/questions/29657995/findnext-from-inputbox-throughout-workbook", "title": "FindNext from InputBox throughout Workbook", "body": "<p>Noob here. I've found plenty of code on this site and want to say thanks to all those who contribute. </p>\n\n<p>My question is I have a UserForm. I click a button to bring up an InputBox, where they enter a value to search for bank name, banker name, business name, etc.</p>\n\n<p>I have the code to do the search no problem, but I want to be able to be able to continue to search all of the instances of the InputBox value. For example, searching for the name \"Smith\" and if the first one isn't the one I need, to continue the search until I've landed on the one I'm looking for.</p>\n\n<pre><code>Dim ws As Worksheet\nDim rFound As Range\nDim strName As String\n\nOn Error Resume Next\nstrName = InputBox(\"Please Enter Search Value.\" &amp; vbNewLine &amp; \"Entry Must Be Exact Cell Value!\", \"Search Value\")\nIf strName = \"\" Then Exit Sub\nFor Each ws In Worksheets\n    With ws.UsedRange\n        Set rFound = .Find(What:=strName, After:=.Cells(1, 1), LookIn:=xlValues, LookAt:=xlPart)\n        If Not rFound Is Nothing Then\n            firstaddress = rFound.Address\n            Application.Goto rFound, True\n            Exit Sub\n        End If\n    End With\nNext ws\nOn Error GoTo 0\n\nMsgBox \"Merchant not found. Please make sure you typed it correctly.\", vbOKOnly + vbCritical, \"Invalid Entry\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4793021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ec670b80f1799a1f1d5d5a4bd118303?s=128&d=identicon&r=PG&f=1", "display_name": "Tayto", "link": "https://stackoverflow.com/users/4793021/tayto"}, "edited": false, "score": 0, "creation_date": 1429356991, "post_id": 29657856, "comment_id": 47568099, "body": "Thanks slayernoah, you got me out of a corner! this is exactly what I needed."}], "tags": [], "owner": {"reputation": 3704, "user_id": 1710577, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YoUi5.jpg?s=128&g=1", "display_name": "slayernoah", "link": "https://stackoverflow.com/users/1710577/slayernoah"}, "is_accepted": true, "score": 0, "last_activity_date": 1429358069, "last_edit_date": 1429358069, "creation_date": 1429122058, "answer_id": 29657856, "question_id": 29657778, "link": "https://stackoverflow.com/questions/29657778/search-for-a-value-in-a-column-which-is-equal-to-cell-value-in-another-sheet-th/29657856#29657856", "title": "Search for a value in a column which is equal to cell value in another sheet, then copy paste to new location", "body": "<pre><code>What:=Sheets(\"Sheet1\").Range(\"A1\").Value\n</code></pre>\n\n<p>Assuming \"Sheet1\" is the name of the sheet you need.</p>\n\n<p>The exact requirements for copy paste is not clear. Here is generic code to perform copy/paste operations:</p>\n\n<p>Example: Copy/paste from cell B1 to B2:</p>\n\n<pre><code>Sheets(\"Sheet1\").Range(\"B1\").Select\nSelection.Copy\nSheets(\"Sheet1\").Range(\"B2\").Select\nSheets(\"Sheet1\").Paste\n</code></pre>\n\n<p>OR simply,</p>\n\n<pre><code>Sheets(\"Sheet1\").Range(\"B2\").Value = Sheets(\"Sheet1\").Range(\"B1\").Value\n</code></pre>\n\n<p><code>Sheets(\"Sheet1\").</code> part in the code is needed if you are referring to sheets other than the currently active sheet. If you are working within the curently active sheet only, then this part can be omitted.</p>\n"}], "owner": {"reputation": 3, "user_id": 4793021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ec670b80f1799a1f1d5d5a4bd118303?s=128&d=identicon&r=PG&f=1", "display_name": "Tayto", "link": "https://stackoverflow.com/users/4793021/tayto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 29657856, "answer_count": 1, "score": 0, "last_activity_date": 1429358069, "creation_date": 1429121778, "last_edit_date": 1429124008, "question_id": 29657778, "link": "https://stackoverflow.com/questions/29657778/search-for-a-value-in-a-column-which-is-equal-to-cell-value-in-another-sheet-th", "title": "Search for a value in a column which is equal to cell value in another sheet, then copy paste to new location", "body": "<p>I need to search column R in sheet 2 for the integer value from sheet 1 Cell A1. Then need to copy 20 cells along row sheet 2, then paste to cell G8 sheet 2. \nI've tried this code but don't know what to enter in the <code>Find(What:=</code>\nor copy bits</p>\n\n<pre><code>Columns(\"R:R\").Select\n    Set cell = Selection.Find(What:=\"??????\", After:=ActiveCell,  LookIn:=xlFormulas, _\n        LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n        MatchCase:=False, SearchFormat:=False)\n</code></pre>\n"}, {"tags": ["email", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1429191163, "post_id": 29664896, "comment_id": 47490197, "body": "When you say &quot;MyNumericKey&quot; is this like the autonumber key each record gets?"}, {"owner": {"reputation": 1967, "user_id": 2548338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5334e079c2f6bf8785e552f4cbb27796?s=128&d=identicon&r=PG", "display_name": "pteranodon", "link": "https://stackoverflow.com/users/2548338/pteranodon"}, "reply_to_user": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1429193899, "post_id": 29664896, "comment_id": 47492427, "body": "@Brianna I have changed it to <code>ID</code> but you must name it with your primary key field&#39;s name."}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1429277262, "post_id": 29664896, "comment_id": 47536873, "body": "Ok I got it now! Thanks :) I would just put an and between the field if I have more than one primary key right?"}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1429289627, "post_id": 29664896, "comment_id": 47545750, "body": "So say I have four fields that are my primary key: CurrentDate, Discover, Tail, and FleetID and CurrentDate is a date field and the other three are text fields. Would it look like what I added above?"}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "edited": false, "score": 0, "creation_date": 1429292663, "post_id": 29664896, "comment_id": 47547651, "body": "I cant seem to get the code correct I keep getting a Syntax Error"}], "tags": [], "owner": {"reputation": 1967, "user_id": 2548338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5334e079c2f6bf8785e552f4cbb27796?s=128&d=identicon&r=PG", "display_name": "pteranodon", "link": "https://stackoverflow.com/users/2548338/pteranodon"}, "is_accepted": true, "score": 2, "last_activity_date": 1429288261, "last_edit_date": 1429288261, "creation_date": 1429155400, "answer_id": 29664896, "question_id": 29657204, "link": "https://stackoverflow.com/questions/29657204/emailing-pdf-from-access/29664896#29664896", "title": "Emailing PDF from Access", "body": "<p>It sounds like your form currently has 15 records. When you use SendObject on a form, it prints <strong>all</strong> records in the form, not just the current one, into the PDF. I think you need to filter your form to show only the current record, then SendObject. If your data source has a primary key field named <code>ID</code> use:</p>\n\n<pre><code>Me.Filter = \"ID=\" &amp; Me!ID\nMe.FilterOn = True\nDoCmd.SendObject acSendForm, \"frmETIC\", ...\n</code></pre>\n\n<p>If you have a multi-field primary key use:</p>\n\n<pre><code>Me.Filter = \"ID=\" &amp; Me!ID &amp; \" AND CustName = '\" &amp; Me!CustName &amp; \"'\"\nMe.FilterOn = True\n</code></pre>\n\n<p>Use no delimiter for numeric fields, quotes around text field values, and <code>#</code> around date field values formatted mm/dd/yyyy.</p>\n"}], "owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 29664896, "answer_count": 1, "score": 2, "last_activity_date": 1594644953, "creation_date": 1429119954, "last_edit_date": 1594644953, "question_id": 29657204, "link": "https://stackoverflow.com/questions/29657204/emailing-pdf-from-access", "title": "Emailing PDF from Access", "body": "<p>I have just recently coded behind a command button to send an email of a form, but when the email pops up and I open the PDF file there are 15 duplicates of the same form. Does anybody know why this would be happening?</p>\n\n<p>Thanks :)</p>\n\n<pre><code>On Error GoTo errhandle\nDoCmd.SendObject acSendForm, \"frmETIC\", acFormatPDF, \"email address\", \"\", \"\", \"Recovery Report\", \"Attached is the submitted Recovery Report\"\nexitErr:\nExit Sub\nerrhandle:\nIf Err.Number &lt;&gt; 2501 Then\nMsgBox (\"Email cancelled!\")\nEnd If\nResume exitErr\n\n\nMe.Filter = \"CurrentDate= #\" &amp; Me!CurrentDate &amp; \"#\" AND \"Discover= '\" &amp; Me!Discover &amp; \"'\" AND \"Tail= '\" &amp; Me!Tail &amp; \"'\" AND \"FleetID= '\" &amp; Me!FleetID &amp; \"'\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7225, "user_id": 1899628, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PAWN2.png?s=128&g=1", "display_name": "stenci", "link": "https://stackoverflow.com/users/1899628/stenci"}, "edited": false, "score": 0, "creation_date": 1429119837, "post_id": 29657040, "comment_id": 47453904, "body": "What is <code>module2</code>? How is newModule declared?"}, {"owner": {"reputation": 1, "user_id": 4793111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99c17e4ce21cc6baafd971d535165471?s=128&d=identicon&r=PG&f=1", "display_name": "Mat Davies", "link": "https://stackoverflow.com/users/4793111/mat-davies"}, "reply_to_user": {"reputation": 7225, "user_id": 1899628, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PAWN2.png?s=128&g=1", "display_name": "stenci", "link": "https://stackoverflow.com/users/1899628/stenci"}, "edited": false, "score": 0, "creation_date": 1429170809, "post_id": 29657040, "comment_id": 47475582, "body": "it&#39;s created at runtime, the code for it is contained in &#39;stng&#39;."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4793111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99c17e4ce21cc6baafd971d535165471?s=128&d=identicon&r=PG&f=1", "display_name": "Mat Davies", "link": "https://stackoverflow.com/users/4793111/mat-davies"}, "edited": false, "score": 0, "creation_date": 1429170189, "post_id": 29663638, "comment_id": 47475207, "body": "Thanks for your response. Unfortunately that approach doesn&#39;t seem to work as the formula doesn&#39;t return a result and the dirty property seems to override manual calculation, forcing a recalculation anyway. I&#39;ve updated the question to be more clear."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 0, "last_activity_date": 1429146565, "creation_date": 1429146565, "answer_id": 29663638, "question_id": 29657040, "link": "https://stackoverflow.com/questions/29657040/vba-function-forcing-recalculation/29663638#29663638", "title": "VBA function forcing recalculation", "body": "<p>Just turn off calculation beforehand:</p>\n\n<pre><code>Application.Calculation = xlCalculateManual\n</code></pre>\n\n<p>When you're ready, you can force a calculation with...</p>\n\n<pre><code>Application.Calculate\n</code></pre>\n\n<p>...and then turn it back on with:</p>\n\n<pre><code>Application.Calculation = xlCalculationAutomatic\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4793111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99c17e4ce21cc6baafd971d535165471?s=128&d=identicon&r=PG&f=1", "display_name": "Mat Davies", "link": "https://stackoverflow.com/users/4793111/mat-davies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 439, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429170511, "creation_date": 1429119434, "last_edit_date": 1429170511, "question_id": 29657040, "link": "https://stackoverflow.com/questions/29657040/vba-function-forcing-recalculation", "title": "VBA function forcing recalculation", "body": "<p>I have a DLL that I'm calling through an Excel VBA function using a subroutine containing <code>Declare Function &lt;func&gt; Lib</code>. In order to control the location of the dll, I'm using <code>Application.VBE</code> to create a module at run time that contains the function reference (a bit messy, but the only solution that seemed to work). </p>\n\n<p>Everything works fine, but modifying modules has the unwelcome consequence that the cell is marked as dirty immediately after evaluation causing i) no result to be written to the cell and ii) immediate revaluation of the function. </p>\n\n<p>Is there a way to prevent a function from dirtying the cell? </p>\n\n<p>pseudo-code (actual code is pretty horrible)</p>\n\n<p>Module1:</p>\n\n<pre><code>Function main()\n  newModule = Proj.vbcomponents.Add(1).CodeModule.AddFromString(stng)\n  main = module2.callDll()\nEnd Function\n</code></pre>\n\n<p>Module2 (contained within stng):</p>\n\n<pre><code>Declare Function &lt;func&gt; Lib\nFunction callDll()\n  callDll = func\nEnd Function\n</code></pre>\n\n<p>I am calling the function in a worksheet cell using <code>=main()</code></p>\n\n<p>Thanks!</p>\n\n<p>Mat</p>\n\n<p>UPDATE</p>\n\n<p>I have tried converting to manual calculation, but this doesn't seem to solve either problem described above. The following code demonstrates the problem </p>\n\n<pre><code>Function main()\n  Application.Calculation = xlCalculationManual\n  Dim stng As String\n  stng = _\n  \"Function callDll()\" &amp; Chr(13) &amp; _\n  \"callDll = 1\" &amp; Chr(13) &amp; _\n  \"End Function\"\n  On Error Resume Next\n  ThisWorkbook.VBProject.VBComponents.Remove ThisWorkbook.VBProject.VBComponents(6)\n  On Error GoTo 0\n  ThisWorkbook.VBProject.VBComponents.Add(vbext_ct_StdModule).CodeModule.AddFromString (stng)\n  main = Module2.callDll()\nEnd Function\n\nFunction mainAlt()\n  mainAlt = Module2.callDll()\nEnd Function\n</code></pre>\n\n<p>A worksheet call to <code>=main()</code> returns zero but a call to <code>=mainAlt()</code> returns the correct result (one) </p>\n\n<p>Note that 'visual basic for applications extensibility...' needs to be enabled as a reference for this to work, and i've lazily assumed that the created module will have index 6. </p>\n\n<p>Cheers </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1429123146, "creation_date": 1429123146, "answer_id": 29658203, "question_id": 29656818, "link": "https://stackoverflow.com/questions/29656818/nested-if-else-end-if-within-select-case/29658203#29658203", "title": "Nested If/Else/End If within Select Case", "body": "<p>There were a few discrepancies between what you described and what your code sample indicated so I went with the former.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"A:X\")) Is Nothing Then\n        On Error GoTo safe_exit\n        Application.EnableEvents = False\n        Dim rw As Long, rng As Range\n        For Each rng In Intersect(Target, Range(\"A:X\"))\n            rw = rng.Row\n            If rw &gt; 1 Then\n                Select Case LCase(Cells(rw, \"X\").Value2)\n                    Case \"open\"\n                        If Cells(rw, \"T\").Value &lt;&gt; \"\" And Cells(rw, \"T\").Value &lt;= Date Then\n                            Cells(rw, \"A\").Resize(1, 24).Interior.ColorIndex = 3\n                        Else\n                            Cells(rw, \"A\").Resize(1, 24).Interior.Pattern = xlNone\n                        End If\n                    Case \"completed\"\n                        Cells(rw, \"A\").Resize(1, 24).Interior.ColorIndex = 15\n                    Case \"rescinded\"\n                        Cells(rw, \"A\").Resize(1, 23).Interior.ColorIndex = 15\n                        Cells(rw, \"X\").Interior.ColorIndex = 46\n                    Case Else\n                        Cells(rw, \"A\").Resize(1, 24).Interior.Pattern = xlNone 'use pattern to turn off interior fill\n                End Select\n            End If\n        Next rng\n    End If\nsafe_exit:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>That should also handle multiple entries like those received from pasting a number of values into the sheet. By 'white' I assumed that you meant to remove any fill color, not actually provide a white fill color.</p>\n"}], "owner": {"reputation": 21, "user_id": 4793036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bef71b3c3212b2644bfb073ffadcfc5?s=128&d=identicon&r=PG&f=1", "display_name": "brandeetercek", "link": "https://stackoverflow.com/users/4793036/brandeetercek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 5065, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1429320442, "creation_date": 1429118751, "last_edit_date": 1531161705, "question_id": 29656818, "link": "https://stackoverflow.com/questions/29656818/nested-if-else-end-if-within-select-case", "title": "Nested If/Else/End If within Select Case", "body": "<p>I have an Excel 2010 form. I am trying to change the row color based on several variables. </p>\n\n<p>I do understand that this can be accomplished with conditional formatting and have got that to work, but cutting and pasting, as my users will likely do, kills the formatting. I was hoping that VBA would fix that. Possibly there is some other solution I am unaware of.</p>\n\n<p>This is what I want to happen (the so called logic)</p>\n\n<pre><code> on Sheet3  \n Columns (a \u2013 w)  \n rows (2 \u2013 10485)  \n upon a change in any field, $x2, or a past due date in $T2\n\nif(AND($X2=\"Open\",$T2&lt;&gt;\"\",$T2&lt;=TODAY()) then all row red ($a2-$x2)\nif(AND($X2=\"Open\",$T2=\"\",$T2&gt;TODAY()) then all row white ($a2-$x2)\n=$X2=\"Completed\" then all row grey ($a2-$x2)\n=$X2=\"Rescinded\" then $X2 = orange and $A2 thru $W2 = grey\n</code></pre>\n\n<p>The <code>x</code> field will use a drop down and be either ( blank, open, completed, or rescinded )</p>\n\n<p>This is the code I have tried to hobble together and failed with.....</p>\n\n<pre><code>Option Explicit\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n     If Intersect(Target, Range(\"A2:X1048567\")) Is Nothing Then Exit Sub\n     Select Case Cells(Target.Row, \"X\").Value\n     Case \"Open\"\n     If Cells(Target.Row, \"T\").Value &lt;&gt; \"\" And T2 &lt;= TODAY() Then 'Range(Cells(Target.Row, \"A\"), Cells(Target.Row, \"F\")).Interior.ColorIndex = 3\n     Else\n     Range(Cells(Target.Row, \"A\"), Cells(Target.Row, \"F\")).Interior.ColorIndex = x1None\n     End Select\n\n     Case \"Completed\"\n     Range(Cells(Target.Row, \"A\"), Cells(Target.Row, \"F\")).Interior.ColorIndex = 15\n     Case \"Rescinded\"\n     Range(Cells(Target.Row, \"A\"), Cells(Target.Row, \"F\")).Interior.ColorIndex = 15\n     Range(Cells(Target.Row, \"A\"), Cells(Target.Row, \"F\")).Interior.ColorIndex = 46\n     Case \"\"\n     Range(Cells(Target.Row, \"A\"), Cells(Target.Row, \"F\")).Interior.ColorIndex = xlNone\n     End Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "foreach", "vba"], "answers": [{"comments": [{"owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "edited": false, "score": 0, "creation_date": 1429132028, "post_id": 29657199, "comment_id": 47461293, "body": "@ PatD it works if a form control is used as opposed to activeX controls"}], "tags": [], "owner": {"reputation": 26, "user_id": 2942493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/176bba356d08c01f7e9985f20ba69e35?s=128&d=identicon&r=PG&f=1", "display_name": "Pat D", "link": "https://stackoverflow.com/users/2942493/pat-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1429119939, "creation_date": 1429119939, "answer_id": 29657199, "question_id": 29656518, "link": "https://stackoverflow.com/questions/29656518/command-button-deletes-when-i-run-script-vba/29657199#29657199", "title": "Command button deletes when I run script VBA", "body": "<h2>This may not be exact, but it should get you on the right path</h2>\n\n<pre><code>Private Sub CommandButton1_Click()\nScreenUpdating = False\n\nFor Each Sheet In Worksheets\n    Sheet.Activate\n    For Each Pic In ActiveSheet.Pictures\n        If Pic &lt;&gt; CommandButton1.Picture Then\n            Pic.Delete\n        End If\n    Next Pic\nNext Sheet\n\nScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1429350461, "creation_date": 1429117776, "last_edit_date": 1531164843, "question_id": 29656518, "link": "https://stackoverflow.com/questions/29656518/command-button-deletes-when-i-run-script-vba", "title": "Command button deletes when I run script VBA", "body": "<p>I have a VBA script which <strong>runs to delete any pictures / screen shots</strong> in Excel in <strong>all worksheets</strong>. However when I press the button, my button is also deleted.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nScreenUpdating = False\n\nFor Each Sheet In Worksheets\n    Sheet.Activate\n    For Each Pic In ActiveSheet.Pictures\n        Pic.Delete\n    Next Pic\nNext Sheet\n\nScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "csv", "ms-word"], "comments": [{"owner": {"reputation": 892, "user_id": 2883071, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e5ba9b9e7e629478194565fc83b46cda?s=128&d=identicon&r=PG&f=1", "display_name": "user2883071", "link": "https://stackoverflow.com/users/2883071/user2883071"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1429120534, "post_id": 29656502, "comment_id": 47454355, "body": "@MaciejLos I have edited the post and added my attempt"}], "answers": [{"comments": [{"owner": {"reputation": 892, "user_id": 2883071, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e5ba9b9e7e629478194565fc83b46cda?s=128&d=identicon&r=PG&f=1", "display_name": "user2883071", "link": "https://stackoverflow.com/users/2883071/user2883071"}, "edited": false, "score": 0, "creation_date": 1429122376, "post_id": 29657484, "comment_id": 47455536, "body": "This is an awesome start, however I was looking for a more efficient way of finding for the correct line without storing the whole file in an array or a script. But I guess I can adapt method 1 to loop until the line beginning with &quot;blah&quot; has been found, and then break out of the loop"}, {"owner": {"reputation": 8750, "user_id": 45084, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23bf7f3caa0269ec36ae928757bfb932?s=128&d=identicon&r=PG", "display_name": "Tmdean", "link": "https://stackoverflow.com/users/45084/tmdean"}, "reply_to_user": {"reputation": 892, "user_id": 2883071, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e5ba9b9e7e629478194565fc83b46cda?s=128&d=identicon&r=PG&f=1", "display_name": "user2883071", "link": "https://stackoverflow.com/users/2883071/user2883071"}, "edited": false, "score": 0, "creation_date": 1429122443, "post_id": 29657484, "comment_id": 47455580, "body": "Yep, that would be the general idea. Loop until csv_line(0) = &quot;blah&quot; and then break and return csv_line from the function. Just don&#39;t forget to close the input file."}, {"owner": {"reputation": 8750, "user_id": 45084, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23bf7f3caa0269ec36ae928757bfb932?s=128&d=identicon&r=PG", "display_name": "Tmdean", "link": "https://stackoverflow.com/users/45084/tmdean"}, "reply_to_user": {"reputation": 892, "user_id": 2883071, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e5ba9b9e7e629478194565fc83b46cda?s=128&d=identicon&r=PG&f=1", "display_name": "user2883071", "link": "https://stackoverflow.com/users/2883071/user2883071"}, "edited": false, "score": 1, "creation_date": 1429137624, "post_id": 29657484, "comment_id": 47463871, "body": "I&#39;ve updated the code to match your specification. The functions now take a field index and a field value to search for and return the first line that matches as an array. If a line is not found, they return Empty."}, {"owner": {"reputation": 892, "user_id": 2883071, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e5ba9b9e7e629478194565fc83b46cda?s=128&d=identicon&r=PG&f=1", "display_name": "user2883071", "link": "https://stackoverflow.com/users/2883071/user2883071"}, "edited": false, "score": 0, "creation_date": 1429196445, "post_id": 29657484, "comment_id": 47494536, "body": "thanks, for the help, I tried implementing it in another way, without the function, but for some reason it does not work that well: <a href=\"http://stackoverflow.com/questions/29660745/vba-script-always-returns-true-and-exits\" title=\"vba script always returns true and exits\">stackoverflow.com/questions/29660745/&hellip;</a> . I tried it your way, but I am having trouble with the variables, as I cant reference the returned result as it is not an array, but a variant"}, {"owner": {"reputation": 8750, "user_id": 45084, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23bf7f3caa0269ec36ae928757bfb932?s=128&d=identicon&r=PG", "display_name": "Tmdean", "link": "https://stackoverflow.com/users/45084/tmdean"}, "reply_to_user": {"reputation": 892, "user_id": 2883071, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e5ba9b9e7e629478194565fc83b46cda?s=128&d=identicon&r=PG&f=1", "display_name": "user2883071", "link": "https://stackoverflow.com/users/2883071/user2883071"}, "edited": false, "score": 1, "creation_date": 1429202626, "post_id": 29657484, "comment_id": 47499238, "body": "It&#39;s a variant array. You should be able to access it like any other array. Declare the variable that receives the result as a Variant and index it like a normal array e.g. result(3)"}, {"owner": {"reputation": 8750, "user_id": 45084, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23bf7f3caa0269ec36ae928757bfb932?s=128&d=identicon&r=PG", "display_name": "Tmdean", "link": "https://stackoverflow.com/users/45084/tmdean"}, "reply_to_user": {"reputation": 892, "user_id": 2883071, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e5ba9b9e7e629478194565fc83b46cda?s=128&d=identicon&r=PG&f=1", "display_name": "user2883071", "link": "https://stackoverflow.com/users/2883071/user2883071"}, "edited": false, "score": 1, "creation_date": 1429202679, "post_id": 29657484, "comment_id": 47499262, "body": "Don&#39;t forget to check if no result was found before you try to index it, though. If IsEmpty(result) Then Debug.Print &quot;no result found&quot;"}, {"owner": {"reputation": 892, "user_id": 2883071, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e5ba9b9e7e629478194565fc83b46cda?s=128&d=identicon&r=PG&f=1", "display_name": "user2883071", "link": "https://stackoverflow.com/users/2883071/user2883071"}, "edited": false, "score": 0, "creation_date": 1429204073, "post_id": 29657484, "comment_id": 47500143, "body": "Thanks a lot! I implemented most of this code, and it works perfectly!"}], "tags": [], "owner": {"reputation": 8750, "user_id": 45084, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23bf7f3caa0269ec36ae928757bfb932?s=128&d=identicon&r=PG", "display_name": "Tmdean", "link": "https://stackoverflow.com/users/45084/tmdean"}, "is_accepted": true, "score": 2, "last_activity_date": 1429138330, "last_edit_date": 1429138330, "creation_date": 1429120838, "answer_id": 29657484, "question_id": 29656502, "link": "https://stackoverflow.com/questions/29656502/searching-for-a-row-in-a-csv-file-using-vba/29657484#29657484", "title": "Searching for a row in a csv file using VBA", "body": "<p>In VBA, there are two standard options for reading files.</p>\n\n<ol>\n<li>The built in VBA file access statements and functions: Open, Input,\nWrite, Print, Get, Put, et al. Consult <a href=\"https://msdn.microsoft.com/EN-US/library/office/jj692818.aspx\" rel=\"nofollow\">your favorite VBA reference</a>\nfor details.</li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/6kxy1a51(v=vs.84).aspx\" rel=\"nofollow\">Scripting.FileSystemObject</a>. Add a reference to \"Microsoft Scripting\nRuntime\". This should be available on every Windows PC since around\nWindows 98, so there isn't a compatibility risk.</li>\n</ol>\n\n<p>Both methods have benefits and drawbacks. The built in commands support binary files, but the API is strange and based off of very old versions of BASIC. FileSystemObject has a more modern API, but only supports text files.</p>\n\n<p>Example using method 1:</p>\n\n<pre><code>Function FindEntry(file_path As String, _\n                   field_index As Long, field_value As String) As Variant\n    Dim file_number As Integer\n    Dim raw_line As String\n    Dim csv_line As Variant\n\n    file_number = FreeFile\n    Open file_path For Input As #file_number\n\n    Do Until EOF(file_number)\n        Line Input #file_number, raw_line\n        csv_line = ProcessCsvData(raw_line)\n\n        If UBound(csv_line) &lt; field_index Then\n            ' Guard against index out of bounds\n        ElseIf csv_line(field_index) = field_value Then\n            FindEntry = csv_line\n            Exit Do\n        End If\n    Loop\n\n    Close #file_number\nEnd Function\n</code></pre>\n\n<p>Example using method 2:</p>\n\n<pre><code>Function FindEntry(file_path As String, _\n                   field_index As Long, field_value As String) As Variant\n    ' use the type Scripting.FileSystemObject if you include a reference\n    ' to \"Microsoft Scripting Runtime\"\n    Dim fs As Object\n    Dim txt_file As Object\n    Dim csv_line As Variant\n\n    Set fs = CreateObject(\"Scripting.FileSystemObject\")\n    Set txt_file = fs.OpenTextFile(file_path)\n\n    Do Until txt_file.AtEndOfStream\n        csv_line = ProcessCsvData(txt_file.ReadLine)\n\n        If UBound(csv_line) &lt; field_index Then\n            ' Guard against index out of bounds\n        ElseIf csv_line(field_index) = field_value Then\n            FindEntry = csv_line\n            Exit Do\n        End If\n    Loop\n\n    txt_file.Close\nEnd Function\n</code></pre>\n\n<p>Both methods are using a function called \"ProcessCsvData\", which is a function that you need to write that will split a CSV line into fields. A very naive implementation of this function would be like this.</p>\n\n<pre><code>' Warning: This code is wrong!\nFunction ProcessCsvData(csv_line As String) As Variant\n    ProcessCsvData = Split(csv_line, \",\")\nEnd Function\n</code></pre>\n\n<p>Of course, that doesn't take into account fields that include commas in them, which are typically marked by enclosing the field in quotes in most CSV formats.</p>\n"}], "owner": {"reputation": 892, "user_id": 2883071, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e5ba9b9e7e629478194565fc83b46cda?s=128&d=identicon&r=PG&f=1", "display_name": "user2883071", "link": "https://stackoverflow.com/users/2883071/user2883071"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3339, "favorite_count": 0, "accepted_answer_id": 29657484, "answer_count": 1, "score": 0, "last_activity_date": 1429138330, "creation_date": 1429117714, "last_edit_date": 1429118845, "question_id": 29656502, "link": "https://stackoverflow.com/questions/29656502/searching-for-a-row-in-a-csv-file-using-vba", "title": "Searching for a row in a csv file using VBA", "body": "<p>What kind of functions can I use to search for a line in a vba file, and then store this file to an array. \nExample:</p>\n\n<pre><code>job,boe,sig,dive,mag,num,\nblah,blah,,,,,\nwuttt,ais,,sidji,,,\n</code></pre>\n\n<p>look for the line that has \"blah\" in the first column and store it to an array.</p>\n\n<p>Currently I am using the bash nawk command to find the line in a csv file, and then put this into a text file. Then I use:</p>\n\n<pre><code>Open \"C:\\file2.csv\" For Binary As #1\nMyData = Space$(LOF(1))\nGet #1, , MyData\nClose #1\nstrData() = Split(MyData, \",\")\n</code></pre>\n\n<p>To store the line in an array. To make it efficient, I want to cancel out the bash portion and read the line in directly from the csv file using VBA.</p>\n"}, {"tags": ["sql", "tsql", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 1421, "user_id": 197684, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/25b907acc06c0dad93d2d4e270f4647d?s=128&d=identicon&r=PG", "display_name": "Mathew A.", "link": "https://stackoverflow.com/users/197684/mathew-a"}, "edited": false, "score": 0, "creation_date": 1429115244, "post_id": 29655490, "comment_id": 47451127, "body": "Hi Sahar.  Welcome.  Could you please provide DataTypes for the tables.  Also would it be possible for you to include a small sample of the data for us to look at.  We could help you a lot more with just a bit more information.  I&#39;ve included a link to a Microsoft paper on the topic.  You might try working through those examples and seeing if you have specific questions."}, {"owner": {"reputation": 13934, "user_id": 4096987, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b66edfbc16fa01f3f45d764a3fa01bb?s=128&d=identicon&r=PG&f=1", "display_name": "AndroidEx", "link": "https://stackoverflow.com/users/4096987/androidex"}, "edited": false, "score": 0, "creation_date": 1429115256, "post_id": 29655490, "comment_id": 47451134, "body": "Normally, it&#39;s expected from you to show what you have tried so far to solve you problem."}, {"owner": {"reputation": 3, "user_id": 4706649, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002996987415/picture?type=large", "display_name": "Sahar Rad", "link": "https://stackoverflow.com/users/4706649/sahar-rad"}, "reply_to_user": {"reputation": 13934, "user_id": 4096987, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b66edfbc16fa01f3f45d764a3fa01bb?s=128&d=identicon&r=PG&f=1", "display_name": "AndroidEx", "link": "https://stackoverflow.com/users/4096987/androidex"}, "edited": false, "score": 0, "creation_date": 1429123214, "post_id": 29655490, "comment_id": 47456036, "body": "@Android777 dear it&#39;s how i want.that link is a picture"}, {"owner": {"reputation": 8084, "user_id": 512728, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GZ3bk.jpg?s=128&g=1", "display_name": "Jan Doggen", "link": "https://stackoverflow.com/users/512728/jan-doggen"}, "edited": false, "score": 0, "creation_date": 1429211107, "post_id": 29655490, "comment_id": 47504464, "body": "I have cleanud up the question and inserted the picture, but I did not understand the middle part of your report description, so that I did not edit."}], "answers": [{"tags": [], "owner": {"reputation": 1421, "user_id": 197684, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/25b907acc06c0dad93d2d4e270f4647d?s=128&d=identicon&r=PG", "display_name": "Mathew A.", "link": "https://stackoverflow.com/users/197684/mathew-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1429115283, "creation_date": 1429115283, "answer_id": 29655744, "question_id": 29655490, "link": "https://stackoverflow.com/questions/29655490/make-report-in-access/29655744#29655744", "title": "make report in access", "body": "<p>Please see my comment above, but this link might prove useful in your investigation.</p>\n\n<p><a href=\"https://support.office.com/en-us/article/Create-a-simple-report-408e92a8-11a4-418d-a378-7f1d99c25304\" rel=\"nofollow\">Create a Simple Report</a></p>\n"}, {"tags": [], "owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "is_accepted": true, "score": 0, "last_activity_date": 1429195875, "creation_date": 1429195875, "answer_id": 29678392, "question_id": 29655490, "link": "https://stackoverflow.com/questions/29655490/make-report-in-access/29678392#29678392", "title": "make report in access", "body": "<p>Based on the data in your tables in the screenshot, I created this query:</p>\n\n<pre><code>SELECT tblUsers.Company, tblCourses.CourseName, tblUsers.Age\nFROM (tblInformation LEFT JOIN tblCourses ON tblInformation.CourceCode = tblCourses.Course) LEFT JOIN tblUsers ON tblInformation.UserID = tblUsers.UserID;\n</code></pre>\n\n<p>Which resulted in this data:</p>\n\n<p><img src=\"https://i.stack.imgur.com/Z1Aqr.jpg\" alt=\"enter image description here\"></p>\n\n<p>I then put this data into a spreadsheet formatted as a table (you can either export it to spreadsheet and then format the data as a table or link your spreadsheet to this query in Access; linking is better in my opinion because you can just refresh the spreadsheet for new data from Access):</p>\n\n<p><img src=\"https://i.stack.imgur.com/r3Qz6.jpg\" alt=\"enter image description here\"></p>\n\n<p>Highlighting the above table in Excel, I inserted a pivot table, and set up the fields in this configuration:</p>\n\n<p><img src=\"https://i.stack.imgur.com/KY50y.jpg\" alt=\"enter image description here\"></p>\n\n<p>...which creates this pivot table:</p>\n\n<p><img src=\"https://i.stack.imgur.com/uPGsU.jpg\" alt=\"enter image description here\"></p>\n\n<p>Is this what you're after?</p>\n"}], "owner": {"reputation": 3, "user_id": 4706649, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002996987415/picture?type=large", "display_name": "Sahar Rad", "link": "https://stackoverflow.com/users/4706649/sahar-rad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 29678392, "answer_count": 2, "score": 0, "last_activity_date": 1429211107, "creation_date": 1429114518, "last_edit_date": 1429211107, "question_id": 29655490, "link": "https://stackoverflow.com/questions/29655490/make-report-in-access", "title": "make report in access", "body": "<p>In MS Access I have 3 tables:</p>\n\n<p><strong>tblUser</strong>(UserID,Age(teen,adult,old),Company,...)<br />\nto store users information</p>\n\n<p><strong>tblCourse</strong>(CourseID,...)<br />to store course information</p>\n\n<p><strong>tblInformation</strong>(CourseID,UserID,...)<br />to store which user takes which cCourse</p>\n\n<p>I need to make a report that shows me how many (teen,adult,old) users each company has, and that company take which course, and how many users in each company take each course.</p>\n\n<p>Example report how I would want it to look, made in Excel<br/>\n+ tables with some data:</p>\n\n<p><img src=\"https://i.stack.imgur.com/8kMgv.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4638540, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2dd9982fb160abf87084cff922c97b56?s=128&d=identicon&r=PG&f=1", "display_name": "Sorenn022", "link": "https://stackoverflow.com/users/4638540/sorenn022"}, "edited": false, "score": 0, "creation_date": 1429129047, "post_id": 29656529, "comment_id": 47459594, "body": "Thanks a lot for your quick answer tigeravatar!   With this code, how (and where in the code) would you insert some lines to add a column?   &gt;&gt;&gt; so the result of the macro is:   1) find the column titled &quot;Location&quot;   2) insert a clumn next to it (on the right) 3) select that new column, make a header (&quot;Geographic Area&quot;) 4) in the new column, enter a formula and extend to the last row.  Thank you so much! I usually do not need to be babysitted to that level, but I must admit that I am way out of my comfort zone on Excel right now.  Anthony"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 11, "user_id": 4638540, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2dd9982fb160abf87084cff922c97b56?s=128&d=identicon&r=PG&f=1", "display_name": "Sorenn022", "link": "https://stackoverflow.com/users/4638540/sorenn022"}, "edited": false, "score": 0, "creation_date": 1429130175, "post_id": 29656529, "comment_id": 47460239, "body": "@FacheAnthony Updated answer"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 11, "user_id": 4638540, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2dd9982fb160abf87084cff922c97b56?s=128&d=identicon&r=PG&f=1", "display_name": "Sorenn022", "link": "https://stackoverflow.com/users/4638540/sorenn022"}, "edited": false, "score": 0, "creation_date": 1429134544, "post_id": 29656529, "comment_id": 47462670, "body": "@FacheAnthony Good catch on that, that&#39;s what happens when I post code without testing it first &gt;&lt;.  I have updated the answer to include how to change the column&#39;s format to General."}, {"owner": {"reputation": 11, "user_id": 4638540, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2dd9982fb160abf87084cff922c97b56?s=128&d=identicon&r=PG&f=1", "display_name": "Sorenn022", "link": "https://stackoverflow.com/users/4638540/sorenn022"}, "edited": false, "score": 0, "creation_date": 1430851708, "post_id": 29656529, "comment_id": 48236850, "body": "Hello tigeravatar, while playing around with the code you gave me I noticed that this line &quot;If rngLocation Is Nothing Then Exit Sub&#39; could sometimes be a problem as it makes the macro stop when it is not really necessary to stop it. So I was wondering: is there any way to say &quot;if rngLocation Is Nothing Then &quot;skip the next three lines of code and display a message box&quot;&quot; without exiting the sub? Thanks!"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1429134491, "last_edit_date": 1429134491, "creation_date": 1429117807, "answer_id": 29656529, "question_id": 29655374, "link": "https://stackoverflow.com/questions/29655374/search-for-a-specific-header-then-enter-a-formula-and-automatically-detect-the/29656529#29656529", "title": "Search for a specific header, then enter a formula and automatically detect the number of rows to extend it to", "body": "<p>Something like this should work for you:</p>\n\n<pre><code>Sub tgr()\n\n    Dim ws As Worksheet\n    Dim rngLocation As Range\n    Dim lRow As Long\n\n    Set ws = ActiveSheet    'To set this to a specific sheetname, use Set ws = Sheets(\"Sheetname\")\n    Set rngLocation = ws.Rows(1).Find(\"Location\")\n    If rngLocation Is Nothing Then Exit Sub 'No column with header \"Location\" found\n\n    lRow = ws.Cells.Find(\"*\", ws.Range(\"A1\"), SearchDirection:=xlPrevious).Row - 1\n    With rngLocation.Offset(1).Resize(lRow)\n        .Formula = \"YourFormula\"    'This will automatically autofill\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT:</strong> Per comments, updated code looks like this:</p>\n\n<pre><code>Sub tgr()\n\n    Dim ws As Worksheet\n    Dim rngLocation As Range\n    Dim rngNewCol As Range\n    Dim lRow As Long\n\n    Set ws = ActiveSheet    'To set this to a specific sheetname, use Set ws = Sheets(\"Sheetname\")\n    Set rngLocation = ws.Rows(1).Find(\"Location\")\n    If rngLocation Is Nothing Then Exit Sub 'No column with header \"Location\" found\n\n    'Insert a new column to the right of rngLocation\n    rngLocation.Offset(, 1).EntireColumn.Insert\n    Set rngNewCol = rngLocation.Offset(, 1)\n\n    'Find last used row in the sheet (subtract one because we won't be including the header row)\n    lRow = ws.Cells.Find(\"*\", ws.Range(\"A1\"), SearchDirection:=xlPrevious).Row - 1\n\n    'Populate the new column\n    rngNewCol.Value = \"Geographic Area\"\n    With rngNewCol.Offset(1).Resize(lRow)\n        .NumberFormat = \"General\"   'Set column to General format\n        .Formula = \"YourFormula\"    'This will automatically autofill\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4638540, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2dd9982fb160abf87084cff922c97b56?s=128&d=identicon&r=PG&f=1", "display_name": "Sorenn022", "link": "https://stackoverflow.com/users/4638540/sorenn022"}, "is_accepted": false, "score": 0, "last_activity_date": 1429136067, "last_edit_date": 1429136067, "creation_date": 1429135729, "answer_id": 29661798, "question_id": 29655374, "link": "https://stackoverflow.com/questions/29655374/search-for-a-specific-header-then-enter-a-formula-and-automatically-detect-the/29661798#29661798", "title": "Search for a specific header, then enter a formula and automatically detect the number of rows to extend it to", "body": "<p>Alright so just to make it clear and complete I will post the full code that worked for my situation, which was:<br>\nI wanted to make a macro that would be able to automatically find a certain column based on its name, then insert another column next to that one, select that new column and fill it with a formula, while automatically detecting when to stop (in term of number of rows).<br>\nThe challenge for me was to find a way to indicate several directions in vba while never using coordinates like \"A2\" or \"F67\".  </p>\n\n<p>Thanks a lot to tigeravatar for his very valuable help in solving that problem!<br>\nBelow is the code I will be using (except if anyone finds something simpler of course):  </p>\n\n<pre><code>Sub Test_New_Macro()\n\nDim ws As Worksheet\nDim rngLocation As Range\nDim rngNewCol As Range\nDim lRow As Long\nSet ws = ActiveSheet\nSet rngLocation = ws.Rows(1).Find(\"Location - City\")\nIf rngLocation Is Nothing Then Exit Sub\nrngLocation.Offset(, 1).EntireColumn.Insert\nSet rngNewCol = rngLocation.Offset(, 1)\nlRow = ws.Cells.Find(\"*\", ws.Range(\"A1\"), SearchDirection:=xlPrevious).Row - 1\nrngNewCol.Value = \"Geographic Area\"\nWith rngNewCol.Offset(1, 0).Resize(lRow)\n    .NumberFormat = \"General\"\n    .Formula = \"Myformula\"\nEnd With\n</code></pre>\n\n<p>I made a few changes to tigeravatar's code:\non line 15:  </p>\n\n<pre><code>With rngNewCol.Offset(1, 0).Resize(lRow)\n</code></pre>\n\n<p>I changed (, 1) to (1, 0). Otherwise the macro would fill both the column's header and the next column with the formula.<br>\nAlso, I added several lines:<br>\nEDIT: thanks tigeravatar for that too!</p>\n\n<pre><code>    .NumberFormat = \"General\"\n</code></pre>\n\n<p>Just before filling the column with the formula because otherwise the formula would appear as text (because the cells were formatted as text from the beginning).<br>\nI might be declaring victory too soon, but after several tests it seems to work just fine!  </p>\n\n<p>Thanks again tigeravatar you have been very helpful!</p>\n\n<p>EDIT: tigeravatar posted a simpler way to make the number format General while I was posting this answer. I edited my answer with the code he posted.</p>\n"}], "owner": {"reputation": 11, "user_id": 4638540, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2dd9982fb160abf87084cff922c97b56?s=128&d=identicon&r=PG&f=1", "display_name": "Sorenn022", "link": "https://stackoverflow.com/users/4638540/sorenn022"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1370, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1429194091, "creation_date": 1429114182, "last_edit_date": 1531161705, "question_id": 29655374, "link": "https://stackoverflow.com/questions/29655374/search-for-a-specific-header-then-enter-a-formula-and-automatically-detect-the", "title": "Search for a specific header, then enter a formula and automatically detect the number of rows to extend it to", "body": "<p>I know that question has already been partially answered but so far I have been unsuccessful in adapting those answers to my problem:  </p>\n\n<p>I have made a macro to be run on monthly reports, but it turns out that the number and position of the columns, as well as the number of rows, will be different for every report.  </p>\n\n<p>I have included in my macro a code like this:  </p>\n\n<pre><code>Range(\"F2\").Select  \nActiveCell.FormulaR1C1 = _   \n\"=Blablabla\"  \nRange(\"F2\").Select  \nDim N As Long  \nN = Cells(Rows.Count, 1).End(xlUp).Row  \nSelection.AutoFill Destination:=Range(\"F2:F\" &amp; N), Type:=xlFillDefault  \n</code></pre>\n\n<p>This successfully allows me to type a formula in F2 and extend it to as many filled rows as there are in the spreadsheet.  </p>\n\n<p>Now, I would like to combine this with a \"column finder\". So instead of telling the macro to select F2, type the formula and extend it down, I would like to tell the macro to fin the column titled \"Location\", select the second row (right below the header) and type the formula and extend it to the last filled row.  </p>\n\n<p>What would the code for such a thing look like? And do you know if it will make the macro significantly longer to run? (before running the macro, the spreadsheet usually has around 60 columns, all with a different title).</p>\n\n<p>EDIT:\nI am having another problem requiring, I believe the same kind of code:<br>\nin the reports I run the macro on there is a column \"Degree\", then several columns (\"Major\", \"Institution\" etc) and finally a column \"Graduation Date\").  </p>\n\n<p>Now, I need to change the graduation date according to the degree (to reflect the virtual Bachelor Degree graduation date). So if column \"Degree\", row 5 says \"Associate Degree\", I need to add two years to the graduation date in column \"Graduation Date\", row 5.   </p>\n\n<p>And I would like to implement that with the same kind of \"header detection\" as for the rest of the table (because for this too the columns can move). So I guess I need some kind of code saying:<br>\n1) find column \"Graduation Date\" and insert a column next to it<br>\n2) title that new column \"B.S. Graduation Date\" and put inside a formula until the last filled row.<br>\nThese two steps I can manage thanks to tigeravatar's code. </p>\n\n<p>What I need help for would be the IF formula saying \"IF column \"Degree\" row 5 says <em>Associate</em>, then column \"B.S. Graduation Date\" must show <em>date of Degree row 5  +2 Years</em>\", without using the coordinates of the columns, but the \"title finder\".  </p>\n\n<p>Please let me know if that makes sense, and if that is doable.  </p>\n\n<p>Thank you!!</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 13138, "user_id": 3459206, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b245689cab3de5b5596a0ba0d235c4e7?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Salauyou", "link": "https://stackoverflow.com/users/3459206/alex-salauyou"}, "edited": false, "score": 0, "creation_date": 1429114194, "post_id": 29655309, "comment_id": 47450472, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/2600876/how-to-open-csv-file-with-vba-macro\">How to open CSV file with VBA macro</a>"}, {"owner": {"reputation": 24066, "user_id": 4686625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gsGGS.jpg?s=128&g=1", "display_name": "miradulo", "link": "https://stackoverflow.com/users/4686625/miradulo"}, "reply_to_user": {"reputation": 13138, "user_id": 3459206, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b245689cab3de5b5596a0ba0d235c4e7?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Salauyou", "link": "https://stackoverflow.com/users/3459206/alex-salauyou"}, "edited": false, "score": 0, "creation_date": 1429114261, "post_id": 29655309, "comment_id": 47450529, "body": "@SashaSalauyou How is this a duplicate of that? At <b><i>all</i></b>?"}, {"owner": {"reputation": 12053, "user_id": 116932, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/14023b72fbbd662ce5bcc075e9c5c666?s=128&d=identicon&r=PG", "display_name": "pagid", "link": "https://stackoverflow.com/users/116932/pagid"}, "edited": false, "score": 0, "creation_date": 1429126721, "post_id": 29655309, "comment_id": 47458261, "body": "Handle the data as code block"}], "answers": [{"tags": [], "owner": {"reputation": 693, "user_id": 4792803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7abffc13cec9c205a15f6856efe76e0?s=128&d=identicon&r=PG&f=1", "display_name": "C. White", "link": "https://stackoverflow.com/users/4792803/c-white"}, "is_accepted": false, "score": 0, "last_activity_date": 1429115105, "creation_date": 1429115105, "answer_id": 29655691, "question_id": 29655309, "link": "https://stackoverflow.com/questions/29655309/vba-read-from-delimited-text/29655691#29655691", "title": "VBA Read From Delimited Text", "body": "<p>Several different options are available, depending on what exactly you're trying to do.</p>\n\n<p>If you only want the first value before the comma, you can use the old OPEN FOR INPUT approach.  The \"<strong>Input</strong> #ff, FirstValue\" literally loads the first value encountered (up until a comma is reached) into that variable:</p>\n\n<pre><code>Public Sub SampleRead(TextFile As String)\n  Dim ff As Integer, i As Long\n  Dim FirstValue As Double\n  Dim VariableName As String\n  ff = FreeFile\n  Open TextFile For Input As #ff\n    Do Until EOF(ff)\n      i = i + 1\n      Input #ff, FirstValue\n      Input #ff, VariableName\n      Debug.Print \"Variable Name: \" &amp; VariableName &amp; \" has a value of: \" &amp; FirstValue &amp; \" on line #\" &amp; i\n    Loop\n  Close #ff\nEnd Sub    \n</code></pre>\n\n<p>Alternately, you could use Split() to parse the lines of the text file you're reading in with <strong>.Readline</strong> (you can use \"<strong>Line Input</strong>\" to do the same thing) in order to break them out into the specific variables.</p>\n"}], "owner": {"reputation": 1, "user_id": 4792783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37d4f2a700959d7a5256f53085cab2f3?s=128&d=identicon&r=PG&f=1", "display_name": "Bjamham", "link": "https://stackoverflow.com/users/4792783/bjamham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 563, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429126721, "creation_date": 1429113997, "last_edit_date": 1429126721, "question_id": 29655309, "link": "https://stackoverflow.com/questions/29655309/vba-read-from-delimited-text", "title": "VBA Read From Delimited Text", "body": "<p>New here and have been searching for a method to read from a text file which makes use of commas as a delimiter. I want to assign the text to a variable and use it within the program. For instance, a line from the text file would be</p>\n\n<pre><code>45.325, Variable Description\n</code></pre>\n\n<p>And I need to assign 45.325 to a variable name in the code. I found a method which uses oFS.Readline, but it reads the whole line whereas I just need it to read up to (not including) the comma.</p>\n\n<p>Thanks for your response\nBen </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 0, "last_activity_date": 1429133962, "creation_date": 1429133962, "answer_id": 29661408, "question_id": 29654482, "link": "https://stackoverflow.com/questions/29654482/coping-selected-filtered-data-to-a-new-sheet/29661408#29661408", "title": "Coping selected Filtered Data to a new sheet", "body": "<p>This code is completely <strong><em>UNTESTED</em></strong>, but it should at least give you the idea...</p>\n\n\n\n<pre><code>Option Explicit\n\nSub CopyColumns()\n    Dim lastRow As Long\n    Dim insurer As Integer\n    Dim dataRange As Range\n    Dim subT As Range\n    Dim newWB As Workbook\n    Dim fName As String\n    Dim fPath As String\n\n    '--- determine the range of the data and filter it for the requested insurer\n    lastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Set dataRange = Sheets(\"Sheet1\").Range(\"$A$1:$AD\" &amp; lastRow)\n    insurer = 1\n    dataRange.AutoFilter Field:=22, Criteria1:=\"=\" &amp; insurer\n\n    '--- open the empty workbook template as the destination for the copied data\n    Set newWB = Workbooks.Open(\"G:\\Accounts\\FINANCE\\Financial Data\\Bordereau\\Monthly Bordereau\\CDL Insurer Template.xlsx\")\n\n    '--- check the subtotal and copy the range only if the subtotal is more than 1\n    '    (put the SUBTOTAL formula in the cell to make it easier)\\\n    Set subT = dataRange.Cells(lastRow + 1, 3)\n    subT.Formula = \"=SUBTOTAL(103,\" &amp; dataRange.Offset(1, 2).Resize(lastRow - 1, 1).Address &amp; \")\"\n    If subT.Value &gt; 1 Then\n        dataRange.Resize(lastRow, 12).Copy Destination:=newWB.Sheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\n    End If\n\n    '--- set up the workbook to save to the correct location\n    fPath = \"G:\\Accounts\\FINANCE\\Financial Data\\Bordereau\\Monthly Bordereau\\2015-03\\\"\n    fName = \"ABC 2015-03.xlsx\"\n    newWB.SaveAs fPath &amp; fName\n    newWB.Close\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4053860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/951b62641c73af21418dfa99596886b0?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Craig", "link": "https://stackoverflow.com/users/4053860/steven-craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 29661408, "answer_count": 1, "score": 0, "last_activity_date": 1429133962, "creation_date": 1429111970, "last_edit_date": 1531164843, "question_id": 29654482, "link": "https://stackoverflow.com/questions/29654482/coping-selected-filtered-data-to-a-new-sheet", "title": "Coping selected Filtered Data to a new sheet", "body": "<p>I have some code to filter data and copy into a new sheet. </p>\n\n<p>I am having some difficulty in coping all of the required columns at once and was wondering if someone could help me on this. There are 2 sources and 2 destinations in the new sheet. Could someone please point me in the right direction? I have only included 1 half of the macro here as I have not finished the other part due to being stuck on this. </p>\n\n<p>I am also struggling to use the \"Insurer\" that I have set at the top of the code to populate the \"Insurer\" name in the file save as, in as ABC here, is this possible or would I have to hard code it? I was looking to set this off in a loop running through a list of companies that I need to create the file for</p>\n\n<pre><code>Dim LR As Integer\nDim Insurer As Integer\nDim InsurerNew As Integer\nDim InsurerOld As Integer\n\n\n\n\nLR = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nSelection.AutoFilter\nActiveSheet.Range(\"$A$1:$AD\" &amp; LR).AutoFilter Field:=22, Criteria1:=Insurer\n\nWorkbooks.Open Filename:= _\n    \"G:\\Accounts\\FINANCE\\Financial Data\\Bordereau\\Monthly Bordereau\\CDL Insurer Template.xlsx\"\n\nIf Application.Subtotal(103, .Columns(3)) &gt; 1 Then\n    .Columns(1).Offset(1, 0).Resize(.Rows.Count - 1, 1).Copy _\n      Destination:=Workbooks(\"CDL Insurer Template.xls\").Sheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\n    .Columns(2).Offset(1, 0).Resize(.Rows.Count - 1, 1).Copy _\n     Destination:=Workbooks(\"CDL Insurer Template.xls\").Sheets(\"Sheet1\").Cells(Rows.Count, 2).End(xlUp).Offset(1, 0)\n    .Columns(3).Offset(1, 0).Resize(.Rows.Count - 1, 1).Copy _\n      Destination:=Workbooks(\"CDL Insurer Template.xls\").Sheets(\"Sheet1\").Cells(Rows.Count, 3).End(xlUp).Offset(1, 0)\n     .Columns(4).Offset(1, 0).Resize(.Rows.Count - 1, 1).Copy _\n     Destination:=Workbooks(\"CDL Insurer Template.xls\").Sheets(\"Sheet1\").Cells(Rows.Count, 4).End(xlUp).Offset(1, 0)\n      .Columns(5).Offset(1, 0).Resize(.Rows.Count - 1, 1).Copy _\n     Destination:=Workbooks(\"CDL Insurer Template.xls\").Sheets(\"Sheet1\").Cells(Rows.Count, 5).End(xlUp).Offset(1, 0)\n     .Columns(6).Offset(1, 0).Resize(.Rows.Count - 1, 1).Copy _\n     Destination:=Workbooks(\"CDL Insurer Template.xls\").Sheets(\"Sheet1\").Cells(Rows.Count, 6).End(xlUp).Offset(1, 0)\n     .Columns(7).Offset(1, 0).Resize(.Rows.Count - 1, 1).Copy _\n     Destination:=Workbooks(\"CDL Insurer Template.xls\").Sheets(\"Sheet1\").Cells(Rows.Count, 7).End(xlUp).Offset(1, 0)\n     .Columns(8).Offset(1, 0).Resize(.Rows.Count - 1, 1).Copy _\n     Destination:=Workbooks(\"CDL Insurer Template.xls\").Sheets(\"Sheet1\").Cells(Rows.Count, 8).End(xlUp).Offset(1, 0)\n     .Columns(9).Offset(1, 0).Resize(.Rows.Count - 1, 1).Copy _\n     Destination:=Workbooks(\"CDL Insurer Template.xls\").Sheets(\"Sheet1\").Cells(Rows.Count, 9).End(xlUp).Offset(1, 0)\n     .Columns(10).Offset(1, 0).Resize(.Rows.Count - 1, 1).Copy _\n     Destination:=Workbooks(\"CDL Insurer Template.xls\").Sheets(\"Sheet1\").Cells(Rows.Count, 10).End(xlUp).Offset(1, 0)\n     .Columns(11).Offset(1, 0).Resize(.Rows.Count - 1, 1).Copy _\n     Destination:=Workbooks(\"CDL Insurer Template.xls\").Sheets(\"Sheet1\").Cells(Rows.Count, 11).End(xlUp).Offset(1, 0)\n     .Columns(12).Offset(1, 0).Resize(.Rows.Count - 1, 1).Copy _\n     Destination:=Workbooks(\"CDL Insurer Template.xls\").Sheets(\"Sheet1\").Cells(Rows.Count, 12).End(xlUp).Offset(1, 0)\n\nChDir \"G:\\Accounts\\FINANCE\\Financial Data\\Bordereau\\Monthly Bordereau\\2015-03\"\nActiveWorkbook.SaveAs Filename:= _\n    \"G:\\Accounts\\FINANCE\\Financial Data\\Bordereau\\Monthly Bordereau\\2015-03\\ABC 2015-03.xlsx\" _\n    , FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n</code></pre>\n\n<p>Thanks</p>\n\n<p>Steven</p>\n"}, {"tags": ["performance", "vba", "excel"], "comments": [{"owner": {"reputation": 3265, "user_id": 1689179, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f666ca7ce62f9137f621faeeb23ebadc?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/1689179/dan"}, "edited": false, "score": 0, "creation_date": 1429111706, "post_id": 29654180, "comment_id": 47448502, "body": "You could take a different approach by copying the whole text file in Excel, the same way you can do manually (copy/paste) but programatically, and then delete the first and last row in Excel."}, {"owner": {"reputation": 101, "user_id": 4568803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/abed51cc509770a558da4f4fa1e0630c?s=128&d=identicon&r=PG&f=1", "display_name": "Mats Olsson", "link": "https://stackoverflow.com/users/4568803/mats-olsson"}, "reply_to_user": {"reputation": 3265, "user_id": 1689179, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f666ca7ce62f9137f621faeeb23ebadc?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/1689179/dan"}, "edited": false, "score": 0, "creation_date": 1429117350, "post_id": 29654180, "comment_id": 47452374, "body": "I am not sure I fully understand. How do I copy the whole text file programatically??"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 4568803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/abed51cc509770a558da4f4fa1e0630c?s=128&d=identicon&r=PG&f=1", "display_name": "Mats Olsson", "link": "https://stackoverflow.com/users/4568803/mats-olsson"}, "edited": false, "score": 0, "creation_date": 1429118032, "post_id": 29654455, "comment_id": 47452818, "body": "Thanks! This was quick! The .CommandType=0 is not accepted, but I took that out and it did the thing! However I now have a Header row which is a bit off (as I split date and time in two). The End staement at the end I can live with. I guess I could copy the file to a working area/sheet and then copy from this excluding the header and end row to the sheet where I want it. Any other ideas?"}, {"owner": {"reputation": 101, "user_id": 4568803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/abed51cc509770a558da4f4fa1e0630c?s=128&d=identicon&r=PG&f=1", "display_name": "Mats Olsson", "link": "https://stackoverflow.com/users/4568803/mats-olsson"}, "edited": false, "score": 0, "creation_date": 1429118635, "post_id": 29654455, "comment_id": 47453169, "body": "Or I could just rewrite the Header row after the data import, that is probably the simplest way.... Thanks Jeanno, I will save hours of waiting time on this!"}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": false, "score": 1, "last_activity_date": 1429111922, "creation_date": 1429111922, "answer_id": 29654455, "question_id": 29654180, "link": "https://stackoverflow.com/questions/29654180/vba-performance-issue-iteration/29654455#29654455", "title": "VBA Performance issue - Iteration", "body": "<p>Excel can handle multiple types of delimiters (tab and space) with get data from text. This is what I have from macro recorder</p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n'\n\n'\n    With ActiveSheet.QueryTables.Add(Connection:= _\n        \"TEXT;C:\\Users\\jeanno\\Documents\\random.txt\", Destination:=Range(\"$A$1\"))\n        .CommandType = 0\n        .Name = \"random_1\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 437\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = True\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = False\n        .TextFileSpaceDelimiter = True\n        .TextFileColumnDataTypes = Array(1)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n    End With\nEnd Sub\n</code></pre>\n\n<p>This will be much faster than string manipulation in VBA.</p>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 4568803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/abed51cc509770a558da4f4fa1e0630c?s=128&d=identicon&r=PG&f=1", "display_name": "Mats Olsson", "link": "https://stackoverflow.com/users/4568803/mats-olsson"}, "edited": false, "score": 0, "creation_date": 1429117251, "post_id": 29655027, "comment_id": 47452320, "body": "Thanks Paul, but I had the same timings for this solution! BTW the END detection is not functioning, but that I know how to fix. Problem is still performance. I have a fairly good machine so &#237;t is not that."}], "tags": [], "owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "is_accepted": false, "score": 0, "last_activity_date": 1429113228, "creation_date": 1429113228, "answer_id": 29655027, "question_id": 29654180, "link": "https://stackoverflow.com/questions/29654180/vba-performance-issue-iteration/29655027#29655027", "title": "VBA Performance issue - Iteration", "body": "<p>I think the problem is you might be reading the file in Binary. Try the following approach. I ran 5100+ records and it parsed it in under a second. </p>\n\n<pre><code>Public Sub ReadFileToExcel(filePath As String, rowNum As Long)\n'******************************************************************************\n'   Opens a large TXT File, reads the data until EOF on the Source,\n'       adds the data in a EXCEL File, based on the row number.\n'   Arguments:\n'   ``````````\n'       1. The Source File Path - \"C:\\Users\\SO\\FileName.Txt\" (or) D:\\Data.txt\n'       2. The Row number you wish to start adding data.\n'*******************************************************************************\n    Dim strIn As String, lineCtr As Long\n    Dim tmpData, DateString\n\n    'Open the SOURCE file for Read.\n    Open filePath For Input As #1\n\n    'Loop the SOURCE till the last line.\n    Do While Not EOF(1)\n        'Read one line at a time.\n        Line Input #1, strIn\n        lineCtr = lineCtr  + 1\n        If lineCtr &lt;&gt; 1 Then\n            If InStr(strIn, \"END\") = 0 Then\n                tmpData = Split(strIn, vbTab)\n                DateString = Split(tmpData(0), \" \")\n                ActiveSheet.Cells(rowNum, 5) = DateString(0) 'Date\n                ActiveSheet.Cells(rowNum, 6) = DateString(1) 'Time\n                ActiveSheet.Cells(rowNum, 2) = tmpData(1)    'Value1\n                ActiveSheet.Cells(rowNum, 3) = tmpData(2)    'Value2\n                ActiveSheet.Cells(rowNum, 4) = tmpData(3)    'Value3\n                rowNum = rowNum + 1\n            End If\n        End If\n    Loop\n\n    Debug.Print \"Total number of records - \" &amp; lineCtr 'Print the last line\n    'Close the files.\n    Close #1\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 4568803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/abed51cc509770a558da4f4fa1e0630c?s=128&d=identicon&r=PG&f=1", "display_name": "Mats Olsson", "link": "https://stackoverflow.com/users/4568803/mats-olsson"}, "edited": false, "score": 0, "creation_date": 1429124777, "post_id": 29657073, "comment_id": 47457001, "body": "stenci, I like the look of this! Being able to manage all manipulations in memory and then in one go assign it to the sheet! Iwill have a go at this, too."}, {"owner": {"reputation": 101, "user_id": 4568803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/abed51cc509770a558da4f4fa1e0630c?s=128&d=identicon&r=PG&f=1", "display_name": "Mats Olsson", "link": "https://stackoverflow.com/users/4568803/mats-olsson"}, "edited": false, "score": 0, "creation_date": 1429129388, "post_id": 29657073, "comment_id": 47459789, "body": "I had to add a transpose of the Values array but this works like a charm. Thanks stenci, I think I will go with this solution."}, {"owner": {"reputation": 7225, "user_id": 1899628, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PAWN2.png?s=128&g=1", "display_name": "stenci", "link": "https://stackoverflow.com/users/1899628/stenci"}, "reply_to_user": {"reputation": 101, "user_id": 4568803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/abed51cc509770a558da4f4fa1e0630c?s=128&d=identicon&r=PG&f=1", "display_name": "Mats Olsson", "link": "https://stackoverflow.com/users/4568803/mats-olsson"}, "edited": false, "score": 0, "creation_date": 1429130645, "post_id": 29657073, "comment_id": 47460502, "body": "<code>Application.Transpose(Values)</code> should work. I&#39;m Glad it helps."}], "tags": [], "owner": {"reputation": 7225, "user_id": 1899628, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PAWN2.png?s=128&g=1", "display_name": "stenci", "link": "https://stackoverflow.com/users/1899628/stenci"}, "is_accepted": true, "score": 1, "last_activity_date": 1429119548, "creation_date": 1429119548, "answer_id": 29657073, "question_id": 29654180, "link": "https://stackoverflow.com/questions/29654180/vba-performance-issue-iteration/29657073#29657073", "title": "VBA Performance issue - Iteration", "body": "<p>Try with something like this:</p>\n\n<pre><code>Dim Values(), N, I\nN = 100\nReDim Values(6, N)\n...\nDo While Not EOF(1)\n  I = I + 1\n  If I &gt; N Then \n    N = N + 100\n    ReDim Preserve Values(6, N)\n  End If\n  Values(0, I) = ...\n  ...\nLoop\nRange(\"A1:F\" &amp; i) = Values\n</code></pre>\n\n<p>The loop will work with arrays that in VBA are much faster than working with the sheet.</p>\n"}], "owner": {"reputation": 101, "user_id": 4568803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/abed51cc509770a558da4f4fa1e0630c?s=128&d=identicon&r=PG&f=1", "display_name": "Mats Olsson", "link": "https://stackoverflow.com/users/4568803/mats-olsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 29657073, "answer_count": 3, "score": 1, "last_activity_date": 1429119548, "creation_date": 1429111208, "question_id": 29654180, "link": "https://stackoverflow.com/questions/29654180/vba-performance-issue-iteration", "title": "VBA Performance issue - Iteration", "body": "<p>I am reading a text file with 5000 strings. Each string contains Date+Time and then 3 values. The delimiter between Date and Time is a space, and then the three values are tab delimited. First string (strData(0)) is just a header, so I do not need that. Last string is just a simple \"End\". </p>\n\n<p>The below code works, but it takes 1 minute to import into the worksheet! What can I do to improve this, and what is taking time?<br>\nScreen updating is off.</p>\n\n<pre><code>   'open the file and read the contents\n    Open strPpName For Binary As #1\n    MyData = Space$(LOF(1))\n    Get #1, , MyData\n    Close #1\n    strData() = Split(MyData, vbCrLf)\n\n   'split the data and write into the correct columns\n   Row = 3\n   i = 0\n   For Each wrd In strData()\n        If i &gt; 0 Then 'first string is only header\n            tmpData() = Split(wrd, vbTab)\n            DateString() = Split(tmpData(0), \" \")\n            If DateString(0) &lt;&gt; \"End\" Then\n                ActiveSheet.Cells(Row, 5) = DateString(0) 'Date\n                ActiveSheet.Cells(Row, 6) = DateString(1) 'Time\n                ActiveSheet.Cells(Row, 2) = tmpData(1)    'Value1\n                ActiveSheet.Cells(Row, 3) = tmpData(2)    'Value2\n                ActiveSheet.Cells(Row, 4) = tmpData(3)    'Value3\n                Row = Row + 1\n            Else\n                GoTo Done\n            End If\n        End If\n        i = i + 1\n    Next wrd\nDone:\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1429109869, "post_id": 29653616, "comment_id": 47447099, "body": "You have not passed the argument to the <code>FindingLastRow</code> method. You have nit declared what <code>MySheet</code> is."}, {"owner": {"reputation": 25, "user_id": 4777793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-emUhiLN_osw/AAAAAAAAAAI/AAAAAAAAABA/Dl_AOyxnmWc/photo.jpg?sz=128", "display_name": "memed", "link": "https://stackoverflow.com/users/4777793/memed"}, "reply_to_user": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1429110073, "post_id": 29653616, "comment_id": 47447283, "body": "@paul I edited the code thanks :)"}, {"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 0, "creation_date": 1429113899, "post_id": 29653616, "comment_id": 47450260, "body": "@memed (upped) question as it got some interesting responses"}], "answers": [{"tags": [], "owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "is_accepted": false, "score": 1, "last_activity_date": 1429111591, "last_edit_date": 1429111591, "creation_date": 1429110232, "answer_id": 29653829, "question_id": 29653616, "link": "https://stackoverflow.com/questions/29653616/how-to-know-the-last-row-filled-in-vba-excel/29653829#29653829", "title": "how to know the last row filled in vba (excel)?", "body": "<p>If you want to find the last cell in a book other than <code>ThisWorkbook</code>:</p>\n\n<pre><code>Function FindingLastRow( _\n  ByVal shtName As String, _\n  Optional ByVal colLetter As Variant, _\n  Optional ByRef wkBk As Variant _\n  ) As Long\n\n  Dim colId As String\n  If IsMissing(colLetter) Then\n     colId = \"A\"\n  Else\n     colId = colLetter\n  End If\n\n  Dim myTargBk As Excel.Workbook\n  If IsMissing(wkBk) Then\n     Set myTargBk = ThisWorkbook\n  Else\n     Set myTargBk = wkBk\n  End If\n\n  Dim sht As Worksheet\n  Set sht = myTargBk.Worksheets(shtName)\n  With sht\n    FindingLastRow = .Cells(.Rows.Count, colId).End(Excel.xlUp).Row\n  End With\n\nEnd Function\n</code></pre>\n\n<p>Used like this:</p>\n\n<pre><code>Sub findLast()\n  MsgBox FindingLastRow(\"Sheet1\")\nEnd Sub\n</code></pre>\n\n<p>Or to find the last row of column A in a different open workbook...</p>\n\n<pre><code>Sub findLast2()\n  Dim w As Excel.Workbook\n  Set w = Excel.Workbooks(\"Norf.xlsx\")\n  MsgBox FindingLastRow(\"Sheet1\", , w)\nEnd Sub\n</code></pre>\n\n<p>Or to find the last row of column <strong>B</strong> in a different open workbook...</p>\n\n<pre><code>Sub findLast3()\n  Dim w As Excel.Workbook\n  Set w = Excel.Workbooks(\"Norf.xlsx\")\n  MsgBox FindingLastRow(\"Sheet1\", \"B\", w)\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 4777793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-emUhiLN_osw/AAAAAAAAAAI/AAAAAAAAABA/Dl_AOyxnmWc/photo.jpg?sz=128", "display_name": "memed", "link": "https://stackoverflow.com/users/4777793/memed"}, "edited": false, "score": 0, "creation_date": 1429111130, "post_id": 29653857, "comment_id": 47448068, "body": "Your code works very well, thank you so much ! pls you can explain to me what he is doing the <code>If Not CBool(Len(MySheet)) Then MySheet = ActiveSheet.Name</code>??"}, {"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "reply_to_user": {"reputation": 25, "user_id": 4777793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-emUhiLN_osw/AAAAAAAAAAI/AAAAAAAAABA/Dl_AOyxnmWc/photo.jpg?sz=128", "display_name": "memed", "link": "https://stackoverflow.com/users/4777793/memed"}, "edited": false, "score": 1, "creation_date": 1429111246, "post_id": 29653857, "comment_id": 47448163, "body": "@memed the argument <code>MySheet</code> is declared as <code>Optional</code> so you can run a line of code like this <code>lastR = FindingLastRow()</code> without the argument - that line you mention will then fill in the gaps - and the code will still run. I think a nicer optional argument might be for column - as you might like to not always find the last row in column &quot;A&quot;."}, {"owner": {"reputation": 25, "user_id": 4777793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-emUhiLN_osw/AAAAAAAAAAI/AAAAAAAAABA/Dl_AOyxnmWc/photo.jpg?sz=128", "display_name": "memed", "link": "https://stackoverflow.com/users/4777793/memed"}, "edited": false, "score": 0, "creation_date": 1429112391, "post_id": 29653857, "comment_id": 47449042, "body": "@whythea yes it true that&#39;s what I did. Now I understand better. thank you very much :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 0, "creation_date": 1429112737, "post_id": 29653857, "comment_id": 47449324, "body": "@whytheq - Good point. I&#39;ve adjusted the function."}, {"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 0, "creation_date": 1429112977, "post_id": 29653857, "comment_id": 47449538, "body": "@Jeeped cool - didn&#39;t realise you could shortcut like that in vba <code>...=&quot;A&quot;</code> ..like it. Am I correct in thinking if you make the optional variables type <code>Variant</code> then you can use the method <code>IsMissing</code> ?"}, {"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 0, "creation_date": 1429113130, "post_id": 29653857, "comment_id": 47449673, "body": "(@Jeeped you could always up my answer by way of a thank you ...)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 0, "creation_date": 1429113488, "post_id": 29653857, "comment_id": 47449940, "body": "@whytheq - a) You can set a default for an optional parameter like that but it has to be a constant. The <code>ActiveSheet.Name</code> is not a constant so it had to be dealt with differently. b) Yes, only a variant type parameter will respond correctly to the <code>IsMissing</code> function. Also, optional variant parameters do not discount macros from being listed in the Alt+F8 Macros dialog. Any other var type of optional parameter will ensure that the macro is not listed. Sometimes I even use one that I will never actually use just so it is not listed."}, {"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 0, "creation_date": 1429113813, "post_id": 29653857, "comment_id": 47450196, "body": "@Jeeped what is the problem with it being listed? <code>IsMissing</code> is a nice self-documenting method compared to say <code>If Not CBool(Len(MySheet))...</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 1, "creation_date": 1429114182, "post_id": 29653857, "comment_id": 47450461, "body": "@whytheq - a) Sometimes I write short helper routines that I do not want people who don&#39;t know exactly what the routine might do fooling with. b) Lots of secondary subs may not actually need parameters passed into them in order to function properly but having them listed only serves to obfuscate the ones that are important and you never know when someone will run something just to see what it does. c) while I&#39;m a firm believer that &#39;if you build something idiot-proof, the world will build a better idiot&#39;, I don&#39;t like to tempt fate."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1429114419, "post_id": 29653857, "comment_id": 47450632, "body": "&#39;if you build something idiot-proof, the world will build a better idiot&#39; that needs to go up on a wall somewhere!"}, {"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 0, "creation_date": 1429114576, "post_id": 29653857, "comment_id": 47450736, "body": "@Jeeped I&#39;m nicking that!! for here....<a href=\"http://stackoverflow.com/users/1179880/whytheq?tab=profile\">stackoverflow.com/users/1179880/whytheq?tab=profile</a>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1429112686, "last_edit_date": 1429112686, "creation_date": 1429110303, "answer_id": 29653857, "question_id": 29653616, "link": "https://stackoverflow.com/questions/29653616/how-to-know-the-last-row-filled-in-vba-excel/29653857#29653857", "title": "how to know the last row filled in vba (excel)?", "body": "<p>You are passing a string into your <code>FindingLastRow</code> function but are not using it. <em>shiit</em> is the parameter being passed in but you later try to use something called <em>Mysheet</em>.</p>\n\n<pre><code>Function FindingLastRow(Optional MySheet As String, Optional sCOL as String = \"A\") As Long\n    Dim sht As Worksheet\n    Dim LastRow As Long\n\n    If Not CBool(Len(MySheet)) Then MySheet = ActiveSheet.Name\n\n    Set sht = ThisWorkbook.Worksheets(MySheet)\n    LastRow = sht.Cells(sht.Rows.Count, sCOL).End(xlUp).Row\n    FindingLastRow = LastRow\n    Set sht = nothing\nEnd Function\n\nSub test_FindingLastRow()\n    Dim lastR As Long\n    lastR = FindingLastRow\n    MsgBox lastR\n    lastR = FindingLastRow(\"Recap\")\n    MsgBox lastR\n    lastR = FindingLastRow(\"Recap\", \"B\")\n    MsgBox lastR\nEnd Sub\n</code></pre>\n\n<p>If no worksheet name is passed in then the currently ActiveSheet's name is used. If no alphabetic column name is passed in it will use column A.</p>\n"}, {"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1429111214, "post_id": 29654151, "comment_id": 47448132, "body": "The used range may not necessarily contain data though and is only updated on the workbook being saved"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1429111389, "post_id": 29654151, "comment_id": 47448270, "body": "@SOofWXLS, you are correct about the UsedRange possibly not containing data.  It is updated with changes though without saving."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1429111709, "post_id": 29654151, "comment_id": 47448508, "body": "I have to disagree with that - the UsedRange doesn&#39;t always keep a good track of what the used range is. Typically I can&#39;t get it to do that at the moment.  Excel doesn&#39;t always return the correct last cell with UsedRange - it remembers cells that have had values/formatting which have subsequently been cleared. <a href=\"http://blog.contextures.com/archives/2012/03/01/select-actual-used-range-in-excel-sheet/\" rel=\"nofollow noreferrer\">blog.contextures.com/archives/2012/03/01/&hellip;</a>"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1429112189, "post_id": 29654151, "comment_id": 47448894, "body": "@DarrenBartrup-Cook, I am pretty confident it properly tracks, but it is easy to not realize a cell still has info in it.  I generally make sure to ALT+H+E+A (clear all) if I think there is residual info in a cell.  Even better is to just delete the rows/columns if the sheet allows it.  In some cases, the <code>UsedRange</code> is a good way to find out if cells outside the &quot;data&quot; have not been sanitized and cleared of formatting if they appear to be good."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1429114645, "post_id": 29654151, "comment_id": 47450782, "body": "Subject to answering an earlier Excel question today I set up some sample data starting in row 42 going down a few rows. The <code>.UsedData</code> is reported as <code>S42:AK44</code> so rows.count isn&#39;t going to be accurate. Then I threw a <i>Long Date</i> number format on some blank cells in O36:O69. The <code>.UsedRange</code> is now reported as <code>O36:AK69</code>. Saving does not reset these."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1429115090, "post_id": 29654151, "comment_id": 47451042, "body": "@Jeeped, I caught the same issue with the <code>UsedRange</code> not starting in row 1.  I added a blurb earlier about adding in <code>UsedRange.Cells(1,1).Row</code> to get the correct row number.  The formatted cells being included is a legitimate issue and could show up in real spreadsheets."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1429193777, "post_id": 29654151, "comment_id": 47492349, "body": "Over UsedRange I&#39;d use the Find method that @SOofWXLS has given as an answer - I just have a .bas file that I drag and drop into my project with a similar function."}], "tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": false, "score": 0, "last_activity_date": 1429111485, "last_edit_date": 1429111485, "creation_date": 1429111128, "answer_id": 29654151, "question_id": 29653616, "link": "https://stackoverflow.com/questions/29653616/how-to-know-the-last-row-filled-in-vba-excel/29654151#29654151", "title": "how to know the last row filled in vba (excel)?", "body": "<p>The <code>UsedRange</code> on a Worksheet variable is very helpful here.  You really don't need a UDF to get the row count.</p>\n\n<pre><code>LastRow = Worksheets(\"Recap\").UsedRange.Rows.Count\n</code></pre>\n\n<p><strong>This method only works</strong> if your data starts in row 1 and the sheet does not have formatting outside of the data.  You could add in the starting row <code>+ UsedRange.Cells(1,1).Row</code> if you know the data starts somewhere other than row 1.  The second issue prevents the use of UsedRange.</p>\n"}, {"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 1, "last_activity_date": 1429112864, "last_edit_date": 1429112864, "creation_date": 1429111151, "answer_id": 29654158, "question_id": 29653616, "link": "https://stackoverflow.com/questions/29653616/how-to-know-the-last-row-filled-in-vba-excel/29654158#29654158", "title": "how to know the last row filled in vba (excel)?", "body": "<p>You're also assuming that the last cell will be in column A which may not be the case, so I tend to revert to something like this:</p>\n\n<pre><code>Function FindingLastRow(sheetName As String) As Long\n    FindingLastRow = Sheets(\"sheetName\").Cells.Find(\"*\", searchorder:=xlByRows, searchdirection:=xlPrevious).Row \nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4777793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-emUhiLN_osw/AAAAAAAAAAI/AAAAAAAAABA/Dl_AOyxnmWc/photo.jpg?sz=128", "display_name": "memed", "link": "https://stackoverflow.com/users/4777793/memed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2284, "favorite_count": 0, "closed_date": 1429145575, "accepted_answer_id": 29653857, "answer_count": 4, "score": 2, "last_activity_date": 1429112864, "creation_date": 1429109710, "last_edit_date": 1429110153, "question_id": 29653616, "link": "https://stackoverflow.com/questions/29653616/how-to-know-the-last-row-filled-in-vba-excel", "closed_reason": "Duplicate", "title": "how to know the last row filled in vba (excel)?", "body": "<p>I have a sheet calls \"Recap\" and I want to know how much line that I have in this sheet.I tried with this code:</p>\n\n<pre><code>Function FindingLastRow(Mysheet As String) As Long\n\nDim sht As Worksheet\nDim LastRow As Long\n\nSet sht = ThisWorkbook.Worksheets(Mysheet) \nLastRow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\nFindingLastRow = LastRow\n\nEnd Function\n</code></pre>\n\n<p>......</p>\n\n<p>in my macro i tried this:</p>\n\n<p>....</p>\n\n<pre><code>Dim lastR As Long\nlastR=FindingLastRow(\"Recap\")\nmsgBox lastR\n</code></pre>\n\n<p>.....</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 1309, "user_id": 1497212, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0511a375f968323baeca37d432ffe053?s=128&d=identicon&r=PG", "display_name": "Christina", "link": "https://stackoverflow.com/users/1497212/christina"}, "edited": false, "score": 0, "creation_date": 1429123571, "post_id": 29652914, "comment_id": 47456250, "body": "Is the focus being moved to the comment when you create it, or is it staying with the checkbox?"}, {"owner": {"reputation": 21, "user_id": 4792242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aed6957379924d816aec1e540fef478d?s=128&d=identicon&r=PG&f=1", "display_name": "VBAatWork", "link": "https://stackoverflow.com/users/4792242/vbaatwork"}, "reply_to_user": {"reputation": 1309, "user_id": 1497212, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0511a375f968323baeca37d432ffe053?s=128&d=identicon&r=PG", "display_name": "Christina", "link": "https://stackoverflow.com/users/1497212/christina"}, "edited": false, "score": 0, "creation_date": 1429133170, "post_id": 29652914, "comment_id": 47461962, "body": "Does Comments.Add set the focus on the new comment? I will check that out."}, {"owner": {"reputation": 1309, "user_id": 1497212, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0511a375f968323baeca37d432ffe053?s=128&d=identicon&r=PG", "display_name": "Christina", "link": "https://stackoverflow.com/users/1497212/christina"}, "edited": false, "score": 0, "creation_date": 1429202009, "post_id": 29652914, "comment_id": 47498775, "body": "I had a chance to double-check and it doesn&#39;t look like the focus moves to the comment normally, so that&#39;s probably not it. How are you capturing the tab and spacebar keypresses? I work with dialogs a lot more than I do with content controls, so I&#39;m not sure what, if any functionality is built-in vs. written into the code."}, {"owner": {"reputation": 21, "user_id": 4792242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aed6957379924d816aec1e540fef478d?s=128&d=identicon&r=PG&f=1", "display_name": "VBAatWork", "link": "https://stackoverflow.com/users/4792242/vbaatwork"}, "reply_to_user": {"reputation": 1309, "user_id": 1497212, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0511a375f968323baeca37d432ffe053?s=128&d=identicon&r=PG", "display_name": "Christina", "link": "https://stackoverflow.com/users/1497212/christina"}, "edited": false, "score": 0, "creation_date": 1429236165, "post_id": 29652914, "comment_id": 47514959, "body": "Normally the spacebar automatically toggles the checkbox from check to unchecked. When I try to capture the spacebar with .keybinding it doesn&#39;t seem to work either while I am in a checkbox! Does that happen with anyone else?"}], "answers": [{"tags": [], "owner": {"reputation": 1309, "user_id": 1497212, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0511a375f968323baeca37d432ffe053?s=128&d=identicon&r=PG", "display_name": "Christina", "link": "https://stackoverflow.com/users/1497212/christina"}, "is_accepted": false, "score": 1, "last_activity_date": 1429289652, "creation_date": 1429289652, "answer_id": 29705169, "question_id": 29652914, "link": "https://stackoverflow.com/questions/29652914/adding-comment-disables-content-control-toggling-with-spacebar/29705169#29705169", "title": "Adding comment disables content control toggling with spacebar", "body": "<p>I don't know the exact mechanism that is causing this, but it seems to me that after you create the comment Word is selecting the next text box at a different 'level' than it would otherwise. I created a very basic version of what I think you're doing, and what I see when I tab from a group of checkboxes that do require a comment is subtly different from what I see when I tab from a group of checkboxes that do not require a comment.</p>\n\n<p><img src=\"https://i.stack.imgur.com/151HE.jpg\" alt=\"enter image description here\"> <img src=\"https://i.stack.imgur.com/4VofY.jpg\" alt=\"enter image description here\"></p>\n\n<p>What seemed to fix it was adding a line after the line that adds the comment:</p>\n\n<pre><code>Selection.End = Selection.Start\n</code></pre>\n\n<p>This seems to force the checkbox's selection state back to what is required for the spacebar to work. Hopefully that will work for you. There does not seem to be an abundance of documentation of this Word feature online.</p>\n"}], "owner": {"reputation": 21, "user_id": 4792242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aed6957379924d816aec1e540fef478d?s=128&d=identicon&r=PG&f=1", "display_name": "VBAatWork", "link": "https://stackoverflow.com/users/4792242/vbaatwork"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1429289652, "creation_date": 1429107890, "last_edit_date": 1429108627, "question_id": 29652914, "link": "https://stackoverflow.com/questions/29652914/adding-comment-disables-content-control-toggling-with-spacebar", "title": "Adding comment disables content control toggling with spacebar", "body": "<p>I am working on a Word macro that checks the validity of a series of checkbox content controls that the user selects. The checkboxes are grouped into yes-no pairs. Currently, if the user tabs through both checkboxes in the pair without checking either, a comment appears on the side. </p>\n\n<p>For example, my document looks like this:</p>\n\n<pre><code>Was an interpreter used?\n    yes[ ] no[ ] \nIf yes, was the interpreter understood?\n    yes[ ] no[ ]\n</code></pre>\n\n<p>If the user tabs through both yes and no in the first question without changing the value of either to <code>[x]</code> then a comment is added to a bookmark around <code>\"Was an interpreter used?\"</code> saying something like <code>\"Please check one of the following:\"</code></p>\n\n<p>The validity of the checkbox group is checked on each triggering of the <code>Document_ContentControlOnExit</code> event. Usually, the user can change whether a checkbox is checked by pressing the spacebar. </p>\n\n<p>The problem is that when the comment is added the spacebar stops allowing the user to toggle the next checkbox. For example, if I have the <code>no[ ]</code> box selected in the first question and I press tab, a comment is added to <code>Was an interpreter used?</code> and the focus shifts to <code>yes[ ]</code> in the next question. However now if the user presses the spacebar then <code>yes[ ]</code> in the second question does not become checked. I can still tab through the checkboxes and the spacebar functionality returns as soon as I have tabbed out of <code>yes[ ]</code>. The line I am currently using to add the comment is:</p>\n\n<pre><code>Set myComment = TempDoc.Comments.Add(TempDoc.Bookmarks(Bookmark).Range, Text)\n</code></pre>\n\n<p>The line simply adds a new comment to a pre-defined bookmark alerting the user of the mistake. I am almost positive that this is the line that causes the spacebar to stop working, since when I comment it out everything works fine.</p>\n\n<p>How can I get the spacebar to toggle the next checkbox after I add my comment?</p>\n"}, {"tags": ["vba", "controls", "libreoffice", "basic", "libreoffice-basic"], "answers": [{"comments": [{"owner": {"reputation": 438, "user_id": 1091484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/292c731dbf18ae7f9661f422a895d501?s=128&d=identicon&r=PG", "display_name": "Samuel", "link": "https://stackoverflow.com/users/1091484/samuel"}, "edited": false, "score": 0, "creation_date": 1429174234, "post_id": 29656054, "comment_id": 47477573, "body": "Thanks @Lyrl but that&#39;s not exactly what I meant. It helped me to progress and now here is my code. Only two lines remain wrong."}, {"owner": {"reputation": 885, "user_id": 3850088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e67773da9020c80a42f1ba6846a02548?s=128&d=identicon&r=PG&f=1", "display_name": "Lyrl", "link": "https://stackoverflow.com/users/3850088/lyrl"}, "reply_to_user": {"reputation": 438, "user_id": 1091484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/292c731dbf18ae7f9661f422a895d501?s=128&d=identicon&r=PG", "display_name": "Samuel", "link": "https://stackoverflow.com/users/1091484/samuel"}, "edited": false, "score": 0, "creation_date": 1429214421, "post_id": 29656054, "comment_id": 47506513, "body": "I&#39;m unfamiliar with the API name for the label. I recommend using an object inspection tool: they examine the object you give it (here you&#39;d feed it cControl) and return all the object&#39;s properties and methods. You can scroll through the properties list and find the API name of the label. Two good ones for Open/LibreOffice are Xray (<a href=\"http://bernard.marcelly.perso.sfr.fr/index2.html\" rel=\"nofollow noreferrer\">link</a>) and MRI (<a href=\"http://extensions.services.openoffice.org/en/project/mri-uno-object-inspection-tool\" rel=\"nofollow noreferrer\">link</a>) also see this MRI tutorial: <a href=\"https://forum.openoffice.org/en/forum/viewtopic.php?f=74&amp;t=49294\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 438, "user_id": 1091484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/292c731dbf18ae7f9661f422a895d501?s=128&d=identicon&r=PG", "display_name": "Samuel", "link": "https://stackoverflow.com/users/1091484/samuel"}, "edited": false, "score": 0, "creation_date": 1429285163, "post_id": 29656054, "comment_id": 47542909, "body": "I&#39;ve tried with Xray. It hasn&#39;t helped :(. I&#39;ll try MRI later. Thanks."}, {"owner": {"reputation": 885, "user_id": 3850088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e67773da9020c80a42f1ba6846a02548?s=128&d=identicon&r=PG&f=1", "display_name": "Lyrl", "link": "https://stackoverflow.com/users/3850088/lyrl"}, "reply_to_user": {"reputation": 438, "user_id": 1091484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/292c731dbf18ae7f9661f422a895d501?s=128&d=identicon&r=PG", "display_name": "Samuel", "link": "https://stackoverflow.com/users/1091484/samuel"}, "edited": false, "score": 0, "creation_date": 1429292909, "post_id": 29656054, "comment_id": 47547827, "body": "I&#39;ve edited my original answer with some additional information."}, {"owner": {"reputation": 438, "user_id": 1091484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/292c731dbf18ae7f9661f422a895d501?s=128&d=identicon&r=PG", "display_name": "Samuel", "link": "https://stackoverflow.com/users/1091484/samuel"}, "edited": false, "score": 0, "creation_date": 1429293929, "post_id": 29656054, "comment_id": 47548418, "body": "That&#39;s brilliant. We can use <code>cControl.getModel().Label</code> on controls which own labels, and <code>cControl.getModel().Name</code> on all controls ! Thanks a lot !"}], "tags": [], "owner": {"reputation": 885, "user_id": 3850088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e67773da9020c80a42f1ba6846a02548?s=128&d=identicon&r=PG&f=1", "display_name": "Lyrl", "link": "https://stackoverflow.com/users/3850088/lyrl"}, "is_accepted": true, "score": 1, "last_activity_date": 1429290068, "last_edit_date": 1429290068, "creation_date": 1429116249, "answer_id": 29656054, "question_id": 29652600, "link": "https://stackoverflow.com/questions/29652600/iterate-over-controls-with-libreoffice-basic/29656054#29656054", "title": "Iterate over Controls with LibreOffice Basic", "body": "<p>Note: this code was tested in OpenOffice.  I believe it will work the same way in LibreOffice.</p>\n\n<p>Controls are located on the drawpage.  If there might be non-control drawpage objects (arrows, shapes, images, etc.) and you want to operate just on controls, you have to iterate through all the draw objects and test each one for being a control: </p>\n\n<pre><code>Sub iterate_forms_controls()\n    Dim oDP As Object : oDP = ThisComponent.drawpage\n    Dim cControl As Object\n    Dim i As Integer\n\n    REM The oDP assignment above is for a standard form (a Writer document).\n    REM If you are using a Calc document as a form you would instead write:\n    REM oDP = ThisComponent.Sheets.getByName(\"SheetName\").drawpage\n\n    For i = 0 To oDP.Count - 1\n    cControl = oDP.getByIndex(i)\n        If cControl.supportsService(\"com.sun.star.drawing.ControlShape\") Then\n            'Do something\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p><strong>Edit:</strong> I looked at the object \"cControl\" with XRay. Looked through the properties, and nothing looked useful.  I then went to methods and found a method \"getModel\".  Double-clicked on getModel to XRay that method, and found \"Label\" with the name I'd given the checkbox.  Woot!  (I've worked with other objects that have certain properties only accessible through a \"model\"; it's not an intuitive place to look.)</p>\n\n<p>So try this:</p>\n\n<pre><code>For Each cControl In Controls\n    I = I + 1\n    A = A &amp; cControl.getModel.Label\nNext cControl\n</code></pre>\n"}], "owner": {"reputation": 438, "user_id": 1091484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/292c731dbf18ae7f9661f422a895d501?s=128&d=identicon&r=PG", "display_name": "Samuel", "link": "https://stackoverflow.com/users/1091484/samuel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1137, "favorite_count": 0, "accepted_answer_id": 29656054, "answer_count": 1, "score": 0, "last_activity_date": 1429290068, "creation_date": 1429107051, "last_edit_date": 1429177509, "question_id": 29652600, "link": "https://stackoverflow.com/questions/29652600/iterate-over-controls-with-libreoffice-basic", "title": "Iterate over Controls with LibreOffice Basic", "body": "<p>I'd like to iterate over Controls in a LibreOffice form with Basic.</p>\n\n<p>Basically, I'd like to do what this code does in VBA.</p>\n\n<pre><code>Sub parcours_controles_formulaire()\n    Dim cControl As Control\n    Dim sLog As String\n    sLog = \"List of controls : \" &amp; vbCrLf \n    For Each cControl In FrmExemplesControles.Controls\n        sLog = sLog &amp; _\n        cControl.Name &amp; _\n        \" of type \" &amp; _\n        TypeName(cControl) &amp; vbCrLf\n    Next cControl\n    MsgBox sLog\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT :</strong> Here is what I found with Lyrl's help. That's not totally correct yet. I'm not able to get the labels of controls.</p>\n\n<pre><code>Sub iterate_forms_controls()\n    Dim Dlg As Object\n    Dim Controls As Object\n    Dim cControl As Object\n    Dim I As Integer\n    Dim A As String\n\n    DialogLibraries.LoadLibrary(\"Standard\")\n    Dlg = CreateUnoDialog(DialogLibraries.Standard.BoiteDeDialogue1)\n\n    Controls = Dlg.Controls\n\n    I = 0\n    A = \"\"\n    For Each cControl In Controls\n        I = I + 1\n        A = A &amp; cControl.getImplementationName()\n        'A = A &amp; cControl  ' How to get back the label of cControl here ?\n    Next cControl\n\n    MsgBox \"There is \" &amp; i &amp; \" controls in that form !\" &amp; A\nEnd Sub\n</code></pre>\n"}, {"tags": ["mysql", "vba", "excel"], "comments": [{"owner": {"reputation": 10409, "user_id": 4187346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uSe1J.png?s=128&g=1", "display_name": "Dave Bennett", "link": "https://stackoverflow.com/users/4187346/dave-bennett"}, "edited": false, "score": 0, "creation_date": 1429106026, "post_id": 29652042, "comment_id": 47444061, "body": "do you have any sample vba of what have you tried thus far?"}, {"owner": {"reputation": 6405, "user_id": 3166160, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9054f030b0058573a8338340e6347da8?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Lambert", "link": "https://stackoverflow.com/users/3166160/jacob-lambert"}, "edited": false, "score": 0, "creation_date": 1429106728, "post_id": 29652042, "comment_id": 47444632, "body": "Why is this tagged mysql?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4792172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8cff2ed9d3d009691276bde7ffd59ce?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandru", "link": "https://stackoverflow.com/users/4792172/alexandru"}, "edited": false, "score": 0, "creation_date": 1429195402, "post_id": 29654730, "comment_id": 47493660, "body": "Hello, unfortunately i cannot run this and i can`t seem to understand why."}, {"owner": {"reputation": 233, "user_id": 4792724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b508493df368e10a82208b9042401b?s=128&d=identicon&r=PG", "display_name": "FairlyLegit", "link": "https://stackoverflow.com/users/4792724/fairlylegit"}, "reply_to_user": {"reputation": 1, "user_id": 4792172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8cff2ed9d3d009691276bde7ffd59ce?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandru", "link": "https://stackoverflow.com/users/4792172/alexandru"}, "edited": false, "score": 0, "creation_date": 1429283179, "post_id": 29654730, "comment_id": 47541543, "body": "You cannot run this because you have to replace several of the things in the code with the specific names of things in your workbooks. Such as the names of the workbooks and the names of the specific worksheets. If you read through the code you will see where I wrote what you specifically need to add."}], "tags": [], "owner": {"reputation": 233, "user_id": 4792724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b508493df368e10a82208b9042401b?s=128&d=identicon&r=PG", "display_name": "FairlyLegit", "link": "https://stackoverflow.com/users/4792724/fairlylegit"}, "is_accepted": false, "score": 1, "last_activity_date": 1429112563, "creation_date": 1429112563, "answer_id": 29654730, "question_id": 29652042, "link": "https://stackoverflow.com/questions/29652042/copy-an-entire-row-based-of-finding-a-value-on-column-a-from-another-excel-file/29654730#29654730", "title": "Copy an entire row based of finding a value on column A from another Excel file", "body": "<p>So you question isn't very specific, which is making it kind of hard to answer. However, I believe I understand what you are asking.</p>\n\n<p>I am assuming that you will have one of these workbooks open. (Either 'Excel 1' or 'Excel 2' and then want to run a macro to do your heavy lifting. Here is some sample code for you to try out. I am assuming that you will start with 'Excel 1' open and then I will have your matches be copied to a new worksheet instead of a new workbook.</p>\n\n<pre><code>Dim wbk as Workbook\nDim Total1Rows as Long\nDim Total2Rows as Long\nDim ws as Worksheet\nDim NewRows as Int\nApplication.ScreenUpdating = False\nSet wbk = Workbooks.Open(\" file location of 'Excel 2' \")\nSet ws = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))\nws.Name = \"Pick a Name\"\nTotal1Rows = Worksheets(\" 'Excel 1' name of worksheet \").UsedRange.Rows.Count\nTotal2Rows = wbk.Worksheets(\" 'Excel 2' name of worksheet \").UsedRange.Rows.Count\nFor i = 1 to Total1Rows\n    For j = 1 to Total2Rows\n        If Worksheets(\" 'Excel 1' name of worksheet \").Range(\"A\" &amp; i) = wbk.Worksheets(\" 'Excel 2' Name of Worksheet \").Range(\"A\" &amp; j) Then\n            NewRows = Worksheets(ws.Name).Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n            wbk.Worksheets(\" 'Excel 2' name of worksheet\").Range(\"A\" &amp; j &amp; \":Z\" &amp; J).Copy\n            Worksheets(\" 'Excel 1' name of worksheet\").Range(\"A\" &amp; NewRows).PasteSpecial\n        End If\n    Next j\nNext i\n</code></pre>\n\n<p>This is actually my first time ever posting an answer so please be forgiving.</p>\n"}], "owner": {"reputation": 1, "user_id": 4792172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8cff2ed9d3d009691276bde7ffd59ce?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandru", "link": "https://stackoverflow.com/users/4792172/alexandru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1429112563, "creation_date": 1429105716, "last_edit_date": 1429106364, "question_id": 29652042, "link": "https://stackoverflow.com/questions/29652042/copy-an-entire-row-based-of-finding-a-value-on-column-a-from-another-excel-file", "title": "Copy an entire row based of finding a value on column A from another Excel file", "body": "<p>I have two Excel files:</p>\n\n<ol>\n<li>about 175k rows and 6.5k columns - column A has some unique numbers and the rest of them some repetitive values</li>\n<li>about 600k rows and 2 columns - column A has some unique numbers and column B has some repetitive text</li>\n</ol>\n\n<p>Based on column A from Excel 2 where I have some unique numbers, I need to match them with column A from Excel 1. Once done, the rest of the row needs to be copied somehow (the repetitive values) into another sheet. Once done, based on the data copied, we need to identify the value from column A Excel 1 that has on the rest of the rows one or more of the repetitive values.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1429114342, "post_id": 29651955, "comment_id": 47450585, "body": "There doesn&#39;t seem to be anything in your code which would cause the workbook corruption you&#39;re seeing.  You could try saving your file in a binary format (*.xlsb) and see if that helps."}, {"owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1429115196, "post_id": 29651955, "comment_id": 47451100, "body": "Hi Tim, I also don&#39;t think there&#39;s anything in the code. I have tried that myself and it seems to work, but why is the problem happening at all?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1429115430, "post_id": 29651955, "comment_id": 47451232, "body": "The error message is complaining about a named range, but there doesn&#39;t seem to be any code in your question which relates to named ranges.  Maybe Excel is having a problem with a too-long name, or some name format it doesn&#39;t like.  Difficult to say."}, {"owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1429115516, "post_id": 29651955, "comment_id": 47451279, "body": "I was thinking along the lines of the tab names causing an issue, I still don&#39;t see why there was no problem back in December and there is now though?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1429147059, "post_id": 29651955, "comment_id": 47466755, "body": "Have you checked the contents of the file repair log?"}, {"owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "edited": false, "score": 0, "creation_date": 1429170980, "post_id": 29651955, "comment_id": 47475655, "body": "Yes, it says &quot;  &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot; ?&gt;  - &lt;recoveryLog xmlns=&quot;<a href=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" rel=\"nofollow noreferrer\">schemas.openxmlformats.org/spreadsheetml/2006/main</a>&quot;&gt;   &lt;logFileName&gt;error062360_01.xml&lt;/logFileName&gt;    &lt;summary&gt;Errors were detected in file &#39;Z:\\Q1 2015\\Con Call File\\EOQ TRACKER - MARCH 20TH V2.xlsm&#39;&lt;/summary&gt;  - &lt;removedRecords summary=&quot;Following is a list of removed records:&quot;&gt;   &lt;removedRecord&gt;Removed Records: Named range from /xl/workbook.xml part (Workbook)&lt;/removedRecord&gt;    &lt;/removedRecords&gt;   &lt;/recoveryLog&gt;&quot; Have you seen this before?"}, {"owner": {"reputation": 415, "user_id": 1228741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5908d95b7b98be56735ea0f4b67f6244?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Chad", "link": "https://stackoverflow.com/users/1228741/michael-chad"}, "edited": false, "score": 1, "creation_date": 1429190278, "post_id": 29651955, "comment_id": 47489448, "body": "Have you been able to see that node in workbook.xml, before the repair?  I&#39;ve had similar corruptions before without any Vba involved.  Sometimes excel just gets a little drunk while saving, sometimes it&#39;s a bad memory  or HDD sector, who knows.  If you can locate that node in the unzipped file, it may lend you some clarification, and may just be able to be removed manually."}, {"owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "edited": false, "score": 0, "creation_date": 1429190452, "post_id": 29651955, "comment_id": 47489605, "body": "I&#39;m sorry to sound stupid, but how would I do that? I would like to point out that a new file was created daily from scratch, and the problem would appear most days. However, it did work perfectly before Christmas and nothing has changed int eh way the file was prepared?"}, {"owner": {"reputation": 415, "user_id": 1228741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5908d95b7b98be56735ea0f4b67f6244?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Chad", "link": "https://stackoverflow.com/users/1228741/michael-chad"}, "edited": false, "score": 1, "creation_date": 1429192602, "post_id": 29651955, "comment_id": 47491403, "body": "Not stupid at all, we&#39;re all here to share and learn!  Under the surface, an .xlsx or .xlsm file is just a compressed folder with the extension changed from .zip to .xls(x/m).  If you changes the extension back to .zip, you can extract it like any other compressed folder.  That error message is complaining that one of the .xml files inside the compressed folder has something it doesn&#39;t like in it."}, {"owner": {"reputation": 415, "user_id": 1228741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5908d95b7b98be56735ea0f4b67f6244?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Chad", "link": "https://stackoverflow.com/users/1228741/michael-chad"}, "edited": false, "score": 1, "creation_date": 1429192894, "post_id": 29651955, "comment_id": 47491650, "body": "So make a copy of your original, and change the extension of the copy to .zip.  Windows will warn you, but it&#39;s OK.  Then, extract the contents, navigate to the xl folder, and open workbook.xml in notepad.  It&#39;s gonna look messy in there so hit ctrl+f and type in &quot;named&quot; and let&#39;s see if it finds a node with that word in it.  It will be enclosed like &lt;nodeName&gt;.  You can append your question with that section of the XML, and that will help us get to the bottom of it."}, {"owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "edited": false, "score": 0, "creation_date": 1429197665, "post_id": 29651955, "comment_id": 47495562, "body": "Thanks a lot, Ok I did that but unfortunately it couldn&#39;t find anything called &quot;named&quot;? There is a section dealing with named ranges and defining them?"}, {"owner": {"reputation": 415, "user_id": 1228741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5908d95b7b98be56735ea0f4b67f6244?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Chad", "link": "https://stackoverflow.com/users/1228741/michael-chad"}, "reply_to_user": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "edited": false, "score": 1, "creation_date": 1429198426, "post_id": 29651955, "comment_id": 47496171, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/75416/discussion-between-michael-chad-and-e-mcandrew\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 415, "user_id": 1228741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5908d95b7b98be56735ea0f4b67f6244?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Chad", "link": "https://stackoverflow.com/users/1228741/michael-chad"}, "is_accepted": true, "score": 6, "last_activity_date": 1429287015, "creation_date": 1429287015, "answer_id": 29704329, "question_id": 29651955, "link": "https://stackoverflow.com/questions/29651955/what-causes-microsoft-excel-error-removed-records-named-range-from-xl-workboo/29704329#29704329", "title": "What causes Microsoft excel error &quot;Removed Records: Named range from /xl/workbook.xml part (Workbook)&quot;", "body": "<p>To avoid a lengthy comment section we continued in chat last night.  It wound up being quicker than anticipated.  He provided the definedName block below.</p>\n\n<p>Although there are a number of things I saw that may/not have contributed, it looks most like a broken relationship in the shared views.  It is a shared workbook, on a network drive, and by the looks of it there are 6 different machines that have all stored some personal view data.  The syntax all looks OK, so without seeing all of the sheet*.xml files, its probably in one of the <code>&lt;definedName&gt;</code>, and <code>&lt;customWorkbookViews&gt;</code> / <code>&lt;customSheetViews&gt;</code> nodes which all relate based on GUID.  It's an easy thing to lose control over as those GUIDs are generated by excel at runtime.</p>\n\n<p>Turning off \"Filter Settings\" in Review Tab>Share Workbook>Advanced Tab, under the \"Include in personal view\" heading will remove <strong>all</strong> of the <code>.wvu</code> named nodes from worksheet.xml, as well as <code>*View(s)</code> nodes from sheet*.xml, and keep them from re-appearing.  This will either fix the issue, or reduce the candidates to one user defined, and one system defined range.  Chances are that a recent save hiccup left some file parts without an update, and thus a broken relationship.  </p>\n\n<p>Drawback:  Only one view state can be saved, so you will see the last users format/filter changes upon opening the file.</p>\n\n<p>Hope it really fixes it!  If not, we'll go another round.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/documentformat.openxml.spreadsheet.customsheetview.aspx\" rel=\"noreferrer\">customSheetView Class MSDN</a></p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/documentformat.openxml.spreadsheet.customworkbookview.aspx\" rel=\"noreferrer\">customWorkbookView Class MSDN</a></p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/dd949469(v=office.12).aspx\" rel=\"noreferrer\">UserBView MSDN (The strangely formatted Z_GUID part)</a></p>\n\n<p>The customSheetViewClass doc states that the GUID \"<strong>Shall correspond to a customWorkbookView</strong>\", where the customWorkbookView needs only to have a name  containing a globally unique GUID (redunant I know, but its in the docs). Failing the \"Shall\" requirement will result in the \"Removed Records: Named Range from /xl/workbook.xml/ part (Workbook)\" repair message.</p>\n\n<pre><code>'EOQ TRACKER - MARCH 20TH V2.xlsm\\workbook.xls - definedNames\n    &lt;definedNames&gt; \n        &lt;definedName name=\"_Allocation\"&gt;'6'!$A$2:$A$25&lt;/definedName&gt; \n        &lt;definedName name=\"_xlnm._FilterDatabase\" localSheetId=\"0\" hidden=\"1\"&gt;'1'!$A:$AV&lt;/definedName&gt; \n        &lt;definedName name=\"Z_02EBD829_B457_4EED_8A23_48BD791D2A90_.wvu.FilterData\" localSheetId=\"0\" hidden=\"1\"&gt;'1'!$A$1:$AU$5396&lt;/definedName&gt; \n        &lt;definedName name=\"Z_5038F31E_F522_4C27_8172_A37A2E0A913D_.wvu.FilterData\" localSheetId=\"0\" hidden=\"1\"&gt;'1'!$A:$AV&lt;/definedName&gt; \n        &lt;definedName name=\"Z_6179D930_DC8C_44A7_9B7D_D78327247088_.wvu.Cols\" localSheetId=\"0\" hidden=\"1\"&gt;'1'!$A:$A,'1'!$O:$O,'1'!$Q:$Q,'1'!$T:$T,'1'!$V:$V&lt;/definedName&gt; \n        &lt;definedName name=\"Z_6179D930_DC8C_44A7_9B7D_D78327247088_.wvu.FilterData\" localSheetId=\"0\" hidden=\"1\"&gt;'1'!$A$1:$AU$5396&lt;/definedName&gt; \n        &lt;definedName name=\"Z_7736F281_6E25_4779_AF1F_AC145F2EB4E9_.wvu.FilterData\" localSheetId=\"0\" hidden=\"1\"&gt;'1'!$A$1:$AU$5396&lt;/definedName&gt;\n        &lt;definedName name=\"Z_A2BCDFEA_821A_444D_B1F8_3659E07AD9AC_.wvu.Cols\" localSheetId=\"0\" hidden=\"1\"&gt;'1'!$A:$A,'1'!$O:$O,'1'!$Q:$Q,'1'!$T:$T,'1'!$V:$V&lt;/definedName&gt;\n        &lt;definedName name=\"Z_A2BCDFEA_821A_444D_B1F8_3659E07AD9AC_.wvu.FilterData\" localSheetId=\"0\" hidden=\"1\"&gt;'1'!$A:$AV&lt;/definedName&gt; \n        &lt;definedName name=\"Z_A2BCDFEA_821A_444D_B1F8_3659E07AD9AC_.wvu.Rows\" localSheetId=\"0\" hidden=\"1\"&gt;'1'!:$1048576&lt;/definedName&gt; \n        &lt;definedName name=\"Z_AC1AB890_7D16_45DD_B4FB_13CB8F92D4C2_.wvu.Cols\" localSheetId=\"0\" hidden=\"1\"&gt;'1'!$A:$A,'1'!$O:$O,'1'!$Q:$Q,'1'!$T:$T,'1'!$V:$V&lt;/definedName&gt;\n        &lt;definedName name=\"Z_AC1AB890_7D16_45DD_B4FB_13CB8F92D4C2_.wvu.FilterData\" localSheetId=\"0\" hidden=\"1\"&gt;'1'!$A:$AV&lt;/definedName&gt; \n    &lt;/definedNames&gt;\n</code></pre>\n"}], "owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12067, "favorite_count": 1, "accepted_answer_id": 29704329, "answer_count": 1, "score": 3, "last_activity_date": 1571302051, "creation_date": 1429105527, "last_edit_date": 1429366928, "question_id": 29651955, "link": "https://stackoverflow.com/questions/29651955/what-causes-microsoft-excel-error-removed-records-named-range-from-xl-workboo", "title": "What causes Microsoft excel error &quot;Removed Records: Named range from /xl/workbook.xml part (Workbook)&quot;", "body": "<p>I have a large Microsoft Excel file that is shared between users in my office. The file has a macro and a set of data validation. The file is used the last two weeks of every third month. The file worked perfectly before Christmas, however, we encountered errors in March.The following error appeared when the file was opened.<br>\n<img src=\"https://i.stack.imgur.com/ZhyYF.png\" alt=\"Error\"></p>\n\n<p>After clicking yes, the following appeared.<br>\n<img src=\"https://i.stack.imgur.com/pGc0z.png\" alt=\"enter image description here\"></p>\n\n<p>The code for the macro is:</p>\n\n<pre><code> Sub Update()\n\n 'Declaring Variables.\n  Dim Number_Rows As Long\n  Dim Oppt As String\n  Dim Array_Oppt() As String\n  Dim Rows_Array As Integer\n\n 'Stops screen refreshing to save time.\n  Application.ScreenUpdating = False\n\n 'removing any data validation and conditional formatting\n  Sheet1.Activate\n  Cells.Select\n  Selection.Validation.Delete\n  Selection.FormatConditions.Delete\n\n\n 'Assigning value to array.\n  Rows_Array = 0\n  ReDim Preserve Array_Oppt(Rows_Array)\n\n\n 'Moving \"Other\" rows to the end of the data\n  Sheet1.Select\n  Selection.AutoFilter Field:=23, Criteria1:= _\n  \"OTHER\"\n\n  Range(\"A2\", Cells(Rows.Count,       \"A\").End(xlUp)).SpecialCells(xlCellTypeVisible).Cells(1, 1).Select\n Selection.EntireRow.Select\n Range(Selection, Selection.End(xlDown)).SpecialCells(xlCellTypeVisible).Select\n Selection.Copy\n Sheet8.Select\n Sheet8.Range(\"A1\").Select\n ActiveSheet.Paste\n Sheet1.Select\n Range(\"A2\", Cells(Rows.Count, \"A\").End(xlUp)).SpecialCells(xlCellTypeVisible).Cells(1, 1).Select\n Selection.EntireRow.Select\n Range(Selection, Selection.End(xlDown)).SpecialCells(xlCellTypeVisible).Select\n Selection.Delete Shift:=xlUp\n Selection.AutoFilter\n\n Number_Rows = Application.WorksheetFunction.CountA(Range(\"A:A\"))\n Sheet8.Select\n Selection.Cut\n Sheet1.Activate\n Range(\"A\" &amp; Number_Rows + 1).Select\n ActiveSheet.Paste\n\n 'Counting number of rows.\n  Number_Rows = Application.WorksheetFunction.CountA(Range(\"A:A\"))\n\n  'Loop to check if oppt if unit or non unit deal. Checks if oppt is in array and adds oppt if not.\n 'Calculates total revenue per opp.\n  For i = 2 To Number_Rows\n\n  Oppt = Range(\"I\" &amp; i)\n\n'In array already.\nIf UBound(Filter(Array_Oppt, Oppt)) &gt;= 0 Then\n\n    'Non Unit deal in the array already. Deletes line and shifts row up as well as i up.\n    If Range(\"W\" &amp; i) = \"OTHER\" Then\n    Rows(i).Select\n    Selection.Delete Shift:=xlUp\n    Number_Rows = Number_Rows - 1\n    i = i - 1\n\n    'Unit deal in the array already.\n    Else\n    Range(\"J\" &amp; i) = \"\"\n    End If\n\n'Not in array so needs to be added.\nElse\nRange(\"J\" &amp; i) = Application.WorksheetFunction.SumIf(Range(\"I:I\"), Oppt, Range(\"J:J\"))\n\n    If Range(\"W\" &amp; i) = \"OTHER\" Then\n\n    Range(Cells(i, 19), Cells(i, 26)) = \"\"\n\n    Else\n    End If\n\n'Redefines the size of the array factoring in new added row.\nReDim Preserve Array_Oppt(Rows_Array)\nArray_Oppt(Rows_Array) = Oppt\nRows_Array = Rows_Array + 1\nEnd If\n\nNext\n\n\n'Adds blank column for business manager.\n Columns(\"H:H\").Select\n Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n Range(\"H1\") = \"Business Manager\"\n\n\n 'Updates the titles of the last columns in  file\n  Range(\"AB1\") = Date - 2\n  Range(\"AC1\") = Date - 1\n  Range(\"AD1\") = \"Today\"\n  Range(\"AE1\") = \"Focus List\"\n  Range(\"AF1\") = \"% Chance\"\n  Range(\"AG1\") = \"Allocation Status\"\n  Range(\"AH1\") = \"New PO Date\"\n  Range(\"AI1\") = Date - 3\n  Range(\"AJ1\") = Date - 4\n  Range(\"AK1\") = Date - 5\n  Range(\"AL1\") = Date - 6\n  Range(\"AM1\") = Date - 7\n  Range(\"AN1\") = Date - 8\n  Range(\"AO1\") = Date - 9\n  Range(\"AP1\") = Date - 10\n  Range(\"AQ1\") = \"Partner Grouping\"\n  Range(\"AR1\") = \"VNX Models\"\n  Range(\"AS1\") = \"Commit + X\"\n  Range(\"AT1\") = \"Country\"\n  Range(\"AU1\") = \"Theater\"\n\n\n  'Moves to Sheet2 and copies Upside X column B to the end (column AV) for the purpose of VLookup. Then returns to Sheet1.\nSheet2.Activate\nSheet2.Columns(\"B:B\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nSheet2.Columns(\"AV:AV\").Select\nActiveSheet.Paste\nSheet1.Activate\n\n\n'Loop to add Linked status; and to complete VLookups from yesterday.\n For i = 2 To Number_Rows\n\n'If to check linked status\nIf Range(\"L\" &amp; i) = \"\" Then\nRange(\"M\" &amp; i) = \"Not Linked\"\n\nElse\nRange(\"M\" &amp; i) = \"Linked\"\nEnd If\n\n\n'Vlookups\nOn Error Resume Next\nErr.Clear\n'Vlookup to add business manager\nSheet1.Range(\"H\" &amp; i) = Application.VLookup(Sheet1.Range(\"G\" &amp; i), Sheet3.Range(\"A:B\"), 2, False)\n'Vlookup to add comments from 2 days ago to column AB\nSheet1.Range(\"AB\" &amp; i) = Application.VLookup(Sheet1.Range(\"J\" &amp; i), Sheet2.Range(\"J:AR\"), 20, False)\n'Vlookup to add comments from yesterday to column AC\nSheet1.Range(\"AC\" &amp; i) = Application.VLookup(Sheet1.Range(\"J\" &amp; i), Sheet2.Range(\"J:AR\"), 21, False)\n'Vlookup to add data from Focus List column\nSheet1.Range(\"AE\" &amp; i) = Application.VLookup(Sheet1.Range(\"J\" &amp; i), Sheet2.Range(\"J:AR\"), 22, False)\n'Vlookup to add data from % Chance column\nSheet1.Range(\"AF\" &amp; i) = Application.VLookup(Sheet1.Range(\"J\" &amp; i), Sheet2.Range(\"J:AR\"), 23, False)\n'Vlookup to add data from Allocation Status column\nSheet1.Range(\"AG\" &amp; i) = Application.VLookup(Sheet1.Range(\"J\" &amp; i), Sheet2.Range(\"J:AR\"), 24, False)\n'Vlookup to add data from New PO Date column\nSheet1.Range(\"AH\" &amp; i) = Application.VLookup(Sheet1.Range(\"J\" &amp; i), Sheet2.Range(\"J:AR\"), 25, False)\n'Vlookup to add data from 3 days ago to column AI\nSheet1.Range(\"AI\" &amp; i) = Application.VLookup(Sheet1.Range(\"J\" &amp; i), Sheet2.Range(\"J:AR\"), 19, False)\n'Vlookup to add data from 4 days ago to column AJ\nSheet1.Range(\"AJ\" &amp; i) = Application.VLookup(Sheet1.Range(\"J\" &amp; i), Sheet2.Range(\"J:AR\"), 26, False)\n'Vlookup to add data from 5 days ago to column AK\nSheet1.Range(\"AK\" &amp; i) = Application.VLookup(Sheet1.Range(\"J\" &amp; i), Sheet2.Range(\"J:AR\"), 27, False)\n'Vlookup to add data from 6 days ago to column AL\nSheet1.Range(\"AL\" &amp; i) = Application.VLookup(Sheet1.Range(\"J\" &amp; i), Sheet2.Range(\"J:AR\"), 28, False)\n'Vlookup to add data from 7 days ago to column AM\nSheet1.Range(\"AM\" &amp; i) = Application.VLookup(Sheet1.Range(\"J\" &amp; i), Sheet2.Range(\"J:AR\"), 29, False)\n'Vlookup to add data from 8 days ago to column AN\nSheet1.Range(\"AN\" &amp; i) = Application.VLookup(Sheet1.Range(\"J\" &amp; i), Sheet2.Range(\"J:AR\"), 30, False)\n'Vlookup to add data from 9 days ago to column AO\nSheet1.Range(\"AO\" &amp; i) = Application.VLookup(Sheet1.Range(\"J\" &amp; i), Sheet2.Range(\"J:AR\"), 31, False)\n'Vlookup to add data from 10 days ago to column AP\nSheet1.Range(\"AP\" &amp; i) = Application.VLookup(Sheet1.Range(\"J\" &amp; i), Sheet2.Range(\"J:AR\"), 32, False)\n'Vlookup to add data to VNX Models column AR from VNX Models sheet 5 using Item Number column\nSheet1.Range(\"AR\" &amp; i) = Application.VLookup(Sheet1.Range(\"W\" &amp; i), Sheet5.Range(\"A:B\"), 2, False)\n'Vlookup to add data to Upside X column B\nSheet1.Range(\"B\" &amp; i) = Application.VLookup(Sheet1.Range(\"J\" &amp; i), Sheet2.Range(\"J:AV\"), 39, False)\n'Vlookup to add  Country to Country column AT based on Mapping Table sheet 4\nSheet1.Range(\"AT\" &amp; i) = Application.VLookup(Sheet1.Range(\"G\" &amp; i), Sheet4.Range(\"A:B\"), 2, False)\n'Vlookup to add Theater to Theater column AU based on Mapping Table sheet 4\nSheet1.Range(\"AU\" &amp; i) = Application.VLookup(Sheet1.Range(\"G\" &amp; i), Sheet4.Range(\"A:C\"), 3, False)\n\nIf Err.Number = 0 Then\nElse\nEnd If\n\n\nNext\n\n\n\n 'Adding Formula for Commit + X Column AS for Conf Call Analysis file\n  Range(\"AS2\").Formula =     \"=IF(C2=\"\"Commit\"\",\"\"Commit+X\"\",IF(B2=\"\"X\"\",\"\"Commit+X\"\",\"\"\"\"))\"\n  Range(\"AS2\").Select\n  Selection.AutoFill Destination:=Range(\"AS2:AS\" &amp; Number_Rows)\n\n\n\n\n  '***********FORMATTING BELOW**************\n\n\n 'Format Revenue column K - no decimal, 1,000 seperator.\n  Columns(\"K:K\").Select\n  Selection.NumberFormat = \"#,##0\"\n\n 'Format Forecast Close Date column P\n  Columns(\"P:P\").Select\n  Selection.NumberFormat = \"d/m/yyyy\"\n\n 'Format Focus List column AE\n  Columns(\"AE:AE\").Select\n  Selection.NumberFormat = \"d/m/yyyy\"\n\n 'Format % Chance column AF\n  Columns(\"AF:AF\").Select\n  Selection.NumberFormat = \"0%\"\n\n 'Format cells with Dates as titles to dd-mm rather than long date\n  Range(\"AB1:AC1\").Select\n  Selection.NumberFormat = \"d-mmm\"\n  Range(\"AI1:AP1\").Select\n  Selection.NumberFormat = \"d-mmm\"\n\n\n 'Add Data Validation to Allocation Status column\n  Columns(\"AG:AG\").Select\n  With Selection.Validation\n    .Delete\n    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n    xlBetween, Formula1:=\"=_Allocation\"\n    .IgnoreBlank = True\n    .InCellDropdown = True\n    .InputTitle = \"\"\n    .ErrorTitle = \"\"\n    .InputMessage = \"\"\n    .ErrorMessage = \"\"\n    .ShowInput = True\n    .ShowError = True\nEnd With\n\n\n 'Sorting by Description A-Z, Business Manager A-Z and Revenue $ Largest to    Smallest\n  Sheet1.Sort.SortFields.Clear\n  Sheet1.Sort.SortFields.Add Key:=Range(\"C2:C\" &amp; Number_Rows _\n    ), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\nSheet1.Sort.SortFields.Add Key:=Range(\"H2:H\" &amp; Number_Rows _\n    ), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\nSheet1.Sort.SortFields.Add Key:=Range(\"K2:K\" &amp; Number_Rows _\n    ), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\nWith Sheet1.Sort\n    .SetRange Range(\"A1:AU\" &amp; Number_Rows)\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n\n\n 'Hide Columns Quarter AA,Primary Partner OO, Reporting Product Type TT, Product Line VV, Opportunity Source Code QQ\n Columns(\"A:A\").Select\n Selection.EntireColumn.Hidden = True\n Columns(\"O:O\").Select\n Selection.EntireColumn.Hidden = True\n Columns(\"T:T\").Select\n Selection.EntireColumn.Hidden = True\n Columns(\"Q:Q\").Select\n Selection.EntireColumn.Hidden = True\n Columns(\"V:V\").Select\n Selection.EntireColumn.Hidden = True\n\n\n 'Colours Today column AD yellow\n  Columns(\"AD:AD\").Select\nWith Selection.Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .Color = 65535\n    .TintAndShade = 0\n    .PatternTintAndShade = 0\nEnd With\n\n\n 'Colours Allocation Status column AG blue\n  Columns(\"AG:AG\").Select\nWith Selection.Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .Color = 15773696\n    .TintAndShade = 0\n    .PatternTintAndShade = 0\nEnd With\n\n\n  'Bold Headings in row 1\n   Rows(\"1:1\").Select\n   Selection.Font.Bold = True\n\n\n 'Adding Conditional Formatting Order Number column J, to highlight all duplicate values so that all oppts that have more than one row are red.\n  Columns(\"J:J\").Select\n  Selection.FormatConditions.AddUniqueValues\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nSelection.FormatConditions(1).DupeUnique = xlDuplicate\nWith Selection.FormatConditions(1).Font\n    .Color = -16383844\n    .TintAndShade = 0\nEnd With\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 13551615\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\n\n\n 'Adding last updated date\n  Sheet3.Range(\"J1\") = Date\n\n\n 'Allows screen to refresh at the end\n  Application.ScreenUpdating = True\n\n\n 'Msgbox to advise when macro is complete.\n  MsgBox (\"File is now updated.\")\n\n\n  End Sub\n</code></pre>\n\n<p>I have figured out a number of work arounds, however, these slow down our productivity, and the error can comeback later on in the day. Can somebody tell me what is the likely cause of this problem?</p>\n"}, {"tags": ["excel", "vba", "email", "email-attachments"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1429106262, "post_id": 29651807, "comment_id": 47444280, "body": "Get rid of this line <code>On Error Resume Next</code> and see which part of your macro is causing an error.  My guess is you&#39;re using wrong syntax to add the attachment, or something else is not right. But the <code>On Error Resume Next</code> is preventing you from seeing (useful) information about the error which is happening. With that line in place, it simply keeps processing the macro as if there was no error, even though there probably was."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 4792075, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bb7b07d9097f67bcbc4eb5a5d887dc8c?s=128&d=identicon&r=PG&f=1", "display_name": "CorinneGermany", "link": "https://stackoverflow.com/users/4792075/corinnegermany"}, "edited": false, "score": 0, "creation_date": 1429130269, "post_id": 29652488, "comment_id": 47460291, "body": "Just found your reply, sorry.  Did what you suggested and you are right,  it was catching on that attachment code.  Changed it and now it gets all the was to send before falling over.  I have had it working before all be it without the attachment so may have messed with something that was OK during all my attempts to fix it.  I will check through it again tomorrow to see if I may have messed up something I had working in the first place."}, {"owner": {"reputation": 43, "user_id": 4792075, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bb7b07d9097f67bcbc4eb5a5d887dc8c?s=128&d=identicon&r=PG&f=1", "display_name": "CorinneGermany", "link": "https://stackoverflow.com/users/4792075/corinnegermany"}, "edited": false, "score": 0, "creation_date": 1429161085, "post_id": 29652488, "comment_id": 47470562, "body": "Yep, the other problem was due to my constant messing to solve the first problem.  The correct coding for attaching a document using Gmail as you kindly pointed out is:   AddAttachment, and  not Attachments.Add   Thank you!"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 3, "last_activity_date": 1429106801, "creation_date": 1429106801, "answer_id": 29652488, "question_id": 29651807, "link": "https://stackoverflow.com/questions/29651807/why-doesnt-attachments-add-work-when-i-send-an-email-from-excel/29652488#29652488", "title": "Why doesn&#39;t Attachments.Add work when I send an Email from Excel?", "body": "<p>A quick google search suggests the appropriate method is <a href=\"https://msdn.microsoft.com/en-us/library/ms526983%28v=exchg.10%29.aspx\" rel=\"nofollow\"><code>AddAttachment</code></a>, not <code>Attachments.Add</code> (the latter is for MS Outlook).  There may be other errors in your method calls, so my recommendation above still stands: debug <strong>without</strong> <code>On Error Resume Next</code></p>\n"}], "owner": {"reputation": 43, "user_id": 4792075, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bb7b07d9097f67bcbc4eb5a5d887dc8c?s=128&d=identicon&r=PG&f=1", "display_name": "CorinneGermany", "link": "https://stackoverflow.com/users/4792075/corinnegermany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2757, "favorite_count": 0, "accepted_answer_id": 29652488, "answer_count": 1, "score": 1, "last_activity_date": 1585688967, "creation_date": 1429105194, "last_edit_date": 1585688967, "question_id": 29651807, "link": "https://stackoverflow.com/questions/29651807/why-doesnt-attachments-add-work-when-i-send-an-email-from-excel", "title": "Why doesn&#39;t Attachments.Add work when I send an Email from Excel?", "body": "<p>I have a workbook from which I create a PDF based on a range of cells. This all works fine. I do this separately from producing the Email so it can be checked before its Emailed.\nI then create an Email from the same workbook to send with the PDF attached. The body of the Email is created from a another range of cells from the workbook. Again, no problems with doing that.\nThe problems came when I send it. The Email sends fine and the body of the Email is fine but just without the attachment.</p>\n\n<p>I have triple checked the file path of the attachment (even moving it to a simpler path to test) and change it to attach a simple word document. I have also used two different Email providers 1&amp;1 and GMail but with the same problem. That attachment just does not want to leave me.</p>\n\n<p>I have also noticed that I now have a message appear by the mouse pointer whenever I hover over a link of any kind. The message is : error while processing request - wrong response. I can only guess it has something to do with all the test Emails I have been firing off but no idea what it means or how to get rid of it. Have I something still running?</p>\n\n<pre><code>Sub CDO_Send_Email_Angebot()\n\n    Dim Rng As Range\n    Dim iMsg As Object\n    Dim ws As Worksheet\n    Dim Flds As Variant\n    Dim iConf As Object\n    Dim PdfFile As String\n\n    PdfFile = Sheets(\"5_Angebot\").Range(\"E97\").Value &amp; \".\" &amp; Sheets(\"5_Angebot\").Range(\"E98\").Value\n\n    'MsgBox rngAttachment\n\n    '---------- Get the Emails from a cells on the sheet\n\n    Dim SendItTo As String\n    Dim SenderEmail As String\n    Dim Subjectext As String\n\n    SendItTo = Sheets(\"5_Angebot\").Range(\"E94\").Value\n    SenderEmail = Sheets(\"5_Angebot\").Range(\"E95\").Value\n    SubjectText = Sheets(\"5_Angebot\").Range(\"E96\").Value\n\n    '---------\n\n    Set iMsg = CreateObject(\"CDO.Message\")\n    Set iConf = CreateObject(\"CDO.Configuration\")\n\n    iConf.Load -1    ' CDO Source Defaults\n    Set Flds = iConf.Fields\n    With Flds\n        .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpusessl\") = True\n        .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpauthenticate\") = 1\n\n        .Item(\"http://schemas.microsoft.com/cdo/configuration/sendusername\") = SenderEmail\n\n        '.Item(\"http://schemas.microsoft.com/cdo/configuration/sendpassword\") = \"**********\"\n        '.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserver\") = \"smtp.1and1.com\"\n        .Item(\"http://schemas.microsoft.com/cdo/configuration/sendpassword\") = \"***********\"\n        .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserver\") = \"smtp.gmail.com\"\n\n        .Item(\"http://schemas.microsoft.com/cdo/configuration/sendusing\") = 2\n        .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserverport\") = 25\n        .Update\n    End With\n    ' ------\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    Set Rng = Nothing\n    On Error Resume Next\n\n    Set Rng = Selection.SpecialCells(xlCellTypeVisible)\n    Set Rng = Sheets(\"5_Angebot\").Range(\"C101:J121\")\n\n    Set iMsg = CreateObject(\"CDO.Message\")\n    With iMsg\n        Set .Configuration = iConf\n        .To = SendItTo\n        .From = SenderEmail\n        .Subject = SubjectText\n\n        .HTMLBody = RangetoHTML(Rng)\n\n        '.Attachments.Add PdfFile\n        .Attachments.Add (\"D:\\Corinne\\test.docx\")\n        .Send\n    End With\n    Set iMsg = Nothing\n\n    ' --------\n    With Application\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 649, "user_id": 4271859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/300a758b7adcf9faa29b5b4beffc9528?s=128&d=identicon&r=PG&f=1", "display_name": "Yaegz", "link": "https://stackoverflow.com/users/4271859/yaegz"}, "edited": false, "score": 0, "creation_date": 1429104036, "post_id": 29651312, "comment_id": 47442452, "body": "Plesae give us your initial input, and your expected output based on that input."}, {"owner": {"reputation": 29, "user_id": 3983869, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/KhK7j.jpg?s=128&g=1", "display_name": "BenC", "link": "https://stackoverflow.com/users/3983869/benc"}, "edited": false, "score": 0, "creation_date": 1429106865, "post_id": 29651312, "comment_id": 47444740, "body": "Sorry to confuse no there is two columns in total."}], "answers": [{"tags": [], "owner": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1429105280, "creation_date": 1429105280, "answer_id": 29651846, "question_id": 29651312, "link": "https://stackoverflow.com/questions/29651312/how-to-check-two-lists-for-match/29651846#29651846", "title": "How to check two lists for match", "body": "<p>I suggest you to use a VBA function:</p>\n\n<pre><code>Function FULLMATCH(Range1 As Range, Range2 As Range) As Boolean\n\n    Dim cell As Range\n    FULLMATCH = False\n\n    For Each cell In Range1.Cells\n        If (cell.Value &lt;&gt; Range2.Cells(cell.Row, cell.Column).Value) Then\n            Exit Function\n        End If\n    Next\n\n    FULLMATCH = True\nEnd Function\n</code></pre>\n\n<p>And use it like this example:</p>\n\n<pre><code>=FULLMATCH(A:A;B:B)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4734241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fef9754b342d5bbbf6399835d5c0fe1?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Sellers", "link": "https://stackoverflow.com/users/4734241/ryan-sellers"}, "is_accepted": false, "score": 0, "last_activity_date": 1429110025, "creation_date": 1429110025, "answer_id": 29653756, "question_id": 29651312, "link": "https://stackoverflow.com/questions/29651312/how-to-check-two-lists-for-match/29653756#29653756", "title": "How to check two lists for match", "body": "<p>shA.t's answer would likely be easier long term but if you want to go with a Vlookup you could do something like this:</p>\n\n<pre><code>=IF(ISNA(VLOOKUP(HDD,Sent,1,FALSE)),CONCATENATE(\"File not sent: \",HDD),VLOOKUP(HDD,Sent,1,FALSE))\n</code></pre>\n\n<p>In this case I put the list of files on the HDD in a named range simply named HDD and a list of sent files in a named range named Sent. You could just as easily replace the named ranges with something like Sheet1!B1:B5 if you wanted to.</p>\n\n<p>If it fails to find a file in the Sent list that is in the HDD list thus returning #N/A instead it returns a message telling you which file from the HDD list wasn't sent. </p>\n\n<p>If you plan on just having the three columns (HDD list, Sent list, and formula) on a single worksheet you could remove the rest and just use this:</p>\n\n<pre><code>=VLOOKUP(HDD,Sent,1,FALSE)\n</code></pre>\n\n<p>But the first formula will work if you have the two lists in separate worksheets or separate excel files and make it easier to see which files are missing.</p>\n"}], "owner": {"reputation": 29, "user_id": 3983869, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/KhK7j.jpg?s=128&g=1", "display_name": "BenC", "link": "https://stackoverflow.com/users/3983869/benc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 209, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1429110025, "creation_date": 1429103726, "last_edit_date": 1531161705, "question_id": 29651312, "link": "https://stackoverflow.com/questions/29651312/how-to-check-two-lists-for-match", "title": "How to check two lists for match", "body": "<p>I want to know which would be the best way to check two lists of text within Excel. I have one list, that has file names which exist on my HDD and I wish to reference these against a second list, of file names which I should have received to make sure that none of them are missing.</p>\n\n<p>I did try </p>\n\n<pre><code> =VLOOKUP(A2,Sheet9!A:B,2,FALSE)\n</code></pre>\n\n<p>Although this brings back a value it does not match the value in the list.</p>\n\n<p>If you require more clarification then let me know.\nI can't post images at the moment so hopefully this (example) will clear things up a bit.</p>\n\n<p>List of files supposedly sent:-</p>\n\n<ul>\n<li>CC-2245-SXV.PDF</li>\n<li>CC-2222-SXV.PDF    </li>\n<li>CC-0001-SXV.PDF    </li>\n<li>DF-2322-CDSC.PDF   </li>\n<li>CC-6221-SXV.PDF    </li>\n</ul>\n\n<p>File names on my HDD:-</p>\n\n<ul>\n<li>CC-0001-SXV.PDF</li>\n<li>CC-0161-SXV.PDF</li>\n<li>CC-2221-CCXV.PDF</li>\n<li>CC-6221-SXV.PDF</li>\n<li>DF-2322-CDSC.PDF</li>\n</ul>\n\n<p>The reason I want to automate this is because I'm dealing with 1000's of files. </p>\n"}, {"tags": ["windows", "excel", "vba", "powershell"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1429147622, "post_id": 29651272, "comment_id": 47466897, "body": "If you just need the macro available for any workbook you open, save the workbook containing your macro as an Excel add-in (.xlam) at the default location.  Then go to Developer -&gt; Add-ins and check the box to enable it. If you want to modify the macro itself to open multiple files, you&#39;d probably want to edit your question to include the code."}, {"owner": {"reputation": 55, "user_id": 4792031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9dbc01255eebc5d9a16b605395223b?s=128&d=identicon&r=PG&f=1", "display_name": "IAmKiserWilhelm", "link": "https://stackoverflow.com/users/4792031/iamkiserwilhelm"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1430486860, "post_id": 29651272, "comment_id": 48094666, "body": "I was unable to use your guidance, xlam is apparently unsupported in Excel 2013."}], "answers": [{"tags": [], "owner": {"reputation": 128, "user_id": 4579685, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-C59XJBW1ADE/AAAAAAAAAAI/AAAAAAAABoU/Jq2XcOn3Uto/photo.jpg?sz=128", "display_name": "Antoine Hejl&#237;k", "link": "https://stackoverflow.com/users/4579685/antoine-hejl%c3%adk"}, "is_accepted": false, "score": 0, "last_activity_date": 1429104154, "creation_date": 1429104154, "answer_id": 29651458, "question_id": 29651272, "link": "https://stackoverflow.com/questions/29651272/running-a-macro-on-multiple-excel-files/29651458#29651458", "title": "Running a macro on multiple Excel files", "body": "<p>I am currently on work-PC with old 2003 Excel and when I open Macros, I have there the list of macros and \"Use macros from all opened files\" or \"use only from this file\" switch. So just make one file with macro with your code and then open other files and call macros from another file, Excel can handle this!\nFor newer versions I cannot try, but I am sure this useful thing can't be killed...?</p>\n"}], "owner": {"reputation": 55, "user_id": 4792031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9dbc01255eebc5d9a16b605395223b?s=128&d=identicon&r=PG&f=1", "display_name": "IAmKiserWilhelm", "link": "https://stackoverflow.com/users/4792031/iamkiserwilhelm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430486802, "creation_date": 1429103651, "last_edit_date": 1430486802, "question_id": 29651272, "link": "https://stackoverflow.com/questions/29651272/running-a-macro-on-multiple-excel-files", "title": "Running a macro on multiple Excel files", "body": "<p>I'm sure this question was asked, but I can't find a solution that works for my situation. I have a text file that contains macro instructions to enter the time date in every record that is entered. I have been pasting the code in an excel file via the VB \"view code\" view and saving it as the file name that I want.</p>\n\n<p>The problem is that it takes forever to do this on the hundreds of files I have to modify. Is there any way to automate this?</p>\n\n<p>I have tried to record a macro where I paste the code and save the file, but it will save the file name of the original file that I recorded the macro on. Is there any way to edit the macro to save the file in the current directory with the current file name?</p>\n\n<p>I record a macro,\nI paste this code into a sheet: </p>\n\n<p><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    '   Code goes in the Worksheet specific module\n    Dim rng As Range\n        '   Set Target Range, i.e. Range(\"A1, B2, C3\"), or Range(\"A1:B3\")\n        Set rng = Target.Parent.Range(\"A:A\")\n             '   Only look at single cell changes\n            If Target.Count &gt; 1 Then Exit Sub\n            '   Only look at that range\n            If Intersect(Target, rng) Is Nothing Then Exit Sub\n            '   Action if Condition(s) are met (do your thing here...)\n            With Target\n                .Offset(, 1) = Date\n                .Offset(, 2) = Time\n            End With\nEnd Sub\n</code>\nThen I stop the macro. This is the result: </p>\n\n<p><code>Sub save()\n save Macro\n    Sheets(\"Sheet1\").Select\n    ChDir \"P:\\Inventory\\templates\\NB (D) Kelso 011\"\n    ActiveWorkbook.SaveAs Filename:= _\n        \"P:\\Inventory\\templates\\NB (D) Kelso 011\\D101.xlsm\", FileFormat:= _\n        xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False\nEnd Sub\n</code></p>\n"}, {"tags": ["excel", "vba", "pdf", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 4791754, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7681e8fbd617e81e41d0415ff4bbe605?s=128&d=identicon&r=PG&f=1", "display_name": "A Elsheikh", "link": "https://stackoverflow.com/users/4791754/a-elsheikh"}, "edited": false, "score": 0, "creation_date": 1429106074, "post_id": 29651627, "comment_id": 47444107, "body": "thanks for your prompt reply. but can you please advice where to place those codes? first code in Outlook? a regular module? and the second code in excel? if so i tried but i could assign the excel macro to a button so i wait for you kind reply"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 89, "user_id": 4791754, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7681e8fbd617e81e41d0415ff4bbe605?s=128&d=identicon&r=PG&f=1", "display_name": "A Elsheikh", "link": "https://stackoverflow.com/users/4791754/a-elsheikh"}, "edited": false, "score": 0, "creation_date": 1429107442, "post_id": 29651627, "comment_id": 47445143, "body": "Place everything in excel, they can&#39;t communicate if the are in separate applications (they can but it is more complex). Look at the code I added, at the start, it create an Outlook application to be able to interact with it in Excel directly. For your method with URL, Excel should be enough too."}, {"owner": {"reputation": 89, "user_id": 4791754, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7681e8fbd617e81e41d0415ff4bbe605?s=128&d=identicon&r=PG&f=1", "display_name": "A Elsheikh", "link": "https://stackoverflow.com/users/4791754/a-elsheikh"}, "edited": false, "score": 0, "creation_date": 1429161304, "post_id": 29651627, "comment_id": 47470643, "body": "thanks for your help but after trying the codes it saves as pdf and start the outlook but with no attachments still :("}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 89, "user_id": 4791754, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7681e8fbd617e81e41d0415ff4bbe605?s=128&d=identicon&r=PG&f=1", "display_name": "A Elsheikh", "link": "https://stackoverflow.com/users/4791754/a-elsheikh"}, "edited": false, "score": 0, "creation_date": 1429171376, "post_id": 29651627, "comment_id": 47475857, "body": "Did you use the second part of the code I put (because URL mailto won&#39;t add attachment), use the <code>sub EnvoiMail</code> with the PJ parameter and the &quot;/&quot; separator for your attachments!"}, {"owner": {"reputation": 89, "user_id": 4791754, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7681e8fbd617e81e41d0415ff4bbe605?s=128&d=identicon&r=PG&f=1", "display_name": "A Elsheikh", "link": "https://stackoverflow.com/users/4791754/a-elsheikh"}, "edited": false, "score": 0, "creation_date": 1429176963, "post_id": 29651627, "comment_id": 47479412, "body": "i think i used the code in a wrong way, if i may not waste your time can you please put the code in a workbook and send me the file so you make sure everything in it`s corrected place and make sure it works as you mean."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 89, "user_id": 4791754, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7681e8fbd617e81e41d0415ff4bbe605?s=128&d=identicon&r=PG&f=1", "display_name": "A Elsheikh", "link": "https://stackoverflow.com/users/4791754/a-elsheikh"}, "edited": false, "score": 0, "creation_date": 1429179384, "post_id": 29651627, "comment_id": 47481159, "body": "I changed it in the edit, just take the whole code and put it in a module in Excel! ;)"}, {"owner": {"reputation": 89, "user_id": 4791754, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7681e8fbd617e81e41d0415ff4bbe605?s=128&d=identicon&r=PG&f=1", "display_name": "A Elsheikh", "link": "https://stackoverflow.com/users/4791754/a-elsheikh"}, "edited": false, "score": 0, "creation_date": 1429181754, "post_id": 29651627, "comment_id": 47482794, "body": "you know what? you are a genius it worked like a charm actually. thank you very much and please tell me how to mark this problem as solved and rate your answer"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 89, "user_id": 4791754, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7681e8fbd617e81e41d0415ff4bbe605?s=128&d=identicon&r=PG&f=1", "display_name": "A Elsheikh", "link": "https://stackoverflow.com/users/4791754/a-elsheikh"}, "edited": false, "score": 0, "creation_date": 1429183235, "post_id": 29651627, "comment_id": 47483837, "body": "Great! Ok so at the start/top of the answer, you have two arrows (vote up and vote down) and right under it, you will see a tick that is still gray. To validate answer, you need to click on that tick that will become green and you may vote up too! Enjoy SO! ;)"}, {"owner": {"reputation": 89, "user_id": 4791754, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7681e8fbd617e81e41d0415ff4bbe605?s=128&d=identicon&r=PG&f=1", "display_name": "A Elsheikh", "link": "https://stackoverflow.com/users/4791754/a-elsheikh"}, "edited": false, "score": 0, "creation_date": 1429187769, "post_id": 29651627, "comment_id": 47487386, "body": "thank you very much, i selected as solved by it said i need +15 rep to be able to vote up :( sorry actually. one more question please, how to include my signature in the new created message by the code?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 89, "user_id": 4791754, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7681e8fbd617e81e41d0415ff4bbe605?s=128&d=identicon&r=PG&f=1", "display_name": "A Elsheikh", "link": "https://stackoverflow.com/users/4791754/a-elsheikh"}, "edited": false, "score": 0, "creation_date": 1429188346, "post_id": 29651627, "comment_id": 47487878, "body": "NP mate, it should be better now! ;) For signature, you will find all the info you need in there : <a href=\"http://www.rondebruin.nl/win/s1/outlook/signature.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s1/outlook/signature.htm</a>"}, {"owner": {"reputation": 89, "user_id": 4791754, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7681e8fbd617e81e41d0415ff4bbe605?s=128&d=identicon&r=PG&f=1", "display_name": "A Elsheikh", "link": "https://stackoverflow.com/users/4791754/a-elsheikh"}, "edited": false, "score": 0, "creation_date": 1429189235, "post_id": 29651627, "comment_id": 47488589, "body": "i really appreciate your prompt replies and perfect answers. once again thank you :)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 89, "user_id": 4791754, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7681e8fbd617e81e41d0415ff4bbe605?s=128&d=identicon&r=PG&f=1", "display_name": "A Elsheikh", "link": "https://stackoverflow.com/users/4791754/a-elsheikh"}, "edited": false, "score": 0, "creation_date": 1429191698, "post_id": 29651627, "comment_id": 47490680, "body": "Don&#39;t mention it ;) Just when you will be a master-coder take some time to answer and up vote what is helpful to you now that you can ;)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 0, "last_activity_date": 1429179282, "last_edit_date": 1429179282, "creation_date": 1429104630, "answer_id": 29651627, "question_id": 29650124, "link": "https://stackoverflow.com/questions/29650124/merging-two-excel-vba-code-save-as-pdf-send-via-outlook/29651627#29651627", "title": "Merging two Excel VBA Code (Save as PDF + Send Via Outlook)", "body": "<p>You can try this :\nIt changes the PDF export to a function to get the file path and use it as an argument in the other one.\nURL method doesn't works with attachments, so below is some code for Outlook(<strong>edited to contain the whole code</strong>)</p>\n\n<p>Preparing mail with Outlook (sorry for french comments):</p>\n\n<pre><code>Sub Send_To_Pdf()\nDim PdfPath As String\nDim BoDy As String\n\nBoDy = Msg = \"Dear Mr. \" &amp; vbCrLf &amp; vbCrLf &amp; \"Good Day\" &amp; vbCrLf &amp; vbCrLf &amp; \"Kindly find the attahched P.O to be delivered to \" &amp; Cells(10, 12)\n\n\nPdfPath = Save_as_pdf\nEnvoiMail Right(PdfPath, InStr(1, StrReverse(PdfPath), \"\\\") - 1), \"recepient1@domain.com;recepient2@domain.com\", , , BoDy, 1, PdfPath\nEnd Sub\n\nPublic Function Save_as_pdf() As String\nDim FSO As Object\nDim s(1) As String\nDim sNewFilePath As String\n\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\n\ns(0) = \"C:\\Users\\\" &amp; Environ(\"UserName\") &amp; \"\\Desktop\\\" &amp; ThisWorkbook.Name\n\nIf FSO.FileExists(ThisWorkbook.FullName) Then\n    '//Change Excel Extension to PDF extension in FilePath\n    s(1) = FSO.GetExtensionName(s(0))\n\n    If s(1) &lt;&gt; \"\" Then\n        s(1) = \".\" &amp; s(1)\n        sNewFilePath = Replace(s(0), s(1), \".pdf\")\n\n        '//Export to PDF with new File Path\n        ActiveSheet.ExportAsFixedFormat _\n            Type:=xlTypePDF, _\n            Filename:=sNewFilePath, _\n            Quality:=xlQualityStandard, IncludeDocProperties:=True, _\n            IgnorePrintAreas:=False, OpenAfterPublish:=False\n    End If\nElse\n    '//Error: file path not found\n    MsgBox \"Error: this workbook may be unsaved.  Please save and try again.\"\nEnd If\n\nSet FSO = Nothing\n\nSave_as_pdf = sNewFilePath\n\nEnd Function\n\n\nSub EnvoiMail(Subject As String, Destina As String, Optional CCdest As String, Optional CCIdest As String, Optional BoDyTxt As String, Optional NbPJ As Integer, Optional PjPaths As String)\n  Dim MonOutlook As Object\n  Dim MonMessage As Object\n  Set MonOutlook = CreateObject(\"Outlook.Application\")\n  Set MonMessage = MonOutlook.createitem(0)\n\n  Dim PJ() As String\n  PJ() = Split(PjPaths, \";\")\n\n  With MonMessage\n      .Subject = Subject      '\"Je suis content\"\n      .To = Destina           '\"marcel@machin.com;julien@chose.com\"\n      .cc = CCdest            '\"chef@machin.com;directeur@chose.com\"\n      .bcc = CCIdest          '\"un.copain@supermail.com;une-amie@hotmail.com\"\n      .BoDy = BoDyTxt\n        If PjPaths &lt;&gt; \"\" And NbPJ &lt;&gt; 0 Then\n            For i = 0 To NbPJ - 1\n                'MsgBox PJ(I)\n              .Attachments.Add PJ(i)      '\"C:\\Mes Documents\\Zoulie Image.gif\"\n            Next i\n        End If\n      .display\n      '.send                        '.Attachments.Add ActiveWorkbook.FullName\n  End With                        '?plusieurs?MonMessage.Attachments.Add \"D:\\Prof\\Janvier\\Base clients.mdb\"\n\n  Set MonOutlook = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 4791754, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7681e8fbd617e81e41d0415ff4bbe605?s=128&d=identicon&r=PG&f=1", "display_name": "A Elsheikh", "link": "https://stackoverflow.com/users/4791754/a-elsheikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 567, "favorite_count": 1, "accepted_answer_id": 29651627, "answer_count": 1, "score": 1, "last_activity_date": 1429179282, "creation_date": 1429100621, "last_edit_date": 1429102719, "question_id": 29650124, "link": "https://stackoverflow.com/questions/29650124/merging-two-excel-vba-code-save-as-pdf-send-via-outlook", "title": "Merging two Excel VBA Code (Save as PDF + Send Via Outlook)", "body": "<p>kindly I have a two <code>VBA</code> codes one is to save the printed area as PDF with the same name as the workbook is and save file location is Desktop and it works fine\nand I do have another code which start outlook new message and take some specific cell value as subject and another value as body.</p>\n\n<p>The problem is I want the code of the new mail to attach that saved PDF file from code 1 and make the subject to be same as PDF file name.</p>\n\n<p>The save pdf code is:</p>\n\n<pre><code>Sub Save_as_pdf()\nDim FSO As Object\nDim s(1) As String\nDim sNewFilePath As String\n\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\n\ns(0) = \"C:\\Users\\\" &amp; Environ(\"UserName\") &amp; \"\\Desktop\\\" &amp; ThisWorkbook.Name\n\nIf FSO.FileExists(ThisWorkbook.FullName) Then\n    '//Change Excel Extension to PDF extension in FilePath\n    s(1) = FSO.GetExtensionName(s(0))\n\n    If s(1) &lt;&gt; \"\" Then\n        s(1) = \".\" &amp; s(1)\n        sNewFilePath = Replace(s(0), s(1), \".pdf\")\n\n        '//Export to PDF with new File Path\n        ActiveSheet.ExportAsFixedFormat _\n            Type:=xlTypePDF, _\n            Filename:=sNewFilePath, _\n            Quality:=xlQualityStandard, IncludeDocProperties:=True, _\n            IgnorePrintAreas:=False, OpenAfterPublish:=False\n    End If\nElse\n    '//Error: file path not found\n    MsgBox \"Error: this workbook may be unsaved.  Please save and try again.\"\nEnd If\n\nSet FSO = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>... and the second outlook new email code is :</p>\n\n<pre><code>Private Declare Function ShellExecute Lib \"shell32.dll\" _\nAlias \"ShellExecuteA\" (ByVal hwnd As Long, ByVal lpOperation As String, _\nByVal lpFile As String, ByVal lpParameters As String, ByVal lpDirectory As     String, _\nByVal nShowCmd As Long) As Long\n\nSub SendEMail()\nDim Email As String, Subj As String\nDim Msg As String, URL As String\n\nEmail = \" \"\n\nSubj = \"P.O # \" &amp; \"-\" &amp; Cells(9, 5) &amp; \"-\" &amp; Cells(15, 2) &amp; \"-\" &amp; Cells(15, 8) &amp; Cells(15, 7)\n\nMsg = \" \"\nMsg = \"Dear Mr. \" &amp; vbCrLf &amp; vbCrLf &amp; \"Good Day\" &amp; vbCrLf &amp; vbCrLf &amp; \"Kindly find the attahched P.O to be delivered to \" &amp; Cells(10, 12)\n\n\n\n'Replace spaces with %20 (hex)\nSubj = Application.WorksheetFunction.Substitute(Subj, \" \", \"%20\")\nMsg = Application.WorksheetFunction.Substitute(Msg, \" \", \"%20\")\n\n'Replace carriage returns with %0D%0A (hex)\nMsg = Application.WorksheetFunction.Substitute(Msg, vbCrLf, \"%0D%0A\")\n\n'Create the URL\nURL = \"mailto:\" &amp; Email &amp; \"?subject=\" &amp; Subj &amp; \"&amp;body=\" &amp; Msg\n\n\n\n'Execute the URL (start the email client)\nShellExecute 0&amp;, vbNullString, URL, vbNullString, vbNullString, vbNormalFocus\n\n'Wait two seconds before sending keystrokes\n'Application.Wait (Now + TimeValue(\"0:00:02\"))\n'Application.SendKeys \"%s\"\nEnd Sub\n</code></pre>\n\n<p>I hope I could clarify my problem fine.\nThanks in advance.</p>\n"}, {"tags": ["html", "vba", "internet-explorer", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1429115075, "post_id": 29649844, "comment_id": 47451028, "body": "The form you&#39;re submitting will open a new window because its &quot;target&quot; attribute is set to &quot;output&quot;.  If you set the target to &quot;_self&quot; before submitting, then it will open in the same window instead of a new one."}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1429126499, "post_id": 29649844, "comment_id": 47458102, "body": "@TimWilliams This looks very promising. Thank you very much! I will test it tomorrow. I still don&#39;t know how to manipulate a hidden popup, but this workaround will do very well."}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1429163789, "post_id": 29649844, "comment_id": 47471585, "body": "@TimWilliams. It works, but now I get a &quot;dummy window&quot;. In the source code of the page, i found <code>var newwindow = window.open(&#39;dummy.html&#39;,&#39;output&#39;,&#39;height=700,width=550,tool&zwnj;&#8203;bar=no,scrollbars=ye&zwnj;&#8203;s,resizable&#39;);</code>. It looks like some script. <b>How can I disable this? I don&#39;t want that popup at all.</b> I don&#39;t know how to find this code in HTML using VBA. Don&#39;t know where to look."}], "owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1331, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1429099821, "creation_date": 1429099821, "last_edit_date": 1531164843, "question_id": 29649844, "link": "https://stackoverflow.com/questions/29649844/vba-html-downloading-data-from-hidden-ie-window", "title": "VBA HTML : Downloading data from hidden IE window", "body": "<p>I'm trying to navigate to <a href=\"http://re.jrc.ec.europa.eu/pvgis/apps4/pvest.php\" rel=\"nofollow\">Photovoltaic Geographical Information System - Interactive Maps</a>(done), fill the fields I need (done), press <strong>Caluclate</strong> with <strong>Web page</strong> as output option(done).</p>\n\n<p>Then a window with data pops up. I want to dowload the content of a data table to my worksheet and close both windows.<br>\nI'm able to do this only with <code>InternetExplorer.visible = True</code> (using a loop through <code>ShellWindows</code>, there are 2 windows => correct, but I don't want windows to be visible). However when the <code>InternetExplorer.visible = False</code> there is only the main window, not the popup => incorrect.</p>\n\n<p><strong><em>My question is:</em></strong> How can I point to the <strong>hidden popup window</strong> and download the data from it? Probably using something different than <em>ShellWindows</em>.  </p>\n\n<p><strong>The code</strong>  </p>\n\n<pre><code>Sub PVGISDownload()\n\n    Dim IE As New SHDocVw.InternetExplorer\n    Dim shellWins As New ShellWindows\n\n    With IE\n        .Navigate \"http://re.jrc.ec.europa.eu/pvgis/apps4/pvest.php\"\n        .Visible = False 'false will not work correctly, unable to get to the popup\n\n        Do While IE.readyState &lt;&gt; 4: DoEvents: Loop\n\n        With .document\n            .getElementsByname(\"address\")(0).Value = \"nitra\"\n\n            Set htmlColl = .getElementsBytagname(\"input\")\n            For Each htmlInput In htmlColl\n                If Trim(htmlInput.Type) = \"submit\" And htmlInput.Value = \"Search\" Then\n                    htmlInput.Click 'set location\n                    Exit For\n                End If\n            Next htmlInput\n\n            Do While IE.readyState &lt;&gt; 4: DoEvents: Loop\n            'set options (among others)\n            .getElementsByname(\"outputchoicebuttons\")(0).Click\n\n            Do While IE.readyState &lt;&gt; 4: DoEvents: Loop\n            '! Blocked by automatic popups (enabled by hand for now)\n            .getElementsByname(\"PVchoicesubmit\")(0).Click 'click for the Popup window with data\n\n            Debug.Print shellWins.Count 'with visible = 2, with hidden = 1\n\n        End With '.document\n    End With 'IE\n\n        'check all opened windows and find the one with PV output\n        For Each shlWindow In shellWins  \n'...code to process the data  \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "combobox"], "answers": [{"tags": [], "owner": {"reputation": 571, "user_id": 4340990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac421880c2178ee38d120ad3b1c7fa2a?s=128&d=identicon&r=PG&f=1", "display_name": "Liniel", "link": "https://stackoverflow.com/users/4340990/liniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1429100481, "creation_date": 1429100481, "answer_id": 29650070, "question_id": 29648854, "link": "https://stackoverflow.com/questions/29648854/onkey-delete-clear-combobox/29650070#29650070", "title": "OnKey &quot;Delete&quot; clear combobox", "body": "<p>Please try: <code>frmZakupy.value=''</code></p>\n\n<p>It's a good practice to don't use special characters like '\u015b','\u0107' in any names.</p>\n"}, {"comments": [{"owner": {"reputation": 117, "user_id": 4725975, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e24cdcbed19057ce6671ccf3c5d74048?s=128&d=identicon&r=PG&f=1", "display_name": "kkris77", "link": "https://stackoverflow.com/users/4725975/kkris77"}, "edited": false, "score": 0, "creation_date": 1429102860, "post_id": 29650666, "comment_id": 47441557, "body": "Thank you, works like a charm. Can you please tell me why you used KeyDown event ? Shoudn&#39;t it be KeyPress ? Would it make a difference ?"}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "reply_to_user": {"reputation": 117, "user_id": 4725975, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e24cdcbed19057ce6671ccf3c5d74048?s=128&d=identicon&r=PG&f=1", "display_name": "kkris77", "link": "https://stackoverflow.com/users/4725975/kkris77"}, "edited": false, "score": 0, "creation_date": 1429103180, "post_id": 29650666, "comment_id": 47441782, "body": "I don&#39;t know why, but KeyPress does not capture keys like Delete and Backspace, so you have to use KeyDown (or KeyUp)."}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": true, "score": 1, "last_activity_date": 1429102120, "creation_date": 1429102120, "answer_id": 29650666, "question_id": 29648854, "link": "https://stackoverflow.com/questions/29648854/onkey-delete-clear-combobox/29650666#29650666", "title": "OnKey &quot;Delete&quot; clear combobox", "body": "<p>You can use the KeyDown event to capture the Delete key (KeyCode = 46) when the user is in the combobox.</p>\n\n<pre><code>Private Sub NazwaPola_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n\n    If KeyCode = 46 Then\n        Me.NazwaPola.Value = vbNullString\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 4725975, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e24cdcbed19057ce6671ccf3c5d74048?s=128&d=identicon&r=PG&f=1", "display_name": "kkris77", "link": "https://stackoverflow.com/users/4725975/kkris77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1717, "favorite_count": 1, "accepted_answer_id": 29650666, "answer_count": 2, "score": 3, "last_activity_date": 1591771154, "creation_date": 1429096848, "last_edit_date": 1591771154, "question_id": 29648854, "link": "https://stackoverflow.com/questions/29648854/onkey-delete-clear-combobox", "title": "OnKey &quot;Delete&quot; clear combobox", "body": "<p>I have a userform with multiple comboboxes. User can type in a new item or pick one from the list.</p>\n\n<p>He can start typing first letters of wanted item but when he makes a mistake and starts with e.g. \"b\" instead of \"n\" he has to clear the combobox manually or find the item on the list using mouse or arrows.</p>\n\n<p>I would like to quickly clear the box using the delete key so the user can start typing again. But I don't know where to put this line of code if correct (enter event, change event, some other maybe?). </p>\n\n<pre><code>Application.OnKey \"{Delete}\", \"WyczyscPole\"\n</code></pre>\n\n<p>First Excel needs to know which box the user is in, and then clear it.</p>\n\n<p>I tried to create separate module with a variable that finds out the current combobox name and clear it in next step. But I don't know whether called sub below is even correct.</p>\n\n<pre><code>Sub WyczyscPole()\n\nDim NazwaPola As ComboBox\n\nNazwaPola = frmZakupy.ActiveControl.Name\nNazwaPola.Clear\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "cell"], "comments": [{"owner": {"reputation": 41696, "user_id": 680068, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/73fd13cfacc3a0a0fc0a8c95f50d8a3f?s=128&d=identicon&r=PG", "display_name": "zx8754", "link": "https://stackoverflow.com/users/680068/zx8754"}, "edited": false, "score": 0, "creation_date": 1429096173, "post_id": 29648538, "comment_id": 47437109, "body": "Do you mean, in first sheet we enter <code>111</code> to <code>A1</code>, then enter <code>222</code> to <code>A1</code>, you want <code>111</code> to show up on second sheet? I don&#39;t think this is possible without VBA."}, {"owner": {"reputation": 7, "user_id": 4247558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eee5450a09dfc394ebf6df4221bc0ac?s=128&d=identicon&r=PG&f=1", "display_name": "danijelam", "link": "https://stackoverflow.com/users/4247558/danijelam"}, "reply_to_user": {"reputation": 41696, "user_id": 680068, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/73fd13cfacc3a0a0fc0a8c95f50d8a3f?s=128&d=identicon&r=PG", "display_name": "zx8754", "link": "https://stackoverflow.com/users/680068/zx8754"}, "edited": false, "score": 0, "creation_date": 1429171060, "post_id": 29648538, "comment_id": 47475691, "body": "any ideas about VBA code? I dont know how to write that code? please help"}, {"owner": {"reputation": 41696, "user_id": 680068, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/73fd13cfacc3a0a0fc0a8c95f50d8a3f?s=128&d=identicon&r=PG", "display_name": "zx8754", "link": "https://stackoverflow.com/users/680068/zx8754"}, "edited": false, "score": 0, "creation_date": 1429171215, "post_id": 29648538, "comment_id": 47475788, "body": "I added <code>vba</code> tag, hopefully someone familiar with VBA will have the answer."}, {"owner": {"reputation": 7, "user_id": 4247558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eee5450a09dfc394ebf6df4221bc0ac?s=128&d=identicon&r=PG&f=1", "display_name": "danijelam", "link": "https://stackoverflow.com/users/4247558/danijelam"}, "reply_to_user": {"reputation": 41696, "user_id": 680068, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/73fd13cfacc3a0a0fc0a8c95f50d8a3f?s=128&d=identicon&r=PG", "display_name": "zx8754", "link": "https://stackoverflow.com/users/680068/zx8754"}, "edited": false, "score": 0, "creation_date": 1429171593, "post_id": 29648538, "comment_id": 47475995, "body": "thanks...I hope that someone will find answer"}, {"owner": {"reputation": 4359, "user_id": 2088851, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/tNZyt.jpg?s=128&g=1", "display_name": "Voitcus", "link": "https://stackoverflow.com/users/2088851/voitcus"}, "edited": false, "score": 0, "creation_date": 1429171854, "post_id": 29648538, "comment_id": 47476163, "body": "Start with this: <a href=\"https://support.microsoft.com/en-us/kb/213612\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/213612</a>"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 4247558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eee5450a09dfc394ebf6df4221bc0ac?s=128&d=identicon&r=PG&f=1", "display_name": "danijelam", "link": "https://stackoverflow.com/users/4247558/danijelam"}, "edited": false, "score": 0, "creation_date": 1429097345, "post_id": 29648801, "comment_id": 47437764, "body": "no...I would like to have in sheet 2 value for A1- to stay 50"}], "tags": [], "owner": {"reputation": 2651, "user_id": 4632401, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/mrZ2J.jpg?s=128&g=1", "display_name": "Jordumus", "link": "https://stackoverflow.com/users/4632401/jordumus"}, "is_accepted": false, "score": -2, "last_activity_date": 1429096689, "creation_date": 1429096689, "answer_id": 29648801, "question_id": 29648538, "link": "https://stackoverflow.com/questions/29648538/copy-only-first-entered-value-into-cell/29648801#29648801", "title": "Copy only first entered value into cell", "body": "<p>in your 2nd sheet, you can put this in a cell: \u00b4=Sheet1!A1\".</p>\n\n<p>Sheet 1:</p>\n\n<pre><code>A1: 50\nB1: =A1 + 20\n</code></pre>\n\n<p>Sheet 2:</p>\n\n<pre><code>A1: =Sheet1!A1  //Will output \"50\"\nB1: =Sheet1!B1  //Will output '70\"\n</code></pre>\n\n<p>Change <code>A1</code>from sheet 1 to any other value, and the 2 cells in sheet 2 will update as well.</p>\n"}, {"tags": [], "owner": {"reputation": 7, "user_id": 4247558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eee5450a09dfc394ebf6df4221bc0ac?s=128&d=identicon&r=PG&f=1", "display_name": "danijelam", "link": "https://stackoverflow.com/users/4247558/danijelam"}, "is_accepted": false, "score": 0, "last_activity_date": 1429258858, "creation_date": 1429258858, "answer_id": 29693934, "question_id": 29648538, "link": "https://stackoverflow.com/questions/29648538/copy-only-first-entered-value-into-cell/29693934#29693934", "title": "Copy only first entered value into cell", "body": "<p>I found this code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\nDim VRange As Range, cell As Range\nDim Msg As String\nDim ValidateCode As Variant\nSet VRange = Range(\"B119:H130\")\nFor Each cell In Target\n    If Union(cell, VRange).Address = VRange.Address Then\n        Cells(cell.Row, Columns.Count).End(xlToLeft).Offset(, 1) = Date &amp; \" \" &amp; Time\n        Cells(cell.Row, Columns.Count).End(xlToLeft).Offset(, 1) = cell.Value\n    End If\nNext cell End Sub\n</code></pre>\n\n<p>that is ok, because now I have time of change and value that change...I need to have cell value of header of column and only first change of cell.\nhow to do that?</p>\n"}], "owner": {"reputation": 7, "user_id": 4247558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eee5450a09dfc394ebf6df4221bc0ac?s=128&d=identicon&r=PG&f=1", "display_name": "danijelam", "link": "https://stackoverflow.com/users/4247558/danijelam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1429258858, "creation_date": 1429095894, "last_edit_date": 1429171107, "question_id": 29648538, "link": "https://stackoverflow.com/questions/29648538/copy-only-first-entered-value-into-cell", "title": "Copy only first entered value into cell", "body": "<p>I have this problem: in Excel file I have two sheets. In first sheet I am entering values, changing values, deleting values... Sometimes, in one cell I enter value like this <code>125+138+458</code></p>\n\n<p>Now, I need to copy values into next sheet, but only values that have been first entered into first sheet.</p>\n"}, {"tags": ["arrays", "vba", "excel", "range"], "answers": [{"comments": [{"owner": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "edited": false, "score": 0, "creation_date": 1429098982, "post_id": 29648783, "comment_id": 47438892, "body": "That makes a lot of sense, thanks! Is there a way to show that on object is late bound programatically?  I can see it would be obvious with <code>Dim obj As Object</code> but intuitively I&#39;d expect <code>ActiveWorksheet</code> to return a <code>Worksheet</code> and indeed <code>TypeName(ActiveWorksheet)</code> would suggest this as well."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "edited": false, "score": 1, "creation_date": 1429099366, "post_id": 29648783, "comment_id": 47439167, "body": "But it&#39;s not <code>ActiveWorksheet</code>, it&#39;s <code>ActiveSheet</code> and that sheet could be a Chart sheet (or a macro sheet even) - that&#39;s why it returns an <code>Object</code>, not a <code>Worksheet</code>. The Object Browser will show the return type."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "edited": false, "score": 0, "creation_date": 1429102018, "post_id": 29648783, "comment_id": 47440992, "body": "@stucharo - The best hint that something was bound late is if you type a &#39;.&#39; after it and don&#39;t get a member list in the Intellesense."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 4, "last_activity_date": 1429173615, "last_edit_date": 1429173615, "creation_date": 1429096635, "answer_id": 29648783, "question_id": 29647434, "link": "https://stackoverflow.com/questions/29647434/explicit-and-implicit-use-of-activesheet-when-assigning-a-range-to-an-array/29648783#29648783", "title": "Explicit and implicit use of ActiveSheet when assigning a range to an array", "body": "<p>It's to do with the binding, and the use of default properties. <code>Activesheet</code> returns an Object, not a <code>Worksheet</code> so everything after that is late bound, whereas <code>Range(...)</code> is actually shorthand for <code>Application.Range</code> so it's early bound. If you declare a worksheet variable and assign ActiveSheet to it, the code will also work:</p>\n\n<pre><code>Dim ws As Worksheet\nSet ws = ActiveWorkbook.ActiveSheet\narr2 = ws.Range(\"A1:B2\") ' works\n</code></pre>\n\n<p>Declaring the variables as <code>Variant</code> rather than <code>Variant()</code> will also work.</p>\n\n<p>Moral of the story: <strong>always specify the property you mean!</strong></p>\n\n<p>From the VBA language spec:</p>\n\n<p><strong><em>5.6.2.3 Default Member Recursion Limits</em></strong></p>\n\n<p>Evaluation of an object whose default Property Get or default function returns another object can lead to a recursive evaluation process if the returned object has a further default member.  Recursion through this chain of default members may be implicit if evaluating to a simple data value and each default member has an empty parameter list, or explicit if index expressions are specified that specifically parameterize each default member.</p>\n\n<p>An implementation may define limits on when such a recursive default member evaluation is valid.  The limits may depend on factors such as the depth of the recursion, implicit vs. explicit specification of empty argument lists, whether members return specific classes vs. returning Object or Variant, whether the default members are functions vs. Property Gets, and whether the expression occurs on the lefthand-side of an assignment. \nThe implementation may determine such an evaluation to be invalid  statically or may raise error 9 (Subscript out of range) or 13 (Type mismatch) during evaluation at runtime</p>\n"}], "owner": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 780, "favorite_count": 1, "accepted_answer_id": 29648783, "answer_count": 1, "score": 0, "last_activity_date": 1429173615, "creation_date": 1429092528, "last_edit_date": 1531164843, "question_id": 29647434, "link": "https://stackoverflow.com/questions/29647434/explicit-and-implicit-use-of-activesheet-when-assigning-a-range-to-an-array", "title": "Explicit and implicit use of ActiveSheet when assigning a range to an array", "body": "<p>When considering @Crouzilles question: <a href=\"https://stackoverflow.com/questions/29607270/assigning-range-to-array-in-vba\">Assigning range to array in VBA</a> I realized that it mattered whether or not <code>ActiveWorkbook.ActiveSheet</code> was explicitly used to define a range.  For example:</p>\n\n<pre><code>Dim arr1() As Variant\nDim arr2() As Variant\n\narr1 = Range(\"A1:B2\")\narr2 = ActiveWorkbook.ActiveSheet.Range(\"A1:B2\")               'Type mismatch\n</code></pre>\n\n<p>I had assumed that both right hand sides would return a <code>Range</code> object and this would be cast into an array of variants; however, the second line generates a type mismatch error:</p>\n\n<pre><code>Run-time error '13': Type mismatch\n</code></pre>\n\n<p>To ensure that both statements did indeed return an array I checked <code>TypeName()</code>:</p>\n\n<pre><code>Debug.Print TypeName(Range(\"A1:B2\"))                            'Range\nDebug.Print TypeName(ActiveWorkbook.ActiveSheet.Range(\"A1:B2\")) 'Range\n</code></pre>\n\n<p>I also checked the <code>Range(\"A1:B1\").Worksheet.Name</code> property to ensure that <code>Range(\"A1:B2\")</code> was indeed a reference to the <code>ActiveWorkbook.ActiveSheet</code>.references</p>\n\n<p>I then tried to assign <code>Range().Value</code> to the arrays both variations, which executed correctly:</p>\n\n<pre><code>arr1 = Range(\"A1:B2\").Value\narr2 = ActiveWorkbook.ActiveSheet.Range(\"A1:B2\").Value          'No error\n</code></pre>\n\n<p>This makes sense as <code>.Value</code> converts a <code>Range</code> object to an array of variants....the same type as <code>arr1</code> and <code>arr2</code>:</p>\n\n<pre><code>Debug.Print TypeName(Range(\"A1:B2\").Value)                      'Variant()\nDebug.Print TypeName(ActiveWorkbook.ActiveSheet.Range(\"A1:B2\").Value)   'Variant()\n</code></pre>\n\n<p>To add to my confusion, explicitly assigning both variations to <code>Range</code> references allowed both arrays to be assigned:</p>\n\n<pre><code>Dim rng1 As Range\nDim rng2 As Range\n\nSet rng1 = Range(\"A1:B2\")\nSet rng2 = ActiveWorkbook.ActiveSheet.Range(\"A1:B2\")\n\narr1 = rng1\narr2 = rng2                                                     'No error\n</code></pre>\n\n<p>Can anyone explain why a <code>Range</code> object referenced by <code>Range(\"A1:B2\")</code> can be implicitly cast to an array of variants whilst <code>ActiveWorkbook.ActiveSheet.Range(\"A1:B2\")</code> cannot?</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1429093156, "post_id": 29647075, "comment_id": 47435204, "body": "You cannot update another cell&#39;s value with a formula, only the cell that the formula is contained in. Is there a reason you don&#39;t want to use VBA?"}, {"owner": {"reputation": 1536, "user_id": 1749354, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/8e2f3652fadd1fc58cbd9780977ab5d5?s=128&d=identicon&r=PG", "display_name": "lyk", "link": "https://stackoverflow.com/users/1749354/lyk"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1429093387, "post_id": 29647075, "comment_id": 47435357, "body": "@SOofWXLS, can&#39;t use VBA because the requirement for now is to update the list immediately once cell E11 gets an input value. I don&#39;t suppose there is any way of triggering a VBA code from such an action? Thus seeking opinions here if it&#39;s even possible"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1429093469, "post_id": 29647075, "comment_id": 47435402, "body": "Actually, that&#39;s exactly the kind of thing to use VBA for.... it&#39;s called a change event and is a very common use for VBA"}, {"owner": {"reputation": 1536, "user_id": 1749354, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/8e2f3652fadd1fc58cbd9780977ab5d5?s=128&d=identicon&r=PG", "display_name": "lyk", "link": "https://stackoverflow.com/users/1749354/lyk"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1429093615, "post_id": 29647075, "comment_id": 47435485, "body": "@SOofWXLS oh, so VBA allows for automaticatic code runs upon events (such as a change in cell value)? Okay thanks for the tip, I&#39;ll try to research towards that direction now in the meantime!"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1429093747, "post_id": 29647075, "comment_id": 47435566, "body": "This might get you started: <a href=\"http://www.cpearson.com/excel/Events.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/Events.aspx</a>"}, {"owner": {"reputation": 1536, "user_id": 1749354, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/8e2f3652fadd1fc58cbd9780977ab5d5?s=128&d=identicon&r=PG", "display_name": "lyk", "link": "https://stackoverflow.com/users/1749354/lyk"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1429093805, "post_id": 29647075, "comment_id": 47435597, "body": "@SOofWXLS, thanks for the link! will look into that =)"}, {"owner": {"reputation": 2706, "user_id": 4230650, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Xfm2v.jpg?s=128&g=1", "display_name": "Marcel", "link": "https://stackoverflow.com/users/4230650/marcel"}, "edited": false, "score": 0, "creation_date": 1429115009, "post_id": 29647075, "comment_id": 47450992, "body": "@lyk can you add an image of the expected behaviour you are looking for? an extended example will do. thanks"}, {"owner": {"reputation": 1536, "user_id": 1749354, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/8e2f3652fadd1fc58cbd9780977ab5d5?s=128&d=identicon&r=PG", "display_name": "lyk", "link": "https://stackoverflow.com/users/1749354/lyk"}, "reply_to_user": {"reputation": 2706, "user_id": 4230650, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Xfm2v.jpg?s=128&g=1", "display_name": "Marcel", "link": "https://stackoverflow.com/users/4230650/marcel"}, "edited": false, "score": 0, "creation_date": 1429148832, "post_id": 29647075, "comment_id": 47467224, "body": "@AHC, hi, what I&#39;m trying to achieve is basically is that once the user types in &quot;Cost Per Unit&quot; in the form under NewVariable (Column E), this get automatically updated in the VList Sheet, under the Column A which has the &quot;Project1&quot; header. &quot;Cost Per Unit&quot; will be updated in the list in cell A6. Do you still require an image for this?"}, {"owner": {"reputation": 1536, "user_id": 1749354, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/8e2f3652fadd1fc58cbd9780977ab5d5?s=128&d=identicon&r=PG", "display_name": "lyk", "link": "https://stackoverflow.com/users/1749354/lyk"}, "reply_to_user": {"reputation": 2706, "user_id": 4230650, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Xfm2v.jpg?s=128&g=1", "display_name": "Marcel", "link": "https://stackoverflow.com/users/4230650/marcel"}, "edited": false, "score": 0, "creation_date": 1429150313, "post_id": 29647075, "comment_id": 47467623, "body": "@AHC added an image, hopefully it is slightly clearer?"}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1429706752, "post_id": 29647075, "comment_id": 47724119, "body": "It&#39;s much clearer. Hopefully you&#39;ll get flooded with answers, especially if you change/add the tag for Excel VBA."}, {"owner": {"reputation": 1536, "user_id": 1749354, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/8e2f3652fadd1fc58cbd9780977ab5d5?s=128&d=identicon&r=PG", "display_name": "lyk", "link": "https://stackoverflow.com/users/1749354/lyk"}, "reply_to_user": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1429760189, "post_id": 29647075, "comment_id": 47754080, "body": "@user3819867 oh yea, thanks for that! have added in, as I previously didn&#39;t think it was possible with vba =)"}], "answers": [{"comments": [{"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1429706602, "post_id": 29797753, "comment_id": 47723981, "body": "See uploaded <a href=\"https://drive.google.com/file/d/0B-773Ttgo1z6anVJXzJNekllS0U/view?usp=sharing\" rel=\"nofollow noreferrer\">file</a>."}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1429707660, "post_id": 29797753, "comment_id": 47724873, "body": "Now that I think about it, you could simply accept other variables (not in list) and then run the same sub. In this case your current column would become obsolete thus input would be more convenient."}, {"owner": {"reputation": 1536, "user_id": 1749354, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/8e2f3652fadd1fc58cbd9780977ab5d5?s=128&d=identicon&r=PG", "display_name": "lyk", "link": "https://stackoverflow.com/users/1749354/lyk"}, "edited": false, "score": 0, "creation_date": 1429761905, "post_id": 29797753, "comment_id": 47754577, "body": "omg this solution is brilliant, thank you so much! I just need to edit a little more to replace the wrong values (e.g. user typed &quot;Testing&quot; but found out is a typo, should be &quot;Testing1&quot;, and thus &quot;Testing1&quot; should replace &quot;Testing&quot;."}, {"owner": {"reputation": 1536, "user_id": 1749354, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/8e2f3652fadd1fc58cbd9780977ab5d5?s=128&d=identicon&r=PG", "display_name": "lyk", "link": "https://stackoverflow.com/users/1749354/lyk"}, "edited": false, "score": 0, "creation_date": 1429761963, "post_id": 29797753, "comment_id": 47754596, "body": "and anyway, I can&#39;t really use tables because VList is also produced from VBA codes and will be cleared and refreshed with new data periodically... hard to explain but yea.."}, {"owner": {"reputation": 1536, "user_id": 1749354, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/8e2f3652fadd1fc58cbd9780977ab5d5?s=128&d=identicon&r=PG", "display_name": "lyk", "link": "https://stackoverflow.com/users/1749354/lyk"}, "edited": false, "score": 0, "creation_date": 1429762607, "post_id": 29797753, "comment_id": 47754758, "body": "is there a way to .Find using the previous cell value under NewVariable and replace it with the correct one?"}, {"owner": {"reputation": 1536, "user_id": 1749354, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/8e2f3652fadd1fc58cbd9780977ab5d5?s=128&d=identicon&r=PG", "display_name": "lyk", "link": "https://stackoverflow.com/users/1749354/lyk"}, "edited": false, "score": 0, "creation_date": 1429769468, "post_id": 29797753, "comment_id": 47757435, "body": "Been trying Target.Value under the selectionChange method but still not working so far"}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "reply_to_user": {"reputation": 1536, "user_id": 1749354, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/8e2f3652fadd1fc58cbd9780977ab5d5?s=128&d=identicon&r=PG", "display_name": "lyk", "link": "https://stackoverflow.com/users/1749354/lyk"}, "edited": false, "score": 0, "creation_date": 1429774724, "post_id": 29797753, "comment_id": 47760525, "body": "Target may or may not be a single cell, I wouldn&#39;t recommend using <code>Target.Value</code>. The previous VList position can be stored in a global variable  replacing <code>HeaderRow + 1</code> or calculated again from the description given by you. The global variable is not recommended as you&#39;ll need to apply an exception rule for the first time it is used (after opening the workbook). The second option doesn&#39;t give you any advantage, takes more computing."}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "reply_to_user": {"reputation": 1536, "user_id": 1749354, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/8e2f3652fadd1fc58cbd9780977ab5d5?s=128&d=identicon&r=PG", "display_name": "lyk", "link": "https://stackoverflow.com/users/1749354/lyk"}, "edited": false, "score": 0, "creation_date": 1429775957, "post_id": 29797753, "comment_id": 47761300, "body": "Deletion from a table can be done through <code>Ctrl -</code> or using simple methods such as the one described in my edit."}, {"owner": {"reputation": 1536, "user_id": 1749354, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/8e2f3652fadd1fc58cbd9780977ab5d5?s=128&d=identicon&r=PG", "display_name": "lyk", "link": "https://stackoverflow.com/users/1749354/lyk"}, "edited": false, "score": 0, "creation_date": 1429779920, "post_id": 29797753, "comment_id": 47763964, "body": "ahhh i see... sadly I can&#39;t really used the Table method as I can&#39;t set the data in VList into a table format due to reasons stated earlier.. but I&#39;ll try to find alternatives in the meantime, thanks!"}], "tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": true, "score": 1, "last_activity_date": 1429776221, "last_edit_date": 1429776221, "creation_date": 1429706061, "answer_id": 29797753, "question_id": 29647075, "link": "https://stackoverflow.com/questions/29647075/updating-a-dynamic-dropdown-list-in-excel-upon-change-in-cell-value/29797753#29797753", "title": "Updating a dynamic dropdown list in excel upon change in cell value", "body": "<p>I was almost having fun with this one, if anyone can refine the screwed-up parts feel free to amend.<br>\nI furthermore recommend using tables. I do realise you can write lengthy formulae to refer to ranges but giving a name to your table gives an expanding list with a simple reference.  </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim NewVar As Range\nOn Error GoTo Err\nSet NewVar = Range(\"C:C\") 'data entered here, could be a referstorange kind of named range reference\nIf Application.WorksheetFunction.CountA(Intersect(Target, NewVar)) &lt;&gt; 0 Then Call ertdfgcvb(Target, NewVar) 'only run if there's an intersect, f*ed up but works anyway\nErr:\nEnd Sub\n\nSub ertdfgcvb(Target As Range, NewVar As Range)\nDim ws As Worksheet, Valid As Long, project As String, ListElmnt As String, Unlisted As Boolean, rng1 As Range, rng2 As Range\n\nSet ws = Sheets(\"VList\") 'the data that you refresh\nValid = 2 'projects in column B\nHeaderRow = 1 'headers in Vlist are in row #1\nuRow = Cells.Rows.Count 'f* yeah, compatibility considerations\n\nFor Each Cell In Intersect(Target, NewVar) 'will evaluate for each cell individually, in case you were to insert columns\n    ListElmnt = Cell.Value2            'stores the prospective list element\n    r = Cell.Row                       'stores the list element's row to...\n    project = Cells(r, Valid).Value2   'identify the related project\n\n    HeaderRowRef = HeaderRow &amp; \":\" &amp; HeaderRow\n    ColumnNum = ws.Range(HeaderRowRef).Find(What:=project, SearchDirection:=xlPrevious, SearchOrder:=xlByColumns, LookAt:=xlWhole).Column   'finds the project in VList\n    'MsgBox ws.Name\n    Set rng1 = ws.Cells(HeaderRow + 1, ColumnNum)\n    Set rng2 = ws.Cells(uRow, ColumnNum)\n    LastRow = ws.Range(ws.Cells(HeaderRow + 1, ColumnNum), ws.Cells(uRow, ColumnNum)).Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row 'finds the last row for the project in VList 'f*ed up but works\n    Unlisted = True                                                                  'assumes it's unlisted\n        For x = HeaderRow + 1 To LastRow\n            If ListElmnt = CStr(ws.Cells(x, ColumnNum).Value2) Then Unlisted = False 'unless proven otherwise\n        Next\n    If Unlisted Then ws.Cells(LastRow + 1, ColumnNum) = ListElmnt                    'if it's unlisted it gets appended to the end of the list\nNext\nEnd Sub\n</code></pre>\n\n<p>EDIT:<br>\nHow to purge the table, example:</p>\n\n<pre><code>Sub ert()\nDim rng As Range\n\nSet rng = Range(\"T\u00e1bl\u00e1zat1\")         'obviously the table name\nDo While x &lt; rng.Rows.Count          'for each row\n    If rng(x, 1).Value2 = \"\" Then    'if it's empty\n        rng(x, 1).Delete Shift:=xlUp 'then delete but retaining the table format\n    Else\n        x = x + 1                    'else go to the next line (note: with deletion comes a shift up!)\n    End If\nLoop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1536, "user_id": 1749354, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/8e2f3652fadd1fc58cbd9780977ab5d5?s=128&d=identicon&r=PG", "display_name": "lyk", "link": "https://stackoverflow.com/users/1749354/lyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8057, "favorite_count": 0, "accepted_answer_id": 29797753, "answer_count": 1, "score": 0, "last_activity_date": 1429776221, "creation_date": 1429091672, "last_edit_date": 1531161705, "question_id": 29647075, "link": "https://stackoverflow.com/questions/29647075/updating-a-dynamic-dropdown-list-in-excel-upon-change-in-cell-value", "title": "Updating a dynamic dropdown list in excel upon change in cell value", "body": "<p>I am trying to create a form which hopefully updates the list of values for a particular dropdown list automatically (without VBA codes) upon user's input immediately. </p>\n\n<p>Here is the form that the user will see:</p>\n\n<p><img src=\"https://i.stack.imgur.com/FrasN.png\" alt=\"enter image description here\"></p>\n\n<p>Currently, both Columns F and H is based on a data-validation formula:</p>\n\n<pre><code>INDIRECT(\"VList!\"&amp;SUBSTITUTE(ADDRESS(1,MATCH($B11,VList!$1:$1,0),1),\"1\",\"\")&amp;\"2:\"&amp;SUBSTITUTE(ADDRESS(1,MATCH($B11,VList!$1:$1,0),1),\"1\",\"\")&amp;COUNTA(INDIRECT(\"VList!\"&amp;ADDRESS(1,MATCH($B11,VList!$1:$1,0),4)&amp;\":\"&amp;ADDRESS(100,MATCH($B11,VList!$1:$1),4))))\n</code></pre>\n\n<p>... where <code>VList</code> refers to the sheet as shown below:</p>\n\n<p><img src=\"https://i.stack.imgur.com/mFqfu.png\" alt=\"enter image description here\"></p>\n\n<p>So my question here is, based on the Project Name in Column B, is there a way to update the list in sheet VList with the value <code>\"Cost Per Unit\" [Cell E11]</code>, so that the dropdown list in <code>F12</code> and <code>H12</code> get automatically updated with the value <code>\"Cost Per Unit\"</code>?</p>\n\n<p>Been researching a long time for this with no avail, so I'm hoping to seek some experts here to see if such a scenario is even possible without VBA. Thanks!</p>\n\n<p><strong>Edit:</strong> So I've been told that VBA codes can be triggered automatically upon changes in the cell value, so I am open to any solutions/help with VBA as well. Will be researching on that direction in the meantime!</p>\n\n<p><strong>Edit2:</strong> Added a simple illustration below that hopefully better depicts what I'm trying to achieve on excel:\n<img src=\"https://i.stack.imgur.com/u53fy.jpg\" alt=\"enter image description here\"></p>\n\n<p><strong>*Edit3:</strong> I'm starting to explore the Worksheet_SelectionChange method, and this is what I've come out so far:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Dim projectName As String\n    Dim VariableList As Worksheet\n    Dim Form As Worksheet\n\n    Dim thisRow As Integer\n    Dim correctColumn As Integer\n    Dim lastRow As Integer\n\n    Set VariableList = ThisWorkbook.Sheets(\"VList\")\n    Set Form = ThisWorkbook.Sheets(\"Form\")\n\n    On Error GoTo EndingSub\n\n    If Target.Column = 5 Then\n        thisRow = Target.Row\n        projectName = Form.Cells(thisRow, 2)\n\n        correctColumn = Application.Match(projectName, VariableList.Range(\"1:1\"), 0)\n\n        lastRow = VariableList.Columns(correctColumn).Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\n        VariableList.Cells(lastRow + 1, correctColumn).value = Form.Cells(5, thisRow).value\n\n    End If\n\nEndingSub:\n\nEnd Sub\n</code></pre>\n\n<p>Somehow the value of <code>Form.Cells(5, thisRow).Value</code> is always empty. </p>\n\n<p>If I change it to <code>Target.Value</code> it still takes the previous value that was being input (e.g. I first put \"ABC\" as New Variable, it doesn't get updated. I changed New Variable to \"DEF\", it updates the list with \"ABC\" instead of \"DEF\"). It also takes ALL the values that are under Column E somehow.</p>\n\n<p>Also, pressing Enter after I placed one input in E11 also causes both values of E11 and E12 to be updated when only E12 has been changed. However if I click away after E11 is being input, then only E11's value gets updated.</p>\n\n<p>What exactly am I doing wrong here?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 0, "creation_date": 1429096661, "post_id": 29646839, "comment_id": 47437377, "body": "You should debug it on your work computer to see where it fails (if starts at all). As it runs well in one pc probably the code is right."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4790757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/535f9dd0c5b9c6b833ceff10368c7bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4790757/alex"}, "edited": false, "score": 0, "creation_date": 1429107687, "post_id": 29649069, "comment_id": 47445349, "body": "Thanks for your answers. I debugged it, and I saw that the macro wasn&#39;t executing the do until loop, so I selected before the cell, and then it worked. Don&#180;t know if it&#39;s logical, but I&#39; glad that it works."}, {"owner": {"reputation": 43, "user_id": 4773706, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5xWnfNGayrU/AAAAAAAAAAI/AAAAAAAAADk/tP6u3bNrBLw/photo.jpg?sz=128", "display_name": "Amila Pathum Kandambi", "link": "https://stackoverflow.com/users/4773706/amila-pathum-kandambi"}, "reply_to_user": {"reputation": 11, "user_id": 4790757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/535f9dd0c5b9c6b833ceff10368c7bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4790757/alex"}, "edited": false, "score": 0, "creation_date": 1429110725, "post_id": 29649069, "comment_id": 47447771, "body": "You are always well come. I made the answer by debugging as well :) The the loop was not executing with the selection. Please accept the answer if it solves your problem. Thanks! :)"}], "tags": [], "owner": {"reputation": 43, "user_id": 4773706, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5xWnfNGayrU/AAAAAAAAAAI/AAAAAAAAADk/tP6u3bNrBLw/photo.jpg?sz=128", "display_name": "Amila Pathum Kandambi", "link": "https://stackoverflow.com/users/4773706/amila-pathum-kandambi"}, "is_accepted": false, "score": 0, "last_activity_date": 1429097890, "last_edit_date": 1429097890, "creation_date": 1429097437, "answer_id": 29649069, "question_id": 29646839, "link": "https://stackoverflow.com/questions/29646839/nothing-happens-when-macro-is-executed/29649069#29649069", "title": "Nothing happens when macro is executed", "body": "<p>If I got your question correct, you need to make a selection on the active sheet and if the condition satisfies, you need to do something. Right? But Is your Do Until Loop is correct? </p>\n\n<p><code>ActiveSheet.Unprotect \"password\"\n Range(\"B\" &amp; rowtolock &amp; \":G\" &amp; rowtolock).Select\n Selection.Locked = False</code></p>\n\n<p>When you call like this ( Range(\"B\" &amp; rowtolock &amp; \":G\" &amp; rowtolock).Select), I hope the active cell changes in the sheet. Then the next iteration will check for the code selected cell.NOT THE ONE YOU ARE SELECTED (May be your home work sheet satisfied the condition: Just a Guess!)</p>\n\n<p>Best thing is to debug your loop and check the ActiveCell value. Thanks !!!</p>\n"}], "owner": {"reputation": 11, "user_id": 4790757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/535f9dd0c5b9c6b833ceff10368c7bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4790757/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2070, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1429097890, "creation_date": 1429090962, "last_edit_date": 1429095320, "question_id": 29646839, "link": "https://stackoverflow.com/questions/29646839/nothing-happens-when-macro-is-executed", "title": "Nothing happens when macro is executed", "body": "<p>I have a locked excel  sheet, and I want that when the sheet is getting activated by the user,  unlockthe range of cells that accomplish a condition (i.e. if cell A1 is > 0 then unlock Range A2:A5).</p>\n\n<p>On the other hand, I also want unlock always the Range K1:K372.</p>\n\n<p>I already have this code:</p>\n\n<pre><code>    ' macro activates by activating the Worksheet       \n    Private Sub Worksheet_Activate()\n' macro activates by activating the Worksheet\n' Set a counter to iterate through all the rows where to if the cell accomplishes the condition\nDim rowtolock As Integer\nrowtolock = 5\n\n\nDo Until IsEmpty(ActiveCell)\n'select the first cell where I will check if the value is greater or less than 0\n   Range(\"M\" &amp; rowtolock).Select\n    ' if the seleted cell value is greater or equal than 0, unprotect the sheet (because it\u00b4s protectet), select the range I want to unlock so that the user can makes changes JUST on those cells, unlock them, and finally lock anotherway the sheet.\n   If ActiveCell.Value &gt;= 0 Then\n        ActiveSheet.Unprotect \"password\"\n        Range(\"B\" &amp; rowtolock &amp; \":G\" &amp; rowtolock).Select\n        Selection.Locked = False\n        Selection.FormulaHidden = False\n        ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True\n    End If\n    ' add 1 to the counter, so that the next selected cell is one row below\n    rowtolock = rowtolock + 1\nLoop\n\n'unprotect sheet, unlock range, and protect sheet\nActiveSheet.Unprotect \"password\"\nRange(\"K1:K372\").Select\nSelection.Locked = False\nSelection.FormulaHidden = False\nActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True\nEnd Sub\n</code></pre>\n\n<p>This code actually works on my computer at home, but on my computer at work, it executes the macro, but nothing changes, all the cells/ the whole sheet is locked, but not the range K1:K372</p>\n\n<p>Somebody knows what is happening or what could be different at home than at work?</p>\n\n<p>Thanks a lot!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 4791158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89738cd959a24068cc7a5cee9f846ef6?s=128&d=identicon&r=PG&f=1", "display_name": "Ariel Flashner", "link": "https://stackoverflow.com/users/4791158/ariel-flashner"}, "is_accepted": true, "score": 4, "last_activity_date": 1429091321, "last_edit_date": 1495539817, "creation_date": 1429091321, "answer_id": 29646962, "question_id": 29646773, "link": "https://stackoverflow.com/questions/29646773/format-specific-text-within-a-cell-with-vba/29646962#29646962", "title": "Format specific text within a cell with VBA?", "body": "<p>I believe the answer could be found here:\n<a href=\"https://stackoverflow.com/questions/10295380/excel-vba-make-part-of-string-bold\">excel vba: make part of string bold</a></p>\n\n<p>Specifically,</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"name/A/date\" &amp; Chr(10) &amp; \"name/B/date\" &amp; Chr(10) &amp; \"name/C/date\"\nWith ActiveCell.Characters(Start:=25, Length:=4).Font\n    .FontStyle = \"Bold\"\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3656, "favorite_count": 0, "accepted_answer_id": 29646962, "answer_count": 1, "score": 0, "last_activity_date": 1429091321, "creation_date": 1429090744, "last_edit_date": 1429091282, "question_id": 29646773, "link": "https://stackoverflow.com/questions/29646773/format-specific-text-within-a-cell-with-vba", "title": "Format specific text within a cell with VBA?", "body": "<p>When I use Excel it allows me to set specific words within a cell to <strong>bold</strong> or <em>italic</em> or even change the text size.</p>\n\n<p>Is there a way of doing this in VBA?</p>\n\n<p>I have two cells with text. One cell contains a list of words which I separated into an array. The other cell contains a few sentences.</p>\n\n<p>I want to write a macro that highlights all words from cell 1 in cell 2.</p>\n\n<p>My idea was to use the array and InStr to search for the position of my words in cell 2. Once found I wanted to split cell 2, format one word an put everything back together.</p>\n\n<p>Maybe this is possible via Word?</p>\n"}, {"tags": ["sql-server", "excel", "combobox", "vba"], "comments": [{"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1429091027, "post_id": 29646619, "comment_id": 47433822, "body": "Could you share the schema of the table that the data is coming from?"}, {"owner": {"reputation": 117, "user_id": 4725975, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e24cdcbed19057ce6671ccf3c5d74048?s=128&d=identicon&r=PG&f=1", "display_name": "kkris77", "link": "https://stackoverflow.com/users/4725975/kkris77"}, "reply_to_user": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1429091228, "post_id": 29646619, "comment_id": 47433947, "body": "In this case it&#39;s a simple Person table with only ID and person&#39;s name: <a href=\"http://i58.tinypic.com/2ij2c1x.jpg\" rel=\"nofollow noreferrer\">i58.tinypic.com/2ij2c1x.jpg</a> For other comboboxes tables have multiple columns but I select data from one column only"}, {"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1429091288, "post_id": 29646619, "comment_id": 47433984, "body": "Sorry i mean what type is the name field in the table ie <code>nchar</code> etc"}, {"owner": {"reputation": 117, "user_id": 4725975, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e24cdcbed19057ce6671ccf3c5d74048?s=128&d=identicon&r=PG&f=1", "display_name": "kkris77", "link": "https://stackoverflow.com/users/4725975/kkris77"}, "reply_to_user": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1429091514, "post_id": 29646619, "comment_id": 47434114, "body": "Hell yeah, you got it. It&#39;s the data type:  <code>CREATE TABLE dbo.Osoba ( Osoba_ID INT NOT NULL IDENTITY (1,1), Imi\u0119 CHAR (8) NOT NULL, \tPRIMARY KEY (Osoba_ID) );</code>"}, {"owner": {"reputation": 117, "user_id": 4725975, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e24cdcbed19057ce6671ccf3c5d74048?s=128&d=identicon&r=PG&f=1", "display_name": "kkris77", "link": "https://stackoverflow.com/users/4725975/kkris77"}, "reply_to_user": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1429091572, "post_id": 29646619, "comment_id": 47434145, "body": "Should be <code>varchar</code> or <code>nvarchar</code>. In other combobox I have the same problem and the data type is <code>nchar</code>."}], "answers": [{"tags": [], "owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "is_accepted": false, "score": 1, "last_activity_date": 1429091682, "creation_date": 1429091682, "answer_id": 29647084, "question_id": 29646619, "link": "https://stackoverflow.com/questions/29646619/excel-vba-combobox-white-spaces-after-items-name/29647084#29647084", "title": "Excel vba combobox - white spaces after item&#39;s name", "body": "<p><code>nchar</code> and <code>char</code> both pad the strings in you table.</p>\n\n<p>Change the data type to <code>nvarchar</code> or <code>varchar</code> to resolve the issue.</p>\n\n<p>Note you'll need to amend the previous data in the table to remove the padding.</p>\n"}], "owner": {"reputation": 117, "user_id": 4725975, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e24cdcbed19057ce6671ccf3c5d74048?s=128&d=identicon&r=PG&f=1", "display_name": "kkris77", "link": "https://stackoverflow.com/users/4725975/kkris77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429132621, "creation_date": 1429090351, "last_edit_date": 1531164843, "question_id": 29646619, "link": "https://stackoverflow.com/questions/29646619/excel-vba-combobox-white-spaces-after-items-name", "title": "Excel vba combobox - white spaces after item&#39;s name", "body": "<p>I have created a userform with mutliple comboboxes. User can either pick item from the list or type in a new item. The list is filled with data selected from a database (MS SQL 2012). Userform then executes a stored procedure and inserts data to tables in database.</p>\n\n<p>When the item is chosen from the list, it's highlited in blue and there are some white spaces after the item. I have no idea where they came from and how to get rid of them. I've inserted some items directly to database so there shouldn't be any spaces. I added also some by using the userform and shouldn't be any either. Here's a print screen how it looks like:</p>\n\n<p><a href=\"http://i61.tinypic.com/2qn2rma.jpg\" rel=\"nofollow\">image</a> (too little reputation for posting images)</p>\n\n<p>The code I am using to fill combobox:</p>\n\n<pre><code>    Private Sub cboImi\u0119_Enter()\n\n\nOn Error GoTo Combobox_Initialize_Err\n\n    Dim rsImi\u0119 As New ADODB.Recordset\n\n    rsImi\u0119.Open \"SELECT DISTINCT Imi\u0119 FROM Osoba;\", con, adOpenStatic\n\n    If rsImi\u0119.RecordCount = 0 Then\n        cboImi\u0119.AddItem\n            ElseIf cboImi\u0119.ListCount = 0 Then\n                rsImi\u0119.MoveFirst\n                With Me.cboImi\u0119\n                    Do\n                        .AddItem rsImi\u0119!Imi\u0119\n                        rsImi\u0119.MoveNext\n                    Loop Until rsImi\u0119.EOF\n                End With\n            Else: GoTo Combobox_Initialize_Exit\n    End If\n\nCombobox_Initialize_Exit:\n    On Error Resume Next\n    rsImi\u0119.Close\n    Set rsImi\u0119 = Nothing\nExit Sub\n\nCombobox_Initialize_Err:\n    MsgBox Err.Number &amp; vbCrLf &amp; Err.Description, vbCritical, \"Error!\"\n        rsImi\u0119.Close\n        Set rsImi\u0119 = Nothing\n        con.Close\n        Set con = Nothing\nEnd Sub\n</code></pre>\n\n<p>I'd be grateful for any tips how to avoid those white spaces.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1429090659, "post_id": 29646333, "comment_id": 47433592, "body": "Can you pre-populate with all 19 &#39;system&#39; worksheets and use <code>xlVeryHidden</code> on them until they are required?"}, {"owner": {"reputation": 21, "user_id": 4791027, "user_type": "registered", "profile_image": "https://graph.facebook.com/772514747845/picture?type=large", "display_name": "Tranman324", "link": "https://stackoverflow.com/users/4791027/tranman324"}, "edited": false, "score": 0, "creation_date": 1429103134, "post_id": 29646333, "comment_id": 47441753, "body": "Yeah I guess that&#39;s possible. I also don&#39;t want to inflate the file size."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1429103428, "post_id": 29646333, "comment_id": 47441984, "body": "Empty worksheets are not going to inflate the size appreciably and the worksheet code sheets could be prewritten. If size is any real consideration, save it as an XLSB rather than a XLSM."}], "answers": [{"tags": [], "owner": {"reputation": 1300, "user_id": 3005534, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/giBVn.jpg?s=128&g=1", "display_name": "Miguel_Ryu", "link": "https://stackoverflow.com/users/3005534/miguel-ryu"}, "is_accepted": false, "score": 2, "last_activity_date": 1429095888, "last_edit_date": 1429095888, "creation_date": 1429090603, "answer_id": 29646723, "question_id": 29646333, "link": "https://stackoverflow.com/questions/29646333/renaming-a-sheet-code-name-through-vba-code-not-through-properties/29646723#29646723", "title": "Renaming a sheet code name through VBA code (Not through properties)", "body": "<p>In the Excel object model a Worksheet has 2 different name properties:</p>\n\n<p>Worksheet.Name\nWorksheet.CodeName</p>\n\n<p>the Name property is read/write and contains the name that appears on the sheet tab. It is user and VBA changeable</p>\n\n<p><strike>the CodeName property is read-only</strike></p>\n\n<p>You can reference a particular sheet as Worksheets(\"Data\").Range(\"A1\") where Data is the .Name property or as Sheet1.Range(\"A1\") where Sheet1 is the codename of the worksheet.</p>\n\n<p>edit: \nYou can change the CodeName Property by accessing the VBA Project Model Components Extensibility.</p>\n\n<pre><code>ThisWorkbook.VBProject.VBComponents(Sheets(\"Sheetname\").CodeName).Name = \"Sheet\" &amp; Workbook.Sheets.Count\n</code></pre>\n\n<p>Just be sure to have the programmatic access to visual basic project.</p>\n\n<p>File -> Options -> Trust Center -> Trust Center Setttings -> Macro Settings -> Trust Access to the VBA Project object model.</p>\n"}, {"tags": [], "owner": {"reputation": 585, "user_id": 1007418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/735cb0177b4c3607b98b92d7862314a4?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Harding", "link": "https://stackoverflow.com/users/1007418/rich-harding"}, "is_accepted": false, "score": 0, "last_activity_date": 1518630398, "creation_date": 1518630398, "answer_id": 48793303, "question_id": 29646333, "link": "https://stackoverflow.com/questions/29646333/renaming-a-sheet-code-name-through-vba-code-not-through-properties/48793303#48793303", "title": "Renaming a sheet code name through VBA code (Not through properties)", "body": "<p>In your specific example, you could modify the CodeName in Workbook B before the user imports it to Workbook A - because if you copy a sheet to another workbook, it retains its CodeName.  Otherwise you have to get into modifying the VBProject itself, e.g.:</p>\n\n<pre><code>&lt;Workbook&gt;.VBProject.VBComponents(&lt;Workbook&gt;.Sheets(&lt;SheetName&gt;).CodeName).Properties(\"_Codename\").value = &lt;CodeName&gt;\n</code></pre>\n\n<p>I came up with (and tested) the copying solution for a slightly different case, where the workbook into which I'm copying the sheet has its VBAProject password-protected, which means that the above code throws:</p>\n\n<pre><code>50289 : Can't perform operation since the project is protected.\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4791027, "user_type": "registered", "profile_image": "https://graph.facebook.com/772514747845/picture?type=large", "display_name": "Tranman324", "link": "https://stackoverflow.com/users/4791027/tranman324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5880, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1518630398, "creation_date": 1429089568, "last_edit_date": 1429089638, "question_id": 29646333, "link": "https://stackoverflow.com/questions/29646333/renaming-a-sheet-code-name-through-vba-code-not-through-properties", "title": "Renaming a sheet code name through VBA code (Not through properties)", "body": "<p>I have a protected workbook A for the user which does not allow the user to copy over a sheet from another workbook B. In  workbook A I consider worksheets 1-19 (only have 13 sheets as of now, I allowed 19 for future expansion of the workbook) as \"system sheets\" and cannot be deleted or modified. Sheets 20-30 are \"non system sheets\" where the user can delete and modify as needed. </p>\n\n<p>I'm looking to have an import function where the user can import workbook B that contains 1 sheet into workbook A. workbook A would check to see how many \"non system sheets\" that currently exists and insert the new sheet at the end with a sheet number that is 20+. For example:</p>\n\n<pre><code>Total sheets in workbook A = 18\n\nTotal \"system sheets\" in A = 13 (sheet 1-sheet 13)\n\nTotal \"non system sheets\" in A = 5 (sheet 20-sheet 24)\n</code></pre>\n\n<p>If I were to import a new sheet workbook A would assign it as sheet 25</p>\n\n<p>I want VBA to change the code name(sheet number) and not the name of the sheet. </p>\n\n<p>I've tried searching for hows, can someone please point me in the right direction on how to do this? thanks!</p>\n"}, {"tags": ["vba", "outlook-2010"], "comments": [{"owner": {"reputation": 16420, "user_id": 15609, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/ZVG3d.jpg?s=128&g=1", "display_name": "Phil.Wheeler", "link": "https://stackoverflow.com/users/15609/phil-wheeler"}, "edited": false, "score": 0, "creation_date": 1429092444, "post_id": 29644989, "comment_id": 47434710, "body": "Can you confirm that the NOTE: line is actually part of the message&#39;s HTML table? Can you link to a Pastebin of the HTML code in its entirety?"}, {"owner": {"reputation": 11, "user_id": 4574446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e4f00a93b5bc86a1c53f2bdb3bffd3?s=128&d=identicon&r=PG&f=1", "display_name": "sajjad haider", "link": "https://stackoverflow.com/users/4574446/sajjad-haider"}, "reply_to_user": {"reputation": 16420, "user_id": 15609, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/ZVG3d.jpg?s=128&g=1", "display_name": "Phil.Wheeler", "link": "https://stackoverflow.com/users/15609/phil-wheeler"}, "edited": false, "score": 0, "creation_date": 1429163049, "post_id": 29644989, "comment_id": 47471284, "body": "actually when table data ends then one Note: line comes separately in the remaining body of Email Text - basically it tells us that this person was working in former role and reporting to former Line. so its long line and always comes after the end of TAble . e.g  table data ends - Note: Ricky Ponting was previously working as Tariff Implementation Support Officer(1A) in the compnay XYZ  Communications and was reporting to Mr Robin Sing."}, {"owner": {"reputation": 11, "user_id": 4574446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e4f00a93b5bc86a1c53f2bdb3bffd3?s=128&d=identicon&r=PG&f=1", "display_name": "sajjad haider", "link": "https://stackoverflow.com/users/4574446/sajjad-haider"}, "reply_to_user": {"reputation": 16420, "user_id": 15609, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/ZVG3d.jpg?s=128&g=1", "display_name": "Phil.Wheeler", "link": "https://stackoverflow.com/users/15609/phil-wheeler"}, "edited": false, "score": 0, "creation_date": 1429164405, "post_id": 29644989, "comment_id": 47471863, "body": "I am also getting following error and outlook stop and excel fetching of data from email folder stops Run-time error &quot;-2147023706 (800704a6)&#39;: Automation error A system Shutdown has already been scheduled  . Debug goes to this line and highlight it in yellow  Set IE = CreateObject(&quot;InternetExplorer.Application&quot;)"}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1429560374, "creation_date": 1429560374, "answer_id": 29757365, "question_id": 29644989, "link": "https://stackoverflow.com/questions/29644989/how-to-export-message-body-and-data-from-table-to-excel-from-outlook-2010/29757365#29757365", "title": "how to export message body and data from Table to Excel from outlook 2010", "body": "<p>A method of parsing text is described here: <a href=\"https://msdn.microsoft.com/en-us/library/dd492012(v=office.12).aspx#Outlook2007ProgrammingCh17_ParsingTextFromAMessageBody\" rel=\"nofollow\">17.2 Parsing text from a message body</a></p>\n\n<p>Make the appropriate changes to look for \"Note:\"</p>\n\n<pre><code>Sub FwdSelToAddr()\n    Dim objOL As Outlook.Application\n    Dim objItem As Object\n    Dim objFwd As Outlook.MailItem\n    Dim strAddr As String\n    On Error Resume Next\n    Set objOL = Application\n    Set objItem = objOL.ActiveExplorer.Selection(1)\n    If Not objItem Is Nothing Then\n        strAddr = ParseTextLinePair(objItem.Body, \"Email:\")\n        If strAddr &lt;&gt; \"\" Then\n            Set objFwd = objItem.Forward\n            objFwd.To = strAddr\n            objFwd.Display\n        Else\n            MsgBox \"Could not extract address from message.\"\n        End If\n    End If\n    Set objOL = Nothing\n    Set objItem = Nothing\n    Set objFwd = Nothing\nEnd Sub\n\nFunction ParseTextLinePair _\n  (strSource As String, strLabel As String)\n    Dim intLocLabel As Integer\n    Dim intLocCRLF As Integer\n    Dim intLenLabel As Integer\n    Dim strText As String\n    intLocLabel = InStr(strSource, strLabel)\n    intLenLabel = Len(strLabel)\n        If intLocLabel &gt; 0 Then\n        intLocCRLF = InStr(intLocLabel, strSource, vbCrLf)\n        If intLocCRLF &gt; 0 Then\n            intLocLabel = intLocLabel + intLenLabel\n            strText = Mid(strSource, _\n                            intLocLabel, _\n                            intLocCRLF - intLocLabel)\n        Else\n            intLocLabel = _\n              Mid(strSource, intLocLabel + intLenLabel)\n        End If\n    End If\n    ParseTextLinePair = Trim(strText)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4574446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e4f00a93b5bc86a1c53f2bdb3bffd3?s=128&d=identicon&r=PG&f=1", "display_name": "sajjad haider", "link": "https://stackoverflow.com/users/4574446/sajjad-haider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 618, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1429560374, "creation_date": 1429085656, "last_edit_date": 1429164001, "question_id": 29644989, "link": "https://stackoverflow.com/questions/29644989/how-to-export-message-body-and-data-from-table-to-excel-from-outlook-2010", "title": "how to export message body and data from Table to Excel from outlook 2010", "body": "<p>I usually get Employee announcement in emails and I need to compile excel sheet from all these emails to know change in status of employee from previous line to current line .</p>\n\n<p>Dear Concerned,</p>\n\n<p>The change in status of the following employee has been carried out as per following details:</p>\n\n<p>New Status</p>\n\n<p>Change in Job</p>\n\n<p>Effective Date</p>\n\n<p>01-Feb-2015</p>\n\n<p>Employee Name</p>\n\n<p>Ricky ponting</p>\n\n<p>Employee Code</p>\n\n<p>4982</p>\n\n<p>Designation</p>\n\n<p>Sourcing Executive (Secondment)</p>\n\n<p>Job Group</p>\n\n<p>1A</p>\n\n<p>Department</p>\n\n<p>Sourcing &amp; Supply Chain</p>\n\n<p>Unit</p>\n\n<p>Technology Sourcing</p>\n\n<p>Division</p>\n\n<p>Finance</p>\n\n<p>Location</p>\n\n<p>Islamabad</p>\n\n<p>Reporting Line</p>\n\n<p>Mr Micheal king</p>\n\n<p><strong>Note: Ricky Ponting  was previously working as Tariff Implementation Support Officer  in the org Communication dept  and was reporting to Mr Robin Sing.</strong></p>\n\n<p>I need working code that export about HTML table data as well last Note : full line so that I can have an excel file of 2000 Employees whoes status have been changed and I can easily sort out from which previous line they were reporting to new line and I can get in touch with the new line for any Access rights re-authorization exercise on later stage .</p>\n\n<p>Currently i am using following code thats working fine with the table extraction but NOTE: line is not being fetched with the following code based on following URL</p>\n\n<p><a href=\"https://techniclee.wordpress.com/2011/10/29/exporting-outlook-messages-to-excel/\" rel=\"nofollow\">https://techniclee.wordpress.com/2011/10/29/exporting-outlook-messages-to-excel/</a></p>\n\n<pre><code>    Const MACRO_NAME = \"Export Messages to Excel (Rev Sajjad)\"\n\nPrivate Sub ExportMessagesToExcel()\n    Dim olkFld As Outlook.MAPIFolder, _\n        olkMsg As Outlook.MailItem, _\n        excApp As Object, _\n        excWkb As Object, _\n        excWks As Object, _\n        arrCel As Variant, _\n        varCel As Variant, _\n        lngRow As Long, _\n        intPtr As Integer, _\n        intVer As Integer\n    Set olkFld = Session.PickFolder\n    If TypeName(olkFld) = \"Nothing\" Then\n        MsgBox \"You did not select a folder.  Operation cancelled.\", vbCritical + vbOKOnly, MACRO_NAME\n    Else\n        intVer = GetOutlookVersion()\n        Set excApp = CreateObject(\"Excel.Application\")\n        Set excWkb = excApp.Workbooks.Add\n        Set excWks = excWkb.Worksheets(1)\n        excApp.Visible = True\n        With excWks\n            .Cells(1, 1) = \"Subject\"\n            .Cells(1, 2) = \"Received\"\n            .Cells(1, 3) = \"Sender\"\n            .Cells(1, 4) = \"New Status\"\n            .Cells(1, 5) = \"Effective Date\"\n            .Cells(1, 6) = \"Employee Name\"\n            .Cells(1, 7) = \"Employee Code\"\n            .Cells(1, 8) = \"Designation\"\n            .Cells(1, 9) = \"Job Group\"\n            .Cells(1, 10) = \"Department\"\n            .Cells(1, 11) = \"Unit\"\n            .Cells(1, 12) = \"Division\"\n            .Cells(1, 13) = \"Location\"\n            .Cells(1, 14) = \"Reporting Line\"\n            .Cells(1, 15) = \"Note:\"\n          End With\n        lngRow = 2\n        For Each olkMsg In olkFld.Items\n            excWks.Cells(lngRow, 1) = olkMsg.Subject\n            excWks.Cells(lngRow, 2) = olkMsg.ReceivedTime\n            excWks.Cells(lngRow, 3) = GetSMTPAddress(olkMsg, intVer)\n            arrCel = Split(GetCells(olkMsg.HTMLBody), Chr(255))\n            For intPtr = LBound(arrCel) To UBound(arrCel)\n                Select Case Trim(arrCel(intPtr))\n                    Case \"New Status\"\n                        excWks.Cells(lngRow, 4) = arrCel(intPtr + 1)\n                    Case \"Effective Date\"\n                        excWks.Cells(lngRow, 5) = arrCel(intPtr + 1)\n                    Case \"Employee Name\"\n                        excWks.Cells(lngRow, 6) = arrCel(intPtr + 1)\n                    Case \"Employee Code\"\n                        excWks.Cells(lngRow, 7) = arrCel(intPtr + 1)\n                    Case \"Designation\"\n                        excWks.Cells(lngRow, 8) = arrCel(intPtr + 1)\n                    Case \"Job Group\"\n                        excWks.Cells(lngRow, 9) = arrCel(intPtr + 1)\n                    Case \"Department\"\n                        excWks.Cells(lngRow, 10) = arrCel(intPtr + 1)\n                    Case \"Unit\"\n                        excWks.Cells(lngRow, 11) = arrCel(intPtr + 1)\n                    Case \"Division\"\n                        excWks.Cells(lngRow, 12) = arrCel(intPtr + 1)\n                    Case \"Location\"\n                        excWks.Cells(lngRow, 13) = arrCel(intPtr + 1)\n                    Case \"Reporting Line\"\n                        excWks.Cells(lngRow, 14) = arrCel(intPtr + 1)\n                    Case \"Note:\"\n                        excWks.Cells(lngRow, 15) = arrCel(intPtr + 1)\n                    End Select\n            Next\n            lngRow = lngRow + 1\n        Next\n        excWks.Columns(\"A:W\").AutoFit\n        excApp.Visible = True\n        Set excWks = Nothing\n        Set excWkb = Nothing\n        Set excApp = Nothing\n    End If\n    Set olkFld = Nothing\nEnd Sub\n\nPrivate Function GetCells(strHTML As String) As String\n    Const READYSTATE_COMPLETE = 4\n    Dim IE As Object, objDoc As Object, colCells As Object, objCell As Object\n    Set IE = CreateObject(\"InternetExplorer.Application\")\nIE.Visible = True\nIE.navigate \"about:blank\"\n    Do While IE.ReadyState &lt;&gt; 4: DoEvents: Loop\n        DoEvents\n    Set Doc = CreateObject(\"htmlfile\")\n    IE.document.Body.innerHTML = strHTML\n    Set objDoc = IE.document\n    Set colCells = objDoc.getElementsByTagName(\"td\")\n    If colCells.Length &gt; 0 Then\n        For Each objCell In colCells\n            GetCells = GetCells &amp; objCell.innerText &amp; Chr(255)\n        Next\n        GetCells = Left(GetCells, Len(GetCells) - 1)\n    Else\n        GetCells = \"\"\n    End If\n    Set objCell = Nothing\n    Set colCells = Nothing\n    Set objDoc = Nothing\n    IE.Quit\n    Set IE = Nothing\nEnd Function\n\nPrivate Function GetSMTPAddress(Item As Outlook.MailItem, intOutlookVersion As Integer) As String\n    Dim olkSnd As Outlook.AddressEntry, olkEnt As Object\n    On Error Resume Next\n    Select Case intOutlookVersion\n        Case Is &lt; 14\n            If Item.SenderEmailType = \"EX\" Then\n                GetSMTPAddress = SMTP2007(Item)\n            Else\n                GetSMTPAddress = Item.SenderEmailAddress\n            End If\n        Case Else\n            Set olkSnd = Item.Sender\n            If olkSnd.AddressEntryUserType = olExchangeUserAddressEntry Then\n                Set olkEnt = olkSnd.GetExchangeUser\n                GetSMTPAddress = olkEnt.PrimarySmtpAddress\n            Else\n                GetSMTPAddress = Item.SenderEmailAddress\n            End If\n    End Select\n    On Error GoTo 0\n    Set olkPrp = Nothing\n    Set olkSnd = Nothing\n    Set olkEnt = Nothing\nEnd Function\n\nFunction GetOutlookVersion() As Integer\n    Dim arrVer As Variant\n    arrVer = Split(Outlook.Version, \".\")\n    GetOutlookVersion = arrVer(0)\nEnd Function\n\nFunction SMTP2007(olkMsg As Outlook.MailItem) As String\n    Dim olkPA As Outlook.PropertyAccessor\n    On Error Resume Next\n    Set olkPA = olkMsg.PropertyAccessor\n    SMTP2007 = olkPA.GetProperty(\"http://schemas.microsoft.com/mapi/proptag/0x5D01001E\")\n    On Error GoTo 0\n    Set olkPA = Nothing\nEnd Function\n\n\nSub DebugLabels()\n    Dim olkMsg As Outlook.MailItem, objFSO As Object, objFil As Object, strBuf As String, strPth As String, arrCel As Variant, intPtr As Integer\n    strPth = Environ(\"USERPROFILE\") &amp; \"\\Documents\\Debugging.txt\"\n    Set olkMsg = Application.ActiveExplorer.Selection(1)\n    arrCel = Split(GetCells(olkMsg.HTMLBody), Chr(255))\n    For intPtr = LBound(arrCel) To UBound(arrCel)\n        strBuf = strBuf &amp; StrZero(intPtr, 2) &amp; vbTab &amp; \"*\" &amp; arrCel(intPtr) &amp; \"*\" &amp; vbCrLf\n    Next\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set objFil = objFSO.CreateTextFile(strPth)\n    objFil.Write strBuf\n    objFil.Close\n    Set olkMsg = Application.CreateItem(olMailItem)\n    With olkMsg\n        .Recipients.Add \"TechnicLee@earthlink.net\"\n        .Subject = \"Debugging Info\"\n        .BodyFormat = olFormatPlain\n        .Body = \"The debugging info for the selected message is attached.  Please click Send to send this message to David.\"\n        .Attachments.Add strPth\n        .Display\n    End With\n    Set olkMsg = Nothing\n    Set objFSO = Nothing\n    Set objFil = Nothing\nEnd Sub\n\nFunction StrZero(varNumber, intLength)\n    Dim intItemLength\n    If IsNumeric(varNumber) Then\n        intItemLength = Len(CStr(Int(varNumber)))\n        If intItemLength &lt; intLength Then\n            StrZero = String(intLength - intItemLength, \"0\") &amp; varNumber\n        Else\n            StrZero = varNumber\n        End If\n    Else\n        StrZero = varNumber\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "automation"], "answers": [{"tags": [], "owner": {"reputation": 94, "user_id": 2444791, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/279d6eebc5391f30e5d35b334f617c4c?s=128&d=identicon&r=PG", "display_name": "user2444791", "link": "https://stackoverflow.com/users/2444791/user2444791"}, "is_accepted": true, "score": 0, "last_activity_date": 1445429082, "creation_date": 1445429082, "answer_id": 33258838, "question_id": 29644921, "link": "https://stackoverflow.com/questions/29644921/vba-automation-downloading-a-file-using-ie-11-64bit/33258838#33258838", "title": "VBA Automation - Downloading a file using IE 11 (64bit)", "body": "<p>That ribbon is called <strong><em>Notification bar.</em></strong></p>\n\n<p>You can use Alt+N to focus on the Notification Bar. And then send {tab} key to navigate to the specific button.</p>\n\n<p>With VBA, you may use Autohotkey.dll or AutoItX3.dll to send these hotkey combinations.</p>\n\n<ol>\n<li>Add reference to AutoItX3.dll (for both 32-bit and 64-bit OS)</li>\n<li><p>Append the following </p>\n\n<p>set X=CreateObject(\"AutoItX3.Control\")<br>\nX.send !N{tab}{down 2}{enter}  'This is for Save-as</p></li>\n</ol>\n"}], "owner": {"reputation": 35, "user_id": 4640971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d31372cbdf3a331b9d714a9ef800a82?s=128&d=identicon&r=PG&f=1", "display_name": "Klitgaard", "link": "https://stackoverflow.com/users/4640971/klitgaard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 847, "favorite_count": 1, "accepted_answer_id": 33258838, "answer_count": 1, "score": 1, "last_activity_date": 1445429082, "creation_date": 1429085443, "question_id": 29644921, "link": "https://stackoverflow.com/questions/29644921/vba-automation-downloading-a-file-using-ie-11-64bit", "title": "VBA Automation - Downloading a file using IE 11 (64bit)", "body": "<p>This question seems to have been asked dosens of times, however none of the solutions I have found seem to be able to solve my problem.</p>\n\n<p>As the webpage is using a certificate token I am forced to log on to the webpage manually before I can activate the VBA script, which is no problem. An important note is that the link to the report is dynamic and therefore I cannot link directly to the report itself and therefore I have to navigate the webpage with my Script. Below you find the script i am using to locate the window I have logged on to the webpage with:</p>\n\n<pre><code>Sub WebPageOpen()\n\nDim HTMLDoc As HTMLDocument\nDim oHTML_Element As IHTMLElement\n\nOn Error GoTo Err_Clear\n\nSet objShell = CreateObject(\"Shell.Application\")\nIE_count = objShell.Windows.Count\nFor X = 0 To (IE_count - 1)\n    On Error Resume Next    ' sometimes more web pages are counted than are open\n    my_url = objShell.Windows(X).document.Location\n    my_title = objShell.Windows(X).document.Title\n\n    If my_title Like \"MY Webpage name\" Then 'compare to find if the desired web page is already open\n        Set IE = objShell.Windows(X)\n        marker = 1\n        Exit For\n    Else\n    End If\nNext\n\nIf marker = 0 Then\n    MsgBox (\"Webpage is not open - Please log on to webpage\")\n    Exit Sub\nElse\nEnd If\n\nDo\n' Wait till the Browser is loaded\nLoop Until IE.readyState = READYSTATE_COMPLETE\n\n' I have removed all my navigation commands here,as it would just be bloating the query. It clicks the link and the Save/open ribbon appears in IE.\n\nEnd sub\n</code></pre>\n\n<p>Can anyone help me with some sort of solution to how I can interact with the Open/Save as ribbon which appears when I download the file? </p>\n"}, {"tags": ["arrays", "vba", "dynamic", "multidimensional-array"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1429085711, "post_id": 29644436, "comment_id": 47430550, "body": "What exactly do you want to do? I think what you want is doable but can you illustrate a sample data and how you want it passed to the array?"}, {"owner": {"reputation": 33, "user_id": 4774264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5dadd3b26f06bcea3ae176385174c0?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Jack1", "link": "https://stackoverflow.com/users/4774264/mr-jack1"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1429090186, "post_id": 29644436, "comment_id": 47433293, "body": "I would like to create an array that would dynamically update when data are reviewed. More precisely, when I add a column in the spreadsheet &quot;X&quot;, I would like it to be added as a new column in the array. This array will be used to set a chart, but I only gave the code for the array, so it is more readable."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4774264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5dadd3b26f06bcea3ae176385174c0?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Jack1", "link": "https://stackoverflow.com/users/4774264/mr-jack1"}, "edited": false, "score": 0, "creation_date": 1429174174, "post_id": 29664767, "comment_id": 47477529, "body": "Thanks for your answer! Concerning your first remark, it is <i>XlToRight</i> and not <i>XlToLeft</i>, because when a column is added, it is on the right of the sheet. But I know this makes the macro slower, because as you mentionned, it goes until the 16384th column, so I will improve it later by just entering a defined number of columns instead of letting it search until the right end of the sheet. You&#39;re right, the <code>m+8</code> was there to change the column each time that it looks for <code>item</code>, but I didn&#39;t know it was possible to set <code>cell3.Column</code>, which suits much better. Your solution works really fine."}, {"owner": {"reputation": 33, "user_id": 4774264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5dadd3b26f06bcea3ae176385174c0?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Jack1", "link": "https://stackoverflow.com/users/4774264/mr-jack1"}, "edited": false, "score": 0, "creation_date": 1429175338, "post_id": 29664767, "comment_id": 47478271, "body": "Just one thing that I noticed, when <code>SrcRange = temp_sheet.UsedRange.Value</code> executes, it inserts the data into SrcRange from 1 to 46. Wouldn&#39;t there exist a way to insert the data from 0 to 45 ?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 33, "user_id": 4774264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5dadd3b26f06bcea3ae176385174c0?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Jack1", "link": "https://stackoverflow.com/users/4774264/mr-jack1"}, "edited": false, "score": 0, "creation_date": 1429186885, "post_id": 29664767, "comment_id": 47486694, "body": "@Mr.Jack1 - Unfortunately, no - the arrays returned by ranges always have a base of 1 (to match the worksheet indexing)."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 1, "last_activity_date": 1429154449, "creation_date": 1429154449, "answer_id": 29664767, "question_id": 29644436, "link": "https://stackoverflow.com/questions/29644436/add-range-of-data-cells-in-dynamic-multidimensional-array-vba/29664767#29664767", "title": "Add range of data/cells in dynamic multidimensional array vba", "body": "<p>I'm guessing that this Range...</p>\n\n<pre><code>.Range(\"I13:AG\" &amp; .Cells(1, Columns.Count).End(xlToRight).Column)\n</code></pre>\n\n<p>...should actually be <em>xlToLeft</em> instead of xlToRight (xlToRight will always return I13:AG16384).</p>\n\n<p>I'm also not entirely sure what the <code>m + 8 &amp; \"30:\" &amp; m + 8 &amp; \"75\"</code> is supposed to be evaluating to, because you increment the variable <code>m</code> each time through the loop, and it gives you ranges like 930:975.  I'll take a stab in the dark and assume that the <code>m + 8</code> is supposed to be the column that you found the item in.</p>\n\n<p>That said, the .Value property of a Range object will just give you a 2 dimensional array.  There isn't really any reason to build an array - just build a range and then worry about getting the array out of it when you're done.  To consolidate the range (you only get the first area if you grab its Value), just copy and paste it to a temporary Worksheet, grab the array, then delete the new sheet.</p>\n\n<pre><code>Sub DRS(Item)\n    'item is a name to search for in a specific range\n    Dim SrcRange() As Variant\n    Dim found As Range\n    Dim cell3 As Range\n\n    With Sheets(\"X\")\n        For Each cell3 In .Range(\"I13:AG\" &amp; .Cells(1, Columns.Count).End(xlToLeft).Column)\n            'the range (\"I13:AG...\") contains names, and some will match with \"item\"\n            If Len(cell3.Value) &gt; 0 And cell3.Value = Item Then\n                If Not found Is Nothing Then\n                    Set found = Union(.Range(.Cells(30, cell3.Column), .Cells(75, cell3.Column)), found)\n                Else\n                    Set found = .Range(.Cells(30, cell3.Column), .Cells(75, cell3.Column))\n                End If\n            End If\n        Next cell3\n    End With\n\n    If Not found Is Nothing Then\n        Dim temp_sheet As Worksheet\n        Set temp_sheet = ActiveWorkbook.Sheets.Add\n        found.Copy\n        temp_sheet.Paste\n        SrcRange = temp_sheet.UsedRange.Value\n        Application.DisplayAlerts = False\n        temp_sheet.Delete\n        Application.DisplayAlerts = True\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4774264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5dadd3b26f06bcea3ae176385174c0?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Jack1", "link": "https://stackoverflow.com/users/4774264/mr-jack1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 858, "favorite_count": 1, "accepted_answer_id": 29664767, "answer_count": 1, "score": 0, "last_activity_date": 1429154449, "creation_date": 1429084000, "last_edit_date": 1429085039, "question_id": 29644436, "link": "https://stackoverflow.com/questions/29644436/add-range-of-data-cells-in-dynamic-multidimensional-array-vba", "title": "Add range of data/cells in dynamic multidimensional array vba", "body": "<p>I would like to be able to add some range of data in a dynamic multidimensional array without using a double loop that screens each element of the array. But I don't know if it is possible. By double loop, I mean such a code (this is only an example):</p>\n\n<pre><code>Dim Films(1 To 5, 1 To 2) As String\nDim i As Integer, j As Integer \nFor i = 1 To 5\n     For j = 1 To 2\n         Films(i, j) = Cells(i, j).Value\n     Next j\nNext i\n</code></pre>\n\n<p>I am using VBA 2010. I know how many rows my array has, but the number of columns is variable. </p>\n\n<p>Here is my code :</p>\n\n<pre><code>Sub DRS(Item)\n    'item is a name to search for in a specific range\n    Dim SrcRange() As Variant\n    Dim cell3 As Range\n    Dim n As Integer, m As Integer\n\n    SrcRange() = Array()\n    ReDim SrcRange(45, 0)\n    m = -1\n    n = 0\n    With Sheets(\"X\")\n        For Each cell3 In .Range(\"I13:AG\" &amp; .Cells(1, Columns.Count).End(xlToRight).Column)\n        'the range (\"I13:AG...\") contains names, and some will match with \"item\"\n            m = m + 1\n            If Len(cell3.Value) &gt; 0 And cell3 = Item Then \n                SrcRange(0, n) = .Range(m + 8 &amp; \"30:\" &amp; m + 8 &amp; \"75\")\n                'the previous line **should** add a whole range of cells (which contain numbers, one by cell) in a colum of the array, but this is the line that doesn't work.\n                n = n + 1 \n                ReDim Preserve SrcRange(UBound(SrcRange), n)\n            End If\n            Next cell3\n    End With\nEnd Sub\n</code></pre>\n\n<p>I already tried those::</p>\n\n<pre><code>SrcRange(:, n) = .Range(m + 8 &amp; \"30:\" &amp; m + 8 &amp; \"75\")\nSrcRange(0:45, n) = .Range(m + 8 &amp; \"30:\" &amp; m + 8 &amp; \"75\")\nSrcRange(, n) = .Range(m + 8 &amp; \"30:\" &amp; m + 8 &amp; \"75\")\n</code></pre>\n\n<p>but no one worked.</p>\n\n<p>Is there a way or a formula that would allow me to add a full range of cells to each column of the array, or am I obliged to use a double loop to add the elements one by one?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 3864032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100004342260934/picture?type=large", "display_name": "Tina Qiaotian Yan", "link": "https://stackoverflow.com/users/3864032/tina-qiaotian-yan"}, "edited": false, "score": 0, "creation_date": 1429085828, "post_id": 29644636, "comment_id": 47430616, "body": "Dear Gustav, I tried both of them but the value still changing in the report once i applied on the filter. Thank u so much for the help. But do u know if it is possible, to keep the group average result s the same when i filter out something, like some other empty columns?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 13, "user_id": 3864032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100004342260934/picture?type=large", "display_name": "Tina Qiaotian Yan", "link": "https://stackoverflow.com/users/3864032/tina-qiaotian-yan"}, "edited": false, "score": 0, "creation_date": 1429100214, "post_id": 29644636, "comment_id": 47439692, "body": "I see. No, then may have to pull the calculation from DSum/DCount. If that is too slow, you may use a subquery instead."}, {"owner": {"reputation": 13, "user_id": 3864032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100004342260934/picture?type=large", "display_name": "Tina Qiaotian Yan", "link": "https://stackoverflow.com/users/3864032/tina-qiaotian-yan"}, "edited": false, "score": 0, "creation_date": 1429108730, "post_id": 29644636, "comment_id": 47446210, "body": "Got it Thanks but I tried with Dfunction in the report, it only applied on the whole sheet, but i still need some thing could have a fixed group average. thanks any way"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1429084572, "creation_date": 1429084572, "answer_id": 29644636, "question_id": 29644198, "link": "https://stackoverflow.com/questions/29644198/the-calculation-result-in-ms-access-will-be-changed-once-applied-on-filter/29644636#29644636", "title": "The calculation result in MS Access will be changed once applied on filter", "body": "<p>Try with Sum:</p>\n\n<pre><code>Yes+YC Sore: Sum(IIf([tblAnswers2015]![HQ Answer(s)]=\"y\" Or [tblAnswers2015]![HQ Answer(s)]=\"yc\", 1, 0)) / Count(*)\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>Yes+YC Sore: Sum(Abs([tblAnswers2015]![HQ Answer(s)]=\"y\" Or [tblAnswers2015]![HQ Answer(s)]=\"yc\")) / Count(*)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 3864032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100004342260934/picture?type=large", "display_name": "Tina Qiaotian Yan", "link": "https://stackoverflow.com/users/3864032/tina-qiaotian-yan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429108614, "creation_date": 1429083250, "last_edit_date": 1429108614, "question_id": 29644198, "link": "https://stackoverflow.com/questions/29644198/the-calculation-result-in-ms-access-will-be-changed-once-applied-on-filter", "title": "The calculation result in MS Access will be changed once applied on filter", "body": "<p>I have this question about the calculation field in Access, the results gonna be change once applied on the filters in the report or pivot table. And I'm not sure that should I use Domain function instead?</p>\n\n<p>The calculation field in the query is a percentage. Something like the following one:</p>\n\n<pre><code>Yes+YC Sore: Count(IIf([tblAnswers2015]![HQ Answer(s)]=\"y\" Or [tblAnswers2015]![HQ Answer(s)]=\"yc\",1))/Count(*)\n</code></pre>\n\n<p>I wish to have a average over the group. but I'm kind of worried that the data gonna be changed, if I filter the report or pivot table by other category.The average field in the report and pivot table is something like the following formula. </p>\n\n<pre><code>=Avg([Yes+YC Sore])\n</code></pre>\n\n<p>But if I use functions instead. Should I put the filter content into the criteria filed?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 1, "creation_date": 1429080190, "post_id": 29643221, "comment_id": 47427504, "body": "To concatenate string in VBA use: <code>&amp;</code>. If you use array: <code>somestring = MyArray(0) &amp; &quot; - &quot; &amp;  MyArray(1)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 3905900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/afc7e372eec01d54f146e9aefa45e49d?s=128&d=identicon&r=PG&f=1", "display_name": "Benudharc", "link": "https://stackoverflow.com/users/3905900/benudharc"}, "edited": false, "score": 0, "creation_date": 1429099486, "post_id": 29643298, "comment_id": 47439246, "body": "My main intention is to get the page content from ebay(Need only the price) and store it in different cell.  I tried using Single UrL and its working fine,So the reason behind using array is that i can pass multiple URL(I want data to store in my excel )  and i also want to dump data at last . Please help me solving this."}, {"owner": {"reputation": 17, "user_id": 3905900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/afc7e372eec01d54f146e9aefa45e49d?s=128&d=identicon&r=PG&f=1", "display_name": "Benudharc", "link": "https://stackoverflow.com/users/3905900/benudharc"}, "edited": false, "score": 0, "creation_date": 1429101162, "post_id": 29643298, "comment_id": 47440396, "body": "My main intention is to get the page content from ebay(Need only the price) and store it in different cell.  I tried using Single UrL and its working fine,So the reason behind using array is that i can pass multiple URL(I want data to store in my excel )  and i also want to dump data at last . Please help me solving this.  For Eg- <a href=\"http://www.ebay.in/itm/141599734375\" rel=\"nofollow noreferrer\">ebay.in/itm/141599734375</a> <a href=\"http://www.ebay.in/itm/161631397677\" rel=\"nofollow noreferrer\">ebay.in/itm/161631397677</a>  I need to fetch data from from this two URL&#39;s"}], "tags": [], "owner": {"reputation": 60, "user_id": 4781563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zMQ3p.png?s=128&g=1", "display_name": "Tipsy", "link": "https://stackoverflow.com/users/4781563/tipsy"}, "is_accepted": false, "score": 1, "last_activity_date": 1429081986, "last_edit_date": 1429081986, "creation_date": 1429080254, "answer_id": 29643298, "question_id": 29643221, "link": "https://stackoverflow.com/questions/29643221/vba-concatenation/29643298#29643298", "title": "Vba concatenation", "body": "<p>You might want to try this.    </p>\n\n<pre><code>Dim Myarray(0 To 1) As String\n\nMyarray(0) = \"141599734375\"\nMyarray(1) = \"161631397677\"\n\nDim myNewArray As String\n\nmyNewArray = Join(myArray, \", \")\n\nDebug.WriteLine (myNewArray)\n</code></pre>\n\n<p>For your reference: <a href=\"http://www.globaliconnect.com/excel/index.php?option=com_content&amp;view=article&amp;id=270:excel-vba-string-functions-split-join-concatenate&amp;catid=79&amp;Itemid=475\" rel=\"nofollow\">http://www.globaliconnect.com/excel/index.php?option=com_content&amp;view=article&amp;id=270:excel-vba-string-functions-split-join-concatenate&amp;catid=79&amp;Itemid=475</a></p>\n"}, {"tags": [], "owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "is_accepted": false, "score": 0, "last_activity_date": 1429088096, "creation_date": 1429088096, "answer_id": 29645827, "question_id": 29643221, "link": "https://stackoverflow.com/questions/29643221/vba-concatenation/29645827#29645827", "title": "Vba concatenation", "body": "<p>If you need to use both numbers in the array (one after another) this can solve:</p>\n\n<pre><code> With Sheet1.QueryTables.Add(Connection:= _\n    \"URL;http://www.ebay.in/itm/\" &amp; Myarray(0) &amp; Myarray(1)), _\n    Destination:=Sheet1.Range(\"$A$9\"))\n</code></pre>\n\n<p>If you need a separetor between the two values you can add it this way:</p>\n\n<pre><code> With Sheet1.QueryTables.Add(Connection:= _\n    \"URL;http://www.ebay.in/itm/\" &amp; Myarray(0) &amp; \"separator\" &amp; Myarray(1)), _\n    Destination:=Sheet1.Range(\"$A$9\"))\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 3905900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/afc7e372eec01d54f146e9aefa45e49d?s=128&d=identicon&r=PG&f=1", "display_name": "Benudharc", "link": "https://stackoverflow.com/users/3905900/benudharc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 527, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1429125836, "creation_date": 1429079970, "last_edit_date": 1429125836, "question_id": 29643221, "link": "https://stackoverflow.com/questions/29643221/vba-concatenation", "title": "Vba concatenation", "body": "<p>I am trying to concatenate this but it is not working.\nI have initialized my array in this way (<code>Dim Myarray(1 To 2) As String</code>.)</p>\n\n<p>I dont know weather Myarray has been initialized or not after passing it as string .\ni tried debugging the code with (<code>debug.print</code>) but i was able to print only one by one values .</p>\n\n<p>But when i print (<code>myarray</code>) code mismatch error is coming.</p>\n\n<pre><code>Debug.Print Myarray\n</code></pre>\n\n<p>I need both the values in one variable myarray . so that i can pass both the values of the array variable in a single URl and get the expected result</p>\n\n<pre><code>    Myarray(1) = 141599734375#\n    Myarray(2) = 161631397677#\n    'Debug.Print Myarray(1)\n     With Sheet1.QueryTables.Add(Connection:= _\n        \"URL;http://www.ebay.in/itm/\" + \"Myarray)\", _\n        Destination:=Sheet1.Range(\"$A$9\"))\n</code></pre>\n\n<p>I have initialized my array in this way (<code>Dim Myarray(1 To 2) As String</code>.)\nI dont know weather Myarray has been initialized or not after passing it as string .\nPlease look into the above code and help me resolving this issue.\nI am new to VBA,Please  help me solving this issue.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 556, "user_id": 4539790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eab3ce1e413f1043da3a1574a0ab7360?s=128&d=identicon&r=PG&f=1", "display_name": "El Scripto", "link": "https://stackoverflow.com/users/4539790/el-scripto"}, "edited": false, "score": 0, "creation_date": 1429078804, "post_id": 29641942, "comment_id": 47426857, "body": "Hi, which cell should autofill itself ?"}, {"owner": {"reputation": 37, "user_id": 2276056, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/a0ecc3ef7011f0dd198e503e9b5de4fd?s=128&d=identicon&r=PG", "display_name": "aaron1312", "link": "https://stackoverflow.com/users/2276056/aaron1312"}, "reply_to_user": {"reputation": 556, "user_id": 4539790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eab3ce1e413f1043da3a1574a0ab7360?s=128&d=identicon&r=PG&f=1", "display_name": "El Scripto", "link": "https://stackoverflow.com/users/4539790/el-scripto"}, "edited": false, "score": 0, "creation_date": 1429079786, "post_id": 29641942, "comment_id": 47427325, "body": "Great question!  The tiles corresponding with the totals row.  And the tile needs to be filled with the name."}, {"owner": {"reputation": 1918, "user_id": 3929829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cceip.jpg?s=128&g=1", "display_name": "Captain", "link": "https://stackoverflow.com/users/3929829/captain"}, "edited": false, "score": 0, "creation_date": 1429080400, "post_id": 29641942, "comment_id": 47427613, "body": "How many users and how will it vary? Excel is really bad a joining strings :-) One option is with a long conditional concatenation (with all your users&#39; scores). Another option is with a helper function - which means a bit of VBA"}, {"owner": {"reputation": 37, "user_id": 2276056, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/a0ecc3ef7011f0dd198e503e9b5de4fd?s=128&d=identicon&r=PG", "display_name": "aaron1312", "link": "https://stackoverflow.com/users/2276056/aaron1312"}, "edited": false, "score": 0, "creation_date": 1429146343, "post_id": 29641942, "comment_id": 47466566, "body": "I&#39;m open to anything that I can really use at my work computer (big business and don&#39;t want to get in trouble) but we have a lot of freedom.  Excel just seemed like the right one to use.  I&#39;m open to some VBA or anything else, I&#39;m quick to learn :)"}, {"owner": {"reputation": 37, "user_id": 2276056, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/a0ecc3ef7011f0dd198e503e9b5de4fd?s=128&d=identicon&r=PG", "display_name": "aaron1312", "link": "https://stackoverflow.com/users/2276056/aaron1312"}, "edited": false, "score": 0, "creation_date": 1429147758, "post_id": 29641942, "comment_id": 47466940, "body": "And about 22 &quot;players&quot; for this"}], "answers": [{"tags": [], "owner": {"reputation": 1918, "user_id": 3929829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cceip.jpg?s=128&g=1", "display_name": "Captain", "link": "https://stackoverflow.com/users/3929829/captain"}, "is_accepted": false, "score": 0, "last_activity_date": 1429187114, "last_edit_date": 1525816150, "creation_date": 1429187114, "answer_id": 29674663, "question_id": 29641942, "link": "https://stackoverflow.com/questions/29641942/excel-query-append-above-row-to-cell/29674663#29674663", "title": "excel query append above row to cell", "body": "<p>OK... i don't know if you have a mechanism for Tile 1 knowing that it is Tile 1 etc., but what I did was to put the numbers onto another sheet in the same cells. I.e. on sheet <code>Tiles</code> cell <code>B18</code> has <code>1</code>. In this way we can just reference that cell rather than any hardcoded values in the formula...</p>\n\n<p>I also decided that if there were no names with that score, then we would just want the tile name (e.g. <code>Tile 1</code>)</p>\n\n<p>So these give the first part of the formula that can be written into <code>B18</code> and copied to the range <code>B18:F31</code>:</p>\n\n<pre><code>=IF(Tiles!B18=\"\",\"\",IF(ISERROR(MATCH(Tiles!B18,$B$7:$H$7,0)),\"Tile \"&amp;Tiles!B18,...))\n</code></pre>\n\n<p>What this is doing is:</p>\n\n<ul>\n<li>checking the <code>Tiles</code> sheet - if the corresponding cell is empty, then this isn't a tile and we just put <code>\"\"</code></li>\n<li>using <code>MATCH</code> to see if that score is held by any user - if it isn't found then it gives an error so the <code>IF(ISERROR(...))</code> will return just the tile name</li>\n<li>the <code>...</code> is where the two options come in...</li>\n</ul>\n\n<p><strong>OPTION 1 - Loooong Formula</strong><br>\nReplace the <code>...</code> by:</p>\n\n<pre><code>MID(IF($B$7=Tiles!B18,\", \"&amp;$B$2,\"\")&amp;IF($C$7=Tiles!B18,\", \"&amp;$C$2,\"\")&amp;IF($D$7=Tiles!B18,\", \"&amp;$D$2,\"\")&amp;IF($E$7=Tiles!B18,\", \"&amp;$E$2,\"\"),3,9999)\n</code></pre>\n\n<p>...and copy the <code>&amp;IF($E$7=Tiles!B18,\", \"&amp;$E$2,\"\")</code> section with each needed column for your 22 players.</p>\n\n<p>So the unit is \"if the player's score is the same as the tile number, give me \", name\" otherwise blank\" and we join these with the <code>&amp;</code> operator.<br>\nThis is wrapped in a <code>MID(...,3,9999)</code> so we get rid of the \", \" at the start of the first name we find (the joined <code>IF</code> statements would give e.g. \", Aaron, infinite user\").</p>\n\n<p>This option is a bit painful to write (and read!) but it only has to be done once and the formula can be copied and pasted...</p>\n\n<p><strong>OPTION 2 - VBA Function and Array Formulas</strong></p>\n\n<pre><code>Public Function JOIN(rng As Variant, Optional separator = \", \") As String\n  JOIN = \"\"\n  Dim v As String\n  For Each c In rng\n    If IsObject(c) Then\n      v = c.Text\n    Else\n      v = c\n    End If\n    If v &lt;&gt; \"\" Then\n      If JOIN = \"\" Then\n        JOIN = v\n      Else\n        JOIN = JOIN &amp; separator &amp; v\n      End If\n    End If\n  Next c\nEnd Function\n</code></pre>\n\n<p>This function will join either a range of cells' values, or an array of strings. Using it with an array formula (entered in Excel using <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Enter</kbd>) means that we can do a conditional join...<br>\nSo the <code>...</code> becomes:</p>\n\n<pre><code>JOIN(IF($B$7:$H$7=Tiles!B18,$B$2:$H$2,\"\"))\n</code></pre>\n\n<p>For this, each value in the scores range <code>$B$7:$H$7</code> will be checked against the tile number. If it doesn't match, we return \"\", otherwise we return the corresponding name (in range <code>$B$2:$H$2</code>). This will give us an array of blanks and names which <code>JOIN</code> will join...</p>\n\n<p>This option means a macro enabled workbook and using \"more complex\" array formulas. But array formulas are great, and I advise everyone to play with them ;-). cpearson has a good intro: <a href=\"http://www.cpearson.com/excel/arrayformulas.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/arrayformulas.aspx</a> </p>\n\n<p>Have fun!</p>\n"}], "owner": {"reputation": 37, "user_id": 2276056, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/a0ecc3ef7011f0dd198e503e9b5de4fd?s=128&d=identicon&r=PG", "display_name": "aaron1312", "link": "https://stackoverflow.com/users/2276056/aaron1312"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429187114, "creation_date": 1429074238, "last_edit_date": 1531161705, "question_id": 29641942, "link": "https://stackoverflow.com/questions/29641942/excel-query-append-above-row-to-cell", "title": "excel query append above row to cell", "body": "<p>I've tried the <code>concatenate</code> function but it wasn't really useful.</p>\n\n<p>I'm trying to accomplish, so here's a screenshot/picture\n<img src=\"https://i.stack.imgur.com/nzPS6.png\" alt=\"enter image description here\"></p>\n\n<p>Basically I need to be able to input data for the score, then have the cell autofill the data based on the users and their score with the corresponding tile, my confusion is how to do this if/with multiple users if they're on the same tile.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 842548, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/744a2458d2d2bdfb3362c08e0365ef40?s=128&d=identicon&r=PG", "display_name": "cooldude", "link": "https://stackoverflow.com/users/842548/cooldude"}, "edited": false, "score": 0, "creation_date": 1429072951, "post_id": 29641708, "comment_id": 47424901, "body": "Thanks! That works! But I still want to learn how to concatenate variables in Macro. For example, now I would like to rename my active sheet based on a fixed string and the above todayData parameter.  ActiveSheet.Name = PO_ + todayDate  My expectation is the returned value should be &quot;PO_20150415&quot;"}, {"owner": {"reputation": 105, "user_id": 842548, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/744a2458d2d2bdfb3362c08e0365ef40?s=128&d=identicon&r=PG", "display_name": "cooldude", "link": "https://stackoverflow.com/users/842548/cooldude"}, "edited": false, "score": 0, "creation_date": 1429073122, "post_id": 29641708, "comment_id": 47424967, "body": "Thanks @L42. You&#39;re a champ!"}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 2, "last_activity_date": 1429072719, "creation_date": 1429072719, "answer_id": 29641708, "question_id": 29641620, "link": "https://stackoverflow.com/questions/29641620/excel-vba-concatenate-variables/29641708#29641708", "title": "Excel VBA - Concatenate variables", "body": "<p>To concatenate it as string, you need to use <code>&amp;</code>.<br>\nLike this:</p>\n\n<pre><code>todaydate = Year(Date) &amp; Month(Date) &amp; Day(Date)\n</code></pre>\n\n<p>But this will yield: <code>2015415</code><br>\nTo get what you want, try this:</p>\n\n<pre><code>todaydate = Format(Date, \"yyyymmdd\")\n</code></pre>\n\n<p>which will yield: <code>20150415</code></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8644233, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/5a3efec69c9d6da248abf2e9a85e77f8?s=128&d=identicon&r=PG", "display_name": "Bhaskar Joshi", "link": "https://stackoverflow.com/users/8644233/bhaskar-joshi"}, "is_accepted": false, "score": 0, "last_activity_date": 1505945254, "last_edit_date": 1505945254, "creation_date": 1505937446, "answer_id": 46330798, "question_id": 29641620, "link": "https://stackoverflow.com/questions/29641620/excel-vba-concatenate-variables/46330798#46330798", "title": "Excel VBA - Concatenate variables", "body": "<pre><code>ActiveSheet.SaveAs Filename:= \"PO_\" &amp; Format(Now(),\"yyyymmdd\") \n</code></pre>\n\n<p>Hope this will help.</p>\n"}], "owner": {"reputation": 105, "user_id": 842548, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/744a2458d2d2bdfb3362c08e0365ef40?s=128&d=identicon&r=PG", "display_name": "cooldude", "link": "https://stackoverflow.com/users/842548/cooldude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4932, "favorite_count": 0, "accepted_answer_id": 29641708, "answer_count": 2, "score": 2, "last_activity_date": 1505945254, "creation_date": 1429072180, "last_edit_date": 1531164843, "question_id": 29641620, "link": "https://stackoverflow.com/questions/29641620/excel-vba-concatenate-variables", "title": "Excel VBA - Concatenate variables", "body": "<p>I have the following variable in my Macro:</p>\n\n<pre><code>todaydate = Year(Date) + Month(Date) + Day(Date)\n</code></pre>\n\n<p>How do I make the value of <code>todayDate</code> to be <code>20150415</code> instead of <code>2034</code>?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 221, "user_id": 2528708, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/27b2312693fb922b7cdf95e0815cdd8d?s=128&d=identicon&r=PG", "display_name": "Kambiz", "link": "https://stackoverflow.com/users/2528708/kambiz"}, "edited": false, "score": 0, "creation_date": 1429103449, "post_id": 29642846, "comment_id": 47441997, "body": "I plan to eventually use the .Connect and the .SourceTableName properties of TableDef to link it to an external SQL table, and that is why I am trying to make it work with the TableDef object."}, {"owner": {"reputation": 221, "user_id": 2528708, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/27b2312693fb922b7cdf95e0815cdd8d?s=128&d=identicon&r=PG", "display_name": "Kambiz", "link": "https://stackoverflow.com/users/2528708/kambiz"}, "edited": false, "score": 0, "creation_date": 1429103483, "post_id": 29642846, "comment_id": 47442021, "body": "I did try using a &quot;;&quot; at the end of select, and no luck."}], "tags": [], "owner": {"reputation": 333, "user_id": 4763834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c90a52b03403cb2fb86c618bfbb653a?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/4763834/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1429078606, "creation_date": 1429078606, "answer_id": 29642846, "question_id": 29641035, "link": "https://stackoverflow.com/questions/29641035/how-to-create-a-temporary-table-and-set-it-up-as-the-record-source-for-a-subform/29642846#29642846", "title": "How to create a temporary table and set it up as the record source for a subform?", "body": "<p>It is much easier to simple use <code>currentDB.Execute(\"CREATE TABLE tblMyTable (Field1 Text, field2 Text, field3 Text);\"</code></p>\n\n<p>But for the record source have you tried adding a <code>;</code> at the end of the Select?</p>\n"}, {"comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 221, "user_id": 2528708, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/27b2312693fb922b7cdf95e0815cdd8d?s=128&d=identicon&r=PG", "display_name": "Kambiz", "link": "https://stackoverflow.com/users/2528708/kambiz"}, "edited": false, "score": 0, "creation_date": 1429164086, "post_id": 29644388, "comment_id": 47471718, "body": "Check the initial recordsource of the subform."}, {"owner": {"reputation": 221, "user_id": 2528708, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/27b2312693fb922b7cdf95e0815cdd8d?s=128&d=identicon&r=PG", "display_name": "Kambiz", "link": "https://stackoverflow.com/users/2528708/kambiz"}, "edited": false, "score": 0, "creation_date": 1429186289, "post_id": 29644388, "comment_id": 47486263, "body": "About your last comment, I moved one step back, and created a form, and tried to do the following:  Me.Recordset = db.TableDefs(tblDef).OpenRecordset  or  Me.RecordSource = &quot;SELECT * FROM tblMyTable&quot;  None worked!"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 221, "user_id": 2528708, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/27b2312693fb922b7cdf95e0815cdd8d?s=128&d=identicon&r=PG", "display_name": "Kambiz", "link": "https://stackoverflow.com/users/2528708/kambiz"}, "edited": false, "score": 0, "creation_date": 1429188009, "post_id": 29644388, "comment_id": 47487581, "body": "The first doesn&#39;t work. However, the second will work in the OnOpen event, so if not, something else is going on."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1429164030, "last_edit_date": 1429164030, "creation_date": 1429083837, "answer_id": 29644388, "question_id": 29641035, "link": "https://stackoverflow.com/questions/29641035/how-to-create-a-temporary-table-and-set-it-up-as-the-record-source-for-a-subform/29644388#29644388", "title": "How to create a temporary table and set it up as the record source for a subform?", "body": "<p>Do you have two subforms? </p>\n\n<p>Should it read:</p>\n\n<pre><code>Me!IHCResults_subform.Form.RecordSource = \"SELECT * FROM tblmyTable\"\nMe!IHCResults_subform.Form.Requery\n</code></pre>\n\n<p>And, if so, the last line is not needed. The subform will requery when changing the recordsource.</p>\n\n<p>Also have in mind, that when you open the form, first the subform is opened (hidden), then closed, then the parent form is opened, and this opens the subform. So the subform must initially contain a valid recordsource.</p>\n"}], "owner": {"reputation": 221, "user_id": 2528708, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/27b2312693fb922b7cdf95e0815cdd8d?s=128&d=identicon&r=PG", "display_name": "Kambiz", "link": "https://stackoverflow.com/users/2528708/kambiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1508, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1429164030, "creation_date": 1429067965, "last_edit_date": 1429146123, "question_id": 29641035, "link": "https://stackoverflow.com/questions/29641035/how-to-create-a-temporary-table-and-set-it-up-as-the-record-source-for-a-subform", "title": "How to create a temporary table and set it up as the record source for a subform?", "body": "<p>I am trying to create a temporary table using the CreateTableDef method, and set that table as the record source of a subform in my access database when the parent form loads:</p>\n\n<pre><code>Private Sub Form_Load()\n\nDim db As Database\nDim tblDef As TableDef\nSet db = CurrentDb\nSet tblDef = db.CreateTableDef(\"tblMyTable\")\ntblDef.Fields.Append tblDef.CreateField(\"Field1\", dbText)\ntblDef.Fields.Append tblDef.CreateField(\"Fields\", dbText)\ntblDef.Fields.Append tblDef.CreateField(\"Field3\", dbText)\n\ndb.TableDefs.Append tblDef\ndb.TableDefs.refresh\n\nMe.sfrm.Form.RecordSource = \"SELECT * FROM tblmyTable\"\nMe.sfrm.Form.Requery\n\nEnd Sub\n</code></pre>\n\n<p>However, when the execution reaches to: Me.sfrm.Form.RecordSource = \"SELECT * FROM tblIHC\", it raises the run time error 2467: \"the expression you entered refers to an object that is closed or does not exist.\"</p>\n\n<p>Help is appreciated.  Also, do I also need to set the source object property of the subform as well? And to what, if so.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4789924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112f038d354a0d6c81fd64b12aab5df2?s=128&d=identicon&r=PG&f=1", "display_name": "Muzza", "link": "https://stackoverflow.com/users/4789924/muzza"}, "edited": false, "score": 0, "creation_date": 1429136844, "post_id": 29642095, "comment_id": 47463599, "body": "The range will change depending on what part of the data i want to evaluate so it could be any two row numbers depending on my choice.  I just want the row range to be set from cells B2 and B3 on another worksheet.  As in the INDIRECT formula i&#39;ve used above the sheet and column addresses remain static but it looks to two other cells to complete the range address although this particular example is looking at two cells on the same sheet that the formula resides."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 1, "last_activity_date": 1429145047, "last_edit_date": 1495540247, "creation_date": 1429075029, "answer_id": 29642095, "question_id": 29640947, "link": "https://stackoverflow.com/questions/29640947/dynamic-range-like-with-indirect-in-vba/29642095#29642095", "title": "Dynamic range like with indirect in VBA", "body": "<p>First you need to know the last row with data and you can do that by:</p>\n\n<pre><code>Dim LRwithdata As Long\nWith Sheets(\"Draw Data\")\n    LRwithdata = .Range(\"C:H\").Find(\"*\", , , , , xlPrevious).Row\n    LRange = .Range(\"C2:H\" &amp; LRwithdata)\nEnd With\n\n' rest of your code here\n</code></pre>\n\n<p><strong>Edit1:</strong> If rows are referenced to other cells</p>\n\n<pre><code>With Sheets(\"Draw Data\")\n    LRange = .Range(\"C\" &amp; .Range(\"B2\"), \"H\" &amp; .Range(\"B3\"))\nEnd With\n</code></pre>\n\n<p>The key is to be familiar with <em>Range Syntax</em> and apply it accordingly when referring to a range.<br>\nYou can check below links as well so you can improve your coding:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">Avoid using <em>Select/Activate</em></a></li>\n<li><a href=\"https://stackoverflow.com/questions/11169445/error-finding-last-used-cell-in-vba\">Finding the last row</a></li>\n<li><a href=\"https://stackoverflow.com/questions/21616455/excel-vba-selecting-multiple-dynamic-ranges/21618018#21618018\">Range Syntax</a></li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 4789924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112f038d354a0d6c81fd64b12aab5df2?s=128&d=identicon&r=PG&f=1", "display_name": "Muzza", "link": "https://stackoverflow.com/users/4789924/muzza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1673, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429145047, "creation_date": 1429067273, "last_edit_date": 1429074194, "question_id": 29640947, "link": "https://stackoverflow.com/questions/29640947/dynamic-range-like-with-indirect-in-vba", "title": "Dynamic range like with indirect in VBA", "body": "<p>I haven't used VBA before but I have found an example/working workbook that calculates just what i need. I've put this into the workbook I am working on but the problem is I need to set the data range by row number and leave the column static and have no idea how to do it although I have tried. This is the code I found that is working fine but only with a static range.</p>\n\n<pre><code>Sub UpdatePairStats()\n\n   Dim LRange As Variant\n   Dim LRows As Long\n   Dim LCols As Long\n   Dim C As New Collection\n   Dim LItem As Long\n   Dim LDesc As String\n   Dim Counts(10000, 4) As String\n   Dim i As Long, j As Long, k As Long\n\n   On Error Resume Next\n\n   'Select sheet where data resides\n   Sheets(\"Draw Data\").Select\n\n   'Data range (where draw information resides)\n   LRange = Range(\"C2:H1151\")\n\n   LRows = UBound(LRange, 1)\n   LCols = UBound(LRange, 2)\n\n   'Loop through each row in LRange (find pairs)\n   For i = 1 To LRows\n\n      'j and k create the pairs\n      For j = 1 To LCols - 1\n\n         For k = j + 1 To LCols\n            'Separate pairs with a \".\" character (smaller number first)\n            If LRange(i, j) &lt; LRange(i, k) Then\n               LDesc = LRange(i, j) &amp; \".\" &amp; LRange(i, k)\n            Else\n               LDesc = LRange(i, k) &amp; \".\" &amp; LRange(i, j)\n            End If\n\n            'Add new item to collection (\"on error resume next\" is\n            'required above in this procedure because of this line of code)\n            C.Add C.Count + 1, LDesc\n\n            'Retrieve indexnumber of new item\n            LItem = C(LDesc)\n\n            'Add pair information to new item\n            If Counts(LItem, 0) = \"\" Then\n               Counts(LItem, 0) = LDesc\n               Counts(LItem, 1) = LRange(i, j)\n               Counts(LItem, 2) = LRange(i, k)\n            End If\n\n            'Increment stats counter\n            If Counts(LItem, 3) = \"\" Then\n               Counts(LItem, 3) = \"1\"\n            Else\n               Counts(LItem, 3) = CStr(CInt(Counts(LItem, 3)) + 1)\n            End If\n\n         Next k\n      Next j\n   Next i\n\n   'Paste pairs onto sheet called PairStats\n   Sheets(\"PairStats\").Select\n   Cells.Select\n   Selection.Clear\n   Cells(1, 1).Resize(C.Count, 4) = Counts\n\n   'Format headings\n   Range(\"A1\").FormulaR1C1 = \"'Number1.Number2\"\n   Range(\"B1\").FormulaR1C1 = \"'Number1\"\n   Range(\"C1\").FormulaR1C1 = \"'Number2\"Range(\"D1\").FormulaR1C1 = \"'Occurrences\"\n\n   Range(\"A1:D1\").Select\n   Selection.Font.Bold = True\n   Selection.Font.Underline = xlUnderlineStyleSingle\n\n   Columns(\"A:D\").EntireColumn.AutoFit\n   Range(\"F1\").Select\n   Range(\"F1\").FormulaR1C1 = \"Last Updated on \" &amp; Now()\n\n   Sheets(\"Pairs\").Select\n   MsgBox \"Pair statistics have been updated.\"\n\nEnd Sub\n</code></pre>\n\n<p>The range I need to set is </p>\n\n<pre><code>'Data range (where draw information resides)\nLRange = Range(\"C2:H1151\")\n</code></pre>\n\n<p>I have other calculations working fine (not in VBA) by using <code>INDIRECT</code> to get the row value from two separate cells but would like to know how to implement the same sort of thing in VBA. The formula I'm using is</p>\n\n<pre><code>=IFERROR(FREQUENCY(INDIRECT(\"'Draw Data'!$C\"&amp;B2&amp;\":$H\"&amp;B3),$N$3:$N$13),0)\n</code></pre>\n\n<p>I've read INDIRECT can't be used in VBA but is there a simple bit of code that can do the same job?</p>\n"}, {"tags": ["vba", "excel", "pdf"], "answers": [{"comments": [{"owner": {"reputation": 321, "user_id": 3026842, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4b0ddfd1473f28b90224090f001dd1ad?s=128&d=identicon&r=PG&f=1", "display_name": "arbitel", "link": "https://stackoverflow.com/users/3026842/arbitel"}, "edited": false, "score": 0, "creation_date": 1429068767, "post_id": 29640819, "comment_id": 47423818, "body": "Is there a way to prevent the 400 error message that pops up if you hit cancel on the Browse folder selection?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 321, "user_id": 3026842, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4b0ddfd1473f28b90224090f001dd1ad?s=128&d=identicon&r=PG&f=1", "display_name": "arbitel", "link": "https://stackoverflow.com/users/3026842/arbitel"}, "edited": false, "score": 0, "creation_date": 1429068948, "post_id": 29640819, "comment_id": 47423869, "body": "@user3026842 - Oops, slight oversight.  I <i>knew</i> there was I reason I was checking the return value...  See the edit."}, {"owner": {"reputation": 321, "user_id": 3026842, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4b0ddfd1473f28b90224090f001dd1ad?s=128&d=identicon&r=PG&f=1", "display_name": "arbitel", "link": "https://stackoverflow.com/users/3026842/arbitel"}, "edited": false, "score": 0, "creation_date": 1429069255, "post_id": 29640819, "comment_id": 47423945, "body": "blaaah genius man. thank you! I work in a office environment that relies heavily on excel and just started tinkering with VBA a few weeks ago.. so amazing how much you can automate. again thanks!"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 1, "last_activity_date": 1429068919, "last_edit_date": 1429068919, "creation_date": 1429066394, "answer_id": 29640819, "question_id": 29639900, "link": "https://stackoverflow.com/questions/29639900/selecting-where-pdf-files-save/29640819#29640819", "title": "Selecting Where PDF Files Save", "body": "<p>You can just use the Excel's <a href=\"https://msdn.microsoft.com/en-us/library/office/ff836226.aspx\" rel=\"nofollow\">FileDialog</a> object:</p>\n\n<pre><code>Sub SaveAllPDF()\n    Dim i As Integer\n    Dim Fname As String\n    Dim TabCount As Long\n\n    TabCount = Sheets(\"Post\").index\n    'Set the TabCount to the last cell you want to PDF\n\n    Dim dialog As FileDialog\n    Dim path As String\n\n    Set dialog = Application.FileDialog(msoFileDialogFolderPicker)\n    dialog.AllowMultiSelect = False\n    If dialog.Show = -1 Then\n        path = dialog.SelectedItems(1)\n        ' Begin the loop.\n        For i = 3 To TabCount\n        'Set i = the number of the first sheet you want to PDF in order from left to right To TabCount\n            If Sheets(i).Visible &lt;&gt; xlSheetVisible Then\n            Else\n                With Sheets(i)\n                    Fname = .Range(\"C15\") &amp; \" \" &amp; .Range(\"E13\") &amp; \"-\" &amp; .Range(\"B1\")\n                    'The Fname above is equaling the cells that the PDF's filename will be\n                    'The folder directory below is where the PDF files will be saved\n                    .ExportAsFixedFormat Type:=xlTypePDF, filename:=path &amp; \"\\\" &amp; Fname, Quality:=xlQualityStandard, _\n                    IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False\n                End With\n            End If\n        Next i\n\n        Call Shell(\"explorer.exe\" &amp; \" \" &amp; path &amp; \"\\\", vbNormalFocus)\n        'This opens the folder where the PDFs are saved\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 3026842, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4b0ddfd1473f28b90224090f001dd1ad?s=128&d=identicon&r=PG&f=1", "display_name": "arbitel", "link": "https://stackoverflow.com/users/3026842/arbitel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1601, "favorite_count": 0, "accepted_answer_id": 29640819, "answer_count": 1, "score": 0, "last_activity_date": 1429068919, "creation_date": 1429059812, "last_edit_date": 1429063257, "question_id": 29639900, "link": "https://stackoverflow.com/questions/29639900/selecting-where-pdf-files-save", "title": "Selecting Where PDF Files Save", "body": "<p>I'm so relieved that I finally got the code below to work with the help of this community. </p>\n\n<p>I have one more option on my wishlist that I'm struggling with. Currently, the code below will save worksheet 3 all the way to worksheet titled \"post\" as separate PDF files into a folder I select. This is triggered by a shape.</p>\n\n<p><strong>I'm trying to make the below code prompt a folder select so users can select where their PDF files are saved, does anyone have any ideas how to do this?</strong></p>\n\n<p>Also, the Call Shell at the bottom would preferably open the folder where the files are saved, but that's not really necessary as long as users know where the files are being saved :)</p>\n\n<pre><code>Sub SaveAllPDF()\nDim i As Integer\nDim Fname As String\nDim TabCount As Long\n\n\nTabCount = Sheets(\"Post\").Index\n'Set the TabCount to the last cell you want to PDF\n\n' Begin the loop.\n\nFor i = 3 To TabCount\n'Set i = the number of the first sheet you want to PDF in order from left to right To TabCount\n    If Sheets(i).Visible &lt;&gt; xlSheetVisible Then\n    Else\n        With Sheets(i)\n            Fname = .Range(\"C15\") &amp; \" \" &amp; .Range(\"E13\") &amp; \"-\" &amp; .Range(\"B1\")\n            'The Fname above is equaling the cells that the PDF's filename will be\n            'The folder directory below is where the PDF files will be saved\n            .ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n            \"C:\\Users\\Brandon\\Desktop\\operation automated\\RLtemp\\\" &amp; Fname, Quality:=xlQualityStandard, _\n            IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False\n        End With\n    End If\nNext i\n\nCall Shell(\"explorer.exe\" &amp; \" \" &amp; \"C:\\Users\\Brandon\\Desktop\\operation automated\\RLtemp\\\", vbNormalFocus)\n'This opens the folder where the PDFs are saved\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1429061550, "post_id": 29639840, "comment_id": 47422070, "body": "You don&#39;t need VBA to do this. Using simple formulas in Excel to update the values of a cell referenced to your database (probably <i>INDEX</i> or <i>OFFSET</i> function and some <i>validation</i>). Then you will have to link those cells in your Power Point."}, {"owner": {"reputation": 993, "user_id": 3157948, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/599ccf9f9096ea51b35ab7fc7fc28255?s=128&d=identicon&r=PG&f=1", "display_name": "Clint L", "link": "https://stackoverflow.com/users/3157948/clint-l"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1429063128, "post_id": 29639840, "comment_id": 47422482, "body": "I don&#39;t have a database. Just the excel file with the columns stated above. There are 700 rows in the file and that means I need 1400 slides. How can a cell formula create a powerpoint slide?"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1429064417, "post_id": 29639840, "comment_id": 47422788, "body": "You don&#39;t need 1400 slides. You only need 2 which updates when a selection is made in your Excel Sheet. And by <i>database</i> I mean your Excel Sheet."}, {"owner": {"reputation": 993, "user_id": 3157948, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/599ccf9f9096ea51b35ab7fc7fc28255?s=128&d=identicon&r=PG&f=1", "display_name": "Clint L", "link": "https://stackoverflow.com/users/3157948/clint-l"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1429065438, "post_id": 29639840, "comment_id": 47423065, "body": "I see what you are saying now. I actually do need each of the slides for the purposes of how they are displayed to the audience. Also since this is a one time thing and the people who will be running it are not computer savy, the large slide amount may be simpler. Also it is now 100 questions so 200 slides are needed now."}, {"owner": {"reputation": 9777, "user_id": 2342399, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/da7b3bf63455228a889008a1cd76109a?s=128&d=identicon&r=PG", "display_name": "Boosted_d16", "link": "https://stackoverflow.com/users/2342399/boosted-d16"}, "edited": false, "score": 0, "creation_date": 1541613892, "post_id": 29639840, "comment_id": 93279141, "body": "Try www.pptxbuilder.com"}], "answers": [{"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1429112783, "creation_date": 1429112783, "answer_id": 29654833, "question_id": 29639840, "link": "https://stackoverflow.com/questions/29639840/create-power-point-using-excel-macro/29654833#29654833", "title": "Create power point using excel macro", "body": "<p>I have a commercial PPT add-in that does this <em>type</em> of thing, but unfortunately not this <em>exact</em> thing.  </p>\n\n<p>In outline, you'd want to start with a PPT presentation that has two slides, each of which has \"placeholder\" text boxes ... text boxes with text like @question@, @answer@ and so on.  </p>\n\n<p>The code would:</p>\n\n<p>Get a count of the number of rows of data (ie, number of Q&amp;A slide pairs needed)</p>\n\n<p>Make a copy of your starting \"template\" PPT file, then duplicate each of the original slides n times, where n=number of rows of data in the spreadsheet.</p>\n\n<p>Walk down the rows of data, for each row, replace the @question@ text in the current slide, replace the options in the current slide, increment the slide counter, replace the @answer@ in the current slide with the answer from the current row of data and so on.</p>\n\n<p>You could write this either in PPT or Excel; if you're familiar with VBA/Excel, I'd do it there.</p>\n"}, {"tags": [], "owner": {"reputation": 56, "user_id": 4810820, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/67fee23ea7a56b94897719e82341d933?s=128&d=identicon&r=PG", "display_name": "Clint L", "link": "https://stackoverflow.com/users/4810820/clint-l"}, "is_accepted": true, "score": 4, "last_activity_date": 1429540081, "creation_date": 1429540081, "answer_id": 29750646, "question_id": 29639840, "link": "https://stackoverflow.com/questions/29639840/create-power-point-using-excel-macro/29750646#29750646", "title": "Create power point using excel macro", "body": "<p>I managed to figure it out coding it myself in the excel macro. It's not the best solution, but it is easy to follow and can be modified by someone with this same issue. FYI I am the asker of this question, but my computer is in serious need of reimage and I can't log in to stack overflow...O well. Here is my code that solved this problem. Please note that all of the question were sorted by category prior so I simply changed the start and end loop control variables to make new ppts after saving and closing the previously created ones. The following code may contain code borrowed from other stack overflow questions and is repurposed:</p>\n\n<pre><code>Sub CreatePowerPointQuestions()\n\n 'Add a reference to the Microsoft PowerPoint Library by:\n'1. Go to Tools in the VBA menu\n'2. Click on Reference\n'3. Scroll down to Microsoft PowerPoint X.0 Object Library, check the box, and press Okay\n\n'First we declare the variables we will be using\n    Dim newPowerPoint As PowerPoint.Application\n    Dim activeSlide As PowerPoint.Slide\n    Dim Question As String\n    Dim Options As String 'comma separated list of options\n    Dim Choices() As String 'split up options for printing\n    Dim printOptions As String 'string to print in contents of slide\n    Dim Answer As String\n    Dim limit As Integer\n'set question amount:\n    limit = 5\n 'Look for existing instance\n    On Error Resume Next\n    Set newPowerPoint = GetObject(, \"PowerPoint.Application\")\n    On Error GoTo 0\n\n'Let's create a new PowerPoint\n    If newPowerPoint Is Nothing Then\n        Set newPowerPoint = New PowerPoint.Application\n    End If\n'Make a presentation in PowerPoint\n    If newPowerPoint.Presentations.Count = 0 Then\n        newPowerPoint.Presentations.Add\n    End If\n\n'Show the PowerPoint\n    newPowerPoint.Visible = True\n'Select worksheet and cells activate\n    Worksheets(\"Sheet1\").Activate\n\n'Loop through each question\n    For i = 1 To limit\n\n    'Add a new slide where we will paste the Question and Options:\n        newPowerPoint.ActivePresentation.Slides.Add newPowerPoint.ActivePresentation.Slides.Count + 1, ppLayoutText\n        newPowerPoint.ActiveWindow.View.GotoSlide newPowerPoint.ActivePresentation.Slides.Count\n        Set activeSlide = newPowerPoint.ActivePresentation.Slides(newPowerPoint.ActivePresentation.Slides.Count)\n\n    'Set the variables to the cells\n        Question = ActiveSheet.Cells(i, 1).Value\n        Options = ActiveSheet.Cells(i, 2).Value\n        Answer = ActiveSheet.Cells(i, 3).Value\n\n    'Split options into choices a,b,c,d based on comma separation\n        Choices() = Split(Options, \", \")\n    'Formate printOptions to paste into content\n        printOptions = \"A) \" &amp; Choices(0) &amp; vbNewLine &amp; \"B) \" &amp; Choices(1) &amp; vbNewLine &amp; \"C) \" &amp; Choices(2) &amp; vbNewLine &amp; \"D) \" &amp; Choices(3)\n        activeSlide.Shapes(2).TextFrame.TextRange.Text = printOptions\n\n    'Set the title of the slide the same as the question for the options\n        activeSlide.Shapes(1).TextFrame.TextRange.Text = Question\n\n    'Add answer slide and select it\n        newPowerPoint.ActivePresentation.Slides.Add newPowerPoint.ActivePresentation.Slides.Count + 1, ppLayoutText\n        newPowerPoint.ActiveWindow.View.GotoSlide newPowerPoint.ActivePresentation.Slides.Count\n        Set activeSlide = newPowerPoint.ActivePresentation.Slides(newPowerPoint.ActivePresentation.Slides.Count)\n    'Set title:\n        activeSlide.Shapes(1).TextFrame.TextRange.Text = \"Answer:\"\n    'Set contents to answer:\n        activeSlide.Shapes(2).TextFrame.TextRange.Text = Answer\n    'Finished with a row (question)\n    Next\n\nAppActivate (\"Microsoft PowerPoint\")\nSet activeSlide = Nothing\nSet newPowerPoint = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 993, "user_id": 3157948, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/599ccf9f9096ea51b35ab7fc7fc28255?s=128&d=identicon&r=PG&f=1", "display_name": "Clint L", "link": "https://stackoverflow.com/users/3157948/clint-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18152, "favorite_count": 1, "accepted_answer_id": 29750646, "answer_count": 2, "score": 2, "last_activity_date": 1429540081, "creation_date": 1429059361, "last_edit_date": 1429061361, "question_id": 29639840, "link": "https://stackoverflow.com/questions/29639840/create-power-point-using-excel-macro", "title": "Create power point using excel macro", "body": "<p>I have an interesting problem I am unsure of. I have not worked with power point and have little excel macro experience. I have found many similar issues to mine but none of them quite fit the bill. I am helping my local charity with a fund raiser and need a way to make a triva sort of game. The game will be displayed with powerpoint, and all the questions, choices, and answers are in an excel sheet. The way it is laid our is one question per row, and the columns are: Question, options, answers and category.</p>\n\n<p>I have managed the category sorting quite easy enough, but now I need to somehow work with creating power point slides in such a way so that the question is the title, with the options being the content, and then the following slide is the answer to that question. Therefore each question creates two slides, a question and answer slide.</p>\n\n<p>Example row (| denote column):</p>\n\n<blockquote>\n  <p>Which of these was an italian sculptor?   |   Michelangelo, tintoretto, da vinci, galilleo    | michelangelo  |  Art</p>\n</blockquote>\n\n<p>So the result would be a side with title \"Which of these was an italian sculptor?\" and content a) Michelangelo, b) tintoretto, c) da vinci, d) galilleo</p>\n\n<p>the following slide simply being \"Michelangelo\" </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 3, "creation_date": 1460387136, "post_id": 29639586, "comment_id": 60705405, "body": "Note that if the table is empty, <code>tbl.DataBodyRange.Rows.Count</code> throws an error"}, {"owner": {"reputation": 197, "user_id": 2237769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SvdY.jpg?s=128&g=1", "display_name": "Kanike Vamshi Krishna", "link": "https://stackoverflow.com/users/2237769/kanike-vamshi-krishna"}, "edited": false, "score": 9, "creation_date": 1462257185, "post_id": 29639586, "comment_id": 61547795, "body": "Instead <code>tbl.listrows.count</code> can be used to get the number of rows even if the table is empty. This would not throw any error in a code"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 24, "last_activity_date": 1429057355, "creation_date": 1429057355, "answer_id": 29639586, "question_id": 29639474, "link": "https://stackoverflow.com/questions/29639474/vba-counting-rows-in-a-table-list-object/29639586#29639586", "title": "VBA: Counting rows in a table (list object)", "body": "<p>You need to go one level deeper in what you are retrieving.</p>\n\n<pre><code>Dim tbl As ListObject\nSet tbl = ActiveSheet.ListObjects(\"MyTable\")\nMsgBox tbl.Range.Rows.Count\nMsgBox tbl.HeaderRowRange.Rows.Count\nMsgBox tbl.DataBodyRange.Rows.Count\nSet tbl = Nothing\n</code></pre>\n\n<p>More information at:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.listobject.aspx\">ListObject Interface</a><br/>  <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.listobject.range.aspx\">ListObject.Range Property</a><br/>  <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193223.aspx?f=255&amp;MSPPError=-2147217396\">ListObject.DataBodyRange Property</a><br/>  <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.listobject.headerrowrange.aspx\">ListObject.HeaderRowRange Property</a></p>\n"}, {"comments": [{"owner": {"reputation": 28753, "user_id": 371184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cebee1b08fb960edf79a359af330391a?s=128&d=identicon&r=PG", "display_name": "Mike Cluck", "link": "https://stackoverflow.com/users/371184/mike-cluck"}, "edited": false, "score": 0, "creation_date": 1466616858, "post_id": 37968864, "comment_id": 63395772, "body": "How does this improve on the accepted answer from over 1 year ago?"}, {"owner": {"reputation": 448, "user_id": 6497071, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100003619527049/picture?type=large", "display_name": "Thiago Conrado", "link": "https://stackoverflow.com/users/6497071/thiago-conrado"}, "edited": false, "score": 0, "creation_date": 1512846984, "post_id": 37968864, "comment_id": 82424921, "body": "Well, I&#39;m sorry that @Jalal anwser was late for you, but I&#39;m really glad he posted it!"}, {"owner": {"reputation": 376, "user_id": 6499355, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xiVMa.jpg?s=128&g=1", "display_name": "Jalal", "link": "https://stackoverflow.com/users/6499355/jalal"}, "edited": false, "score": 0, "creation_date": 1576189559, "post_id": 37968864, "comment_id": 104829012, "body": "<code>[#data]</code> can be omited. i.e. <code>Range(&quot;MyTable&quot;).Rows.Count</code> can be used. This is even better: <code>Range(&quot;MyTable&quot;).ListObject.ListRows.Count</code> as it will return 0 if the table has no rows (a variation of what @Kanike mentioned in his comment above)."}], "tags": [], "owner": {"reputation": 376, "user_id": 6499355, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xiVMa.jpg?s=128&g=1", "display_name": "Jalal", "link": "https://stackoverflow.com/users/6499355/jalal"}, "is_accepted": false, "score": 4, "last_activity_date": 1520411778, "last_edit_date": 1520411778, "creation_date": 1466600508, "answer_id": 37968864, "question_id": 29639474, "link": "https://stackoverflow.com/questions/29639474/vba-counting-rows-in-a-table-list-object/37968864#37968864", "title": "VBA: Counting rows in a table (list object)", "body": "<p>You can use this:</p>\n\n<pre><code>    Range(\"MyTable[#Data]\").Rows.Count\n</code></pre>\n\n<p>You have to distinguish between a table which has either one row of data or no data, as the previous code will return \"1\" for both cases.\nUse this to test for an empty table:</p>\n\n<pre><code>    If WorksheetFunction.CountA(Range(\"MyTable[#Data]\"))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9424804, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DqoTDsHlYEw/AAAAAAAAAAI/AAAAAAAAO_k/dg_jtC22Pak/photo.jpg?sz=128", "display_name": "Sangamesh B M", "link": "https://stackoverflow.com/users/9424804/sangamesh-b-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1519845513, "last_edit_date": 1519845513, "creation_date": 1519837306, "answer_id": 49034887, "question_id": 29639474, "link": "https://stackoverflow.com/questions/29639474/vba-counting-rows-in-a-table-list-object/49034887#49034887", "title": "VBA: Counting rows in a table (list object)", "body": "<p>You can use:</p>\n\n<pre><code>Sub returnname(ByVal TableName As String)\n\nMsgBox (Range(\"Table15\").Rows.count)\n\nEnd Sub\n</code></pre>\n\n<p>and call the function as below</p>\n\n<pre><code>Sub called()\n\nreturnname \"Table15\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 2412489, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5c13bd989b8f9a41dd7c642f1c3f6930?s=128&d=identicon&r=PG", "display_name": "user2412489", "link": "https://stackoverflow.com/users/2412489/user2412489"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108983, "favorite_count": 3, "accepted_answer_id": 29639586, "answer_count": 3, "score": 13, "last_activity_date": 1533154006, "creation_date": 1429056425, "last_edit_date": 1533154006, "question_id": 29639474, "link": "https://stackoverflow.com/questions/29639474/vba-counting-rows-in-a-table-list-object", "title": "VBA: Counting rows in a table (list object)", "body": "<p>I am trying to write some VBA in Excel that can take the name of a table (list object) as a parameter and return the number of rows.</p>\n\n<p>The following works, but isn't allowing me to pass in a string with the table name.</p>\n\n<pre><code>MsgBox ([MyTable].Rows.Count)\n</code></pre>\n\n<p>The following gives the error: </p>\n\n<blockquote>\n  <p>Object required</p>\n</blockquote>\n\n<pre><code>v_MyTable = \"MyTable\"\nMsgBox (v_MyTable.Rows.Count)\n</code></pre>\n\n<p>The following gives the error: </p>\n\n<blockquote>\n  <p>Object variable or With block variable not set</p>\n</blockquote>\n\n<pre><code>v_MyTable_b = \"[\" &amp; \"MyTable\" &amp; \"]\"\nMsgBox(v_MyTable_b.Rows.Count)\n</code></pre>\n\n<p>I also tried working with ListObjects, which I am new to. I get the error: </p>\n\n<blockquote>\n  <p>Object doesn't support this property or method</p>\n</blockquote>\n\n<pre><code>Dim tbl As ListObject\nSet tbl = ActiveSheet.ListObjects(\"MyTable\")\nMsgBox(tbl.Rows.Count)\n</code></pre>\n\n<p>Thanks for any help!</p>\n"}, {"tags": ["xml", "vba", "dom", "xpath", "xml-parsing"], "answers": [{"comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1429068762, "post_id": 29639701, "comment_id": 47423815, "body": "we appreciate your answer but it is helpful to give a brief, written summary of the answer you suggest for both the OP and future readers."}, {"owner": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "edited": false, "score": 0, "creation_date": 1429107546, "post_id": 29639701, "comment_id": 47445226, "body": "@Tim very interesting, thanks! One question: why don&#39;t we have to <b>ReDim Preserve</b> the arrays that we&#39;re storing data in though?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "edited": false, "score": 1, "creation_date": 1429110234, "post_id": 29639701, "comment_id": 47447396, "body": "@NRH - I split out the array extension and population into the Sub <code>AddValue</code>"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1429058182, "creation_date": 1429058182, "answer_id": 29639701, "question_id": 29639301, "link": "https://stackoverflow.com/questions/29639301/vba-dom-variable-attribute-in-xpath/29639701#29639701", "title": "VBA DOM Variable Attribute in XPath", "body": "<pre><code>Sub mySub()\n\nDim XMLFile As Variant\nDim Author As Variant\nDim athr As String, BookType As String, Title As String, StoreLocation As String\nDim AuthorArray() As String, BookTypeArray() As String, TitleArray() As String, StoreLocationArray() As String\nDim i As Long, x As Long, j As Long, pn As Object, loc As Object, arr, ln As String\n\nDim mainWorkBook As Workbook\nDim n As IXMLDOMNode\nSet mainWorkBook = ActiveWorkbook\nSet XMLFile = CreateObject(\"Microsoft.XMLDOM\")\nXMLFile.Load (\"C:\\Books.xml\")\n\nx = 1\nj = 0\n\nSet Author = XMLFile.SelectNodes(\"/catalog/book/author\")\nFor i = 0 To (Author.Length - 1)\n\n    athr = Author(i).Text\n\n    If athr = \"Ralls, Kim\" Then\n\n        Set pn = Author(i).ParentNode\n        BookType = pn.getAttribute(\"id\")\n        Title = pn.getElementsByTagName(\"title\").Item(0).nodeTypedValue\n\n        Set loc = pn.SelectSingleNode(\"misc/PublishedAuthor[@id='\" &amp; athr &amp; \"']/StoreLocation\")\n        'not found on full name - try last name\n        If loc Is Nothing Then\n            'get the last name\n            arr = Split(athr, \",\")\n            ln = Trim(arr(LBound(arr)))\n            Set loc = pn.SelectSingleNode(\"misc/PublishedAuthor[@id='\" &amp; ln &amp; \"']/StoreLocation\")\n        End If\n\n        If Not loc Is Nothing Then\n            StoreLocation = loc.Text\n        Else\n            StoreLocation = \"???\"\n        End If\n\n        AddValue AuthorArray, athr\n        AddValue BookTypeArray, BookType\n        AddValue TitleArray, Title\n        AddValue StoreLocationArray, StoreLocation\n\n        j = j + 1\n        x = x + 1\n    End If\nNext\n\nRange(\"A3\").Resize(j, 1).Value = WorksheetFunction.Transpose(AuthorArray)\nRange(\"B3\").Resize(j, 1).Value = WorksheetFunction.Transpose(BookTypeArray)\nRange(\"C3\").Resize(j, 1).Value = WorksheetFunction.Transpose(TitleArray)\nRange(\"D3\").Resize(j, 1).Value = WorksheetFunction.Transpose(StoreLocationArray)\n\nEnd Sub\n\n'Utility method - resize an array as needed, and add a new value\nSub AddValue(arr, v)\n    Dim i As Long\n    i = -1\n    On Error Resume Next\n    i = UBound(arr) + 1\n    On Error GoTo 0\n    If i = -1 Then i = 0\n    ReDim Preserve arr(0 To i)\n    arr(i) = v\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 3658340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d84370eb96f5d6f5ad3cd58a82780bb?s=128&d=identicon&r=PG", "display_name": "Wlouthe", "link": "https://stackoverflow.com/users/3658340/wlouthe"}, "is_accepted": false, "score": 0, "last_activity_date": 1429065000, "last_edit_date": 1429065000, "creation_date": 1429058545, "answer_id": 29639738, "question_id": 29639301, "link": "https://stackoverflow.com/questions/29639301/vba-dom-variable-attribute-in-xpath/29639738#29639738", "title": "VBA DOM Variable Attribute in XPath", "body": "<p>Maybe try your bottom line plus splitting?</p>\n\n<pre><code>Dim athrArry() as String = Split(athr, \", \")\n\nStoreLocation = Author(i).ParentNode.SelectSingleNode(\"misc/PublishedAuthor[@id=\"\"\" &amp; athrArry(0) &amp; \"\"\"]/StoreLocation\").Text\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 670, "favorite_count": 0, "accepted_answer_id": 29639701, "answer_count": 2, "score": 0, "last_activity_date": 1429065000, "creation_date": 1429055400, "question_id": 29639301, "link": "https://stackoverflow.com/questions/29639301/vba-dom-variable-attribute-in-xpath", "title": "VBA DOM Variable Attribute in XPath", "body": "<p>I have a program that searches for and gathers (via array) a specific author and their 'BookType' and 'BookTitle' I am now trying to learn how to use the author's name - that I've stored in an array - as a variable in the XPath to get the 'Store Location'. </p>\n\n<p>The biggest obstacle now is that the location only uses the author's last name. So I can split the string and all, but how would I feed it back into the XPath?</p>\n\n<p>Below you'll see that <code>&lt;PublishedAuthor id='LASTNAME'&gt;</code> as opposed to their full name, so I cannot just put <code>athr</code> in the XPath this time. I keep getting an object error.</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;catalog&gt;\n&lt;book id=\"Adventure\"&gt;\n   &lt;author&gt;Gambardella, Matthew&lt;/author&gt;\n   &lt;title&gt;XML Developer's Guide&lt;/title&gt;\n   &lt;price&gt;44.95&lt;/price&gt;\n   &lt;misc&gt;\n        &lt;Publisher id=\"5691\"&gt;\n            &lt;PublisherLocation&gt;Los Angeles&lt;/PublisherLocation&gt;\n        &lt;/Publisher&gt;\n        &lt;PublishedAuthor id=\"Gambardella\"&gt;\n            &lt;StoreLocation&gt;Store B&lt;/StoreLocation&gt;\n        &lt;/PublishedAuthor&gt;\n    &lt;/misc&gt;\n&lt;/book&gt;\n&lt;book id=\"Adventure\"&gt;\n   &lt;author&gt;Ralls, Kim&lt;/author&gt;\n   &lt;title&gt;Midnight Rain&lt;/title&gt;\n   &lt;price&gt;5.95&lt;/price&gt;\n   &lt;misc&gt;\n        &lt;Publisher id=\"4787\"&gt;\n            &lt;PublisherLocation&gt;New York&lt;/PublisherLocation&gt;\n        &lt;/Publisher&gt;\n        &lt;PublishedAuthor id=\"Ralls\"&gt;\n            &lt;StoreLocation&gt;Store B&lt;/StoreLocation&gt;\n        &lt;/PublishedAuthor&gt;\n    &lt;/misc&gt;\n&lt;/book&gt;\n&lt;book id=\"Adventure\"&gt;\n   &lt;author&gt;Boal, John&lt;/author&gt;\n   &lt;title&gt;Mist&lt;/title&gt;\n   &lt;price&gt;15.95&lt;/price&gt;\n   &lt;misc&gt;\n        &lt;Publisher id=\"8101\"&gt;\n            &lt;PublisherLocation&gt;New Mexico&lt;/PublisherLocation&gt;\n        &lt;/Publisher&gt;\n        &lt;PublishedAuthor id=\"Boal\"&gt;\n            &lt;StoreLocation&gt;Store B&lt;/StoreLocation&gt;\n        &lt;/PublishedAuthor&gt;\n    &lt;/misc&gt;\n&lt;/book&gt;\n&lt;book id=\"Mystery\"&gt;\n   &lt;author&gt;Ralls, Kim&lt;/author&gt;\n   &lt;title&gt;Some Mystery Book&lt;/title&gt;\n   &lt;price&gt;9.95&lt;/price&gt;\n   &lt;misc&gt;\n        &lt;Publisher id=\"6642\"&gt;\n            &lt;PublisherLocation&gt;New York&lt;/PublisherLocation&gt;\n        &lt;/Publisher&gt;\n        &lt;PublishedAuthor id=\"Ralls\"&gt;\n            &lt;StoreLocation&gt;Store B&lt;/StoreLocation&gt;\n        &lt;/PublishedAuthor&gt;\n    &lt;/misc&gt;\n&lt;/book&gt;\n&lt;/catalog&gt;\n</code></pre>\n\n<p>My code:</p>\n\n<pre><code>Option Explicit\n\nSub mySub()\n\nDim XMLFile As Variant\nDim Author As Variant\nDim athr As String, BookType As String, Title As String, StoreLocation As String\nDim AuthorArray() As String, BookTypeArray() As String, TitleArray() As String, StoreLocationArray() As String\nDim i As Long, x As Long, j As Long\n\nDim mainWorkBook As Workbook\nDim n As IXMLDOMNode\nSet mainWorkBook = ActiveWorkbook\nSet XMLFile = CreateObject(\"Microsoft.XMLDOM\")\nXMLFile.Load (\"C:\\Books.xml\")\n\n\nx = 1\nj = 0\n\nSet Author = XMLFile.SelectNodes(\"/catalog/book/author\")\nFor i = 0 To (Author.Length - 1)\n    ReDim Preserve AuthorArray(0 To i)\n    ReDim Preserve BookTypeArray(0 To i)\n    ReDim Preserve TitleArray(0 To i)\n    ReDim Preserve StoreLocationArray(0 To i)\n\n    athr = Author(i).Text\n    BookType = Author(i).ParentNode.getAttribute(\"id\")\n    Title = Author(i).ParentNode.getElementsByTagName(\"title\").Item(0).nodeTypedValue\n    StoreLocation = Author(i).ParentNode.SelectSingleNode(\"misc/PublishedAuthor[@id=\"\"\" &amp; athr &amp; \"\"\"]/StoreLocation\").Text\n\n    If athr = \"Ralls, Kim\" Then\n\n        AuthorArray(j) = athr\n        BookTypeArray(j) = BookType\n        TitleArray(j) = Title\n        StoreLocationArray(j) = StoreLocation\n\n        j = j + 1\n        x = x + 1\n    End If\nNext\n\nRange(\"A3:A\" &amp; UBound(AuthorArray) + 1) = WorksheetFunction.Transpose(AuthorArray)\nRange(\"B3:B\" &amp; UBound(BookTypeArray) + 1) = WorksheetFunction.Transpose(BookTypeArray)\nRange(\"C3:C\" &amp; UBound(BookTypeArray) + 1) = WorksheetFunction.Transpose(TitleArray)\nRange(\"D3:D\" &amp; UBound(BookTypeArray) + 1) = WorksheetFunction.Transpose(TitleArray)\n</code></pre>\n\n<p>Is there a better way to deal with an issue like this?</p>\n\n<p><code>StoreLocation = Author(i).ParentNode.SelectSingleNode(\"misc/PublishedAuthor[@id=\"\"\" &amp; athr &amp; \"\"\"]/StoreLocation\").Text</code> works flawlessly if the PublishedAuthor id was the same value as the author value.</p>\n\n<p>Thank you for any guidance, help, or comments!</p>\n"}, {"tags": ["vba", "function", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1429052756, "post_id": 29638807, "comment_id": 47419795, "body": "You can use <code>VLOOKUP()</code> for this"}], "answers": [{"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1429052814, "creation_date": 1429052814, "answer_id": 29638880, "question_id": 29638807, "link": "https://stackoverflow.com/questions/29638807/trying-to-search-a-sheet-and-copy-row-which-matches/29638880#29638880", "title": "Trying to search a sheet and copy row which matches", "body": "<p>Please try:  </p>\n\n<pre><code>=VLOOKUP($B1,SheetA!$A:$L,COLUMN()+x,0)  \n</code></pre>\n\n<p>in the cell immediately to the right of <code>Bob</code> and copied across eleven columns. Set <code>+x</code> to suit the column in which <code>Bob</code> is (eg to <code>-1</code> if <code>Bob</code> is in ColumnB).</p>\n"}], "owner": {"reputation": 1, "user_id": 4789518, "user_type": "registered", "profile_image": "https://graph.facebook.com/350526445155054/picture?type=large", "display_name": "David Andersen", "link": "https://stackoverflow.com/users/4789518/david-andersen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429052814, "creation_date": 1429052358, "last_edit_date": 1429052531, "question_id": 29638807, "link": "https://stackoverflow.com/questions/29638807/trying-to-search-a-sheet-and-copy-row-which-matches", "title": "Trying to search a sheet and copy row which matches", "body": "<p>I believe this will take a macro, but would prefer something else.</p>\n\n<p>Once I enter a name such as Bob into a cell, I would like it to check sheet A in column A for \"Bob\". If it locates a Bob, it copies the 11 cells to the right of Bob's name into the current sheet I am working on, to the right of where I had typed Bob.</p>\n"}, {"tags": ["arrays", "vba", "loops", "excel"], "comments": [{"owner": {"reputation": 414, "user_id": 3750262, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/903190092/picture?type=large", "display_name": "Greg", "link": "https://stackoverflow.com/users/3750262/greg"}, "edited": false, "score": 1, "creation_date": 1429050189, "post_id": 29638215, "comment_id": 47418981, "body": "What value should be returned for a non-square range? What value should be returned for the matrix {(1,2), (5,6)} ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1429050742, "post_id": 29638215, "comment_id": 47419168, "body": "I&#39;m unclear on how <b>(1,2,1,3)</b> is a 4&#215;4 matrix; seems to be either a 1&#215;4 or 4&#215;1 matrix; probably the former. A 4&#215;4 matrix would be something like <b>((1,2,1,3),(1,1,1,3),(3,2,3,3),(2,2,1,1))</b>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1429051044, "post_id": 29638215, "comment_id": 47419277, "body": "@pnuts - VBA arrays drive me nuts (no pun intended). Transpose or not transpose, single column or row always becomes two dimensional array, etc, etc."}, {"owner": {"reputation": 414, "user_id": 3750262, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/903190092/picture?type=large", "display_name": "Greg", "link": "https://stackoverflow.com/users/3750262/greg"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1429051541, "post_id": 29638215, "comment_id": 47419438, "body": "@pnuts Is there a way to constrain a function&#39;s range parameter such that it need be square? I think a non-square range would need to be tested for within the function."}, {"owner": {"reputation": 414, "user_id": 3750262, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/903190092/picture?type=large", "display_name": "Greg", "link": "https://stackoverflow.com/users/3750262/greg"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1429053654, "post_id": 29638215, "comment_id": 47420041, "body": "@pnuts Ah thank you. I&#39;d interpreted this completely wrong."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1429054030, "creation_date": 1429054030, "answer_id": 29639077, "question_id": 29638215, "link": "https://stackoverflow.com/questions/29638215/identify-missing-values-from-array/29639077#29639077", "title": "Identify missing values from array", "body": "<p>Assuming that the requirement of a square range of cells supersedes the description of the 'matrix's' values, I'm not sure why an array is needed at all.</p>\n\n<pre><code>Function calcCost(rTopLeft As Range, n As Long)\n    Dim c As Long, r As Long\n\n    For c = 1 To n\n        If Not CBool(Application.CountIf(rTopLeft.Resize(n, n), c)) Then _\n            r = r + 1\n    Next c\n    calcCost = r\n\nEnd Function\n</code></pre>\n\n<p>Syntax:</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0=calcCost(<em>&lt;top left corner of desired range&gt;, &lt;number of cells both right and down&gt;</em>)</p>\n\n<p>Example:</p>\n\n<pre><code>=calcCost(E9, 18)\n</code></pre>\n\n<p>The above implementation could also be written as,</p>\n\n<pre><code>=18-SUMPRODUCT(--SIGN(COUNTIF(OFFSET(E9,0,0,18,18), ROW(1:18))))\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4773506, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153700623317004/picture?type=large", "display_name": "Sean Kay", "link": "https://stackoverflow.com/users/4773506/sean-kay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 444, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429320829, "creation_date": 1429049311, "last_edit_date": 1429320829, "question_id": 29638215, "link": "https://stackoverflow.com/questions/29638215/identify-missing-values-from-array", "title": "Identify missing values from array", "body": "<p>I am striving to create a function in VBA that calculates the number of missing values in each column of a matrix of nxn dimensions.</p>\n\n<p>Each column should contain the numbers 1 to n only once. \nHowever if this is not the case I want to the function to state how many values are missing. For example in a column of  4x4 matrix (1,2,1,3) there is one missing value which is 4, and the function should return the value 1, for the 1 missing value.</p>\n\n<p>I am very new to VBA and by no means a master, but this is what I have done so far...</p>\n\n<pre><code>Function calcCost(sol() As Integer, n As Integer) As Integer\n\nDim ArrayOfTruth(1 To n) As Boolean \n\n\n    For Row = 1 To n\n        For i = 1 To n\n            If ProbMatrix(Column, Row) = i Then\n                ArrayOfTruth(i) = True\n\n    cost = 0\n    For i = 1 To n\n        If ArrayOfTruth(i) = True Then\n            cost = cost + 1\n</code></pre>\n"}, {"tags": ["excel", "vba", "extract", "pull"], "comments": [{"owner": {"reputation": 414, "user_id": 3750262, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/903190092/picture?type=large", "display_name": "Greg", "link": "https://stackoverflow.com/users/3750262/greg"}, "edited": false, "score": 1, "creation_date": 1429050369, "post_id": 29638102, "comment_id": 47419029, "body": "What happens if you remove the .Select"}], "answers": [{"tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": true, "score": 1, "last_activity_date": 1429056830, "creation_date": 1429056830, "answer_id": 29639523, "question_id": 29638102, "link": "https://stackoverflow.com/questions/29638102/macro-to-pull-data-from-closed-workbook-to-another-workbook/29639523#29639523", "title": "Macro to pull data from closed workbook to another workbook", "body": "<p>As @Greg mentioned, the <code>.Select</code> is not needed.  Once that is removed though, you will have a new problem where the two ranges are not the same size.  <code>Range(\"A1\")</code> is only 1 cell while the other range will be at least 11.  Your current VBA will only overwrite the values in the Range called for, which is <code>A1</code> here.</p>\n\n<p>To get around this there are two approaches which work well.</p>\n\n<h1>Resize</h1>\n\n<p><code>Resize</code> the left hand side so that it is the same size as the right hand side.</p>\n\n<pre><code>Sub OpenWorkbookToPullData()\n\n    Dim sht As Worksheet\n    Dim lastRow As Long\n    lastRow = ActiveSheet.UsedRange.Rows.Count\n    Set sht = ThisWorkbook.Worksheets(Sheet1.Name)\n    Dim path As String\n    path = \"C:\\users\\\" &amp; Environ$(\"username\") &amp; _\n    \"\\desktop\\RC Switch Project\\Daily Automation Availability Report.xlsx\"\n\n    Dim currentWb As Workbook\n    Set currentWb = ThisWorkbook\n\n    Dim openWb As Workbook\n    Set openWb = Workbooks.Open(path)\n\n    Dim openWs As Worksheet\n    Set openWs = openWb.Sheets(\"Automation Data\")\n\n    Dim rng_data As Range\n    Set rng_data = openWs.Range(\"A5:K\" &amp; lastRow)\n\n    currentWb.Sheets(\"Availability\").Range(\"A1\").Resize( _\n        rng_data.Rows.Count, rng_data.Columns.Count).Value = rng_data.Value\n\n    openWb.Close (False)\n\nEnd Sub\n</code></pre>\n\n<h1>Copy/PasteSpecial</h1>\n\n<p>Actually <code>Copy</code> and then <code>PasteSpecial</code>.</p>\n\n<pre><code>Sub OpenWorkbookToPullData()\n\n    Dim sht As Worksheet\n    Dim lastRow As Long\n    lastRow = ActiveSheet.UsedRange.Rows.Count\n    Set sht = ThisWorkbook.Worksheets(Sheet1.Name)\n    Dim path As String\n    path = \"C:\\users\\\" &amp; Environ$(\"username\") &amp; _\n    \"\\desktop\\RC Switch Project\\Daily Automation Availability Report.xlsx\"\n\n    Dim currentWb As Workbook\n    Set currentWb = ThisWorkbook\n\n    Dim openWb As Workbook\n    Set openWb = Workbooks.Open(path)\n\n    Dim openWs As Worksheet\n    Set openWs = openWb.Sheets(\"Automation Data\")\n\n    Dim rng_data As Range\n    Set rng_data = openWs.Range(\"A5:K\" &amp; lastRow)\n\n    rng_data.Copy\n    currentWb.Sheets(\"Availability\").Range(\"A1\").PasteSpecial xlPasteValues\n\n    openWb.Close (False)\n\nEnd Sub\n</code></pre>\n\n<p>Since it looks like you are going for values anyways, I would use the <code>Copy/PasteSpecial</code> route for clarity in the code.</p>\n"}], "owner": {"reputation": 15, "user_id": 4500383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36c49db6c5dadcff05dc395c1a06485?s=128&d=identicon&r=PG&f=1", "display_name": "Hawth33", "link": "https://stackoverflow.com/users/4500383/hawth33"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3733, "favorite_count": 0, "accepted_answer_id": 29639523, "answer_count": 1, "score": 0, "last_activity_date": 1442282323, "creation_date": 1429048719, "last_edit_date": 1442282323, "question_id": 29638102, "link": "https://stackoverflow.com/questions/29638102/macro-to-pull-data-from-closed-workbook-to-another-workbook", "title": "Macro to pull data from closed workbook to another workbook", "body": "<p>I am writing a macro to do the following:</p>\n\n<p>Every time I open a workbook, pull data from a closed workbook on my computer and copy that data to a sheet titled \"Availability\" starting in cell A1.</p>\n\n<p>Currently, all that happens is \"TRUE\" is put into cell A1 on the Availability sheet.</p>\n\n<p>Please help.</p>\n\n<pre><code>Sub OpenWorkbookToPullData()\n\n    Dim sht As Worksheet\n    Dim lastRow As Long\n    lastRow = ActiveSheet.UsedRange.Rows.Count\n    Set sht = ThisWorkbook.Worksheets(Sheet1.Name)\n    Dim path As String\n    path = \"C:\\users\\\" &amp; Environ$(\"username\") &amp; _\n    \"\\desktop\\RC Switch Project\\Daily Automation _\n    Availability Report.xlsx\"\n\n    Dim currentWb As Workbook\n    Set currentWb = ThisWorkbook\n\n    Dim openWb As Workbook\n    Set openWb = Workbooks.Open(path)\n\n    Dim openWs As Worksheet\n    Set openWs = openWb.Sheets(\"Automation Data\")\n\n    currentWb.Sheets(\"Availability\").Range(\"A1\") _\n    = openWs.Range(\"A5:K\" &amp; LastRow).Select\n    openWb.Close (False)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "for-loop"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4789278, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ebcb780b272cb4efa639a4a3558d5aac?s=128&d=identicon&r=PG&f=1", "display_name": "chs", "link": "https://stackoverflow.com/users/4789278/chs"}, "edited": false, "score": 0, "creation_date": 1429118662, "post_id": 29640595, "comment_id": 47453182, "body": "Great, Thanks! The only issue is that after the first loop it doesn&#39;t go on to the next sheet in the workbook book. How would I fix that?"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 25, "user_id": 4789278, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ebcb780b272cb4efa639a4a3558d5aac?s=128&d=identicon&r=PG&f=1", "display_name": "chs", "link": "https://stackoverflow.com/users/4789278/chs"}, "edited": false, "score": 0, "creation_date": 1429145681, "post_id": 29640595, "comment_id": 47466376, "body": "@Jamie What do you mean it doesn&#39;t go to the next sheet. That will iterate every worksheet in the workbook."}, {"owner": {"reputation": 25, "user_id": 4789278, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ebcb780b272cb4efa639a4a3558d5aac?s=128&d=identicon&r=PG&f=1", "display_name": "chs", "link": "https://stackoverflow.com/users/4789278/chs"}, "edited": false, "score": 0, "creation_date": 1429584996, "post_id": 29640595, "comment_id": 47655967, "body": "After it iterates through the first table, it selects the next table on the next sheet, but doesnt add the row. It gives an error &quot;select method of range class failed&quot;. Again, thanks for the help so far and i hope this comment helps."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 25, "user_id": 4789278, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ebcb780b272cb4efa639a4a3558d5aac?s=128&d=identicon&r=PG&f=1", "display_name": "chs", "link": "https://stackoverflow.com/users/4789278/chs"}, "edited": false, "score": 0, "creation_date": 1429653876, "post_id": 29640595, "comment_id": 47697808, "body": "@chs I am now lost :) First, how many tables do you have in one sheet. Second, <code>but doesnt add the row</code> what do you mean by this statement? AFAIK, we&#39;re only trying to access the tables in each worksheet so other than that will be out of scope."}, {"owner": {"reputation": 25, "user_id": 4789278, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ebcb780b272cb4efa639a4a3558d5aac?s=128&d=identicon&r=PG&f=1", "display_name": "chs", "link": "https://stackoverflow.com/users/4789278/chs"}, "edited": false, "score": 0, "creation_date": 1430350154, "post_id": 29640595, "comment_id": 48033522, "body": "I ended up figuring it out, it ended up being as simple as adding a Worsheet.Activate piece. Thanks for your help"}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 1, "last_activity_date": 1429065330, "last_edit_date": 1429065330, "creation_date": 1429064942, "answer_id": 29640595, "question_id": 29637620, "link": "https://stackoverflow.com/questions/29637620/copy-paste-for-loop/29640595#29640595", "title": "Copy/Paste For Loop", "body": "<p>If you are using the counter, I am assuming your tables are named <em>Table1</em>, <em>Table2</em>, and so on for each worksheet.\nThe problem here is that you need to make sure that the Worksheet Index is in the same sequence as your table.<br></p>\n\n<p>You can try this alternative which is not dependent on the sequence of the worksheet and name of the <code>Tables</code>.</p>\n\n<pre><code>Dim sh As Worksheet\n\nFor Each sh In ThisWorkbook.Worksheets\n    sh.ListObjects(1).Range.Select\n    ' to check if you got the correct object, add below line\n    Debug.Print sh.ListObjects(1).Range.Address(, , , True)\nNext\n</code></pre>\n\n<p>Above is considering you only have one(1) <code>Table</code> in each Sheet.</p>\n"}], "owner": {"reputation": 25, "user_id": 4789278, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ebcb780b272cb4efa639a4a3558d5aac?s=128&d=identicon&r=PG&f=1", "display_name": "chs", "link": "https://stackoverflow.com/users/4789278/chs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429065330, "creation_date": 1429046471, "last_edit_date": 1531164843, "question_id": 29637620, "link": "https://stackoverflow.com/questions/29637620/copy-paste-for-loop", "title": "Copy/Paste For Loop", "body": "<p>I am working on a for loop that takes an entry on the first page of a worksheet, and copy and pastes it to the remaining sheets in the workbook, with the array size being <code>Worksheets.Count</code>. Specifically, I am having trouble finding a way to call on each table in each specific worksheet. I was trying to select the table based on the counter in the for loop such that: </p>\n\n<pre><code>For i=1 to Worksheets.count\n    Range.(\"Table(Counter\").Select \nNext i\n</code></pre>\n\n<p>but it doesn't work. Is there a better way to make sure that my code selects the proper table in each successive worksheet? I am still pretty new to VBA, so any and all help is appreciated! </p>\n"}, {"tags": ["arrays", "excel", "vba", "loops"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4725249, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/42683bc87bf0755f2ffa6492134f3f48?s=128&d=identicon&r=PG&f=1", "display_name": "StefanW", "link": "https://stackoverflow.com/users/4725249/stefanw"}, "edited": false, "score": 0, "creation_date": 1429050293, "post_id": 29637843, "comment_id": 47419010, "body": "Thank you! I tried this, but the return of the function is still #VALUE! . It seems like k does not get a value if month(parameter) = 12. But it still works for every other month..."}, {"owner": {"reputation": 128, "user_id": 4705168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba740fd7cfacd9d94eac1a6b67cf5949?s=128&d=identicon&r=PG&f=1", "display_name": "c b", "link": "https://stackoverflow.com/users/4705168/c-b"}, "reply_to_user": {"reputation": 23, "user_id": 4725249, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/42683bc87bf0755f2ffa6492134f3f48?s=128&d=identicon&r=PG&f=1", "display_name": "StefanW", "link": "https://stackoverflow.com/users/4725249/stefanw"}, "edited": false, "score": 0, "creation_date": 1429059535, "post_id": 29637843, "comment_id": 47421571, "body": "I see now. It makes things easier if you loop through the number of contract months you have, rather than all the months in the calendar. It also helps to separate your &quot;answer&quot; month and your &quot;loop counter&quot; into separate variables."}, {"owner": {"reputation": 128, "user_id": 4705168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba740fd7cfacd9d94eac1a6b67cf5949?s=128&d=identicon&r=PG&f=1", "display_name": "c b", "link": "https://stackoverflow.com/users/4705168/c-b"}, "reply_to_user": {"reputation": 23, "user_id": 4725249, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/42683bc87bf0755f2ffa6492134f3f48?s=128&d=identicon&r=PG&f=1", "display_name": "StefanW", "link": "https://stackoverflow.com/users/4725249/stefanw"}, "edited": false, "score": 0, "creation_date": 1429059712, "post_id": 29637843, "comment_id": 47421627, "body": "(Sean&#39;s solution is interesting but fails if you have contract months (3, 5, 7) and a parameter month of 10.)"}], "tags": [], "owner": {"reputation": 128, "user_id": 4705168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba740fd7cfacd9d94eac1a6b67cf5949?s=128&d=identicon&r=PG&f=1", "display_name": "c b", "link": "https://stackoverflow.com/users/4705168/c-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1429059449, "last_edit_date": 1429059449, "creation_date": 1429047435, "answer_id": 29637843, "question_id": 29637572, "link": "https://stackoverflow.com/questions/29637572/vba-excel-return-values-from-an-array-with-loop/29637843#29637843", "title": "VBA Excel Return values from an array with loop", "body": "<p>I understand better now what you're doing. I've edited my solution below. Don't be afraid to use more variables. Sometimes you can be using one variable to do too much and it makes it hard to see a solution.</p>\n\n<pre><code>' My test data\nDim contractlist(1 To 5, 1 To 1) As Integer\ncontractlist(1, 1) = 3\ncontractlist(2, 1) = 5\ncontractlist(3, 1) = 7\ncontractlist(4, 1) = 9\ncontractlist(5, 1) = 12\n\nDim month As Integer ' represents Month(Parameter)\nmonth = 12\n\n' Solution\nDim contractCount As Integer\nDim nextContractNum As Integer\nDim nextcontract As String\ncontractCount = UBound(contractlist, 1)\n\n' Next contract is the first in the list\n' if we don't find a later one\nnextContractNum = contractlist(1, 1)\n\nFor i = 1 To contractCount\n    If month &lt; contractlist(i, 1) Then\n        nextContractNum = contractlist(i, 1)\n        Exit For\n    End If\nNext i\n\nnextcontract = MonthName(nextContractNum)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "is_accepted": false, "score": 2, "last_activity_date": 1429048845, "creation_date": 1429048845, "answer_id": 29638129, "question_id": 29637572, "link": "https://stackoverflow.com/questions/29637572/vba-excel-return-values-from-an-array-with-loop/29638129#29638129", "title": "VBA Excel Return values from an array with loop", "body": "<p>There's a sneaky way to cheat that uses <code>MOD</code><br>\nAs <em>mod</em> will reduce a value to 0 when it equals the value looked for (and multiples), we can use this so the Month when you get December from your parameter will be zero, instead of 12...</p>\n\n<pre><code>Do Until (Month(Parameter) Mod 12) &lt; contractlist(k, 1)\n</code></pre>\n\n<p>This will leave every other month alone, but will return 0 for December.  </p>\n"}], "owner": {"reputation": 23, "user_id": 4725249, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/42683bc87bf0755f2ffa6492134f3f48?s=128&d=identicon&r=PG&f=1", "display_name": "StefanW", "link": "https://stackoverflow.com/users/4725249/stefanw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 903, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1429059449, "creation_date": 1429046317, "question_id": 29637572, "link": "https://stackoverflow.com/questions/29637572/vba-excel-return-values-from-an-array-with-loop", "title": "VBA Excel Return values from an array with loop", "body": "<p>I have a small loop in my vba function, which gives me for each Month - i.e. Parameter - the respective contract from a list and works for every month except December. Contractlist is a vertical array (3,5,7,9,12). This is the code:</p>\n\n<blockquote>\n<pre><code>k = 1\nDo Until Month(Parameter) &lt; contractlist(k, 1)\nk = k + 1\nLoop\n\nnextcontract = MonthName(contractlist(k, 1))\n</code></pre>\n</blockquote>\n\n<p>Here is the problem: When the month is December, month(December) is never smaller than contractlist(k, 1) because 12 is the smallest value in that array. In that case, I would like to just jump to the first value of the array, i.e. \"3\". In other words, in the last line nextcontract should be MonthName(contractlist(1, 1)). Can somebody give me a hint how to do that?</p>\n\n<p>Thanks, your help is really appreciated!</p>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 2309, "user_id": 1411000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gRPK5.jpg?s=128&g=1", "display_name": "Hiten004", "link": "https://stackoverflow.com/users/1411000/hiten004"}, "edited": false, "score": 0, "creation_date": 1429042819, "post_id": 29636427, "comment_id": 47415542, "body": "In your code listed above i do not see any sheet1 and sheet2. i saw <code>Sheets(&quot;P&amp;L&quot;)</code> and <code>Sheets(&quot;Sheet4&quot;)</code> please modifed the question. thx"}, {"owner": {"reputation": 1, "user_id": 4789040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71a573b270afbe5a467844564716d975?s=128&d=identicon&r=PG&f=1", "display_name": "ja2255", "link": "https://stackoverflow.com/users/4789040/ja2255"}, "reply_to_user": {"reputation": 2309, "user_id": 1411000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gRPK5.jpg?s=128&g=1", "display_name": "Hiten004", "link": "https://stackoverflow.com/users/1411000/hiten004"}, "edited": false, "score": 0, "creation_date": 1429044181, "post_id": 29636427, "comment_id": 47416228, "body": "@Hiten004 - I updated the description. thanks for any help"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1429045389, "post_id": 29636427, "comment_id": 47416854, "body": "Why do you use a + sign in front of VLookup?"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1429046138, "post_id": 29636427, "comment_id": 47417240, "body": "123 did not have VBA. If it is possible to learn VBA, it should be possible to learn formula syntax in Excel, too. Just sayin&#39;."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4789040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71a573b270afbe5a467844564716d975?s=128&d=identicon&r=PG&f=1", "display_name": "ja2255", "link": "https://stackoverflow.com/users/4789040/ja2255"}, "edited": false, "score": 0, "creation_date": 1429541530, "post_id": 29637251, "comment_id": 47634516, "body": "awesome - it moves through the active worksheet rather than updating each sheet. thanks for your help! @chito"}], "tags": [], "owner": {"reputation": 185, "user_id": 2357267, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1025d5e0ae22bca65697f606795a94ab?s=128&d=identicon&r=PG&f=1", "display_name": "Chito", "link": "https://stackoverflow.com/users/2357267/chito"}, "is_accepted": false, "score": 0, "last_activity_date": 1429044942, "creation_date": 1429044942, "answer_id": 29637251, "question_id": 29636427, "link": "https://stackoverflow.com/questions/29636427/duplicating-vlookup-macro-in-multiple-sheets/29637251#29637251", "title": "Duplicating VLOOKUP macro in multiple sheets", "body": "<p>Try this one,</p>\n\n<pre><code>Sub update_gp_profits()\nDim ws As Worksheet\nDim rng As Range\nDim lRow As Long\n\nSet ws = ActiveSheet\n      '\n    With ws\n            lRow = ws.Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row ' Last row\n\n            Set rng = .Range(\"A2\" &amp; \":\" &amp; \"A\" &amp; lRow) ' This is your range\n                rng.Offset(0, 1).FormulaR1C1 = \"=VLOOKUP(RC[-1],'P&amp;L'!R15C3:R29702C4,2,FALSE)\"\n                rng.Offset(0, 2).FormulaR1C1 = \"=VLOOKUP(RC[-2],'P&amp;L'!R15C3:R29702C5,3,FALSE)\"\n                rng.Offset(0, 3).FormulaR1C1 = \"=VLOOKUP(RC[-3],'P&amp;L'!R15C3:R29702C6,4,FALSE)\"\n                rng.Offset(0, 4).FormulaR1C1 = \"=VLOOKUP(RC[-4],'P&amp;L'!R15C3:R29702C17,15,FALSE)\"\n                rng.Offset(0, 5).FormulaR1C1 = \"=VLOOKUP(RC[-5],'P&amp;L'!R15C3:R29702C18,16,FALSE)\"\n                rng.Offset(0, 10).FormulaR1C1 = \"=VLOOKUP(RC[-10],'P&amp;L'!R15C3:R29702C160,158,FALSE)\"\n\n            Debug.Print rng.Address\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2309, "user_id": 1411000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gRPK5.jpg?s=128&g=1", "display_name": "Hiten004", "link": "https://stackoverflow.com/users/1411000/hiten004"}, "is_accepted": false, "score": 0, "last_activity_date": 1429045110, "last_edit_date": 1495542130, "creation_date": 1429045110, "answer_id": 29637303, "question_id": 29636427, "link": "https://stackoverflow.com/questions/29636427/duplicating-vlookup-macro-in-multiple-sheets/29637303#29637303", "title": "Duplicating VLOOKUP macro in multiple sheets", "body": "<p><strong>Try below code it will loop all the rows on the sheet4.</strong> \nmax num of row in 2010 office = <a href=\"https://stackoverflow.com/a/527026/1411000\">https://stackoverflow.com/a/527026/1411000</a>\n<a href=\"https://stackoverflow.com/a/527026/1411000\">https://stackoverflow.com/a/527026/1411000</a></p>\n\n<pre><code>Sub update_gp_profits()\n\nDim StartIndex, EndIndex, LoopIndex As Integer\nStartIndex = Sheets(\"Sheet4\").).Index + 1\nEndIndex =  1048576    \nFor LoopIndex = StartIndex To EndIndex\n\nlastrow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n.Range(\"B2:B\" &amp; lastrow).Formula = \"=+VLOOKUP(RC[-1],'P&amp;L'!R15C3:R29702C4,2,FALSE)\"\n    Range(\"C2\").Select\n.Range(\"C2:C\" &amp; lastrow).Formula = \"=+VLOOKUP(RC[-2],'P&amp;L'!R15C3:R29702C5,3,FALSE)\"\n    Range(\"D2\").Select\n.Range(\"D2:D\" &amp; lastrow).Formula = \"=+VLOOKUP(RC[-3],'P&amp;L'!R15C3:R29702C6,4,FALSE)\"\n    Range(\"E2\").Select\n.Range(\"E2:E\" &amp; lastrow).Formula = \"=+VLOOKUP(RC[-4],'P&amp;L'!R15C3:R29702C17,15,FALSE)\"\n    Range(\"F2\").Select\n.Range(\"F2:F\" &amp; lastrow).Formula = \"=+VLOOKUP(RC[-5],'P&amp;L'!R15C3:R29702C18,16,FALSE)\"\n    Range(\"J2\").Select\n.Range(\"k2:k\" &amp; lastrow).Formula = \"=+VLOOKUP(RC[-10],'P&amp;L'!R15C3:R29702C160,158,FALSE)\"\nRange(\"k2\").Select\n\nNext LoopIndex\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4789040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71a573b270afbe5a467844564716d975?s=128&d=identicon&r=PG&f=1", "display_name": "ja2255", "link": "https://stackoverflow.com/users/4789040/ja2255"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 249, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1429045110, "creation_date": 1429041876, "last_edit_date": 1429044357, "question_id": 29636427, "link": "https://stackoverflow.com/questions/29636427/duplicating-vlookup-macro-in-multiple-sheets", "title": "Duplicating VLOOKUP macro in multiple sheets", "body": "<p>I recorded a macro that VLOOKUPs from Sheet \"P&amp;L\" (the first tab that holds all of the data) and filters down in the current sheet until the data in column A runs out.  It works; however, I need this code to function for the remaining sheets. These are updated monthly.  There will be a different number of inputs in Column A in each sheet.  These are all ID #s I'm using to vlookup information from the P&amp;L tab.</p>\n\n<p>When I wrote this macro as a FoorLoopIndex, I keep getting \"Compile error: invalid or unqualified\" messages. </p>\n\n<p>I do not have any experiences with macros -- I'm struggling to find my error.</p>\n\n<pre><code>Sub update_gp_profits()\n\nDim StartIndex, EndIndex, LoopIndex As Integer\nStartIndex = Sheets(\"P&amp;L\").Index + 1\nEndIndex = Sheets(\"Sheet4\").Index - 1\n\nFor LoopIndex = StartIndex To EndIndex\n\nlastrow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n.Range(\"B2:B\" &amp; lastrow).Formula = \"=+VLOOKUP(RC[-1],'P&amp;L'!R15C3:R29702C4,2,FALSE)\"\n    Range(\"C2\").Select\n.Range(\"C2:C\" &amp; lastrow).Formula = \"=+VLOOKUP(RC[-2],'P&amp;L'!R15C3:R29702C5,3,FALSE)\"\n    Range(\"D2\").Select\n.Range(\"D2:D\" &amp; lastrow).Formula = \"=+VLOOKUP(RC[-3],'P&amp;L'!R15C3:R29702C6,4,FALSE)\"\n    Range(\"E2\").Select\n.Range(\"E2:E\" &amp; lastrow).Formula = \"=+VLOOKUP(RC[-4],'P&amp;L'!R15C3:R29702C17,15,FALSE)\"\n    Range(\"F2\").Select\n.Range(\"F2:F\" &amp; lastrow).Formula = \"=+VLOOKUP(RC[-5],'P&amp;L'!R15C3:R29702C18,16,FALSE)\"\n    Range(\"J2\").Select\n.Range(\"k2:k\" &amp; lastrow).Formula = \"=+VLOOKUP(RC[-10],'P&amp;L'!R15C3:R29702C160,158,FALSE)\"\nRange(\"k2\").Select\n\nNext LoopIndex\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "userform", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "is_accepted": false, "score": 0, "last_activity_date": 1429046438, "creation_date": 1429046438, "answer_id": 29637608, "question_id": 29635741, "link": "https://stackoverflow.com/questions/29635741/excel-vba-move-select-items-from-listbox-to-a-listbox-in-a-differnt-form-that-wi/29637608#29637608", "title": "Excel VBA move select items from listbox to a listbox in a differnt form that will be another popup userform", "body": "<p>Wherever you see <code>Me</code> you can reference a different userform.</p>\n\n<p>For example, I have two userforms <code>UserForm1</code> and <code>UserForm2</code>.  Let's say our initial ListBox, <code>ListBox1</code> is on <code>UserForm1</code> and contains a list of colors.  <code>UserForm1</code> also contains a command button, <code>CommandButton1</code> that will move the selected items from <code>UserForm1</code> to a different listbox (also called <code>ListBox1</code>) in <code>UserForm2</code> to the next form.</p>\n\n<p>The code in <code>UserForm1</code>, the initial form shown, the code on the command button would look like this:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim i As Integer\n\n    For i = 0 To Me.ListBox1.ListCount - 1\n        If Me.ListBox1.Selected(i) = True Then\n            UserForm2.ListBox1.AddItem Me.ListBox1.List(i)\n        End If\n    Next i\n\n    UserForm2.Show\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 4756071, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/RcAh4.jpg?s=128&g=1", "display_name": "PrincessPinkBunnyPants", "link": "https://stackoverflow.com/users/4756071/princesspinkbunnypants"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3246, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429046438, "creation_date": 1429039348, "last_edit_date": 1531164843, "question_id": 29635741, "link": "https://stackoverflow.com/questions/29635741/excel-vba-move-select-items-from-listbox-to-a-listbox-in-a-differnt-form-that-wi", "title": "Excel VBA move select items from listbox to a listbox in a differnt form that will be another popup userform", "body": "<p>i have a workbook that has a Listbox that people can select multiple rows. i want to take that information once selected to another ListBox in a new form that will pop up once selected.</p>\n\n<p>i found examples that transfer between listboxes in the same userform, but i need help moving them between different Forms.</p>\n\n<p>this code shows how to pass information between two user forms on the same Form. But I need to modify this to move it between two different forms. Like if you click a submit button and another listbox with textboxes pops up.</p>\n\n<pre><code>Option Explicit\n'Move Listbox Items in UserForm\n'code from Dave Peterson\n'posted on www.contextures.com\n\n\n    Private Sub BTN_moveAllLeft_Click()\n\n    Dim iCtr As Long\n\n    For iCtr = 0 To Me.ListBox2.ListCount - 1\n        Me.ListBox1.AddItem Me.ListBox2.List(iCtr)\n    Next iCtr\n\n    Me.ListBox2.Clear\nEnd Sub\n\n\nPrivate Sub BTN_moveAllRight_Click()\n\nDim iCtr As Long\n\nFor iCtr = 0 To Me.ListBox1.ListCount - 1\n    Me.ListBox2.AddItem Me.ListBox1.List(iCtr)\nNext iCtr\n\nMe.ListBox1.Clear\nEnd Sub\n\n\nPrivate Sub BTN_MoveSelectedLeft_Click()\n\nDim iCtr As Long\n\nFor iCtr = 0 To Me.ListBox2.ListCount - 1\n    If Me.ListBox2.Selected(iCtr) = True Then\n        Me.ListBox1.AddItem Me.ListBox2.List(iCtr)\n    End If\nNext iCtr\n\nFor iCtr = Me.ListBox2.ListCount - 1 To 0 Step -1\n    If Me.ListBox2.Selected(iCtr) = True Then\n        Me.ListBox2.RemoveItem iCtr\n    End If\nNext iCtr\n\nEnd Sub\n\n\nPrivate Sub BTN_MoveSelectedRight_Click()\n\nDim iCtr As Long\n\nFor iCtr = 0 To Me.ListBox1.ListCount - 1\n    If Me.ListBox1.Selected(iCtr) = True Then\n        Me.ListBox2.AddItem Me.ListBox1.List(iCtr)\n    End If\nNext iCtr\n\nFor iCtr = Me.ListBox1.ListCount - 1 To 0 Step -1\n    If Me.ListBox1.Selected(iCtr) = True Then\n        Me.ListBox1.RemoveItem iCtr\n    End If\nNext iCtr\n\nEnd Sub\n\nPrivate Sub cmdOK_Click()\nUnload Me\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n\nDim iCtr As Long\n\nWith Me.ListBox1\n    For iCtr = 1 To 10\n        .AddItem \"This is a test\" &amp; iCtr\n    Next iCtr\nEnd With\n\nWith Me.ListBox2\n    For iCtr = 1 To 10\n        .AddItem \"This is a not a test\" &amp; iCtr\n    Next iCtr\nEnd With\n\nMe.ListBox1.MultiSelect = fmMultiSelectMulti\nMe.ListBox2.MultiSelect = fmMultiSelectMulti\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "while-loop", "count"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1429038941, "post_id": 29635147, "comment_id": 47413466, "body": "Can you update your question to give an example of the string that gets returned from the <code>getDirSubParentPath()</code> method please."}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1429039327, "post_id": 29635147, "comment_id": 47413683, "body": "Unfortunately, I don&#180;t have access to it right now (it is on my workstation). But I have updated it with something similar to what I use."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1429039375, "post_id": 29635147, "comment_id": 47413715, "body": "OK, the point I was getting at anyway - was to make sure that the string being returned ends with a &quot;\\&quot; so that it&#39;s a valid file path for the <code>Dir()</code> function."}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1429039599, "post_id": 29635147, "comment_id": 47413837, "body": "Updated the function to the one I use."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1429040681, "post_id": 29635147, "comment_id": 47414396, "body": "Also, you&#39;re not using the <code>.FileExists()</code> method anywhere? You&#39;re using <code>Len(Dir())</code> which is a different thing altogether."}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1429041136, "post_id": 29635147, "comment_id": 47414663, "body": "It is in the rest of the code.. I can update it if you want :)"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1429041528, "post_id": 29635147, "comment_id": 47414868, "body": "If you replace those <code>Len(Dir())</code> statements with the <code>.FileExists()</code> method - you will probably solve your own problem ;)"}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1429047308, "post_id": 29635147, "comment_id": 47417863, "body": "@SOofWXLS I have tried another loop that works when I am saving the files (in another sub). However, in this sub it doesn&#180;t work. <code>FileExists(MyFilePath)</code> is apparently &quot;False&quot; when I use that loop (it jumps to the Else-statement), however, it can return the correct name of the file in <code>MsgBox</code>. I am pretty lost, think I tried the most."}], "answers": [{"tags": [], "owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "is_accepted": true, "score": 0, "last_activity_date": 1429128746, "creation_date": 1429128746, "answer_id": 29659967, "question_id": 29635147, "link": "https://stackoverflow.com/questions/29635147/how-to-add-an-incremental-count-version-to-a-string-file-in-excel-vba/29659967#29659967", "title": "How to add an incremental count (version) to a string (file) in Excel/VBA?", "body": "<p>I finally manage to create a solution that seems viable. However, the code could use some cleaning up :) But it gets the job done.<br>\nSo basically, I am having some issues with the loop. It will return a file named W16-0 (which should actual just be W16). It should only add the \"-X\" if W16 is found. So the incremental order should be W16, W16-1, W16-2, etc.<br>\nWhat I am doing is that I try to locate if there is a W16-0 and then replace it with W16. Furthermore, it seems like the loop will give me one higher than the amount of files I have. So that is where I also got an error. So if I had a W16-4, it would ask the macro to find and open a file named W16-5, which would obviously not exist.<br>\nIf somebody could help me clean up the code, I would be really thankful!</p>\n\n<pre><code>Sub RemoveCommasDoubleQ()\n'\n'    Enable a reference to 'Microsft Scripting Runtime'\n'    under VBA menu option Tools &gt; References\n\nDim week, UserName As String\nDim MyFile, MyFilePath As String\nDim version As Integer\n\nDim fso As Object 'scripting.filesystemobject\nSet fso = CreateObject(\"scripting.filesystemobject\")\n\n' Current week, XX\nweek = Format(Date, \"ww\")\n' Username, e.g. niclas.madsen\nUserName = Environ$(\"UserName\")\n' Initials, first letter of last and surname to caps\n' e.g. niclas.madsen would be NM\nUserName = UCase(Left(UserName, 1) &amp; Mid(UserName, InStr(UserName, \".\") + 1, 1))\n\n' fix filename for saving purpose\nMyFile = Replace(Replace(\"SupplierOrganization_W\", \"\", \"\"), \".\", \"_\") _\n            &amp; \"\" _\n            &amp; week _\n            &amp; \" \" _\n            &amp; UserName _\n            &amp; \".csv\"\n    'SupplierOrganization_WXX NM\n\n'MyFilePath = ThisWorkbook.Path &amp; \"\\CSV\\Parent\\\" &amp; MyFile\nMyFilePath = getDirSubParentPath &amp; MyFile\n\nDebug.Print MyFilePath\nDebug.Print \"BEFORE LOOP\"\n'version = 1\n\nDo While Len(Dir(MyFilePath)) &lt;&gt; 0\n     '// If it does, then append a _000 to the name\n     '// Change _000 to suit your requirement\n    MyFilePath = getDirSubParentPath &amp; \"SupplierOrganization_W\" &amp; week &amp; \"-\" &amp; version &amp; \" \" &amp; UserName &amp; \".csv\"\n\n     '// Increment the counter\n    version = version + 1\n\n     '// and go around again\n\n    If MyFilePath = getDirSubParentPath &amp; \"SupplierOrganization_W\" &amp; week &amp; \"-0\" &amp; \" \" &amp; UserName &amp; \".csv\" Then\n       MyFilePath = getDirSubParentPath &amp; \"SupplierOrganization_W\" &amp; week &amp; \" \" &amp; UserName &amp; \".csv\"\n       Debug.Print MyFilePath\n       Debug.Print \"IF LOOP\"\n    End If\nLoop\nDebug.Print MyFilePath\nDebug.Print \"LOOP\"\n\nIf fso.FileExists(getDirSubParentPath &amp; \"SupplierOrganization_W\" &amp; week &amp; \"-\" &amp; version &amp; \" \" &amp; UserName &amp; \".csv\") = False Then\n    MyFilePath = getDirSubParentPath &amp; \"SupplierOrganization_W\" &amp; week &amp; \"-\" &amp; version - 2 &amp; \" \" &amp; UserName &amp; \".csv\"\n    MsgBox getDirSubParentPath &amp; \"SupplierOrganization_W\" &amp; week &amp; \"-\" &amp; version &amp; \" \" &amp; UserName &amp; \".csv\"\nEnd If\n\nfileName = fso.GetFileName(MyFilePath)\nDebug.Print fileName\n\nIf MyFilePath = getDirSubParentPath &amp; \"SupplierOrganization_W\" &amp; week &amp; \"-0\" &amp; \" \" &amp; UserName &amp; \".csv\" Then\n   MyFilePath = getDirSubParentPath &amp; \"SupplierOrganization_W\" &amp; week &amp; \" \" &amp; UserName &amp; \".csv\"\n   Debug.Print MyFilePath\n   Debug.Print \"her it should be 0\"\nEnd If\n\nIf MyFilePath = getDirSubParentPath &amp; \"SupplierOrganization_W\" &amp; week &amp; \"-\" &amp; \" \" &amp; UserName &amp; \".csv\" Then\n   MyFilePath = getDirSubParentPath &amp; \"SupplierOrganization_W\" &amp; week &amp; \"-\" &amp; version &amp; \" \" &amp; UserName &amp; \".csv\"\nEnd If\n\n\n\nDebug.Print \"HER ER VI\"\nfileName = fso.GetFileName(MyFilePath)\nDebug.Print fileName\n\n\nDim tmpFile, tmpFilePath As String\ntmpFile = getDirSubParentPath &amp; \"tmp_file.txt\"\n\nDim tmpString As String\n\nDebug.Print \"------\"\nDebug.Print MyFilePath\n\nIf fso.FileExists(getDirSubParentPath &amp; \"SupplierOrganization_W\" &amp; week &amp; \"-0\" &amp; \" \" &amp; UserName &amp; \".csv\") = True Then\n   MsgBox \"Found the W-0\"\n   MyFilePath = getDirSubParentPath &amp; \"SupplierOrganization_W\" &amp; week &amp; \" \" &amp; UserName &amp; \".csv\"\nEnd If\n\nDebug.Print \"Found 0?\"\nDebug.Print MyFilePath\n\n\nIf fso.FileExists(MyFilePath) = True Then\n    Application.ScreenUpdating = False\n    Open MyFilePath For Input As #1\n    Open tmpFile For Output As #2\n    tmpString = Input(LOF(1), 1) 'read the entire file\n    tmpString = Replace(tmpString, (Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) _\n    &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) _\n    &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) _\n    &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) _\n    &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) _\n    &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) _\n    &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) _\n    &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) _\n    &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) _\n    &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) _\n    &amp; Chr(34)), \"\") 'eliminate double quotation and commas in the first line with UTF-8\n    Print #2, tmpString 'output result\n    Close #1\n    Close #2\n    fso.DeleteFile (MyFilePath) 'delete original file\n    fso.CopyFile tmpFile, MyFilePath, True 'rename temp file\n    fso.DeleteFile (tmpFile) 'delete temp file\n    Application.ScreenUpdating = True\n    MsgBox \"Finished processing file\", vbInformation, \"Done!\"\nElse\n    MsgBox \"Cannot locate the file : \" &amp; MyFile, vbCritical, \"Error\"\nEnd If\nSet fso = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 29659967, "answer_count": 1, "score": 0, "last_activity_date": 1429128746, "creation_date": 1429037342, "last_edit_date": 1429041658, "question_id": 29635147, "link": "https://stackoverflow.com/questions/29635147/how-to-add-an-incremental-count-version-to-a-string-file-in-excel-vba", "title": "How to add an incremental count (version) to a string (file) in Excel/VBA?", "body": "<p>I have tried a lot of different things, and it seems like I cannot get it to work. So basically, this is a small piece of my complete code.<br>\nI am using <code>Microsoft Scripting Runtime</code> to save the file, using the FileExists() to check if the file actually exist before saving.<br>\nThis is working fine if I remove the IF-statement/Loop.<br>\nHowever, now it feels like <code>FileExists</code> won\u00b4t find the string, <code>MyFilePath</code>, when I run it with the IF/Loop. (getdirsubparentpath is a function)</p>\n\n<pre><code>Dim week, UserName As String\nDim MyFile, MyFilePath As String\nDim version As Integer\n\n\n' Current week, XX\nweek = Format(Date, \"ww\")\n' Username, e.g. niclas.madsen\nUserName = Environ$(\"UserName\")\n' Initials, first letter of last and surname to caps\n' e.g. niclas.madsen would be NM\nUserName = UCase(Left(UserName, 1) &amp; Mid(UserName, InStr(UserName, \".\") + 1, 1))\n\n' fix filename for saving purpose\nMyFile = Replace(Replace(\"SupplierOrganization_W\", \"\", \"\"), \".\", \"_\") _\n        &amp; \"\" _\n        &amp; week _\n        &amp; \" \" _\n        &amp; UserName _\n        &amp; \".csv\"\n'SupplierOrganization_WXX NM\n\nMyFilePath = getDirSubParentPath &amp; MyFile\n\n' Look for the MyFilePath, if it exists then\n' Add \"-1\" after the week number, if 1 exists, add 2, etc.\nIf Len(Dir(MyFilePath)) &lt;&gt; 0 Then\nversion = 0\nDo\nversion = version + 1\nMyFilePath = Dir(getDirSubParentPath &amp; \"SupplierOrganization_W\" &amp; week &amp; \"-\" &amp; version &amp; \" \" &amp; UserName &amp; \".csv\")\nLoop Until Len(Dir(MyFilePath)) &lt; 0\nEnd If\n\nDim tmpFile, tmpFilePath As String\ntmpFile = getDirSubParentPath &amp; \"tmp_file.txt\"\n\n\nDim tmpString As String\n'Dim fso As New FileSystemObject\n\n\nDim fso As Object 'scripting.filesystemobject\nSet fso = CreateObject(\"scripting.filesystemobject\")\n\nIf fso.FileExists(MyFilePath) = True Then\n    Application.ScreenUpdating = False\n    Open MyFilePath For Input As #1\n    Open tmpFile For Output As #2\n    tmpString = Input(LOF(1), 1) 'read the entire file\n    tmpString = Replace(tmpString, (Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) _\n    &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) _\n    &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) _\n    &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) _\n    &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) _\n    &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) _\n    &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) _\n    &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) _\n    &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) _\n    &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) &amp; Chr(34) &amp; Chr(44) &amp; Chr(34) _\n    &amp; Chr(34)), \"\") 'eliminate double quotation and commas in the first line with UTF-8\n    Print #2, tmpString 'output result\n    Close #1\n    Close #2\n    fso.DeleteFile (MyFilePath) 'delete original file\n    fso.CopyFile tmpFile, MyFilePath, True 'rename temp file\n    fso.DeleteFile (tmpFile) 'delete temp file\n    Application.ScreenUpdating = True\n    MsgBox \"Finished processing file\", vbInformation, \"Done!\"\nElse\n    MsgBox \"Cannot locate the file : \" &amp; MyFilePath, vbCritical, \"Error\"\nEnd If\nSet fso = Nothing\nEnd Sub\n\n\n\n\n' Get Parent Sub Directory Path\nFunction getDirSubParentPath()\ngetDirSubParentPath = ThisWorkbook.Path &amp; Application.PathSeparator &amp; \"CSV\" &amp; Application.PathSeparator &amp; \"Parent\" &amp; Application.PathSeparator\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "function", "excel"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1429031941, "post_id": 29633517, "comment_id": 47409486, "body": "How DX Code should look like?"}, {"owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "edited": false, "score": 3, "creation_date": 1429032064, "post_id": 29633517, "comment_id": 47409564, "body": "your function name &quot;IsAlpha&quot; .. your exit assignment: &quot;IsLetter&quot; .. that won&#39;t work well .."}, {"owner": {"reputation": 137, "user_id": 4724127, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1682dac646466b000de6d9c96ed9092f?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac Rothstein", "link": "https://stackoverflow.com/users/4724127/isaac-rothstein"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1429032592, "post_id": 29633517, "comment_id": 47409851, "body": "@MaciejLos Char1 = Alpha Char2 = Numeric Additional Characters = Alpha+Numeric"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1429032690, "post_id": 29633517, "comment_id": 47409906, "body": "@IsaacRothstein, and the length?"}], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 4724127, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1682dac646466b000de6d9c96ed9092f?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac Rothstein", "link": "https://stackoverflow.com/users/4724127/isaac-rothstein"}, "edited": false, "score": 0, "creation_date": 1429032461, "post_id": 29633680, "comment_id": 47409776, "body": "Heh, that&#39;s what I get for copying code that I don&#39;t know how to reverse engineer."}], "tags": [], "owner": {"reputation": 2651, "user_id": 4059942, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/2bmaq.jpg?s=128&g=1", "display_name": "Saagar Elias Jacky", "link": "https://stackoverflow.com/users/4059942/saagar-elias-jacky"}, "is_accepted": false, "score": 4, "last_activity_date": 1429032242, "creation_date": 1429032242, "answer_id": 29633680, "question_id": 29633517, "link": "https://stackoverflow.com/questions/29633517/how-can-i-check-if-a-string-only-contains-letters/29633680#29633680", "title": "How can I check if a string only contains letters?", "body": "<p>Try this for <code>IsAlpha</code></p>\n\n<pre><code>Public Function IsAlpha(strValue As String) As Boolean\nDim intPos As Integer\n\n    For intPos = 1 To Len(strValue)\n        Select Case Asc(Mid(strValue, intPos, 1))\n            Case 65 To 90, 97 To 122\n                IsAlpha = True\n            Case Else\n                IsAlpha = False\n                Exit For\n        End Select\n    Next\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 137, "user_id": 4724127, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1682dac646466b000de6d9c96ed9092f?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac Rothstein", "link": "https://stackoverflow.com/users/4724127/isaac-rothstein"}, "edited": false, "score": 0, "creation_date": 1429032489, "post_id": 29633694, "comment_id": 47409787, "body": "Because at present, I don&#39;t know what the difference is."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 137, "user_id": 4724127, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1682dac646466b000de6d9c96ed9092f?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac Rothstein", "link": "https://stackoverflow.com/users/4724127/isaac-rothstein"}, "edited": false, "score": 3, "creation_date": 1429032593, "post_id": 29633694, "comment_id": 47409854, "body": "Regular Expressions are using in nearly every programming language - it&#39;s a way of &quot;pattern matching&quot; and is designed to be used exactly for this purpose. VBA natively offers <b>very</b> basic regular expressions, but you can set a reference and get more complex if you wish. A quick google should get you started, there&#39;s plenty out there on it"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 14, "last_activity_date": 1429032502, "last_edit_date": 1429032502, "creation_date": 1429032302, "answer_id": 29633694, "question_id": 29633517, "link": "https://stackoverflow.com/questions/29633517/how-can-i-check-if-a-string-only-contains-letters/29633694#29633694", "title": "How can I check if a string only contains letters?", "body": "<p>Why don't you use regular expressions instead? Then there's no loops involved:</p>\n\n<pre><code>Public Function IsAlpha(strValue As String) As Boolean\n    IsAlpha = strValue Like WorksheetFunction.Rept(\"[a-zA-Z]\", Len(strValue))\nEnd Function\n</code></pre>\n\n<p>Also, when you create a User-Defined Function (UDF) you need to ensure that the return value is assigned to the name of the actual function, in this case <code>IsAlpha</code> - not <code>IsLetter</code> otherwise the value will never be passed back.</p>\n"}, {"tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": false, "score": 1, "last_activity_date": 1429056001, "creation_date": 1429056001, "answer_id": 29639412, "question_id": 29633517, "link": "https://stackoverflow.com/questions/29633517/how-can-i-check-if-a-string-only-contains-letters/29639412#29639412", "title": "How can I check if a string only contains letters?", "body": "<p><code>Left(Me.TxtDxCode.Text, 2)</code> returns the first two characters of the string. So, if Me.TxtDxCode.Text was 7ZABC, this expression would return \"7Z\". This would cause the <code>IsAlpha</code> test to fail.</p>\n\n<p>As you want to examine just the 2nd character, use Mid$ instead:</p>\n\n<p><code>If IsAlpha(Mid$(Me.TxtDxCode.Text, 2, 1)) Then</code></p>\n\n<p>This will return \"Z\" and the <code>IsAlpha</code> test should now succeed</p>\n\n<p>(The string versions Left$, Mid$ etc are slightly faster than the variant versions Left, Mid etc - see <a href=\"http://www.aivosto.com/vbtips/stringopt.html\" rel=\"nofollow\">here</a>)</p>\n"}, {"tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": false, "score": 4, "last_activity_date": 1588218615, "creation_date": 1588218615, "answer_id": 61515624, "question_id": 29633517, "link": "https://stackoverflow.com/questions/29633517/how-can-i-check-if-a-string-only-contains-letters/61515624#61515624", "title": "How can I check if a string only contains letters?", "body": "<p>The most direct, concise, and performant way to check if a string contains only alpha characters is with this function:</p>\n\n<pre><code>Function IsAlpha(s) As Boolean\n    IsAlpha = Len(s) And Not s Like \"*[!a-zA-Z]*\"\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 4724127, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1682dac646466b000de6d9c96ed9092f?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac Rothstein", "link": "https://stackoverflow.com/users/4724127/isaac-rothstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38359, "favorite_count": 1, "answer_count": 4, "score": 9, "last_activity_date": 1588218615, "creation_date": 1429031758, "last_edit_date": 1531164843, "question_id": 29633517, "link": "https://stackoverflow.com/questions/29633517/how-can-i-check-if-a-string-only-contains-letters", "title": "How can I check if a string only contains letters?", "body": "<p>I'm using a function that allows me to review a string of text and evaluate if it is composed of letters.  It is housed in a module called \"General\".  The general module only exists to house public functions and variables.  Function code is listed below:</p>\n\n<pre><code>Public Function IsAlpha(strValue As String) As Boolean\nDim intPos As Integer\n\n    For intPos = 1 To Len(strValue)\n        Select Case Asc(Mid(strValue, intPos, 1))\n            Case 65 To 90, 97 To 122\n                IsLetter = True\n            Case Else\n                IsLetter = False\n                Exit For\n        End Select\n    Next\nEnd Function  \n</code></pre>\n\n<p>Next I have two \"if\" routines that evaluate the first 2 characters of a textbox in my userform.  The first routine asks if the 1st character is numeric and the second routine asks if the 2nd character is alpha.  Currently, the second \"if\" routine is ejecting me from the sub-routine when IsAlpha tests True, rather than generating the MsgBox.  Is the IsAlpha function not being called correctly?</p>\n\n<p>If routines code listed below:</p>\n\n<pre><code>Private Sub CmdMap_Click()\n\n    With TxtDxCode\n        If IsNumeric(Left(Me.TxtDxCode.Text, 1)) Then\n            MsgBox \"Incorrect DX Code format was entered. \", vbExclamation, \"DX Code Entry\"\n            TxtDxCode.Value = \"\"\n            TxtDxCode.SetFocus\n            Exit Sub\n        End If\n\n        If IsAlpha(Left(Me.TxtDxCode.Text, 2)) Then\n            MsgBox \"Incorrect DX Code format was entered. \", vbExclamation, \"DX Code Entry\"\n            TxtDxCode.Value = \"\"\n            TxtDxCode.SetFocus\n            Exit Sub\n        End If\n    End With\n</code></pre>\n"}, {"tags": ["vba", "excel-2010", "copy-paste"], "answers": [{"comments": [{"owner": {"reputation": 422, "user_id": 3376305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda141a8fc733851347199b3073c395f?s=128&d=identicon&r=PG&f=1", "display_name": "tzvi", "link": "https://stackoverflow.com/users/3376305/tzvi"}, "edited": false, "score": 0, "creation_date": 1429052378, "post_id": 29634752, "comment_id": 47419677, "body": "I appreciate you spending the time to research my issue. The line of code you are referring to does not affect the &#39;copy&#39; The comment above the line you mentioned explains that section of code is counting the amount of separate areas that are visible. If there are more than 8192 an error message is shown . Otherwise &#39;ListObject.Range.Copy&#39; is called which seems to copy the entire Range. It only is applied to the visible ones though. I&#39;ll post the current version of my code above."}, {"owner": {"reputation": 422, "user_id": 3376305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda141a8fc733851347199b3073c395f?s=128&d=identicon&r=PG&f=1", "display_name": "tzvi", "link": "https://stackoverflow.com/users/3376305/tzvi"}, "edited": false, "score": 0, "creation_date": 1429117490, "post_id": 29634752, "comment_id": 47452488, "body": "You have properly read my code. visibleOnly is a <b>parameter</b> in the first line. I added the  If statement later on to bypass the original copy command if <code>visibleOnly == false</code>. I have been asking for help in implementing the proper method of accomplishing this. Note the abnormal <code>MsgBox</code> there and <code>ActiveSheet.UsedRange.Copy</code> will not be limited to the Table, and will also ignore hidden columns. I will edit the code above to clarify."}, {"owner": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "reply_to_user": {"reputation": 422, "user_id": 3376305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda141a8fc733851347199b3073c395f?s=128&d=identicon&r=PG&f=1", "display_name": "tzvi", "link": "https://stackoverflow.com/users/3376305/tzvi"}, "edited": false, "score": 0, "creation_date": 1429120722, "post_id": 29634752, "comment_id": 47454472, "body": "Try out the code I updated my answer with. It worked for me with multiple tables with varying complexity and a wide range of hidden/visible conditions. I only tried it copying to a sheet within the same workbook, so this is only troubleshooting the hidden/visible data issue"}, {"owner": {"reputation": 422, "user_id": 3376305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda141a8fc733851347199b3073c395f?s=128&d=identicon&r=PG&f=1", "display_name": "tzvi", "link": "https://stackoverflow.com/users/3376305/tzvi"}, "edited": false, "score": 0, "creation_date": 1429122384, "post_id": 29634752, "comment_id": 47455541, "body": "You are absolutely right. The hidden cells had been copied all along. I guess I had been believing the comment on MS site (see link in original post) that only visible cells were copied, which was corroborated in those columns not being visible in the new workbook. In actuality, they existed, but were still hidden. In a csv! Regarding the visiblrOnly, I would be calling this Sub from other subs which would set those arguments as needed. I&#39;ll edit the post accordingly."}], "tags": [], "owner": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "is_accepted": true, "score": 2, "last_activity_date": 1429120381, "last_edit_date": 1429120381, "creation_date": 1429035889, "answer_id": 29634752, "question_id": 29633394, "link": "https://stackoverflow.com/questions/29633394/excel-vba-how-to-copy-entire-range-including-hidden-columns/29634752#29634752", "title": "Excel VBA: How to copy entire range including hidden columns", "body": "<p>Updating now that example code is available: </p>\n\n<p>Ok looking at the code you posted, I see a bool named visibleOnly but I don't see where it gets set. Your ability for the logic to reach UsedRange.Copy entirely depends on that being set to false. The comment above ACell.ListObject.Range.Copy indicates that if you reach that statement you are only copying visible cells. In order to copy the hidden cells, visibleOnly would need to be set to false (bypassing the rest of the CCount stuff). So I would be interested in knowing how that bool is set and checking to see what its value is set to when you are running your code.</p>\n\n<p>Update 2: </p>\n\n<p>You need to set the value of your visibleOnly boolean somehow. </p>\n\n<p>here's some code I edited that creates a message box that allows the user to say \"yes\" or \"no\" to \"do you want to copy hidden data too?\" that answer will dictate the value of visibleOnly which in turn dictates which flow they enter. </p>\n\n<p>In addition to that, your assumption that ACell.ListObject.Range.Copy would only copy visible cells appears to have been incorrect. Instead that is being replaced with the specialcell type for visible cells. </p>\n\n<p>Finally, vbYesNo does not actually return a boolean value. Instead it returns vbYes or vbNo which are vb type enumerators (value 6 and 7 respectively). So setting a bool to the value of a vbYesNo will always return True (as a value exists and essentially it just evaluates iferror). </p>\n\n<p>So I changed that bit as well so it now properly checks the Yes/No condition on your userchoice (which is no longer a bool). </p>\n\n<p>here's the code: </p>\n\n<pre><code>Dim ACell, Data As Range\nDim CCount As Long\nDim ActiveCellInTable As Boolean\nDim CopyFormats, retrySave As Variant\nDim sheetName, user, defaultFileName, fileSaveName As String\n\n\n'Check to see if the worksheet or workbook is protected. TODO this may not be necessary anymore\nIf ActiveWorkbook.ProtectStructure = True Or ActiveSheet.ProtectContents = True Then\n    MsgBox \"This macro will not work when the workbook or worksheet is write-protected.\"\n        Exit Sub\n    End If\n\n    'Set a reference to the ActiveCell. You can always use ACell to\n    'point to this cell, no matter where you are in the workbook.\n    Set ACell = ActiveCell\n\n    'Test to see if ACell is in a table or list. Note that by using ACell.ListObject, you\n    'do not need to know the name of the table to work with it.\n    On Error Resume Next\n    ActiveCellInTable = (ACell.ListObject.Name &lt;&gt; \"\")\n    On Error GoTo 0\n\n    'TODO here we will select the fields to export\n    'If the cell is in a list or table run the code.\n    If ActiveCellInTable = True Then\n        CopyHidden = MsgBox(\"Would you like to copy hidden data also?\", vbYesNo, \"Copy Hidden Data?\")\n        If CopyHidden = vbYes Then\n            visibleOnly = False\n        ElseIf CopyHidden = vbNo Then\n            visibleOnly = True\n        End If\n\n        With Application\n            .ScreenUpdating = False\n            .EnableEvents = False\n        End With\n        If visibleOnly = True Then\n            'Test if there are more than 8192 separate areas. Excel only supports\n            'a maximum of 8,192 non-contiguous areas through VBA macros and manual.\n            On Error Resume Next\n            With ACell.ListObject.ListColumns(1).Range 'TODO remove this \"with\"\n                CCount = .SpecialCells(xlCellTypeVisible).Areas(1).Cells.Count\n            End With\n            On Error GoTo 0\n\n            If CCount = 0 Then\n                MsgBox \"There are more than 8192 individual areas, so it is not possible to \" &amp; _\n                       \"copy the visible data to a new worksheet. Tip: Sort your \" &amp; _\n                       \"data before you apply the filter and try this macro again.\", _\n                       vbOKOnly, \"Copy to new worksheet\"\n                Exit Sub\n            Else\n                'Copy the visible cells.\n                ACell.ListObject.Range.SpecialCells(xlCellTypeVisible).Copy\n                ' Only visible cells within the table are now in clipboard\n            End If\n        Else\n            'The user indicated he wants to copy hidden columns too.\n            MsgBox (\"You wanted to copy hidden columns too?\")\n            ACell.ListObject.Range.Copy\n            ' All table data cells including hidden are now in clipboard\n        End If\n    Else\n'        MsgBox \"Select a cell in your list or table before you run the macro.\", _\n'           vbOKOnly, \"Copy to new worksheet\"\n        userChoice = MsgBox(\"A Table/Table protion is not selected. Do you want to export the entire page?\", vbYesNo)\n        If userChoice = vbNo Then Exit Sub\n        ActiveSheet.UsedRange.Copy\n        'Entire sheet range is now in clipboard (this is not always accurate)\n        'Exit Sub\n    End If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 422, "user_id": 3376305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda141a8fc733851347199b3073c395f?s=128&d=identicon&r=PG&f=1", "display_name": "tzvi", "link": "https://stackoverflow.com/users/3376305/tzvi"}, "edited": false, "score": 0, "creation_date": 1429121249, "post_id": 29641102, "comment_id": 47454800, "body": "Thank you for your answer. I will try out your code as soon as I get a chance to."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 2, "last_activity_date": 1429068496, "creation_date": 1429068496, "answer_id": 29641102, "question_id": 29633394, "link": "https://stackoverflow.com/questions/29633394/excel-vba-how-to-copy-entire-range-including-hidden-columns/29641102#29641102", "title": "Excel VBA: How to copy entire range including hidden columns", "body": "<p>Assign the Value of the range to your target range instead of using the .Copy method:</p>\n\n<pre><code>Sub ExportCSV(source As Range, filename As String)\n\n    Dim temp As Workbook\n    Set temp = Application.Workbooks.Add\n\n    Dim sheet As Worksheet\n    Set sheet = temp.Worksheets(1)\n\n    Dim target As Range\n    'Size the target range to the same dimension as the source range.\n    Set target = sheet.Range(sheet.Cells(1, 1), _\n                 sheet.Cells(source.Rows.Count, source.Columns.Count))\n    target.Value = source.Value\n\n    temp.SaveAs filename, xlCSV\n    temp.Close False\n\nEnd Sub\n</code></pre>\n\n<p>This also has the benefit of not nuking whatever the user might have on the clipboard.</p>\n"}], "owner": {"reputation": 422, "user_id": 3376305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda141a8fc733851347199b3073c395f?s=128&d=identicon&r=PG&f=1", "display_name": "tzvi", "link": "https://stackoverflow.com/users/3376305/tzvi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13506, "favorite_count": 0, "accepted_answer_id": 29634752, "answer_count": 2, "score": 1, "last_activity_date": 1429122686, "creation_date": 1429031301, "last_edit_date": 1429122686, "question_id": 29633394, "link": "https://stackoverflow.com/questions/29633394/excel-vba-how-to-copy-entire-range-including-hidden-columns", "title": "Excel VBA: How to copy entire range including hidden columns", "body": "<p>I'm looking for a VBA Macro to export data to a csv. I found <a href=\"https://msdn.microsoft.com/en-us/library/dd637097%28v=office.11%29.aspx#odc_office2007_taWorkingwithListsTablesPart1_CopyingTableListtoNewWorksheetCurrentWorkbook\" rel=\"nofollow\">this code</a>\nwhich after some tweaking does a great job. However, when copying from a range, Excel seems to ignore hidden columns while I want the CSV to contain all the columns. Has anyone discovered concise way to code this?</p>\n\n<p>Here is the code I have so far:</p>\n\n<pre><code>Sub ExportListOrTable(Optional newBook As Boolean, Optional willNameSheet As Boolean, Optional asCSV As Boolean, Optional visibleOnly As Boolean)\n'Sub CopyListOrTable2NewWorksheet()\n'Works in Excel 2003 and Excel 2007. Only copies visible data.\n'code source: https://msdn.microsoft.com/en-us/library/dd637097%28v=office.11%29.aspx\n'improved by: Tzvi\n'   - replaced new worksheet with new workbook\n\n'params:\n'   newBook: To create a new new sheet in the current workbook or (default) in a new workbook\n'   willNameSheet: To offer the user to name the sheet or (default) leave the default names\n'   asCSV: not implemented - will always save as CSV\n'   visibleOnly: to filter out any hidden columns - default false\n\n'TODO\n'   -add parameter list for following options:\n'   - if table was not selected, copy activesheet.usedRange\n'   - optional saveFileType\n'   -\n\n\nDim New_Ws As Worksheet\nDim ACell, Data As Range\nDim CCount As Long\nDim ActiveCellInTable As Boolean\nDim CopyFormats, retrySave As Variant\nDim sheetName, user, defaultFileName, fileSaveName As String\nDim userChoice As Boolean\n\n'Check to see if the worksheet or workbook is protected. TODO this may not be necessary anymore\nIf ActiveWorkbook.ProtectStructure = True Or ActiveSheet.ProtectContents = True Then\n    MsgBox \"This macro will not work when the workbook or worksheet is write-protected.\"\n        Exit Sub\n    End If\n\n    'Set a reference to the ActiveCell. You can always use ACell to\n    'point to this cell, no matter where you are in the workbook.\n    Set ACell = activeCell\n\n    'Test to see if ACell is in a table or list. Note that by using ACell.ListObject, you\n    'do not need to know the name of the table to work with it.\n    On Error Resume Next\n    ActiveCellInTable = (ACell.ListObject.Name &lt;&gt; \"\")\n    On Error GoTo 0\n\n    'TODO here we will select the fields to export\n    'If the cell is in a list or table run the code.\n    If ActiveCellInTable = True Then\n        With Application\n            .ScreenUpdating = False\n            .EnableEvents = False\n        End With\n        If visibleOnly = True Then\n            'Test if there are more than 8192 separate areas. Excel only supports\n            'a maximum of 8,192 non-contiguous areas through VBA macros and manual.\n            On Error Resume Next\n            With ACell.ListObject.ListColumns(1).Range 'TODO remove this \"with\"\n                CCount = .SpecialCells(xlCellTypeVisible).Areas(1).Cells.Count\n            End With\n            On Error GoTo 0\n\n            If CCount = 0 Then\n                MsgBox \"There are more than 8192 individual areas, so it is not possible to \" &amp; _\n                       \"copy the visible data to a new worksheet. Tip: Sort your \" &amp; _\n                       \"data before you apply the filter and try this macro again.\", _\n                       vbOKOnly, \"Copy to new worksheet\"\n                Exit Sub\n            Else\n                'Copy the visible cells.\n                ACell.ListObject.Range.Copy\n            End If\n        Else\n            'The user indicated he wants to copy hidden columns too.\n            '**********************************************************\n            'HOW DO I PROPERLY IMPLEMENT THIS PART?\n            '**********************************************************\n\n            MsgBox (\"You wanted to copy hidden columns too?\")\n            ActiveSheet.UsedRange.Copy\n        End If\n    Else\n'        MsgBox \"Select a cell in your list or table before you run the macro.\", _\n'           vbOKOnly, \"Copy to new worksheet\"\n        userChoice = MsgBox(\"A Table/Table protion is not selected. Do you want to export the entire page?\", vbYesNo)\n        If userChoice = False Then Exit Sub\n        ActiveSheet.UsedRange.Copy\n        'Exit Sub\n    End If\n            'Add a new Worksheet/WorkBook.\n            If newBook = False Then\n                Set New_Ws = Worksheets.Add(after:=Sheets(ActiveSheet.Index))\n            Else\n                Set New_Ws = Workbooks.Add(xlWBATWorksheet).Worksheets(1)\n            End If\n\n            'Prompt the user for the worksheet name.\n            If willNameSheet = True Then\n                sheetName = InputBox(\"What is the name of the new worksheet?\", _\n                                     \"Name the New Sheet\")\n\n                On Error Resume Next\n                New_Ws.Name = sheetName\n                If Err.Number &gt; 0 Then\n                    MsgBox \"Change the name of sheet : \" &amp; New_Ws.Name &amp; _\n                         \" manually after the macro is ready. The sheet name\" &amp; _\n                         \" you typed in already exists or you use characters\" &amp; _\n                         \" that are not allowed in a sheet name.\"\n                    Err.Clear\n                End If\n                On Error GoTo 0\n            End If\n\n            'Paste the data into the new worksheet.\n            With New_Ws.Range(\"A1\")\n                .PasteSpecial xlPasteColumnWidths\n                .PasteSpecial xlPasteValuesAndNumberFormats\n                .Select\n                Application.CutCopyMode = False\n            End With\n\n            Application.ScreenUpdating = False\n\n            'If you did not create a table, you have the option to copy the formats.\n            If ActiveCellInTable = False Then\n                Application.Goto ACell\n                CopyFormats = MsgBox(\"Do you also want to copy the Formatting?\", _\n                                     vbOKCancel + vbExclamation, \"Copy to new worksheet\")\n                If CopyFormats = vbOK Then\n                    ACell.ListObject.Range.Copy\n                    With New_Ws.Range(\"A1\")\n                        .PasteSpecial xlPasteFormats\n                        Application.CutCopyMode = False\n                    End With\n                End If\n            End If\n\n        'Select the new worksheet if it is not active.\n        Application.Goto New_Ws.Range(\"A1\")\n\n        With Application\n            .ScreenUpdating = True\n            .EnableEvents = True\n        End With\n\n        'Now we're ready to save our new file as excel format\n        defaultFileName = ActiveWorkbook.Name\n        user = Environ(\"userprofile\")\n\n'marker getfilename: to return to if we need to look for a new filename\ngetfilename:\n        ChDir user &amp; \"\\Desktop\"\n        fileSaveName = Application.GetSaveAsFilename(defaultFileName &amp; \".csv\", \"Comma Delimited Format (*.csv), *.csv\")\n\n        If fileSaveName &lt;&gt; \"False\" Then\n            'error handling for 'file already exists and the user clicks 'no'\n            On Error Resume Next\n            ActiveWorkbook.SaveAs fileName:=fileSaveName, FileFormat:=xlCSV, ReadOnlyRecommended:=True, CreateBackup:=False, ConflictResolution:=xlUserResolution\n            If Err.Number = 1004 Then\n                'Offer user two options: To try a different filename or cancel the entire export\n                retrySave = MsgBox(Err.Description, vbRetryCancel, \"Error creating file\")\n                If retrySave = vbRetry Then\n                    GoTo getfilename\n                Else\n                    GoTo cancelprocedure\n                End If\n            End If\n            On Error GoTo 0\n        Else\n            GoTo cancelprocedure\n        End If\n\nExit Sub\ncancelprocedure:\n    ActiveWorkbook.Close saveChanges:=False\n    Exit Sub\nEnd Sub\n</code></pre>\n\n<p>Update:</p>\n\n<p>In response to shagans concern. The parameter list on line one is intended to be set by another Macro as such:</p>\n\n<pre><code>Sub ExportVisibleAsCSV\n    Call ExportListOrTable(newBook:=True, willNameSheet:=False, asCSV:=True, visibleOnly:=True)\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "edited": false, "score": 0, "creation_date": 1429031740, "post_id": 29633244, "comment_id": 47409370, "body": "A <code>Do...Loop</code> block would work wonders with your snippet.  Just loop through the rows one by one and when you&#39;ve copied 5 rows, exit the loop."}, {"owner": {"reputation": 107, "user_id": 1783135, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/60e4da7e8a7bd5c424553aef8ef3bb79?s=128&d=identicon&r=PG", "display_name": "E_L", "link": "https://stackoverflow.com/users/1783135/e-l"}, "reply_to_user": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "edited": false, "score": 0, "creation_date": 1429075607, "post_id": 29633244, "comment_id": 47425709, "body": "How does that look @jbarker2160?  How do I loop through the visible rows?  I know what you mean but I&#39;m struggling to know how to execute it..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1430053852, "post_id": 29633244, "comment_id": 47880212, "body": "a) Your sample code shows the copied results pasted into row 3 of the target worksheet but your sample images show row 5. What is the actual target row? b) Is it necessary to preserve the &#39;whitespace&#39; on the target worksheet&#39;s columns C and E? Is there a possibility that there may be values there that would be overwritten with a block paste?"}, {"owner": {"reputation": 107, "user_id": 1783135, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/60e4da7e8a7bd5c424553aef8ef3bb79?s=128&d=identicon&r=PG", "display_name": "E_L", "link": "https://stackoverflow.com/users/1783135/e-l"}, "edited": false, "score": 0, "creation_date": 1430137296, "post_id": 29633244, "comment_id": 47913845, "body": "Hi @Jeeped.  This is actually for a report at work so I can&#39;t obviously give any of the actual data or the report.  This table, and two others like it, are in the middle of a page of tables and graphs and I cannot change the whitespace etc so a block select, paste, delete type approach wouldn&#39;t work.  Also, I only show the operation for the column F but I would repeat it on column H, and then again on J.  All the copied data will be in same columns (ie. A, B, D, and F) in the new page but not in the same table."}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 1783135, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/60e4da7e8a7bd5c424553aef8ef3bb79?s=128&d=identicon&r=PG", "display_name": "E_L", "link": "https://stackoverflow.com/users/1783135/e-l"}, "edited": false, "score": 0, "creation_date": 1429074692, "post_id": 29634108, "comment_id": 47425419, "body": "This looks good, but its not copying the filtered data... its giving me the top 5 lines, but not the top 5 lines after I&#39;ve filtered for Dave... :-s"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 107, "user_id": 1783135, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/60e4da7e8a7bd5c424553aef8ef3bb79?s=128&d=identicon&r=PG", "display_name": "E_L", "link": "https://stackoverflow.com/users/1783135/e-l"}, "edited": false, "score": 1, "creation_date": 1429109245, "post_id": 29634108, "comment_id": 47446579, "body": "Good point.  I thought they were sorted for some reason in the picture above.  I edited the code so that it only grabs visible rows."}, {"owner": {"reputation": 107, "user_id": 1783135, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/60e4da7e8a7bd5c424553aef8ef3bb79?s=128&d=identicon&r=PG", "display_name": "E_L", "link": "https://stackoverflow.com/users/1783135/e-l"}, "edited": false, "score": 0, "creation_date": 1429394464, "post_id": 29634108, "comment_id": 47580961, "body": "Oooh so close!  Just two things - the headers are proving to be a trouble, particularly because some of them are merged cells.  I&#39;m thinking I should just do away with them, but taking out the 4th line of code &quot;set rng_5&quot; creates problems later in the subroutine.  How do I fix that?  Some sort of &quot;If rng_5 empty, set to first line&quot;?  Secondly, there is some column padding in the copied-to sheet - how do I incorporate that in to the intersect?  FYI, one of the columns I&#39;m copying from, column D, has formulas."}, {"owner": {"reputation": 107, "user_id": 1783135, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/60e4da7e8a7bd5c424553aef8ef3bb79?s=128&d=identicon&r=PG", "display_name": "E_L", "link": "https://stackoverflow.com/users/1783135/e-l"}, "edited": false, "score": 0, "creation_date": 1429680232, "post_id": 29634108, "comment_id": 47706043, "body": "Yo!  @Byron Wall.  Any chance you can help me out here? I&#39;ve been thinking about this a lot and doing a lot of googling searching but I&#39;m just not finding the right info to help me with this.  Can you help me out?"}], "tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": false, "score": 1, "last_activity_date": 1429109190, "last_edit_date": 1429109190, "creation_date": 1429033686, "answer_id": 29634108, "question_id": 29633244, "link": "https://stackoverflow.com/questions/29633244/excel-vba-filter-and-copy-from-top-5-rows-cells/29634108#29634108", "title": "Excel VBA: Filter and copy from top 5 rows/cells", "body": "<p>A quick way to do this is to use <code>Union</code> and <code>Intersect</code> to only copy the cells that you want.  If you are pasting values (or the data is not a formula to start), this works well.  Thinking about it, it builds a range of columns to keep using <code>Union</code> and then <code>Intersect</code> that with the first 5 rows of data with 2 header rows.  The result is a copy of only the data you want with formatting intact.</p>\n\n<p><strong>Edit only process visible rows, grabbing the header, and then the first 5 below the header rows</strong></p>\n\n<pre><code>Sub CopyTopFiveFromSpecificColumns()\n\n    'set up the headers first to keep\n    Dim rng_top5 As Range\n    Set rng_top5 = Range(\"3:4\").EntireRow\n\n    Dim int_index As Integer\n    'start below the headers and keep all the visible cells\n    For Each cell In Intersect( _\n        ActiveSheet.UsedRange.Offset(5), _\n        Range(\"A:A\").SpecialCells(xlCellTypeVisible))\n\n        'add row to keepers\n        Set rng_top5 = Union(rng_top5, cell.EntireRow)\n\n        'track how many items have been stored\n        int_index = int_index + 1\n        If int_index &gt;= 5 Then\n            Exit For\n        End If\n    Next cell\n\n    'copy only certain columns of the keepers\n    Intersect(rng_top5, _\n        Union(Range(\"A:A\"), _\n                Range(\"B:B\"), _\n                Range(\"D:D\"), _\n                Range(\"F:F\"))).Copy\n\n    'using Sheet2 here, you can set to wherever, works if data is not formulas\n    Range(\"Sheet2!A1\").PasteSpecial xlPasteAll\n\n    'if the data contains formulas, use this route\n    'Range(\"Sheet2!A1\").PasteSpecial xlPasteValues\n    'Range(\"Sheet2!A1\").PasteSpecial xlPasteFormats\n\nEnd Sub\n</code></pre>\n\n<p>Here is the result I get from some dummy data set up in the same ranges as the picture above.</p>\n\n<p><strong>Sheet1 with copied range visible</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/6KLmb.png\" alt=\"Sheet1\"></p>\n\n<p><strong>Sheet2 with pasted data</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/ZfjiT.png\" alt=\"Sheet2\"></p>\n"}, {"tags": [], "owner": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "is_accepted": false, "score": 0, "last_activity_date": 1430056715, "creation_date": 1430056715, "answer_id": 29878557, "question_id": 29633244, "link": "https://stackoverflow.com/questions/29633244/excel-vba-filter-and-copy-from-top-5-rows-cells/29878557#29878557", "title": "Excel VBA: Filter and copy from top 5 rows/cells", "body": "<p>The first part of your question, selecting the top5 visible cells, is relatively easy, the copying and pasting is where the trouble are. You see, you cannot paste a range, even if it is not uniform, into non uniform range. So you'll need to write your own Paste function.</p>\n\n<p><strong>Part 1 - Getting the Top5 rows</strong></p>\n\n<p>I used a similar technique to @Byron's. Notice that this is merely a function returning a <code>Range</code> object and accepting a <code>String</code>, which represents your non-uniform range (you can change the parameter type to <code>Range</code> if you wish).</p>\n\n<pre><code>Function GetTop5Range(SourceAddress As String) As Range\n    Dim rngSource As Range\n    Dim rngVisible As Range\n    Dim rngIntersect As Range\n    Dim rngTop5 As Range\n\n    Dim i As Integer\n    Dim cell As Range\n\n    Set rngSource = Range(SourceAddress)\n    Set rngVisible = rngSource.SpecialCells(xlCellTypeVisible).Cells\n    Set rngIntersect = Intersect(rngVisible, rngVisible.Cells(1, 1).EntireColumn)\n\n    i = 1\n    For Each cell In rngIntersect\n        If i = 1 Then\n            Set rngTop5 = cell.EntireRow\n            i = i + 1\n        ElseIf i &gt; 1 And i &lt; 6 Then\n            Set rngTop5 = Union(rngTop5, cell.EntireRow)\n            i = i + 1\n        Else\n            Exit For\n        End If\n    Next cell\n\n    Set GetTop5Range = Intersect(rngTop5, rngVisible)\nEnd Function\n</code></pre>\n\n<p><strong>Part 2 - Creating your own pasting function</strong></p>\n\n<p>Because Excel always pastes your copied range as uniform, you need to do it yourself. This method essentially breaks down your source region to columns and pastes them individually. The method accepts parameter SourceRange of type <code>Range</code> , which is meant to by your Top5 range, and a TopLeftCornerRange of type <code>Range</code>, which represents the target cell of your pasting.</p>\n\n<pre><code>Sub PasteRange(SourceRange As Range, TopLeftCornerRange As Range)\n    Dim rngColumnRange As Range\n\n    Dim cell As Range\n\n    Set rngColumnRange = Intersect(SourceRange, SourceRange.Cells(1, 1).EntireRow)\n\n    For Each cell In rngColumnRange\n        Intersect(SourceRange, cell.EntireColumn).Copy\n        TopLeftCornerRange.Offset(0, cell.Column - 1).PasteSpecial xlPasteValuesAndNumberFormats\n    Next cell\n\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p><strong>Part 3 - Running the procedure</strong></p>\n\n<pre><code>Sub Main()\n    PasteRange GetTop5Range(\"A2:B33,D2:D33\"), Range(\"A35\")\nEnd Sub\n</code></pre>\n\n<p>That's it.</p>\n\n<p>In my project, I had source data in Columns A, B and D like you did and the results are pasted to range beginning at A35.</p>\n\n<p>Result:</p>\n\n<p><img src=\"https://i.stack.imgur.com/Wq9oj.jpg\" alt=\"enter image description here\"></p>\n\n<p>Hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1430119858, "last_edit_date": 1430119858, "creation_date": 1430060190, "answer_id": 29879190, "question_id": 29633244, "link": "https://stackoverflow.com/questions/29633244/excel-vba-filter-and-copy-from-top-5-rows-cells/29879190#29879190", "title": "Excel VBA: Filter and copy from top 5 rows/cells", "body": "<p>Try this:</p>\n\n<pre><code>Sub GetTopFiveRows()\n    Dim table As Range, cl As Range, cnt As Integer\n\n    Set table = Worksheets(\"Sheet1\").Range(\"A2:A10\").SpecialCells(xlCellTypeVisible)\n    cnt = 1\n\n    With Worksheets(\"Sheet2\")\n        For Each cl In table\n            If cnt &lt;= 5 Then\n                .Range(\"A\" &amp; cnt) = cl\n                .Range(\"B\" &amp; cnt) = cl.Offset(0, 1)\n                .Range(\"D\" &amp; cnt) = cl.Offset(0, 3)\n                .Range(\"F\" &amp; cnt) = cl.Offset(0, 5)\n                cnt = cnt + 1\n            Else\n                Exit Sub\n            End If\n        Next cl\n    End With\nEnd Sub\n</code></pre>\n\n<ul>\n<li>First a reference is set to only visible rows in the entire table (you'll need to update the range reference)</li>\n<li>Then we loop over the visible range, copy to sheet 2, and stop when 5 records (i.e. the top five) have been copied</li>\n</ul>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1430060671, "creation_date": 1430060671, "answer_id": 29879276, "question_id": 29633244, "link": "https://stackoverflow.com/questions/29633244/excel-vba-filter-and-copy-from-top-5-rows-cells/29879276#29879276", "title": "Excel VBA: Filter and copy from top 5 rows/cells", "body": "<p>While it may simply be easier to loop through the first five visible rows, I used application.evaluate to process a worksheet-style formula that returned the row number of the fifth visible record.</p>\n\n<pre><code>Sub sort_filter_copy()\n    Dim lr As Long, lc As Long, flr As Long, rws As Long, v As Long\n    Dim sCRIT As String\n    Dim vCOLs As Variant, vVALs As Variant\n    Dim bCopyFormulas As Boolean, bSort2Keys As Boolean\n\n    bCopyFormulas = True\n    bSort2Keys = False\n    sCRIT = \"dave\"\n    vCOLs = Array(1, 2, 4, 6)\n\n    With Sheet1\n        lr = .Cells(Rows.Count, 1).End(xlUp).Row\n        lc = .Cells(4, Columns.Count).End(xlToLeft).Column\n        With .Cells(5, 1).Resize(lr - 4, lc)\n            'sort on column F as if there was no header\n            If bSort2Keys Then\n                .Cells.Sort Key1:=.Columns(6), Order1:=xlDescending, _\n                            Key2:=.Columns(7), Order2:=xlDescending, _\n                            Orientation:=xlTopToBottom, Header:=xlNo\n            Else\n                .Cells.Sort Key1:=.Columns(6), Order1:=xlDescending, _\n                            Orientation:=xlTopToBottom, Header:=xlNo\n            End If\n            With .Offset(-1, 0).Resize(.Rows.Count + 1, .Columns.Count)\n                .AutoFilter\n                .AutoFilter field:=3, Criteria1:=sCRIT\n                With .Offset(1, 0).Resize(.Rows.Count - 1, .Columns.Count)\n                    rws = Application.Min(5, Application.Subtotal(103, .Columns(3)))\n                    If CBool(rws) Then\n                        flr = Application.Evaluate(\"=small(index(rows(5:\" &amp; lr &amp; \") + ('\" &amp; Sheet1.Name &amp; \"'!C5:C\" &amp; lr &amp; \"&lt;&gt;\" &amp; Chr(34) &amp; sCRIT &amp; Chr(34) &amp; \")*1e99, , ), \" &amp; rws &amp; \")\")\n                        For v = LBound(vCOLs) To UBound(vCOLs)\n                            If .Columns(vCOLs(v)).Cells(1).HasFormula And bCopyFormulas Then\n                                Sheet2.Cells(3, vCOLs(v)).Resize(5, 1).FormulaR1C1 = _\n                                    .Columns(vCOLs(v)).Cells(1).FormulaR1C1\n                            Else\n                                .Columns(vCOLs(v)).Resize(flr - 4, 1).Copy _\n                                    Destination:=Sheet2.Cells(3, vCOLs(v))\n                            End If\n                        Next v\n                    End If\n                End With\n                .AutoFilter\n            End With\n            'uncomment the next line if you want to return to a standard ascending sort on column A\n            '.Cells.Sort Key1:=.Columns(1), Order1:=xlAscending, _\n                        Orientation:=xlTopToBottom, Header:=xlNo\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>All options are set just below the variable declarations. Your sample images seemed to indicate that you used a two key sort so I coded for that optionally. If you want to bring in any formulas as formulas, that option is there. The filter criteria and the columns to copy are assigned to their respective vars as well.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<img src=\"https://i.stack.imgur.com/8QxsD.png\" alt=\"Sort, Filter and Copy Top 5\"></p>\n\n<p>My sample workbook is available on my public DropBox at:<br/>\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://dl.dropboxusercontent.com/u/100009401/Sort_Filter_Copy_from_Top_5.xlsb\" rel=\"nofollow noreferrer\">Sort_Filter_Copy_from_Top_5.xlsb</a></p>\n"}, {"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1430224606, "creation_date": 1430224606, "answer_id": 29919725, "question_id": 29633244, "link": "https://stackoverflow.com/questions/29633244/excel-vba-filter-and-copy-from-top-5-rows-cells/29919725#29919725", "title": "Excel VBA: Filter and copy from top 5 rows/cells", "body": "<p>First Unmerge the cells then use this code, very similar to some of the other suggestions.</p>\n\n<pre><code>    Sub Button1_Click()\n    Dim sh As Worksheet\n    Dim Rws As Long, Rng As Range, fRng As Range, c As Range, fRw As Long\n\n    Set sh = Sheets(\"Sheet2\")\n    Rws = Cells(Rows.Count, \"A\").End(xlUp).Row\n    Set Rng = Range(Cells(4, 1), Cells(Rws, \"T\"))    'unmerge all the headers\n\n\n    Rng.AutoFilter Field:=3, Criteria1:=\"Dave\"\n    ActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort.SortFields. _\n            Clear\n    ActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort.SortFields.Add _\n            Key:=Range(\"F4:F321\"), SortOn:=xlSortOnValues, Order:=xlDescending, _\n            DataOption:=xlSortTextAsNumbers\n    With ActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\n    Set fRng = Range(Cells(5, 1), Cells(Rws, 1)).SpecialCells(xlCellTypeVisible)\n    x = 0\n\n    For Each c In fRng.Cells\n\n        If x = 5 Then Exit Sub\n        fRw = sh.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n        sh.Range(sh.Cells(fRw, 1), sh.Cells(fRw, 2)).Value = Range(Cells(c.Row, 1), Cells(c.Row, 2)).Value\n        sh.Cells(fRw, 4).Value = Cells(c.Row, 4).Value\n        sh.Cells(fRw, 6).Value = Cells(c.Row, 6).Value\n        x = x + 1\n\n    Next c\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 107, "user_id": 1783135, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/60e4da7e8a7bd5c424553aef8ef3bb79?s=128&d=identicon&r=PG", "display_name": "E_L", "link": "https://stackoverflow.com/users/1783135/e-l"}, "edited": false, "score": 0, "creation_date": 1430387914, "post_id": 29956613, "comment_id": 48049292, "body": "1.  That&#39;s interesting, I didn&#39;t know that!  Will definitely look at using that in the future.  2.  Sorry mate, merged cells is not my choice.  For the moment that is something I can&#39;t change.  3.  Yup.  I agree.  But you also have to work with what you know and right now I don&#39;t know a lot ;-)"}, {"owner": {"reputation": 107, "user_id": 1783135, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/60e4da7e8a7bd5c424553aef8ef3bb79?s=128&d=identicon&r=PG", "display_name": "E_L", "link": "https://stackoverflow.com/users/1783135/e-l"}, "edited": false, "score": 0, "creation_date": 1430402576, "post_id": 29956613, "comment_id": 48059315, "body": "With a little bit of twiddling, I was able to understand which bit of the code did what and bend it to my will.  Thanks very much.  It was quite simple and I liked the lack of loops."}, {"owner": {"reputation": 7898, "user_id": 795231, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b849439b7749c507eaaa94e50759a623?s=128&d=identicon&r=PG", "display_name": "Reafidy", "link": "https://stackoverflow.com/users/795231/reafidy"}, "reply_to_user": {"reputation": 107, "user_id": 1783135, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/60e4da7e8a7bd5c424553aef8ef3bb79?s=128&d=identicon&r=PG", "display_name": "E_L", "link": "https://stackoverflow.com/users/1783135/e-l"}, "edited": false, "score": 1, "creation_date": 1430620599, "post_id": 29956613, "comment_id": 48137611, "body": "Great, glad it worked for you.  Yes sometimes merged cells are unavoidable, just make them a last resort.  So also are loops but avoiding them where possible usually will result in faster execution of code as your taking advantage of excels builtin features."}], "tags": [], "owner": {"reputation": 7898, "user_id": 795231, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b849439b7749c507eaaa94e50759a623?s=128&d=identicon&r=PG", "display_name": "Reafidy", "link": "https://stackoverflow.com/users/795231/reafidy"}, "is_accepted": true, "score": 2, "last_activity_date": 1430354437, "last_edit_date": 1430354437, "creation_date": 1430351358, "answer_id": 29956613, "question_id": 29633244, "link": "https://stackoverflow.com/questions/29633244/excel-vba-filter-and-copy-from-top-5-rows-cells/29956613#29956613", "title": "Excel VBA: Filter and copy from top 5 rows/cells", "body": "<p>Firstly a few helpful points:</p>\n\n<ul>\n<li>You should refer to worksheets by there <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837552.aspx\" rel=\"nofollow\">Code Name</a> to avoid renaming issues.</li>\n<li>If you want to work with VBA then my advice is to avoid merged cells like the plague.  They cause havoc with code.  If possible use format cells - alignment - horizontal - centre accross selection</li>\n<li>I also advise <a href=\"http://www.ozgrid.com/VBA/VBALoops.htm\" rel=\"nofollow\">avoiding loops</a> wherever possible and take advantage of excels built in functions instead as a good practice exercise.</li>\n</ul>\n\n<p>Here is my solution.  Keep it simple.  If you need further help let me now.  </p>\n\n<pre><code>Sub HTH()\n\n    Dim rCopy As Range\n\n    With Sheet1.AutoFilter.Range\n        '// Set to somewhere blank and unused on your worksheet\n        Set rCopy = Sheet1.Range(\"A\" &amp; Rows.Count - (.Rows.Count))\n        .SpecialCells(xlCellTypeVisible).Copy rCopy\n    End With\n\n    With rCopy.Offset(1).Resize(5) '// Offset to avoid the header\n        .Resize(, 2).Copy Sheet2.Range(\"A5\")\n        .Offset(, 3).Resize(, 1).Copy Sheet2.Range(\"D5\")\n        .Offset(, 5).Resize(, 1).Copy Sheet2.Range(\"F5\")\n        .CurrentRegion.Delete xlUp '// Delete the tempory area\n    End With\n\n    Set rCopy = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 1783135, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/60e4da7e8a7bd5c424553aef8ef3bb79?s=128&d=identicon&r=PG", "display_name": "E_L", "link": "https://stackoverflow.com/users/1783135/e-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8319, "favorite_count": 2, "accepted_answer_id": 29956613, "answer_count": 6, "score": 2, "last_activity_date": 1430354437, "creation_date": 1429030794, "last_edit_date": 1531161705, "question_id": 29633244, "link": "https://stackoverflow.com/questions/29633244/excel-vba-filter-and-copy-from-top-5-rows-cells", "title": "Excel VBA: Filter and copy from top 5 rows/cells", "body": "<p>I have a data table which is sorted on descending order in column F.  I then need to copy the top 5 rows, but only data from Column A, B, D, and F (not the headers).  See pictures.</p>\n\n<pre><code>Sub top5()\n\nSheets(\"Sheet1\").Select\n\nIf (ActiveSheet.AutoFilterMode And ActiveSheet.FilterMode) Or ActiveSheet.FilterMode Then\nActiveSheet.ShowAllData\nEnd If\n\n\nActiveSheet.Range(\"$A$4:$T$321\").AutoFilter Field:=3, Criteria1:=\"Dave\"\nActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort.SortFields. _\n    Clear\nActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort.SortFields.Add _\n    Key:=Range(\"F4:F321\"), SortOn:=xlSortOnValues, Order:=xlDescending, _\n    DataOption:=xlSortTextAsNumbers\nWith ActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n\n' This copy-paste part does what its supposed to, but only for the specific \n' cells.  Its not generalised and I will have to repeat this operation\n' several times for different people\nSheets(\"Sheet1\").Select\nRange(\"A3:B15\").Select\nSelection.Copy\n\nSheets(\"Sheet2\").Select\nRange(\"A3\").Select\nActiveSheet.Paste\n\nSheets(\"Sheet1\").Select\nRange(\"D3:D15\").Select\nApplication.CutCopyMode = False\nSelection.Copy\n\nSheets(\"Sheet2\").Select\nRange(\"C3\").Select\nActiveSheet.Paste\n\nSheets(\"Sheet1\").Select\nRange(\"F3:F15\").Select\nApplication.CutCopyMode = False\nSelection.Copy\n\nSheets(\"Sheet2\").Select\nRange(\"D3\").Select\nActiveSheet.Paste\nApplication.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n\n<p>I thought about trying to adapt this snippet of code below using visible cells function, but I'm stuck and I can't find anything on the net which fits.</p>\n\n<pre><code>' This selects all rows (plus 1, probably due to offset), I only want parts of from the top 5.\nSheets(\"Sheet1\").Select\nActiveSheet.Range(\"$A$4:$B$321\").Offset(1, 0).SpecialCells(xlCellTypeVisible).Select\nSelection.Copy\nSheets(\"Sheet2\").Select\nRange(\"A3\").Select\nActiveSheet.Paste\n\nSheets(\"Sheet1\").Select\nActiveSheet.Range(\"$D$4:$D$321\").Offset(1, 0).SpecialCells(xlCellTypeVisible).Select\nSelection.Copy\nSheets(\"Sheet2\").Select\nRange(\"C3\").Select\nActiveSheet.Paste\n</code></pre>\n\n<p>I hope my example makes sense and I really appreciate your help!</p>\n\n<p><img src=\"https://i.stack.imgur.com/pitTN.png\" alt=\"Sample Excel table\"></p>\n\n<p>Note:  The heading names are only the same in the two tables to show that the data is the same.  The headers are NOT supposed to be copied.  In addition, there is an extra column/white space in the second table.  A solution should include this.</p>\n\n<p><img src=\"https://i.stack.imgur.com/XXCK4.png\" alt=\"Data copied to new table\"></p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 0, "creation_date": 1429030554, "post_id": 29632942, "comment_id": 47408755, "body": "You need to learn <a href=\"http://stackoverflow.com/questions/2923957/bang-notation-and-dot-notation-in-vba-and-ms-access\">when to use a bang and when to use a dot</a>.  That knowledge would have rendered this question obsolete.  :o)"}], "tags": [], "owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "is_accepted": false, "score": 0, "last_activity_date": 1429029897, "creation_date": 1429029897, "answer_id": 29632942, "question_id": 29632796, "link": "https://stackoverflow.com/questions/29632796/access-vba-refer-to-a-textbox-on-active-form/29632942#29632942", "title": "Access VBA refer to a textbox on Active Form", "body": "<p>woops, I found the answer right after posting!</p>\n\n<pre><code>Screen.ActiveForm![TimerActivatedLabel].Visible = True\n</code></pre>\n\n<p>is working great for me.</p>\n\n<p>Thanks anyway!</p>\n"}], "owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1285, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429029897, "creation_date": 1429029464, "question_id": 29632796, "link": "https://stackoverflow.com/questions/29632796/access-vba-refer-to-a-textbox-on-active-form", "title": "Access VBA refer to a textbox on Active Form", "body": "<p>I know how to refer to an item on a form by choosing the form, i.e. <code>Forms!frmMyForm![Control].Value</code>.  But I have code that that finds which form is open, and then executes code from that variable, and it's not working.  I think I just need to refer to the control using ActiveForm, rather than an explicit form name, but the things I've tried to accomplish that haven't worked.</p>\n\n<p>Here's my code.</p>\n\n<pre><code>Private Sub OrderButton_Click()\n'\nDoCmd.SetWarnings False\n'\nCurRecord = Forms!frm_EC_All![L#].Value\nGetID = Forms!frm_MainMenu!AssocIDBox\n'\nMe.LBox.Value = CurRecord\n'\nIf CurrentProject.AllForms(\"frm_EC_All\").IsLoaded = True Then\n    RightForm = \"frm_EC_All\"\nElseIf CurrentProject.AllForms(\"frm_EC_EC#\").IsLoaded = True Then\n    RightForm = \"frm_EC_EC#\"\nElseIf CurrentProject.AllForms(\"frm_EC_Holds\").IsLoaded = True Then\n    RightForm = \"frm_EC_Holds\"\nElseIf CurrentProject.AllForms(\"frm_EC_L1\").IsLoaded = True Then\n    RightForm = \"frm_EC_L1\"\nElseIf CurrentProject.AllForms(\"frm_EC_L1_L2\").IsLoaded = True Then\n    RightForm = \"frm_EC_L1_L2\"\nElseIf CurrentProject.AllForms(\"frm_EC_L2\").IsLoaded = True Then\n    RightForm = \"frm_EC_L2\"\nElseIf CurrentProject.AllForms(\"frm_EC_L34\").IsLoaded = True Then\n    RightForm = \"frm_EC_L34\"\nEnd If\n'\nMe.Refresh\n'\nDoCmd.RunSQL \"UPDATE tbl_CQueue SET Order1 = -1, Order1Date = Now WHERE [L#] = \" &amp; CurRecord\nDoCmd.Close acForm, \"frm_Requests\", acSaveYes\nDoCmd.Close acForm, RightForm, acSaveYes\n'\nDoCmd.OpenForm RightForm, acNormal, , , , acWindowNormal\n'\nDim CurrentForm As Form: Set CurrentForm = Screen.ActiveForm\nMsgBox \"Current form is \" &amp; CurrentForm.Name\n'\nCurrentForm.TimerActivatedLabel.Visible = True\n'\nGetID = Forms!frm_MainMenu!AssocIDBox\nCurRecord = Forms!CurrentForm![L#].Value\n'\nDoCmd.RunSQL \"UPDATE tbl_Data SET tbl_Data.[AssocID] = \" &amp; GetID &amp; \" , tbl_Data.[tsStartAll] = Now WHERE tbl_Data.[AssocID] Is Null AND tbl_Data.[L#] = \" &amp; CurRecord\n'\nForms!CurrentForm!IDFieldBox.Value = GetID\n'\nDoCmd.SetWarnings True\n'\nEnd Sub\n</code></pre>\n\n<p>I get an error on the line <code>CurrentForm.TimerActivatedLabel.Visible = True</code>.  The error says <code>\"Database can't find the form 'CurrentForm' referred to in a macro expression or Visual Basic code.\"</code></p>\n\n<p>So it sees what form is open in the background and stores that as \"RightForm\", then closes whichever that form is, opens it again, and then to try to get this to work I set the active form to <code>CurrentForm</code>, and then it's supposed to set some textboxes and runs an SQL statement, etc.  But it needs to know the form's name and it's not correctly grabbing <code>CurrentForm</code> to use as the form's name.</p>\n\n<p>Any ideas?  Thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 0, "creation_date": 1429030209, "post_id": 29632703, "comment_id": 47408584, "body": "Have you tried to use <code>offset(1,0).copy</code> instead of <code>resize</code>? That should copy your formula instead of filling it down."}, {"owner": {"reputation": 7290, "user_id": 3406576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HjVSN.png?s=128&g=1", "display_name": "Banana", "link": "https://stackoverflow.com/users/3406576/banana"}, "reply_to_user": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 0, "creation_date": 1429030365, "post_id": 29632703, "comment_id": 47408657, "body": "@M&#225;t&#233;Juh&#225;sz im not quite sure how copying the destination range will help me with pasting the formulas into it... i think you have misunderstood my question."}, {"owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 0, "creation_date": 1429030784, "post_id": 29632703, "comment_id": 47408872, "body": "Copy works similar as resize but doesn&#39;t change the formula. You can specify the destination range too: <code>rngLstObj.Offset(1, 0).copy rngLstObj.rows(2,rngLstObj.Columns.Count)</code>"}, {"owner": {"reputation": 7290, "user_id": 3406576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HjVSN.png?s=128&g=1", "display_name": "Banana", "link": "https://stackoverflow.com/users/3406576/banana"}, "reply_to_user": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 0, "creation_date": 1429031330, "post_id": 29632703, "comment_id": 47409158, "body": "@M&#225;t&#233;Juh&#225;sz i need to paste the data from the 2 dimentional array <code>RevList</code> into the destination range. the offset and resize methods are simply used here to select the table&#39;s body without the headers, thats all. its the <code>.Formula = RevList</code> part that handles the data insertion."}], "answers": [{"tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": false, "score": 0, "last_activity_date": 1429029779, "creation_date": 1429029779, "answer_id": 29632910, "question_id": 29632703, "link": "https://stackoverflow.com/questions/29632703/add-data-into-table-without-auto-increment/29632910#29632910", "title": "Add data into table without auto increment", "body": "<p>If you start with</p>\n\n<pre><code>='H:\\dev...[some book name.xlsm]Main'!$C$1\n</code></pre>\n\n<p>it will force the absolute reference wherever it is copied.</p>\n\n<p>The added dollar signs prevent the range from changing.</p>\n"}, {"tags": [], "owner": {"reputation": 7290, "user_id": 3406576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HjVSN.png?s=128&g=1", "display_name": "Banana", "link": "https://stackoverflow.com/users/3406576/banana"}, "is_accepted": true, "score": 0, "last_activity_date": 1429036952, "creation_date": 1429036952, "answer_id": 29635055, "question_id": 29632703, "link": "https://stackoverflow.com/questions/29632703/add-data-into-table-without-auto-increment/29635055#29635055", "title": "Add data into table without auto increment", "body": "<p>I was resizing the destination range wrong, instead of:</p>\n\n<pre><code>With rngLstObj.Offset(1, 0).Resize(rngLstObj.Rows.Count - 1,rngLstObj.Columns.Count)\n    .Formula = RevList  \nEnd With\n</code></pre>\n\n<p>i should have resized the range according to the array dimensions:</p>\n\n<pre><code>rngLstObj.Offset(1, 0).Resize(UBound(RevList), _\nUBound(Application.Transpose(RevList))) = RevList\n</code></pre>\n"}], "owner": {"reputation": 7290, "user_id": 3406576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HjVSN.png?s=128&g=1", "display_name": "Banana", "link": "https://stackoverflow.com/users/3406576/banana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 29635055, "answer_count": 2, "score": 0, "last_activity_date": 1429036952, "creation_date": 1429029146, "question_id": 29632703, "link": "https://stackoverflow.com/questions/29632703/add-data-into-table-without-auto-increment", "title": "Add data into table without auto increment", "body": "<p>So i am trying to dynamically insert data into an Excel table from other closed workbooks.</p>\n\n<p><strong>i got everything working just fine, except one small annoying thing.</strong></p>\n\n<p>i have a formula as follows:</p>\n\n<blockquote>\n  <p>='H:\\dev...[some book name.xlsm]Main'!C1</p>\n</blockquote>\n\n<p>the formula above works fine. what i need is to insert this exact same formula into a table in the sheet for several rows.</p>\n\n<p>it should look like that in one column:</p>\n\n<blockquote>\n  <p>='H:\\dev...[some book name.xlsm]Main'!C1<br/>\n  ='H:\\dev...[some book name.xlsm]Main'!C1<br/>\n  ='H:\\dev...[some book name.xlsm]Main'!C1<br/></p>\n</blockquote>\n\n<p>what excel does, it automatically changes all the cell references to be incremental, like this:</p>\n\n<blockquote>\n  <p>='H:\\dev...[some book name.xlsm]Main'!<strong>C1</strong><br/>\n  ='H:\\dev...[some book name.xlsm]Main'!<strong>C2</strong><br/>\n  ='H:\\dev...[some book name.xlsm]Main'!<strong>C3</strong><br/></p>\n</blockquote>\n\n<p>i insert the the formulas as a string into an array,  and then paste it into the table using this code:</p>\n\n<pre><code>Set lstObj = Sheets(1).ListObjects(1)\nSet rngLstObj = lstObj.Range\nWith rngLstObj.Offset(1, 0).Resize(rngLstObj.Rows.Count - 1,rngLstObj.Columns.Count)\n    .Formula = RevList  \nEnd With\n</code></pre>\n\n<p>in the code above, <code>RevList</code> is a 2 dimentional array.</p>\n\n<p>i tried setting it to <code>.Formula</code>, <code>.Value</code>, in both cases excel changes the cell references to be incremental.</p>\n\n<p>i tried disabling calculation</p>\n\n<pre><code>ThisWorkbook.Sheets(1).EnableCalculation = False\n</code></pre>\n\n<p>still same.</p>\n\n<p>how do i stop this behavior from VBA side?</p>\n"}, {"tags": ["vba", "excel", "sharepoint", "sharepoint-2010"], "answers": [{"tags": [], "owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "is_accepted": false, "score": 0, "last_activity_date": 1436367699, "last_edit_date": 1495535206, "creation_date": 1436367699, "answer_id": 31296501, "question_id": 29632632, "link": "https://stackoverflow.com/questions/29632632/how-to-copy-data-from-an-excel-sheet-to-another-excel-sheet-uploaded-in-sharepoi/31296501#31296501", "title": "How to copy data from an excel sheet to another excel sheet uploaded in sharepoint using VBA?", "body": "<p>If you have access to Sharepoint you can use this code:\n<a href=\"https://stackoverflow.com/q/30927462/4572953\">Excel VBA Up-/Download from multiple SharePoint folders</a></p>\n\n<p>in order to open the SharePoint folders as network drive and access the files using <code>filesystemobject</code> or <code>dir</code> like you would do it on your local hard disk.</p>\n\n<p>I currently recommend this method if you've enough drive letters available. 1 Letter is 1 folder. You can also connect to a root folder on SharePoint and browse to subfolders like you do it in explorer.</p>\n\n<p>I hope it will help you. If you have any question, just ask.</p>\n"}], "owner": {"reputation": 115, "user_id": 4025565, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/13ba3984f46eb06d51c72a63c2b02c73?s=128&d=identicon&r=PG&f=1", "display_name": "xtina1231", "link": "https://stackoverflow.com/users/4025565/xtina1231"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436367699, "creation_date": 1429028931, "question_id": 29632632, "link": "https://stackoverflow.com/questions/29632632/how-to-copy-data-from-an-excel-sheet-to-another-excel-sheet-uploaded-in-sharepoi", "title": "How to copy data from an excel sheet to another excel sheet uploaded in sharepoint using VBA?", "body": "<p>i would like to ask if it's possible to copy or transfer data from an excel sheet to a worksheet uploaded in SharePoint without the need of opening the file from the SharePoint. Could this be done with VBA? You're prompt response is much appreciated. Thanks a lot!</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "edited": false, "score": 0, "creation_date": 1429108505, "post_id": 29651559, "comment_id": 47446034, "body": "Actually, I tried that. You can&#39;t right-click on the table to get &quot;Table Properties&quot; when recording. Also, using the toolbar to get to the properties does not show the same popup as Outlook (and there is not macro recording in Outlook). The Word version does not have the &quot;Same as the whole table&quot; property."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1429104425, "creation_date": 1429104425, "answer_id": 29651559, "question_id": 29632481, "link": "https://stackoverflow.com/questions/29632481/remove-the-same-as-the-whole-table-property-from-outlook-table/29651559#29651559", "title": "Remove the &quot;same as the whole table&quot; property from Outlook table", "body": "<p>Word provides a macro recorder which allows to generate the VBA code in the background. Try to record a VBA macro in Word and see what properties should be used for that. See <a href=\"https://support.office.com/en-ca/article/Record-or-run-a-macro-cd56fb86-d8b2-475c-ba39-9728389feeeb?ui=en-US&amp;rs=en-CA&amp;ad=CA&amp;fromAR=1\" rel=\"nofollow\">Record or run a macro</a> for more information. </p>\n"}, {"tags": [], "owner": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "is_accepted": false, "score": 0, "last_activity_date": 1429109229, "creation_date": 1429109229, "answer_id": 29653414, "question_id": 29632481, "link": "https://stackoverflow.com/questions/29632481/remove-the-same-as-the-whole-table-property-from-outlook-table/29653414#29653414", "title": "Remove the &quot;same as the whole table&quot; property from Outlook table", "body": "<p>My bad,</p>\n\n<p>Turns out that setting the padding <em>is</em> the way to turn off this property. The problem was actually in the <code>InchesToPoints</code> call that I copied and pasted from when I macro recording in MS Word.</p>\n\n<p><strong>However</strong> <code>InchesToPoints</code> is/was not an available method and that issue was hidden by the first line of my code:</p>\n\n<pre><code>On Error Goto Catch\n</code></pre>\n\n<p>(Shoot me now!)</p>\n\n<p>So, <code>InchesToPoints</code> failed, which means the padding was NOT actually getting set. I made my own <code>InchesToPoints</code> method:</p>\n\n<pre><code>Public Function InchesToPoints(ByVal dInches As Double) As Double\n    Const INCHES_TO_POINTS = 72#\n    InchesToPoints = dInches * INCHES_TO_POINTS\nEnd Function\n</code></pre>\n\n<p>And now it all works just fine.</p>\n\n<p><strong>The actual correct answer</strong> to this question <strong>is setting the table padding</strong> (E.g., <code>.TopPadding = 7.2</code> <strong>will turn off the \"Same as the whole table\" property.</strong></p>\n\n<p>Have a nice day.</p>\n"}], "owner": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1479759643, "creation_date": 1429028423, "last_edit_date": 1479759643, "question_id": 29632481, "link": "https://stackoverflow.com/questions/29632481/remove-the-same-as-the-whole-table-property-from-outlook-table", "title": "Remove the &quot;same as the whole table&quot; property from Outlook table", "body": "<p>I've got the following code to \"Codeize\" a block of code in an outlook message:</p>\n\n<pre><code>On Error GoTo Catch\nDim oSelection As Word.Selection\nSet oSelection = Application.ActiveInspector.CurrentItem.GetInspector.WordEditor.Application.Selection\n\nWith oSelection\n    With .Font\n        .Name = \"Courier New\"\n        '.Color = 10027008 '13369344\n        .Size = 10\n    End With\nEnd With\n\nDim oTable As Word.Table\nSet oTable = oSelection.ConvertToTable(, 1, 1)\nWith oTable\n    .Borders.OutsideLineStyle = wdLineStyleDot\n    .Shading.BackgroundPatternColor = wdColorGray05\n    .TopPadding = InchesToPoints(0.1)\n    .BottomPadding = InchesToPoints(0.1)\n    .LeftPadding = InchesToPoints(0.2)\n    .RightPadding = InchesToPoints(0.05)\nEnd With\n</code></pre>\n\n<p>Works great, BUT I think <strong>I cannot get the margins to work</strong> because I'm missing whatever removes the <strong>\"Same as the whole table\" property</strong>. </p>\n\n<p>After the code runs, the Table Properties looks like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/gXNMQ.jpg\" alt=\"enter image description here\"></p>\n\n<p>Perhaps I'm just setting the margins wrong, and this will automatically go away? What am I missing?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1429032125, "post_id": 29632330, "comment_id": 47409594, "body": "It would help to show a sample of your input data: it&#39;s difficult to picture how it looks from your description."}, {"owner": {"reputation": 197, "user_id": 2296381, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/1e19d34052a5e3ad527659ed7105417e?s=128&d=identicon&r=PG", "display_name": "user2296381", "link": "https://stackoverflow.com/users/2296381/user2296381"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1429035551, "post_id": 29632330, "comment_id": 47411479, "body": "Thanks Tim, I added a Sample set of data with a sample set of comma separated output. Hope that helps."}, {"owner": {"reputation": 1355, "user_id": 4121920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/183acca97aee37decce653048e68f307?s=128&d=identicon&r=PG&f=1", "display_name": "Coder375", "link": "https://stackoverflow.com/users/4121920/coder375"}, "edited": false, "score": 0, "creation_date": 1429081605, "post_id": 29632330, "comment_id": 47428239, "body": "I&#39;m sorry your question doesn&#39;t make sense to me, I cannot see how you would get from your sample data to the output, does your sample data actually look like that?"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1429037698, "creation_date": 1429037698, "answer_id": 29635270, "question_id": 29632330, "link": "https://stackoverflow.com/questions/29632330/best-way-to-create-import-files-with-excel/29635270#29635270", "title": "Best Way to Create Import Files with Excel?", "body": "<p>This worked for me:</p>\n\n<pre><code>Sub tester()\n\n    Dim sht As Worksheet, rngNames As Range, rngAccts As Range\n    Dim nm As Range, acct As Range, i As Long\n\n    Set sht = ActiveSheet\n\n    With sht\n        Set rngNames = .Range(.Range(\"A2\"), _\n                          .Cells(.Rows.Count, 1).End(xlUp))\n        Set rngAccts = .Range(.Range(\"B2\"), _\n                          .Cells(.Rows.Count, 2).End(xlUp))\n    End With\n\n    i = 1\n\n    For Each nm In rngNames.Cells\n    For Each acct In rngAccts.Cells\n        i = i + 1\n        sht.Cells(i, 5).Value = nm.Value\n        sht.Cells(i, 6).Value = acct.Value\n        sht.Cells(i, 7).Value = sht.Range(\"C1\").Offset(i - 1, 0).Value\n    Next acct\n    Next nm\n\nEnd Sub\n</code></pre>\n\n<p>Inputs are in ColA-C, output goes to Cols E-G</p>\n"}], "owner": {"reputation": 197, "user_id": 2296381, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/1e19d34052a5e3ad527659ed7105417e?s=128&d=identicon&r=PG", "display_name": "user2296381", "link": "https://stackoverflow.com/users/2296381/user2296381"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 29635270, "answer_count": 1, "score": 0, "last_activity_date": 1429037698, "creation_date": 1429027958, "last_edit_date": 1429035527, "question_id": 29632330, "link": "https://stackoverflow.com/questions/29632330/best-way-to-create-import-files-with-excel", "title": "Best Way to Create Import Files with Excel?", "body": "<p>Not sure what the best way to describe this situation is, but I'll do my best. I am trying to create an import file for a database system using Excel. </p>\n\n<p>Here is what we have as an example:</p>\n\n<pre><code>1) Names in a Column\n2) Accounts in a Column (Accounts 1-3)\n3) Amounts (An Amount for each Combo, ex: Name1, Account1, Name 1, Account2)\n</code></pre>\n\n<p>So what I want is an easy way (possibly with VBA?) to create an import file similar to below:</p>\n\n<pre><code>(Columns A, B, C)\nName#1, Account#1, Amount#1\nName#1, Account#2, Amount#2\nName#1, Account#3, Amount#3\nName#2, Account#1, Amount#4\nName#2, Account#2, Amount#5\netc.. etc..\n</code></pre>\n\n<p>Is there anyway to do this without having to do a ton of copying and pasting? I tried Pivot Tables, but it just doesn't seem to work for my situation</p>\n\n<p>Sample Data:</p>\n\n<pre><code>Names     |  Accounts   |   Amounts\nDavid        11230          $32.50\nMarry        11240          $2.00\nJerry        54500          $990.00\n             64000          $500.00\n                            $300.00\n                            $600.00\n                            $330.55\n                            $500.00\n                            $45.00\n                            $53.38\n                            $75.00\n                            $44.00\n</code></pre>\n\n<p>Thus the intended output we want is:</p>\n\n<pre><code>David, 11230, $32.50\nDavid, 11240, $2.00\nDavid, 54500, $990.00\nDavid, 64000, $500.00\nMarry, 11230, $300.00\nMarry, 11240, $600.00\n....Continue...\n</code></pre>\n\n<p>Hope that helps</p>\n"}, {"tags": ["xml", "vba", "dom", "xpath", "xml-parsing"], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "edited": false, "score": 0, "creation_date": 1429037524, "post_id": 29633849, "comment_id": 47412613, "body": "thanks. I am getting an <code>Object variable or With block variable not set</code>. Do you think it&#39;s because I&#39;m trying to go back to the ParentNode and then selectSingleNode?"}, {"owner": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "edited": false, "score": 0, "creation_date": 1429054065, "post_id": 29633849, "comment_id": 47420155, "body": "Awesome, thanks Tim. <code>toreLocation = Author(i).ParentNode.selectSingleNode(&quot;&#47;misc&#47;PublishedAuthor&zwnj;&#8203;[@id=&quot;&quot;&amp;athr(j)&amp;&quot;&quot;]&#47;&zwnj;&#8203;StoreLocation&quot;).Text</code> also fixed the object error (Text as opposed to NodeValue)"}, {"owner": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "edited": false, "score": 0, "creation_date": 1429056728, "post_id": 29633849, "comment_id": 47420887, "body": "If you&#39;re interested, I ran into a similar scenario that I can&#39;t figure out (what if only the author&#39;s last name is shown?). I posted it here <a href=\"http://stackoverflow.com/questions/29639301/vba-dom-variable-attribute-in-xpath\" title=\"vba dom variable attribute in xpath\">stackoverflow.com/questions/29639301/&hellip;</a>. Appreciate your kindness and help!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1429038926, "last_edit_date": 1429038926, "creation_date": 1429032815, "answer_id": 29633849, "question_id": 29631940, "link": "https://stackoverflow.com/questions/29631940/vba-dom-variable-in-xpath-attribute/29633849#29633849", "title": "VBA DOM Variable in XPath Attribute", "body": "<p>You need to double-up quotes to escape them:</p>\n\n<pre><code>StoreLocation = Author(i).ParentNode.selectSingleNode( _\n   \"/misc/PublishedAuthor[@id=\"\"\" &amp; athr &amp; \"\"\"]/StoreLocation\").NodeValue\n</code></pre>\n\n<p>EDIT: this worked for me</p>\n\n<pre><code>Sub mySub()\n\nDim XMLFile As Variant\nDim Author As Variant\nDim athr As String, BookType As String, Title As String, StoreLocation As String\nDim AuthorArray() As String, BookTypeArray() As String\nDim TitleArray() As String, StoreLocationArray() As String\nDim i As Long, x As Long, j As Long, locs\n\nDim mainWorkBook As Workbook\nDim n As IXMLDOMNode\nSet mainWorkBook = ActiveWorkbook\nSet XMLFile = CreateObject(\"Microsoft.XMLDOM\")\nXMLFile.Load (\"C:\\Books.xml\")\n\nx = 1\nj = 0\n\nSet Author = XMLFile.SelectNodes(\"/catalog/book/author\")\n\nFor i = 0 To (Author.Length - 1)\n\n    athr = Author(i).Text\n\n    'moved a bunch of your code inside this check...\n    If athr = \"Ralls, Kim\" Then\n\n        BookType = Author(i).ParentNode.getAttribute(\"id\")\n        Title = Author(i).ParentNode.getElementsByTagName(\"title\").Item(0).nodeTypedValue\n\n        Set locs = Author(i).ParentNode.SelectNodes( _\n               \"misc/PublishedAuthor[@id='\" &amp; athr &amp; \"']/StoreLocation\")\n\n        If locs.Length &gt; 0 Then\n            StoreLocation = locs(0).nodeTypedValue\n        Else\n            StoreLocation = \"???\"\n        End If\n\n        ReDim Preserve AuthorArray(0 To j)\n        ReDim Preserve BookTypeArray(0 To j)\n        ReDim Preserve TitleArray(0 To j)\n        ReDim Preserve StoreLocationArray(0 To j)\n\n        AuthorArray(j) = athr\n        BookTypeArray(j) = BookType\n        TitleArray(j) = Title\n        StoreLocationArray(j) = StoreLocation\n\n        j = j + 1\n        x = x + 1\n\n    End If\nNext\n\nIf j &gt; 0 Then\n\n    Range(\"A3\").Resize(j, 1).Value = WorksheetFunction.Transpose(AuthorArray)\n    Range(\"B3\").Resize(j, 1).Value = WorksheetFunction.Transpose(BookTypeArray)\n    Range(\"C3\").Resize(j, 1).Value = WorksheetFunction.Transpose(TitleArray)\n    Range(\"D3\").Resize(j, 1).Value = WorksheetFunction.Transpose(StoreLocationArray)\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 4643092, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-AItmzNvImlw/AAAAAAAAAAI/AAAAAAAAAEY/eXrF39bZ1Dk/photo.jpg?sz=128", "display_name": "NRH", "link": "https://stackoverflow.com/users/4643092/nrh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1108, "favorite_count": 1, "accepted_answer_id": 29633849, "answer_count": 1, "score": 0, "last_activity_date": 1429038926, "creation_date": 1429026844, "question_id": 29631940, "link": "https://stackoverflow.com/questions/29631940/vba-dom-variable-in-xpath-attribute", "title": "VBA DOM Variable in XPath Attribute", "body": "<p>I have a program that searches for and gathers (via array) a specific author and their 'BookType' and 'BookTitle' I am now trying to learn how to use the author's name - that I've stored in an array - as a variable in the XPath to get the 'Store Location'. Something like: \"/catalog/book/misc/PublisherAuthor id=\"myvar\"/StoreLocation\"</p>\n\n<p>Three things that are really confusing me:\n1. How would you declare a variable in XPath if it's an array (if possible)?\n2. Is it a bad idea to declare a statement like this inside the For loop?\n3. Is my XPath/DOM logic correct?</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;catalog&gt;\n&lt;book id=\"Adventure\"&gt;\n   &lt;author&gt;Gambardella, Matthew&lt;/author&gt;\n   &lt;title&gt;XML Developer's Guide&lt;/title&gt;\n   &lt;price&gt;44.95&lt;/price&gt;\n   &lt;misc&gt;\n        &lt;Publisher id=\"5691\"&gt;\n            &lt;PublisherLocation&gt;Los Angeles&lt;/PublisherLocation&gt;\n        &lt;/Publisher&gt;\n        &lt;PublishedAuthor id=\"Gambardella, Matthew\"&gt;\n            &lt;StoreLocation&gt;Store B&lt;/StoreLocation&gt;\n        &lt;/PublishedAuthor&gt;\n    &lt;/misc&gt;\n&lt;/book&gt;\n&lt;book id=\"Adventure\"&gt;\n   &lt;author&gt;Ralls, Kim&lt;/author&gt;\n   &lt;title&gt;Midnight Rain&lt;/title&gt;\n   &lt;price&gt;5.95&lt;/price&gt;\n   &lt;misc&gt;\n        &lt;Publisher id=\"4787\"&gt;\n            &lt;PublisherLocation&gt;New York&lt;/PublisherLocation&gt;\n        &lt;/Publisher&gt;\n        &lt;PublishedAuthor id=\"Ralls, Kim\"&gt;\n            &lt;StoreLocation&gt;Store B&lt;/StoreLocation&gt;\n        &lt;/PublishedAuthor&gt;\n    &lt;/misc&gt;\n&lt;/book&gt;\n&lt;book id=\"Adventure\"&gt;\n   &lt;author&gt;Boal, John&lt;/author&gt;\n   &lt;title&gt;Mist&lt;/title&gt;\n   &lt;price&gt;15.95&lt;/price&gt;\n   &lt;misc&gt;\n        &lt;Publisher id=\"8101\"&gt;\n            &lt;PublisherLocation&gt;New Mexico&lt;/PublisherLocation&gt;\n        &lt;/Publisher&gt;\n        &lt;PublishedAuthor id=\"Boal, John\"&gt;\n            &lt;StoreLocation&gt;Store B&lt;/StoreLocation&gt;\n        &lt;/PublishedAuthor&gt;\n    &lt;/misc&gt;\n&lt;/book&gt;\n&lt;book id=\"Mystery\"&gt;\n   &lt;author&gt;Ralls, Kim&lt;/author&gt;\n   &lt;title&gt;Some Mystery Book&lt;/title&gt;\n   &lt;price&gt;9.95&lt;/price&gt;\n   &lt;misc&gt;\n        &lt;Publisher id=\"6642\"&gt;\n            &lt;PublisherLocation&gt;New York&lt;/PublisherLocation&gt;\n        &lt;/Publisher&gt;\n        &lt;PublishedAuthor id=\"Ralls, Kim\"&gt;\n            &lt;StoreLocation&gt;Store B&lt;/StoreLocation&gt;\n        &lt;/PublishedAuthor&gt;\n    &lt;/misc&gt;\n&lt;/book&gt;\n&lt;/catalog&gt;\n</code></pre>\n\n<p>My code:</p>\n\n<pre><code>Option Explicit\n\nSub mySub()\n\nDim XMLFile As Variant\nDim Author As Variant\nDim athr As String, BookType As String, Title As String, StoreLocation As String\nDim AuthorArray() As String, BookTypeArray() As String, TitleArray() As String, StoreLocationArray() As String\nDim i As Long, x As Long, j As Long\n\nDim mainWorkBook As Workbook\nDim n As IXMLDOMNode\nSet mainWorkBook = ActiveWorkbook\nSet XMLFile = CreateObject(\"Microsoft.XMLDOM\")\nXMLFile.Load (\"C:\\Books.xml\")\n\n\nx = 1\nj = 0\n\nSet Author = XMLFile.SelectNodes(\"/catalog/book/author\")\nFor i = 0 To (Author.Length - 1)\n    ReDim Preserve AuthorArray(0 To i)\n    ReDim Preserve BookTypeArray(0 To i)\n    ReDim Preserve TitleArray(0 To i)\n    ReDim Preserve StoreLocationArray(0 To i)\n\n    athr = Author(i).Text\n    BookType = Author(i).ParentNode.getAttribute(\"id\")\n    Title = Author(i).ParentNode.getElementsByTagName(\"title\").Item(0).nodeTypedValue\n    StoreLocation = Author(i).ParentNode.selectSingleNode(\"/misc/PublishedAuthor[@id=\"\"&amp;athr(j)&amp;\"\"]/StoreLocation\").NodeValue\n\n    If athr = \"Ralls, Kim\" Then\n\n        AuthorArray(j) = athr\n        BookTypeArray(j) = BookType\n        TitleArray(j) = Title\n        StoreLocationArray(j) = StoreLocation\n\n        j = j + 1\n        x = x + 1\n    End If\nNext\n\nRange(\"A3:A\" &amp; UBound(AuthorArray) + 1) = WorksheetFunction.Transpose(AuthorArray)\nRange(\"B3:B\" &amp; UBound(BookTypeArray) + 1) = WorksheetFunction.Transpose(BookTypeArray)\nRange(\"C3:C\" &amp; UBound(BookTypeArray) + 1) = WorksheetFunction.Transpose(TitleArray)\nRange(\"D3:D\" &amp; UBound(BookTypeArray) + 1) = WorksheetFunction.Transpose(TitleArray)\n</code></pre>\n\n<p>To be specific, it's this line that I don't understand how to setup:    </p>\n\n<pre><code>StoreLocation = Author(i).ParentNode.selectSingleNode(\"/misc/PublishedAuthor[@id=\"\"&amp;athr(j)&amp;\"\"]/StoreLocation\").NodeValue\n</code></pre>\n\n<p>Is doing something like this frowned upon? Is there a more logical way?</p>\n\n<p>Thank you for any guidance, help, or comments :)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1429027202, "post_id": 29631627, "comment_id": 47406687, "body": "Without using AutoFill, I would just add 7 since Excel stores dates as days and that advances a week."}], "answers": [{"tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": false, "score": 0, "last_activity_date": 1429028056, "creation_date": 1429028056, "answer_id": 29632359, "question_id": 29631627, "link": "https://stackoverflow.com/questions/29631627/fill-in-dates-by-week/29632359#29632359", "title": "Fill in Dates by week?", "body": "<p>If you put a Sunday's date in <code>A2</code> and the next Sunday's date in <code>A3</code> then select <code>A2:A3</code> and fill down, then there are only Sunday's dates filled because there are ever 7 days difference between Sundays and the default fill behavior will fill series with the difference of the selected cells.</p>\n\n<pre><code>Sub FillDates()\n With Sheet1.Range(\"A2\")\n        .Value = DateSerial(2015, 4, 12)\n        .Offset(1, 0).Value = .Value + 7\n        .Resize(2, 1).AutoFill Destination:=.Resize(1102, 1)\n End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4788036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce2d8d8bb4232b8a2280e96573a937d3?s=128&d=identicon&r=PG&f=1", "display_name": "George Steele", "link": "https://stackoverflow.com/users/4788036/george-steele"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 496, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1429077751, "creation_date": 1429025857, "last_edit_date": 1429077751, "question_id": 29631627, "link": "https://stackoverflow.com/questions/29631627/fill-in-dates-by-week", "title": "Fill in Dates by week?", "body": "<p>Is there a way to fill a column week by week including weekends? For example:</p>\n\n<blockquote>\n  <p>A2 = 12/04/2015 <br>\n  A3 = 19/04/2015 <br>\n  A4 = 26/04/2015....  </p>\n</blockquote>\n\n<p>My current code is as follows:</p>\n\n<pre><code>Sub FillDates()\n    With Sheet1.Range(\"A2\")\n        .Value = DateSerial(2015, 4, 12)\n        .AutoFill .Resize(1102, 1), xlFillDays\n    End With\nEnd Sub\n</code></pre>\n\n<p>I have tried the code for weekdays, months and individual days but this doesn't satisfy what I want, is there a way to fill each corresponding cell in a column with weekly dates? </p>\n"}, {"tags": ["arrays", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1429027095, "post_id": 29631719, "comment_id": 47406616, "body": "Gary, I tested this, it is optimized than my solution. I think it might need <code>3 * lastRow</code> as for every element it needs two more. Also, it needs <code>propertyArr(1, i + 2) = &quot;&quot;</code> followed by <code>propertyArr(1, i + 1) = &quot;&quot;</code>. As the OP needed two blanks."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1429026138, "creation_date": 1429026138, "answer_id": 29631719, "question_id": 29631454, "link": "https://stackoverflow.com/questions/29631454/how-can-i-add-empty-spaces-between-values-to-a-vba-array/29631719#29631719", "title": "How can I add empty spaces between values to a vba array?", "body": "<p>Something like:</p>\n\n<pre><code>Sub ytrewq()\n    Dim propertyArr(), lastRow As Long\n    Dim originalWS As Worksheet\n    Set originalWS = ActiveSheet\n    lastRow = 5\n    ReDim propertyArr(1, 2 * lastRow)\n    For i = 1 To 2 * lastRow Step 2\n        propertyArr(1, i) = originalWS.Cells(i + 1, 5).Value\n        propertyArr(1, i + 1) = \"\"\n        Debug.Print propertyArr(1, i)\n    Next\nEnd Sub\n</code></pre>\n\n<p><strong>UNTESTED</strong></p>\n"}, {"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1429027781, "post_id": 29631814, "comment_id": 47407067, "body": "Thank you for your comments.............I will update my post as per your instructions later today."}, {"owner": {"reputation": 346, "user_id": 1733817, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/xJ0Nv.jpg?s=128&g=1", "display_name": "Aldo Sanchez", "link": "https://stackoverflow.com/users/1733817/aldo-sanchez"}, "edited": false, "score": 0, "creation_date": 1429106704, "post_id": 29631814, "comment_id": 47444614, "body": "thank you for your answer, however I still have a problem with how I store the values from the cells. I have edited my comment so that I make my problem a bit more clear. Let me know if you have other questions. Thank you! @PaulFrancis"}, {"owner": {"reputation": 346, "user_id": 1733817, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/xJ0Nv.jpg?s=128&g=1", "display_name": "Aldo Sanchez", "link": "https://stackoverflow.com/users/1733817/aldo-sanchez"}, "edited": false, "score": 0, "creation_date": 1429107622, "post_id": 29631814, "comment_id": 47445296, "body": "@PaulFrancis  I actually just figured it out.  It was all about updating my cell value correctly.  I posted the loop below.  Thank you for your help!"}, {"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 1, "creation_date": 1429109358, "post_id": 29631814, "comment_id": 47446679, "body": "You&#39;re welcome ! If you found the answer helpful you can mark it with the green tick. Cheers. Good luck :)"}], "tags": [], "owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "is_accepted": false, "score": 5, "last_activity_date": 1429026403, "creation_date": 1429026403, "answer_id": 29631814, "question_id": 29631454, "link": "https://stackoverflow.com/questions/29631454/how-can-i-add-empty-spaces-between-values-to-a-vba-array/29631814#29631814", "title": "How can I add empty spaces between values to a vba array?", "body": "<p>This should do the trick,</p>\n\n<pre><code>Dim lRowNo As Long\n\nlRowNo = lastRow * 3\nReDim propertyArr(1, lRowNo)\n\nFor i = 1 To lRowNo \n    If i Mod 3 = 1 Then\n        propertyArr(1, i) = originalWS.Cells(i + 1, 5).Value\n    Else\n        propertyArr(1, i) = \"\"\n    End If\n    Debug.Print propertyArr(1, i)\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1429029336, "post_id": 29632381, "comment_id": 47408053, "body": "&quot;More efficiently&quot; as in a couple fewer lines of code? I&#39;m assuming you&#39;re not referring to any vanishingly tiny, hypothetical performance gains... That would be silly, right? Anyhow, this is probably how I&#39;d do it."}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "reply_to_user": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1429029472, "post_id": 29632381, "comment_id": 47408149, "body": "It depends on the size of the array @Jean-Fran&#231;oisCorbett. If it&#39;s a large number of iterations, this method could cut that number by a factor of 3."}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 1, "creation_date": 1429030569, "post_id": 29632381, "comment_id": 47408762, "body": "(Um, what?) How large is large? I just tested your and @PaulFrancis&#39;s codes. There is indeed a factor of ~3. That amounts to a whopping 0.02 seconds difference for <code>lastRow = 32768</code>. For higher values of <code>lastrow</code>, your code overflows so that&#39;s the maximum possible gain :-)  Change <code>CInt</code> to <code>CLng</code> and you&#39;re all set. For <code>lastRow = 1 million</code> you gain about half a second. For anything below 1000, the difference is too small to measure using <code>Timer</code>. So, that&#39;s how large."}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "reply_to_user": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 1, "creation_date": 1429030705, "post_id": 29632381, "comment_id": 47408826, "body": "Can&#39;t ask for perfection from example code written in about 60 seconds. =;)-"}], "tags": [], "owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "is_accepted": false, "score": 1, "last_activity_date": 1429028108, "creation_date": 1429028108, "answer_id": 29632381, "question_id": 29631454, "link": "https://stackoverflow.com/questions/29631454/how-can-i-add-empty-spaces-between-values-to-a-vba-array/29632381#29632381", "title": "How can I add empty spaces between values to a vba array?", "body": "<p>You can also unroll the loop a bit to do this a bit more efficiently. Note that for each iteration, <code>i</code> isn't incremented by <code>1</code>, but by <code>3</code>.</p>\n\n<pre><code>Public Sub test()\n\n    Dim lastRow As Long\n    lastRow = 6\n\n    Dim lastIndex As Long\n    lastIndex = lastRow * 3\n\n    ReDim propertyArr(1 To lastIndex)\n\n    Dim i As Long\n    For i = 1 To lastIndex Step 3\n        propertyArr(i) = CInt(i / 3)\n        propertyArr(i + 1) = vbNullString\n        propertyArr(i + 2) = vbNullString\n    Next\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1429094076, "post_id": 29646608, "comment_id": 47435761, "body": "That is good. Just a small concern. So this would be cloaser to what the OP wantes I think? <code>propertyarr = Join(Application.Transpose(ws.Range(&quot;E1:E5&quot;)), &quot;,&quot;&quot;&quot;&quot;,&quot;&quot;&quot;&quot;,&quot;) &amp; &quot;,&quot;&quot;&quot;&quot;,&quot;&quot;&quot;&quot;&quot;</code>. Also, should a <code>SPLIT</code> follow the <code>JOIN</code> to get an Array back?"}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 1, "last_activity_date": 1429097737, "last_edit_date": 1429097737, "creation_date": 1429090330, "answer_id": 29646608, "question_id": 29631454, "link": "https://stackoverflow.com/questions/29631454/how-can-i-add-empty-spaces-between-values-to-a-vba-array/29646608#29646608", "title": "How can I add empty spaces between values to a vba array?", "body": "<p>Or without loops</p>\n\n<pre><code>Dim ws As Worksheet\nSet ws = Sheets(1)\npropertyarr = Join(Application.Transpose(ws.Range(\"E1:E5\")), \",\"\"\"\",\"\"\"\",\")\n</code></pre>\n\n<p>to put back into array</p>\n\n<pre><code>propertyarr = Split(Join(Application.Transpose(ws.Range(\"E1:E5\")), \",,,\"), \",\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 346, "user_id": 1733817, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/xJ0Nv.jpg?s=128&g=1", "display_name": "Aldo Sanchez", "link": "https://stackoverflow.com/users/1733817/aldo-sanchez"}, "is_accepted": false, "score": 0, "last_activity_date": 1429107738, "creation_date": 1429107738, "answer_id": 29652859, "question_id": 29631454, "link": "https://stackoverflow.com/questions/29631454/how-can-i-add-empty-spaces-between-values-to-a-vba-array/29652859#29652859", "title": "How can I add empty spaces between values to a vba array?", "body": "<p>I figured out the answer.  I wasn't updating the cells I needed correctly. See code below:</p>\n\n<pre><code>count = 3\nlastIndex = lastRow * 3\n\nReDim propertyArr(1, lastIndex)\nFor i = 1 To lastIndex Step 3\n        propertyArr(1, i) = originalWS.Cells((count - 1), 5)\n        count = count + 1\nNext\n</code></pre>\n"}], "owner": {"reputation": 346, "user_id": 1733817, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/xJ0Nv.jpg?s=128&g=1", "display_name": "Aldo Sanchez", "link": "https://stackoverflow.com/users/1733817/aldo-sanchez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1699, "favorite_count": 0, "answer_count": 5, "score": 2, "last_activity_date": 1429107738, "creation_date": 1429025414, "last_edit_date": 1429106533, "question_id": 29631454, "link": "https://stackoverflow.com/questions/29631454/how-can-i-add-empty-spaces-between-values-to-a-vba-array", "title": "How can I add empty spaces between values to a vba array?", "body": "<p>I create an array in vba by looping through cells in a sheet (originalWS). So let's say cells (2,5) to (2,12) have the following:</p>\n\n<pre><code>(2,5)Item\n(3,5)Type \n(4,5)Nominal Diameter\n(5,5)Lead\n.\n.\n.\n(12,5)For Use with End Blocks\n</code></pre>\n\n<p>Thus, when I loop with the code below I get an array that looks like this:</p>\n\n<p>[Item,Type,Nominal Diameter,Lead,...,For Use with End Blocks].</p>\n\n<p>However, I would like to add two empty spaces between each value in my array. so that it looks like this:</p>\n\n<p>[Item,\"\",\"\",Type,\"\",\"\",Nominal Diameter,\"\",\"\",Lead,\"\",\"\",...,For Use with End Blocks,\"\",\"\"]</p>\n\n<pre><code>ReDim propertyArr(1, lastRow)\nFor i = 1 To lastRow\n    propertyArr(1, i) = originalWS.Cells(i + 1, 5).Value\n    Debug.Print propertyArr(1, i)\nNext\n</code></pre>\n\n<p>I have tried to loop to by the final total size of the array so (lastRow*3) and step forward by 3.  However, I'm having a hard time figuring out how I would reset my orginalWS.cells(i,5) values so that they are consecutive. </p>\n\n<p>In other words, when I loop stepping by 3 my values would be:</p>\n\n<pre><code>propertyArr(1,1) = originalWS.Cells(2,5).value\npropertyArr(1,4) = originalWS.cells(5,5).value\npropertyArr(1,7) = originalWS.cells(8,5).value\n</code></pre>\n\n<p>How can I loop so that I store values in my array every 2 places, while I get the values from a consecutive list in a sheet. </p>\n\n<p>Can I do this without having to add extra empty row\n a way to add two empty spaces between each value within my original loop without having to add extra empty rows?</p>\n\n<p>Or, can I add the two empty spaces between each value after I created my array the first time?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 1083, "user_id": 201302, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dec0dbd7cc0e523ab95f933df089d38f?s=128&d=identicon&r=PG", "display_name": "JonYork", "link": "https://stackoverflow.com/users/201302/jonyork"}, "edited": false, "score": 0, "creation_date": 1429038059, "post_id": 29631654, "comment_id": 47412960, "body": "I would say to copy the function in answer to your modeule and then add the line <code>Cells(r, 10) = GetFileOwner(Folder.FolderPath, FName)</code> just before <code>r = r + 1</code>. I did not try to run your code because most of your variables are not defined (put <code>Option Explicit</code> at the top of your module), and it looks recursive."}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 1, "last_activity_date": 1429025948, "creation_date": 1429025948, "answer_id": 29631654, "question_id": 29631310, "link": "https://stackoverflow.com/questions/29631310/get-owner-of-file-on-disk/29631654#29631654", "title": "Get owner of file on disk", "body": "<p>You can access the file's security properties (one of which is the Owner), through the Security Utility object.</p>\n\n\n\n<pre><code>Option Explicit\n\nSub test()\n    Dim fName As String\n    Dim fDir As String\n    fName = \"test.txt\"\n    fDir = \"C:\\Temp\\\"\n    Debug.Print \"The owner is \" &amp; GetFileOwner(fDir, fName)\nEnd Sub\n\nFunction GetFileOwner(fileDir As String, fileName As String) As String\n    Dim securityUtility As Object\n    Dim securityDescriptor As Object\n    Set securityUtility = CreateObject(\"ADsSecurityUtility\")\n    Set securityDescriptor = securityUtility.GetSecurityDescriptor(fileDir &amp; fileName, 1, 1)\n    GetFileOwner = securityDescriptor.owner\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1083, "user_id": 201302, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dec0dbd7cc0e523ab95f933df089d38f?s=128&d=identicon&r=PG", "display_name": "JonYork", "link": "https://stackoverflow.com/users/201302/jonyork"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2673, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1429029992, "creation_date": 1429025079, "last_edit_date": 1429029992, "question_id": 29631310, "link": "https://stackoverflow.com/questions/29631310/get-owner-of-file-on-disk", "title": "Get owner of file on disk", "body": "<p>Below is my current macro, which is working great, but I would like to add in Cells(r, 10) the owner of the file. How can such a thing be accomplished? I can't find the command to use like File.Owner or something.</p>\n\n<pre><code>Sub DoFolder(Folder)\nIf Ans = vbNo Then GoTo NoSub                                           'Switching according to ans.\nDim SubFolder\nFor Each SubFolder In Folder.SubFolders\n    DoFolder SubFolder\nNext\nNoSub:\nDim File\nFor Each File In Folder.Files\n    FName = File.Name\n    If InStrRev(FName, \".\") = 0 Then GoTo NextFile                      'If \".\" not found then go to next file\n    Cells(r, 1) = Left(FName, InStrRev(FName, \".\") - 1)                 'File Name\n    ActiveSheet.Hyperlinks.Add Anchor:=Cells(r, 2), _\n                               Address:=File.Path, _\n                               TextToDisplay:=File.Path                 'Hyperlinking Path\n    Cells(r, 3) = File.DateLastModified                                 'Date Last Modified\n    Cells(r, 4) = Round(File.Size / 1024, 3)                            'in KBs Rounded to 3 Decimal places\n    Cells(r, 5) = Right(FName, Len(FName) - InStrRev(FName, \".\") + 1)   'File Extension\n    r = r + 1\nNextFile:\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 1, "last_activity_date": 1429024852, "creation_date": 1429024852, "answer_id": 29631225, "question_id": 29629622, "link": "https://stackoverflow.com/questions/29629622/merge-files-in-order/29631225#29631225", "title": "Merge Files in order", "body": "<p>The files will always appear in a random order in your VBA code. In order to set your own sort order, you can define it using the <code>.Folder</code> and it's properties. Look at the documentation for the <a href=\"https://msdn.microsoft.com/EN-US/library/office/gg278618.aspx\" rel=\"nofollow\">MSDN - Folder Object</a> and then the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff866960.aspx\" rel=\"nofollow\">Items.Sort Method</a>. </p>\n\n<p>Alternatively, you can read in all the file names and sort them in your VBA-based array as discussed over in <a href=\"http://blog.codinghorror.com/sorting-for-humans-natural-sort-order/\" rel=\"nofollow\">CodingHorror</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 889, "user_id": 4403269, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-hxdYtQPJ6Jw/AAAAAAAAAAI/AAAAAAAAABQ/SWZyxZzJ8K8/photo.jpg?sz=128", "display_name": "Sharunas Bielskis", "link": "https://stackoverflow.com/users/4403269/sharunas-bielskis"}, "is_accepted": false, "score": 0, "last_activity_date": 1507616169, "creation_date": 1507616169, "answer_id": 46659754, "question_id": 29629622, "link": "https://stackoverflow.com/questions/29629622/merge-files-in-order/46659754#46659754", "title": "Merge Files in order", "body": "<p>My solution is for the case when is need to merge excel files into one file in these files creation order.</p>\n\n<pre><code>Sub Main()\n\n\nDim sourceWorkbook As Workbook\nDim FSO As Object\nDim sourceFolder As Object\nDim file As Object\nDim templatePath As String, templateName As String, sourceFolderPath As String\nDim destinationFileNamePrefix As String, destinationFolderPath As String\nDim moveMergedFilesToBackup As Boolean, backupUpperFolderPath As String\nDim lastTemplateColumn As Integer, fullyFilledColumnNumber As Integer, lastSourceFileColumn As Integer, sourceFileName As String\nDim lastRow As Long, i As Long, insertExecutionNumber As Boolean, executionNumber As Long\nDim sortingWorkbook As Workbook, rowNo As Long, lastArrayIndex As Long, sourceFilesPathArray() As String\n\nApplication.ScreenUpdating = False\n\nCall LoadSettings.LoadDataFromControlSheet(templatePath, sourceFolderPath, fullyFilledColumnNumber, destinationFolderPath, _\n        destinationFileNamePrefix, moveMergedFilesToBackup, backupUpperFolderPath, insertExecutionNumber)\n\nWorkbooks.Open fileName:=templatePath\ntemplateName = Right(templatePath, Len(templatePath) - InStrRev(templatePath, \"\\\"))\nWorkbooks(templateName).Activate\nCall SaveFiles.SaveTemplateToTemporaryFolder(templateName)\nlastTemplateColumn = Range(\"A1\").End(xlToRight).Column\n\n\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nSet sourceFolder = FSO.Getfolder(sourceFolderPath)\n\n'Create a new workbook for files sorting in ascending order according their creation date\nSet sortingWorkbook = Workbooks.Add\n'sortingWorkbook.Name = \"SortingWorkbook.xlsx\"\n'Call SaveFiles.SaveTemplateToTemporaryFolder(sortingWorkbook.Name)\nsortingWorkbook.Activate\nRange(\"A1\") = \"File path\"\nRange(\"B1\") = \"Creation Date and Time\"\n'Write required data into sorting workbook\nrowNo = 2\nFor Each file In sourceFolder.Files\n    sourceFileName = file.Name\n    If InStr(sourceFileName, \".xlsx\") Then ' Only xlsx files will be merged\n        Range(\"A\" &amp; rowNo) = file.Path\n        Range(\"B\" &amp; rowNo) = file.DateCreated\n        rowNo = rowNo + 1\n    End If ' If InStr(sourceFileName, \".xlsx\") Then' Only xlsx files will be merged\nNext\n\n'Sort by file creation date and time - column B\nRange(\"A1:B1\").Select\nSelection.AutoFilter\nActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort.SortFields.Add Key:=Range _\n    (\"B1\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nWith ActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n'Read filepath into array\nlastArrayIndex = rowNo - 3 ' rowNo at this moment is +1 than rows, data is from 2 row, array is 0 Based, so -3\nReDim sourceFilesPathArray(lastArrayIndex) 'size array\nrowNo = 2\nFor i = 0 To lastArrayIndex\n    sourceFilesPathArray(i) = Range(\"A\" &amp; rowNo)\n    rowNo = rowNo + 1\nNext i\n\nsortingWorkbook.Close saveChanges:=False\n\n'Open source files and merge them into accumulation template\nFor i = 0 To lastArrayIndex\n    Set sourceWorkbook = Workbooks.Open(sourceFilesPathArray(i))\n    'Check if source file headers columns number corresponds template to which will be merged data columns number\n    lastSourceFileColumn = Range(\"A1\").End(xlToRight).Column\n    If lastSourceFileColumn = lastTemplateColumn Then\n        lastRow = Cells(Rows.Count, fullyFilledColumnNumber).End(xlUp).Row\n        Range(Cells(2, 1), Cells(lastRow, lastSourceFileColumn)).Copy\n        Workbooks(templateName).Activate\n        lastRow = Cells(Rows.Count, fullyFilledColumnNumber).End(xlUp).Row\n        Range(\"A\" &amp; lastRow + 1).PasteSpecial\n        Application.CutCopyMode = False\n        sourceWorkbook.Close\n    Else\n        MsgBox \"In the source directory was found xlsx format file\" &amp; vbNewLine &amp; _\n            sourceFilesPathArray(i) &amp; vbNewLine &amp; _\n            \"which has data columns number \" &amp; lastSourceFileColumn &amp; vbNewLine &amp; _\n            \"which is different from template into which data are accumulated \" &amp; vbNewLine &amp; _\n            \"data columns number \" &amp; lastTemplateColumn &amp; \".\" &amp; vbNewLine &amp; _\n            \"This program will end now.\" &amp; vbNewLine &amp; _\n            \"Check if you selected correct template and source folder or\" &amp; vbNewLine &amp; _\n            \"remove incorrect source file from source folder and then\" &amp; vbNewLine &amp; _\n            \"restart the program\", vbCritical, ThisWorkbook.Name\n\n        Workbooks(templateName).Close saveChanges:=False\n        sourceWorkbook.Close\n        End\n    End If\n\nNext i\n\n\nSet sourceWorkbook = Nothing\nSet filesObj = Nothing\nSet FSO = Nothing\n\n\n\n\n'Save accumulated in template data into destination folder with name formed by settings\nCall SaveFiles.SaveMergedDataIntoDestination(templateName, destinationFileNamePrefix, destinationFolderPath)\n\n\n\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4787610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7ef159fd9185b691010b21775c47fc9?s=128&d=identicon&r=PG&f=1", "display_name": "theanchorman", "link": "https://stackoverflow.com/users/4787610/theanchorman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1507616169, "creation_date": 1429020651, "question_id": 29629622, "link": "https://stackoverflow.com/questions/29629622/merge-files-in-order", "title": "Merge Files in order", "body": "<p>I have the below vba macro for merging multiple files. However, when im merging the files, they dont merge in order of how my folder is set up for that path. Could someone tell me how i could get my files to merge in order?</p>\n\n<pre><code>Dim booklist As Workbook   \nDim mergeObj As Object, dirObj As Object, filesObj As Object, everyObj As Object\nApplication.ScreenUpdating = False  \nSet mergeObj = CreateObject(\"Scripting.FileSystemObject\")\n\nSet dirObj = mergeObj.Getfolder(\"PATH\")  \nSet filesObj = dirObj.Files  \nFor Each everyObj In filesObj  \nSet booklist = Workbooks.Open(everyObj)\n\nRange(\"A1:H27\").Copy  \nThisWorkbook.Worksheets(1).Activate\n\nRange(\"A65536\").End(xlUp).Offset(2, 0).PasteSpecial  \nApplication.CutCopyMode = False  \nbooklist.Close  \nNext\n\nRows(\"1:1\").Select  \nSelection.Delete Shift:=xlUp  \nRows(\"1:1\").Select  \nSelection.Delete Shift:=xlUp  \nRange(\"A1\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1429019575, "post_id": 29629190, "comment_id": 47401207, "body": "That&#39;s how <code>Select</code> statements work. <a href=\"https://msdn.microsoft.com/EN-US/library/office/gg278665.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/EN-US/library/office/gg278665.aspx</a>"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1429019585, "post_id": 29629190, "comment_id": 47401213, "body": "Yes, <code>Case</code> does not fall-through."}, {"owner": {"reputation": 13, "user_id": 4787567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22fcd52f74bd01230b789d586df249f1?s=128&d=identicon&r=PG&f=1", "display_name": "Tisha", "link": "https://stackoverflow.com/users/4787567/tisha"}, "edited": false, "score": 0, "creation_date": 1429019928, "post_id": 29629190, "comment_id": 47401468, "body": "How could I modify it for what I need it to do?"}], "answers": [{"tags": [], "owner": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "is_accepted": false, "score": 1, "last_activity_date": 1429019991, "creation_date": 1429019991, "answer_id": 29629371, "question_id": 29629190, "link": "https://stackoverflow.com/questions/29629190/excel-vba-select-case-ends-select-after-finding-one-case-true-and-doesnt-comp/29629371#29629371", "title": "Excel VBA - Select Case ends select after finding one case true and doesn&#39;t complete other cases", "body": "<p>This is how VB select case works.</p>\n\n<p>If you want to have multiple cases that execute the same block, you put them in the same case and delimit them with commas, like this:</p>\n\n<pre><code>Public Sub TestX(ByVal x As Long)\n\n\n    Select Case x\n        Case 1, 2\n            Debug.Print \"x is One or Two\"\n        Case 3\n            Debug.Print \"x is Three\"\n        Case Else\n            Debug.Print ; \"is something else\"\n    End Select\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1429021935, "creation_date": 1429021935, "answer_id": 29630108, "question_id": 29629190, "link": "https://stackoverflow.com/questions/29629190/excel-vba-select-case-ends-select-after-finding-one-case-true-and-doesnt-comp/29630108#29630108", "title": "Excel VBA - Select Case ends select after finding one case true and doesn&#39;t complete other cases", "body": "<p>It looks to me as though you don't want <code>Select Case</code>, which is designed to behave the way you describe, at all but rather a series of separate If statements:</p>\n\n<pre><code>Dim n                           As Long\n\nIf Len(xColA) &gt; 2 Then    'Check if length is greater than 2\n    Cells(xRowCount, 1).Interior.Color = RGB(255, 0, 0)\n    xFormatErrorCount = xFormatErrorCount + 1\nEnd If\nIf Len(xColB) &gt; 5 Then    'Check if length is greater than 5\n    Cells(xRowCount, 2).Interior.Color = RGB(255, 0, 0)\n    xFormatErrorCount = xFormatErrorCount + 1\nEnd If\nIf Len(xColC) &gt; 5 Or Cells(xRowCount, 3).NumberFormat &lt;&gt; \"0\" Then    'Check if length is greater than 5 and format is number\n    Cells(xRowCount, 3).Interior.Color = RGB(255, 0, 0)\n    xFormatErrorCount = xFormatErrorCount + 1\nEnd If\nIf Len(xColD) &gt; 18 Or Cells(xRowCount, 4).NumberFormat &lt;&gt; \"0\" Then  'Check if length is greater than 18 and format is number\n    Cells(xRowCount, 4).Interior.Color = RGB(255, 0, 0)\n    xFormatErrorCount = xFormatErrorCount + 1\nEnd If\nIf Len(xColE) &gt; 11 Or Cells(xRowCount, 5).NumberFormat &lt;&gt; \"0\" Then  'Check if length is greater than 11 and format is number\n    Cells(xRowCount, 5).Interior.Color = RGB(255, 0, 0)\n    xFormatErrorCount = xFormatErrorCount + 1\nEnd If\nFor n = 6 To 9\n    If Cells(xRowCount, n).NumberFormat &lt;&gt; \"0\" Then    'Check if format is number\n        Cells(xRowCount, n).Interior.Color = RGB(255, 0, 0)\n        xFormatErrorCount = xFormatErrorCount + 1\n    End If\nNext n\nIf Cells(xRowCount, 10).NumberFormat &lt;&gt; \"0.00\" Then    'Check if #\n    Cells(xRowCount, 10).Interior.Color = RGB(255, 0, 0)\n    xFormatErrorCount = xFormatErrorCount + 1\nEnd If\nIf Len(xColK) &gt; 1 Then    'Check if length is greater than 1\n    Cells(xRowCount, 11).Interior.Color = RGB(255, 0, 0)\n    xFormatErrorCount = xFormatErrorCount + 1\nEnd If\nIf Len(xColL) &gt; 1 Then    'Check if length is greater than 1\n    Cells(xRowCount, 12).Interior.Color = RGB(255, 0, 0)\n    xFormatErrorCount = xFormatErrorCount + 1\nEnd If\nIf Len(xColM) &gt; 1 Then  'Check if length is greater than 1\n    Cells(xRowCount, 13).Interior.Color = RGB(255, 0, 0)\n    xFormatErrorCount = xFormatErrorCount + 1\nEnd If\n</code></pre>\n\n<p>I think you could probably streamline this more using arrays.</p>\n"}], "owner": {"reputation": 13, "user_id": 4787567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22fcd52f74bd01230b789d586df249f1?s=128&d=identicon&r=PG&f=1", "display_name": "Tisha", "link": "https://stackoverflow.com/users/4787567/tisha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "accepted_answer_id": 29630108, "answer_count": 2, "score": 1, "last_activity_date": 1429021935, "creation_date": 1429019445, "question_id": 29629190, "link": "https://stackoverflow.com/questions/29629190/excel-vba-select-case-ends-select-after-finding-one-case-true-and-doesnt-comp", "title": "Excel VBA - Select Case ends select after finding one case true and doesn&#39;t complete other cases", "body": "<p>I created a loop that would check the length of columns and column types.  But once it finds a case to be true it ends the select instead of going to the next case (column) where there could be an additional error. </p>\n\n<p>'(6.1) Create loop to check for format and length errors\n           xRowCount = 1\n           xFormatErrorCount = 0</p>\n\n<pre><code>       For i = 0 To xNumOfRows - 1\n\n       xColA = Cells(xRowCount, 1).Value\n       xColB = Cells(xRowCount, 2).Value\n       xColC = Cells(xRowCount, 3).Value\n       xColD = Cells(xRowCount, 4).Value\n       xColE = Cells(xRowCount, 5).Value\n       xColF = Cells(xRowCount, 6).Value\n       xColG = Cells(xRowCount, 7).Value\n       xColH = Cells(xRowCount, 8).Value\n       xColI = Cells(xRowCount, 9).Value\n       xColJ = Cells(xRowCount, 10).Value\n       xColK = Cells(xRowCount, 11).Value\n       xColL = Cells(xRowCount, 12).Value\n       xColM = Cells(xRowCount, 13).Value\n\n       Select Case True\n\n        Case Len(xColA) &gt; 2 'Check if length is greater than 2\n         Cells(xRowCount, 1).Interior.Color = RGB(255, 0, 0)\n         xFormatErrorCount = xFormatErrorCount + 1\n\n        Case Len(xColB) &gt; 5 'Check if length is greater than 5\n         Cells(xRowCount, 2).Interior.Color = RGB(255, 0, 0)\n         xFormatErrorCount = xFormatErrorCount + 1\n\n        Case Len(xColC) &gt; 5, Cells(xRowCount, 3).NumberFormat &lt;&gt; \"0\" 'Check if length is greater than 5 and format is number\n         Cells(xRowCount, 3).Interior.Color = RGB(255, 0, 0)\n         xFormatErrorCount = xFormatErrorCount + 1\n\n        Case Len(xColD) &gt; 18, Cells(xRowCount, 4).NumberFormat &lt;&gt; \"0\"  'Check if length is greater than 18 and format is number\n         Cells(xRowCount, 4).Interior.Color = RGB(255, 0, 0)\n         xFormatErrorCount = xFormatErrorCount + 1\n\n        Case Len(xColE) &gt; 11, Cells(xRowCount, 5).NumberFormat &lt;&gt; \"0\"  'Check if length is greater than 11 and format is number\n         Cells(xRowCount, 5).Interior.Color = RGB(255, 0, 0)\n         xFormatErrorCount = xFormatErrorCount + 1\n\n        Case Cells(xRowCount, 6).NumberFormat &lt;&gt; \"0\"  'Check if format is number\n         Cells(xRowCount, 6).Interior.Color = RGB(255, 0, 0)\n         xFormatErrorCount = xFormatErrorCount + 1\n\n        Case Cells(xRowCount, 7).NumberFormat &lt;&gt; \"0\"  'Check if #\n         Cells(xRowCount, 7).Interior.Color = RGB(255, 0, 0)\n         xFormatErrorCount = xFormatErrorCount + 1\n\n        Case Cells(xRowCount, 8).NumberFormat &lt;&gt; \"0\"  'Check if #\n        Cells(xRowCount, 8).Interior.Color = RGB(255, 0, 0)\n         xFormatErrorCount = xFormatErrorCount + 1\n\n        Case Cells(xRowCount, 9).NumberFormat &lt;&gt; \"0\"  'Check if #\n         Cells(xRowCount, 9).Interior.Color = RGB(255, 0, 0)\n         xFormatErrorCount = xFormatErrorCount + 1\n\n        Case Cells(xRowCount, 10).NumberFormat &lt;&gt; \"0.00\"  'Check if # \n         Cells(xRowCount, 10).Interior.Color = RGB(255, 0, 0)\n         xFormatErrorCount = xFormatErrorCount + 1\n\n        Case Len(xColK) &gt; 1 'Check if length is greater than 1\n         Cells(xRowCount, 11).Interior.Color = RGB(255, 0, 0)\n         xFormatErrorCount = xFormatErrorCount + 1\n\n        Case Len(xColL) &gt; 1  'Check if length is greater than 1\n         Cells(xRowCount, 12).Interior.Color = RGB(255, 0, 0)\n         xFormatErrorCount = xFormatErrorCount + 1\n\n        Case Len(xColM) &gt; 1  'Check if length is greater than 1\n         Cells(xRowCount, 13).Interior.Color = RGB(255, 0, 0)\n         xFormatErrorCount = xFormatErrorCount + 1\n\n\n       End Select\n        xRowCount = xRowCount + 1\n</code></pre>\n\n<p>Next</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 866, "user_id": 3674416, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BvgRu.jpg?s=128&g=1", "display_name": "Dave0504", "link": "https://stackoverflow.com/users/3674416/dave0504"}, "is_accepted": false, "score": 0, "last_activity_date": 1429020064, "creation_date": 1429020064, "answer_id": 29629399, "question_id": 29628835, "link": "https://stackoverflow.com/questions/29628835/excel-worksheets-vba/29629399#29629399", "title": "Excel Worksheets VBA", "body": "<p>Question resolved. Stupid simple mistake like most of the annoying ones are...</p>\n\n<p><code>sh.Activate</code> missing from UserForm_Activate</p>\n\n<p>Doh...</p>\n"}], "owner": {"reputation": 866, "user_id": 3674416, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BvgRu.jpg?s=128&g=1", "display_name": "Dave0504", "link": "https://stackoverflow.com/users/3674416/dave0504"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429020064, "creation_date": 1429018550, "question_id": 29628835, "link": "https://stackoverflow.com/questions/29628835/excel-worksheets-vba", "title": "Excel Worksheets VBA", "body": "<p>another Excel 2013/VBA question...</p>\n\n<p>I'm trying to set up a userform in VBA which pulls data from a specified worksheet. I've got the form set up and I am extracting the data from the cells withou any issues barr one. The form is pulling the data from whichever sheet is active in the background. I can't workout were i'm going wrong but I am very knew to Excel/VBA. </p>\n\n<p>My first form (<code>frmMenu</code>) is a simple radio button group which I use to select the desired zone and set zoneChoice String to the correct value. the main (<code>frmNSSMain</code>) form is then loaded adn with the code i have put below, i am expecting it to pull data of of either of the two sheets in the workbook at present, \"Central\" and \"SE\".</p>\n\n<p>Unfortunately, the data is pulled off of whichever is the active sheet at run time, and not the one seletced by the user. im guessing the problem is from the activate function, <code>Set sh = line</code>. Any help appreciated.</p>\n\n<p>Code from <code>frmMenu</code></p>\n\n<pre><code>Public zoneChoice As String\n\nPrivate Sub btnLoadMain_Click()\nIf Me.optCentral Then\n    zoneChoice = \"Central\"\n    frmNSSMain.Show\n    ElseIf Me.optSE Then\n    zoneChoice = \"SE\"\n    frmNSSMain.Show\n    'ElseIf Me.optSNI Then\n    'frmNSSMain.zoneChoice = \"SNI\"\n    'frmNSSMain.Show\n    'ElseIf Me.optSW Then\n    'frmNSSMain.zoneChoice = \"SW\"\n    'frmNSSMain.Show\n    Else:\n    msg = MsgBox(\"You must choose a Zone from the right hand side before continuing!\", vbCritical)\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Code from <code>frmNSSMain</code></p>\n\n<pre><code>Public Sub UserForm_Activate()\n' Initialize worksheet variables\nSet sh = ThisWorkbook.Sheets(frmMenu.zoneChoice)\nx = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\ny = Application.WorksheetFunction.CountIf(Range(\"R2:R\" &amp; x), \"\")\n\n'K holds row count based on data in Column A\nk = sh.Range(\"A2\", sh.Range(\"A2\").End(xlDown)).Rows.Count\n\n'Disable discard, submit and no contact buttons until data is loaded\nbtnSubmit.Enabled = False\nbtnDiscard.Enabled = False\nbtnNoContact.Enabled = False\ntxtQ1Score.Enabled = False\ntxtQ2Score.Enabled = False\ntxtContactNumber.MaxLength = 11\nlblOne.Caption = frmMenu.zoneChoice\nEnd Sub\n\n\nPrivate Sub btnRetrieve_Click()\n\n    ' Check Data for NSS surveys is available, if so retrieve data, else show error message\n    If y &gt; 0 Then\n\n        'Select random row\n        aRandNum = Int((k - 2) * Rnd + 2)\n\n        'Set global variable aRow to held selected row\n        aRow = Replace(Str(aRandNum), \" \", \"\")\n\n        'Get Area\n        areaName = Replace(\"D\" &amp; Str(aRandNum), \" \", \"\")\n        txtArea.Text = Range(areaName).Value\n\n        'Get Establishment\n        establishmentName = Replace(\"E\" &amp; Str(aRandNum), \" \", \"\")\n        txtEstablishment.Text = Range(establishmentName).Value\n\n        'Get End User Name\n        endUserName = Replace(\"F\" &amp; Str(aRandNum), \" \", \"\")\n        txtName.Text = Range(endUserName).Value\n\n        'Get End User Contact Number\n        endUserTelNum = Replace(\"G\" &amp; Str(aRandNum), \" \", \"\")\n        txtContactNumber.Text = Replace(Range(endUserTelNum).Value, \" \", \"\")\n        txtContactNumber.Enabled = True\n        txtContactNumber.Locked = False\n\n        'Get Job Description\n        jobDescription = Replace(\"I\" &amp; Str(aRandNum), \" \", \"\")\n        txtJobDescription.Text = Range(jobDescription).Value\n\n        'Get contractor\n        contractorName = Replace(\"H\" &amp; Str(aRandNum), \" \", \"\")\n        txtContractor.Text = Range(contractorName).Value\n\n        'Get job number\n        jobNumber = Replace(\"C\" &amp; Str(aRandNum), \" \", \"\")\n        txtJobNumber.Text = Range(jobNumber).Value\n\n        ' reported by, contact number, contractor, job description, comments, raised by, survey by,\n\n        ' Disable get NSS data button after retrieval and activate other discard, submit and no contact\n        btnSubmit.Enabled = True\n        btnDiscard.Enabled = True\n        btnNoContact.Enabled = True\n        btnRetrieve.Enabled = False\n        txtQ1Score.Enabled = True\n        txtQ2Score.Enabled = True\n\n        ElseIf y &lt; 1 Then\n\n        Dim result As String\n        result = MsgBox(\"No NSS data available. Please inform Management Team.\", vbCritical)\n\n    End If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1429018625, "post_id": 29628658, "comment_id": 47400487, "body": "If you are calling that function from a cell, you cannot alter the value of a different cell."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1429018724, "post_id": 29628658, "comment_id": 47400576, "body": "Your code worked for me. Check to make sure you have valid values in <code>res</code>."}, {"owner": {"reputation": 628, "user_id": 4595909, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/135635506b604fd32a3c74aeddad8b0f?s=128&d=identicon&r=PG&f=1", "display_name": "kitap mitap", "link": "https://stackoverflow.com/users/4595909/kitap-mitap"}, "edited": false, "score": 0, "creation_date": 1429019850, "post_id": 29628658, "comment_id": 47401414, "body": "Yes, code works. It may be useful to see the function."}], "answers": [{"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 1, "last_activity_date": 1429071476, "creation_date": 1429071476, "answer_id": 29641506, "question_id": 29628658, "link": "https://stackoverflow.com/questions/29628658/excel-vba-write-2d-array-to-another-worksheet/29641506#29641506", "title": "Excel VBA: Write 2D array to another worksheet", "body": "<p>Your existing code should work.</p>\n\n<p>Does <code>Res</code> actually contain data?</p>\n\n<p>Sample below that populates an array, checks if it is more than one cell, then dumps back to the worksheet.</p>\n\n<pre><code>Dim wb As Workbook\nDim ws As Worksheet\nDim ws2 As Worksheet\n\nDim rng1 As Range\nDim res\n\nSet wb = ThisWorkbook\nSet ws = wb.Worksheets(\"Input\")\nSet ws1 = wb.Worksheets(\"Output\")\n\nSet rng1 = ws.Range(\"A1:B10\")\n\nIf rng1.Cells.Count &gt; 1 Then\n    res = rng1.Value2\n    ws1.[a1].Resize(UBound(res, 1), UBound(res, 2)).Value2 = res\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1510, "user_id": 1184934, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/283cb558c14cd2b49411ac4bb1eb1d5d?s=128&d=identicon&r=PG", "display_name": "charles hendry", "link": "https://stackoverflow.com/users/1184934/charles-hendry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1988, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429186942, "creation_date": 1429018145, "question_id": 29628658, "link": "https://stackoverflow.com/questions/29628658/excel-vba-write-2d-array-to-another-worksheet", "title": "Excel VBA: Write 2D array to another worksheet", "body": "<p>I have a VBA function that creates a 2D array <code>res</code>. I'd like to write the array data to another worksheet, not the current worksheet the function is executed from. This should be pretty straightforwards but i'm new to VBA.</p>\n\n<p>The code ends on the last line without an error message or writing any data.</p>\n\n<pre><code>Dim wb As Workbook\nDim ws As Worksheet\nSet wb = ThisWorkbook\nSet ws = wb.Worksheets(\"Output\")\n\nDim out As Range\nSet out = ws.Range(\"A1\")\nout.Resize(UBound(res, 1), UBound(res, 2)).Value = res\n</code></pre>\n"}, {"tags": ["vba", "excel", "audit-trail"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 3983869, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/KhK7j.jpg?s=128&g=1", "display_name": "BenC", "link": "https://stackoverflow.com/users/3983869/benc"}, "edited": false, "score": 0, "creation_date": 1429019398, "post_id": 29629070, "comment_id": 47401079, "body": "Thanks Mark this was very helpful and make the code look a lot neater."}], "tags": [], "owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "is_accepted": true, "score": 1, "last_activity_date": 1429019124, "creation_date": 1429019124, "answer_id": 29629070, "question_id": 29628220, "link": "https://stackoverflow.com/questions/29628220/exclude-cell-range-from-worksheet-change-function/29629070#29629070", "title": "Exclude Cell Range from Worksheet_Change function", "body": "<p>In your Workbook_BeforeSave add:</p>\n\n<p><code>Application.EnableEvents = False</code></p>\n\n<p>before changing the sheets <strong>but be sure to add</strong></p>\n\n<pre><code>Application.EnableEvents = True\n</code></pre>\n\n<p>before ending the Sub.</p>\n\n<p>This prevents the <code>Worksheet_Change</code> event from being triggered so nothing gets written to your log. </p>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 3983869, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/KhK7j.jpg?s=128&g=1", "display_name": "BenC", "link": "https://stackoverflow.com/users/3983869/benc"}, "is_accepted": false, "score": 0, "last_activity_date": 1429019157, "creation_date": 1429019157, "answer_id": 29629079, "question_id": 29628220, "link": "https://stackoverflow.com/questions/29628220/exclude-cell-range-from-worksheet-change-function/29629079#29629079", "title": "Exclude Cell Range from Worksheet_Change function", "body": "<p>After a bit more searching I was able to locate the answer to this query:-</p>\n\n<p>To exclude certain cells from the Worksheet_Change function all you have to do is add the following line of code for the cells in question:-</p>\n\n<pre><code> If Target.Address = \"Cell number\" Then Exit Sub\n</code></pre>\n\n<p>The final code will look like this:-</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Address = \"$D$5\" Then Exit Sub\nIf Target.Address = \"$E$5\" Then Exit Sub\n''Excludes cells D5 and E5 from Worksheet_Change call''\nIf Target.Value &lt;&gt; PreviousValue Then\n    Sheets(\"log\").Cells(65000, 1).End(xlUp).Offset(1, 0).Value = _\n        Application.UserName &amp; \" changed cell \" &amp; Target.Address _\n        &amp; \" from \" &amp; PreviousValue &amp; \" to \" &amp; Target.Value\nEnd If\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\nPreviousValue = Target.Value\n End Sub\n</code></pre>\n\n<p>I'm sure someone on here will be able to make this code look neater though as is it does what I require it to do. </p>\n"}, {"tags": [], "owner": {"reputation": 746, "user_id": 4733869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f0b856d3215d1cbde059e0d411ab55?s=128&d=identicon&r=PG&f=1", "display_name": "Dawid", "link": "https://stackoverflow.com/users/4733869/dawid"}, "is_accepted": false, "score": 0, "last_activity_date": 1429019550, "creation_date": 1429019550, "answer_id": 29629231, "question_id": 29628220, "link": "https://stackoverflow.com/questions/29628220/exclude-cell-range-from-worksheet-change-function/29629231#29629231", "title": "Exclude Cell Range from Worksheet_Change function", "body": "<p>You can use <code>Intersect</code> in your case:</p>\n\n<pre><code> Private Sub Worksheet_Change(ByVal Target As Range)\n   If Target.Value &lt;&gt; PreviousValue AND Intersect(Target, Range(\"D4,D5,E5\")) Is Nothing Then\n    Sheets(\"log\").Cells(65000, 1).End(xlUp).Offset(1, 0).Value = _\n        Application.UserName &amp; \" changed cell \" &amp; Target.Address _\n        &amp; \" from \" &amp; PreviousValue &amp; \" to \" &amp; Target.Value\n  End If\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 3983869, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/KhK7j.jpg?s=128&g=1", "display_name": "BenC", "link": "https://stackoverflow.com/users/3983869/benc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1044, "favorite_count": 0, "accepted_answer_id": 29629070, "answer_count": 3, "score": 0, "last_activity_date": 1429019550, "creation_date": 1429016991, "last_edit_date": 1429018200, "question_id": 29628220, "link": "https://stackoverflow.com/questions/29628220/exclude-cell-range-from-worksheet-change-function", "title": "Exclude Cell Range from Worksheet_Change function", "body": "<p>I'm currently trying to set up a spread sheet which will allow me to keep a track of each time someone in the office changes any information within it, I have got this to work via the following code:- </p>\n\n<pre><code>Dim PreviousValue\n\n Private Sub Worksheet_Change(ByVal Target As Range)\n   If Target.Value &lt;&gt; PreviousValue Then\n    Sheets(\"log\").Cells(65000, 1).End(xlUp).Offset(1, 0).Value = _\n        Application.UserName &amp; \" changed cell \" &amp; Target.Address _\n        &amp; \" from \" &amp; PreviousValue &amp; \" to \" &amp; Target.Value\n  End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n PreviousValue = Target.Value\nEnd Sub\n</code></pre>\n\n<p>Which logs any changes to all the cells in the workbook. However I also have this code:-</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n Sheets(\"MEP 01\").Range(\"D5\").Value = Date\n Sheets(\"MEP 01\").Range(\"E5\").Value = Time\nEnd Sub\n</code></pre>\n\n<p>This then logs the last time the document was saved, I would like to know if there is any way I can remove cells D5 and E5 from the audit code, as these two cells along with D4 (which contains =TODAY() formula) will change often and will make my audit trail rather large.</p>\n\n<p>Any help would be most appreciated. </p>\n"}, {"tags": ["vba", "teradata"], "comments": [{"owner": {"reputation": 7316, "user_id": 2751573, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/GsKBw.jpg?s=128&g=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/2751573/andrew"}, "edited": false, "score": 0, "creation_date": 1429036484, "post_id": 29627000, "comment_id": 47412013, "body": "What version of Teradata is your database, and what version of the driver do you have installed?"}], "answers": [{"tags": [], "owner": {"reputation": 2323, "user_id": 1682, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a5819b544c84f20e3443e408dffdaed4?s=128&d=identicon&r=PG", "display_name": "Anthony K", "link": "https://stackoverflow.com/users/1682/anthony-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1468378896, "creation_date": 1468378896, "answer_id": 38341970, "question_id": 29627000, "link": "https://stackoverflow.com/questions/29627000/run-time-error-teradata-the-object-name-is-too-long-in-nfd-nfc/38341970#38341970", "title": "Run time error [Teradata] The object name is too long in NFD/NFC", "body": "<p>I had this error when running an update query in SQL Assistant.  I had enclosed my text field in double quotes rather than single quotes.  Teradata interpreted the double quotes as a column name.  You might like to review your code and see that there isn't any way the quotes could be embedded in your VBA code.</p>\n"}], "owner": {"reputation": 43, "user_id": 4675346, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/941d7a6d4d66f593107f6a53cd0be200?s=128&d=identicon&r=PG&f=1", "display_name": "Rajyalakshmi Gangisetty", "link": "https://stackoverflow.com/users/4675346/rajyalakshmi-gangisetty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2385, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1468378896, "creation_date": 1429013590, "last_edit_date": 1429350858, "question_id": 29627000, "link": "https://stackoverflow.com/questions/29627000/run-time-error-teradata-the-object-name-is-too-long-in-nfd-nfc", "title": "Run time error [Teradata] The object name is too long in NFD/NFC", "body": "<p>When I try to run a SQL query through VBA Code it is throwing the below error: </p>\n\n<blockquote>\n  <p>Run time error -2147467259(80004005)<br>\n  [Teradata] The object name is too long in NFD/NFC</p>\n</blockquote>\n\n<pre><code>Set rec1 = New ADODB.Recordset\nrec1.Open oSql, conn\nWorksheets(\"BO_Output\").range(\"A\" &amp; (N)).Value = thissql\n</code></pre>\n\n<p>My query is working fine when I run it in SQL assistant</p>\n"}, {"tags": ["vba", "email", "excel", "dynamic"], "comments": [{"owner": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "edited": false, "score": 0, "creation_date": 1429351111, "post_id": 29626784, "comment_id": 47566239, "body": "links of your images are removed !! ;)."}], "answers": [{"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 0, "last_activity_date": 1429025305, "last_edit_date": 1495542129, "creation_date": 1429025305, "answer_id": 29631400, "question_id": 29626784, "link": "https://stackoverflow.com/questions/29626784/excel-vba-how-do-copy-dynamic-background-color-of-excel-cell-to-email-body-usi/29631400#29631400", "title": "Excel VBA - How do copy dynamic background color of excel cell to email body using macro?", "body": "<p>Take a look at <a href=\"https://stackoverflow.com/questions/29420752/range-in-middle-of-the-email-body/29421995#29421995\">Range in Middle of Email Body</a>. My code there also uses Ron de Bruin's <code>RangeToHTML</code> method and copies/preserves all cell formats into the email body.</p>\n"}], "owner": {"reputation": 11, "user_id": 4787105, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gjSDgt06cbc/AAAAAAAAAAI/AAAAAAAACPU/ssj0d3KS4Ww/photo.jpg?sz=128", "display_name": "Prem", "link": "https://stackoverflow.com/users/4787105/prem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1051, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1429351066, "creation_date": 1429012962, "last_edit_date": 1531164843, "question_id": 29626784, "link": "https://stackoverflow.com/questions/29626784/excel-vba-how-do-copy-dynamic-background-color-of-excel-cell-to-email-body-usi", "title": "Excel VBA - How do copy dynamic background color of excel cell to email body using macro?", "body": "<p>This is an Excel file, here red color is static background and green color is dynamic background and it will change based on dynamic value as mentioned below.<br>\n![enter image description here][1]</p>\n\n<p>I have used below code to copy the selected range of Excel sheet and paste it in email body.</p>\n\n<pre><code>Sub Mail_Selection_Range_Outlook_Body()\n'For Tips see: http://www.rondebruin.nl/win/winmail/Outlook/tips.htm\n'Don't forget to copy the function RangetoHTML in the module.\n'Working in Excel 2000-2013\nDim rng As Range\nDim OutApp As Outlook.Application\nDim OutMail As Outlook.MailItem\n\nSet rng = Nothing\nOn Error Resume Next\n'Only the visible cells in the selection\nSet rng = Selection.SpecialCells(xlCellTypeVisible)\n'You can also use a fixed range if you want\n'Set rng = Sheets(\"YourSheet\").Range(\"D4:D12\").SpecialCells(xlCellTypeVisible)\nOn Error GoTo 0\n\nIf rng Is Nothing Then\n    MsgBox \"The selection is not a range or the sheet is protected\" &amp; _\n           vbNewLine &amp; \"please correct and try again.\", vbOKOnly\n    Exit Sub\nEnd If\n\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(olMailItem)\n\nOn Error Resume Next\nWith OutMail\n    .To = \"ron@debruin.nl\"\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = \"This is the Subject line\"\n    .HTMLBody = RangetoHTML(rng)\n    .Save   'or use .Display\nEnd With\nOn Error GoTo 0\n\nWith Application\n    .EnableEvents = True\n    .ScreenUpdating = True\nEnd With\n\nSet OutMail = Nothing\nSet OutApp = Nothing\nEnd Sub\n\nFunction RangetoHTML(rng As Range)\n' Changed by Ron de Bruin 28-Oct-2006\n' Working in Office 2000-2013\nDim fso As Object\nDim ts As Object\nDim TempFile As String\nDim TempWB As Workbook\n\nTempFile = Environ$(\"temp\") &amp; \"\\\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n\n'Copy the range and create a new workbook to past the data in\nrng.Copy\nSet TempWB = Workbooks.Add(1)\nWith TempWB.Sheets(1)\n    .Cells(1).PasteSpecial Paste:=8\n    .Cells(1).PasteSpecial xlPasteValues, , False, False\n    .Cells(1).PasteSpecial xlPasteFormats, , False, False\n    .Cells(1).Select\n    Application.CutCopyMode = False\n    On Error Resume Next\n    .DrawingObjects.Visible = True\n    .DrawingObjects.Delete\n    On Error GoTo 0\nEnd With\n\n'Publish the sheet to a htm file\nWith TempWB.PublishObjects.Add( _\n     SourceType:=xlSourceRange, _\n     Filename:=TempFile, _\n     Sheet:=TempWB.Sheets(1).Name, _\n     Source:=TempWB.Sheets(1).UsedRange.Address, _\n     HtmlType:=xlHtmlStatic)\n    .Publish (True)\nEnd With\n\n'Read all data from the htm file into RangetoHTML\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\nRangetoHTML = ts.readall\nts.Close\nRangetoHTML = Replace(RangetoHTML, \"align=center x:publishsource=\", _\n                      \"align=left x:publishsource=\")\n\n'Close TempWB\nTempWB.Close savechanges:=False\n\n'Delete the htm file we used in this function\nKill TempFile\n\nSet ts = Nothing\nSet fso = Nothing\nSet TempWB = Nothing\nEnd Function\n</code></pre>\n\n<p>After run the above code  all values are copied in Email except dynamic background color. Please help me out.<br>\n![enter image description here][2]</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007", "ms-access-2010"], "comments": [{"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1429009665, "post_id": 29625478, "comment_id": 47394686, "body": "Make sure that you include the parentheses after the function name in the <code>RunCode</code> step, e.g., <code>DsnLessLinkTable()</code>."}, {"owner": {"reputation": 179, "user_id": 4711707, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1037383746276136/picture?type=large", "display_name": "Noora No", "link": "https://stackoverflow.com/users/4711707/noora-no"}, "reply_to_user": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1429014150, "post_id": 29625478, "comment_id": 47397370, "body": "thanks @GordThompson for the reply, it worked for both parentheses () and double quotes &quot; &quot;, which one i can consider correct?"}], "answers": [{"tags": [], "owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "is_accepted": true, "score": 1, "last_activity_date": 1429018723, "creation_date": 1429018723, "answer_id": 29628917, "question_id": 29625478, "link": "https://stackoverflow.com/questions/29625478/cannot-find-name-when-running-autoexec-macro/29628917#29628917", "title": "cannot find name when running AutoExec macro", "body": "<p>If you're using a function, you should always include a set of parenthesis at the end:</p>\n\n<pre><code>DsnLessLinkTable()\n</code></pre>\n\n<p>This is the proper way to reference a function, and becomes important if you are ever passing variables to a function, so it's good practice to always use that syntax.</p>\n"}], "owner": {"reputation": 179, "user_id": 4711707, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1037383746276136/picture?type=large", "display_name": "Noora No", "link": "https://stackoverflow.com/users/4711707/noora-no"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 29628917, "answer_count": 1, "score": 1, "last_activity_date": 1429018723, "creation_date": 1429008685, "last_edit_date": 1429012067, "question_id": 29625478, "link": "https://stackoverflow.com/questions/29625478/cannot-find-name-when-running-autoexec-macro", "title": "cannot find name when running AutoExec macro", "body": "<p>In Access I created a Function within a Module.</p>\n\n<p>I need to execute this module when the Access application first opens.</p>\n\n<p>In the AutoExec macro, I added the action <code>[RunCode]</code> and wrote the name of the function from this module in <code>[Function Name]</code> but when I run the application I am getting the following error:\n<img src=\"https://i.stack.imgur.com/dGx14.png\" alt=\"access error msg\"></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "is_accepted": true, "score": 1, "last_activity_date": 1429011539, "last_edit_date": 1429011539, "creation_date": 1429008595, "answer_id": 29625451, "question_id": 29625351, "link": "https://stackoverflow.com/questions/29625351/saving-any-file-with-vba-code/29625451#29625451", "title": "saving any file with VBA code", "body": "<p>There should be so many options for you FileCopy, Move, Name etc. are a few. </p>\n\n<p>However, Ron De Bruin, has a great article on this, <a href=\"http://www.rondebruin.nl/win/s3/win026.htm\" rel=\"nofollow\">http://www.rondebruin.nl/win/s3/win026.htm</a></p>\n"}], "owner": {"reputation": 367, "user_id": 2615718, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ec6cedf22cdd0b7c9b9fec0e1377865e?s=128&d=identicon&r=PG", "display_name": "Artur Rutkowski", "link": "https://stackoverflow.com/users/2615718/artur-rutkowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 29625451, "answer_count": 1, "score": 0, "last_activity_date": 1429011539, "creation_date": 1429008275, "last_edit_date": 1429011498, "question_id": 29625351, "link": "https://stackoverflow.com/questions/29625351/saving-any-file-with-vba-code", "title": "saving any file with VBA code", "body": "<p>Is it possible to save any file with VBA code?</p>\n\n<p>Speciffically I a trying to save an already existing PDF file to a different lacation. The macro is run within excel workbook.</p>\n\n<p>I have been  browsing net for the answer, yet resultlessly, maybe I am asking wrong questions.</p>\n\n<p>I would appreciate any help, pointing to tge right  \"key words\" would be much appreciated as well.</p>\n"}, {"tags": ["excel", "vba", "datepicker"], "answers": [{"tags": [], "owner": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "is_accepted": false, "score": 0, "last_activity_date": 1429011239, "creation_date": 1429011239, "answer_id": 29626251, "question_id": 29625307, "link": "https://stackoverflow.com/questions/29625307/add-vba-code-to-date-picker-to-control-allowed-dates/29626251#29626251", "title": "Add VBA code to date picker to control allowed dates", "body": "<p>Your code needs to track the change in Worksheet... Try this</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n  If Target.Value &gt; Date And Target.Column = 3 Then 'The Second part Target.Column assumes that you have the Dates that are being changes in the second column\n    MsgBox \"Error\"\n  End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4786366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fe42745693945767634bfa9b64392aa?s=128&d=identicon&r=PG&f=1", "display_name": "James Michael", "link": "https://stackoverflow.com/users/4786366/james-michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1068, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429011239, "creation_date": 1429008170, "last_edit_date": 1429008349, "question_id": 29625307, "link": "https://stackoverflow.com/questions/29625307/add-vba-code-to-date-picker-to-control-allowed-dates", "title": "Add VBA code to date picker to control allowed dates", "body": "<p>I am using the following formula to embed a date picker in my cell.</p>\n\n<pre><code>=EMBED(\"LDDATETIME.LDDateCtrl.1\",\"\")\n</code></pre>\n\n<p>My question is how can I control the dates that a user can select. For instance I don't want them to be able to select any future dates only past dates.</p>\n\n<p>I have tried this but it gives me an object undefined error:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nIf LDDate1 &gt; Date Then\nMsgBox \"Error\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Please can someone show me where I am going wrong with this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 742, "user_id": 2301065, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f6053c23bdf62e14f7fc8d3473ef0658?s=128&d=identicon&r=PG", "display_name": "Rossco", "link": "https://stackoverflow.com/users/2301065/rossco"}, "edited": false, "score": 0, "creation_date": 1429004909, "post_id": 29623861, "comment_id": 47391878, "body": "What is Banner?  It isn&#39;t defined in the code you&#39;ve posted."}, {"owner": {"reputation": 92, "user_id": 323257, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xn0eo.jpg?s=128&g=1", "display_name": "Neil Cooper", "link": "https://stackoverflow.com/users/323257/neil-cooper"}, "reply_to_user": {"reputation": 742, "user_id": 2301065, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f6053c23bdf62e14f7fc8d3473ef0658?s=128&d=identicon&r=PG", "display_name": "Rossco", "link": "https://stackoverflow.com/users/2301065/rossco"}, "edited": false, "score": 0, "creation_date": 1429006365, "post_id": 29623861, "comment_id": 47392722, "body": "Sorry, it&#39;s defined in a public module outside of this <code>Option Explicit  Public Type Banner     imagePath As String     retImagePath As String     urlPath As String     bannerTitle As String End Type</code>"}], "answers": [{"comments": [{"owner": {"reputation": 92, "user_id": 323257, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xn0eo.jpg?s=128&g=1", "display_name": "Neil Cooper", "link": "https://stackoverflow.com/users/323257/neil-cooper"}, "edited": false, "score": 0, "creation_date": 1429009698, "post_id": 29625294, "comment_id": 47394702, "body": "This is great :) thanks for the swift help - i&#39;d never even heard of &#39;With&#39; - VBA definitely isn&#39;t my first language - can you tell? ;)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1429008136, "creation_date": 1429008136, "answer_id": 29625294, "question_id": 29623861, "link": "https://stackoverflow.com/questions/29623861/output-doesnt-match-input/29625294#29625294", "title": "Output doesn&#39;t match input", "body": "<p>You are setting <code>allCells</code> to a distinct range of cells correctly.</p>\n\n<pre><code>  Set allCells = mySheet.Range(\"a2\", mySheet.Cells(lastRow, lastCol))\n</code></pre>\n\n<p>Then you loop through each row in the <code>allCells</code> range.</p>\n\n<pre><code>  For Each r In allCells.Rows\n</code></pre>\n\n<p>But when you actually go to use <em>r</em>, it is only to use the row number.</p>\n\n<pre><code>  thisBanner.imagePath = Cells(r.Row, 2).Value\n</code></pre>\n\n<p><code>r.Row</code> is a number between 1 and 1,048,576, nothing more. There is no guarantee that <code>Cells(r.Row, 2).Value</code> refers to something on <strong>mySheet</strong>; only that whatever worksheet it is coming from it will using whatever worksheet's row number that corresponds to <code>r.row</code>. You need to define some parentage. An <code>With ... End With</code> block within the <code>For ... Next</code> and properly annotated <code>.Range</code> and <code>.Cell</code> references should suffice.</p>\n\n<pre><code>Sub createCode()\n\n    Dim myWorkbook As Workbook\n    Dim mySheet As Worksheet\n    Dim bannerCount As Integer\n    Dim BannerCollection() As Banner\n    Dim r As Range\n    Dim lastRow, lastCol\n    Dim allCells As Range\n\n    Set myWorkbook = Application.ActiveWorkbook\n\n    For Each mySheet In myWorkbook.Worksheets\n        With mySheet\n            'declare your vars outside the loop and zero/null then here if necessary.\n            bannerCount = 0\n            lastCol = .Range(\"a2\").End(xlToRight).Column\n            lastRow = .Range(\"a2\").End(xlDown).Row\n            Set allCells = .Range(\"a2\", .Cells(lastRow, lastCol))\n        '    MsgBox (mySheet.Name)\n        '    MsgBox (\"lastRow:\" &amp; lastRow &amp; \"lastCol:\" &amp; lastCol)\n            ReDim BannerCollection(allCells.Rows.Count)\n\n            For Each r In allCells.Rows\n                Dim thisBanner As Banner\n                thisBanner.imagePath = \"\"\n                thisBanner.retImagePath = \"\"\n                thisBanner.bannerTitle = \"\"\n                thisBanner.urlPath = \"\"\n                bannerCount = bannerCount + 1\n        '        MsgBox (bannerCount)\n                thisBanner.imagePath = .Cells(r.Row, 2).Value\n                thisBanner.retImagePath = .Cells(r.Row, 3).Value\n                thisBanner.bannerTitle = .Cells(r.Row, 4).Value\n                thisBanner.urlPath = .Cells(r.Row, 5).Value\n                'MsgBox (.Cells(r.Row, 2).Value)\n                'MsgBox (.Cells(r.Row, 3).Value)\n                'MsgBox (.Cells(r.Row, 4).Value)\n                'MsgBox (.Cells(r.Row, 5).Value)\n                BannerCollection(bannerCount - 1) = thisBanner\n            Next r\n\n            Dim i As Variant\n            Dim retinaCSS, imgCSS, firstBannerCode, otherBannersCode, bannerTracking As String\n            retinaCSS = \"\"\n            imgCSS = \"\"\n            firstBannerCode = \"\"\n            otherBannersCode = \"\"\n            bannerTracking = \"\"\n\n\n            For i = 0 To bannerCount - 1\n                bannerTracking = BannerCollection(i).bannerTitle\n                bannerTracking = Replace(bannerTracking, \" \", \"+\")\n                bannerTracking = Replace(bannerTracking, \"&amp;\", \"And\")\n                bannerTracking = Replace(bannerTracking, \"%\", \"PC\")\n                bannerTracking = Replace(bannerTracking, \"!\", \"\")\n                bannerTracking = Replace(bannerTracking, \"\u00c2\u00a3\", \"\")\n                bannerTracking = Replace(bannerTracking, \",\", \"\")\n                bannerTracking = Replace(bannerTracking, \"'\", \"\")\n                bannerTracking = Replace(bannerTracking, \"#\", \"\")\n                bannerTracking = Replace(bannerTracking, \".\", \"\")\n                retinaCSS = retinaCSS &amp; \"#sliderTarget .banner-\" &amp; i + 1 &amp; \"{background-image: url('/assets/static/\" &amp; BannerCollection(i).retImagePath &amp; \"');}\" &amp; vbNewLine\n                imgCSS = imgCSS &amp; \"#sliderTarget .banner-\" &amp; i + 1 &amp; \"{background-image: url('/assets/static/\" &amp; BannerCollection(i).imagePath &amp; \"');}\" &amp; vbNewLine\n                If i = 0 Then\n                    firstBannerCode = firstBannerCode &amp; \"&lt;div class=\" &amp; Chr(34) &amp; \"banner banner-\" &amp; i + 1 &amp; \" staticBanner\" &amp; Chr(34) &amp; \"&gt;\" &amp; vbNewLine\n                    firstBannerCode = firstBannerCode &amp; \"&lt;a href=\" &amp; Chr(34) &amp; BannerCollection(i).urlPath &amp; Chr(34) &amp; \" manual_cm_re=\" &amp; Chr(34) &amp; \"MAINBANNER-_-BANNER+\" &amp; i + 1 &amp; \"-_-\" &amp; bannerTracking &amp; Chr(34) &amp; \"&gt;&lt;/a&gt;\" &amp; vbNewLine\n                    firstBannerCode = firstBannerCode &amp; \"&lt;/div&gt;\" &amp; vbNewLine\n                Else\n                    otherBannersCode = otherBannersCode &amp; \"&lt;div class=\" &amp; Chr(34) &amp; \"banner banner-\" &amp; i + 1 &amp; \" staticBanner\" &amp; Chr(34) &amp; \"&gt;\" &amp; vbNewLine\n                    otherBannersCode = otherBannersCode &amp; \"&lt;a href=\" &amp; Chr(34) &amp; BannerCollection(i).urlPath &amp; Chr(34) &amp; \" manual_cm_re=\" &amp; Chr(34) &amp; \"MAINBANNER-_-BANNER+\" &amp; i + 1 &amp; \"-_-\" &amp; bannerTracking &amp; Chr(34) &amp; \"&gt;&lt;/a&gt;\" &amp; vbNewLine\n                    otherBannersCode = otherBannersCode &amp; \"&lt;/div&gt;\" &amp; vbNewLine\n                End If\n        '        MsgBox (BannerCollection(i).retImagePath &amp; vbNewLine &amp; BannerCollection(i).imagePath &amp; vbNewLine &amp; BannerCollection(i).bannerTitle &amp; vbNewLine &amp; BannerCollection(i).urlPath)\n\n            Next i\n\n            CodeString = \"\"\n            CodeString = CodeString &amp; \"&lt;style type=\" &amp; Chr(34) &amp; \"text/css\" &amp; Chr(34) &amp; \"&gt;\" &amp; vbNewLine\n            CodeString = CodeString &amp; \"/* Banners */\" &amp; vbNewLine\n            CodeString = CodeString &amp; imgCSS\n            CodeString = CodeString &amp; \"/* Retina Banners */\" &amp; vbNewLine\n            CodeString = CodeString &amp; \"@media only screen and (-webkit-min-device-pixel-ratio: 2) {\" &amp; vbNewLine\n            CodeString = CodeString &amp; retinaCSS\n            CodeString = CodeString &amp; \"}\" &amp; vbNewLine\n            CodeString = CodeString &amp; \"&lt;/style&gt;\" &amp; vbNewLine\n            CodeString = CodeString &amp; \"&lt;div id=\" &amp; Chr(34) &amp; \"sliderTarget\" &amp; Chr(34) &amp; \" class=\" &amp; Chr(34) &amp; \"slides\" &amp; Chr(34) &amp; \"&gt;\" &amp; vbNewLine\n            CodeString = CodeString &amp; firstBannerCode\n            CodeString = CodeString &amp; \"&lt;/div&gt;\" &amp; vbNewLine\n            CodeString = CodeString &amp; \"&lt;script id=\" &amp; Chr(34) &amp; \"sliderTemplate\" &amp; Chr(34) &amp; \" type=\" &amp; Chr(34) &amp; \"text/template\" &amp; Chr(34) &amp; \"&gt;\" &amp; vbNewLine\n            CodeString = CodeString &amp; otherBannersCode\n            CodeString = CodeString &amp; \"&lt;/script&gt;\"\n\n            FilePath = Application.DefaultFilePath &amp; \"\\\" &amp; mySheet.Name &amp; \"code.txt\"\n            Open FilePath For Output As #2\n            Print #2, CodeString\n            Close #2\n            MsgBox (\"code.txt contains:\" &amp; CodeString)\n            MsgBox (Application.DefaultFilePath &amp; \"\\\" &amp; mySheet.Name &amp; \"code.txt\")\n            Erase BannerCollection\n        End With\n    Next mySheet\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 92, "user_id": 323257, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xn0eo.jpg?s=128&g=1", "display_name": "Neil Cooper", "link": "https://stackoverflow.com/users/323257/neil-cooper"}, "edited": false, "score": 0, "creation_date": 1429009723, "post_id": 29625400, "comment_id": 47394718, "body": "Thanks for this, i&#39;ll definitely be bearing it in mind as this little piece is bound to expand further :D"}], "tags": [], "owner": {"reputation": 742, "user_id": 2301065, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f6053c23bdf62e14f7fc8d3473ef0658?s=128&d=identicon&r=PG", "display_name": "Rossco", "link": "https://stackoverflow.com/users/2301065/rossco"}, "is_accepted": false, "score": 2, "last_activity_date": 1429008428, "creation_date": 1429008428, "answer_id": 29625400, "question_id": 29623861, "link": "https://stackoverflow.com/questions/29623861/output-doesnt-match-input/29625400#29625400", "title": "Output doesn&#39;t match input", "body": "<p>I ended up doing a bit of a code review (oops spent too much time on the Code Review site).  I'll post this here in addition to @Jeeped answer in case you get some value from it.</p>\n\n<h2>Option Explicit</h2>\n\n<p>You should specify <code>Option Explicit</code> at the top of each code module.  What this does is tell the VBA compiler to check that every variable that you are trying to use has been declared (i.e. you've got <code>Dim blah as String</code>, <code>Public blah as String</code> or <code>Private blah as String</code> for each <code>blah</code> you're using).</p>\n\n<p>If you attempt to use a variable which hasn't been declared, the compiler will give you a compilation error where the first problem occurs.  This helps if you mistype a variable name, otherwise the compiler will think you are talking about something new. </p>\n\n<p>Adding this to the top of your code requires a couple of declarations in your code but nothing major.</p>\n\n<h2>Multiple variable declaration on a single line</h2>\n\n<p>Don't do it.  You have the following line: <code>Dim retinaCSS, imgCSS, firstBannerCode, otherBannersCode, bannerTracking As String</code> which declares 5 variables.  The first 4 are declared as variants and the last one is a String.  Now your code may work like this but you were probably expecting all 5 to be Strings.  Other languages I believe do operate this way but VBA doesn't.</p>\n\n<p>Declare them separately like:</p>\n\n<pre><code>Dim retinaCSS As String\nDim imgCSS As String\nDim firstBannerCode As String\nDim otherBannersCode As String\nDim bannerTracking As String\n</code></pre>\n\n<h2>Don't initialise variables unnecessarily</h2>\n\n<p>I see code like:</p>\n\n<pre><code>    CodeString = \"\"\n    CodeString = CodeString &amp; \"&lt;style type=\" &amp; Chr(34) &amp; \"text/css\" &amp; Chr(34) &amp; \"&gt;\" &amp; vbNewLine\n</code></pre>\n\n<p>Now the problem with this is that you're assigning the empty string value to CodeString but then you are immediately assigning something else to it in the very next line.  The risk is that you might try to use a variable before you have assigned something to it.  This isn't a risk for the string type since it implicitly assigned an empty string value when it is created.</p>\n\n<p>You can safely remove the first assignment to it.  The danger could come from object references.  Say if you have a reference to a worksheet but do not assign a worksheet to the variable before you try to use it.  In any case you want to make sure that your variable has the required value before you attempt to use the value it holds.</p>\n\n<h2>Use Collection instead of an array</h2>\n\n<p>The array code is cumbersome and inflexible.  VBA has a simple collection type which allows you to add and remove items to and from it without having to declare a fixed size.  </p>\n\n<p>You can also iterate through the contents using a <code>For Each</code> loop.</p>\n\n<p>Here is the code I'm recommending:</p>\n\n<pre><code>    Dim BannerCollection As Collection\n    Set BannerCollection = New Collection\n    ' ...\n    For Each r In allCells.Rows\n        Dim thisBanner As Banner\n        Set thisBanner = New Banner\n        ' ...\n        BannerCollection.Add thisBanner\n    Next r\n\n    ' ...\n    Dim b As Banner\n    For Each b In BannerCollection\n        ' do something with the banner.\n    Next\n</code></pre>\n\n<p>Now to do this, Banner <strong>must</strong> be a Class not a Type.  I think it makes life a lot easier though.</p>\n\n<h2>Split a big method up into single purpose methods.</h2>\n\n<p>For instance I extracted a method as follows:</p>\n\n<pre><code>Private Function UrlEncode(ByVal text As String) As String\n    text = Replace(text, \" \", \"+\")\n    text = Replace(text, \"&amp;\", \"And\")\n    text = Replace(text, \"%\", \"PC\")\n    text = Replace(text, \"!\", \"\")\n    text = Replace(text, \"\u00c2\u00a3\", \"\")\n    text = Replace(text, \",\", \"\")\n    text = Replace(text, \"'\", \"\")\n    text = Replace(text, \"#\", \"\")\n    text = Replace(text, \".\", \"\")\n    UrlEncode = text\nEnd Function\n</code></pre>\n\n<p>Now this can be referenced like <code>bannerTracking = UrlEncode(b.bannerTitle)</code>.</p>\n"}], "owner": {"reputation": 92, "user_id": 323257, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xn0eo.jpg?s=128&g=1", "display_name": "Neil Cooper", "link": "https://stackoverflow.com/users/323257/neil-cooper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 29625294, "answer_count": 2, "score": 0, "last_activity_date": 1429014302, "creation_date": 1429003933, "last_edit_date": 1429014302, "question_id": 29623861, "link": "https://stackoverflow.com/questions/29623861/output-doesnt-match-input", "title": "Output doesn&#39;t match input", "body": "<p>I've created a macro that's meant to created a lump of CSS &amp; HTML from a set of values in each sheet of a spreadsheet.<br>\nIt's a little untidy as I created the function to write it from one sheet first as a proof of concept, and then updated it.<br>\nIt doesn't throw any obvious errors, but the output varies, sometimes it shows the same thing both times, and then depending on where I've got debug MsgBoxs or watches in VBA seems to alter the output.</p>\n\n<p>Any ideas what on earth i'm doing wrong?</p>\n\n<p><img src=\"https://i.stack.imgur.com/CsUbh.png\" alt=\"SHeet 1\">\n<img src=\"https://i.stack.imgur.com/1VFvm.png\" alt=\"Sheet 2\"></p>\n\n<pre><code>Sub createCode()\n\nDim myWorkbook As Workbook\nDim mySheet As Worksheet\nSet myWorkbook = Application.ActiveWorkbook\n\nFor Each mySheet In myWorkbook.Worksheets\n\n    Dim bannerCount As Integer\n    Dim BannerCollection() As Banner\n    Dim r As Range\n    Dim lastRow, lastCol\n    Dim allCells As Range\n    bannerCount = 0\n    lastCol = mySheet.Range(\"a2\").End(xlToRight).Column\n    lastRow = mySheet.Range(\"a2\").End(xlDown).Row\n    Set allCells = mySheet.Range(\"a2\", mySheet.Cells(lastRow, lastCol))\n'    MsgBox (mySheet.Name)\n'    MsgBox (\"lastRow:\" &amp; lastRow &amp; \"lastCol:\" &amp; lastCol)\n    ReDim BannerCollection(allCells.Rows.Count)\n\n    For Each r In allCells.Rows\n        Dim thisBanner As Banner\n        thisBanner.imagePath = \"\"\n        thisBanner.retImagePath = \"\"\n        thisBanner.bannerTitle = \"\"\n        thisBanner.urlPath = \"\"\n        bannerCount = bannerCount + 1\n'        MsgBox (bannerCount)\n        thisBanner.imagePath = Cells(r.Row, 2).Value\n        thisBanner.retImagePath = Cells(r.Row, 3).Value\n        thisBanner.bannerTitle = Cells(r.Row, 4).Value\n        thisBanner.urlPath = Cells(r.Row, 5).Value\n        'MsgBox (Cells(r.Row, 2).Value)\n        'MsgBox (Cells(r.Row, 3).Value)\n        'MsgBox (Cells(r.Row, 4).Value)\n        'MsgBox (Cells(r.Row, 5).Value)\n        BannerCollection(bannerCount - 1) = thisBanner\n    Next r\n\n    Dim i As Variant\n    Dim retinaCSS, imgCSS, firstBannerCode, otherBannersCode, bannerTracking As String\n    retinaCSS = \"\"\n    imgCSS = \"\"\n    firstBannerCode = \"\"\n    otherBannersCode = \"\"\n    bannerTracking = \"\"\n\n\n    For i = 0 To bannerCount - 1\n        bannerTracking = BannerCollection(i).bannerTitle\n        bannerTracking = Replace(bannerTracking, \" \", \"+\")\n        bannerTracking = Replace(bannerTracking, \"&amp;\", \"And\")\n        bannerTracking = Replace(bannerTracking, \"%\", \"PC\")\n        bannerTracking = Replace(bannerTracking, \"!\", \"\")\n        bannerTracking = Replace(bannerTracking, \"\u00c2\u00a3\", \"\")\n        bannerTracking = Replace(bannerTracking, \",\", \"\")\n        bannerTracking = Replace(bannerTracking, \"'\", \"\")\n        bannerTracking = Replace(bannerTracking, \"#\", \"\")\n        bannerTracking = Replace(bannerTracking, \".\", \"\")\n        retinaCSS = retinaCSS &amp; \"#sliderTarget .banner-\" &amp; i + 1 &amp; \"{background-image: url('/assets/static/\" &amp; BannerCollection(i).retImagePath &amp; \"');}\" &amp; vbNewLine\n        imgCSS = imgCSS &amp; \"#sliderTarget .banner-\" &amp; i + 1 &amp; \"{background-image: url('/assets/static/\" &amp; BannerCollection(i).imagePath &amp; \"');}\" &amp; vbNewLine\n        If i = 0 Then\n            firstBannerCode = firstBannerCode &amp; \"&lt;div class=\" &amp; Chr(34) &amp; \"banner banner-\" &amp; i + 1 &amp; \" staticBanner\" &amp; Chr(34) &amp; \"&gt;\" &amp; vbNewLine\n            firstBannerCode = firstBannerCode &amp; \"&lt;a href=\" &amp; Chr(34) &amp; BannerCollection(i).urlPath &amp; Chr(34) &amp; \" manual_cm_re=\" &amp; Chr(34) &amp; \"MAINBANNER-_-BANNER+\" &amp; i + 1 &amp; \"-_-\" &amp; bannerTracking &amp; Chr(34) &amp; \"&gt;&lt;/a&gt;\" &amp; vbNewLine\n            firstBannerCode = firstBannerCode &amp; \"&lt;/div&gt;\" &amp; vbNewLine\n        Else\n            otherBannersCode = otherBannersCode &amp; \"&lt;div class=\" &amp; Chr(34) &amp; \"banner banner-\" &amp; i + 1 &amp; \" staticBanner\" &amp; Chr(34) &amp; \"&gt;\" &amp; vbNewLine\n            otherBannersCode = otherBannersCode &amp; \"&lt;a href=\" &amp; Chr(34) &amp; BannerCollection(i).urlPath &amp; Chr(34) &amp; \" manual_cm_re=\" &amp; Chr(34) &amp; \"MAINBANNER-_-BANNER+\" &amp; i + 1 &amp; \"-_-\" &amp; bannerTracking &amp; Chr(34) &amp; \"&gt;&lt;/a&gt;\" &amp; vbNewLine\n            otherBannersCode = otherBannersCode &amp; \"&lt;/div&gt;\" &amp; vbNewLine\n        End If\n'        MsgBox (BannerCollection(i).retImagePath &amp; vbNewLine &amp; BannerCollection(i).imagePath &amp; vbNewLine &amp; BannerCollection(i).bannerTitle &amp; vbNewLine &amp; BannerCollection(i).urlPath)\n\n    Next i\n\n    CodeString = \"\"\n    CodeString = CodeString &amp; \"&lt;style type=\" &amp; Chr(34) &amp; \"text/css\" &amp; Chr(34) &amp; \"&gt;\" &amp; vbNewLine\n    CodeString = CodeString &amp; \"/* Banners */\" &amp; vbNewLine\n    CodeString = CodeString &amp; imgCSS\n    CodeString = CodeString &amp; \"/* Retina Banners */\" &amp; vbNewLine\n    CodeString = CodeString &amp; \"@media only screen and (-webkit-min-device-pixel-ratio: 2) {\" &amp; vbNewLine\n    CodeString = CodeString &amp; retinaCSS\n    CodeString = CodeString &amp; \"}\" &amp; vbNewLine\n    CodeString = CodeString &amp; \"&lt;/style&gt;\" &amp; vbNewLine\n    CodeString = CodeString &amp; \"&lt;div id=\" &amp; Chr(34) &amp; \"sliderTarget\" &amp; Chr(34) &amp; \" class=\" &amp; Chr(34) &amp; \"slides\" &amp; Chr(34) &amp; \"&gt;\" &amp; vbNewLine\n    CodeString = CodeString &amp; firstBannerCode\n    CodeString = CodeString &amp; \"&lt;/div&gt;\" &amp; vbNewLine\n    CodeString = CodeString &amp; \"&lt;script id=\" &amp; Chr(34) &amp; \"sliderTemplate\" &amp; Chr(34) &amp; \" type=\" &amp; Chr(34) &amp; \"text/template\" &amp; Chr(34) &amp; \"&gt;\" &amp; vbNewLine\n    CodeString = CodeString &amp; otherBannersCode\n    CodeString = CodeString &amp; \"&lt;/script&gt;\"\n\n    FilePath = Application.DefaultFilePath &amp; \"\\\" &amp; mySheet.Name &amp; \"code.txt\"\n    Open FilePath For Output As #2\n    Print #2, CodeString\n    Close #2\n    MsgBox (\"code.txt contains:\" &amp; CodeString)\n    MsgBox (Application.DefaultFilePath &amp; \"\\\" &amp; mySheet.Name &amp; \"code.txt\")\n    Erase BannerCollection\nNext mySheet\n\nEnd Sub\n</code></pre>\n\n<p>and here is the <code>Banner</code> type:</p>\n\n<pre><code>Public Type Banner \n   imagePath As String \n   retImagePath As String \n   urlPath As String \n   bannerTitle As String \nEnd Type\n</code></pre>\n"}, {"tags": ["vba", "email", "excel", "outlook"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1429002919, "creation_date": 1429002919, "answer_id": 29623516, "question_id": 29623013, "link": "https://stackoverflow.com/questions/29623013/received-email-date-from-outlook-problems-with-format-and-search-from-info-in-c/29623516#29623516", "title": "Received email date from outlook. Problems with format and search from info in cells", "body": "<p>There is no loop to walk through the values in column E. Another <code>For ... Next</code> loop involving <em>i</em> should be sufficient.</p>\n\n<pre><code>Sub ReceivedEmailDate()\n    Dim outlookApp\n    Dim olNs As Outlook.Namespace\n    Dim Fldr As Outlook.MAPIFolder\n    Dim olMail As Variant\n    Dim myTasks\n    Dim sir() As String\n\n    Set outlookApp = CreateObject(\"Outlook.Application\")\n\n    Set olNs = outlookApp.GetNamespace(\"MAPI\")\n    Set Fldr = olNs.GetDefaultFolder(olFolderInbox)\n    Set myTasks = Fldr.Items\n\n    With ActiveSheet\n        For i = 2 To .Cells(Rows.Count, \"E\").End(xlUp).Row\n            For Each olMail In myTasks\n\n                'This is where the search occurs in the outlook inbox (parameters can be altered depending on what you want to search for)\n                'I have stated to search for the invoice numbers in the subject field of the email. Invoice numbers located down column E\n                If CBool(InStr(1, olMail.Subject, .Cells(i, \"E\").Value, vbTextCompare)) Then\n                    .Cells(i, \"H\") = CDate(olMail.ReceivedTime)   'put a real datetime in whether you need it right now or not\n                    .Cells(i, \"H\").NumberFormat = \"dd/mm/yy\"      'format function to only show the date, rather than both date and time\n                End If\n\n            Next olMail\n        Next i\n    End With\n\n    Set myTasks = Nothing\n    Set Fldr = Nothing\n    Set olNs = Nothing\n    Set outlookApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>I've put a real datetime into column H and formatted it to <em>dd/mm/yy</em>. You can revert to the text representation of a date if you prefer.</p>\n"}], "owner": {"reputation": 145, "user_id": 4786410, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/969158327194824aae3a978ae5271bef?s=128&d=identicon&r=PG&f=1", "display_name": "redd", "link": "https://stackoverflow.com/users/4786410/redd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1163, "favorite_count": 0, "accepted_answer_id": 29623516, "answer_count": 1, "score": 1, "last_activity_date": 1429002919, "creation_date": 1429001423, "question_id": 29623013, "link": "https://stackoverflow.com/questions/29623013/received-email-date-from-outlook-problems-with-format-and-search-from-info-in-c", "title": "Received email date from outlook. Problems with format and search from info in cells", "body": "<pre><code>Sub ReceivedEmailDate()\nDim outlookApp\nDim olNs As Outlook.Namespace\nDim Fldr As Outlook.MAPIFolder\nDim olMail As Variant\nDim myTasks\nDim sir() As String\n\nSet outlookApp = CreateObject(\"Outlook.Application\")\n\nSet olNs = outlookApp.GetNamespace(\"MAPI\")\nSet Fldr = olNs.GetDefaultFolder(olFolderInbox)\nSet myTasks = Fldr.Items\n\ni = 2             'This is the row you want the date/time to start from\n\nFor Each olMail In myTasks\n\n                'This is where the search occurs in the outlook inbox (parameters can be altered depending on what you want to search for)\n                'I have stated to search for the invoice numbers in the subject field of the email. Invoice numbers located down column E\nIf (InStr(1, olMail.Subject, ActiveSheet.Cells(i, 5), vbTextCompare) &gt; 0) Then\n  ActiveSheet.Cells(i, 8).Value = Format(olMail.ReceivedTime, \"DD/MM/YY\")      'format function to only show the date, rather than both date and time\n\n\n  i = i + 1     'Count so that each email date/time is entered in the row below the previous one\n\nEnd If\n\nNext olMail\n\nSet Fldr = Nothing\nSet olNs = Nothing\nSet olApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>I'm wanting the code to search in outlook for what is in cell E2 and post the received date in cell H2, then search in outlook for what is in cell E3 and post the received date in cell H3 and so on.</p>\n\n<p>I thought I had it working for a while, but it now just posts in the first cell only (H2). Also the format seems all over the place.</p>\n\n<p>Any help would be much appreciated.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "is_accepted": false, "score": 0, "last_activity_date": 1429001680, "last_edit_date": 1429001680, "creation_date": 1429001174, "answer_id": 29622929, "question_id": 29622516, "link": "https://stackoverflow.com/questions/29622516/excel-vba-run-macro-on-any-key-stroke-press/29622929#29622929", "title": "Excel Vba: Run macro on ANY key stroke / press", "body": "<p>Since <code>KeyAscii</code> will always be <a href=\"http://thecodeforyou.blogspot.nl/2013/01/vb-keyascii-values.html\" rel=\"nofollow\">positive</a>, try:</p>\n\n<pre><code>Private Sub TextBox2_KeyPress(KeyAscii As Integer)\n    If KeyAscii &gt; -1 Then\n        MsgBox \"You Pressed a key\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Also, I've checked it just now, you must remove the <code>As MSForms.Returninteger</code> part. The code I have just posted works perfectly fine for me.</p>\n"}], "owner": {"reputation": 11, "user_id": 4786366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fe42745693945767634bfa9b64392aa?s=128&d=identicon&r=PG&f=1", "display_name": "James Michael", "link": "https://stackoverflow.com/users/4786366/james-michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2089, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1429001680, "creation_date": 1429000005, "question_id": 29622516, "link": "https://stackoverflow.com/questions/29622516/excel-vba-run-macro-on-any-key-stroke-press", "title": "Excel Vba: Run macro on ANY key stroke / press", "body": "<p>I am using the following vba code to run a macro on the enter key press event. However is there a way i can alter this code to run on any keystroke not just enter?</p>\n\n<p>here is the code i am using:</p>\n\n<pre><code>Private Sub TextBox2_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)\nIf KeyAscii = 13 Then\nMsgBox \"You Pressed a key\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["excel", "vba", "compare"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4786265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38454fb79c5e2d7c1ba5be021b65528d?s=128&d=identicon&r=PG&f=1", "display_name": "Martijn", "link": "https://stackoverflow.com/users/4786265/martijn"}, "edited": false, "score": 0, "creation_date": 1429003742, "post_id": 29623491, "comment_id": 47391178, "body": "Well, this does compare the data, but it only copies the content of the  matching cell.   I need to compare two names, if those match, i need to copy the date which is two columns to the right of the name. So, where it says &#39;Startdatum = j&#39; in your formula, it actually needs to be &#39;Startdatum = j + 2 columns&#39;"}, {"owner": {"reputation": 1, "user_id": 4786265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38454fb79c5e2d7c1ba5be021b65528d?s=128&d=identicon&r=PG&f=1", "display_name": "Martijn", "link": "https://stackoverflow.com/users/4786265/martijn"}, "edited": false, "score": 0, "creation_date": 1429004765, "post_id": 29623491, "comment_id": 47391791, "body": "I&#39;ve been trying, but I really don&#39;t know how to achieve the whole &#39;j + 2 columns&#39; thing :p Any advice there? Thanks in advance!"}, {"owner": {"reputation": 1, "user_id": 4786265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38454fb79c5e2d7c1ba5be021b65528d?s=128&d=identicon&r=PG&f=1", "display_name": "Martijn", "link": "https://stackoverflow.com/users/4786265/martijn"}, "edited": false, "score": 0, "creation_date": 1429005732, "post_id": 29623491, "comment_id": 47392363, "body": "Thanks for revising. Getting close! But I think it&#39;s easier to explain if I put up a little sample of the data. I&#39;ll edit the original post."}, {"owner": {"reputation": 1, "user_id": 4786265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38454fb79c5e2d7c1ba5be021b65528d?s=128&d=identicon&r=PG&f=1", "display_name": "Martijn", "link": "https://stackoverflow.com/users/4786265/martijn"}, "edited": false, "score": 0, "creation_date": 1429006075, "post_id": 29623491, "comment_id": 47392556, "body": "Right now, it copies a date, but it corresponds to the row of sheet 2, while it should correspond to the row of sheet 1 to which it matched."}, {"owner": {"reputation": 333, "user_id": 4763834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c90a52b03403cb2fb86c618bfbb653a?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/4763834/adrian"}, "reply_to_user": {"reputation": 1, "user_id": 4786265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38454fb79c5e2d7c1ba5be021b65528d?s=128&d=identicon&r=PG&f=1", "display_name": "Martijn", "link": "https://stackoverflow.com/users/4786265/martijn"}, "edited": false, "score": 0, "creation_date": 1429006168, "post_id": 29623491, "comment_id": 47392605, "body": "Have you tried =Startdatum(A1,Sheet2!$A$1:$A$7,B1)? (into C1 on sheet 1)"}, {"owner": {"reputation": 1, "user_id": 4786265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38454fb79c5e2d7c1ba5be021b65528d?s=128&d=identicon&r=PG&f=1", "display_name": "Martijn", "link": "https://stackoverflow.com/users/4786265/martijn"}, "edited": false, "score": 0, "creation_date": 1429007560, "post_id": 29623491, "comment_id": 47393472, "body": "I&#39;ve tried that, doesn&#39;t work, unfortunately. What I need, is the &#39;celltarget&#39; not to be the same row as the &#39;cell&#39;, but to be the same row as the matching &#39;cellrange&#39;."}, {"owner": {"reputation": 333, "user_id": 4763834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c90a52b03403cb2fb86c618bfbb653a?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/4763834/adrian"}, "reply_to_user": {"reputation": 1, "user_id": 4786265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38454fb79c5e2d7c1ba5be021b65528d?s=128&d=identicon&r=PG&f=1", "display_name": "Martijn", "link": "https://stackoverflow.com/users/4786265/martijn"}, "edited": false, "score": 0, "creation_date": 1429059840, "post_id": 29623491, "comment_id": 47421656, "body": "Oh well, did you have any luck?"}, {"owner": {"reputation": 1, "user_id": 4786265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38454fb79c5e2d7c1ba5be021b65528d?s=128&d=identicon&r=PG&f=1", "display_name": "Martijn", "link": "https://stackoverflow.com/users/4786265/martijn"}, "edited": false, "score": 0, "creation_date": 1429094158, "post_id": 29623491, "comment_id": 47435814, "body": "Actually, yeah :P turns out my original code worked, just that i placed the order in &#39;Cells(1, i)&#39; the wrong way around. It should have been &#39;Cells(i,1)&#39;... (i felt kinda stupid ;)"}], "tags": [], "owner": {"reputation": 333, "user_id": 4763834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c90a52b03403cb2fb86c618bfbb653a?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/4763834/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1429005658, "last_edit_date": 1429005658, "creation_date": 1429002864, "answer_id": 29623491, "question_id": 29622169, "link": "https://stackoverflow.com/questions/29622169/id-like-to-compare-data-in-two-worksheets-and-copy-a-cell-if-theres-a-match/29623491#29623491", "title": "I&#39;d like to compare data in two worksheets and copy a cell if there&#39;s a match", "body": "<p>Try this (revised):</p>\n\n<pre><code>Function Startdatum(cell As Variant, cellrange As range, Optional celltarget As Variant) As String\nFor Each j In cellrange\n    If j = cell Then Startdatum = IIf(IsMissing(celltarget), j, celltarget): Exit Function\nNext\nEnd Function\n</code></pre>\n\n<p>Put that into a new module, then you can enter into the first cell =Startdatum(A1,$C$1:$C$7,D1) </p>\n\n<ul>\n<li><p>A1 is the cell you want to compare. </p></li>\n<li><p>$C$1:$C$whatever (the $'s maintain the range when you drag it down) is the range of cells you want to compare it with...</p></li>\n<li><p>D1 is the cell you want to copy if there is a match </p></li>\n</ul>\n\n<p>Drag down to do the whole range...</p>\n"}], "owner": {"reputation": 1, "user_id": 4786265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38454fb79c5e2d7c1ba5be021b65528d?s=128&d=identicon&r=PG&f=1", "display_name": "Martijn", "link": "https://stackoverflow.com/users/4786265/martijn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429005929, "creation_date": 1428998815, "last_edit_date": 1429005929, "question_id": 29622169, "link": "https://stackoverflow.com/questions/29622169/id-like-to-compare-data-in-two-worksheets-and-copy-a-cell-if-theres-a-match", "title": "I&#39;d like to compare data in two worksheets and copy a cell if there&#39;s a match", "body": "<p>I'd like to match column A between two worksheets, and if there is a match, data of column B (sheet1) of the corresponding row should be copied to column B (sheet2). </p>\n\n<p>Sheet 1:</p>\n\n<p>COLUMN A-----------------COLUMN B</p>\n\n<p>Company name 1----------Startdate 1</p>\n\n<p>Company name 2----------Startdate 2</p>\n\n<p>Company name 3----------Startdate 3</p>\n\n<p>etc.</p>\n\n<p>Sheet 2:</p>\n\n<p>COLUMN A</p>\n\n<p>Company name 1</p>\n\n<p>Company name 1</p>\n\n<p>Company name 1</p>\n\n<p>Company name 2</p>\n\n<p>Company name 2</p>\n\n<p>Etc.</p>\n\n<p>I need to do this for multiple files which have varying number of rows. </p>\n\n<p>The way I tried it is below, but it ends up only copying data to C3. Anyone know what I'm doing wrong?</p>\n\n<pre><code>Sub Startdatum()\n\ncntcomp = ActiveWorkbook.Worksheets(\"Component\").Range(\"A2\", Worksheets(\"Component\").Range(\"A2\").End(xlDown)).Rows.Count\ncntbedrijf = ActiveWorkbook.Worksheets(\"Bedrijf\").Range(\"A2\", Worksheets(\"Bedrijf\").Range(\"A2\").End(xlDown)).Rows.Count\n\nFor i = 2 To cntcomp\n\nFor j = 2 To cntbedrijf\n\n    If ActiveWorkbook.Worksheets(\"Component\").Cells(1, i).Value = ActiveWorkbook.Worksheets(\"Bedrijf\").Cells(1, j).Value Then\n\n        ActiveWorkbook.Worksheets(\"Component\").Cells(3, i).Value = ActiveWorkbook.Worksheets(\"Bedrijf\").Cells(2, j).Value\n\n    End If\n\nNext j\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4786093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bXDn79nZMzc/AAAAAAAAAAI/AAAAAAAAABI/vh5SPT-sms4/photo.jpg?sz=128", "display_name": "LeloucheVI", "link": "https://stackoverflow.com/users/4786093/lelouchevi"}, "edited": false, "score": 0, "creation_date": 1429003533, "post_id": 29622804, "comment_id": 47391046, "body": "Jeeped, thank you for your code implementation, but the problem still persist:  each time i fill the 5000 rows range with formulas it gets slower and slower like excel is recalculating all the formulas above. But we know they&#39;re just value and every step should take the same time."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1, "user_id": 4786093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bXDn79nZMzc/AAAAAAAAAAI/AAAAAAAAABI/vh5SPT-sms4/photo.jpg?sz=128", "display_name": "LeloucheVI", "link": "https://stackoverflow.com/users/4786093/lelouchevi"}, "edited": false, "score": 0, "creation_date": 1429004615, "post_id": 29622804, "comment_id": 47391703, "body": "@LeloucheVI - I&#39;ve suggested a few times that there may be other dependencies that are slowing down the process but you&#39;ve offered no indication of anything in that area. FWIW, Excel will slow down as it loads more memory doing tasks. Watch the <i>Processes</i> tab of <i>Task Manager</i> to see how memory usage grows while that runs. If speed is mission critical, load column A from <b>Report 1</b> into a dictionary object and all the values from <b>BOM Str Parents</b> into a variant array and process the whole thing in memory like <a href=\"http://tinyurl.com/ntez24k\" rel=\"nofollow noreferrer\">this</a> then drop the var array into <b>Report 1</b>."}, {"owner": {"reputation": 1, "user_id": 4786093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bXDn79nZMzc/AAAAAAAAAAI/AAAAAAAAABI/vh5SPT-sms4/photo.jpg?sz=128", "display_name": "LeloucheVI", "link": "https://stackoverflow.com/users/4786093/lelouchevi"}, "edited": false, "score": 0, "creation_date": 1429006092, "post_id": 29622804, "comment_id": 47392564, "body": "In the &quot;Report 1&quot; sheet there are just columns with string values (no formulas, pivot,etc). I don&#39;t think the problem is related to what is in that sheet. The problem is that when i try manually it takes 12 second for column, while launching the macro it takes 45 second. As I said it behaves like it&#39;s recalculating above formulas, while it shouldn&#39;t cause they&#39;re just values. Anyway i tried to debug with F8 and that&#39;s where I&#39;ve noticed this behaviou but even if VBA stops (like it&#39;s recalculating) if I force it pressing F8 again it goes ahed.  Problem is I can&#39;t &quot;force&quot; during normal execution"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1, "user_id": 4786093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bXDn79nZMzc/AAAAAAAAAAI/AAAAAAAAABI/vh5SPT-sms4/photo.jpg?sz=128", "display_name": "LeloucheVI", "link": "https://stackoverflow.com/users/4786093/lelouchevi"}, "edited": false, "score": 0, "creation_date": 1429006804, "post_id": 29622804, "comment_id": 47393022, "body": "@LeloucheVI - All <code>MATCH</code> returns to the <b>match</b> ws is the row number where the corresponding value from <b>BOM Str Parents</b> is located on <b>Report 1</b>&#39;s column A. This is pretty useless information unless it is used by another formula like <code>INDEX</code> to actually locate a value. Select one of the values and check with Formulas \u25ba Formula Auditing \u25ba Trace Dependents. This will show you what other formulas are using the values in their calculations."}, {"owner": {"reputation": 1, "user_id": 4786093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bXDn79nZMzc/AAAAAAAAAAI/AAAAAAAAABI/vh5SPT-sms4/photo.jpg?sz=128", "display_name": "LeloucheVI", "link": "https://stackoverflow.com/users/4786093/lelouchevi"}, "edited": false, "score": 0, "creation_date": 1429007706, "post_id": 29622804, "comment_id": 47393551, "body": "Yes,  MATCH formula results are  used by concatenated INDEX formulas at a later stage. Though I&#39;ve been careful and I left no formulas in the workbook connected with those values. as I&#39;ve been able to verify with the method you suggested. I can guess,then, the problem is not within the Workbook."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1, "user_id": 4786093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bXDn79nZMzc/AAAAAAAAAAI/AAAAAAAAABI/vh5SPT-sms4/photo.jpg?sz=128", "display_name": "LeloucheVI", "link": "https://stackoverflow.com/users/4786093/lelouchevi"}, "edited": false, "score": 0, "creation_date": 1429008532, "post_id": 29622804, "comment_id": 47394034, "body": "@LeloucheVI - If there are no current dependencies then it sounds like the scope of the operation and the amount of available memory is what is holding you back. I can try to swap this over to array based calculation but the details are slim."}, {"owner": {"reputation": 1, "user_id": 4786093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bXDn79nZMzc/AAAAAAAAAAI/AAAAAAAAABI/vh5SPT-sms4/photo.jpg?sz=128", "display_name": "LeloucheVI", "link": "https://stackoverflow.com/users/4786093/lelouchevi"}, "edited": false, "score": 0, "creation_date": 1429085152, "post_id": 29622804, "comment_id": 47430242, "body": "I adapted the array based macro but it just crashes. Anyway, thanks for your effort and patience"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1429010571, "last_edit_date": 1429010571, "creation_date": 1429000823, "answer_id": 29622804, "question_id": 29621521, "link": "https://stackoverflow.com/questions/29621521/inefficient-calculation-when-looping-through-formulas/29622804#29622804", "title": "Inefficient calculation when looping through formulas", "body": "<p>It is unclear what precedents and dependents are related to the values you are inserting. A worksheet named <strong>Report 1</strong> suggests anything from statistical and subtotal formulas to an embedded chart and event macros like <em>Worksheet_Change</em>. Your code would benefit from reducing the calculation of the range to receive the formulas/values from three times to one as well as shutting down the 'big 3' application modes (e.g. <em>.ScreenUpdating, .EnableEvents</em> and <em>.Calculation</em>). Blocking the worksheets into <strong>With ... End With</strong> sections avoids the often ambiguous ActiveSheet parent referral. External references to the cells on <strong>Report 1</strong> should be temporarily broken.</p>\n\n<pre><code>    Dim rw As Long, k As Long, i As Long, h As Long, l As Long, rng As Range\n\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    Application.Calculation = xlCalculationManual\n\n    With Sheets(\"Report 1\")\n        rw = .Range(.Cells(5, 3), .Cells(5, 3).End(xlDown)).Count\n    End With\n\n    With Sheets(\"match\")\n        k = rw / 5000\n        h = 4\n        For l = 2 To 12\n            For i = 1 To k\n                Set rng = .Range(.Cells(h, l), .Cells(3 + rw - ((k - i) * 5000), l))\n                rng.FormulaR1C1 = \"=MATCH('BOM Str Parents'!RC, 'Report 1'!C1, 0)\"\n                rng = rng.Value2\n                Set rng = Nothing\n                h = rw - ((k - i) * 5000) + 1\n            Next i\n        Next l\n    End With\n\n    'Application.Calculation = xlCalculationAutomatic\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\n</code></pre>\n\n<p>Those simple steps should speed up your calculation time significantly. <code>.Value2</code> can be used as we know that match is only going to return a long integer or an error. I don't know what calculation mode you started with so I left the return to <code>xlCalculationAutomatic</code> commented.</p>\n\n<p>Actual results are going to depend greatly on what else is connected to the cells on <strong>Report 1</strong>.</p>\n\n<p><strong>Addendum:</strong></p>\n\n<p>I'm not sure if I have the row/column calculation or the range sizing entirely correct but the array sizing and orientation should be good and this runs a bit faster.</p>\n\n<pre><code>    Debug.Print Timer\n    Dim h As Long, l As Long, v As Long\n    Dim rws As Long, vRPT1a As Variant, vBOMstr As Variant\n\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    Application.Calculation = xlCalculationManual\n\n    With Sheets(\"Report 1\")\n        vRPT1a = .Range(.Cells(5, 1), .Cells(5, 3).End(xlDown).Offset(0, -1)).Value\n        rws = UBound(vRPT1a)\n    End With\n\n    With Sheets(\"match\")\n        h = 4\n        For l = 2 To 12\n            vBOMstr = Sheets(\"BOM Str Parents\").Cells(h, l).Resize(rws, 1).Value2\n            For v = LBound(vBOMstr, 1) To rws\n                vBOMstr(v, 1) = Application.Match(vBOMstr(v, 1), Application.Index(vRPT1a, 0, 1), 0)\n            Next v\n            .Cells(4, l).Resize(rws, 1) = Application.Index(vBOMstr, 0, 1)\n        Next l\n    End With\n\n    'Application.Calculation = xlCalculationAutomatic\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\n    Debug.Print Timer\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4786093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bXDn79nZMzc/AAAAAAAAAAI/AAAAAAAAABI/vh5SPT-sms4/photo.jpg?sz=128", "display_name": "LeloucheVI", "link": "https://stackoverflow.com/users/4786093/lelouchevi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429321068, "creation_date": 1428996550, "last_edit_date": 1531164843, "question_id": 29621521, "link": "https://stackoverflow.com/questions/29621521/inefficient-calculation-when-looping-through-formulas", "title": "Inefficient calculation when looping through formulas", "body": "<p>While I was trying to speed up my Workbook I incurred in this problem:</p>\n\n<p>I've got several rows and columns to fill with formulas so I tried to make it all quicker by copying and pasting value after calculating formulas by slots. While this works easily on excel (doing it manually), when I do it with VBA it behaves like it's recalculating all the formulas, even if they're just values, and the calculating time grows every step.</p>\n\n<p>Is there a way to avoid this strange behaviour?</p>\n\n<p>PS: I've already tried to set calculation to manual but nothing changed since VBA seems to not care about it.</p>\n\n<p>I know it shouldn't be necessary but here is the code:</p>\n\n<pre><code>Dim rw As Long, k As Long, i As Long, h As Long, l As Long\n'\nApplication.ScreenUpdating = False\n'\nSheets(\"Report 1\").Activate\n    rw = Range(Cells(5, 3), Cells(5, 3).End(xlDown)).Count\n        Sheets(\"match\").Activate\nk = rw / 5000\n    h = 4\nFor l = 2 To 12\n    For i = 1 To k\n        Range(Cells(h, l), Cells(3 + rw - ((k - i) * 5000), l)).FormulaR1C1 = \"=MATCH('BOM Str Parents'!RC,'Report 1'!c1,0)\"\n            Range(Cells(h, l), Cells(3 + rw - ((k - i) * 5000), l)).Value = Range(Cells(h, l), Cells(3 + rw - ((k - i) * 5000), l)).Value\n        h = rw - ((k - i) * 5000) + 1\n    Next i\nNext l\n</code></pre>\n"}]