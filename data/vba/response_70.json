[{"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1463012263, "creation_date": 1463012263, "answer_id": 37175266, "question_id": 37174997, "link": "https://stackoverflow.com/questions/37174997/vba-code-to-create-and-name-new-sheet-based-on-variable/37175266#37175266", "title": "VBA Code to create and name new sheet based on variable", "body": "<pre><code>For X = 1 To B\n    Worksheets.Add().Name = Sheets(\"Calculations\").Range(\"B2\").Offset(X, 0).Value\nNext X\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 419, "user_id": 6187464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IqTLI.jpg?s=128&g=1", "display_name": "HedgePig", "link": "https://stackoverflow.com/users/6187464/hedgepig"}, "is_accepted": false, "score": 0, "last_activity_date": 1463015547, "creation_date": 1463015547, "answer_id": 37175673, "question_id": 37174997, "link": "https://stackoverflow.com/questions/37174997/vba-code-to-create-and-name-new-sheet-based-on-variable/37175673#37175673", "title": "VBA Code to create and name new sheet based on variable", "body": "<p>In your original code, you have Function_Name in quotes in</p>\n\n<pre><code>Worksheets.Add().Name = (\"Function_Name\")\n</code></pre>\n\n<p>The quotes should be removed. </p>\n\n<p>Tim's answer gives an even more succinct way of writing the code.</p>\n\n<p>You may also consider putting in some error trapping because if you try and add a worksheet with a name that already exists, you will get a run time error.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6323752, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v713L2BC048/AAAAAAAAAAI/AAAAAAAACyY/xMoSDnsVAwM/photo.jpg?sz=128", "display_name": "Raj Mohan", "link": "https://stackoverflow.com/users/6323752/raj-mohan"}, "is_accepted": false, "score": 0, "last_activity_date": 1463032547, "creation_date": 1463032547, "answer_id": 37178363, "question_id": 37174997, "link": "https://stackoverflow.com/questions/37174997/vba-code-to-create-and-name-new-sheet-based-on-variable/37178363#37178363", "title": "VBA Code to create and name new sheet based on variable", "body": "<pre><code>Dim wksSource   as worksheet\n\nFor X = 1 To B\n    Sheets(\"Calculations\").Select\n    Function_Name = Range(\"B2\").Offset(X, 0)   'Gets the Function Name\n    Set wksSource = worksheets.add\n    wksSource.Name = (\"Function_Name\")\n    Set wksSource = nothing\nNext X\n</code></pre>\n"}], "owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "accepted_answer_id": 37175266, "answer_count": 3, "score": 0, "last_activity_date": 1463032547, "creation_date": 1463010205, "question_id": 37174997, "link": "https://stackoverflow.com/questions/37174997/vba-code-to-create-and-name-new-sheet-based-on-variable", "title": "VBA Code to create and name new sheet based on variable", "body": "<p>I am trying to get my code to add a sheet with the name the code determines based on the Function_Name variable. When I run this it names the new sheet Function_Name. Any thoughts?</p>\n\n<pre><code>For X = 1 To B\n    Sheets(\"Calculations\").Select\n    Function_Name = Range(\"B2\").Offset(X, 0)   'Gets the Function Name\n    Worksheets.Add().Name = (\"Function_Name\")\nNext X\n</code></pre>\n"}, {"tags": ["excel", "if-statement", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1463009913, "post_id": 37174920, "comment_id": 61884520, "body": "<code>=IF(COUNTIF(W5:Y35,&quot;OK&quot;)=COUNTA(W5:Y35),&quot;GOOD&quot;,&quot;WARNING!&quot;)</code>"}, {"owner": {"reputation": 141, "user_id": 6268362, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/a4202013a491ecfa1b479a4c8d1a219c?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/6268362/alec"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1463010171, "post_id": 37174920, "comment_id": 61884601, "body": "How would it look like if had &quot;stuff&quot; in between the columns(lets assume one would be located on A5:A35 and next is on Z5:Z35)"}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 6268362, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/a4202013a491ecfa1b479a4c8d1a219c?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/6268362/alec"}, "edited": false, "score": 0, "creation_date": 1463011010, "post_id": 37175065, "comment_id": 61884853, "body": "OMG That was perfect!! Thank you sooo much Chris!!"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 0, "last_activity_date": 1463010735, "creation_date": 1463010735, "answer_id": 37175065, "question_id": 37174920, "link": "https://stackoverflow.com/questions/37174920/if-and-or-combination-for-cell-values-in-a-colums/37175065#37175065", "title": "IF and OR combination for cell values in a Colum(s)", "body": "<p>Separate the column checks and use \"AND\"</p>\n\n<pre><code>=IF(AND(COUNTIF(W5:W35,\"OK\")=ROWS(W5:W35),COUNTIF(X5:X35,\"OK\")=ROWS(X5:X35),COUNTIF(Y5:Y35,\"OK\")=ROWS(Y5:Y35)),\"GOOD\",\"WARNING!\")\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 6268362, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/a4202013a491ecfa1b479a4c8d1a219c?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/6268362/alec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 37175065, "answer_count": 1, "score": 0, "last_activity_date": 1463010735, "creation_date": 1463009625, "last_edit_date": 1531161705, "question_id": 37174920, "link": "https://stackoverflow.com/questions/37174920/if-and-or-combination-for-cell-values-in-a-colums", "title": "IF and OR combination for cell values in a Colum(s)", "body": "<p>In cell <code>Q49</code> I have: <code>=IF(COUNTIF(W5:W35,\"OK\")=ROWS(W5:W35),\"GOOD\",\"WARNING!\")</code></p>\n\n<p>Now, it works perfect with one column, but I would like to add more \"columns\" \n(for example add <code>X5:X35</code> and <code>Y5:Y35</code>)</p>\n\n<p>That should make excel look for \"OK\" in the designated columns.\nThis is what i tried but it didn't work:    </p>\n\n<p><code>=IF(COUNTIF(W5:W35,X5:X35,Y5:Y35,\"OK\")=ROWS(W5:W35,X5:X35,Y5:Y35),\"GOOD\",\"WARNING!\")</code></p>\n"}, {"tags": ["arrays", "excel", "vba", "countif"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1463010410, "post_id": 37174152, "comment_id": 61884674, "body": "The answer to this will depend on how big your data set is.  How many rows in&quot;Range To Test&quot; and how many rows in &quot;Values&quot;?"}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1463021121, "post_id": 37174152, "comment_id": 61887290, "body": "That&#39;s true - I intend this answer for large data sets and didn&#39;t specifically say so. My own data set was 90,000 rows."}], "answers": [{"comments": [{"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1463062460, "post_id": 37174153, "comment_id": 61911695, "body": "<a href=\"http://chat.stackoverflow.com/transcript/message/30485994#30485994\">chat.stackoverflow.com/transcript/message/30485994#30485994</a> Also from @Jeeped: &quot;I finally found some time to bench test that method a little more thoroughly and I have found a limitation. Using the parameters backwards limits the array as the lookup_value to 255 elements. This makes it prohibitive to use as an array-based substitution to countif in large blocks of data.&quot;"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1546977726, "post_id": 37174153, "comment_id": 95030594, "body": "Nice; came across your interesting approach by chance +1)"}], "tags": [], "owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "is_accepted": true, "score": 8, "last_activity_date": 1463004781, "last_edit_date": 1610973356, "creation_date": 1463004781, "answer_id": 37174153, "question_id": 37174152, "link": "https://stackoverflow.com/questions/37174152/array-countif-substitute-countmatch/37174153#37174153", "title": "Array CountIf Substitute - Count(Match())", "body": "<h2>Solution - Count(Match())</h2>\n<p>The solution we are looking for is:</p>\n<p><code>Application.Count(Application.Match(SavedArray(), Array([lookup_value]), 0))</code></p>\n<br>\nWhat? How does that work?\n---\nHow can a function that normally returns a row number be paired with an array and count to return the correct answer? How can you count row numbers?\n<p><strong>Explanation of Mechanics</strong></p>\n<p>With many thanks to @Jeeped, here's how it works:</p>\n<p>It's an undocumented feature of <code>Match(lookup value, lookup array, 0)</code> that if you put an array as the lookup value, it will <code>Match()</code> each value in the array you entered against the lookup array. Thus, for the above example, for <code>Loop = 1</code>, it will become:</p>\n<p><code>{match(A2, Array(&quot;1&quot;), 0),match(A3, Array(&quot;1&quot;), 0), ... match(A11, Array(&quot;1&quot;), 0)}</code></p>\n<p>Then, per @Jeeped:</p>\n<blockquote>\n<p>Each match will either return a number or an error. The <code>Count()</code> function counts numbers, not errors. So you get a count of whether any of the values in <code>A1:A11</code> match <code>Loop1</code>.</p>\n</blockquote>\n<p><strong>Final Code and Values</strong></p>\n<pre><code>Sub M1ArrayCount()\n\nDim arrNumbers() As Variant\nDim Long1 As Long\nDim Loop1 As Long\n\narrNumbers() = ThisWorkbook.Sheets(1).Range(&quot;A2:A11&quot;).Value\n\nWith ThisWorkbook.Sheets(1)\n    For Loop1 = 1 To 6\n        .Cells(Loop1 + 1, 4).Value = Application.Count(Application.Match(arrNumbers(), Array(Loop1), 0))\n    Next Loop1\nEnd With\n\nEnd Sub\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/QRnqo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QRnqo.png\" alt=\"Final Results\" /></a></p>\n<br>\nReferences\n---\n<a href=\"https://stackoverflow.com/questions/28507501/vba-why-does-application-countif-return-an-array-or-error-424#comment45355497_28507501\">This comment</a>\n<p><a href=\"http://www.mrexcel.com/forum/excel-questions/739653-countif-visual-basic-applications-array-without-loop.html#post3635486\" rel=\"nofollow noreferrer\">This answer </a></p>\n<blockquote>\n<p><strong>Question</strong></p>\n<blockquote>\n<p>Example:</p>\n<pre><code>myarray = array(&quot;First&quot;,&quot;Second&quot;,&quot;Second&quot;,&quot;Third&quot;,&quot;Fourth&quot;)\n</code></pre>\n<p>then what would the <code>countif(myarray,&quot;second&quot;)</code> syntax be? (the result\nshould equal 2 counts)</p>\n</blockquote>\n<p><strong>Answer</strong></p>\n<blockquote>\n<p>Try also:</p>\n<pre><code>MsgBox Application.Count(Application.Match(myArray, Array(&quot;Second&quot;), 0))\n</code></pre>\n</blockquote>\n</blockquote>\n<p><a href=\"https://chat.stackoverflow.com/transcript/message/30481710#30481710\">This chat</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 15114511, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/755d28f5c7e6b1af2fbe349b179fe220?s=128&d=identicon&r=PG", "display_name": "Guest", "link": "https://stackoverflow.com/users/15114511/guest"}, "is_accepted": false, "score": 0, "last_activity_date": 1612050477, "last_edit_date": 1612050477, "creation_date": 1612050044, "answer_id": 65974293, "question_id": 37174152, "link": "https://stackoverflow.com/questions/37174152/array-countif-substitute-countmatch/65974293#65974293", "title": "Array CountIf Substitute - Count(Match())", "body": "<pre><code>Dim rowin as integer 'this is a counter for the row index\nFor rowin = 2 To Sheets(&quot;Sheet1&quot;).UsedRange.Rows.Count\nSheets(&quot;Sheet1&quot;).Range(&quot;D&quot; &amp; rowin).Value = WorksheetFunction.CountIf(Range(&quot;A:A&quot;), Range(&quot;C&quot; &amp; rowin))\nNext\n</code></pre>\n"}], "owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8659, "favorite_count": 4, "accepted_answer_id": 37174153, "answer_count": 2, "score": 4, "last_activity_date": 1612050477, "creation_date": 1463004781, "last_edit_date": 1573740467, "question_id": 37174152, "link": "https://stackoverflow.com/questions/37174152/array-countif-substitute-countmatch", "title": "Array CountIf Substitute - Count(Match())", "body": "<h2>Core Question</h2>\n\n<p>How can I perform repeated <code>CountIf()</code>s on a range as efficiently (performance-wise) as possible?</p>\n\n<p><br></p>\n\n<h2>Concerns in Detail</h2>\n\n<p><strong>Range to Array</strong></p>\n\n<p>Since each read/write to a spreadsheet results in slower VBA code, it is advisable to do so as few times as possible. Normally, if someone is repeatedly reading/writing to a range, he or she should first save that range to an array, perform the operations to the array, and then do a final read or write to the spreadsheet if necessary.</p>\n\n<p><br>\n<strong>Example Values and Code</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/owyrv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/owyrv.png\" alt=\"Example Values\"></a></p>\n\n<p>How can I use perform <code>CountIf()</code>s on the range of <code>A2:A11</code> above to calculate the count of each value and write them to <code>D2:D7</code>? I would expect the below code to work:</p>\n\n<pre><code>Sub M1ArrayCount()\n\nDim arrNumbers() As Variant\nDim Long1 As Long\nDim Loop1 As Long\n\narrNumbers() = ThisWorkbook.Sheets(1).Range(\"A2:A11\").Value\n\nWith ThisWorkbook.Sheets(1)\n    For Loop1 = 1 To 6\n        .Cells(Loop1 + 1, 4).Value = Application.CountIf(arrNumbers(), Loop1)\n    Next Loop1\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><strong>CountIf() Doesn't Work with Arrays</strong></p>\n\n<p>However, because <code>Application.CountIf()</code> only works with ranges and not arrays, <code>D2:D7</code> all show <code>#VALUE!</code> errors after running the above code. A substitute must be found.</p>\n"}, {"tags": ["vba", "excel", "unit-testing"], "answers": [{"tags": [], "owner": {"reputation": 126, "user_id": 2811765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f9d48f19954ce958bd878b93d392ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Gall", "link": "https://stackoverflow.com/users/2811765/scott-gall"}, "is_accepted": false, "score": 0, "last_activity_date": 1463020679, "creation_date": 1463020679, "answer_id": 37176333, "question_id": 37173851, "link": "https://stackoverflow.com/questions/37173851/unit-testing-both-excel-formulas-and-vb-with-the-same-tool/37176333#37176333", "title": "Unit testing both Excel formulas and VB with the same tool?", "body": "<p>The only way I have found to \"Unit Test\" functions within Excel is to create a sheet within you workbook for which it's purpose in life is to be the validations page. Define Various additional functions within this sheet which look for edge cases and check additions etc within your workbook.</p>\n\n<p>It is quite helpful to keep a comments field as well as a boolean success field that can be aggregated to put a custom format message on your other input pages to cue the user to a failed \"Unit Test\".</p>\n\n<p>This approach can work quite well in making your testing reusable as well as transparent to the end users of your workbooks.</p>\n"}, {"tags": [], "owner": {"reputation": 161, "user_id": 11229873, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DLJ1V.png?s=128&g=1", "display_name": "bradbase", "link": "https://stackoverflow.com/users/11229873/bradbase"}, "is_accepted": false, "score": 0, "last_activity_date": 1588751306, "last_edit_date": 1588751306, "creation_date": 1588656024, "answer_id": 61606254, "question_id": 37173851, "link": "https://stackoverflow.com/questions/37173851/unit-testing-both-excel-formulas-and-vb-with-the-same-tool/61606254#61606254", "title": "Unit testing both Excel formulas and VB with the same tool?", "body": "<p>It is possible to unit test both Excel formulas and VBA using <a href=\"https://github.com/bradbase/flyingkoala\" rel=\"nofollow noreferrer\">FlyingKoala</a>. FlyingKoala is an extension of <a href=\"https://www.xlwings.org/\" rel=\"nofollow noreferrer\">xlwings</a>.</p>\n\n<p>xlwings offers a COM wrapper which provides the ability to execute VBA from Python (by getting Excel to run it). It's a great library/solution. The esteemed Felix from ZoomerAnalyitics has written a <a href=\"https://www.xlwings.org/blog/unittests-for-microsoft-excel\" rel=\"nofollow noreferrer\">blogpost</a> about unit testing VBA using xlwings with examples.</p>\n\n<p>FlyingKoala uses a library (<a href=\"https://github.com/bradbase/xlcalculator\" rel=\"nofollow noreferrer\">xlcalculator</a>) to convert Excel formulas into Python which can then be unit tested in Python's unittest framework. So it's possible to evaluate the formula and check against a known goal value whether that is in Excel or pre-defined.</p>\n\n<p>An example of unit testing formulas using FlyingKoala while Excel is running;</p>\n\n<pre><code>import unittest\nimport logging\n\nimport xlwings as xw\nfrom flyingkoala import FlyingKoala\nfrom pandas import DataFrame\nfrom pandas import Series\nfrom numpy import array\nfrom numpy.testing import assert_array_equal\nfrom pandas.testing import assert_series_equal\n\nlogging.basicConfig(level=logging.ERROR)\n\nclass Test_equation_1(unittest.TestCase):\n\n    def setUp(self):\n\n        self.workbook_name = r'growing_degrees_day.xlsm'\n\n        if len(xw.apps) == 0:\n            raise \"We need an Excel workbook open for this unit test.\"\n\n        self.my_fk = FlyingKoala(self.workbook_name, load_koala=True)\n        self.my_fk.reload_koala('')\n        self.equation_name = xw.Range('Equation_1')\n\n        if self.equation_name not in self.my_fk.koala_models.keys():\n            model = None\n            wb = xw.books[self.workbook_name]\n            wb.activate()\n            for name in wb.names:\n                self.my_fk.load_model(self.equation_name)\n                if self.equation_name == name.name:\n                    model = xw.Range(self.equation_name)\n                    self.my_fk.generate_model_graph(model)\n\n            if model is None:\n                return 'Model \"%s\" has not been loaded into cache, if named range exists check spelling.' % self.equation_name\n\n\n    def test_Equation_1(self):\n        \"\"\"First type of test for Equation_1\"\"\"\n\n        xw.books[self.workbook_name].sheets['Growing Degree Day'].activate()\n\n        goal = xw.books[self.workbook_name].sheets['Growing Degree Day'].range(xw.Range('D2'), xw.Range('D6')).options(array).value\n\n        tmin = xw.books[self.workbook_name].sheets['Growing Degree Day'].range(xw.Range('B2'), xw.Range('B6')).options(array).value\n        tmax = xw.books[self.workbook_name].sheets['Growing Degree Day'].range(xw.Range('C2'), xw.Range('C6')).options(array).value\n        inputs_for_DegreeDay = DataFrame({'T_min': tmin, 'T_max': tmax})\n        result = self.my_fk.evaluate_koala_model('Equation_1', inputs_for_DegreeDay).to_numpy()\n\n        assert_array_equal(goal, result)\n\n\n    def test_Equation_1_predefined_goal(self):\n        \"\"\"First type of test for Equation_1\"\"\"\n\n        goal = Series([0.0, 0.0, 0.0, 0.0, 0.0, 5, 10, 15, 20])\n\n        tmin = [-20, -15, -10, -5, 0, 5, 10, 15, 20]\n        tmax = [0, 5, 10, 15, 20, 25, 30, 35, 40]\n        inputs_for_DegreeDay = DataFrame({'T_min': tmin, 'T_max': tmax})\n        result = self.my_fk.evaluate_koala_model('Equation_1', inputs_for_DegreeDay)\n\n        assert_series_equal(goal, result)\n\n\n    def test_VBA_Equation_1(self):\n        \"\"\"\n        The function definition being called;\n\n        Function VBA_Equation_1(T_min As Double, T_max As Double) As Double\n            VBA_Equation_1 = Application.WorksheetFunction.Max(((T_max + T_min) / 2) - 10, 0)\n        End Function\n        \"\"\"\n\n        goal = 20\n\n        vba_equation_1 = xw.books[self.workbook_name].macro('VBA_Equation_1')\n        result = vba_equation_1(20.0, 40.0)\n\n        self.assertEqual(goal, result)\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 5884646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c19e283f5cf68f6c77307ad4064350a6?s=128&d=identicon&r=PG&f=1", "display_name": "mostlynew", "link": "https://stackoverflow.com/users/5884646/mostlynew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1588751306, "creation_date": 1463003310, "question_id": 37173851, "link": "https://stackoverflow.com/questions/37173851/unit-testing-both-excel-formulas-and-vb-with-the-same-tool", "title": "Unit testing both Excel formulas and VB with the same tool?", "body": "<p>Are there any tools that allow for unit testing both Excel formulas and Visual Basic forms within Excel? I'm finding methods that will do one or the other, but not both. <a href=\"http://rubberduck-vba.com\" rel=\"nofollow\">Rubberduck</a> for example looks promising for testing VBA, but does not appear to allow testing of formulas within Excel spreadsheets.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1463001537, "post_id": 37173026, "comment_id": 61881571, "body": "Is this code in a <b>module</b> code sheet or a <b>sheet</b> code sheet? Did you get there by right-clicking the worksheet&#39;s name tab and choose View Code? Did you open the VBE with [alt]+F11 and use the pull-downs to Insert \u25ba Module?"}, {"owner": {"reputation": 19, "user_id": 4595378, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/97cefa9c5d6c34a06b6811551eb18369?s=128&d=identicon&r=PG&f=1", "display_name": "MTB", "link": "https://stackoverflow.com/users/4595378/mtb"}, "edited": false, "score": 0, "creation_date": 1504747202, "post_id": 37173026, "comment_id": 79134873, "body": "@Jeeped It is in the main sheet"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 4595378, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/97cefa9c5d6c34a06b6811551eb18369?s=128&d=identicon&r=PG&f=1", "display_name": "MTB", "link": "https://stackoverflow.com/users/4595378/mtb"}, "edited": false, "score": 0, "creation_date": 1463342288, "post_id": 37173994, "comment_id": 62014889, "body": "Thanks for taking the time to look at this, this works exactly as advertised."}, {"owner": {"reputation": 19, "user_id": 4595378, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/97cefa9c5d6c34a06b6811551eb18369?s=128&d=identicon&r=PG&f=1", "display_name": "MTB", "link": "https://stackoverflow.com/users/4595378/mtb"}, "edited": false, "score": 0, "creation_date": 1463342728, "post_id": 37173994, "comment_id": 62015043, "body": "I was wondering how I could get this to work during runtime, as in, i wanted to get user input and punch that in as a time variable, and then once all other modules were completed, then this module would be executed."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 19, "user_id": 4595378, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/97cefa9c5d6c34a06b6811551eb18369?s=128&d=identicon&r=PG&f=1", "display_name": "MTB", "link": "https://stackoverflow.com/users/4595378/mtb"}, "edited": false, "score": 0, "creation_date": 1463343165, "post_id": 37173994, "comment_id": 62015194, "body": "@MTB  I wrote some code a while back to do exactly what you describe.  The code requested the time in <b>seconds</b> and then used it."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1463004041, "creation_date": 1463004041, "answer_id": 37173994, "question_id": 37173026, "link": "https://stackoverflow.com/questions/37173026/create-a-countdown-timer-in-excel-2010-using-vba-excel/37173994#37173994", "title": "create a countdown timer in excel 2010 using VBA (excel)", "body": "<p>I modified your code very slightly and put it in a standard module:</p>\n\n<pre><code>Public Future As Double\n\nSub StartTimer()\n    Future = Now + TimeSerial(0, 0, 1)\n    Application.OnTime earliestTime:=Future, procedure:=\"nextTime\", _\n         schedule:=True\nEnd Sub\n\nSub nextTime()\n    Sheet1.Range(\"B1\").Value = Sheet1.Range(\"B1\").Value - TimeValue(\"00:00:01\")\n    StartTimer\nEnd Sub\n\nSub StopTimer()\n   On Error Resume Next\n   Application.OnTime earliestTime:=Future, _\n       procedure:=\"nextTime\", schedule:=False\nEnd Sub\n</code></pre>\n\n<p>Both <em>StartTimer()</em> and <em>StopTimer()</em> run just fine.</p>\n"}], "owner": {"reputation": 19, "user_id": 4595378, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/97cefa9c5d6c34a06b6811551eb18369?s=128&d=identicon&r=PG&f=1", "display_name": "MTB", "link": "https://stackoverflow.com/users/4595378/mtb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10793, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1469110530, "creation_date": 1462999761, "last_edit_date": 1531161705, "question_id": 37173026, "link": "https://stackoverflow.com/questions/37173026/create-a-countdown-timer-in-excel-2010-using-vba-excel", "title": "create a countdown timer in excel 2010 using VBA (excel)", "body": "<p>I'm using Excel 2010, and want to create a countdown timer in excel. The code will be started and stopped by using buttons with macros attached to them. The problem occurs when the \"start\" button is pushed. The code above is utilizing Cell \"B1\" as the input spot, because I was just trying to get it to work, but every time I tried, it would always say: \n    \"Cannot run the macro . The macro may not be available in this workbook or all macros may be disabled\". </p>\n\n<p>Yes I enabled all macros before putting this here. I want to be able to take user input, and to make that the time that the timer starts at instead of just using cell \"B1\". </p>\n\n<pre><code>'Macro for Starting the timer (attached to the start button)\nSub startTimer()\nApplication.OnTime Now + TimeValue(\"00:00:01\"), \"nextTick\"\nEnd Sub\n\n'Macro for next second\nSub nextTick()\nSheet1.Range(\"B1\").Value = Sheet1.Range(\"B1\").Value - TimeValue(\"00:00:01\")\nstartTimer\nEnd Sub\n\n'Macro for stopping the timer (attached to the end button)\nSub stopTimer()\nApplication.OnTime Now - TimeValue(\"00:00:01\"), \"nextTick\", , False\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "date", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 24, "user_id": 6301450, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1ozU3y5zEEA/AAAAAAAAAAI/AAAAAAAAAwk/yYR7M74Mfws/photo.jpg?sz=128", "display_name": "Scott Baker", "link": "https://stackoverflow.com/users/6301450/scott-baker"}, "edited": false, "score": 0, "creation_date": 1463000303, "post_id": 37173158, "comment_id": 61880913, "body": "&quot;.pdf&quot; &lt;-- i forgot the dot above!"}], "tags": [], "owner": {"reputation": 24, "user_id": 6301450, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1ozU3y5zEEA/AAAAAAAAAAI/AAAAAAAAAwk/yYR7M74Mfws/photo.jpg?sz=128", "display_name": "Scott Baker", "link": "https://stackoverflow.com/users/6301450/scott-baker"}, "is_accepted": true, "score": 1, "last_activity_date": 1463001427, "last_edit_date": 1463001427, "creation_date": 1463000267, "answer_id": 37173158, "question_id": 37172974, "link": "https://stackoverflow.com/questions/37172974/putting-date-after-after-file-name/37173158#37173158", "title": "Putting date after after file name", "body": "<p>this should work:\nobjAtt.SaveAsFile saveFolder &amp; \" ASDF ADF AD\" &amp; dateFormat &amp; \".pdf\"</p>\n"}], "owner": {"reputation": 13, "user_id": 6291379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80920964a67a155b5c70b010e1114529?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doez", "link": "https://stackoverflow.com/users/6291379/j-doez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 1, "accepted_answer_id": 37173158, "answer_count": 1, "score": 0, "last_activity_date": 1463001427, "creation_date": 1462999564, "question_id": 37172974, "link": "https://stackoverflow.com/questions/37172974/putting-date-after-after-file-name", "title": "Putting date after after file name", "body": "<p>This is what I have so far:</p>\n\n<pre><code>Public Sub saveAttachtoDisk6(itm As Outlook.MailItem)\nDim objAtt As Outlook.Attachment\nDim saveFolder As String\nsaveFolder = \"P:\\me\\\"\nDim dateFormat\ndateFormat = Format(Now, \"yyyy.mm.dd\")\n For Each objAtt In itm.Attachments\n        If InStr(1, objAtt.FileName, \"ASDFA\", vbTextCompare) &gt; 0 Then\n        objAtt.SaveAsFile saveFolder &amp; dateFormat &amp; \" ADFA ADF.pdf\"\n        ElseIf InStr(1, itm.Subject, \"ASDF ADSF ADSF\", vbTextCompare) &gt; 0 Then\n        objAtt.SaveAsFile saveFolder &amp; dateFormat &amp; \" ASD ASDF ASD.pdf\"\n        ElseIf InStr(1, objAtt.FileName, \"ASDDAAD\", vbTextCompare) &gt; 0 Then\n        objAtt.SaveAsFile saveFolder &amp; dateFormat &amp; \" ASDF ADF AD.pdf\"\n        Else\n  End If\n  Set objAtt = Nothing\n Next\nEnd Sub\n</code></pre>\n\n<p>Changed file names for privacy, but I want to put the date after the file name but I need the .pdf to save the files as pdf's. The files I get are pdf's in the email but for some reason I could only get this to work by appending .pdf at the end of the file name. Is there any way to get this to save as \"ASDD ASDAS 2016.05.11.pdf\" instead of \"2016.05.11 ADSF ASDF.pdf\"? </p>\n\n<p>Thanks!!!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 741, "user_id": 5455941, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9d15614985a2ae4540c08f7987341c1e?s=128&d=identicon&r=PG&f=1", "display_name": "data_pi", "link": "https://stackoverflow.com/users/5455941/data-pi"}, "edited": false, "score": 0, "creation_date": 1463066715, "post_id": 37173794, "comment_id": 61915060, "body": "Hmm, it&#39;s giving me an error for:        If StrComp(Source_Data.Cells(j, 2).Value, Target_Data.Cells(i, 6).Value, CompareMethod.Text) = 0 Then   , its giving me an object required error"}, {"owner": {"reputation": 741, "user_id": 5455941, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9d15614985a2ae4540c08f7987341c1e?s=128&d=identicon&r=PG&f=1", "display_name": "data_pi", "link": "https://stackoverflow.com/users/5455941/data-pi"}, "edited": false, "score": 0, "creation_date": 1463067069, "post_id": 37173794, "comment_id": 61915326, "body": "I fixed it by using: If StrComp(Source_Data.Cells(j, 2).Value, Target_Data.Cells(i, 6).Value, vbTextCompare) = 0 Then   instead of using it with CompareMethod.Text"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "reply_to_user": {"reputation": 741, "user_id": 5455941, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9d15614985a2ae4540c08f7987341c1e?s=128&d=identicon&r=PG&f=1", "display_name": "data_pi", "link": "https://stackoverflow.com/users/5455941/data-pi"}, "edited": false, "score": 0, "creation_date": 1463067210, "post_id": 37173794, "comment_id": 61915418, "body": "Oh, yeah. I was wondering what that Comparemethod.Text was there for, but I guessed you had something in a Class module or something... I&#39;ll update my answer. :)"}], "tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": true, "score": 0, "last_activity_date": 1463075062, "last_edit_date": 1463075062, "creation_date": 1463002986, "answer_id": 37173794, "question_id": 37172850, "link": "https://stackoverflow.com/questions/37172850/comparing-text-within-2-columns-in-different-workbooks/37173794#37173794", "title": "Comparing text within 2 columns in different workbooks", "body": "<p>You are mixing a few things. Namely range objects (actual cells in Excel) and row counts (simple numbers).</p>\n\n<p>Try it like this:</p>\n\n<pre><code>Set Target_Data = Target_Workbook.Sheets(\"Sheet1\").Cells(2, 6).CurrentRegion\nSet Source_Data = Source_Workbook.Sheets(\"Sheet1`\").Cells(5, 2).CurrentRegion\n\nFor i = 1 To Target_Data.Rows.Count\nFor j = 1 To Source_Data.Rows.Count\n  If Source_Data.Cells(j, 1).Value &lt;&gt; \"\" Then  \n    If StrComp(Source_Data.Cells(j, 2).Value, Target_Data.Cells(i, 6).Value, vbTextCompare) = 0 Then\n\n      Source_Data.Cells(j, 2).Interior.Color = RGB(255, 255, 255) \n      Source_Data.Cells(j, 2).Font.Color = RGB(0, 0, 0) \n\n    Else\n      Source_Data.Cells(j, 2).Interior.Color = RGB(0, 0, 0) \n      Source_Data.Cells(j, 2).Font.Color = RGB(255, 199, 206) \n    End If\n  End If\nNext j\nNext I\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 741, "user_id": 5455941, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9d15614985a2ae4540c08f7987341c1e?s=128&d=identicon&r=PG&f=1", "display_name": "data_pi", "link": "https://stackoverflow.com/users/5455941/data-pi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 37173794, "answer_count": 1, "score": 1, "last_activity_date": 1463075062, "creation_date": 1462999179, "question_id": 37172850, "link": "https://stackoverflow.com/questions/37172850/comparing-text-within-2-columns-in-different-workbooks", "title": "Comparing text within 2 columns in different workbooks", "body": "<p>I'm trying to compare all the cells in two columns, each column in different workbooks.\nThe cells contain text and numbers, and if the two cells (each in different workbooks) are different, I want one of the cells to be highlighted/colored/filled.</p>\n\n<p><strong>Task:</strong> </p>\n\n<p>1.1 - Cell1 = Hi </p>\n\n<p>1.1 - Cell2 = Hi</p>\n\n<p>So no highlight need here, both values are equal</p>\n\n<p>1.2 - Cell1 = Hello</p>\n\n<p>1.2 - Cell2 = Hellod</p>\n\n<p>Highlight is needed here, both values are not equal to one another</p>\n\n<p><strong>NOTE: Both Cell1 and Cell2 are in different workbooks</strong></p>\n\n<p><strong>Here is the code I have so far:</strong></p>\n\n<pre><code>Sub DescriptionDiscrepency()\n</code></pre>\n\n<ul>\n<li>Set the location of file to an object</li>\n<li><p>Target Path is redundant in my code but might be useful for you guys</p>\n\n<pre><code>Target_Path = \"C:\\Users\\Example.xlsm\"\n\n\nSet Target_Workbook = Workbooks(\"Example.xlsm\")\nTarget_Workbook.Sheets(\"Sheet1\").Unprotect Password:=\"****\"\nSet Source_Workbook = Workbooks(\"Example2.xlsm\")\nSource_Workbook.Sheets(\"Sheet1\").Unprotect Password:=\"*****\"\n</code></pre>\n\n<ul>\n<li><p>Read Data from Target File to see if source file matches up</p>\n\n<pre><code>Target_Data = Target_Workbook.Sheets(\"Sheet1\").Cells(2, 6).CurrentRegion.Rows.Count\nSource_Data = Source_Workbook.Sheets(\"Sheet1`\").Cells(5, 2).CurrentRegion.Rows.Count\n</code></pre></li>\n<li><p>Highlight if CAT description is not same in our status tracker</p></li>\n<li><p><strong>This part is not working</strong></p>\n\n<pre><code>For i = 1 To lastRow\nFor j = 1 To lastRow\n    If Source_Data.Cells(j, 1).Value &lt;&gt; \"\" Then  \n        If StrComp(Source_Data.Cells(j, 2).Value, \n            Target_Data.Cells(i, 6).Value, CompareMethod.Text) = 0 Then\n\n            Source_Data.Cells(j, 2).Interior.ColorIndex = RGB(255, 255, 255) \n            Source_Data.Cells(j, 2).Font.Color = RGB(0, 0, 0) \n\n        Else\n            Source_Data.Cells(j, 2).Interior.ColorIndex = RGB(0, 0, 0) \n            Source_Data.Cells(j, 2).Font.Color = RGB(255, 199, 206) \n        End If\n    End If\nNext j\nNext I\nEnd Sub\n</code></pre></li>\n</ul></li>\n</ul>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2126, "user_id": 3076048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6400b93631ba00051f21c5e158f1ed34?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Balhoff", "link": "https://stackoverflow.com/users/3076048/mark-balhoff"}, "edited": false, "score": 0, "creation_date": 1462999778, "post_id": 37172787, "comment_id": 61880646, "body": "See <a href=\"http://www.rondebruin.nl/win/s3/win026.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s3/win026.htm</a>"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1463002413, "post_id": 37172787, "comment_id": 61881959, "body": "<code>searched quite a few different &#47; similar topics, but non were able to help</code> @tigeravatar has done this several times here at SO."}, {"owner": {"reputation": 1, "user_id": 4930000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d42645e36c38f4b0cce9f049a457e6a?s=128&d=identicon&r=PG&f=1", "display_name": "mkn95u0", "link": "https://stackoverflow.com/users/4930000/mkn95u0"}, "edited": false, "score": 0, "creation_date": 1463003148, "post_id": 37172787, "comment_id": 61882280, "body": "Can you link them to me? i mean, i&#39;ve been googling all day, and then i&#39;ve read through and tried about 6 or so on here myself."}, {"owner": {"reputation": 1, "user_id": 4930000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d42645e36c38f4b0cce9f049a457e6a?s=128&d=identicon&r=PG&f=1", "display_name": "mkn95u0", "link": "https://stackoverflow.com/users/4930000/mkn95u0"}, "edited": false, "score": 0, "creation_date": 1463003302, "post_id": 37172787, "comment_id": 61882334, "body": "Mark, that one does not do what i need it to do. that one appeared to copy directories as a form of using the vba to do a back up, not necessarily a restore... it copies them to a preset destination... and the code on top of that specifically says it will only copy 1 at a time. Maybe i&#39;m reading that wrong, or i just don&#39;t understand the way it was put in, but it doesn&#39;t appear to be what i&#39;m doing..."}, {"owner": {"reputation": 1, "user_id": 4930000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d42645e36c38f4b0cce9f049a457e6a?s=128&d=identicon&r=PG&f=1", "display_name": "mkn95u0", "link": "https://stackoverflow.com/users/4930000/mkn95u0"}, "edited": false, "score": 0, "creation_date": 1463003408, "post_id": 37172787, "comment_id": 61882373, "body": "Mark, see this part, the copy from &amp; two are static, mine are going to vary by row.Sub Copy_Folder() &#39;This example copy all files and subfolders from FromPath to ToPath. &#39;Note: If ToPath already exist it will overwrite existing files in this folder &#39;if ToPath not exist it will be made for you.     Dim FSO As Object     Dim FromPath As String     Dim ToPath As String      FromPath = &quot;C:\\Users\\Ron\\Data&quot;  &#39;&lt;&lt; Change     ToPath = &quot;C:\\Users\\Ron\\Test&quot;    &#39;&lt;&lt; Change"}, {"owner": {"reputation": 1, "user_id": 4930000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d42645e36c38f4b0cce9f049a457e6a?s=128&d=identicon&r=PG&f=1", "display_name": "mkn95u0", "link": "https://stackoverflow.com/users/4930000/mkn95u0"}, "edited": false, "score": 0, "creation_date": 1463003680, "post_id": 37172787, "comment_id": 61882495, "body": "findwindow - i just did a search for @tigeravatar, and none of his remarks even remotely come close to what i&#39;m asking. thanks for the direction though"}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1463004065, "post_id": 37172787, "comment_id": 61882651, "body": "<a href=\"http://stackoverflow.com/questions/35726602/excel-vba-macro-copy-multiple-files-from-folder-to-folder\" title=\"excel vba macro copy multiple files from folder to folder\">stackoverflow.com/questions/35726602/&hellip;</a> does this for one row - you just need a loop.  And there are a couple others that aren&#39;t quite as relevant."}, {"owner": {"reputation": 1, "user_id": 4930000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d42645e36c38f4b0cce9f049a457e6a?s=128&d=identicon&r=PG&f=1", "display_name": "mkn95u0", "link": "https://stackoverflow.com/users/4930000/mkn95u0"}, "edited": false, "score": 0, "creation_date": 1463005196, "post_id": 37172787, "comment_id": 61883092, "body": "Jerry - for now, this is one i&#39;m trying to work with, so far with no luck. i&#39;ll keep the thread updated if i&#39;m successful.  I&#39;m not aware of how to get it to loop, but if i could get it to do just one first, i can probably look into how to get the source path and dst path to loop"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1463008410, "post_id": 37172787, "comment_id": 61884119, "body": "@mkn95u0 <a href=\"http://stackoverflow.com/questions/18617349/excel-last-character-string-match-in-a-string/18617720#18617720\" title=\"excel last character string match in a string\">stackoverflow.com/questions/18617349/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 4930000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d42645e36c38f4b0cce9f049a457e6a?s=128&d=identicon&r=PG&f=1", "display_name": "mkn95u0", "link": "https://stackoverflow.com/users/4930000/mkn95u0"}, "edited": false, "score": 0, "creation_date": 1463011571, "post_id": 37172787, "comment_id": 61884982, "body": "i posted my resolved solution in the answers. Thank you for everyone who  provided valuable input."}, {"owner": {"reputation": 1, "user_id": 4930000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d42645e36c38f4b0cce9f049a457e6a?s=128&d=identicon&r=PG&f=1", "display_name": "mkn95u0", "link": "https://stackoverflow.com/users/4930000/mkn95u0"}, "edited": false, "score": 0, "creation_date": 1463011779, "post_id": 37172787, "comment_id": 61885026, "body": "findwindow, that is definately not related to this. those are excel formulas, not a macro. it also doesn&#39;t copy nor paste a file in any way at all."}, {"owner": {"reputation": 1, "user_id": 4930000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d42645e36c38f4b0cce9f049a457e6a?s=128&d=identicon&r=PG&f=1", "display_name": "mkn95u0", "link": "https://stackoverflow.com/users/4930000/mkn95u0"}, "edited": false, "score": 0, "creation_date": 1463011874, "post_id": 37172787, "comment_id": 61885055, "body": "findwindow - please read the entire question before replying next time, you&#39;d save us all some unnecessary hassle. i believe you just looked at the column A and Column B and assumed I wanted Column B as the results, that is definitely not the case here."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4930000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d42645e36c38f4b0cce9f049a457e6a?s=128&d=identicon&r=PG&f=1", "display_name": "mkn95u0", "link": "https://stackoverflow.com/users/4930000/mkn95u0"}, "edited": false, "score": 0, "creation_date": 1463006853, "post_id": 37174407, "comment_id": 61883666, "body": "Thanks, i ended up moving the sourcepath and dst path to within the For r = section, then changing to fit the structure of the loop (range&quot;c&quot; 7 r) then used your &amp; rows.count).end(xlup).row instead of the To 3000... i&#39;ll report back in a few mins. i&#39;m able to get some of it with errors, but i think i almost have it"}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 1, "last_activity_date": 1463006204, "creation_date": 1463006204, "answer_id": 37174407, "question_id": 37172787, "link": "https://stackoverflow.com/questions/37172787/copy-files-from-one-location-to-another-based-off-file-path-in-column/37174407#37174407", "title": "Copy files from one location to another based off file path in column", "body": "<p>Loop through the rows and use FileCopy, something like (I am free typing this so you may need to debug)</p>\n\n<pre><code>Sub CopyFiles\nDim X as long\nFor X = 2 to range(\"A\" &amp; Rows.count).end(xlup).row 'Change 2 to 1 if you don't have headers\n    FileCopy Range(\"A\" &amp; X).Text Range(\"B\" &amp; X).Text\nNext\nEnd Sub\n</code></pre>\n\n<p>I don't know if you will need the file name on the destination as I have never used the FileCopy function but if you do I am sure you can source it from Column A without needing help from me. <em>Hint</em> use Split and Ubound to get it</p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1463006325, "creation_date": 1463006325, "answer_id": 37174432, "question_id": 37172787, "link": "https://stackoverflow.com/questions/37172787/copy-files-from-one-location-to-another-based-off-file-path-in-column/37174432#37174432", "title": "Copy files from one location to another based off file path in column", "body": "<p>Please try it like this.</p>\n\n<p>Copy or Move one file</p>\n\n<p>For one file you can use the VBA Name and FileCopy function and for entire folders or a lot of files use the other macro example's on this page.</p>\n\n<pre><code>Sub Copy_One_File()\n    FileCopy \"C:\\Users\\Ron\\SourceFolder\\Test.xls\", \"C:\\Users\\Ron\\DestFolder\\Test.xls\"\nEnd Sub\n\nSub Move_Rename_One_File()\n'You can change the path and file name\n    Name \"C:\\Users\\Ron\\SourceFolder\\Test.xls\" As \"C:\\Users\\Ron\\DestFolder\\TestNew.xls\"\nEnd Sub\n</code></pre>\n\n<p>Copy or move more files or complete folders</p>\n\n<p>Note: Read the commented code lines in the code</p>\n\n<pre><code>Sub Copy_Folder()\n'This example copy all files and subfolders from FromPath to ToPath.\n'Note: If ToPath already exist it will overwrite existing files in this folder\n'if ToPath not exist it will be made for you.\n    Dim FSO As Object\n    Dim FromPath As String\n    Dim ToPath As String\n\n    FromPath = \"C:\\Users\\Ron\\Data\"  '&lt;&lt; Change\n    ToPath = \"C:\\Users\\Ron\\Test\"    '&lt;&lt; Change\n\n    'If you want to create a backup of your folder every time you run this macro\n    'you can create a unique folder with a Date/Time stamp.\n    'ToPath = \"C:\\Users\\Ron\\\" &amp; Format(Now, \"yyyy-mm-dd h-mm-ss\")\n\n    If Right(FromPath, 1) = \"\\\" Then\n        FromPath = Left(FromPath, Len(FromPath) - 1)\n    End If\n\n    If Right(ToPath, 1) = \"\\\" Then\n        ToPath = Left(ToPath, Len(ToPath) - 1)\n    End If\n\n    Set FSO = CreateObject(\"scripting.filesystemobject\")\n\n    If FSO.FolderExists(FromPath) = False Then\n        MsgBox FromPath &amp; \" doesn't exist\"\n        Exit Sub\n    End If\n\n    FSO.CopyFolder Source:=FromPath, Destination:=ToPath\n    MsgBox \"You can find the files and subfolders from \" &amp; FromPath &amp; \" in \" &amp; ToPath\n\nEnd Sub\n</code></pre>\n\n<p>You can find all details using the link below.</p>\n\n<p><a href=\"http://www.rondebruin.nl/win/s3/win026.htm\" rel=\"nofollow\">http://www.rondebruin.nl/win/s3/win026.htm</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4930000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d42645e36c38f4b0cce9f049a457e6a?s=128&d=identicon&r=PG&f=1", "display_name": "mkn95u0", "link": "https://stackoverflow.com/users/4930000/mkn95u0"}, "is_accepted": false, "score": 0, "last_activity_date": 1579062224, "last_edit_date": 1579062224, "creation_date": 1463011471, "answer_id": 37175175, "question_id": 37172787, "link": "https://stackoverflow.com/questions/37172787/copy-files-from-one-location-to-another-based-off-file-path-in-column/37175175#37175175", "title": "Copy files from one location to another based off file path in column", "body": "<p>Here is the code I manipulated from \n<a href=\"https://stackoverflow.com/questions/35726602/excel-vba-macro-copy-multiple-files-from-folder-to-folder\">excel vba macro copy multiple files from folder to folder</a></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub copy()\n    Dim r As Long\n    Dim SourcePath As String\n    Dim dstPath As String\n    Dim myFile As String\n    On Error GoTo ErrHandler\n    For r = 2 To Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        SourcePath = Range(\"C\" &amp; r)\n        dstPath = Range(\"D\" &amp; r)\n        myFile = Range(\"A\" &amp; r)\n        FileCopy SourcePath &amp; \"\\\" &amp; myFile, dstPath &amp; \"\\\" &amp; myFile\n        If Range(\"A\" &amp; r) = \"\" Then\n            Exit For\n        End If\n    Next r\n    MsgBox \"The file(s) can found in: \" &amp; vbNewLine &amp; dstPath, , \"COPY COMPLETED\"\n\nErrHandler:\n    MsgBox \"Copy error: \" &amp; SourcePath &amp; \"\\\" &amp; myFile &amp; vbNewLine &amp; vbNewLine &amp; _\n    \"File could not be found in the source folder\", , \"MISSING FILE(S)\"\n    Range(\"A\" &amp; r).copy Range(\"F\" &amp; r)\n    Resume Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11666612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed64dae0332d7cf60c266a7815589b04?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/11666612/jay"}, "is_accepted": false, "score": 0, "last_activity_date": 1560886598, "creation_date": 1560886598, "answer_id": 56655926, "question_id": 37172787, "link": "https://stackoverflow.com/questions/37172787/copy-files-from-one-location-to-another-based-off-file-path-in-column/56655926#56655926", "title": "Copy files from one location to another based off file path in column", "body": "<p>Below code works fine for me. But it is not able to copy files from Sub Folders</p>\n\n<pre><code>Sub copy() Dim r As Long\n    Dim SourcePath As String\n    Dim dstPath As String\n    Dim myFile As String\n    On Error GoTo ErrHandler\n    For r = 2 To Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    SourcePath = Range(\"C\" &amp; r)\n    dstPath = Range(\"D\" &amp; r)\n        myFile = Range(\"A\" &amp; r)\n        FileCopy SourcePath &amp; \"\\\" &amp; myFile, dstPath &amp; \"\\\" &amp; myFile\n        If Range(\"A\" &amp; r) = \"\" Then\n           Exit For\n        End If\n    Next r\n        MsgBox \"The file(s) can found in: \" &amp; vbNewLine &amp; dstPath, , \"COPY COMPLETED\" ErrHandler:\n    MsgBox \"Copy error: \" &amp; SourcePath &amp; \"\\\" &amp; myFile &amp; vbNewLine &amp; vbNewLine &amp; _\n    \"File could not be found in the source folder\", , \"MISSING FILE(S)\" Range(\"A\" &amp; r).copy Range(\"F\" &amp; r) Resume Next End Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4930000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d42645e36c38f4b0cce9f049a457e6a?s=128&d=identicon&r=PG&f=1", "display_name": "mkn95u0", "link": "https://stackoverflow.com/users/4930000/mkn95u0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26440, "favorite_count": 0, "answer_count": 4, "score": -3, "last_activity_date": 1579062224, "creation_date": 1462998954, "last_edit_date": 1579057808, "question_id": 37172787, "link": "https://stackoverflow.com/questions/37172787/copy-files-from-one-location-to-another-based-off-file-path-in-column", "title": "Copy files from one location to another based off file path in column", "body": "<p>I have a list of files, with file paths, in column A.</p>\n\n<p>I need to copy each file into a directory that has the same folder path (like a backup being restored).</p>\n\n<p>How do I loop through column A and copy each file to column B's location?</p>\n\n<p><strong>Column A</strong></p>\n\n<p><strong>C</strong>:\\Users\\user\\Desktop\\Test\\test1\\test1d.txt</p>\n\n<p>C:\\Users\\user\\Desktop\\Test\\test2\\test2d.txt</p>\n\n<p>C:\\Users\\user\\Desktop\\Test\\test3\\test3d.txt</p>\n\n<p>...</p>\n\n<p><strong>Column B</strong></p>\n\n<p><strong>D</strong>:\\Users\\user\\Desktop\\Test\\test1\\</p>\n\n<p>D:\\Users\\user\\Desktop\\Test\\test2\\</p>\n\n<p>D:\\Users\\user\\Desktop\\Test\\test3\\</p>\n\n<p>...</p>\n\n<p>I searched quite a few topics, but none were able to help me get to what I need to do.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6322349, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-aufkxgNHtRA/AAAAAAAAAAI/AAAAAAAAAI0/m-REXCw2aWU/photo.jpg?sz=128", "display_name": "Pinaki Bhadra", "link": "https://stackoverflow.com/users/6322349/pinaki-bhadra"}, "edited": false, "score": 0, "creation_date": 1463037279, "post_id": 37172964, "comment_id": 61893177, "body": "Hi Gary, I don not need the msgbox to show the &quot;high&quot; &quot;low&quot; values rather I want to copy the &quot;High&quot; values and paste on sheet2 and about &quot;low&quot; values &quot;no action&quot; msg will show on sheet2 cell A2. but when the &quot;high&quot; values rows are pasting on sheet2 the &quot;no action&quot; msg is also coming up on cell A2 sheet2."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1462999537, "creation_date": 1462999537, "answer_id": 37172964, "question_id": 37172671, "link": "https://stackoverflow.com/questions/37172671/excel-vba-programming-to-copy-specific-rows-from-sheet1-to-sheet2-specific-cell/37172964#37172964", "title": "Excel VBA programming to copy specific rows from sheet1 to sheet2 specific cell", "body": "<p>You are moving off <em>Sheet1</em> too soon:</p>\n\n<pre><code>Sub fhskdfh()\n    Sheets(\"Sheet1\").Select\n    Range(\"D1\").Select\n    Dim mycode As Worksheet\n    Set mycode = ThisWorkbook.Worksheets(\"Sheet2\")\n    Dim i As Long\n    For i = 2 To Cells(Rows.Count, \"D\").End(xlUp).Row\n        MsgBox i &amp; vbCrLf &amp; Cells(i, 4).Value\n        If Cells(i, 4).Value = \"high\" Then\n            Range(Cells(i, 1), Cells(i, 8)).Copy Destination:=mycode.Range(\"A\" &amp; mycode.Cells(Rows.Count, \"A\").End(xlUp).Row + 1)\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 6322349, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-aufkxgNHtRA/AAAAAAAAAAI/AAAAAAAAAI0/m-REXCw2aWU/photo.jpg?sz=128", "display_name": "Pinaki Bhadra", "link": "https://stackoverflow.com/users/6322349/pinaki-bhadra"}, "edited": false, "score": 0, "creation_date": 1463037099, "post_id": 37173001, "comment_id": 61893058, "body": "Hi Glenn, Thanks for your comment. I have a column (lets assume cloumn D) which consists the value as &quot;Low&quot; and &quot;High&quot; and my code should be like when the &quot;high&quot; values are found (note: there must be &quot;Low&quot; values also in column D but &quot;high&quot; values may come) from Sheet1, the entire column(s) will copy and paste those to sheet2. But when the column consists only &quot;Low&quot; values that time &quot;No Action&quot; msg is showing on cell A2 on Sheet2 and when column D consists &quot;high&quot; values along with &quot;low&quot; values then it is copying those &quot;high&quot; values and pasting on sheet2 but cell A2 is also showing &quot;No action&quot;."}], "tags": [], "owner": {"reputation": 409, "user_id": 5604652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73bf206d862d877d6c866e97cbaf0184?s=128&d=identicon&r=PG&f=1", "display_name": "B540Glenn", "link": "https://stackoverflow.com/users/5604652/b540glenn"}, "is_accepted": false, "score": 0, "last_activity_date": 1462999649, "creation_date": 1462999649, "answer_id": 37173001, "question_id": 37172671, "link": "https://stackoverflow.com/questions/37172671/excel-vba-programming-to-copy-specific-rows-from-sheet1-to-sheet2-specific-cell/37173001#37173001", "title": "Excel VBA programming to copy specific rows from sheet1 to sheet2 specific cell", "body": "<p>Change your destination of the \"No Crtical Logs Found\" message \n<br/>From  </p>\n\n<pre><code>Sheets(\"Sheet2\").Select Range(\"A2\").Value\n</code></pre>\n\n<p><br/>To  </p>\n\n<pre><code>Sheets(\"Sheet2\").Range(\"A2\").Value\n</code></pre>\n\n<p>You do not need to select the cell before assigning a value to it.</p>\n"}], "owner": {"reputation": 23, "user_id": 6322349, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-aufkxgNHtRA/AAAAAAAAAAI/AAAAAAAAAI0/m-REXCw2aWU/photo.jpg?sz=128", "display_name": "Pinaki Bhadra", "link": "https://stackoverflow.com/users/6322349/pinaki-bhadra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1977, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1462999649, "creation_date": 1462998456, "last_edit_date": 1531164843, "question_id": 37172671, "link": "https://stackoverflow.com/questions/37172671/excel-vba-programming-to-copy-specific-rows-from-sheet1-to-sheet2-specific-cell", "title": "Excel VBA programming to copy specific rows from sheet1 to sheet2 specific cell", "body": "<p>I want to write one vba code which will search data from a specific column of sheet1 and copy those rows and paste those to sheet2. I have written the code but found one problem there. here is the code below.</p>\n\n<pre><code>    Sheets(\"Sheet1\").Select\n    Range(\"D1\").Select\n    Dim mycode As Worksheet\n    Set mycode = ThisWorkbook.Worksheets(\"Sheet2\")\n    Dim i As Long\n    For i = 2 To Cells(Rows.Count, \"D\").End(xlUp).Row\n        If Cells(i, 4).Value = \"high\" Then\n            Range(Cells(i, 1), Cells(i, 8)).Copy Destination:=mycode.Range(\"A\" &amp; mycode.Cells(Rows.Count, \"A\").End(xlUp).Row + 1)\n            ElseIf Cells(i, 4).Value &lt;&gt; \"high\" Then\n            Sheets(\"Sheet2\").Select\n            Range(\"A2\").Value = \"No Crtical Logs Found\"\n            End If\n        Next i\n    End Sub\n</code></pre>\n\n<p>From sheet1 column D(number4) I am searching data matching \"high\" and copy paste those rows to sheet2. And if any of the \"high\" is not there in column D then \"No action required\" will be written in cell A2 on sheet2. But the problem is when \"high\" value is not there it is working fine but when \"high\" value is there in D column sheet1 then all time \"no action required\" value is coming on cell A2 on sheet2. Please help me to rectify this.</p>\n\n<pre><code>No Crtical Logs Found   4/11/2016   Critical    high        192.168.1.1 This is the sample excel sheet  Action Required\n</code></pre>\n\n<p>Regards,\nPinaki</p>\n"}, {"tags": ["excel", "if-statement", "vba"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1462997700, "creation_date": 1462997700, "answer_id": 37172463, "question_id": 37172434, "link": "https://stackoverflow.com/questions/37172434/write-good-or-bad-if-values-in-range-are-true-or-false/37172463#37172463", "title": "Write &quot;good&quot; or &quot;bad&quot; if values in range are true or false", "body": "<p>In T36:</p>\n\n<pre><code>IF(COUNTIF(T5:T35,\"True\")=ROWS(T5:T35),\"GOOD\",\"BAD\")\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 6268362, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/a4202013a491ecfa1b479a4c8d1a219c?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/6268362/alec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 1, "accepted_answer_id": 37172463, "answer_count": 1, "score": 0, "last_activity_date": 1462997700, "creation_date": 1462997588, "last_edit_date": 1531161705, "question_id": 37172434, "link": "https://stackoverflow.com/questions/37172434/write-good-or-bad-if-values-in-range-are-true-or-false", "title": "Write &quot;good&quot; or &quot;bad&quot; if values in range are true or false", "body": "<p>I have a a column (T) with a range of values (T5 thru T35)\nall the values are usually \"true\" but when one or more values say false, I want excel to write in cell T36 \"bad\". And the same thing for \"true\" values, if all are \"true\" then write in cell T36 \"good\".\nThank you for your help </p>\n"}, {"tags": ["sql", "vba", "ms-access", "dao"], "answers": [{"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1463000132, "post_id": 37172775, "comment_id": 61880830, "body": "I think too that <code>RecordsetClone</code> is the way to go, but he will still have to insert the data into a temporary table (either the PKs only and then join it to the main table, or all columns)."}, {"owner": {"reputation": 469, "user_id": 2635462, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8be5508120157c230d6c41e323fd451e?s=128&d=identicon&r=PG", "display_name": "clum", "link": "https://stackoverflow.com/users/2635462/clum"}, "edited": false, "score": 0, "creation_date": 1463341807, "post_id": 37172775, "comment_id": 62014748, "body": "In other words, there&#39;s no way to directly get the <code>RecordsetClone</code> directly into a table, and I have to iterate through it and manually insert it, as I suggested in my question?"}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "reply_to_user": {"reputation": 469, "user_id": 2635462, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8be5508120157c230d6c41e323fd451e?s=128&d=identicon&r=PG", "display_name": "clum", "link": "https://stackoverflow.com/users/2635462/clum"}, "edited": false, "score": 0, "creation_date": 1463404833, "post_id": 37172775, "comment_id": 62037121, "body": "@clum It looks that way. :( I tried using the sql string to dump all rows but it outputs only the first record. You will need to loop to get all of the values from your clone into your table."}], "tags": [], "owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "is_accepted": true, "score": 1, "last_activity_date": 1463404894, "last_edit_date": 1463404894, "creation_date": 1462998906, "answer_id": 37172775, "question_id": 37172136, "link": "https://stackoverflow.com/questions/37172136/using-filtered-records-from-a-form-in-a-query/37172775#37172775", "title": "Using filtered records from a form in a query", "body": "<p>Using <code>Form.RecordsetClone</code> will copy the subform's recordset and include any filters applied through the Access' built-in filters. </p>\n\n<p>Note: the <code>Form.</code> is standard and does not refer to your form. So your reference would need to be <code>Me!SubformName!Form.RecordsetClone</code> if triggered from the main form. <a href=\"https://msdn.microsoft.com/en-us/library/office/ff835062.aspx\" rel=\"nofollow\">MSDN</a></p>\n\n<p>After you  create a clone, it seems you can use sql to drop the recordset into a temp table. But as @Andre mentioned, adding the PK only would be ideal to reduce load in large recordsets. The SQL string creation I found is simply: </p>\n\n<p><code>sql = \"INSERT INTO TEMPTable VALUES\" &amp; rs.Fields(\"YourPKFieldNameFromSUBFORM\")</code></p>\n\n<p>Assuming <code>sql</code> and <code>rs</code> have been declared as a string and your cloned recordset respectively, and TEMPTable has already been created with one column for your PK. <a href=\"https://blog.udemy.com/vba-recordset/\" rel=\"nofollow\">Source: #5</a> and <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193203.aspx\" rel=\"nofollow\">MSDN</a>  However, you will still need to loop through each record of the clone, as the sql statement only outputs a single row at a time.</p>\n"}, {"comments": [{"owner": {"reputation": 469, "user_id": 2635462, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8be5508120157c230d6c41e323fd451e?s=128&d=identicon&r=PG", "display_name": "clum", "link": "https://stackoverflow.com/users/2635462/clum"}, "edited": false, "score": 0, "creation_date": 1466106011, "post_id": 37260791, "comment_id": 63192832, "body": "An important note: This worked fine during development when using a small subset of data. When used in real life, this takes a very long time when there is still a large dataset (such as when there are no filters or barely limiting filters). I still don&#39;t have a good solution for this."}], "tags": [], "owner": {"reputation": 469, "user_id": 2635462, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8be5508120157c230d6c41e323fd451e?s=128&d=identicon&r=PG", "display_name": "clum", "link": "https://stackoverflow.com/users/2635462/clum"}, "is_accepted": false, "score": 0, "last_activity_date": 1463423396, "creation_date": 1463423396, "answer_id": 37260791, "question_id": 37172136, "link": "https://stackoverflow.com/questions/37172136/using-filtered-records-from-a-form-in-a-query/37260791#37260791", "title": "Using filtered records from a form in a query", "body": "<p>As a supplement to Christopher D.'s answer, here is the final code I ended up using:</p>\n\n<pre><code>CurrentDb.Execute \"DELETE FROM FilteredJobs\"\nDim rs As Recordset\nSet rs = Search_subform.Form.RecordsetClone\nrs.MoveFirst\nWhile Not rs.EOF\n    CurrentDb.Execute \"INSERT INTO FilteredJobs VALUES (\" &amp; rs.Fields(\"JobID\") &amp; \")\"\n    rs.MoveNext\nWend\n</code></pre>\n"}], "owner": {"reputation": 469, "user_id": 2635462, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8be5508120157c230d6c41e323fd451e?s=128&d=identicon&r=PG", "display_name": "clum", "link": "https://stackoverflow.com/users/2635462/clum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1438, "favorite_count": 0, "accepted_answer_id": 37172775, "answer_count": 2, "score": 1, "last_activity_date": 1463423396, "creation_date": 1462996572, "last_edit_date": 1462997513, "question_id": 37172136, "link": "https://stackoverflow.com/questions/37172136/using-filtered-records-from-a-form-in-a-query", "title": "Using filtered records from a form in a query", "body": "<p>I have a large table. I am making a form that displays the table, and allows the user to use Access' standard filters on many different fields to choose only some of the data. Then, after the user has used the filters to choose only some of the data, I want to be able to include only the resulting recordset (and not the entire original table) in various queries.</p>\n\n<p>I'm not sure if there's a way I can directly reference the form's underlying recordset in a query. </p>\n\n<p>The obvious thing would be to use vba to iterate through the recordset, and either fill a temporary table with it that would be used in the queries, or directly do what I want with the data without using sql. But I believe iterating through a recordset is considerably slower than a query. Is there some way that I can reference a form's recordset directly from within a query, or dump the entire contents of the recordset into a temporary table?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 0, "creation_date": 1462996472, "post_id": 37172086, "comment_id": 61878891, "body": "How would you suggest fixing it?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 1, "creation_date": 1462996641, "post_id": 37172086, "comment_id": 61878986, "body": "Also, what is the point of this function? It doesn&#39;t return a value or change anything so it&#39;s of no value to your code..."}, {"owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 1, "creation_date": 1462996900, "post_id": 37172086, "comment_id": 61879127, "body": "I am trying to get it to return a value. That is what I am trying to figure out how to do. I am pretty new to VBA so am basically just blundering along."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 0, "creation_date": 1462997074, "post_id": 37172086, "comment_id": 61879227, "body": "It&#39;s a bit too long winded to go into the workings of a UDF in the comments here, but once you&#39;ve hit 20 rep <a href=\"http://chat.stackoverflow.com/rooms/111528/vba-lounge\">join this chat room</a> and I&#39;ll be happy to go through it with you"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 0, "creation_date": 1462998471, "post_id": 37172086, "comment_id": 61879939, "body": "I saw you appeared in the chat room, if you can actually see what&#39;s being said I can explain it while you&#39;re in there even though you can&#39;t post anything if you haven&#39;t got 20+ rep"}, {"owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 0, "creation_date": 1463004549, "post_id": 37172086, "comment_id": 61882851, "body": "I had to head out. I appreciate the help!"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 0, "creation_date": 1463005312, "post_id": 37172086, "comment_id": 61883139, "body": "No worries, when you hit 20 rep just ping me in that room :)"}, {"owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 0, "creation_date": 1463007837, "post_id": 37172086, "comment_id": 61883944, "body": "I just figured out my problem. I was trying to run it as a separate program instead of in the main sub. I moved it to the main sub and it works great. Thanks for the help."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 3, "last_activity_date": 1462996503, "last_edit_date": 1462996503, "creation_date": 1462996352, "answer_id": 37172086, "question_id": 37172037, "link": "https://stackoverflow.com/questions/37172037/argument-not-optional-error/37172086#37172086", "title": "Argument not Optional Error", "body": "<p>Your UDF:</p>\n\n<pre><code>Function Count_BU_Data(A As Integer)\n</code></pre>\n\n<p>Takes an argument (<code>A As Integer</code>) which you haven't specified as being an <em>Optional</em> argument. You call the function from your other routine without supplying this argument:</p>\n\n<pre><code>Sub Organize_Data()\n\n    Dim A As Integer\n    Dim B As Integer\n    Dim C As Integer\n\n    Worksheets.Add().Name = \"Calculations\"\n    Find_Unit\n    Find_Locations\n    Count_BU_Data    '// &lt;~~ No argument passed to function.\n    Count_Country_Data\n    Count_Raw_Data\nEnd Sub\n</code></pre>\n\n<p>Hence the 'Argument not optional' error.</p>\n\n<p>Seeing as that function doesn't appear to actually use the argument, you can either remove it from the function header:</p>\n\n<pre><code>Function Count_BU_Data() As Long '// Note I've included a return value...\n</code></pre>\n\n<p>Or make it an optional argument</p>\n\n<pre><code>Function Count_BU_Data(Optional A As Integer) As Long\n</code></pre>\n\n<p>You can also specify a default value if the optional argument isn't supplied</p>\n\n<pre><code>Function Count_BU_Data(Optional A As Integer = 1) As Long\n</code></pre>\n"}], "owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 37172086, "answer_count": 1, "score": 2, "last_activity_date": 1462996503, "creation_date": 1462996175, "last_edit_date": 1462996230, "question_id": 37172037, "link": "https://stackoverflow.com/questions/37172037/argument-not-optional-error", "title": "Argument not Optional Error", "body": "<p>I am building a sheet to extract data from a list of job openings that I need to sort and filter by location and by BU. I need the code to count the number of openings then pass that information back to the main sub to use in creating additional pages and to loop the sub. I keep getting the above error in this segment. Any thoughts on what I am doing wrong?</p>\n\n<pre><code>Sub Organize_Data()\n\n    Dim A As Integer\n    Dim B As Integer\n    Dim C As Integer\n\n    Worksheets.Add().Name = \"Calculations\"\n    Find_Unit\n    Find_Locations\n    Count_BU_Data\n    Count_Country_Data\n    Count_Raw_Data\nEnd Sub\n\nFunction Count_BU_Data(A As Integer)\n\n   ActiveWorkbook.Worksheets(\"Calculations\").Range(\"B3\", Worksheets(\"Calculations\").Range(\"B3\").End(xlDown)).Rows.Count\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462995777, "post_id": 37171861, "comment_id": 61878481, "body": "Welcome to StackOverflow. If you have working code which merely needs improvements then you&#39;re probably in the wrong place with this post. <a href=\"http://codereview.stackexchange.com/\">Code Review</a> is where they handle existing / working code and do their upmost to improve it in terms of speed, security, sustainability, and longevity. Give it a try. They&#39;re good! Yet, if you have problems with the above code, please specify the error(s) you are getting. Maybe you want to <a href=\"http://stackoverflow.com/tour\">take the tour</a> for SO and learn more about it. At the same time you&#39;ll earn a badge..."}, {"owner": {"reputation": 1, "user_id": 6140163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/659ffb98f960c5151e1c274567466d24?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/6140163/richard"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462996950, "post_id": 37171861, "comment_id": 61879158, "body": "@Ralph You are right. Excuse me for not specifying the issue in the beginning. I have edited the post with the error."}, {"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1462997469, "post_id": 37171861, "comment_id": 61879410, "body": "<code>redim rngduplicates(0,0)</code> means you only have one entry in an array.  You then assign a range (via the find function) to rngduplicates(0).  NExt you compare to rngduplicates(1) which doesn&#39;t exist and throws an error."}, {"owner": {"reputation": 1, "user_id": 6140163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/659ffb98f960c5151e1c274567466d24?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/6140163/richard"}, "reply_to_user": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1463057763, "post_id": 37171861, "comment_id": 61907806, "body": "@gtwebb thanks for your comments. I have changed &#39;redim rngduplicates(0,0)&#39; to &#39;redim rngduplicates(0,5)&#39; and it throws &quot;Object variable or With Blcok variable not set&quot; error at &#39;If rngduplicates(i).Address &lt;&gt; rngcell.Address Then&#39; which I can&#39;t see why. Any ideas on why it gets stuck?"}], "owner": {"reputation": 1, "user_id": 6140163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/659ffb98f960c5151e1c274567466d24?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/6140163/richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1462996858, "creation_date": 1462995500, "last_edit_date": 1462996858, "question_id": 37171861, "link": "https://stackoverflow.com/questions/37171861/inspecting-the-duplicate-values-on-a-worksheet-before-a-new-data-entry-is-made", "title": "Inspecting the duplicate values on a worksheet before a new data entry is made", "body": "<p>I would like to create a well-functioning code which searches for duplicates values in a range of cells and exits the procedure in case a duplicate value has been found. The underlying motivation is to prevent data entry from happening more than once should the users make the same entry multiple times. In the absence of duplicate values, the data provided in Worksheet1 would be copied to Worksheet2. It is why I do not choose conditional formatting as a possible solution for duplicate values.</p>\n\n<p>The code does not seem to capture the range \"(Range(\"A:B\"))\" wherein the duplicate values might occur as it throws a \"Subscript out of Range\" error at \"If rngduplicates(i).Address &lt;> rngcell.Address Then\" part. </p>\n\n<p>Please find the code below that I have been tinkering with for a while. Your help is much appreciated.</p>\n\n<pre><code>Sub attitude()\n\nWorkbooks(\"wbname\").Activate\n\nDim EmptyRow As Long: EmptyRow = Application.WorksheetFunction.Count(Range(\"A:A\")) + 1\nDim rng As Range\nDim i As Integer\nDim rngduplicates() As Range\nDim rngcell As Range\nDim rngCheck As Range\n\nSet rngCheck = Worksheets(\"WK2\").Range(\"A:B\")\n\nWith Sheets(\"WK1\")\n\n  Set rng = .Range(\"B1:B2, B4:B11\")\n  Set rng = Union(.Range(\"B1:B2\"), .Range(\"B4:B11\"))\n\n  For Each rngcell In rngCheck.Cells\n\n    Debug.Print rngcell.Address\n\n    If Not IsEmpty(rngcell.Value) Then\n      ReDim rngduplicates(0 To 0)\n      i = 0\n      Set rngduplicates(i) = rngCheck.Find(What:=rngcell.Value, After:=rngcell, LookIn:=xlValues, _\n      LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext)\n      i = i + 1\n      If rngduplicates(i).Address &lt;&gt; rngcell.Address Then\n        MsgBox (\"You have already evaluated this agent. Please evaluate the next one\")\n        Exit Sub\n      Else\n        rng.Copy\n        Sheets(\"WK2\").Cells(EmptyRow + 1, 1).PasteSpecial Paste:=xlPasteValues, Transpose:=True\n        Application.CutCopyMode = False\n      End If\n    End If\n\n  Next rngcell\n\nEnd With\n\nSet rng = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 156, "user_id": 6219524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be82ab7ad90aa19b4df8add5fcc2d244?s=128&d=identicon&r=PG&f=1", "display_name": "csanjose", "link": "https://stackoverflow.com/users/6219524/csanjose"}, "edited": false, "score": 0, "creation_date": 1462995814, "post_id": 37171759, "comment_id": 61878509, "body": "Range(c2, c3...cn) are filled with data? Could you upload a picture? Your while bucle seems to work as expected..."}, {"owner": {"reputation": 501, "user_id": 1618085, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/899a85006f2c9b0502ac0fa9faeeada5?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/1618085/james"}, "reply_to_user": {"reputation": 156, "user_id": 6219524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be82ab7ad90aa19b4df8add5fcc2d244?s=128&d=identicon&r=PG&f=1", "display_name": "csanjose", "link": "https://stackoverflow.com/users/6219524/csanjose"}, "edited": false, "score": 0, "creation_date": 1462996128, "post_id": 37171759, "comment_id": 61878681, "body": "A through G has data down to row 37 on the search sheet (Sheet 1)"}, {"owner": {"reputation": 156, "user_id": 6219524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be82ab7ad90aa19b4df8add5fcc2d244?s=128&d=identicon&r=PG&f=1", "display_name": "csanjose", "link": "https://stackoverflow.com/users/6219524/csanjose"}, "edited": false, "score": 0, "creation_date": 1462996494, "post_id": 37171759, "comment_id": 61878906, "body": "I filled my sheet with some data in column C, and in a step-by-step debug works fine. Plz show us the excel sheet"}, {"owner": {"reputation": 156, "user_id": 6219524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be82ab7ad90aa19b4df8add5fcc2d244?s=128&d=identicon&r=PG&f=1", "display_name": "csanjose", "link": "https://stackoverflow.com/users/6219524/csanjose"}, "edited": false, "score": 0, "creation_date": 1462996902, "post_id": 37171759, "comment_id": 61879130, "body": "This is just off-topic. Is better to use cells(i,j) instead of that range expresion which is a bit confusing. If tformat is not important, you dont need to .select and .copy to copy values from a cell to another"}], "answers": [{"tags": [], "owner": {"reputation": 156, "user_id": 6219524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be82ab7ad90aa19b4df8add5fcc2d244?s=128&d=identicon&r=PG&f=1", "display_name": "csanjose", "link": "https://stackoverflow.com/users/6219524/csanjose"}, "is_accepted": false, "score": 0, "last_activity_date": 1462999659, "last_edit_date": 1462999659, "creation_date": 1462995793, "answer_id": 37171920, "question_id": 37171759, "link": "https://stackoverflow.com/questions/37171759/while-is-broken-after-the-first-run-through-in-excel-vba-macro/37171920#37171920", "title": "&quot;WHILE&quot; is broken after the first run through in Excel VBA Macro", "body": "<p>Hope this works</p>\n\n<pre><code>Sub pos()\n\nFor x = 1 To 50\n\n    Dim LSearchRow, LCopyToRow As Integer\n\n    LSearchRow = 2\n    LCopyToRow = 2\n\n    While Cells(LSearchRow, 3) &lt;&gt; \"\"\n\n       If Cells(LSearchRow, 8) = x Then\n        For j = 1 To 8\n          Sheets(\"PO\" &amp; x).Cells(LCopyToRow, j) = Sheets(1).Cells(LSearchRow, j)\n        Next\n      End If\n\n      LSearchRow = LSearchRow + 1\n      LCopyToRow = LCopyToRow + 1\n\n    Wend\n\n   Next x\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 501, "user_id": 1618085, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/899a85006f2c9b0502ac0fa9faeeada5?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/1618085/james"}, "edited": false, "score": 0, "creation_date": 1462996298, "post_id": 37171992, "comment_id": 61878781, "body": "Sheet(1) is where the rows are copied from and the (&quot;PO&quot; &amp; x) is the sheet in the same workbook where they are pasted to starting at row 2. Then the WHILE needs to go back to Sheet(1) to search the next row."}, {"owner": {"reputation": 156, "user_id": 6219524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be82ab7ad90aa19b4df8add5fcc2d244?s=128&d=identicon&r=PG&f=1", "display_name": "csanjose", "link": "https://stackoverflow.com/users/6219524/csanjose"}, "edited": false, "score": 0, "creation_date": 1462996472, "post_id": 37171992, "comment_id": 61878892, "body": "Ok, didnt checked that"}, {"owner": {"reputation": 501, "user_id": 1618085, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/899a85006f2c9b0502ac0fa9faeeada5?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/1618085/james"}, "edited": false, "score": 0, "creation_date": 1462996578, "post_id": 37171992, "comment_id": 61878958, "body": "@dpdragnev, the move to right before Wend caused it to leave sheets blank instead of at least coping one row as before."}, {"owner": {"reputation": 501, "user_id": 1618085, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/899a85006f2c9b0502ac0fa9faeeada5?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/1618085/james"}, "edited": false, "score": 0, "creation_date": 1462996624, "post_id": 37171992, "comment_id": 61878976, "body": "how do I add images so you can see the master?"}, {"owner": {"reputation": 501, "user_id": 1618085, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/899a85006f2c9b0502ac0fa9faeeada5?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/1618085/james"}, "edited": false, "score": 0, "creation_date": 1462996827, "post_id": 37171992, "comment_id": 61879093, "body": "image has been added to original post"}, {"owner": {"reputation": 1699, "user_id": 3135566, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1c02713d9ee49574017166f791acb41c?s=128&d=identicon&r=PG&f=1", "display_name": "dpdragnev", "link": "https://stackoverflow.com/users/3135566/dpdragnev"}, "edited": false, "score": 0, "creation_date": 1462996926, "post_id": 37171992, "comment_id": 61879148, "body": "It has been a while since I did a VBA project, but if I remember correctly, you could access a sheet without selecting it. For example: Sheets(&quot;PO&quot; &amp; x ).Range(.Cells(1,1), .Cells(2,1)).Value = some value"}, {"owner": {"reputation": 156, "user_id": 6219524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be82ab7ad90aa19b4df8add5fcc2d244?s=128&d=identicon&r=PG&f=1", "display_name": "csanjose", "link": "https://stackoverflow.com/users/6219524/csanjose"}, "edited": false, "score": 0, "creation_date": 1462997460, "post_id": 37171992, "comment_id": 61879406, "body": "Wee need also H column"}, {"owner": {"reputation": 501, "user_id": 1618085, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/899a85006f2c9b0502ac0fa9faeeada5?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/1618085/james"}, "edited": false, "score": 0, "creation_date": 1462997472, "post_id": 37171992, "comment_id": 61879412, "body": "okay, I also moved &quot;Application.CutCopyMode = False&quot; to under &quot;Sheets(1).Select&quot; right above Wend and now I get the first three sheets updated but then no more after. I will edit my questions to reflect new changes and image"}, {"owner": {"reputation": 1699, "user_id": 3135566, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1c02713d9ee49574017166f791acb41c?s=128&d=identicon&r=PG&f=1", "display_name": "dpdragnev", "link": "https://stackoverflow.com/users/3135566/dpdragnev"}, "edited": false, "score": 0, "creation_date": 1462997968, "post_id": 37171992, "comment_id": 61879678, "body": "Did you try my suggestion to write directly to the target sheet without selecting it?  This might be the easiest and most reliable solution."}, {"owner": {"reputation": 501, "user_id": 1618085, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/899a85006f2c9b0502ac0fa9faeeada5?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/1618085/james"}, "edited": false, "score": 0, "creation_date": 1462998186, "post_id": 37171992, "comment_id": 61879790, "body": "I am working on that now. Trying to find the best way to implement it based on a paste method since that is what this script is doing. I am not an expert so having to think my way through it slowly."}, {"owner": {"reputation": 156, "user_id": 6219524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be82ab7ad90aa19b4df8add5fcc2d244?s=128&d=identicon&r=PG&f=1", "display_name": "csanjose", "link": "https://stackoverflow.com/users/6219524/csanjose"}, "edited": false, "score": 0, "creation_date": 1462998369, "post_id": 37171992, "comment_id": 61879886, "body": "Whats the criteria for arranging these rows in PO sheets? perhaps i can find another solution"}, {"owner": {"reputation": 501, "user_id": 1618085, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/899a85006f2c9b0502ac0fa9faeeada5?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/1618085/james"}, "reply_to_user": {"reputation": 156, "user_id": 6219524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be82ab7ad90aa19b4df8add5fcc2d244?s=128&d=identicon&r=PG&f=1", "display_name": "csanjose", "link": "https://stackoverflow.com/users/6219524/csanjose"}, "edited": false, "score": 0, "creation_date": 1462998725, "post_id": 37171992, "comment_id": 61880098, "body": "@csanjose, I just simple need to separate each PO from each other so I can run further scripts within their sheets and then save them as individual text files for a software program that only accepts text files."}, {"owner": {"reputation": 501, "user_id": 1618085, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/899a85006f2c9b0502ac0fa9faeeada5?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/1618085/james"}, "edited": false, "score": 0, "creation_date": 1462998892, "post_id": 37171992, "comment_id": 61880195, "body": "One more thing. The numbers at the end created by Excel&#39;s ranking formula so I can have a consistent identifier because the POs are always changing and I cannot rely on them to run this particular script in my question. So I came up with using the Rank, and this script will create based on this ranking number. When I do this separately it works fine. But I am trying to reduce the size of the file and make it easy to increase the number if needed by using a loop."}, {"owner": {"reputation": 501, "user_id": 1618085, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/899a85006f2c9b0502ac0fa9faeeada5?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/1618085/james"}, "edited": false, "score": 0, "creation_date": 1462999134, "post_id": 37171992, "comment_id": 61880317, "body": "PO is a Purchase Order number"}], "tags": [], "owner": {"reputation": 1699, "user_id": 3135566, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1c02713d9ee49574017166f791acb41c?s=128&d=identicon&r=PG&f=1", "display_name": "dpdragnev", "link": "https://stackoverflow.com/users/3135566/dpdragnev"}, "is_accepted": false, "score": 1, "last_activity_date": 1462996019, "creation_date": 1462996019, "answer_id": 37171992, "question_id": 37171759, "link": "https://stackoverflow.com/questions/37171759/while-is-broken-after-the-first-run-through-in-excel-vba-macro/37171992#37171992", "title": "&quot;WHILE&quot; is broken after the first run through in Excel VBA Macro", "body": "<p>Could it be because originally you select Sheet(1) but later inside your While loop you are using sheets(\"PO\" &amp; x).Select?  The focus will switch to the new sheet and the data you are looking for in your while loop condition may not be there.</p>\n\n<p>Without seeing your actual file this is just a guess. </p>\n"}, {"comments": [{"owner": {"reputation": 501, "user_id": 1618085, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/899a85006f2c9b0502ac0fa9faeeada5?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/1618085/james"}, "edited": false, "score": 0, "creation_date": 1463000299, "post_id": 37172880, "comment_id": 61880911, "body": "I did use it and it is not finding the data ... I see that you edited it. So I will recopy and see what happens. Thanks a lot for this. I see what you are doing and like it. EDIT - it says it cannot find target sheet which is your msg box based on false."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 501, "user_id": 1618085, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/899a85006f2c9b0502ac0fa9faeeada5?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/1618085/james"}, "edited": false, "score": 1, "creation_date": 1463001248, "post_id": 37172880, "comment_id": 61881406, "body": "Well, then it&#39;s probably good that I implemented this check. Now you know what the problem is. There is a sheet missing you were trying to use in your past code without verifying first if that sheet actually exists. A common problem here might be that the sheet name is not <code>PO40</code> but <code>P040</code> (written with two zeros or two capital o) or <code>PO40 </code> (with a leading or trailing space you cannot see). Check your sheet names where the message box pops-up."}, {"owner": {"reputation": 501, "user_id": 1618085, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/899a85006f2c9b0502ac0fa9faeeada5?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/1618085/james"}, "edited": false, "score": 0, "creation_date": 1463057094, "post_id": 37172880, "comment_id": 61907240, "body": "I checked all O&#39;s and they are the letter and not the number. And the sheets do exist and this script is not finding them. I have gone back to my original script and now have it where the While does work until it does not find the value in Column H and then it breaks. This works without my FOR but when I wrap the FOR around it that is when it no longer ignores missing values. There will be missing values and I just want it to skip and move to the next one until it finds the others that do exist."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 501, "user_id": 1618085, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/899a85006f2c9b0502ac0fa9faeeada5?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/1618085/james"}, "edited": false, "score": 0, "creation_date": 1463057322, "post_id": 37172880, "comment_id": 61907433, "body": "@James: we have already helped you resolve some bugs / errors and furthermore helped you improve / refine your code in so many ways. If you have a new question with new issues then please feel free to post a new question. Yet, I do not think that your current question still pertains to the original problem and should therefore be continued on this post."}, {"owner": {"reputation": 501, "user_id": 1618085, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/899a85006f2c9b0502ac0fa9faeeada5?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/1618085/james"}, "edited": false, "score": 0, "creation_date": 1463057629, "post_id": 37172880, "comment_id": 61907693, "body": "I am VERY appreciative of your time and help. But your code did not work and you even said it might not: &quot;The above code has not been tested. I merely wrote it from the top of my head and might include flaws which require some tweaking. In this case, feel free to ask me about it.&quot; So I am resorting back to my original code with dpdragnev suggestion which has gotten me closer. I just need to find why WHILE breaks with FOR wrapped around it. That is all. Thanks for you time and I may ask that as a new question per suggestion."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 501, "user_id": 1618085, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/899a85006f2c9b0502ac0fa9faeeada5?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/1618085/james"}, "edited": false, "score": 0, "creation_date": 1463059078, "post_id": 37172880, "comment_id": 61908862, "body": "You are correct: I did write this and you may very well send me the file by email and I will have a look at it (when I have time). At the same time, I believe that posting your improved code as a new question is also a good idea as you will get more exposure and (potentially) more experts having a look at your code block."}, {"owner": {"reputation": 501, "user_id": 1618085, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/899a85006f2c9b0502ac0fa9faeeada5?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/1618085/james"}, "edited": false, "score": 0, "creation_date": 1463060781, "post_id": 37172880, "comment_id": 61910280, "body": "Thanks, @Ralph! I appreciate it. I will be using your ideas and improvements to the code and will post accordingly. So trust me, I have learned something from your posting. Thanks again!"}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 2, "last_activity_date": 1462999729, "last_edit_date": 1462999729, "creation_date": 1462999299, "answer_id": 37172880, "question_id": 37171759, "link": "https://stackoverflow.com/questions/37171759/while-is-broken-after-the-first-run-through-in-excel-vba-macro/37172880#37172880", "title": "&quot;WHILE&quot; is broken after the first run through in Excel VBA Macro", "body": "<p>I am not really following your \"discussion\" and certainly do not wish to intervene. Yet, I felt the urge to propose a few changes which might help with your problem:</p>\n\n<pre><code>Public Sub tmpSO()\n\nDim LSearchRow As Long, LCopyToRow As Long\nDim shtSource As Worksheet, shtTarget As Worksheet\nDim bolFound As Boolean\n\nSet shtSource = ThisWorkbook.Worksheets(\"Sheet1\") 'Name of the source sheet\n\n'set the sequence variable\nFor x = 1 To 50\n    'Verify the existence of a sheet before processing it...\n    bolFound = False\n    For Each shtTarget In ThisWorkbook.Worksheets\n        If shtTarget.Name = \"PO\" &amp; x Then\n            bolFound = True\n            Exit For\n        End If\n    Next shtTarget\n    If bolFound = False Then\n        MsgBox \"Couldn't find target sheet PO\" &amp; x &amp; Chr(10) &amp; \"Skipping... moving on to next sheet.\"\n        GoTo NextSheet\n    End If\n\n    'Start search in row 1\n    LSearchRow = 2\n\n    'Start copying data to row 2 in PO40 (row counter variable)\n    LCopyToRow = 2\n\n    'run the copy script for each PO\n    While Len(shtSource.Cells(LSearchRow, \"C\").Value) &gt; 0\n\n        'If value in column H = \"sequence match\", copy entire row to its particular sheet\n        If shtSource.Cells(LSearchRow, \"H\").Value = x Then\n\n            'Select row in Sheet1 to copy\n            shtSource.Rows(CStr(LSearchRow) &amp; \":\" &amp; CStr(LSearchRow)).Copy\n\n            'Paste row into its particular sheet in next row\n            shtTarget.Rows(CStr(LCopyToRow) &amp; \":\" &amp; CStr(LCopyToRow)).Paste\n\n            Application.CutCopyMode = False\n            'Move counter to next row\n            LCopyToRow = LCopyToRow + 1\n\n        End If\n\n        LSearchRow = LSearchRow + 1\n\n    Wend\n\n    shtTarget.Cells.EntireColumn.AutoFit\nNextSheet:\n\nNext x\n\nEnd Sub\n</code></pre>\n\n<p>Notes:</p>\n\n<ol>\n<li>As suggested by @dpdragnev there is no more selecting in the above code.</li>\n<li>Explicit coding means that you do not just use <code>ActiveSheet</code> or <code>Range</code> without stating which sheet you are referring to.</li>\n<li>There were a few cumbersome uses of <code>Range(\"H\" &amp; CStr(LSearchRow))</code> which I changed to <code>Cells(LSearchRow, \"H\")</code>. I believe this to be more legible and I know <code>Cells</code> to be faster than <code>Range</code>.</li>\n<li>The <code>Dim</code> was moved outside the x-loop. There is no need to <code>Dim</code> something 50 times.</li>\n<li>When using <code>Dim</code> with multiple variables then you need to repeat the variable type <strong>for each</strong> variable. So, instead of <code>Dim LSearchRow, LCopyToRow As Integer</code> you need to write <code>Dim LSearchRow as Integer, LCopyToRow As Integer</code>.</li>\n<li>I guess that <code>Integer</code> is just fine for now. But eventually (when dealing with Excel rows) you might be going beyond 32,000 (and something) rows. So, it is probably better to go with <code>Long</code>.</li>\n<li>There is now a small \"extra\" at the beginning of the x-loop verifying the existence of a sheet before processing it (just for good measures).</li>\n</ol>\n\n<p>Other than that. I couldn't find anything for now. Of course, there are more things which could be improved. Yet, I didn't want to change your code too much around. You two have put a lot of hard work into that.</p>\n\n<p><sub>The above code has <strong>not</strong> been tested. I merely wrote it from the top of my head and might include flaws which require some tweaking. In this case, feel free to ask me about it.</sub></p>\n"}, {"tags": [], "owner": {"reputation": 501, "user_id": 1618085, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/899a85006f2c9b0502ac0fa9faeeada5?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/1618085/james"}, "is_accepted": false, "score": 0, "last_activity_date": 1463078345, "last_edit_date": 1463078345, "creation_date": 1463069388, "answer_id": 37192252, "question_id": 37171759, "link": "https://stackoverflow.com/questions/37171759/while-is-broken-after-the-first-run-through-in-excel-vba-macro/37192252#37192252", "title": "&quot;WHILE&quot; is broken after the first run through in Excel VBA Macro", "body": "<p>Got it to work by altering @Ralph's code. I couldn't get the pasting down as written but adjusted it from old code and it works like a charm. Working Code is successful as follows ...</p>\n\n<pre><code>Dim LSearchRow As Long, LCopyToRow As Long\nDim shtSource As Worksheet\n\nSet shtSource = sheets(1) 'source sheet\n\n'set the sequence variable\nFor x = 1 To 50\n\n    'Start search in row 1\n    LSearchRow = 2\n\n    'Start copying data to row 2 in PO40 (row counter variable)\n    LCopyToRow = 2\n\n    'run the copy script for each PO\n    While Len(shtSource.Cells(LSearchRow, \"C\").Value) &gt; 0\n\n        'If value in column H = \"sequence match\", copy entire row to its particular sheet\n        If shtSource.Cells(LSearchRow, \"H\").Value = x Then\n\n            'Select row in first sheet to copy\n            shtSource.Rows(CStr(LSearchRow) &amp; \":\" &amp; CStr(LSearchRow)).Copy\n\n            'Paste row into its particular sheet in next row\n            sheets(\"PO\" &amp; x).Select\n            Rows(CStr(LCopyToRow) &amp; \":\" &amp; CStr(LCopyToRow)).Select\n            ActiveSheet.Paste\n\n            Application.CutCopyMode = False\n            'Move counter to next row\n            LCopyToRow = LCopyToRow + 1\n\n        End If\n\n        LSearchRow = LSearchRow + 1\n\n    Wend\n        Cells.Select\n        Cells.EntireColumn.AutoFit\n\nNext x\n</code></pre>\n\n<p>Thanks to @Ralph, @dpdragnev and @csanjose who posted here!</p>\n"}], "owner": {"reputation": 501, "user_id": 1618085, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/899a85006f2c9b0502ac0fa9faeeada5?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/1618085/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1463078345, "creation_date": 1462995124, "last_edit_date": 1531161705, "question_id": 37171759, "link": "https://stackoverflow.com/questions/37171759/while-is-broken-after-the-first-run-through-in-excel-vba-macro", "title": "&quot;WHILE&quot; is broken after the first run through in Excel VBA Macro", "body": "<p>I am trying to run an IF within a WHILE within a FOR. The FOR and the IF is working like it supposed to. But after the first successful run through the WHILE and it comes back from the FOR the WHILE only goes through once and does not look into the rest of the rows. Here is the code:</p>\n\n<pre><code>'COPY EACH PO TO ITS OWN SHEET ............................................\n\n   'set the sequence variable\n    For x = 1 To 50\n\n    Dim LSearchRow, LCopyToRow As Integer\n\n   'Start search in row 1\n    LSearchRow = 2\n\n   'Start copying data to row 2 in PO40 (row counter variable)\n    LCopyToRow = 2\n\n   'run the copy script for each PO\n    While Len(Range(\"C\" &amp; CStr(LSearchRow)).Value) &gt; 0\n\n      'If value in column H = \"sequence match\", copy entire row to its particular sheet\n       If Range(\"H\" &amp; CStr(LSearchRow)).Value = x Then\n\n        'Select row in Sheet1 to copy\n         Rows(CStr(LSearchRow) &amp; \":\" &amp; CStr(LSearchRow)).Select\n         Selection.Copy\n\n        'Paste row into its particular sheet in next row\n         sheets(\"PO\" &amp; x).Select\n         Rows(CStr(LCopyToRow) &amp; \":\" &amp; CStr(LCopyToRow)).Select\n         ActiveSheet.Paste\n\n         'Move counter to next row\n         LCopyToRow = LCopyToRow + 1\n\n      End If\n\n      LSearchRow = LSearchRow + 1\n\n      sheets(1).Select\n      Application.CutCopyMode = False\n\n   Wend\n\n      sheets(\"PO\" &amp; x).Select\n        Cells.Select\n        Cells.EntireColumn.AutoFit\n\n   Next x\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/5lFY8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5lFY8.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "percentage"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462992765, "post_id": 37171049, "comment_id": 61876832, "body": "Please put both the data and the code directly in the original post not pictures.  Put them in highlight the text and hit ctrl-k"}, {"owner": {"reputation": 7455, "user_id": 5432501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8MGE3.png?s=128&g=1", "display_name": "Alex Knauth", "link": "https://stackoverflow.com/users/5432501/alex-knauth"}, "edited": false, "score": 0, "creation_date": 1463002040, "post_id": 37171049, "comment_id": 61881796, "body": "Why did you delete your code after getting an answer?"}, {"owner": {"reputation": 1, "user_id": 6322047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ddf7c0af7f0caa0495c2fafe8adaed9?s=128&d=identicon&r=PG&f=1", "display_name": "Anna1127", "link": "https://stackoverflow.com/users/6322047/anna1127"}, "edited": false, "score": 0, "creation_date": 1463002618, "post_id": 37171049, "comment_id": 61882049, "body": "I don&#39;t think I did? Sorry I&#39;m new to this"}, {"owner": {"reputation": 7455, "user_id": 5432501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8MGE3.png?s=128&g=1", "display_name": "Alex Knauth", "link": "https://stackoverflow.com/users/5432501/alex-knauth"}, "edited": false, "score": 0, "creation_date": 1463009689, "post_id": 37171049, "comment_id": 61884465, "body": "Your last edit, 3 hours ago, titled &quot;deleted 922 characters in body,&quot; deleted your code. This was after @ryguy7272&#39;s answer, which was posted 4 hours ago."}, {"owner": {"reputation": 1, "user_id": 6322047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ddf7c0af7f0caa0495c2fafe8adaed9?s=128&d=identicon&r=PG&f=1", "display_name": "Anna1127", "link": "https://stackoverflow.com/users/6322047/anna1127"}, "edited": false, "score": 0, "creation_date": 1463057411, "post_id": 37171049, "comment_id": 61907500, "body": "Yes, because I couldn&#39;t get the code to show up and make sense"}, {"owner": {"reputation": 7455, "user_id": 5432501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8MGE3.png?s=128&g=1", "display_name": "Alex Knauth", "link": "https://stackoverflow.com/users/5432501/alex-knauth"}, "edited": false, "score": 0, "creation_date": 1463058333, "post_id": 37171049, "comment_id": 61908256, "body": "If you go to the help center and seach &quot;formatting code,&quot; then the <a href=\"https://stackoverflow.com/help/formatting\">first thing that comes up</a> says that to format blocks of code, you can indent it four spaces. So you should revert that edit and indent the code four spaces."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6322047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ddf7c0af7f0caa0495c2fafe8adaed9?s=128&d=identicon&r=PG&f=1", "display_name": "Anna1127", "link": "https://stackoverflow.com/users/6322047/anna1127"}, "edited": false, "score": 0, "creation_date": 1462998308, "post_id": 37171481, "comment_id": 61879863, "body": "I need it to be in a code so that anyone can use it and sort it"}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1462994137, "creation_date": 1462994137, "answer_id": 37171481, "question_id": 37171049, "link": "https://stackoverflow.com/questions/37171049/finding-percentage-of-value-compared-to-total-in-macros-excel-code/37171481#37171481", "title": "Finding percentage of value compared to total in macros excel code", "body": "<p>Can't you just use a Pivot table for this kind of thing?  Or, use the Sumproduct function.  Here is a good lik that shows several examples of how to use Sumproduct.</p>\n\n<p><a href=\"http://www.xldynamic.com/source/xld.SUMPRODUCT.html\" rel=\"nofollow\">http://www.xldynamic.com/source/xld.SUMPRODUCT.html</a></p>\n\n<p>If you need all of this in VBA, simply record a Macro when you are going through the steps.</p>\n"}], "owner": {"reputation": 1, "user_id": 6322047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ddf7c0af7f0caa0495c2fafe8adaed9?s=128&d=identicon&r=PG&f=1", "display_name": "Anna1127", "link": "https://stackoverflow.com/users/6322047/anna1127"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1463059672, "creation_date": 1462992629, "last_edit_date": 1463059672, "question_id": 37171049, "link": "https://stackoverflow.com/questions/37171049/finding-percentage-of-value-compared-to-total-in-macros-excel-code", "title": "Finding percentage of value compared to total in macros excel code", "body": "<p>I'm writing a program to organize people's hours by percentage of their work in other projects.  Here is a link to my excel document <a href=\"http://i.stack.imgur.com/T9QLe.png\" rel=\"nofollow\">Excel Document</a> and my work so far <a href=\"http://i.stack.imgur.com/HElJs.png\" rel=\"nofollow\">Macros work</a>.  Basically, I have coded enough to calculate the total hours used by a person, but I need to calculate the hours done for each project number by each person.  I eventually need a graph comparing the percentage of work each person spent on the different project numbers they worked on.  I'm having trouble distinguishing hours done by each project though.  Anything helps! </p>\n"}, {"tags": ["vba", "conditional", "array-formulas", "percentile"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 5351061, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad8ae4a4d9f442ce979d90957f9767a2?s=128&d=identicon&r=PG&f=1", "display_name": "sevans", "link": "https://stackoverflow.com/users/5351061/sevans"}, "edited": false, "score": 0, "creation_date": 1462993149, "post_id": 37171048, "comment_id": 61877068, "body": "Thanks for the response. I&#39;m still getting a type mismatch on the variables. Maybe I have to declare the range variables differently since it is in a formula array?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 39, "user_id": 5351061, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad8ae4a4d9f442ce979d90957f9767a2?s=128&d=identicon&r=PG&f=1", "display_name": "sevans", "link": "https://stackoverflow.com/users/5351061/sevans"}, "edited": false, "score": 0, "creation_date": 1462993394, "post_id": 37171048, "comment_id": 61877207, "body": "@sevans see edit, I forgot that we need to use the address not the range variable itself."}, {"owner": {"reputation": 39, "user_id": 5351061, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad8ae4a4d9f442ce979d90957f9767a2?s=128&d=identicon&r=PG&f=1", "display_name": "sevans", "link": "https://stackoverflow.com/users/5351061/sevans"}, "edited": false, "score": 0, "creation_date": 1462993500, "post_id": 37171048, "comment_id": 61877263, "body": "Thanks very much for the help; you put an end to over an hour of google searches."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1462993364, "last_edit_date": 1462993364, "creation_date": 1462992626, "answer_id": 37171048, "question_id": 37171006, "link": "https://stackoverflow.com/questions/37171006/creating-a-percentile-if-function-in-vba-with-variables/37171048#37171048", "title": "Creating a percentile if function in VBA with variables", "body": "<p>You need to move the variable outside the quotes:</p>\n\n<pre><code>dim lastyear as integer\ndim yearcol as range\ndim valuescol as range\n\nlastyear = 2015\nSet valuescol = range(cells(1,1),cells(5,1))\nSet yearcol = range(cells(1,2),cells(5,2))\n\nCells(1, 10).FormulaArray = \"=PERCENTILE.EXC(IF(\" &amp; yearcol.address(0,0) &amp; \" = \" &amp; lastyear &amp; \", \" &amp; valuescol.address(0,0) &amp; \",0.9)\"\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 5351061, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad8ae4a4d9f442ce979d90957f9767a2?s=128&d=identicon&r=PG&f=1", "display_name": "sevans", "link": "https://stackoverflow.com/users/5351061/sevans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 970, "favorite_count": 0, "accepted_answer_id": 37171048, "answer_count": 1, "score": 1, "last_activity_date": 1462993364, "creation_date": 1462992465, "question_id": 37171006, "link": "https://stackoverflow.com/questions/37171006/creating-a-percentile-if-function-in-vba-with-variables", "title": "Creating a percentile if function in VBA with variables", "body": "<p>I'm currently stuck trying to create a function that calculates a percentile with data that meets a criteria. My data is much longer but is in this form:</p>\n\n<pre><code>A          B\n462        2015\n675        2015\n494        2014\n802        2015\n380        2014\n</code></pre>\n\n<p>So in this case, the percentile array is column A and the criteria range is column B. The statement below is calculating the 90th percentile of values in column A that correspond to 2015 in column B. The only way I can get this to work is to have VBA evaluate a statement in quotes using the .formulaArray property. Using the 5 row example above (I think you need more than 5 rows to calculate a percentile):</p>\n\n<pre><code>Cells(1, 10).FormulaArray = \"=PERCENTILE.EXC(IF(A2:A5 = 2015,B2:B5),0.9)\"\n</code></pre>\n\n<p>This works, except for when I substitute the ranges/ values in the function for variables. This does not work:</p>\n\n<pre><code>dim lastyear as integer\ndim yearcol as range\ndim valuescol as range\n\nlastyear = 2015\nvaluescol = range(cells(1,1),cells(5,1))\nyearcol = range(cells(1,2),cells(5,2)\n\nCells(1, 10).FormulaArray = \"=PERCENTILE.EXC(IF(yearcol = lastyear, valuescol,0.9)\"\n</code></pre>\n\n<p>If anyone has any suggestions, I would really appreciate it.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1462992017, "post_id": 37170731, "comment_id": 61876389, "body": "what are all these &#39;&gt;&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 5802694, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-TBuEk4U_RgY/AAAAAAAAAAI/AAAAAAAAAdo/P61a2vroLRA/photo.jpg?sz=128", "display_name": "Laura X", "link": "https://stackoverflow.com/users/5802694/laura-x"}, "edited": false, "score": 0, "creation_date": 1462992187, "post_id": 37170843, "comment_id": 61876498, "body": "just checked , there &quot;Opeton explicit &quot; on the top . why can I not find the declaration. ?"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "reply_to_user": {"reputation": 39, "user_id": 5802694, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-TBuEk4U_RgY/AAAAAAAAAAI/AAAAAAAAAdo/P61a2vroLRA/photo.jpg?sz=128", "display_name": "Laura X", "link": "https://stackoverflow.com/users/5802694/laura-x"}, "edited": false, "score": 0, "creation_date": 1462993679, "post_id": 37170843, "comment_id": 61877350, "body": "@Lauraxu I edited my answer to add another posibility"}, {"owner": {"reputation": 39, "user_id": 5802694, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-TBuEk4U_RgY/AAAAAAAAAAI/AAAAAAAAAdo/P61a2vroLRA/photo.jpg?sz=128", "display_name": "Laura X", "link": "https://stackoverflow.com/users/5802694/laura-x"}, "edited": false, "score": 0, "creation_date": 1463083943, "post_id": 37170843, "comment_id": 61925586, "body": "Hi, Litelite, I tried the second method . it shows &quot;Identifier under cursor is not recognized&quot; . But the above code just run well with any bugs. Other possibilities ?"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "reply_to_user": {"reputation": 39, "user_id": 5802694, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-TBuEk4U_RgY/AAAAAAAAAAI/AAAAAAAAAdo/P61a2vroLRA/photo.jpg?sz=128", "display_name": "Laura X", "link": "https://stackoverflow.com/users/5802694/laura-x"}, "edited": false, "score": 0, "creation_date": 1463084179, "post_id": 37170843, "comment_id": 61925712, "body": "@Lauraxu are you certain that <code>Option explicit</code> is present and not commented?"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "reply_to_user": {"reputation": 39, "user_id": 5802694, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-TBuEk4U_RgY/AAAAAAAAAAI/AAAAAAAAAdo/P61a2vroLRA/photo.jpg?sz=128", "display_name": "Laura X", "link": "https://stackoverflow.com/users/5802694/laura-x"}, "edited": false, "score": 0, "creation_date": 1463602637, "post_id": 37170843, "comment_id": 62139741, "body": "If <code>option explicit</code> is present in the file and NOT commented, then I have strictly no idea how your code is working sorry..."}], "tags": [], "owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "is_accepted": false, "score": 0, "last_activity_date": 1462992408, "last_edit_date": 1462992408, "creation_date": 1462991917, "answer_id": 37170843, "question_id": 37170731, "link": "https://stackoverflow.com/questions/37170731/vba-in-access-how-flag-and-err05-got-declared/37170843#37170843", "title": "VBA in ACCESS how &quot;Flag&quot; and &quot;Err05&quot; got declared ?", "body": "<p>Two posibilities</p>\n\n<ol>\n<li><p>Unless the file have <code>Option explicit</code> in the top, you are not forced to explicitely declare variables. Which means that <code>Flag</code> and <code>Err05</code> have indeed never been declared. VBA will just create them on the fly with a <code>Variant</code> type and an initial value of <code>Nothing</code>.</p></li>\n<li><p>They might be global variables declared outside of any sub in another file. Try right clicking the variable and then click <em>definition</em> in the menu, Access will show you the way.</p></li>\n</ol>\n"}], "owner": {"reputation": 39, "user_id": 5802694, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-TBuEk4U_RgY/AAAAAAAAAAI/AAAAAAAAAdo/P61a2vroLRA/photo.jpg?sz=128", "display_name": "Laura X", "link": "https://stackoverflow.com/users/5802694/laura-x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593958660, "creation_date": 1462991565, "last_edit_date": 1593958660, "question_id": 37170731, "link": "https://stackoverflow.com/questions/37170731/vba-in-access-how-flag-and-err05-got-declared", "title": "VBA in ACCESS how &quot;Flag&quot; and &quot;Err05&quot; got declared ?", "body": "<p>I do not understand where \"Flag and Err05\" (at the bottom of the codes)have been declared ? I have searched the entire project and can not found where the two parameters got declared.  When I try to use the below codes in another project , i got the error message \"Run time error : items not found in this collection \"  Any answers?</p>\n\n<pre><code>&gt;Private Sub SanityCheck_Click()\n&gt;Dim St As String, WrnFlag As Boolean, j As Integer\n&gt;Dim RS As Recordset, RS1 As Recordset, i As Integer, WrongRootCauses As String\n&gt;Dim Err01 As String, Err02 As String, Err03 As String, Err04 As String\n&gt;WrnFlag = False\n&gt;If IsNull(Me.FactoryList) Then\n &gt;   MsgBox \"Select valid Factory before proceeding.\", vbExclamation\n&gt;Else\n\n&gt;    St = \"SELECT Factory, Step1, Step2, Step3, Step4, DateColumn FROM [tbl &gt;Factory] WHERE Allowed = True and Factory = \"\"\" &amp; Me.FactoryList.Value &amp; \"\"\"\"\n &gt;   Set RS = CurrentDb.OpenRecordset(St, dbOpenSnapshot)\n\n'-- 12NC codes check --\n   &gt; St = \"SELECT Count([\" &amp; RS!Step2 &amp; \"].PLANT) AS 12NC_chk \" &amp; _\n    &gt;\"FROM [\" &amp; RS!Step2 &amp; \"] \" &amp; _\n   &gt; \"WHERE (((Len(Trim(IIf(Left(Trim([12NC_CODE]),3)=\"\"000\"\",Right&gt;([12NC_CODE],Len([12NC_CODE])-3),[12NC_CODE])))) Not In (0,1,12)));\"\n'    \"WHERE (((Len(Trim([12NC_CODE]))) Not In (0,1,12)));\"\n\n   &gt; Set RS1 = CurrentDb.OpenRecordset(St, dbOpenSnapshot)\n    &gt;If RS1.BOF And RS1.EOF Then\n     &gt;   Err05 = \"+ No 12NC issues found.\"\n    &gt;Else\n   &gt;     RS1.MoveFirst\n    &gt;    RS1.MoveLast\n     &gt;   If RS1![12NC_chk] = 0 Then\n      &gt;      Err05 = \"+ No 12NC issues found.\"\n       &gt; Else\n        &gt;    Err05 = \"- \" &amp; RS1![12NC_chk] &amp; \" Incorrect 12NCs found!\"\n         &gt;   WrnFlag = True\n       &gt; End If\n   &gt; End If\n'--\n\n   &gt; If WrnFlag = True Then **Flag** = vbCritical Else **Flag** = vbInformation\n   &gt; MsgBox RS!Factory &amp; \" input data sanity check:\" &amp; vbCrLf &amp; vbCrLf &amp; \"  \" &amp; &gt;Err01 &amp; vbCrLf &amp; \"  \" &amp; Err02 &amp; vbCrLf &amp; \"  \" &amp; Err03 &amp; _\n &gt;       vbCrLf &amp; \"  \" &amp; Err04 &amp; vbCrLf &amp; \"  \" &amp; Err05 &amp; vbCrLf &amp; vbCrLf &amp; IIf&gt;&gt;(WrongRootCauses = \"\", \"\", \"  Unknown ADP Root Cause(s):\" &amp; vbCrLf &amp; WrongRootCauses), Flag\n\n   &gt; RS.Close\n    &gt;RS1.Close\n&gt;End If\n&gt;End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1462991666, "post_id": 37170515, "comment_id": 61876208, "body": "I&#39;m not 100% positive on this one, but perhaps stick a final <code>&amp; &quot;\\&quot;</code> on the end of those last two <code>oFSO.movefile</code> calls."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1462996100, "post_id": 37170515, "comment_id": 61878660, "body": "Each <code>If</code> block has <code>NewFolder = LoanID</code>, but shouldn&#39;t the 2nd and 3rd instance use something like <code>Sponsor</code> and <code>Sponsor2</code> ?"}, {"owner": {"reputation": 1, "user_id": 6321699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bee61d63793b8e9c5b82d7aec887226b?s=128&d=identicon&r=PG&f=1", "display_name": "Deftek", "link": "https://stackoverflow.com/users/6321699/deftek"}, "edited": false, "score": 0, "creation_date": 1462998895, "post_id": 37170515, "comment_id": 61880197, "body": "Thank you, I did add the final &amp; &quot;\\&quot; on the other two. this was necessary but not what was causing my error. I removed the redundant code reassigning newfolder to loanid since it only needs to be assigned at the top. I do want it to populate the sponsor and sponsor2 folders within the loanID folder."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6321699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bee61d63793b8e9c5b82d7aec887226b?s=128&d=identicon&r=PG&f=1", "display_name": "Deftek", "link": "https://stackoverflow.com/users/6321699/deftek"}, "edited": false, "score": 0, "creation_date": 1462999051, "post_id": 37171377, "comment_id": 61880264, "body": "good catch! I had missed this bug. Strangely it seems that my problem lies in the third if statement. When that field is blank (or even contains a 0) then the if statement for some reason returns true and the code continues to go through it. When I change it to a word the if statement correctly returns false... very strange but it seems to be working now."}, {"owner": {"reputation": 7, "user_id": 6195284, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_hRmF43gpek/AAAAAAAAAAI/AAAAAAAAAAA/5Aei6VogISc/photo.jpg?sz=128", "display_name": "Eduardo Dani", "link": "https://stackoverflow.com/users/6195284/eduardo-dani"}, "reply_to_user": {"reputation": 1, "user_id": 6321699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bee61d63793b8e9c5b82d7aec887226b?s=128&d=identicon&r=PG&f=1", "display_name": "Deftek", "link": "https://stackoverflow.com/users/6321699/deftek"}, "edited": false, "score": 0, "creation_date": 1463010558, "post_id": 37171377, "comment_id": 61884717, "body": "According to the official specificiation, that is how the InStr function works. <a href=\"https://msdn.microsoft.com/en-us/library/8460tsh1(v=vs.90).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/8460tsh1(v=vs.90).aspx</a>  Could you post your code for future reference?"}], "tags": [], "owner": {"reputation": 7, "user_id": 6195284, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_hRmF43gpek/AAAAAAAAAAI/AAAAAAAAAAA/5Aei6VogISc/photo.jpg?sz=128", "display_name": "Eduardo Dani", "link": "https://stackoverflow.com/users/6195284/eduardo-dani"}, "is_accepted": false, "score": -1, "last_activity_date": 1463011383, "last_edit_date": 1463011383, "creation_date": 1462993745, "answer_id": 37171377, "question_id": 37170515, "link": "https://stackoverflow.com/questions/37170515/file-already-exists/37171377#37171377", "title": "File already exists", "body": "<p>Is it possible that columns Sponsor (2) and Sponsor2 (3) have the same information? If so, the folder created under the SourceFolder\\NewFolder will have the same name.</p>\n\n<p>Also, I don't know why you're testing those columns with the file's name, but at line 42 you're testing with 'Sponsor' again.</p>\n\n<pre><code>If InStr(UCase(TestString), UCase(Sponsor)) &gt; 0 Then\n</code></pre>\n\n<p>Depending on your data, it might be the source of the problem.</p>\n"}], "owner": {"reputation": 1, "user_id": 6321699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bee61d63793b8e9c5b82d7aec887226b?s=128&d=identicon&r=PG&f=1", "display_name": "Deftek", "link": "https://stackoverflow.com/users/6321699/deftek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 408, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463011383, "creation_date": 1462990847, "last_edit_date": 1531164843, "question_id": 37170515, "link": "https://stackoverflow.com/questions/37170515/file-already-exists", "title": "File already exists", "body": "<p>I've created a macro that distributes a group of files into various subfolders. However, I'm getting a \"file already exists\" error when trying to move the file. It occurs on the 2nd and 3rd oFSO.movefile statements. Any Ideas? I tried adding a \"\\\" to the end of the filename but then it gives me a type mismatch error?</p>\n\n<p>PS. please bear with me, I don't have any formal training in VBA.</p>\n\n<p>thanks!</p>\n\n<pre><code>Sub DistributeDD()\nMsgBox (\"To use this Macro, Place all loan numbers you want to create     folders for in column A starting at A1 and the sponsor in column B or C\")\nSourceFolder = InputBox(\"Paste the Path where the files are located\")\nDim oFSO\nDim oFolder As Object\nDim oFile As Object\nDim NewFolder As String\nDim myRange As Range\nDim i As Long\nDim TestString As String\nLastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nDim subfolder As String\nDim Sponsor As String\nSet oFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet oFolder = oFSO.GetFolder(SourceFolder)\n\nFor i = 1 To LastRow\nLoanID = Cells(i, 1).Value\nSponsor = Cells(i, 2).Value\nSponsor2 = Cells(i, 3).Value\n\nFor Each oFile In oFolder.Files\n        TestString = oFile.Name\n        'Populate Collateral File\n        If InStr(UCase(TestString), UCase(LoanID)) &gt; 0 Then\n            NewFolder = LoanID\n            subfolder = IdentifySubfolder(TestString)\n        createNewDirectory (SourceFolder &amp; \"\\\" &amp; NewFolder)\n        createNewDirectory (SourceFolder &amp; \"\\\" &amp; NewFolder &amp; \"\\\" &amp; subfolder)\n        oFSO.movefile Source:=oFile, Destination:=SourceFolder &amp; \"\\\" &amp; NewFolder &amp; \"\\\" &amp; subfolder &amp; \"\\\"\n        End If\n        'Populate Sponsor\n        If InStr(UCase(TestString), UCase(Sponsor)) &gt; 0 Then\n            NewFolder = LoanID\n            subfolder = IdentifySubfolder(TestString)\n        createNewDirectory (SourceFolder &amp; \"\\\" &amp; NewFolder)\n        createNewDirectory (SourceFolder &amp; \"\\\" &amp; NewFolder &amp; \"\\\" &amp; Sponsor)\n        oFSO.movefile Source:=oFile, Destination:=SourceFolder &amp; \"\\\" &amp; NewFolder &amp; \"\\\" &amp; Sponsor\n        MsgBox (TestString)\n        End If\n        'Populate Sponsor2\n        If InStr(UCase(TestString), UCase(Sponsor)) &gt; 0 Then\n            NewFolder = LoanID\n            subfolder = IdentifySubfolder(TestString)\n        createNewDirectory (SourceFolder &amp; \"\\\" &amp; NewFolder)\n        createNewDirectory (SourceFolder &amp; \"\\\" &amp; NewFolder &amp; \"\\\" &amp; Sponsor2)\n        createNewDirectory (SourceFolder &amp; \"\\\" &amp; NewFolder &amp; \"\\\" &amp; Sponsor2 &amp; \"\\\" &amp; subfolder)\n        oFSO.movefile Source:=oFile, Destination:=SourceFolder &amp; \"\\\" &amp; NewFolder &amp; \"\\\" &amp; Sponsor2\n        End If\n\nNext oFile\nNext i\n\nSet oFolder = Nothing\nSet oFSO = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "rowdeleting"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1462990219, "post_id": 37170095, "comment_id": 61875468, "body": "Try <code>ActiveSheet.Cells(i, 6).EntireRow.Delete</code>"}], "answers": [{"comments": [{"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1462990461, "post_id": 37170383, "comment_id": 61875590, "body": "You beat me to the bunch. I need to type more quickly!!"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1462990490, "post_id": 37170383, "comment_id": 61875610, "body": "@user3561813 you had a longer explanation ^_^"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1462990597, "post_id": 37170383, "comment_id": 61875682, "body": "@findwindow maybe I can change my username to <code>verbosity</code>!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 2, "creation_date": 1462990806, "post_id": 37170383, "comment_id": 61875801, "body": "@user3561813 - I don&#39;t see any issue with similar answers being posted within a short timeframe and fw is correct; you took the time to expand on &#39;best practise&#39; corrections like working bottom-to-top that I only corrected in code. The cream will rise to the top."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1462991197, "post_id": 37170383, "comment_id": 61875990, "body": "Ugh Batman, youtube blocked at work. But yeaaaaa, 3-3 now. Pay per view cage fight commencing. Please paypal tickets to my email kthxbye."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1462992504, "post_id": 37170383, "comment_id": 61876679, "body": "I just put him over! He&#39;s in the lead now!"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1462992553, "post_id": 37170383, "comment_id": 61876707, "body": "@user3561813 I am trying to sell tickets and you ruin it. tsk tsk. Removing my upvote from you =P"}, {"owner": {"reputation": 33, "user_id": 6321833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/961be3204a8bb5acfaccb6ebcd089570?s=128&d=identicon&r=PG&f=1", "display_name": "Tommy M", "link": "https://stackoverflow.com/users/6321833/tommy-m"}, "edited": false, "score": 1, "creation_date": 1462992913, "post_id": 37170383, "comment_id": 61876925, "body": "See it&#39;s conversations like this that make me love, not just use, this site. ;)  Thanks for the assist. I&#39;ll test and confirm it works."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 33, "user_id": 6321833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/961be3204a8bb5acfaccb6ebcd089570?s=128&d=identicon&r=PG&f=1", "display_name": "Tommy M", "link": "https://stackoverflow.com/users/6321833/tommy-m"}, "edited": false, "score": 1, "creation_date": 1462994054, "post_id": 37170383, "comment_id": 61877545, "body": "@TommyM Make sure you use your upvotes wisely! We need to make sure findwindow maximizes ticket sales"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 5, "last_activity_date": 1462990365, "creation_date": 1462990365, "answer_id": 37170383, "question_id": 37170095, "link": "https://stackoverflow.com/questions/37170095/deleting-rows-with-duplicate-info-in-columns/37170383#37170383", "title": "Deleting rows with duplicate info in columns", "body": "<p>Try it with,</p>\n\n<pre><code>For i = Range(\"f\" &amp; Rows.Count).End(xlUp).Row to 1 Step -1\n    If Cells(i, 5).Value = \"\" Then 'if column E is blank on row i\n        x = Cells(i, 6).Value\n        If Application.Countif(Columns(6), x) &gt; 1 Then '&amp; if that row is a duplicate\n            Rows(i).EntireRow.Delete 'delete new duplicate row\n        End If\n    End If\nNext i\n</code></pre>\n\n<p>You were trying to delete the row number <em>x</em>, not <em>i</em>. Additionally, everything was going to be matched once.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 6321833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/961be3204a8bb5acfaccb6ebcd089570?s=128&d=identicon&r=PG&f=1", "display_name": "Tommy M", "link": "https://stackoverflow.com/users/6321833/tommy-m"}, "edited": false, "score": 0, "creation_date": 1462993013, "post_id": 37170394, "comment_id": 61876989, "body": "Highly appreciate the added info/best practices details. I&#39;d upvote for that alone. &quot;Teach a man to fish...&quot;"}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 4, "last_activity_date": 1462990427, "creation_date": 1462990427, "answer_id": 37170394, "question_id": 37170095, "link": "https://stackoverflow.com/questions/37170095/deleting-rows-with-duplicate-info-in-columns/37170394#37170394", "title": "Deleting rows with duplicate info in columns", "body": "<p>So there are a couple of errors that need to be addressed in your code. First, if you are looping over a range and deleting rows, it's best to start from the bottom and work your way up. This prevents issues where your iterator is on a row, that row gets deleted, and the loop essentially skips the next row.</p>\n\n<p>Next, you are looking for a <code>Match</code> in column F of <code>x</code>, which contains a value from Column F. So, it will always return a value (itself, at the very minimum). Maybe try using a <code>COUNTIF</code> and seeing if it's greater than 1 may be a better option?</p>\n\n<p>Next, you populated the variable <code>x</code> with the value in <code>Cells(i, 6)</code>, but then you try to use it as a range when deleting. Change your code to the following and see if it works:</p>\n\n<pre><code>For i = Range(\"f\" &amp; Rows.Count).End(xlUp).Row To 1 Step -1\nIf Cells(i, 5).Value = \"\" Then 'if column E is blank on row i\nx = Cells(i, 6).Value\n    If Application.Countif(Columns(6), x) &gt; 1 Then '&amp; if that row is a duplicate\n    ActiveSheet.Rows(i).Delete 'delete new duplicate row\n    End If\nEnd If\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1463001071, "post_id": 37173073, "comment_id": 61881316, "body": "Column E has to be blank as well as values in column F being duplicated. While using column E and F for the duplicate criteria <b>might</b> work, it could lead to false positives."}], "tags": [], "owner": {"reputation": 3, "user_id": 6300645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6266ff4e72f3a46d4f4454e567f48ce1?s=128&d=identicon&r=PG&f=1", "display_name": "gualdhar", "link": "https://stackoverflow.com/users/6300645/gualdhar"}, "is_accepted": false, "score": 0, "last_activity_date": 1462999964, "creation_date": 1462999964, "answer_id": 37173073, "question_id": 37170095, "link": "https://stackoverflow.com/questions/37170095/deleting-rows-with-duplicate-info-in-columns/37173073#37173073", "title": "Deleting rows with duplicate info in columns", "body": "<p>Why not use the .RemoveDuplicates method? It's faster than looping around. Here's a rough outline on its use:</p>\n\n<pre><code>With Range\n    .RemoveDuplicates Columns:=Array(6), Header:=xlYes\nEnd With\n</code></pre>\n\n<p>Here's the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193823.aspx\" rel=\"nofollow\">msdn doc</a> for the method, and <a href=\"http://www.thespreadsheetguru.com/the-code-vault/2015/2/24/vba-code-remove-duplicate-cell-values-or-entire-rows\" rel=\"nofollow\">another page</a> with a more detailed implementation.  They should clear up any questions you might have.</p>\n"}], "owner": {"reputation": 33, "user_id": 6321833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/961be3204a8bb5acfaccb6ebcd089570?s=128&d=identicon&r=PG&f=1", "display_name": "Tommy M", "link": "https://stackoverflow.com/users/6321833/tommy-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 37170394, "answer_count": 3, "score": 3, "last_activity_date": 1462999964, "creation_date": 1462989479, "last_edit_date": 1462991336, "question_id": 37170095, "link": "https://stackoverflow.com/questions/37170095/deleting-rows-with-duplicate-info-in-columns", "title": "Deleting rows with duplicate info in columns", "body": "<p>I'm writing a code that copies data  from one sheet into another and I've got that function working fine. Now, I'm trying to code it to delete any rows that contain duplicate information based off that information's ID number in column F. Part of our process is to manually enter in column E when each row has been worked. </p>\n\n<p>So my end goal is for the code to delete rows where column E is blank and column F is a duplicate. My code runs, but doesn't delete anything. I'm really hoping I'm just missing something ridiculously obvious.</p>\n\n<pre><code>For i = 1 To Range(\"f\" &amp; Rows.Count).End(xlUp).Row\n    If Cells(i, 5).Value = \"\" Then 'if column E is blank on row i\n        x = Cells(i, 6).Value\n        If Not IsError(Application.Match(x, \"F:F\", 0)) Then '&amp; if that row is a duplicate\n            ActiveSheet.Range(x).EntireRow.Delete 'delete new duplicate row\n        End If\n    End If\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1462989268, "post_id": 37169895, "comment_id": 61874895, "body": "what is the error?  What is the condition that determine when the rows are to be coloured, or is it all rows?  Do you really mean the entire row (not advisable) or your entire row of data in which case what is the last column of your data to be coloured."}, {"owner": {"reputation": 65, "user_id": 6177416, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1785fcb7427d011623588c690fe922ac?s=128&d=identicon&r=PG&f=1", "display_name": "David Syriac", "link": "https://stackoverflow.com/users/6177416/david-syriac"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1462989709, "post_id": 37169895, "comment_id": 61875135, "body": "@ForwardEd  that&#39;s the main challenge while recording it takes rows (..) but it will vary for different works that&#39;s y I have tried putting active rows after filter"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1462990030, "post_id": 37169895, "comment_id": 61875344, "body": "Sorry missed the entire line with the autofilter in it.  you would think by 2 pm I would be awake!"}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1462989243, "last_edit_date": 1495541766, "creation_date": 1462989243, "answer_id": 37170022, "question_id": 37169895, "link": "https://stackoverflow.com/questions/37169895/colouring-the-entire-row/37170022#37170022", "title": "Colouring the entire row", "body": "<p><code>Rows.Activate.Select</code> is where your error is happening, as you can't do <code>.Activate.Select</code>.  Please read through <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using <code>.Select</code>/<code>.Activate</code></a>, and try the below:</p>\n\n<pre><code>Sub t()\n' What's this next line supposed to do?\n'ActiveSheet.Range(\"I1:I100\").AutoFilter Field:=1, Criteria1:=RGB(255, 255 _\n    , 0), Operator:=xlFilterCellColor\n\nWith Rows(\"1:100\").Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 65535\n    .TintAndShade = 0\n    .PatternTintAndShade = 0\nEnd With\nActiveSheet.Range(\"$A$1:$G$9\").AutoFilter Field:=1\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 6177416, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1785fcb7427d011623588c690fe922ac?s=128&d=identicon&r=PG&f=1", "display_name": "David Syriac", "link": "https://stackoverflow.com/users/6177416/david-syriac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462989243, "creation_date": 1462988791, "last_edit_date": 1531161705, "question_id": 37169895, "link": "https://stackoverflow.com/questions/37169895/colouring-the-entire-row", "title": "Colouring the entire row", "body": "<p>I have few cells colored in Range (\"I1:I100\"). I need to color the entire row .I have VBA recorded for that but it shows some error.</p>\n\n<pre><code>ActiveSheet.Range(\"I1:I100\").AutoFilter Field:=1, Criteria1:=RGB(255, 255 _\n    , 0), Operator:=xlFilterCellColor\nRows.Activate.Select\nWith Selection.Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 65535\n    .TintAndShade = 0\n    .PatternTintAndShade = 0\nEnd With\nActiveSheet.Range(\"$A$1:$G$9\").AutoFilter Field:=1\n</code></pre>\n\n<p>but is it possible to have a SIMPLE code by declaring the variables. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1462988868, "post_id": 37169840, "comment_id": 61874613, "body": "The issue you are seeing is because Excel uses number with decimals to store date/time and you are running into the issue that though Excel shows every fifteen minutes in decimal form it is not exact to the value you are looking for it may be off by +/- .00001 or more.  This is not enough to change the minute but is in fact several parts of a second off."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1462989547, "post_id": 37169840, "comment_id": 61875039, "body": "Damn you number precision!  You have been my bane on more than one occasion."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462989737, "post_id": 37169840, "comment_id": 61875150, "body": "Especially when 15 minutes equates to <code>0.010416666666</code> with 6 repeating forever.  Excel truncates this to <code>0.0104166666666667</code> so depending on when excel rounds it will be off."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1462990496, "post_id": 37169840, "comment_id": 61875616, "body": "This is VBA as opposed to spreadsheet formulas, but would the VBA code work better if he broke the time down and compare the quivalent of Minutes(a1)&lt;&gt;Minutes(A1)+Time(0,15,0)  or are you still just screwed with the precision aspect?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 1, "creation_date": 1462990697, "post_id": 37169840, "comment_id": 61875739, "body": "@ForwardEd yes <code>If TimeSerial(Hour(Range(&quot;A&quot; &amp; j).Value), Minute(Range(&quot;A&quot; &amp; j).Value), 0) &lt;&gt; TimeSerial(Hour(Range(&quot;A&quot; &amp; j - 1).Value), Minute(Range(&quot;A&quot; &amp; j - 1).Value + 15), 0) Then</code>"}], "owner": {"reputation": 11, "user_id": 5269852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caa843c1c0732af9e78acddf789bfc99?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin T", "link": "https://stackoverflow.com/users/5269852/kevin-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1462988631, "creation_date": 1462988631, "question_id": 37169840, "link": "https://stackoverflow.com/questions/37169840/arbitrary-equivalence-of-dates", "title": "Arbitrary equivalence of dates", "body": "<p>My code in VBA is as follows to check that each datetime in column A is 15 min after the one before: </p>\n\n<pre><code>  For j = 2 To 18\n       If Range(\"A\" &amp; j).Value &lt;&gt; DateAdd(\"n\", 15, Range(\"A\" &amp; j - 1).Value) Then   \n            Range(\"C\" &amp; j).Value = DateAdd(\"n\", 15, Range(\"A\" &amp; j - 1).Value)\n            Range(\"D\" &amp; j).Value = Range(\"A\" &amp; j).Value\n       End If\n  Next j\n</code></pre>\n\n<p>This is my output when I expect nothing in columns C and D:\n<a href=\"http://i.stack.imgur.com/6jsWw.png\" rel=\"nofollow\">Output</a></p>\n\n<p>Why is there a recurring pattern of when the dates are not equivalent even though the output shows that they are?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1462988571, "post_id": 37169796, "comment_id": 61874429, "body": "Try this <code>.Range(&quot;N2&quot;).FormulaArray = &quot;=INDEX(&quot; &amp; sPath &amp; &quot;,MATCH(1,(&quot; &amp; sPath3 &amp; &quot;=K2)*(&quot; &amp; sPath2 &amp; &quot;=&quot;&quot;CVA&quot;&quot;),0),3)&quot;</code>.  You need to remove the variables from the quotes."}, {"owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462989360, "post_id": 37169796, "comment_id": 61874949, "body": "that looked promising but &#39;unable to set the formularray property of the range class&#39; err."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462989839, "post_id": 37169796, "comment_id": 61875211, "body": "try this as a regular formula not an array: <code>.Range(&quot;N2&quot;).FormulaArray = &quot;=INDEX(&quot; &amp; sPath &amp; &quot;,MATCH(1,INDEX(&quot; &amp; sPath3 &amp; &quot;=K2)*(&quot; &amp; sPath2 &amp; &quot;=&quot;&quot;CVA&quot;&quot;),),0),3)&quot;</code>"}, {"owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462994633, "post_id": 37169796, "comment_id": 61877846, "body": "That didn&#39;t work either.  Appreciate your input."}, {"owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462995322, "post_id": 37169796, "comment_id": 61878230, "body": "I think I see the problem potentially.  The formula ends up being 305 chars long.  Perhaps breaking it up will help."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462995386, "post_id": 37169796, "comment_id": 61878270, "body": "I had a typo, did you try <code>.Range(&quot;N2&quot;).Formula = &quot;=INDEX(&quot; &amp; sPath &amp; &quot;,MATCH(1,INDEX(&quot; &amp; sPath3 &amp; &quot;=K2)*(&quot; &amp; sPath2 &amp; &quot;=&quot;&quot;CVA&quot;&quot;),),0),3)&quot;</code>?"}, {"owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462995501, "post_id": 37169796, "comment_id": 61878337, "body": "I did, i knew what you were going for"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462995596, "post_id": 37169796, "comment_id": 61878387, "body": "You are missing a <code>&#39;</code> in the beginning of the string.  Change this <code>sPath = sPath &amp; &quot;[TypeList]List&#39;!$B$2:$D$1000&quot;</code> to this <code>sPath = &quot;&#39;&quot; &amp; sPath &amp; &quot;[TypeList]List&#39;!$B$2:$D$1000&quot;</code>"}, {"owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462996305, "post_id": 37169796, "comment_id": 61878784, "body": "Okay, that last suggestion and just using as a Formula get&#39;s it working, not getting my desired result <code>#N&#47;A</code> but at least the Formula gets entered."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462997131, "post_id": 37169796, "comment_id": 61879253, "body": "So your formula in the cell is correct but returns &quot;N/A&quot;?  That usually means that the criteria was not found.  It has to find the value in Column K <b>and</b> &quot;CVA&quot; in their respective columns."}, {"owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462997332, "post_id": 37169796, "comment_id": 61879347, "body": "That is correct and it should find a match.  Confirmed by looking at the workbook and by using the orig formula.  Thanks for assistance.  2 free internet beers for you."}], "owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 687, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462988458, "creation_date": 1462988458, "question_id": 37169796, "link": "https://stackoverflow.com/questions/37169796/index-match-from-closed-workbook-with-variable-file-path", "title": "Index Match from closed workbook with variable file path", "body": "<p>I currently have the following which works as it references the open TypeList workbook and matches on two criteria to return appropriate value.</p>\n\n<pre><code>With Sheets(wsname)\n        .Range(\"N2\").FormulaArray = \"=INDEX([TypeList]List!$B$2:$D$1000,MATCH(1,([TypeList]List!$B$2:$B$1000=K2)*([TypeList]List!$A$2:$A$1000=\"\"CVA\"\"),0),3)\"\n        .Range(\"N2:N\" &amp; lRow).FillDown\nEnd With\n</code></pre>\n\n<p>What I'm trying is to avoid opening the TypeList workbook and instead reference the range inside the closed workbook.  I've assigned the file path and ranges</p>\n\n<pre><code>sPath = Application.UserLibraryPath\nsPath2 = Application.UserLibraryPath\nsPath3 = Application.UserLibraryPath\nsPath = sPath &amp; \"[TypeList]List'!$B$2:$D$1000\"\nsPath2 = sPath2 &amp; \"[TypeList]List'!$A$2:$A$1000\"\nsPath3 = sPath3 &amp; \"[TypeList]List'!$B$2:$B$1000\"\n</code></pre>\n\n<p>so I thought this would work</p>\n\n<pre><code>.Range(\"N2\").FormulaArray = \"=INDEX(sPath,MATCH(1,(sPath3=K2)*(sPath2=\"\"CVA\"\"),0),3)\"\n</code></pre>\n\n<p>which only returns #NAME so I assume it's not seeing the closed workbook but I'm sure what direction to go.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1462989867, "post_id": 37169719, "comment_id": 61875234, "body": "Move the &quot;Wend&quot; statement from where it is to after &quot;End If&quot;"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1462989904, "post_id": 37169719, "comment_id": 61875254, "body": "Also, see this: <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\" title=\"how to avoid using select in excel vba macros\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1462989982, "post_id": 37169719, "comment_id": 61875313, "body": "Also change &quot;Range(&quot;Y&quot; &amp; intCardSize)&quot; to &quot;Range(&quot;Y&quot; &amp; intCounter)&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1462997911, "post_id": 37172007, "comment_id": 61879639, "body": "The OP had a misunderstanding about how to code VBA.  This answer does not explain the issue they were having, and, further, uses even more difficult to understand VBA without explaining it.  The OP will not learn much from pasting your code into their workbook.  To improve this, comment on the problem they were having and how to fix it, then, potentially, include your additional solution, along with an explanation."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1462998321, "post_id": 37172007, "comment_id": 61879874, "body": "@OpiesDad You know, I learned much more studying different solutions then those I expected. Nonetheless I never downvoted who thought differently"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1462998834, "post_id": 37172007, "comment_id": 61880163, "body": "I have no problem with offering a different solution.  This solution doesn&#39;t explain anything.  It is fair to say that I went too far in suggesting that your solution needed to include a solution in the method asked for and for that, I apologize.  The code should at least be explained, however, even as much as stating why this method is preferable to the one they were attempting."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1462996072, "creation_date": 1462996072, "answer_id": 37172007, "question_id": 37169719, "link": "https://stackoverflow.com/questions/37169719/excel-macro-help-if-statement-with-a-variable-range/37172007#37172007", "title": "Excel macro help - If statement with a variable range", "body": "<p>I hope I understood your code goal as follows </p>\n\n<pre><code>With Sheets(\"Data_Dump\")\n    With Sheets(\"Reconciliation\").Range(\"E11\").Resize(.Cells(.Rows.Count,1).Row)\n        .Formula=\"=IF('Data_Dump'!Y1=\"CB\", \"Yes\",\"\")\"\n        .Value= .Value\n    End With\nEnd With \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 6321710, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8II1PDaoOT4/AAAAAAAAAAI/AAAAAAAAAK4/ZgmXglILBY4/photo.jpg?sz=128", "display_name": "Kamal", "link": "https://stackoverflow.com/users/6321710/kamal"}, "edited": false, "score": 0, "creation_date": 1463066688, "post_id": 37173156, "comment_id": 61915045, "body": "Hey thanks so much for this! Having the Wend at the beginning did nothing, as your comment up top stated. I made some changes and I can&#39;t seem to get it work properly...I want it to start pasting into column E11 (on recSheet) and go down from there. So if there are 15 rows in Y1, on dataSheet, recSheet would paste from E11 to E26, yes or no. I changed&quot;E&quot; to &quot;E1&quot;, which starts to paste at E11 but only goes 9 iterations before jumping to row 110. Do you know why this might be? Something with the the counter?"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 13, "user_id": 6321710, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8II1PDaoOT4/AAAAAAAAAAI/AAAAAAAAAK4/ZgmXglILBY4/photo.jpg?sz=128", "display_name": "Kamal", "link": "https://stackoverflow.com/users/6321710/kamal"}, "edited": false, "score": 0, "creation_date": 1463066911, "post_id": 37173156, "comment_id": 61915211, "body": "I misread the question....the code as provided will paste starting in row 1 on the recSheet.  By changing &quot;E&quot; to &quot;E1&quot;, you were initially pasting in cell &quot;E11&quot;, but then, once lngCounter was equal to &#39;10&#39;, you began pasting in cell, &quot;E110&quot; as &quot;E1&quot; was concatenated with &#39;10&#39;.  One way to do it is, &quot;E&quot; &amp; (9+lngCounter).  I&#39;ll update the answer to reflect this.  The 9 is described in the comment in the code."}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": true, "score": 0, "last_activity_date": 1463068666, "last_edit_date": 1463068666, "creation_date": 1463000261, "answer_id": 37173156, "question_id": 37169719, "link": "https://stackoverflow.com/questions/37169719/excel-macro-help-if-statement-with-a-variable-range/37173156#37173156", "title": "Excel macro help - If statement with a variable range", "body": "<p>The problem that you are having is that your code doesn't loop to try to compare.  The While loop that you have only looks to see if there is something in the next cell.  In fact, it actually skips the first row, but maybe that was intentional.</p>\n\n<pre><code>Dim dataSheet As WorkSheet\nDim recSheet As Worksheet\nDim lngCounter As Long 'Use long because an integer may not be big enough for large dataset.\nDim intCardSize As Long\n\nSet dataSheet = ThisWorkbook.Sheets(\"Data_Dump\")\nSet recSheet = ThisWorkbook.Sheets(\"Reconciliation\")\n'You want to set the sheets to a variable instead of referring to the whole path each time\n'Also, Note the usage of \"ThisWorkbook\" which guarantees the worksheet \n'is coming from the one with code in it.\nlngCounter = 2 'If you want to start looking at row 2, start at row 2 with\n               'the variable instead of starting the variable and checking var+1\nWhile dataSheet.Range(\"Y\" &amp; (lngCounter)) &lt;&gt; \"\"\n     'While there is a value in the column\n\n     'intCardSize = intCounter 'Not sure what this is supposed to do\n     'MsgBox (intCardSize) 'This looks like debugging.  Commenting out.\n\n\n     If dataSheet.Range(\"Y\" &amp; lngCounter) = \"CB\" Then\n          'Check each row as you go through the loop.\n          'Sheets(\"Reconciliation\").Select \n          'Avoid selecting sheet/range.  Unneccessary work for computer.\n\n          recSheet.Range(\"E\" &amp; (9 + lngCounter)) = \"Yes\"\n          'Set reconciliation sheet value to \"Yes\" if data sheet has \"CB\"\n          'The reconciliation sheet starts on row 11, whereas the datasheet\n          'starts at row 2 ,a difference of 9 \n     Else\n          recSheet.Range(\"E\" &amp; (9 + lngCounter)) = \"No\"\n          'Otherwise set to no.\n     End If\n     lngCounter = lngCounter + 1\nWend\nintCardSize = lngCounter - 1 'It's been increased to one past the last item.\nMsgBox intCardSize 'Display the last row checked.\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6321710, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8II1PDaoOT4/AAAAAAAAAAI/AAAAAAAAAK4/ZgmXglILBY4/photo.jpg?sz=128", "display_name": "Kamal", "link": "https://stackoverflow.com/users/6321710/kamal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 594, "favorite_count": 0, "accepted_answer_id": 37173156, "answer_count": 2, "score": 1, "last_activity_date": 1463068666, "creation_date": 1462988243, "last_edit_date": 1462997711, "question_id": 37169719, "link": "https://stackoverflow.com/questions/37169719/excel-macro-help-if-statement-with-a-variable-range", "title": "Excel macro help - If statement with a variable range", "body": "<p>I am creating a macro to help organize a data dump (sheet 1) into an invoice (sheet 2). I have coded most of the macro, but am stuck on the following. </p>\n\n<p>I want the macro to read column Y on sheet 1, which is a variable range (can be 2 rows to 50) and check if it says \"CB\". If this is true, then E11 on sheet 2 is Yes, otherwise No, and so on until it reaches the end of column Y on sheet 1. </p>\n\n<p>I have the following:</p>\n\n<pre><code>Sheets(\"Data_Dump\").Select\nintCounter = 1\nWhile Range(\"Y\" &amp; (intCounter + 1)) &lt;&gt; \"\"\n    intCounter = intCounter + 1\nWend\nintCardSize = intCounter\nMsgBox (intCardSize)\n\nSheets(\"Data_Dump\").Select\n\nIf Range(\"Y\" &amp; intCardSize) = \"CB\" Then\n    Sheets(\"Reconciliation\").Select\n    Range(\"E11:E\" &amp; intCardSize).Select\n    Range(\"E11\") = \"Yes\"\nEnd If\n</code></pre>\n\n<p>The while range seems to work and it displays the number of  cells with text in column Y, but I can't seem to wrap my head around how to get it to move from Y1 to Y2 and so on and then paste the response into E11 then E12 and so on.</p>\n"}, {"tags": ["excel", "vb6", "xlsx", "vba"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1462990340, "post_id": 37169547, "comment_id": 61875523, "body": "<a href=\"http://www.connectionstrings.com\" rel=\"nofollow noreferrer\">connectionstrings.com</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6321675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f308399ab7caf849809a77371cb0a377?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Fuzaro", "link": "https://stackoverflow.com/users/6321675/arthur-fuzaro"}, "edited": false, "score": 1, "creation_date": 1462995778, "post_id": 37171414, "comment_id": 61878483, "body": "yeah, I asked for help, for a friend mine, and I did almost the same thing, so thank you so much"}], "tags": [], "owner": {"reputation": 222, "user_id": 5932559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2b032614454ca145d8715856daba434a?s=128&d=identicon&r=PG&f=1", "display_name": "FatBoySlim7", "link": "https://stackoverflow.com/users/5932559/fatboyslim7"}, "is_accepted": true, "score": 0, "last_activity_date": 1462993904, "creation_date": 1462993904, "answer_id": 37171414, "question_id": 37169547, "link": "https://stackoverflow.com/questions/37169547/reading-excel-with-the-driver-xlsx-vb6/37171414#37171414", "title": "Reading excel with the driver xlsx vb6", "body": "<p>I don't really understand what you are trying to do but it seems like you are trying to establish a connection (looking at your code).....try something like this with what you are doing....</p>\n\n<pre><code>Dim g_cnDB as ADODB.Connection\nSet g_cnDB as ADODB.Connection\ng_cnDB.ConnectionString = \"Provider=TEXT;User ID=TEXT; Pwd=TEXT; Initial Catalog=TEXT; Data Source=TEXT\"\n'Then set it's timeout to be unlimited, so your connection remains open until you close it\ng_cnDB.CommandTimeout = 0\n'Establishing the connection\ng_cnDB.Open\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6321675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f308399ab7caf849809a77371cb0a377?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Fuzaro", "link": "https://stackoverflow.com/users/6321675/arthur-fuzaro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1288, "favorite_count": 0, "accepted_answer_id": 37171414, "answer_count": 1, "score": 0, "last_activity_date": 1463058967, "creation_date": 1462987778, "last_edit_date": 1531161705, "question_id": 37169547, "link": "https://stackoverflow.com/questions/37169547/reading-excel-with-the-driver-xlsx-vb6", "title": "Reading excel with the driver xlsx vb6", "body": "<p>I'm having a problem during one week, and I couldn't find the solution. I'm trying to read a file in xlsx on vb6 as a component of the asp classic.</p>\n\n<p>First issue that I couldn't be able to solve was this</p>\n\n<pre><code>Dim cn As New ADODB.Connection\nDim provider As String\nprovider = \"Driver={Microsoft Excel Driver (*.xlsx)};DBQ=\" &amp; nomArq &amp; \";\"\nSet cn = CreateObject(\"ADODB.Connection\")\ncn.Open provider\n</code></pre>\n\n<p>The error that I got in this connection was </p>\n\n<blockquote>\n  <p>\"[Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified\"</p>\n</blockquote>\n\n<p>The second try was in this way</p>\n\n<pre><code>Dim cn As New ADODB.Connection\n'Dim provider As String\nWith cn\n    .provider = \"Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; nomArq &amp; \";\" &amp; \";Extended Properties=\\\"\"Excel 8.0;HDR=Yes\\;\"\"\"\n    .Open\nEnd With\n</code></pre>\n\n<p>And the erros was </p>\n\n<blockquote>\n  <p>\"Format of the initialization string does not conform to the OLE DB specification.\"</p>\n</blockquote>\n\n<p>I also tried in another way and I got the error: </p>\n\n<blockquote>\n  <p>\"could not find installable isam\"</p>\n</blockquote>\n\n<p>but I don't have the code hear anymore.</p>\n\n<p>someone could help me, I looked in all most everything on google</p>\n"}, {"tags": ["excel", "vba", "pivot-table", "excel-2013"], "comments": [{"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1462987804, "post_id": 37169016, "comment_id": 61873952, "body": "Have you tried using the macro recorder to see what syntax it uses?  Looks like <code>activeworkbook.refreshall</code> should replace those loops."}, {"owner": {"reputation": 131, "user_id": 6315324, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eee6419b551cbdc5c28b6a5344639cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Habib Inman", "link": "https://stackoverflow.com/users/6315324/habib-inman"}, "reply_to_user": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1462987983, "post_id": 37169016, "comment_id": 61874060, "body": "Which version of Excel?  When I use the macro recorder I get this: ActiveSheet.PivotTables(&quot;PivotTable1&quot;).PivotCache.Refresh"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1462988075, "post_id": 37169016, "comment_id": 61874120, "body": "What&#39;s the pivot table source exactly? Is the source refreshed?"}, {"owner": {"reputation": 131, "user_id": 6315324, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eee6419b551cbdc5c28b6a5344639cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Habib Inman", "link": "https://stackoverflow.com/users/6315324/habib-inman"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1462988144, "post_id": 37169016, "comment_id": 61874157, "body": "@Mat&#39;sMug - the pivot table source is an embedded mysql query that needs to be refreshed first...I wonder if the pivot refresh fire is occuring before the pivot table is fully refreshed."}, {"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 1, "creation_date": 1462989235, "post_id": 37169016, "comment_id": 61874873, "body": "Excel 2013 and I was using the refresh all button from the drop down.  Using the normal refresh button I get the ..pivotcashe.refresh which also works running it through vba for me."}, {"owner": {"reputation": 131, "user_id": 6315324, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eee6419b551cbdc5c28b6a5344639cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Habib Inman", "link": "https://stackoverflow.com/users/6315324/habib-inman"}, "reply_to_user": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1462991125, "post_id": 37169016, "comment_id": 61875958, "body": "@gtwebb - is there a way to set the way refreshall() works in?  Meaning, can I have the pivottable be the very last to refresh and ONLY begin after the mysql query is completed?"}, {"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1462991994, "post_id": 37169016, "comment_id": 61876379, "body": "You wouldn&#39;t be able to set it within the refreshall command itself.  Not sure how you refresh the SQL data but you could either set up a pause of a certain duration in the code or have another loop that runs until the rest of the updating is done.  Also note refreshall won&#39;t resize the pivottable source data if more data is added."}, {"owner": {"reputation": 131, "user_id": 6315324, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eee6419b551cbdc5c28b6a5344639cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Habib Inman", "link": "https://stackoverflow.com/users/6315324/habib-inman"}, "reply_to_user": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1462995654, "post_id": 37169016, "comment_id": 61878415, "body": "@gtwebb - I&#39;ll play with the wait function,thank you for that heads up, I have the pivot table set to a named range so it grows/shrinks based on the dataset returned."}, {"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1477480998, "post_id": 37169016, "comment_id": 67782476, "body": "I&#39;ve also got this issue - pivot table with data source as a data table in another sheet.  I change the query, refresh the data table connection (<code>connection.Refresh</code>) which successfully updates the data table, then call  <code>PivotTable.PivotCache.Refresh</code> <i>and</i> <code>PivotTable.RefreshTable</code> after a long delay, but the pivot table stays on the previous data.  Manually refreshing from the UI works fine.  Single-stepping through the code also refreshes the pivot table.  I&#39;ve tried activating the worksheet first and setting <code>ScreenUpdating = True</code> first, but no help."}], "answers": [{"tags": [], "owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "is_accepted": false, "score": 0, "last_activity_date": 1477490864, "last_edit_date": 1495540837, "creation_date": 1477490864, "answer_id": 40264509, "question_id": 37169016, "link": "https://stackoverflow.com/questions/37169016/refresh-pivot-table/40264509#40264509", "title": "Refresh Pivot Table", "body": "<p>My problem with this was solved by setting <code>BackgroundQuery</code> to <code>False</code> in the related connection before refreshing it:</p>\n\n<pre><code>With ThisWorkbook.Connections(1).OLEDBConnection\n    .BackgroundQuery = False\n    .Refresh\nEnd With\nPivot.RefreshTable\n</code></pre>\n\n<p>(replace <code>OLEDBConnection</code> with the appropriate connection object)</p>\n\n<p>It appears that with <code>BackgroundQuery</code> set to <code>True</code>, the connection will not finish retrieving the data until the code has exited.  You can see this by doing:</p>\n\n<pre><code>With ThisWorkbook.Connections(1).OLEDBConnection\n    .BackgroundQuery = True\n    .Refresh\n    Do While .Refreshing\n        DoEvents\n    Loop\nEnd With\n</code></pre>\n\n<p>This loop never terminates, and the status bar in Excel shows \"RUNNING BACKGROUND QUERY (CLICK HERE TO CANCEL)\"; clicking brings up a dialogue showing \"All rows fetched.\", but with the query still apparently running.</p>\n\n<p>See also this answer - <a href=\"https://stackoverflow.com/a/25054870/3590073\">https://stackoverflow.com/a/25054870/3590073</a></p>\n"}], "owner": {"reputation": 131, "user_id": 6315324, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eee6419b551cbdc5c28b6a5344639cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Habib Inman", "link": "https://stackoverflow.com/users/6315324/habib-inman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 392, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1477490864, "creation_date": 1462986087, "last_edit_date": 1462988109, "question_id": 37169016, "link": "https://stackoverflow.com/questions/37169016/refresh-pivot-table", "title": "Refresh Pivot Table", "body": "<p>In Excel 2013 - what is the VBA Syntax to refresh a Pivot Table?  I have tried both of the options below and neither of them refresh my pivot table.</p>\n\n<pre><code>    'Does Not Work\nSheets(\"Sheet1\").Select\nActiveSheet.PivotTables(\"PivotTable1\").PivotCache.Refresh\n'Does Not Work\nFor Each Sheet In ThisWorkbook.Worksheets\n    For Each Pivot In Sheet.PivotTables\n        Pivot.RefreshTable\n        Pivot.Update\n    Next\nNext\n</code></pre>\n\n<p><strong>EDIT</strong><br>\nTo Add to it---I am actually needing to refresh a embedded MySQL Query 1st THEN refresh the pivot table.</p>\n"}, {"tags": ["vba", "validation", "ms-access", "boolean"], "answers": [{"tags": [], "owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "is_accepted": false, "score": 1, "last_activity_date": 1462986147, "creation_date": 1462986147, "answer_id": 37169032, "question_id": 37168946, "link": "https://stackoverflow.com/questions/37168946/validation-rule-as-a-boolean-or-comparable-variable-vba-access/37169032#37169032", "title": "Validation Rule As a Boolean (or comparable variable) VBA Access", "body": "<p>You can use the <code>and</code> operator. So you will have something like</p>\n\n<pre><code>If rule1 And rule2 And rule3 then\n    'code here\nEnd if\n</code></pre>\n\n<p>Where ruleX is any boolean expression.</p>\n"}], "owner": {"reputation": 1, "user_id": 6297617, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oohHNm-HTNo/AAAAAAAAAAI/AAAAAAAAAww/e3knjS6MEVk/photo.jpg?sz=128", "display_name": "Iain Henderson", "link": "https://stackoverflow.com/users/6297617/iain-henderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593958664, "creation_date": 1462985877, "last_edit_date": 1593958664, "question_id": 37168946, "link": "https://stackoverflow.com/questions/37168946/validation-rule-as-a-boolean-or-comparable-variable-vba-access", "title": "Validation Rule As a Boolean (or comparable variable) VBA Access", "body": "<p>I have a form that creates user accounts, and I want the \"Create My Account\" button to be disabled until all the fields have satisfied their validation rules.\nIs there some manner of coding comparable to:</p>\n\n<pre><code>If Me.Field.ValidationRule = True Then\n-code-\n</code></pre>\n\n<p>It doesn't have to be in boolean form, that's just the first way I can think of doing it.\nI don't know if it makes a difference, but the fields are not directly linked to the table; after the \"Create My Account\" button is pressed, the values are transferred. \nThank you.</p>\n"}, {"tags": ["excel", "vba", "text"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1462985267, "post_id": 37168727, "comment_id": 61872470, "body": "Text to columns? Convert texto csv then import? Regex?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 2, "creation_date": 1462985800, "post_id": 37168727, "comment_id": 61872761, "body": "<b>Help us to help you.</b> Post your current code."}], "answers": [{"tags": [], "owner": {"reputation": 156, "user_id": 6219524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be82ab7ad90aa19b4df8add5fcc2d244?s=128&d=identicon&r=PG&f=1", "display_name": "csanjose", "link": "https://stackoverflow.com/users/6219524/csanjose"}, "is_accepted": false, "score": 1, "last_activity_date": 1462985802, "creation_date": 1462985802, "answer_id": 37168922, "question_id": 37168727, "link": "https://stackoverflow.com/questions/37168727/how-to-get-value-from-text-file-by-excel-vba/37168922#37168922", "title": "how to get value from text file by excel vba?", "body": "<pre><code>Open file For Input As #1\nText = \"\"\n  Do Until EOF(1)\n    Line Input #1, textline\n    Text = Text &amp; textline\n  Loop\n\n  Close #1\n</code></pre>\n\n<p>With that, you have all data in variable 'text'. Now you can fill the data into the appropiate columns with InStr.</p>\n"}], "owner": {"reputation": 15, "user_id": 3648588, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dea2d58305e6399355f1751baa3a32fc?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/3648588/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 684, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1462985802, "creation_date": 1462985131, "last_edit_date": 1462985191, "question_id": 37168727, "link": "https://stackoverflow.com/questions/37168727/how-to-get-value-from-text-file-by-excel-vba", "title": "how to get value from text file by excel vba?", "body": "<p>I have a text file with information like </p>\n\n<blockquote>\n  <p>{\"status\":200,\"source_coordinates\":[[52.55407,13.160621]],\"destination_coordinates\":[[52.431237,13.720644],[52.55409,13.720557],[52.55407,13.160621]],\"distance_table\":[[31574,30971,0]]}</p>\n</blockquote>\n\n<p>and I'd like to have a table in excel with</p>\n\n<pre><code>columns status, source, destination, distance_table and theirs values.\n</code></pre>\n\n<p>Thanks for help</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1462984234, "post_id": 37168152, "comment_id": 61871867, "body": "Are you trying to retrieve information from a spreadsheet?"}, {"owner": {"reputation": 17, "user_id": 6321035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sy8Tl.jpg?s=128&g=1", "display_name": "pedrokl", "link": "https://stackoverflow.com/users/6321035/pedrokl"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1462986167, "post_id": 37168152, "comment_id": 61872965, "body": "No! Actually I&#39;m retrieving from a cube."}], "answers": [{"tags": [], "owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "is_accepted": true, "score": 0, "last_activity_date": 1463037586, "creation_date": 1463037586, "answer_id": 37179903, "question_id": 37168152, "link": "https://stackoverflow.com/questions/37168152/how-do-i-list-ids-via-mdx/37179903#37179903", "title": "How do I list ids via MDX?", "body": "<p>Maybe more like this:</p>\n\n<pre><code>WITH\n   MEMBER [Measures].[ID] AS \n    [Item ID].CURRENTMEMBER.MEMBER_KEY\nSELECT\n   [Measures].[ID] ON 0,\n    [Letter].ALLMEMBERS \n   *[Item ID].[Item ID].MEMBERS\n   ON 1\nFROM [Cube];\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 6321035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sy8Tl.jpg?s=128&g=1", "display_name": "pedrokl", "link": "https://stackoverflow.com/users/6321035/pedrokl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 37179903, "answer_count": 1, "score": 0, "last_activity_date": 1604883353, "creation_date": 1462983410, "last_edit_date": 1604883353, "question_id": 37168152, "link": "https://stackoverflow.com/questions/37168152/how-do-i-list-ids-via-mdx", "title": "How do I list ids via MDX?", "body": "<p>The question is, how can i retrieve the info in the way below?</p>\n<pre><code>LETTER | ID | NAME\n  A    | 01 | xxxx\n  A    | 02 | xxyy\n  A    | 03 | xyz\n  B    | 04 | aaaa\n  B    | 05 | aabb\n  C    | 06 | yyy\n... \n</code></pre>\n<p><em><strong>Quick edit here:</strong></em></p>\n<p>I tried to run this query</p>\n<pre><code>WITH\n   MEMBER [Measures].[ID] AS [Item ID].CURRENTMEMBER.MEMBER_CAPTION\nSELECT\n   [Measures].[ID] ON COLUMNS,\n   [Letter].ALLMEMBERS ON ROWS\nFROM [Cube]\n</code></pre>\n<p>And the result was</p>\n<pre><code>LETTER | ID\n   A   | All\n   B   | All\n   C   | All\n   D   | All\n   E   | All\n</code></pre>\n<p>Just to give some context here, I intend to get this unique ID and retrieve all the info related to it and then write on a Excel row, for example, all of that using VBA.</p>\n<p><em><strong>New edit!</strong></em></p>\n<p>It worked very well, but I tried to make some mods, without success.\nAs I said, I'm pretty new to OLAP cube, but I do have a background in SQL.</p>\n<p>Maybe the real question is:</p>\n<p>What is the best practice to do that? Should I try to transform OLAP Cube into a flat file? How can manage this data before printing it?</p>\n"}, {"tags": ["sql-server", "excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1462984439, "post_id": 37168069, "comment_id": 61871993, "body": "Look at using <code>DoEvents</code> it might clear down some pending messages in the processing queue"}, {"owner": {"reputation": 693, "user_id": 4792803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7abffc13cec9c205a15f6856efe76e0?s=128&d=identicon&r=PG&f=1", "display_name": "C. White", "link": "https://stackoverflow.com/users/4792803/c-white"}, "edited": false, "score": 0, "creation_date": 1463105041, "post_id": 37168069, "comment_id": 61932442, "body": "Are you using ADO or DAO to open the recordset? There&#39;s a screwy bug in ADO that causes all sorts of weird memory issues when you use certain kinds of cursor/command combinations (asynchfetch + forwardonly, for example). Certain specific data sets seem to trigger it. <i>Probably</i> unrelated, but if that sounds like it may apply, change your cursor to <code>adOpenKeyset</code> and your execute option to synchronous (<code>&amp;H0</code>) see if that fixes it."}, {"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1463122461, "post_id": 37168069, "comment_id": 61938053, "body": "So this error says its an object, what is the <code>object</code>? Can it be replaced by <code>application</code>?"}], "owner": {"reputation": 21, "user_id": 3662523, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000061391446/picture?type=large", "display_name": "user3662523", "link": "https://stackoverflow.com/users/3662523/user3662523"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 841, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1594651435, "creation_date": 1462983161, "last_edit_date": 1594651435, "question_id": 37168069, "link": "https://stackoverflow.com/questions/37168069/access-vba-copy-from-recordset-range-object-error-2147417856", "title": "Access VBA Copy From Recordset Range Object Error -2147417856", "body": "<p>My database uses an ODBC connection to connect to SQL server.</p>\n\n<p>The access code runs through a SQL table of 100,000 years (around 5.7 million rows) and spits out in increments of 10,000 years data that is then run through a macro in excel and then repeated for the next increment of 10k years.</p>\n\n<p>The first set of 10,000 years has roughly 420k+ rows exporting to excel\nThe next set of 10,000 years (years 10,001-20,000) has roughly 450k+ rows </p>\n\n<p>Assume gradual increase of 30k rows per 10k year jump up </p>\n\n<p>When getting to the 60,001-70,000 increment sometimes the code will crap out and give a </p>\n\n<blockquote>\n  <p>'Copy from Recordset Object Range Method failed Code -2147417856' error</p>\n</blockquote>\n\n<p>The fix to this is to hit debug, then just hit the play button and the code then continues. Because that fix works, I'm under the impression that access is getting overloaded with processing and just craps out randomly (I don't know what else could be wrong) </p>\n\n<p>I tried to install an error handling fix to repeat the part of the code that craps out if an error occurs, and the error handler caught the error, but the error still occurred.</p>\n\n<p>UPDATE: Before I typed this up I went into the Excel file that is being spit out and hit Ctrl + Pause within the macro and then hit the play button then hit Ctrl + Pause again then hit the play button. Then I pressed debug and clicked compile VBA project and then saved the workbook. Then when running from access again there was no error. </p>\n\n<p>Honestly, I have no idea what's going on so any ideas or fixes on this would be helpful. (Although it seems as if I have fixed the issue)</p>\n"}, {"tags": ["python", "excel", "openpyxl", "win32com", "vba"], "comments": [{"owner": {"reputation": 14362, "user_id": 2385133, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3a93c5a0f975385738c1f27848f3b50a?s=128&d=identicon&r=PG", "display_name": "Charlie Clark", "link": "https://stackoverflow.com/users/2385133/charlie-clark"}, "edited": false, "score": 1, "creation_date": 1462990786, "post_id": 37167855, "comment_id": 61875784, "body": "You probably want to look at the outline properties for row and column dimensions."}, {"owner": {"reputation": 366, "user_id": 2256346, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a5f9cbd50c4ad1836534519dc3f4e87?s=128&d=identicon&r=PG", "display_name": "Hellohowdododo", "link": "https://stackoverflow.com/users/2256346/hellohowdododo"}, "reply_to_user": {"reputation": 14362, "user_id": 2385133, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3a93c5a0f975385738c1f27848f3b50a?s=128&d=identicon&r=PG", "display_name": "Charlie Clark", "link": "https://stackoverflow.com/users/2385133/charlie-clark"}, "edited": false, "score": 0, "creation_date": 1463021336, "post_id": 37167855, "comment_id": 61887340, "body": "Aha! Thank you very much, your comment helped a lot! Before I did not now at all, which questions to ask from google :-) I will post answer now."}], "answers": [{"tags": [], "owner": {"reputation": 366, "user_id": 2256346, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a5f9cbd50c4ad1836534519dc3f4e87?s=128&d=identicon&r=PG", "display_name": "Hellohowdododo", "link": "https://stackoverflow.com/users/2256346/hellohowdododo"}, "is_accepted": true, "score": 0, "last_activity_date": 1463021474, "creation_date": 1463021474, "answer_id": 37176453, "question_id": 37167855, "link": "https://stackoverflow.com/questions/37167855/split-excel-file-into-multiple-by-excel-groups/37176453#37176453", "title": "Split excel file into multiple by excel groups", "body": "<pre><code># -*- coding: utf-8 -*-\nimport openpyxl\n\nwb = openpyxl.load_workbook(r'path_to_xlsx_file')\nws = wb.active\nrange_string = ws.calculate_dimension()\nprint(range_string)\nfor row_index, row in enumerate(ws.iter_rows(range_string=range_string)):\n    print(ws.row_dimensions[row_index].index,  # just for the great LULZ\n          ws.row_dimensions[row_index].outline_level,  # THAT what I was looking for!\n          ws.row_dimensions[row_index].hidden,  # couple other helpful parameters\n          ws.row_dimensions[row_index].collapsed,\n          ws.row_dimensions[row_index].height)\n</code></pre>\n"}], "owner": {"reputation": 366, "user_id": 2256346, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a5f9cbd50c4ad1836534519dc3f4e87?s=128&d=identicon&r=PG", "display_name": "Hellohowdododo", "link": "https://stackoverflow.com/users/2256346/hellohowdododo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 0, "accepted_answer_id": 37176453, "answer_count": 1, "score": -1, "last_activity_date": 1463021474, "creation_date": 1462982551, "last_edit_date": 1531161705, "question_id": 37167855, "link": "https://stackoverflow.com/questions/37167855/split-excel-file-into-multiple-by-excel-groups", "title": "Split excel file into multiple by excel groups", "body": "<p>By groups I mean this expandable things:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Nmrbe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Nmrbe.png\" alt=\"pic1\"></a></p>\n\n<p>When pressing on them we can expand some rows, in this particular case I need to extract rows to different data locations (in whatever, list of rows/better - other excel files), grouped by 1st, hm, group:</p>\n\n<p><a href=\"https://i.imgur.com/UvTg8nm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.imgur.com/UvTg8nm.png\" alt=\"pic2\"></a></p>\n\n<p>So that, for example in this case:</p>\n\n<p>file1.xlsx will be include all rows from 6 to 572</p>\n\n<p>file2.xlsx will be include rows from 573 to 627</p>\n\n<p>and so on.</p>\n\n<p>How to perform this? It can be VBA script, but better with some python library like openpyxl or win32com.client</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1462986368, "post_id": 37167482, "comment_id": 61873071, "body": "as a side note: you&#39;d better declare <code>Dim R_count As Long</code> since you could exceed the integer type maximum value (some 32 k or so)"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6321286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/407da95dd8775e6cc48dbec5c1255db3?s=128&d=identicon&r=PG&f=1", "display_name": "Km1", "link": "https://stackoverflow.com/users/6321286/km1"}, "edited": false, "score": 0, "creation_date": 1462982512, "post_id": 37167590, "comment_id": 61870778, "body": "HI Chase, I still get a compile error with that ... many thanks for ur time"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 31, "user_id": 6321286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/407da95dd8775e6cc48dbec5c1255db3?s=128&d=identicon&r=PG&f=1", "display_name": "Km1", "link": "https://stackoverflow.com/users/6321286/km1"}, "edited": false, "score": 0, "creation_date": 1462984311, "post_id": 37167590, "comment_id": 61871914, "body": "@Km1 my guess is you were using the non edited formula.  make sure you refresh your screen.  This should work."}], "tags": [], "owner": {"reputation": 127, "user_id": 5942603, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5dd7e5e856cbbbed8f75dd1be5e96525?s=128&d=identicon&r=PG&f=1", "display_name": "Chase", "link": "https://stackoverflow.com/users/5942603/chase"}, "is_accepted": false, "score": 1, "last_activity_date": 1462982088, "last_edit_date": 1462982088, "creation_date": 1462981763, "answer_id": 37167590, "question_id": 37167482, "link": "https://stackoverflow.com/questions/37167482/assigning-a-variable-declared-as-integer-to-a-formula/37167590#37167590", "title": "Assigning a variable declared as integer to a formula", "body": "<p>Your value you are assigning for your range is a string, so you will need to concatenate the string formula with your variable. Try the following:</p>\n\n<p><code>Range(\"n2\").FormulaR1C1 = \"=min((RC[-9]:R[\" &amp; R_count &amp; \"]c[-9]))\"</code></p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/te2585xw.aspx\" rel=\"nofollow\">Concatenating in VBA</a></p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 6321286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/407da95dd8775e6cc48dbec5c1255db3?s=128&d=identicon&r=PG&f=1", "display_name": "Km1", "link": "https://stackoverflow.com/users/6321286/km1"}, "edited": false, "score": 0, "creation_date": 1462983453, "post_id": 37167693, "comment_id": 61871398, "body": "That works fine ..... so basically by using &quot;&amp; xxxx &amp;&quot; u transforming the string into the integer it was previously assigned ? Many thanks for u time"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "reply_to_user": {"reputation": 31, "user_id": 6321286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/407da95dd8775e6cc48dbec5c1255db3?s=128&d=identicon&r=PG&f=1", "display_name": "Km1", "link": "https://stackoverflow.com/users/6321286/km1"}, "edited": false, "score": 0, "creation_date": 1462985762, "post_id": 37167693, "comment_id": 61872741, "body": "@Km1 the <code>xxxx</code> can be (almost) any variable. It will always convert the value to a string automaticly"}], "tags": [], "owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "is_accepted": false, "score": 0, "last_activity_date": 1462982370, "last_edit_date": 1462982370, "creation_date": 1462982048, "answer_id": 37167693, "question_id": 37167482, "link": "https://stackoverflow.com/questions/37167482/assigning-a-variable-declared-as-integer-to-a-formula/37167693#37167693", "title": "Assigning a variable declared as integer to a formula", "body": "<p>You cannot directly reference variables from vba in a formula, because the formula is a string that will be evaluated in a different place that does not know about your code. You will need to insert the value in your formula like so :</p>\n\n<pre><code>Range(\"n2\").FormulaR1C1 = \"=min((RC[-9]:R[\" &amp; R_count &amp; \"]c[-9]))\"\n</code></pre>\n\n<p>Which will produce a formula that will look like this (lets assume that <code>R_Count</code> is equal to 42 for this exemple)</p>\n\n<pre><code>=min((RC[-9]:R[42]c[-9]))\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6321286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/407da95dd8775e6cc48dbec5c1255db3?s=128&d=identicon&r=PG&f=1", "display_name": "Km1", "link": "https://stackoverflow.com/users/6321286/km1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1462984064, "creation_date": 1462981516, "last_edit_date": 1462984064, "question_id": 37167482, "link": "https://stackoverflow.com/questions/37167482/assigning-a-variable-declared-as-integer-to-a-formula", "title": "Assigning a variable declared as integer to a formula", "body": "<p>I'm trying to use a variable inside a formula, which has previously been declared as integer in the code, can someone help me with this matter? </p>\n\n<p>So basically I have: </p>\n\n<pre><code>  Dim R_count As Integer\n\n  R_count = Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n</code></pre>\n\n<p>which counts the number of row. Then I am trying to use the <code>variable R_count</code> in the <code>min</code> formula as being the bottom of my range, such as: </p>\n\n<pre><code>Range(\"n2\").FormulaR1C1 = \"=min((RC[-9]:R[&amp;R_count]c[-9]))\"\n</code></pre>\n\n<p>but VBa does not read <code>R_count</code> as an integer in the formula.</p>\n"}, {"tags": ["function", "excel", "concatenation", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462980133, "post_id": 37166799, "comment_id": 61869129, "body": "Do you have access to the latest Office 365?  If so the formula would be; <code>TEXTJOIN(&quot;;&quot;,TRUE,before!$A$1:$C$1 &amp; &quot;=&quot; &amp; before!$A2:$C2)</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462980457, "post_id": 37166799, "comment_id": 61869344, "body": "The above formula is an array and must be confirmed with Ctrl-Shift-Enter"}, {"owner": {"reputation": 164, "user_id": 2075066, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Kva7k.jpg?s=128&g=1", "display_name": "pwlm", "link": "https://stackoverflow.com/users/2075066/pwlm"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462981558, "post_id": 37166799, "comment_id": 61870093, "body": "@ScottCraner Though I do have access to 365 I wouldn&#39;t be able to use it for this project. Also it seems to split the result over multiple columns rather than in 1."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462981777, "post_id": 37166799, "comment_id": 61870247, "body": "It shouldn&#39;t but as I do not have access to my Office 365 at the moment to test I can&#39;t confirm.  But the reason that no one else has answered is that Stack Overflow is not a code for me site.  This will require VBA in a UDF or Sub.  When I get home I will try it."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462982310, "post_id": 37167727, "comment_id": 61870646, "body": "This only does the first row, you need to add another loop, or make this into a UDF then the rows can be set."}, {"owner": {"reputation": 1602, "user_id": 5682919, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4rC18.png?s=128&g=1", "display_name": "jsanchezs", "link": "https://stackoverflow.com/users/5682919/jsanchezs"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462982465, "post_id": 37167727, "comment_id": 61870742, "body": "That&#39;s the reason i said assuming it only has one row of values. @pwl would tell us if needs more."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1462982925, "post_id": 37167727, "comment_id": 61871049, "body": "@jsanchezs note that this <code>Dim r, c As Byte</code> only declares <code>c</code> as a byte, <code>r</code> will be treated as a variant. It won&#39;t make any odds here, but it&#39;s something commonly misunderstood in VBA"}], "tags": [], "owner": {"reputation": 1602, "user_id": 5682919, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4rC18.png?s=128&g=1", "display_name": "jsanchezs", "link": "https://stackoverflow.com/users/5682919/jsanchezs"}, "is_accepted": false, "score": 0, "last_activity_date": 1462983068, "last_edit_date": 1462983068, "creation_date": 1462982147, "answer_id": 37167727, "question_id": 37166799, "link": "https://stackoverflow.com/questions/37166799/concatenate-alternating-fixed-column-headers-and-row-values/37167727#37167727", "title": "Concatenate alternating fixed column headers and row values", "body": "<p>You can use this macro code temporary and assuming there's only one row of values :</p>\n\n<pre><code>Sub Macro1()\n\n' Macro1 Macro\n\nRange(\"A1\").Select\n\nDim r As Byte\nDim c as Byte\n\nDim stringunion As String\n\nr = 1\n\nc = 1\n\nDo While Cells(r, c) &lt;&gt; \"\"\n\n    stringunion = stringunion &amp; Cells(r, c).Value &amp; \"=\" &amp; Cells(r + 1, c) &amp; \";\"\n\n    c = c + 1\n\nLoop\n\nMsgBox stringunion\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 164, "user_id": 2075066, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Kva7k.jpg?s=128&g=1", "display_name": "pwlm", "link": "https://stackoverflow.com/users/2075066/pwlm"}, "edited": false, "score": 0, "creation_date": 1463049693, "post_id": 37167935, "comment_id": 61901903, "body": "Thank you for this solution."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1462982744, "creation_date": 1462982744, "answer_id": 37167935, "question_id": 37166799, "link": "https://stackoverflow.com/questions/37166799/concatenate-alternating-fixed-column-headers-and-row-values/37167935#37167935", "title": "Concatenate alternating fixed column headers and row values", "body": "<p>The following UDF will do it:</p>\n\n<pre><code>Function unionText(ttl As Range, rng As Range) As String\nDim i As Long\nIf ttl.Cells.Count &lt;&gt; rng.Cells.Count Or _\n    ttl.Rows.Count &lt;&gt; 1 Or rng.Rows.Count &lt;&gt; 1 Then\n    unionText = CVErr(xlErrValue)\n    Exit Function\nEnd If\n\nFor i = 1 To ttl.Cells.Count\n    unionText = unionText &amp; ttl(i) &amp; \"=\" &amp; rng(i) &amp; \";\"\nNext i\nEnd Function\n</code></pre>\n\n<p>It is called in the sheet like this:</p>\n\n<pre><code>=unionText(before!$A$1:$C$1,before!A2:C2)\n</code></pre>\n\n<p>Then copied down</p>\n\n<p><a href=\"https://i.stack.imgur.com/YYmdW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YYmdW.png\" alt=\"enter image description here\"></a></p>\n\n<p>Mine is obviously on the same sheet but the formula above uses your sheet reference.</p>\n"}], "owner": {"reputation": 164, "user_id": 2075066, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Kva7k.jpg?s=128&g=1", "display_name": "pwlm", "link": "https://stackoverflow.com/users/2075066/pwlm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1013, "favorite_count": 0, "accepted_answer_id": 37167935, "answer_count": 2, "score": 0, "last_activity_date": 1462983068, "creation_date": 1462979585, "last_edit_date": 1531161705, "question_id": 37166799, "link": "https://stackoverflow.com/questions/37166799/concatenate-alternating-fixed-column-headers-and-row-values", "title": "Concatenate alternating fixed column headers and row values", "body": "<p>I have a spreadsheet with fixed column headers and variable row data, I would like to create a simple tool (lets aim for 1 click) that will concatenate the column values and row data entered by the user into an attribute string (with '=' after each header and ';' after each value).</p>\n\n<p>Before looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/D8813.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/D8813.jpg\" alt=\"Before\"></a></p>\n\n<p>After looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/NOIbZ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NOIbZ.jpg\" alt=\"After\"></a></p>\n\n<p>The output is required in a separate worksheet and if possible saved as a value.\nThe number of columns could vary so a solution that uses a defined table would be useful.</p>\n\n<p>Formula used: </p>\n\n<p><code>=CONCATENATE(before!$A$1,\"=\",before!$A2,\";\",before!$B$1,\"=\",before!$B2,\";\",before!$C$1,\"=\",before!$C2,\";\")</code></p>\n\n<p>Any assistance would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1743, "user_id": 3629691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RkvSZ.jpg?s=128&g=1", "display_name": "CodeJockey", "link": "https://stackoverflow.com/users/3629691/codejockey"}, "edited": false, "score": 0, "creation_date": 1462981376, "post_id": 37166665, "comment_id": 61869961, "body": "So it bugs on <code>Selection.Copy</code>?  What is the error message that is returned?"}], "answers": [{"comments": [{"owner": {"reputation": 381, "user_id": 5804831, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IXuOh.jpg?s=128&g=1", "display_name": "Schadrack Rurangwa", "link": "https://stackoverflow.com/users/5804831/schadrack-rurangwa"}, "edited": false, "score": 0, "creation_date": 1463040568, "post_id": 37167635, "comment_id": 61895238, "body": "Thank you so much."}], "tags": [], "owner": {"reputation": 192, "user_id": 1666422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c2JIV.jpg?s=128&g=1", "display_name": "Kellsens", "link": "https://stackoverflow.com/users/1666422/kellsens"}, "is_accepted": false, "score": 1, "last_activity_date": 1462981854, "creation_date": 1462981854, "answer_id": 37167635, "question_id": 37166665, "link": "https://stackoverflow.com/questions/37166665/how-to-select-and-copy-first-and-last-rows-of-excel-in-vba/37167635#37167635", "title": "How to select and copy first and last rows of excel in vba?", "body": "<p>When you create your new workbook, there's no activesheet to paste, that's the error cause. You could instantiate your new workbook to the declared variable Wb.\nConsidering that your data starts in \"B1\" and considering that your new worksheet will have 4 rows, I made some modifications to your code:</p>\n\n<pre><code>Sub SaveLastLine()\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim filename As String\n    Dim lastCol As Integer\n    Dim lastRow As Integer\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n    Set ws = ActiveSheet ' Here I instantiate the active worksheet\n    Set wb = Workbooks.Add ' Here I instantiate the new workbook\n\n    lastCol = ws.Range(\"B1\").End(xlToRight).Column\n    lastRow = ws.Range(\"B1\").End(xlDown).Row\n\n    ws.Range(ws.Cells(1, 2), ws.Cells(3, lastCol)).Copy wb.Worksheets(1).Range(\"B1\") ' Here I copy the first 3 rows and paste in the first worksheet of your new workbook\n    ws.Range(ws.Cells(lastRow, 2), ws.Cells(lastRow, lastCol)).Copy wb.Worksheets(1).Range(\"B4\") ' Here I copy the last row and paste\n\n    filename = \"yourfilename.xlsx\"\n    wb.SaveAs filename\n\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 381, "user_id": 5804831, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IXuOh.jpg?s=128&g=1", "display_name": "Schadrack Rurangwa", "link": "https://stackoverflow.com/users/5804831/schadrack-rurangwa"}, "edited": false, "score": 0, "creation_date": 1463054846, "post_id": 37169504, "comment_id": 61905481, "body": "Hi Karl, your codes give an error to the line of copy if any cell of first or last row is empty. How can I solve that error?."}, {"owner": {"reputation": 1293, "user_id": 2665195, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8rUmZ.png?s=128&g=1", "display_name": "Instant Breakfast", "link": "https://stackoverflow.com/users/2665195/instant-breakfast"}, "reply_to_user": {"reputation": 381, "user_id": 5804831, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IXuOh.jpg?s=128&g=1", "display_name": "Schadrack Rurangwa", "link": "https://stackoverflow.com/users/5804831/schadrack-rurangwa"}, "edited": false, "score": 0, "creation_date": 1463171133, "post_id": 37169504, "comment_id": 61968582, "body": "@SchadrackRurangwa - Yes, blank cells can cause all kinds of problems in a spreadsheet.  The simplest way to fix the problem is to ensure there are no empty cells the used range. If you cannot do that, for some reason, you will need to force the ranges in your Union to be the same width before you copy them."}], "tags": [], "owner": {"reputation": 1293, "user_id": 2665195, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8rUmZ.png?s=128&g=1", "display_name": "Instant Breakfast", "link": "https://stackoverflow.com/users/2665195/instant-breakfast"}, "is_accepted": true, "score": 2, "last_activity_date": 1462988401, "last_edit_date": 1462988401, "creation_date": 1462987665, "answer_id": 37169504, "question_id": 37166665, "link": "https://stackoverflow.com/questions/37166665/how-to-select-and-copy-first-and-last-rows-of-excel-in-vba/37169504#37169504", "title": "How to select and copy first and last rows of excel in vba?", "body": "<p>Working with selected ranges is probably your problem. Kellsens has given you a solution that works around this by first copying the first three rows, then copying the last row to the new worksheet.</p>\n\n<p>If you want to do this all in one shot, you can first define the range, then copy the content of that range to the new workbook. Something like this:</p>\n\n<pre><code>Sub SaveLastLine()\n\n    Dim WB As Workbook\n    Dim myRange As Range\n\n    'copy the content\n        Set myRange = Union(Range(Range(\"B1:B3\"), Range(\"B1:B3\").End(xlToRight)), _\n                            Range(Range(\"B1\").End(xlDown), Range(\"B1\").End(xlDown).End(xlToRight)))\n        myRange.Copy\n\n    'paste the content\n        Set WB = Workbooks.Add\n        WB.ActiveSheet.Range(\"A1\").PasteSpecial\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 381, "user_id": 5804831, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IXuOh.jpg?s=128&g=1", "display_name": "Schadrack Rurangwa", "link": "https://stackoverflow.com/users/5804831/schadrack-rurangwa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1811, "favorite_count": 0, "accepted_answer_id": 37169504, "answer_count": 2, "score": 0, "last_activity_date": 1462988401, "creation_date": 1462979237, "last_edit_date": 1531164843, "question_id": 37166665, "link": "https://stackoverflow.com/questions/37166665/how-to-select-and-copy-first-and-last-rows-of-excel-in-vba", "title": "How to select and copy first and last rows of excel in vba?", "body": "<p>I want to select and copy the first 3 rows and the last row in an Excel worksheet but in my code below the line <code>Selection.Copy</code> gives an error.</p>\n\n<pre><code>Sub SaveLastLine()\n    Dim WB As Workbook, filename As String\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n    Range(\"B1\").Select\n    Selection.End(xlDown).Select\n    Union(Range(\"1:3\"), Range(Selection, Selection.End(xlToRight))).Select\n\n    Selection.Copy\n    Workbooks.Add\n    ActiveSheet.Paste\nEnd Sub\n</code></pre>\n\n<p>Please anyone can help me.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1462979302, "post_id": 37166426, "comment_id": 61868473, "body": "A UDF is a macro of sorts. What are you trying to do? Can you expand more please, and see <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask</a>"}, {"owner": {"reputation": 21, "user_id": 6312436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87016d78fc214dfb2540cf658dbf0b4d?s=128&d=identicon&r=PG&f=1", "display_name": "F.Fun", "link": "https://stackoverflow.com/users/6312436/f-fun"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1462979755, "post_id": 37166426, "comment_id": 61868836, "body": "I have many workbooks with costs information (one WB for each year), like: maintenance costs (meta data about the maintenance), I want to make a report workbook that uses a from/to date and update the report. Two years ago I tryed something like this and failed. Is it possible to do it with UDF? Or just by macros??"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1462980275, "post_id": 37166426, "comment_id": 61869230, "body": "So basically, you want to access a closed workbook, and work with that closed workbook&#39;s data?"}, {"owner": {"reputation": 21, "user_id": 6312436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87016d78fc214dfb2540cf658dbf0b4d?s=128&d=identicon&r=PG&f=1", "display_name": "F.Fun", "link": "https://stackoverflow.com/users/6312436/f-fun"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1462980873, "post_id": 37166426, "comment_id": 61869639, "body": "Thats the idea.. I will iterate thru the workbooks and fetch the required data. Im on the verge of converting the data to a database, but workbooks are more accessible for my coworkers."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1462984291, "post_id": 37166426, "comment_id": 61871902, "body": "What have you tried? You should be able to loop through a directory, using each Excel file in there."}], "answers": [{"tags": [], "owner": {"reputation": 531, "user_id": 1946796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vd55i.jpg?s=128&g=1", "display_name": "Rafa Barragan", "link": "https://stackoverflow.com/users/1946796/rafa-barragan"}, "is_accepted": true, "score": 0, "last_activity_date": 1462980274, "creation_date": 1462980274, "answer_id": 37167050, "question_id": 37166426, "link": "https://stackoverflow.com/questions/37166426/excel-vba-read-cell-data-from-another-workbook-from-function/37167050#37167050", "title": "Excel VBA - read cell data from another workbook from function", "body": "<p>Yes, try to reference that <code>Workbook</code> like this</p>\n\n<pre><code>Function Plus5(Wkb as Workbook, sSheet as String, sRef as String) as Double\n'' I'm guessing that is number the data you want\n'' Wkb = Workbooks object, sSheet = Sheet Name; sRef = Cell Reference\n\nDim Wks as Worksheet\nSet Wks = Wkb.Worksheets(sSheet)\n\nPlus5 = Wks.Range(sRef) + 5\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6312436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87016d78fc214dfb2540cf658dbf0b4d?s=128&d=identicon&r=PG&f=1", "display_name": "F.Fun", "link": "https://stackoverflow.com/users/6312436/f-fun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 929, "favorite_count": 0, "accepted_answer_id": 37167050, "answer_count": 1, "score": -1, "last_activity_date": 1462980274, "creation_date": 1462978704, "question_id": 37166426, "link": "https://stackoverflow.com/questions/37166426/excel-vba-read-cell-data-from-another-workbook-from-function", "title": "Excel VBA - read cell data from another workbook from function", "body": "<p>Is there a way to read data from another workbook in a user defined function (Not macro) in excel VBA??</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8095, "user_id": 250725, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/T5rng.jpg?s=128&g=1", "display_name": "psubsee2003", "link": "https://stackoverflow.com/users/250725/psubsee2003"}, "edited": false, "score": 0, "creation_date": 1462977645, "post_id": 37165918, "comment_id": 61867268, "body": "When you say &quot;aren&#39;t blank&quot; please clarify what you mean.  If there are blanks within the (n x m) table, should they be selected?  Are you just looking for the last column and last row with data?  And does the table always start in Cell A1?"}, {"owner": {"reputation": 535, "user_id": 3771876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/800fb3c9b0aa3c18dfd71912b21deb52?s=128&d=identicon&r=PG&f=1", "display_name": "lauw", "link": "https://stackoverflow.com/users/3771876/lauw"}, "edited": false, "score": 0, "creation_date": 1462977742, "post_id": 37165918, "comment_id": 61867347, "body": "this is what google showed me on the first hit <a href=\"http://www.mrexcel.com/forum/excel-questions/353392-visual-basic-applications-select-only-cells-value.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a> the last answer on page 1 seems to be what you want"}, {"owner": {"reputation": 89, "user_id": 2212428, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d7f089c551464d15e66d477a7676992b?s=128&d=identicon&r=PG", "display_name": "Apparently Im user2212428", "link": "https://stackoverflow.com/users/2212428/apparently-im-user2212428"}, "reply_to_user": {"reputation": 8095, "user_id": 250725, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/T5rng.jpg?s=128&g=1", "display_name": "psubsee2003", "link": "https://stackoverflow.com/users/250725/psubsee2003"}, "edited": false, "score": 0, "creation_date": 1462977788, "post_id": 37165918, "comment_id": 61867387, "body": "@psubsee2003 I am looking to select Range A1:-B5, so the whole table. Even if some fields are blank"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 2212428, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d7f089c551464d15e66d477a7676992b?s=128&d=identicon&r=PG", "display_name": "Apparently Im user2212428", "link": "https://stackoverflow.com/users/2212428/apparently-im-user2212428"}, "edited": false, "score": 0, "creation_date": 1462985698, "post_id": 37166416, "comment_id": 61872701, "body": "I guess I worded my question poorly. I have a table in a empty spreadsheet and I want to put the table in a 2D array. If the table is 1000 rows I can&#39;t use this code"}, {"owner": {"reputation": 89, "user_id": 2212428, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d7f089c551464d15e66d477a7676992b?s=128&d=identicon&r=PG", "display_name": "Apparently Im user2212428", "link": "https://stackoverflow.com/users/2212428/apparently-im-user2212428"}, "edited": false, "score": 0, "creation_date": 1462986343, "post_id": 37166416, "comment_id": 61873060, "body": "Suppose I wanted the data range to copy or pivot the table. How would I know here if the table ends at myTable(4,5) or myTable(400,500)?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 89, "user_id": 2212428, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d7f089c551464d15e66d477a7676992b?s=128&d=identicon&r=PG", "display_name": "Apparently Im user2212428", "link": "https://stackoverflow.com/users/2212428/apparently-im-user2212428"}, "edited": false, "score": 0, "creation_date": 1462986611, "post_id": 37166416, "comment_id": 61873228, "body": "You use the <code>UBound()</code> method :)"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 1, "last_activity_date": 1462981750, "last_edit_date": 1462981750, "creation_date": 1462978683, "answer_id": 37166416, "question_id": 37165918, "link": "https://stackoverflow.com/questions/37165918/excel-vba-range-select-all-rows-and-columns-that-arent-blank/37166416#37166416", "title": "Excel VBA - Range select all rows and columns that aren&#39;t blank", "body": "<p>You can create a 2D array from the range:</p>\n\n<pre><code>Sub SelectAll()\n\n    Dim myTable As Variant\n\n    myTable = Range(\"A1\").CurrentRegion.Value\n\n    '// myTable is now a 2D-Array that you can work with\n    '// by using row/column indeces like so:\n\n    Debug.Print myTable(1, 1) '// A1 value\n    Debug.Print myTable(2, 1) '// A2 value\n    Debug.Print myTable(3, 1) '// A3 value\n\n    Debug.Print myTable(1, 2) '// B1 value\n    Debug.Print myTable(2, 2) '// B2 value\n    Debug.Print myTable(3, 2) '// B3 value\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 2212428, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d7f089c551464d15e66d477a7676992b?s=128&d=identicon&r=PG", "display_name": "Apparently Im user2212428", "link": "https://stackoverflow.com/users/2212428/apparently-im-user2212428"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 677, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462981750, "creation_date": 1462977436, "last_edit_date": 1531164843, "question_id": 37165918, "link": "https://stackoverflow.com/questions/37165918/excel-vba-range-select-all-rows-and-columns-that-arent-blank", "title": "Excel VBA - Range select all rows and columns that aren&#39;t blank", "body": "<p>Given a table (n x m) how can I select everything in VBA?</p>\n\n<p>Note I may want to store everything in a variable so by select I don't mean highlight but grab everything. The picture is just an example of what data I want</p>\n\n<p><a href=\"https://i.stack.imgur.com/CuuNl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CuuNl.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub SelectAll()\n\nActiveWorkbook.Sheets(\"instance\").Select\n\n\nActiveCell.CurrentRegion.Select\n\nEnd Sub\n</code></pre>\n\n<p>I apologize if this question was asked before, I couldn't find on this site a solution so a moderator can close this question or link a answered solution.</p>\n"}, {"tags": ["vba", "excel", "basic"], "comments": [{"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1462977564, "post_id": 37165902, "comment_id": 61867214, "body": "You have explained what the code does, can you explain what it is you want it to do. An example of the desired outcome would be helpful also."}, {"owner": {"reputation": 29, "user_id": 6320923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/491e7b32adf0afab2b472bfb81790761?s=128&d=identicon&r=PG&f=1", "display_name": "Visa", "link": "https://stackoverflow.com/users/6320923/visa"}, "reply_to_user": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1462978435, "post_id": 37165902, "comment_id": 61867849, "body": "@tim:  What i want to is copy column 3 from Sheet 1 paste in column 2 of sheet 2, copy column 14 from sheet 1 and paste in column 4 of sheet 2 ..etc. And i want to do the same without copying the headers from both sheets. Finally when i run the macro, i want data to be copied from sheet 1 to sheet 2, WITHOUT headers and in a DIFFERENT region. Hope this helps"}, {"owner": {"reputation": 29, "user_id": 6320923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/491e7b32adf0afab2b472bfb81790761?s=128&d=identicon&r=PG&f=1", "display_name": "Visa", "link": "https://stackoverflow.com/users/6320923/visa"}, "reply_to_user": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 1, "creation_date": 1462979446, "post_id": 37165902, "comment_id": 61868577, "body": "@TimWilkinson i have edited the question and added details too"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 6320923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/491e7b32adf0afab2b472bfb81790761?s=128&d=identicon&r=PG&f=1", "display_name": "Visa", "link": "https://stackoverflow.com/users/6320923/visa"}, "edited": false, "score": 0, "creation_date": 1462979953, "post_id": 37166758, "comment_id": 61869006, "body": "This is still giving me Run time error 1004 -Application defined or object defined error.."}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "reply_to_user": {"reputation": 29, "user_id": 6320923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/491e7b32adf0afab2b472bfb81790761?s=128&d=identicon&r=PG&f=1", "display_name": "Visa", "link": "https://stackoverflow.com/users/6320923/visa"}, "edited": false, "score": 0, "creation_date": 1462980205, "post_id": 37166758, "comment_id": 61869173, "body": "I just commented out the last two lines out of curiosity can you try with the new code and see if it still happens?"}, {"owner": {"reputation": 29, "user_id": 6320923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/491e7b32adf0afab2b472bfb81790761?s=128&d=identicon&r=PG&f=1", "display_name": "Visa", "link": "https://stackoverflow.com/users/6320923/visa"}, "edited": false, "score": 0, "creation_date": 1462980352, "post_id": 37166758, "comment_id": 61869277, "body": "Its working.. :) Thanks a lot.. But am curious to know how."}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "reply_to_user": {"reputation": 29, "user_id": 6320923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/491e7b32adf0afab2b472bfb81790761?s=128&d=identicon&r=PG&f=1", "display_name": "Visa", "link": "https://stackoverflow.com/users/6320923/visa"}, "edited": false, "score": 0, "creation_date": 1462980472, "post_id": 37166758, "comment_id": 61869359, "body": "I noticed it was happening a few times on mine for just the very last &quot;Range(&quot;A1&quot;).Select&quot; and I have to be honest I have no idea! If this answer is working please don&#39;t forget to mark as accepted."}], "tags": [], "owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "is_accepted": true, "score": 1, "last_activity_date": 1462980182, "last_edit_date": 1462980182, "creation_date": 1462979497, "answer_id": 37166758, "question_id": 37165902, "link": "https://stackoverflow.com/questions/37165902/how-to-copy-specific-columns-from-one-sheet-and-paste-in-another-sheet-in-a-diff/37166758#37166758", "title": "How to copy specific columns from one sheet and paste in another sheet in a different range?", "body": "<p>Try this, always better to avoid copy and paste.</p>\n\n<pre><code>Sub copypaste()\nDim lastrow As Integer, erow As Integer, sheet1 As Worksheet, sheet2 As Worksheet\n\nSet sheet1 = Worksheets(\"Sheet1\")\nSet sheet2 = Worksheets(\"Sheet2\")\nlastrow = sheet1.Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = 2 To lastrow\n    erow = sheet2.Cells(Rows.Count, 2).End(xlUp).Offset(1, 0).Row\n    sheet2.Cells(erow, 2) = sheet1.Cells(i, 3)\n    sheet2.Cells(erow, 3) = sheet1.Cells(i, 6)\n    sheet2.Cells(erow, 4) = sheet1.Cells(i, 14)\nNext i\n\n'ThisWorkbook.Worksheets(\"Sheet2\").Columns().AutoFit\n'sheet1.Cells(1, 1).Activate\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 6320923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/491e7b32adf0afab2b472bfb81790761?s=128&d=identicon&r=PG&f=1", "display_name": "Visa", "link": "https://stackoverflow.com/users/6320923/visa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17070, "favorite_count": 0, "accepted_answer_id": 37166758, "answer_count": 1, "score": 1, "last_activity_date": 1462980182, "creation_date": 1462977400, "last_edit_date": 1462979412, "question_id": 37165902, "link": "https://stackoverflow.com/questions/37165902/how-to-copy-specific-columns-from-one-sheet-and-paste-in-another-sheet-in-a-diff", "title": "How to copy specific columns from one sheet and paste in another sheet in a different range?", "body": "<p>I am a beginner and I have this code below, but this just copies the last row from sheet and pastes into sheet 2 range. Basically the empty row is not getting updated. And also throws run time error 1004 - Application defined or object defined error. Any help would be much appreciated.</p>\n\n<pre><code>Sub copypaste()\nDim lastrow As Long, erow As Long\n\nlastrow = ThisWorkbook.Worksheets(\"sheet1\").Cells(Rows.Count, 1).End(xlUp).Row\nFor i = 2 To lastrow\n\nSheet1.Cells(i, 3).Copy\nerow = ThisWorkbook.Worksheets(\"sheet2\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\nSheet1.Paste Destination:=Worksheets(\"Sheet2\").Cells(erow, 2)\nSheet1.Cells(i, 14).Copy\nSheet1.Paste Destination:=Worksheets(\"Sheet2\").Cells(erow, 4)\nSheet1.Cells(i, 6).Copy\nSheet1.Paste Destination:=Worksheets(\"Sheet2\").Cells(erow, 3)\n\nNext i\n\nApplication.CutCopyMode = False\nThisWorkbook.Worksheets(\"sheet2\").Columns().AutoFit\nRange(\"A1\").Select\n\nEnd Sub\n</code></pre>\n\n<p>Lets say this is sheet 1\n<a href=\"http://i.stack.imgur.com/PZRUM.png\" rel=\"nofollow\"> sheet 1</a></p>\n\n<p>and this is sheet2:\n<a href=\"http://i.stack.imgur.com/kV3F4.png\" rel=\"nofollow\">sheet2:</a></p>\n\n<p>Where the headers are slightly different in naming and there's also a position change. And the last row in sheet 1 is varied.</p>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 688, "user_id": 5726827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f9bea4b67d779a3ecc212123b1d0256?s=128&d=identicon&r=PG&f=1", "display_name": "David Glickman", "link": "https://stackoverflow.com/users/5726827/david-glickman"}, "edited": false, "score": 0, "creation_date": 1462977530, "post_id": 37165835, "comment_id": 61867192, "body": "What is your question? What are you trying to do, what have you done, what has happened?"}, {"owner": {"reputation": 1, "user_id": 6200332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50f45c1e33118a0f6bb2b871c061c426?s=128&d=identicon&r=PG&f=1", "display_name": "Newbee", "link": "https://stackoverflow.com/users/6200332/newbee"}, "reply_to_user": {"reputation": 688, "user_id": 5726827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f9bea4b67d779a3ecc212123b1d0256?s=128&d=identicon&r=PG&f=1", "display_name": "David Glickman", "link": "https://stackoverflow.com/users/5726827/david-glickman"}, "edited": false, "score": 0, "creation_date": 1462979549, "post_id": 37165835, "comment_id": 61868662, "body": "Match 2 columns from 2 different sheets and extract specific data into sheet 1. Above code matches 1 column."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462983941, "post_id": 37165835, "comment_id": 61871675, "body": "You should be able to do this via <code>sumproduct</code> as demonstrated by @scottcraner <a href=\"http://stackoverflow.com/questions/37125502/if-cell-in-column-partially-contains-text-in-another-column/37125607#37125607\">yesterday</a>."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1462984141, "post_id": 37165835, "comment_id": 61871799, "body": "@findwindow I would use INDEX/MATCH in this case because some of the returned is text.  Also I would only use formula if the datasets are relatively small; &lt;1000, or the fact that this would require an array formula it would bog down the calc times."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1462984362, "post_id": 37165835, "comment_id": 61871943, "body": "Just kidding. Ignore me XD"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6200332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50f45c1e33118a0f6bb2b871c061c426?s=128&d=identicon&r=PG&f=1", "display_name": "Newbee", "link": "https://stackoverflow.com/users/6200332/newbee"}, "edited": false, "score": 0, "creation_date": 1462991602, "post_id": 37169600, "comment_id": 61876181, "body": "It worked thanks....How do i fill in data back into Contact sheet if any data missing( ex. phone number missing) and i enter it manually and has to be filled into main contact sheet. And if no match of first and last name new record to be inserted into contact sheet"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 1, "user_id": 6200332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50f45c1e33118a0f6bb2b871c061c426?s=128&d=identicon&r=PG&f=1", "display_name": "Newbee", "link": "https://stackoverflow.com/users/6200332/newbee"}, "edited": false, "score": 0, "creation_date": 1462991768, "post_id": 37169600, "comment_id": 61876262, "body": "You would need another sub that does what this one does but backwards.  that is a new question and try it on your own before simply asking a new question.  As this answered your current question please mark as correct by clicking the check mark by the answer."}, {"owner": {"reputation": 1, "user_id": 6200332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50f45c1e33118a0f6bb2b871c061c426?s=128&d=identicon&r=PG&f=1", "display_name": "Newbee", "link": "https://stackoverflow.com/users/6200332/newbee"}, "edited": false, "score": 0, "creation_date": 1462992976, "post_id": 37169600, "comment_id": 61876964, "body": "Sure..Will open new sub..Tried and gauging internet to reverse it. One more query for same thread, How do i make change In 4.mobile sheet to start from row 18 and ignore any matched names above row 18."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1462987893, "creation_date": 1462987893, "answer_id": 37169600, "question_id": 37165835, "link": "https://stackoverflow.com/questions/37165835/match-2-columns-first-and-last-names-on-two-excel-worksheet-and-copy-data/37169600#37169600", "title": "Match 2 columns (First and last names) on two excel worksheet and copy data", "body": "<p>If I understand all you need to do is add an <code>And</code> in your If:</p>\n\n<pre><code>Sub CopyBasedonSheet1()\n\nDim i As Long\nDim j As Long\nSheet4LastRow = Worksheets(\"4. Mobile\").Range(\"D\" &amp; Rows.Count).End(xlUp).Row\nsheet7LastRow = Worksheets(\"Contacts\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    For j = 1 To Sheet4LastRow\n        For i = 1 To sheet7LastRow\n            If Worksheets(\"4. Mobile\").Cells(j, 4).Value = Worksheets(\"Contacts\").Cells(i, 1).Value _\n                And Worksheets(\"4. Mobile\").Cells(j, 5).Value = Worksheets(\"Contacts\").Cells(i, 2).Value Then\n                Worksheets(\"4. Mobile\").Cells(j, 1).Value = Worksheets(\"Contacts\").Cells(i, 3).Value\n                Worksheets(\"4. Mobile\").Cells(j, 3).Value = Worksheets(\"Contacts\").Cells(i, 4).Value\n                Worksheets(\"4. Mobile\").Cells(j, 6).Value = Worksheets(\"Contacts\").Cells(i, 5).Value\n                Worksheets(\"4. Mobile\").Cells(j, 7).Value = Worksheets(\"Contacts\").Cells(i, 6).Value\n                Worksheets(\"4. Mobile\").Cells(j, 8).Value = Worksheets(\"Contacts\").Cells(i, 7).Value\n\n            Else\n            End If\n    Next i\nNext j\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6200332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50f45c1e33118a0f6bb2b871c061c426?s=128&d=identicon&r=PG&f=1", "display_name": "Newbee", "link": "https://stackoverflow.com/users/6200332/newbee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 600, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1462987893, "creation_date": 1462977258, "last_edit_date": 1531161705, "question_id": 37165835, "link": "https://stackoverflow.com/questions/37165835/match-2-columns-first-and-last-names-on-two-excel-worksheet-and-copy-data", "title": "Match 2 columns (First and last names) on two excel worksheet and copy data", "body": "<p>I searched stack overflow for similar question and here is the code that i found (modified slightly) and below code matches 1 column.</p>\n\n<p>Require to match 2 columns( first and last name) in both sheets instead of 1 column first name and in 4.mobile sheet to start from row 18 and ignore any matched names above row 18</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ogiw9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ogiw9.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/bs4HQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bs4HQ.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub CopyBasedonSheet1()\n\nDim i As Long\nDim j As Long\nSheet4LastRow = Worksheets(\"4. Mobile\").Range(\"D\" &amp; Rows.Count).End(xlUp).Row\nsheet7LastRow = Worksheets(\"Contacts\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    For j = 1 To Sheet4LastRow\n        For i = 1 To sheet7LastRow\n            If Worksheets(\"4. Mobile\").Cells(j, 4).Value = Worksheets(\"Contacts\").Cells(i, 1).Value Then\n                Worksheets(\"4. Mobile\").Cells(j, 1).Value = Worksheets(\"Contacts\").Cells(i, 3).Value\n                Worksheets(\"4. Mobile\").Cells(j, 3).Value = Worksheets(\"Contacts\").Cells(i, 4).Value\n                Worksheets(\"4. Mobile\").Cells(j, 6).Value = Worksheets(\"Contacts\").Cells(i, 5).Value\n                Worksheets(\"4. Mobile\").Cells(j, 7).Value = Worksheets(\"Contacts\").Cells(i, 6).Value\n                Worksheets(\"4. Mobile\").Cells(j, 8).Value = Worksheets(\"Contacts\").Cells(i, 7).Value\n\n            Else\n            End If\n    Next i\nNext j\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "worksheet-function", "worksheet", "vba"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1462977612, "post_id": 37165642, "comment_id": 61867248, "body": "You could add another column to your data using the <code>AVERAGEIF</code> function and then also use an average on the field in the pivot table"}, {"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 0, "creation_date": 1462978950, "post_id": 37165642, "comment_id": 61868216, "body": "I would have to do it by adding an extra column to the original data using COUNTIF to count how many times a supervisor&#39;s name was repeated"}, {"owner": {"reputation": 43, "user_id": 6320750, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/bc546db4533a133f87c7130f6c14961e?s=128&d=identicon&r=PG&f=1", "display_name": "Kenny T.", "link": "https://stackoverflow.com/users/6320750/kenny-t"}, "edited": false, "score": 0, "creation_date": 1462982071, "post_id": 37165642, "comment_id": 61870470, "body": "Hi guys, it is important that this needs to be in a pivot table format just because i need to see the whole span of control of each supervisor. and each supervisor has a different grade level and I need to find the average of grade level 10, 11, etc.  I want to know how can I manipulate the pivot table to calculate how many employees on average are per supervisor. But I can&#39;t get the pivot table to count employees and divide it with how many unique supervisors there is. I hope this makes sense."}, {"owner": {"reputation": 43, "user_id": 6320750, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/bc546db4533a133f87c7130f6c14961e?s=128&d=identicon&r=PG&f=1", "display_name": "Kenny T.", "link": "https://stackoverflow.com/users/6320750/kenny-t"}, "edited": false, "score": 0, "creation_date": 1462984897, "post_id": 37165642, "comment_id": 61872272, "body": "In an ideal world I wish I could manipulate the pivot table by putting supervisor name in the row field, supervisor grade in columns field, and calculate the average employee in the Value data field. But that seems to be non-achievable because the employee names column are text strings. how can I get this to appear on the pivot table?"}, {"owner": {"reputation": 43, "user_id": 6320750, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/bc546db4533a133f87c7130f6c14961e?s=128&d=identicon&r=PG&f=1", "display_name": "Kenny T.", "link": "https://stackoverflow.com/users/6320750/kenny-t"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1462985699, "post_id": 37165642, "comment_id": 61872704, "body": "@CallumDA33  AVERAGEIF function will not average out words, only number values."}, {"owner": {"reputation": 43, "user_id": 6320750, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/bc546db4533a133f87c7130f6c14961e?s=128&d=identicon&r=PG&f=1", "display_name": "Kenny T.", "link": "https://stackoverflow.com/users/6320750/kenny-t"}, "reply_to_user": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 0, "creation_date": 1462985705, "post_id": 37165642, "comment_id": 61872710, "body": "@Tom Sharpe. Yes COUNTIF will help me find how many times a supervisor repeats itself (which tells me how many employees they are in charge of) but I need a pivot table that will show me the average of every supervisor in the same grade how many employee they have."}], "answers": [{"tags": [], "owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "is_accepted": false, "score": 0, "last_activity_date": 1463156989, "last_edit_date": 1463156989, "creation_date": 1463152209, "answer_id": 37213558, "question_id": 37165642, "link": "https://stackoverflow.com/questions/37165642/calculating-the-average-using-names-on-a-pivot-table/37213558#37213558", "title": "Calculating the average using names on a pivot table", "body": "<p>OK well not very elegant I know but this would do it. Add a helper column which works out the fraction of a supervisor available to each employee (e.g. 2 employees per supervisor = 1/2, 3 employees = 1/3 etc.) starting in D2:-</p>\n\n<pre><code>=1/COUNTIFS($A$2:$A$20,A2,$C$2:$C$20,C2)\n</code></pre>\n\n<p>Then you can put the sum of these and the count of any column into a pivot table, putting Region as the row variable, and simply a manual formula to work out the ratio starting in J2:-</p>\n\n<pre><code>=IFERROR(I2/H2,\"\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Kpac9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Kpac9.png\" alt=\"enter image description here\"></a></p>\n\n<p>Note:- You can use GetPivotData to get the totals from the pivot table if you prefer. You could also use an array formula to list the distinct values of Region and not use a pivot table, but the pivot is quicker.</p>\n"}], "owner": {"reputation": 43, "user_id": 6320750, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/bc546db4533a133f87c7130f6c14961e?s=128&d=identicon&r=PG&f=1", "display_name": "Kenny T.", "link": "https://stackoverflow.com/users/6320750/kenny-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1128, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1463156989, "creation_date": 1462976799, "last_edit_date": 1531161705, "question_id": 37165642, "link": "https://stackoverflow.com/questions/37165642/calculating-the-average-using-names-on-a-pivot-table", "title": "Calculating the average using names on a pivot table", "body": "<p>I'm trying to have the pivot table calculate the average number of employees underneath each supervisor for a specific region. However pivot tables are unable to average out text strings. In the example below, within one region I have 5 supervisors but they all have different numbers of employees under them, some have 1 or 2. But all together there are 7 employees for that region. I need it to average out the number of employees per supervisor: so 7/5 = 1.4 would be the average. Is there any way you can create a count of employee divided by the amount of unique supervisors using a pivot table?</p>\n\n<p><a href=\"http://i.stack.imgur.com/F8Isg.jpg\" rel=\"nofollow\">Number of Supervisor to Employee</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1462976987, "post_id": 37165547, "comment_id": 61866753, "body": "Use the macro recorder or show us what you&#39;ve already tried. This isn&#39;t a code-writing service."}], "answers": [{"tags": [], "owner": {"reputation": 221, "user_id": 2577136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9673316d6150d99a7bd8616d5edc4e9?s=128&d=identicon&r=PG", "display_name": "DHP", "link": "https://stackoverflow.com/users/2577136/dhp"}, "is_accepted": false, "score": 0, "last_activity_date": 1462977019, "creation_date": 1462977019, "answer_id": 37165733, "question_id": 37165547, "link": "https://stackoverflow.com/questions/37165547/if-cell-a1-on-sheet1-contains-x-then-copy-a1-from-sheet2-to-cell-a2-on-sheet-1/37165733#37165733", "title": "If cell A1 on sheet1 contains X then copy A1 from sheet2 to cell A2 on sheet 1", "body": "<p>You could set up a formula in cell A2 on Sheet1 like this:</p>\n\n<pre><code>=IF(ISNUMBER(SEARCH(\"X\", A1)), Sheet2!A1, \"NOT FOUND\")\n</code></pre>\n\n<p>Changing \"X\" to whatever you want your text to be.</p>\n\n<p>SEARCH will look for text \"X\" in cell A1, and ISNUMBER will check if SEARCH returned the index of where the text was found in the cell. If it was not found, it will print \"NOT FOUND\"</p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 6314963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b6c645f9e8d3d68554f912cdfb5d912?s=128&d=identicon&r=PG&f=1", "display_name": "Naumaan", "link": "https://stackoverflow.com/users/6314963/naumaan"}, "edited": false, "score": 0, "creation_date": 1462979778, "post_id": 37165856, "comment_id": 61868858, "body": "Many thanks Ricky for your code as well as it also works but i can only mark 1 as solution so ticked first one to answer :). You have a great day too!"}], "tags": [], "owner": {"reputation": 98, "user_id": 3230453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/COYUq.jpg?s=128&g=1", "display_name": "Ricky", "link": "https://stackoverflow.com/users/3230453/ricky"}, "is_accepted": false, "score": 0, "last_activity_date": 1462977303, "creation_date": 1462977303, "answer_id": 37165856, "question_id": 37165547, "link": "https://stackoverflow.com/questions/37165547/if-cell-a1-on-sheet1-contains-x-then-copy-a1-from-sheet2-to-cell-a2-on-sheet-1/37165856#37165856", "title": "If cell A1 on sheet1 contains X then copy A1 from sheet2 to cell A2 on sheet 1", "body": "<p>If your looking for a macro i am assuming this is what your asking for.</p>\n\n<pre><code>Sub Test\n    IF Sheet1.Range(\"A1\").value = \"X\" then Sheet1.Range(\"A2\").value = Sheet2.Range(\"A1\").value\nEnd sub \n</code></pre>\n\n<p>Have a great day!</p>\n"}, {"tags": [], "owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "is_accepted": true, "score": 1, "last_activity_date": 1462977431, "creation_date": 1462977431, "answer_id": 37165915, "question_id": 37165547, "link": "https://stackoverflow.com/questions/37165547/if-cell-a1-on-sheet1-contains-x-then-copy-a1-from-sheet2-to-cell-a2-on-sheet-1/37165915#37165915", "title": "If cell A1 on sheet1 contains X then copy A1 from sheet2 to cell A2 on sheet 1", "body": "<p>This does exactly as the question asks.</p>\n\n<pre><code>Sub copyStuff()\n\nIf Sheets(\"Sheet1\").Range(\"A1\") = \"X\" Then\nSheets(\"Sheet1\").Range(\"A2\") = Sheets(\"Sheet2\").Range(\"A1\")\nEnd If\nMsgBox \"Next time I will provide an example\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 6314963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b6c645f9e8d3d68554f912cdfb5d912?s=128&d=identicon&r=PG&f=1", "display_name": "Naumaan", "link": "https://stackoverflow.com/users/6314963/naumaan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1121, "favorite_count": 0, "accepted_answer_id": 37165915, "answer_count": 3, "score": 0, "last_activity_date": 1506662679, "creation_date": 1462976605, "question_id": 37165547, "link": "https://stackoverflow.com/questions/37165547/if-cell-a1-on-sheet1-contains-x-then-copy-a1-from-sheet2-to-cell-a2-on-sheet-1", "title": "If cell A1 on sheet1 contains X then copy A1 from sheet2 to cell A2 on sheet 1", "body": "<p>Think this should be straight forward for everyone. So as the title says, i would like to know the easiest way to achieve below :</p>\n\n<p>If cell A1 on sheet1 contains X then copy A1 from sheet2 to cell A2 on sheet 1</p>\n\n<p>many thanks!</p>\n"}, {"tags": ["excel", "vba", "date"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 4, "creation_date": 1462976385, "post_id": 37165410, "comment_id": 61866305, "body": "Welcome to StackOverflow. Please note, that this is not a free code-writing service. Yet, we are eager to help fellow programmers (and aspirants) with <b>their</b> code. Please read the help topics on <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I Ask a Good Question</a>. You might also want to <a href=\"http://stackoverflow.com/tour\">take the tour</a> and earn a badge while doing so. Afterwards, please update your question with the VBA code you have written thus far in order to complete the task(s) you wish to achieve."}], "answers": [{"tags": [], "owner": {"reputation": 1450, "user_id": 5429138, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/iXacd.jpg?s=128&g=1", "display_name": "Carlo", "link": "https://stackoverflow.com/users/5429138/carlo"}, "is_accepted": false, "score": 0, "last_activity_date": 1462981501, "creation_date": 1462981501, "answer_id": 37167473, "question_id": 37165410, "link": "https://stackoverflow.com/questions/37165410/excel-vba-update-date-to-1-hour-when-between-2-dates/37167473#37167473", "title": "Excel VBA &gt; update date to +1 hour when between 2 dates", "body": "<p>If I correctly understood your request you don't need a VBA function for this. You can do it just formulas.</p>\n\n<p>Here's the formula to write and related excel sheet (in the picture the formula is different because I'm using Excel in Italian language):</p>\n\n<pre><code>=IF(AND($A$2&lt;D7;D7&lt;$B$2);D7+1/24;D7)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/w7Ak4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w7Ak4.png\" alt=\"excel sheet with formula\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 6320863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2512fe981e11a8eba6ce91ef60b1b4f?s=128&d=identicon&r=PG&f=1", "display_name": "james e", "link": "https://stackoverflow.com/users/6320863/james-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1462981501, "creation_date": 1462976268, "question_id": 37165410, "link": "https://stackoverflow.com/questions/37165410/excel-vba-update-date-to-1-hour-when-between-2-dates", "title": "Excel VBA &gt; update date to +1 hour when between 2 dates", "body": "<p>I have 2 columns on dates, lets say A1:A100 &amp; B2:B200 that may fall in between 2 dates ( in this case its the British Summer time range )</p>\n\n<p>Can you help with a sub to update the range of cells with an extra hour if they fall between those 2 dates)</p>\n\n<p>thanks\nJames</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "edited": false, "score": 4, "creation_date": 1462975899, "post_id": 37164938, "comment_id": 61865948, "body": "<a href=\"http://access.mvps.org/access/forms/frm0031.htm\" rel=\"nofollow noreferrer\">access.mvps.org/access/forms/frm0031.htm</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "is_accepted": false, "score": 0, "last_activity_date": 1462976148, "creation_date": 1462976148, "answer_id": 37165362, "question_id": 37164938, "link": "https://stackoverflow.com/questions/37164938/changing-main-form-button-visibility-from-the-subform/37165362#37165362", "title": "Changing main form button visibility from the subform", "body": "<p>Assuming <code>Me</code> is the sub form, and <code>Or\u00e7amentos</code> is the main form:</p>\n\n<pre><code>If Me.Produto = \"\" Then\n    Me.Parent!Comando33.Visible = False\n    Me.Parent!Comando47.Visible = False\n    Me.Descri\u00e7\u00e3o.Visible = False\nEnd If\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6311523"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462992401, "creation_date": 1462975149, "last_edit_date": 1462992401, "question_id": 37164938, "link": "https://stackoverflow.com/questions/37164938/changing-main-form-button-visibility-from-the-subform", "title": "Changing main form button visibility from the subform", "body": "<p>I've been trying to make a button disappear when a new insert is made and one of the fields is empty, problem is the field is on a subform (data sheet view) and the button on the main form I've been trying the following code with no success.</p>\n\n<pre><code>If Me.Produto = \"\" Then\n        [Or\u00e7amentos]!Comando33.Visible = False\n        [Or\u00e7amentos]!Comando47.Visible = False\n        Me.Descri\u00e7\u00e3o.Visible = False\n End If\n</code></pre>\n\n<p>Any advice?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1300, "user_id": 3005534, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/giBVn.jpg?s=128&g=1", "display_name": "Miguel_Ryu", "link": "https://stackoverflow.com/users/3005534/miguel-ryu"}, "edited": false, "score": 1, "creation_date": 1462979720, "post_id": 37165608, "comment_id": 61868811, "body": "Hi @Macro Man, thanks it helped a lot by pointing me in the right direction, I ended up only needing to add <code>Microsoft InkPicture Control</code> to <code>Tools-&gt;Additional Controls</code> but I wouldn&#39;t have found if it wasn&#39;t for you. I&#39;ll Later update the question with my findings to whoever gets stuck like me"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 3, "last_activity_date": 1462976728, "creation_date": 1462976728, "answer_id": 37165608, "question_id": 37164849, "link": "https://stackoverflow.com/questions/37164849/how-to-add-handwritten-signature-using-excels-ink-tools/37165608#37165608", "title": "How to add handwritten signature using Excel&#39;s Ink Tools?", "body": "<p>Is it the InkEdit Control you're after? </p>\n\n<p>This is one of the standard libraries that you can find in Tools->References</p>\n\n<p><a href=\"https://i.stack.imgur.com/YRNRz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YRNRz.png\" alt=\"References window showing InkEdit library\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1300, "user_id": 3005534, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/giBVn.jpg?s=128&g=1", "display_name": "Miguel_Ryu", "link": "https://stackoverflow.com/users/3005534/miguel-ryu"}, "is_accepted": false, "score": 6, "last_activity_date": 1610837143, "last_edit_date": 1610837143, "creation_date": 1463047199, "answer_id": 37183541, "question_id": 37164849, "link": "https://stackoverflow.com/questions/37164849/how-to-add-handwritten-signature-using-excels-ink-tools/37183541#37183541", "title": "How to add handwritten signature using Excel&#39;s Ink Tools?", "body": "<p>Update:</p>\n<p>After @Macro Man pointed me in the right direction I found some material that helped get the eSignature up and running.</p>\n<p>I've found some material on MSDN <strong><a href=\"https://msdn.microsoft.com/en-us/library/ms812501.aspx\" rel=\"nofollow noreferrer\">Digital Ink Signatures - Concepts and Technologies</a></strong> and <strong><a href=\"https://msdn.microsoft.com/en-us/library/aa514604.aspx\" rel=\"nofollow noreferrer\">InkPicture Class</a></strong> that talk about the Ink collection on VB.net and C# through a PictureBox/Userform , this coupled with the InkEdit Control in another <a href=\"https://stackoverflow.com/questions/23598211/every-character-in-textbox-in-different-color-in-vba-excel\">Stackoverflow response</a> in which I realised that VBAs tool box had a InkPicture Control additional control that could be utilized to collect the handwritten eSignature through User form.</p>\n<p>Please find below step by step:</p>\n<p>In VBAs toolbox on additional control under Tools &gt; Additional Controls there is the InkPicture Control which allows you to create a signature Userform.</p>\n<p><a href=\"https://i.stack.imgur.com/PH3IL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PH3IL.png\" alt=\"enter image description here\" /></a></p>\n<p>Once Added InkPicture can be used as any other control on the toolbox.</p>\n<p><a href=\"https://i.stack.imgur.com/0ugPy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0ugPy.png\" alt=\"enter image description here\" /></a></p>\n<p>Then its a case of initialising the UserForm for the Signature request. I'm using a drawing pad, but other hardware should work as well.</p>\n<p><a href=\"https://i.stack.imgur.com/tQ6v5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tQ6v5.png\" alt=\"enter image description here\" /></a></p>\n<p>And storing or utilising the resultant image at need, in my case saving a temp version in the server to then resize and add to a Word document.</p>\n<hr />\n<p><strong>Edit:</strong></p>\n<p>After answering a similar question in <a href=\"https://stackoverflow.com/questions/48641960/userform-vba-inkpicture-input-into-sheet-specific-cell-as-image-user-signature\">here</a>, on how to use Userform InkPicture to input image signature into a worksheet/specific cell, I thought I'd edit this answer for those interested.</p>\n<p>The below code will allow you to, open the userform so the user can sign the ink field, save the image temperately, add the InkPicture to your worksheet and kill the temp image.</p>\n<p>Set up your UserForm (mine is set up like this, with a couple extra options) the UserForm is named <code>Signature_pad</code>, the essential option you need is <code>Private Sub Use_Click()</code>.</p>\n<p><a href=\"https://i.stack.imgur.com/ojaCL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ojaCL.png\" alt=\"enter image description here\" /></a></p>\n<p>This is the code inside the Userform:</p>\n<pre><code>Private Sub Use_Click()\n    \n    'dim object type and byte array to save from binary\n    Dim objInk As MSINKAUTLib.InkPicture\n    Dim bytArr() As Byte\n    Dim File1 As String\n    \n    'get temp file path as $user\\Temp\\[file name]\n    FilePath = Environ$(&quot;temp&quot;) &amp; &quot;\\&quot; &amp; &quot;Signature.png&quot;\n    \n    ' set objInk as image/strokes of InkPicture control form object\n    Set objInk = Me.SignPicture\n    \n    'if object is not empty\n    If objInk.Ink.Strokes.Count &gt; 0 Then\n        'get bytes from object save\n        bytArr = objInk.Ink.Save(2)\n        'create file for output\n        Open FilePath For Binary As #1\n        'output/write bytArr into #1/created (empty)file\n        Put #1, , bytArr\n        Close #1\n    End If\n    \n    'set public File as file path to be used later on main sub\n    Signature.File = FilePath\n\n    Unload Me\nEnd Sub\n\nPrivate Sub Cancel_Click()\n    End\nEnd Sub\n\nPrivate Sub ClearPad_Click()\n    'delete strokes/lines of signature\n    Me.SignPicture.Ink.DeleteStrokes\n    'refresh form\n    Me.Repaint\nEnd Sub\n</code></pre>\n<p>Below is the <code>Main sub</code> (Module called <code>Signature</code>) to call the userform and handle the signature, you can call this <code>Sub</code> with a <code>button</code> or form another <code>Sub</code>. <br></p>\n<pre><code>'public temp file path\nPublic File\nSub collect_signature()\n\n    'Dim and call userform\n    Dim myUserForm As Signature_pad\n\n    Set myUserForm = New Signature_pad\n    myUserForm.Show\n    Set myUserForm = Nothing\n    \n    'insert image/signature from temp file into application active sheet\n    Set SignatureImage = Application.ActiveSheet.Shapes.AddPicture(File, False, True, 1, 1, 1, 1)\n    \n    'scale image/signature\n    SignatureImage.ScaleHeight 1, True\n    SignatureImage.ScaleWidth 1, True\n    \n    'image/signature position\n    SignatureImage.Top = Range(&quot;A1&quot;).Top\n    SignatureImage.Left = Range(&quot;A1&quot;).Left\n    \n    'delete temp file\n    Kill File\n\nEnd Sub\n</code></pre>\n<p>Be sure to rename either the <code>Userform Name</code> and <code>Buttons Name</code> Or the code to match the names of you <code>buttons</code>.</p>\n"}], "owner": {"reputation": 1300, "user_id": 3005534, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/giBVn.jpg?s=128&g=1", "display_name": "Miguel_Ryu", "link": "https://stackoverflow.com/users/3005534/miguel-ryu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7285, "favorite_count": 0, "protected_date": 1595541633, "accepted_answer_id": 37165608, "answer_count": 2, "score": 5, "last_activity_date": 1617885101, "creation_date": 1462974938, "last_edit_date": 1617885101, "question_id": 37164849, "link": "https://stackoverflow.com/questions/37164849/how-to-add-handwritten-signature-using-excels-ink-tools", "title": "How to add handwritten signature using Excel&#39;s Ink Tools?", "body": "<p>I want to add a handwritten digital signature to some of my company's forms.</p>\n<p>The goal is to, select a document, add a signature (through the use of a drawing pad, which can be done with Excel's Ink Tools) and store the file in the server as PDF. This would cut out the necessity of printing and then scanning the form back in to obtain a signature.</p>\n<p>I'm using Excel for the main interface for file manipulation and search. I've not found any references/libraries for the use of Excel - Ink Tools through VBA.</p>\n<p>How do I start Ink Tools Objects in VBA? Would I have to use a different software to get the signature?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1462976505, "post_id": 37164592, "comment_id": 61866382, "body": "<code>Sub ProPlanner()</code> - the fact that the method doesn&#39;t start with a verb that tells us exactly what it does, is an indication that it&#39;s doing too many things. Split things up, extract responsibilities into separate functions and procedures, each responsible for handling their own set of possible errors. I&#39;d suggest you put your code up on <a href=\"https://codereview.stackexchange.com\">Code Review</a> <i>once it works as intended</i>, if you would like peer review / feedback on all aspects of the code, and tips for making it cleaner, more fail-safe and generally easier to maintain."}, {"owner": {"reputation": 25, "user_id": 6320502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c4f033120170e2764e85256ed6ff2f0?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6320502/chris"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1462985129, "post_id": 37164592, "comment_id": 61872395, "body": "This macro is just a one time thing, but if I make a macro that is widely or frequently used I will use the code review. Thank you"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1462976398, "post_id": 37165417, "comment_id": 61866313, "body": "++ best error handling is handle error conditions before they turn into a runtime error."}, {"owner": {"reputation": 25, "user_id": 6320502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c4f033120170e2764e85256ed6ff2f0?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6320502/chris"}, "edited": false, "score": 0, "creation_date": 1462985059, "post_id": 37165417, "comment_id": 61872352, "body": "I don&#39;t know why I did not think of an If then statement. Thank you."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1462976284, "creation_date": 1462976284, "answer_id": 37165417, "question_id": 37164592, "link": "https://stackoverflow.com/questions/37164592/nested-on-error-vba/37165417#37165417", "title": "Nested on error VBA", "body": "<p>you cold add a check like follows</p>\n\n<pre><code>TaskInRoute:\n\n    strTask = Cells(TaskCellRow, TaskCellCol).Value\n\n    NewTaskPath = (NewRoutPath &amp; \"\\\" &amp; strTask)\n    If Dir(NewRoutPath &amp; \"\\\" &amp; strTask, vbDirectory) = \"\" Then\n        MkDir (NewTaskPath) 'error occurs here if 2nd layer folder already exists...nested on error statement?\n    Else\n        ' subfolder already exists\n        ' do other things\n    End If\n\n    Resume IterationLoop\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6320502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c4f033120170e2764e85256ed6ff2f0?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6320502/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 37165417, "answer_count": 1, "score": 1, "last_activity_date": 1462976284, "creation_date": 1462974340, "last_edit_date": 1531164843, "question_id": 37164592, "link": "https://stackoverflow.com/questions/37164592/nested-on-error-vba", "title": "Nested on error VBA", "body": "<p>The code I have made is meant to go down two columns on a spreadsheet and create folders within folders. The left column has the name of the 1st layer folder, while the second column has the folders within the first layer folder.</p>\n\n<pre><code>1st layer   2nd layer\n3508023     131392\n3508023     90701 - repeat\n3508023     115469\n3508023     358167\n3705584     90701 - repeat\n3705584     133214\n3705584     349453\n</code></pre>\n\n<p>My code currently handles if a 1st layer folder already exists by skipping it and going to the next iteration, but I can't figure out how to handle an error if a 2nd layer folder already exists via a nested error statement.</p>\n\n<p>Here is the code I have</p>\n\n<pre><code>Sub ProPlanner()\n    '\n    ' ProPlanner Macro\n    '\n    Dim strRout As String\n    Dim strTask As String\n    Dim strPath As String\n\n    Dim RoutCellCol As Integer\n    Dim TaskCellCol As Integer\n\n    Dim RoutCellRow As Integer\n    Dim TaskCellRow As Integer\n\n    Dim NewRoutPath As String\n    Dim NewTaskPath As String\n\n    'declare staring cells in spreadsheet\n\n    RoutCellCol = 2\n    RoutCellRow = 2\n\n    TaskCellCol = 6\n    TaskCellRow = 2\n\n\n    Do Until TaskCellRow &gt; 72 'ending row\n\n    strRout = Cells(RoutCellRow, RoutCellCol).Value\n\n    On Error GoTo TaskInRoute\n\n    'create first layer folder in shared file\n\n    NewRoutPath = (\"S:DEPT\\IE\\Employee Files\\Chris\\\" &amp; \"Rout \" &amp; strRout)\n    MkDir (NewRoutPath)\n\n    'create the first 2nd layer folder within the 1st layer folder just created\n\n    strTask = Cells(TaskCellRow, TaskCellCol).Value\n\n    NewTaskPath = (NewRoutPath &amp; \"\\\" &amp; strTask)\n    MkDir (NewTaskPath)\n\n\nIterationLoop:\n\n    RoutCellRow = RoutCellRow + 1\n    TaskCellRow = TaskCellRow + 1\n\nLoop\n\nExit Sub\n\n'error handler if 1st layer folder already exists\n\nTaskInRoute:\n\n\n    strTask = Cells(TaskCellRow, TaskCellCol).Value\n\n    NewTaskPath = (NewRoutPath &amp; \"\\\" &amp; strTask)\n    MkDir (NewTaskPath) 'error occurs here if 2nd layer folder already exists...nested on error statement?\n\n\n\n   Resume IterationLoop\n\n\nExit Sub\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#", "vb.net", "excel", "excel-dna", "vba"], "answers": [{"comments": [{"owner": {"reputation": 112, "user_id": 5200994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4158aba18be472c19fe35e35495aa9c0?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Dermody-Lawrence", "link": "https://stackoverflow.com/users/5200994/christopher-dermody-lawrence"}, "edited": false, "score": 0, "creation_date": 1463059840, "post_id": 37172991, "comment_id": 61909482, "body": "Thanks that worked very well for freeing up the users movement, but there is still an issue when the user opens a conditional formatting window or a message pops up, the macro&#39;s are still trying to run is still trying to run, pushing back errors."}, {"owner": {"reputation": 112, "user_id": 5200994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4158aba18be472c19fe35e35495aa9c0?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Dermody-Lawrence", "link": "https://stackoverflow.com/users/5200994/christopher-dermody-lawrence"}, "edited": false, "score": 0, "creation_date": 1463060549, "post_id": 37172991, "comment_id": 61910060, "body": "using this example,<a href=\"https://groups.google.com/forum/#!msg/ExcelDna/9LMUVP5myUI/qx4NWbKWAAAJ\" rel=\"nofollow noreferrer\">link</a>, the function would return errors when trying to run when a message box is open."}, {"owner": {"reputation": 112, "user_id": 5200994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4158aba18be472c19fe35e35495aa9c0?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Dermody-Lawrence", "link": "https://stackoverflow.com/users/5200994/christopher-dermody-lawrence"}, "edited": false, "score": 0, "creation_date": 1463068308, "post_id": 37172991, "comment_id": 61916259, "body": "I&#39;ve found it easier to have the functionality in a .dll file that the addins use to communicate with the api using an XML file for the address and credentials, that the other addin handles in the ribbon."}], "tags": [], "owner": {"reputation": 15406, "user_id": 44264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d941e5d68ed49560a678a4f37c2bbb?s=128&d=identicon&r=PG", "display_name": "Govert", "link": "https://stackoverflow.com/users/44264/govert"}, "is_accepted": true, "score": 1, "last_activity_date": 1462999624, "creation_date": 1462999624, "answer_id": 37172991, "question_id": 37164541, "link": "https://stackoverflow.com/questions/37164541/excel-dna-calling-xll-function-from-another-async-xll-function-exception-from-h/37172991#37172991", "title": "Excel-DNA calling xll function from another async xll function (Exception from HRESULT: 0x800AC472)", "body": "<p>When you run <code>AsyncTest</code>, the <code>SyncTest</code> will run on a ThreadPool thread (due to <code>Task.Run</code>). From there you are making a COM call from Excel.</p>\n\n<p>As a rule, an Excel add-in should <em>never</em> call into Excel from any thread except the main calculation thread. The Excel COM object model is (basically) single-threaded, so all COM calls eventually have to execute on the main thread. Any call from another thread might fail with a COM error like the one you see.</p>\n\n<p>Excel-DNA has a helper method that allows you to schedule a delegate to be run on the main Excel thread - you call <code>ExcelAsyncUtil.QueueAsMacro(...)</code>. This will have the delegate run once Excel is ready, and both COM and C API calls in that context will work, since the delegate will run on the main thread in a macro context. <code>ExcelAsyncUtil.QueueAsMacro</code> can be called from any thread at any time.</p>\n"}], "owner": {"reputation": 112, "user_id": 5200994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4158aba18be472c19fe35e35495aa9c0?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Dermody-Lawrence", "link": "https://stackoverflow.com/users/5200994/christopher-dermody-lawrence"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 891, "favorite_count": 0, "accepted_answer_id": 37172991, "answer_count": 1, "score": 0, "last_activity_date": 1462999624, "creation_date": 1462974212, "last_edit_date": 1531161705, "question_id": 37164541, "link": "https://stackoverflow.com/questions/37164541/excel-dna-calling-xll-function-from-another-async-xll-function-exception-from-h", "title": "Excel-DNA calling xll function from another async xll function (Exception from HRESULT: 0x800AC472)", "body": "<p>I'm using excel-DNA to make the addins, one addin handles communication to an API and another handles the inputs and routes. The second addin needs to be separate as other addins use it to post to the same api, and it is used to hold information about the address and user.</p>\n\n<p>In VBA i used Application.Run() to run other files functions so I assumed the ExcelDnaUtil.Application.run() worked the same way, which it did. The issue is that the async functions, when they are trying to use application.run when the user is entering in a cell or selecting multiple cell and they get an error 0x800AC472. </p>\n\n<p>I tried to solve the problem by looping until the function was successful (example below) using the ideas from this thread <a href=\"https://social.msdn.microsoft.com/Forums/vstudio/en-US/9168f9f2-e5bc-4535-8d7d-4e374ab8ff09/hresult-800ac472-from-set-operations-in-excel?forum=vsto\" rel=\"nofollow\">HRESULT 800ac472 from set operations in Excel </a> but the errors still come when someone opens a formatting or function wizard window.</p>\n\n<p></p>\n\n<pre><code>Public Shared Function AsyncTest(a As Integer, b As Integer) As Object\n    Return ExcelAsyncUtil.Run(\"AsyncTest\", New Object() {a, b}, Function() SyncTest(a, b))\nEnd Function\n\n&lt;MethodImpl(MethodImplOptions.Synchronized)&gt;\nPublic Shared Function SyncTest(a As Integer, b As Integer) As Object\n    Try\n        Dim Package = String.Concat({\"&lt;Model&gt;&lt;a&gt;\", a, \"&lt;/a&gt;&lt;b&gt;\", b, \"&lt;/b&gt;&lt;/Model&gt;\"})\n\n        Dim xlApp As Object\n        xlApp = ExcelDnaUtil.Application\n        Dim failed as boolean = false\n        Do\n            Try\n                Return xlApp.Run(\"PostToApiXmlToJson\", Package, \"api/test/add\")  \n\n            Catch e As System.Runtime.InteropServices.COMException\n                If e.ErrorCode = -2146777998 Then\n                    failed = True\n                    System.Threading.Thread.Sleep(10)\n                End If\n                Debug.Write(String.Concat({\"ErrorCode: #### \", e.ErrorCode, \" #### PostToAPI\"}))\n            End Try\n\n            count = count + 1\n\n            Loop Until failed = False Or count &gt; 100\n\n        Catch err As Exception\n            Return err.Message\n        End Try\n    End Function\n</code></pre>\n\n<p><strong>So is there a different way of calling a function from another xll?</strong></p>\n\n<p><strong>Or is there a way of telling the function not to calculate until the function is free?</strong></p>\n\n<p><strong>Or is there a way of telling Excel that this function hasn't finished calculating try again?</strong></p>\n\n<p>Does anyone need any more information to help?</p>\n\n<p>Any help will be appreciated</p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2007"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1462975891, "post_id": 37164287, "comment_id": 61865941, "body": "Which Access version are you using? Conditional formatting has changed a lot over the versions."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1462977306, "post_id": 37164287, "comment_id": 61867010, "body": "Have you tried creating format conditions with VBA? <a href=\"https://docs.google.com/document/pub?id=1MNJ15nfDoElcl8liROCqTwLW0iwjLB70zERbh4F1WxE\" rel=\"nofollow noreferrer\">Example</a>. My memory may be flaky, but I think I was able to create &gt; 3 format conditions in Access 2003 with VBA."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1462977587, "post_id": 37164287, "comment_id": 61867231, "body": "Otherwise there are workarounds here: <a href=\"http://www.access-programmers.co.uk/forums/showthread.php?t=154634\" rel=\"nofollow noreferrer\">access-programmers.co.uk/forums/showthread.php?t=154634</a> (using bitmaps in bound controls) or here: <a href=\"http://www.utteraccess.com/forum/Conditional-Formatting-C-t1544411.html\" rel=\"nofollow noreferrer\">utteraccess.com/forum/Conditional-Formatting-C-t1544411.html</a> (using text, a font with &quot;block&quot; characters)"}], "owner": {"reputation": 35, "user_id": 3684517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51050392f26592ff93163bf8cf2d6fbd?s=128&d=identicon&r=PG&f=1", "display_name": "user3684517", "link": "https://stackoverflow.com/users/3684517/user3684517"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 677, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462977638, "creation_date": 1462973619, "last_edit_date": 1462977638, "question_id": 37164287, "link": "https://stackoverflow.com/questions/37164287/changing-row-color-on-access-form-through-vba", "title": "Changing row color on access form through vba", "body": "<p>I'm using access 2007, I can't migrate.</p>\n\n<p>I need to evaluate the result of a query and change the colors of rows depending on the state field.</p>\n\n<p>Example:</p>\n\n<p>In my query I have a state field with values like (R,J,S,X,K,M)</p>\n\n<p>So I want:</p>\n\n<p>Rows must be red when the status value is \"R\"<br>\nRows must be blue when the status value is \"J\"<br>\nRows must be yellow when the status value is \"S\"<br>\nRows have to be orange when the status value is \"X\"<br>\nRows must be green when the status value is \"K\"<br>\nRows must be brown when the status value is \"M\"</p>\n\n<p>How can I do this? I tried using the Conditional tool, but just allow 3 conditions.</p>\n\n<p>I will appreciate any help on this.</p>\n"}, {"tags": ["javascript", "vba", "selenium", "xpath", "web-scraping"], "answers": [{"tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": true, "score": 0, "last_activity_date": 1462974259, "creation_date": 1462974259, "answer_id": 37164558, "question_id": 37164087, "link": "https://stackoverflow.com/questions/37164087/xpath-not-valid-with-selenium-webdriver-xpath-not-found/37164558#37164558", "title": "Xpath not valid with Selenium Webdriver &quot;Xpath not found&quot;", "body": "<p>You first need to set the context on the frame to access the button:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim driver As New FirefoxDriver\ndriver.Get \"http://www.ocepar.org.br/ocepar/cooperativasPR/consultaPorRamo.html\"\ndriver.SwitchToFrame \"buttons\"\ndriver.FindElementById(\"buttonBar\").Click\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6320552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6677ce111e9ceb5949a2de490847f62b?s=128&d=identicon&r=PG&f=1", "display_name": "bingo", "link": "https://stackoverflow.com/users/6320552/bingo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 37164558, "answer_count": 1, "score": 0, "last_activity_date": 1462974259, "creation_date": 1462973089, "question_id": 37164087, "link": "https://stackoverflow.com/questions/37164087/xpath-not-valid-with-selenium-webdriver-xpath-not-found", "title": "Xpath not valid with Selenium Webdriver &quot;Xpath not found&quot;", "body": "<p>I am using the Selenium WebDriver for VBA to get some information from a website, \nbut first I need to select a \"category\" and click a button, no problem i've been doing that a few times, but on this website the XPath does not return a valid object. </p>\n\n<p>I suspect the website is a \"dynamic format\" and it breaks the XPath</p>\n\n<p>How do I navigate to the button and click it when it's path is not valid?</p>\n\n<p>Line of code that is not working:\ndriver.FindElementByXPath(\"//div[@id=\"\"buttonBar\"\"]/td\").Click</p>\n\n<p>website:\n<a href=\"http://www.ocepar.org.br/ocepar/cooperativasPR/consultaPorRamo.html\" rel=\"nofollow\">http://www.ocepar.org.br/ocepar/cooperativasPR/consultaPorRamo.html</a></p>\n\n<p>The button is the \"continuar\" on the botton of the page</p>\n\n<p>Thanks for the help!</p>\n"}, {"tags": ["vba", "excel", "delete-row"], "comments": [{"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 2, "creation_date": 1462973318, "post_id": 37164080, "comment_id": 61863706, "body": "Can you edit with an example of the data that needs to match, also providing your existing macro could be useful."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1462973583, "post_id": 37164080, "comment_id": 61863901, "body": "You realize, of course, that you may delete rows <b>3</b> through <b>13</b> and thus destroy the criteria ??"}], "answers": [{"tags": [], "owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "is_accepted": false, "score": 0, "last_activity_date": 1462974782, "last_edit_date": 1462974782, "creation_date": 1462973996, "answer_id": 37164454, "question_id": 37164080, "link": "https://stackoverflow.com/questions/37164080/deleting-rows-in-excel-with-specific-combination-of-values-using-vba/37164454#37164454", "title": "Deleting rows in Excel with specific combination of values using VBA", "body": "<p>Far from perfect but without sample data I assumed a few things.</p>\n\n<pre><code>Sub deleteRow()\n\nDim lastRow As Integer, matchVal As String, searchVal As String\n\nlastRow = Range(\"A5000\").End(xlUp).Row\n\nFor i = lastRow To 3 Step -1\n    matchVal = Cells(i, 9).Value &amp; \" \" &amp; Cells(i, 10).Value\n    searchVal = Cells(i, 15).Value &amp; \" \" &amp; Cells(i, 16).Value\n    If matchVal &lt;&gt; searchVal Then Cells(i, 1).EntireRow.Delete\nNext i\n\nMsgBox \"Next time I will add an example to my question\"\nEnd Sub\n</code></pre>\n\n<p>If values in I and J do not equal values in O and P the line will be removed.</p>\n"}, {"comments": [{"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1462975758, "post_id": 37164832, "comment_id": 61865832, "body": "I never advise using <code>End(xlDown)</code> to find the final row. If there is no data in the sheet this would run for a million rows."}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 1, "creation_date": 1462977282, "post_id": 37164832, "comment_id": 61866988, "body": "@Tim Wilkinson True. What you have or <code>cells(rows.Count,col1).end(xlup).row</code> would be better. Thanks!"}], "tags": [], "owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "is_accepted": false, "score": 0, "last_activity_date": 1462974924, "creation_date": 1462974924, "answer_id": 37164832, "question_id": 37164080, "link": "https://stackoverflow.com/questions/37164080/deleting-rows-in-excel-with-specific-combination-of-values-using-vba/37164832#37164832", "title": "Deleting rows in Excel with specific combination of values using VBA", "body": "<p>Not sure if this is what you want:</p>\n\n<pre><code>Sub Test()\n\nDim r As Range\nDim i As Long\nDim col1 As Long\nDim col2 As Long\nDim count As Long\n\ncol1 = Range(\"I:I\").column\ncol2 = Range(\"J:J\").column\ncount = ActiveSheet.Range(\"I3\").End(xlDown).row\n\nFor i = count To 3 Step -1\n    If Cells(i, col1) &lt;&gt; Cells(i, col1).Offset(0, 6) Or Cells(i, col2) &lt;&gt; Cells(i, col2).Offset(0, 6) Then\n        Rows(i).Delete\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6320415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a90b095f129db961641fb756de3b09e2?s=128&d=identicon&r=PG&f=1", "display_name": "A. Turbo", "link": "https://stackoverflow.com/users/6320415/a-turbo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 265, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1462974924, "creation_date": 1462973071, "question_id": 37164080, "link": "https://stackoverflow.com/questions/37164080/deleting-rows-in-excel-with-specific-combination-of-values-using-vba", "title": "Deleting rows in Excel with specific combination of values using VBA", "body": "<p>I want to insert some code into an existing macro that deletes all rows except those with a specific combination of values in columns O and P. The combinations are in I3:I13 and J3:13.</p>\n\n<p>In other words, I want to keep rows that in columns O and P have values corresponding to I3 and J3 respectively, or I6 and J6 respectively, etc, and delete all the others.</p>\n\n<p>Any help is greatly appreciated.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 122, "user_id": 5534881, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1KnxnCM_WMs/AAAAAAAAAAI/AAAAAAAAAFY/NzBIFdE9PiE/photo.jpg?sz=128", "display_name": "DukeOfHazard", "link": "https://stackoverflow.com/users/5534881/dukeofhazard"}, "edited": false, "score": 0, "creation_date": 1462974392, "post_id": 37164020, "comment_id": 61864621, "body": "You can find answers here :<a href=\"http://stackoverflow.com/questions/4668410/how-do-i-get-the-old-value-of-a-changed-cell-in-excel-vba\" title=\"how do i get the old value of a changed cell in excel vba\">stackoverflow.com/questions/4668410/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1462974862, "post_id": 37164737, "comment_id": 61865049, "body": "Looks good............should you not refresh <code>sOldValue</code> somewhere in the code ??"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1462978965, "post_id": 37164737, "comment_id": 61868227, "body": "That&#39;s handled in the <code>Worksheet_SelectionChange</code> event.  After the cell has been updated pressing enter will move to the next cell and capture the old value of that cell."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 1, "last_activity_date": 1462974670, "creation_date": 1462974670, "answer_id": 37164737, "question_id": 37164020, "link": "https://stackoverflow.com/questions/37164020/vba-change-color-of-modified-text/37164737#37164737", "title": "VBA - Change color of modified text", "body": "<p>This will change the font, but it's not perfect.  Seems if you have different font colours in the same cell then <code>Target.Font.ColorIndex</code> returns NULL so it only works on the first change.</p>\n\n<pre><code>Option Explicit\n\nDim sOldValue As String\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim sNewValue As String\n    Dim sDifference As String\n    Dim lStart As Long\n    Dim lLength As Long\n    Dim lColorIndex As Long\n\n    On Error GoTo ERROR_HANDLER\n\n    If Not Intersect(Target, Range(\"A1:A100\")) Is Nothing Then\n        sNewValue = Target.Value\n        sDifference = Replace(sNewValue, sOldValue, \"\")\n        lStart = InStr(sNewValue, sDifference)\n        lLength = Len(sDifference)\n        If Target.Font.ColorIndex = 3 Then\n            lColorIndex = 5\n        Else\n            lColorIndex = 3\n        End If\n        Target.Characters(Start:=lStart, Length:=lLength).Font.ColorIndex = lColorIndex\n    End If\n\n    On Error GoTo 0\n    Exit Sub\n\nERROR_HANDLER:\n    Select Case Err.Number\n        'I haven't added error handling - trap any errors here.\n        Case Else\n            MsgBox \"Error \" &amp; Err.Number &amp; vbCr &amp; _\n                \" (\" &amp; Err.Description &amp; \") in procedure Sheet1.Worksheet_Change.\"\n    End Select\n\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"A1:A100\")) Is Nothing Then\n        sOldValue = Target.Value\n    End If\nEnd Sub\n</code></pre>\n\n<p>Edit:  It will only work with a continuous string.  Maybe can change to look at each character in <code>sOldValue</code> and <code>sNewValue</code> and change colour as required.</p>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1462975150, "last_edit_date": 1462975150, "creation_date": 1462974720, "answer_id": 37164759, "question_id": 37164020, "link": "https://stackoverflow.com/questions/37164020/vba-change-color-of-modified-text/37164759#37164759", "title": "VBA - Change color of modified text", "body": "<p>It is laborious:</p>\n\n<ol>\n<li>detect that a cell has changed in the range of interest</li>\n<li>use <code>UnDo</code> to get the original contents</li>\n<li>use <code>ReDo</code> to get the new contents</li>\n<li>compare them to get the changed characters</li>\n<li>use the <code>Characters</code> property of the cell to format the new characters</li>\n</ol>\n\n<p>I would use <code>UnDo</code> to avoid keeping a <code>static</code> copy of each of the 100 cells.</p>\n"}, {"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1462975432, "post_id": 37164799, "comment_id": 61865562, "body": "The code is good.............. but may have trouble retaining the old values of all the cells in the range of interest with only one global."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 2, "last_activity_date": 1462974833, "creation_date": 1462974833, "answer_id": 37164799, "question_id": 37164020, "link": "https://stackoverflow.com/questions/37164020/vba-change-color-of-modified-text/37164799#37164799", "title": "VBA - Change color of modified text", "body": "<p>Here's what I put together:</p>\n\n<pre><code>Dim oldString$, newString$\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    If Not Intersect(Target, Range(\"A1:A100\")) Is Nothing Then\n    newString = Target.Value\n        If Target.Font.ColorIndex = 3 Then\n            Target.Font.ColorIndex = 5\n        Else\n            Target.Font.ColorIndex = 3\n        End If\n    End If\nDebug.Print \"New text: \" &amp; newString\ncolor_New_Text oldString, newString, Target\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Excel.Range)\n    If Not Intersect(Target, Range(\"A1:A100\")) Is Nothing Then\n        oldString$ = Target.Value\n        Debug.Print \"Original text: \" &amp; oldString$\n    End If\nEnd Sub\n\nSub color_New_Text(ByVal oldString As String, ByVal newString As String, ByVal theCell As Range)\nDim oldLen&amp;, newLen&amp;, i&amp;, k&amp;\noldLen = Len(oldString)\nnewLen = Len(newString)\n\nDebug.Print newString &amp; \", \" &amp; oldString\nFor i = 1 To newLen\n    If Mid(newString, i, 1) &lt;&gt; Mid(oldString, i, 1) Then\n        Debug.Print \"different\"\n        Debug.Print theCell.Characters(i, 1).Text\n        If theCell.Characters(i, 1).Font.ColorIndex = 3 Then\n            theCell.Characters(i, 1).Font.ColorIndex = 5\n        Else\n            theCell.Characters(i, 1).Font.ColorIndex = 3\n        End If\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>It's two global variables, a <code>Worksheet_SelectionChange</code>and <code>Worksheet_Change</code>to get the strings.</p>\n"}, {"comments": [{"owner": {"reputation": 535, "user_id": 4980705, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cfb8a28439044578ba741915bbd61698?s=128&d=identicon&r=PG&f=1", "display_name": "peetman", "link": "https://stackoverflow.com/users/4980705/peetman"}, "edited": false, "score": 0, "creation_date": 1462977916, "post_id": 37165710, "comment_id": 61867489, "body": "Thanks! It does work although if I change something in the beginning of the cell it will change the color of the characters on the right side. But anyway it does the purpose. Thanks a lot!"}], "tags": [], "owner": {"reputation": 192, "user_id": 1666422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c2JIV.jpg?s=128&g=1", "display_name": "Kellsens", "link": "https://stackoverflow.com/users/1666422/kellsens"}, "is_accepted": true, "score": 1, "last_activity_date": 1462976951, "creation_date": 1462976951, "answer_id": 37165710, "question_id": 37164020, "link": "https://stackoverflow.com/questions/37164020/vba-change-color-of-modified-text/37165710#37165710", "title": "VBA - Change color of modified text", "body": "<p>using the tip from Gary's Student, I retain the old value of cell and compare with the new value. Then use the lenght to get the 'difference' and color the 'characters'. Here's the modification:</p>\n\n<pre><code>Option Explicit\nPublic oldValue As Variant\n\nPublic Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    oldValue = Target.Value\n\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim oldColor\n\n    If Not Intersect(Target, Range(\"A1:A100\")) Is Nothing Then\n        If Target.Value &lt;&gt; oldValue Then\n            oldColor = Target.Font.ColorIndex\n            Target.Characters(Len(oldValue) + 1, Len(Target) - Len(oldValue)).Font.ColorIndex = IIf(oldColor = 3, 5, 3)\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>P.S. Sorry my english</p>\n"}, {"tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 0, "last_activity_date": 1462979303, "creation_date": 1462979303, "answer_id": 37166692, "question_id": 37164020, "link": "https://stackoverflow.com/questions/37164020/vba-change-color-of-modified-text/37166692#37166692", "title": "VBA - Change color of modified text", "body": "<p>Try with below</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim newvalue As String\n    Dim olvalue As String\n    Dim content\n    Application.EnableEvents = False\n    If Not Intersect(Target, Range(\"A1:A100\")) Is Nothing Then\n        If Target.Font.ColorIndex &lt;&gt; -4105 Or IsNull(Target.Font.ColorIndex) = True Then\n            newvalue = Target.Value\n            Application.Undo\n            oldvalue = Target.Value\n            Content = InStr(newvalue, Replace(newvalue, oldvalue, \"\"))\n            Target.Value = newvalue\n            With Target.Characters(Start:=Content, Length:=Len(newvalue)).Font\n                .Color = 5\n            End With\n        Else\n            Target.Font.ColorIndex = 3\n        End If\n    End If\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 535, "user_id": 4980705, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cfb8a28439044578ba741915bbd61698?s=128&d=identicon&r=PG&f=1", "display_name": "peetman", "link": "https://stackoverflow.com/users/4980705/peetman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1161, "favorite_count": 0, "accepted_answer_id": 37165710, "answer_count": 5, "score": 2, "last_activity_date": 1462979303, "creation_date": 1462972934, "question_id": 37164020, "link": "https://stackoverflow.com/questions/37164020/vba-change-color-of-modified-text", "title": "VBA - Change color of modified text", "body": "<p>I have this code that changes the color of the text in a cell if it is modified. However I was looking into something that only changes the color of modified text inside the cell. For example I have in cell A1 = \"This cell\" and when I change it to \"This cell - this is new text\" I would like just to change the color of \"- this is new text\"</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    If Not Intersect(Target, Range(\"A1:A100\")) Is Nothing Then\n        If Target.Font.ColorIndex = 3 Then\n            Target.Font.ColorIndex = 5\n        Else\n            Target.Font.ColorIndex = 3\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462975763, "post_id": 37163992, "comment_id": 61865836, "body": "While you have been around for a while, I would still like to remind you that StackOverflow is not a free code-writing service. Yet, we are eager to help fellow programmers (and aspirants) with their code. So, if you don&#39;t have a specific coding question then you are probably posting this question on the wrong site. Have a look <a href=\"http://stackoverflow.com/help/on-topic\">here</a> for more information which posts are on-topic."}, {"owner": {"reputation": 255, "user_id": 1806531, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1e5c2468b26cc8a209c909e52942e9e8?s=128&d=identicon&r=PG", "display_name": "Kaish", "link": "https://stackoverflow.com/users/1806531/kaish"}, "reply_to_user": {"reputation": 4587, "user_id": 3447827, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/n08Vz.jpg?s=128&g=1", "display_name": "durbnpoisn", "link": "https://stackoverflow.com/users/3447827/durbnpoisn"}, "edited": false, "score": 0, "creation_date": 1462976521, "post_id": 37163992, "comment_id": 61866392, "body": "@durbnpoisn Well this project was supposed to be my way of learning. Maybe I should not ever learn anything I don&#39;t know as I don&#39;t know it?"}, {"owner": {"reputation": 255, "user_id": 1806531, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1e5c2468b26cc8a209c909e52942e9e8?s=128&d=identicon&r=PG", "display_name": "Kaish", "link": "https://stackoverflow.com/users/1806531/kaish"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462976549, "post_id": 37163992, "comment_id": 61866420, "body": "@Ralph Am I not asking a specific question in how to link user specific, logged in webpages to my spreadsheet?"}, {"owner": {"reputation": 4587, "user_id": 3447827, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/n08Vz.jpg?s=128&g=1", "display_name": "durbnpoisn", "link": "https://stackoverflow.com/users/3447827/durbnpoisn"}, "edited": false, "score": 0, "creation_date": 1462977377, "post_id": 37163992, "comment_id": 61867063, "body": "@Kaish...  That is not at all what I am suggesting.  What I AM suggesting is that you start smaller.  Give yourself something a little less ambitious.  Because learning programming concepts and new languages is not something to be taken lightly.  It takes YEARS.  I&#39;ve been doing various programming for 30 years, in at least as many languages, and I&#39;m still learning stuff all the time.  So don&#39;t take my comment as an insult.  Consider it a push in the right direction."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462977575, "post_id": 37163992, "comment_id": 61867223, "body": "The following link might be able to help you find a starting point for your question(s): <a href=\"http://meta.programmers.stackexchange.com/questions/6366/where-to-start/6367#6367\" title=\"where to start\">meta.programmers.stackexchange.com/questions/6366/&hellip;</a>"}, {"owner": {"reputation": 255, "user_id": 1806531, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1e5c2468b26cc8a209c909e52942e9e8?s=128&d=identicon&r=PG", "display_name": "Kaish", "link": "https://stackoverflow.com/users/1806531/kaish"}, "reply_to_user": {"reputation": 4587, "user_id": 3447827, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/n08Vz.jpg?s=128&g=1", "display_name": "durbnpoisn", "link": "https://stackoverflow.com/users/3447827/durbnpoisn"}, "edited": false, "score": 0, "creation_date": 1462977769, "post_id": 37163992, "comment_id": 61867370, "body": "@durbnpoisn Ah I see. Sorry about that! I know BASIC programming (some unix, awk, LUA and other languages like HTML and CSS and some basic Matlab) but I think I just wanted a shortcut to more interesting programming (like Java) and thought the best way to do it was via a project I found interesting, as the best way I found to learn those other things was by doing something rather than working through a text book etc"}, {"owner": {"reputation": 255, "user_id": 1806531, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1e5c2468b26cc8a209c909e52942e9e8?s=128&d=identicon&r=PG", "display_name": "Kaish", "link": "https://stackoverflow.com/users/1806531/kaish"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462977913, "post_id": 37163992, "comment_id": 61867487, "body": "@Ralph Ok thanks for that, I see what I have done. I will try to revise the question, edit and re-post it. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": true, "score": 0, "last_activity_date": 1464375452, "creation_date": 1464375452, "answer_id": 37490553, "question_id": 37163992, "link": "https://stackoverflow.com/questions/37163992/how-to-link-logged-in-webpages-to-excel/37490553#37490553", "title": "How to link logged in webpages to Excel", "body": "<p>This should be enough to get you started.</p>\n\n<pre><code>Dim HTMLDoc As HTMLDocument\nDim oBrowser As InternetExplorer\nSub Login_2_Website()\n\nDim oHTML_Element As IHTMLElement\nDim sURL As String\n\nOn Error GoTo Err_Clear\nsURL = \"https://www.google.com/accounts/Login\"\nSet oBrowser = New InternetExplorer\noBrowser.Silent = True\noBrowser.timeout = 60\noBrowser.navigate sURL\noBrowser.Visible = True\n\nDo\n' Wait till the Browser is loaded\nLoop Until oBrowser.readyState = READYSTATE_COMPLETE\n\nSet HTMLDoc = oBrowser.Document\n\nHTMLDoc.all.Email.Value = \"sample@vbadud.com\"\nHTMLDoc.all.passwd.Value = \"*****\"\n\nFor Each oHTML_Element In HTMLDoc.getElementsByTagName(\"input\")\nIf oHTML_Element.Type = \"submit\" Then oHTML_Element.Click: Exit For\nNext\n\n' oBrowser.Refresh ' Refresh If Needed\nErr_Clear:\nIf Err &lt;&gt; 0 Then\nDebug.Assert Err = 0\nErr.Clear\nResume Next\nEnd If\nEnd Sub\n</code></pre>\n\n<p><a href=\"http://vbadud.blogspot.com/2009/08/how-to-login-to-website-using-vba.html\" rel=\"nofollow\">http://vbadud.blogspot.com/2009/08/how-to-login-to-website-using-vba.html</a></p>\n"}], "owner": {"reputation": 255, "user_id": 1806531, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1e5c2468b26cc8a209c909e52942e9e8?s=128&d=identicon&r=PG", "display_name": "Kaish", "link": "https://stackoverflow.com/users/1806531/kaish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 37490553, "answer_count": 1, "score": -2, "last_activity_date": 1586965072, "creation_date": 1462972874, "last_edit_date": 1586965072, "question_id": 37163992, "link": "https://stackoverflow.com/questions/37163992/how-to-link-logged-in-webpages-to-excel", "title": "How to link logged in webpages to Excel", "body": "<p>How do I link data from a user specific webpage, i.e one you need to be logged in on (for example Instagram followers or Facebook friends) etc to a spreadsheet?</p>\n\n<p>From what I can see, the Data -> From Web option only lets you do it from open webpages, i.e those that you don't need to log in and is not specific to the user.</p>\n\n<p>Is there a way I can do this on Excel? </p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 4595, "user_id": 314507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35fa938f2b64b7620be0181281f2ae1?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/314507/jeremy"}, "edited": false, "score": 1, "creation_date": 1462974099, "post_id": 37163938, "comment_id": 61864340, "body": "Prepared statements also might help you, because then you don&#39;t have to take special characters into account when building your string. See if this sample helps you. <a href=\"http://stackoverflow.com/questions/6572448/ms-access-prepared-statements\" title=\"ms access prepared statements\">stackoverflow.com/questions/6572448/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 4611970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MO31Q.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/4611970/kevin"}, "edited": false, "score": 0, "creation_date": 1462977679, "post_id": 37164338, "comment_id": 61867295, "body": "i knew it was probably a comma or apostrophe I have had a hard time with quotes and commas. Thank you for your reply!"}], "tags": [], "owner": {"reputation": 366, "user_id": 5621866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15e2f5c3ce73b5e3d34d6b1635b91377?s=128&d=identicon&r=PG&f=1", "display_name": "Slubee", "link": "https://stackoverflow.com/users/5621866/slubee"}, "is_accepted": false, "score": 0, "last_activity_date": 1462973723, "creation_date": 1462973723, "answer_id": 37164338, "question_id": 37163938, "link": "https://stackoverflow.com/questions/37163938/vba-sql-string-run-time-error-3075/37164338#37164338", "title": "VBA SQL String Run-Time Error 3075", "body": "<p>The issue is due to the '(apostrophes) in \"O'TOOL\". Try replacing that with double apostrophe (O''TOOL) or put the address in double quotes</p>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 4611970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MO31Q.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/4611970/kevin"}, "edited": false, "score": 0, "creation_date": 1462977478, "post_id": 37164521, "comment_id": 61867144, "body": "Decided to try the DAO Recordset AddNew. I cannot believe how nice that is when added data to a table, very smooth. I have always struggled with apostrophes and quotes. Thank you for your response very helpful!"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 55, "user_id": 4611970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MO31Q.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/4611970/kevin"}, "edited": false, "score": 1, "creation_date": 1462982442, "post_id": 37164521, "comment_id": 61870730, "body": "You&#39;re welcome.  I also like that both parameter queries and <code>Recordset.AddNew</code> make dates easier to deal with --- you needn&#39;t bother with format issues and <code>#</code> delimiters."}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1462975722, "last_edit_date": 1495542179, "creation_date": 1462974166, "answer_id": 37164521, "question_id": 37163938, "link": "https://stackoverflow.com/questions/37163938/vba-sql-string-run-time-error-3075/37164521#37164521", "title": "VBA SQL String Run-Time Error 3075", "body": "<p>I'm uncertain whether the comma in the address is the problem.  It looks to me like the apostrophe in <em>O'TOOL</em> should be a problem.  But if it is not the cause of the first error Access complains about, it should trigger another error after you fix the first error.  </p>\n\n<p>For a simple example, the following code triggers error 3075, <em>\"Syntax error (missing operator) in query expression ''O'TOOL');'.\"</em></p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim strInsert As String\nstrInsert = \"INSERT INTO tblFoo(text_field) VALUES ('O'TOOL');\"\nCurrentDb.Execute strInsert, dbFailOnError\n</code></pre>\n\n<p>Changing the <code>INSERT</code> statement to either of these allows the statement to execute without error.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>strInsert = \"INSERT INTO tblFoo(text_field) VALUES ('O''TOOL');\"\nstrInsert = \"INSERT INTO tblFoo(text_field) VALUES (\"\"O'TOOL\"\");\"\n</code></pre>\n\n<p>You could revise your code to use one of those approaches.  However consider a <a href=\"https://stackoverflow.com/a/6572841/77335\">parameter query</a> or the <a href=\"https://stackoverflow.com/a/13712926/77335\">DAO.Recordset.AddNew</a> method instead ... and then quotes and apostrophes will be less troublesome.</p>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 4611970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MO31Q.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/4611970/kevin"}, "edited": false, "score": 0, "creation_date": 1462977550, "post_id": 37164607, "comment_id": 61867206, "body": "Thank you for the reply I am going to look into adding this function to my database. I need to go through it more to understand it better."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 55, "user_id": 4611970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MO31Q.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/4611970/kevin"}, "edited": false, "score": 0, "creation_date": 1462980507, "post_id": 37164607, "comment_id": 61869388, "body": "It may look of more than it is. It really is quite simple - see the in-line example."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1462974383, "creation_date": 1462974383, "answer_id": 37164607, "question_id": 37163938, "link": "https://stackoverflow.com/questions/37163938/vba-sql-string-run-time-error-3075/37164607#37164607", "title": "VBA SQL String Run-Time Error 3075", "body": "<p>Yes, it is the apostrophe. </p>\n\n<p>You can use this function to avoid this and most other troubles when concatenating SQL:</p>\n\n<pre><code>' Converts a value of any type to its string representation.\n' The function can be concatenated into an SQL expression as is\n' without any delimiters or leading/trailing white-space.\n'\n' Examples:\n'   SQL = \"Select * From TableTest Where [Amount]&gt;\" &amp; CSql(12.5) &amp; \"And [DueDate]&lt;\" &amp; CSql(Date) &amp; \"\"\n'   SQL -&gt; Select * From TableTest Where [Amount]&gt; 12.5 And [DueDate]&lt; #2016/01/30 00:00:00#\n'\n'   SQL = \"Insert Into TableTest ( [Street] ) Values (\" &amp; CSql(\" \") &amp; \")\"\n'   SQL -&gt; Insert Into TableTest ( [Street] ) Values ( Null )\n'\n' Trims text variables for leading/trailing Space and secures single quotes.\n' Replaces zero length strings with Null.\n' Formats date/time variables as safe string expressions.\n' Uses Str to format decimal values to string expressions.\n' Returns Null for values that cannot be expressed with a string expression.\n'\n' 2016-01-30. Gustav Brock, Cactus Data ApS, CPH.\n'\nPublic Function CSql( _\n    ByVal Value As Variant) _\n    As String\n\n    Const vbLongLong    As Integer = 20\n    Const SqlNull       As String = \" Null\"\n\n    Dim Sql             As String\n    Dim LongLong        As Integer\n\n    #If Win32 Then\n        LongLong = vbLongLong\n    #End If\n    #If Win64 Then\n        LongLong = VBA.vbLongLong\n    #End If\n\n    Select Case VarType(Value)\n        Case vbEmpty            '    0  Empty (uninitialized).\n            Sql = SqlNull\n        Case vbNull             '    1  Null (no valid data).\n            Sql = SqlNull\n        Case vbInteger          '    2  Integer.\n            Sql = Str(Value)\n        Case vbLong             '    3  Long integer.\n            Sql = Str(Value)\n        Case vbSingle           '    4  Single-precision floating-point number.\n            Sql = Str(Value)\n        Case vbDouble           '    5  Double-precision floating-point number.\n            Sql = Str(Value)\n        Case vbCurrency         '    6  Currency.\n            Sql = Str(Value)\n        Case vbDate             '    7  Date.\n            Sql = Format(Value, \" \\#yyyy\\/mm\\/dd hh\\:nn\\:ss\\#\")\n        Case vbString           '    8  String.\n            Sql = Replace(Trim(Value), \"'\", \"''\")\n            If Sql = \"\" Then\n                Sql = SqlNull\n            Else\n                Sql = \" '\" &amp; Sql &amp; \"'\"\n            End If\n        Case vbObject           '    9  Object.\n            Sql = SqlNull\n        Case vbError            '   10  Error.\n            Sql = SqlNull\n        Case vbBoolean          '   11  Boolean.\n            Sql = Str(Abs(Value))\n        Case vbVariant          '   12  Variant (used only with arrays of variants).\n            Sql = SqlNull\n        Case vbDataObject       '   13  A data access object.\n            Sql = SqlNull\n        Case vbDecimal          '   14  Decimal.\n            Sql = Str(Value)\n        Case vbByte             '   17  Byte.\n            Sql = Str(Value)\n        Case LongLong           '   20  LongLong integer (Valid on 64-bit platforms only).\n            Sql = Str(Value)\n        Case vbUserDefinedType  '   36  Variants that contain user-defined types.\n            Sql = SqlNull\n        Case vbArray            ' 8192  Array.\n            Sql = SqlNull\n        Case Else               '       Should not happen.\n            Sql = SqlNull\n    End Select\n\n    CSql = Sql &amp; \" \"\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 4611970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MO31Q.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/4611970/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 972, "favorite_count": 1, "accepted_answer_id": 37164521, "answer_count": 3, "score": 1, "last_activity_date": 1462975722, "creation_date": 1462972776, "last_edit_date": 1462974650, "question_id": 37163938, "link": "https://stackoverflow.com/questions/37163938/vba-sql-string-run-time-error-3075", "title": "VBA SQL String Run-Time Error 3075", "body": "<p>I have a string that is adding data to a table so I can print a report or labels from the data. The data consists of addresses and is causing the string to fail because of the comma in the address. this string has been working but when it has some weird addresses I think that is what is causing this. </p>\n\n<pre><code>sqls = \"INSERT INTO tInvReportDataWrk(SO,ITEM,QTY,billTO,shipTO,LINEKEY)VALUES('\" &amp; \n  SO &amp; \"', '\" &amp; it &amp; \"', '\" &amp; qty &amp; \"', '\" &amp; billTO &amp; \"', '\" &amp; shipTO &amp; \"', '\" &amp; lk &amp; \"')\"\n</code></pre>\n\n<p>The data that is trying looks like this from the <code>debug.print</code></p>\n\n<pre><code>INSERT INTO tInvReportDataWrk(SO,ITEM,QTY,billTO,shipTO,LINEKEY)\nVALUES('0000001', 'L-R_4-8R2B-01', '2', 'BAR - ANAHEIM\nBAR BRANCH\nP.O. BOX 00000\nVENDOR ID# VC-00001\nSaint Louis, MO  00008\n', 'ABC ELEMENT WAREHOUSE\n2000 O'TOOL AVE.\nSan Jose, CA  95131-1301\n', '000001')\n</code></pre>\n"}, {"tags": ["database", "vba", "excel"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1462972577, "post_id": 37163771, "comment_id": 61863083, "body": "<code>I can handle some beginner level macros</code> Have you tried writing something then?"}, {"owner": {"reputation": 1, "user_id": 6320434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90a91c3cbba915f35018fcf0db6c32ec?s=128&d=identicon&r=PG&f=1", "display_name": "stephen k", "link": "https://stackoverflow.com/users/6320434/stephen-k"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1462972814, "post_id": 37163771, "comment_id": 61863297, "body": "No, I usually import some that has already been written. I am &quot;familiar&quot; with macros..."}, {"owner": {"reputation": 2046, "user_id": 6216216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e055d8eee151322d496f655f12088a?s=128&d=identicon&r=PG&f=1", "display_name": "Leviathan", "link": "https://stackoverflow.com/users/6216216/leviathan"}, "edited": false, "score": 0, "creation_date": 1462995078, "post_id": 37163771, "comment_id": 61878099, "body": "Well, then the solution to your problem seems to be to learn VBA a bit better so you can understand and - more importantly - improve the written code you encounter. If you have a specific question though please feel free to return and ask - but you can&#39;t expect us to do all your work just because you don&#39;t want to learn for yourself."}, {"owner": {"reputation": 1, "user_id": 6320434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90a91c3cbba915f35018fcf0db6c32ec?s=128&d=identicon&r=PG&f=1", "display_name": "stephen k", "link": "https://stackoverflow.com/users/6320434/stephen-k"}, "edited": false, "score": 0, "creation_date": 1463152852, "post_id": 37163771, "comment_id": 61958890, "body": "Sooo I fooled around with the code and I came up with what I wanted! I f anyone lands on this page in the future, here it is:"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6320434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90a91c3cbba915f35018fcf0db6c32ec?s=128&d=identicon&r=PG&f=1", "display_name": "stephen k", "link": "https://stackoverflow.com/users/6320434/stephen-k"}, "is_accepted": true, "score": 0, "last_activity_date": 1463153048, "creation_date": 1463153048, "answer_id": 37213816, "question_id": 37163771, "link": "https://stackoverflow.com/questions/37163771/compiling-data-from-all-workbooks-in-a-folder/37213816#37213816", "title": "Compiling data from all workbooks in a folder", "body": "<pre><code>Sub Fetch_Heures2()\n\nDim Wbname As String\nDim Wb As Workbook\nDim ws As Worksheet\nDim ws1 As Worksheet\nDim lngCalc As Long\nDim l\n\nngrow As Long\n    Dim lngcol As Long\n\n'Cell C4 (date) Cell B7 (name of employee) Cell I50 (hours on site) Cell H50 (hours in office)\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\n    lngCalc = .CalculationState\n    .Calculation = xlCalculationManual\nEnd With\n\n\n\n\nSet ws1 = ThisWorkbook.Sheets(\"TempData\")\n    'change folder path here\n    FolderName = \"J:\\15-0023_Vauquelin\\8.0 Phase-construction\\FdT fictives\"\n    Wbname = Dir(FolderName &amp; \"\\\" &amp; \"*.xls*\")\n\n    'ThisWorkbook.Sheets(1).UsedRange.ClearContents\n    Do While Len(Wbname) &gt; 0\n        Set Wb = Workbooks.Open(FolderName &amp; \"\\\" &amp; Wbname)\n        Set ws = Nothing\n        On Error Resume Next\n        'change sheet name here\n        Set ws = Wb.Sheets(\"Heures\")\n        On Error GoTo 0\n        If Not ws Is Nothing Then\n        lngcol = 0\n        lngrow = lngrow + 1\n        lngcol = lngcol + 1\n        ws.Cells(4, \"C\").Copy ws1.Cells(lngrow, lngcol)\n        lngcol = lngcol + 1\n        ws.Cells(7, \"B\").Copy ws1.Cells(lngrow, lngcol)\n        lngcol = lngcol + 1\n        ws.Cells(50, \"I\").Copy ws1.Cells(lngrow, lngcol)\n        lngcol = lngcol + 1\n        ws.Cells(50, \"H\").Copy ws1.Cells(lngrow, lngcol)\n        End If\n        Wb.Close False\n        Wbname = Dir\n    Loop\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = lngCalc\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6320434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90a91c3cbba915f35018fcf0db6c32ec?s=128&d=identicon&r=PG&f=1", "display_name": "stephen k", "link": "https://stackoverflow.com/users/6320434/stephen-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 37213816, "answer_count": 1, "score": -5, "last_activity_date": 1463153048, "creation_date": 1462972362, "last_edit_date": 1462973411, "question_id": 37163771, "link": "https://stackoverflow.com/questions/37163771/compiling-data-from-all-workbooks-in-a-folder", "title": "Compiling data from all workbooks in a folder", "body": "<p>I have a folder with 150+ timesheets that are formatted the exact same way and that I want compiled in a \"master\" workbook. Namely, I need 4 cells per timesheet to be replicated in the master:</p>\n\n<p>Cell C4 (date)\nCell B7 (name of employee)\nCell I50 (hours on site)\nCell H50 (hours in office)</p>\n\n<p>The master workbook would have to look like this:</p>\n\n<p>[Master workbook: the goal][1]</p>\n\n<p>Simply said: I need a macro that runs though all excel files in a specific folder and copies information to a \"master\" workbook.</p>\n\n<p>I'm not an expert at this but I can handle some beginner level macros. I really need this so any help is appreciated! Thanks!</p>\n\n<p>EDIT: I found a macro that copies the second row of each file. That's a starting point but I don't have the skills to edit it...</p>\n\n<pre><code> Sub ConFiles()\n\n    Dim Wbname As String\n    Dim Wb As Workbook\n    Dim ws As Worksheet\n    Dim ws1 As Worksheet\n    Dim lngCalc As Long\n    Dim lngrow As Long\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n        lngCalc = .CalculationState\n        .Calculation = xlCalculationManual\n    End With\n\n\n   Set ws1 = ThisWorkbook.Sheets.Add\n    'change folder path here\n    FolderName = \"J:\\15-0023_Vauquelin\\8.0 Phase-construction\\FdT fictives\"\n    Wbname = Dir(FolderName &amp; \"\\\" &amp; \"*.xls*\")\n\n    'ThisWorkbook.Sheets(1).UsedRange.ClearContents\n    Do While Len(Wbname) &gt; 0\n        Set Wb = Workbooks.Open(FolderName &amp; \"\\\" &amp; Wbname)\n        Set ws = Nothing\n        On Error Resume Next\n        'change sheet name here\n        Set ws = Wb.Sheets(\"Heures\")\n        On Error GoTo 0\n        If Not ws Is Nothing Then\n        lngrow = lngrow + 1\n        ws.Rows(2).Copy ws1.Cells(lngrow, \"A\")\n        End If\n        Wb.Close False\n        Wbname = Dir\n    Loop\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = lngCalc\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "reference"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 2, "creation_date": 1462971384, "post_id": 37163302, "comment_id": 61862078, "body": "Try <code>Debug.Print (WB.Worksheets(&quot;NameOfSheet&quot;).Range(&quot;named_cell&quot;).Value)</code> instead."}, {"owner": {"reputation": 11403, "user_id": 263589, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/C1Xw0.jpg?s=128&g=1", "display_name": "speendo", "link": "https://stackoverflow.com/users/263589/speendo"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462972223, "post_id": 37163302, "comment_id": 61862801, "body": "Thank you! This works. However, it&#39;s a bit strange that I can access the reference of a named range without specifying the sheet name but not the content... Is there really no way?"}], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 5, "last_activity_date": 1462972279, "creation_date": 1462972279, "answer_id": 37163734, "question_id": 37163302, "link": "https://stackoverflow.com/questions/37163302/access-value-content-of-a-named-cell-in-excel-vba/37163734#37163734", "title": "access value (content) of a named cell in Excel VBA", "body": "<p>Couple of ways:</p>\n\n<pre><code>Debug.Print Range(\"Named_Range\").Value\nDebug.Print [Named_Range].Value '// This uses the evaluate method\n</code></pre>\n\n<p>You don't need to qualify a named range with a sheet object if it's in the active workbook (which it should be as it's the last workbook you opened).</p>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1462972563, "creation_date": 1462972563, "answer_id": 37163842, "question_id": 37163302, "link": "https://stackoverflow.com/questions/37163302/access-value-content-of-a-named-cell-in-excel-vba/37163842#37163842", "title": "access value (content) of a named cell in Excel VBA", "body": "<p>Once the Named Range has been established, Excel knows its <code>Parent</code>, so:</p>\n\n<pre><code>Sub dural()\n    Dim r As Range\n    Set r = Range(\"named_cell\")\n    MsgBox r.Parent.Name &amp; vbCrLf &amp; r.Address(0, 0) &amp; vbCrLf &amp; r.Value\nEnd Sub\n</code></pre>\n\n<p>is one way to get info about this range:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ud5Cw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ud5Cw.png\" alt=\"enter image description here\"></a></p>\n\n<p>This uses the properties of the <em>Range</em> Object rather than the <em>Workbook</em> Object.</p>\n"}, {"comments": [{"owner": {"reputation": 11403, "user_id": 263589, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/C1Xw0.jpg?s=128&g=1", "display_name": "speendo", "link": "https://stackoverflow.com/users/263589/speendo"}, "edited": false, "score": 0, "creation_date": 1462974077, "post_id": 37164301, "comment_id": 61864315, "body": "That&#39;s it! Thank you!"}], "tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": true, "score": 5, "last_activity_date": 1462973648, "last_edit_date": 1495540357, "creation_date": 1462973648, "answer_id": 37164301, "question_id": 37163302, "link": "https://stackoverflow.com/questions/37163302/access-value-content-of-a-named-cell-in-excel-vba/37164301#37164301", "title": "access value (content) of a named cell in Excel VBA", "body": "<p>If <code>WB.Names(\"named_cell\")</code> returns a <code>Name</code> object, then this object has a <code>RefersToRange</code> property. That returns the Range object referred to by a Name object. See <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834918.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff834918.aspx</a>.</p>\n\n<p>So</p>\n\n<pre><code>Debug.Print WB.Names(\"named_cell\").RefersToRange.Value\n</code></pre>\n\n<p>See also <a href=\"https://stackoverflow.com/questions/32604412/malfunction-of-excel-vba-own-function-when-open-other-excel-file/32606967#32606967\">Malfunction of Excel-VBA own function when open other excel-file</a>.</p>\n"}], "owner": {"reputation": 11403, "user_id": 263589, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/C1Xw0.jpg?s=128&g=1", "display_name": "speendo", "link": "https://stackoverflow.com/users/263589/speendo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7641, "favorite_count": 0, "accepted_answer_id": 37164301, "answer_count": 3, "score": 5, "last_activity_date": 1462973648, "creation_date": 1462971205, "question_id": 37163302, "link": "https://stackoverflow.com/questions/37163302/access-value-content-of-a-named-cell-in-excel-vba", "title": "access value (content) of a named cell in Excel VBA", "body": "<p>This</p>\n\n<pre><code>Dim WB As Workbook\nSet WB = Workbooks.Open(\"foo\\bar.xlsx\", , True)\nDebug.Print (WB.Names(\"named_cell\").Value)\nWB.Close (False)\n</code></pre>\n\n<p>returns</p>\n\n<pre><code>='Sheet'!$C$377\n</code></pre>\n\n<p>instead of the value in the cell <code>C377</code>.</p>\n\n<p>How can I receive the value of the cell instead?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2046, "user_id": 6216216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e055d8eee151322d496f655f12088a?s=128&d=identicon&r=PG&f=1", "display_name": "Leviathan", "link": "https://stackoverflow.com/users/6216216/leviathan"}, "edited": false, "score": 0, "creation_date": 1465591563, "post_id": 37163279, "comment_id": 62983133, "body": "Did my answer solve your problem? You should accept the answer that best solves your problem. That a valuable signal to other who stumble accross your question later on. Also, accepting an answer provides reputation to the answerer, and you get a small amount as well!"}], "answers": [{"tags": [], "owner": {"reputation": 2046, "user_id": 6216216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e055d8eee151322d496f655f12088a?s=128&d=identicon&r=PG&f=1", "display_name": "Leviathan", "link": "https://stackoverflow.com/users/6216216/leviathan"}, "is_accepted": false, "score": 0, "last_activity_date": 1462995592, "creation_date": 1462995592, "answer_id": 37171883, "question_id": 37163279, "link": "https://stackoverflow.com/questions/37163279/vba-excel-subtracting-active-sheet-cell-from-prior-day-sheet-cell/37171883#37171883", "title": "VBA EXcel - Subtracting active sheet cell from prior day sheet cell", "body": "<p>If you add a sheet with VBA you get a reference to that worksheet in return. Just save it to a variable and you can access it later on:</p>\n\n<pre><code>Set ws2 = ThisWorkbook.Sheets.Add(\"05.11.16\")\n</code></pre>\n\n<p>You can use the workbook's <code>Address</code> property (possibly with the fourth parameter set to True) to retrieve the address that you have to change your formula to.</p>\n"}], "owner": {"reputation": 37, "user_id": 2657664, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1546187333/picture?type=large", "display_name": "Goofy_1969", "link": "https://stackoverflow.com/users/2657664/goofy-1969"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1462995592, "creation_date": 1462971147, "last_edit_date": 1462978464, "question_id": 37163279, "link": "https://stackoverflow.com/questions/37163279/vba-excel-subtracting-active-sheet-cell-from-prior-day-sheet-cell", "title": "VBA EXcel - Subtracting active sheet cell from prior day sheet cell", "body": "<p>I have a spreadsheet that I track the daily inventory by account and make sure I balance to the G/L. I have a VBA set up that creates my new sheet and names it as per current date. At the bottom of the sheet I have formulas that give me the change in inventory value from today minus yesterday. Since that formula isn't something I need to \"update\" daily I am looking to write the formula in the VBA.</p>\n\n<p>I am getting myself caught up on how to write the VBA for the change in sheet name when the new sheet is created.</p>\n\n<p>For example, I have a sheet named \"05.10.16\" that has a formula that takes <code>B8 - '05.09.16'!B8</code> and shows the result. So I open the spreadsheet today and create today's sheet, \"05.11.16\".</p>\n\n<p>What is the coding I need in VBA to update that formula <code>ActiveCell.Formula = \"B8 - ws2.cell(B8)\"</code>?</p>\n\n<p>I have <code>set ws1 = ActiveSheet</code>, but having trouble defining <code>ws2</code>. <code>ws2</code> will be a moving target once the new sheet is added for the day.</p>\n"}, {"tags": ["vba", "excel", "vbscript"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1462971306, "post_id": 37163252, "comment_id": 61862002, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/13133126/calling-a-vbs-script-from-excel-vba\">Calling a .vbs script from Excel VBA</a>"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 1, "creation_date": 1462972446, "post_id": 37163252, "comment_id": 61862987, "body": "Currently, sFilename will look like <code>c:\\foo\\bar\\c:\\Users\\266...</code> You are concatening two absolute paths"}], "answers": [{"comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1462972734, "post_id": 37163655, "comment_id": 61863219, "body": "Windows manage spaces in paths. And this is not sent to a shell so a space should not matter"}], "tags": [], "owner": {"reputation": 230, "user_id": 6315250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112f4f5e97d29472976c863f1c8a7ac0?s=128&d=identicon&r=PG&f=1", "display_name": "timthebomb", "link": "https://stackoverflow.com/users/6315250/timthebomb"}, "is_accepted": false, "score": -1, "last_activity_date": 1462972160, "last_edit_date": 1462972160, "creation_date": 1462972051, "answer_id": 37163655, "question_id": 37163252, "link": "https://stackoverflow.com/questions/37163252/running-vba-script-file-from-excel-macro/37163655#37163655", "title": "Running VBA script file from excel macro", "body": "<p>Could be an issue with the space in your reference.</p>\n\n<pre><code>\"C:\\Users\\266720\\AppData\\Roaming\\SAP\\SAP GUI\\Scripts\\Script7-pa30.vbs\"\n</code></pre>\n\n<p>I would change the folder name to SAP_GUI and see how that works, or use double quotes around the whole line.</p>\n\n<pre><code>\"\"\"C:\\Users\\266720\\AppData\\Roaming\\SAP\\SAP GUI\" &amp; \"\\Scripts\\Script7-pa30.vbs\"\"\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6320416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b48ac6edf1a46f2b68d62ace58eefcb?s=128&d=identicon&r=PG&f=1", "display_name": "Vinothkumar", "link": "https://stackoverflow.com/users/6320416/vinothkumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 215, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462975272, "creation_date": 1462971074, "last_edit_date": 1462975272, "question_id": 37163252, "link": "https://stackoverflow.com/questions/37163252/running-vba-script-file-from-excel-macro", "title": "Running VBA script file from excel macro", "body": "<p>I'm trying to run a vbscript file from excel macro, can anyone please help.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim sFilename As String\nsFilename = ActiveWorkbook.Path &amp; \"C:\\Users\\266720\\AppData\\Roaming\\SAP\\SAP GUI\\Scripts\\Script7-pa30.vbs\"\nsFilename.Run\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462971086, "post_id": 37163064, "comment_id": 61861802, "body": "While this is not your first post to this site, allow me to remind you that this is not a free code-writing service. Yet, we are eager to help fellow programmers (and aspirants) with <b>their</b> code. Please read the help topics on <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I Ask a Good Question</a> once again. Afterwards, please update your question with the VBA code you have written thus far in order to complete the task(s) you wish to achieve."}, {"owner": {"reputation": 98, "user_id": 4859515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1cdcb8f93603189e9d03f048249de56?s=128&d=identicon&r=PG&f=1", "display_name": "freakfeuer", "link": "https://stackoverflow.com/users/4859515/freakfeuer"}, "edited": false, "score": 0, "creation_date": 1462971112, "post_id": 37163064, "comment_id": 61861830, "body": "In addition to the comment from Ralph, I think if you provide the data you imported it might be easier to fix the import to avoid the problem you got."}], "owner": {"reputation": 11, "user_id": 5502875, "user_type": "registered", "profile_image": "https://graph.facebook.com/894613107274469/picture?type=large", "display_name": "Zane ", "link": "https://stackoverflow.com/users/5502875/zane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462971138, "creation_date": 1462970545, "last_edit_date": 1531164843, "question_id": 37163064, "link": "https://stackoverflow.com/questions/37163064/excel-vba-shift-cells-without-date-format", "title": "excel vba shift cells without date format", "body": "<p>I have a data set imported into excel with 645,000 rows. Sometimes the names are inserted into the columns with dates when the name should all be in one cell. Is there any way to write a vba code that would copy the name into the cell and shift the other data over?<a href=\"http://i.stack.imgur.com/weymC.png\" rel=\"nofollow\">screenshot of the data</a> I would like to move John into the cell with Doe and shift the rest of the data one cell to the left</p>\n"}, {"tags": ["sql", "vba", "ms-access-2013"], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 6318893, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/14a16578c4694a8c6f09f0165d99ba38?s=128&d=identicon&r=PG&f=1", "display_name": "zkhan", "link": "https://stackoverflow.com/users/6318893/zkhan"}, "edited": false, "score": 0, "creation_date": 1462987317, "post_id": 37163185, "comment_id": 61873652, "body": "Thanks for the response. However, I don&#39;t understand why we use the symbols [ &quot; &amp; before the variable. Can you explain what each of those does?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 147, "user_id": 6318893, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/14a16578c4694a8c6f09f0165d99ba38?s=128&d=identicon&r=PG&f=1", "display_name": "zkhan", "link": "https://stackoverflow.com/users/6318893/zkhan"}, "edited": false, "score": 1, "creation_date": 1462993859, "post_id": 37163185, "comment_id": 61877446, "body": "@zkhan: see edit, but I fear that if you are <i>that</i> new with coding in VBA, you should look for a tutorial / introduction to VBA, before creating and running ALTER TABLE statements on the fly."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1462993722, "last_edit_date": 1462993722, "creation_date": 1462970924, "answer_id": 37163185, "question_id": 37162839, "link": "https://stackoverflow.com/questions/37162839/adding-new-field-to-table-in-access-using-vba/37163185#37163185", "title": "adding new field to table in access using vba", "body": "<p><code>[monthly]</code> is simply part of the string you are executing, it is not automatically resolved from the variable with the same name.</p>\n\n<p>You need string concatenation:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim S As String\n\nS = \"ALTER TABLE tblEPdata ADD COLUMN [\" &amp; monthly &amp; \"] string;\"\nDebug.Print S\ndb.Execute S\n</code></pre>\n\n<p><code>Debug.Print</code> helps with debugging, the output goes to the Immediate window (Ctrl+G).</p>\n\n<p>Notice the syntax coloring in the above code.</p>\n\n<pre><code>\"ALTER TABLE tblEPdata ADD COLUMN [\"\n</code></pre>\n\n<p>is a constant string.</p>\n\n<p><code>&amp;</code> concatenates strings and variables into a new string.</p>\n\n<p>The [square brackets] are needed because your field names contain spaces (e.g. <code>WP M2</code>).</p>\n"}], "owner": {"reputation": 147, "user_id": 6318893, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/14a16578c4694a8c6f09f0165d99ba38?s=128&d=identicon&r=PG&f=1", "display_name": "zkhan", "link": "https://stackoverflow.com/users/6318893/zkhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2212, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462993722, "creation_date": 1462969996, "last_edit_date": 1462970778, "question_id": 37162839, "link": "https://stackoverflow.com/questions/37162839/adding-new-field-to-table-in-access-using-vba", "title": "adding new field to table in access using vba", "body": "<p>I get an error in the line with the alter table command. I'm trying to create a field for each month based on the variable monthly using a loop, however it is not going through since I don't get the desired result. The code creates a column called monthly and then gives an error on the second iteration. Code is as follows:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim x As Integer\nDim Months As Integer\nDim monthly As String\n\nMonths = Me.YearsBack * 12\n\nSet db = CurrentDb\nIf Me.Period = \"monthly\" Then\n    For x = 1 To 2\n    'Months\n    monthly = \"WP M\" &amp; x\n    db.Execute \"ALTER TABLE tblEPdata ADD COLUMN [monthly] string;\"\n    Next\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "function"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1462970341, "post_id": 37162614, "comment_id": 61861133, "body": "Could you please elaborate on &quot;[...] but when I attempt to run them through a VBA code it doesn&#39;t work.&quot;? How are you trying to run these in VBA and what is not working while you are attempting this? To answer your question: it depends on your VBA skills if you are able to write code which does the same job. Yet, it is certainly possible to write VBA code to mimic these functions."}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1462970366, "post_id": 37162614, "comment_id": 61861153, "body": "You cannot just use functions that you use in a formula directly in the code. Look at the <code>Application.WorksheetFunction</code> object <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834434.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff834434.aspx</a>"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 6234420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c4aff8d7d8b32fe7d652e488ca9a6125?s=128&d=identicon&r=PG&f=1", "display_name": "Niko", "link": "https://stackoverflow.com/users/6234420/niko"}, "edited": false, "score": 0, "creation_date": 1462971012, "post_id": 37163086, "comment_id": 61861725, "body": "Fantastic, Thanks!"}], "tags": [], "owner": {"reputation": 116, "user_id": 5982062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFQvV.jpg?s=128&g=1", "display_name": "wallyeye", "link": "https://stackoverflow.com/users/5982062/wallyeye"}, "is_accepted": true, "score": 0, "last_activity_date": 1462971993, "last_edit_date": 1462971993, "creation_date": 1462970621, "answer_id": 37163086, "question_id": 37162614, "link": "https://stackoverflow.com/questions/37162614/worksheet-function-in-vba-code/37163086#37163086", "title": "Worksheet function in VBA code", "body": "<p>The trick is to double up on the double quotes:</p>\n\n<pre><code>Range(\"j14\").formula = \"=countifs(b:b,\"\"&gt;\"\" ...\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 6234420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c4aff8d7d8b32fe7d652e488ca9a6125?s=128&d=identicon&r=PG&f=1", "display_name": "Niko", "link": "https://stackoverflow.com/users/6234420/niko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 37163086, "answer_count": 1, "score": 0, "last_activity_date": 1462971993, "creation_date": 1462969430, "last_edit_date": 1462969599, "question_id": 37162614, "link": "https://stackoverflow.com/questions/37162614/worksheet-function-in-vba-code", "title": "Worksheet function in VBA code", "body": "<p>I have two worksheet functions that work fine when I type them directly in a cell, but when I attempt to run them through a VBA code it doesn't work. The functions are as follows:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>=COUNTIFS(B:B,\"&gt;\"&amp;DATE(2015,12,31),I:I,\"&lt;&gt;\"&amp;\"\",G:G,\"=FALSE\")\n\n=SUMIFS(I:I,B:B,\"&gt;\"&amp;DATE(2015,12,31),G:G,\"=FALSE\")\n</code></pre>\n\n<p>The functions are intended to be in cell J14 respectively J15</p>\n\n<p>Can I write a code that does the same job?\nThanks in Advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462970510, "post_id": 37162501, "comment_id": 61861278, "body": "Welcome to StackOverflow. Please note, that this is not a free code-writing service. Yet, we are eager to help fellow programmers (and aspirants) with <b>their</b> code. Please read the help topics on <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I Ask a Good Question</a>. You might also want to <a href=\"http://stackoverflow.com/tour\">take the tour</a> and earn a badge while doing so. Afterwards, please update your question with the VBA code you have written thus far in order to complete the task(s) you wish to achieve. BTW: &quot;row A&quot; in your post is probably a typo and should be row 1, right?"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 6320231, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f13345bbd5d806bce9a4abcf9b7ddfff?s=128&d=identicon&r=PG&f=1", "display_name": "James Hurst", "link": "https://stackoverflow.com/users/6320231/james-hurst"}, "edited": false, "score": 0, "creation_date": 1462979126, "post_id": 37162906, "comment_id": 61868340, "body": "You, my friend, are a gentleman and a scholar! I have been struggling with this for a while. If I could kiss you I would!"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 63, "user_id": 6320231, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f13345bbd5d806bce9a4abcf9b7ddfff?s=128&d=identicon&r=PG&f=1", "display_name": "James Hurst", "link": "https://stackoverflow.com/users/6320231/james-hurst"}, "edited": false, "score": 0, "creation_date": 1463168899, "post_id": 37162906, "comment_id": 61967501, "body": "@JamesHurst  Glad to help."}, {"owner": {"reputation": 63, "user_id": 6320231, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f13345bbd5d806bce9a4abcf9b7ddfff?s=128&d=identicon&r=PG&f=1", "display_name": "James Hurst", "link": "https://stackoverflow.com/users/6320231/james-hurst"}, "edited": false, "score": 0, "creation_date": 1463174309, "post_id": 37162906, "comment_id": 61969878, "body": "Gary, you have been such a tremendous help, can you maybe look at another question Ive asked? <a href=\"http://stackoverflow.com/questions/37219465/join-cells-based-on-value-of-a-cell-vba\" title=\"join cells based on value of a cell vba\">stackoverflow.com/questions/37219465/&hellip;</a>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1462970174, "creation_date": 1462970174, "answer_id": 37162906, "question_id": 37162501, "link": "https://stackoverflow.com/questions/37162501/cut-paste-data-based-on-found-cell-value-in-vba/37162906#37162906", "title": "cut paste data based on found cell value in VBA", "body": "<p>This should give you a start:</p>\n\n<pre><code>Sub summary()\n    Dim sh1 As Worksheet, sh2 As Worksheet\n    Dim N As Long, i As Long, r1 As Range, r2 As Range\n\n    Set sh1 = Sheets(\"Sheet1\")\n    Set sh2 = Sheets(\"Sheet2\")\n    Set r2 = sh2.Range(\"A1\")\n\n    With sh1\n        N = .Cells(Rows.Count, \"A\").End(xlUp).Row\n        For i = 1 To N\n            If .Cells(i, \"A\").Value = \"Summary\" Then\n                Set r1 = Range(.Cells(i, \"A\"), .Cells(N, \"G\"))\n                r1.Copy r2\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 6320231, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f13345bbd5d806bce9a4abcf9b7ddfff?s=128&d=identicon&r=PG&f=1", "display_name": "James Hurst", "link": "https://stackoverflow.com/users/6320231/james-hurst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 716, "favorite_count": 0, "accepted_answer_id": 37162906, "answer_count": 1, "score": 0, "last_activity_date": 1462970174, "creation_date": 1462969155, "last_edit_date": 1531164843, "question_id": 37162501, "link": "https://stackoverflow.com/questions/37162501/cut-paste-data-based-on-found-cell-value-in-vba", "title": "cut paste data based on found cell value in VBA", "body": "<p>I have trawled though hours of searches trying to find an answer to my problem. </p>\n\n<p>It seemed an easy enough task, in that I would like to cut data from sheet1 and paste in sheet 2. I was successful in doing this but the data had to remain in the same locations.</p>\n\n<p>The data is imported and each time the location of where I would like to cut from changes. </p>\n\n<p>I basically need to search column A for the word \"Summary\" (the only word which is always in the same column), when found I would like to cut the \"Summary\" row and everything below and across to column G until empty cells (this data is always at the bottom, but the row number will vary)</p>\n\n<p>The cut data needs to be pasted into sheet2 column A row A.</p>\n\n<p>I hope there is someone who has something similar which i could tailor to my own needs.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "attachmate-extra"], "comments": [{"owner": {"reputation": 1286, "user_id": 6122062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43dd41fb587ae514e874f9167fd74a4c?s=128&d=identicon&r=PG&f=1", "display_name": "bassfader", "link": "https://stackoverflow.com/users/6122062/bassfader"}, "edited": false, "score": 0, "creation_date": 1462968047, "post_id": 37161954, "comment_id": 61859361, "body": "Have you tried to set a breakpoint in one of the <code>Do While</code> loops and ensured that <code>Sess0.Screen.OIA.Xstatus</code> will actually change to something else than <code>0</code>? Otherwise (when <code>Sess0.Screen.OIA.Xstatus</code> stays at <code>0</code>) this might be the cause of the issue."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1462968059, "post_id": 37161954, "comment_id": 61859374, "body": "Do you mean 10-15 seconds after the code has <i>finished</i> ? If so then you&#39;ve probably not closed or released a COM object properly or something. If it&#39;s <i>while</i> the code is running then press Ctrl+Break to pause execution and see what line is causing the issue."}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1463044596, "post_id": 37161954, "comment_id": 61898114, "body": "i&#39;s a bit strange seeing those two  <code>do while</code> inside a <code>for</code> loop. I don&#39;t see what you are trying to achieve..."}, {"owner": {"reputation": 305, "user_id": 4582026, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/042c4604042b6c28a0fb03a9b0cd89fb?s=128&d=identicon&r=PG&f=1", "display_name": "Vik", "link": "https://stackoverflow.com/users/4582026/vik"}, "reply_to_user": {"reputation": 1286, "user_id": 6122062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43dd41fb587ae514e874f9167fd74a4c?s=128&d=identicon&r=PG&f=1", "display_name": "bassfader", "link": "https://stackoverflow.com/users/6122062/bassfader"}, "edited": false, "score": 0, "creation_date": 1463055609, "post_id": 37161954, "comment_id": 61906077, "body": "@bassfader The macro does reach the end, so I am not too sure if it gets stuck in the loop. I have however taken your suggestion onboard and adapted it to <code>Do Until Sess0.Screen.OIA.Xstatus = 0     DoEvents     Loop</code>, which does the same thing but fixes the issue that may arise as you said. However this does not fix the original problem of the freezing."}, {"owner": {"reputation": 305, "user_id": 4582026, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/042c4604042b6c28a0fb03a9b0cd89fb?s=128&d=identicon&r=PG&f=1", "display_name": "Vik", "link": "https://stackoverflow.com/users/4582026/vik"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1463055778, "post_id": 37161954, "comment_id": 61906197, "body": "@MacroMan It is not always 10-15 seconds, my apologies. Sometimes it can be when I switch straight over to the mainframe and start manually entering data, excel will freeze. It is never during the code running, always at least 10 seconds once it finishes"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1463055891, "post_id": 37161954, "comment_id": 61906287, "body": "Are you working with a file on a network drive?"}, {"owner": {"reputation": 305, "user_id": 4582026, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/042c4604042b6c28a0fb03a9b0cd89fb?s=128&d=identicon&r=PG&f=1", "display_name": "Vik", "link": "https://stackoverflow.com/users/4582026/vik"}, "reply_to_user": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1463055977, "post_id": 37161954, "comment_id": 61906368, "body": "@PatrickLepelletier The point of the <code>do while</code>, is to wait for the mainframe to to finish all of its processes before continuing. Waiting for the <code>sess0.screen.OIA.Xstatus </code> to be 0, meaning all processes are done before carrying on. I did try using the <code>application.wait </code> method and  <code>wait.host.quiet </code>, however these froze the code whilst running. Any other suggestions?"}, {"owner": {"reputation": 305, "user_id": 4582026, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/042c4604042b6c28a0fb03a9b0cd89fb?s=128&d=identicon&r=PG&f=1", "display_name": "Vik", "link": "https://stackoverflow.com/users/4582026/vik"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1463056110, "post_id": 37161954, "comment_id": 61906468, "body": "@MacroMan Nope, the plan was to put it on a network drive, however right now it is not."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1463056353, "post_id": 37161954, "comment_id": 61906663, "body": "@Vik just to clarify, if the code finished then it&#39;s nothing to do with the code <i>per se</i> - VBA doesn&#39;t cope well with processes or threading, and so it could be a message being sent by the code, but received after the code has finished causing some kind of deadlock or something. All hypothetical at this point but I don&#39;t think there is anything you can do in  the code other than add something at the end to act as a listener for anything being returned or something..."}, {"owner": {"reputation": 305, "user_id": 4582026, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/042c4604042b6c28a0fb03a9b0cd89fb?s=128&d=identicon&r=PG&f=1", "display_name": "Vik", "link": "https://stackoverflow.com/users/4582026/vik"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1463056775, "post_id": 37161954, "comment_id": 61907000, "body": "@MacroMan That is unfortunate, well thank you for your help. I will still persist in trying to find a solution, if I do, I will post it here. Thank you once again."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1463056930, "post_id": 37161954, "comment_id": 61907118, "body": "@Vik does the <code>system</code> object not have a <code>.Quit()</code> method or similar? Using <code>Set system = Nothing</code> is simply releasing the object from memory, it&#39;s not actually terminating the process (if you look at task manager you will see what I mean)"}, {"owner": {"reputation": 305, "user_id": 4582026, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/042c4604042b6c28a0fb03a9b0cd89fb?s=128&d=identicon&r=PG&f=1", "display_name": "Vik", "link": "https://stackoverflow.com/users/4582026/vik"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1463060485, "post_id": 37161954, "comment_id": 61909986, "body": "@MacroMan it does have a quit option, however it is not something I want to do, since the plan is to continue using the system"}], "owner": {"reputation": 305, "user_id": 4582026, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/042c4604042b6c28a0fb03a9b0cd89fb?s=128&d=identicon&r=PG&f=1", "display_name": "Vik", "link": "https://stackoverflow.com/users/4582026/vik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 687, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462967797, "creation_date": 1462967797, "last_edit_date": 1531164843, "question_id": 37161954, "link": "https://stackoverflow.com/questions/37161954/vba-script-causing-excel-to-stop-responding", "title": "VBA script causing excel to stop responding", "body": "<p>I have the following vba code running from excel which interacts with the an additional program perfectly.</p>\n\n<pre><code>' Global variable declarations\nPublic g_HostSettleTime%\nPublic g_szPassword$\nPublic Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As LongPtr)\n\nSub PlanGroups()\n\n\n'--------------------------------------------------------------------------------\n' Get the main system object\n    Dim Sessions As Object\n    Dim System As Object\n\n    If MsgBox(\"Is your mainframe is on screen TOP MNU? Do you have access to PCMB03?\", vbYesNo) = vbNo Then\n\nExit Sub\nEnd If\n\n\n\n    Set System = GetObject(\"\", \"EXTRA.System\")\n        If System Is Nothing Then\n            Set System = CreateObject(\"EXTRA.System\")\n    If (System Is Nothing) Then\n        MsgBox \"Could not create the EXTRA System object.  Stopping macro playback.\"\n        Stop\n    End If\n        End If\n    Set System = CreateObject(\"EXTRA.System\")   ' Gets the system object\n    If (System Is Nothing) Then\n        MsgBox \"Could not create the EXTRA System object.  Stopping macro playback.\"\n        Stop\n    End If\n\n    Set Sessions = System.Sessions.Open(\"C:\\Program Files (x86)\\E!PC\\Sessions\\Mainfrme.edp\")\n        If Sessions Is Nothing Then\n            Set Sessions = System.Sessions.Open(\"C:\\Program Files (x86)\\E!PC\\Sessions\\Mainframe.edp\")\n            If MySession Is Nothing Then\n                Response = MsgBox(\"Could not create the EXTRA Session object\", vbCritical, \"EXTRA Session\")\n                End\n            End If\n        End If\n\n\n'--------------------------------------------------------------------------------\n' Set the default wait timeout value\n    g_HostSettleTime = 30       ' milliseconds\n\n    OldSystemTimeout&amp; = System.TimeoutValue\n    If (g_HostSettleTime &gt; OldSystemTimeout) Then\n        System.TimeoutValue = g_HostSettleTime\n    End If\n\n' Get the necessary Session Object\n    Dim Sess0 As Object\n    Set Sess0 = System.ActiveSession\n    If (Sess0 Is Nothing) Then\n        MsgBox \"Could not create the Session object.  Stopping macro playback.\"\n        Stop\n    End If\n    If Not Sess0.Visible Then Sess0.Visible = True\n\n\n 'paste macro below\nWorksheets(\"ADD PLANNING GROUPS\").Activate\n\nIf Application.CountA(Range(\"A9\")) = 0 Then\n            MsgBox \"PLEASE ENTER VALID DATA STARTING FROM ROW 9!\"\n            Set System = Nothing\nSet Sessions = Nothing\nSet Sess0 = Nothing\n\n            Exit Sub\n\nEnd If\n\n\n\nSheets(\"ADD PLANNING GROUPS\").Cells(1, 1).Value = Sess0.Screen.GetString(2, 3, 7)\n\nIf Not Sheets(\"ADD PLANNING GROUPS\").Cells(1, 1) = (\"TOP MNU\") Then\n    MsgBox \"You are not in TOP MNU...Liar.\"\n    Sheets(\"ADD PLANNING GROUPS\").Cells(1, 1).Clear\n    Set System = Nothing\nSet Sessions = Nothing\nSet Sess0 = Nothing\n\n    Exit Sub\n    End If\nSheets(\"ADD PLANNING GROUPS\").Cells(1, 1).Clear\n\n\n\nIf IsEmpty(Sheets(\"ADD PLANNING GROUPS\").Cells(8, 4).Value) Then\n    MsgBox \"Enter a valid Mainframe ID.\"\nSet System = Nothing\nSet Sessions = Nothing\nSet Sess0 = Nothing\n\n    Exit Sub\n    End If\n\n\nSess0.Screen.MoveTo 24, 72\nSess0.Screen.SendKeys (\"PCMB03&lt;PF2&gt;\")\n  Do While Sess0.Screen.OIA.Xstatus &lt;&gt; 0\n    DoEvents\n    Loop\n\n\n\n    Dim rngFoundG As Range\n\n    With Sheets(\"ADD PLANNING GROUPS\")\n        Set rngFoundG = .Columns(\"A:A\").Find(\"\", After:=.Range(\"A8\"), _\n            SearchDirection:=xlDown)\n\n    End With\n\n\n\n\nDim PlanGroup As String\nDim MainFrameID As String\nMainFrameID = Sheets(\"ADD PLANNING GROUPS\").Cells(8, 4).Value\nSleep (50)\nSess0.Screen.MoveTo 6, 25\nSess0.Screen.SendKeys (MainFrameID &amp; \"&lt;ENTER&gt;\")\nSheets(\"ADD PLANNING GROUPS\").Cells(8, 5).Value = Sess0.Screen.GetString(6, 38, 30)\n\n\nLastCell = rngFoundG.Row - 1\n\nFor i = 9 To LastCell\nSleep (50)\nPlanGroup = Format(Cells(i, \"A\").Value, \"0000\")\nSess0.Screen.MoveTo 10, 38\n    Sess0.Screen.SendKeys (\"&lt;EraseEOF&gt;\" &amp; PlanGroup &amp; \"&lt;Enter&gt;\")\n  Do While Sess0.Screen.OIA.Xstatus &lt;&gt; 0\n    DoEvents\n    Loop\n    Sess0.Screen.SendKeys (\"&lt;PF12&gt;\")\n  Do While Sess0.Screen.OIA.Xstatus &lt;&gt; 0\n    DoEvents\n    Loop\n    Sheets(\"ADD PLANNING GROUPS\").Cells(i, 2).Value = Sess0.Screen.GetString(23, 2, 17)\n       If Not Sheets(\"ADD PLANNING GROUPS\").Cells(i, 2).Value = \"UPDATE SUCCESSFUL\" Then\n       Sheets(\"ADD PLANNING GROUPS\").Cells(i, 2).Value = \"Error\"\n   End If\nNext\nSet System = Nothing\nSet Sessions = Nothing\nSet Sess0 = Nothing\nSet rngFoundG = Nothing\n\n\n    MsgBox \"Done!\"\nEnd Sub \n</code></pre>\n\n<p>However, the issue after one run through, which is flawless, after approximately 10-15 seconds, excel freezes and needs to be manually closed down. Is there any reason for this? From my research I have set my variables and objects to nothing but this still does not help.</p>\n\n<p>Thank you! </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462966434, "post_id": 37161145, "comment_id": 61858093, "body": "I like this answer because it shows the way and not the resulting code. Yet, I believe it would be even better if you were willing to recap and amend the content of the first link in your post. Link-only answers are not well perceived as the links may expire or move to a different location (rendering your answer useless)."}, {"owner": {"reputation": 98, "user_id": 4859515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1cdcb8f93603189e9d03f048249de56?s=128&d=identicon&r=PG&f=1", "display_name": "freakfeuer", "link": "https://stackoverflow.com/users/4859515/freakfeuer"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462966744, "post_id": 37161145, "comment_id": 61858315, "body": "Thanks for that hint, I will consider this for the future and edit my answer. @Ralph"}], "tags": [], "owner": {"reputation": 98, "user_id": 4859515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1cdcb8f93603189e9d03f048249de56?s=128&d=identicon&r=PG&f=1", "display_name": "freakfeuer", "link": "https://stackoverflow.com/users/4859515/freakfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1462967268, "last_edit_date": 1462967268, "creation_date": 1462965780, "answer_id": 37161145, "question_id": 37160901, "link": "https://stackoverflow.com/questions/37160901/how-to-extract-kg-figure-from-cell/37161145#37161145", "title": "How to extract KG figure from cell", "body": "<p>If you don't want to do this with a macro u can use this method: <a href=\"https://support.office.com/en-us/article/Split-text-into-different-cells-30b14928-5550-41f5-97ca-7a3e9c363ed7\" rel=\"nofollow\">https://support.office.com/en-us/article/Split-text-into-different-cells-30b14928-5550-41f5-97ca-7a3e9c363ed7</a></p>\n\n<p>You can do it this way (see link for better explanation): </p>\n\n<ol>\n<li>Click Data >Text to Columns </li>\n<li>Click Delimited > Next</li>\n<li>Just use <em>Space</em> and <em>Other</em> > <code>/</code> as delimiter</li>\n<li>Click Next</li>\n<li>Choose the format of the resulting cells</li>\n<li>Select the cells you want to insert your splitted data</li>\n</ol>\n\n<hr>\n\n<p>If you want to do this in a macro (excel-vba tag) then use the split function: <a href=\"https://msdn.microsoft.com/en-us/library/6x627e5f(v=vs.90).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/6x627e5f(v=vs.90).aspx</a>\nFirst split with <code>/</code> as delimiter and just use the first entry in the resulting array to split for the <em>space</em> ( <code>\" \"</code> ). From that split you get the KGs as the last entry of the resulting array.</p>\n\n<p>The syntax for using the split function your way is the following:</p>\n\n<pre><code>your_array = split(&lt;your_string&gt;, &lt;delimiter&gt;)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6319689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60ac1fd3a6dbdf4e8d716f8c6e92ad10?s=128&d=identicon&r=PG&f=1", "display_name": "user6319689", "link": "https://stackoverflow.com/users/6319689/user6319689"}, "edited": false, "score": 0, "creation_date": 1463364111, "post_id": 37161714, "comment_id": 62020121, "body": "Excellent formula this is what I&#39;m looking for, is there a way to take off the /PAIL, /DRUM or /IBC as I only want the number in this instance."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 1, "user_id": 6319689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60ac1fd3a6dbdf4e8d716f8c6e92ad10?s=128&d=identicon&r=PG&f=1", "display_name": "user6319689", "link": "https://stackoverflow.com/users/6319689/user6319689"}, "edited": false, "score": 0, "creation_date": 1463367310, "post_id": 37161714, "comment_id": 62020730, "body": "@user6319689 additional formula in a helper column provided for you to get numeric figure as prima facie It appeared that a single formula will be too complicated.Please see the edit of my post."}], "tags": [], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1463367076, "last_edit_date": 1463367076, "creation_date": 1462967222, "answer_id": 37161714, "question_id": 37160901, "link": "https://stackoverflow.com/questions/37160901/how-to-extract-kg-figure-from-cell/37161714#37161714", "title": "How to extract KG figure from cell", "body": "<p>If your data is in A column then use this formula in B1 for A1 data and fill down.</p>\n\n<pre><code>=RIGHT(A1,LEN(A1)-SEARCH(\"^^\",SUBSTITUTE(A1,\" \",\"^^\",LEN(A1)-LEN(SUBSTITUTE(A1,\" \",\"\"))))+1)\n</code></pre>\n\n<p>Following image shows the results.\n<a href=\"https://i.stack.imgur.com/i0k1V.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/i0k1V.jpg\" alt=\"Image showing sample and formula\"></a></p>\n\n<p>HTH</p>\n\n<p>EDIT:</p>\n\n<p>i Was not quite sure of your requrementsas to whether you want numeric figure or packing size. Anyway I was finding one formula quite complicated. If you can afford another helper column things are quite easy.</p>\n\n<p>Use another formula in C1 and copy down .</p>\n\n<pre><code>=LEFT(B1,FIND(\"KG\",TRIM(B1),1))\n</code></pre>\n\n<p>Screenshot of results is placed below. <a href=\"https://i.stack.imgur.com/7rOR4.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7rOR4.jpg\" alt=\"Sample data to meet OP requirement\"></a></p>\n\n<p>It appeared to me while I was designing this formula that one single function may be too complicated. However I will look into possibilities of a single function.</p>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1462967960, "creation_date": 1462967960, "answer_id": 37162017, "question_id": 37160901, "link": "https://stackoverflow.com/questions/37160901/how-to-extract-kg-figure-from-cell/37162017#37162017", "title": "How to extract KG figure from cell", "body": "<p>Consider the following User Defined Function <em>(UDF)</em>:</p>\n\n<pre><code>Public Function GetKiloGrams(sIN As String) As Double\n    arr = Split(sIN, \" \")\n    GetKiloGrams = 0\n    For Each a In arr\n        If InStr(1, a, \"KG\") &gt; 0 Then\n            brr = Split(a, \"KG\")\n            GetKiloGrams = CDbl(brr(0))\n            Exit Function\n        End If\n    Next a\nEnd Function\n</code></pre>\n\n<p>It parses the data and returns the proper value:</p>\n\n<p><a href=\"https://i.stack.imgur.com/McnDk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/McnDk.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 6319689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60ac1fd3a6dbdf4e8d716f8c6e92ad10?s=128&d=identicon&r=PG&f=1", "display_name": "user6319689", "link": "https://stackoverflow.com/users/6319689/user6319689"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1463367076, "creation_date": 1462965158, "last_edit_date": 1531161705, "question_id": 37160901, "link": "https://stackoverflow.com/questions/37160901/how-to-extract-kg-figure-from-cell", "title": "How to extract KG figure from cell", "body": "<p>I have a set of data similar to the below that I need to easily separate from one cell so I can extract the packsize from.</p>\n\n<ul>\n<li>Dogfood A-2786-M 25KG/PAIL</li>\n<li>Catfood E6601 NS 200KG/DRUM</li>\n<li>Catfood SR9050 18.2KG/PAIL</li>\n<li>Dogfood BU 1000KG/IBC</li>\n</ul>\n\n<p>The pack size can change and the product name can be different but is always a number followed by /PAIL, /DRUM or /IBC</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462966754, "post_id": 37160837, "comment_id": 61858322, "body": "Where is the &quot;real file extension&quot; to be found? Is it part of the link? Then you can easily extract it from there using <code>split</code> or <code>mid</code> together with <code>InStrRev</code>. Or do you want to write code which examines the files and looks for possible headers which identify the files?"}, {"owner": {"reputation": 25, "user_id": 6278300, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/vnESk.png?s=128&g=1", "display_name": "Remus Sarnus", "link": "https://stackoverflow.com/users/6278300/remus-sarnus"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462967606, "post_id": 37160837, "comment_id": 61858982, "body": "@Ralph The real extension is not specified, that&#39;s the problem, most files are jpg, many png and some gif. The ideal solution would be the latter you mentioned, to have the script examine the file and get its extension. Is that doable in VBA?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462969344, "post_id": 37160837, "comment_id": 61860364, "body": "As mentioned <a href=\"http://stackoverflow.com/questions/55869/determine-file-type-of-an-image\">in this post</a> it would be much easier to do this with existing libraries. Yet, you can certainly achieve this also with VBA only. But if you want to take this route then you&#39;ll have to write the code yourself first (while we can help you debug it) or pay someone to do this for you. Alternatively, just get a new picture viewing program which do that for you (recognize pictures regardless of their extensions)."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462969488, "post_id": 37160837, "comment_id": 61860466, "body": "For a <code>.net</code> implementation in Excel using VBA (as suggested in one of the answers to the above referenced question) you might want to have a look at the following: <a href=\"http://www.codeproject.com/Articles/555660/Extend-your-VBA-code-with-Csharp-VB-NET-or-Cpluspl\" rel=\"nofollow noreferrer\">codeproject.com/Articles/555660/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 6278300, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/vnESk.png?s=128&g=1", "display_name": "Remus Sarnus", "link": "https://stackoverflow.com/users/6278300/remus-sarnus"}, "edited": false, "score": 0, "creation_date": 1462975569, "post_id": 37164119, "comment_id": 61865676, "body": "Genius! It gets the correct extension. I&#39;ll try my best to &quot;merge&quot; the 2 scripts together and have yours fetch image links from my csv file. THX!"}, {"owner": {"reputation": 25, "user_id": 6278300, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/vnESk.png?s=128&g=1", "display_name": "Remus Sarnus", "link": "https://stackoverflow.com/users/6278300/remus-sarnus"}, "edited": false, "score": 0, "creation_date": 1463248811, "post_id": 37164119, "comment_id": 61989963, "body": "Hmm, I can&#39;t code, can&#39;t even read it =D. I ended up downloading images and saving them without extension, then add file extensions using a TrID batch. Two steps instead of one, but it does the job."}], "tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": false, "score": 2, "last_activity_date": 1462973173, "creation_date": 1462973173, "answer_id": 37164119, "question_id": 37160837, "link": "https://stackoverflow.com/questions/37160837/vba-download-file-without-extension-get-extension-and-add-it-to-filename/37164119#37164119", "title": "VBA: download file without extension, get extension and add it to filename", "body": "<p>One way would be to parse the <code>Content-Type</code> from the response:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub DownloadLink()\n\n  Const imageLink = \"http://i.stack.imgur.com/9w2PY.png?s=32\"\n  Const filePath = \"C:\\Temp\\myimage\"\n\n  Dim req As Object, content() As Byte, extension$\n\n  ' send the request\n  Set req = CreateObject(\"Msxml2.ServerXMLHTTP.6.0\")\n  req.Open \"GET\", imageLink, False\n  req.Send\n\n  ' get the extension and data\n  extension = \".\" &amp; Split(req.getResponseHeader(\"Content-Type\"), \"/\")(1)\n  content = req.responseBody\n\n  ' write the file\n  Open filePath &amp; extension For Binary Access Write As #1\n      Put #1, 1, content\n  Close #1\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6278300, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/vnESk.png?s=128&g=1", "display_name": "Remus Sarnus", "link": "https://stackoverflow.com/users/6278300/remus-sarnus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1433, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462973173, "creation_date": 1462964976, "question_id": 37160837, "link": "https://stackoverflow.com/questions/37160837/vba-download-file-without-extension-get-extension-and-add-it-to-filename", "title": "VBA: download file without extension, get extension and add it to filename", "body": "<p>This VBA script uses column A as filename, B as image url and adds a \".jpg\" as extension.<br></p>\n\n<p>Problem is that many files are not in jpg format, so it's best to consider them having an unknown extension.<br></p>\n\n<p><strong>Is it possible to tweak the script so that it gets the real file extension before saving the image and add it to filename instead of the user defined \".jpg\" ?</strong><br></p>\n\n<p>The Script</p>\n\n<pre><code>Option Explicit\n'~~&gt; This macro downloads images from urls. Column A=image title, Column B=image URL.\nPrivate Declare Function URLDownloadToFile Lib \"urlmon\" _\nAlias \"URLDownloadToFileA\" (ByVal pCaller As Long, _\nByVal szURL As String, ByVal szFileName As String, _\nByVal dwReserved As Long, ByVal lpfnCB As Long) As Long\n\nDim Ret As Long\n\n'~~&gt; This is where the images will be saved. Change as applicable\nConst FolderName As String = \"C:\\Users\\plus\\Desktop\\INPUT\\\"\n\nSub DOWNLOAD_image_XLS()\n'~~&gt; This is where text is divided into 2 columns right down the \"|\" delimiter\n    Columns(\"A:A\").Select\n    Selection.TextToColumns Destination:=Range(\"A1\") _\n                      , DataType:=xlDelimited _\n                      , Other:=True _\n                      , OtherChar:=\"|\"\n    Dim ws As Worksheet\n    Dim LastRow As Long, i As Long\n    Dim strPath As String\n\n    Set ws = ActiveSheet\n\n    LastRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    For i = 2 To LastRow '&lt;~~ 2 because row 1 has headers\n        strPath = FolderName &amp; ws.Range(\"A\" &amp; i).Value &amp; \".jpg\"\n\n        Ret = URLDownloadToFile(0, ws.Range(\"B\" &amp; i).Value, strPath, 0, 0)\n\n        If Ret = 0 Then\n            ws.Range(\"C\" &amp; i).Value = \"OK\"\n        Else\n            ws.Range(\"C\" &amp; i).Value = \"Failed!\"\n        End If\n    Next i\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462966027, "post_id": 37160001, "comment_id": 61857785, "body": "Welcome to StackOverflow and thank you for the elaborate post. Yet, I was unable to see the immanent question within. Could you please help me? Is the code working or not? If it is not working then please elaborate on the error messages that you get. If your code is incomplete and requires more code to accomplish additional tasks then you&#39;re probably in the wrong place as this site does not offer free code-writing services. If you have working code which requires merely tweaking then you should try <a href=\"http://codereview.stackexchange.com/\">Code Review</a>. So, which one is it? Thanks."}, {"owner": {"reputation": 1, "user_id": 6319303, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WiwQxX9KR0M/AAAAAAAAAAI/AAAAAAAAACs/vG1IDp0ZNeM/photo.jpg?sz=128", "display_name": "Eoin Prunty", "link": "https://stackoverflow.com/users/6319303/eoin-prunty"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1462974256, "post_id": 37160001, "comment_id": 61864479, "body": "Hi Ralph. The first section of code in my edited post &#39;updateRevs&#39; is not working, but the rest is and is just there for context of what I&#39;m trying to do. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6319303, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WiwQxX9KR0M/AAAAAAAAAAI/AAAAAAAAACs/vG1IDp0ZNeM/photo.jpg?sz=128", "display_name": "Eoin Prunty", "link": "https://stackoverflow.com/users/6319303/eoin-prunty"}, "edited": false, "score": 0, "creation_date": 1463062562, "post_id": 37164965, "comment_id": 61911786, "body": "Thanks for the feedback Ralph. As you can probably tell I&#39;m relatively unskilled with VBA! Upon taking your advice, and some intensive Googling  I&#39;ve now gotten it working. I&#39;ll add the code to the original post."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 1, "user_id": 6319303, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WiwQxX9KR0M/AAAAAAAAAAI/AAAAAAAAACs/vG1IDp0ZNeM/photo.jpg?sz=128", "display_name": "Eoin Prunty", "link": "https://stackoverflow.com/users/6319303/eoin-prunty"}, "edited": false, "score": 0, "creation_date": 1463063271, "post_id": 37164965, "comment_id": 61912423, "body": "I am glad to hear that I&#39;ve been able to help you figure out the correct code. Feel free to upvote my answer. When editing your original post, please don&#39;t make the mistake of removing your original post. This is still necessary to show future site visitors the original problem. Rather expand upon your post and <b>add</b> to the bottom a section with the newly updated code (which works)."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 0, "last_activity_date": 1462977868, "last_edit_date": 1462977868, "creation_date": 1462975234, "answer_id": 37164965, "question_id": 37160001, "link": "https://stackoverflow.com/questions/37160001/copy-value-from-a-cell-in-one-sheet-to-a-cell-in-the-last-used-column-in-another/37164965#37164965", "title": "Copy value from a cell in one sheet to a cell in the last used Column in another sheet, if values in two other Columns&#39; values match", "body": "<p>The sub <code>updateRevs</code> cannot work due to a few problems:</p>\n\n<ol>\n<li>You declare <code>j</code> to be a range but then use it as a number.</li>\n<li>The line where you are setting <code>LastRow</code> is not explicit and should include the sheet (<code>r.Rows.Count</code>).</li>\n<li>The <code>Do Until</code> loop will never end because <code>j</code> is just going from 1 to the <code>LastRow</code> (which still contains data). So, here is an endless loop making the code run forever. I am not quite sure what you want to achieve here. Hence I do not know what to suggest as an improvement.</li>\n<li>You used sometimes <code>Range</code> with two numbers to reference a cell. Yet, this is only possible with <code>Cells</code>. So, I changed a few of those to <code>Cells</code>. Yet, the reference here is <code>Cells(rowNumber, columnNumber)</code>. So, you might want to review these changes.</li>\n</ol>\n\n<p>Here is the resulting code after these changes:</p>\n\n<pre><code>Sub updateRevs()\n\nDim d As Long\nDim j As Long\nDim LastRow As Long\nDim i As Worksheet\nDim r As Worksheet\n\nd = 1\nSet i = ThisWorkbook.Sheets(\"Sheet1\")\nSet r = ThisWorkbook.Sheets(\"Revisions\")\n\nLastRow = r.Range(\"A\" &amp; r.Rows.Count).End(xlUp).Row\n\nDo Until IsEmpty(r.Range(\"A\" &amp; j))\n    For j = 1 To LastRow\n        If r.Range(\"A\" &amp; d).Value = i.Cells(j, 8).Value Then\n            r.Range(\"B\" &amp; d).Copy\n            i.Cells(j, Sheet2.Range(\"AA3\").Value).PasteSpecial xlPasteValues\n        End If\n    Next j\n    d = d + 1\nLoop\n\nEnd Sub\n</code></pre>\n\n<p><sub>As mentioned before this code will result in an endless loop and will have to be further adjusted. Most likely you can remove the loop altogether. Yet, I do not know what <code>d = d + 1</code> is for?!</sub></p>\n\n<p><sub>Note also that this \"answer\" is more of a collection of hints to get you in the right direction (rather than a complete answer). This is due to the fact that it is currently not possible for me to see what you want to achieve with your loop.</sub></p>\n"}], "owner": {"reputation": 1, "user_id": 6319303, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WiwQxX9KR0M/AAAAAAAAAAI/AAAAAAAAACs/vG1IDp0ZNeM/photo.jpg?sz=128", "display_name": "Eoin Prunty", "link": "https://stackoverflow.com/users/6319303/eoin-prunty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 774, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463062804, "creation_date": 1462962740, "last_edit_date": 1463062804, "question_id": 37160001, "link": "https://stackoverflow.com/questions/37160001/copy-value-from-a-cell-in-one-sheet-to-a-cell-in-the-last-used-column-in-another", "title": "Copy value from a cell in one sheet to a cell in the last used Column in another sheet, if values in two other Columns&#39; values match", "body": "<p>This may not be possible using VBA. I have an Architectural drawings register which uses 1 row per drawing with individual columns for Drawing Number, Drawing Name, scale and paper size. Issued information is tracked from column \"O\" onwards. </p>\n\n<p>When information is issued, the current revision of that information is marked under the date that it is being issued on. </p>\n\n<p>The software we use to develop our drawing information contains data including the most current revision. What I am trying to do is export the drawing number and current revision values to excel and then automatically bring that information into the last issue date on the drawing register in the correct row.\nI was hoping to ensure the correct row by searching the contents of <a href=\"http://i.stack.imgur.com/NMeTX.png\" rel=\"nofollow\">Sheet1 (000 MODELS, ACAD...)</a>  Column A with the contents of Sheet3 (\"Revisions\") Column A and when it finds a match on Sheet1, copy Sheet3's corresponding cell from column B into the matched rows' last column.</p>\n\n<p>So far (Updated image):\nI had previously updated a simplified version of the sheet, but have now uploaded the original version.</p>\n\n<p>As you can see in the image of Sheet 1, there are two buttons. One that hides all issues before a prompted input date, and Update Revisions which doesn't work yet...  </p>\n\n<p>Sheet2 (List) is used purely for storing values used in macro calculations and data calcs (Don't have enough rep to post a 3rd link...). The last column number is recorded as a value in Sheet3 cell AA3 because of the findCol macro I use for the 'Hide/Show Old Issue Dates' button, which I'm hoping can be used for defining the column to copy the current revision to.  Columns AA and AJ store the information used in this macro. </p>\n\n<p><a href=\"http://i.stack.imgur.com/efBoG.png\" rel=\"nofollow\">Sheet3 (revisions)</a> contains the exported drawing number and current revision for each drawing as exported from Revit. For the process I see it that this data should be copied in from the exported 'standalone' excel sheet, manipulated to populate the issue sheet with current revisions and is then deleted.</p>\n\n<p>The piece of code that I'm having trouble with is where I'm trying to find a matching value in Column H on Sheet1 for the values in Sheet3. Where a match is found I want to copy the cell value from Sheet3 into the last column on the  corresponding row in Sheet1.</p>\n\n<pre><code>Sub updateRevs()\nSet i = Sheets(\"Sheet1\")\nSet r = Sheets(\"Revisions\")\nDim d\nd = 1\nDim j As Range\nDim LastRow As Long\nLastRow = r.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nDo Until IsEmpty(r.Range(\"A\" &amp; j))\nFor j = 1 To LastRow\n    If r.Range(\"A\" &amp; d).Value = i.Range(j, 8).Value Then\n        r.Range(\"B\" &amp; d).Copy\n        i.Range(j, Sheet2.Range(\"AA3\").Value).PasteSpecial xlPasteValues\n    End If\nNext j\nd = d + 1\nLoop\nEnd Sub\n</code></pre>\n\n<p>The macro call-order for the 'Update Revisions' button is as follows:</p>\n\n<pre><code>Sub MakeNewSheet()\nSheets.Add.Name = \"Revisions\"\nEnd Sub\n\nSub copyRevisions()\nApplication.FileDialog(msoFileDialogFilePicker).Show\nSheet2.Range(\"AJ1\").Value = Application.FileDialog(msoFileDialogFilePicker).SelectedItems(1)\nDim x As Workbook\nDim y As Workbook\nlastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nSet x = ThisWorkbook\nSet y = Workbooks.Open(Sheet2.Range(\"AJ1\").Value)\ny.Sheets(\"Revisions\").Range(\"A1:B\" &amp; lastRow).Copy\nx.Sheets(\"Revisions\").Range(\"A1\").PasteSpecial\nApplication.CutCopyMode = False\ny.Close\nEnd Sub\n\n\nSub updateRevs()\nSet i = Sheets(\"Sheet1\")\nSet r = Sheets(\"Revisions\")\nDim d\nd = 1\nDim j As Range\nDim LastRow As Long\nLastRow = r.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nDo Until IsEmpty(r.Range(\"A\" &amp; j))\nFor j = 1 To LastRow\n    If r.Range(\"A\" &amp; d).Value = i.Range(j, 8).Value Then\n        r.Range(\"B\" &amp; d).Copy\n        i.Range(j, Sheet2.Range(\"AA3\").Value).PasteSpecial xlPasteValues\n    End If\nNext j\nd = d + 1\nLoop\nEnd Sub\n\nSub deleteRevSheet()\nApplication.DisplayAlerts = False\nSheets(\"Revisions\").Delete\nEnd Sub\n</code></pre>\n\n<p>Any help would be much appreciated (even to say that it's possible or not in VBA!)</p>\n\n<p>Thanks!</p>\n\n<p>Updated working code, which probably requires fine-tuning:</p>\n\n<pre><code>Sub updateRevisions()\nDim i As Worksheet\nDim r As Worksheet\nDim LastRow As Long\nDim LastRowSheets As Long\nSet i = ThisWorkbook.Sheets(\"000 MODELS, ACAD...\")\nSet r = ThisWorkbook.Sheets(\"Revisions\")\nDim FirstAddress As String\nDim Rng As Range\nDim e As Long\nDim check() As String\nDim cell As Range\nDim j As Integer\nj = 1\nDim Col As Long\nCol = Sheet2.Range(\"AB1\").Value\n\n\nLastRow = r.Cells(Rows.Count, \"A\").End(xlUp).Row\nLastRowSheets = i.Cells(Rows.Count, \"H\").End(xlUp).Row\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\nWith Sheet1.Range(\"H51:H\" &amp; LastRowSheets)\nReDim check(j)\n    For Each cell In r.Range(\"A2:A\" &amp; LastRow)\n        check(j) = cell\n            For e = LBound(check()) To UBound(check())\n                Set Rng = .Find(What:=check(j), _\n                        After:=.Cells(.Cells.Count), _\n                        LookIn:=xlFormulas, _\n                        LookAt:=xlWhole, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlNext, _\n                        MatchCase:=False)\n                If Not Rng Is Nothing Then\n                FirstAddress = Rng.Address\n                Do\n                Rng.Offset(0, Col).Value = r.Cells(j + 1, \"B\").Value\n                Set Rng = .FindNext(Rng)\n                Loop While Not Rng Is Nothing And Rng.Address &lt;&gt; FirstAddress\n                End If\n            Next e\n        j = j + 1\n    ReDim Preserve check(j)\nNext\nEnd With\n\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["performance", "vba", "excel"], "comments": [{"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 2, "creation_date": 1462963161, "post_id": 37159778, "comment_id": 61855879, "body": "i don&#39;t know if Access or MATBLAB are faster, i think Access should be. Anyway this should definitly be possible with Excel too. But there are a lot of things to look at. First opening the workbook the Default way is slow. ADO or ExecuteExcel4Macro (<a href=\"http://stackoverflow.com/questions/25287549/how-to-optimize-opening-and-closing-excel-workbooks-to-extract-data-to-run-faste\" title=\"how to optimize opening and closing excel workbooks to extract data to run faste\">stackoverflow.com/questions/25287549/&hellip;</a>) would be faster. Copying data can also be done very slow or quite fast. But you will have to post your correct code to get more help."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 2, "creation_date": 1462963490, "post_id": 37159778, "comment_id": 61856075, "body": "If you have working code which merely needs improvements then you&#39;re probably in the wrong place with this post. <a href=\"http://codereview.stackexchange.com/\">Code Review</a> is where they handle existing / working code and do their upmost to improve it in terms of speed, security, sustainability, and longevity. Give it a try. They&#39;re good!"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1462964083, "post_id": 37159778, "comment_id": 61856500, "body": "If you are frequently referencing the worksheet as you process your data, this will be very slow.  You can expect significant (ten-fold?) speed increase by using VBA arrays, Collections and possibly user defined objects to gather your data before writing it onto the worksheet.  With the amount of your data, you may have to do this in stages, but that should still afford you a significant speed increase."}, {"owner": {"reputation": 55, "user_id": 5159982, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/94a441744ea8d627e117cc77470d6ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Gurdeep", "link": "https://stackoverflow.com/users/5159982/gurdeep"}, "edited": false, "score": 0, "creation_date": 1462966919, "post_id": 37159778, "comment_id": 61858449, "body": "I;ve never heard of using ADO or ExcuteExcel4Macro before, I&#39;ll look into that. I will post the code when I get a chance, I&#39;ll have to change some of the names in it."}, {"owner": {"reputation": 55, "user_id": 5159982, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/94a441744ea8d627e117cc77470d6ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Gurdeep", "link": "https://stackoverflow.com/users/5159982/gurdeep"}, "edited": false, "score": 0, "creation_date": 1462966983, "post_id": 37159778, "comment_id": 61858489, "body": "When I was referring to code, it&#39;s just VBA, Code Review looks handy, but is that for actual programming as opposed to scripts like VBA?"}, {"owner": {"reputation": 55, "user_id": 5159982, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/94a441744ea8d627e117cc77470d6ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Gurdeep", "link": "https://stackoverflow.com/users/5159982/gurdeep"}, "edited": false, "score": 0, "creation_date": 1462967064, "post_id": 37159778, "comment_id": 61858533, "body": "I&#39;ll look into using arrays, it looks like that could be handy - I thought that something like that would be RAM-intensive and so copying, pasting and clearing the memory would have been quicker?"}], "answers": [{"comments": [{"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 1, "creation_date": 1462964016, "post_id": 37160335, "comment_id": 61856456, "body": "I most of the time, the slow thing is accessing the Excel sheet and not copying the values (Depending on how it is copied...). I would recomment to copy the full value to an Array, and Loop throught that. -&gt; <a href=\"http://stackoverflow.com/questions/8178161/what-is-the-most-efficient-quickest-way-to-loop-through-rows-in-vba-excel\" title=\"what is the most efficient quickest way to loop through rows in vba excel\">stackoverflow.com/questions/8178161/&hellip;</a>"}, {"owner": {"reputation": 55, "user_id": 5159982, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/94a441744ea8d627e117cc77470d6ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Gurdeep", "link": "https://stackoverflow.com/users/5159982/gurdeep"}, "edited": false, "score": 0, "creation_date": 1462967295, "post_id": 37160335, "comment_id": 61858709, "body": "1) ~Will that override any OnWorkbookOpen Macros with update links enabled?                                                                                                                       2) I suppose that gives fewer steps to run through, I did have it like that, and it was really slow as well mainly because the workbook it opens constantly updates whenever any change is made, even in read-only mode. I will give it a shot and get back to this thread with what helped improve.  The criteria are all strings, so I have a list of column headers that I want in a list, and just match and delet"}], "tags": [], "owner": {"reputation": 419, "user_id": 6187464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IqTLI.jpg?s=128&g=1", "display_name": "HedgePig", "link": "https://stackoverflow.com/users/6187464/hedgepig"}, "is_accepted": true, "score": 1, "last_activity_date": 1462967969, "last_edit_date": 1462967969, "creation_date": 1462963582, "answer_id": 37160335, "question_id": 37159778, "link": "https://stackoverflow.com/questions/37159778/processing-large-amounts-of-data-in-macro-enabled-workbooks-excel-other/37160335#37160335", "title": "Processing large amounts of data in macro-enabled workbooks [Excel/Other]", "body": "<p>Some thoughts.</p>\n\n<p>1) If the main culprit is the updating of links, then stop the updating on opening with with</p>\n\n<pre><code>Workbooks.Open fullFileName, UpdateLinks:=False\n</code></pre>\n\n<p>2) I suspect it's time consuming to copy everything and then delete what you don't need - is this really necessary?\nCould you try cycling through the data and identify what is relevant and copy that? \nI guess it might depend on how you are doing your searching but if you are going through and testing every row anyway (not sure if you need to do this) then you could identify the first row that meets the criteria and carry on until you hit row which doesn't meet the criteria. Then copy and paste the rows (or sections thereof) starting from the first and ending with the last that met your criteria. Once you've done this, carry on cycling through your data.\nYou might even be able to collect all the ranges in a sheet (e.g. with a Union statement) and finally copy them all in one statement once you reach the end of the sheet.</p>\n\n<p>Not sure if this is what you are looking for. It might help to know more about your data and the types of criteria you have.</p>\n\n<p>Edit 1: Yes that will override the updating of links. Also have you tried setting calculation mode to manual and making sure screen updating is set to false? These could be slowing you down signficantly.</p>\n"}], "owner": {"reputation": 55, "user_id": 5159982, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/94a441744ea8d627e117cc77470d6ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Gurdeep", "link": "https://stackoverflow.com/users/5159982/gurdeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1140, "favorite_count": 0, "accepted_answer_id": 37160335, "answer_count": 1, "score": 0, "last_activity_date": 1462973705, "creation_date": 1462962184, "last_edit_date": 1462973705, "question_id": 37159778, "link": "https://stackoverflow.com/questions/37159778/processing-large-amounts-of-data-in-macro-enabled-workbooks-excel-other", "title": "Processing large amounts of data in macro-enabled workbooks [Excel/Other]", "body": "<p>I have 15 or so workbooks with a large amount of data (2000 rows, ~120000 Active Cells in the sheet I want to use) and I'm trying to create basically a search engine where someone can type a criteria and then excel or something else returns any rows where that condition is met. </p>\n\n<p>I have something like this working </p>\n\n<p>Pseudo code</p>\n\n<pre><code>Map drive (files are stored on sharepoint)\nLoop workbookdata1 to workbookdata15\n    Copy data from sheet to new sheet in workbookMAIN\n    Loop through columns, keeping only relevant columns, deleting the rest\n    Loop through rows, deleting row if first cell = blank or \"xxx\" \nNext workbookdata\nCompile all of the data from the newly generated sheet\nMake it look nice and readable\n</code></pre>\n\n<p>This works, but it takes 45mins - hour to run because every sheet it opens updates links (all 2000 rows) and then having to filter out all of the unwanted data. </p>\n\n<p>What are my options for speeding this up? Can I process the data quicker using Access or MATLAB, or coding something that would? </p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"tags": [], "owner": {"reputation": 156, "user_id": 6219524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be82ab7ad90aa19b4df8add5fcc2d244?s=128&d=identicon&r=PG&f=1", "display_name": "csanjose", "link": "https://stackoverflow.com/users/6219524/csanjose"}, "is_accepted": false, "score": 0, "last_activity_date": 1462963423, "last_edit_date": 1462963423, "creation_date": 1462962007, "answer_id": 37159711, "question_id": 37159395, "link": "https://stackoverflow.com/questions/37159395/how-to-insert-the-values-of-a-function-every-nth-row/37159711#37159711", "title": "How to insert the values of a function every nth row", "body": "<pre><code>=IF(MOD(ROW(),49)=0,AVERAGE($I$1:$I$36),\"\")\n</code></pre>\n\n<p>If you save in c1 the starting row and in c2 the frequency of the formula, it should look like</p>\n\n<pre><code>=IF(MOD(ROW()-$c$1+$c$2,$c$2)=0,AVERAGE($I$1:$I$36),\"\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 3515459, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/716169600/picture?type=large", "display_name": "Sherif", "link": "https://stackoverflow.com/users/3515459/sherif"}, "edited": false, "score": 0, "creation_date": 1462962934, "post_id": 37159713, "comment_id": 61855731, "body": "My excel skill are poor, i created a column right to it, which is J, and selected entire J column and pasted your function, and didnt work, so then i changed then $I to $J and still no use."}, {"owner": {"reputation": 156, "user_id": 6219524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be82ab7ad90aa19b4df8add5fcc2d244?s=128&d=identicon&r=PG&f=1", "display_name": "csanjose", "link": "https://stackoverflow.com/users/6219524/csanjose"}, "edited": false, "score": 0, "creation_date": 1462963499, "post_id": 37159713, "comment_id": 61856081, "body": "Sherif, You should put cell references between &#39;$&#39; to properly copy the formula"}], "tags": [], "owner": {"reputation": 507, "user_id": 2289233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fee8554503135fedda947204d8266e6?s=128&d=identicon&r=PG", "display_name": "kipar", "link": "https://stackoverflow.com/users/2289233/kipar"}, "is_accepted": false, "score": 0, "last_activity_date": 1462967001, "last_edit_date": 1462967001, "creation_date": 1462962012, "answer_id": 37159713, "question_id": 37159395, "link": "https://stackoverflow.com/questions/37159395/how-to-insert-the-values-of-a-function-every-nth-row/37159713#37159713", "title": "How to insert the values of a function every nth row", "body": "<p><strong>Decision 1</strong></p>\n\n<p>Use <code>=IF(MOD((ROW()-ROW($I$1)),49)=0;AVERAGE(I1:I36);\"\")</code><br>\nPro: pure formula, without macros.<br>\nCons: you have to use entire column for it, excessive calculations (btw ROW() function is not efficient, so it would be better to spend another column for row number).</p>\n\n<p><strong>Decision 2</strong></p>\n\n<p>Just select cell with a formula and 48 empty cells, press \"Copy\", then select entire range and press \"Paste\".</p>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": true, "score": 1, "last_activity_date": 1463027253, "creation_date": 1463027253, "answer_id": 37177281, "question_id": 37159395, "link": "https://stackoverflow.com/questions/37159395/how-to-insert-the-values-of-a-function-every-nth-row/37177281#37177281", "title": "How to insert the values of a function every nth row", "body": "<p>To do this in VBA (avoiding blank formulae) you could try this:</p>\n\n<p><em>Enters formulas from A1 to A50000 every 9 rows</em></p>\n\n<pre><code>Dim rng1 As Range\nSet rng1 = Range([a1], Cells(50000, \"A\"))\nrng1.FormulaR1C1 = Application.Evaluate(\"=IF(MOD(ROW(A1:A50000),49)=0,\"\"=AVERAGE(RC9:R[35]C9)\"\",\"\"\"\")\")\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 3515459, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/716169600/picture?type=large", "display_name": "Sherif", "link": "https://stackoverflow.com/users/3515459/sherif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2475, "favorite_count": 0, "accepted_answer_id": 37177281, "answer_count": 3, "score": 2, "last_activity_date": 1463027294, "creation_date": 1462961270, "last_edit_date": 1531161705, "question_id": 37159395, "link": "https://stackoverflow.com/questions/37159395/how-to-insert-the-values-of-a-function-every-nth-row", "title": "How to insert the values of a function every nth row", "body": "<p>I have a function in Excel that calculates the average of some numbers \n<code>=AVERAGE(I1:I36)</code> for example.</p>\n\n<p>The thing is, I need to paste this function every 49 rows, instead of counting the rows manually then copying and pasting. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1462962539, "post_id": 37159164, "comment_id": 61855459, "body": "<code>27&#47;11&#47;1992</code> = 0.00123220 (because <code>&#47;</code> means &#39;divide&#39;) and the datetime representation of 0.00123220 is <code>00:01:46</code> - I think you mean to wrap that in quotes (<code>&quot;</code>) so that it&#39;s treated as a string instead."}], "answers": [{"comments": [{"owner": {"reputation": 74, "user_id": 5492717, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab7bc30e36649574b7ada2d9821d7416?s=128&d=identicon&r=PG&f=1", "display_name": "ZerO", "link": "https://stackoverflow.com/users/5492717/zero"}, "edited": false, "score": 0, "creation_date": 1462961480, "post_id": 37159300, "comment_id": 61854714, "body": "Thank you so much. I get it."}], "tags": [], "owner": {"reputation": 3364, "user_id": 6139255, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H7gaC.jpg?s=128&g=1", "display_name": "Abdellah OUMGHAR", "link": "https://stackoverflow.com/users/6139255/abdellah-oumghar"}, "is_accepted": true, "score": 1, "last_activity_date": 1462961094, "creation_date": 1462961094, "answer_id": 37159300, "question_id": 37159164, "link": "https://stackoverflow.com/questions/37159164/date-on-message-box-vba/37159300#37159300", "title": "Date on message box - VBA", "body": "<p>Use :</p>\n\n<pre><code> birthday = \"27 / 11 / 1992\"\n</code></pre>\n"}], "owner": {"reputation": 74, "user_id": 5492717, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab7bc30e36649574b7ada2d9821d7416?s=128&d=identicon&r=PG&f=1", "display_name": "ZerO", "link": "https://stackoverflow.com/users/5492717/zero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2275, "favorite_count": 0, "accepted_answer_id": 37159300, "answer_count": 1, "score": 0, "last_activity_date": 1462961094, "creation_date": 1462960811, "last_edit_date": 1531164843, "question_id": 37159164, "link": "https://stackoverflow.com/questions/37159164/date-on-message-box-vba", "title": "Date on message box - VBA", "body": "<p>I performed code below to show date on message box. However, the value in code is not the same with showing value on message box. Could you please help me to know the reason?</p>\n\n<p>code VB:</p>\n\n<pre><code>Sub Button1_Click()\nDim birthday As Date\nbirthday = 27 / 11 / 1992 'dd/mm/yyy\nabc = MsgBox(\"Birthday: \" &amp; Format(birthday, \"dd/mm/yyyy\"), 3, \"Choose option\")\nEnd Sub\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/G72By.png\" rel=\"nofollow\">message box result</a></p>\n"}, {"tags": ["vba", "ms-project"], "answers": [{"tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": true, "score": 0, "last_activity_date": 1462976254, "creation_date": 1462976254, "answer_id": 37165406, "question_id": 37158457, "link": "https://stackoverflow.com/questions/37158457/ms-project-vba-return-collection-of-tasks-assigned-to-a-summary-task/37165406#37165406", "title": "MS Project VBA - Return collection of tasks assigned to a summary task", "body": "<p><code>OutlineChildren</code> will give you the collection of immediate subtasks. For example, this code will loop through all tasks in the active project and print out the name of each summary task with the name of its subtask(s).</p>\n\n<pre><code>For Each t In ActiveProject.Tasks\n    For Each s In t.OutlineChildren\n        Debug.Print \"Summary task: \" &amp; t.Name, \"Subtask: \" &amp; s.Name\n    Next s\nNext t\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5668593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b5ee3ee65abf6559b5fcd6baa4c0648?s=128&d=identicon&r=PG&f=1", "display_name": "anon", "link": "https://stackoverflow.com/users/5668593/anon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1828, "favorite_count": 0, "accepted_answer_id": 37165406, "answer_count": 1, "score": 0, "last_activity_date": 1462976254, "creation_date": 1462959026, "question_id": 37158457, "link": "https://stackoverflow.com/questions/37158457/ms-project-vba-return-collection-of-tasks-assigned-to-a-summary-task", "title": "MS Project VBA - Return collection of tasks assigned to a summary task", "body": "<p>I am looking for some VBA that will return a collection of tasks assigned to a sub task in Microsoft Project. I can use the .Summary method to identify a summary task, but how can I retrieve the tasks underneath that summary task?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1462960804, "post_id": 37158629, "comment_id": 61854181, "body": "Thank you, Does LTrim removes spaces only in front?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1462960968, "post_id": 37158629, "comment_id": 61854327, "body": "well you can see it by yourself by typing <code>Len(LTrim(&quot;         ooo &quot;))</code> in the immediate window"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1462962764, "post_id": 37158629, "comment_id": 61855626, "body": "but you discarded my answer... grrr! anyhow consider that @Vegard solution wouldn&#39;t account for characters like <code>&quot;!&#39;|&#163;$</code> and such. while both mine solutions have no such restrictions. and <code>LTrim</code> one actually is very simple"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1462962913, "post_id": 37158629, "comment_id": 61855719, "body": "@user3598756: While that is true, it&#39;s easy to add those to the list (just type them in). The downside of your and PhilS&#39; answer is that <code>Trim</code> and its cousins can&#39;t remove all types of spaces."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1462963267, "post_id": 37158629, "comment_id": 61855945, "body": "I&#39;m not the question-asker, so it&#39;s not up to me which question gets accepted. Just pointing out things to keep in mind. For many uses, <code>Trim</code> is perfectly fine. For others, it&#39;s not."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1462963409, "post_id": 37158629, "comment_id": 61856028, "body": "@Vegard, sorry I didn&#39;t notice it was not Jeevan answering. Anyhow both solution has been given: with and without <code>Trim</code> family"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1462960976, "last_edit_date": 1462960976, "creation_date": 1462959482, "answer_id": 37158629, "question_id": 37158341, "link": "https://stackoverflow.com/questions/37158341/count-the-number-of-empty-spaces-in-front-and-back-of-the-string/37158629#37158629", "title": "Count the number of empty spaces in front and back of the string", "body": "<pre><code>Sub main()\n    Dim strng As String\n    Dim i As Long\n\n    strng = \"         ooo                   \"\n\n    i = 1\n    Do While Mid(strng, i, 1) = \" \"\n        i = i + 1\n    Loop\n    MsgBox \"number of front empty spaces: \" &amp; i - 1\nEnd Sub\n</code></pre>\n\n<p>or use <code>LTrim</code> function:</p>\n\n<pre><code>Sub main2()\n    Dim strng As String\n    strng = \"         ooo                   \"\n    MsgBox \"number of front empty spaces: \" &amp; Len(strng) - Len(LTrim(strng))\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 3, "creation_date": 1462960187, "post_id": 37158640, "comment_id": 61853760, "body": "that pattern can also be written as <code>[a-z0-9]</code> btw"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1462962132, "post_id": 37158640, "comment_id": 61855168, "body": "I use that for regex, but didn&#39;t know you can use it with <code>Like</code> as well. Thanks for the heads up."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1462962201, "post_id": 37158640, "comment_id": 61855209, "body": "Yeah, it&#39;s one of the few things that <code>Like</code> allows thankfully!"}], "tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": true, "score": 2, "last_activity_date": 1462965293, "last_edit_date": 1495539848, "creation_date": 1462959508, "answer_id": 37158640, "question_id": 37158341, "link": "https://stackoverflow.com/questions/37158341/count-the-number-of-empty-spaces-in-front-and-back-of-the-string/37158640#37158640", "title": "Count the number of empty spaces in front and back of the string", "body": "<pre><code>Function test(s As String) As Integer\n    Dim str As String\n    str = \"[abcdefghijklmnopqrstuvwxyz0123456789]\"\n\n    Dim spaceCounter As Integer\n\n    For i = 1 To Len(s)\n        If Not Mid(s, i, 1) Like str Then\n            spaceCounter = spaceCounter + 1\n        Else\n            Exit For\n        End If\n    Next i\n\n    test = spaceCounter\nEnd Function\n</code></pre>\n\n<p>By popular request: Why use this function instead of <code>Trim</code>, <code>LTrim</code>, etc?</p>\n\n<p>Well, to summarize <a href=\"https://support.office.com/en-us/article/Remove-spaces-and-nonprinting-characters-from-text-023f3a08-3d56-49e4-bf0c-fe5303222c9d\" rel=\"nofollow noreferrer\">the full explanation</a>, not all spaces can be removed with <code>Trim</code>. But they will be removed with this function.</p>\n\n<p>Consider this example (I'll borrow <a href=\"https://stackoverflow.com/a/37158801/4604845\">PhilS' solution</a> for illustrative purposes):</p>\n\n<pre><code>Sub testSpaceRemoval()\n    Dim str1 As String\n    str1 = \" \" &amp; Chr(32) &amp; Chr(160) &amp; \"a\"\n    Debug.Print Chr(34) &amp; str1 &amp; Chr(34)\n    Debug.Print NumberOfLeadingSpaces(str1)\n    Debug.Print test(str1)\nEnd Sub\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>\"  \u00a0a\"  \n2   \n3\n</code></pre>\n\n<p>Here we can see that the string clearly contains 3 spaces, but the solution using <code>LTrim</code> only counted 2.</p>\n\n<p>So, what to use? </p>\n\n<p>Well, it depends. If you have a dataset where you know you won't get non-breaking characters, use <code>Trim</code> as much as you want! If you think you can get non-breaking characters, <code>Trim</code> alone will not be enough.</p>\n\n<p>Characters to look out for are, quoted from the explanation linked above:</p>\n\n<blockquote>\n  <p>leading, trailing, or multiple embedded space characters (Unicode character set values 32 and 160), or non-printing characters (Unicode character set values 0 to 31, 127, 129, 141, 143, 144, and 157)</p>\n</blockquote>\n\n<p><code>Trim</code> can remove <code>chr(32)</code> (as demonstrated above) but not <code>chr(160)</code>, because <a href=\"http://spreadsheets.about.com/od/excelfunctions/qt/080404_trim.htm\" rel=\"nofollow noreferrer\">32 is the regular space and 160 is a non-breaking space</a>.</p>\n\n<p>If you're a stickler for covering your behind, consider this total solution:</p>\n\n<pre><code>Function cleanSpecialCharacters(str As String) As String\n    bannedChars = Chr(127) &amp; \",\" &amp; Chr(129) &amp; \",\" &amp; Chr(141) &amp; \",\" &amp; Chr(143) &amp; \",\" &amp; Chr(144) &amp; \",\" &amp; Chr(157) &amp; \",\" &amp; Chr(160)\n\n    str = Application.WorksheetFunction.Clean(str)\n    str = Application.WorksheetFunction.Trim(str)\n\n    For Each c In Split(bannedChars, \",\")\n        str = Replace(str, c, \"\")\n    Next\n\n    cleanSpecialCharacters = str\nEnd Function\n</code></pre>\n\n<p>For OP's particular question, it would have to be a little more tailored.</p>\n"}, {"tags": [], "owner": {"reputation": 156, "user_id": 6219524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be82ab7ad90aa19b4df8add5fcc2d244?s=128&d=identicon&r=PG&f=1", "display_name": "csanjose", "link": "https://stackoverflow.com/users/6219524/csanjose"}, "is_accepted": false, "score": 0, "last_activity_date": 1462959720, "last_edit_date": 1462959720, "creation_date": 1462959523, "answer_id": 37158649, "question_id": 37158341, "link": "https://stackoverflow.com/questions/37158341/count-the-number-of-empty-spaces-in-front-and-back-of-the-string/37158649#37158649", "title": "Count the number of empty spaces in front and back of the string", "body": "<pre><code>Sub blanks()    \n    cadena = Cells(1, 1)\n    i = Len(cadena)\n    Do Until Mid(cadena, i, 1) &lt;&gt; \" \"\n        If Mid(cadena, i, 1) = \" \" Then contador = contador + 1 \n        i = i - 1\n    Loop    \n    Cells(2, 1) = contador\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 381, "user_id": 1753935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2mkbh.jpg?s=128&g=1", "display_name": "DDuffy", "link": "https://stackoverflow.com/users/1753935/dduffy"}, "edited": false, "score": 1, "creation_date": 1462959909, "post_id": 37158801, "comment_id": 61853552, "body": "beat me to it, was typing this when yours popped up. Haha"}, {"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1462960978, "post_id": 37158801, "comment_id": 61854337, "body": "Correct me if I am wrong, LTrim removes space in front and RTrim removes space in back"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1462962334, "post_id": 37158801, "comment_id": 61855307, "body": "Probably faster (and easier to implement), I agree. The downside is that for some use-cases it won&#39;t work (but doing character comparisons will). Of course, such use-cases might not arise at all depending on your dataset!"}, {"owner": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "reply_to_user": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1462966190, "post_id": 37158801, "comment_id": 61857903, "body": "@Vegard: Sure, it works for chr(32) spaces only. For other characters, like non-breaking space, you have to use another solution, as you excellently illustrated."}], "tags": [], "owner": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "is_accepted": false, "score": 6, "last_activity_date": 1462959937, "last_edit_date": 1462959937, "creation_date": 1462959877, "answer_id": 37158801, "question_id": 37158341, "link": "https://stackoverflow.com/questions/37158341/count-the-number-of-empty-spaces-in-front-and-back-of-the-string/37158801#37158801", "title": "Count the number of empty spaces in front and back of the string", "body": "<p>You could use the <code>LTrim</code> and <code>RTrim</code> functions. - I would assume that is faster, than looping through the string and doing character comparisons.</p>\n\n<pre><code>Public Function NumberOfLeadingSpaces(ByVal theString As String) As Long\n    NumberOfLeadingSpaces = Len(theString) - Len(LTrim(theString))\nEnd Function\n\nPublic Function NumberOfTrailingSpaces(ByVal theString As String) As Long\n    NumberOfTrailingSpaces = Len(theString) - Len(RTrim(theString))\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 566, "favorite_count": 0, "accepted_answer_id": 37158640, "answer_count": 4, "score": 1, "last_activity_date": 1462965293, "creation_date": 1462958774, "last_edit_date": 1462960744, "question_id": 37158341, "link": "https://stackoverflow.com/questions/37158341/count-the-number-of-empty-spaces-in-front-and-back-of-the-string", "title": "Count the number of empty spaces in front and back of the string", "body": "<p>I am reading a file line by line in Excel VBA. </p>\n\n<p>I have some strings for example, </p>\n\n<pre><code>\"             ooo\"\n\"         ooo                   \"\n</code></pre>\n\n<p>I want to find the number of empty spaces in the front of the string. If I use Trim, it is removing empty spaces from both back and front of the string. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1462958250, "post_id": 37157990, "comment_id": 61852429, "body": "Works fine for me although I&#39;m not sure I would use that methodology."}, {"owner": {"reputation": 381, "user_id": 1753935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2mkbh.jpg?s=128&g=1", "display_name": "DDuffy", "link": "https://stackoverflow.com/users/1753935/dduffy"}, "edited": false, "score": 0, "creation_date": 1462958877, "post_id": 37157990, "comment_id": 61852847, "body": "have you tried <code>Variable = Sheet1.Range(&quot;W12&quot;).Value</code>"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 1, "creation_date": 1462958933, "post_id": 37157990, "comment_id": 61852884, "body": "It will work correctly if your w12 cell contains Range like &quot;R2:R11&quot;  (without quotes) . If w12 contains string like Hello or numeric like 23 you will get error 1004"}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1462959109, "post_id": 37158453, "comment_id": 61852983, "body": "well, should those double quotes be the issue then @skkakkar resolved it while I was typing -&gt; credits to him!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1462959020, "creation_date": 1462959020, "answer_id": 37158453, "question_id": 37157990, "link": "https://stackoverflow.com/questions/37157990/value-in-cell-as-variable-in-select-formula/37158453#37158453", "title": "Value in cell as variable in select formula", "body": "<p>you most probably typed <code>\"R2:R11\"</code> in W12 cell, i.e with double quotes too\nin that cell you only have to type  <code>R1:R12</code></p>\n\n<p>moreover you can simply code</p>\n\n<pre><code>Sub test()\n   Sheet1.Range(Sheet1.Range(\"W12\")).Select\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1462961042, "post_id": 37158794, "comment_id": 61854381, "body": "Even with your nice code if OP does not ensure appropriate data in cell W12 like R2:R11 , he is likely to get error 1004."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1462961439, "post_id": 37158794, "comment_id": 61854678, "body": "as per my &quot;tests&quot; (quite a few indeed..) I think the OP&#39;s issue <i>has</i> to be the double quotes actually typed in the cell content. If you type them, error 1004 is thrown by either codes (with <code>Variant</code> or <code>String</code> type variables)"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1462961563, "post_id": 37158794, "comment_id": 61854775, "body": "@skakkar: seems we&#39;re &quot;in phase&quot; today!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1462986056, "post_id": 37158794, "comment_id": 61872914, "body": "so the issue was not the double quotes?"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 1, "last_activity_date": 1462959859, "creation_date": 1462959859, "answer_id": 37158794, "question_id": 37157990, "link": "https://stackoverflow.com/questions/37157990/value-in-cell-as-variable-in-select-formula/37158794#37158794", "title": "Value in cell as variable in select formula", "body": "<p>You need to declare your variables properly and access the actual <code>.Value</code> property of the Range object.</p>\n\n<pre><code>Sub test()\nDim Variable As String\nVariable = Sheet1.Range(\"W12\").Value\nSheet1.Select\nRange(Variable).Select\nEnd Sub\n</code></pre>\n\n<p>Which can also be written as:</p>\n\n<pre><code>Sub test()\nSheet1.Activate\nRange([W12]).Activate\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>A note on the <code>.Value</code> property - if you omit this, the value will usually be assigned anyway because it's the default property of the range object. That being said there are scenarios where this won't be the case and therefore it's always best practice to explicitly state that you want the value.</p>\n"}], "owner": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 37158794, "answer_count": 2, "score": 0, "last_activity_date": 1462959859, "creation_date": 1462957892, "question_id": 37157990, "link": "https://stackoverflow.com/questions/37157990/value-in-cell-as-variable-in-select-formula", "title": "Value in cell as variable in select formula", "body": "<p>I have programmed the following VBA code:</p>\n\n<pre><code>Sub test()\nDim Variable As Variant\nVariable = \"R2:R11\"\nSheet1.Select\nRange(Variable).Select\nEnd Sub\n</code></pre>\n\n<p>This formula works perfectly. Now I want to replace the \"R2:R11\" part of the variable and instead referring to a cell (W12) in the spreadsheet. In this cell I have written \"R2:R11\" and I changed the formula to the following:</p>\n\n<pre><code>Variable = Sheet1.Range(\"W12\")\n</code></pre>\n\n<p>which leads to the following code:</p>\n\n<pre><code>Sub test()\nDim Variable As Variant\nVariable = Sheet1.Range(\"W12\")\nSheet1.Select\nRange(Variable).Select\nEnd Sub\n</code></pre>\n\n<p>However, with this formula I now get the ERROR 1004.</p>\n\n<p>Do you guys have any solution how I can make the variable referring to the cell in the spreadsheet and then use it in the select formula?</p>\n\n<p>Thanks for any help :-)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1462956794, "post_id": 37157539, "comment_id": 61851388, "body": "This is not a script writing service. What have you tried yourself?"}, {"owner": {"reputation": 43, "user_id": 3382091, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100001667179678/picture?type=large", "display_name": "BenThomas", "link": "https://stackoverflow.com/users/3382091/benthomas"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1462959939, "post_id": 37157539, "comment_id": 61853574, "body": "@CallumDA33- I have added the code I used"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1462960308, "post_id": 37157539, "comment_id": 61853842, "body": "Why don&#39;t you just use conditional formatting?"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 3382091, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100001667179678/picture?type=large", "display_name": "BenThomas", "link": "https://stackoverflow.com/users/3382091/benthomas"}, "edited": false, "score": 0, "creation_date": 1462964590, "post_id": 37158779, "comment_id": 61856845, "body": "Thank you. I am a beginner in macro. You have helped a lot"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 43, "user_id": 3382091, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100001667179678/picture?type=large", "display_name": "BenThomas", "link": "https://stackoverflow.com/users/3382091/benthomas"}, "edited": false, "score": 0, "creation_date": 1462970385, "post_id": 37158779, "comment_id": 61861179, "body": "@BenThomas - Glad I could help."}], "tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 1, "last_activity_date": 1462962758, "last_edit_date": 1462962758, "creation_date": 1462959834, "answer_id": 37158779, "question_id": 37157539, "link": "https://stackoverflow.com/questions/37157539/excel-vba-need-to-compare-two-tables-in-the-same-sheet-the-input-tables-will-b/37158779#37158779", "title": "Excel VBA- Need to compare two tables in the same sheet. the input tables will be given as selection using mouse", "body": "<p>Try the following code:</p>\n\n<pre><code>Sub CompareTable()\n\n    Dim oldTable As Range, newTable As Range, i As Integer, J As Integer, m As Integer, n As Integer\n\n    On Error Resume Next\n\n    Set oldTable = Application.InputBox(Prompt:=\"Please Select Raw Data\", Title:=\"Range Select\", Type:=8)\n    Set newTable = Application.InputBox(Prompt:=\"Please Select Processed Data\", Title:=\"Range Select\", Type:=8)\n\n    i = oldTable.Rows.Count\n    J = oldTable.Columns.Count\n\n    For m = 1 To i\n        For n = 1 To J\n            If oldTable.Cells(m, n) &lt;&gt; newTable.Cells(m, n) Then\n                newTable.Cells(m, n).Interior.ColorIndex = 6\n            End If\n        Next n\n    Next m\n\nEnd Sub\n</code></pre>\n\n<p>This will ask you for two ranges. Select the two tables that you want to compare and the differences will be highlighted in the second table.</p>\n\n<p><strong>EDIT</strong>:\n<strong>_________________________________________________________________________________</strong></p>\n\n<p>Or you can update your code to:</p>\n\n<pre><code>Sub CompareBtn_Click()\n    Dim first_index As Integer\n    Dim last_index As Integer\n    Dim rows_index As Integer, columns_index As Integer\n    Dim sheet1 As Worksheet\n    Dim sheet2 As Worksheet\n    Dim r1 As Integer\n    Dim r2 As Integer\n    Dim found As Boolean\n    Dim rng As Range\n\n    Set sheet1 = Worksheets(\"Source\")\n    Set sheet2 = Worksheets(\"Minus\")\n\n    rows_index = sheet2.UsedRange.Rows.Count\n    columns_index = sheet2.UsedRange.Columns.Count\n\n    For r2 = 1 To rows_index\n        For r1 = 1 To columns_index\n            If sheet1.Cells(r2, r1) &lt;&gt; sheet2.Cells(r2, r1) Then\n                sheet2.Cells(r2, r1).Interior.ColorIndex = 35\n            End If\n        Next r1\n    Next r2\n    sheet2.Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 3382091, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100001667179678/picture?type=large", "display_name": "BenThomas", "link": "https://stackoverflow.com/users/3382091/benthomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "accepted_answer_id": 37158779, "answer_count": 1, "score": 0, "last_activity_date": 1462975018, "creation_date": 1462956716, "last_edit_date": 1462975018, "question_id": 37157539, "link": "https://stackoverflow.com/questions/37157539/excel-vba-need-to-compare-two-tables-in-the-same-sheet-the-input-tables-will-b", "title": "Excel VBA- Need to compare two tables in the same sheet. the input tables will be given as selection using mouse", "body": "<p>I want to compare two tables in the same sheet. I will select the first table and click on button to give as first input. Similarly I will give next table input. When I click 'compare' button, the result should be displayed by highlighting cells in the second table. Please help me to do this.</p>\n\n<p>Below is the script I Used to compare two tables in two sheets. Please help me to find to give input using selection option</p>\n\n<pre><code>Private Sub CompareBtn_Click()\nDim first_index As Integer\nDim last_index As Integer\nDim sheet1 As Worksheet\nDim sheet2 As Worksheet\nDim r1 As Integer\nDim r2 As Integer\nDim found As Boolean\nDim rng As Range\n\n    Set sheet1 = Worksheets(\"Source\")\n    Set sheet2 = Worksheets(\"Minus\")\n\n\n    first_index = 1\n    last_index = sheet2.UsedRange.Rows.Count\n\n\n\n    For r2 = first_index To last_index\n        found = False\n\n        For r1 = first_index To last_index\n            If sheet1.Cells(r1, 1) = sheet2.Cells(r2, 1) _\n                And _\n               sheet1.Cells(r1, 2) = sheet2.Cells(r2, 2) _\n            Then\n\n                found = True\n                Exit For\n            End If\n        Next r1\n\n\n        If Not found Then\n\n            sheet2.Cells(r2, 1).Interior.ColorIndex = 35\n            sheet2.Cells(r2, 2).Interior.ColorIndex = 35\n        End If\n    Next r2\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1462957372, "post_id": 37157485, "comment_id": 61851829, "body": "Use Error Handling- <code>On Error GoTo Err_Exit</code> then on exit set your object to Quit"}, {"owner": {"reputation": 193, "user_id": 5519581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9749b449e3b7199e4e198c5b461d50de?s=128&d=identicon&r=PG", "display_name": "Lance", "link": "https://stackoverflow.com/users/5519581/lance"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1462958234, "post_id": 37157485, "comment_id": 61852417, "body": "Interruption is handled as an error?"}, {"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1462964388, "post_id": 37157485, "comment_id": 61856712, "body": "how do you open the IE if you use the SHDocVw.InternetExplorer &#39;microsoft internet controls (shdocvw.dll) you can use .Quit also you can raise Errors programmatically -&gt; <a href=\"http://stackoverflow.com/questions/26368883/how-to-stop-vba-code-execution-if-conditions-are-met\" title=\"how to stop vba code execution if conditions are met\">stackoverflow.com/questions/26368883/&hellip;</a>"}, {"owner": {"reputation": 193, "user_id": 5519581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9749b449e3b7199e4e198c5b461d50de?s=128&d=identicon&r=PG", "display_name": "Lance", "link": "https://stackoverflow.com/users/5519581/lance"}, "edited": false, "score": 0, "creation_date": 1462966313, "post_id": 37157485, "comment_id": 61858008, "body": "Set IE = New InternetExplorerMedium Along the reference are Internet Controls and HTML object library I use quit at the end of macro. The problem is, that User can interrupt the macro and the iexplorer.exe remains open in process list. And the Om3r suggestion did not work. VBA doesn&#39;t handle interruption as an error, even if it did, the user interrupts the process so if exactly at the time of interruption code dictated to quit it would be stopped by the same thing - the interruption"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1462987271, "post_id": 37157485, "comment_id": 61873628, "body": "In what application is this code running? What does a user do to interrupt the process?"}], "answers": [{"tags": [], "owner": {"reputation": 98, "user_id": 3230453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/COYUq.jpg?s=128&g=1", "display_name": "Ricky", "link": "https://stackoverflow.com/users/3230453/ricky"}, "is_accepted": false, "score": 0, "last_activity_date": 1462984485, "last_edit_date": 1462984485, "creation_date": 1462984037, "answer_id": 37168380, "question_id": 37157485, "link": "https://stackoverflow.com/questions/37157485/trigger-macro-using-abort/37168380#37168380", "title": "Trigger macro using abort", "body": "<p>This will interrupt the hidden IE and close it.</p>\n\n<pre><code>Sub Test()\nOn error goto Out:\n\n'Do Something\n\nExit Sub\n\nOut:\n    IE.quit\n  'End\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 5519581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9749b449e3b7199e4e198c5b461d50de?s=128&d=identicon&r=PG", "display_name": "Lance", "link": "https://stackoverflow.com/users/5519581/lance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1462984485, "creation_date": 1462956563, "last_edit_date": 1462966856, "question_id": 37157485, "link": "https://stackoverflow.com/questions/37157485/trigger-macro-using-abort", "title": "Trigger macro using abort", "body": "<p>Is there a way to trigger macro by the escape key that is used to interrupt the ongoing procedure? I found nothing on the subject on the internet. </p>\n\n<p>I have a procedure that opens Internet Explorer in not visible mode. It's pulling data from pages. Now when user interrupts the procedure the Internet Explorer remains open. I need to shut it down if user chooses to interrupt for whatever reason. Can someone point me in the right direction?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 5836742, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/e0663fa0d3d4b7ca71ca3e00155561de?s=128&d=identicon&r=PG&f=1", "display_name": "user5836742", "link": "https://stackoverflow.com/users/5836742/user5836742"}, "edited": false, "score": 0, "creation_date": 1462958601, "post_id": 37157795, "comment_id": 61852661, "body": "Thanks for the response - I&#39;m a little confused though, how would this work? Is this not just unhiding sheets to everyone? I&#39;m looking for something that specifies Name1 can see Sheet3 and Sheet 4, Name2 can see sheet4 and Sheet5. (As an example)"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 43, "user_id": 5836742, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/e0663fa0d3d4b7ca71ca3e00155561de?s=128&d=identicon&r=PG&f=1", "display_name": "user5836742", "link": "https://stackoverflow.com/users/5836742/user5836742"}, "edited": false, "score": 0, "creation_date": 1462958965, "post_id": 37157795, "comment_id": 61852897, "body": "@user5836742 - Oops! I think I didn&#39;t understand your question completely. My code will make Sheet1 visible to Name1, Sheet2 visible to Name2 and so on..."}, {"owner": {"reputation": 43, "user_id": 5836742, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/e0663fa0d3d4b7ca71ca3e00155561de?s=128&d=identicon&r=PG&f=1", "display_name": "user5836742", "link": "https://stackoverflow.com/users/5836742/user5836742"}, "edited": false, "score": 0, "creation_date": 1462960245, "post_id": 37157795, "comment_id": 61853799, "body": "Ah ok, do you have any recommendations for what I am looking for?"}], "tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": false, "score": 0, "last_activity_date": 1462957406, "creation_date": 1462957406, "answer_id": 37157795, "question_id": 37157323, "link": "https://stackoverflow.com/questions/37157323/vba-hide-sheets-from-specific-users/37157795#37157795", "title": "VBA hide sheets from specific users", "body": "<p>Make changes in your <code>If</code> condition as:</p>\n\n<pre><code>If Err &lt;&gt; 0 Then\n    MsgBox \"You are not authorised to use this Workbook\"\n    ThisWorkbook.Close SaveChanges:=False\nElse\n    For Each ws In Worksheets\n        If ws.Name &lt;&gt; \"Sheet\" &amp; UFind Then\n            ws.Visible = xlSheetHidden\n        End If\n    Next ws\nEnd If\n</code></pre>\n\n<p>Make sure that the sheet names are Sheet1, Sheet2, Sheet3, .. etc as mentioned in the question.</p>\n"}, {"comments": [{"owner": {"reputation": 1269, "user_id": 6065711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bedb05fd942a5a6acd9870d295d3afd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jochen", "link": "https://stackoverflow.com/users/6065711/jochen"}, "edited": false, "score": 0, "creation_date": 1462976314, "post_id": 37164446, "comment_id": 61866253, "body": "Nicely done! Just two remarks: (1) Take a look at <code>Select Case ... End Select</code>, it has a better structure than lots of <code>ElseIf</code>s. (2) You can alternatively use <code>Workbook_BeforeSave</code>. This has the advantage, that the User can decide not to save..."}], "tags": [], "owner": {"reputation": 43, "user_id": 5836742, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/e0663fa0d3d4b7ca71ca3e00155561de?s=128&d=identicon&r=PG&f=1", "display_name": "user5836742", "link": "https://stackoverflow.com/users/5836742/user5836742"}, "is_accepted": true, "score": 1, "last_activity_date": 1462973971, "creation_date": 1462973971, "answer_id": 37164446, "question_id": 37157323, "link": "https://stackoverflow.com/questions/37157323/vba-hide-sheets-from-specific-users/37164446#37164446", "title": "VBA hide sheets from specific users", "body": "<p>Came up with an answer, it is pretty simple, and wont withstand new users being added, but for the mean time it is ok...</p>\n\n<pre><code>Private Sub Workbook_Open()\n Dim Users As Variant\n Dim UName As String\n Dim UFind As Variant\n Users = Array(\"Name1\", \"Name2\", \"Name3\")\n\n UName = Environ(\"UserName\")\n On Error Resume Next\n UFind = WorksheetFunction.Match(UName, Users, 0)\n If UName = \"Name2\" Then\n Worksheets(\"Sheet23\").Visible = True\n Worksheets(\"SHEET17\").Visible = True\n\n ElseIf UName = \"Name1\" Then\n Worksheets(\"Sheet23\").Visible = True\n Worksheets(\"SHEET17\").Visible = True\n Worksheets(\"Sheet4\").Visible = True\n\n\n ElseIf UName = \"Name3\" Then\n Worksheets(\"Sheet23\").Visible = True\n Worksheets(\"SHEET17\").Visible = True\n\n ElseIf Err &lt;&gt; 0 Then\n     MsgBox \"You are not authorised to use this Workbook\"\n     ThisWorkbook.Close SaveChanges:=False\n End If\n End Sub\n</code></pre>\n\n<p>And in order to re-hide them all again when closing the file:</p>\n\n<pre><code>SubPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n\nWorksheets(\"Sheet23\").Visible = False\nWorksheets(\"SHEET17\").Visible = False\nWorksheets(\"Sheet4\").Visible = False\nWorksheets(\"Sheet1\").Visible = False\n\n\u2018If you don\u2019t save it\u2019s not effective\nMe.Save End Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5836742, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/e0663fa0d3d4b7ca71ca3e00155561de?s=128&d=identicon&r=PG&f=1", "display_name": "user5836742", "link": "https://stackoverflow.com/users/5836742/user5836742"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2209, "favorite_count": 0, "protected_date": 1566069022, "accepted_answer_id": 37164446, "answer_count": 2, "score": 3, "last_activity_date": 1565999164, "creation_date": 1462956179, "last_edit_date": 1462959131, "question_id": 37157323, "link": "https://stackoverflow.com/questions/37157323/vba-hide-sheets-from-specific-users", "title": "VBA hide sheets from specific users", "body": "<p>Looking for some help on VBA User restrictions. \nSo far I have the code pasted below. It is working perfectly, but I want to build on it. </p>\n\n<p>I have it so the specific users listed have access to the file, and anyone else who tries to access the file gets a <code>msgbox</code> saying they aren't authorized and then the book closes. </p>\n\n<p>I am however hoping that some of the users can see some sheets (the sheets they shouldn't see will be xlveryhidden) And then the other users can see the other sheets listed...</p>\n\n<p>ie:\nName 1 can see sheet 13, \nName2 can see sheet14 and sheet3 \nName 3 can see sheet22 sheet23 and sheet4\nIn terms of security it isn't hugely important, they are all from the same team, but just for user friendly and tidy document.</p>\n\n<pre><code>Private Sub Workbook_Open()\n Dim Users As Variant\n Dim UName As String\n Dim UFind As Variant\n Users = Array(\"Name1\", \"Name2\", \"Name3\", \"Name4\", \"Name5\")\n\n UName = Environ(\"UserName\")\n On Error Resume Next\n UFind = WorksheetFunction.Match(UName, Users, 0)\n If Err &lt;&gt; 0 Then\n     MsgBox \"You are not authorised to use this Workbook\"\n     ThisWorkbook.Close SaveChanges:=False\n End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 381, "user_id": 1753935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2mkbh.jpg?s=128&g=1", "display_name": "DDuffy", "link": "https://stackoverflow.com/users/1753935/dduffy"}, "edited": false, "score": 2, "creation_date": 1462957611, "post_id": 37157247, "comment_id": 61851996, "body": "You may want to start by showing what you have tried yourself. People here are always willing to help, but not so willing to do it for you with no visible attempt from you."}, {"owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 0, "creation_date": 1462958857, "post_id": 37157247, "comment_id": 61852832, "body": "It could be done by looping through columns and using InStr or StrComp to compare cells (depending on how you want the comparison to be done. As DDuffy has said though, where have you got so far? People are happy to help but only if you show willingness to try and learn and persevere!"}, {"owner": {"reputation": 1, "user_id": 4480714, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1cdda656c59ec3008a372be33fa79f4?s=128&d=identicon&r=PG&f=1", "display_name": "patr", "link": "https://stackoverflow.com/users/4480714/patr"}, "reply_to_user": {"reputation": 381, "user_id": 1753935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2mkbh.jpg?s=128&g=1", "display_name": "DDuffy", "link": "https://stackoverflow.com/users/1753935/dduffy"}, "edited": false, "score": 0, "creation_date": 1463015917, "post_id": 37157247, "comment_id": 61885935, "body": "@DDuffy I asked because I had no idea where to begin but if you could suggest some places where I can read up on rather than saying stuff like &quot;no visible attempt&quot;, it would be really great."}, {"owner": {"reputation": 381, "user_id": 1753935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2mkbh.jpg?s=128&g=1", "display_name": "DDuffy", "link": "https://stackoverflow.com/users/1753935/dduffy"}, "edited": false, "score": 0, "creation_date": 1463040296, "post_id": 37157247, "comment_id": 61895054, "body": "have you tried googling &quot;VBA Compare string values&quot;? the fourth result is an article on this site that will give you a good jumping off point. <a href=\"http://stackoverflow.com/questions/24370665/comparing-strings-in-vba\">See Here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 210, "user_id": 3568495, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fc05d9269ccdf83f68233c8093ebba6c?s=128&d=identicon&r=PG&f=1", "display_name": "crookie", "link": "https://stackoverflow.com/users/3568495/crookie"}, "edited": false, "score": 0, "creation_date": 1462969402, "post_id": 37161683, "comment_id": 61860400, "body": "Why would anyone mark my answer down when I have given a full working solution to the problem? If you aren&#39;t sure about anything, why not ask"}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1462974936, "post_id": 37161683, "comment_id": 61865129, "body": "It wasn&#39;t me who down voted, but some people here think it&#39;s not great form to provide detailed answer to a poorly written question, esp. when the OP has shown no sign of having made any effort. Basically, this OP has said &quot;can someone write my code for free because I can&#39;t be bothered&quot; and you&#39;ve obliged him. It&#39;s possible that some might see that as encouraging more lazy or &#39;give me free code&#39; questions."}, {"owner": {"reputation": 210, "user_id": 3568495, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fc05d9269ccdf83f68233c8093ebba6c?s=128&d=identicon&r=PG&f=1", "display_name": "crookie", "link": "https://stackoverflow.com/users/3568495/crookie"}, "reply_to_user": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 1, "creation_date": 1462978449, "post_id": 37161683, "comment_id": 61867862, "body": "Thanks for your reasoning Ambie. I understand but would think it would be kinder for people to comment that they don&#39;t think I should have given an answer rather than to rate it down which implies my answer doesn&#39;t work, which it does. I read the other original 2 comments before writing my answer and did so as when I was new to programming, there were times when I didn&#39;t really know where to start which may or not be the case here. I like to give people the benefit of doubt and work on the assumption the questioner wants to learn. I have lost 4 points today when I was just trying to be helpful"}, {"owner": {"reputation": 381, "user_id": 1753935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2mkbh.jpg?s=128&g=1", "display_name": "DDuffy", "link": "https://stackoverflow.com/users/1753935/dduffy"}, "edited": false, "score": 0, "creation_date": 1463040479, "post_id": 37161683, "comment_id": 61895171, "body": "Just for the record, it wasn&#39;t me that down voted you either. If someone wants to give an answer that is their choice. I voted you up as i think answering this question is selfless and admirable. but hey."}], "tags": [], "owner": {"reputation": 210, "user_id": 3568495, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fc05d9269ccdf83f68233c8093ebba6c?s=128&d=identicon&r=PG&f=1", "display_name": "crookie", "link": "https://stackoverflow.com/users/3568495/crookie"}, "is_accepted": false, "score": 1, "last_activity_date": 1462973134, "last_edit_date": 1462973134, "creation_date": 1462967173, "answer_id": 37161683, "question_id": 37157247, "link": "https://stackoverflow.com/questions/37157247/vba-code-to-compare-cell-values/37161683#37161683", "title": "VBA code to compare cell values", "body": "<p>I think its easy enough the use the worksheet function Match which will error if the items doesn't exist so we handle the error. Here's my answer:</p>\n\n<pre><code>Sub MyCompare()\n    Dim wksMaster As Worksheet\n    Dim wksBases(2) As Worksheet\n    Dim wksBase As Variant\n    Dim intRowCountBase As Integer\n    Dim intRowCountMaster As Integer\n    Dim rngCell As Range\n    Dim rngMasterColG As Range\n    Dim intMatch As Integer\n\n    'set up sheet vaiables\n    Set wksMaster = ActiveWorkbook.Worksheets(\"Master\")\n    Set wksBases(0) = ActiveWorkbook.Worksheets(\"Base1\")\n    Set wksBases(1) = ActiveWorkbook.Worksheets(\"Base2\")\n    Set wksBases(2) = ActiveWorkbook.Worksheets(\"Base3\")\n\n    'get the range of the master sheet col G\n    intRowCountMaster = wksMaster.UsedRange.Rows.Count\n    Set rngMasterColG = wksMaster.Range(wksMaster.Cells(1, 7), wksMaster.Cells(intRowCountMaster, 7))\n\n    'Loop through the base sheets\n    For Each wksBase In wksBases\n        intRowCountBase = wksBase.UsedRange.Rows.Count\n\n        'Loop through the cells in col H of the base sheet\n        For Each rngCell In wksBase.Range(wksBase.Cells(1, 8), wksBase.Cells(intRowCountBase, 8))\n            If rngCell.Value &lt;&gt; \"\" Then 'only do something if there is a value in the base sheet\n                On Error Resume Next\n                'the match value will error if the item doesn't exist\n                intMatch = Application.WorksheetFunction.Match(rngCell.Value, rngMasterColG, 0)\n                If Err.Number &gt; 0 Then ' ie there is no match\n                    On Error GoTo 0\n\n                    intRowCountMaster = intRowCountMaster + 1\n                    'put the item on the master sheet\n                    wksMaster.Cells(intRowCountMaster, 7).Value = rngCell.Value\n                    'reset the master range\n                    Set rngMasterColG = wksMaster.Range(wksMaster.Cells(1, 7), wksMaster.Cells(intRowCountMaster, 7))\n                End If\n            End If\n        Next rngCell\n\n    Next wksBase\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4480714, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1cdda656c59ec3008a372be33fa79f4?s=128&d=identicon&r=PG&f=1", "display_name": "patr", "link": "https://stackoverflow.com/users/4480714/patr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 674, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1462973134, "creation_date": 1462955925, "question_id": 37157247, "link": "https://stackoverflow.com/questions/37157247/vba-code-to-compare-cell-values", "title": "VBA code to compare cell values", "body": "<p>I have 3 worksheets(base) and a master worksheet (master) to compare with.</p>\n\n<p>For each base worksheet, I need to compare the string value in each row for Col H (e.g.) to each row in master worksheet for Col G (e.g.). If the string value does not exist in the whole col G, the row in the base worksheet must be copied over to the master worksheet.</p>\n\n<p>TIA!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7455, "user_id": 5432501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8MGE3.png?s=128&g=1", "display_name": "Alex Knauth", "link": "https://stackoverflow.com/users/5432501/alex-knauth"}, "edited": false, "score": 0, "creation_date": 1462977596, "post_id": 37157024, "comment_id": 61867234, "body": "For this question and your previous one, you had tried to use the [macros] tag. But the usage info for that tag specifically says, &quot;<i>Not for MS-OFFICE / VBA / macro languages. Use the respective tags instead.</i>&quot; So, for future Excel/VBA macro questions, you shouldn&#39;t use the [macros] tag; you should use tags like [excel-vba] instead."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6310290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/051740004885cbfb686f98e834dd4580?s=128&d=identicon&r=PG&f=1", "display_name": "vbacoder1", "link": "https://stackoverflow.com/users/6310290/vbacoder1"}, "edited": false, "score": 0, "creation_date": 1462956619, "post_id": 37157182, "comment_id": 61851273, "body": "THANK YOU!  the offset worked just the way i wanted to!"}], "tags": [], "owner": {"reputation": 912, "user_id": 5082125, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63dcdfcc8b5d1d469fecd22e9f5819e1?s=128&d=identicon&r=PG&f=1", "display_name": "manu", "link": "https://stackoverflow.com/users/5082125/manu"}, "is_accepted": false, "score": 0, "last_activity_date": 1462955681, "creation_date": 1462955681, "answer_id": 37157182, "question_id": 37157024, "link": "https://stackoverflow.com/questions/37157024/vba-code-for-adding-information-to-the-right-place/37157182#37157182", "title": "Vba code for adding information to the right place", "body": "<p>You should use <strong>Offset</strong> so replace:</p>\n\n<pre><code> Rng.Value = tulos \n</code></pre>\n\n<p>By:</p>\n\n<p><code>Rng.Offset(, 6).Value = tulos</code></p>\n"}, {"tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": true, "score": 0, "last_activity_date": 1462955685, "creation_date": 1462955685, "answer_id": 37157183, "question_id": 37157024, "link": "https://stackoverflow.com/questions/37157024/vba-code-for-adding-information-to-the-right-place/37157183#37157183", "title": "Vba code for adding information to the right place", "body": "<p>You can use <code>OFFSET</code>, for example:<br>\nChange <code>Rng.Value = tulos</code> to <code>Rng.Offset(0, 1).Value = tulos</code> to move the input 1 column to the right. Just change the 1 to however many columns you need to hop in order to end up in column G.</p>\n\n<p>Alternatively, you can construct a new range:<br>\nChange <code>Rng.Value = tulos</code> to <code>Range(\"G\" &amp; rng.Row).Value = tulos</code></p>\n"}], "owner": {"reputation": 19, "user_id": 6310290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/051740004885cbfb686f98e834dd4580?s=128&d=identicon&r=PG&f=1", "display_name": "vbacoder1", "link": "https://stackoverflow.com/users/6310290/vbacoder1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 37157183, "answer_count": 2, "score": 0, "last_activity_date": 1462976132, "creation_date": 1462955327, "last_edit_date": 1462976132, "question_id": 37157024, "link": "https://stackoverflow.com/questions/37157024/vba-code-for-adding-information-to-the-right-place", "title": "Vba code for adding information to the right place", "body": "<p>I am trying to find solution for my code, where first the user is asked a player's name and then the macro searches for the name in my database. If the name is there then the macro asks how many goals the player has made. Then the number of goals written to the inputBox is added to the player's information.</p>\n\n<p>My problem is that the macro doesn't add the number of goals for the player that has been searched. It adds the number of goals and replaces the players name </p>\n\n<p>Here is my code right now:</p>\n\n<pre><code>Sub maalit()\n\n   Dim ws As Worksheet\n   Dim lRow As Long\n   Dim strSearch As String\n    Set ws = Worksheets(\"Data\")\n\n\nDim etsi As String\netsi = InputBox(\"Etsi J\u00e4sen\", \"maalien lis\u00e4\u00e4minen\")   'asks the players name\n\n\nIf Trim(etsi) &lt;&gt; \"\" Then\n        With Sheets(\"Data\").Range(\"A:A\")\n            Set Rng = .Find(What:=etsi, _\n                            After:=.Cells(.Cells.Count), _\n                            LookIn:=xlValues, _\n                            LookAt:=xlWhole, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlNext, _\n                            MatchCase:=False)\n            If Not Rng Is Nothing Then\n\n   tulos = InputBox(\"Anna pelaajan maalienm\u00e4\u00e4r\u00e4\", \"maalien lis\u00e4\u00e4minen\")\n    Rng.Value = tulos        'asks the number of goals but this is the problem place the bacause it adds them to the wrong column i want them to be in column G\n\n\n        Else\n                MsgBox \"J\u00e4sent\u00e4 ei l\u00f6ytynyt\"\n            End If\n        End With\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 2, "creation_date": 1462954893, "post_id": 37156842, "comment_id": 61850199, "body": "See this: <a href=\"http://stackoverflow.com/questions/10380312/loop-through-files-in-a-folder-using-vba\" title=\"loop through files in a folder using vba\">stackoverflow.com/questions/10380312/&hellip;</a>"}, {"owner": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "reply_to_user": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1462956788, "post_id": 37156842, "comment_id": 61851379, "body": "doesnt help me at all, thanks though !"}, {"owner": {"reputation": 381, "user_id": 1753935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2mkbh.jpg?s=128&g=1", "display_name": "DDuffy", "link": "https://stackoverflow.com/users/1753935/dduffy"}, "edited": false, "score": 1, "creation_date": 1462958029, "post_id": 37156842, "comment_id": 61852288, "body": "Actually, i think that link will help you more than you think. The link shows code that will open all files in a folder if they have the word test in the name. If you replace the &quot;IF&quot; statement in the middle of the loop with your copy/paste code, you will have the code to loop through every file in a folder, copy from it, paste to another, and close."}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "edited": false, "score": 0, "creation_date": 1462959630, "post_id": 37158300, "comment_id": 61853343, "body": "thank you for the help. However this does not compile, as it states Workbooks.Close (False) causes Problem. when i delete this then it gives another error."}], "tags": [], "owner": {"reputation": 381, "user_id": 1753935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2mkbh.jpg?s=128&g=1", "display_name": "DDuffy", "link": "https://stackoverflow.com/users/1753935/dduffy"}, "is_accepted": true, "score": 1, "last_activity_date": 1462963187, "last_edit_date": 1462963187, "creation_date": 1462958667, "answer_id": 37158300, "question_id": 37156842, "link": "https://stackoverflow.com/questions/37156842/opening-and-copy-pasting-variable-named-file/37158300#37158300", "title": "opening and copy/pasting variable named file", "body": "<p>Untested, as i am currently unable to use Excel. However, using the information you provided, and the link @Mrig provided, i believe this could be the base for what you're looking for.</p>\n\n<pre><code>    Sub LoopThroughFiles()\nDim StrFile As String\nDim WB As Workbook\nDim InputFilePath As String\nInputFilePath = \"Z:\\1000_Entwicklung\\05_PROJECT\\0558000_CFT\\055800L_CFT_Projektleitung\\99_Arbeitsordner PL\\Tanverdi, Yigit\\SAA\\\"\nStrFile = Dir(InputFilePath &amp; \"*\")\n\nDo While Len(StrFile) &gt; 0\n        Set WB = Workbooks.Open(InputFilePath &amp; StrFile)\n        WB.Activate\n            Sheets(\"data\").Select\n            Sheets(\"data\").Move After:=Workbooks(\"makrotochange.xlsm\").Sheets(23)\n            StrFile = Dir()\n    Loop\n    End Sub\n</code></pre>\n\nEDITED\n\n<p>Edited the code now that i am able to use Excel. </p>\n\n<p>This will take all the files in the folder, open them, copy the \"Data\" sheet, and move it to after sheet 23 in your makrotochange.xlsm file.</p>\n\n<p>A few points of interest though.\nYou need to make sure that your makrotochange.xlsm file is open to begin with. \nYou need to make sure all files have a sheet called \"Data\".\nThey will be pasted after Sheet 23. So the last file to be pasted in will be the one next to sheet 23.</p>\n\n<p>Have fun</p>\n"}], "owner": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 37158300, "answer_count": 1, "score": 0, "last_activity_date": 1462963187, "creation_date": 1462954743, "question_id": 37156842, "link": "https://stackoverflow.com/questions/37156842/opening-and-copy-pasting-variable-named-file", "title": "opening and copy/pasting variable named file", "body": "<p>I have the following vba code which opens a Folder, where i save the Excel files with certain names (\"11.xlsm and \"2.xlsm\") and then open These files automatically and copy their Sheets called \"data\" and paste it to my masterworkbook \"makrotochange\".</p>\n\n<pre><code> ChDir _\n    \"Z:\\1000_Entwicklung\\05_PROJECT\\0558000_CFT\\055800L_CFT_Projektleitung\\99_Arbeitsordner PL\\Tanverdi, Yigit\\SAA\"\nWorkbooks.Open Filename:= _\n    \"Z:\\1000_Entwicklung\\05_PROJECT\\0558000_CFT\\055800L_CFT_Projektleitung\\99_Arbeitsordner PL\\Tanverdi, Yigit\\SAA\\11.xlsm\"\nWorkbooks.Open Filename:= _\n    \"Z:\\1000_Entwicklung\\05_PROJECT\\0558000_CFT\\055800L_CFT_Projektleitung\\99_Arbeitsordner PL\\Tanverdi, Yigit\\SAA\\2.xlsm\"\nWindows(\"makrotochange.xlsm\").Activate\n\n\n\n Windows(\"11.xlsm\").Activate\nsheets(\"data\").Select\n\nsheets(\"data\").Move After:=Workbooks(\"makrotochange.xlsm\").sheets(23)\n\nWindows(\"2.xlsm\").Activate\n\nsheets(\"data\").Select\nsheets(\"data\").Move After:=Workbooks(\"makrotochange.xlsm\").sheets(24)\n</code></pre>\n\n<p>I want to be able to open any amount of variable named files which is in </p>\n\n<pre><code>\"Z:\\1000_Entwicklung\\05_PROJECT\\0558000_CFT\\055800L_CFT_Projektleitung\\99_Arbeitsordner PL\\Tanverdi, Yigit\\SAA\"\n</code></pre>\n\n<p>and copy/paste it to my \"makrotochange.xlsm\" masterworkbook.</p>\n\n<p>How can i do this ?</p>\n"}, {"tags": ["vba", "email", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 3569647, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/db427040dbb35d473e0ee8d2972449b0?s=128&d=identicon&r=PG&f=1", "display_name": "user3569647", "link": "https://stackoverflow.com/users/3569647/user3569647"}, "edited": false, "score": 0, "creation_date": 1462959215, "post_id": 37158214, "comment_id": 61853046, "body": "Thank you a lot , and how can i express the corresponding field a.value of the corresponding mail  as  &quot;Subject&quot;?"}, {"owner": {"reputation": 25, "user_id": 3569647, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/db427040dbb35d473e0ee8d2972449b0?s=128&d=identicon&r=PG&f=1", "display_name": "user3569647", "link": "https://stackoverflow.com/users/3569647/user3569647"}, "edited": false, "score": 0, "creation_date": 1462964088, "post_id": 37158214, "comment_id": 61856506, "body": "Now it works without error ,Nevertheless i can&#39;t receive the Email. any Idea?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 25, "user_id": 3569647, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/db427040dbb35d473e0ee8d2972449b0?s=128&d=identicon&r=PG&f=1", "display_name": "user3569647", "link": "https://stackoverflow.com/users/3569647/user3569647"}, "edited": false, "score": 0, "creation_date": 1462964983, "post_id": 37158214, "comment_id": 61857125, "body": "@user3569647: no, that can have many reasons, one would need to look at your installation to analyze it. And it really is a new question."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1462960276, "last_edit_date": 1462960276, "creation_date": 1462958439, "answer_id": 37158214, "question_id": 37156837, "link": "https://stackoverflow.com/questions/37156837/how-to-use-a-field-value-from-access-query-into-vba-code/37158214#37158214", "title": "how to use a field value from access query into vba code", "body": "<p>To use a value from a query in VBA, don't use <code>DoCmd.OpenQuery</code>. Open a <strong>Recordset</strong> instead. </p>\n\n<p>E.g. to send to all recipients in the query, loop over the recordset:</p>\n\n<pre><code>Dim db as DAO.Database\nDim rs as DAO.Recordset\nDim subj as String\n\nSet db = CurrentDB\nSet rs = db.OpenRecordset(\"Query1\")\n\nDo While Not rs.EOF\n    subj = \"Hello \" &amp; rs![field b]\n    DoCmd.SendObject acSendNoObject, , , rs!Mailfield, , , subj, \"Message\", False\n    rs.MoveNext\nLoop\nrs.Close\n</code></pre>\n\n<p>Note though that Outlook may display a security warning.</p>\n"}], "owner": {"reputation": 25, "user_id": 3569647, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/db427040dbb35d473e0ee8d2972449b0?s=128&d=identicon&r=PG&f=1", "display_name": "user3569647", "link": "https://stackoverflow.com/users/3569647/user3569647"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1186, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462960276, "creation_date": 1462954724, "question_id": 37156837, "link": "https://stackoverflow.com/questions/37156837/how-to-use-a-field-value-from-access-query-into-vba-code", "title": "how to use a field value from access query into vba code", "body": "<p><a href=\"https://i.stack.imgur.com/1YRxT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1YRxT.png\" alt=\"enter image description here\"></a></p>\n\n<p>Hi,I'm trying to make a Access macro, what sends mails to persons.</p>\n\n<p>This mails exist in a field \"MailField\" from a Query \"Query1\". So I'm trying to loop into all rows and send mails using the \"MailField\" with the corresponding value of row i as \"Message\":</p>\n\n<p>Example: mail to \"mail2@123.com\" With a message \"value of field a in row 2\".</p>\n\n<pre><code>Function makroabc()\nOn Error GoTo makroabc_Err\n\nFor i = \"first Raw\" To \"mumber of data in the query\"\n\n    If (Eval(\"Hour(Now()) Between 11 And 16\")) Then\n        DoCmd.OpenQuery \"Query1\", acViewNormal, acReadOnly\n        DoCmd.SendObject , \"\", \"\", \"Mail from row i\", \"\", \"\", \"Subject\", \"Message\", False, \"\"\n    End If\n\nNext i\n\nmakroabc_Exit:\n    Exit Function\n\nmakroabc_Err:\n    MsgBox Error$\n    Resume makroabc_Exit\n\nEnd Function\n</code></pre>\n\n<p>What can i input instead of  \"Mail from row i\" ?</p>\n\n<p>I hope you can help me.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "formatting", "ms-word"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1462955746, "post_id": 37156487, "comment_id": 61850723, "body": "If you want to apply styles to the first row only do it inside your <code>With .Condition(wdFirstRow) ...  End With</code> block."}, {"owner": {"reputation": 4777, "user_id": 375828, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/PZNgw.gif?s=128&g=1", "display_name": "Jason R. Mick", "link": "https://stackoverflow.com/users/375828/jason-r-mick"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1462974097, "post_id": 37156487, "comment_id": 61864339, "body": "Right, my above example uses that... the issue is I&#39;m not seeing any member of <code>StyTbl.Table.Condition(wdFirstRow)</code> that leads to <code>.Font.bold</code>.  Do you know how exactly to call that to get to <code>.Font</code>?  Or are you saying perhaps I don&#39;t have to?  Are you suggesting I do something like: <code>StyTbl.Table.Condition(wdFirstRow) StyTable.Font.Bold = True End With</code>?  Trying that now..."}, {"owner": {"reputation": 4777, "user_id": 375828, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/PZNgw.gif?s=128&g=1", "display_name": "Jason R. Mick", "link": "https://stackoverflow.com/users/375828/jason-r-mick"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1462975328, "post_id": 37156487, "comment_id": 61865482, "body": "EDIT:  If I set <code>StyTbl.Table.Condition(wdFirstRow) StyTable.Font.Bold = True End With</code>, that applies bold to the entire table, not just the first row.  However, if I set <code>StyTbl.Table.Condition(wdFirstRow).Font.Bold = True</code> that does work... can you post that as a solution?  For some reason the <code>StyTbl.Table.Condition(wdFirstRow)</code> wasn&#39;t initially showing its members, so I missed the somewhat obvious fix."}], "answers": [{"comments": [{"owner": {"reputation": 4777, "user_id": 375828, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/PZNgw.gif?s=128&g=1", "display_name": "Jason R. Mick", "link": "https://stackoverflow.com/users/375828/jason-r-mick"}, "edited": false, "score": 0, "creation_date": 1462984832, "post_id": 37167330, "comment_id": 61872238, "body": "Right... the vertical alignment is the last part I&#39;m uncertain on... if no one figures out a way to set it in a style, or if you modify your answer to include their solution, I will accept this answer... I appreciate the help and advice!"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 4777, "user_id": 375828, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/PZNgw.gif?s=128&g=1", "display_name": "Jason R. Mick", "link": "https://stackoverflow.com/users/375828/jason-r-mick"}, "edited": false, "score": 1, "creation_date": 1462990481, "post_id": 37167330, "comment_id": 61875603, "body": "@JasonR.Mick It doesn&#39;t appear to be available through the object model, although it can be done when creating a style through the Word UI. Any chance you could use a Word template (dotx or dotm) that contains the style already? Create a new document from the template and the style will automatically be &quot;inherited&quot;."}, {"owner": {"reputation": 4777, "user_id": 375828, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/PZNgw.gif?s=128&g=1", "display_name": "Jason R. Mick", "link": "https://stackoverflow.com/users/375828/jason-r-mick"}, "edited": false, "score": 0, "creation_date": 1463005904, "post_id": 37167330, "comment_id": 61883353, "body": "Hi Cindy, my current workaround is the following: <code>Sub AlignVertical(tblNew As Table, rows As Integer)    Dim rowIdx As Integer    For rowIdx = 1 To rows       tblNew.rows(rowIdx).Cells.VerticalAlignment = wdCellAlignVerticalCenter    Next rowIdx End Sub</code> It isn&#39;t quite as tidy/homogeneous as I&#39;d like, but it does the trick.  I use a similar function for table height: <code>Sub SetHeight(tblNew As Table, h As Single, rows As Integer)    Dim rowIdx As Integer    For rowIdx = 1 To rows       tblNew.rows(rowIdx).SetHeight h, wdRowHeightExactly    Next rowIdx End Sub</code>  Seemed the best option."}], "tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": true, "score": 2, "last_activity_date": 1462981114, "creation_date": 1462981114, "answer_id": 37167330, "question_id": 37156487, "link": "https://stackoverflow.com/questions/37156487/how-to-set-table-valign-and-first-row-bolding-in-word-vba-style/37167330#37167330", "title": "How to Set Table VAlign and First Row Bolding in Word VBA Style?", "body": "<p>You can access the <code>.Font</code> of the <code>.Condition(wdFirstRow)</code> to set the different settings you need:</p>\n\n<pre><code>Sub NewTableStyle()\n    Dim StyTbl As Style\n\n    Set StyTbl = ActiveDocument.Styles.Add(Name:=\"PhaseTable\", Type:=wdStyleTypeTable)\n\n    With StyTbl.Table\n        .Alignment = wdAlignRowLeft\n\n        With .Condition(wdFirstRow)\n            With .Borders(wdBorderBottom)\n                .LineStyle = wdLineStyleSingle\n                .Visible = True\n                .LineWidth = wdLineWidth150pt\n            End With\n            With .Borders(wdBorderTop)\n                .LineStyle = wdLineStyleSingle\n                .Visible = True\n                .LineWidth = wdLineWidth150pt\n            End With\n            With .Font\n                .Bold = False\n                .Size = 12\n                .Name = \"Times New Roman\"\n            End With\n\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>But there don't seems to have vba access to vertical alignment.</p>\n"}], "owner": {"reputation": 4777, "user_id": 375828, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/PZNgw.gif?s=128&g=1", "display_name": "Jason R. Mick", "link": "https://stackoverflow.com/users/375828/jason-r-mick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1194, "favorite_count": 0, "accepted_answer_id": 37167330, "answer_count": 1, "score": 0, "last_activity_date": 1462999820, "creation_date": 1462953714, "last_edit_date": 1462999820, "question_id": 37156487, "link": "https://stackoverflow.com/questions/37156487/how-to-set-table-valign-and-first-row-bolding-in-word-vba-style", "title": "How to Set Table VAlign and First Row Bolding in Word VBA Style?", "body": "<p>I have a basic <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195508.aspx\" rel=\"nofollow\">TableStyle</a> laid out as follows:</p>\n\n<pre><code>Sub NewTableStyle()\n Dim StyTbl As Style\n\n Set StyTbl = ActiveDocument.Styles.Add(Name:=\"PhaseTable\", Type:=wdStyleTypeTable)\n\n With StyTbl.Table\n    .Alignment = wdAlignRowLeft\n\n    With .Condition(wdFirstRow)\n        With .Borders(wdBorderBottom)\n            .LineStyle = wdLineStyleSingle\n            .Visible = True\n            .LineWidth = wdLineWidth150pt\n        End With\n        With .Borders(wdBorderTop)\n            .LineStyle = wdLineStyleSingle\n            .Visible = True\n            .LineWidth = wdLineWidth150pt\n        End With\n    End With\n\n End With\nEnd Sub\n</code></pre>\n\n<p>But I want to expand on it, applying the following to all cells:</p>\n\n<ul>\n<li>font: \"Times New Roman\", size 12.</li>\n<li>vertical alignment: middle</li>\n</ul>\n\n<p>...and the following to the first row only:</p>\n\n<ul>\n<li>bold</li>\n</ul>\n\n<p>I think I can add something like:</p>\n\n<pre><code> With StyTbl.Font\n    .Size = 12\n    .Name = \"Times New Roman\"\n End With\n</code></pre>\n\n<p>To the end of my subroutine to apply the following properties to the entire table.  However, I can't seem to figure out the selective first row bolding or the vertical alignment.</p>\n\n<p>I know it is probably possible as I can modify the Excel default styles to have these options in the GUI.  How do I set those options in the VBA <code>Style</code> which I plan to apply to tables?</p>\n"}, {"tags": ["vba", "ms-word", "ms-office"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1462953541, "post_id": 37156091, "comment_id": 61849340, "body": "Debug the programme - use <code>F8</code> key to find out what line causes error!"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 2, "creation_date": 1462953715, "post_id": 37156091, "comment_id": 61849446, "body": "<code>.Replacement.Text = &quot;\\1&quot; &amp; a=&quot;\\2&quot; inverter(a) &amp; &quot;\\3&quot;</code> Check this line. There seems to be a missing <code>&amp;</code> and I don&#39;t think <code>a=&quot;\\2&quot;</code> will work either. Also please don&#39;t put all the statements in one line, it&#39;s impossible to read."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 1, "creation_date": 1462956815, "post_id": 37156091, "comment_id": 61851405, "body": "Addition to my last comment: <code>a</code> and <code>inverter</code> should probably be changed to deal with strings. <code>a=&quot;\\2&quot; &amp; inverter(a)</code> won&#39;t work because <code>a=&quot;\\2&quot;</code> isn&#39;t evaluated when the text is replaced but when the replacement text is set so it will return false. <code>&quot;\\2&quot; &amp; inverter(&quot;\\2&quot;)</code> won&#39;t work either because <code>inverter(&quot;\\2&quot;)</code> is evaluated at time of definition of replacement.text. I would recommend looking into regular expressions and looping over the matches."}], "answers": [{"comments": [{"owner": {"reputation": 1434, "user_id": 2724418, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5HAOY.jpg?s=128&g=1", "display_name": "YFeizi", "link": "https://stackoverflow.com/users/2724418/yfeizi"}, "edited": false, "score": 1, "creation_date": 1462965642, "post_id": 37160338, "comment_id": 61857525, "body": "thanks for your time , i dont access to my pc now, i will test it tomorrow :)"}, {"owner": {"reputation": 95, "user_id": 4291593, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-s8YbIg53Abk/AAAAAAAAAAI/AAAAAAAAACQ/bZQTOITkpls/photo.jpg?sz=128", "display_name": "amini gazar", "link": "https://stackoverflow.com/users/4291593/amini-gazar"}, "edited": false, "score": 0, "creation_date": 1463202153, "post_id": 37160338, "comment_id": 61975762, "body": "test this file <a href=\"http://s000.tinyupload.com/index.php?file_id=93208893086428438387\" rel=\"nofollow noreferrer\">test.docx</a> macro <b>remove</b> line 2"}, {"owner": {"reputation": 95, "user_id": 4291593, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-s8YbIg53Abk/AAAAAAAAAAI/AAAAAAAAACQ/bZQTOITkpls/photo.jpg?sz=128", "display_name": "amini gazar", "link": "https://stackoverflow.com/users/4291593/amini-gazar"}, "edited": false, "score": 0, "creation_date": 1463203765, "post_id": 37160338, "comment_id": 61976113, "body": "@fabrice-lylian-tayou can you test this macro with this file?"}, {"owner": {"reputation": 553, "user_id": 3998265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc6a29af4bb7e5fed5d9446dc9d7d27?s=128&d=identicon&r=PG", "display_name": "Fabrice T", "link": "https://stackoverflow.com/users/3998265/fabrice-t"}, "reply_to_user": {"reputation": 95, "user_id": 4291593, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-s8YbIg53Abk/AAAAAAAAAAI/AAAAAAAAACQ/bZQTOITkpls/photo.jpg?sz=128", "display_name": "amini gazar", "link": "https://stackoverflow.com/users/4291593/amini-gazar"}, "edited": false, "score": 0, "creation_date": 1463217239, "post_id": 37160338, "comment_id": 61979732, "body": "@amini-gazar I am unable to download that doc, my antivirus blocked the website, can you share via dropbox or gg drive ?"}, {"owner": {"reputation": 95, "user_id": 4291593, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-s8YbIg53Abk/AAAAAAAAAAI/AAAAAAAAACQ/bZQTOITkpls/photo.jpg?sz=128", "display_name": "amini gazar", "link": "https://stackoverflow.com/users/4291593/amini-gazar"}, "edited": false, "score": 0, "creation_date": 1463826482, "post_id": 37160338, "comment_id": 62237143, "body": "@fabrice-lylian-tayou Share in <a href=\"https://www.dropbox.com/s/3bifaypj7vhgtex/test.docx?dl=0\" rel=\"nofollow noreferrer\">Dropbox</a>"}, {"owner": {"reputation": 553, "user_id": 3998265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc6a29af4bb7e5fed5d9446dc9d7d27?s=128&d=identicon&r=PG", "display_name": "Fabrice T", "link": "https://stackoverflow.com/users/3998265/fabrice-t"}, "edited": false, "score": 0, "creation_date": 1464124207, "post_id": 37160338, "comment_id": 62353089, "body": "I tested the code into that document, at my side it is not removing line but skipping some numbers"}], "tags": [], "owner": {"reputation": 553, "user_id": 3998265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc6a29af4bb7e5fed5d9446dc9d7d27?s=128&d=identicon&r=PG", "display_name": "Fabrice T", "link": "https://stackoverflow.com/users/3998265/fabrice-t"}, "is_accepted": true, "score": 2, "last_activity_date": 1462963589, "creation_date": 1462963589, "answer_id": 37160338, "question_id": 37156091, "link": "https://stackoverflow.com/questions/37156091/invert-numbers-in-document-using-macro/37160338#37160338", "title": "Invert numbers in document using macro", "body": "<p>This line doesn't make sense for me</p>\n\n<pre><code>.Replacement.Text = \"\\1\" &amp; a=\"\\2\" inverter(a) &amp; \"\\3\"\n</code></pre>\n\n<p>It seems like a combination of assignment, logical evaluation and \"error\"</p>\n\n<p>I am unable to find a batch replace solution like you need ; so here my suggestion:</p>\n\n<p>I changed your <code>Invertor</code> to work with strings instead, because your <code>Invertor</code> will return <code>1</code> for <code>1000</code> instead of <code>0001</code> (perhaps this is not considered in Word RegEx)</p>\n\n<pre><code>Function Inverter2(nb As String) As String\n    Dim bn As String\n    For i = 1 To Len(nb)\n        bn = Mid(nb, i, 1) &amp; bn\n    Next i\n    Inverter2 = bn\nEnd Function\n</code></pre>\n\n<p>And here is your <code>invert</code> changed</p>\n\n<pre><code>Sub invert()\nDim a As Long\n    Selection.GoTo What = wdGoToLine, Which = wdGoToFirst\n    Selection.Find.ClearFormatting\n    Selection.Find.Replacement.ClearFormatting\n    With Selection.Find\n           .Text = \"([!0-9])([0-9]@)([!0-9])\"\n           '.Replacement.Text = \"\\1\" &amp; a=\"\\2\" inverter(a) &amp; \"\\3\"\n           .Forward = True\n           '.Wrap = wdFindContinue\n           .Format = False\n           .MatchCase = False\n           .MatchWholeWord = False\n           .MatchKashida = False\n           .MatchDiacritics = False\n           .MatchAlefHamza = False\n           .MatchControl = False\n           .MatchWildcards = True\n           .MatchSoundsLike = False\n           .MatchAllWordForms = False\n           '.Execute Replace:=wdReplaceOne\n           While .Execute\n               Selection.Text = Inverter2(Selection.Text)\n           Wend\n    End With\n    Selection.GoTo What = wdGoToLine, Which = wdGoToFirst\nEnd Sub\n</code></pre>\n\n<p>I removed <code>.Wrap = wdFindContinue</code> because the text will be inverted two times so kept same</p>\n\n<p>I also removed your replacement and proceeded one by one.</p>\n"}], "owner": {"reputation": 1434, "user_id": 2724418, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5HAOY.jpg?s=128&g=1", "display_name": "YFeizi", "link": "https://stackoverflow.com/users/2724418/yfeizi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 1, "accepted_answer_id": 37160338, "answer_count": 1, "score": 1, "last_activity_date": 1462963589, "creation_date": 1462952394, "last_edit_date": 1462953801, "question_id": 37156091, "link": "https://stackoverflow.com/questions/37156091/invert-numbers-in-document-using-macro", "title": "Invert numbers in document using macro", "body": "<p>I want to write a macro to find numbers and invert them in a document.<br>\nfor example convert : <code>123456</code> to <code>654321</code><br>\nI write this macro but it doesnt work :  </p>\n\n<pre><code>Function inverter(Numbers)\nDim Num As Long\nDim inverted As Long\nNum = Numbers\nDo Until Num &gt;= 1\n    remainder = Num Mod 10\n    Num = Num / 10\n    inverted = inverted * 10 + remainder\nLoop\ninverter = inverted\nEnd Function\nSub invert()\nDim a As Long\n    Selection.GoTo What = wdGoToLine, Which = wdGoToFirst\n    Selection.Find.ClearFormatting\n    Selection.Find.Replacement.ClearFormatting\n    With Selection.Find\n           .Text = \"([!0-9])([0-9]@)([!0-9])\"\n           .Replacement.Text = \"\\1\" &amp; a=\"\\2\" inverter(a) &amp; \"\\3\"\n           .Forward = True\n           .Wrap = wdFindContinue\n           .Format = False\n           .MatchCase = False\n           .MatchWholeWord = False\n           .MatchKashida = False\n           .MatchDiacritics = False\n           .MatchAlefHamza = False\n           .MatchControl = False\n           .MatchWildcards = True\n           .MatchSoundsLike = False\n           .MatchAllWordForms = False\n           .Execute Replace:=wdReplaceAll\n    End With\nEnd Sub\n</code></pre>\n\n<p>When i compile it return this error :  </p>\n\n<pre><code>---------------------------\nMicrosoft Visual Basic for Applications\n---------------------------\nCompile error:\n\nExpected: end of statement\n---------------------------\nOK   Help   \n---------------------------\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-office"], "comments": [{"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 0, "creation_date": 1462953384, "post_id": 37156004, "comment_id": 61849249, "body": "What are you trying to do?"}, {"owner": {"reputation": 1, "user_id": 6318613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75a139f7a30dca1e58fa45ebec0ba73d?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Lavicka", "link": "https://stackoverflow.com/users/6318613/jan-lavicka"}, "reply_to_user": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 0, "creation_date": 1462955746, "post_id": 37156004, "comment_id": 61850724, "body": "to sort on double click"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 1, "creation_date": 1462957577, "post_id": 37156004, "comment_id": 61851972, "body": "I would add a hidden worksheet to your workbook that contains the proper code and copy that sheet. Alternatively, use the Workbook_SheetBeforeDoubleClick event in ThisWorkbook."}, {"owner": {"reputation": 1, "user_id": 6318613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75a139f7a30dca1e58fa45ebec0ba73d?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Lavicka", "link": "https://stackoverflow.com/users/6318613/jan-lavicka"}, "edited": false, "score": 0, "creation_date": 1462957760, "post_id": 37156004, "comment_id": 61852101, "body": "The problem is that the desired sheet is recreated even 100 times so the codename changes all the time. And we need to create more sheets automatically not just this one that changes its structure as desired."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6318613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75a139f7a30dca1e58fa45ebec0ba73d?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Lavicka", "link": "https://stackoverflow.com/users/6318613/jan-lavicka"}, "edited": false, "score": 0, "creation_date": 1463036083, "post_id": 37161102, "comment_id": 61892413, "body": "Thx, this looks like a solution/workaround of the bug, we will use that. So is this bug really a bug or just a typical Microsoft &quot;feature&quot;?"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1462965645, "creation_date": 1462965645, "answer_id": 37161102, "question_id": 37156004, "link": "https://stackoverflow.com/questions/37156004/vba-excel-codename-not-acquired-sometimes/37161102#37161102", "title": "VBA Excel Codename not acquired sometimes", "body": "<p>As @jkpieterse suggested - use a hidden worksheet.</p>\n\n<p>Create a template sheet and give it a codename of <code>shtTemplate</code>.<br>\nAdd this code to the sheet (NB the Key range selection could probably be better):</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    With ActiveSheet\n        .Sort.SortFields.Clear\n        .Sort.SortFields.Add Key:= _\n            Range(Selection.CurrentRegion.Offset(, Selection.Column - Selection.CurrentRegion.Resize(, 1).Column).Resize(, 1).Address) _\n            , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        With .Sort\n            .SetRange Range(Selection.CurrentRegion.Address)\n            .Header = xlYes\n            .MatchCase = False\n            .Orientation = xlTopToBottom\n            .SortMethod = xlPinYin\n            .Apply\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>Add a normal code module and add this code:</p>\n\n<pre><code>Public Sub CreateSheet()\n\n    Dim wrkSht As Worksheet\n\n    shtTemplate.Visible = xlSheetVisible\n    shtTemplate.Copy ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)\n    Set wrkSht = ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)\n    shtTemplate.Visible = xlSheetVeryHidden 'Hide the template sheet so only VBA can unhide it.\n\n    wrkSht.Name = \"Copied Sheet\"\n\nEnd Sub\n</code></pre>\n\n<p>You'll need to add something to give the new sheet the correct unique name.  The sort on double-click will work on each sheet you create.</p>\n"}], "owner": {"reputation": 1, "user_id": 6318613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75a139f7a30dca1e58fa45ebec0ba73d?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Lavicka", "link": "https://stackoverflow.com/users/6318613/jan-lavicka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1462965645, "creation_date": 1462952142, "last_edit_date": 1462962753, "question_id": 37156004, "link": "https://stackoverflow.com/questions/37156004/vba-excel-codename-not-acquired-sometimes", "title": "VBA Excel Codename not acquired sometimes", "body": "<pre><code>Set tablesheet = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ActiveSheet.Index))\nKodoveJmeno = ThisWorkbook.VBProject.VBComponents(tablesheet.CodeName).Properties(\"Codename\")\nThisWorkbook.VBProject.VBComponents(KodoveJmeno).CodeModule.AddFromString _ \"Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\" + Chr(10) _ + \"Application.ScreenUpdating = False\" + Chr(10) _ + \"Call Trideni.Serad(Target, ActiveCell.ListObject.Name)\" + Chr(10) _ + \"Application.ScreenUpdating = True\" + Chr(10) _ + \"End Sub\"\n</code></pre>\n\n<p>The 2nd command stops with:</p>\n\n<blockquote>\n  <p>Run-time error '9': subscript out of range</p>\n</blockquote>\n\n<p>but after F5 it continues without problems - Looks like BUG has been present for many years (Office 2003-2016)!! Any solution for this?</p>\n\n<p>Sometimes it works - after I delete the sheet, open and close VBA with alt+F11 but sometimes it is broken and VERY ANNOYING all the time, destroys productive work.</p>\n\n<p>On some computer everything is OK, on some computers we get errors. Looks like a problem of internal excel procedures sync with VBA communication or something like this (sleep, waiting or alt+f11 in VBA don't not work).</p>\n\n<p>Thx for help</p>\n"}, {"tags": ["c++", "vb.net", "winforms", "vba", "visual-studio"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1462952324, "post_id": 37155662, "comment_id": 61848626, "body": "Why do you think you want do do that?"}, {"owner": {"reputation": 2944, "user_id": 1466583, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TIcrY.png?s=128&g=1", "display_name": "Maximilian Ast", "link": "https://stackoverflow.com/users/1466583/maximilian-ast"}, "edited": false, "score": 1, "creation_date": 1462952822, "post_id": 37155662, "comment_id": 61848920, "body": "Semmes like a <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY-Problem</a>"}, {"owner": {"reputation": 1, "user_id": 6318830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c23bc23a74a215667ed5bb80daf3e40?s=128&d=identicon&r=PG&f=1", "display_name": "Faldo", "link": "https://stackoverflow.com/users/6318830/faldo"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1462966024, "post_id": 37155662, "comment_id": 61857783, "body": "@VincentG : cause I don&#39;t find a certain codes for C++/CLI, but I find it for VB codes in internet"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6318830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c23bc23a74a215667ed5bb80daf3e40?s=128&d=identicon&r=PG&f=1", "display_name": "Faldo", "link": "https://stackoverflow.com/users/6318830/faldo"}, "edited": false, "score": 0, "creation_date": 1462965885, "post_id": 37156059, "comment_id": 61857690, "body": "Thanks for answering"}], "tags": [], "owner": {"reputation": 39513, "user_id": 584183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc31dff5555e427e5829e385376c46c4?s=128&d=identicon&r=PG", "display_name": "jmcilhinney", "link": "https://stackoverflow.com/users/584183/jmcilhinney"}, "is_accepted": false, "score": 1, "last_activity_date": 1462952303, "creation_date": 1462952303, "answer_id": 37156059, "question_id": 37155662, "link": "https://stackoverflow.com/questions/37155662/visual-studio-creating-vb-windows-form-in-c-project/37156059#37156059", "title": "visual studio creating vb windows form in c++ project?", "body": "<p>No.  In C++ projects you use C++ and in VB projects you use VB.</p>\n"}], "owner": {"reputation": 1, "user_id": 6318830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c23bc23a74a215667ed5bb80daf3e40?s=128&d=identicon&r=PG&f=1", "display_name": "Faldo", "link": "https://stackoverflow.com/users/6318830/faldo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1462952303, "creation_date": 1462951127, "question_id": 37155662, "link": "https://stackoverflow.com/questions/37155662/visual-studio-creating-vb-windows-form-in-c-project", "title": "visual studio creating vb windows form in c++ project?", "body": "<p>Is it possible to create visual basic(vb) windows form in c++ project in visual studio? and how? </p>\n\n<p>thanks before.</p>\n\n<p>btw, I'm using visual studio community 2015</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2648, "user_id": 6230407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IgdHF.jpg?s=128&g=1", "display_name": "Marco Vos", "link": "https://stackoverflow.com/users/6230407/marco-vos"}, "is_accepted": false, "score": 2, "last_activity_date": 1462952869, "last_edit_date": 1462952869, "creation_date": 1462951847, "answer_id": 37155887, "question_id": 37155496, "link": "https://stackoverflow.com/questions/37155496/copy-value-not-formula-excel-vba/37155887#37155887", "title": "Copy value not formula excel vba", "body": "<p>Replace:</p>\n\n<pre><code>Source.Rows(c.Row).Copy Target.Rows(1)\n</code></pre>\n\n<p>By:</p>\n\n<pre><code>Source.Rows(c.Row).Copy \nTarget.Rows(1).PasteSpecial xlPasteValues\n</code></pre>\n\n<p>This will paste the values and not the formulas</p>\n\n<p><strong>EDIT</strong>\nThis answer is a quick and dirty fix! Check out the answer form Jeeped for a more extensive improvement of OP's code.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1462952230, "last_edit_date": 1495542701, "creation_date": 1462951913, "answer_id": 37155915, "question_id": 37155496, "link": "https://stackoverflow.com/questions/37155496/copy-value-not-formula-excel-vba/37155915#37155915", "title": "Copy value not formula excel vba", "body": "<p>To start off, have a look at this line.</p>\n\n<pre><code>For Each c In Source.Range(\"a1:a\" &amp; Cells.SpecialCells(xlCellTypeLastCell).Row)\n</code></pre>\n\n<p>The <code>Cells.SpecialCells(...</code> does not explicitly refer to the Source worksheet. It is implicitly referring to the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822753.aspx\" rel=\"nofollow noreferrer\">ActiveSheet property</a>. By coincidence, this also happens to be the Source worksheet since opening that workbook made it the ActiveSheet. However, this should not be relied upon. Better to explicitly define all <a href=\"https://msdn.microsoft.com/en-us/library/office/aa224980.aspx\" rel=\"nofollow noreferrer\">Range.Parent</a> worksheet properties.</p>\n\n<pre><code>For Each c In Source.Range(\"a1:a\" &amp; SOURCE.Cells.SpecialCells(xlCellTypeLastCell).Row)\n</code></pre>\n\n<p>As far as copying values only, you could use a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839476.aspx\" rel=\"nofollow noreferrer\">Range.PasteSpecial method</a> with a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837425.aspx\" rel=\"nofollow noreferrer\">xlPasteType</a> of xlPasteValues. However, direct value transfer is a more efficient method of transferring values and it does not involve the clipboard or <a href=\"https://stackoverflow.com/questions/33833318\">.CutCopyMode</a>.</p>\n\n<p>Replace all of this,</p>\n\n<pre><code>For Each c In Source.Range(\"a1:a\" &amp; Cells.SpecialCells(xlCellTypeLastCell).Row)\n    If c = lNum Then\n       Source.Rows(c.Row).Copy Target.Rows(1)\n    End If\nNext c\n</code></pre>\n\n<p>... with this,</p>\n\n<pre><code>Dim rw as Variant\nWith Source\n    rw = Application.Match(lNum, .Columns(1), 0)\n    If Not IsError(rw) Then\n        With .Range(.Cells(rw, \"A\"), .Cells(rw, .Columns.Count).End(xlToLeft))\n            Target.Cells(1, 1).Resize(.Rows.Count, .Columns.Count) = .Value\n        End With\n    End If\nEnd With\n</code></pre>\n\n<p>That takes everything from column A to the last populated cell on the matching row the Source worksheet and transfers the values to the Target worksheet radiating out from column A1.</p>\n"}], "owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4450, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1462952869, "creation_date": 1462950633, "question_id": 37155496, "link": "https://stackoverflow.com/questions/37155496/copy-value-not-formula-excel-vba", "title": "Copy value not formula excel vba", "body": "<p>i have a piece of code that copies a row from one excel to another. The problem is that columns E to G an N to O have a reference to another excel and when it copies it copies the formula not the cell value resulting in repeating the formula to the target column in descending order. I have tried with hide/ unhide but it doesn't do much difference. The target column D it will result in D1= 1.xslm/sheet1/formula(n1) ; D2= 2.xslm/sheet1/formula(n2) ... - that are the reference from the source sheet column D. In the source the values are ok, in the target the formula is just wrong and it shouldn't have n1, n2 ... .  If the source row is 122 in target it should be D1= 1.xslm/sheet1/formula(n122) , D2= 2.xslm/sheet1/formula(n122)</p>\n\n<pre><code>Sub copy1()\n    Dim c As Range\n    Dim j As Integer\n    Dim Source As Worksheet\n    Dim Target As Worksheet\n    Dim Sour As String\n    Dim Tar As String\n    Dim path As String\n    Dim AutoSR As Workbook\n    Dim asrSheet As Worksheet\n    Set AutoSR = ActiveWorkbook\n    Set Target = AutoSR.ActiveSheet\n\n    path = \"c:\\first.xlsm\"\n    Tar = \"Sheet1\"\n    Set Source = Workbooks.Open(path).Sheets(Tar)\n    Source.Unprotect Password:=\"XXX\"\n    Application.DisplayAlerts = False\n    Columns(\"E:G\").EntireColumn.Hidden = False\n    Columns(\"N:O\").EntireColumn.Hidden = False\n    Source.Range(\"N:O\").EntireColumn.Hidden = True\n    For Each c In Source.Range(\"a1:a\" &amp; Cells.SpecialCells(xlCellTypeLastCell).Row)\n        If c = lNum Then\n           Source.Rows(c.Row).Copy Target.Rows(1)\n        End If\n    Next c\n    Source.Range(\"E:G\").EntireColumn.Hidden = True\n    Source.Range(\"N:O\").EntireColumn.Hidden = True\n    Source.Protect Password:=\"XXX\"\n    Source.Activate\n    ActiveWorkbook.Close SaveChanges:=True\n    Set Source = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 3, "last_activity_date": 1462950817, "creation_date": 1462950817, "answer_id": 37155556, "question_id": 37155472, "link": "https://stackoverflow.com/questions/37155472/how-to-use-like-to-check-if-a-match-exists/37155556#37155556", "title": "How to use Like to check if a match exists", "body": "<p><code>instr(1,\"aeiou\",str)&gt;0</code>   or you can use like x or like y or like z, for one char though, I'd use str=a or str=b rather than like</p>\n"}, {"comments": [{"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1462951350, "post_id": 37155590, "comment_id": 61848061, "body": "I knew it was going to be something really obvious... just couldn&#39;t see it. thank you!"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1462951390, "post_id": 37155590, "comment_id": 61848085, "body": "will award you the answer as it most closely matches my question."}], "tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": true, "score": 2, "last_activity_date": 1462950918, "creation_date": 1462950918, "answer_id": 37155590, "question_id": 37155472, "link": "https://stackoverflow.com/questions/37155472/how-to-use-like-to-check-if-a-match-exists/37155590#37155590", "title": "How to use Like to check if a match exists", "body": "<p>If you want to use <code>Like</code> then use</p>\n\n<pre><code>str Like \"[aeiou]\"\n</code></pre>\n\n<p><code>instr</code> might be more efficient though</p>\n"}], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 37155590, "answer_count": 2, "score": 0, "last_activity_date": 1594642154, "creation_date": 1462950556, "last_edit_date": 1594642154, "question_id": 37155472, "link": "https://stackoverflow.com/questions/37155472/how-to-use-like-to-check-if-a-match-exists", "title": "How to use Like to check if a match exists", "body": "<p>Am I missing something very simple or is this really not doable? I want to check whether str (which is simply one letter) is a vowel.</p>\n\n<pre><code>Dim testCheck As Boolean\ntestCheck = str Like [a,e,i,o,u]\nIf testCheck Then\n    str = UCase(str)\nEnd If\n</code></pre>\n\n<p>I was looking for a more elegant solution than looping through an array.</p>\n"}, {"tags": ["vba", "vbscript", "ms-word"], "comments": [{"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1462954259, "post_id": 37154798, "comment_id": 61849785, "body": "I don&#39;t think that&#39;s possible."}, {"owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "reply_to_user": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1462957994, "post_id": 37154798, "comment_id": 61852263, "body": "Ok. I also thought so but wanted to confirm."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 2, "creation_date": 1462985434, "post_id": 37154798, "comment_id": 61872553, "body": "I confirm that what you describe is <i>not</i> possible - and it would be a tremendous security loophole BTW. What Dave suggests is possible, but the setting he mentions is blocked by installation default since this also presents a major security risk. And he neglects to mention that  once the code has been imported you <i>must</i> automate the Word application using <code>Application.Run</code> to run the macro code."}, {"owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "edited": false, "score": 0, "creation_date": 1463027202, "post_id": 37154798, "comment_id": 61888780, "body": "Thanks. I don&#39;t under why running macro a text source in vbscript by first importing will be security concern. The person, can breach the security be vbscript itself, why he would go to vba for breach of security. I don&#39;t have much knowledge about vba but I think vbscript can pretty much do everything that can be breach of security that vba possibly can do."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 2, "creation_date": 1463042224, "post_id": 37154798, "comment_id": 61896337, "body": "I wasn&#39;t neglecting to mention it @CindyMeister, the OP&#39;s code example shows they are automating the Word instance, document open and then the macro run from vbscript; all that was missing was how to import the module.  The OP already had the wrdApp.Run (Application.Run) statement in place, so I saw no need to specify it.."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1463072490, "post_id": 37154798, "comment_id": 61918926, "body": "Security: If programmatic access is granted to the VBE then any outside (malicious) code can load / create macros and run them in the Office application. When this setting is not enabled, the code must already be in an Office document that the user has trusted and opened. That&#39;s why the suggested approach is a security risk: enabling code from outside Word to create <i>new</i> code in Word and run it."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1463072585, "post_id": 37154798, "comment_id": 61918967, "body": "@Dave Sorry, I was totally focussed on the external *.bas file and my brain simply stopped at that point. You are correct. And I&#39;d delete that comment except for the security issue; unfortunately, it can no longer be edited."}], "answers": [{"comments": [{"owner": {"reputation": 337, "user_id": 12929541, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9utdr.png?s=128&g=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/12929541/scott"}, "edited": false, "score": 0, "creation_date": 1595830734, "post_id": 37159444, "comment_id": 111598393, "body": "Dave, will this work in Excel 365?  Could I then simply <code>Call</code> any macro Subs that are in that .bas file?"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 337, "user_id": 12929541, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9utdr.png?s=128&g=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/12929541/scott"}, "edited": false, "score": 0, "creation_date": 1595979984, "post_id": 37159444, "comment_id": 111660409, "body": "@Scott I haven&#39;t tried it to be honest.  If it works (note that you&#39;d probably need to call the <code>VBProject</code> belonging to the associated <code>workbook</code> object rather than the <code>application</code> level object), then once the <code>.bas</code> is imported, yes, you should be able to use functions within that file by calling them from elsewhere.  I think.  Someone may come along and correct me though!"}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": true, "score": 2, "last_activity_date": 1462961419, "creation_date": 1462961419, "answer_id": 37159444, "question_id": 37154798, "link": "https://stackoverflow.com/questions/37154798/how-to-run-macro-stored-in-a-file/37159444#37159444", "title": "How to run macro stored in a file", "body": "<p>I believe the code you're looking for to import a module (a .bas file) can be achieved with:</p>\n\n<pre><code>wrdApp.VBE.ActiveVBProject.VBComponents.Import \"C:\\temp\\yourmodule.bas\"\n</code></pre>\n\n<p>You will need to ensure that programmatic access to the VB Project object model is enabled.</p>\n"}], "owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1191, "favorite_count": 0, "accepted_answer_id": 37159444, "answer_count": 1, "score": 0, "last_activity_date": 1462961419, "creation_date": 1462948661, "last_edit_date": 1462950257, "question_id": 37154798, "link": "https://stackoverflow.com/questions/37154798/how-to-run-macro-stored-in-a-file", "title": "How to run macro stored in a file", "body": "<p>Is it possible to run a macro sub or functions stored in say .bas file?</p>\n\n<p>I want to make a <code>vbscript</code> that can open a word document and run a macro function from <code>.bas</code> file. I know that this is possible using macro enabled document but what about <code>.bas</code> file or <code>.text</code> file?</p>\n\n<p>so that from vbscript</p>\n\n<pre><code>Set wrdApp = CreateObject(\"Word.Application\")\nSet wrdDoc = wrdApp.Documents.Open(sFile)\n'some code here to import the macro form a file\nwrdApp.run(\"macroname\")\n</code></pre>\n"}, {"tags": ["excel", "vba", "alm"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 3226892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fP3jE.png?s=128&g=1", "display_name": "Enrico Sencu", "link": "https://stackoverflow.com/users/3226892/enrico-sencu"}, "is_accepted": false, "score": 0, "last_activity_date": 1471356797, "creation_date": 1471356797, "answer_id": 38977263, "question_id": 37154690, "link": "https://stackoverflow.com/questions/37154690/ota-version-12-21-and-alm-version-11-52-compatibility-issue/38977263#38977263", "title": "OTA version 12.21 and ALM version 11.52 compatibility issue", "body": "<p>For simplicity, we can say that VBA uses OTA registed on system wide level. For this case only one client could be registered.\nFrankly speaking you shouldn't try to work with 2 different client in same process. But if you need this you need load Side-By-Side manifest provided by ALM.\nBy default ALM clients located in folder\n%LOCALAPPDATA%\\HP\\ALM-Client. In file Deployments.ini you can find where is exact ALM clients are deployed (in dependecy of ALM URL or version)\nYou can use file application.sxs.manifest to activate activation context that you need. Here is the sample code :</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Declare Function CreateActCtx Lib \"kernel32\" Alias \"CreateActCtxA\" (ByRef pActCtx As ACTCTX_) As Long\nPrivate Declare Sub ReleaseActCtx Lib \"kernel32\" (ByVal hActCtx As Long)\n\nPrivate Declare Function ActivateActCtx Lib \"kernel32\" (ByVal hActCtx As Long, ByRef lpCookie As Long) As Integer\nPrivate Declare Function DeactivateActCtx Lib \"kernel32\" (ByVal dwFlags As Long, ByVal ulCookie As Long) As Boolean\n\n\nPrivate Declare Function GetLastError Lib \"kernel32\" () As Long\nDeclare Sub SetLastError Lib \"kernel32.dll\" (ByVal dwErrCode As Long)\n\nPrivate Type ACTCTX_\n    cbSize As Long\n    dwFlags As Long\n    lpSource As String\n    wProcessorArchitecture As Integer\n    wLangId As Integer\n    lpAssemblyDirectory As String\n    lpResourceName As String\n    lpApplicationName As String\n    hModule As Long\nEnd Type\n\nPrivate actctx As ACTCTX_\nPrivate hActCtx As Long\nPrivate actCtxCookie As Long\n\nConst ACTCTX_FLAG_ASSEMBLY_DIRECTORY_VALID As Long = 4\nConst INVALID_HANDLE_VALUE As Long = -1\n\nConst CREATE_CONTEXT_ERROR As Long = 1\nConst ACTIVATE_CONTEXT_ERROR As Long = 2\n\nPublic Sub ActivateOtaContext(ByVal almClientDeploymendPath As String)\n  Dim actctx As ACTCTX_, ativated As Integer\n\n\n  If Right(almClientDeploymendPath, 1) = \"\\\" Then\n    almClientDeploymendPath = Left(almClientDeploymendPath, Len(almClientDeploymendPath) - 1)\n  End If\n  actctx.cbSize = Len(actctx)\n  actctx.dwFlags = ACTCTX_FLAG_ASSEMBLY_DIRECTORY_VALID\n  actctx.lpAssemblyDirectory = almClientDeploymendPath\n  actctx.lpSource = almClientDeploymendPath &amp; \"\\application.sxs.manifest\"\n\n  hActCtx = CreateActCtx(actctx)\n  If hActCtx = INVALID_HANDLE_VALUE Then\n    Err.Raise vbObjectError + CREATE_CONTEXT_ERROR, , \"Cannot create activation context. Error code: \" + GetLastError\n  End If\n  If ActivateActCtx(hActCtx, actCtxCookie) &lt;&gt; 1 Then\n    Err.Raise vbObjectError + ACTIVATE_CONTEXT_ERROR, , \"Cannot activate context. Error code: \" + GetLastError\n  End If\nEnd Sub\n\nPublic Sub DeactivateOtaContext()\n  If actCtxCookie &gt; 0 Then\n    Call DeactivateActCtx(0, actCtxCookie)\n    actCtxCookie = 0\n  End If\n  If hActCtx &gt; 0 Then\n    Call ReleaseActCtx(hActCtx)\n  End If\nEnd Sub\n\nSub Test()\n  Dim tdConnection As ITDConnection10\n  Dim AlmClientsBasePath As String\n  AlmClientsBasePath = Environ(\"LocalAppData\") + \"\\HP\\ALM-Client\"\n\n  ActivateOtaContext AlmClientsBasePath + \"\\alm1221\"\n\n  Set tdConnection = CreateObject(\"TDApiOle80.TDConnection\")\n  tdConnection.InitConnectionEx \"http://alm1221.company.net/qcbin/\"\n  tdConnection.LoginEx \"user1\", \"pwd1\"\n  tdConnection.Logout\n  tdConnection.ReleaseConnection\n  Set tdConnection = Nothing\n\n  DeactivateOtaContext\n\n  ActivateOtaContext AlmClientsBasePath + \"\\alm115\"\n\n\n  Set tdConnection = CreateObject(\"TDApiOle80.TDConnection\")\n  tdConnection.InitConnectionEx \"http://alm.company.net/qcbin/\"\n  tdConnection.LoginEx \"user2\", \"pwd2\"\n  tdConnection.Logout\n  tdConnection.ReleaseConnection\n  Set tdConnection = Nothing\n\n  DeactivateOtaContext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5608343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfb05a83aeb61a9f89af7f59ba468314?s=128&d=identicon&r=PG&f=1", "display_name": "Madz", "link": "https://stackoverflow.com/users/5608343/madz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 907, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471356797, "creation_date": 1462948290, "question_id": 37154690, "link": "https://stackoverflow.com/questions/37154690/ota-version-12-21-and-alm-version-11-52-compatibility-issue", "title": "OTA version 12.21 and ALM version 11.52 compatibility issue", "body": "<p>I am currently using both ALM 11.52 and ALM 12.21. There is an excel vba macro that I need to run on both the ALM versions 9as some projects are on 11.52 and some are on 12.21). But I get an error message that OTA version (12.21) is not compatible with ALM server version 11.52 when I try to connect to project which is on ALM 11.52. Is there a way I can solve the OTA compatibility issue?</p>\n"}, {"tags": ["c#", ".net", "vba", "web-services", "aspose-cells"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1462946198, "post_id": 37154090, "comment_id": 61845189, "body": "Why to force to run VBA scripts, if you can complete the job within .net code?"}, {"owner": {"reputation": 2827, "user_id": 784988, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0fd5186b6b43633b893b903f6b2eb530?s=128&d=identicon&r=PG", "display_name": "JohnB", "link": "https://stackoverflow.com/users/784988/johnb"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1462970635, "post_id": 37154090, "comment_id": 61861395, "body": "Maciej:  Good point, but not an option. We HAVE to use the spreadsheet provided for us. This is not a point for debate."}], "answers": [{"comments": [{"owner": {"reputation": 2827, "user_id": 784988, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0fd5186b6b43633b893b903f6b2eb530?s=128&d=identicon&r=PG", "display_name": "JohnB", "link": "https://stackoverflow.com/users/784988/johnb"}, "edited": false, "score": 0, "creation_date": 1463158421, "post_id": 37204071, "comment_id": 61962084, "body": "shakeel: My application is an MS Web Service. Based on the reading I&#39;ve seen so far, people advise against using Microsoft.Office.Interop (com objects) in Web Services. What are your recommendations?"}, {"owner": {"reputation": 1639, "user_id": 1715603, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQ6uN.png?s=128&g=1", "display_name": "shakeel", "link": "https://stackoverflow.com/users/1715603/shakeel"}, "reply_to_user": {"reputation": 2827, "user_id": 784988, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0fd5186b6b43633b893b903f6b2eb530?s=128&d=identicon&r=PG", "display_name": "JohnB", "link": "https://stackoverflow.com/users/784988/johnb"}, "edited": false, "score": 0, "creation_date": 1463239716, "post_id": 37204071, "comment_id": 61986723, "body": "You are right. This is not a server-side solution and it needs MS-Office installed and it runs on local machine, so it is not a good solution but I am afraid, it is the only solution. Please create and execute a little example and it will tell you about all the limitations of it. Once, you had some idea about it, then please post your questions on stack over flow website and get the help of the people. May be you could find out some solution feasible for your requirements. Best wishes."}], "tags": [], "owner": {"reputation": 1639, "user_id": 1715603, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQ6uN.png?s=128&g=1", "display_name": "shakeel", "link": "https://stackoverflow.com/users/1715603/shakeel"}, "is_accepted": false, "score": 0, "last_activity_date": 1463125199, "creation_date": 1463125199, "answer_id": 37204071, "question_id": 37154090, "link": "https://stackoverflow.com/questions/37154090/how-do-i-run-vba-scripts-embedded-in-a-spreadsheet-in-net/37204071#37204071", "title": "How do I run vba scripts embedded in a spreadsheet in .Net?", "body": "<p>Aspose.Cells cannot run macros. Besides, we are afraid, there is no server-side solution for your problem too. However on client-side (local machine) you can execute macros using Microsoft Office APIs. Please use the namespace</p>\n\n<p>i.e</p>\n\n<pre><code>using Excel = Microsoft.Office.Interop.Excel;\n</code></pre>\n\n<p>Here is an example how to make use of it.</p>\n\n<p><a href=\"https://social.msdn.microsoft.com/Forums/Lync/en-US/2e33b8e5-c9fd-42a1-8d67-3d61d2cedc1c/how-to-call-excel-macros-programmatically-in-c?forum=exceldev\" rel=\"nofollow\">https://social.msdn.microsoft.com/Forums/Lync/en-US/2e33b8e5-c9fd-42a1-8d67-3d61d2cedc1c/how-to-call-excel-macros-programmatically-in-c?forum=exceldev</a></p>\n\n<p><em>Note: I am working as Developer Evangelist at Aspose</em></p>\n"}], "owner": {"reputation": 2827, "user_id": 784988, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0fd5186b6b43633b893b903f6b2eb530?s=128&d=identicon&r=PG", "display_name": "JohnB", "link": "https://stackoverflow.com/users/784988/johnb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 711, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463125199, "creation_date": 1462946022, "question_id": 37154090, "link": "https://stackoverflow.com/questions/37154090/how-do-i-run-vba-scripts-embedded-in-a-spreadsheet-in-net", "title": "How do I run vba scripts embedded in a spreadsheet in .Net?", "body": "<p>We have a .Net/C# based web service.\nWithin the service, we use a spreadsheet as a calculationr engine.\nWe're using Apose.Cells for .Net to populate the spreadsheet cells.</p>\n\n<p>Calculations are performed through VB script embedded in the spreadsheet.\nTo be able to generate results, I need to be able to run/trigger the VB script.</p>\n\n<p>Aspose does not seem to support this functionality. \nIt can poke/retrieve data and force recalc of any formulae that exist in the spreadsheet, but not run macros/VB script.</p>\n\n<p>Once I've uploaded the desired data into the spreadsheet, how do I run the macros through .Net?</p>\n\n<p>Thanks,\nJohnB</p>\n"}, {"tags": ["excel", "vba", "validation"], "answers": [{"tags": [], "owner": {"reputation": 527, "user_id": 3261010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cf07a8119c781c92a3342097080dcb1?s=128&d=identicon&r=PG&f=1", "display_name": "shaojl7", "link": "https://stackoverflow.com/users/3261010/shaojl7"}, "is_accepted": false, "score": 0, "last_activity_date": 1462945984, "creation_date": 1462945984, "answer_id": 37154081, "question_id": 37153308, "link": "https://stackoverflow.com/questions/37153308/excel-macro-add-data-validation-list-box-to-sheet-blank-cells/37154081#37154081", "title": "Excel Macro add data validation list box to sheet - Blank cells", "body": "<p>You can add the ignore blank part in the code: \neg. </p>\n\n<pre><code>With Range(\"A21:A42\").Validation\n   .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n    xlBetween, Formula1:=\"=Data!$A$4:$A$100\", .IgnoreBlank = True\nEnd With\n</code></pre>\n\n<p>You can also get these code, by recording a macro</p>\n"}, {"tags": [], "owner": {"reputation": 371, "user_id": 3327358, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgwxR.jpg?s=128&g=1", "display_name": "Vasanta Koli", "link": "https://stackoverflow.com/users/3327358/vasanta-koli"}, "is_accepted": false, "score": 0, "last_activity_date": 1462948006, "last_edit_date": 1462948006, "creation_date": 1462946466, "answer_id": 37154198, "question_id": 37153308, "link": "https://stackoverflow.com/questions/37153308/excel-macro-add-data-validation-list-box-to-sheet-blank-cells/37154198#37154198", "title": "Excel Macro add data validation list box to sheet - Blank cells", "body": "<p>Hi You can create a Dynamic Named Range</p>\n\n<p>Goto Name Manager anc create new name example filteredList</p>\n\n<p>then use formula for the list</p>\n\n<pre><code>=Data!$A$4:INDEX(Data!$A$4:$A$100,SUMPRODUCT(--(Data!$A$4:$A$100&lt;&gt;\"\")))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Y5GBq.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y5GBq.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>and later update your macro or the range from <code>=Data!$A$4:$A$100</code> to <code>=filteredList</code></p>\n\n<p>If you wanted to add the List using vba use below code above your code </p>\n\n<pre><code>ActiveWorkbook.Names.Add Name:=\"filteredList\", RefersToR1C1:= _\n    \"=Data!R4C1:INDEX(Data!R4C1:R100C1,SUMPRODUCT(--(Data!R4C1:R100C1&lt;&gt;\"\"\"\")))\"\nActiveWorkbook.Names(\"filteredList\").Comment = \"\"\n</code></pre>\n\n<p>===</p>\n\n<pre><code>With Range(\"A21:A42\").Validation\n   .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n    xlBetween, Formula1:=\"=filteredList\"\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 3789276, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000407002617/picture?type=large", "display_name": "user3789276", "link": "https://stackoverflow.com/users/3789276/user3789276"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 715, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1462948006, "creation_date": 1462942076, "last_edit_date": 1462943828, "question_id": 37153308, "link": "https://stackoverflow.com/questions/37153308/excel-macro-add-data-validation-list-box-to-sheet-blank-cells", "title": "Excel Macro add data validation list box to sheet - Blank cells", "body": "<p>I am adding a data validation list box to an existing Excel spreadsheet. The data is coming from a separate sheet called Data. The range for the data is A4 - A100; so far data is only in cells A4 - A10.</p>\n\n<p>When activating the Data Validation List box it is reading all the blank cells. Is there a way to stop this?</p>\n\n<p>My code so far:</p>\n\n<pre><code>    ''Code below is what I am using to create the list box\n    With Range(\"A21:A42\").Validation\n\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n        xlBetween, Formula1:=\"=Data!$A$4:$A$100\"\n    End With\n</code></pre>\n\n<p>I know that when creating Data Validation directly in Excel it's a tick box to ignore blank cells.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1462933975, "post_id": 37152025, "comment_id": 61841816, "body": "try <code>Columns</code> without <code>s</code> or directly use <code>MsgBox Application.Match(Application.Min(Worksheets(&quot;Solver VBA&quot;).Range(&quot;C94:T94&quot;)), Worksheets(&quot;Solver VBA&quot;).Range(&quot;C94:T94&quot;), 0) + 2</code>"}, {"owner": {"reputation": 51, "user_id": 6125202, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a86e9045154f2b3596255fb45a457418?s=128&d=identicon&r=PG&f=1", "display_name": "Student1001", "link": "https://stackoverflow.com/users/6125202/student1001"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1462934440, "post_id": 37152025, "comment_id": 61841929, "body": "yes I have tried that, it still returns the same error :("}, {"owner": {"reputation": 51, "user_id": 6125202, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a86e9045154f2b3596255fb45a457418?s=128&d=identicon&r=PG&f=1", "display_name": "Student1001", "link": "https://stackoverflow.com/users/6125202/student1001"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1462935845, "post_id": 37152025, "comment_id": 61842222, "body": "hello again, I have tried your suggestion and it works! However, is there a way I will be able to store the number as an integer instead of it appearing on a msgbox? I am planning to use that number to locate a cell on another row and input a value &#39;1&#39;. Thanks again."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6125202, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a86e9045154f2b3596255fb45a457418?s=128&d=identicon&r=PG&f=1", "display_name": "Student1001", "link": "https://stackoverflow.com/users/6125202/student1001"}, "edited": false, "score": 0, "creation_date": 1462936711, "post_id": 37152270, "comment_id": 61842417, "body": "I have corrected the relevant parts, however, I am now getting the error: Compile error: Invalid qualifier on the first line <code>Private Sub CommandButton1_Click()</code> Also, I am unable to get the code to accept .column as .Column (it always changes back to small caps), will that be an issue?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 51, "user_id": 6125202, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a86e9045154f2b3596255fb45a457418?s=128&d=identicon&r=PG&f=1", "display_name": "Student1001", "link": "https://stackoverflow.com/users/6125202/student1001"}, "edited": false, "score": 0, "creation_date": 1462937143, "post_id": 37152270, "comment_id": 61842514, "body": "Have you changed the <b>Dim</b> and removed the <b>Set</b> ??"}, {"owner": {"reputation": 51, "user_id": 6125202, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a86e9045154f2b3596255fb45a457418?s=128&d=identicon&r=PG&f=1", "display_name": "Student1001", "link": "https://stackoverflow.com/users/6125202/student1001"}, "edited": false, "score": 0, "creation_date": 1462939102, "post_id": 37152270, "comment_id": 61842953, "body": "Yes, sorry for the misunderstanding, I got the error run-time error &#39;9&#39;, not compile error."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1462935978, "last_edit_date": 1462935978, "creation_date": 1462934888, "answer_id": 37152270, "question_id": 37152025, "link": "https://stackoverflow.com/questions/37152025/finding-a-particular-value-in-an-excel-file-and-its-relevant-column/37152270#37152270", "title": "Finding a particular value in an excel file and its relevant column", "body": "<p>Consider </p>\n\n<ol>\n<li>Dimming <code>f</code> as <strong>Long</strong></li>\n<li>Dropping the <code>Set</code></li>\n<li>Using <strong>.Column</strong></li>\n<li>Keeping the <code>MsgBox</code></li>\n</ol>\n\n<p>You see with <strong>.Columns</strong> you get a Range object. With <strong>.Column</strong> you get a Long.</p>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1462936014, "creation_date": 1462936014, "answer_id": 37152429, "question_id": 37152025, "link": "https://stackoverflow.com/questions/37152025/finding-a-particular-value-in-an-excel-file-and-its-relevant-column/37152429#37152429", "title": "Finding a particular value in an excel file and its relevant column", "body": "<p>Change</p>\n\n<pre><code>MsgBox f\n</code></pre>\n\n<p>to</p>\n\n<pre><code>MsgBox f.address\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": true, "score": 2, "last_activity_date": 1462936896, "creation_date": 1462936896, "answer_id": 37152571, "question_id": 37152025, "link": "https://stackoverflow.com/questions/37152025/finding-a-particular-value-in-an-excel-file-and-its-relevant-column/37152571#37152571", "title": "Finding a particular value in an excel file and its relevant column", "body": "<p>I suggest doing it like that (keeping all your variables):</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n  Dim myrange As Range\n  Set myrange = Worksheets(\"Solver VBA\").Range(\"C94:T94\")\n\n  Dim answer As Double\n  answer = Application.Min(myrange)\n\n  Dim column1 As Integer\n  column1 = Application.Match(answer, myrange, 0) + 2\n\n  Dim f As Range\n  Set f = Application.Index(myrange.EntireRow, 1, column1)\n\nEnd Sub\n</code></pre>\n\n<p>if you need just the range (the cell containing the value) you also can directly use something like that:</p>\n\n<pre><code>Set f = Worksheets(\"Solver VBA\").Range(\"B94\").Offset(, Application.Match(Application.Min(Worksheets(\"Solver VBA\").Range(\"C94:T94\")), Worksheets(\"Solver VBA\").Range(\"C94:T94\"), 0))\n</code></pre>\n\n<p>or like in my comment to just get the column number:</p>\n\n<pre><code>column1 = Application.Match(Application.Min(Worksheets(\"Solver VBA\").Range(\"C94:T94\")), Worksheets(\"Solver VBA\").Range(\"C94:T94\"), 0) + 2\n</code></pre>\n\n<p>Should be self explaining. But if you still have any questions, just ask ;)</p>\n"}], "owner": {"reputation": 51, "user_id": 6125202, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a86e9045154f2b3596255fb45a457418?s=128&d=identicon&r=PG&f=1", "display_name": "Student1001", "link": "https://stackoverflow.com/users/6125202/student1001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 37152571, "answer_count": 3, "score": 2, "last_activity_date": 1462938681, "creation_date": 1462933223, "last_edit_date": 1462938681, "question_id": 37152025, "link": "https://stackoverflow.com/questions/37152025/finding-a-particular-value-in-an-excel-file-and-its-relevant-column", "title": "Finding a particular value in an excel file and its relevant column", "body": "<p>I am extremely new in VBA and I would like to find the minimum value of a row and return its column number by creating a command button. \nFor example, in a row:\n3 2 2 4 5 6 7 \nI need to return the column number 2, even though 2 appears twice.  </p>\n\n<p>my code currently looks like this: </p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim myrange As range\nDim answer As Double\nDim f As Range\nDim column1 As Integer\n\nSet myrange = Worksheets(\"Solver VBA\").range(\"C94:T94\")\nanswer = Application.WorksheetFunction.Min(myrange)\nMsgBox answer\n\nSet f = Worksheets(\"Solver VBA\").Cells.Find(answer).Column\nMsgBox f\nEnd Sub\n</code></pre>\n\n<p>I keep getting the runtime error '91' and yellow highlight on the 3rd last line. </p>\n\n<p>Edit: I have tried these steps as suggested and it works (but it gives me column number 3 instead of 2, which is fine in my case as well):</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim myrange As range\nSet myrange = Worksheets(\"Solver VBA\").range(\"C94:T94\")\n\nDim answer As Double\nanswer = Application.WorksheetFunction.Min(myrange)\nMsgBox answer\nPrivate Sub CommandButton1_Click()\n\nDim column1 As Integer\ncolumn1 = Application.Match(answer, myrange, 0) + 2\nMsgBox column1\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1463973626, "post_id": 37151909, "comment_id": 62275112, "body": "How about concatenating another row, which has a key of 99999999 or some such value higher than all keys in your tables. And detect that in DetailPrint, and remove it, and replace it with your solid black line.   (sql=  Select .... from ...  UNION ALL  Select &quot;99999999&quot; ...)"}, {"owner": {"reputation": 187, "user_id": 4648491, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7acf7029d2dc7932d4aba073f74aeeae?s=128&d=identicon&r=PG&f=1", "display_name": "Bullfrog", "link": "https://stackoverflow.com/users/4648491/bullfrog"}, "reply_to_user": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1464166962, "post_id": 37151909, "comment_id": 62368272, "body": "@donPablo that only gives me the last row on the last column, that is the only one that I can get, I am after the last row on each column. So making an extra row in the data is not going to help really."}], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 4648491, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7acf7029d2dc7932d4aba073f74aeeae?s=128&d=identicon&r=PG&f=1", "display_name": "Bullfrog", "link": "https://stackoverflow.com/users/4648491/bullfrog"}, "edited": false, "score": 0, "creation_date": 1462940417, "post_id": 37152835, "comment_id": 61843244, "body": "I understand the implementation of what you are suggesting but that is not going to work in this case as this is one really long list that is flowing from column 1 to 2 to 3 then onto the next page where it starts again. I can&#39;t see these solutions working but thanks anyway"}, {"owner": {"reputation": 1926, "user_id": 992660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8c0282d3af4d0d388ba24e32e71ca66b?s=128&d=identicon&r=PG", "display_name": "John Bingham", "link": "https://stackoverflow.com/users/992660/john-bingham"}, "reply_to_user": {"reputation": 187, "user_id": 4648491, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7acf7029d2dc7932d4aba073f74aeeae?s=128&d=identicon&r=PG&f=1", "display_name": "Bullfrog", "link": "https://stackoverflow.com/users/4648491/bullfrog"}, "edited": false, "score": 0, "creation_date": 1463018021, "post_id": 37152835, "comment_id": 61886483, "body": "@Bullfrog What is the record source of the report, and what columns/fields of the record source show in the columns?"}, {"owner": {"reputation": 187, "user_id": 4648491, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7acf7029d2dc7932d4aba073f74aeeae?s=128&d=identicon&r=PG&f=1", "display_name": "Bullfrog", "link": "https://stackoverflow.com/users/4648491/bullfrog"}, "edited": false, "score": 0, "creation_date": 1463461684, "post_id": 37152835, "comment_id": 62061414, "body": "A query is the recordset,"}, {"owner": {"reputation": 187, "user_id": 4648491, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7acf7029d2dc7932d4aba073f74aeeae?s=128&d=identicon&r=PG&f=1", "display_name": "Bullfrog", "link": "https://stackoverflow.com/users/4648491/bullfrog"}, "edited": false, "score": 0, "creation_date": 1463462259, "post_id": 37152835, "comment_id": 62061634, "body": "Sorry for delay been away, A query is the record source, three columns, &quot;First Letter of last Name, Name String, Department. Each of these columns are displayed on the report. The report is grouped by the first letter column then the name column, in case someone is in two departments. There is a requirement that the report must fit on one double sided A4 piece of paper. That is the reason for the multiple columns. Names currently wrap in some rows due to really large names. This is the reason that I can&#39;t use the method of just x number of rows add a line."}, {"owner": {"reputation": 1926, "user_id": 992660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8c0282d3af4d0d388ba24e32e71ca66b?s=128&d=identicon&r=PG", "display_name": "John Bingham", "link": "https://stackoverflow.com/users/992660/john-bingham"}, "reply_to_user": {"reputation": 187, "user_id": 4648491, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7acf7029d2dc7932d4aba073f74aeeae?s=128&d=identicon&r=PG&f=1", "display_name": "Bullfrog", "link": "https://stackoverflow.com/users/4648491/bullfrog"}, "edited": false, "score": 0, "creation_date": 1463462853, "post_id": 37152835, "comment_id": 62061869, "body": "I&#39;m guessing you want the column outlines at the top and bottom of the page, and not where the last record prints in the last column? The whole thing sounds jolly difficult. You could try removing the detail section and putting this into a subreport with no header or footer, and putting the subreport into the existing report&#39;s detail section with a line hard above and another hard below - but that&#39;s only good for one page of data, and if you&#39;re showing lines between the columns it&#39;s unlikely to work in the last column after the last line of data. I think I can only say &quot;Good Luck&quot;!"}, {"owner": {"reputation": 187, "user_id": 4648491, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7acf7029d2dc7932d4aba073f74aeeae?s=128&d=identicon&r=PG&f=1", "display_name": "Bullfrog", "link": "https://stackoverflow.com/users/4648491/bullfrog"}, "edited": false, "score": 0, "creation_date": 1463472054, "post_id": 37152835, "comment_id": 62066747, "body": "Thanks, for the help. I am slowly trying different things. I will post back if I get it, but I suggest no one holds their breath as I may never get it."}], "tags": [], "owner": {"reputation": 1926, "user_id": 992660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8c0282d3af4d0d388ba24e32e71ca66b?s=128&d=identicon&r=PG", "display_name": "John Bingham", "link": "https://stackoverflow.com/users/992660/john-bingham"}, "is_accepted": false, "score": 1, "last_activity_date": 1462938913, "creation_date": 1462938913, "answer_id": 37152835, "question_id": 37151909, "link": "https://stackoverflow.com/questions/37151909/find-last-row-in-access-report-column/37152835#37152835", "title": "Find last Row in Access report Column", "body": "<p>I can think of two solutions.</p>\n\n<p>1) put the data in each column into a separate sub-report, and simply mark the sub-reports as having solid borders: problem solved, though it will make the report a bit messy to create and maintain.</p>\n\n<p>2) The report must have a record source. Don't set the record source in the properties window, set it in the report_open event.</p>\n\n<p>Before setting the record source, determine how many rows are represented by the record source, and put this information in a variable, and in the Detail_Format event, count the rows, using another variable; On the row where the row counter = the number of rows, put the line.</p>\n\n<p>For example;</p>\n\n<p>if the record source is </p>\n\n<pre><code>SELECT col1, col2, col3 FROM myTable WHERE col1 = 'Purple'\n</code></pre>\n\n<p>then the number of rows is </p>\n\n<pre><code>SELECT count(*) FROM myTable WHERE col1 = 'Purple'\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 4648491, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7acf7029d2dc7932d4aba073f74aeeae?s=128&d=identicon&r=PG&f=1", "display_name": "Bullfrog", "link": "https://stackoverflow.com/users/4648491/bullfrog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 661, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462940875, "creation_date": 1462932372, "last_edit_date": 1462940875, "question_id": 37151909, "link": "https://stackoverflow.com/questions/37151909/find-last-row-in-access-report-column", "title": "Find last Row in Access report Column", "body": "<p>I have a report that generates with three columns, these columns are not data columns but columns of records.</p>\n\n<p>I need to add a solid black line to the end of each column. This will complete a box around the outside of each column in the report.</p>\n\n<p>I know how to add the line in the event <code>Detail_Print</code> but can't figure out how to detect that the record is the last in any column.</p>\n\n<p>Additionally the heights of the rows vary due to <code>canGrow</code> turned on one of the fields, so I can't count the rows and then and keep track of the current count to figure it out.</p>\n\n<p>Thanks for the help.</p>\n\n<p><strong>EDIT - Additional Question</strong></p>\n\n<p>Is there a way to determine the available height for the detail section, like the number of twips between the 'bottom of the page header' and the 'top of the page footer' Because I think I can do it if I know that value or can derive it somehow.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2039, "user_id": 3848861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhEKB.png?s=128&g=1", "display_name": "dePatinkin", "link": "https://stackoverflow.com/users/3848861/depatinkin"}, "reply_to_user": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1462934523, "post_id": 37151903, "comment_id": 61841953, "body": "What do you get? Does your code ever reach this line?"}, {"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1462935673, "post_id": 37151903, "comment_id": 61842200, "body": "Hi sorry it works now but it still pastes columns which has no values &gt;0"}, {"owner": {"reputation": 2039, "user_id": 3848861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhEKB.png?s=128&g=1", "display_name": "dePatinkin", "link": "https://stackoverflow.com/users/3848861/depatinkin"}, "reply_to_user": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1462936795, "post_id": 37151903, "comment_id": 61842439, "body": "Do the <code>COUNTIFS</code> as a formula in the sheet, and see if you get correct values. <code>=COUNTIFS(C:C,&quot;&gt;0&quot;)</code>, <code>=COUNTIFS(D:D,&quot;&gt;0&quot;)</code>, etc."}], "tags": [], "owner": {"reputation": 2039, "user_id": 3848861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhEKB.png?s=128&g=1", "display_name": "dePatinkin", "link": "https://stackoverflow.com/users/3848861/depatinkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1462932318, "creation_date": 1462932318, "answer_id": 37151903, "question_id": 37151753, "link": "https://stackoverflow.com/questions/37151753/code-to-loop-through-columns-for-specific-value-range/37151903#37151903", "title": "Code to loop through columns for specific value range", "body": "<p>You keep pasting to column 3. Try:</p>\n\n<pre><code>.Columns(j).Copy Destination:=Worksheets(\"Sheet1\").Columns(j)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1462934760, "post_id": 37152215, "comment_id": 61842006, "body": "@Niva if you keep &quot;&gt;0&quot; it will give false even for a non empty cell but &quot;&lt;&gt;0&quot; will correctly work and give true value for a non empty cell."}, {"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1462934776, "post_id": 37152215, "comment_id": 61842017, "body": "Sorry but it still does not work:/ Worksheet still remains blank after runing the code"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1462934903, "post_id": 37152215, "comment_id": 61842046, "body": "@Niva It works for me. Should I upload sample file to drop box"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1462935109, "post_id": 37152215, "comment_id": 61842077, "body": "I have uploaded sample file &lt;<a href=\"https://www.dropbox.com/s/4kj3iehzp4f8mnr/copy_to_loop.xlsm?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/4kj3iehzp4f8mnr/copy_to_loop.xlsm?dl=0</a>&gt;"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1462935224, "post_id": 37152215, "comment_id": 61842104, "body": "@Niva if dropbox does not suit you then pl suggest alternatives."}, {"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1462935679, "post_id": 37152215, "comment_id": 61842201, "body": "Hi sorry it works now but it still pastes columns which has no values &gt;0"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1462936686, "post_id": 37152215, "comment_id": 61842414, "body": "@Niva It is doing so because lastcol is coming 8 and despite the condition is checking correctly .Columns(j).Copy Destination:=Worksheets(&quot;Sheet1&quot;).Columns(j) will print as per column no. only as such it is printing blank column. Someway is to be found out to decrement J if the column is empty which is rightly checked or some other way to resize the columns."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1462937322, "post_id": 37152215, "comment_id": 61842544, "body": "@Niva please ignore my previous comment.      ~CBool(Application.CountIfs(.Columns(j), &quot;&lt;&gt;0&quot;))~   It is giving True even for a non empty cell. This needs attention."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1462945568, "post_id": 37152215, "comment_id": 61844932, "body": "@Niva I am yet to find out basic reason of Countifs or CountA not giving desired results. For your immediate requirements you can use an additional program to delete blanks in Sheet1. I am editing my answer for the same."}, {"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1462949315, "post_id": 37152215, "comment_id": 61846742, "body": "hi sorry for the trouble but appreciate that you are helping out so much:) tried the code it does not seem to execute, columns start from C and row starts from row 5. Did the amendments to the range but still in vain"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1462949523, "post_id": 37152215, "comment_id": 61846864, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/111602/discussion-between-skkakkar-and-niva\">continue this discussion in chat</a>."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1462950022, "post_id": 37152215, "comment_id": 61847160, "body": "@Niva can you join me in chat? If not possible I shall upload my sample file which works properly to dropbox or any other site suggested by you."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1462950644, "post_id": 37152215, "comment_id": 61847593, "body": "@Niva both programs columndata3 and deleteblankcolumns are working fine with me. Please ensure after running first program select sheet1 by selecting any cell in active area and then run deletebalnkcolumns. uploaded file link &lt;<a href=\"https://www.dropbox.com/s/1q8q2qcwkuqkili/copy_to_loop_v2.xlsm?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/1q8q2qcwkuqkili/copy_to_loop_v2.xlsm?dl=0</a>&gt;"}], "tags": [], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "is_accepted": false, "score": 1, "last_activity_date": 1462946117, "last_edit_date": 1462946117, "creation_date": 1462934528, "answer_id": 37152215, "question_id": 37151753, "link": "https://stackoverflow.com/questions/37151753/code-to-loop-through-columns-for-specific-value-range/37152215#37152215", "title": "Code to loop through columns for specific value range", "body": "<pre><code>Sub TestPasteColumnData3()\n\nDim lastcol As Long\nDim j As Long\n\n    With Worksheets(\"WF - L12 (3)\")\n    lastcol = .Cells(4, Columns.Count).End(xlToLeft).Column\n       For j = 3 To lastcol\n      'change &gt;0 to &lt;&gt;0 and 3 to j        \n      If CBool(Application.CountIfs(.Columns(j), \"&lt;&gt;0\")) Then\n            .Columns(j).Copy Destination:=Worksheets(\"Sheet1\").Columns(j)\n        Else\n            MsgBox (\"No Value\")\n            Exit Sub\n        End If\n        Next\n    End With\n\n    MsgBox (\"Done\")\nEnd Sub\n</code></pre>\n\n<p>Pl make 2 changes suggested above your code will work.</p>\n\n<p>@Niva I am yet to find out basic reason of Countifs or CountA not giving desired results. For your immediate requirements you can use an additional program to delete blanks in Sheet1. Please make it Active Sheet and use the following program.</p>\n\n<pre><code>Sub DeleteBlankColumns()\n\n  With Worksheets(\"Sheet1\")\n    Dim lastColumn As Long\n    lastColumn = ActiveSheet.Cells(2, Columns.Count).End(xlToLeft).Column\n   'MsgBox lastColumn\n    Dim lastRow As Long\n    Dim rng As Range\n\n   Set rng = ActiveSheet.Cells\n\n     lastRow = rng.Find(What:=\"*\", After:=rng.Cells(1), Lookat:=xlPart, LookIn:=xlFormulas, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, MatchCase:=False).Row\n\n    'MsgBox lastRow\n   'Step1:  Declare your variables.\n    Dim MyRange As Range\n    Dim iCounter As Long\n   'Step 2:  Define the target Range.\n    Set MyRange = ActiveSheet.Range(Cells(1, 1), Cells(lastRow, lastColumn))\n\n   'Step 3:  Start reverse looping through the range.\n\n    For iCounter = MyRange.Columns.Count To 1 Step -1\n   'Debug.Print iCounter\n   'Step 4: If entire column is empty then delete it.\n       Debug.Print Application.CountA(Columns(iCounter).EntireColumn) = 0\n       If Application.CountA(Columns(iCounter).EntireColumn) = 0 Then\n       Columns(iCounter).Delete\n       End If\n  'Step 5: Increment the counter down\n    Next iCounter\n  End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1462948771, "post_id": 37152369, "comment_id": 61846429, "body": "Did the above but it still copies blank columns. I think it has something to do with the j variable because when i hardcode  it , the countif function works"}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1462935583, "creation_date": 1462935583, "answer_id": 37152369, "question_id": 37151753, "link": "https://stackoverflow.com/questions/37151753/code-to-loop-through-columns-for-specific-value-range/37152369#37152369", "title": "Code to loop through columns for specific value range", "body": "<p>Why use copy and paste? I try to avoid copy and paste because it relies on the OS's clipboard which can be used by other applications.</p>\n\n<pre><code>Worksheets(\"Sheet1\").Columns(j).value = Columns(j).value\n</code></pre>\n\n<p>also this:</p>\n\n<pre><code>Application.CountIfs\n</code></pre>\n\n<p>should be this:</p>\n\n<pre><code>Application.worksheetfunction.CountIf 'Note, don't need countifS for only 1 criteria\n</code></pre>\n\n<p>Also, not sure that you really need to convert it to a boolean.</p>\n"}], "owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1462946117, "creation_date": 1462931319, "question_id": 37151753, "link": "https://stackoverflow.com/questions/37151753/code-to-loop-through-columns-for-specific-value-range", "title": "Code to loop through columns for specific value range", "body": "<p>Hi there I want a code which allows to loop through the columns of Sheet A, and columns which have values>0 would be copied to Sheet B. Did a code with help of some answers from the previous forum question but still having issues as it does not seem to work at the paste destination! Some help would be very much appreciated. The code is as follows:</p>\n\n<pre><code>Sub TestPasteColumnData3()\n\nDim lastcol As Long\nDim j As Long\n\n    With Worksheets(\"WF - L12 (3)\")\n    lastcol = .Cells(4, Columns.Count).End(xlToLeft).Column\n       For j = 3 To lastcol\n        If CBool(Application.CountIfs(.Columns(j), \"&gt;0\")) Then\n            .Columns(j).Copy Destination:=Worksheets(\"Sheet1\").Columns(3)\n        Else\n            MsgBox (\"No Value\")\n            Exit Sub\n        End If\n        Next\n    End With\n\n    MsgBox (\"Done\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 78, "user_id": 6068821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7cc231a479dc3e628bed8b31d5014ac?s=128&d=identicon&r=PG&f=1", "display_name": "Mati Diaz", "link": "https://stackoverflow.com/users/6068821/mati-diaz"}, "is_accepted": true, "score": 2, "last_activity_date": 1462934164, "creation_date": 1462934164, "answer_id": 37152157, "question_id": 37151309, "link": "https://stackoverflow.com/questions/37151309/using-lookup-in-ms-access-forms/37152157#37152157", "title": "Using Lookup in MS Access Forms", "body": "<ol>\n<li><p>Go to the \"FORMAT\" tab of the Form Properties Dialog Window (the same one you used to set the <strong>Row Source</strong> and <strong>Row Source Type</strong> properties)</p></li>\n<li><p>You'll see two fields (<strong>Column Count</strong> and <strong>Column Widths</strong>)</p></li>\n<li><p>Set <strong>Column Count</strong> to 2.</p></li>\n<li><p>Set <strong>Column Widths</strong> to 0\";1\"</p></li>\n</ol>\n\n<p>This works in Access 2007. Any version later then 2007 should also work.</p>\n\n<p>By setting the column count to '2' you're displaying the StudentId and the Name. Then by setting StudentId column width to '0' you are hiding the column.</p>\n\n<p>When you switch to Form View you will see the <strong>Student Names</strong>, but the value stored underneath is really the <strong>StudentId</strong>. Neat trick.</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 4887, "user_id": 1492229, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JpJrO.jpg?s=128&g=1", "display_name": "asmgx", "link": "https://stackoverflow.com/users/1492229/asmgx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 37152157, "answer_count": 1, "score": -1, "last_activity_date": 1462934164, "creation_date": 1462927993, "question_id": 37151309, "link": "https://stackoverflow.com/questions/37151309/using-lookup-in-ms-access-forms", "title": "Using Lookup in MS Access Forms", "body": "<p>I have a MS Access Form that has Student ID,</p>\n\n<p>This is ok, I can see student ID as it should be</p>\n\n<p>What I want is to display Student Name instead of Student ID</p>\n\n<p>I used <strong><em>SELECT StID, StName From Students</em></strong> in \"Row Source\" \n\"Row Source Type\" = Table/Query\n\"Bound Column\" = 1</p>\n\n<p>I could not find any property where I can decide the Display Column</p>\n\n<p>Help is much appreciated.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1462921113, "post_id": 37150256, "comment_id": 61838464, "body": "<code>results(0 To 5, 0 To 6)</code> is 6 and 7?"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1462921657, "post_id": 37150256, "comment_id": 61838612, "body": "Look at <code>results</code> in a Watch.  It&#39;s Dim&#39;d <code>1 To 5, 1 To 6</code>"}, {"owner": {"reputation": 49, "user_id": 5912333, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-T4lCUns4p0E/AAAAAAAAAAI/AAAAAAAAADc/bC2W5hg47xc/photo.jpg?sz=128", "display_name": "Mofasa E", "link": "https://stackoverflow.com/users/5912333/mofasa-e"}, "edited": false, "score": 0, "creation_date": 1462921659, "post_id": 37150256, "comment_id": 61838613, "body": "How come? Excel help shows a sample of the array produced.. its 5 rows?"}, {"owner": {"reputation": 49, "user_id": 5912333, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-T4lCUns4p0E/AAAAAAAAAAI/AAAAAAAAADc/bC2W5hg47xc/photo.jpg?sz=128", "display_name": "Mofasa E", "link": "https://stackoverflow.com/users/5912333/mofasa-e"}, "edited": false, "score": 0, "creation_date": 1462921696, "post_id": 37150256, "comment_id": 61838627, "body": "Let me try, how do I use watch? sorry Im new to VBA"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1462921775, "post_id": 37150256, "comment_id": 61838657, "body": "Open the Watch window from the View menu.  Put a break just after <code>results = ...</code> and drag <code>results</code> onto the watch window"}, {"owner": {"reputation": 49, "user_id": 5912333, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-T4lCUns4p0E/AAAAAAAAAAI/AAAAAAAAADc/bC2W5hg47xc/photo.jpg?sz=128", "display_name": "Mofasa E", "link": "https://stackoverflow.com/users/5912333/mofasa-e"}, "edited": false, "score": 0, "creation_date": 1462921806, "post_id": 37150256, "comment_id": 61838665, "body": "Tried 1 to 5,1 to 6 and still gives an error out of subscript"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1462921874, "post_id": 37150256, "comment_id": 61838691, "body": "What do you mean <i>tried 1 to 5,1 to 6</i>?  The issue is you are referencing out of range with <code>results(2, 0)</code>"}, {"owner": {"reputation": 49, "user_id": 5912333, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-T4lCUns4p0E/AAAAAAAAAAI/AAAAAAAAADc/bC2W5hg47xc/photo.jpg?sz=128", "display_name": "Mofasa E", "link": "https://stackoverflow.com/users/5912333/mofasa-e"}, "edited": false, "score": 0, "creation_date": 1462922027, "post_id": 37150256, "comment_id": 61838760, "body": "Oh, thank you! watch helped tons.. Never knew such a tool exists! thanks alot :)"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1462922094, "creation_date": 1462922094, "answer_id": 37150427, "question_id": 37150256, "link": "https://stackoverflow.com/questions/37150256/access-the-array-resulting-from-linest-function/37150427#37150427", "title": "Access the array resulting from LinEst function", "body": "<p>When you redim results as <code>ReDim results(0 To 5, 0 To 6)</code> it does not 'lock' the <a href=\"https://msdn.microsoft.com/en-us/library/t9a7w1ac(v=vs.90).aspx\" rel=\"nofollow\">LBound</a> and <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278658.aspx\" rel=\"nofollow\">UBound</a> dimensions of that variant array.</p>\n\n<p>This line resets the <strong>results</strong> into results(1 to 5, 1 to 6).</p>\n\n<pre><code>results = Application.LinEst(yvalues, Application.Power(xvalues, Array(1, 2, 3, 4, 5)), True, True)\n</code></pre>\n\n<p>In fact, there is no point in the original redim statement at all. Use the new LBound(results, 1) and LBound(results, 2) to retrieve the desired value from the array.</p>\n\n<pre><code>Cells(counter, 23) = results(2, 1)\n</code></pre>\n\n<p>I'm not sure about the 2 in that. With a new LBound(results, 1) of 1, that might have to be 3.</p>\n"}], "owner": {"reputation": 49, "user_id": 5912333, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-T4lCUns4p0E/AAAAAAAAAAI/AAAAAAAAADc/bC2W5hg47xc/photo.jpg?sz=128", "display_name": "Mofasa E", "link": "https://stackoverflow.com/users/5912333/mofasa-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 37150427, "answer_count": 1, "score": 2, "last_activity_date": 1462922097, "creation_date": 1462920937, "last_edit_date": 1531161705, "question_id": 37150256, "link": "https://stackoverflow.com/questions/37150256/access-the-array-resulting-from-linest-function", "title": "Access the array resulting from LinEst function", "body": "<p>I am trying to output the values of the R2 from the linEst function for all the rows of data I have using the following code:</p>\n\n<pre><code>Sub getdeflection6()\nDim xvalues() As Double, yvalues() As Double, cell As Range\nDim alldata As Range\nDim results As Variant\nDim counter As Integer\n\nReDim xvalues(0 To 8, 0 To 0)\nReDim yvalues(0 To 8, 0 To 0)\nReDim results(0 To 5, 0 To 6)\n\nxvalues(0, 0) = 0\nxvalues(1, 0) = Range(\"S2\").Value\nxvalues(2, 0) = Range(\"P2\").Value\nxvalues(3, 0) = Range(\"M2\").Value\nxvalues(4, 0) = Range(\"J2\").Value\nxvalues(5, 0) = Range(\"G2\").Value\nxvalues(6, 0) = Range(\"C2\").Value\nxvalues(7, 0) = Range(\"B2\").Value\n\nSet alldata = Range(\"F7\", Range(\"F7\").End(xlDown))\n\ncounter = 7\nFor Each cell In alldata\n\n    yvalues(0, 0) = 0\n    yvalues(1, 0) = cell.Offset(0, 15).Value\n    yvalues(2, 0) = cell.Offset(0, 12).Value\n    yvalues(3, 0) = cell.Offset(0, 9).Value\n    yvalues(4, 0) = cell.Offset(0, 6).Value\n    yvalues(5, 0) = cell.Offset(0, 3).Value\n    yvalues(6, 0) = cell.Value\n    yvalues(7, 0) = 0\n\n    results = Application.LinEst(yvalues, Application.Power(xvalues, Array(1, 2, 3, 4, 5)), True, True)\n\n    Cells(counter, 23) = results(2, 0)\n    counter = counter + 1\n\nNext cell\nEnd Sub\n</code></pre>\n\n<p>I am getting an error at the last line when I try to access the results(2,0) array to obtain the R2 value stating the subscript is out of range. Am I doing it wrong? From my understanding the results array will be 5 rows by 6 columns?</p>\n"}, {"tags": ["vba", "email", "variables", "hyperlink", "href"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6200356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73589fb13fb02953883fe4b5ca416cb8?s=128&d=identicon&r=PG&f=1", "display_name": "SamHink123", "link": "https://stackoverflow.com/users/6200356/samhink123"}, "is_accepted": false, "score": 1, "last_activity_date": 1462915504, "creation_date": 1462915504, "answer_id": 37149226, "question_id": 37149189, "link": "https://stackoverflow.com/questions/37149189/can-you-hyperlink-a-variable-string-as-an-email-in-href-mailto-with-excel-vba/37149226#37149226", "title": "Can you hyperlink a variable string as an email in href mailto with excel vba?", "body": "<pre><code>\"&lt;a href = 'mailto:\" &amp; SpEmail &amp; \"'&gt;\" &amp; SpEmail &amp; \"&lt;/a&gt;\"\n</code></pre>\n\n<p>I figured it out myself... I had tried this before, but missed a double quote somewhere I'm pretty sure.</p>\n"}], "owner": {"reputation": 11, "user_id": 6200356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73589fb13fb02953883fe4b5ca416cb8?s=128&d=identicon&r=PG&f=1", "display_name": "SamHink123", "link": "https://stackoverflow.com/users/6200356/samhink123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3792, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1617407718, "creation_date": 1462915290, "question_id": 37149189, "link": "https://stackoverflow.com/questions/37149189/can-you-hyperlink-a-variable-string-as-an-email-in-href-mailto-with-excel-vba", "title": "Can you hyperlink a variable string as an email in href mailto with excel vba?", "body": "<p>I'm trying to add an email address into the body of my email and hyper link it, dynamically, since the variable I'm using is a string and could change for each email according to the spreadsheet I'm using.</p>\n\n<p>Here's the basics of my code:</p>\n\n<pre><code>Dim SpFirstName As String\nDim SpLastName As String\nDim StrBody2 As String\nDim SpEmail As String\n\n    SpFirstName = cell.Offset(0, 3)\n    SpLastName = cell.Offset(0, 4)\n\n    SpEmail = SpFirstName &amp; \".\" &amp; SpLastName &amp; \"@abc.com\"\n\n    StrBody2 = \"&lt;a href = 'mailto:SpEmail'&gt;\" &amp; SpEmail &amp; \"&lt;/a&gt;\"\n</code></pre>\n\n<p>Basically, I have two columns in the spreadsheet that give the person's first and last name and the critera (where the offset is based off) is a company name.</p>\n\n<p>SpEmail returns the value I want (John.Doe@abc.com or Jane.Doe@abc.com) and it displays the email address in the body of the email when it populates as a hyperlink, but when you click on the hyperlink, it opens a new message TO: spemail. Not the email address I've created through the string.</p>\n\n<p>Is it possible to get the hyperlink to actually link to the email address that might show up? Everything I've tried hasn't worked :(.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 3, "creation_date": 1462914896, "post_id": 37149041, "comment_id": 61836168, "body": "My best advice for learning to do this is to study through <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using <code>.Select</code>/<code>.Activate</code></a>. This should hopefully clear some things up and show you how to work directly with your data."}, {"owner": {"reputation": 31, "user_id": 6312745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c142134d08d274196a20ee9261118143?s=128&d=identicon&r=PG&f=1", "display_name": "user6312745", "link": "https://stackoverflow.com/users/6312745/user6312745"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1462915631, "post_id": 37149041, "comment_id": 61836548, "body": "Thank you @BruceWayne, I have heard about Select-Activate but my Excel refuses to do what I want using any other command. I will look into the information at the link. Would you know if any given Visual Basic is compatible with all Excel versions? When my macros refuse to run I do not know if I am using the wrong command or if the command I learned (somewhere online) is not compatible with my Excel version."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1462915715, "post_id": 37149041, "comment_id": 61836604, "body": "Your requirements make version irrelevant. It would help if you provide sample data."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1462915831, "post_id": 37149041, "comment_id": 61836651, "body": "Can you post some sample data? Also, is your macro not working? What error do you get, and when you click &quot;Debug&quot;, what line does it occur on? I&#39;m highly suspicious that Excel refuses to do this any other way."}, {"owner": {"reputation": 31, "user_id": 6312745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c142134d08d274196a20ee9261118143?s=128&d=identicon&r=PG&f=1", "display_name": "user6312745", "link": "https://stackoverflow.com/users/6312745/user6312745"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1462916703, "post_id": 37149041, "comment_id": 61836970, "body": "A screenshot of the typical report format has been added at the beginning of the post. @BruceWayne - My macro seems to work fine, I am learning VBA so I have run into the .Select/.Activate avoidance issue. Next time I get an error I will post it as a comment. Thanks!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1462918429, "post_id": 37149041, "comment_id": 61837588, "body": "Have a look at <a href=\"http://stackoverflow.com/questions/36672632#36672632\">Create a new sheet for each unique agent and move all data to each sheet</a>."}, {"owner": {"reputation": 31, "user_id": 6312745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c142134d08d274196a20ee9261118143?s=128&d=identicon&r=PG&f=1", "display_name": "user6312745", "link": "https://stackoverflow.com/users/6312745/user6312745"}, "edited": false, "score": 0, "creation_date": 1462919069, "post_id": 37149041, "comment_id": 61837804, "body": "Thank you everyone, I will go over the information you have shared and post any working solution. Further comments/suggestions are welcome. Stay tuned!"}], "answers": [{"tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": false, "score": 0, "last_activity_date": 1462928716, "creation_date": 1462928716, "answer_id": 37151410, "question_id": 37149041, "link": "https://stackoverflow.com/questions/37149041/vba-excel-macros-copy-cell-value-to-another-sheet-offset-repeat-until-findin/37151410#37151410", "title": "VBA, Excel macros: copy cell value to another sheet, offset, repeat until finding an empty cell", "body": "<p>To do it in a fast way, I suggest using as less interaction with the sheets as possible. This way the following code \"should\" run pretty fast and efficient:</p>\n\n<pre><code>Sub test()\n\n  Dim output() As Variant, holder As Variant, i As Long\n\n  'get the whole range (values) which is important\n  With Sheets(\"Source Sheet\")\n    holder = .Range(.Range(\"B2\").End(xlDown), .Range(\"H2\")).Value\n  End With\n\n  'resize the output-array as we need it\n  ReDim output(1 To Int(UBound(holder) / 35), 1 To 36)\n\n  'run for every \"line\" in the values\n  For i = 1 To UBound(output) * 35\n\n    'every \"first\" line get the \"header\"\n    If i Mod 35 = 1 Then output((i - 1) / 35 + 1, 1) = holder(i, 1)\n\n    'all lines get the value\n    output(Int((i - 1) / 35 + 1), (i - 1) Mod 35 + 2) = holder(i, 7)\n  Next\n\n  'output everything at the desired range\n  Sheets(\"Output Sheet\").Range(\"A3\").Resize(UBound(output), 36).Value = output\n\nEnd Sub\n</code></pre>\n\n<p>Should be self-explaining, but if you still have any questions, just ask.<br>\n(Tested with 315 lines of data => no errors / faults => took less than 1 second)</p>\n"}, {"tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 0, "last_activity_date": 1462929131, "creation_date": 1462929131, "answer_id": 37151473, "question_id": 37149041, "link": "https://stackoverflow.com/questions/37149041/vba-excel-macros-copy-cell-value-to-another-sheet-offset-repeat-until-findin/37151473#37151473", "title": "VBA, Excel macros: copy cell value to another sheet, offset, repeat until finding an empty cell", "body": "<p>As the comments are suggesting, there are better (and easier) ways to go about this task. The first step is to try and move away from a <em>recording keystrokes</em> style of programming which is what <code>.Activate/.Select</code> code tends to be. The second would be to think through how the data needs to be manipulated programmatically. In your case, it's seems to be: you need an <em>n</em> x 36 two-dimensional array where <em>n</em> is your raw data length / 35. The second dimension holds every 35th item in Column \"B\" and then every 35 items of column \"H\".</p>\n\n<p>Once you have this outline, then the coding becomes straight forward. The sample below is very much a skeleton one (eg there are better ways than <code>.UsedRange</code> to scope the data and I've hard-coded many of the values), but it should at least give you an idea of different coding philosophy:</p>\n\n<pre><code>Dim data As Variant\nDim output() As Variant\nDim n As Long\nDim i As Long\nDim r As Long\nDim c As Integer\n\n'Read the data\ndata = ThisWorkbook.Worksheets(\"raw\").UsedRange.Value2\n\n'Calculate the number of records and size the output array\nn = (UBound(data, 1) - 1) / 35\nReDim output(1 To n, 1 To 36)\n\n'Transfer the data\ni = 2 'first row of raw data\nFor r = 1 To n\n    output(r, 1) = data(i, 2)\n    For c = 2 To 36\n        output(r, c) = data(i, 8)\n        i = i + 1\n    Next\nNext\n\n'Write the output\nThisWorkbook.Worksheets(\"output\").Range(\"A3\").Resize(n, 36).Value = output\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6312745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c142134d08d274196a20ee9261118143?s=128&d=identicon&r=PG&f=1", "display_name": "user6312745", "link": "https://stackoverflow.com/users/6312745/user6312745"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3268, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1462929131, "creation_date": 1462914592, "last_edit_date": 1462916467, "question_id": 37149041, "link": "https://stackoverflow.com/questions/37149041/vba-excel-macros-copy-cell-value-to-another-sheet-offset-repeat-until-findin", "title": "VBA, Excel macros: copy cell value to another sheet, offset, repeat until finding an empty cell", "body": "<p><a href=\"http://i.stack.imgur.com/6QOBX.jpg\" rel=\"nofollow\">screenshot - cell values have been changed for simplicity</a>\nI am new to VBA and need to build a data processing pipeline for mass spectrometry data. The instrument generates an output data file always in the same format: 9 columns (A-I), column B has 35 rows for every sample (that is because the instrument quantifies 35 analytes in every sample and reports each analysis as an individual result, every analysis report corresponds to a row; all rows with the same sample name -35- correspond to the same sample). Column H is the most important one; this column contains the quantified values for each of the 35 analytes. Here, 35 rows (for 35 analytes) correspond to the same sample (have the same sample name in column B).</p>\n\n<p>There are a couple of things I need and I cannot figure out what would be the best strategy:</p>\n\n<p>Starting with cell B2 in the original instrument report (for all intents and purposes, this would be an Excel spreadsheet), in an Excel file with multiple sheets, to build the list of sample names I need to:</p>\n\n<ol>\n<li>copy the report cell value (B2) only (no formats, e.g.), and paste it in a second spreadsheet (at A3).</li>\n<li>Offset 35 cells down in the original report; offset one cell down in the destination sheet</li>\n<li>copy the report cell value (B36) only, and paste it in the spreadsheet from #1 above (at A4)</li>\n</ol>\n\n<p>I need to repeat this (B72 in report to A5 in destination, B107 in report to A6 in destination, etc.) until the report cell is empty. This stops the first task.</p>\n\n<p>The second task is to move to column H in the instrument report spreadsheet, pick the first 35 numerical values (always starting at H2) and transpose them to a row in a second spreadsheet (same as #1 above) that matches the sample names. That is,</p>\n\n<p>1.1. copy range H2:H37 in the report spreadsheet\n1.2. paste.special (transpose) to the row starting in cell B3 in a second spreadsheet (same as #1 above)\n1.3. offset to range H38:H73 in report; offset one cell down in destination sheet\n1.4. copy range H:38-H:73, paste.special (transpose) to row starting at B4 in a second spreadsheet (same as #1 above)</p>\n\n<p>And so forth until I enter all the data in the report file.</p>\n\n<p>This is what I got so far:</p>\n\n<pre><code>    Sub transpose()\n\nSheets(\"RAW\").Select\nRange(\"D2:D36\").Select\nSelection.Copy\nSheets(\"transpose\").Select\nRange(\"C2\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, transpose:=True\n\n\nSheets(\"RAW\").Activate\nRange(\"B2\").Select\n\n  Do Until IsEmpty(ActiveCell)\n\nWorksheets(\"transpose\").Range(\"B3\") = Worksheets(\"RAW\").Range(\"B2\").Value\n\n     ActiveCell.Offset(1, 0).Select\n  Loop\n\n    End Sub\n</code></pre>\n\n<p>my other macros</p>\n\n<pre><code>     Sheets(\"raw\").Select\nRange(\"D2:D36\").Select\nSelection.Copy\nSheets(\"transposed\").Select\nRange(\"B2\").Select\nSelection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n    False, transpose:=True\n\nSheets(\"raw\").Select\nRange(\"B2\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nSheets(\"transposed\").Select\nRange(\"A4\").Select\nActiveSheet.Paste\n\nSheets(\"raw\").Select\nRange(\"H2:H36\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nSheets(\"transposed\").Select\nRange(\"B4\").Select\nSelection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n    False, transpose:=True \n   ...\n</code></pre>\n\n<p>It seems like I want to combine both of these into one.\nI am having trouble with that, maybe my strategy is not the best.</p>\n\n<p>Any help/comments would be greatly appreciated!</p>\n"}, {"tags": ["excel", "vba", "count"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1462913988, "post_id": 37148808, "comment_id": 61835661, "body": "So, the TextBox has a string, correct? Could you perhaps count the spaces in there, and use that number +1 ?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1462914852, "post_id": 37148808, "comment_id": 61836141, "body": "Your post makes it rather unclear as to whether you actually want to count <i>words</i> or <i>characters</i> ..."}, {"owner": {"reputation": 99, "user_id": 6120605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74103da882385c18f38b2fec61311ff2?s=128&d=identicon&r=PG&f=1", "display_name": "spriteup", "link": "https://stackoverflow.com/users/6120605/spriteup"}, "edited": false, "score": 0, "creation_date": 1462915041, "post_id": 37148808, "comment_id": 61836248, "body": "My goal is count words from TextBox."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 6120605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74103da882385c18f38b2fec61311ff2?s=128&d=identicon&r=PG&f=1", "display_name": "spriteup", "link": "https://stackoverflow.com/users/6120605/spriteup"}, "edited": false, "score": 0, "creation_date": 1462916951, "post_id": 37149077, "comment_id": 61837070, "body": "Hi. Carl..But how to do it in the TextBox? How to embed it in the shape?"}, {"owner": {"reputation": 707, "user_id": 3956549, "user_type": "registered", "profile_image": "https://graph.facebook.com/1316610025/picture?type=large", "display_name": "Carl Kevinson", "link": "https://stackoverflow.com/users/3956549/carl-kevinson"}, "reply_to_user": {"reputation": 99, "user_id": 6120605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74103da882385c18f38b2fec61311ff2?s=128&d=identicon&r=PG&f=1", "display_name": "spriteup", "link": "https://stackoverflow.com/users/6120605/spriteup"}, "edited": false, "score": 0, "creation_date": 1462917717, "post_id": 37149077, "comment_id": 61837342, "body": "I haven&#39;t worked with the TextFrame object much, but you could do something like this: lTxtBoxWords = countWords(shp.TextFrame.Characters)"}, {"owner": {"reputation": 99, "user_id": 6120605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74103da882385c18f38b2fec61311ff2?s=128&d=identicon&r=PG&f=1", "display_name": "spriteup", "link": "https://stackoverflow.com/users/6120605/spriteup"}, "edited": false, "score": 0, "creation_date": 1462918286, "post_id": 37149077, "comment_id": 61837536, "body": "i supplemented this function, but it doesnt work for shapes: my line with this function for my macro was following - countWords(shp.TextFrame) and no luck."}, {"owner": {"reputation": 99, "user_id": 6120605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74103da882385c18f38b2fec61311ff2?s=128&d=identicon&r=PG&f=1", "display_name": "spriteup", "link": "https://stackoverflow.com/users/6120605/spriteup"}, "edited": false, "score": 0, "creation_date": 1462918604, "post_id": 37149077, "comment_id": 61837654, "body": "also  countWords(shp.TextFrame.Characters) doesnt work"}], "tags": [], "owner": {"reputation": 707, "user_id": 3956549, "user_type": "registered", "profile_image": "https://graph.facebook.com/1316610025/picture?type=large", "display_name": "Carl Kevinson", "link": "https://stackoverflow.com/users/3956549/carl-kevinson"}, "is_accepted": false, "score": 5, "last_activity_date": 1462914769, "creation_date": 1462914769, "answer_id": 37149077, "question_id": 37148808, "link": "https://stackoverflow.com/questions/37148808/count-words-from-textbox-in-excel-vba/37149077#37149077", "title": "Count Words from TextBox in Excel VBA", "body": "<pre><code>Function countWords(ByVal sentence As String) As Integer\n    countWords = UBound(Split(sentence, \" \")) + 1\nEnd Function\n</code></pre>\n\n<p>Explanation:</p>\n\n<p>The Split() function returns an array of strings split on a delimiter you specify.  For example, split(\"Carl is awesome\",\" \") would split on \" \" (a space) and return:\n[\"Carl\", \"is\", \"awesome\"].  The indices of this array are 0-2.</p>\n\n<p>Ubound() returns the index of the last element in an array.  Since arrays from split() start at 0, we need to add 1 to the result of ubound().</p>\n\n<p>The function CountWords() takes a string and returns the number of spaces+1, which is almost certainly the number of words.  You might consider checking the length of elements returned by split() to catch 0-length \"words\", i.e. double spaces or leading or trailing spaces.</p>\n"}, {"comments": [{"owner": {"reputation": 99, "user_id": 6120605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74103da882385c18f38b2fec61311ff2?s=128&d=identicon&r=PG&f=1", "display_name": "spriteup", "link": "https://stackoverflow.com/users/6120605/spriteup"}, "edited": false, "score": 0, "creation_date": 1462917246, "post_id": 37149218, "comment_id": 61837195, "body": "But how to do it in the TextBox? This is general calculation in the cells, but i have the textboxes not cells"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 99, "user_id": 6120605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74103da882385c18f38b2fec61311ff2?s=128&d=identicon&r=PG&f=1", "display_name": "spriteup", "link": "https://stackoverflow.com/users/6120605/spriteup"}, "edited": false, "score": 0, "creation_date": 1462920155, "post_id": 37149218, "comment_id": 61838154, "body": "@spriteup  See my <b>EDIT#1.</b>"}, {"owner": {"reputation": 99, "user_id": 6120605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74103da882385c18f38b2fec61311ff2?s=128&d=identicon&r=PG&f=1", "display_name": "spriteup", "link": "https://stackoverflow.com/users/6120605/spriteup"}, "edited": false, "score": 0, "creation_date": 1462922475, "post_id": 37149218, "comment_id": 61838894, "body": "Nice try. Thanks. But there is constant string for textbox name (&quot;SPLASH&quot;). And that is not i am looking for. David showed me better way and inspiring by his method I finally found better solution. See below."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 99, "user_id": 6120605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74103da882385c18f38b2fec61311ff2?s=128&d=identicon&r=PG&f=1", "display_name": "spriteup", "link": "https://stackoverflow.com/users/6120605/spriteup"}, "edited": false, "score": 0, "creation_date": 1590615726, "post_id": 37149218, "comment_id": 109750956, "body": "@spriteup You should reconsider. Gary&#39;s Student&#39;s answer is the best one here. Think a little harder."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1462920134, "last_edit_date": 1462920134, "creation_date": 1462915474, "answer_id": 37149218, "question_id": 37148808, "link": "https://stackoverflow.com/questions/37148808/count-words-from-textbox-in-excel-vba/37149218#37149218", "title": "Count Words from TextBox in Excel VBA", "body": "<p>If words are character strings separated by a space, then you can count words in any string like:</p>\n\n<pre><code>Sub WordCount()\n    Dim s As String\n\n    s = \"klaatu barada nikto\"\n    With Application.WorksheetFunction\n        MsgBox UBound(Split(.Trim(s), \" \")) + 1\n    End With\nEnd Sub\n</code></pre>\n\n<p>Here <em>Trim()</em> is used to remove any extraneous spaces</p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>Here is how I would apply this to a TextBox.  First create the TextBox:</p>\n\n<pre><code>Sub BoxMaker()\n    ActiveSheet.Shapes.AddTextbox(msoTextOrientationHorizontal, 217.5, 51#, _\n        482.25, 278.25).Select\n    Selection.Name = \"SPLASH\"\n    Selection.Characters.Text = \"Please Wait for Macro\"\n    With Selection.Characters(Start:=1, Length:=21).Font\n        .Name = \"Arial\"\n        .FontStyle = \"Regular\"\n        .Size = 36\n        .Strikethrough = False\n        .Superscript = False\n        .Subscript = False\n        .OutlineFont = False\n        .Shadow = False\n        .Underline = xlUnderlineStyleNone\n        .ColorIndex = xlAutomatic\n    End With\n    Selection.HorizontalAlignment = xlCenter\n    Selection.VerticalAlignment = xlCenter\nEnd Sub\n</code></pre>\n\n<p>and here is how I would count the words in that TextBox:</p>\n\n<pre><code>Sub WordCounter2()\n    Dim s As String\n    ActiveSheet.Shapes(\"SPLASH\").Select\n    s = Selection.Characters.Text\n    With Application.WorksheetFunction\n        MsgBox UBound(Split(.Trim(s), \" \")) + 1\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 99, "user_id": 6120605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74103da882385c18f38b2fec61311ff2?s=128&d=identicon&r=PG&f=1", "display_name": "spriteup", "link": "https://stackoverflow.com/users/6120605/spriteup"}, "edited": false, "score": 0, "creation_date": 1462925264, "post_id": 37149948, "comment_id": 61839681, "body": "Although your code doesnt sum up all textbox&#39;s words count and it pops out message boxes from each text box separately i adapt your code part to my first code below. Thank you to find the right approach."}, {"owner": {"reputation": 1192, "user_id": 1744727, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8d02d3ecefb127c4467e9328308ffb12?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/1744727/david"}, "reply_to_user": {"reputation": 99, "user_id": 6120605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74103da882385c18f38b2fec61311ff2?s=128&d=identicon&r=PG&f=1", "display_name": "spriteup", "link": "https://stackoverflow.com/users/6120605/spriteup"}, "edited": false, "score": 0, "creation_date": 1462996374, "post_id": 37149948, "comment_id": 61878827, "body": "Ah sorry, I didn&#39;t get that from your initial question. I thought the question and the code sample suggested you were just summing one box at a time. In fact, it seems everyone else read it like that, too. Don&#39;t worry I&#39;m just being cheeky, vying for extra points :-). Thanks for the feedback."}], "tags": [], "owner": {"reputation": 1192, "user_id": 1744727, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8d02d3ecefb127c4467e9328308ffb12?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/1744727/david"}, "is_accepted": false, "score": 1, "last_activity_date": 1462919092, "creation_date": 1462919092, "answer_id": 37149948, "question_id": 37148808, "link": "https://stackoverflow.com/questions/37148808/count-words-from-textbox-in-excel-vba/37149948#37149948", "title": "Count Words from TextBox in Excel VBA", "body": "<p>Here you go</p>\n\n<pre><code>Sub CountCharFromTextBoxV2()\n    For Each shp In ActiveSheet.Shapes\n        ActiveSheet.Shapes.Range(Array(shp.Name)).Select\n        theString = Selection.ShapeRange(1).TextFrame2.TextRange.Characters.Text\n        theNumWords = Len(Trim(theString)) - Len(Replace(Trim(theString), \" \", \"\")) + 1\n        MsgBox \"TextBox Name: \" &amp; shp.Name &amp; vbNewLine &amp; vbNewLine &amp; \"Number of words: \" &amp; theNumWords\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 99, "user_id": 6120605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74103da882385c18f38b2fec61311ff2?s=128&d=identicon&r=PG&f=1", "display_name": "spriteup", "link": "https://stackoverflow.com/users/6120605/spriteup"}, "is_accepted": true, "score": 1, "last_activity_date": 1462923101, "last_edit_date": 1462923101, "creation_date": 1462921789, "answer_id": 37150376, "question_id": 37148808, "link": "https://stackoverflow.com/questions/37148808/count-words-from-textbox-in-excel-vba/37150376#37150376", "title": "Count Words from TextBox in Excel VBA", "body": "<p>Thanks to David. He gave me the right inspiration. The code is finally found. Thanks for me and David. Now I can share with others too:</p>\n\n<pre><code>    Sub CountWordsFromTextBox()\n\n        Dim shp As Shape\n        Dim wks As Worksheet\n        Dim lTxtBoxWords As String\n        theNumWords = 0\n            For Each wks In ActiveWorkbook.Worksheets\n                For Each shp In wks.Shapes\n                    If TypeName(shp) &lt;&gt; \"GroupObject\" And shp.TextFrame2.TextRange.Characters.Text &lt;&gt; \"\" Then\n                        lTxtBoxWords = shp.TextFrame2.TextRange.Characters.Text\n                        theNumWords = theNumWords + Len(Trim(lTxtBoxWords)) - Len(Replace(Trim(lTxtBoxWords), \" \", \"\")) + 1\n                    End If\n                Next shp\n                Next wks\n                MsgBox theNumWords\n        End Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 99, "user_id": 6120605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74103da882385c18f38b2fec61311ff2?s=128&d=identicon&r=PG&f=1", "display_name": "spriteup", "link": "https://stackoverflow.com/users/6120605/spriteup"}, "edited": false, "score": 0, "creation_date": 1462986984, "post_id": 37154196, "comment_id": 61873460, "body": "Thanks Karthick it is another solution. But I have already created it. Below I added my last comment.   About your code : create another TextBox and launch again. What do you see? :) Modify this line and insert lTxtBoxWordsnew = 0 after last dim. lTxtBoxWordsnew = lTxtBoxWordsnew  + getwordscount(shp.TextFrame.Characters.text)"}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 0, "last_activity_date": 1462946460, "creation_date": 1462946460, "answer_id": 37154196, "question_id": 37148808, "link": "https://stackoverflow.com/questions/37148808/count-words-from-textbox-in-excel-vba/37154196#37154196", "title": "Count Words from TextBox in Excel VBA", "body": "<p>Try with below code </p>\n\n<p><strong>Tested</strong></p>\n\n<pre><code>Sub CountCharFromTextBox()\n    Dim shp As Shape\n    Dim wks As Worksheet\n    Dim lTxtBoxWords As Long\n    Dim lTxtBoxWordsnew As Long\n        For Each wks In ActiveWorkbook.Worksheets\n            For Each shp In wks.Shapes\n                If TypeName(shp) &lt;&gt; \"GroupObject\" Then\n                    lTxtBoxWords = shp.TextFrame.Characters.Count\n                    lTxtBoxWordsnew = getwordscount(shp.TextFrame.Characters.text)\n                End If\n            Next shp\n        Next wks\n        MsgBox lTxtBoxWordsnew\nEnd Sub\n\n\nPrivate Function getwordscount(text As String)\n    getwordscount = Len(text) - Len(Application.WorksheetFunction.Substitute(text, \" \", \"\")) + 1\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/FbNxJ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FbNxJ.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4474024"}, "is_accepted": false, "score": 0, "last_activity_date": 1571399447, "creation_date": 1571399447, "answer_id": 58450305, "question_id": 37148808, "link": "https://stackoverflow.com/questions/37148808/count-words-from-textbox-in-excel-vba/58450305#58450305", "title": "Count Words from TextBox in Excel VBA", "body": "<p>Great code! Is it possible to use this in PowerPoint?</p>\n\n<pre><code>Sub CountWordsFromTextBox()\n    Dim shp As Shape\n    Dim wks As Worksheet\n    Dim lTxtBoxWords As String\n    theNumWords = 0\n        For Each wks In ActiveWorkbook.Worksheets\n            For Each shp In wks.Shapes\n                If TypeName(shp) &lt;&gt; \"GroupObject\" And shp.TextFrame2.TextRange.Characters.Text &lt;&gt; \"\" Then\n                    lTxtBoxWords = shp.TextFrame2.TextRange.Characters.Text\n                    theNumWords = theNumWords + Len(Trim(lTxtBoxWords)) - Len(Replace(Trim(lTxtBoxWords), \" \", \"\")) + 1\n                End If\n            Next shp\n            Next wks\n            MsgBox theNumWords\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 6120605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74103da882385c18f38b2fec61311ff2?s=128&d=identicon&r=PG&f=1", "display_name": "spriteup", "link": "https://stackoverflow.com/users/6120605/spriteup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2788, "favorite_count": 0, "accepted_answer_id": 37150376, "answer_count": 6, "score": 0, "last_activity_date": 1581785075, "creation_date": 1462913719, "last_edit_date": 1581785075, "question_id": 37148808, "link": "https://stackoverflow.com/questions/37148808/count-words-from-textbox-in-excel-vba", "title": "Count Words from TextBox in Excel VBA", "body": "<p>I have code that counts characters in a TextBox.</p>\n\n<pre><code>Sub CountCharFromTextBox()\n    Dim shp As Shape\n    Dim wks As Worksheet\n    Dim lTxtBoxWords As Long\n    For Each wks In ActiveWorkbook.Worksheets\n        For Each shp In wks.Shapes\n            If TypeName(shp) &lt;&gt; \"GroupObject\" Then\n                lTxtBoxWords = shp.TextFrame.Characters.Count\n            End If\n        Next shp\n    Next wks\n    MsgBox lTxtBoxWords\nEnd Sub\n</code></pre>\n\n<p>How can I count words from Textboxes?</p>\n\n<p>I can't find any similar Property for TextFrame. TextFrame2 doesnt work.</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 2046, "user_id": 6216216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e055d8eee151322d496f655f12088a?s=128&d=identicon&r=PG&f=1", "display_name": "Leviathan", "link": "https://stackoverflow.com/users/6216216/leviathan"}, "edited": false, "score": 2, "creation_date": 1462914202, "post_id": 37148642, "comment_id": 61835785, "body": "You shouldn&#39;t use a function for this - just do a JOIN on <code>Race Card Contenders</code> in the query. That&#39;s what databases are for, that&#39;s how SQL works. And it will be much, much, MUCH faster! And easier. And, well, everything will be better. What is a JOIN? See here: <a href=\"https://stackoverflow.com/questions/17946221\">stackoverflow.com/questions/17946221</a>"}, {"owner": {"reputation": 6712, "user_id": 122139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24cd8afa32a0e16b095a5348f6b772b?s=128&d=identicon&r=PG", "display_name": "Smandoli", "link": "https://stackoverflow.com/users/122139/smandoli"}, "edited": false, "score": 0, "creation_date": 1462921813, "post_id": 37148642, "comment_id": 61838674, "body": "Agree.  If you can get an understanding of  SQL <i>OR</i> of functions, maybe you have a chance."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6317158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b82d3d333abb73bf4f3890a34e2dc08?s=128&d=identicon&r=PG&f=1", "display_name": "D. Gleason", "link": "https://stackoverflow.com/users/6317158/d-gleason"}, "edited": false, "score": 0, "creation_date": 1462971221, "post_id": 37151496, "comment_id": 61861923, "body": "The VBA solution works best since there are over 50 unique cases to be tested. Thank you for your valued response"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 1, "user_id": 6317158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b82d3d333abb73bf4f3890a34e2dc08?s=128&d=identicon&r=PG&f=1", "display_name": "D. Gleason", "link": "https://stackoverflow.com/users/6317158/d-gleason"}, "edited": false, "score": 0, "creation_date": 1462973191, "post_id": 37151496, "comment_id": 61863605, "body": "Great! Please accept answer to confirm resolution. Also, do note, <code>IIF()</code> can be nested to allow more conditions."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 1, "last_activity_date": 1462929339, "creation_date": 1462929339, "answer_id": 37151496, "question_id": 37148642, "link": "https://stackoverflow.com/questions/37148642/access-vba-unable-to-use-a-user-defined-function/37151496#37151496", "title": "Access VBA -- unable to use a user-defined function", "body": "<p>In the MS Access UI (.exe only not ODBC/OLEDB) you can call a user-defined inline function directly from an SQL query even passing parameters with no need for opening the same recordset:</p>\n\n<p><strong>VBA</strong> function <em>(to be placed in a module)</em></p>\n\n<pre><code>Public Function RaceOutlook(Fav1 As Integer, Fav2 As Integer, _\n                            Outlook As Integer, Pace As Integer)\n\n    Select Case True\n\n       Case (Fav1 = 1 And Fav2 = 3 And Outlook = 1 And Pace = 5)\n       RaceOutlook = 1\n\n       Case Else\n       RaceOutlook = 0\n\n    End Select\n\nEnd Function\n</code></pre>\n\n<p><strong>SQL</strong> query</p>\n\n<pre><code>SELECT r.*, \n       RaceOutlook(r.fav1, r.fav2, r.Outlook, r.Pace) As RaceOutlook\nFROM [Race Card Contenders] r\n</code></pre>\n\n<p>However, as commented, the VBA function does not offer more than Access's <code>IIF()</code> expression. Plus, below alternative query will work if connected to the database externally via ODBC/OLEDB:</p>\n\n<pre><code>SELECT r.*, \n       IIF(r.fav1=1 AND r.fav2=3 AND r.Outlook=1 AND r.Pace=5, 1, 0) As RaceOutlook\nFROM [Race Card Contenders] r\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6317158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b82d3d333abb73bf4f3890a34e2dc08?s=128&d=identicon&r=PG&f=1", "display_name": "D. Gleason", "link": "https://stackoverflow.com/users/6317158/d-gleason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1462929339, "creation_date": 1462913069, "last_edit_date": 1462921883, "question_id": 37148642, "link": "https://stackoverflow.com/questions/37148642/access-vba-unable-to-use-a-user-defined-function", "title": "Access VBA -- unable to use a user-defined function", "body": "<p>I wrote a function to use in an Access Query. The function work once but now it reverts back to the start of the routine when \"Set rs = db.OpenRecordset etc.\" is hit.</p>\n\n<pre><code>Public Function RaceOutlook()\n\nDim db As DAO.Database\nDim rs As DAO.Recordset\nDim Fav1 As Integer\nDim Fav2 As Integer\nDim Outlook As Integer\nDim Pace As Integer\nDim nFav1 As Field\nDim nFav2 As Field\nDim nOutlook As Field\nDim nPace As Field\nSet db = CurrentDb 'tells program to use the current db\nSet rs = db.OpenRecordset(\"Race Card Contenders\", dbOpenDynaset)\n\n\nFav1 = rs(\"nFav1\")\nFav2 = rs(\"nFav2\")\nOutlook = rs(\"nOutlook\")\nPace = rs(\"nPace\")\n\n\nSelect Case True\n    Case (Fav1 = 1 And Fav2 = 3 And Outlook = 1 And Pace = 5)\n    RaceOutlook = 1\n    Case Else\n    RaceOutlook = 0\nEnd Select\nrs.Close\nEnd Function\n</code></pre>\n"}, {"tags": ["arrays", "vba", "callbyname"], "comments": [{"owner": {"reputation": 11, "user_id": 6317202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77271ea62c4cd386148cd34ac071d952?s=128&d=identicon&r=PG&f=1", "display_name": "viktorajosagos", "link": "https://stackoverflow.com/users/6317202/viktorajosagos"}, "reply_to_user": {"reputation": 2046, "user_id": 6216216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e055d8eee151322d496f655f12088a?s=128&d=identicon&r=PG&f=1", "display_name": "Leviathan", "link": "https://stackoverflow.com/users/6216216/leviathan"}, "edited": false, "score": 0, "creation_date": 1462915292, "post_id": 37148590, "comment_id": 61836380, "body": "Dear MAts, thanks a lot, I wasnt clear: Id like to add an array to an array property which is yet empty and for this purpose Id like to use callbyname. so I only need vblet, i wont run any sub :) anyway, I searched it everywhere, there is no solution so far and maybe there is no solution at all. again we are at the limits of vba :("}, {"owner": {"reputation": 2046, "user_id": 6216216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e055d8eee151322d496f655f12088a?s=128&d=identicon&r=PG&f=1", "display_name": "Leviathan", "link": "https://stackoverflow.com/users/6216216/leviathan"}, "edited": false, "score": 0, "creation_date": 1462915801, "post_id": 37148590, "comment_id": 61836641, "body": "Sorry, I misunderstood the problem; deleted my previous comment. This is the new one: If what you want to do doesn&#39;t work with the built-in <code>CallByName</code> you need to write your own one that works around the limitations. There you can loop over the array and explicitly call your properties one by one for each entry."}, {"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1462925157, "post_id": 37148590, "comment_id": 61839645, "body": "You have to use typelib as mentioned here <a href=\"http://www.vbforums.com/showthread.php?405366-RESOLVED-Using-CallByName-with-variable-number-of-arguments\" rel=\"nofollow noreferrer\">vbforums.com/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1462941298, "last_edit_date": 1462941298, "creation_date": 1462925961, "answer_id": 37151030, "question_id": 37148590, "link": "https://stackoverflow.com/questions/37148590/callbyname-works-with-array-element-as-procname/37151030#37151030", "title": "callbyname works with array element as procname", "body": "<p>Your <code>GARG</code> property Let accepts an index and a string: you can't pass in a whole array instead </p>\n\n<pre><code>Public Sub whatsoever()\n\n    Dim g As Long\n    Dim obj As Object\n\n    Set obj = New teszt\n    obj.init\n\n    For g = 0 To 4\n        CallByName obj, \"GARG\", VbLet, g, \"g_\" &amp; CStr(g)\n    Next g\n\n    Debug.Print obj.GARG(0) '&gt;&gt; g_0\n    Debug.Print obj.GARG(1) '&gt;&gt; g_1\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6317202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77271ea62c4cd386148cd34ac071d952?s=128&d=identicon&r=PG&f=1", "display_name": "viktorajosagos", "link": "https://stackoverflow.com/users/6317202/viktorajosagos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462941298, "creation_date": 1462912914, "last_edit_date": 1462913074, "question_id": 37148590, "link": "https://stackoverflow.com/questions/37148590/callbyname-works-with-array-element-as-procname", "title": "callbyname works with array element as procname", "body": "<p>I have a terrible problem. I built up monstrous classes with many properties, among which there are array properties as well. </p>\n\n<p>if I would like to refer to these with CALLBYNAME, it wont work, let us see an example: </p>\n\n<pre><code>public sub whatsoever()\n\n    Dim alfaarray() As Variant\n\n    Dim g As Integer\n\n    Dim obj As Object\n\n    ReDim alfaarray(4)\n\n    Set obj = New teszt\n\n    For g = 0 To 4\n    alfaarray(g) = \"g\" &amp; CStr(g)\n    Next g\n\n    Call obj.init\n\n    CallByName obj, \"GARG\", VbLet, alfaarray\n\nend sub\n</code></pre>\n\n<p>class: <code>teszt</code></p>\n\n<pre><code>Dim pgarg() As String\n\nProperty Let GARG(index As Long, value As String)\npgarg(index) = value\nEnd Property\n\nProperty Get GARG(index As Long) As String\nGARG = pgarg(index)\nEnd Property\n\nPublic Sub init()\n    ReDim pgarg(4)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "fonts", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": true, "score": 2, "last_activity_date": 1462914072, "creation_date": 1462914072, "answer_id": 37148917, "question_id": 37148521, "link": "https://stackoverflow.com/questions/37148521/looking-for-different-fonts-per-line-in-a-textframe/37148917#37148917", "title": "Looking for different fonts per line in a textframe", "body": "<p>You're looping through the .Runs (which are subsets if the full TextRange with the same set of methods and properties) but outputting the style properties for the whole TextRange. Use .TextFrame.TextRange.Runs(x).Font.Name etc. instead.</p>\n"}], "owner": {"reputation": 131, "user_id": 5469176, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/031e28aeacbf16f3a78ece53dcc8f18b?s=128&d=identicon&r=PG&f=1", "display_name": "SFro", "link": "https://stackoverflow.com/users/5469176/sfro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 37148917, "answer_count": 1, "score": 0, "last_activity_date": 1462914072, "creation_date": 1462912617, "question_id": 37148521, "link": "https://stackoverflow.com/questions/37148521/looking-for-different-fonts-per-line-in-a-textframe", "title": "Looking for different fonts per line in a textframe", "body": "<p>I'm designing a macro to proof PowerPoint presentations that checks each text box/shape on a slide, and outputs the font type, size and colour. I have it working to the point that it will spit out the font size for each shape, the problem is that when there are multiple font sizes per line in a given shape. Currently, if for example the first line is Arial 12 and the next line is Arial 14, the output simply takes the first line, and say that there are two lines of Arial 12</p>\n\n<pre><code>Dim lFindColor As Long\nDim oSl As Slide\nDim oSh As Shape\n\nDim colorsUsed As String\nDim fontsUsed As String\n\nDim lRow As Long\nDim lCol As Long\n\nDim shpFont As String\nDim shpSize As String\nDim shpColour As String\n\n\nSet oSl = ActiveWindow.View.Slide\nDim x As Integer\n\n    For Each oSh In oSl.Shapes\n    '----Shape Check----------------------------------------------------------\n        With oSh\n            If .HasTextFrame Then\n                If .TextFrame.HasText Then\n                    For x = 1 To .TextFrame.TextRange.Runs.Count\n                        shpFont = shpFont &amp; .TextFrame.TextRange.Font.Name &amp; \", \"\n                        shpSize = shpSize &amp; .TextFrame.TextRange.Font.Size &amp; \", \"\n                        shpColour = shpColour &amp; .TextFrame.TextRange.Font.Color.RGB &amp; \", \"\n                    Next\n                End If\n            End If\n        End With\n    Next\n</code></pre>\n\n<p>What can I do to search each line and give me the font sizes/type for each individual line within a shape?</p>\n"}, {"tags": ["vba", "excel", "dynamic", "hyperlink"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4337939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87c44e146110555ddb29435d30e3000b?s=128&d=identicon&r=PG&f=1", "display_name": "Hunter Velez", "link": "https://stackoverflow.com/users/4337939/hunter-velez"}, "edited": false, "score": 0, "creation_date": 1463051793, "post_id": 37150443, "comment_id": 61903327, "body": "I did not think of this as being a solution to the original question. However, it gets me what I need and it will work! Thank you kind internet friend."}], "tags": [], "owner": {"reputation": 1042, "user_id": 6099813, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6ad1a82990f2fe3f70fa19274a71af79?s=128&d=identicon&r=PG&f=1", "display_name": "Danhol86", "link": "https://stackoverflow.com/users/6099813/danhol86"}, "is_accepted": true, "score": 0, "last_activity_date": 1462922157, "creation_date": 1462922157, "answer_id": 37150443, "question_id": 37148274, "link": "https://stackoverflow.com/questions/37148274/excel-vba-extract-open-a-dynamic-hyperlink-url-address/37150443#37150443", "title": "Excel VBA - Extract/Open a dynamic hyperlink URL/Address", "body": "<p>Any reason you cant run the vlookup in VBA. Then you will have the link address as a string which you can then do what you want with:</p>\n\n<pre><code>Sub GetLink()\n    Dim ReturnedAddress As String\n    ReturnedAddress = Application.WorksheetFunction.VLookup(ThisWorkbook.Sheets(\"S.O.P.\").Range(\"D3\"), ThisWorkbook.Sheets(\"Models\").Range(\"C2:G296\"), 4, 0)\nend sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4337939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87c44e146110555ddb29435d30e3000b?s=128&d=identicon&r=PG&f=1", "display_name": "Hunter Velez", "link": "https://stackoverflow.com/users/4337939/hunter-velez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1230, "favorite_count": 0, "accepted_answer_id": 37150443, "answer_count": 1, "score": 0, "last_activity_date": 1462922157, "creation_date": 1462911815, "last_edit_date": 1495542701, "question_id": 37148274, "link": "https://stackoverflow.com/questions/37148274/excel-vba-extract-open-a-dynamic-hyperlink-url-address", "title": "Excel VBA - Extract/Open a dynamic hyperlink URL/Address", "body": "<p>Greeting!</p>\n\n<p>I am attempting to use excel vba to extract a <em>dynamic</em> hyperlink from OR use excel vba to open the <em>dynamic</em> hyperlink in a worksheet. I am able to click the hyperlink and it will open up correctly. So far, I am not able to find any relevant information pertaining to how to extract the URL the hyperlink is pointing to or simply open the hyperlink.</p>\n\n<p>Here is the formula that is used to build the dynamic hyperlink based on a model selection. </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>=IFERROR(HYPERLINK(VLOOKUP(S.O.P.!$D$3,Models!$C$2:$G$296,4,FALSE), \"Click Here to Open Box Label\"), \"Unable to retrieve part information\")\n</code></pre>\n\n<p>So based on a selection the user makes this formula goes and finds the respective link that will be used to create the hyperlink.</p>\n\n<p>What I want: Using a button - open the file(PDF) to allow the users to easily print the files they need from one button. I am trying to minimize human touches to eliminate the possibility for human errors.</p>\n\n<p>I have also attempted to record a macro to open up the link, but it only takes me to the worksheet that the hyperlink is placed in.</p>\n\n<p>Here are links to other post that were not able to resolve my issue, but provided good information...\n<a href=\"https://stackoverflow.com/questions/23984577/excel-vba-get-hyperlink-address-of-specific-cell\">Excel VBA Get hyperlink address of specific cell</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/32230657/extract-url-from-excel-hyperlink-formula\">Extract URL From Excel Hyperlink Formula</a></p>\n\n<p>Thank you, I look forward to some helpful responses c:</p>\n\n<p>let me know if I need to elaborate or clarify anything!</p>\n"}, {"tags": ["vba", "excel", "adodb"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1462911408, "post_id": 37148098, "comment_id": 61834208, "body": "<code>lr = .ListRow(Target.row - 5).Index</code> indicates that it should be inside a With Block.  Should it be <code>lr = lo.ListRow(Target.row - 5).Index</code>?"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1462938787, "post_id": 37148098, "comment_id": 61842883, "body": "I expect @ScottCraner is correct, but notice he framed it as a question. You did not specify what line(s) throw an error."}, {"owner": {"reputation": 53, "user_id": 5873627, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154520587602306/picture?type=large", "display_name": "Boris Demerichsky", "link": "https://stackoverflow.com/users/5873627/boris-demerichsky"}, "edited": false, "score": 0, "creation_date": 1462970237, "post_id": 37148098, "comment_id": 61861065, "body": "Sorry, I&#39;m just now responding. So, he did indeed point to the line that causes the error, but the running the code with his correction returns a different error: 438 - Object doesn&#39;t support this property or method."}, {"owner": {"reputation": 53, "user_id": 5873627, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154520587602306/picture?type=large", "display_name": "Boris Demerichsky", "link": "https://stackoverflow.com/users/5873627/boris-demerichsky"}, "edited": false, "score": 0, "creation_date": 1462971680, "post_id": 37148098, "comment_id": 61862350, "body": "Solved it! So, I need to use the Set function for lr in this case. So the line need to look like:  <code>Set lr = lo.ListRows(Target.row - 5)</code>  I am a fool."}], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 5873627, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154520587602306/picture?type=large", "display_name": "Boris Demerichsky", "link": "https://stackoverflow.com/users/5873627/boris-demerichsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1462971749, "creation_date": 1462971749, "answer_id": 37163538, "question_id": 37148098, "link": "https://stackoverflow.com/questions/37148098/having-trouble-getting-targets-listrow-on-worsheet-change-in-vba/37163538#37163538", "title": "Having trouble getting Target&#39;s ListRow on Worsheet_Change in VBA", "body": "<p>Solved it! So, I need to use the Set function for lr in this case. So the line need to look like: <code>Set lr = lo.ListRows(Target.row - 5)</code> I am a fool.</p>\n"}], "owner": {"reputation": 53, "user_id": 5873627, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154520587602306/picture?type=large", "display_name": "Boris Demerichsky", "link": "https://stackoverflow.com/users/5873627/boris-demerichsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 245, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1462971749, "creation_date": 1462911225, "question_id": 37148098, "link": "https://stackoverflow.com/questions/37148098/having-trouble-getting-targets-listrow-on-worsheet-change-in-vba", "title": "Having trouble getting Target&#39;s ListRow on Worsheet_Change in VBA", "body": "<p>So, I'm trying to get the <code>ListRow</code> from <code>Target</code>, but I seem to get errors non-stop. The goal is to upload changes done in the document to a server. Originally I looped through <code>ListRows</code> to upload the changes when the document was closed, but now the <code>ListObjects</code> have become so large that it takes too long to upload the arrays to the server. The faster way appears to simply upload changes as they happen. </p>\n\n<p>I wrote a code below, and i get the error: invalid or unqualified reference.\nThere are a couple of functions I've omitted since they are working and are irrelevant to the issue.</p>\n\n<pre><code>     Private Sub Worksheet_Change(ByVal Target As Range)\n        Application.Calculation = xlCalculationManual\n\n        Dim CustomersConn As ADODB.Connection\n        Dim CustomersCmd As ADODB.Command\n        Dim lo As Excel.ListObject\n        Dim ws As Excel.Worksheet\n        Dim lr As Excel.ListRow\n        Dim Customers As Variant\n\n\n        Set ws = ThisWorkbook.Worksheets(8)\n        Set lo = ws.ListObjects(\"TCustomers\")\n        Set CustomersConn = New ADODB.Connection\n        Set CustomersCmd = New ADODB.Command\n\n        lr = .ListRow(Target.row - 5).Index\n\n\n        CustomersConn.ConnectionString = SQLConStr\n\n        CustomersConn.Open\n\n        CustomersCmd.ActiveConnection = CustomersConn\n\n\n        CustomersCmd.CommandText = _\n        GetUpdateText( _\n        Intersect(lr.Range, lo.ListColumns(\"Type\").Range).Value, _\n        Intersect(lr.Range, lo.ListColumns(\"Customer\").Range).Value, _\n        Intersect(lr.Range, lo.ListColumns(\"Name\").Range).Value, _\n        Intersect(lr.Range, lo.ListColumns(\"Contact\").Range).Value, _\n        Intersect(lr.Range, lo.ListColumns(\"Email\").Range).Value, _\n        Intersect(lr.Range, lo.ListColumns(\"Phone\").Range).Value, _\n        Intersect(lr.Range, lo.ListColumns(\"Corp\").Range).Value)\n\n        Debug.Print (CustomersCmd.CommandText)\nCustomersConn.Close\n\nSet CustomersConn = Nothing\nSet lo = Nothing\nSet ws = Nothing\nSet lr = Nothing\n\nApplication.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "vb6", "specifications", "vbe"], "comments": [{"owner": {"reputation": 1006, "user_id": 1195578, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/07l5Q.jpg?s=128&g=1", "display_name": "Simon Bosley", "link": "https://stackoverflow.com/users/1195578/simon-bosley"}, "edited": false, "score": 2, "creation_date": 1462911336, "post_id": 37147979, "comment_id": 61834171, "body": "I was about to correct it to Schr&#246;dinger before that pesky cat disappeared, <b>again</b>"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 1, "creation_date": 1462911399, "post_id": 37147979, "comment_id": 61834202, "body": "does simplifying the nested conversions to True, leave the code in the same 2 states?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1462911524, "post_id": 37147979, "comment_id": 61834269, "body": "@ThunderFrame it... doesn&#39;t (when it says <code>Debug.Assert True</code> then you can edit it again, it stays compilable). seems the nested conversions <i>do</i> matter then."}, {"owner": {"reputation": 1314, "user_id": 5886152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00e0f45d92950c218c6256bedede7b90?s=128&d=identicon&r=PG", "display_name": "PhillipXT", "link": "https://stackoverflow.com/users/5886152/phillipxt"}, "edited": false, "score": 1, "creation_date": 1462912339, "post_id": 37147979, "comment_id": 61834699, "body": "Interesting in that if you type it out manually, it doesn&#39;t compile either.  Is it possible to have hidden control codes in the text?  That used to be possible long ago, but I don&#39;t think you can do that any more."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1314, "user_id": 5886152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00e0f45d92950c218c6256bedede7b90?s=128&d=identicon&r=PG", "display_name": "PhillipXT", "link": "https://stackoverflow.com/users/5886152/phillipxt"}, "edited": false, "score": 0, "creation_date": 1462912496, "post_id": 37147979, "comment_id": 61834792, "body": "@PhillipXT but the invisible control characters wouldn&#39;t be tokenized by a formal grammar definition; the lexer would just throw an exception at them and refuse to pipe them into the ANTLR token stream... unless I&#39;m missing something. Perhaps I should add an ANTLR tag..."}, {"owner": {"reputation": 1314, "user_id": 5886152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00e0f45d92950c218c6256bedede7b90?s=128&d=identicon&r=PG", "display_name": "PhillipXT", "link": "https://stackoverflow.com/users/5886152/phillipxt"}, "edited": false, "score": 0, "creation_date": 1462914014, "post_id": 37147979, "comment_id": 61835674, "body": "Yeah, no control characters there anyway - if you type it out into Notepad and paste it into VB it works fine."}, {"owner": {"reputation": 9316, "user_id": 35777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c7e94664f931ff90e17b2b47086f483?s=128&d=identicon&r=PG", "display_name": "Arvo", "link": "https://stackoverflow.com/users/35777/arvo"}, "edited": false, "score": 0, "creation_date": 1462955611, "post_id": 37147979, "comment_id": 61850634, "body": "Maybe problem is in missing <code>End If</code> - it is required for multiple line <code>If ... Then ...</code> construct, but not on single line."}, {"owner": {"reputation": 5434, "user_id": 127742, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/8c7ba31033e1ddc6271e7d33d93d8fec?s=128&d=identicon&r=PG", "display_name": "Mark Bertenshaw", "link": "https://stackoverflow.com/users/127742/mark-bertenshaw"}, "edited": false, "score": 1, "creation_date": 1462966342, "post_id": 37147979, "comment_id": 61858029, "body": "Can&#39;t repro this on VB6."}], "answers": [{"tags": [], "owner": {"reputation": 2298, "user_id": 6201755, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/001427804e7d9b7787a96ffbdc7c1fd8?s=128&d=identicon&r=PG&f=1", "display_name": "ib11", "link": "https://stackoverflow.com/users/6201755/ib11"}, "is_accepted": false, "score": 0, "last_activity_date": 1462953996, "creation_date": 1462953996, "answer_id": 37156572, "question_id": 37147979, "link": "https://stackoverflow.com/questions/37147979/why-does-this-code-compile-when-pasted-in-but-fail-otherwise/37156572#37156572", "title": "Why does this code compile when pasted in but fail otherwise?", "body": "<p>I would adventure to answer that the <code>Resume Next</code> is a key instruction here, since anything else invalid would skip to the next instruction.</p>\n\n<p>Colons separate the commands as if they were new lines.</p>\n\n<p>It is otherwise very inriguing indeed.</p>\n"}, {"tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": true, "score": 12, "last_activity_date": 1462971723, "creation_date": 1462971723, "answer_id": 37163528, "question_id": 37147979, "link": "https://stackoverflow.com/questions/37147979/why-does-this-code-compile-when-pasted-in-but-fail-otherwise/37163528#37163528", "title": "Why does this code compile when pasted in but fail otherwise?", "body": "<p>With such a long line of code, it's hard to spot where the compile error creeps in, but there is a subtle difference that appears to be the VBE applying an autocorrect to the line as, or more likely after, it is parsed.</p>\n\n<h2>This is the <i>original</i> line - As pasted from the clipboard</h2>\n\n<p>The line appears like this <strong>until</strong> you move the cursor to another line.\nNotice the colon, in bold, <strong>between the <code>Loop</code> and <code>Else</code> keywords</strong> statement:</p>\n\n<blockquote>\n  <p>On Local Error Resume Next: If Not Empty Is Nothing Then Do While Null: ReDim i(True To False) As Currency: <strong><code>Loop: Else</code></strong> Debug.Assert CCur(CLng(CInt(CBool(False Imp True Xor False Eqv True)))): Stop: On Local Error GoTo 0</p>\n</blockquote>\n\n<h2>This is the line <i>after</i> you move the cursor to another line:</h2>\n\n<p>Notice the colon has been auto-removed by VBE. It seems like the VBE parser recognizes the statement, and then \"optimizes\" the \"redundant\" colon away. </p>\n\n<blockquote>\n  <p>On Local Error Resume Next: If Not Empty Is Nothing Then Do While Null: ReDim i(True To False) As Currency: <strong><code>Loop Else</code></strong> Debug.Assert CCur(CLng(CInt(CBool(False Imp True Xor False Eqv True)))): Stop: On Local Error GoTo 0</p>\n</blockquote>\n\n<p>If you <em>add back</em> the colon to a line that is in the invalid syntax state, then the autocorrect kicks in again, but your line returns to being valid, but <em>fragile</em> code.</p>\n\n<p>So, it seems that VBE parses the line, identifies an optimization (the redundant colon), and then applies the fix, but VBE doesn't realize the optimized line has syntax problems.</p>\n\n<p>But why does the line end up being fragile? There are lots of distracting and irrelevant keywords in the line, so let's reduce it drastically:</p>\n\n<h2>Do While..Loop</h2>\n\n<blockquote>\n  <p>If we minimize the complexity of the line, to isolate the problem, we can simplify the line to:<br />\n  <code>If True Then Do While True: Beep: Loop: Else</code><br /><br />\n  Which, again, VBE autocorrects to a <em>fragile</em> line:<br />\n  <code>If True Then Do While True: Beep: Loop Else</code><br /><br />\n  But we can go even further and reduce the line to an illogically short line:<br />\n  <code>If True Then Do: Loop: Else</code><br /><br />\n  And VBE, once again, dutifully removes the colon to produce this line: (<strong>DO NOT EXECUTE THIS LINE OR YOU WILL HANG EXCEL)</strong><br />\n  <code>If True Then Do: Loop Else</code><br /></p>\n</blockquote>\n\n<h2>While..Wend</h2>\n\n<blockquote>\n  <p>Repeating the line, but swapping out the <code>Do While Loop</code>, for the older <code>While Wend</code> syntax:<br />\n  <code>If True Then While True: Beep: Wend: Else</code><br /><br />\n  Again, VBE optimizes away the colon, to give:<br />\n  <code>If True Then While True: Beep: Wend Else</code><br /><br >\n  But now the line is not <em>fragile</em> anymore!</p>\n</blockquote>\n\n<p>So, the While..Wend is the older construct, and the Do..Loop construct is newer (and more flexible), but it seems the VBE parser (and syntax optimizer) struggle with the Do..Loop construct.</p>\n\n<p>Key point: Don't use <code>Do..Loop</code> in Single-Line <code>If</code> statements that include an <code>Else</code> statement.</p>\n"}], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 2, "accepted_answer_id": 37163528, "answer_count": 2, "score": 11, "last_activity_date": 1462971723, "creation_date": 1462910814, "last_edit_date": 1462924428, "question_id": 37147979, "link": "https://stackoverflow.com/questions/37147979/why-does-this-code-compile-when-pasted-in-but-fail-otherwise", "title": "Why does this code compile when pasted in but fail otherwise?", "body": "<p>A friend made me look at <a href=\"http://www.vbforums.com/showthread.php?781595-VB6-Call-Functions-By-Pointer-(Universall-DLL-Calls)\">this page</a>, and noticed a strange piece of code in the signature of one of the forum users.</p>\n\n<p><strong>The code is a one-liner that goes as follows:</strong></p>\n\n<pre><code>On Local Error Resume Next: If Not Empty Is Nothing Then Do While Null: ReDim i(True To False) As Currency: Loop: Else Debug.Assert CCur(CLng(CInt(CBool(False Imp True Xor False Eqv True)))): Stop: On Local Error GoTo 0\n</code></pre>\n\n<p><strong>Scrolling removed:</strong></p>\n\n<blockquote>\n  <p>On Local Error Resume Next: If Not Empty Is Nothing Then Do While Null: ReDim i(True To False) As Currency: Loop: Else Debug.Assert CCur(CLng(CInt(CBool(False Imp True Xor False Eqv True)))): Stop: On Local Error GoTo 0</p>\n</blockquote>\n\n<p>Quite mind-blowingly, that code compiles (I didn't try to run it, but that's irrelevant) if you just paste it as-is (and then don't touch it again!) into a valid procedure-level scope.</p>\n\n<p><strong>Some observations:</strong></p>\n\n<ul>\n<li>If instruction separators / colons are replaced with new lines, it no longer compiles</li>\n<li><code>On Local Error</code> can be simplified to <code>On Error</code></li>\n<li>The nested conversions aren't of any particular interest at first sight, but it turns out replacing that series of conversions and comparisons with a simple <code>Debug.Assert True</code> makes the code consistently compile, so <em>something</em> in there is messing up the compiler.</li>\n<li>If the code is pasted, it compiles; if it's modified in any way (even merely removing <code>Local</code>) after the VBE has validated the line, it stops compiling, and nothing seems to make VBA understand it anymore, unless the line is deleted and re-pasted.</li>\n<li>The latest <a href=\"/questions/tagged/rubberduck\" class=\"post-tag\" title=\"show questions tagged &#39;rubberduck&#39;\" rel=\"tag\">rubberduck</a> grammar/parser being closely modeled on the actual VBA specs, <a href=\"http://i.stack.imgur.com/hOWh2.png\">it parses and resolves just fine</a> (which honestly blows my mind)</li>\n<li>If the line is known to not compile, and then cut/re-pasted, it doesn't compile... but re-pasting it again from outside the VBE, it suddenly compiles.</li>\n</ul>\n\n<p><strong>The question is</strong>, how does this code manage to compile against the VB language specs? Is it a bug in the VB[6|A|E] implementation? In other words, <em>why/how does it work</em>?</p>\n\n<p>I <em>think</em> it has something to do with the instruction separator (<code>:</code>) and the inline-if syntax - given there's no <code>End If</code> statement, the thing <em>is</em> a single line and not a block.</p>\n\n<p>But then, what makes <em>that specific code</em> be Schr\u00f6dinger's code? What is it that makes it both legal and illegal at the same time?</p>\n\n<p>If the code gets correctly parsed by a parser generated using a formal grammar definition (ANTLR), then it must be a legal construct? Then why does it stop being legal when you merely go back to that line and hit ENTER?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1462911458, "post_id": 37147882, "comment_id": 61834230, "body": "It should remain as long as you don&#39;t do something to reset the project (same is true of all public variables)."}], "answers": [{"tags": [], "owner": {"reputation": 1324, "user_id": 6212666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6979ce8911c0f0e6c27f93bb6b39f09?s=128&d=identicon&r=PG", "display_name": "John D", "link": "https://stackoverflow.com/users/6212666/john-d"}, "is_accepted": false, "score": 3, "last_activity_date": 1462911620, "creation_date": 1462911620, "answer_id": 37148199, "question_id": 37147882, "link": "https://stackoverflow.com/questions/37147882/vba-global-variable-dropping-out-of-scope/37148199#37148199", "title": "VBA - Global Variable dropping out of scope", "body": "<p>Try declaring the public variable in a module rather than the workbook. Also check that you haven't declared it twice. Convention is to declare all globals in one module which is often called globals.bas.</p>\n"}, {"tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 1, "last_activity_date": 1462912823, "creation_date": 1462912823, "answer_id": 37148562, "question_id": 37147882, "link": "https://stackoverflow.com/questions/37147882/vba-global-variable-dropping-out-of-scope/37148562#37148562", "title": "VBA - Global Variable dropping out of scope", "body": "<p>In cases like these, I sometimes like to use a <code>Singleton</code> pattern of sorts (at least, this is my understanding of the singleton pattern). I create a publicly available function that either returns the object if it exists, or creates then returns the object. This way, you don't have to worry too much about it falling out of scope.</p>\n\n<p>Here's an example: </p>\n\n<pre><code>Public oDict As Object\n\nPublic Function GetDictionary() As Object\n    If oDict Is Nothing Then\n        Set oDict = CreateObject(\"Scripting.Dictionary\")\n        For Each cel In Range(\"A1:A10\")\n            oDict.Add cel.Value, cel.Offset(, 1).Value\n        Next cel\n    End If\n\n    Set GetDictionary = oDict\nEnd Function\n</code></pre>\n\n<p>To reference it, it's like:</p>\n\n<pre><code>Sub GetDictCount()\n    MsgBox GetDictionary().Count\nEnd Sub\n\nSub OtherDictTest()\n    MsgBox GetDictionary()(1)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3028, "user_id": 558619, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1618a853824f6ed866aa0fe4385b8687?s=128&d=identicon&r=PG", "display_name": "keynesiancross", "link": "https://stackoverflow.com/users/558619/keynesiancross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1033, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1462912823, "creation_date": 1462910445, "question_id": 37147882, "link": "https://stackoverflow.com/questions/37147882/vba-global-variable-dropping-out-of-scope", "title": "VBA - Global Variable dropping out of scope", "body": "<p>I'm having an issue with a global variable dropping out of scope.  I have defined a public variable in \"ThisWorkbook\":</p>\n\n<pre><code>Public dict As Scripting.Dictionary\n</code></pre>\n\n<p>This gets initalized in \"Workbook_Open()\" </p>\n\n<pre><code>Set dict = New Scripting.Dictionary\n</code></pre>\n\n<p>After initialization I run a Sub (code located in \"ThisWorkbook\" still) that fills this dictionary with IDs and instances of a custom class. </p>\n\n<p>I'm having trouble working with this dict variable in other modules though.  The goal is to build a number of public functions that the worksheet will be able to call. These functions manipulate/retrieve/etc data in the custom classes in the dictionary. </p>\n\n<p>For example, this test sub (code in ModuleXYZ) throws \"Object variable or With block variable not set\"</p>\n\n<pre><code>Private Sub TestSub()   \n    Dim x As Integer\n    x = ThisWorkbook.dict.Count\nEnd Sub\n</code></pre>\n\n<p>This is the same error I would get when I first started this coding project, when the dict fell out of scope in the \"ThisWorkbook\" module, and I'd have to redo the \"Set dict = New Scripting.Dictionary\"</p>\n\n<p>My hope was that by setting the dict as a Public variable in \"ThisWorkbook\", that it would stay in scope the entire time this workbook was open. </p>\n\n<p>Thanks - KC</p>\n"}]