[{"tags": ["excel", "vba", "visio"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1485994677, "post_id": 41991506, "comment_id": 71161477, "body": "Do you actually have &lt;&gt; around the Excel file path? - I&#39;ve not seen that before.  Probably also want to use the full workbook filename including the extension."}, {"owner": {"reputation": 43, "user_id": 6030679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5330e08f3f97d1023981f060a72ac00f?s=128&d=identicon&r=PG&f=1", "display_name": "Codingrookie", "link": "https://stackoverflow.com/users/6030679/codingrookie"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1485996303, "post_id": 41991506, "comment_id": 71161947, "body": "Removed  the &lt;&gt; in the path and added .xlsx and it&#39;s still giving me the same error. I ran this code from msdn and it didnt give me an error.  <a href=\"https://msdn.microsoft.com/en-us/library/office/ff765564.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff765564.aspx</a>  Tried modifying the officepath and adding my file path. Still gives me  the same error"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 1, "creation_date": 1486048865, "post_id": 41991506, "comment_id": 71187799, "body": "Are you running Visio Professional 2013?  The note on your link says &quot;Data-connectivity features are available only to licensed users of Microsoft Visio Professional 2013&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6568629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e8e4a26fcee4bf694f52834d00a339?s=128&d=identicon&r=PG&f=1", "display_name": "OldSchool1948", "link": "https://stackoverflow.com/users/6568629/oldschool1948"}, "is_accepted": false, "score": 1, "last_activity_date": 1537963164, "creation_date": 1537963164, "answer_id": 52517248, "question_id": 41991506, "link": "https://stackoverflow.com/questions/41991506/connecting-excel-to-visio/52517248#52517248", "title": "Connecting Excel to Visio", "body": "<pre><code>Dim xlWorkBookName As String\nxlWorkBookName = \"WorkbookName.xlsm\"\n\nDim xlApp As Excel.Application\nSet xlApp = CreateObject(\"excel.application\")\n\nDim pathExcel As String\npathExcel = Visio.ActiveDocument.Path &amp; xlWorkBookName\n\nDim XlWrkBook As Excel.Workbook\nSet XlWrkBook = xlApp.Workbooks.Open(FileName:=pathExcel)\nxlApp.Visible = True\n\nDim XlWrkSheet As Excel.Worksheet\nSet XlWrkSheet = XlWrkBook.Sheets.Item(\"WorksheetName\")\nXlWrkSheet.Activate\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6030679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5330e08f3f97d1023981f060a72ac00f?s=128&d=identicon&r=PG&f=1", "display_name": "Codingrookie", "link": "https://stackoverflow.com/users/6030679/codingrookie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1499, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593524235, "creation_date": 1485990426, "last_edit_date": 1593524235, "question_id": 41991506, "link": "https://stackoverflow.com/questions/41991506/connecting-excel-to-visio", "title": "Connecting Excel to Visio", "body": "<p>I'm trying to have Visio read data from Excel and create a drawing on Visio based on the information on the spreadsheet. Found this example that uses Access and C# to do what i'm trying to accomplish. Can anybody help me with this? I started by just creating the connection on excel to visio and i'm already stuck. Visio keeps giving me an error \"Unable to connect to data\". Here's what I have so far</p>\n\n<pre><code>Const excelFileName As String = \"&lt;C:\\Users\\Documents\\Book2&gt;\"\n\nPublic Sub DrawVisio()\n\nDim doc As Visio.Document\nSet doc = ActiveDocument\n\nDim cmd As String\nDim conString As String\nDim drs As Visio.DataRecordset\n\nconString = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n             \"User ID=Admin;\" &amp; _\n             \"Data Source=\" &amp; excelFileName &amp; \";\" &amp; _\n             \"Mode=Read;\" &amp; _\n             \"Extended Properties=\"\"HDR=YES;IMEX=1;\" &amp; _\n             \"MaxScanRows=0;Excel 12.0;\"\";\" &amp; _\n             \"Jet OLEDB:Engine Type=34;\"\n    cmd = \"select * from `Sheet1$`\"\n    Set drs = doc.DataRecordsets.Add(conString, cmd, 0, \"Sheet1\")\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1485990913, "post_id": 41990820, "comment_id": 71160277, "body": "In your loop, you set <code>dvCell = c.Value</code>, but then never use <code>dvCell</code>.  What&#39;s the loop supposed to do? It&#39;s <i>always</i> going to copy your named range &quot;prototemp&quot;, no matter the <code>c</code> value."}, {"owner": {"reputation": 33, "user_id": 6655443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645f6ad4472a449263e62c13429df946?s=128&d=identicon&r=PG&f=1", "display_name": "MattO", "link": "https://stackoverflow.com/users/6655443/matto"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1485991890, "post_id": 41990820, "comment_id": 71160599, "body": "Its supposed to loop through all the names in the drop down, and for each name, create a new workbook, with the range a1:j54 from invoice temp, with values and formatting. Naming the sheet with the corresponding value from the drop down."}], "owner": {"reputation": 33, "user_id": 6655443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645f6ad4472a449263e62c13429df946?s=128&d=identicon&r=PG&f=1", "display_name": "MattO", "link": "https://stackoverflow.com/users/6655443/matto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 689, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1485989208, "creation_date": 1485987253, "last_edit_date": 1485989208, "question_id": 41990820, "link": "https://stackoverflow.com/questions/41990820/vba-loop-through-drop-down-copy-range", "title": "VBA Loop Through drop down, copy range", "body": "<p>I have a sheet named \"Invoice Temp\", invoice temp has a drop down on L4. \nModifying this drop down updates cells in range A1: J54 of \"Invoice Temp\"</p>\n\n<p>What I'm trying to do, is get VBA to scroll through the drop down list in L4, and for each value, copy range A1:J54 into a new work book and rename the sheet after the L4 value, and save it under folder: c:/folder a/</p>\n\n<p>^ thats big picture. I've worked out how to get it to loop through and copy a single cell, but i seem to be having a problem copying the range. </p>\n\n<p>Column K has the data validation for L4. </p>\n\n<p>Thanks for the help!</p>\n\n<p>here is what I got: </p>\n\n<pre><code>Sub trial()\nDim dvCell As Range\nDim inputRange As Range\nDim c As Range\nDim i As Long\nSet dataSheet = Sheets(\"Invoice\")\n\n\n\n   Dim curSheetName As String\n   curSheetName = LefdataSheet.Cells(i, \"K\"), 24)\n\n    Call AddSheet(curSheetName)\n\n    Set trgSheet = Sheets(targetSheetName)\n\n\n 'Which cell has data validation\n  Set dvCell = Worksheets(\"Invoice\").Range(\"L4\")\n 'Determine where validation comes from\n  Set inputRange = Evaluate(dvCell.Validation.Formula1)\n   i = 1\n 'Begin our loop\nApplication.ScreenUpdating = False\nFor Each c In inputRange\n    dvCell = c.Value\n\n\n\ndataSheet.Range(\"prototemp\").Copy\ntrgSheet.Range(\"A1\").PasteSpecial Paste:=xlPasteValues\ntrgSheet.Range(\"A1\").PasteSpecial Paste:=xlPasteFormats\ntrgSheet.Range(\"A1\").PasteSpecial Paste:=xlPasteFormulas\ntrgSheet.Range(\"A1\").PasteSpecial Paste:=xlPasteColumnWidths\ni = i + 1\n\n\nNext c\nApplication.ScreenUpdating = True\n\n\nEnd Sub\n\nSub AddSheet(sheetName As String)\n\n'Remove sheet if one already exist\nApplication.DisplayAlerts = False\nOn Error Resume Next\nSheets(sheetName).Delete\nErr.Clear\nApplication.DisplayAlerts = True\n\n'Add sheet with designated name\nSheets.Add(after:=Sheets(Sheets.Count)).Name = sheetName\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 504, "user_id": 3448060, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bzLfT.jpg?s=128&g=1", "display_name": "Namkce", "link": "https://stackoverflow.com/users/3448060/namkce"}, "edited": false, "score": 0, "creation_date": 1485988432, "post_id": 41990496, "comment_id": 71159331, "body": "What about pasting as an image/picture?"}, {"owner": {"reputation": 101, "user_id": 7369282, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/10f2593a6483d8ee4c8235b9ba06ba0e?s=128&d=identicon&r=PG", "display_name": "Superhans", "link": "https://stackoverflow.com/users/7369282/superhans"}, "reply_to_user": {"reputation": 504, "user_id": 3448060, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bzLfT.jpg?s=128&g=1", "display_name": "Namkce", "link": "https://stackoverflow.com/users/3448060/namkce"}, "edited": false, "score": 0, "creation_date": 1485989096, "post_id": 41990496, "comment_id": 71159609, "body": "Yes, I&#39;d be happy to do that but firstly, it includes a line divide between two cells despite specifying no internal border and secondly, I&#39;d like to have a drop shadow on the text I am copying - If I can get that from an image paste, happy to do so!"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1486665963, "post_id": 41990496, "comment_id": 71455299, "body": "Don&#39;t you need to set PPSlide to slide 13 before pasting the data from XLws.Range(&quot;Q36:R36&quot;)?"}], "answers": [{"tags": [], "owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "is_accepted": false, "score": 0, "last_activity_date": 1491406381, "last_edit_date": 1495535445, "creation_date": 1491406381, "answer_id": 43235648, "question_id": 41990496, "link": "https://stackoverflow.com/questions/41990496/maintain-font-formatting-from-excel-into-powerpoint/43235648#43235648", "title": "Maintain Font Formatting from Excel into Powerpoint", "body": "<p>Colin, </p>\n\n<p>Are you changing the font size back after you copy it?  Maybe it's linked/updating automatically.  </p>\n\n<p>If you can copy it in manually using one of the paste options I'd suggest using the <code>ExecuteMso</code> command referenced in the following post to mimic more accurately what you are doing:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/19185788/how-to-copy-a-chart-from-excel-to-powerpoint/19187572#19187572\">How to copy a chart from Excel to PowerPoint?</a></p>\n"}], "owner": {"reputation": 101, "user_id": 7369282, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/10f2593a6483d8ee4c8235b9ba06ba0e?s=128&d=identicon&r=PG", "display_name": "Superhans", "link": "https://stackoverflow.com/users/7369282/superhans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 974, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1491406381, "creation_date": 1485986051, "last_edit_date": 1487545931, "question_id": 41990496, "link": "https://stackoverflow.com/questions/41990496/maintain-font-formatting-from-excel-into-powerpoint", "title": "Maintain Font Formatting from Excel into Powerpoint", "body": "<p>I have a VBA macro that pastes charts from Excel into PowerPoint and this works.</p>\n\n<p>I've adjusted the macro to copy the cell contents of certain cells of the same worksheet into PowerPoint. Despite setting the font size to be the same in Excel as it is in PowerPoint template before the macro copies it (40 point in both) the font gets pasted in at 18 point rather than 40 which I have set in Excel prior to the Macro running.</p>\n\n<p>The code that handles all of this is as follows:</p>\n\n<pre><code>'Opens a new PowerPoint presentation based on template and pastes data into Slide 2 of Powerpoint from Excel\n\nDim PPApp As PowerPoint.Application, PPPres As PowerPoint.Presentation, PPSlide As PowerPoint.Slide, PPShape As Object, PPChart As Object\n\nDim XLws As Worksheet\n\nSet XLws = ActiveSheet\nSet PPApp = New PowerPoint.Application\nSet PPPres = PPApp.Presentations.Open(\"C:\\Users\\Colin\\Dropbox (Edge45)\\Edge45 Team Folder\\Edge45 Company Documents\\Templates\\Powerpoint Templates\\Edge45 Monthly Report Template Macro.potm\", Untitled:=msoTrue)\nPPApp.Visible = True\nSet PPSlide = PPPres.Slides(12)\n\nXLws.ChartObjects(1).Copy ' or XLws.ChartObjects(\"Chart 2\").Copy\nSet PPChart = PPSlide.Shapes.PasteSpecial(DataType:=ppPasteDefault)\n\nWith PPChart\n\n.Left = 18\n.Height = 322\n.Top = 121\n.Width = 531\n\nEnd With\n\n'Copies Contents of Cells Q36 and R36 in excel worksheet and pastes as text into slide 13 of presentation\n  XLws.Range(\"Q36:R36\").Copy\n  Set PPChart = PPSlide.Shapes.PasteSpecial(DataType:=ppPasteDefault)\n\nSet PPSlide = PPPres.Slides(13)\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 715, "user_id": 4258124, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Cp2ML.jpg?s=128&g=1", "display_name": "NikT", "link": "https://stackoverflow.com/users/4258124/nikt"}, "edited": false, "score": 2, "creation_date": 1485986193, "post_id": 41990431, "comment_id": 71158251, "body": "It seems like you&#39;re always adding it after the last one. Why specify <code>After:=</code> at all then (since that is what will happen by default) ?"}, {"owner": {"reputation": 320, "user_id": 5001425, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f87ab6387cb9bb0c4756d213ca483c78?s=128&d=identicon&r=PG&f=1", "display_name": "kainC", "link": "https://stackoverflow.com/users/5001425/kainc"}, "reply_to_user": {"reputation": 715, "user_id": 4258124, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Cp2ML.jpg?s=128&g=1", "display_name": "NikT", "link": "https://stackoverflow.com/users/4258124/nikt"}, "edited": false, "score": 0, "creation_date": 1485986570, "post_id": 41990431, "comment_id": 71158448, "body": "I haven&#39;t found any evidence in the documentation that it always adds in order, but regardless my question was more broadly about optional arguments and passing an empty value so they would revert to default behavior."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 1, "creation_date": 1485988659, "post_id": 41990431, "comment_id": 71159435, "body": "Just for reference, the <code>Collection.Add</code> method always adds in order, even if you specify a key, unless you provide Before or After. For example, <code>Dim c As Collection</code>, <code>c.Add &quot;a&quot;</code>, <code>c.Add &quot;b&quot;, &quot;thiskey&quot;</code>. After that code, <code>c.Item(1)</code> = &quot;a&quot; and <code>c.Item(2)</code> = &quot;b&quot; and <code>c.Item(&quot;thiskey&quot;)</code> = &quot;b&quot;. The key can only be a string, so the item is stored by both the next index <i>and</i> the key."}], "answers": [{"tags": [], "owner": {"reputation": 715, "user_id": 4258124, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Cp2ML.jpg?s=128&g=1", "display_name": "NikT", "link": "https://stackoverflow.com/users/4258124/nikt"}, "is_accepted": false, "score": 2, "last_activity_date": 1485989212, "last_edit_date": 1485989212, "creation_date": 1485987635, "answer_id": 41990919, "question_id": 41990431, "link": "https://stackoverflow.com/questions/41990431/vba-specify-no-value-for-optional-argument/41990919#41990919", "title": "VBA specify no value for optional argument", "body": "<p>Aside from that in this particular case I believe it's redundant since they should be added to collection in order anyway without specifying the \"after\"; two things come to mind:</p>\n\n<p>1) You can use the iif function and take advantage of the \"missing\" property (not sure if there's a better way).  </p>\n\n<pre><code>Sub my_collection(Optional b As Variant)\n\n    Dim x As Collection\n    Set x = New Collection\n\n    'if you just run my_collection without passing anything\n    'b will be \"missing\"\n    x.Add \"Test\", After:=IIf(x.Count, x.Count, b)\n\nEnd Sub\n</code></pre>\n\n<p>since you never pass b to the my_collection, b will always be \"missing\" (you can test with <code>IsMissing()</code> )</p>\n\n<p>2) Function to add the values</p>\n\n<pre><code>Sub my_collection()\n\n    Dim x As Collection\n    Set x = New Collection\n    Dim v As String\n    v = \"test\"\n    Call add_to_collection(x, v)\n\nEnd Sub\nSub add_to_collection(ByRef y As Collection, q As Variant)\n    If y.Count Then\n        y.Add q, After:=y.Count\n    Else\n        y.Add q\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1485994521, "post_id": 41992161, "comment_id": 71161437, "body": "Interesting. What if the optional parameter isn&#39;t a variant parameter?"}, {"owner": {"reputation": 715, "user_id": 4258124, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Cp2ML.jpg?s=128&g=1", "display_name": "NikT", "link": "https://stackoverflow.com/users/4258124/nikt"}, "edited": false, "score": 0, "creation_date": 1485994590, "post_id": 41992161, "comment_id": 71161453, "body": "getMissingVar -&gt; getMissingVariant ... not enough characters for me to make that correction :)"}, {"owner": {"reputation": 715, "user_id": 4258124, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Cp2ML.jpg?s=128&g=1", "display_name": "NikT", "link": "https://stackoverflow.com/users/4258124/nikt"}, "edited": false, "score": 0, "creation_date": 1485994734, "post_id": 41992161, "comment_id": 71161490, "body": "Very interesting! Your solution <b>does</b> work for me in Excel 2010, as well as my answer, both of which use &quot;missing&quot; variable in After. Any idea why that is ?"}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 715, "user_id": 4258124, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Cp2ML.jpg?s=128&g=1", "display_name": "NikT", "link": "https://stackoverflow.com/users/4258124/nikt"}, "edited": false, "score": 0, "creation_date": 1485994897, "post_id": 41992161, "comment_id": 71161542, "body": "@Nik ooooh, so you can use the &quot;missing&quot; variant <i>in the IIF function</i>? If so, that&#39;s very interesting... Edit: well I&#39;ll be damned, you&#39;re right! I tried <code>Debug.Print IIf(False, 1, getMissingVariant())</code> and it printed out a &quot;Error 448&quot; without throwing any errors!"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1485995087, "post_id": 41992161, "comment_id": 71161604, "body": "Note - if you use this a lot in your code, you&#39;ll avoid a serious performance penalty by only calling <code>getMissingVariant()</code> <b><i>once</i></b> and storing the &quot;value&quot; somewhere."}, {"owner": {"reputation": 715, "user_id": 4258124, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Cp2ML.jpg?s=128&g=1", "display_name": "NikT", "link": "https://stackoverflow.com/users/4258124/nikt"}, "edited": false, "score": 0, "creation_date": 1485995188, "post_id": 41992161, "comment_id": 71161630, "body": "@Blackhawk Awesome ! Good to know"}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 715, "user_id": 4258124, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Cp2ML.jpg?s=128&g=1", "display_name": "NikT", "link": "https://stackoverflow.com/users/4258124/nikt"}, "edited": false, "score": 0, "creation_date": 1485995657, "post_id": 41992161, "comment_id": 71161741, "body": "@Nik I&#39;m dumb, I realized based on your answer that CopyMemory isn&#39;t even necessary...."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1485996233, "post_id": 41992161, "comment_id": 71161918, "body": "@John Coleman: if optional parameter is not a variant then IsMissing will always report False."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1485996302, "post_id": 41992161, "comment_id": 71161945, "body": "@JohnColeman You get a &quot;Type Mismatch&quot; for <code>Optional s As String</code> or <code>Long</code> etc. I believe that what VBA does when you provide the &quot;missing&quot; variant value as a parameter is it treats it as a valid parameter and makes the assignment. To the code inside the function it appears exactly the same as if VBA had detected there was no parameter and assigned the &quot;missing&quot; variant value itself. So in the case of Optional Strings or Longs or whatever, VBA similarly tries to directly assign the value, only implicit conversion fails."}, {"owner": {"reputation": 715, "user_id": 4258124, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Cp2ML.jpg?s=128&g=1", "display_name": "NikT", "link": "https://stackoverflow.com/users/4258124/nikt"}, "edited": false, "score": 0, "creation_date": 1485997754, "post_id": 41992161, "comment_id": 71162359, "body": "@Blackhawk Not at all! I think it was great to see how CopyMemory could be used to manipulate the returned value. I&#39;ve never used it before"}, {"owner": {"reputation": 320, "user_id": 5001425, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f87ab6387cb9bb0c4756d213ca483c78?s=128&d=identicon&r=PG&f=1", "display_name": "kainC", "link": "https://stackoverflow.com/users/5001425/kainc"}, "edited": false, "score": 0, "creation_date": 1486008957, "post_id": 41992161, "comment_id": 71165136, "body": "This is the best answer so far, since you explained that the &quot;missing&quot; is actually an error value. Unfortunately, I still can&#39;t find a way to explicitly assign it as a parameter, even if I try &quot;Before:=Error(448)&quot;.  It seems like a workaround that you would have to assign it as the output of another function. Any suggestions?"}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1486014850, "post_id": 41992161, "comment_id": 71166947, "body": "KainC, the VBA language was not designed to be used this way, so it is of course a workaround. I don&#39;t know of any language that IS designed to allow you to fool a variadic function into accepting a &quot;missing&quot; value..."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1486015357, "post_id": 41992161, "comment_id": 71167145, "body": "To clarify further, this is just a fun hack that should not be used in a serious application. The question of how to trick an optional parameter into thinking it isn&#39;t being used is similar to &quot;how can i ride my motorcycle safely through a grocery store?&quot; The answer to that question would certainly be amusing, but no one would (or should) actually do it. If you ever run into a situation where you feel that you <i>need</i> to fake a missing parameter, i encourage you to post the specifics as a question on StackOverflow to get some perspective."}, {"owner": {"reputation": 320, "user_id": 5001425, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f87ab6387cb9bb0c4756d213ca483c78?s=128&d=identicon&r=PG&f=1", "display_name": "kainC", "link": "https://stackoverflow.com/users/5001425/kainc"}, "edited": false, "score": 0, "creation_date": 1486047897, "post_id": 41992161, "comment_id": 71187115, "body": "I accepted this as the answer. I agree it&#39;s better to let VBA infer the &quot;missing&quot; value, however I wish there was a cleaner way of dealing with the fact that .Add provides two optional arguments (before/after) that <i>unconditionally</i> throw an error if I pass them with an empty collection."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 320, "user_id": 5001425, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f87ab6387cb9bb0c4756d213ca483c78?s=128&d=identicon&r=PG&f=1", "display_name": "kainC", "link": "https://stackoverflow.com/users/5001425/kainc"}, "edited": false, "score": 0, "creation_date": 1486077391, "post_id": 41992161, "comment_id": 71203617, "body": "@kainC LOTS of things will throw errors if handled incorrectly - it&#39;s up to you, the programmer, to be aware of what your code is doing. For example, if you try and reference members of an Object variable which is Nothing, you&#39;ll get an error; or if you try to look up a value in an array which hasn&#39;t been dimensioned or if the index exceed the bounds; or if you try to manipulate a control that doesn&#39;t have focus; or any of a hundred different things. The general way these are handled is with the conditional clauses of If statements or For loops or While loops. It&#39;s expected behavior."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 320, "user_id": 5001425, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f87ab6387cb9bb0c4756d213ca483c78?s=128&d=identicon&r=PG&f=1", "display_name": "kainC", "link": "https://stackoverflow.com/users/5001425/kainc"}, "edited": false, "score": 0, "creation_date": 1486096551, "post_id": 41992161, "comment_id": 71208451, "body": "@kainC I think I get it! I bet you&#39;re coming from a programming language that makes extensive use of functional paradigms, which generally makes things really neat and concise. Unfortunately, VBA doesn&#39;t support first class functions, so it requires a lot of (arguably) uglier syntax to get the same effect. No first class functions means no passing functions as arguments, no lambdas/anonymous functions, no higher order functions like Map and Reduce, and a lot more classes in places where a function would be easier in a language like Python or Ruby. :&#39;("}], "tags": [], "owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "is_accepted": true, "score": 5, "last_activity_date": 1485995626, "last_edit_date": 1485995626, "creation_date": 1485994083, "answer_id": 41992161, "question_id": 41990431, "link": "https://stackoverflow.com/questions/41990431/vba-specify-no-value-for-optional-argument/41992161#41992161", "title": "VBA specify no value for optional argument", "body": "<p><strong>Yes, it is possible in VBA</strong> (Updated to avoid the complication of CopyMemory)</p>\n\n<p>Add a new module <strong>mdlMissingVariant</strong> to your VBA project with the following code:</p>\n\n<pre><code>Public Function getMissingVariant(Optional v As Variant) As Variant\n    getMissingVariant = v\nEnd Function\n</code></pre>\n\n<p>Now, anytime you want to trick VBA into thinking you didn't provide a value for a parameter, use <code>getMissingVariant()</code> (don't provide a parameter) instead. For example, define the following function:</p>\n\n<pre><code>Public Sub testOpt(Optional v As Variant)\n    Debug.Print IsMissing(v)\nEnd Sub\n</code></pre>\n\n<p>And test with...</p>\n\n<pre><code>testOpt getMissingVariant()\n</code></pre>\n\n<p>...to see that the VBA IsMissing function detects that the parameter was not provided. The reason this works is a <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms221627(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Variant is a 16-byte structure</a> that includes a <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms221170(v=vs.85).aspx\" rel=\"nofollow noreferrer\">2-byte code describing the type of data it contains</a>. One of these types (10, in fact) is VT_ERROR. When you don't provide a parameter to an optional Variant, internally VBA changes the type of the Variant to \"VT_ERROR\" and assigns a value of &amp;H80020004 (Long), which is <a href=\"https://msdn.microsoft.com/en-us/library/cc704587.aspx\" rel=\"nofollow noreferrer\">the Windows error code for \"Parameter not found\"</a>.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I stand corrected - as @Nik points out, the \"missing\" Variant <em>can</em> be used as a parameter of <code>IIF</code>, so your code will work fine!</p>\n"}, {"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 5, "last_activity_date": 1485997167, "last_edit_date": 1492087139, "creation_date": 1485996525, "answer_id": 41992515, "question_id": 41990431, "link": "https://stackoverflow.com/questions/41990431/vba-specify-no-value-for-optional-argument/41992515#41992515", "title": "VBA specify no value for optional argument", "body": "<p>I'm going to begin with a caveat that calling <code>Collection.Add</code> with an <code>IIf</code> statement like that is <strong><em>not</em></strong> \"cleaner\" than having 2 different calls.  <code>IIf</code> is a <em>function</em> and carries the overhead of a function call. Also, since both the true part and the false part are passed as parameters, <strong><em>both</em></strong> of them are evaluated <strong><em>regardless</em></strong> of whether the condition is true or false. That means you'll <em>always</em> call <code>myCollection.Count</code> twice. In addition to being much less efficient, it is much less readable.  Unless you're <a href=\"https://codegolf.stackexchange.com/\">code golfing</a>, there is rarely a good reason to use <code>IIf</code> at all.  This is much, much better on several levels:</p>\n\n<pre><code>If myCollection.Count &gt; 0 Then\n    myCollection.Add myItem, , myCollection.Count\nElse\n    myCollection.Add myItem\nEnd If\n</code></pre>\n\n<p>Also, as mentioned in the comments, <code>Collection</code> <strong><em>does</em></strong> preserve order of added items, so the above code is identical to:</p>\n\n<pre><code>myCollection.Add myItem\n</code></pre>\n\n<p>OK, with that out of the way, if you <em>really</em> feel compelled to do this... Another option is to simply provide your own overload of <code>IIf</code> with optional parameters:</p>\n\n<pre><code>Private Function IIf(condition As Boolean, Optional truepart As Variant, _\n                     Optional falsepart As Variant)\n    IIf = VBA.IIf(condition, truepart, falsepart)\nEnd Function\n</code></pre>\n\n<p>Note that this \"hides\" the built-in VBA function within the scope that you declare the function in, so you should comment it heavily and make sure that it doesn't break other calls to <code>IIf</code> elsewhere in your code. After you provide the overload, you can use it just like the built-in, but omit parameters:</p>\n\n<pre><code>Public Sub Example()\n     ValueOfIIf IIf(True, , \"Foo\")\nEnd Sub\n\nPublic Sub ValueOfIIf(result As Variant)\n    Debug.Print IsMissing(result)    '&lt;--True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 320, "user_id": 5001425, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f87ab6387cb9bb0c4756d213ca483c78?s=128&d=identicon&r=PG&f=1", "display_name": "kainC", "link": "https://stackoverflow.com/users/5001425/kainc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1512, "favorite_count": 0, "accepted_answer_id": 41992161, "answer_count": 3, "score": 0, "last_activity_date": 1485997167, "creation_date": 1485985775, "question_id": 41990431, "link": "https://stackoverflow.com/questions/41990431/vba-specify-no-value-for-optional-argument", "title": "VBA specify no value for optional argument", "body": "<p>I want to add to a collection using a statement like</p>\n\n<pre><code>myCollection.Add myItem, After:=Iif(myCollection.Count &gt; 0, myCollection.Count, vbNull)\n</code></pre>\n\n<p>In other words, I want to decide if I want to specify the parameter \"After\", and if I don't then I want to pass a non-value value in it's place.</p>\n\n<p>It would be a lot cleaner than having to put in a separate call for each scenario.</p>\n\n<p>Is this possible in VBA?</p>\n"}, {"tags": ["vba", "excel", "object", "garbage-collection"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1486002545, "post_id": 41990017, "comment_id": 71163542, "body": "If you really have a dll that has a <code>GetObject</code> method, you should alias it in the declare statement so it doesn&#39;t hide the VBA <code>GetObject</code> function."}, {"owner": {"reputation": 173, "user_id": 3847207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e177b9ef9729e7b4feaeaca796b49590?s=128&d=identicon&r=PG&f=1", "display_name": "zaphodalive", "link": "https://stackoverflow.com/users/3847207/zaphodalive"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1486028047, "post_id": 41990017, "comment_id": 71173752, "body": "@Comintern: Ah perhaps I should have used a different name... no the DLL does not have a GetObject method, just a method that returns an object.  I used that name only to keep the example simple."}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 3847207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e177b9ef9729e7b4feaeaca796b49590?s=128&d=identicon&r=PG&f=1", "display_name": "zaphodalive", "link": "https://stackoverflow.com/users/3847207/zaphodalive"}, "edited": false, "score": 0, "creation_date": 1485989531, "post_id": 41990482, "comment_id": 71159764, "body": "Thanks, that&#39;s all I needed to know.  I wanted to make sure that the spreadsheet I&#39;m working on doesn&#39;t create endless objects that aren&#39;t being dis-instantiated without explicitly breaking the variable reference with <code>= Nothing</code>."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1486002432, "post_id": 41990482, "comment_id": 71163516, "body": "FWIW, <i>all</i> COM objects handle reference counting that way, and user objects are COM objects. IIR they extend a base class defined in a hidden 2nd typelib in VBE7.dll.  VBA uses the COM reference counting interfaces and lets the COM server determine object lifespan."}], "tags": [], "owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "is_accepted": true, "score": 3, "last_activity_date": 1485985998, "creation_date": 1485985998, "answer_id": 41990482, "question_id": 41990017, "link": "https://stackoverflow.com/questions/41990017/is-a-vba-object-destroyed-when-the-variable-is-set-to-a-new-object/41990482#41990482", "title": "Is a VBA object destroyed when the variable is set to a new object?", "body": "<p>When you assign an object reference to a variable, the reference count goes up by one, and when the variable loses the reference by some other assignment, the object's reference count goes down by one. For example:</p>\n\n<pre><code>Dim a As Collection\nSet a = new Collection 'The reference count of this new Collection object is 1\nSet b = a              'The reference count of the Collection object is now 2\nSet b = new Collection 'The reference count of the original collection has gone back down to 1 because b is no longer a reference to it, and this new Collection has a reference count of 1\n\nSet a = Nothing        'The original collection no longer has any active references, so VBA safely GCs it.\nSet b = Nothing        'The newer collection now no longer has any active references either, so VBA safely GCs it.\n</code></pre>\n\n<p>Now, in your case you're talking about an external DLL, which may manage its own memory or running state differently internally. But the way that VBA handles COM reference counts is the same. </p>\n"}], "owner": {"reputation": 173, "user_id": 3847207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e177b9ef9729e7b4feaeaca796b49590?s=128&d=identicon&r=PG&f=1", "display_name": "zaphodalive", "link": "https://stackoverflow.com/users/3847207/zaphodalive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 716, "favorite_count": 0, "accepted_answer_id": 41990482, "answer_count": 1, "score": 2, "last_activity_date": 1485985998, "creation_date": 1485984237, "question_id": 41990017, "link": "https://stackoverflow.com/questions/41990017/is-a-vba-object-destroyed-when-the-variable-is-set-to-a-new-object", "title": "Is a VBA object destroyed when the variable is set to a new object?", "body": "<p>I haven't found an answer specific to this question so hopefully someone can clear it up for me.</p>\n\n<p>I understand the VBA Garbage Collector uses a reference count to determine if an object is not longer required, and to explicitly disassociate a variable (thereby decrementing the reference count) you use:</p>\n\n<pre><code>Set objectVariable = Nothing\n</code></pre>\n\n<p>Here is what I have in a spreadsheet I'm working on right now:</p>\n\n<pre><code>Declare Function GetObject Lib \"ObjectCreator.dll\" () As Object\nPublic MyObject as Object\n\nSub MyMethod()\n    Set MyObject = GetObject()\n        ...do stuff with MyObject...\n\n    Set MyObject = GetObject()\n        ...do stuff with my new MyObject...\n\n    Set MyObject = GetObject()\n        ...do stuff with my even newer MyObject...\n\n    Set MyObject = Nothing\nEnd Sub\n</code></pre>\n\n<p>My question is: Do all three of the created objects get destroyed by the GC or only the last one?  i.e. Does the reference count of an object get decremented when its referencing variable is set to another object rather than being set to <code>Nothing</code>?</p>\n"}, {"tags": ["vba", "outlook", "outlook-2010"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1485984618, "post_id": 41989779, "comment_id": 71157521, "body": "Set email = ActiveInspector.currentItem"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1485985781, "post_id": 41989779, "comment_id": 71158041, "body": "The tiny text below your code says you cannot send emails you composed; you must edit an existing email. Your code edits the first or only selected email directly. Have you tried creating a copy of the original email and editting the copy? Add <code>Dim emailCopy As MailItem</code> and <code>Set emailCopy = email</code>."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1485994415, "post_id": 41989779, "comment_id": 71161405, "body": "About not being able to compose new emails - have you tried using Outlook in safe mode <code>outlook.exe &#47;safe</code>? It could be some Outlook Addin."}], "answers": [{"tags": [], "owner": {"reputation": 2295, "user_id": 1873386, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8edc08129abcfef8b73d6bd8d1bd2bf5?s=128&d=identicon&r=PG", "display_name": "crashwap", "link": "https://stackoverflow.com/users/1873386/crashwap"}, "is_accepted": true, "score": 1, "last_activity_date": 1486057201, "last_edit_date": 1495540923, "creation_date": 1486057201, "answer_id": 42008837, "question_id": 41989779, "link": "https://stackoverflow.com/questions/41989779/outlook-programmatically-modify-email-currently-being-composed-edited/42008837#42008837", "title": "Outlook - programmatically modify email currently being composed/edited", "body": "<p>This allows editing the email currently being composed:</p>\n\n<pre><code>Dim theEmail As MailItem, oInspector As Inspector\nSet oInspector = Application.ActiveInspector\nSet theEmail = oInspector.CurrentItem\n</code></pre>\n\n<p>Reference:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/15476986/working-with-current-open-email\">Working with current open email</a></p>\n"}], "owner": {"reputation": 2295, "user_id": 1873386, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8edc08129abcfef8b73d6bd8d1bd2bf5?s=128&d=identicon&r=PG", "display_name": "crashwap", "link": "https://stackoverflow.com/users/1873386/crashwap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "accepted_answer_id": 42008837, "answer_count": 1, "score": 1, "last_activity_date": 1593413842, "creation_date": 1485983303, "last_edit_date": 1593413842, "question_id": 41989779, "link": "https://stackoverflow.com/questions/41989779/outlook-programmatically-modify-email-currently-being-composed-edited", "title": "Outlook - programmatically modify email currently being composed/edited", "body": "<p>For valid personal reasons** I am trying to construct a macro that clears out the To, CC, Subject and Body of the email being replied to (in compose mode?). What I have below works on an email being READ, but it does not work on an email being MODIFIED/COMPOSED.</p>\n\n<p>What must be changed for the macro to work on an email being composed/edited?</p>\n\n<pre><code>Sub ClearEmail()\n    Dim olExplorer As Explorer\n    Dim olSelection As Selection\n    Dim email As MailItem\n    Dim strSig As String, Sig As String\n\n    Set olExplorer = Application.ActiveExplorer\n    Set olSelection = olExplorer.Selection\n    Set email = olSelection.Item(1)\n\n    email.To = \"\"\n    email.CC = \"team@example.com\"\n\n    email.Subject = \"\"\n    email.HTMLBody = vbCrLf &amp; vbCrLf &amp; vbCrLf &amp; \"Hello\"\nEnd Sub\n</code></pre>\n\n<p><sup>**</sup> <sub><em>My Exchange profile is messed up, has been for weeks, and the part-time Exchange admin cannot get to it anytime soon. The only way I can successfully send an email is to open an existing email from the group Inbox, hit Reply To All, clear out the fields and add my signature. Then I can edit as desired and send it with no problems. (Emails I simply compose and send get stuck in the Outbox and are never sent - there are dozens of them.) I have been doing this manually for weeks.</em></sub><br><sub><em>I am not an Outlook/VBA programmer so please forgive me for not knowing the right terminology.</em></sub></p>\n\n<p>Sources:</p>\n\n<p><a href=\"http://www.rondebruin.nl/win/s1/outlook/signature.htm\" rel=\"nofollow noreferrer\">http://www.rondebruin.nl/win/s1/outlook/signature.htm</a></p>\n\n<p><a href=\"http://www.vbforums.com/showthread.php?628044-Insert-text-into-current-outlook-message\" rel=\"nofollow noreferrer\">http://www.vbforums.com/showthread.php?628044-Insert-text-into-current-outlook-message</a></p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 2, "creation_date": 1485983249, "post_id": 41989668, "comment_id": 71156870, "body": "put a break on each line and press F5, by the way, there&#39;s nothing on your code to step into anyway."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 2, "creation_date": 1485983350, "post_id": 41989668, "comment_id": 71156916, "body": "break points doesn&#39;t work on declarations."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1485984947, "post_id": 41989668, "comment_id": 71157674, "body": "Rolled back the edit.  The answer you accepted doesn&#39;t make any sense without the original code."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1485986081, "post_id": 41989668, "comment_id": 71158198, "body": "And questions without code are somewhat verboten anyway, @Comintern"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1485984146, "creation_date": 1485984146, "answer_id": 41989992, "question_id": 41989668, "link": "https://stackoverflow.com/questions/41989668/how-to-run-each-line-using-f8/41989992#41989992", "title": "How to run each line using F8?", "body": "<p><em>Step into</em> only works on <em>executable instructions</em>.</p>\n\n<p><code>Dim</code> statements aren't executable; their order doesn't matter at all actually - essentially, a local variable comes into existence as soon as execution enters its scope*, regardless of where in that scope it's declared.</p>\n\n<p>So in this case when execution enters the <code>upload_fed_expenses_batch</code> procedure, it hits the first executable statement and, because that's a <code>Stop</code> statement, stops right there and then.</p>\n\n<p><strong>From that point on</strong>, you can use F8 to run <em>executable</em> code line by line, but as was accurately mentioned in comments already, you can't break on declarations.</p>\n\n<hr>\n\n<p>*with a caveat for <code>Static</code> locals.</p>\n"}], "owner": {"reputation": 33, "user_id": 2623359, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5d00971f4fcd40c4eea080686b596000?s=128&d=identicon&r=PG", "display_name": "user2623359", "link": "https://stackoverflow.com/users/2623359/user2623359"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1385, "favorite_count": 0, "accepted_answer_id": 41989992, "answer_count": 1, "score": 0, "last_activity_date": 1609589081, "creation_date": 1485982834, "last_edit_date": 1609589081, "question_id": 41989668, "link": "https://stackoverflow.com/questions/41989668/how-to-run-each-line-using-f8", "title": "How to run each line using F8?", "body": "<p>How to you run a Private Sub, and execute each line?</p>\n<p>It is not allowing me to Step into by pressing F8.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub upload_fed_expenses_batch()\n    \n    Dim dbConn As ADODB.Connection, sSQL As String, rsLocal As New ADODB.Recordset, rstmp As New ADODB.Recordset\n    Dim dbOracle As New ADODB.Connection, rsOracle As New ADODB.Recordset, lCount As Long, rsValue As New ADODB.Recordset\n    Dim dAmount As Double, dBase As Double\n\n    Stop\n</code></pre>\n"}, {"tags": ["vba", "excel", "internet-explorer", "xmlhttprequest"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1485983372, "post_id": 41989412, "comment_id": 71156928, "body": "It&#39;s impossible to answer this without seeing the actual URL - there are many potential events which code in your HTML page could be responding to (blur, key down/up, focus, etc etc)"}, {"owner": {"reputation": 12139, "user_id": 2412846, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/eBJip.gif?s=128&g=1", "display_name": "davidhigh", "link": "https://stackoverflow.com/users/2412846/davidhigh"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1485984243, "post_id": 41989412, "comment_id": 71157330, "body": "@TimWilliams: (i) is it possible to figure out the occuring events in a clever or systematic way? (--without trial and error with recording)  (ii) anyways, I don&#39;t want to use the event-reproduction way. I want to directly fire a post request using XMLHttpRequest in the Internet Explorer, and this from VBA ... so that the server sees the same result as it would otherwise be triggered by Javascript events."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1485984519, "post_id": 41989412, "comment_id": 71157476, "body": "Yes it&#39;s probably possible, but you will need to examine the page and figure out exactly what&#39;s going on there."}, {"owner": {"reputation": 12139, "user_id": 2412846, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/eBJip.gif?s=128&g=1", "display_name": "davidhigh", "link": "https://stackoverflow.com/users/2412846/davidhigh"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1485984732, "post_id": 41989412, "comment_id": 71157574, "body": "@TimWilliams: ok, thanks, that relates to (i). The heart of the OP is at (ii). Any ideas?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1485986408, "post_id": 41989412, "comment_id": 71158363, "body": "I was talking about both parts.  You need to figure out (i) in order to do (ii)."}, {"owner": {"reputation": 12139, "user_id": 2412846, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/eBJip.gif?s=128&g=1", "display_name": "davidhigh", "link": "https://stackoverflow.com/users/2412846/davidhigh"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1485986595, "post_id": 41989412, "comment_id": 71158464, "body": "@TimWilliams: I did, and I exactly know the POST request I want to send --it&#39;s there in the F12 developer tools. I just don&#39;t know how to replicate it in the Internet Explorer using VBA."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1485996958, "post_id": 41989412, "comment_id": 71162146, "body": "Do you have access to the js code that is sending the POST ?"}, {"owner": {"reputation": 12139, "user_id": 2412846, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/eBJip.gif?s=128&g=1", "display_name": "davidhigh", "link": "https://stackoverflow.com/users/2412846/davidhigh"}, "edited": false, "score": 0, "creation_date": 1486032812, "post_id": 41989412, "comment_id": 71177000, "body": "@RobertMackenzie: I can see it in the browser, yes. But it&#39;s quite much, quite unformatted and I don&#39;t know Javascript well. What would you suggest when the code is there? ... probably going through it and figure out exactly what is done, yes?"}], "answers": [{"tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 1, "last_activity_date": 1485996743, "creation_date": 1485996743, "answer_id": 41992553, "question_id": 41989412, "link": "https://stackoverflow.com/questions/41989412/vba-send-xmlhttprequest-from-internet-explorer/41992553#41992553", "title": "VBA send XMLHttpRequest from Internet Explorer", "body": "<p>These links looks promising |<a href=\"https://support.microsoft.com/en-us/help/167658/how-to-automate-internet-explorer-to-post-form-data\" rel=\"nofollow noreferrer\">VB5</a>| <a href=\"https://support.microsoft.com/en-us/help/815724/how-to-automate-internet-explorer-to-post-form-data-by-using-visual-c-.net-or-visual-c-2005\" rel=\"nofollow noreferrer\">C#</a> |\n<a href=\"https://msdn.microsoft.com/en-us/library/aa752093(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Navigate method, 4th argument </a>|<a href=\"http://www.motobit.com/tips/detpg_sendfrmie/\" rel=\"nofollow noreferrer\">Another VB example using StrConv for byte array conversion</a>|\nIt looks like you simply use the Navigate method and simply data packed into a byte array for the fourth argument.  One of the above links is old but the newer link looks very similar so I think the interface has not changed much.</p>\n\n<p>Do please post feedback.</p>\n"}], "owner": {"reputation": 12139, "user_id": 2412846, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/eBJip.gif?s=128&g=1", "display_name": "davidhigh", "link": "https://stackoverflow.com/users/2412846/davidhigh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 777, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485996743, "creation_date": 1485981903, "last_edit_date": 1531164843, "question_id": 41989412, "link": "https://stackoverflow.com/questions/41989412/vba-send-xmlhttprequest-from-internet-explorer", "title": "VBA send XMLHttpRequest from Internet Explorer", "body": "<p>tl;dr: How can one send a POST request in VBA by using an XMLHttpRequest within the Internet Explorer?</p>\n\n<hr>\n\n<p>I'm about automating the use of page on the internet. The idea is to start from Excel to gather some data in a worksheet, then transfer these data to the internet page, click some buttons in the meantime, and thereafter work on manually.</p>\n\n<p>I recorded the whole process when executed manually by the F12 Developer tools. By bringing the data into the textboxes of the internet page, some Javascript events take place which fire a POST request through XMLHttpRequest:\n<a href=\"https://i.stack.imgur.com/vaOQA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vaOQA.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now, by replicating the procedure described above in VBA (using <code>getElementById</code>, <code>.click()</code>,<code>.value=</code> and the like), it appears that the relevant events are not fired: no such POST request as shown above are sent to the server, and no additional masks open. This is why I wanted to omit the textbox-filling-and-clicking approach and simply replicate the POST request.</p>\n\n<p>How can I do this from VBA by using the Internet Explorer?</p>\n\n<p>Disclaimer: I'm aware how to send a POST request using <code>MSXML2.serverXMLHTTP</code>, which is described hundreds of times over the web. However, there it's always either-or: either use the Internet Explorer, or <code>MSXML2.serverXMLHTTP</code>. However, I need the request within the Internet Explorer.</p>\n"}, {"tags": ["vba", "outlook", "special-characters", "attachment"], "comments": [{"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 1, "creation_date": 1485981648, "post_id": 41989240, "comment_id": 71155930, "body": "Hello and welcome to SO. Please take some time to read the help page, including <a href=\"http://stackoverflow.com/help/on-topic\">What topics can I ask about here?</a> and <a href=\"http://stackoverflow.com/help/dont-ask\">What types of questions should I avoid asking?</a>. Also Note that SO is NOT a code writing service...we are programmers trying to help other programmers through specific questions or errors. If you don&#39;t include the code you are working with and a detailed explanation of any errors or expectations vs reality...we can&#39;t help much.  Use code formatted in <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 1, "creation_date": 1485984356, "post_id": 41989240, "comment_id": 71157382, "body": "I do not understand your problem. You say you have found code that saves attachments. That will include a statement something like <code>ItemCrnt.Attachment(InxA) Path &amp; FileName</code>. Typically <code>FileName</code> will be the attachment&#39;s <code>DisplayName</code>. Firstly, You need to extract the extension with preceding period from <code>DisplayName</code>. Secondly replace the save statement with: <code>ItemCrnt.Attachment(InxA) Path &amp; ItemCrnt.Subject &amp; &quot; (&quot; &amp; InxA &amp; &quot;)&quot; &amp; Extn</code>"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1485986578, "post_id": 41989240, "comment_id": 71158453, "body": "Can you post your code so we can help you fix it?"}, {"owner": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "edited": false, "score": 2, "creation_date": 1486091342, "post_id": 41989240, "comment_id": 71207190, "body": "I added the script I am using now and added a little more detail to my request. Thanks a bunch for you time :)"}], "answers": [{"comments": [{"owner": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "edited": false, "score": 0, "creation_date": 1486191099, "post_id": 42037172, "comment_id": 71248719, "body": "Ok thanks I will try this on Monday when I have access to outlook."}, {"owner": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "edited": false, "score": 0, "creation_date": 1486384778, "post_id": 42037172, "comment_id": 71307252, "body": "Thanks 0m3r that has helped a lot. I now have a macro that will pull all documents and rename them as i need. I do have one problem thought. If the email is from a Forward (FW:) or a Reply (RE: then the file is renamed as FW or RE and no file extention has been assigned to those files. I will attempt to figure this out myself but I am only a beginner in code and would very much appreciate your asistance."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "edited": false, "score": 0, "creation_date": 1486407641, "post_id": 42037172, "comment_id": 71321936, "body": "@BaconTech wow buddy, you have updated your question- you should accept this answer and ask new question..."}, {"owner": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "edited": false, "score": 0, "creation_date": 1486470816, "post_id": 42037172, "comment_id": 71349956, "body": "I am still new to this kind of forum. In the future I will ask a seperate question once part of my original was answered. I did not want to post several questions related to my original."}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1486188723, "creation_date": 1486188723, "answer_id": 42037172, "question_id": 41989240, "link": "https://stackoverflow.com/questions/41989240/how-can-i-extract-attachments-from-outlook-save-as-subject-line-and-remove-inva/42037172#42037172", "title": "How can I extract attachments from Outlook, save as subject line and remove invalid characters?", "body": "<p>You need to modify your <strong><code>For Each loop</code></strong>, Try this...</p>\n\n<p>Change this </p>\n\n<pre><code>Dim strAtmtName(1)      As String\n</code></pre>\n\n<p>To this</p>\n\n<pre><code>Dim strAtmtName         As String\n</code></pre>\n\n<p>And then modify your <code>For Each loop</code> like this</p>\n\n<pre><code>For Each Atmt In atmts\n    strAtmtFullName = Atmt.FileName\n    intDotPosition = InStrRev(strAtmtFullName, \".\")\n    strAtmtName = Right$(strAtmtFullName, Len(strAtmtFullName) - intDotPosition)\n    strAtmtPath = strFolderPath &amp; objItem.Subject &amp; Chr(46) &amp; strAtmtName\n\n    Dim lngF As Long\n    lngF = 1\n\n    If Len(strAtmtPath) &lt;= MAX_PATH Then\n        blnIsSave = True\n        Do While objFSO.FileExists(strAtmtPath)\n\n            strAtmtNameTemp = objItem.Subject &amp; \"(\" &amp; lngF &amp; \")\"\n\n            strAtmtPath = strFolderPath &amp; strAtmtNameTemp &amp; Chr(46) &amp; strAtmtName\n\n            If Len(strAtmtPath) &gt; MAX_PATH Then\n                lCountEachItem = lCountEachItem - 1\n                blnIsSave = False\n                Exit Do\n            End If\n\n            lngF = lngF + 1\n        Loop\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 407, "user_id": 1136578, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bed0d00bb4470949d375aaf2315fb99f?s=128&d=identicon&r=PG", "display_name": "Erin", "link": "https://stackoverflow.com/users/1136578/erin"}, "edited": false, "score": 0, "creation_date": 1495580837, "post_id": 42095242, "comment_id": 75310452, "body": "I&#39;m trying to use this script but am getting a &quot;Compile Error: Sub or Function not defined.&quot; It then highlights line 27: FindWindow.  I do not know how to troubleshoot this. Any idea why it is going wrong for me?"}, {"owner": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "reply_to_user": {"reputation": 407, "user_id": 1136578, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bed0d00bb4470949d375aaf2315fb99f?s=128&d=identicon&r=PG", "display_name": "Erin", "link": "https://stackoverflow.com/users/1136578/erin"}, "edited": false, "score": 1, "creation_date": 1495631829, "post_id": 42095242, "comment_id": 75335366, "body": "@Erin there are some important sections of code that were not included in my answer as they are part of API declarations. I have added an edited section to show the code you need to deal with the FindWindow error. Let me know if it helped."}], "tags": [], "owner": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "is_accepted": false, "score": 2, "last_activity_date": 1495631717, "last_edit_date": 1495631717, "creation_date": 1486485404, "answer_id": 42095242, "question_id": 41989240, "link": "https://stackoverflow.com/questions/41989240/how-can-i-extract-attachments-from-outlook-save-as-subject-line-and-remove-inva/42095242#42095242", "title": "How can I extract attachments from Outlook, save as subject line and remove invalid characters?", "body": "<p>After some digging aroung looking at several posible options for omiting special characters from the subject line and some toying aroung with the macro I have come up with what seams to work perfectly for what I need.</p>\n\n<p>Thank you 0m3r for your inital assistance in getting this taken care of.</p>\n\n<p>The code below:</p>\n\n<ol>\n<li>selcet the folder to save all attachments to.</li>\n<li>It then pulls the subject line of each email</li>\n<li>Replaces any special characters I define with \"_\"</li>\n<li>Saves the file as the modified subject line.</li>\n<li>Repeates process for every selected email.</li>\n</ol>\n\n<p>Paste:</p>\n\n<pre><code>Public Function SaveAttachmentsFromSelection() As Long\nDim objFSO              As Object\nDim objShell            As Object\nDim objFolder           As Object\nDim objItem             As Outlook.MailItem\nDim selItems            As Selection\nDim atmt                As Attachment\nDim strAtmtPath         As String\nDim strAtmtFullName     As String\nDim strAtmtName         As String\nDim strAtmtNameTemp     As String\nDim intDotPosition      As Integer\nDim atmts               As Attachments\nDim lCountEachItem      As Long\nDim lCountAllItems      As Long\nDim strFolderPath       As String\nDim blnIsEnd            As Boolean\nDim blnIsSave           As Boolean\nDim strPrompt           As String, strname As String\nDim sreplace            As String, mychar As Variant\n blnIsEnd = False\nblnIsSave = False\nlCountAllItems = 0\nOn Error Resume Next\nSet selItems = ActiveExplorer.Selection\nIf Err.Number = 0 Then\n    lHwnd = FindWindow(olAppCLSN, vbNullString)\n    If lHwnd &lt;&gt; 0 Then\n        Set objShell = CreateObject(\"Shell.Application\")\n        Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n        Set objFolder = objShell.BrowseForFolder(lHwnd, \"Select folder to save attachments:\", _\n                                                 BIF_RETURNONLYFSDIRS + BIF_DONTGOBELOWDOMAIN, CSIDL_DESKTOP)\n        If Err.Number &lt;&gt; 0 Then\n            MsgBox \"Run-time error '\" &amp; CStr(Err.Number) &amp; \" (0x\" &amp; CStr(Hex(Err.Number)) &amp; \")':\" &amp; vbNewLine &amp; _\n                   Err.Description &amp; \".\", vbCritical, \"Error from Attachment Saver\"\n            blnIsEnd = True\n            GoTo PROC_EXIT\n        End If\n\n        If objFolder Is Nothing Then\n            strFolderPath = \"\"\n            blnIsEnd = True\n            GoTo PROC_EXIT\n        Else\n            strFolderPath = CGPath(objFolder.Self.Path)\n            For Each objItem In selItems\n                lCountEachItem = objItem.Attachments.Count\n                If lCountEachItem &gt; 0 Then\n                    Set atmts = objItem.Attachments\n\n                    If objItem.Class = olMail Then\n                        If objItem.subject &lt;&gt; vbNullString Then\n                            strname = objItem.subject\n                        Else\n                            strname = \"No_Subject\"\n                        End If\n                    sreplace = \"_\"\n                    For Each mychar In Array(\"/\", \"\\\", \":\", \"?\", Chr(34), \"&lt;\", \"&gt;\", \"\u00a6\")\n                    'do the replacement for each character that's illegal\n                        strname = Replace(strname, mychar, sreplace)\n                    Next mychar\n                    End If\n                    For Each atmt In atmts\n                        strAtmtFullName = atmt.FileName\n                        intDotPosition = InStrRev(strAtmtFullName, \".\")\n                        strAtmtName = Right$(strAtmtFullName, Len(strAtmtFullName) - intDotPosition)\n                        strAtmtPath = strFolderPath &amp; strname &amp; Chr(46) &amp; strAtmtName\n                        Dim lngF As Long\n                        lngF = 1\n                        If Len(strAtmtPath) &lt;= MAX_PATH Then\n                            blnIsSave = True\n                            Do While objFSO.FileExists(strAtmtPath)\n                                strAtmtNameTemp = strname &amp; \"(\" &amp; lngF &amp; \")\"\n                                strAtmtPath = strFolderPath &amp; strAtmtNameTemp &amp; Chr(46) &amp; strAtmtName\n                                If Len(strAtmtPath) &gt; MAX_PATH Then\n                                    lCountEachItem = lCountEachItem - 1\n                                    blnIsSave = False\n                                    Exit Do\n                                End If\n                            lngF = lngF + 1\n                            Loop\n                            If blnIsSave Then atmt.SaveAsFile strAtmtPath\n                        Else\n                            lCountEachItem = lCountEachItem - 1\n                        End If\n                    Next\n                End If\n                lCountAllItems = lCountAllItems + lCountEachItem\n            Next\n        End If\n    Else\n        MsgBox \"Failed to get the handle of Outlook window!\", vbCritical, \"Error from Attachment Saver\"\n        blnIsEnd = True\n        GoTo PROC_EXIT\n    End If   \nElse\n    MsgBox \"Please select an Outlook item at least.\", vbExclamation, \"Message from Attachment Saver\"\n    blnIsEnd = True\nEnd If\nPROC_EXIT:\nSaveAttachmentsFromSelection = lCountAllItems\nIf Not (objFSO Is Nothing) Then Set objFSO = Nothing\nIf Not (objItem Is Nothing) Then Set objItem = Nothing\nIf Not (selItems Is Nothing) Then Set selItems = Nothing\nIf Not (atmt Is Nothing) Then Set atmt = Nothing\nIf Not (atmts Is Nothing) Then Set atmts = Nothing\nIf blnIsEnd Then End\nEnd Function\nPublic Function CGPath(ByVal Path As String) As String\nIf Right(Path, 1) &lt;&gt; \"\\\" Then Path = Path &amp; \"\\\"\nCGPath = Path\nEnd Function\nPublic Sub ExecuteSaving()\nDim lNum As Long\nlNum = SaveAttachmentsFromSelection\nIf lNum &gt; 0 Then\n    MsgBox CStr(lNum) &amp; \" attachment(s) was(were) saved successfully.\", vbInformation, \"Message from Attachment Saver\"\nElse\n    MsgBox \"No attachment(s) in the selected Outlook items.\", vbInformation, \"Message from Attachment Saver\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Edit: </p>\n\n<p>Section of script used for API declarations that are needed to make this script work in outlooks VBA. This section of code goes before you declare all your variables above the line <code>Public Function SaveAttachmentsFromSelection() As Long</code></p>\n\n<pre><code>Option Explicit\n\n' *****************\n' For Outlook 2010.\n' *****************\n#If VBA7 Then\n    ' The window handle of Outlook.\n    Private lHwnd As LongPtr\n\n    ' /* API declarations. */\n    Private Declare PtrSafe Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As String, _\n        ByVal lpWindowName As String) As LongPtr\n\n' *****************************************\n' For the previous version of Outlook 2010.\n' *****************************************\n#Else\n    ' The window handle of Outlook.\n    Private lHwnd As Long\n\n    ' /* API declarations. */\n    Private Declare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As String, _\n        ByVal lpWindowName As String) As Long\n#End If\n\n' The class name of Outlook window.\nPrivate Const olAppCLSN As String = \"rctrl_renwnd32\"\n' Windows desktop - the virtual folder that is the root of the namespace.\nPrivate Const CSIDL_DESKTOP = &amp;H0\n' Only return file system directories. If the user selects folders that are not part of the file system, the OK button is grayed.\nPrivate Const BIF_RETURNONLYFSDIRS = &amp;H1\n' Do not include network folders below the domain level in the dialog box's tree view control.\nPrivate Const BIF_DONTGOBELOWDOMAIN = &amp;H2\n' The maximum length for a path is 260 characters.\nPrivate Const MAX_PATH = 260\n</code></pre>\n"}], "owner": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 934, "favorite_count": 0, "accepted_answer_id": 42037172, "answer_count": 2, "score": 2, "last_activity_date": 1592994554, "creation_date": 1485981294, "last_edit_date": 1592994554, "question_id": 41989240, "link": "https://stackoverflow.com/questions/41989240/how-can-i-extract-attachments-from-outlook-save-as-subject-line-and-remove-inva", "title": "How can I extract attachments from Outlook, save as subject line and remove invalid characters?", "body": "<p>I am working on a project that requires me to save large numbers of attachments to a folder and filter them.</p>\n\n<p>I can currently save the attachments with the subject of the email as the filename. If there is more than 1 attachment then it saves as the subject line with a (1) or (2) and so on.</p>\n\n<p>I currently have a script that will do most of what I need (Thanks to the help from 0m3r in the replys below)</p>\n\n<p>The last thing I need to complete this script is something that will omit special caracters from the subject line before it uses the subject line as the file name. The problem I am running into is the program does not save files correctly if the subject is a Forward (FW:) or a Reply (RE:) I suspect the \":\" is what is breaking the save file. For example if the Subject reads \"FW: Here is the file you requested 2017\" what I am getting is a file saved as \"FW\" without a file extensions. What I need is to remove the \":\" or the \"FW:\" so this does not happen.</p>\n\n<p>Can someone provide me with the correction I need to remove special characters from the subject as its converted to the save file name?</p>\n\n<p>I think an Array will be needed to accomplish this but I am not sure how to implament it and what part of the script to add it into.</p>\n\n<p>Something like Array(\"&lt;\", \">\", \"|\", \"/\", \"*\", \"\\\", \"?\", \"\"\"\", \"'\", \":\")</p>\n\n<pre><code>Public Function SaveAttachmentsFromSelection() As Long\nDim objFSO              As Object       \nDim objShell            As Object       \nDim objFolder           As Object       \nDim objItem             As Object       \nDim selItems            As Selection    \nDim atmt                As Attachment   \nDim strAtmtPath         As String       \nDim strAtmtFullName     As String       \nDim strAtmtName         As String       \nDim strAtmtNameTemp     As String       \nDim intDotPosition      As Integer      \nDim atmts               As Attachments  \nDim lCountEachItem      As Long         \nDim lCountAllItems      As Long         \nDim strFolderPath       As String       \nDim blnIsEnd            As Boolean      \nDim blnIsSave           As Boolean      \n\nblnIsEnd = False\nblnIsSave = False\nlCountAllItems = 0\n\nOn Error Resume Next\n\nSet selItems = ActiveExplorer.Selection\n\nIf Err.Number = 0 Then\n\n    lHwnd = FindWindow(olAppCLSN, vbNullString)\n\n    If lHwnd &lt;&gt; 0 Then\n\n        Set objShell = CreateObject(\"Shell.Application\")\n        Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n        Set objFolder = objShell.BrowseForFolder(lHwnd, \"Select folder to save attachments:\", _\n                                                 BIF_RETURNONLYFSDIRS + BIF_DONTGOBELOWDOMAIN, CSIDL_DESKTOP)\n\n        If Err.Number &lt;&gt; 0 Then\n            MsgBox \"Run-time error '\" &amp; CStr(Err.Number) &amp; \" (0x\" &amp; CStr(Hex(Err.Number)) &amp; \")':\" &amp; vbNewLine &amp; _\n                   Err.Description &amp; \".\", vbCritical, \"Error from Attachment Saver\"\n            blnIsEnd = True\n            GoTo PROC_EXIT\n        End If\n\n        If objFolder Is Nothing Then\n            strFolderPath = \"\"\n            blnIsEnd = True\n            GoTo PROC_EXIT\n        Else\n            strFolderPath = CGPath(objFolder.Self.Path)\n\n            For Each objItem In selItems\n                lCountEachItem = objItem.Attachments.Count\n\n                If lCountEachItem &gt; 0 Then\n                    Set atmts = objItem.Attachments\n\n                    For Each atmt In atmts\n                        strAtmtFullName = atmt.FileName\n                        intDotPosition = InStrRev(strAtmtFullName, \".\")\n                        strAtmtName = Right$(strAtmtFullName, Len(strAtmtFullName) - intDotPosition)\n                        strAtmtPath = strFolderPath &amp; objItem.subject &amp; Chr(46) &amp; strAtmtName\n\n                        Dim lngF As Long\n                        lngF = 1\n\n                        If Len(strAtmtPath) &lt;= MAX_PATH Then\n                            blnIsSave = True\n                            Do While objFSO.FileExists(strAtmtPath)\n\n                                strAtmtNameTemp = objItem.subject &amp; \"(\" &amp; lngF &amp; \")\"\n\n                                strAtmtPath = strFolderPath &amp; strAtmtNameTemp &amp; Chr(46) &amp; strAtmtName\n\n                                If Len(strAtmtPath) &gt; MAX_PATH Then\n                                    lCountEachItem = lCountEachItem - 1\n                                    blnIsSave = False\n                                    Exit Do\n                                End If\n\n                            lngF = lngF + 1\n                            Loop\n\n                            If blnIsSave Then atmt.SaveAsFile strAtmtPath\n                        Else\n                            lCountEachItem = lCountEachItem - 1\n                        End If\n                    Next\n                End If\n\n                lCountAllItems = lCountAllItems + lCountEachItem\n            Next\n        End If\n    Else\n        MsgBox \"Failed to get the handle of Outlook window!\", vbCritical, \"Error from Attachment Saver\"\n        blnIsEnd = True\n        GoTo PROC_EXIT\n    End If\n\nElse\n    MsgBox \"Please select an Outlook item at least.\",  vbExclamation, \"Message from Attachment Saver\"\n    blnIsEnd = True\nEnd If\n\nPROC_EXIT:\nSaveAttachmentsFromSelection = lCountAllItems\n\nIf Not (objFSO Is Nothing) Then Set objFSO = Nothing\nIf Not (objItem Is Nothing) Then Set objItem = Nothing\nIf Not (selItems Is Nothing) Then Set selItems = Nothing\nIf Not (atmt Is Nothing) Then Set atmt = Nothing\nIf Not (atmts Is Nothing) Then Set atmts = Nothing\n\nIf blnIsEnd Then End\nEnd Function\n\nPublic Function CGPath(ByVal Path As String) As String\nIf Right(Path, 1) &lt;&gt; \"\\\" Then Path = Path &amp; \"\\\"\nCGPath = Path\nEnd Function\n\nPublic Sub ExecuteSaving()\nDim lNum As Long\n\nlNum = SaveAttachmentsFromSelection\n\nIf lNum &gt; 0 Then\n    MsgBox CStr(lNum) &amp; \" attachment(s) was(were) saved successfully.\", vbInformation, \"Message from Attachment Saver\"\nElse\n    MsgBox \"No attachment(s) in the selected Outlook items.\", vbInformation, \"Message from Attachment Saver\"\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 135, "user_id": 7502463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820415bebe0ed17ba720335a5d9cb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/7502463/gab"}, "edited": false, "score": 0, "creation_date": 1485981380, "post_id": 41989199, "comment_id": 71155788, "body": "I had previously refer to this thread to help me complete my code <a href=\"http://stackoverflow.com/questions/22382729/setting-a-global-scripting-dictionary-in-visual-basic-for-applications-vba\" title=\"setting a global scripting dictionary in visual basic for applications vba\">stackoverflow.com/questions/22382729/&hellip;</a>"}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 1, "creation_date": 1485981798, "post_id": 41989199, "comment_id": 71156026, "body": "You should probably remove the Goto Fill, Else and Fill label...and move the End If up to where you have the Else.  It&#39;s bad form to have one part of your If Goto the other part.  Just doesn&#39;t make sense logically.  That won&#39;t solve your issue, just isn&#39;t good programming."}, {"owner": {"reputation": 135, "user_id": 7502463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820415bebe0ed17ba720335a5d9cb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/7502463/gab"}, "reply_to_user": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1486059415, "post_id": 41989199, "comment_id": 71194548, "body": "Thanks for your comment @Rdster, I also thought it was weird but I guess I was focusing more on the dictionary problem. I will take your advice and change that  code."}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 7502463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820415bebe0ed17ba720335a5d9cb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/7502463/gab"}, "edited": false, "score": 0, "creation_date": 1486060109, "post_id": 41989632, "comment_id": 71194880, "body": "Thanks a lot @Mat&#39;s Mug, I have to admit that I need to learn more about object propertys and instance ans I will include your closing method to my code. As for the dictionary I was using late binding because i read that it was more robust for multi-user purpose"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 135, "user_id": 7502463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820415bebe0ed17ba720335a5d9cb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/7502463/gab"}, "edited": false, "score": 1, "creation_date": 1486060352, "post_id": 41989632, "comment_id": 71195020, "body": "Late binding will load the last installed version of a given library, so if you early-bind to <i>SomeRandomLibrary v2.4</i> and a user has v2.6 installed, the binding will fail because early binding is version-specific. The scripting library hasn&#39;t had an update this century though, and isn&#39;t likely to get one either."}, {"owner": {"reputation": 135, "user_id": 7502463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820415bebe0ed17ba720335a5d9cb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/7502463/gab"}, "edited": false, "score": 0, "creation_date": 1486060770, "post_id": 41989632, "comment_id": 71195250, "body": "Also, shouldn&#39;t I make <code>Public DictOption As Object</code> instead of  <code>Private DicOption As Object</code> so it will be available for other forms/subs? Do I have to initializing and terminate in all form that uses DicOption? Or are you sugesting that intitialize and terminate goes in my general module and not my &#39;&#39;form&#39;&#39; module?  Thanks in advance"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 135, "user_id": 7502463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820415bebe0ed17ba720335a5d9cb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/7502463/gab"}, "edited": false, "score": 0, "creation_date": 1486060906, "post_id": 41989632, "comment_id": 71195318, "body": "I have a personal vendetta against exposing public fields on objects; if it&#39;s <code>Public</code>, then anyone outside the module can just <code>Set frm.DicOptions = Nothing</code> and wreck everything. I&#39;d expose a <code>Public Property Get GetOption(ByVal name As String) As String</code> that returns the dictionary value at the specified key. That way code outside the form simply cannot <code>Set</code> that reference in any way, and can still read every value from it."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 135, "user_id": 7502463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820415bebe0ed17ba720335a5d9cb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/7502463/gab"}, "edited": false, "score": 0, "creation_date": 1486061161, "post_id": 41989632, "comment_id": 71195441, "body": "@GabrielH&#233;bertMaheu <code>UserForm_Initialize</code> and <code>UserForm_Terminate</code> are handlers that can only exist in the form&#39;s code-behind."}, {"owner": {"reputation": 135, "user_id": 7502463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820415bebe0ed17ba720335a5d9cb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/7502463/gab"}, "edited": false, "score": 0, "creation_date": 1486071262, "post_id": 41989632, "comment_id": 71200956, "body": "That seems neat, but it works well with a public object for now. I will try to learn more on property soon, but I need to speed up with my work. I will check mark your answer  since the code you have posted is working. Hope it can help other users also. Thanks again!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 135, "user_id": 7502463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820415bebe0ed17ba720335a5d9cb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/7502463/gab"}, "edited": false, "score": 0, "creation_date": 1486071427, "post_id": 41989632, "comment_id": 71201054, "body": "Of course it works with a public field - the problem is that it&#39;s easy to later introduce bugs by accessing that field in a way it wasn&#39;t <i>meant</i> to be used, e.g. <code>Set frm.DicOptions = New Dictionary</code> or <code>Set frm.DicOptions = Nothing</code>, 6 months down the line, by future you, or by future maintainer; a read-only property makes that kind of misuse impossible, and conveys <i>intent</i> more explicitly - <i>that&#39;s</i> the difference! ;-)"}, {"owner": {"reputation": 135, "user_id": 7502463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820415bebe0ed17ba720335a5d9cb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/7502463/gab"}, "edited": false, "score": 0, "creation_date": 1486667925, "post_id": 41989632, "comment_id": 71456329, "body": "@ Mat&#39;s Mug , I finally got time to learn about property and class module, (as userform are a class module from my understanding). I find it nice to have a <code>Public Property Get GetOption(ByVal name As String) As String</code> but I can&#39;t figure how to make a new entry in the dictionnary with the  <code>Property Let</code> since I need two value for that : the key and the item. I need to add several new key and item in other userform to this dictionary. Do you know a solution for this?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 135, "user_id": 7502463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820415bebe0ed17ba720335a5d9cb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/7502463/gab"}, "edited": false, "score": 0, "creation_date": 1486668076, "post_id": 41989632, "comment_id": 71456426, "body": "Your <code>Property Let</code> member can have as many parameters as you need. <code>Public Property Let SetOption(ByVal name As String, ByVal value As String)</code> - as long as the last parameter is the same type as the property itself. Such properties are called &quot;indexed properties&quot;"}, {"owner": {"reputation": 135, "user_id": 7502463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820415bebe0ed17ba720335a5d9cb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/7502463/gab"}, "edited": false, "score": 0, "creation_date": 1486668289, "post_id": 41989632, "comment_id": 71456546, "body": "That is fine because i am using string for keys and item. How can i use this property then <code>Userform.GetOption = Cells(i, 10).Value</code>  + <code>Cells(i, 2).Value</code>??? (to add a new key/item to the dictionary)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 135, "user_id": 7502463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820415bebe0ed17ba720335a5d9cb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/7502463/gab"}, "edited": false, "score": 0, "creation_date": 1486668394, "post_id": 41989632, "comment_id": 71456609, "body": "Ah, sorry for the confusion - the property name must be the same for both <code>Let</code> and <code>Get</code> members, I&#39;d call it <code>Options</code>. So you &quot;get&quot; with <code>foo = theForm.Options(&quot;key&quot;)</code> and you &quot;let&quot; with <code>theForm.Options(&quot;key&quot;) = foo</code>."}, {"owner": {"reputation": 135, "user_id": 7502463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820415bebe0ed17ba720335a5d9cb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/7502463/gab"}, "edited": false, "score": 0, "creation_date": 1486672217, "post_id": 41989632, "comment_id": 71458864, "body": "This is ok to enter a new item value. I am trying to figure out how to enter a new &quot;key&quot; with property but my brain is going in infinite loop ... (i need to check if key already exist to avoid error)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 135, "user_id": 7502463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820415bebe0ed17ba720335a5d9cb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/7502463/gab"}, "edited": false, "score": 0, "creation_date": 1486672624, "post_id": 41989632, "comment_id": 71459119, "body": "Implement the logic for that in the <code>Property Let</code> member, which <i>has</i> both the <code>key</code> and <code>value</code> parameters you need."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1506029230, "last_edit_date": 1506029230, "creation_date": 1485982673, "answer_id": 41989632, "question_id": 41989199, "link": "https://stackoverflow.com/questions/41989199/vba-using-a-dictionary-outside-of-a-userform/41989632#41989632", "title": "VBA: using a dictionary outside of a userform", "body": "<pre><code>Public Sub ExchangeToDicOption()\n\nStatic DicOption As Object\n</code></pre>\n\n<p>The <code>DicOption</code> object variable is in <em>local scope</em> - it only ever exists inside the <code>ExchangeToDicOption</code> procedure.</p>\n\n<p>This line in <code>UserForm_Initialize</code>:</p>\n\n<pre><code>opt = DicOption(Creation_step)\n</code></pre>\n\n<p>Looks like it's trying to access a variable declared in another scope. <strong>It can't.</strong></p>\n\n<p>Specify <code>Option Explicit</code> at the top of your modules; that form stops compiling. Or, <strong>if</strong> there's another <code>DicOption</code> variable in module-scope (declared at the top of the module, above the procedures), then the <code>DicOption</code> that's local to <code>ExchangeToDicOption</code> is <em>hiding</em> it (VBA resolves calls to <code>DicOption</code> to the local declaration, not the module-level one). Remove the <code>Static DicOption As Object</code> declaration.</p>\n\n<p>Since you have two procedures that need to access the same object, you need to declare that object at module level.</p>\n\n<pre><code>Option Explicit\nPrivate DicOption As Object\n\nPrivate Sub UserForm_Initialize()\n    Set DicOption = CreateObject(\"Scripting.Dictionary\")\nEnd Sub\n\nPrivate Sub UserForm_Terminate()\n    Set DicOption = Nothing\nEnd Sub\n\nPublic Sub ExchangeToDicOption()\n    DicOption.RemoveAll\n    LR = Rg.Find(What:=\"*\", Lookat:=xlPart, LookIn:=xlFormulas, SearchOrder:=xlByRows, _\n        SearchDirection:=xlPrevious, MatchCase:=False).Row\n\n    If LR &gt; 1 Then\n        For i = 2 To LR\n            DicOption.Add key:=Cells(i, 1).Value, Item:=Cells(i, 2).Value\n        Next i\n    End If\nEnd Sub\n</code></pre>\n\n<p>Now, not sure why you're late-binding to a library that's standard-installed on any Windows box since 1998... but that's another issue.</p>\n\n<p>By initializing the instance in <code>UserForm_Initialize</code> and killing it in <code>UserForm_Terminate</code>, you're ensuring to have a non-null object reference for the entire lifetime of the <code>UserForm</code> object instance.</p>\n"}], "owner": {"reputation": 135, "user_id": 7502463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820415bebe0ed17ba720335a5d9cb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/7502463/gab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 555, "favorite_count": 0, "accepted_answer_id": 41989632, "answer_count": 1, "score": 1, "last_activity_date": 1506029230, "creation_date": 1485981126, "last_edit_date": 1531164843, "question_id": 41989199, "link": "https://stackoverflow.com/questions/41989199/vba-using-a-dictionary-outside-of-a-userform", "title": "VBA: using a dictionary outside of a userform", "body": "<p>I am new to vba so I might have missed something.</p>\n\n<p>I am filling a dictionary <code>DicOption</code> in a sub from a Module.\nThis is the sub:</p>\n\n<pre><code>Public Sub ExchangeToDicOption()\n\nStatic DicOption As Object\nDim LR As Long\nDim Rg As Range\nDim ws As Worksheet\nDim i As Long\nSet ws = ActiveWorkbook.Worksheets(2)\nSet Rg = ws.Columns(2)\n\nIf Not DicOption Is Nothing Then\n    DicOption.RemoveAll\nEnd If\n\n\n    LR = Rg.Find(What:=\"*\", Lookat:=xlPart, LookIn:=xlFormulas, SearchOrder:=xlByRows, _\n        SearchDirection:=xlPrevious, MatchCase:=False).Row\n\n    Set DicOption = CreateObject(\"Scripting.Dictionary\")\n\n    If LR &gt; 1 Then\n        For i = 2 To LR\n            DicOption.Add key:=Cells(i, 1).Value, Item:=Cells(i, 2).Value\n        Next i\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>But the dictionary seems to empty itself when it finishes its process.I am calling the sub <code>ExchangeToDicOption</code> in UserForm_Initialize. Creation_step is a key in <code>DicOption</code>.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\nDim control As control\nDim opt As String\n\nCall ExchangeToDicOption\n\nopt = DicOption(Creation_step)\nWith UBidStatus\n    Select Case opt\n        Case Is &gt; 0\n            For Each control In UBidStatus.Controls\n                control.Enabled = False\n            Next control\n            With UBidStatus\n                .Image4.Enabled = True\n                .LProject.Enabled = True\n                .LClient.Enabled = True\n                .Label6.Enabled = True\n                .Label7.Enabled = True\n                .IProjectinfoNOK.Enabled = True\n                .IProjectinfoOK.Enabled = True\n                .LProjectinfo.Enabled = True\n                .CBProjectinfo.Enabled = True\n                .IProjectinfoNOK.Visible = True\n                .IProjectinfoOK.Visible = False\n            End With\nect....\n</code></pre>\n\n<p>I also tried to use <code>Public DicOption as Object</code> as a global variable (before all my subs in Module edit window) but it didn't work either.\nThank you for your help!!</p>\n"}, {"tags": ["vba", "excel", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 7043384, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kEiiQwcbE3M/AAAAAAAAAAI/AAAAAAAAGpc/oNccSOSOsGw/photo.jpg?sz=128", "display_name": "Benjamin", "link": "https://stackoverflow.com/users/7043384/benjamin"}, "is_accepted": false, "score": 0, "last_activity_date": 1486008456, "creation_date": 1486008456, "answer_id": 41994036, "question_id": 41988936, "link": "https://stackoverflow.com/questions/41988936/how-to-paste-images-from-excel-to-powerpoint-vba-without-using-select-method/41994036#41994036", "title": "How to paste images from Excel to PowerPoint VBA without using .Select method", "body": "<p>Good call on avoiding \"selecting\" the object. The only time I really ever select is when I am intentionally directing the user to a tab/cell.</p>\n\n<p>So how about this:</p>\n\n<pre><code>Dim s As Shape\nDim ws As Worksheet\n\nSet ws = ThisWorkbook.Worksheets(\"IMG\")\nSet s = ws.Shapes(\"Picture 1\")\n\ns.Copy\n</code></pre>\n\n<p>And of course you could loop through each shape on the worksheet:</p>\n\n<pre><code>for each s in ws.shapes\n  debug.print s.name\n  s.copy\n  'Code for pasting the image\nnext s\n</code></pre>\n\n<p>Good luck! Hope it helps!</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 7406478, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c7c176b41a382877e7aa1760be5b08b3?s=128&d=identicon&r=PG&f=1", "display_name": "thePB", "link": "https://stackoverflow.com/users/7406478/thepb"}, "edited": false, "score": 0, "creation_date": 1486044892, "post_id": 41995440, "comment_id": 71184916, "body": "Thanks. It was helpful. But the only thing is that the positioning doesnt work ith the &quot;With &quot; funtion. dont know why"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 31, "user_id": 7406478, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c7c176b41a382877e7aa1760be5b08b3?s=128&d=identicon&r=PG&f=1", "display_name": "thePB", "link": "https://stackoverflow.com/users/7406478/thepb"}, "edited": false, "score": 0, "creation_date": 1486045037, "post_id": 41995440, "comment_id": 71185018, "body": "you copied my entire code and the positioning doesn&#39;t work ? are you getting an error ? or it&#39;s not re-positioning ?"}, {"owner": {"reputation": 31, "user_id": 7406478, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c7c176b41a382877e7aa1760be5b08b3?s=128&d=identicon&r=PG&f=1", "display_name": "thePB", "link": "https://stackoverflow.com/users/7406478/thepb"}, "edited": false, "score": 0, "creation_date": 1486061960, "post_id": 41995440, "comment_id": 71195896, "body": "No, i copied your code for the images of my code (which is a long code and has other things that could affect this) . it didnt give me an error but when i opened the ppt the image was not positioned"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 31, "user_id": 7406478, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c7c176b41a382877e7aa1760be5b08b3?s=128&d=identicon&r=PG&f=1", "display_name": "thePB", "link": "https://stackoverflow.com/users/7406478/thepb"}, "edited": false, "score": 0, "creation_date": 1486062099, "post_id": 41995440, "comment_id": 71195981, "body": "@thePB  can u share the rest of your code ? I used this code and it worked. It puts the a small image at the top of the slide. You know it&#39;s 72 points to an inch?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 31, "user_id": 7406478, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c7c176b41a382877e7aa1760be5b08b3?s=128&d=identicon&r=PG&f=1", "display_name": "thePB", "link": "https://stackoverflow.com/users/7406478/thepb"}, "edited": false, "score": 0, "creation_date": 1486279804, "post_id": 41995440, "comment_id": 71271667, "body": "@thePB I can&#39;t see in your edited code the part <code>Set myPic = pptSlide.Shapes.PasteSpecial(ppPasteMetafilePicture, msoFalse)</code> , did you copy this line after you copy <code>Sheets(&quot;IMG&quot;).Shapes(&quot;Picture 1&quot;).Copy</code> ?"}, {"owner": {"reputation": 31, "user_id": 7406478, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c7c176b41a382877e7aa1760be5b08b3?s=128&d=identicon&r=PG&f=1", "display_name": "thePB", "link": "https://stackoverflow.com/users/7406478/thepb"}, "edited": false, "score": 0, "creation_date": 1486379943, "post_id": 41995440, "comment_id": 71304308, "body": "no, this is my actual working code, with your edit the positioning doesnt work."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1486016801, "last_edit_date": 1486016801, "creation_date": 1486016373, "answer_id": 41995440, "question_id": 41988936, "link": "https://stackoverflow.com/questions/41988936/how-to-paste-images-from-excel-to-powerpoint-vba-without-using-select-method/41995440#41995440", "title": "How to paste images from Excel to PowerPoint VBA without using .Select method", "body": "<p>Use the code below to copy an Image from Excel worksheet (without <code>Select</code>ing it), and paste it to a PowerPoint Slide.</p>\n\n<p><em>Note</em>: I assume the part you set-up your PowerPoint presentation, and setting <code>pptSlide</code>  works for you, and the only thing left is <strong>Copy >> Paste</strong> the image.</p>\n\n<p><strong>Code</strong>    </p>\n\n<pre><code>Option Explicit\n\nSub CopyPic_to_PPT()\n\nDim pptSlide As PowerPoint.Slide\nDim myPic   As Object                                                     \n\nSheets(\"IMG\").Shapes(\"Picture 1\").Copy '&lt;-- copy the \"Picture 1\" image from \"IMG\" worksheet\n\n' set myPic to current pasted shape in PowerPoint\nSet myPic = pptSlide.Shapes.PasteSpecial(ppPasteMetafilePicture, msoFalse)\n\n' modify current pic setting\nWith myPic\n    .Width = 121\n    .Height = 51\n    .Left = 580\n    .Top = 3\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><strong>Extra</strong> (the safer mode): If you want to loop through all <code>Shapes</code> in \"IMG\" worksheet, check each shape's name if it's \"Picture 1\", and only then copy this Shape to PowerPoint Slide, then use also the piece of code below: </p>\n\n<pre><code>Dim CurShape As Object\n\n' loop through all shapes in \"IMG\" worksheet\nFor Each CurShape In Sheets(\"IMG\").Shapes\n    If CurShape.Name Like \"Picture 1\" Then ' if current shape's name = \"Picture 1\", then copy\n        CurShape.Copy\n        Exit For\n    End If\nNext CurShape\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7406478, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c7c176b41a382877e7aa1760be5b08b3?s=128&d=identicon&r=PG&f=1", "display_name": "thePB", "link": "https://stackoverflow.com/users/7406478/thepb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4758, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1486063656, "creation_date": 1485980312, "last_edit_date": 1486063656, "question_id": 41988936, "link": "https://stackoverflow.com/questions/41988936/how-to-paste-images-from-excel-to-powerpoint-vba-without-using-select-method", "title": "How to paste images from Excel to PowerPoint VBA without using .Select method", "body": "<p>I am writing a code that creates a PowerPoint from Excel VBA, using data from the Excel document. In this document, i have a Sheet called IMG where there is a series of images named \"Picture X\", X being the number of the current picture. The code I have for copying these pictures and pasting them on their respective PowerPoint Slide uses the .Select method, which, according to what I have read around here, makes the code run slower, and can/must be avoidable. I want to know if it is possible to avoid using the \".Select\" method and still be able to paste the images from the excel sheet.</p>\n\n<p>The code I am using is:</p>\n\n<pre><code>Dim pptSlide As PowerPoint.Slide\n\nSheets(\"IMG\").Select\n    ActiveSheet.Shapes.Range(Array(\"Picture 1\")).Select\n    Selection.Copy\n\npptSlide.Shapes.PasteSpecial(ppPasteMetafilePicture).Select\npptSlide.Shapes(4).Width = 121\npptSlide.Shapes(4).Height = 51\npptSlide.Shapes(4).Left = 580\npptSlide.Shapes(4).Top = 3\n</code></pre>\n\n<p>Thanks </p>\n\n<p>Rest of my code:</p>\n\n<pre><code>Dim pptApp As PowerPoint.Application\nDim pptPres As PowerPoint.Presentation\nDim pptSlide As PowerPoint.Slide\nDim pptShape As PowerPoint.Shape\nDim excelTable As Excel.Range\nDim SlideTitle As String\nDim SlideText As String\nDim SlideObject As Object\nDim pptTextbox As PowerPoint.Shape\nDim SlideNumber As String\nDim myPic As Object\n\n\n\nOn Error Resume Next\nSet pptApp = New PowerPoint.Application\n\n\nSet pptPres = pptApp.Presentations.Add\npptPres.PageSetup.SlideSize = ppSlideSizeOnScreen\npptPres.ApplyTemplate \"c:\\Program Files\\Microsoft Office\\Templates\\1033\\Blank.potx\"\n\npptPres.PageSetup.FirstSlideNumber = 0\n\n''Consolidados\nSet excelTable1 = Worksheets(\"TDCSD\").Range(\"N280:U287\")\nSet excelTable2 = Worksheets(\"TDEXITO\").Range(\"N48:U55\")\nSet excelTable3 = Worksheets(\"TDGPA\").Range(\"N81:U88\")\nSet excelTable4 = Worksheets(\"TDSACI\").Range(\"N234:U241\")\nSet excelTable5 = Worksheets(\"TDSMU\").Range(\"N47:U54\")\nSet excelTable6 = Worksheets(\"TDRPLY\").Range(\"N76:U83\")\nSet excelTable7 = Worksheets(\"TDInR\").Range(\"N44:U51\")\nSet excelTable8 = Worksheets(\"TDPA\").Range(\"N59:U66\")\nSet excelTable9 = Worksheets(\"TDIRSA\").Range(\"N31:U38\")\nSet excelTable10 = Worksheets(\"TCOM\").Range(\"Q8:AC17\")\nSet excelTable11 = Worksheets(\"TCOM\").Range(\"Q24:AC33\")\n\n\n'SLIDES\n\n'Slide 0\n\nSet pptSlide = pptPres.Slides.Add(1, ppLayoutTitle)\n\nSlideTitle = ThisWorkbook.Sheets(\"PPT\").Range(\"F7\").Value\npptSlide.Shapes(1).TextFrame.TextRange.Text = SlideTitle\n\npptSlide.Shapes.Title.TextFrame.TextRange.Characters(Start:=36, Length:=65).Font.Size = 20\npptSlide.Shapes.Title.Width = 610\n\npptSlide.Shapes(2).TextFrame.TextRange.Text = ThisWorkbook.Sheets(\"PPT\").Range(\"B7\").Value\n\n'Agregar el n\u00famero de diapositiva en la esquina derecha:\nSet pptTextbox = pptSlide.Shapes.AddTextbox( _\n    msoTextOrientationHorizontal, 686, 510, 34, 29)\n\nWith pptTextbox.TextFrame\n    .TextRange.InsertSlideNumber\n    .TextRange.Font.Size = 8\n    .TextRange.Font.Name = \"Tahoma\"\n    .TextRange.Font.Color = RGB(137, 137, 137)\n    .VerticalAnchor = msoAnchorMiddle\nEnd With\n\n\n\n'Slide 1:\n\nSet pptSlide = pptPres.Slides.Add(2, ppLayoutCustom)\nSlideTitle = \"Introducci\u00f3n\"\npptSlide.Shapes.Title.TextFrame.TextRange.Text = SlideTitle\npptSlide.Shapes.Title.TextFrame.TextRange.Font.Size = 22\n\n\nSet pptTextbox = pptSlide.Shapes(1)\n\npptTextbox.TextFrame.TextRange.Text = ThisWorkbook.Sheets(\"PPT\").Range(\"B11\").Value\npptTextbox.Top = 88\npptTextbox.TextFrame.TextRange.Paragraphs.ParagraphFormat.Alignment = ppAlignJustify\n\n'Agregar el n\u00famero de diapositiva:\nSet pptTextbox = pptSlide.Shapes.AddTextbox( _\n    msoTextOrientationHorizontal, 686, 510, 34, 29)\n\nWith pptTextbox.TextFrame\n    .TextRange.InsertSlideNumber\n    .TextRange.Font.Size = 8\n    .TextRange.Font.Name = \"Tahoma\"\n    .TextRange.Font.Color = RGB(137, 137, 137)\n    .VerticalAnchor = msoAnchorMiddle\nEnd With\n\n\n\n\n'Slide 2:\nSet pptSlide = pptPres.Slides.Add(3, ppLayoutTitleOnly)\nSlideTitle = \"Agenda\"\npptSlide.Shapes.Title.TextFrame.TextRange.Text = SlideTitle\npptSlide.Shapes.Title.TextFrame.TextRange.Font.Size = 22\n\nSet pptTextbox = pptSlide.Shapes.AddTextbox( _\n    msoTextOrientationHorizontal, 686, 510, 34, 29)\n\nWith pptTextbox.TextFrame\n    .TextRange.InsertSlideNumber\n    .TextRange.Font.Size = 8\n    .TextRange.Font.Name = \"Tahoma\"\n    .TextRange.Font.Color = RGB(137, 137, 137)\n    .VerticalAnchor = msoAnchorMiddle\nEnd With\n\n\n'Slide 3:\n''Crear Slide y a\u00f1adir t\u00edtulo\nSet pptSlide = pptPres.Slides.Add(4, ppLayoutCustom)\nSlideTitle = \"Noticias Relevantes\"\npptSlide.Shapes.Title.TextFrame.TextRange.Text = SlideTitle\npptSlide.Shapes.Title.TextFrame.TextRange.Font.Size = 22\n\n''Insertar el texto desde Excel\nSet pptTextbox = pptSlide.Shapes(1)\n\npptTextbox.TextFrame.TextRange.Text = ThisWorkbook.Sheets(\"PPT\").Range(\"B24\").Value\npptTextbox.Top = 68.8\npptTextbox.TextFrame.TextRange.Paragraphs.ParagraphFormat.Alignment = ppAlignJustify\n\n''A\u00f1adir n\u00famero de Slide\nSet pptTextbox = pptSlide.Shapes.AddTextbox( _\n    msoTextOrientationHorizontal, 686, 510, 34, 29)\n\nWith pptTextbox.TextFrame\n    .TextRange.InsertSlideNumber\n    .TextRange.Font.Size = 8\n    .TextRange.Font.Name = \"Tahoma\"\n    .TextRange.Font.Color = RGB(137, 137, 137)\n    .VerticalAnchor = msoAnchorMiddle\nEnd With\n\n'A\u00f1adir imagenes\n'Falabella\nSheets(\"IMG\").Shapes(\"Picture 1\").Copy\npptSlide.Shapes.PasteSpecial(ppPasteMetafilePicture).Select\npptSlide.Shapes(4).Width = 121\npptSlide.Shapes(4).Height = 51\npptSlide.Shapes(4).Left = 579.4\npptSlide.Shapes(4).Top = 3.4\n\n\n'Slide 4:\n''Crear Slide y a\u00f1adir el t\u00edtulo\nSet pptSlide = pptPres.Slides.Add(5, ppLayoutCustom)\nSlideTitle = \"Noticias Relevantes\"\npptSlide.Shapes.Title.TextFrame.TextRange.Text = SlideTitle\npptSlide.Shapes.Title.TextFrame.TextRange.Font.Size = 22\n\n''A\u00f1adir texto\nSet pptTextbox = pptSlide.Shapes(1)\n\npptTextbox.TextFrame.TextRange.Text = ThisWorkbook.Sheets(\"PPT\").Range(\"B49\").Value\npptTextbox.Top = 77\npptTextbox.TextFrame.TextRange.Paragraphs.ParagraphFormat.Alignment = ppAlignJustify\n\n''A\u00f1adir n\u00famero de Slide\nSet pptTextbox = pptSlide.Shapes.AddTextbox( _\n    msoTextOrientationHorizontal, 686, 510, 34, 29)\n\nWith pptTextbox.TextFrame\n    .TextRange.InsertSlideNumber\n    .TextRange.Font.Size = 8\n    .TextRange.Font.Name = \"Tahoma\"\n    .TextRange.Font.Color = RGB(137, 137, 137)\n    .VerticalAnchor = msoAnchorMiddle\nEnd With\n\n''A\u00f1adir imagenes\n'Grupo \u00c9xito\nSheets(\"IMG\").Shapes(\"Picture 2\").Copy\n\npptSlide.Shapes.PasteSpecial (ppPasteMetafilePicture)\npptSlide.Shapes(4).Width = 108\npptSlide.Shapes(4).Height = 65\npptSlide.Shapes(4).Left = 592\npptSlide.Shapes(4).Top = 1.42\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 4, "creation_date": 1485979534, "post_id": 41988620, "comment_id": 71154812, "body": "It&#39;s just - <code>Case &quot;Same&quot;</code>"}, {"owner": {"reputation": 3, "user_id": 7471085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9457e2780ef4053d960181c7cb9d6e2e?s=128&d=identicon&r=PG&f=1", "display_name": "David Redford", "link": "https://stackoverflow.com/users/7471085/david-redford"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1485980184, "post_id": 41988620, "comment_id": 71155148, "body": "I still get the same error with Case &quot;Same&quot;"}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1485980530, "post_id": 41988620, "comment_id": 71155352, "body": "you need to remove the Case Is = &quot;&quot; to Case &quot;&quot;"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1485980531, "post_id": 41988620, "comment_id": 71155355, "body": "Any error values in those cells?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1485980808, "post_id": 41988620, "comment_id": 71155481, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/21409396/type-mismatch-error-when-iterating-over-cells-in-a-range\">Type mismatch error when iterating over cells in a range</a>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1485981012, "post_id": 41988620, "comment_id": 71155591, "body": "@TimWilliams - <code>Case &quot;xyz&quot;</code> is just shorthand for the fully expanded <code>Case Is = &quot;xyz&quot;</code> - both are legal.  AFAIK &quot;Is =&quot; is just the default operation."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1485981215, "post_id": 41988620, "comment_id": 71155697, "body": "@YowE3K agreed. It&#39;s overly verbose and awkward though. Anyway, this question is a dupe, OP needs to wrap their <code>Select Case</code> block with an <code>If Not IsError(cell.Value) Then</code>  check."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1485981518, "post_id": 41988620, "comment_id": 71155857, "body": "@Mat&#39;sMug - or include a <code>Case CVErr(xlErrNA)</code> (etc) condition prior to getting to a condition where it needs to cast the <code>Variant&#47;Error</code> to a <code>String</code>"}, {"owner": {"reputation": 3, "user_id": 7471085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9457e2780ef4053d960181c7cb9d6e2e?s=128&d=identicon&r=PG&f=1", "display_name": "David Redford", "link": "https://stackoverflow.com/users/7471085/david-redford"}, "edited": false, "score": 0, "creation_date": 1485983570, "post_id": 41988620, "comment_id": 71157018, "body": "Turns out there was an error in my ranges. I no longer get the Error Mismatch, but now it wont&#39; color any of the cells &quot;Same&quot; to what I have. The macro kinda just runs flat."}], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1486022642, "creation_date": 1486022642, "answer_id": 41997001, "question_id": 41988620, "link": "https://stackoverflow.com/questions/41988620/error-mismatch-13-on-case-range/41997001#41997001", "title": "Error Mismatch 13 on Case &amp; Range", "body": "<p>you may be experiencing some \"case\" issue </p>\n\n<p>in that case you could use:</p>\n\n<pre><code>    Select Case UCase(cell.Value) '&lt;--| consider the UPPERCASE string of your current cell value\n        Case \"SAME\" '&lt;---| and compare it against \"SAME\"\n            cell.Interior.ColorIndex = 46\n        Case \"\"\n        Case Else\n    End Select\n</code></pre>\n\n<p>furthermore you may want to use a more concise <code>CellRange</code> setting and a more efficient way of looping through cells with \"text\" values only</p>\n\n<pre><code>Sub DifferenceReport()\n    Dim CellRange As Range, cell As Range\n\n    With Sheets(\"Difference\")\n        Set CellRange = Intersect(.Range(\"G3:AI200\"), .Range(\"G:G, H:H, K:K, N:N, Q:Q, T:T, Z:Z, AC:AC, AF:AF, AI:AI\"))\n    End With\n\n    For Each cell In CellRange.SpecialCells(xlCellTypeConstants, xlTextValues)\n        Select Case UCase(cell.Value)\n            Case \"SAME\"\n                cell.Interior.ColorIndex = 46\n            Case \"\"\n            Case Else\n        End Select\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7471085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9457e2780ef4053d960181c7cb9d6e2e?s=128&d=identicon&r=PG&f=1", "display_name": "David Redford", "link": "https://stackoverflow.com/users/7471085/david-redford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1486022642, "creation_date": 1485979264, "last_edit_date": 1485979863, "question_id": 41988620, "link": "https://stackoverflow.com/questions/41988620/error-mismatch-13-on-case-range", "title": "Error Mismatch 13 on Case &amp; Range", "body": "<p>I basically want to do some formatting via VBA based on certain criteria. For reasons, I need to avoid conditional formatting.</p>\n\n<p>I keep getting this error message and this row is highlighted...\n\"Case Is = \"Same\"\"</p>\n\n<p>The code works for like half of two columns and gives this error. What can I do to apply this to my ranges?</p>\n\n<pre><code>Sub DifferenceReport()\n\n        Dim c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, CellRange As Range\n        Set c1 = Sheets(\"Difference\").Range(\"G3:G200\")\n        Set c2 = Sheets(\"Difference\").Range(\"H3:H200\")\n        Set c3 = Sheets(\"Difference\").Range(\"K3:K200\")\n        Set c4 = Sheets(\"Difference\").Range(\"N3:N200\")\n        Set c5 = Sheets(\"Difference\").Range(\"Q3:Q200\")\n        Set c6 = Sheets(\"Difference\").Range(\"T3:T200\")\n        Set c7 = Sheets(\"Difference\").Range(\"Z3:Z200\")\n        Set c8 = Sheets(\"Difference\").Range(\"AC3:AC200\")\n        Set c9 = Sheets(\"Difference\").Range(\"AF3:AF200\")\n        Set c10 = Sheets(\"Difference\").Range(\"AI3:AI200\")\n        Set CellRange = Union(c1, c2, c3, c4, c5, c6, c7, c8, c9, c10)\n\n        For Each cell In CellRange\n            Select Case cell.Value\n                Case Is = \"Same\"\n                    cell.Interior.ColorIndex = 46\n                Case Is = \"\"\n                Case Else\n            End Select\n        Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1485976830, "post_id": 41987873, "comment_id": 71153350, "body": "Just use the variables <code>DetailONW.Offset(3, 0).Resize(300, 0)</code> and so on."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1485976887, "post_id": 41987873, "comment_id": 71153377, "body": "Also FWIW <code>Dim OntarioWestDet, OntarioEastDet, WestDet, QuebecDet As Range</code> only sets the last as a range and the rest as variants.  You need to do it one at a time: <code>Dim OntarioWestDet As Range, OntarioEastDet As Range, WestDet As Range, QuebecDet As Rang</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1485977003, "post_id": 41987873, "comment_id": 71153447, "body": "also FWIW, these are not &quot;Named Ranges&quot;.   They are range variables.  A named range is different and is tied to the workbook and thus is saved with the workbook."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1485977300, "post_id": 41987873, "comment_id": 71153609, "body": "In addition to @ScottCraner&#39;s points, I don&#39;t think the column parameter of &#39;Resize&#39; can be zero so just omit, or use 1."}, {"owner": {"reputation": 11, "user_id": 7431724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/484b0965f2f7b37c82406bb469ca7be6?s=128&d=identicon&r=PG&f=1", "display_name": "user7431724", "link": "https://stackoverflow.com/users/7431724/user7431724"}, "edited": false, "score": 0, "creation_date": 1485978345, "post_id": 41987873, "comment_id": 71154163, "body": "Even if I change the second section to: Dim OntarioWestDet As Range, OntarioEastDet As Range, WestDet As Range, QuebecDet As Range Set OntarioWestDet = DetailONW.Offset(3).Resize(300, 1) it still gives me the same object error. Even if I change Resize(300,1) to Resize(300)."}, {"owner": {"reputation": 11, "user_id": 7431724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/484b0965f2f7b37c82406bb469ca7be6?s=128&d=identicon&r=PG&f=1", "display_name": "user7431724", "link": "https://stackoverflow.com/users/7431724/user7431724"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1485978698, "post_id": 41987873, "comment_id": 71154353, "body": "Sorry - I&#39;m new to this website so I&#39;m not sure how to make my code appear as code in a comment. @Scott"}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 1, "last_activity_date": 1485981254, "creation_date": 1485981254, "answer_id": 41989226, "question_id": 41987873, "link": "https://stackoverflow.com/questions/41987873/define-a-range-using-an-existing-named-range-offset-resize/41989226#41989226", "title": "Define a range using an existing named range &amp; offset/resize", "body": "<p>This works for me (there is a typo in one of your names</p>\n\n<pre><code>Sub x()\n\nDim DetailONE As Range, DetailONW As Range, DetailW As Range, DetailQc As Range\nSet DetailONE = Sheet11.Range(\"CM12:EG13\")\nSet DetailONW = Sheet11.Range(\"EI12:GC13\")\nSet DetailW = Sheet11.Range(\"GE12:HO13\")\nSet DetailQc = Sheet11.Range(\"HQ12:IT13\")\n\nDim OntarioWestDet As Range, OntarioEastDet As Range, WestDet As Range, QuebecDet As Range\nSet OntarioWestDet = DetailONW.Offset(3, 0).Resize(300)\nSet OntarioEastDet = DetailONE.Offset(3, 0).Resize(300)\nSet WestDet = DetailW.Offset(3, 0).Resize(300)\nSet QuebecDet = DetailQc.Offset(3, 0).Resize(300)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7431724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/484b0965f2f7b37c82406bb469ca7be6?s=128&d=identicon&r=PG&f=1", "display_name": "user7431724", "link": "https://stackoverflow.com/users/7431724/user7431724"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1067, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485981254, "creation_date": 1485976718, "last_edit_date": 1531164843, "question_id": 41987873, "link": "https://stackoverflow.com/questions/41987873/define-a-range-using-an-existing-named-range-offset-resize", "title": "Define a range using an existing named range &amp; offset/resize", "body": "<p>I am trying to use an existing named range to reference different rows (the columns should be the same). Right now I have the following:</p>\n\n<pre><code>Dim DetailONE, DetailONW, DetailW, DetailQc As Range\nSet DetailONE = Sheet11.Range(\"CM12:EG13\")\nSet DetailONW = Sheet11.Range(\"EI12:GC13\")\nSet DetailW = Sheet11.Range(\"GE12:HO13\")\nSet DetailQc = Sheet11.Range(\"HQ12:IT13\")\n</code></pre>\n\n<p>And then I refer to those named ranges but I get an Application defined or object defined error with the following. Does anyone know why? I don't know if I need the .Address part afterwards either or if I can forego this.</p>\n\n<pre><code>Dim OntarioWestDet, OntarioEastDet, WestDet, QuebecDet As Range\nSet OntarioWestDet = Sheet11.Range(DetailONW.Address).Offset(3, 0).Resize(300, 0)\nSet OntarioEastDet = Sheet11.Range(DetailONE).Offset(3, 0).Resize(300, 0)\nSet WestDet = Sheet11.Range(DetailWe).Offset(3, 0).Resize(300, 0)\nSet QuebecDet = Sheet11.Range(DetailQc).Offset(3, 0).Resize(300, 0)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 293, "user_id": 2449090, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/55a33a4cff4b3c1edb4fe043bfc01319?s=128&d=identicon&r=PG", "display_name": "Des Hutch", "link": "https://stackoverflow.com/users/2449090/des-hutch"}, "is_accepted": true, "score": 1, "last_activity_date": 1485988830, "creation_date": 1485988830, "answer_id": 41991183, "question_id": 41987787, "link": "https://stackoverflow.com/questions/41987787/reading-large-single-line-text-file/41991183#41991183", "title": "Reading large single line text file", "body": "<p>The best solution I came up with was to manipulate the data into a CSV file and have excel/VBA work with it from there. No issues once it had been converted.</p>\n"}], "owner": {"reputation": 293, "user_id": 2449090, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/55a33a4cff4b3c1edb4fe043bfc01319?s=128&d=identicon&r=PG", "display_name": "Des Hutch", "link": "https://stackoverflow.com/users/2449090/des-hutch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 41991183, "answer_count": 1, "score": 0, "last_activity_date": 1485988830, "creation_date": 1485976433, "last_edit_date": 1531164843, "question_id": 41987787, "link": "https://stackoverflow.com/questions/41987787/reading-large-single-line-text-file", "title": "Reading large single line text file", "body": "<p>I am attempting to read a large html table stored as a single line text file. The text is approx. 81.8 million characters long, around 80mb in size. I have tried the code below but it just hangs for a long time, too long for it to be usable. \nThe data inside is a standard html table construction. <code>&lt;table&gt;&lt;tr&gt;&lt;td&gt;sometext&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</code></p>\n\n<p>I cannot change the structure of the file at the source and so stuck with this. The data is to be parsed into a sheet. <code>&lt;tr&gt;</code> on new row and <code>&lt;td&gt;</code> in next cell etc which would occur after reading the text into a <code>MSHTML.Document</code> variable.</p>\n\n<p>Does anyone have a suggestion on how to handle this?</p>\n\n<pre><code>myFile = \"C:\\xxx\\xxx\\xxx\\xxx.txt\"\nOpen myFile For Input As #1\nLine Input #1, textline\nClose #1\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485976056, "post_id": 41987286, "comment_id": 71152937, "body": "Working fine for me (running Windows 7)."}], "answers": [{"tags": [], "owner": {"reputation": 377, "user_id": 6510076, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fa3859327cb7a1f6c90736fe01dd4451?s=128&d=identicon&r=PG&f=1", "display_name": "vivi11130704", "link": "https://stackoverflow.com/users/6510076/vivi11130704"}, "is_accepted": false, "score": 0, "last_activity_date": 1486574046, "creation_date": 1486574046, "answer_id": 42119535, "question_id": 41987286, "link": "https://stackoverflow.com/questions/41987286/vba-close-excel-file-get-subscript-out-of-range-error/42119535#42119535", "title": "VBA Close Excel File get subscript out of range error", "body": "<p>I managed to fix it - If I use </p>\n\n<p><code>FileFormat:=xlTextMSDOS</code> then everything works as expected.</p>\n"}], "owner": {"reputation": 377, "user_id": 6510076, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fa3859327cb7a1f6c90736fe01dd4451?s=128&d=identicon&r=PG&f=1", "display_name": "vivi11130704", "link": "https://stackoverflow.com/users/6510076/vivi11130704"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1486574046, "creation_date": 1485974608, "last_edit_date": 1485975214, "question_id": 41987286, "link": "https://stackoverflow.com/questions/41987286/vba-close-excel-file-get-subscript-out-of-range-error", "title": "VBA Close Excel File get subscript out of range error", "body": "<p>I'm running the below code and get the \"subscript out of range\" error on the workbook close line:</p>\n\n<pre><code>Sub SaveFileAs()\n    With Workbooks.Open(path &amp; \"\\\" &amp; filename).Worksheets(\"Sheet 1\")\n        .SaveAs path &amp; \"\\\" &amp; \"test.woe\", _\n                FileFormat:=xlTextWindows, _\n                CreateBackup:=False\n    End With\n\n    Workbooks(\"test.woe\").Close SaveChanges:=True\nEnd Sub\n</code></pre>\n\n<p>However if i change <code>FileFormat:=xlTextWindows</code> into <code>FileFormat:=xlTextMac</code>, then I can close the file. I'm using windows 10. Can anyone please explain why this happens?</p>\n"}, {"tags": ["database", "excel", "vba", "loops"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1485974615, "post_id": 41987234, "comment_id": 71152164, "body": "Is <code>i = i + 1 And q = 2</code> really meant to be a logical expression, or is this meant to be two statements, i.e. <code>i = i + 1: q = 2</code>?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1485974774, "post_id": 41987234, "comment_id": 71152245, "body": "<i>Nothing happens when I click the command button</i> - Have <i>you</i> tried to point out the error in your code by <a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">debugging</a> (running through the code line-by-line and seeing what results happen by checking variable values and such)."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1485974824, "post_id": 41987234, "comment_id": 71152265, "body": "Don&#39;t use a logical operator when you should use a statement separator."}, {"owner": {"reputation": 1029, "user_id": 1474994, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/rOT6j.png?s=128&g=1", "display_name": "UndeadBob", "link": "https://stackoverflow.com/users/1474994/undeadbob"}, "edited": false, "score": 0, "creation_date": 1485975289, "post_id": 41987234, "comment_id": 71152522, "body": "Create a <code>MessageBox</code> right after <code>Sub Button2_Click()</code> to make sure the script is running."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1485975433, "post_id": 41987234, "comment_id": 71152598, "body": "If <code>If Sheets(&quot;Sheet1&quot;).Range(&quot;A&quot; &amp; i).Value Like Sheets(&quot;Sheet2&quot;).Range(&quot;A&quot; &amp; q).Value Then</code> is always returning <code>False</code> we would need to see some sample data to work out why - can you post a screendump of the start of each of your two sheets.  (If you have any names, etc, then clear them out for privacy reasons, but &quot;ids&quot; should be safe to leave there for us to look at.)"}, {"owner": {"reputation": 1, "user_id": 7502150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a038a0e3f5adc28476c92b302f4f8c0?s=128&d=identicon&r=PG&f=1", "display_name": "xpes100", "link": "https://stackoverflow.com/users/7502150/xpes100"}, "edited": false, "score": 0, "creation_date": 1485975723, "post_id": 41987234, "comment_id": 71152763, "body": "Unfortunately, I cannot post the project Id information as that is private information, but I can explain the data some more. Column A on both sheets are 9 digit numbers formatted as numbers. The respective date columns are formatted as general text, in either Fall/Spring #### (ex. Fall 2012) format."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1485976017, "post_id": 41987234, "comment_id": 71152924, "body": "Are you sure that they are numbers?  Switch formatting to general and make sure leading zeroes disappear, or use a format of <code>&quot;#,##0&quot;</code> and make sure commas appear.  (P.S. Once you get past that line, your <code>.cell</code> methods will fail.  They should be the <code>.Cells</code> property.)  Why are you even using <code>Like</code> if they are 9 digit numbers, wouldn&#39;t you want to check for equality?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1485976165, "post_id": 41987234, "comment_id": 71152996, "body": "I was going to mention that your term format was wrong too, but it appears you have edited the question to fix that."}, {"owner": {"reputation": 1, "user_id": 7502150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a038a0e3f5adc28476c92b302f4f8c0?s=128&d=identicon&r=PG&f=1", "display_name": "xpes100", "link": "https://stackoverflow.com/users/7502150/xpes100"}, "edited": false, "score": 0, "creation_date": 1485976351, "post_id": 41987234, "comment_id": 71153093, "body": "Yes they are numbers, and I goofed on my lefts and rights. Fixed that in code already. The debugging has told me that the code can&#39;t get past the first if statement even though the project ids do match."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1485976679, "post_id": 41987234, "comment_id": 71153267, "body": "I&#39;m pretty sure <code>cell(i, x)</code> should be <code>Cells(i,x)</code>...You should be using <code>Cells()</code> after <code>Range()</code>, not <code>Cell()</code>, no?  Edit: Ah, @YowE3K already mentioned that :P"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1485976870, "post_id": 41987234, "comment_id": 71153368, "body": "I got through one test-case which worked, but then it goes into an infinite loop once the one case matched, because you don&#39;t increment either <code>i</code> or <code>q</code> after a successful match."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1485977607, "post_id": 41987234, "comment_id": 71153784, "body": "Sorry - I was wrong with my comment about q being both less than and greater than something - you were incrementing <code>q</code> between the two statements.  (It wouldn&#39;t have been right, but not for the reason I said.)"}, {"owner": {"reputation": 1, "user_id": 7502150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a038a0e3f5adc28476c92b302f4f8c0?s=128&d=identicon&r=PG&f=1", "display_name": "xpes100", "link": "https://stackoverflow.com/users/7502150/xpes100"}, "edited": false, "score": 0, "creation_date": 1485977933, "post_id": 41987234, "comment_id": 71153969, "body": "Any guesses on how long this code will run? It started after the last code edit I posted. It&#39;s 467 rows on Sheet 1 and 3422 on sheet 2."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1485978531, "post_id": 41987234, "comment_id": 71154250, "body": "I have put some refactored code as an &quot;answer&quot;.  It includes shifting the <code>Len(Worksheets(&quot;Sheet1&quot;).Cells(i, 4)) &lt; 12</code> test to earlier in the code (because there is no point searching Sheet2 at all if the Entry Date isn&#39;t valid on Sheet1)."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1485978902, "post_id": 41987234, "comment_id": 71154470, "body": "It now also includes reading the ids into arrays at the start of the code - that should improve the speed immensely."}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 1, "user_id": 7502150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a038a0e3f5adc28476c92b302f4f8c0?s=128&d=identicon&r=PG&f=1", "display_name": "xpes100", "link": "https://stackoverflow.com/users/7502150/xpes100"}, "edited": false, "score": 0, "creation_date": 1485991059, "post_id": 41987366, "comment_id": 71160316, "body": "@xpes100 - nothing happens at all? What if you step through the code with <code>F8</code>, you can hover the mouse over variables and see if it&#39;s updating them as you expect, or you can kind of &quot;trace&quot; where the macro is going wrong."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1485994296, "post_id": 41987366, "comment_id": 71161373, "body": "@BruceWayne - the OP&#39;s comment above is left over from my very first attempt at answering the question (i.e. when the code included <code>i = i + 1 And q = 2</code>).  Apparently the OP&#39;s code is now working (or, at least, doing something), but just taking a long time to run."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1485995277, "post_id": 41987366, "comment_id": 71161655, "body": "Do you think turning off auto calculation and screen updating would help any, with the speed?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1485996774, "post_id": 41987366, "comment_id": 71162087, "body": "@BruceWayne - Probably help a little, but there&#39;s a maximum of 932 cell writes so I can&#39;t see screen updating being a <b>major</b> cause of slowness, and I&#39;m guessing that there won&#39;t be many calculations dependent on the updated cells (it just doesn&#39;t seem to be a calculation-intensive type of application).  I&#39;ll edit the code anyway."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1486014392, "post_id": 41987366, "comment_id": 71166767, "body": "not a big fan of using <code>With Worksheets(&quot;Sheet1&quot;)</code> in the begining ? would have made the code a lot cleaner and shorter."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 1, "last_activity_date": 1485997058, "last_edit_date": 1485997058, "creation_date": 1485974880, "answer_id": 41987366, "question_id": 41987234, "link": "https://stackoverflow.com/questions/41987234/vba-loop-isnt-functioning-properly/41987366#41987366", "title": "VBA loop isn&#39;t functioning properly", "body": "<p>Can I suggest that you refactor your code as follows:</p>\n\n<pre><code>Sub Button2_Click()\n    Dim i As Integer, q As Integer\n    'Storing the ids in an array will make it much faster to access instead\n    'of interfacing with Excel's object model a couple of million times\n    Dim ids1, ids2\n    Dim origCalcMode As XlCalculation\n\n    'Switch off ScreenUpdating to improve speed\n    Application.ScreenUpdating = False\n    'Switch off auto calculation to improve speed\n    origCalcMode = Application.Calculation\n    Application.Calculation = xlCalculationManual\n\n    ids1 = Application.Transpose(Worksheets(\"Sheet1\").Range(\"A2:A467\").Value)\n    ids2 = Application.Transpose(Worksheets(\"Sheet2\").Range(\"A2:A3422\").Value)\n    'Using For loops rather than manually keeping track of row counters\n    'makes the code MUCH cleaner and less prone to errors\n    For i = 2 To 467\n        'Moving this test to earlier in the code avoids having to iterate\n        'through all the rows on Sheet2 when there is nothing that can be\n        'done with the matching data anyway\n        If Len(Worksheets(\"Sheet1\").Cells(i, 4)) &lt; 12 Then\n            For q = 2 To 3422\n                If ids1(i - 1) = ids2(q - 1) Then\n                    Dim edate As String, adate As String, ed As String, ad As String, n As Integer, x As Integer, y As Integer\n                    edate = Sheets(\"sheet1\").Cells(i, 4).Value\n                    adate = Sheets(\"sheet2\").Cells(q, 2).Value\n                    ed = Right(Sheets(\"sheet1\").Cells(i, 4), 4)\n                    ad = Right(Sheets(\"sheet2\").Cells(q, 2), 4)\n                    n = CInt(ad) - CInt(ed)\n                    If InStr(edate, \"Fall\") And InStr(adate, \"Fall\") Then x = 7 + (5 * n)\n                    If InStr(edate, \"Fall\") And InStr(adate, \"Spring\") Then x = 9 + (5 * (n - 1))\n                    If InStr(edate, \"Spring\") And InStr(adate, \"Spring\") Then x = 9 + (5 * n)\n                    If InStr(edate, \"Spring\") And InStr(adate, \"Fall\") Then x = 12 + (5 * n)\n                    y = x - 1\n                    Worksheets(\"Sheet1\").Cells(i, x).Value = Worksheets(\"Sheet2\").Cells(q, 5).Value\n                    Worksheets(\"Sheet1\").Cells(i, y).Value = Worksheets(\"Sheet2\").Cells(q, 3).Value\n                    Exit For\n                End If\n            Next\n        End If\n    Next\n\n    'Restore application settings\n    Application.ScreenUpdating = True\n    Application.Calculation = origCalcMode\nEnd Sub\n</code></pre>\n\n<p>I'm not sure about the <code>Exit For</code> line.  Your question implies that you need to process multiple entries from Sheet2 if they exist.  If so, delete the <code>Exit For</code> line, but that will increase the runtime because it will need to iterate over all 3421 rows in Sheet2 for each row in Sheet1.</p>\n\n<p>Edit: Included changes to ScreenUpdating and Calculation as suggested by BruceWayne.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7502150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a038a0e3f5adc28476c92b302f4f8c0?s=128&d=identicon&r=PG&f=1", "display_name": "xpes100", "link": "https://stackoverflow.com/users/7502150/xpes100"}, "is_accepted": true, "score": 0, "last_activity_date": 1486411456, "creation_date": 1486411456, "answer_id": 42076308, "question_id": 41987234, "link": "https://stackoverflow.com/questions/41987234/vba-loop-isnt-functioning-properly/42076308#42076308", "title": "VBA loop isn&#39;t functioning properly", "body": "<p>Thanks for all of the help, here is the code that works in case anyone stumbles upon this with a similar problem.</p>\n\n<p>This code loops through sheet1 with integer i and sheet2 with integer q to find a match in the first/A column of both sheets. As I have multiples of the project ideas (Sheet 1 column A) on sheet2 in column A, it continues after finding a match at the row (q) found on sheet2. This then continues through the specified amount of rows (i) and secondly through all rows (q) for each i.</p>\n\n<pre><code>Public CalcState As Long\nPublic EventState As Boolean\nPublic PageBreakState As Boolean\n\nSub OptimizeCode_Begin()\n\nApplication.ScreenUpdating = False\n\nEventState = Application.EnableEvents\nApplication.EnableEvents = False\n\nCalcState = Application.Calculation\nApplication.Calculation = xlCalculationManual\n\nPageBreakState = ActiveSheet.DisplayPageBreaks\nActiveSheet.DisplayPageBreaks = False\n\nEnd Sub\n\nSub OptimizeCode_End()\n\nActiveSheet.DisplayPageBreaks = PageBreakState\nApplication.Calculation = CalcState\nApplication.EnableEvents = EventState\nApplication.ScreenUpdating = True\n\nEnd Sub\n\n\nSub Button2_Click()\nDim i As Integer, q As Integer, origCalcMode As XlCalculation\ni = 3\nq = 2\nCall OptimizeCode_Begin\nDo While i &lt; 467\nIf Len(Worksheets(\"Sheet1\").Cells(i, 4)) &lt; 12 Then\n    If Worksheets(\"Sheet1\").Cells(i, 1).Value = Worksheets(\"Sheet2\").Cells(q, 1).Value Then\n        Dim edate As String, adate As String, ed As String, ad As String, n As Integer, x As Integer, y As Integer\n        edate = Sheets(\"sheet1\").Cells(i, 4).Value\n        adate = Sheets(\"sheet2\").Cells(q, 2).Value\n        ed = Right(Sheets(\"sheet1\").Cells(i, 4), 4)\n        ad = Right(Sheets(\"sheet2\").Cells(q, 2), 4)\n        n = CInt(ad) - CInt(ed)\n        If InStr(edate, \"Fall\") And InStr(adate, \"Fall\") Then x = 7 + (5 * n)\n        If InStr(edate, \"Fall\") And InStr(adate, \"Spring\") Then x = 9 + (5 * (n - 1))\n        If InStr(edate, \"Spring\") And InStr(adate, \"Spring\") Then x = 9 + (5 * n)\n        If InStr(edate, \"Spring\") And InStr(adate, \"Fall\") Then x = 12 + (5 * n)\n        y = x - 1\n        Worksheets(\"Sheet1\").Cells(i, x).Value = Worksheets(\"Sheet2\").Cells(q, 5).Value\n        Worksheets(\"Sheet1\").Cells(i, y).Value = Worksheets(\"Sheet2\").Cells(q, 3).Value\n        q = q + 1\n    Else\n        If q &lt; 1236 Then\n            q = q + 1\n        Else\n            i = i + 1\n            q = 2\n        End If\n    End If\nElse\n   i = i + 1\n   q = 2\nEnd If\nLoop\nCall OptimizeCode_End\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7502150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a038a0e3f5adc28476c92b302f4f8c0?s=128&d=identicon&r=PG&f=1", "display_name": "xpes100", "link": "https://stackoverflow.com/users/7502150/xpes100"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 42076308, "answer_count": 2, "score": 0, "last_activity_date": 1486411456, "creation_date": 1485974393, "last_edit_date": 1485977644, "question_id": 41987234, "link": "https://stackoverflow.com/questions/41987234/vba-loop-isnt-functioning-properly", "title": "VBA loop isn&#39;t functioning properly", "body": "<pre><code>Sub Button2_Click()\nDim i As Integer, q As Integer\ni = 2\nq = 2\nDo While i &lt; 468 And q &lt; 3450\nIf Worksheets(\"Sheet1\").Range(\"A\" &amp; i).Value = Worksheets(\"Sheet2\").Range(\"A\" &amp; q).Value Then\n    If Len(Worksheets(\"Sheet1\").Cells(i, 4)) &lt; 12 Then\n        Dim edate As String, adate As String, ed As String, ad As String, n As Integer, x As Integer, y As Integer\n        edate = Sheets(\"sheet1\").Cells(i, 4).Value\n        adate = Sheets(\"sheet2\").Cells(q, 2).Value\n        ed = Right(Sheets(\"sheet1\").Cells(i, 4), 4)\n        ad = Right(Sheets(\"sheet2\").Cells(q, 2), 4)\n        n = CInt(ad) - CInt(ed)\n        If InStr(edate, \"Fall\") And InStr(adate, \"Fall\") Then x = 7 + (5 * n)\n        If InStr(edate, \"Fall\") And InStr(adate, \"Spring\") Then x = 9 + (5 * (n - 1))\n        If InStr(edate, \"Spring\") And InStr(adate, \"Spring\") Then x = 9 + (5 * n)\n        If InStr(edate, \"Spring\") And InStr(adate, \"Fall\") Then x = 12 + (5 * n)\n        y = x - 1\n        Worksheets(\"Sheet1\").Cells(i, x).Value = Worksheets(\"Sheet2\").Cells(q, 5).Value\n        Worksheets(\"Sheet1\").Cells(i, y).Value = Worksheets(\"Sheet2\").Cells(q, 3).Value\n        i= i +1\n        q=2\n    Else\n        i = i + 1\n        q = 2\n    End If\nElse\n    If q &lt; 3423 Then\n        q = q + 1\n    else\n        i = 1 + 1\n        q=2\n    End If\n    Else\n        i = i + 1\n        q = 2\n    End If\nEnd If\nLoop\nEnd Sub\n</code></pre>\n\n<p>Hey guys, the code above is something I've been working on to important some data from sheet2 to sheet1. Sheet 2 has project Id numbers in column 1, terms (awarddate) in column 2, type of award in column 3, and amount in column 5. Sheet 1 has project id in column 1, and term (entry date) in column 4. Sheet 2 has awards given by semester and indexed by project id, I would like to important the data and place them into the columns given by the if instr statements int he middle of the text. </p>\n\n<p>The goal of this code is to loop through the project id numbers in sheet 1, column A and check to see if they exist in sheet 2 column A, and then to import the award type and amount sorted by the difference in years between the entry date on sheet 1 and the award date on sheet 2. The dates have spring/fall and a year, so I tried the left(string, #) command to only have years to subtract, and then the block of aforementioned if instr code is supposed to balance out the difference in semesters. </p>\n\n<p>There are multiples of the same project id in sheet 2, so I need the code to resume the loop after the previous row on sheet 2, until every project id on sheet 1 has been cross-referenced.</p>\n\n<p>Can someone point out the error in my code? Nothing happens when I click the command button.</p>\n\n<p>The problem is in the first if statement, it skips all of the operations that require the condition to be met, when I know that at least 450 of the data match.</p>\n\n<p>Just edited my code, it's still running right now.</p>\n\n<p>List of edits thanks to comments: fixed logical statment issue, fixed range/cell/cells issue, fixed looping issue, fixed right/left string issue</p>\n"}, {"tags": ["vba", "registry", "powerpoint", "add-in"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1485974725, "post_id": 41987072, "comment_id": 71152216, "body": "<i>I want this add-in to load through registry</i> - huh? like a COM add-in? it&#39;s <i>not</i> a COM add-in."}, {"owner": {"reputation": 7, "user_id": 4840379, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-b5epq1TpzaY/AAAAAAAAAAI/AAAAAAAAAAA/INCalJC6mCI/photo.jpg?sz=128", "display_name": "omkarnath bag", "link": "https://stackoverflow.com/users/4840379/omkarnath-bag"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1486007308, "post_id": 41987072, "comment_id": 71164699, "body": "Power Point add in"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1486007648, "post_id": 41987072, "comment_id": 71164795, "body": "Yes, exactly: not a COM add-in. It doesn&#39;t work like that."}, {"owner": {"reputation": 7, "user_id": 4840379, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-b5epq1TpzaY/AAAAAAAAAAI/AAAAAAAAAAA/INCalJC6mCI/photo.jpg?sz=128", "display_name": "omkarnath bag", "link": "https://stackoverflow.com/users/4840379/omkarnath-bag"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1486015882, "post_id": 41987072, "comment_id": 71167387, "body": "ohh... So only COM add-in can be configured .. Not PowerPoint Add-in ?  <a href=\"http://www.pptfaq.com/FAQ00469_Add_-_install_an_addin_via_the_registry.htm\" rel=\"nofollow noreferrer\">pptfaq.com/FAQ00469_Add_-_install_an_addin_via_the_registry.&zwnj;&#8203;htm</a>"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 4840379, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-b5epq1TpzaY/AAAAAAAAAAI/AAAAAAAAAAA/INCalJC6mCI/photo.jpg?sz=128", "display_name": "omkarnath bag", "link": "https://stackoverflow.com/users/4840379/omkarnath-bag"}, "edited": false, "score": 0, "creation_date": 1486058399, "post_id": 42007007, "comment_id": 71194010, "body": "Thanks it worked. The error was in file path. I changed it to &quot;Path&quot;=&quot;C:\\\\Controller\\\\registry\\\\CloseExtraWindow.ppam&quot; and it now loads on start up."}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": true, "score": 0, "last_activity_date": 1486051772, "creation_date": 1486051772, "answer_id": 42007007, "question_id": 41987072, "link": "https://stackoverflow.com/questions/41987072/adding-powerpoint-add-in-from-registry-throws-powerpoint-couldnt-load-the-fil/42007007#42007007", "title": "adding Powerpoint Add-in from registry throws &quot; Powerpoint couldn&#39;t load the file&quot; error", "body": "<p>FWIW, here's the registry entry for one of my installed add-ins:</p>\n\n<pre><code>[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\15.0\\PowerPoint\\AddIns\\RESIZE]\n\"Path\"=\"C:\\\\Users\\\\steve\\\\AppData\\\\Roaming\\\\Microsoft\\\\AddIns\\\\RESIZE.PPA\"\n\"AutoLoad\"=dword:ffffffff\n</code></pre>\n\n<p>Yours:</p>\n\n<pre><code>[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\15.0\\PowerPoint\\Addins\\MyNewAddIn]\n\"AutoLoad\"=dword:ffffffff \n\"Path\"=\"file:///C:/MyAddinFolder/MyNewAddIn.ppam\"\n</code></pre>\n\n<p>Note the differences in the Path entry.</p>\n"}], "owner": {"reputation": 7, "user_id": 4840379, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-b5epq1TpzaY/AAAAAAAAAAI/AAAAAAAAAAA/INCalJC6mCI/photo.jpg?sz=128", "display_name": "omkarnath bag", "link": "https://stackoverflow.com/users/4840379/omkarnath-bag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 0, "accepted_answer_id": 42007007, "answer_count": 1, "score": 0, "last_activity_date": 1486051772, "creation_date": 1485973909, "question_id": 41987072, "link": "https://stackoverflow.com/questions/41987072/adding-powerpoint-add-in-from-registry-throws-powerpoint-couldnt-load-the-fil", "title": "adding Powerpoint Add-in from registry throws &quot; Powerpoint couldn&#39;t load the file&quot; error", "body": "<p><em>I created Powerpoint Add-in using VBA. I added it manually to Powerpoint and it works fine, When I start Powerpoint, I can see it's loaded and working as expected. I want this add-in to load through registry. Below is my registry file detail. But it throws error</em> <strong>\"For some reason Powerpoint couldn't load the file\"</strong></p>\n\n#\n\n<pre><code>Windows Registry Editor Version 5.00\n\n[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\15.0\\PowerPoint\\Addins\\MyNewAddIn]\n\"AutoLoad\"=dword:ffffffff \n\"Path\"=\"file:///C:/MyAddinFolder/MyNewAddIn.ppam\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 175, "user_id": 2261631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQPMH.jpg?s=128&g=1", "display_name": "P. O.", "link": "https://stackoverflow.com/users/2261631/p-o"}, "edited": false, "score": 1, "creation_date": 1485974239, "post_id": 41987041, "comment_id": 71151958, "body": "You could try first to not select the whole columns, but only the range you&#39;re interested in. Also avoid &quot;select&quot; whenever possible. see <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\" title=\"how to avoid using select in excel vba macros\">stackoverflow.com/questions/10714251/&hellip;</a>  for info. With these two steps you&#39;ll probably speed your macro by a factor of ten."}, {"owner": {"reputation": 1029, "user_id": 1474994, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/rOT6j.png?s=128&g=1", "display_name": "UndeadBob", "link": "https://stackoverflow.com/users/1474994/undeadbob"}, "edited": false, "score": 0, "creation_date": 1485974660, "post_id": 41987041, "comment_id": 71152183, "body": "<code>ScreenUpdating = False</code> may help.  But first, just remove all the <code>Select</code> and <code>Activate</code> statements.  If it&#39;s still slow due to calculation, disable automatic calculation during the <code>for</code> loop."}, {"owner": {"reputation": 39, "user_id": 5004848, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6144bf68b0253b3d68c57dcf540562b1?s=128&d=identicon&r=PG&f=1", "display_name": "ThomasTcred", "link": "https://stackoverflow.com/users/5004848/thomastcred"}, "reply_to_user": {"reputation": 1029, "user_id": 1474994, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/rOT6j.png?s=128&g=1", "display_name": "UndeadBob", "link": "https://stackoverflow.com/users/1474994/undeadbob"}, "edited": false, "score": 0, "creation_date": 1485989108, "post_id": 41987041, "comment_id": 71159614, "body": "@reasra but if i have to remove the select and activate statements i somehow still need to copy the data and paste it into the new sheet, i haven&#39;t figured out yet how to complete that with other code not involving the select and activate method."}, {"owner": {"reputation": 1029, "user_id": 1474994, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/rOT6j.png?s=128&g=1", "display_name": "UndeadBob", "link": "https://stackoverflow.com/users/1474994/undeadbob"}, "edited": false, "score": 0, "creation_date": 1486006762, "post_id": 41987041, "comment_id": 71164577, "body": "Just set the .Value of the destination to the .Value of the source. Can&#39;t find the back quote mark on this phone to format correctly right now."}, {"owner": {"reputation": 39, "user_id": 5004848, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6144bf68b0253b3d68c57dcf540562b1?s=128&d=identicon&r=PG&f=1", "display_name": "ThomasTcred", "link": "https://stackoverflow.com/users/5004848/thomastcred"}, "reply_to_user": {"reputation": 1029, "user_id": 1474994, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/rOT6j.png?s=128&g=1", "display_name": "UndeadBob", "link": "https://stackoverflow.com/users/1474994/undeadbob"}, "edited": false, "score": 0, "creation_date": 1488216401, "post_id": 41987041, "comment_id": 72123309, "body": "Apologies about the very delayed response, but i tried out the code @reasra, it turns out everything in the column is copied instead of just the filtered rows into the new sheet? Any help would still be appreciated."}, {"owner": {"reputation": 1029, "user_id": 1474994, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/rOT6j.png?s=128&g=1", "display_name": "UndeadBob", "link": "https://stackoverflow.com/users/1474994/undeadbob"}, "edited": false, "score": 0, "creation_date": 1488481769, "post_id": 41987041, "comment_id": 72261721, "body": "Original question made no mention of only wanting to copy <i>only</i> filtered data.  See <a href=\"http://stackoverflow.com/questions/10849177/easiest-way-to-loop-through-a-filtered-list-with-vba\">this answer</a> to check out the <code>range.SpecialCells(xlCellTypeVisible)</code>.  Use that to determine whether or not to copy the value."}, {"owner": {"reputation": 39, "user_id": 5004848, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6144bf68b0253b3d68c57dcf540562b1?s=128&d=identicon&r=PG&f=1", "display_name": "ThomasTcred", "link": "https://stackoverflow.com/users/5004848/thomastcred"}, "edited": false, "score": 0, "creation_date": 1488574348, "post_id": 41987041, "comment_id": 72308610, "body": "I was not able to make the new code work with that range.special, but 20 seconds of waiting is still better than completing the task manually as I previously did so I shall keep using it. Thanks for the attempt to help!!"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 5004848, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6144bf68b0253b3d68c57dcf540562b1?s=128&d=identicon&r=PG&f=1", "display_name": "ThomasTcred", "link": "https://stackoverflow.com/users/5004848/thomastcred"}, "edited": false, "score": 0, "creation_date": 1485990901, "post_id": 41987235, "comment_id": 71160271, "body": "Hi @Anand this does help reduce the screen movement back and forth but it still seems to take a lot of processing before the code is execute and take rather long to execute. Thanks though, it still is an improvement in comparison."}], "tags": [], "owner": {"reputation": 353, "user_id": 4625886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dba3b62f6875333ff46c58c3e240c0b8?s=128&d=identicon&r=PG&f=1", "display_name": "Anand", "link": "https://stackoverflow.com/users/4625886/anand"}, "is_accepted": false, "score": 0, "last_activity_date": 1485974401, "creation_date": 1485974401, "answer_id": 41987235, "question_id": 41987041, "link": "https://stackoverflow.com/questions/41987041/my-code-is-causing-excel-to-run-really-slowly-i-was-wondering-if-it-is-because/41987235#41987235", "title": "My code is causing excel to run really slowly, I was wondering if it is because of unecessary loops", "body": "<p>Try this and see if it helps:</p>\n\n<p>Disable Sheet Screen Updating</p>\n\n<pre><code>Application.ScreenUpdating = False\n\n\u2018Place your macro code here\n\nApplication.ScreenUpdating = True\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 173, "user_id": 3847207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e177b9ef9729e7b4feaeaca796b49590?s=128&d=identicon&r=PG&f=1", "display_name": "zaphodalive", "link": "https://stackoverflow.com/users/3847207/zaphodalive"}, "is_accepted": false, "score": 0, "last_activity_date": 1485992424, "creation_date": 1485992424, "answer_id": 41991893, "question_id": 41987041, "link": "https://stackoverflow.com/questions/41987041/my-code-is-causing-excel-to-run-really-slowly-i-was-wondering-if-it-is-because/41991893#41991893", "title": "My code is causing excel to run really slowly, I was wondering if it is because of unecessary loops", "body": "<p>If your workbook has a lot of formulas or event macros that could slow it down significantly.  Try the magic four:</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.Calculation = xlCalculationManual\nApplication.Cursor = xlWait\n\n' Your code\n\nApplication.Cursor = xlDefault\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1029, "user_id": 1474994, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/rOT6j.png?s=128&g=1", "display_name": "UndeadBob", "link": "https://stackoverflow.com/users/1474994/undeadbob"}, "is_accepted": false, "score": 0, "last_activity_date": 1486044038, "creation_date": 1486044038, "answer_id": 42004161, "question_id": 41987041, "link": "https://stackoverflow.com/questions/41987041/my-code-is-causing-excel-to-run-really-slowly-i-was-wondering-if-it-is-because/42004161#42004161", "title": "My code is causing excel to run really slowly, I was wondering if it is because of unecessary loops", "body": "<p>Try this instead of <em>copy+paste</em>:</p>\n\n<pre><code>Worksheets(NAME).Activate 'Just to watch it happen\nFor i = 1 To lNumElements - 1\n    Sheets(NAME).Columns(i + 1).Value = Sheets(\"Database\").Columns(c(i)).Value\n    Sheets(NAME).Columns(i + 1).NumberFormat = Sheets(\"Database\").Columns(c(i)).NumberFormat\nk = k + 1\nNext i\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 5004848, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6144bf68b0253b3d68c57dcf540562b1?s=128&d=identicon&r=PG&f=1", "display_name": "ThomasTcred", "link": "https://stackoverflow.com/users/5004848/thomastcred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1486305979, "creation_date": 1485973784, "last_edit_date": 1486305979, "question_id": 41987041, "link": "https://stackoverflow.com/questions/41987041/my-code-is-causing-excel-to-run-really-slowly-i-was-wondering-if-it-is-because", "title": "My code is causing excel to run really slowly, I was wondering if it is because of unecessary loops", "body": "<p>I am trying to create a table subset from a larger table. I'm pulling data from certain columns based on data that is filtered so everything up till the first blank row is reached is copied and pasted on a new sheet. Ideally I would like to create a specific type of formatted table, but for now I'm trying to copy the same format as the main table but excel seems to run very repetitively and I'm wondering if its because of redundancies.</p>\n\n<pre><code>Sub Lists()\nDim i As Integer 'define variables, i is a counter, K is a counter, c is an array to hold the values of column numbers to be coppied\n'Dim k As Integer ****this variable is no longer needed with this new code of including the formating\n'k = 2 'initialize value of counter k the value needed is 2 because the loop does not handle the first element, this is hard coded *** no longer needed with new formatting code\n\nDim c As Variant 'this variable holds the column numbers to be copied\nc = Array(1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 24, 25)\n\nDim lNumElements As Long ' this varibale will hold the number of elements in array c\nlNumElements = UBound(c) - LBound(c) + 1 'this is a formula for the number of elemnts in variable c\n\nDim NAME As String\nNAME = InputBox(\"Please name the sheet\") 'here the user can choose the name of the new worksheet that they wish to write the new table to\n\nDim ws As Worksheet 'declare a new worksheet to me made\nSet ws = ThisWorkbook.Sheets.Add(After:= _\n         ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)) 'code used to add a new work sheet\nws.NAME = NAME  'use the name from the user input to rename the worksheet\n\nWorksheets(\"Database\").Select 'select the database worksheet\nWorksheets(\"Database\").Range(\"A1\").Activate 'place the curser on the A1 range of database\n\n'Sheets(\"Database\").Columns(1).Copy Destination:=Sheets(ws.NAME).Columns(1) ' copy from database sheet and paste to new sheet hard coded for column 1 as the for loop did not like having column one in it as well *** no longer needed with new code\nSheets(\"Database\").Columns(1).Copy 'copy the first column ( column A)\nWorksheets(NAME).Select 'choose where you want to copy the data to on the new page\nWorksheets(NAME).Range(\"A1\").Activate 'activate the section you choose to copy to in the previous line of code\nSelection.PasteSpecial Paste:=xlPasteValues  'paste the values of the code you wanted\nSelection.PasteSpecial Paste:=xlPasteFormats 'keep the formating of the code you pasted\n\n\n\nFor i = 1 To lNumElements - 1 'this for loop will cycle through the number of elements in array c except for the first element\n'Sheets(\"Database\").Columns(c(i)).Copy Destination:=Sheets(ws.NAME).Columns(k) ' copy from database sheet and paste to new sheet excluding element 1).  Paste information starting in column 2 (column 1 is hard coded above)\n\nWorksheets(\"Database\").Select\nColumns(c(i)).Activate\nSheets(\"Database\").Columns(c(i)).Copy\nWorksheets(NAME).Select\nColumns(i + 1).Activate\n\nSelection.PasteSpecial Paste:=xlPasteValues\nSelection.PasteSpecial Paste:=xlPasteFormats\n\nk = k + 1\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba", "excel"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1485974181, "post_id": 41986962, "comment_id": 71151925, "body": "Can we see the html? It sounds like one of two things, the page isn&#39;t actually loading fully despite your code. The new page is in a frame/iFrame. Or something else, seeing the website or HTML should help."}, {"owner": {"reputation": 27, "user_id": 3335592, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2ee75c1cd25f1e70d3bad9db8adb5c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Tsnorthern", "link": "https://stackoverflow.com/users/3335592/tsnorthern"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1485975408, "post_id": 41986962, "comment_id": 71152579, "body": "I can&#39;t seem to figure out how to get properly formatted HTML into the original post (it turns into a trainwreck when i paste). Here is the website: <a href=\"http://snowload.atcouncil.org/index.php/component/vcpsnowload/item\" rel=\"nofollow noreferrer\">Snow Link</a>  I&#39;m not that familiar with HTML, so i&#39;m not entirely sure if any of it is noteworthy."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1485977134, "post_id": 41986962, "comment_id": 71153533, "body": "Are you trying to return the psf of the snowfall for a specific area?"}, {"owner": {"reputation": 27, "user_id": 3335592, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2ee75c1cd25f1e70d3bad9db8adb5c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Tsnorthern", "link": "https://stackoverflow.com/users/3335592/tsnorthern"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1485977427, "post_id": 41986962, "comment_id": 71153681, "body": "Exactly. Entering the location on the prior page changes that value, which is what i&#39;m trying to retain."}], "answers": [{"comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 27, "user_id": 3335592, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2ee75c1cd25f1e70d3bad9db8adb5c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Tsnorthern", "link": "https://stackoverflow.com/users/3335592/tsnorthern"}, "edited": false, "score": 0, "creation_date": 1485983931, "post_id": 41989256, "comment_id": 71157194, "body": "No problem, glad I could help. Really weird issue, it shouldn&#39;t be doing that as far as I know. Once the refresh is done the HTML should be updating."}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": true, "score": 1, "last_activity_date": 1485981347, "creation_date": 1485981347, "answer_id": 41989256, "question_id": 41986962, "link": "https://stackoverflow.com/questions/41986962/vba-getting-html-data-from-page-navigated-to-by-click/41989256#41989256", "title": "VBA: Getting HTML Data from page navigated to by click", "body": "<p>I've got this working seemingly reliably. I just ran it 5-6 times without an issue. I too was not finding the element after the page was refreshing. To get around this, I got a brand new reference to the object after the load. That seemed to work well. </p>\n\n<p>Also, I did a general clean up on the code.</p>\n\n<pre><code>#If VBA7 Then\n    Public Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As LongPtr)\n#Else\n    Public Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n#End If\n\nSub SnowLoad()\nOn Error GoTo errhand:\n    'I hard coded these for testing\n    Latitude = \"46\"\n    Longitude = \"-87\"\n\n    Dim MyURL       As String: MyURL = \"http://snowload.atcouncil.org/\"\n    Dim element     As Object\n\n    ''open new explorer, I used late binding\n    Dim MyBrowser   As Object: Set MyBrowser = CreateObject(\"InternetExplorer.Application\")\n    MyBrowser.Visible = True\n    MyBrowser.navigate MyURL\n\n    'Wait for the browser to finish loading\n    waitForLoad MyBrowser\n\n    With MyBrowser.document\n        .getElementByID(\"optionCoordinate_LATLON\").Click\n        .getElementByID(\"coordinate_lat\").Value = Latitude\n        .getElementByID(\"coordinate_lon\").Value = Longitude\n        .getElementsByName(\"btn-submit\")(0).Click\n    End With\n\n    waitForLoad MyBrowser\n\n    'For whatever reason the HTML isn't updating along with the page\n    'Instead, I'm just getting an updated reference to the IE object with the\n    'below function, weird issue, but this seems to work\n    Set MyBrowser = FindWindow(\"component/vcpsnowload/item\")\n    Set element = MyBrowser.document.Forms(\"adminForm\").getelementsByTagName(\"p\")(0)\n    Range(\"A1\").Value = element.innertext\n\n    Exit Sub\nerrhand:\n    MsgBox (Err.Number &amp; \"  \" &amp; Err.Description)\nEnd Sub\n\nPublic Function FindWindow(SearchCriteria As String) As Object\n    Dim window As Object\n\n    For Each window In CreateObject(\"Shell.Application\").Windows\n        If window.locationurl Like \"*\" &amp; SearchCriteria &amp; \"*\" Then\n            Set FindWindow = window\n            Exit Function\n        End If\n    Next\n\n    Set FindWindow = Nothing\nEnd Function\n\nPublic Sub waitForLoad(ByVal IE As Object)\n    Dim i As Byte\n    Sleep 500 ' wait a bit for the page to start loading\n    Do\n        i = i + 1\n        Sleep 500\n    Loop Until IE.readystate = 4 Or IE.busy = False Or i &gt;= 20\nEnd Sub\n</code></pre>\n\n<p>The code above is returning this: <code>Any elevation: Ground Snow Load is 60 psf</code></p>\n"}], "owner": {"reputation": 27, "user_id": 3335592, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2ee75c1cd25f1e70d3bad9db8adb5c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Tsnorthern", "link": "https://stackoverflow.com/users/3335592/tsnorthern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1319, "favorite_count": 0, "accepted_answer_id": 41989256, "answer_count": 1, "score": 0, "last_activity_date": 1511008912, "creation_date": 1485973477, "last_edit_date": 1531164843, "question_id": 41986962, "link": "https://stackoverflow.com/questions/41986962/vba-getting-html-data-from-page-navigated-to-by-click", "title": "VBA: Getting HTML Data from page navigated to by click", "body": "<p>I'm trying to use VBA to navigate to a web page, fill in some information, click a button, move to the next page, and collect some of the resulting information. Here is the problem that i'm having: the code goes through the first few steps, but when it tries to parse the html of the second page, it returns the HTML from the first page. For some reason, even though the correct page is shown on the screen (with the desired information), the HTML in the WebBrowser.Document never changes with the new screen loading. I've tried forcing I.E. to wait until the page is loaded, but that doesn't seem to make any difference. The code is below:</p>\n\n<pre><code>    Sub SnowLoad(Latitude As String, Longitude As String, State As String)\n\n\nDim MyHTML_Element As IHTMLElement\nDim HTMLDoc As HTMLDocument\nDim MyURL As String\nDim SnowTag As String\nDim SnowPos As Long\nSnowTag = \"Load\"\nOn Error GoTo Err_Clear\nMyURL = \"http://snowload.atcouncil.org/\"\n''open new explorer\nDim MyBrowser As New InternetExplorer\nMyBrowser.Silent = True\n''navigate to page\nMyBrowser.navigate MyURL\nMyBrowser.Visible = True\n''wait until ready\nDo\nDoEvents\nLoop Until MyBrowser.readyState = READYSTATE_COMPLETE\n\nSet HTMLDoc = MyBrowser.document\nHTMLDoc.all.optionCoordinate_LATLON.Click\n\nHTMLDoc.all.coordinate_lat.Value = Latitude\nHTMLDoc.all.coordinate_lon.Value = Longitude\nSet elems = HTMLDoc.getElementsByTagName(\"button\")\n    For Each e In elems\n\n        If (e.getAttribute(\"class\") = \"btn\") Then\n            e.Click\n            Exit For\n        End If\n\n    Next e\n\nDo\nDoEvents\nLoop Until MyBrowser.readyState = READYSTATE_COMPLETE\n\nSet elems = HTMLDoc.getElementsByTagName(\"p\")\n\n    For Each e In elems\n        Debug.Print e.innerHTML\n        If InStr(e.innerHTML, SnowTag) Then\n            SnowPos = InStr(e.innerHTML, SnowTag)\n            Range(\"SnowPosition\").Value = SnowPos\n            Exit For\n        End If\n\n    Next e\n\nErr_Clear:\n If Err &lt;&gt; 0 Then\n Err.Clear\n Resume Next\n End If\n\nEnd Sub\n</code></pre>\n\n<p>I for the life of me can't figure out how to get the information shown on the second page. No amount of googling seems to have produced an answer or a similar issue. Could it be related to using the button to naviate in lieu of an actual call to .navigate?</p>\n"}, {"tags": ["xml", "vba", "ms-access", "xslt"], "answers": [{"comments": [{"owner": {"reputation": 203, "user_id": 4346740, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/500996bedcbd309d97bd359f839a809a?s=128&d=identicon&r=PG&f=1", "display_name": "jjohnson", "link": "https://stackoverflow.com/users/4346740/jjohnson"}, "edited": false, "score": 0, "creation_date": 1486145365, "post_id": 42015523, "comment_id": 71235326, "body": "Thank you Parfait! You are amazing and I love you! This worked perfectly!"}, {"owner": {"reputation": 203, "user_id": 4346740, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/500996bedcbd309d97bd359f839a809a?s=128&d=identicon&r=PG&f=1", "display_name": "jjohnson", "link": "https://stackoverflow.com/users/4346740/jjohnson"}, "edited": false, "score": 0, "creation_date": 1486166629, "post_id": 42015523, "comment_id": 71244200, "body": "is there a way to import values as comma separated? Like <code>&lt;vms             &lt;posture&gt;1029&lt;&#47;posture&gt;           &lt;posture&gt;1712&lt;&#47;posture&gt;                &lt;posture&gt;59&lt;&#47;posture&gt;         &lt;&#47;vms&gt; be: &lt;posture&gt;1029, 1712, 59&lt;&#47;posture&gt;</code>"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 203, "user_id": 4346740, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/500996bedcbd309d97bd359f839a809a?s=128&d=identicon&r=PG&f=1", "display_name": "jjohnson", "link": "https://stackoverflow.com/users/4346740/jjohnson"}, "edited": false, "score": 0, "creation_date": 1486168574, "post_id": 42015523, "comment_id": 71244699, "body": "You need to adjust XSLT with a special <code>vms</code> template. See my updated answer in your other question."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 2, "last_activity_date": 1486087061, "creation_date": 1486087061, "answer_id": 42015523, "question_id": 41986878, "link": "https://stackoverflow.com/questions/41986878/import-xml-into-mc-access-with-transform-file-in-visual-basic/42015523#42015523", "title": "Import XML into mc access with transform file in visual basic", "body": "<p>Simply use MSXML's <a href=\"https://msdn.microsoft.com/en-us/library/ms759204(v=vs.85).aspx\" rel=\"nofollow noreferrer\">XSLT</a> methods with Access' built-in <a href=\"https://msdn.microsoft.com/en-us/library/office/ff823157.aspx\" rel=\"nofollow noreferrer\">Application.ImportXML</a> specifying its <em>acAppendData</em> argument to append data from a looped list of XML files.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub TransformAndImportMultipleXMLs()\n    Dim strFile As String, strPath As String\n    ' REFERENCE MS XML, v6.0\n    Dim xmlDoc As New MSXML2.DOMDocument60, xslDoc As New MSXML2.DOMDocument60 \n    Dim newDoc As New MSXML2.DOMDocument60\n\n    strPath = \"C:\\test\\\"\n    strFile = Dir(strPath &amp; \"*.xml\")\n\n    ' LOAD XSL ONLY ONCE\n    xslDoc.Load \"C:\\test\\transformer.xsl\"\n\n    While strFile &lt;&gt; \"\"\n        ' REINITIALIZE DOM OBJECTS\n        Set xmlDoc = New MSXML2.DOMDocument60\n        Set newDoc = New MSXML2.DOMDocument60\n\n        ' LOAD XML SOURCE\n        xmlDoc.Load strPath &amp; strFile\n\n        ' TRANSFORM SOURCE\n        xmlDoc.transformNodeToObject xslDoc, newDoc\n        newDoc.Save \"C:\\test\\temp.xml\"\n\n        ' APPEND TO TABLES\n        Application.ImportXML \"C:\\test\\temp.xml\", acAppendData\n        strFile = Dir()\n    Wend\n\n   ' RELEASE DOM OBJECTS\n    Set xmlDoc = Nothing: Set xslDoc = Nothing: Set newDoc = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 203, "user_id": 4346740, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/500996bedcbd309d97bd359f839a809a?s=128&d=identicon&r=PG&f=1", "display_name": "jjohnson", "link": "https://stackoverflow.com/users/4346740/jjohnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2348, "favorite_count": 1, "accepted_answer_id": 42015523, "answer_count": 1, "score": 0, "last_activity_date": 1586459581, "creation_date": 1485973200, "last_edit_date": 1491923697, "question_id": 41986878, "link": "https://stackoverflow.com/questions/41986878/import-xml-into-mc-access-with-transform-file-in-visual-basic", "title": "Import XML into mc access with transform file in visual basic", "body": "<p>What I would like to do is have a button import an XML file into ms access with a XSLT file.</p>\n\n<p>Here is my vb code right now (which is kind of a mess, new to this):</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Function CreateDOM()\n    Dim dom\n    Set dom = New DOMDocument60\n    dom.async = False\n    dom.validateOnParse = False\n    dom.resolveExternals = False\n    Set CreateDOM = dom\nEnd Function\n\nPrivate Sub impotr_Click()\n    Dim strFileList() As String 'File Array\n    Dim strFile As String 'Filename\n    Dim intFile As Integer 'File Number\n    Dim strPath As String ' Path to file folder\n    Dim doc, xsl, out, str\n\n    Set doc = CreateDOM\n    doc.Load \"C:\\test\\test.xml\"\n    strPath = \"C:\\test\\\"\n    strFile = Dir(strPath &amp; \"*.XML\")\n\n    Set xsl = CreateDOM\n    xsl.Load \"C:\\test\\transformer.xsl\"\n\n    While strFile &lt;&gt; \"\"\n           'add files to the list\n          intFile = intFile + 1\n          ReDim Preserve strFileList(1 To intFile)\n          strFileList(intFile) = strFile\n          strFile = Dir()\n      Wend\n\n\n       'see if any files were found\n    If intFile = 0 Then\n          MsgBox \"No files found\"\n          Exit Sub\n    End If\n\n      'cycle through the list of files\n      For intFile = 1 To UBound(strFileList)\n          On Error Resume Next\n          Application.ImportXml strPath &amp; strFileList(intFile), 2\n\n      Next intFile\n\n\n    str = doc.transformNode(xsl)\n\n    Set out = CreateDOM\n    doc.transformNodeToObject xsl, out\n\n    MsgBox \"Import Completed\"\nEnd Sub\n</code></pre>\n\n<p>XML file:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;iavmNotice xmlns=\"http://stuff.com\" noticeId=\"138643\"&gt;\n   &lt;xmlUrl&gt;https://fakexmlurl.xml&lt;/xmlUrl&gt;\n   &lt;htmlUrl&gt;https://fakehtmlurl.htm&lt;/htmlUrl&gt;\n   &lt;iavmNoticeNumber&gt;2012-B-0080&lt;/iavmNoticeNumber&gt;\n   &lt;title&gt;Cisco Vulnerability&lt;/title&gt;\n   &lt;type&gt;B&lt;/type&gt;\n   &lt;state&gt;FINAL&lt;/state&gt;\n   &lt;lastSaved&gt;2012-08-24T10:34:13&lt;/lastSaved&gt;\n   &lt;precoordDueDate&gt;2012-08-23T11:00:00&lt;/precoordDueDate&gt;\n   &lt;releaseDate&gt;2012-08-23&lt;/releaseDate&gt;\n   &lt;acknowledgeDate&gt;2012-08-28&lt;/acknowledgeDate&gt;\n   &lt;knownExploits&gt;true&lt;/knownExploits&gt;\n   &lt;knownDodIncidents&gt;false&lt;/knownDodIncidents&gt;\n   &lt;executiveSummary&gt;Cisco incidents.&lt;/executiveSummary&gt;\n   &lt;techOverview&gt;\n      &lt;entry&gt;\n         &lt;title&gt;2012-2490&lt;/title&gt;\n         &lt;description&gt;Cisco ID 71.&lt;/description&gt;\n      &lt;/entry&gt;\n   &lt;/techOverview&gt;\n   &lt;fixAction&gt;Apply appropriate vendor update&lt;/fixAction&gt;\n   &lt;note&gt;&amp;lt;b&amp;gt;Upgrade later&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&lt;/note&gt;\n   &lt;tempMitStrat&gt;\n      &lt;header&gt;&amp;lt;b&amp;gt;Cisco &amp;lt;/b&amp;gt;&lt;/header&gt;\n      &lt;body&gt;&amp;lt;br&amp;gt;None&lt;/body&gt;\n   &lt;/tempMitStrat&gt;\n   &lt;vulnAppsSysAndCntrmsrs&gt;Cisco IP Communicator 8.6&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&lt;/vulnAppsSysAndCntrmsrs&gt;\n   &lt;references&gt;\n   &lt;reference&gt;\n      &lt;title&gt;Release Notes for Cisco IP Communicator Release 8.6&lt;/title&gt;\n      &lt;url&gt;http://www.fakeurl.com/html&lt;/url&gt;\n   &lt;/reference&gt;\n   &lt;/references&gt;\n   &lt;deepSightBids&gt;\n      &lt;bid&gt;54850&lt;/bid&gt;\n   &lt;/deepSightBids&gt;\n   &lt;revisions&gt;\n      &lt;revision&gt;\n         &lt;majorNum&gt;0&lt;/majorNum&gt;\n         &lt;minorNum&gt;0&lt;/minorNum&gt;\n         &lt;type&gt;MAJOR&lt;/type&gt;\n         &lt;date&gt;2012-08-23&lt;/date&gt;\n         &lt;details&gt;Initial Release&lt;/details&gt;\n      &lt;/revision&gt;\n      &lt;revision&gt;\n         &lt;majorNum&gt;0&lt;/majorNum&gt;\n         &lt;minorNum&gt;1&lt;/minorNum&gt;\n         &lt;type&gt;MINOR&lt;/type&gt;\n         &lt;date&gt;2012-08-24&lt;/date&gt;\n         &lt;details&gt;Updated Retina Audit&lt;/details&gt;\n      &lt;/revision&gt;\n   &lt;/revisions&gt;\n   &lt;patches&gt;\n      &lt;patch&gt;\n         &lt;type&gt;V&lt;/type&gt;\n         &lt;title&gt;Cisco&lt;/title&gt;\n         &lt;url&gt;http://www.fake.com&lt;/url&gt;\n      &lt;/patch&gt;\n   &lt;/patches&gt;\n   &lt;scanners&gt;\n      &lt;retina&gt;Audit 2548&lt;/retina&gt;\n   &lt;/scanners&gt;\n   &lt;vms&gt;\n      &lt;stigFindingSeverity&gt;1&lt;/stigFindingSeverity&gt;\n      &lt;affectedEnvs&gt;B&lt;/affectedEnvs&gt;\n      &lt;posture&gt;1029&lt;/posture&gt;\n      &lt;posture&gt;1712&lt;/posture&gt;\n      &lt;posture&gt;59&lt;/posture&gt;\n   &lt;/vms&gt;\n&lt;/iavmNotice&gt;\n</code></pre>\n\n<p>XSL file:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;xsl:stylesheet xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" version=\"1.0\"\n                xmlns:stuff=\"http://stuff.com\"  exclude-result-prefixes=\"stuff\"&gt;\n&lt;xsl:output version=\"1.0\" encoding=\"UTF-8\" indent=\"yes\" /&gt;\n&lt;xsl:strip-space elements=\"*\"/&gt;\n\n  &lt;!-- Identity Transform --&gt;\n  &lt;xsl:template match=\"@*|node()\"&gt;\n    &lt;xsl:copy&gt;\n      &lt;xsl:apply-templates select=\"@*|node()\"/&gt;\n    &lt;/xsl:copy&gt;\n  &lt;/xsl:template&gt;  \n\n  &lt;xsl:template match=\"stuff:entry|stuff:tempMitStrat|stuff:reference|stuff:deepSightBids|\n                       stuff:revision|stuff:patch|stuff:scanners|stuff:vms\"&gt;\n    &lt;xsl:copy&gt;      \n      &lt;xsl:copy-of select=\"ancestor::stuff:iavmNotice/stuff:iavmNoticeNumber\"/&gt;\n      &lt;xsl:apply-templates/&gt;\n    &lt;/xsl:copy&gt;\n  &lt;/xsl:template&gt;\n</code></pre>\n\n<p>Everything works when I import it through ms access but I need help with is the visual basic code that will transform the XML then import it.</p>\n"}, {"tags": ["excel", "vba", "date"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1485972389, "post_id": 41986445, "comment_id": 71150967, "body": "I assume that this is part of an <b>Event</b> macro......if this is true then format the entire column as <i>Text</i> <b>before</b> entering any data into it.  Your problem may be that Excel formats the data prior to the Event macro getting to see it."}], "answers": [{"tags": [], "owner": {"reputation": 887, "user_id": 5688082, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/6f68631525f101fb84fc1bd0858a4591?s=128&d=identicon&r=PG&f=1", "display_name": "dgan", "link": "https://stackoverflow.com/users/5688082/dgan"}, "is_accepted": false, "score": 0, "last_activity_date": 1485995364, "creation_date": 1485995364, "answer_id": 41992345, "question_id": 41986445, "link": "https://stackoverflow.com/questions/41986445/excel-vba-format-date-with-slashes-as-typed-in-cell/41992345#41992345", "title": "excel vba format date with slashes as typed in cell?", "body": "<p>Just keep it simple and obvious...No?</p>\n\n<pre><code>Dim Cell As Range, CellVal As String, dim Dt as Date\n  If Not Intersect(Target, ActiveSheet.Columns(\"B\")) Is Nothing Then\n      For Each Cell In Intersect(Target, ActiveSheet.Columns(\"B\"))\n          val = Cell.Value\n\n          if instr(val,\".\")&gt;0 then 'check if this particular char is present\n            temp = split(val,\".\")\n            day= temp(0)\n            month=temp(1)\n            year=temp(2)\n            Dt = DateSerial(year, month, day)\n            Cell.Value= Format(Dt, \"dd/mm/yy\") 'you can change this to \"dd-mmm-yyyy\" or whatever\n         else if instr(val,\"/\")&gt;0 then\n            temp =  Split(val,\"/\")\n            day= temp(0)\n            month=temp(1)\n            year=temp(2)\n            Dt = DateSerial(year, month, day)\n            Cell.Value= Format(Dt, \"dd/mm/yy\")\n         else if len(val) = 8 then\n            day = left(val,2) ' start at first, and take 2\n            month = mid(val, 3,2) 'start a 3rd char and take 2\n            year = right(val,4)\n            Dt = DateSerial(year, month, day)\n            Cell.Value= Format(Dt, \"dd/mm/yy\")\n         else if len(val) = 6 then\n            day = left(val,2) ' start at first, and take 2\n            month = mid(val, 3,2) 'start a 3rd char and take 2\n            year = right(val,2)\n            year = year +2000\n            Dt = DateSerial(year, month, day)\n            Cell.Value= Format(Dt, \"dd/mm/yy\")\n         end if\n      Next Cell\n  End If\n</code></pre>\n\n<p>I could have make some mistakes in func. parameters here, because it's 1:30 in the morning, and I dont have excel at my laptop, but I think I got right the main part :)</p>\n"}], "owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 867, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485995364, "creation_date": 1485971621, "question_id": 41986445, "link": "https://stackoverflow.com/questions/41986445/excel-vba-format-date-with-slashes-as-typed-in-cell", "title": "excel vba format date with slashes as typed in cell?", "body": "<p>Users can enter a date in column B freely like so:</p>\n\n<p>(Dates in uk format)\nColumn B</p>\n\n<pre><code>02/01/2017\n02.01.2017\n01.01.17\n01012017\n010117\n</code></pre>\n\n<p>Its extremely frustrating when we want to run a report that these date formats are not consistent.</p>\n\n<p>I am trying to create a code which will format the date, however it's entered with slashes like so:</p>\n\n<pre><code>02/01/2017\n02/01/2017\n01/01/2017\n01/01/2017\netc...\n</code></pre>\n\n<p>Here is my code:</p>\n\n<pre><code>Dim Cell As Range, CellVal As String\n  If Not Intersect(Target, ActiveSheet.Columns(\"B\")) Is Nothing Then\n      For Each Cell In Intersect(Target, ActiveSheet.Columns(\"B\"))\n          CellVal = Cell.Value\n          If (Not CellVal Like \"*[!0-9]*\") And (Len(CellVal) &gt; 4) Then\n              CellVal = Format(CellVal, \"@@ @@ @@\")\n              Cell.Value = CDate(WorksheetFunction.Replace(CellVal, 4, 2, MonthName(Mid(CellVal, 4, 2))))\n              Cell.NumberFormat = \"dd/mm/yyyy\"\n          End If\n      Next Cell\n  End If\n</code></pre>\n\n<p>This only seems to work if the user enters a 9 digit format like so:</p>\n\n<pre><code>01012017\n</code></pre>\n\n<p>This is then changed to</p>\n\n<pre><code>   01/01/2017\n</code></pre>\n\n<p>But if the user enters </p>\n\n<pre><code>010117\n</code></pre>\n\n<p>Then this translates to:</p>\n\n<pre><code>28/01/1955   &lt;---This is wrong\n</code></pre>\n\n<p>The other thing, users may enter dots:</p>\n\n<pre><code>01.01.2017\n</code></pre>\n\n<p>Then the code just doesn't work at all.</p>\n\n<p>Please can someone show me a better way to do this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1485971547, "post_id": 41986237, "comment_id": 71150467, "body": "no inbuilt full path return feature in <code>Dir</code>. Just use <code>Workbooks.Open (wbPath &amp; &quot;\\&quot; &amp; FName)</code>"}, {"owner": {"reputation": 343, "user_id": 4898713, "user_type": "registered", "profile_image": "https://graph.facebook.com/1189342967759685/picture?type=large", "display_name": "Wujaszkun", "link": "https://stackoverflow.com/users/4898713/wujaszkun"}, "edited": false, "score": 0, "creation_date": 1485972063, "post_id": 41986237, "comment_id": 71150786, "body": "I have checked your code and indeed Excel didn&#39;t assign anything to <code>wbPath</code>. The way it could be fixed is to save the file, which is logical - there is no path to an unsaved file."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1486275910, "post_id": 41986237, "comment_id": 71270917, "body": "@Devman have you tested any of the code you got as answers below ? any feedback ?"}, {"owner": {"reputation": 3, "user_id": 7501510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/268508df40d051e9d912c6dacbad8028?s=128&d=identicon&r=PG&f=1", "display_name": "Devman", "link": "https://stackoverflow.com/users/7501510/devman"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1486392780, "post_id": 41986237, "comment_id": 71312518, "body": "@Shai Rado; Yes, cyboashu&#39;s answer above works and your answer below also works.  Many thanks to both of you!"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1486393047, "post_id": 41986237, "comment_id": 71312711, "body": "So mark either one of the answers as &quot;answer&quot;, by clicking the <b>V</b> next to their answer"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1485971883, "creation_date": 1485971883, "answer_id": 41986523, "question_id": 41986237, "link": "https://stackoverflow.com/questions/41986237/excel-vb-filepath-concatenation-not-working/41986523#41986523", "title": "Excel VB Filepath Concatenation not Working", "body": "<p><code>Dir()</code> does not return the path part:</p>\n\n<pre><code>Sub dural()\n    fname = Dir(\"C:\\Users\\garys\\desktop\\*.*\")\n    MsgBox fname\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/EA2vt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EA2vt.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1485975395, "last_edit_date": 1485975395, "creation_date": 1485972684, "answer_id": 41986742, "question_id": 41986237, "link": "https://stackoverflow.com/questions/41986237/excel-vb-filepath-concatenation-not-working/41986742#41986742", "title": "Excel VB Filepath Concatenation not Working", "body": "<p>If you meant to loop through all files in Folder \"H:\\Folder\\123456\" use the code below.</p>\n\n<p><strong>Note</strong>: I've added a criteria test <code>Like \"*.csv\"</code>, this will only open files with \".csv\" extension.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Sub LoopCSVFiles()\n\nDim wbPath As String\nDim PathTextPart2 As String\nDim FName As String\n\nPathTextPart2 = 123456\nwbPath = ThisWorkbook.Path &amp; \"\\\" &amp; PathTextPart2 &amp; \"\\\" ' \"H:\\Folder\"\\123456\\\"\nFName = Dir(wbPath)\n\n' loop through all files in folder\nDo Until FName = \"\"\n    If FName Like \"*.csv\" Then ' only open files with .csv extension\n        Workbooks.Open (FName)\n        ' put the rest of your code here\n\n    End If\n    FName = Dir()\nLoop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7501510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/268508df40d051e9d912c6dacbad8028?s=128&d=identicon&r=PG&f=1", "display_name": "Devman", "link": "https://stackoverflow.com/users/7501510/devman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 41986742, "answer_count": 2, "score": 0, "last_activity_date": 1485975395, "creation_date": 1485971009, "last_edit_date": 1531164843, "question_id": 41986237, "link": "https://stackoverflow.com/questions/41986237/excel-vb-filepath-concatenation-not-working", "title": "Excel VB Filepath Concatenation not Working", "body": "<p>I have a macro in an Excel xlsm file designed to open and close a number of csv files within a certain folder while extracting information from them. The following is representative of the code:</p>\n\n<pre><code>Dim wbPath As String\nDim PathTextPart2 As String\nDim FName As String\n\nPathTextPart2 = 123456\nwbPath = ThisWorkbook.Path  '=\"H:\\Folder\"\nFName = Dir(wbPath &amp; \"\\\" &amp; PathTextPart2 &amp; \"PathTextPart3*.csv\")\nWorkbooks.Open (FName)\n</code></pre>\n\n<p>The macro fails because FName returns \"123456PathTextPart3789.csv\", somehow leaving off \"H:\\Folder\\\" at the beginning of the string.  I have searched for solutions to my problem, but did not find any.  Can anyone spot what the problem is?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 2, "creation_date": 1485970020, "post_id": 41985860, "comment_id": 71149525, "body": "its the TabIndex property for control. Also, in the View Menu--Tab Order item allows you to manage tabs for all the controls on a user form."}, {"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1485970688, "post_id": 41985860, "comment_id": 71149957, "body": "@cyboashu Excellent tip with the view&gt;tab order, thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 7406786, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-iwIOdgYVqTk/AAAAAAAAAAI/AAAAAAAABJQ/X9hnIYvyRUw/photo.jpg?sz=128", "display_name": "David Quetglas", "link": "https://stackoverflow.com/users/7406786/david-quetglas"}, "edited": false, "score": 0, "creation_date": 1485980068, "post_id": 41985900, "comment_id": 71155087, "body": "You&#39;re the best!!! I thought that had meant to bring back or forward an object. WOW THANK YOU"}], "tags": [], "owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "is_accepted": true, "score": 1, "last_activity_date": 1485969943, "creation_date": 1485969943, "answer_id": 41985900, "question_id": 41985860, "link": "https://stackoverflow.com/questions/41985860/userform-excel-finding-the-order-of-the-codebuttons-etc-inorder-to-change-s/41985900#41985900", "title": "Userform Excel: finding the order of the code(buttons etc), inorder to change, so the user can press &#39;tab&#39; on form and it will move to the next one", "body": "<p>Each object on the Userform has a TabIndex property, adjust the numbering for each object to adjust the order.</p>\n"}], "owner": {"reputation": 87, "user_id": 7406786, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-iwIOdgYVqTk/AAAAAAAAAAI/AAAAAAAABJQ/X9hnIYvyRUw/photo.jpg?sz=128", "display_name": "David Quetglas", "link": "https://stackoverflow.com/users/7406786/david-quetglas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "accepted_answer_id": 41985900, "answer_count": 1, "score": 0, "last_activity_date": 1489498866, "creation_date": 1485969799, "last_edit_date": 1489498866, "question_id": 41985860, "link": "https://stackoverflow.com/questions/41985860/userform-excel-finding-the-order-of-the-codebuttons-etc-inorder-to-change-s", "title": "Userform Excel: finding the order of the code(buttons etc), inorder to change, so the user can press &#39;tab&#39; on form and it will move to the next one", "body": "<p>I want to fix the order of the cursor when the user presses 'tab' to go in order. Not sure where the order is, i've tried moving around everything in the VBA</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 67, "user_id": 7151732, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/41c0591e42c794173d8d2e6a8e2ea930?s=128&d=identicon&r=PG&f=1", "display_name": "Elena", "link": "https://stackoverflow.com/users/7151732/elena"}, "edited": false, "score": 0, "creation_date": 1486031076, "post_id": 41985432, "comment_id": 71175796, "body": "could anybody help with the above please? thanks very much in advance."}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1486130410, "post_id": 41985432, "comment_id": 71225839, "body": "This isn&#39;t really something that can be done easily; excel doesn&#39;t have an option to have multiple panes side-by-side so that one pane is static while the other can move. As you state - you can split and freeze panes, but if you&#39;ve already considered that and discarded it I see two options really. 1) Have a worksheet scroll macro that repositions all your buttons each time the worksheet is scrolled so they are effectively stationary or create a userform with the buttons on and show it non-modally; this is essentially a separate window so scrolling of the worksheet shouldn&#39;t effect it."}, {"owner": {"reputation": 67, "user_id": 7151732, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/41c0591e42c794173d8d2e6a8e2ea930?s=128&d=identicon&r=PG&f=1", "display_name": "Elena", "link": "https://stackoverflow.com/users/7151732/elena"}, "reply_to_user": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1486148087, "post_id": 41985432, "comment_id": 71236760, "body": "Thanks Flephal, I would try a worksheet scroll macro but not sure how to write it. If you could advise, that would be greatly appreciated. Thanks"}, {"owner": {"reputation": 67, "user_id": 7151732, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/41c0591e42c794173d8d2e6a8e2ea930?s=128&d=identicon&r=PG&f=1", "display_name": "Elena", "link": "https://stackoverflow.com/users/7151732/elena"}, "reply_to_user": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1486222024, "post_id": 41985432, "comment_id": 71257427, "body": "I&#39;m sorry to be a pain, if you could look into I&#39;d be hugely grateful? Thank you"}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1486230710, "post_id": 41985432, "comment_id": 71260331, "body": "I&#39;ve had a quick look around and tried a few things, but there doesn&#39;t appear to easily be a scroll event that can be captured. I think a userform is the way forward for this option..."}, {"owner": {"reputation": 67, "user_id": 7151732, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/41c0591e42c794173d8d2e6a8e2ea930?s=128&d=identicon&r=PG&f=1", "display_name": "Elena", "link": "https://stackoverflow.com/users/7151732/elena"}, "reply_to_user": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1486231775, "post_id": 41985432, "comment_id": 71260707, "body": "Oh ok :(  thanks for trying"}], "owner": {"reputation": 67, "user_id": 7151732, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/41c0591e42c794173d8d2e6a8e2ea930?s=128&d=identicon&r=PG&f=1", "display_name": "Elena", "link": "https://stackoverflow.com/users/7151732/elena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1485971012, "creation_date": 1485968443, "last_edit_date": 1485971012, "question_id": 41985432, "link": "https://stackoverflow.com/questions/41985432/scroll-a-page-up-and-down-and-across-specific-range", "title": "scroll a page up and down and across specific range", "body": "<p>I have a worksheet with multiple command buttons / shapes assigned to macros that my users can click on to perform certain  actions. However, I want this worksheet to look a  bit more \"professional\" like a dashboard so I would need to be able to show all these buttons on the top left hand side corner of the first page (say in column A). </p>\n\n<p>The problem is that my worksheet is several pages long and when I scroll down, the buttons disappear too as they stay on the first page. </p>\n\n<p>I know I can freeze the first page but it doesn't look right because I have too many buttons to fit in the first couple of rows. For example doesn't look user friendly to freeze the first 10 rows, hence I want to have all these button on the top left hand side corner of the first page. </p>\n\n<p>I've come up with the following code to allow the user to scroll but it doesn't seem to work: </p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Worksheets(\"dummy\").ScrollArea = \"B1:AA5000\"\nEnd Sub\n</code></pre>\n\n<p>Your help is much appreciated and any questions then please let me know.    </p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1485969643, "post_id": 41984894, "comment_id": 71149253, "body": "that seems like a pretty inefficient way to generate CSV because of the many string concatenations, so if it starts to get too slow you can <code>Join</code> the strings and replace all with single Regex."}], "answers": [{"comments": [{"owner": {"reputation": 2295, "user_id": 1873386, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8edc08129abcfef8b73d6bd8d1bd2bf5?s=128&d=identicon&r=PG", "display_name": "crashwap", "link": "https://stackoverflow.com/users/1873386/crashwap"}, "edited": false, "score": 0, "creation_date": 1485967638, "post_id": 41984989, "comment_id": 71148044, "body": "Looking to be efficient, can I also do this: <code>Dim Report as String, CurrLine, CurrDate, CurrTask, St</code> ? <i>The goal being to do as much on a single line as possible</i>"}, {"owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "reply_to_user": {"reputation": 2295, "user_id": 1873386, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8edc08129abcfef8b73d6bd8d1bd2bf5?s=128&d=identicon&r=PG", "display_name": "crashwap", "link": "https://stackoverflow.com/users/1873386/crashwap"}, "edited": false, "score": 1, "creation_date": 1485967821, "post_id": 41984989, "comment_id": 71148170, "body": "absolutely, however currline and followings will have data type variant, not string"}, {"owner": {"reputation": 2295, "user_id": 1873386, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8edc08129abcfef8b73d6bd8d1bd2bf5?s=128&d=identicon&r=PG", "display_name": "crashwap", "link": "https://stackoverflow.com/users/1873386/crashwap"}, "edited": false, "score": 0, "creation_date": 1485967930, "post_id": 41984989, "comment_id": 71148240, "body": "So I can leave out the <code>as String</code> bit and just use <code>Dim Report, CurrLine, CurrDate, CurrTask, St</code> and the code will still work just fine..?"}, {"owner": {"reputation": 2295, "user_id": 1873386, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8edc08129abcfef8b73d6bd8d1bd2bf5?s=128&d=identicon&r=PG", "display_name": "crashwap", "link": "https://stackoverflow.com/users/1873386/crashwap"}, "edited": false, "score": 0, "creation_date": 1485968191, "post_id": 41984989, "comment_id": 71148402, "body": "Thanks - you solved my problem(s). Trust Microsoft to be out of step. I was in the VBA editor and used Ctrl+Z to undo a few changes, then used Ctrl+Y to put them back... I will be bald because of Microsoft."}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "reply_to_user": {"reputation": 2295, "user_id": 1873386, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8edc08129abcfef8b73d6bd8d1bd2bf5?s=128&d=identicon&r=PG", "display_name": "crashwap", "link": "https://stackoverflow.com/users/1873386/crashwap"}, "edited": false, "score": 0, "creation_date": 1485968395, "post_id": 41984989, "comment_id": 71148541, "body": "@crashwap eeeer not great form, if you want to do it in a single line use the format: Dim a as long, b as string, c as Double.  If you leave out the dimensioning they will be variants, which is what&#39;s needed for st in this case, but it&#39;s not really appropriate for the rest"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1485969115, "post_id": 41984989, "comment_id": 71148955, "body": "<code>Dim St() As String</code> or <code>Dim St$()</code> as <code>Split</code> always returns String array"}], "tags": [], "owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "is_accepted": true, "score": 5, "last_activity_date": 1485967151, "creation_date": 1485967151, "answer_id": 41984989, "question_id": 41984894, "link": "https://stackoverflow.com/questions/41984894/get-nth-element-from-vba-string-array/41984989#41984989", "title": "Get nth element from VBA string array", "body": "<p>a possible solution</p>\n\n<pre><code>Dim Report As String\nDim CurrLine As String\nDim CurrDate As String\nDim CurrTask As String, St \n\n\nCurrLine = \"TEST - 2017/01/20 = Invoice\"\nSt=Split(replace(CurrLine, \"=\",\"-\"),\"-\")\nCurrDate = St(1)\nCurrTask = St(2)\nReport = Report &amp; CHR(34) &amp; CurrDate &amp; CHR(34) &amp; \",\" &amp; CHR(34) &amp; CurrTask &amp; CHR(34)  //result: \"2017/01/20\",\"Invoice\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 3, "last_activity_date": 1485967338, "creation_date": 1485967338, "answer_id": 41985058, "question_id": 41984894, "link": "https://stackoverflow.com/questions/41984894/get-nth-element-from-vba-string-array/41985058#41985058", "title": "Get nth element from VBA string array", "body": "<p>I would have used the solution of @h2so4 with replacement (especially if it is a job related task), but if you are a fan of \"fancy\" coding, this works as well:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Test()\n\n    Dim strtest As String\n\n    strtest = \"Test - 2017 / 1 / 20 = Invoice\"\n\n    Debug.Print Trim(Split(strtest, \"-\")(1))\n    Debug.Print Trim(Split(strtest, \"=\")(1))\n    Debug.Print Trim(Split(Trim(Split(strtest, \"-\")(1)), \"=\")(0))\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2295, "user_id": 1873386, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8edc08129abcfef8b73d6bd8d1bd2bf5?s=128&d=identicon&r=PG", "display_name": "crashwap", "link": "https://stackoverflow.com/users/1873386/crashwap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3162, "favorite_count": 1, "accepted_answer_id": 41984989, "answer_count": 2, "score": 4, "last_activity_date": 1519383319, "creation_date": 1485966845, "last_edit_date": 1531164843, "question_id": 41984894, "link": "https://stackoverflow.com/questions/41984894/get-nth-element-from-vba-string-array", "title": "Get nth element from VBA string array", "body": "<p>How would I extract the nth element from a VBA string array?</p>\n\n<p>I have a string, like: <code>TEST - 2017/01/20 = Invoice</code></p>\n\n<p>I wish to extract out the 2nd and 3rd elements as concisely as possible.  I was trying something Javascripty like this, which doesn't work, so there must be a VBA way:</p>\n\n<pre><code>Dim Report As String\nDim CurrLine As String\nDim CurrDate As String\nDim CurrTask As String\n\nCurrLine = \"TEST - 2017/01/20 = Invoice\"\nCurrDate = Trim(Split(CurrLine, '-')[1])\nCurrTask = Trim(Split(CurrLine, '=')[1])\nReport = Report &amp; CHR(34) &amp; CurrDate &amp; CHR(34) &amp; \",\" &amp; CHR(34) &amp; CurrTask &amp; CHR(34)\n\n//result: \"2017/01/20\",\"Invoice\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1485966374, "post_id": 41984657, "comment_id": 71147273, "body": "Look into Fuzzy matching. It will be hard to match the different names without a standardized pattern."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1485966511, "post_id": 41984657, "comment_id": 71147345, "body": "You could probably use <code>InStr</code> to determine if each of the words in your desired name was in the slightly variant name and if so, perform a replacement based on that but it&#39;s not going to be too easy.  Search for Fuzzy Matching and it may be of use"}, {"owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "edited": false, "score": 0, "creation_date": 1485967708, "post_id": 41984657, "comment_id": 71148089, "body": "you should have a look at this : <a href=\"https://en.wikipedia.org/wiki/Levenshtein_distance\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Levenshtein_distance</a>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485970369, "post_id": 41984657, "comment_id": 71149747, "body": "you could add another column B (on the right side of this column), and this columns you will write down the &quot;Clean Names&quot;, like <code>General Mills</code> , <code>Eurostock Foods</code> and then use a loop and <code>Match</code> to replace all values in column A with the Matches in Column B (&quot;Clean Names&quot;)"}, {"owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485971112, "post_id": 41984657, "comment_id": 71150201, "body": "@ShaiRado how could i do this?"}], "owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1485966116, "creation_date": 1485966116, "question_id": 41984657, "link": "https://stackoverflow.com/questions/41984657/excel-rename-similar-values", "title": "Excel: Rename similar values?", "body": "<p>I have a sheet of data with supplier names like below. The problem is the names have been spelt slightly differently.</p>\n\n<pre><code> Column F\n    GB - General Mills Uk\n    General Mills Uk\n    General Mills\n    Eurostock Foods\n    EurostockFoods\n    INT - Eurostock foods\n</code></pre>\n\n<p>Is there anyway i can rename these suppliers to match like so:</p>\n\n<pre><code>Column F\nGeneral Mills\nGeneral Mills\nGeneral Mills\nEurostock Foods\nEurostock Foods\nEurostock Foods\n</code></pre>\n\n<p>To be honest i wouldn't even know where to begin here, although using vba i would imagine it would be something like this:</p>\n\n<p>Loop through each cell in column F and see if the cell above is like the current cell, if true rename current cell to cell above...</p>\n\n<pre><code>    Sub FindMatchingValue()\n        Dim i as Integer, intValueToFind as integer\n        intValueToFind = ActiveCell.Offset(-1,0).Value\n        For i = 1 to 500    ' Revise the 500 to include all of your values\n            If Cells(i,1).Value Like intValueToFind then \n                Cells.Value = ActiveCell.Offset(-1,0).Value\n                Exit Sub\n            End If\n        Next i\n</code></pre>\n\n<p>End Sub</p>\n\n<p>This doesn't work and i need some help to get this to do what i need. I am brand new to vba so any help would be really appreciated.</p>\n"}, {"tags": ["c#", "excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1485966163, "post_id": 41984585, "comment_id": 71147122, "body": "<code>I can not find which Macro is called on button click</code> - right click the button and see?"}, {"owner": {"reputation": 552, "user_id": 4501281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db35fccc8dbaae603ef15011431f95a7?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan C", "link": "https://stackoverflow.com/users/4501281/ryan-c"}, "edited": false, "score": 0, "creation_date": 1485966730, "post_id": 41984585, "comment_id": 71147482, "body": "Details about how to add Developer tab to Excel and assigning Macro to buttons, you&#39;ll just do the reverse to find out what&#39;s currently assigned: <a href=\"https://support.office.com/en-us/article/Assign-a-macro-to-a-Form-or-a-Control-button-d58edd7d-cb04-4964-bead-9c72c843a283\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 45, "user_id": 6685727, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7aab5ad84a21c62a80f767528ea1ffb9?s=128&d=identicon&r=PG&f=1", "display_name": "Skye", "link": "https://stackoverflow.com/users/6685727/skye"}, "edited": false, "score": 0, "creation_date": 1485966824, "post_id": 41984585, "comment_id": 71147552, "body": "I tried that but its not working."}, {"owner": {"reputation": 45, "user_id": 6685727, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7aab5ad84a21c62a80f767528ea1ffb9?s=128&d=identicon&r=PG&f=1", "display_name": "Skye", "link": "https://stackoverflow.com/users/6685727/skye"}, "edited": false, "score": 0, "creation_date": 1485967432, "post_id": 41984585, "comment_id": 71147920, "body": "Insert option and right click are disabled on button and macros are also password protected."}, {"owner": {"reputation": 19955, "user_id": 101087, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/646f0fa3075659904242cf6f576ed2e9?s=128&d=identicon&r=PG", "display_name": "NineBerry", "link": "https://stackoverflow.com/users/101087/nineberry"}, "edited": false, "score": 0, "creation_date": 1485993851, "post_id": 41984585, "comment_id": 71161237, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/130166/clicking-command-button-from-other-workbook\">&quot;Clicking&quot; Command Button from other workbook</a>"}], "answers": [{"tags": [], "owner": {"reputation": 173, "user_id": 3847207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e177b9ef9729e7b4feaeaca796b49590?s=128&d=identicon&r=PG&f=1", "display_name": "zaphodalive", "link": "https://stackoverflow.com/users/3847207/zaphodalive"}, "is_accepted": false, "score": 0, "last_activity_date": 1485993477, "creation_date": 1485993477, "answer_id": 41992082, "question_id": 41984585, "link": "https://stackoverflow.com/questions/41984585/invoke-button-in-excel-programatically-c/41992082#41992082", "title": "Invoke Button in Excel Programatically C#", "body": "<p>If Insert is disabled on the Developer tab and right-click is disabled on the button, then it sounds like the worksheet or workbook is protected.  And if the VBA Project is password protected then I don't think you'll be able to find out the name of the macro that is called.</p>\n"}], "owner": {"reputation": 45, "user_id": 6685727, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7aab5ad84a21c62a80f767528ea1ffb9?s=128&d=identicon&r=PG&f=1", "display_name": "Skye", "link": "https://stackoverflow.com/users/6685727/skye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 702, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489139441, "creation_date": 1485965912, "last_edit_date": 1531164843, "question_id": 41984585, "link": "https://stackoverflow.com/questions/41984585/invoke-button-in-excel-programatically-c", "title": "Invoke Button in Excel Programatically C#", "body": "<p>I have an Excel file with some macro's defined which are invoked on a button click. I can not find which Macro is called on button click. Is there any way I can find that ? How do I invoke button programmatically in C# ?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1485965789, "post_id": 41984459, "comment_id": 71146875, "body": "Are you calling this from a cell? If so, it won&#39;t work."}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1485966058, "post_id": 41984459, "comment_id": 71147049, "body": "Try <code>Set shAux = Workbooks.Open(Filename:=&quot;C:\\Dados\\People\\Projects\\person1.x&zwnj;&#8203;lsx&quot;).Sheets(&quot;sheet1&zwnj;&#8203;&quot;)</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1485966068, "post_id": 41984459, "comment_id": 71147056, "body": "Try to use this -&gt; <code>Set shAux </code>"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1485966257, "post_id": 41984459, "comment_id": 71147190, "body": "For future reference, providing details of the error you are getting definitely helps.  The first issue I can see is that you are trying to set an object reference without the <code>Set</code> keyword in place as @Vityata has suggested."}, {"owner": {"reputation": 128, "user_id": 1298004, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d6ce91dffe0330d2e55a7dcb0461e4e1?s=128&d=identicon&r=PG", "display_name": "noitib", "link": "https://stackoverflow.com/users/1298004/noitib"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1485966375, "post_id": 41984459, "comment_id": 71147275, "body": "yes I am @Rory . Is there an alternative way to do this from a cell?"}, {"owner": {"reputation": 128, "user_id": 1298004, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d6ce91dffe0330d2e55a7dcb0461e4e1?s=128&d=identicon&r=PG", "display_name": "noitib", "link": "https://stackoverflow.com/users/1298004/noitib"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1485966639, "post_id": 41984459, "comment_id": 71147430, "body": "@Dave I tried to use the <code>Set</code> keyword and setting the sheet name between quotation marks with no luck. When I call the function from a cell, the cell gets <code>#VALUE!</code>"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1485967600, "post_id": 41984459, "comment_id": 71148017, "body": "what exactly are you hoping to archive when using the  <code>=TipoProjeto()</code> function? Do you want to find a string related to the string in the function?"}, {"owner": {"reputation": 128, "user_id": 1298004, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d6ce91dffe0330d2e55a7dcb0461e4e1?s=128&d=identicon&r=PG", "display_name": "noitib", "link": "https://stackoverflow.com/users/1298004/noitib"}, "reply_to_user": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1485967949, "post_id": 41984459, "comment_id": 71148250, "body": "@VBAPete the <code>TipoProjeto</code> function receives a string that will match a file on the  <code>C:\\Dados\\People\\Projects</code> folder. Let&#39;s say <code>TipoProjeto(&quot;VBAPete&quot;)</code> will search for a file named <code>VBAPete.xlsx</code> and then output the value of cell B2"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1485968864, "post_id": 41984459, "comment_id": 71148805, "body": "I can&#39;t find anything on opening workbooks using a function. There might be limitation of what you can use inside of a function."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1485968976, "post_id": 41984459, "comment_id": 71148864, "body": "You can&#39;t open a workbook from a UDF. Google Harlan coben&#39;s Pull function."}], "answers": [{"tags": [], "owner": {"reputation": 324, "user_id": 6421449, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-byMP_uB_itg/AAAAAAAAAAI/AAAAAAAAF9c/zan1F_ZCbwI/photo.jpg?sz=128", "display_name": "zatbusch", "link": "https://stackoverflow.com/users/6421449/zatbusch"}, "is_accepted": true, "score": 1, "last_activity_date": 1486049437, "creation_date": 1486049437, "answer_id": 42006187, "question_id": 41984459, "link": "https://stackoverflow.com/questions/41984459/function-to-read-values-from-a-worksheet-by-providing-path/42006187#42006187", "title": "Function to read values from a worksheet by providing path", "body": "<p>Use Workbook object and not worksheet object at the beginning.\nThe below will work:</p>\n\n<pre><code>Public Function TipoProjeto() As String\nDim location As String\nlocation = \"C:\\Dados\\People\\Projects\\person1.xlsx\"\n\nDim wkb As Workbook\nSet wkb = Workbooks.Open(location)\n\nDim sht As Worksheet\nSet sht = wkb.sheets(\"Sheet1\") 'Use set sht = wkb.sheet1 only if the sheet has been named this in the project explorer\n\nMsgBox sht.Range(\"B2\").Value\n\nTipoProjeto = \"test\"\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 128, "user_id": 1298004, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d6ce91dffe0330d2e55a7dcb0461e4e1?s=128&d=identicon&r=PG", "display_name": "noitib", "link": "https://stackoverflow.com/users/1298004/noitib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 42006187, "answer_count": 1, "score": 0, "last_activity_date": 1486049437, "creation_date": 1485965502, "question_id": 41984459, "link": "https://stackoverflow.com/questions/41984459/function-to-read-values-from-a-worksheet-by-providing-path", "title": "Function to read values from a worksheet by providing path", "body": "<p>I want to populate some cells with values from another workbook. To accomplish this, I wrote a function that will take the name of a person as parameter, which will be the name of the file to open and read information from.</p>\n\n<p>To simplify, let's assume that there's only one person.</p>\n\n<p>The worksheet that calls the function is located at</p>\n\n<pre><code>C:\\Dados\\People\n</code></pre>\n\n<p>And the files I want to read from are located at</p>\n\n<pre><code>C:\\Dados\\People\\Projects\n</code></pre>\n\n<p>This is the code I have so far, to simply echo the value of a cell that's store on the first worksheet:</p>\n\n<pre><code>Public Function TipoProjeto(name As String) As String\nDim shAux As Worksheet\n\nshAux = Workbooks.Open(Filename:=\"C:\\Dados\\People\\Projects\\person1.xlsx\").Sheets(sheet1)\n\nMsgBox shAux.Range(\"B2\").Value\n\nTipoProjeto = \"test\"\nEnd Function\n</code></pre>\n\n<p>I set a breakpoint for the MsgBox instruction, but I cannot get past the open instruction. What can I be missing?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "edited": false, "score": 0, "creation_date": 1485965585, "post_id": 41984419, "comment_id": 71146744, "body": "What are you trying to do in line <code>Range(&quot;AL:AL&quot;) = Columns(7)</code>?"}, {"owner": {"reputation": 61, "user_id": 7437417, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d1de9f5afd13dcd74a822695c1301de?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/7437417/sarah"}, "reply_to_user": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "edited": false, "score": 0, "creation_date": 1485965777, "post_id": 41984419, "comment_id": 71146866, "body": "I was trying to figure out why the std dev calculation does not work. You can ignore that line"}, {"owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "edited": false, "score": 0, "creation_date": 1485966999, "post_id": 41984419, "comment_id": 71147657, "body": "To be honest I&#39;m not sure how to fix this you should consider instantiating ranges as object because <code>Column(7)</code> is not readable, you have to remeber what is in that range, and a third party simply cannot figure out what this is."}, {"owner": {"reputation": 61, "user_id": 7437417, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d1de9f5afd13dcd74a822695c1301de?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/7437417/sarah"}, "reply_to_user": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "edited": false, "score": 0, "creation_date": 1485982851, "post_id": 41984419, "comment_id": 71156645, "body": "That&#39;s ok. Thanks for your help. I will end up doing this a different way by calling a function."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 7437417, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d1de9f5afd13dcd74a822695c1301de?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/7437417/sarah"}, "edited": false, "score": 0, "creation_date": 1485982795, "post_id": 41985377, "comment_id": 71156614, "body": "Someone else helped me with a different way similar to this by calling a function. Problem solved, thanks :)"}], "tags": [], "owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "is_accepted": false, "score": 1, "last_activity_date": 1485968296, "creation_date": 1485968296, "answer_id": 41985377, "question_id": 41984419, "link": "https://stackoverflow.com/questions/41984419/calculating-weighted-standard-deviation-error/41985377#41985377", "title": "calculating weighted standard deviation error", "body": "<p>Not shure about the \"weighted\" AV or SD, but maybe you can adapt the following. Code loads data in an array, and then gets AV and SD.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim MyArray() As Variant\n    Dim lAV As Double\n    Dim lSD As Double\n    Dim i As Integer\n\n    lLastRow = Worksheets(\"MyData\").UsedRange.Rows.Count\n    ReDim MyArray(1 To 1) As Variant\n\n    For i = 1 To lLastRow\n        MyArray(UBound(MyArray)) = Worksheets(\"MyData\").Cells(i, 7).Value * Worksheets(\"MyData\").Cells(i, 8).Value\n        ReDim Preserve MyArray(1 To UBound(MyArray) + 1) As Variant 'now array is 1 element longer\n    Next\n\n    'Now MyArray contains desired data.\n    'Get average and SD\n\n    lAV = Application.WorksheetFunction.Average(MyArray)\n    lSD = Application.WorksheetFunction.StDev(MyArray)\n\n    'write results (be shure not to overwrite your data)\n    Worksheets(\"MyData\").Cells(1, 10) = \"Average: \"\n    Worksheets(\"MyData\").Cells(1, 11) = lAV\n    Worksheets(\"MyData\").Cells(2, 10) = \"SD: \"\n    Worksheets(\"MyData\").Cells(2, 11) = lSD\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 7437417, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d1de9f5afd13dcd74a822695c1301de?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/7437417/sarah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485968296, "creation_date": 1485965395, "last_edit_date": 1531164843, "question_id": 41984419, "link": "https://stackoverflow.com/questions/41984419/calculating-weighted-standard-deviation-error", "title": "calculating weighted standard deviation error", "body": "<p>I want to calculate the weighted mean and weighted standard deviation. I was able to calculate the mean but not the standard deviation. How should I go about it?</p>\n\n<pre><code>     With Application.WorksheetFunction\n\n\n        Range(\"AH\" &amp; 2) = .SumProduct(Columns(7), Columns(8)) / .Max(Columns(8))  'This code works very well. It calculates the mean\n\n\n        Dim Nprime As Double\n\n        Nprime = .CountIf(Range(\"H2:H\" &amp; lengthRows), \"&lt;&gt;\" &amp; 0)  'This code works well\n\n\n        Range(\"AM\" &amp; 2) = 2 * .SQRT(.SumProduct((Columns(7) - Columns(34)) ^ 2, Columns(8)) / ((Nprime - 1) * .Sum(Columns(8))) / Nprime) 'This line does not work. It should calculate the weighted standard deviation.\n\nRange(\"AM\" &amp; 2) = Evaluate(\"2*SQRT(SumProduct((Columns(7) - weightedMean)^2), Columns(8)) / ((Nprime - 1) * .Sum(Columns(8))) / Nprime)\") 'This line code evaluates with an answer of #VALUE! probably due to the titles in Row1, how do I fix the code to only evaluate the numerical values within the columns?\n\n        End With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1485967077, "post_id": 41984357, "comment_id": 71147714, "body": "can you add a reference to rhino from vba to allow any insight into the automation of it?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 3, "creation_date": 1485967923, "post_id": 41984357, "comment_id": 71148239, "body": "by the looks of this some API programming is needed <a href=\"https://github.com/dalefugier/TestVbAutomation\" rel=\"nofollow noreferrer\">github.com/dalefugier/TestVbAutomation</a>   and <a href=\"http://4.rhino3d.com/5/rhinoscript/introduction/external_access.htm\" rel=\"nofollow noreferrer\">4.rhino3d.com/5/rhinoscript/introduction/external_access.htm</a>&zwnj;&#8203;.  I agree with @Mat&#39;s Mug, you&#39;ll have to loop the error not the nothing status, I&#39;d add a retry count into the mix to, just in case, say 100000 attempts, and a small delay using the sleep api before retry."}, {"owner": {"reputation": 175, "user_id": 1159672, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/546ea01f572ab407684fb077b52c1cf6?s=128&d=identicon&r=PG", "display_name": "tranzmatt", "link": "https://stackoverflow.com/users/1159672/tranzmatt"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1485975218, "post_id": 41984357, "comment_id": 71152471, "body": "I didn&#39;t see the link to the external access page, @Nathan_Sav.  I was only using the .chm help file that came with Rhino3D.  Thank for the reference.  Hopefully this will help solve my problem."}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 1159672, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/546ea01f572ab407684fb077b52c1cf6?s=128&d=identicon&r=PG", "display_name": "tranzmatt", "link": "https://stackoverflow.com/users/1159672/tranzmatt"}, "edited": false, "score": 0, "creation_date": 1485975373, "post_id": 41985044, "comment_id": 71152561, "body": "Yes, both you and @Nathan_Sav provided useful feedback.  Thanks for the pointers.  Hopefully this will resolve my problem.  The original code was done for Rhino v3, on XP and Excel 2010, so stuff like UAC wasn&#39;t a problem.  Windows 10 and Excel 365 seems to have gummed up the works :p."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 5, "last_activity_date": 1485968794, "last_edit_date": 1495535373, "creation_date": 1485967295, "answer_id": 41985044, "question_id": 41984357, "link": "https://stackoverflow.com/questions/41984357/vb-wait-for-object-creation/41985044#41985044", "title": "VB - Wait for Object Creation", "body": "<p>I know nothing of the Rhino API, there <em>may</em> be a better way to do this.</p>\n\n<p>If you <em>know</em> that the run-time error is caused by what you're describing, and that <code>Rhino.GetScriptObject</code> is <em>eventually</em> going to succeed, you can loop until it works:</p>\n\n<pre><code>Dim iterations As Integer 'max value: 32,767\nDo\n    iterations = iterations + 1 'will *eventually* overflow if loop keeps failing\n    On Error Resume Next 'switch off error handling\n    Set RhinoScript = Rhino.GetScriptObject\n    On Error GoTo 0 'restore error handling (IMPORTANT!)\n    If Err.Number &lt;&gt; 0 And Err.Number &lt;&gt; 424 Then Err.Raise Err.Number ' rethrow\n    Err.Clear\n    DoEvents ' so that the host app remains responsive while the loop runs\nWhile RhinoScript Is Nothing\n</code></pre>\n\n<p>Notice the re-raising of the error if the number is anything other than the expected 424; this is to (try to) prevent an infinite loop if the situation is hopeless.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/41984357/vb-wait-for-object-creation#comment71148239_41984357\">Nathan made a good comment</a> about adding additional protection against infinite looping - here by incrementing a counter until its value overflows its type (raising runtime error 6). You could also use a constant and an <code>If</code> check, if 32,768 iterations is too long a timeout.</p>\n\n<p>Probably not the best solution, but <em>should</em> work. Ideally you would explore the Rhino4.Application API, see if it exposes any member that could be used to determine if the instance is \"ready\" to use. <code>IsReady</code>, or <code>State</code> perhaps.</p>\n"}], "owner": {"reputation": 175, "user_id": 1159672, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/546ea01f572ab407684fb077b52c1cf6?s=128&d=identicon&r=PG", "display_name": "tranzmatt", "link": "https://stackoverflow.com/users/1159672/tranzmatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "accepted_answer_id": 41985044, "answer_count": 1, "score": 2, "last_activity_date": 1485968794, "creation_date": 1485965225, "last_edit_date": 1531164843, "question_id": 41984357, "link": "https://stackoverflow.com/questions/41984357/vb-wait-for-object-creation", "title": "VB - Wait for Object Creation", "body": "<p>I'm trying to follow the example for externally access a RhinoScript module from Excel (in my case Excel 365 on Windows 10) using a standard method.</p>\n\n<pre><code>Dim Rhino As Object\nDim RhinoScript As Object\n\nSet Rhino = CreateObject(\"Rhino4.Application\")\nSet RhinoScript = Rhino.GetScriptObject()\n</code></pre>\n\n<p>But I'm running into a \"Runtime 424 - Object Required\" error on the last line. </p>\n\n<p>The problem seems to be that GetScriptObject isn't waiting for CreateObject to fully complete because while Rhino4 starts up, the UAC of Windows 10 will prompt me to allow the Updater to make changes to the system before allowing it to bring up the GUI.  If I debug these statements and go line-by-line so Rhino4 has time to fully start before GetScriptObject hits, everything works fine.  So, is there a ways to make GetScriptObject wait until Rhino4 is completely started? I've tried setting up a loop that check's Rhino's value (Nothing?), but it immediately falls through.  I'm a little new to VB, so apologies for what may be a newbie question.</p>\n\n<p>Thanks,</p>\n\n<p>Matt</p>\n"}, {"tags": ["javascript", "html", "vba", "object", "web-scraping"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1485966793, "post_id": 41984307, "comment_id": 71147523, "body": "When I get an error in a long expression, I break it up into smaller pieces.  You&#39;ll discover which segment of the expression is breaking that way."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1485968988, "post_id": 41984307, "comment_id": 71148871, "body": "<code>getElementById(&quot;tblData&quot;)</code> will always return a single element (assuming a match was made), not a collection/list, so you don&#39;t need the <code>(0)</code> following that."}, {"owner": {"reputation": 25, "user_id": 5526121, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7af2502ce5c83811e4323316f31cb2a9?s=128&d=identicon&r=PG&f=1", "display_name": "DangeRuss", "link": "https://stackoverflow.com/users/5526121/dangeruss"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1485969450, "post_id": 41984307, "comment_id": 71149139, "body": "@SMeaden Thanks for showing up... You helped with this the last time. I don&#39;t think it&#39;s a matter of it being a long expression. It&#39;s a matter of the site won&#39;t let me set the variables. Have you ever heard of this? This code (or a very similar version) runs perfectly on other pages; could this be a firewall issue, if so, any thoughts on circumventing?"}, {"owner": {"reputation": 25, "user_id": 5526121, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7af2502ce5c83811e4323316f31cb2a9?s=128&d=identicon&r=PG&f=1", "display_name": "DangeRuss", "link": "https://stackoverflow.com/users/5526121/dangeruss"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1485969835, "post_id": 41984307, "comment_id": 71149398, "body": "Thanks @TimWilliams; I&#39;ve also tried the code two lines down where I go through and narrow down the search by tag names. Still I have errors. Also, if I try to set els = htmlDoc.getElementByID(&quot;tblData&quot;) and leave the rest of the line blank, it throws error. Any ideas?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1485974191, "post_id": 41984307, "comment_id": 71151932, "body": "<code>getElementByTagName</code> is not a valid method: it&#39;s getElement<b>s</b>ByTagName (though you have it correct in the commented-out lines).  It&#39;s impossible to really help here, without the HTML source or an accessible URL&gt;"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5526121, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7af2502ce5c83811e4323316f31cb2a9?s=128&d=identicon&r=PG&f=1", "display_name": "DangeRuss", "link": "https://stackoverflow.com/users/5526121/dangeruss"}, "edited": false, "score": 0, "creation_date": 1485970552, "post_id": 41985958, "comment_id": 71149854, "body": "Ok... I&#39;ve got that the getElementByID command only returns a single element, but I&#39;ve tried other methods too (see commented code two lines down from &#39;ID&#39; command) I&#39;m still unable to set the variable using this method as well. Any thoughts on what could be the error in the alternative code? I&#39;m still thinking firewall. Do you know anything about that?"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 25, "user_id": 5526121, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7af2502ce5c83811e4323316f31cb2a9?s=128&d=identicon&r=PG&f=1", "display_name": "DangeRuss", "link": "https://stackoverflow.com/users/5526121/dangeruss"}, "edited": false, "score": 0, "creation_date": 1485973751, "post_id": 41985958, "comment_id": 71151690, "body": "Difficult for us to debug if we do not have username and password.  Have you tried querySelector?  See this <a href=\"http://stackoverflow.com/questions/41947882/scraping-data-with-no-html-element-id-excel-vba/41963519#41963519\" title=\"scraping data with no html element id excel vba\">stackoverflow.com/questions/41947882/&hellip;</a>  Can you somehow show the HTML page source?"}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 0, "last_activity_date": 1485970101, "creation_date": 1485970101, "answer_id": 41985958, "question_id": 41984307, "link": "https://stackoverflow.com/questions/41984307/cant-set-object-variable-in-htmldocument-for-scraping-data-from-website/41985958#41985958", "title": "Can&#39;t set object variable in HTMLDocument for scraping data from website", "body": "<p>Further to Tim's eagle eye, here is some documentation.   The error (as Tim spotted) is that getElementById does not return a list of HTML elements but a single element.</p>\n\n<p>Here is a documentation link</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/ms536437(v=vs.85).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/ms536437(v=vs.85).aspx</a></p>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 5526121, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7af2502ce5c83811e4323316f31cb2a9?s=128&d=identicon&r=PG&f=1", "display_name": "DangeRuss", "link": "https://stackoverflow.com/users/5526121/dangeruss"}, "edited": false, "score": 0, "creation_date": 1486161363, "post_id": 42008453, "comment_id": 71242702, "body": "Whoa!!! That is awesome! Thanks a million! Sorry I was out sick for a couple of days and wasn&#39;t responding. This is great, thanks Ryan!"}, {"owner": {"reputation": 25, "user_id": 5526121, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7af2502ce5c83811e4323316f31cb2a9?s=128&d=identicon&r=PG&f=1", "display_name": "DangeRuss", "link": "https://stackoverflow.com/users/5526121/dangeruss"}, "edited": false, "score": 0, "creation_date": 1486161665, "post_id": 42008453, "comment_id": 71242797, "body": "How did you figure that out?"}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": true, "score": 0, "last_activity_date": 1486056014, "creation_date": 1486056014, "answer_id": 42008453, "question_id": 41984307, "link": "https://stackoverflow.com/questions/41984307/cant-set-object-variable-in-htmldocument-for-scraping-data-from-website/42008453#42008453", "title": "Can&#39;t set object variable in HTMLDocument for scraping data from website", "body": "<p>I believe I have a working example with the URL provided in the code posted above. From what I can tell there are frames on the website, so you need to handle these slightly differently. </p>\n\n<p>In addition, waiting for the page to load needed a different method. For that I reused some code I got some another StackOverflow answer. Basically it waits until it doesn't find anymore tags on a page as it is loading.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>#If VBA7 Then\n    Public Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As LongPtr)\n#Else\n    Public Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n#End If\n\nSub getData()\n    Dim element     As Object\n    Dim MyURL       As String\n    MyURL = \"https://members.cambridgeassociates.com/markets/marketindexsnapshot/DailyMarketReturnsUS.asp\"\n\n    'Late binding open IE\n    Dim MyBrowser   As Object: Set MyBrowser = CreateObject(\"InternetExplorer.Application\")\n    MyBrowser.Visible = True\n    MyBrowser.navigate MyURL\n\n    waitforload MyBrowser\n\n    Set element = MyBrowser.document.getelementsByTagName(\"Frameset\")(0).Children(1).contentdocument\n    Set element = element.getelementByID(\"tblData\")\n    Set element = element.getelementsByTagName(\"tr\")(5)\n    Set element = element.getelementsByTagName(\"td\")(1)\n    Debug.Print element.innertext\nEnd Sub\n\nPrivate Sub waitforload(ByRef ie As Object)\n    Dim i        As Byte\n    Dim tagnames As Long\n\n    While ie.Busy\n        Sleep 250\n        DoEvents\n    Wend\n\n    While ie.ReadyState &lt;&gt; 4\n        Sleep 250\n        DoEvents\n    Wend\n\n    Do\n        tagnames = ie.document.getelementsByTagName(\"*\").Length\n        For i = 1 To 5\n            Sleep 75\n            If tagnames = ie.document.getelementsByTagName(\"*\").Length Then Exit Sub\n        Next\n    Loop\nEnd Sub\n</code></pre>\n\n<p>This should return: <code>0.10</code></p>\n"}], "owner": {"reputation": 25, "user_id": 5526121, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7af2502ce5c83811e4323316f31cb2a9?s=128&d=identicon&r=PG&f=1", "display_name": "DangeRuss", "link": "https://stackoverflow.com/users/5526121/dangeruss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 0, "accepted_answer_id": 42008453, "answer_count": 2, "score": 0, "last_activity_date": 1486056014, "creation_date": 1485965047, "question_id": 41984307, "link": "https://stackoverflow.com/questions/41984307/cant-set-object-variable-in-htmldocument-for-scraping-data-from-website", "title": "Can&#39;t set object variable in HTMLDocument for scraping data from website", "body": "<p>I have seen this question posted before, but my situation is somewhat different so I was hoping I could get some help from the community and maybe a fresh perspective. I have a macro written in vba that's supposed to pull return data from this company's online db, things like returns for MSCI World Index, S&amp;P 500, etc. The code I have works on other pages, but I think this one is different. I talked to the webmaster and he told me that the code was not designed to be scraped, but that is not restricted by their usage policy. It would be a huge time saver for me if I could, indeed, get the data by scraping so I'm trying really hard to figure out a way to do it. I've tagged this under java-script as well, as I think the code would be very similar and I want to accept as many solutions as possible to solve this problem. </p>\n\n<p>The situation is this: I have the following code that throws me an \"Object variable not set\" error when it comes to the actual scraping of the data (the line that begins 'set els = htmlDoc....\" I've tried many combinations of the getElement(s) function thinking that may have been the problem, but I've drawn a blank. Anybody know any other ways to set the object variable in this environment? Or just any other creative ways to pull the data. </p>\n\n<p>I can't give out the login info, but I think by just navigating to the 'caRetPage' site, you can see the html code that I'm trying to scrape/parse. </p>\n\n<pre><code>Sub caScrape()\n\nDim ie As Object        'ie: internet explorer\nDim htmlDoc As MSHTML.HTMLDocument\nDim els As Object   'to store html objects\nDim rtn As String   'to store values to be scraped from page\nDim loginButton As Object\ncaLoginPage = \"https://members.cambridgeassociates.com/Login/Forms/login-form.asp\"\ncaRetPage = \"https://members.cambridgeassociates.com/markets/marketindexsnapshot/DailyMarketReturnsUS.asp\"\ncaUser = \"xxxxx\"\ncaPass = \"xxxxx\"\nSet ie = CreateObject(\"internetexplorer.application\")\nie.Visible = True\nie.navigate caLoginPage\nWhile ie.Busy\n    DoEvents\nWend\nDo Until ie.readyState = 4\n    DoEvents\nLoop\nSet htmlDoc = ie.document\n'Log in to site\nSet loginButton = htmlDoc.getElementsByTagName(\"button\").Item(0)\nWith htmlDoc\n    .all(\"Username\").Value = caUser\n    .all(\"Password\").Value = caPass\n    loginButton.Click\nEnd With\nWhile ie.Busy\n    DoEvents\nWend\nSet acceptButton = htmlDoc.getElementsByName(\"Submit\").Item(0)\nacceptButton.Click\nWhile ie.Busy\n    DoEvents\nWend\n\n\n'Here is the page with the return data on it                                                                                   \nie.navigate caRetPage\nWhile ie.Busy\n    DoEvents\nWend\nDo Until ie.readyState = 4\n    DoEvents\nLoop\nSet htmlDoc = ie.document\n\n'This next line is where the error gets thrown\nSet els = htmlDoc.getElementById(\"tblData\")(0).getElementByTagName(\"tr\")(5).getElementByTagName(\"td\")(1)\n    'Also tried the following and plenty of variations of getElement command\n'Set els = htmlDoc.getElementsByTagName(\"body\")(0).getElementsByTagName(\"table\")(2).getElementsByTagName(\"tbody\")(0).getElementByTagName(\"tr\")(5).getElementByTagName(\"td\")(1)\n\nrtn = els.innerText\nDebug.Print(rtn)\n\n\nEnd Sub\n</code></pre>\n\n<p>Any help would be greatly appreciated. </p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1485965310, "post_id": 41984264, "comment_id": 71146549, "body": "Take a look at the following article... it explains how to use conditional formatting to lock controls ... <a href=\"http://stackoverflow.com/questions/11507151/enabling-and-disabling-controls-on-a-continuous-subform-in-access-2007-2010\" title=\"enabling and disabling controls on a continuous subform in access 2007 2010\">stackoverflow.com/questions/11507151/&hellip;</a>"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1485966981, "post_id": 41984264, "comment_id": 71147649, "body": "You don&#39;t need to specify the rule at run time. Just set it once, then it will work for all rows. To use Conditional Formatting: (1) Right click on the control, (2) Select &#39;Conditional Formatting&#39;; (3) Click &#39;New Rule&#39;; (4) Use &#39;Field Value Is&#39; and &#39;not equal to&#39; and in the 3rd field, use the &#39;builder&#39; to select your ComboBox. and finally click the &#39;enable&#39; icon (just to right of font color)."}, {"owner": {"reputation": 111, "user_id": 6762683, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ec06e128aa05136657499e5b04bedf75?s=128&d=identicon&r=PG&f=1", "display_name": "Travis Cowart", "link": "https://stackoverflow.com/users/6762683/travis-cowart"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1485968312, "post_id": 41984264, "comment_id": 71148482, "body": "Tried that. It essentially just locks my combo box (when conditional formatting is applied to combo box...as I can&#39;t use conditional formatting on my button). My other thought may be to implement some more vba where the titles will be placed in an array based on a particular fund code or something."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1485969784, "post_id": 41984264, "comment_id": 71149357, "body": "No, no. Use conditional formatting on the &#39;Priority&#39; field .. not the combobox. I just did this and when I select a value from the combobox, only fields containing that value can be edited."}], "owner": {"reputation": 111, "user_id": 6762683, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ec06e128aa05136657499e5b04bedf75?s=128&d=identicon&r=PG&f=1", "display_name": "Travis Cowart", "link": "https://stackoverflow.com/users/6762683/travis-cowart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1486053797, "creation_date": 1485964924, "last_edit_date": 1486053797, "question_id": 41984264, "link": "https://stackoverflow.com/questions/41984264/lock-a-subform-based-on-combo-box-selection", "title": "Lock a subform based on combo box selection", "body": "<p><strong>The Scenario</strong> <br>\nI have figured out how to lock a subform's rows (ALL) using a button and VBA code. However, I have a little extra tidbit I would like the button to perform. I have 40 choices in my <code>combobox</code>.  Once I select the first and enter data in fields in the subform below it, I would like the button to lock those rows.\n<br><br></p>\n\n<p><strong>The Goal</strong><br>\nWhen I select the next option in my <code>combobox</code>, I would like those to be editable until I click the lock button, and so forth. Is this possible?\n<br><br></p>\n\n<p><strong>The Code</strong>  <br>\nThis is currently what I have for the button:</p>\n\n<pre><code>If Me.fsubtitles!Priority.Enabled = False Then\n    Me.fsubtitles!Priority.Enabled = True\nElse\n    Me.fsubtitles!Priority.Enabled = False\nEnd If\n</code></pre>\n\n<p>Any thing else I need to provide? </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["r", "excel", "vba", "charts", "extract"], "comments": [{"owner": {"reputation": 117262, "user_id": 1412059, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MQ33X.jpg?s=128&g=1", "display_name": "Roland", "link": "https://stackoverflow.com/users/1412059/roland"}, "edited": false, "score": 0, "creation_date": 1485964352, "post_id": 41983909, "comment_id": 71145818, "body": "Can you please be more specific? Do you have Excel available (which version)? Would a VBA solution be fine?"}, {"owner": {"reputation": 1256, "user_id": 17216, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/O5ffZ.jpg?s=128&g=1", "display_name": "Mikhail", "link": "https://stackoverflow.com/users/17216/mikhail"}, "reply_to_user": {"reputation": 117262, "user_id": 1412059, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MQ33X.jpg?s=128&g=1", "display_name": "Roland", "link": "https://stackoverflow.com/users/1412059/roland"}, "edited": false, "score": 0, "creation_date": 1485964893, "post_id": 41983909, "comment_id": 71146260, "body": "Updated the question."}, {"owner": {"reputation": 117262, "user_id": 1412059, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MQ33X.jpg?s=128&g=1", "display_name": "Roland", "link": "https://stackoverflow.com/users/1412059/roland"}, "edited": false, "score": 0, "creation_date": 1485965563, "post_id": 41983909, "comment_id": 71146730, "body": "Well, I would use VBA (mind you, I wouldn&#39;t produce these charts in Excel). There is an export method for chart objects, so this shouldn&#39;t be too difficult. You might want to add the VBA tag."}], "answers": [{"comments": [{"owner": {"reputation": 1256, "user_id": 17216, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/O5ffZ.jpg?s=128&g=1", "display_name": "Mikhail", "link": "https://stackoverflow.com/users/17216/mikhail"}, "edited": false, "score": 0, "creation_date": 1486046055, "post_id": 41986154, "comment_id": 71185795, "body": "Cool, thanks a lot!  I&#39;ve to open all the spreadsheets, but it&#39;s still much less manual work that extracting all charts by hand."}, {"owner": {"reputation": 61, "user_id": 7043384, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kEiiQwcbE3M/AAAAAAAAAAI/AAAAAAAAGpc/oNccSOSOsGw/photo.jpg?sz=128", "display_name": "Benjamin", "link": "https://stackoverflow.com/users/7043384/benjamin"}, "reply_to_user": {"reputation": 1256, "user_id": 17216, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/O5ffZ.jpg?s=128&g=1", "display_name": "Mikhail", "link": "https://stackoverflow.com/users/17216/mikhail"}, "edited": false, "score": 0, "creation_date": 1486058959, "post_id": 41986154, "comment_id": 71194310, "body": "You&#39;re welcome! You can iterate through your folder(s) and open &amp; close files. Look into the Dir() function. Then use application.workbooks.open."}], "tags": [], "owner": {"reputation": 61, "user_id": 7043384, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kEiiQwcbE3M/AAAAAAAAAAI/AAAAAAAAGpc/oNccSOSOsGw/photo.jpg?sz=128", "display_name": "Benjamin", "link": "https://stackoverflow.com/users/7043384/benjamin"}, "is_accepted": true, "score": 2, "last_activity_date": 1486019374, "last_edit_date": 1486019374, "creation_date": 1485970791, "answer_id": 41986154, "question_id": 41983909, "link": "https://stackoverflow.com/questions/41983909/r-how-to-extract-charts-from-ms-excel-spreadsheet/41986154#41986154", "title": "R: How to extract charts from MS Excel spreadsheet?", "body": "<p>Assuming that all of your charts are embedded in normal worksheets (e.g. Sheet1, Sheet2) and not chart sheets (e.g. Chart1)... Try something like this in VBA:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub exportAllCharts()\n\nDim folder As String\nDim filename As String\nDim wb As Workbook\nDim ws As Worksheet\nDim cObj As ChartObject\n\nfolder = \"C:\\\"  'Make sure to have the trailing slash\nFor Each wb In Application.Workbooks\n  For Each ws In wb.Worksheets\n    For Each cObj In ws.ChartObjects\n      filename = wb.Name &amp; \" \" &amp; ws.Name &amp; \" \" &amp; cObj.Name &amp; \".png\" 'Or whatever your code is to name your file...\n      cObj.Chart.Export folder &amp; filename\n    Next cObj\n  Next ws\nNext wb\nEnd Sub\n</code></pre>\n\n<p>I tested it and it works. That should iterate all open workbooks, all worksheets, and export all chart objects.</p>\n"}], "owner": {"reputation": 1256, "user_id": 17216, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/O5ffZ.jpg?s=128&g=1", "display_name": "Mikhail", "link": "https://stackoverflow.com/users/17216/mikhail"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 41986154, "answer_count": 1, "score": 1, "last_activity_date": 1486019374, "creation_date": 1485963956, "last_edit_date": 1485965762, "question_id": 41983909, "link": "https://stackoverflow.com/questions/41983909/r-how-to-extract-charts-from-ms-excel-spreadsheet", "title": "R: How to extract charts from MS Excel spreadsheet?", "body": "<p>I've looked around, but wasn't able to find a way to automatically extract charts from Excel spreadsheets. (My tool of choice is R, but I'd consider alternatives.)</p>\n\n<p>Has anyone done it?</p>\n\n<p>Update: I've got a bunch of spreadsheets I created using Excel 2013, and I'd like to extract all charts as pictures (e.g. PNG). I don't mind using VBA, but I need to be able to run code on <em>all</em> spreadsheets at once, as going through them one by one would defeat the purpose of this exercise.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 2, "creation_date": 1485963867, "post_id": 41983683, "comment_id": 71145416, "body": "Try adding this: Application.EnableEvents = False"}, {"owner": {"reputation": 45, "user_id": 5040776, "user_type": "registered", "profile_image": "https://graph.facebook.com/10200494271796772/picture?type=large", "display_name": "Cairl Dacar Borstnik", "link": "https://stackoverflow.com/users/5040776/cairl-dacar-borstnik"}, "reply_to_user": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 1, "creation_date": 1485963983, "post_id": 41983683, "comment_id": 71145524, "body": "already tried that - no luck"}, {"owner": {"reputation": 45, "user_id": 5040776, "user_type": "registered", "profile_image": "https://graph.facebook.com/10200494271796772/picture?type=large", "display_name": "Cairl Dacar Borstnik", "link": "https://stackoverflow.com/users/5040776/cairl-dacar-borstnik"}, "edited": false, "score": 0, "creation_date": 1485964112, "post_id": 41983683, "comment_id": 71145629, "body": "actually it was disabling screen updating that I&#39;d tried - disabling events seems to have worked.  thx!"}], "answers": [{"tags": [], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "is_accepted": true, "score": 3, "last_activity_date": 1485965026, "creation_date": 1485965026, "answer_id": 41984301, "question_id": 41983683, "link": "https://stackoverflow.com/questions/41983683/application-displayalerts-false-not-stopping-popup-window/41984301#41984301", "title": "Application.displayalerts = false not stopping popup window", "body": "<p>Addinng the below line will solve the problem.</p>\n\n<pre><code>Application.EnableEvents = False \n</code></pre>\n\n<p>If you're interested, I like to use this function when I start a long process:</p>\n\n<pre><code>Sub SetEvents(ByVal State As Boolean)\n    With Excel.Application\n        .DisplayAlerts = State\n        .ScreenUpdating = State\n        .EnableEvents = State\n        If State = True Then .Calculation = xlCalculationAutomatic Else .Calculation = xlCalculationManual\n    End With\nEnd Sub\n</code></pre>\n\n<p>By adding this you can turn off calcs, events, screen and alerts like this in your main sub:</p>\n\n<pre><code>Sub CallEvents()\n    SetEvents False\n    'Do some stuff\n    SetEvents True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5040776, "user_type": "registered", "profile_image": "https://graph.facebook.com/10200494271796772/picture?type=large", "display_name": "Cairl Dacar Borstnik", "link": "https://stackoverflow.com/users/5040776/cairl-dacar-borstnik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 516, "favorite_count": 0, "accepted_answer_id": 41984301, "answer_count": 1, "score": 2, "last_activity_date": 1485965026, "creation_date": 1485963377, "question_id": 41983683, "link": "https://stackoverflow.com/questions/41983683/application-displayalerts-false-not-stopping-popup-window", "title": "Application.displayalerts = false not stopping popup window", "body": "<p>I'm trying to use VBA in Excel to find and replace multiple values.  The field that is being updated has HTML text so I'm getting a window popup that says I'll lose formatting changes and when it's published back out to TFS it'll be stored as plain text.  Using Application.displayalerts = false isn't stopping that window from appearing.</p>\n\n<p>Is there a way I can use code to make this go away?</p>\n\n<p><a href=\"https://i.stack.imgur.com/tvYGQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tvYGQ.png\" alt=\"Warning message\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1485963091, "post_id": 41983354, "comment_id": 71144826, "body": "&quot;It doesn&#39;t work&quot; is not very helpful. What happens - an error, nothing, ... ? You also need to clarify where this code is and which sheet tab should be coloured."}, {"owner": {"reputation": 1018, "user_id": 6706734, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89cf86a3fd50974771d8041b8f13e5b0?s=128&d=identicon&r=PG&f=1", "display_name": "J_Lard", "link": "https://stackoverflow.com/users/6706734/j-lard"}, "edited": false, "score": 0, "creation_date": 1485963463, "post_id": 41983354, "comment_id": 71145109, "body": "I just ran a similar code and the code seemed to work fine. Only difference is that I removed your <code>MyVal</code> declaration and changed the <code>Select</code> statement to: <code>Select Case Sheets(&quot;Summary&quot;).Range(&quot;A8&quot;).Value</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1097, "user_id": 5626959, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a69e414eff81de3460cef89d2c97492f?s=128&d=identicon&r=PG&f=1", "display_name": "RyanL", "link": "https://stackoverflow.com/users/5626959/ryanl"}, "is_accepted": false, "score": 0, "last_activity_date": 1485963395, "creation_date": 1485963395, "answer_id": 41983691, "question_id": 41983354, "link": "https://stackoverflow.com/questions/41983354/excel-macro-how-to-change-tab-color-based-on-cell-in-a-separate-worksheet-in-s/41983691#41983691", "title": "Excel Macro - How to change tab color based on cell in a separate worksheet in same workbook?", "body": "<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim MyVal$\nMyVal = ActiveWorkbook.Sheets(\"Summary\").Range(\"A8\")\n\nWith ActiveSheet.Tab\n    Select Case MyVal\n        Case \"Black\"\n            .Color = vbBlack\n        Case \"Red\"\n            .Color = vbRed\n        Case \"Green\"\n            .Color = vbGreen\n        Case \"Yellow\"\n            .Color = vbYellow\n        Case \"Blue\"\n            .Color = vbBlue\n        Case \"Magenta\"\n            .Color = vbMagenta\n        Case \"Cyan\"\n            .Color = vbCyan\n        Case \"White\"\n            .Color = vbWhite\n        Case Else\n            .ColorIndex = xlColorIndexNone\n    End Select\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7501136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cf691ecff4928be16e5cf973e6fe0c6?s=128&d=identicon&r=PG&f=1", "display_name": "bamasal", "link": "https://stackoverflow.com/users/7501136/bamasal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 330, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485963395, "creation_date": 1485962519, "last_edit_date": 1485963113, "question_id": 41983354, "link": "https://stackoverflow.com/questions/41983354/excel-macro-how-to-change-tab-color-based-on-cell-in-a-separate-worksheet-in-s", "title": "Excel Macro - How to change tab color based on cell in a separate worksheet in same workbook?", "body": "<p>I tried the following and it doesn't work - any other suggestions?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nMyVal = Range(\"'Summary'!A8\").Text\n\nWith ActiveSheet.Tab\n    Select Case MyVal\n        Case \"Black\"\n            .Color = vbBlack\n        Case \"Red\"\n            .Color = vbRed\n        Case \"Green\"\n            .Color = vbGreen\n        Case \"Yellow\"\n            .Color = vbYellow\n        Case \"Blue\"\n            .Color = vbBlue\n        Case \"Magenta\"\n            .Color = vbMagenta\n        Case \"Cyan\"\n            .Color = vbCyan\n        Case \"White\"\n            .Color = vbWhite\n        Case Else\n            .ColorIndex = xlColorIndexNone\n    End Select\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1485962241, "post_id": 41983229, "comment_id": 71144183, "body": "what exactly <code>phase1 = table(i, 2).Value &amp; frequence1 = table(i, 3).Value</code> suppose to be ?"}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1485962334, "post_id": 41983229, "comment_id": 71144249, "body": "Set your table to either your sheet name or &quot;ActiveSheet.Cells&quot; instead of ws.Cells. Same for your tableRows and tableCols"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 4, "creation_date": 1485962501, "post_id": 41983229, "comment_id": 71144380, "body": "You do not appear to be defining <code>ws</code>."}, {"owner": {"reputation": 17, "user_id": 7080084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ce54be0417895d3b0450130f172df72?s=128&d=identicon&r=PG&f=1", "display_name": "Yassine", "link": "https://stackoverflow.com/users/7080084/yassine"}, "edited": false, "score": 0, "creation_date": 1485962758, "post_id": 41983229, "comment_id": 71144567, "body": "phase1 and frequence1 are parameters , I have phase in column 2 and frequence in column 3 . when I said phase1 means that I select phase1 of Antenna1 and"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1485962887, "post_id": 41983229, "comment_id": 71144678, "body": "As a side point you can dimension variables in this format: Dim A As Double, B As Double, C as Double"}, {"owner": {"reputation": 17, "user_id": 7080084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ce54be0417895d3b0450130f172df72?s=128&d=identicon&r=PG&f=1", "display_name": "Yassine", "link": "https://stackoverflow.com/users/7080084/yassine"}, "edited": false, "score": 0, "creation_date": 1485963110, "post_id": 41983229, "comment_id": 71144838, "body": "I don&#39;t think that the problem was in the condition"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1485963331, "post_id": 41983229, "comment_id": 71145014, "body": "@Yassine I believe Shai Rado is pointing out that <code>phase1 = table(i, 2).Value &amp; frequence1 = table(i, 3).Value</code> does not what you think it does. Namely, it stores into <code>phase1</code> the result of calculating <code>table(i, 2).Value &amp; frequence1 = table(i, 3).Value</code>, which is <code>(table(i, 2).Value &amp; frequence1) = table(i, 3).Value</code>, which concatenates <code>table(i, 2).Value</code> and <code>frequence1</code> as strings and then verifies that the result equals the apparently numeric value of <code>table(i, 3).Value</code>. The result of that comparison, <code>True</code> or <code>False</code>, is stored in <code>phase1</code>."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1485963424, "post_id": 41983229, "comment_id": 71145085, "body": "@Yassine Yes, it is not the source of the error 91. Its source, as SJR has noted, is that you never assign <code>ws</code> with anything."}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1485963947, "post_id": 41983229, "comment_id": 71145491, "body": "@Yassine yes, define your worksheet in &quot;ws&quot; else use activesheet"}, {"owner": {"reputation": 17, "user_id": 7080084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ce54be0417895d3b0450130f172df72?s=128&d=identicon&r=PG&f=1", "display_name": "Yassine", "link": "https://stackoverflow.com/users/7080084/yassine"}, "edited": false, "score": 0, "creation_date": 1485964432, "post_id": 41983229, "comment_id": 71145879, "body": "have I  write    ws.activesheet.Cells ...?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1485964637, "post_id": 41983229, "comment_id": 71146053, "body": "@Yassine no, <code>Set ws = ActiveSheet</code> (or <code>Set ws = Worksheets(&quot;some other sheet&quot;)</code>, etc.)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1485964753, "post_id": 41983229, "comment_id": 71146146, "body": "Also: <code>Integer</code> will overflow if your <code>UsedRange</code> has more than 32,767 rows. Use a <code>Long</code> whenever you&#39;re storing anything that has to do with row numbers."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 7080084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ce54be0417895d3b0450130f172df72?s=128&d=identicon&r=PG&f=1", "display_name": "Yassine", "link": "https://stackoverflow.com/users/7080084/yassine"}, "edited": false, "score": 0, "creation_date": 1485965128, "post_id": 41984119, "comment_id": 71146435, "body": "I corrected this three lines but I have another error 6  , and before I modified all doubles by Long but I got the same error"}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "reply_to_user": {"reputation": 17, "user_id": 7080084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ce54be0417895d3b0450130f172df72?s=128&d=identicon&r=PG&f=1", "display_name": "Yassine", "link": "https://stackoverflow.com/users/7080084/yassine"}, "edited": false, "score": 0, "creation_date": 1485965324, "post_id": 41984119, "comment_id": 71146558, "body": "you should accept this as a answer since it fix your initial question and ask a new question regarding your new error."}, {"owner": {"reputation": 17, "user_id": 7080084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ce54be0417895d3b0450130f172df72?s=128&d=identicon&r=PG&f=1", "display_name": "Yassine", "link": "https://stackoverflow.com/users/7080084/yassine"}, "edited": false, "score": 0, "creation_date": 1485965406, "post_id": 41984119, "comment_id": 71146615, "body": "thank you so muck @pokemon_Man I&#39;ll ask a new question now"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 17, "user_id": 7080084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ce54be0417895d3b0450130f172df72?s=128&d=identicon&r=PG&f=1", "display_name": "Yassine", "link": "https://stackoverflow.com/users/7080084/yassine"}, "edited": false, "score": 0, "creation_date": 1485985087, "post_id": 41984119, "comment_id": 71157734, "body": "@Yassine Spitting <code>ActiveSheet</code> everywhere instead of your <code>ws</code> <a href=\"http://stackoverflow.com/q/10714251/11683\">is bad</a>. Please do <a href=\"http://stackoverflow.com/questions/41983229/error-91-vba-excel/41984119#comment71146053_41983229\">what David Zemens said</a> instead."}], "tags": [], "owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "is_accepted": true, "score": -2, "last_activity_date": 1485965227, "last_edit_date": 1485965227, "creation_date": 1485964504, "answer_id": 41984119, "question_id": 41983229, "link": "https://stackoverflow.com/questions/41983229/error-91-vba-excel/41984119#41984119", "title": "Error 91 VBA Excel", "body": "<p>Define your worksheet here:   </p>\n\n<pre><code> Set table = ActiveSheet.Cells\n tableRows = ActiveSheet.UsedRange.Rows.Count\n tableCols = ActiveSheet.UsedRange.Columns.Count\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 7080084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ce54be0417895d3b0450130f172df72?s=128&d=identicon&r=PG&f=1", "display_name": "Yassine", "link": "https://stackoverflow.com/users/7080084/yassine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 41984119, "answer_count": 1, "score": 1, "last_activity_date": 1578657293, "creation_date": 1485962162, "last_edit_date": 1531164843, "question_id": 41983229, "link": "https://stackoverflow.com/questions/41983229/error-91-vba-excel", "title": "Error 91 VBA Excel", "body": "<p>I got error 91 when I execute my code in VBA</p>\n\n<p>There is my code</p>\n\n<pre><code>Sub Traingulation()    \n Dim table As Range\n Dim tableRows As Integer\n Dim tableCols As Integer\n Dim ws As Worksheet   \n\n Set table = ws.Cells\n tableRows = ws.UsedRange.Rows.Count\n tableCols = ws.UsedRange.Columns.Count\n\n Dim x1 As Double\n Dim x2 As Double\n Dim x3 As Double\n Dim y1 As Double\n Dim y2 As Double\n Dim y3 As Double   \n\n Dim r1 As Double\n Dim r2 As Double\n Dim r3 As Double    \n\n Dim phase1 As Double\n Dim phase2 As Double\n Dim phase3 As Double    \n Dim frequence1 As Double\n Dim frequence2 As Double\n Dim frequence3 As Double   \n Dim A As Double\n Dim B As Double\n Dim C As Double\n Dim D As Double\n Dim E As Double\n Dim F As Double   \n Dim Xu As Double\n Dim Yu As Double\n\n x1 = Range(\"L5\").Value\n x2 = Range(\"L6\").Value\n x3 = Range(\"L7\").Value\n y1 = Range(\"M5\").Value\n y2 = Range(\"M6\").Value\n y3 = Range(\"M7\").Value\n\n For i = 1 To table1Rows\n   For j = 1 To table1Cols\n     If table(i, 5).Value = 1 Then\n       phase1 = table(i, 2).Value &amp; frequence1 = table(i, 3).Value\n     End If\n   Next\n\n   If table(i, 5).Value = 2 Then  \n     phase1 = table(i, 2).Value &amp; frequence1 = table(i, 3).Value\n   End If\n Next\n\n If table(i, 5).Value = 3 Then\n   phase1 = table(i, 2).Value &amp; frequence1 = table(i, 3).Value\n End If\n\n r1 = -(3 * 10 ^ 8 * phase1) / 4 * 3.14 * frequence1    \n r2 = -(3 * 10 ^ 8 * phase2) / 4 * 3.14 * frequence2\n r3 = -(3 * 10 ^ 8 * phase3) / 4 * 3.14 * frequence3\n\n A = x3 - x1\n B = y3 - y1\n C = x3 - x2\n D = y3 - y2\n E = ((r1) ^ 2 - (r3) ^ 2) - ((x1) ^ 2 - (x3) ^ 2) - ((y1) ^ 2 - (y3) ^ 2)\n F = ((r2) ^ 2 - (r3) ^ 2) - ((x2) ^ 2 - (x3) ^ 2) - ((y2) ^ 2 - (y3) ^ 2)\n\n Xu = 0.5 * ((F * B) - (D * E)) / ((C * D) - (A * D))\n Yu = (0.5 * E / B) - (A * ((F * B) - (D * E))) / (B * ((C * B) - (A * B))) \n\n MsgBox \"Triangulation : Xu =  \" &amp; Xu &amp; \",  et Yu =  : \" &amp; Yu &amp; \" \"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "password-protection"], "comments": [{"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 1, "creation_date": 1485963341, "post_id": 41983067, "comment_id": 71145023, "body": "I suggust set read only to the file"}, {"owner": {"reputation": 113, "user_id": 4391373, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c4fef5f85c23acd32d3a46c5350e79cb?s=128&d=identicon&r=PG&f=1", "display_name": "SMLBW", "link": "https://stackoverflow.com/users/4391373/smlbw"}, "reply_to_user": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1485963478, "post_id": 41983067, "comment_id": 71145123, "body": "Thanks pokemon_man, Nick has suggested the same and I think you are both right. Can you think of what circumstances may require one of the more complex options I mentioned? Want to check I am not missing anything."}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 1, "creation_date": 1485963800, "post_id": 41983067, "comment_id": 71145355, "body": "If your workbook is a template where users work off of then i suggest worksheet password protect therefore user cannot change anything on worksheet other then the areas needed to be change. Then set workbook as read only therefore they cannot save over the file thus having to save as another workbook name."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 4391373, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c4fef5f85c23acd32d3a46c5350e79cb?s=128&d=identicon&r=PG&f=1", "display_name": "SMLBW", "link": "https://stackoverflow.com/users/4391373/smlbw"}, "edited": false, "score": 0, "creation_date": 1485963352, "post_id": 41983288, "comment_id": 71145034, "body": "Thanks Nick, that actually looks to suit my needs exactly, slightly embarrassed that I did not think that and was trying to over-complicate things. Before closing it off though, can you think of what circumstances may require one of the more complex options I mentioned? Want to check I am not missing anything."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1485964944, "post_id": 41983288, "comment_id": 71146300, "body": "Just keeping track of updates etc, but that will be common to all the options."}, {"owner": {"reputation": 2465, "user_id": 2570277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0483cce5f2ea53671a36477fed79898b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2570277/nick"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1486120367, "post_id": 41983288, "comment_id": 71219777, "body": "@SolarMike took the words out of my mouth :)"}], "tags": [], "owner": {"reputation": 2465, "user_id": 2570277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0483cce5f2ea53671a36477fed79898b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2570277/nick"}, "is_accepted": true, "score": 2, "last_activity_date": 1485962338, "creation_date": 1485962338, "answer_id": 41983288, "question_id": 41983067, "link": "https://stackoverflow.com/questions/41983067/prevent-excel-document-being-overwritten/41983288#41983288", "title": "Prevent Excel document being overwritten", "body": "<p>How about saving the document as Read-only? That way they can't save over the original. </p>\n\n<p>To do so File > Save as and then next to the save button click the tools button as shown, then general options and check the Read only box as shown in the next image.</p>\n\n<p><a href=\"https://i.stack.imgur.com/vdYMv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vdYMv.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/opSd2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/opSd2.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 113, "user_id": 4391373, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c4fef5f85c23acd32d3a46c5350e79cb?s=128&d=identicon&r=PG&f=1", "display_name": "SMLBW", "link": "https://stackoverflow.com/users/4391373/smlbw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4303, "favorite_count": 0, "accepted_answer_id": 41983288, "answer_count": 1, "score": 1, "last_activity_date": 1485962338, "creation_date": 1485961699, "question_id": 41983067, "link": "https://stackoverflow.com/questions/41983067/prevent-excel-document-being-overwritten", "title": "Prevent Excel document being overwritten", "body": "<p>I am creating Excel reports for clients to enable multi users to pull in data relevant to their sector of the business and am exploring options to protect the documents from being overwritten whilst still allowing macros to run and the document to be edited.</p>\n\n<p>Googling gives three commonly suggested ways to do this:</p>\n\n<p>1) Password protect the file when saving so that regular users cannot save over the original file</p>\n\n<ul>\n<li><strong>Pro:</strong> does not require vba, no version control issues</li>\n<li><strong>Con:</strong> Risk of forgetting password, pop-up could be considered    annoying for users</li>\n</ul>\n\n<p>2) Create a workbook_beforesave event which prevents the original file being overwritten</p>\n\n<ul>\n<li><p><strong>Pro:</strong> no pop-up / invisible to users, no version control issues</p></li>\n<li><p><strong>Con:</strong> if project is password then risk of password being forgotten, requires vba which could put off some people</p></li>\n</ul>\n\n<p>3) Saving file as .xltm (template) which forces user to save as a new document rather than overwrite</p>\n\n<ul>\n<li><p><strong>Pro:</strong> no pop-up / invisible to users, no password issues, does not require vba</p></li>\n<li><p><strong>Con:</strong> changes would be have to be done in the original file and then re-saved as template so might cause version control issues.</p></li>\n</ul>\n\n<p>Are there any other options or further pros/cons to be considered for each of the suggested options?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 1, "creation_date": 1485961626, "post_id": 41983020, "comment_id": 71143718, "body": "You have no &quot;End If&quot; after the last line. Else put &quot;:&quot; after &quot;Then&quot; on your last code If 4 = 4 Then:"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1485961745, "post_id": 41983020, "comment_id": 71143814, "body": "@pokemon_Man, yeah, but number 3 works pretty good without any <code>End If</code>"}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1485961783, "post_id": 41983020, "comment_id": 71143845, "body": "number 3 has a colon and number 4 do not. Put a colon after &quot;Then&quot; on number 4"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1485961835, "post_id": 41983020, "comment_id": 71143879, "body": "Then it should be exactly like number 3. And I want to write it on 2 lines."}, {"owner": {"reputation": 1097, "user_id": 5626959, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a69e414eff81de3460cef89d2c97492f?s=128&d=identicon&r=PG&f=1", "display_name": "RyanL", "link": "https://stackoverflow.com/users/5626959/ryanl"}, "edited": false, "score": 2, "creation_date": 1485961937, "post_id": 41983020, "comment_id": 71143956, "body": "then you&#39;ll need to add an End If"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485961996, "post_id": 41983020, "comment_id": 71144010, "body": "In my humble knowledge, <code>:</code> is used to put multiple commands on the same line as the VBA compiler will be a bit more performant having less lines to read. So it don&#39;t see the point of 3 and 4... Then you could use <code>_</code> to change line, but it&#39;s the same issue..."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1485962561, "post_id": 41983020, "comment_id": 71144427, "body": "The <code>:</code> straight after the <code>Then</code> is basically ignored, other to force it into being a single line <code>If</code>.  <code>Debug.Print 3</code> is executed whether the previous statement is <code>If 3 = 3 Then</code> or <code>If 3 = 15 Then</code>."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 1, "creation_date": 1485963516, "post_id": 41983020, "comment_id": 71145142, "body": "When <code>python</code> programmer does <code>vba</code> you get the last (commented) statement"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1485991610, "post_id": 41983020, "comment_id": 71160491, "body": "@ja72 - I knew it reminds me something :)"}], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1485961987, "post_id": 41983139, "comment_id": 71144004, "body": "<code>The first one is fine because the command after Then is on the same line.</code> - but we have a statement deliminator, it should be treated as if it goes on another line."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 3, "creation_date": 1485962143, "post_id": 41983139, "comment_id": 71144113, "body": "@Vityata - No, with the <code>:</code> and then the command it is still a single line <code>If</code>, just like <code>If 5 = 5 Then Debug.Print 5: Debug.Print 5: Debug.Print 5</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1485962411, "post_id": 41983139, "comment_id": 71144305, "body": "@YowE3K - I would have expected an error in case 1 and 3."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 3, "creation_date": 1485962482, "post_id": 41983139, "comment_id": 71144365, "body": "Case 3 works because when the <code>If</code> is evaluated to <code>True</code> there are no statements to execute (other than the dummy statements preceding / following the <code>:</code>)."}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1485963001, "post_id": 41983139, "comment_id": 71144759, "body": "@YowE3K Really?  That&#39;s kinda cool actually.  I&#39;ll update to reflect that."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 3, "creation_date": 1485963255, "post_id": 41983139, "comment_id": 71144954, "body": "@Vityata - I&#39;d suggest you use an example of <code>If 5 = 5 Then Debug.Print 5::: Debug.Print 5</code> except that it would make it too obvious what the answer is - that a <code>:</code> just separates statements even if one of those statements is a dummy non-statement.  P.S. If you single-step through your code it becomes more apparent what is happening."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1485963350, "post_id": 41983139, "comment_id": 71145032, "body": "Agree with @YowE3K, I tried it as well, all statements following the <code>If</code> and separated with <code>:</code> will be merged in one. Following it step by step with the debugger is just amazing!"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1485963656, "post_id": 41983139, "comment_id": 71145237, "body": "@YowE3K, yup, just added it. Looks interesting, did not know it."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1485963735, "post_id": 41983139, "comment_id": 71145302, "body": "@Vityata - or of course the example <code>If 5 = 6 Then Debug.Print 5::: Debug.Print 5 Else Debug.Print 6: Debug.Print 6</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1485963906, "post_id": 41983139, "comment_id": 71145452, "body": "@YowE3K - it is added."}], "tags": [], "owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "is_accepted": false, "score": 3, "last_activity_date": 1485963371, "last_edit_date": 1485963371, "creation_date": 1485961877, "answer_id": 41983139, "question_id": 41983020, "link": "https://stackoverflow.com/questions/41983020/vba-how-the-colon-works-in-vba-code-with-condition/41983139#41983139", "title": "VBA - How the colon `:` works in VBA code with condition", "body": "<p>If Then Blocks require a matching End If when they are multi-line.</p>\n\n<p>The first case is fine because the command after Then is on the same line.</p>\n\n<p>The second case is fine for the same reason, the : makes no difference in this situation.</p>\n\n<p>The third case works because when the IF statement evaluates to True, there is no command following the ':'.  The : signals to compiler that the next command should be seen as being on the same line.  There is nothing following, so processing moves to the next line which is seen as outside the If Then Block.</p>\n\n<p>The fourth case has no notation to tell the compiler that the If Then command is single line, and therefore it is looking for the End IF to the block.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n  If 1 = 1 Then: Debug.Print 1 '&lt;-- All on a single line - OK\n\n  If 2 = 2 Then Debug.Print 2  '&lt;-- All on a single line - OK\n\n  If 3 = 3 Then:               '&lt;-- No command following :\n    Debug.Print 3              '&lt;-- Seen as outside the If Then Block\n\n'   Gives error:\n'    If 4 = 4 Then\n'        Debug.Print 4\n'    End IF                   '&lt;-- Required to show the end of the If Then block\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1485962807, "post_id": 41983416, "comment_id": 71144605, "body": "Yep, in that case, you&#39;&#39;ll need an endif"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 12, "last_activity_date": 1485963642, "last_edit_date": 1485963642, "creation_date": 1485962656, "answer_id": 41983416, "question_id": 41983020, "link": "https://stackoverflow.com/questions/41983020/vba-how-the-colon-works-in-vba-code-with-condition/41983416#41983416", "title": "VBA - How the colon `:` works in VBA code with condition", "body": "<p>I think the confusion comes from <code>3</code>. We'd think that <code>3</code> and <code>4</code> should behave the same. In fact, <code>3</code> is equivalent to this:</p>\n\n<pre><code>If 3 = 3 Then: (do nothing) 'an empty statement\n   Debug.Print 3 ' &lt;-- This will be executed regardless of the previous If condition\n</code></pre>\n\n<p>To see it, change <code>3</code> into this:</p>\n\n<pre><code>If 3 = 0 Then:\n    Debug.Print 3 '&lt;-- 3 will be printed! ;)\n</code></pre>\n\n<p>In conclusion, yes, the <code>:</code> is indeed to merge many statements on a single line </p>\n\n<p>Good job @Vityata !!! :)</p>\n"}], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3417, "favorite_count": 1, "accepted_answer_id": 41983416, "answer_count": 2, "score": 9, "last_activity_date": 1485963878, "creation_date": 1485961547, "last_edit_date": 1531164843, "question_id": 41983020, "link": "https://stackoverflow.com/questions/41983020/vba-how-the-colon-works-in-vba-code-with-condition", "title": "VBA - How the colon `:` works in VBA code with condition", "body": "<p>The colon operator <code>:</code> is a statement delimiter in VBA.</p>\n\n<p>However, does anyone has a clue why the first three examples work and the fourth (when uncommented) produces an error?</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    If 1 = 1 Then: Debug.Print 1\n\n    If 2 = 2 Then Debug.Print 2\n\n    If 3 = 3 Then:\n        Debug.Print 3\n\n'   Gives error:\n'    If 4 = 4 Then\n'        Debug.Print 4\n\n'Other Examples, from the comments and the answers:\n\n::::::::::::::::::::::::::::         '&lt;-- This seems to be ok\n\n    If 5 = 5 Then Debug.Print \"5a\"::: Debug.Print \"5b\"\n    If 6 = 0 Then Debug.Print \"6a\"::: Debug.Print \"6b\"\n\n    If 7 = 0 Then:\n        Debug.Print 7 ' Does not have anything to do with the condition...\n\n    If 8 = 0 Then Debug.Print \"8a\"::: Debug.Print \"8b\" Else Debug.Print \"8c\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "image", "printing"], "answers": [{"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 0, "last_activity_date": 1485969234, "last_edit_date": 1485969234, "creation_date": 1485968033, "answer_id": 41985298, "question_id": 41982872, "link": "https://stackoverflow.com/questions/41982872/is-is-possible-to-use-a-printable-image-as-a-spreadsheet-background/41985298#41985298", "title": "Is is possible to use a printable image as a spreadsheet background", "body": "<p>The following would put the image on screen, without the transparency/fade etc.</p>\n\n<pre><code>Worksheets(\"tool\").SetBackgroundPicture Filename:= \"Z:\\Capture.JPG\"\n</code></pre>\n\n<p>And this would add the image as part of the document header, so it would print.</p>\n\n<pre><code>With Worksheets(\"tool\").PageSetup\n    .LeftHeaderPicture.Filename = \"Z:\\Capture.JPG\"\n    .LeftHeader = \"&amp;G\"\nEnd With\n</code></pre>\n\n<p>You could always use a paint program to edit the image to mimic the fade/transparency.</p>\n"}], "owner": {"reputation": 632, "user_id": 7273886, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/26ac35f03f943adc61a1208fcba6b53b?s=128&d=identicon&r=PG&f=1", "display_name": "Bartek Malysz", "link": "https://stackoverflow.com/users/7273886/bartek-malysz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 432, "favorite_count": 0, "accepted_answer_id": 41985298, "answer_count": 1, "score": 0, "last_activity_date": 1594204981, "creation_date": 1485961131, "last_edit_date": 1594204981, "question_id": 41982872, "link": "https://stackoverflow.com/questions/41982872/is-is-possible-to-use-a-printable-image-as-a-spreadsheet-background", "title": "Is is possible to use a printable image as a spreadsheet background", "body": "<p>is it possible to use an image from a disk as a printable excel spreadsheet background, which would not cover cells? I want to embed a snip image of a document onto worksheet, add text and calculation in particular cells on top of the image and be able to print it along with the values in cells.</p>\n\n<p>I used the below code, but it does not put the image as a background. Even if transparency is lets say 35% the image is faded, so are the values in the cells.</p>\n\n<pre><code>Worksheets(\"tool\").Range(\"A1\").Select\nActiveSheet.Shapes.AddShape(msoShapeRectangle, 0, 0, 432, 435).Select\n\nWith Selection.ShapeRange.Fill\n    .Visible = msoTrue\n    .UserPicture \"Z:\\Capture.JPG\"\n    .Transparency = 0.35\n    .TextureTile = msoFalse\n    .TextureHorizontalScale = 1\n    .TextureVerticalScale = 1\n    .TextureAlignment = msoTextureTopLeft\nEnd With\n</code></pre>\n\n<p>Is there any better way to achieve what I need please?</p>\n\n<p>Many thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1485961307, "post_id": 41982862, "comment_id": 71143514, "body": "Hello and welcome to SO. Please take some time to read the help page, including <a href=\"http://stackoverflow.com/help/on-topic\">What topics can I ask about here?</a> and <a href=\"http://stackoverflow.com/help/dont-ask\">What types of questions should I avoid asking?</a>. Also Note that SO is NOT a code writing service...we are programmers trying to help other programmers through specific questions or errors. If you don&#39;t include the code you are working with and a detailed explanation of any errors or expectations vs reality...we can&#39;t help much.  Use code formatted in <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>"}, {"owner": {"reputation": 1029, "user_id": 1474994, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/rOT6j.png?s=128&g=1", "display_name": "UndeadBob", "link": "https://stackoverflow.com/users/1474994/undeadbob"}, "edited": false, "score": 0, "creation_date": 1486130687, "post_id": 41982862, "comment_id": 71226044, "body": "The workbook, &quot;Report 1&quot;, must be open.  For that matter, if <code>Tick_Nums</code> is only one column, you shouldn&#39;t need the <code>COLUMNS(&#39;Report 1&#39;!C5)</code>.  <i>This would be much easier to diagnose with a screenshot of some of these columns...</i>"}], "answers": [{"comments": [{"owner": {"reputation": 1029, "user_id": 1474994, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/rOT6j.png?s=128&g=1", "display_name": "UndeadBob", "link": "https://stackoverflow.com/users/1474994/undeadbob"}, "reply_to_user": {"reputation": 1, "user_id": 7501034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a68e52c7440cb005b53655114d513779?s=128&d=identicon&r=PG&f=1", "display_name": "genesisjoec", "link": "https://stackoverflow.com/users/7501034/genesisjoec"}, "edited": false, "score": 0, "creation_date": 1485962855, "post_id": 41983241, "comment_id": 71144651, "body": "For <code>VLOOKUP</code>, the value in <code>Q5</code> <i>must</i> be found in the left most column."}], "tags": [], "owner": {"reputation": 1029, "user_id": 1474994, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/rOT6j.png?s=128&g=1", "display_name": "UndeadBob", "link": "https://stackoverflow.com/users/1474994/undeadbob"}, "is_accepted": false, "score": 1, "last_activity_date": 1485962191, "creation_date": 1485962191, "answer_id": 41983241, "question_id": 41982862, "link": "https://stackoverflow.com/questions/41982862/vlookup-certain-criteria-from-one-workbook-to-another/41983241#41983241", "title": "Vlookup Certain Criteria From One Workbook to Another", "body": "<p>I completely agree with Rdster's comment.  That said, you don't need VBA.  You're looking for <code>MATCH</code> and <code>INDEX</code>.  You just want to <code>MATCH</code> the <em>number</em> in the ticket workbook and use that output as input to the <code>INDEX</code> for each column of data you want.  Good luck and edit your post if you have issues (but please provide some failed formulas next time).</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7501034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a68e52c7440cb005b53655114d513779?s=128&d=identicon&r=PG&f=1", "display_name": "genesisjoec", "link": "https://stackoverflow.com/users/7501034/genesisjoec"}, "is_accepted": false, "score": 0, "last_activity_date": 1486134353, "last_edit_date": 1486134353, "creation_date": 1485968846, "answer_id": 41985559, "question_id": 41982862, "link": "https://stackoverflow.com/questions/41982862/vlookup-certain-criteria-from-one-workbook-to-another/41985559#41985559", "title": "Vlookup Certain Criteria From One Workbook to Another", "body": "<p>Thank you everyone who took the time to provide help.  I figured it out with this code:</p>\n\n<pre><code>=VLOOKUP(A15,'Report 1'!C:M,11,FALSE)\n</code></pre>\n\n<p>The key here though was to <strong>convert those numbers from text to numbers</strong>.  Excel did not recognize them as numbers at first, but once I did that it worked.</p>\n"}], "owner": {"reputation": 1, "user_id": 7501034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a68e52c7440cb005b53655114d513779?s=128&d=identicon&r=PG&f=1", "display_name": "genesisjoec", "link": "https://stackoverflow.com/users/7501034/genesisjoec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1486134353, "creation_date": 1485961097, "last_edit_date": 1485964883, "question_id": 41982862, "link": "https://stackoverflow.com/questions/41982862/vlookup-certain-criteria-from-one-workbook-to-another", "title": "Vlookup Certain Criteria From One Workbook to Another", "body": "<p>I have been racking my brain on this because I suck with excel. I have two workbooks. One workbook (survey workbook) contains a column of specific numbers that I need to find in another workbook(ticket workbook). The ticket workbook is a massive dataset with multiple columns that serve no use to me. What I need from the ticket workbook are two columns. The numbers I  am searching for have a column associated with them that I need to pull too. So I need to search for these exact numbers within the ticket workbook and return those numbers along with the one associated column I need. I would like to automate this process with VBA if possible.</p>\n\n<p>I have used ctrl+shift+end to select the entire table and I named it data.</p>\n\n<p>I created two additional columns in the ticket workbook labeled ticket (with the numbers that I need under the header) and driver (for the other column I need in the workbook).</p>\n\n<p>Here is my code : \n=VLOOKUP(Q5,data,12,FALSE)</p>\n\n<p>Q5 contains the first number that I'm trying to find within the workbook. 12 is the column that I need associated with the number I'm searching for in the workbook.The formula cames back as #N/A.</p>\n\n<p>I'm tried using the index and match function , but I'm still getting #N/A.</p>\n\n<p>My Code: \n=INDEX(Tick_Nums,MATCH($A2,Tick_Drivs,0),COLUMNS('Report 1'!C5))</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 1, "creation_date": 1485960964, "post_id": 41982734, "comment_id": 71143258, "body": "You could clean that code up a lot following <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">Avoid Select/Activate</a>"}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 3638193, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/714117384/picture?type=large", "display_name": "SQUISH", "link": "https://stackoverflow.com/users/3638193/squish"}, "edited": false, "score": 0, "creation_date": 1485961543, "post_id": 41982804, "comment_id": 71143661, "body": "This is awesome, and it worked. However, it is SUMming sideways, how can I make it sum just the row above?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 155, "user_id": 3638193, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/714117384/picture?type=large", "display_name": "SQUISH", "link": "https://stackoverflow.com/users/3638193/squish"}, "edited": false, "score": 0, "creation_date": 1485961603, "post_id": 41982804, "comment_id": 71143695, "body": "@SQUISH what do you mean just the row above ? you want to sum only the last row from the entire range ?"}, {"owner": {"reputation": 155, "user_id": 3638193, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/714117384/picture?type=large", "display_name": "SQUISH", "link": "https://stackoverflow.com/users/3638193/squish"}, "edited": false, "score": 0, "creation_date": 1485961802, "post_id": 41982804, "comment_id": 71143859, "body": "I want to sum the cells in the sumrow directly above, right now it&#39;s summing the whole row..does that make sense?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 155, "user_id": 3638193, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/714117384/picture?type=large", "display_name": "SQUISH", "link": "https://stackoverflow.com/users/3638193/squish"}, "edited": false, "score": 0, "creation_date": 1485962193, "post_id": 41982804, "comment_id": 71144143, "body": "@SQUISH you want to sum all cells in the row above ? like if I&#39;m at Cell E3, you want to sum cells(D2:D5) ?"}, {"owner": {"reputation": 155, "user_id": 3638193, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/714117384/picture?type=large", "display_name": "SQUISH", "link": "https://stackoverflow.com/users/3638193/squish"}, "edited": false, "score": 0, "creation_date": 1485962372, "post_id": 41982804, "comment_id": 71144276, "body": "what you said above is correct, sorry, I do want the sum formula at the row below the bottom row of my sumrow named range...i&#39;ll re edit my code, it&#39;s not working."}, {"owner": {"reputation": 155, "user_id": 3638193, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/714117384/picture?type=large", "display_name": "SQUISH", "link": "https://stackoverflow.com/users/3638193/squish"}, "edited": false, "score": 0, "creation_date": 1485962888, "post_id": 41982804, "comment_id": 71144680, "body": "something is not working the xlDown, when i put the error over the code xlDown (=-4121)..."}, {"owner": {"reputation": 155, "user_id": 3638193, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/714117384/picture?type=large", "display_name": "SQUISH", "link": "https://stackoverflow.com/users/3638193/squish"}, "edited": false, "score": 0, "creation_date": 1485964842, "post_id": 41982804, "comment_id": 71146220, "body": "Range(&quot;sumrow&quot;).Offset(1, 0).Formula = &quot;=Sum(&quot; &amp; Range(&quot;sumrow&quot;).Address &amp; &quot;)&quot;  this works but it selects my entire sumrow row, and I only want it to sum the totals direct above each cell below it, sumrow consists of 4 columns of numbers..."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 155, "user_id": 3638193, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/714117384/picture?type=large", "display_name": "SQUISH", "link": "https://stackoverflow.com/users/3638193/squish"}, "edited": false, "score": 0, "creation_date": 1485966259, "post_id": 41982804, "comment_id": 71147193, "body": "@SQUISH your description doesn&#39;t make much sense to me - it would be really helpful if you could amend your question with a sample of the data."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 155, "user_id": 3638193, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/714117384/picture?type=large", "display_name": "SQUISH", "link": "https://stackoverflow.com/users/3638193/squish"}, "edited": false, "score": 0, "creation_date": 1485969663, "post_id": 41982804, "comment_id": 71149268, "body": "@SQUISH please edit your post and add a screen-shot of your excel sheet, describe where is <code>Range(&quot;sumrow&quot;)</code> defined, which data you want to Sum"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1485961568, "last_edit_date": 1485961568, "creation_date": 1485960949, "answer_id": 41982804, "question_id": 41982734, "link": "https://stackoverflow.com/questions/41982734/vba-to-autosum-selected-range/41982804#41982804", "title": "VBA to AutoSUM selected Range", "body": "<p>There is no need to <code>Select</code> <code>Range(\"sumrow\")</code>, and then use <code>Selection</code>, you can modify the <code>Formula</code> to the <code>Range</code> directly.</p>\n\n<p>Try the code below, it will put the <code>Sum</code> formula at the row below the bottom row of your \"sumrow\" named range:</p>\n\n<pre><code>Range(\"sumrow\").End(xlDown).Offset(1, 0) = \"=Sum(\" &amp; Range(\"sumrow\").Address(True, True) &amp; \")\"\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 3638193, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/714117384/picture?type=large", "display_name": "SQUISH", "link": "https://stackoverflow.com/users/3638193/squish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 910, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485962819, "creation_date": 1485960770, "last_edit_date": 1485962819, "question_id": 41982734, "link": "https://stackoverflow.com/questions/41982734/vba-to-autosum-selected-range", "title": "VBA to AutoSUM selected Range", "body": "<p>I am working on automating some reports by pasting data from raw files into my Template called PA Reach. I have named a range \"Sumrow\" and I need VBA to autosum the numbers above in each of the loops after pasting the data in. Here is what I have and I'm getting errors:</p>\n\n<pre><code>Workbooks.Open datapath &amp; datafile1 &amp; OutputFileExt\n  Sheets(\"Rep\").Activate\n  ActiveSheet.UsedRange.AutoFilter        \n\n  For i = 1 To terrs_to_generate\n    Workbooks(builder).Sheets(\"Control\").Activate\n\n    Range(\"Reportnum\") = i\n    currfile = Range(\"CurrFile\").Value\n    currterr = Range(\"CurrTerr\").Value\n    currRep = Range(\"currRep\").Value\n    terrname = Range(\"terrname\").Value\n    DMName = Range(\"DMName\").Value\n    TMStartDate = Range(\"TMstartdate\").Value\n\n    'open template\n    Workbooks.Open templatepath &amp; templatefile &amp; OutputFileExt\n\n    Set currtemplatefile = ActiveWorkbook\n\n    Sheets(\"Control\").Select\n    Sheets(\"control\").Range(\"terrname\") = terrname\n    Sheets(\"control\").Range(\"repname\") = currRep\n    Sheets(\"control\").Range(\"reportdate\") = reportdate\n    Sheets(\"control\").Range(\"TMstartdate\") = TMStartDate\n    Sheets(\"control\").Range(\"DMName\") = DMName\n    Sheets(\"control\").Range(\"Territory\") = currterr\n\n    Workbooks(datafile1 &amp; OutputFileExt).Activate\n    Selection.AutoFilter field:=1, Criteria1:=currterr\n\n    Range(\"A1\").Select\n    Range(Selection.Offset(1, 1).End(xlDown), Selection.End(xlToRight)).Copy\n    currtemplatefile.Activate\n    Sheets(\"PA Reach\").Select\n    Range(\"pasterange\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues\n\n    currtemplatefile.Activate\n    Range(\"formatrow\").Copy\n\n    Range(\"pasterange\").Select\n    Range(Selection.End(xlToRight), Selection.End(xlDown).Offset(0, 0)).Select\n    Selection.PasteSpecial Paste:=xlPasteFormats\n\n    'Delete PasteRange\n    Range(\"pasterange\").Select\n    Selection.EntireRow.Delete\n\n    'Value Range Sheet so no formulas show\n    ActiveSheet.UsedRange.Select\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues\n\n   Range(\"A1\").Select\n\n\n\n Sheets(\"control\").Delete\n'need to add in sum total\nRange(\"sumrow1\").End(xlDown).Offset(1, 0) = \"=Sum(\" &amp; Range(\"sumrow1\").Address(True, True) &amp; \")\"\n\n\n\n    'save as and close\n     ActiveWorkbook.SaveAs Filename:=(reportpath &amp; currfile &amp; OutputFileExt)   'not working\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1190, "user_id": 7410353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92df7e8954b8a6ed2a580c9dbec0cd70?s=128&d=identicon&r=PG&f=1", "display_name": "Svekke", "link": "https://stackoverflow.com/users/7410353/svekke"}, "is_accepted": false, "score": -1, "last_activity_date": 1485960380, "creation_date": 1485960380, "answer_id": 41982570, "question_id": 41982407, "link": "https://stackoverflow.com/questions/41982407/adding-new-tabs-with-excel-vba/41982570#41982570", "title": "Adding New Tabs with Excel VBA", "body": "<p>I guess you are trying to access a sheet that does not exist. Since I don't see any <code>Sheets.Add</code></p>\n\n<pre><code> Dim ws As Worksheet\n Set ws = ThisWorkbook.Sheets.Add(After:= _\n         ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))\n ws.Name = JobName\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": [], "owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "is_accepted": false, "score": 1, "last_activity_date": 1485960408, "creation_date": 1485960408, "answer_id": 41982580, "question_id": 41982407, "link": "https://stackoverflow.com/questions/41982407/adding-new-tabs-with-excel-vba/41982580#41982580", "title": "Adding New Tabs with Excel VBA", "body": "<p>Your .copy does not set a destination so it is copying it to a new workbook I assume. at which point the new workbook is selected and the Sheets(\"Setup\") reference within the loop is out of context (new workbook doesn't have a sheet named \"setup\".</p>\n\n<p>Either scope the copy location or reselect the workbook</p>\n\n<p>Specify copy destination:</p>\n\n<pre><code>Sub JobTabs()\nApplication.ScreenUpdating = False\nWorksheets(\"Setup\").Select\nFor i = 7 To 100\n    JobName = Sheets(\"Setup\").Cells(\"D\" &amp; i).Value\n    If JobName = \"\" Then\n        i = 100\n    Else\n        Sheets(\"Job A\").Copy after:=Sheets(\"Job A\")\n        ActiveSheet.Name = JobName\n    End If\nNext i\nEnd Sub\n</code></pre>\n\n<p>Reselect workbook</p>\n\n<pre><code>Sub JobTabs()\nApplication.ScreenUpdating = False\nWorksheets(\"Setup\").Select\nFor i = 7 To 100\n    ThisWorkbook.Activate\n    JobName = Sheets(\"Setup\").Cells(\"D\" &amp; i).Value\n    If JobName = \"\" Then\n        i = 100\n    Else\n        Sheets(\"Job A\").Copy\n        ActiveSheet.Name = JobName\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 7459948, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fde988cfaeed0e99fbb64914d126176c?s=128&d=identicon&r=PG&f=1", "display_name": "user7459948", "link": "https://stackoverflow.com/users/7459948/user7459948"}, "edited": false, "score": 0, "creation_date": 1485960909, "post_id": 41982612, "comment_id": 71143213, "body": "This runs but nothing happens. There&#39;s a list of 3 new tab names in cells D7:D9 on Setup worksheet."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 33, "user_id": 7459948, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fde988cfaeed0e99fbb64914d126176c?s=128&d=identicon&r=PG&f=1", "display_name": "user7459948", "link": "https://stackoverflow.com/users/7459948/user7459948"}, "edited": false, "score": 0, "creation_date": 1485961155, "post_id": 41982612, "comment_id": 71143403, "body": "@user7459948 try now, I modifed the code to loop on rows on Column D. Copy the edited code and try"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 33, "user_id": 7459948, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fde988cfaeed0e99fbb64914d126176c?s=128&d=identicon&r=PG&f=1", "display_name": "user7459948", "link": "https://stackoverflow.com/users/7459948/user7459948"}, "edited": false, "score": 0, "creation_date": 1486995146, "post_id": 41982612, "comment_id": 71573374, "body": "@user7459948  have you tested the code above ? is it working as you intended ?"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 2, "last_activity_date": 1485961071, "last_edit_date": 1485961071, "creation_date": 1485960457, "answer_id": 41982612, "question_id": 41982407, "link": "https://stackoverflow.com/questions/41982407/adding-new-tabs-with-excel-vba/41982612#41982612", "title": "Adding New Tabs with Excel VBA", "body": "<p>There is no need to use <code>Select</code>, just reference <code>Worksheets(\"Setup\")</code> directly using the <code>With</code> statement.</p>\n\n<p>Try the code below:</p>\n\n<pre><code>Sub JobTabs()\n\n    Dim i           As Long\n    Dim JobName     As Variant\n\n    Application.ScreenUpdating = False\n\n    With Worksheets(\"Setup\")\n        For i = 7 To 100\n            JobName = .Range(\"D\" &amp; i).Value\n            If JobName &lt;&gt; \"\" Then\n                ' copy the worksheet at the end\n                Sheets(\"Job A\").Copy After:=Sheets(ThisWorkbook.Sheets.Count)                    \n                ActiveSheet.Name = JobName\n            Else\n                Exit For\n            End If\n        Next i\n\n    End With\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7459948, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fde988cfaeed0e99fbb64914d126176c?s=128&d=identicon&r=PG&f=1", "display_name": "user7459948", "link": "https://stackoverflow.com/users/7459948/user7459948"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1576, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1485961071, "creation_date": 1485959905, "last_edit_date": 1485960755, "question_id": 41982407, "link": "https://stackoverflow.com/questions/41982407/adding-new-tabs-with-excel-vba", "title": "Adding New Tabs with Excel VBA", "body": "<p>The VBA below is supposed to look at a list on the Setup tab and create a new tab for each <code>JobName</code>. I'm getting an \"out of range\" error when executing.</p>\n\n<pre><code>Sub JobTabs()\n\nApplication.ScreenUpdating = False\nWorksheets(\"Setup\").Select\nFor i = 7 To 100\n    JobName = Sheets(\"Setup\").Cells(\"D\" &amp; i).Value\n    If JobName = \"\" Then\n        i = 100\n    Else\n        Sheets(\"Job A\").Copy\n        ActiveSheet.Name = JobName\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["javascript", "html", "excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1485964818, "post_id": 41982226, "comment_id": 71146203, "body": "What is 3955, what do text1/2 etc mean, can you elaborate, or are you saying query the database and find the id of say text1 which would be 3955?"}, {"owner": {"reputation": 1, "user_id": 7500824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee2ebe5b904e87c072fceda96d25841?s=128&d=identicon&r=PG&f=1", "display_name": "mikit", "link": "https://stackoverflow.com/users/7500824/mikit"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1485966054, "post_id": 41982226, "comment_id": 71147046, "body": "3955 is random ID assigned by database. Database is a list of devices, each has name (text1) and IP (text2). There are hundreds of devices, each has one &quot;tr&quot; section in webpage code. In an example there is a code for 2 devices. I need to select e.g. 5 devices that are in database, check a checkbox next to that device and let database do something. I don&#39;t know ID as it is internally assigned. I know only hostname and IP. I need to get that ID based on the text1 or text2 (text3 and 4 are for the second device, etc.) and then use that ID in a vba code to check checkbox."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1485966466, "post_id": 41982226, "comment_id": 71147318, "body": "you need to look at using html controls library, you haven&#39;t actually posted your VBA so cant comment, but I&#39;d use a collection populated using <code>document.getelementsbytagname(&quot;TABLE&quot;)(0).getElementsByTagNa&zwnj;&#8203;me(&quot;TD&quot;)</code> and work through that collection in steps of 2 to get the ID that way."}, {"owner": {"reputation": 1, "user_id": 7500824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee2ebe5b904e87c072fceda96d25841?s=128&d=identicon&r=PG&f=1", "display_name": "mikit", "link": "https://stackoverflow.com/users/7500824/mikit"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1486043548, "post_id": 41982226, "comment_id": 71183987, "body": "I think I&#39;ve solved it. I will post code later for reference. What you&#39;ve proposed actually helped me.  Thank you Nathan."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7500824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee2ebe5b904e87c072fceda96d25841?s=128&d=identicon&r=PG&f=1", "display_name": "mikit", "link": "https://stackoverflow.com/users/7500824/mikit"}, "is_accepted": true, "score": 0, "last_activity_date": 1486044742, "creation_date": 1486044742, "answer_id": 42004431, "question_id": 41982226, "link": "https://stackoverflow.com/questions/41982226/excel-vba-check-checkbox-on-webpage-based-on-inner-text/42004431#42004431", "title": "Excel VBA: Check checkbox on webpage based on inner text", "body": "<p>This is working for me:</p>\n\n<p>Find in which \"tr\" section hostname or IP is and then just read the ID value.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>' find tr and ID\nFor i = 1 To 5000\n    checkdevX = ie.Document.getElementsByTagName(\"tr\")(i).innerText\n    If InStr(checkdevX, \"text2\") Then\n        idvalue = ie.Document.getElementsByTagName(\"tr\")(i).getElementsByTagName(\"td\")(0). _\n                    getElementsByTagName(\"input\")(0).getAttribute(\"value\")\n        Exit For\n    End If\nNext i\n\n' check checkbox\nSet CheckBox = ie.Document.getElementsByTagName(\"input\")\n    For Each idnumber In CheckBox\n        If (idnumber.getAttribute(\"value\") = idvalue) Then\n            idnumber.Click\n            Exit For\n        End If\n    Next\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7500824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee2ebe5b904e87c072fceda96d25841?s=128&d=identicon&r=PG&f=1", "display_name": "mikit", "link": "https://stackoverflow.com/users/7500824/mikit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 966, "favorite_count": 1, "accepted_answer_id": 42004431, "answer_count": 1, "score": -1, "last_activity_date": 1486044884, "creation_date": 1485959380, "last_edit_date": 1486044884, "question_id": 41982226, "link": "https://stackoverflow.com/questions/41982226/excel-vba-check-checkbox-on-webpage-based-on-inner-text", "title": "Excel VBA: Check checkbox on webpage based on inner text", "body": "<p>I know that there are few question on how to check checkbox but couldn't the situation I am dealing with.</p>\n\n<p>Here is the sample of webpage code:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;tr class=\"odd\"&gt;\r\n  &lt;td&gt;\r\n    &lt;input type=\"checkbox\" name=\"device_id\" value=\"3896\"&gt;\r\n  &lt;/td&gt;\r\n  &lt;td&gt;text1&lt;/td&gt;\r\n  &lt;td&gt;text2&lt;/td&gt;\r\n  &lt;td&gt;xxx&lt;/td&gt;\r\n  &lt;td&gt;\r\n    Good\r\n  &lt;/td&gt;\r\n  &lt;td&gt;\r\n   &lt;/td&gt;&lt;/tr&gt;\r\n\r\n&lt;tr class=\"odd\"&gt;\r\n  &lt;td&gt;\r\n    &lt;input type=\"checkbox\" name=\"device_id\" value=\"3955\"&gt;\r\n  &lt;/td&gt;\r\n  &lt;td&gt;text3&lt;/td&gt;\r\n  &lt;td&gt;text4&lt;/td&gt;\r\n  &lt;td&gt;xxx&lt;/td&gt;\r\n  &lt;td&gt;\r\n    Good\r\n  &lt;/td&gt;\r\n  &lt;td&gt;\r\n&lt;/td&gt;&lt;/tr&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>This is just a sample, there are hundreds of \"entries\" like this. </p>\n\n<p>I have a macro that opens a page and navigates where it should. It is also not a problem to check checkbox based on value, which is an ID assigned to text1/text2, text3/text4, etc. internally by a database. Problem is that I do not know that ID and all I know is text1/text2, text3/text4, etc.</p>\n\n<p>What I am struggling with is, how to check that checkbox if I know only those texts? I know there is a way how to match texts with and ID and then use that ID to check checkbox but I have no idea how to do that match. Any help will be appreciated :-)</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5402874, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/53c6d4cc57c6e876c32c9e5d594acc52?s=128&d=identicon&r=PG&f=1", "display_name": "kicpereniek", "link": "https://stackoverflow.com/users/5402874/kicpereniek"}, "edited": false, "score": 0, "creation_date": 1485963791, "post_id": 41981862, "comment_id": 71145343, "body": "Thanks a lot. It solves a problem when adding a column within the range. But if a column is added at the borders of the named range, it doesn&#39;t belong to the named range and, of course, doesn&#39;t hide/unhide. Do you know if there&#39;s a solution for that? For example, I need to add a column at the end of the named range (in this case it&#39;s BF), but when added it doesn&#39;t belong to the named range and, of course, doesn&#39;t hide when using a macro."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 33, "user_id": 5402874, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/53c6d4cc57c6e876c32c9e5d594acc52?s=128&d=identicon&r=PG&f=1", "display_name": "kicpereniek", "link": "https://stackoverflow.com/users/5402874/kicpereniek"}, "edited": false, "score": 0, "creation_date": 1486132841, "post_id": 41981862, "comment_id": 71227432, "body": "Will the column always contain content and is it the last populated column in the entire sheet?"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 5, "last_activity_date": 1485958303, "creation_date": 1485958303, "answer_id": 41981862, "question_id": 41981782, "link": "https://stackoverflow.com/questions/41981782/macro-to-hide-unhide-columns-in-excel/41981862#41981862", "title": "Macro to Hide/Unhide Columns in Excel", "body": "<p>You need to have a placer for the column. You could used a named range along the top row of columns AM:BF (Which will then change if you add a column in the middle of it). Your code could then look like</p>\n\n<pre><code>With ThisWorkbook.Sheets(\"MySheet\").Range(\"NamedRange\").EntireColumn\n    .Hidden = Not .Hidden   \nEnd With\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5402874, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/53c6d4cc57c6e876c32c9e5d594acc52?s=128&d=identicon&r=PG&f=1", "display_name": "kicpereniek", "link": "https://stackoverflow.com/users/5402874/kicpereniek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5234, "favorite_count": 0, "accepted_answer_id": 41981862, "answer_count": 1, "score": 2, "last_activity_date": 1485959733, "creation_date": 1485958060, "last_edit_date": 1485959733, "question_id": 41981782, "link": "https://stackoverflow.com/questions/41981782/macro-to-hide-unhide-columns-in-excel", "title": "Macro to Hide/Unhide Columns in Excel", "body": "<p>I created a simple macro to hide/unhide columns in Excel (attached below).\nIt works fine, however, when adding a column within the range of columns in the macro, the last column supposed to be hidden remains unhidden. \nTo make myself clear: The range of columns in macro is AM:BF. When I need to add a column within this range, the column BF stays unhidden. Could you help me how to improve the code so that the initial range of columns would stay hidden as well as the added one?</p>\n\n<pre><code>With Columns(\"AM:BF\")\n    If .EntireColumn.Hidden = True Then\n        .EntireColumn.Hidden = False\n    Else\n        .EntireColumn.Hidden = True\n    End If\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel", "merge", "duplicates"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1485957630, "post_id": 41981612, "comment_id": 71140953, "body": "see here for a method that uses conditional formatting: <a href=\"http://stackoverflow.com/questions/41938249/auto-grouping-merging-in-excel/41939842#comment71061510_41939842\" title=\"auto grouping merging in excel\">stackoverflow.com/questions/41938249/&hellip;</a>"}, {"owner": {"reputation": 1029, "user_id": 1474994, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/rOT6j.png?s=128&g=1", "display_name": "UndeadBob", "link": "https://stackoverflow.com/users/1474994/undeadbob"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1485958163, "post_id": 41981612, "comment_id": 71141310, "body": "@ScottCraner That was a good answer by Gordon.  I&#39;ll have to put that in my toolbox.  For this case, LucyG could simply make the font color white."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1485958544, "post_id": 41981876, "comment_id": 71141583, "body": "I understand what you are doing, but be careful, I have seen pseudo code answers down voted, heavily."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1485958653, "post_id": 41981876, "comment_id": 71141668, "body": "@ScottCraner, Nothing can get more than 5 downvotes. :)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1485958348, "creation_date": 1485958348, "answer_id": 41981876, "question_id": 41981612, "link": "https://stackoverflow.com/questions/41981612/merging-duplicate-column-data-without-losing-the-values-in-the-rest-of-the-rows/41981876#41981876", "title": "Merging duplicate column data without losing the values in the rest of the rows in Excel", "body": "<p>Actually, you need to focus only on the first column. The second has nothing to do with it.\nHere is some pseudo code, that would work, if you translate it to VBA:</p>\n\n<pre><code>FOR EACH CELL IN COLUMN NUMBER\n    IF CELL = OFFSET(PREVIOUS CELL) AND CELL.COLUMN &gt; 1 THEN\n        CELL.TEXT = \"\"\n    END IF\nNEXT CELL\n\nFOR EACH CELL IN COLUMN NUMBER\n    IF CELL = \"\" THEN \n        ENLARGE THE RANGE\n    ELSE\n        MERGE THE RANGE\n    END IF\nNEXT CELL\n\nIF RANGE &lt;&gt; NOTHING THEN\n     MERGE THE RANGE\nEND IF\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7500728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31142c88143091d33f019aa7a7649c89?s=128&d=identicon&r=PG&f=1", "display_name": "LucyG", "link": "https://stackoverflow.com/users/7500728/lucyg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 351, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485958348, "creation_date": 1485957518, "last_edit_date": 1485957835, "question_id": 41981612, "link": "https://stackoverflow.com/questions/41981612/merging-duplicate-column-data-without-losing-the-values-in-the-rest-of-the-rows", "title": "Merging duplicate column data without losing the values in the rest of the rows in Excel", "body": "<p>I'm trying to find a way to merge duplicate values in the first column of my data without losing the unique values in the rest of the rows. </p>\n\n<p>e.g. at the moment my data looks like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/xIyZ9.png\" alt=\"column a with a,a,a,b,b,b,c,c,c and column b with 1,2,3,4,1,2,3,4,1,2,3,4\"></p>\n\n<p>and I want it to look like this: </p>\n\n<p><img src=\"https://i.stack.imgur.com/7lafS.png\" alt=\"column a with a, b, c and column b with 1,2,3,4,1,2,3,4,1,2,3,4\"></p>\n"}, {"tags": ["sql", "vba", "batch-file", "ms-access"], "comments": [{"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 2, "creation_date": 1485957713, "post_id": 41981583, "comment_id": 71141000, "body": "In short, the answer is that you can store an sql query anywhere, effectively just a text string, so  save it to a .txt file, and you can reuse it.  If you want to query the db from a spreadsheet, try this: <a href=\"http://stackoverflow.com/questions/7842607/how-to-query-a-ms-access-table-from-ms-excel-2010-using-vba\" title=\"how to query a ms access table from ms excel 2010 using vba\">stackoverflow.com/questions/7842607/&hellip;</a>"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 2, "creation_date": 1485958833, "post_id": 41981583, "comment_id": 71141790, "body": "MS Access is like any other database and so most language/programs (Java, C#, Python, PHP, Perl, Excel, R, Stata, SAS, VB) can connect to it via ODBC and run SQL queries without ever opening up the MSAccess.exe GUI program. In fact, PC users don&#39;t need this Office app installed."}], "owner": {"reputation": 412, "user_id": 7475393, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd68c7076fe28993df2596dce832719d?s=128&d=identicon&r=PG&f=1", "display_name": "KrystianB", "link": "https://stackoverflow.com/users/7475393/krystianb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1485957431, "creation_date": 1485957431, "question_id": 41981583, "link": "https://stackoverflow.com/questions/41981583/access-save-query-externally-to-run-on-other-computers", "title": "Access save query externally to run on other computers?", "body": "<p>I have a mdb file that needs to be fixed.\nI don't have the latest copy, as it is still in use. I have an older back up which I created an sql query. \n<br>Is there a way I can save the query externally? Or create a single file that will run the query without people needing to go into Microsoft access?</p>\n"}, {"tags": ["javascript", "html", "excel", "vba"], "comments": [{"owner": {"reputation": 301, "user_id": 6563435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PNdis.jpg?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/6563435/joshua"}, "edited": false, "score": 2, "creation_date": 1485957382, "post_id": 41981501, "comment_id": 71140789, "body": "Can you show us the code you are working with, or provide a jsfiddle example of the problem?"}, {"owner": {"reputation": 3013, "user_id": 4516689, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xPRs0.png?s=128&g=1", "display_name": "Markus", "link": "https://stackoverflow.com/users/4516689/markus"}, "edited": false, "score": 0, "creation_date": 1485957833, "post_id": 41981501, "comment_id": 71141079, "body": "Perhaps browser automation would help you. e.g. Selenium"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1485960394, "post_id": 41981501, "comment_id": 71142849, "body": "The page may need an event to fire to update the cells. You can use FireBug to see which events are being called. To fire an onChange event you can try something like: Element.FireEvent(&quot;OnChange&quot;) or Browser.document.parentWindow.ExecScript(&quot;$(&#39;#MyEleID&#39;).chan&zwnj;&#8203;ge()&quot;) using jQuery."}, {"owner": {"reputation": 11, "user_id": 7441417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b06aa4023af9d744c65c177c37ec2ac?s=128&d=identicon&r=PG&f=1", "display_name": "puputtiap", "link": "https://stackoverflow.com/users/7441417/puputtiap"}, "edited": false, "score": 0, "creation_date": 1486039541, "post_id": 41981501, "comment_id": 71181366, "body": "Thanks for the tip on Firebug Ryan. If i look at the console when inputting hours, it is showing me this event: <b>unreachable code after return statement[Learn More]  IGAikidoCombined.js:3:4279</b>"}, {"owner": {"reputation": 11, "user_id": 7441417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b06aa4023af9d744c65c177c37ec2ac?s=128&d=identicon&r=PG&f=1", "display_name": "puputtiap", "link": "https://stackoverflow.com/users/7441417/puputtiap"}, "edited": false, "score": 0, "creation_date": 1487500401, "post_id": 41981501, "comment_id": 71805157, "body": "Some new info added. Website is using ajax so probably I need to try HTTP requests to make it work. The other option would be to go with selenium, although this app should be distributed to people with zero knowledge so I would prefer a method where user doesn&#39;t have to install anything.."}], "owner": {"reputation": 11, "user_id": 7441417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b06aa4023af9d744c65c177c37ec2ac?s=128&d=identicon&r=PG&f=1", "display_name": "puputtiap", "link": "https://stackoverflow.com/users/7441417/puputtiap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1487537582, "creation_date": 1485957199, "last_edit_date": 1487537582, "question_id": 41981501, "link": "https://stackoverflow.com/questions/41981501/added-more-content-to-tackle-the-issue-vba-controlling-html-table-with-javascri", "title": "Added more content to tackle the issue: VBA controlling HTML table with javascript", "body": "<p>Background:\nCurrently we have a situation where we need to fill in three different web based time tracking tools separately which is quite irritating and causes some accuracy problems. </p>\n\n<p>I have created a simple excel app to track time and every week i will submit reports from this app. Two platforms are simple HTML table and it was pretty easy to make submission work with those.</p>\n\n<p>The third webpage uses quite a lot of javascript and with that one i am having problems. I have virtually zero experience working with javascript so i am a bit lost where to find a solution.</p>\n\n<p>Problem:\nI can access and insert values to this table using table innerHTML</p>\n\n<p>However when i click update button or click away from the table, all the values disappear. When i physically click a row in the table it highlights it so I am guessing that it is provoking for some javascript function to record changes, am i on the right tracks here? </p>\n\n<p>Unfortunately the site is using login credentials so cannot share it.</p>\n\n<p>I really appreciate any help i can get on tackling this problem!</p>\n\n<p><strong>EDIT:</strong> It has been a while since i last had a chance to work with this. Current status is that i am still not able to populate report in a way that values would stick after refreshing the page.</p>\n\n<p>After some inspection i found that when you select something from the dropdown category it is calling XMLHttpRequest called UpdateTimesheet.</p>\n\n<p>Some progress at least, if i input value manually and then run following line in VBA it will save the input. Just cannot figure out how to input values to table so that it would actually stick...</p>\n\n<pre><code>IE.Document.parentWindow.execScript \"TimesheetPage.updateTimesheet()\", \"Ja\nvaScript\"\n</code></pre>\n\n<p>After some inspecting i found that the webpage is using MicrosoftAjax and the other thing is that when I click a cell in the table it activates:</p>\n\n<p>Tried xml request but since the site uses autologin with corporate credentials, cannot really ask users to save their credentials.. Not sure if there is a possibility to somehow open explorer first as it will auto login and the use it to fetch requests? Another thing i inspected was IGAikidoCOmpined.js and it pretty long action so don't want to paste whole code as it would be too much. However i guess this part might be interesting, </p>\n\n<pre><code>this._set_value($IG.GridActivationProps.ActiveGroupedRow, f);\nif (c) {\n    this.__raiseClientEvent(\"ActiveCellChanged\", $IG.ActiveCellChangedEventArgs, [this, this.get_activeCell(), true, (k ? k.get_row() : null)])\n</code></pre>\n\n<p>Couldn't figure out yet how to use this script though.. </p>\n\n<p>This is the form from the site.</p>\n\n<pre><code>&lt;form name=\"aspnetForm\" method=\"post\" action=\"./TimesheetPage.aspx\" id=\"aspnetForm\"&gt;\n&lt;div&gt;\n&lt;input type=\"hidden\" name=\"__EVENTTARGET\" id=\"__EVENTTARGET\" value=\"\"&gt;\n&lt;input type=\"hidden\" name=\"__EVENTARGUMENT\" id=\"__EVENTARGUMENT\" value=\"\"&gt;\n&lt;input type=\"hidden\" name=\"__VIEWSTATE\" id=\"__VIEWSTATE\"\n</code></pre>\n\n<p>Here is the Table I am trying to fill in:</p>\n\n<pre><code>&lt;div id=\"x:1502727720.3:mkr:container\" style=\"overflow: hidden; height: 372px;\" mkr=\"container\"&gt;\n   &lt;table cellspacing=\"0\" cellpadding=\"0\" border=\"0\" style=\"table-layout: fixed; width: 861px; visibility: visible;\" id=\"x:1502727720.4:mkr:dataTbl.hdn\" mkr=\"dataTbl.hdn\"&gt;\n      &lt;tbody id=\"x:1502727720.5:mkr:rows:nw:1\" class=\"ig_TimesheetItem igg_TimesheetItem\" nw=\"1\" mkr=\"rows\"&gt;\n         &lt;tr id=\"x:-33.10000:adr:0\" adr=\"0\" type=\"row\" class=\"\"&gt;\n            &lt;td adr=\"0\" idx=\"0\" type=\"cell\" wlkd=\"1\" class=\"\" title=\"\" style=\"width: 275px; text-align: left;\"&gt;&lt;/td&gt;\n            &lt;td adr=\"1\" idx=\"1\" type=\"cell\" wlkd=\"1\" class=\"\" style=\"width: 16px;\"&gt;&lt;input style=\"BORDER-RIGHT-WIDTH: 0px; WIDTH: 16px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 16px; VISIBILITY: hidden; BORDER-LEFT-WIDTH: 0px\" id=\"Image\" onclick=\"return false;\" src=\"../images/arrow_right_myTE_disabled.png\" alt=\"Replicate\" type=\"image\" name=\"Image\"&gt;&lt;/td&gt;\n            &lt;td adr=\"2\" idx=\"2\" type=\"cell\" wlkd=\"1\" class=\"\" style=\"width: 40px;\"&gt;&lt;/td&gt;\n            &lt;td adr=\"3\" idx=\"3\" type=\"cell\" wlkd=\"1\" class=\"\" style=\"width: 40px;\"&gt;&lt;/td&gt;\n</code></pre>\n\n<p>Once I activate a row by clicking in any cell of that table, this:</p>\n\n<pre><code>&lt;tr id=\"x:-33.10000:adr:0\" adr=\"0\" type=\"row\" class=\"\"&gt;\n   &lt;td adr=\"0\" idx=\"0\" type=\"cell\" wlkd=\"1\" class=\"\" title=\"\" style=\"width: 275px; text-align: left;\"&gt;&lt;/td&gt;\n   &lt;td adr=\"1\" idx=\"1\" type=\"cell\" wlkd=\"1\" class=\"\" style=\"width: 16px;\"&gt;&lt;input style=\"BORDER-RIGHT-WIDTH: 0px; \n</code></pre>\n\n<p>Becomes this:</p>\n\n<pre><code>&lt;tr id=\"x:-33.10000:adr:0\" adr=\"0\" type=\"row\" class=\"igg_TimesheetActiveRow\"&gt;\n   &lt;td adr=\"0\" idx=\"0\" type=\"cell\" wlkd=\"1\" class=\"igg_TimesheetActiveCell\" title=\"\" tabindex=\"0\" style=\"width: 275px; text-align: left;\"&gt;&lt;/td&gt;\n</code></pre>\n\n<p>I guess it should be possible to somehow send class to activate certain row?</p>\n\n<p>I found these two functions that seems to be related to activating the edition of the cells they are part of TimesheetPage.aspx</p>\n\n<pre><code>Sys.Application.add_init(function() {\n    $create(Infragistics.Web.UI.WebDataGrid, {\n        \"clientbindingprops\": [\n\n                                [\"CellEditing\"], {\n                                    \"c\": {\n                                        \"ecc\": \"igg_TimesheetEditCell\"\n\n                                'Assignment': [\n                                    [], {\n                                        \"c\": {\n                                            \"ro\": false,\n                                            \"ck\": \"Assignment\",\n                                            \"eid\": \"wdgTimeEntry_Assignment\"\n                                        }\n                                    }\n                                ]\n                            }],\n                            [\"ExitedEditMode:TimesheetPage.timeEntryGridExitingEditMode\", \"EnteringEditMode:TimesheetPage.timeEntryGridEnteringEditMode\"]\n                        ]\n                    ], , [\"CellValueChanged:TimesheetPage.timeEntryGridCellValueChanged\", \"CellValueChanging:TimesheetPage.timeEntryGridCellValueChanging\", \"RowAdding::2\", \"RowsDeleting::2\"]\n                ],\n\n                        [\"Activation\", , ], {\n                            \"c\": {\n                                \"arc\": \"igg_TimesheetActiveRow\",\n                                \"acc\": \"igg_TimesheetActiveCell\",\n                                \"arsc\": \"igg_TimesheetActiveRowSelector\",\n                                \"arsi\": \"igg_TimesheetActiveRowSelectorImage\",\n                                \"ahc\": \"igg_TimesheetActiveColumn\"\n\n                        [\"Selection\", 1, , 2, , , , ], {\n                            \"c\": {\n                                \"sh\": \"igg_TimesheetSelectedHeader\",\n                                \"ehs\": false,\n                                \"si\": \"igg_TimesheetSelectedRowSelectorImage\",\n                                \"sr\": \"igg_TimesheetSelectedRowSelector\",\n                                \"sc\": \"ig_TimesheetSelected igg_TimesheetSelectedCell\"\n\n                    ], , , [\"RowSelectionChanging:TimesheetPage.cancelSelectionIfNeeded\"]\n\n            [\"DataBound:TimesheetPage.timeEntryGridDataBound\", \"KeyDown:isValidTime\", \"Initialize:TimesheetPage.timeEntryGridInitialize\"],\n\n        \"id\": \"ctl00_ctl00_MainContentPlaceHolder_ContentPlaceHolder_TimeReport_wdgTimeEntry\",\n        \"name\": \"wdgTimeEntry\"\n    }, null, null, $get(\"ctl00_ctl00_MainContentPlaceHolder_ContentPlaceHolder_TimeReport_wdgTimeEntry\"));\n});\n\n\nSys.Application.add_init(function() {\n    $create(Infragistics.Web.UI.WebDataGrid, {\n        \"clientbindingprops\": [\n            [\n                [, 0, 0, 0], {\n                    \"c\": {\n                        \"vscb\": 1,\n                        \"cbc\": 0,\n                        \"ecr\": true,\n\n                        \"uid\": \"ctl00$ctl00$MainContentPlaceHolder$ContentPlaceHolder_TimeReport$wdgTimeCategory\",\n                        \"ti\": 0\n\n                        [\"EditingCore\"]\n\n                                [\"CellEditing\"], {\n                                    \"c\": {\n                                        \"ecc\": \"igg_TimesheetEditCell\"\n\n                            [\"ExitedEditMode:TimesheetPage.timeCategoryGridExitingEditMode\", \"EnteringEditMode:TimesheetPage.timeCategoryGridEnteringEditMode\"]\n                        ]\n                    ], , [\"CellValueChanged:TimesheetPage.timeEntryGridCellValueChanged\", \"CellValueChanging:TimesheetPage.timeCategoryGridCellValueChanging\", \"RowAdding::2\", \"RowsDeleting::2\"]\n\n                        [\"Activation\", , ], {\n                            \"c\": {\n                                \"arc\": \"igg_TimesheetActiveRow\",\n                                \"acc\": \"igg_TimesheetActiveCell\",\n                                \"arsc\": \"igg_TimesheetActiveRowSelector\",\n                                \"arsi\": \"igg_TimesheetActiveRowSelectorImage\",\n                                \"ahc\": \"igg_TimesheetActiveColumn\"\n\n\n            [\"DataBound:TimesheetPage.timeCategoryGridDataBound\"],\n            []\n        ],\n        \"id\": \"ctl00_ctl00_MainContentPlaceHolder_ContentPlaceHolder_TimeReport_wdgTimeCategory\",\n        \"name\": \"wdgTimeCategory\"\n    }, null, null, $get(\"ctl00_ctl00_MainContentPlaceHolder_ContentPlaceHolder_TimeReport_wdgTimeCategory\"));\n});\n</code></pre>\n"}, {"tags": ["vba", "email", "templates", "outlook", "mailitem"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4389453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbe9eced09bf61e16acccfde42f23ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Andr&#233; Muraro", "link": "https://stackoverflow.com/users/4389453/andr%c3%a9-muraro"}, "edited": false, "score": 0, "creation_date": 1485973138, "post_id": 41984019, "comment_id": 71151350, "body": "Yes, I had done that test, and EmailKRI returns type Object/MailItem, .class is olMail."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 31, "user_id": 4389453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbe9eced09bf61e16acccfde42f23ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Andr&#233; Muraro", "link": "https://stackoverflow.com/users/4389453/andr%c3%a9-muraro"}, "edited": false, "score": 0, "creation_date": 1485980089, "post_id": 41984019, "comment_id": 71155096, "body": "I can only suggest there is a problem with the Outlook type library at run-time..."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1485964213, "creation_date": 1485964213, "answer_id": 41984019, "question_id": 41981269, "link": "https://stackoverflow.com/questions/41981269/createitemfromtemplate-type-mismatch/41984019#41984019", "title": "CreateItemFromTemplate Type mismatch", "body": "<p>You will get that error if CreateItemFromTemplate returns something other than MailItem object. Are you sure the OFT file is for a regular mail item.\nAs a test, declare EmailKRI  as a generic Obejct and at run time check the value of the EmailKRI.Class property. It is supposed to be 43 (OlObjectClass.olMail) for the regular MailItem objects.</p>\n"}], "owner": {"reputation": 31, "user_id": 4389453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbe9eced09bf61e16acccfde42f23ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Andr&#233; Muraro", "link": "https://stackoverflow.com/users/4389453/andr%c3%a9-muraro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1043, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1609056575, "creation_date": 1485956470, "last_edit_date": 1609056575, "question_id": 41981269, "link": "https://stackoverflow.com/questions/41981269/createitemfromtemplate-type-mismatch", "title": "CreateItemFromTemplate Type mismatch", "body": "<p>I have code to generate an email based on data on a userform.</p>\n<p>It worked for a long time across multiple machines, but when I changed machines it started throwing a run-time error 13 type mismatch on on the <code>CreateItemFromTemplate</code> method in the following section:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub AcaoEnviar_Click()\n    Dim OutlookApp As New Outlook.Application\n    Dim EmailKRI As Outlook.MailItem\n\n    Set EmailKRI = OutlookApp.CreateItemFromTemplate(PATH_EMAIL_TEMPLATE)\n</code></pre>\n<p>The code still runs on other machines, suggesting the problem is local. My Outlook library is the same as on the other machines, and the only difference I\u00b4m aware of is that I\u00b4m running it on a 64-bit system and 32-bit office, while most others have 32-bit systems (one other has the same 64-bit setup and runs fine).</p>\n<p>Changing the object declaration from Outlook.MailItem to Object seems to solve the problem, which I think eliminates problems with Outlook's programmatic access, and in any case, my Antivirus status is valid.</p>\n<p>I'm still confused as to why such an error would occur only with me.<br />\nIs there any solution so that I can go back to early binding for that email object?</p>\n"}, {"tags": ["vba", "rubberduck"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485956137, "post_id": 41981099, "comment_id": 71139870, "body": "Since you didn&#39;t share your entire code (probabely too long) is <code>sMap</code> defined as <code>Name</code> ? did you set it to a <code>Range</code> ?"}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485956206, "post_id": 41981099, "comment_id": 71139918, "body": "I did, the only thing left out are the Declarations...added"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485956554, "post_id": 41981099, "comment_id": 71140165, "body": "What is the scope of your Named Ranges <code>oratio1map</code>...? Is it workbook? You should specify the sheet in which the range is defined to avoid that tag, ie <code>Sheets(&quot;SheetName&quot;).Range(...)</code>!"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485956653, "post_id": 41981099, "comment_id": 71140251, "body": "do you have a worksheet with the name that equals <code>Range(sMap).Cells(CurrentRow, 1)</code> ? you have a sheet per each name in the row of your <code>oratio1map</code> Named Range ? I&#39;m getting an error on the line <code>Set wsData = ActiveWorkbook.Worksheets(Test)</code> (because I don&#39;t have so many worksheets in my workbook)"}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1485957162, "post_id": 41981099, "comment_id": 71140633, "body": "Oratio1map is a range of cells I14:L16 on a sheets named Macro. Col I contains another Sheet name, Col J is another named range, Col K &amp; L are both starting rows for a report and data."}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1485957246, "post_id": 41981099, "comment_id": 71140695, "body": "The code works fine, my question is more about Rubberduck wanting the Range(named range) to be qualified...and whether it is really needed since it is a named range."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 2, "creation_date": 1485958156, "post_id": 41981099, "comment_id": 71141305, "body": "If you want, you can have <code>Dim Rng As Range</code>, and after <code>Set Rng = Range(sMap)</code> , even though it &quot;pleases&quot; the <b>Rubberduck</b>   I don&#39;t see any affects on your code."}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1485961092, "post_id": 41981099, "comment_id": 71143349, "body": "That would limit the number of instances of the warning, but it would still give me the warning on the first one...which still leads to the question, is it really necessary to qualify a range reference to a named range?  The named range has a sheet name as part of its reference."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 3, "creation_date": 1485961521, "post_id": 41981099, "comment_id": 71143650, "body": "This is legit. <code>ActiveSheet</code> doesn&#39;t have to be a <code>Worksheet</code>, so <code>Applictation.Range</code> calls can throw if <code>ActiveSheet</code> is a <code>Chart</code>, etc."}], "answers": [{"comments": [{"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 2, "creation_date": 1485962907, "post_id": 41983264, "comment_id": 71144696, "body": "Ok, I can understand that.  I&#39;ve learned quite a bit from what warnings my code throws.  This one though is that the named range has the worksheet mentioned as ActiveWorkbook.Names(&quot;Oratio1map&quot;) = &quot;=Macro!$I$14:$L$16&quot;...just seems almost redundant to use ActiveWorkbook.Sheets(&quot;Macro&quot;).Range(&quot;oratio1map&quot;) when the sheet name is already in the range.  However, if doing so will help eliminate errors or bugs, then I suppose I&#39;ll start doing that, and using the Rng as Shai suggested also."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 10, "last_activity_date": 1485962258, "last_edit_date": 1495542329, "creation_date": 1485962258, "answer_id": 41983264, "question_id": 41981099, "link": "https://stackoverflow.com/questions/41981099/code-inspection-named-range-reference/41983264#41983264", "title": "Code inspection - Named Range Reference", "body": "<blockquote>\n  <p>Disclaimer: I'm heavily involved in the development of Rubberduck.</p>\n</blockquote>\n\n<p>Consider this common mistake:</p>\n\n<pre><code>lastRow = Worksheets(\"Sheet12\").Cells(1, Rows.Count).End(xlUp).Row\n</code></pre>\n\n<p><code>Rows</code> is unqualified, and therefore implicitly refers to the active sheet and therefore <code>Rows.Count</code> isn't necessarily the row count on \"Sheet12\". The code <em>might</em> work, but it could also result in a subtle bug where <code>lastRow</code> doesn't have the correct value because of this, depending on the content of the active sheet.</p>\n\n<p>Or this one:</p>\n\n<pre><code>ActiveWorkbook.Worksheets(\"SummarySheet\") _\n    .ListObjects(\"Table1\").Sort.SortFields.Add _\n        Key:=Range(\"Table1[[#All],[\"Date]]\"), _    \n        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortTextAsNumbers\n</code></pre>\n\n<p>See it? Because the <code>Key</code> parameter isn't qualified, the call is going to fail at run-time with error 1004 - \"Method 'Range' of object '_Global' failed\". That's <a href=\"https://stackoverflow.com/search?q=is%3Aquestion+Method+%27Range%27+of+object+%27_Global%27+failed\">169 Stack Overflow questions</a>. \"Error 1004\" yields <a href=\"https://stackoverflow.com/search?q=%5Bvba%5D+is%3Aquestion+%22error+1004%22\">1465 Stack Overflow questions</a>.</p>\n\n<p>Implicit references to the active worksheet are a very common cause of bugs.</p>\n\n<hr>\n\n<p>Rubberduck's VBA code inspections are, like ReSharper's C# static code analysis, <em>hints/suggestions</em>. The tool is telling you that it's possible there's something here that <em>could</em> cause problems, or that makes the code less explicit than it could be.</p>\n\n<p>Do you <em>need</em> to fully qualify <em>every single <code>Range</code> call</em>? Of course not - Rubberduck is merely letting you know that in these instances, <code>ActiveSheet</code> is implicitly being referenced, that's all there is to it.</p>\n\n<p>You can always tell Rubberduck \"look, I know what I'm doing\", using the \"Ignore once\" quick-fix:</p>\n\n<p><img src=\"https://i.stack.imgur.com/5Hd5P.png\" alt=\"ignore once\"></p>\n\n<p>That \"fix\" inserts a special comment (internally, Rubberduck calls them \"annotations\") that instructs the inspection to ignore specific results, while leaving the inspection enabled:</p>\n\n<pre><code>  With ActiveWorkbook\n    Set wsMacro = .Worksheets(\"Macro\")\n    Set wsORatio = .Worksheets(\"ORatio\" &amp; TabNum)\n    With wsORatio\n      sMap = \"oratio\" &amp; TabNum &amp; \"map\"\n      '@Ignore ImplicitActiveSheetReference           \n      For CurrentRow = 1 To Range(sMap).Rows.Count             \n        '@Ignore ImplicitActiveSheetReference           \n        Test = Range(sMap).Cells(CurrentRow, 1)                \n        Set wsData = ActiveWorkbook.Worksheets(Test)\n        '@Ignore ImplicitActiveSheetReference           \n        Start = Range(Range(sMap).Cells(CurrentRow, 2)).Row    \n        Report = wsMacro.Range(sMap).Cells(CurrentRow, 3)\n        For Cat = 0 To 12\n          For iMth = 1 To 12\n            wsORatio.Cells(Report + Cat, 7 + iMth) = wsData.Cells(Start + Cat, 37 + iMth)\n          Next iMth\n        Next Cat\n      Next CurrentRow\n    End With\n  End With\n</code></pre>\n\n<p>These annotations have the advantage of telling the reader (future you, or whoever takes your code over) that there's something going on here.</p>\n\n<p>Future versions will eventually support specifying <code>@Ignore</code> annotations once at module-level, to ignore all results of a particular inspection in an entire module.</p>\n\n<hr>\n\n<p>Note that the inspection is under the <em>Maintainability and Readability Issues</em> category. <code>Range(\"DefinedName\")</code> isn't half as explicit and fail-safe as:</p>\n\n<pre><code>ActiveWorkbook.Names(\"DefinedName\").RefersToRange\n</code></pre>\n\n<p>Which gives you the same range, <em>and</em> reads like it's actually pulling a named range scoped at workbook level.</p>\n"}, {"comments": [{"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 3, "creation_date": 1485965965, "post_id": 41984364, "comment_id": 71146983, "body": "That makes sense, and considering that the guy that was here before me put a &quot;Macro&quot; sheet in every workbook...explicitly qualifying which workbook now sounds like a really good idea.  I guess I assumed that a named range would include that workbook somehow along with the sheet name."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 2, "creation_date": 1485966563, "post_id": 41984364, "comment_id": 71147377, "body": "@Rdster - Easy oversight to make.  You can see this by defining a range named &quot;Foo&quot; on 2 workbooks, then running <code>Debug.Print Range(&quot;Foo&quot;).Value</code> with each of them active."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 8, "last_activity_date": 1485965234, "creation_date": 1485965234, "answer_id": 41984364, "question_id": 41981099, "link": "https://stackoverflow.com/questions/41981099/code-inspection-named-range-reference/41984364#41984364", "title": "Code inspection - Named Range Reference", "body": "<blockquote>\n  <p>Disclaimer: I'm also involved in the development of Rubberduck.</p>\n</blockquote>\n\n<p>As @Mat'sMug already pointed out, the inspection is providing you information about the code.  What you <em>do</em> with that information is a matter of preference, coding sytle, etc.</p>\n\n<p>In this case, the inspection isn't telling you that there is an error in your code, it's telling you that there is a potential that implicit object references will cause your code to behave in unexpected ways.  <strong>The takeaway from this specific inspection is that you are letting Excel decide how to interpret which object you are referring to.</strong> </p>\n\n<p>From <a href=\"https://msdn.microsoft.com/en-us/library/office/ff841254.aspx\">the documentation</a> for <code>Application.Range</code>:</p>\n\n<blockquote>\n  <p>When used without an object qualifier, this property is a shortcut for\n  ActiveSheet.Range (it returns a range from the active sheet; if the\n  active sheet isn't a worksheet, the property fails).</p>\n</blockquote>\n\n<p>The last sentence is the first reason you shouldn't ignore this inspection - <code>Range</code> without a qualifier will throw if you have a <code>Chart</code> selected.  This is the same reason why you should use <code>Workbook.Worksheets(foo)</code> instead of <code>Workbook.Sheets(foo)</code> if you are assigning to a <code>Worksheet</code> (this is actually <a href=\"https://github.com/rubberduck-vba/Rubberduck/issues/1925\">on the Rubberduck inspection wish-list</a>).</p>\n\n<p>The second reason is related to the first. As you correctly point out in the comments, \"the named range has a sheet name as part of its reference\", or rephrased \"a named range can be assumed to be unique\".  But it <em>doesn't</em> have to be unique if you have more than one workbook open.  Since <code>ActiveSheet</code> is <strong><em>always</em></strong> returned from the <code>ActiveWorkbook</code> at the time of the call, if the <code>Workbook</code> the code expects is not active, this code will either throw or return the incorrect <code>Range</code> (if the other <code>Workbook</code> coincidentally contains a <code>Range</code> with the same name). </p>\n\n<p>Keep in mind that although the <code>With</code> block captures a hard reference to <code>ActiveWorkbook</code>, <code>Application</code> does not - and <code>ActiveWorkbook</code> can change during the course of your code's execution. This all ties back to the reasons why you should avoid using the <code>ActiveFoo</code> objects - <em>they introduce the possibility that errors will result from otherwise \"correct\" code</em>.</p>\n\n<p>The solution is simple.  Just add the dot in front of them. That way they'll be calling <code>Workbook.Range</code> via the captured hard reference from the <code>With</code> block instead of <code>Application.Range</code>.  </p>\n"}], "owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 519, "favorite_count": 0, "answer_count": 2, "score": 7, "last_activity_date": 1485965234, "creation_date": 1485955944, "last_edit_date": 1485956314, "question_id": 41981099, "link": "https://stackoverflow.com/questions/41981099/code-inspection-named-range-reference", "title": "Code inspection - Named Range Reference", "body": "<p>After running the code inspections in Rubberduck 2.0.11.2453, there are 4 Range references that get tagged as:</p>\n\n<blockquote>\n  <p>Member 'Range' implicitly references ActiveSheet</p>\n</blockquote>\n\n<p>The ranges in question are referring to Named Ranges.  Is it necessary to qualify a named range reference?  </p>\n\n<pre><code>Private Sub RunORatio(ByVal TabNum As Integer)\n  Dim Start As Integer, Cat As Integer, iMth As Integer, CurrentRow As Integer, Report As Integer\n  Dim wsORatio As Worksheet, wsData As Worksheet, wsMacro As Worksheet\n  Dim sMap As String, Test As String\n\n  With ActiveWorkbook\n    Set wsMacro = .Worksheets(\"Macro\")\n    Set wsORatio = .Worksheets(\"ORatio\" &amp; TabNum)\n    With wsORatio\n      sMap = \"oratio\" &amp; TabNum &amp; \"map\"           \n      For CurrentRow = 1 To Range(sMap).Rows.Count             '&lt;---1 here\n        Test = Range(sMap).Cells(CurrentRow, 1)                '&lt;---1 Here\n        Set wsData = ActiveWorkbook.Worksheets(Test)\n        Start = Range(Range(sMap).Cells(CurrentRow, 2)).Row    '&lt;---2 Here\n        Report = wsMacro.Range(sMap).Cells(CurrentRow, 3)\n        For Cat = 0 To 12\n          For iMth = 1 To 12\n            wsORatio.Cells(Report + Cat, 7 + iMth) = wsData.Cells(Start + Cat, 37 + iMth)\n          Next iMth\n        Next Cat\n      Next CurrentRow\n    End With\n  End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 3, "creation_date": 1485956122, "post_id": 41980933, "comment_id": 71139862, "body": "Hello and welcome to StackOverflow. Please take some time to read the help page, especially the sections named <a href=\"http://stackoverflow.com/help/on-topic\">What topics can I ask about here?</a> and <a href=\"http://stackoverflow.com/help/dont-ask\">What types of questions should I avoid asking?</a>. And more importantly, please read <a href=\"http://meta.stackexchange.com/q/156810/204922\">the Stack Overflow question checklist</a>. You might also want to learn about <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>.  And include the code you are trying to work through...so people can help."}], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 2, "last_activity_date": 1485959242, "last_edit_date": 1485959242, "creation_date": 1485956718, "answer_id": 41981355, "question_id": 41980933, "link": "https://stackoverflow.com/questions/41980933/copy-cells-containing-specific-word-to-cell-on-another-sheet/41981355#41981355", "title": "Copy cells containing specific word to cell on another sheet", "body": "<p>Place this formula in <code>DASHBOARD cell A1</code> :</p>\n\n<pre><code>=MID(INDEX(RESULTS!A:A, MATCH(\"Host name:*\", RESULTS!A:A,0)), 2+LEN(\"Host name:\"),1000)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1190, "user_id": 7410353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92df7e8954b8a6ed2a580c9dbec0cd70?s=128&d=identicon&r=PG&f=1", "display_name": "Svekke", "link": "https://stackoverflow.com/users/7410353/svekke"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1485959519, "post_id": 41981691, "comment_id": 71142277, "body": "I changed my code, which had asked for an input, that&#39;s why it&#39;s still there. I will change it."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1485959588, "post_id": 41981691, "comment_id": 71142327, "body": "aha, makes more sense now :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7500527"}, "edited": false, "score": 0, "creation_date": 1486012772, "post_id": 41981691, "comment_id": 71166213, "body": "Thanks Svekke for your VBA script and your input!"}], "tags": [], "owner": {"reputation": 1190, "user_id": 7410353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92df7e8954b8a6ed2a580c9dbec0cd70?s=128&d=identicon&r=PG&f=1", "display_name": "Svekke", "link": "https://stackoverflow.com/users/7410353/svekke"}, "is_accepted": false, "score": 1, "last_activity_date": 1485959553, "last_edit_date": 1485959553, "creation_date": 1485957770, "answer_id": 41981691, "question_id": 41980933, "link": "https://stackoverflow.com/questions/41980933/copy-cells-containing-specific-word-to-cell-on-another-sheet/41981691#41981691", "title": "Copy cells containing specific word to cell on another sheet", "body": "<p>You can also do this with vba but it's more complicated that way:</p>\n\n<pre><code>Dim FindString As String\nFindString = \"Host Name: \"\nDim Rng As Range\n\n    With Sheets(1).Range(\"A:A\")\n        Set Rng = .Find(What:=FindString, _\n                        After:=.Cells(.Cells.Count), _\n                        LookIn:=xlValues, _\n                        LookAt:=xlPart, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlNext, _\n                        MatchCase:=False)\n        If Not Rng Is Nothing Then\n            Sheets(2).Range(\"A\" &amp; Rng.row).Value = Replace(Rng.Text, \"Host Name:\", \"\")\n    End With\nEnd If\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7500527"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "accepted_answer_id": 41981355, "answer_count": 2, "score": -1, "last_activity_date": 1485959553, "creation_date": 1485955454, "last_edit_date": 1485956008, "question_id": 41980933, "link": "https://stackoverflow.com/questions/41980933/copy-cells-containing-specific-word-to-cell-on-another-sheet", "title": "Copy cells containing specific word to cell on another sheet", "body": "<p>I have the following data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/3ougL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3ougL.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have two sheets.</p>\n\n<pre><code>1 = RESULTS\n2 = DASHBOARD\n</code></pre>\n\n<p>I am looking for a formula that searches sheet <strong>RESULTS</strong> column <strong>A:A</strong> (whole column) for the word <strong>\"Host name\"</strong>, and then copies the \"Host name\" to sheet <strong>DASHBOARD</strong> cell <strong>A1</strong>.</p>\n\n<p>IF POSSIBLE: (Using above image as example) I would appreciate it if the formula could search for \"Host name\" and then before copying it to cell <strong>A1</strong>, remove the word \"<strong>Host Name:</strong>\" (with colon). So the result copied will only be <strong>USER-PC</strong>.</p>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 1, "creation_date": 1485954826, "post_id": 41980668, "comment_id": 71138978, "body": "You could always consult Google or use the recorder to get started.  Then as you come across specific questions, you can post your code and the issue here to get help."}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1485954864, "post_id": 41980668, "comment_id": 71138999, "body": "You need to open the file, then copy the table and close it.  You can start by using the macro recorder.  I would focus on the getting of the information first, then you can worry about values from a gropdown later."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1485955188, "post_id": 41980668, "comment_id": 71139221, "body": "maybe Parameterized Microsoft Query <a href=\"https://www.youtube.com/watch?v=P9cUYpXIKsU\" rel=\"nofollow noreferrer\">youtube.com/watch?v=P9cUYpXIKsU</a>, or Power Query"}, {"owner": {"reputation": 35, "user_id": 4896238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e78e29b75594688d05682428591c4ad0?s=128&d=identicon&r=PG&f=1", "display_name": "eshy", "link": "https://stackoverflow.com/users/4896238/eshy"}, "reply_to_user": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1485955962, "post_id": 41980668, "comment_id": 71139742, "body": "@Rdster Sorry, I should have posted what I have now. Basically I have this: <code>Workbooks.Open Filename:= _         &quot;file.xlsx&quot; _         , Notify:=False     Windows(&quot;file.xlsx&quot;).Activate     Range(&quot;A16:G171&quot;).Select     Selection.Copy     Windows(&quot;newfile.xlsm&quot;).Activate     Sheets(&quot;Total&quot;).Select     Range(&quot;A1&quot;).Select     Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _         :=False, Transpose:=False&#39;&#180;</code>"}, {"owner": {"reputation": 35, "user_id": 4896238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e78e29b75594688d05682428591c4ad0?s=128&d=identicon&r=PG&f=1", "display_name": "eshy", "link": "https://stackoverflow.com/users/4896238/eshy"}, "edited": false, "score": 0, "creation_date": 1485956242, "post_id": 41980668, "comment_id": 71139952, "body": "However, I need a way to select a filter in the pivottable and then its values instead of just selecting a Range."}, {"owner": {"reputation": 35, "user_id": 4896238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e78e29b75594688d05682428591c4ad0?s=128&d=identicon&r=PG&f=1", "display_name": "eshy", "link": "https://stackoverflow.com/users/4896238/eshy"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1485975080, "post_id": 41980668, "comment_id": 71152395, "body": "@Slai I tried that one, thank you! the only problem is that I doesn&#39;t work if the source data is in the form of a pivot-table."}], "owner": {"reputation": 35, "user_id": 4896238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e78e29b75594688d05682428591c4ad0?s=128&d=identicon&r=PG&f=1", "display_name": "eshy", "link": "https://stackoverflow.com/users/4896238/eshy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 281, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1486093136, "creation_date": 1485954644, "last_edit_date": 1485975648, "question_id": 41980668, "link": "https://stackoverflow.com/questions/41980668/read-from-pivot-table-in-another-excel-file", "title": "Read from pivot-table in another excel file", "body": "<p>I am developing an excel-file for storing and analyzing data for my job. For this, I need to use VBA to perform certain calculations etc.</p>\n\n<p>To the problem: The data that I want to read into my excel files is stored in other excel-files updated monthly by another unit at my work. These files are presented as pivot-tables on monthly data with certain filters available. </p>\n\n<p>Basically, in my excel-file, I have a dropdown-list where the user chooses a region (filter option in the other excel-files containing the data) and then presses a button \"Update\". Then, the VBA-program should read into my file from the other excel-files filtering the pivot-tables according to the region the user choose in my file, and fetch the data to my file and later perform some calculations on it.</p>\n\n<p>So, I would be really thankful if someone could explain to me how I could go about this. I guess that the value the user chooses in my file should pass as some kind of argument into the VBA-program? How do I read from other closed excel-files?</p>\n\n<p>I hope that my explanation is clear enough to understand what I am looking for.</p>\n\n<p>Many thanks in advance!</p>\n\n<p>Edit:\nSo I have started with a VBA-program that looks as follows:</p>\n\n<pre><code>strLan = Range(\"K2\").Value 'The value I want to set for the filter option\n\nWorkbooks.Open Filename:= _\n    \"source-file.xlsx\" _\n    , Notify:=False\nWindows(\"sourcefile.xlsx\").Activate\nSheets(\"Blad1\").PivotTables(\"PivotTable1\").PivotFields(\"filtervariable\").CurrentPage = strLan\nActiveSheet.PivotTables(\"PivotTable1\").DataBodyRange.Select\nSelection.Copy\nWindows(\"newfile.xlsm\").Activate\nSheets(\"Totalt\").Select\nRange(\"A1\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nWorkbooks.Close\n</code></pre>\n\n<p>However, I get the following error message:\n\"unable to get the pivottables property of the worksheet class\"</p>\n\n<p>I hope that clears up my problem!</p>\n\n<p>Best</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1485952505, "post_id": 41979635, "comment_id": 71137446, "body": "FWIW, that&#39;s quite inefficient, as you are looking up the same value 10 times. Better to use MATCH in one column to get the right row and then use that directly in 10 INDEX formulas."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1485956741, "post_id": 41979635, "comment_id": 71140328, "body": "whats&#39; your real goal?"}], "answers": [{"tags": [], "owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "is_accepted": true, "score": 0, "last_activity_date": 1485951719, "last_edit_date": 1485951719, "creation_date": 1485951651, "answer_id": 41979693, "question_id": 41979635, "link": "https://stackoverflow.com/questions/41979635/is-there-a-way-to-make-the-look-up-column-dynamic-in-excel-vba/41979693#41979693", "title": "Is there a way to make the look up column dynamic in excel VBA?", "body": "<p>Just use string manipulation as below:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=VLOOKUP(THIS VALUE,'IN THIS TABLE RANGE,\" &amp; i &amp; \",FALSE)\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1485951848, "creation_date": 1485951848, "answer_id": 41979752, "question_id": 41979635, "link": "https://stackoverflow.com/questions/41979635/is-there-a-way-to-make-the-look-up-column-dynamic-in-excel-vba/41979752#41979752", "title": "Is there a way to make the look up column dynamic in excel VBA?", "body": "<p>Only use <code>FormulaR1C1</code> if you use <code>R1C1</code> references, otherwise use <code>Formula</code></p>\n\n<p>This will put the formula in the 10 first on the 1st row, on the sheet named <code>SheetName</code> :</p>\n\n<pre><code>With Sheets(\"SheetName\")\n    For i = 1 To 10\n        .Cells(1, i).Formula = \"=VLOOKUP(THIS VALUE,IN THIS TABLE RANGE,\" &amp; i &amp; \",FALSE)\"\n    Next i\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1485957685, "creation_date": 1485957685, "answer_id": 41981669, "question_id": 41979635, "link": "https://stackoverflow.com/questions/41979635/is-there-a-way-to-make-the-look-up-column-dynamic-in-excel-vba/41981669#41981669", "title": "Is there a way to make the look up column dynamic in excel VBA?", "body": "<p>you could be after something like this</p>\n\n<pre><code>Cells(1, 1).Resize(, 10).FormulaR1C1 = \"=VLOOKUP(\"\"THIS_VALUE\"\",R2C1:R100C10,COLUMN(),FALSE)\"\n</code></pre>\n\n<p>where you have to change:</p>\n\n<ul>\n<li><p><code>Cells(1, 1)</code> to your actual cell reference you want to start writing formula down from</p></li>\n<li><p><code>R2C1:R100C10</code> to actual \"TABLE RANGE\" address in <code>R1C1</code> style</p></li>\n<li><p><code>COLUMN()</code> to proper difference between written cells column index and \"TABLE RANGE\" ones (e.g. it could be some <code>COLUMN()-1</code>)</p></li>\n</ul>\n"}], "owner": {"reputation": 41, "user_id": 5837662, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/2bb59a2b7e91df23012ed35102a3bf9a?s=128&d=identicon&r=PG&f=1", "display_name": "Log On", "link": "https://stackoverflow.com/users/5837662/log-on"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 41979693, "answer_count": 3, "score": 1, "last_activity_date": 1485957685, "creation_date": 1485951468, "last_edit_date": 1485951707, "question_id": 41979635, "link": "https://stackoverflow.com/questions/41979635/is-there-a-way-to-make-the-look-up-column-dynamic-in-excel-vba", "title": "Is there a way to make the look up column dynamic in excel VBA?", "body": "<p>I want to do something like this:</p>\n\n<pre><code>For i = 1 To 10\n\nActiveCell.FormulaR1C1 = _\n        \"=VLOOKUP(THIS VALUE,'IN THIS TABLE RANGE,i,FALSE)\"\n\nNext i\n</code></pre>\n\n<p>I want to pass the value of i to the column value to be looked up. </p>\n"}, {"tags": ["python", "vba", "excel", "loops"], "answers": [{"comments": [{"owner": {"reputation": 14216, "user_id": 3015186, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/u85Sl.png?s=128&g=1", "display_name": "np8", "link": "https://stackoverflow.com/users/3015186/np8"}, "edited": false, "score": 0, "creation_date": 1574240357, "post_id": 41981007, "comment_id": 104157048, "body": "Related to usage of .Value2: <a href=\"https://stackoverflow.com/a/17363466/3015186\">stackoverflow.com/a/17363466/3015186</a>"}], "tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": false, "score": 4, "last_activity_date": 1485955671, "creation_date": 1485955671, "answer_id": 41981007, "question_id": 41979439, "link": "https://stackoverflow.com/questions/41979439/vba-version-of-pythons-zip-function-for-each-loop/41981007#41981007", "title": "VBA version of Python&#39;s Zip function (FOR EACH loop)", "body": "<p>There is no direct equivalent of zip in VBA.<br>\nNote1 its much more efficient to get the data into arrays and loop on the arrays rather than process cell by cell<br>\nNote2 Its very unusual to get .Text from cells because it does not get the underlying value, may give ####, and is slow : better to use .Value2</p>\n\n<p>If the ranges are contiguous it would be best to use a 2D array, otherwise 4 individual arrays</p>\n\n<pre><code>Sub testing1()\nDim var As Variant\nDim j As Long\nDim k As Long\nDim str As String\nvar = Worksheets(\"Sheet1\").Range(\"A2:D673\").Value2\n\nFor j = LBound(var) To UBound(var)\nFor k = LBound(var, 2) To UBound(var, 2)\nstr = str &amp; var(j, k) &amp; \" \"\nNext k\nDebug.Print str\nstr = \"\"\nNext j\n\nEnd Sub\n\nSub testing2()\nDim varA As Variant\nDim varB As Variant\nDim varC As Variant\nDim varD As Variant\nDim j As Long\n\nvarA = Worksheets(\"Sheet1\").Range(\"A2:A673\").Value2\nvarB = Worksheets(\"Sheet1\").Range(\"B2:B673\").Value2\nvarC = Worksheets(\"Sheet1\").Range(\"C2:C673\").Value2\nvarD = Worksheets(\"Sheet1\").Range(\"D2:D673\").Value2\n\nFor j = LBound(varA) To UBound(varA)\nDebug.Print varA(j, 1) &amp; \" \" &amp; varB(j, 1) &amp; \" \" &amp; varC(j, 1) &amp; \" \" &amp; varD(j, 1)\nNext j\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1869, "user_id": 3805500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/L2aW1.jpg?s=128&g=1", "display_name": "Karl Anka", "link": "https://stackoverflow.com/users/3805500/karl-anka"}, "is_accepted": false, "score": 0, "last_activity_date": 1485956789, "creation_date": 1485956789, "answer_id": 41981373, "question_id": 41979439, "link": "https://stackoverflow.com/questions/41979439/vba-version-of-pythons-zip-function-for-each-loop/41981373#41981373", "title": "VBA version of Python&#39;s Zip function (FOR EACH loop)", "body": "<p>If your actual code have the \"lists\" on the same sheet where the corresponding ones-twos-threes-four are on the same row this could work for you.</p>\n\n<pre><code>Dim ws As Worksheet\nSet ws = ActiveSheet\nSet rng = ws.Range(\"A2:D673\")\n\nFor Each rw In rng.Rows\n    ' where 4 is the column number of the D-column\n    ones = ws.Cells(rw.Row, 4).Value \n    twos = ws.Cells(rw.Row, 1).Value\n    threes = ws.Cells(rw.Row, 2).Value\n    fours = ws.Cells(rw.Row, 3).Value\nNext rw\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 7069864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/960edc90de488e0f80b1e85a79003ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Reginald Johnson", "link": "https://stackoverflow.com/users/7069864/reginald-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1018, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1485956789, "creation_date": 1485950888, "last_edit_date": 1485951666, "question_id": 41979439, "link": "https://stackoverflow.com/questions/41979439/vba-version-of-pythons-zip-function-for-each-loop", "title": "VBA version of Python&#39;s Zip function (FOR EACH loop)", "body": "<p>In Python, I can iterate through multiple lists at once, by using the zip function. How would I do this in a macro in VBA in Excel?</p>\n\n<p>Pseudo Code</p>\n\n<pre><code>Set ones = Worksheets(\"Insertion\").Range(\"D2:D673\")\nSet twos = Worksheets(\"Insertion\").Range(\"A2:A673\")\nSet threes = Worksheets(\"Insertion\").Range(\"B2:B673\")\nSet fours = Worksheets(\"Insertion\").Range(\"C2:C673\")\n\nFor Each one, two, three, four in zip(ones.Cells, twos.Cells, threes.Cells, fours.Cells)\n    Debug.Print(one.Text &amp; two.Text &amp; three.Text &amp; four.Text)\nNext one\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1476, "user_id": 4126959, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a2e55f7fb5bb46885ca8eb69ce1f583?s=128&d=identicon&r=PG&f=1", "display_name": "Zero", "link": "https://stackoverflow.com/users/4126959/zero"}, "edited": false, "score": 1, "creation_date": 1485951070, "post_id": 41979431, "comment_id": 71136491, "body": "Try selecting row numbers (left most column) rather than cells, then right click and delete (also on left most column) to delete full rows. Delete rows, and that deletes all data and formatting that is associated with them. Also, this question probably belongs on other stack exchange, as it is not about programming."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1485951549, "post_id": 41979431, "comment_id": 71136810, "body": "use <code>ActiveSheet.UsedRange.EntireRow.Delete</code>"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485951550, "post_id": 41979431, "comment_id": 71136813, "body": "Just delete unused Rows and Columns in each sheet (hidden too), and save the file. You should see a difference when using Ctrl+End ! ;)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1485951613, "post_id": 41979431, "comment_id": 71136851, "body": "@user3598756 : Seems a bit radical if you don&#39;t want to erase the data!!"}, {"owner": {"reputation": 1337, "user_id": 2999781, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kYD9I.gif?s=128&g=1", "display_name": "Jiminy Cricket", "link": "https://stackoverflow.com/users/2999781/jiminy-cricket"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1485951929, "post_id": 41979431, "comment_id": 71137069, "body": "@user3598756 I don&#39;t want to delete my data"}, {"owner": {"reputation": 1337, "user_id": 2999781, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kYD9I.gif?s=128&g=1", "display_name": "Jiminy Cricket", "link": "https://stackoverflow.com/users/2999781/jiminy-cricket"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485951958, "post_id": 41979431, "comment_id": 71137090, "body": "@R3uK I&#39;ve edited my question to show different attempts. Unfortunately deleting the rows doesn&#39;t work"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485952578, "post_id": 41979431, "comment_id": 71137501, "body": "@JiminyCricket : That&#39;s because you have to save the file afterwards! ;)"}], "answers": [{"comments": [{"owner": {"reputation": 1337, "user_id": 2999781, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kYD9I.gif?s=128&g=1", "display_name": "Jiminy Cricket", "link": "https://stackoverflow.com/users/2999781/jiminy-cricket"}, "edited": false, "score": 0, "creation_date": 1485952193, "post_id": 41979859, "comment_id": 71137260, "body": "Amazing. Thanks! I thought UsedRange was just a function to return the range"}, {"owner": {"reputation": 983, "user_id": 6753444, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9a4459e9cb4ab680f510b698e7002eca?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/6753444/jonathan"}, "reply_to_user": {"reputation": 1337, "user_id": 2999781, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kYD9I.gif?s=128&g=1", "display_name": "Jiminy Cricket", "link": "https://stackoverflow.com/users/2999781/jiminy-cricket"}, "edited": false, "score": 0, "creation_date": 1485952446, "post_id": 41979859, "comment_id": 71137420, "body": "No problem, I&#39;ve added the code I use to add it to the context menu each time I open Excel (I put this code into PERSONAL.XLSB)"}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 0, "creation_date": 1485961027, "post_id": 41979859, "comment_id": 71143304, "body": "Note that this method of resetting the used range often fails with large ranges and recent Excel versions."}, {"owner": {"reputation": 180, "user_id": 3701166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a475031a159ad184ac13edc5e835f1e?s=128&d=identicon&r=PG&f=1", "display_name": "RBerman", "link": "https://stackoverflow.com/users/3701166/rberman"}, "edited": false, "score": 0, "creation_date": 1616621889, "post_id": 41979859, "comment_id": 118064306, "body": "The compiler currently won&#39;t accept that &quot;x.UsedRange&quot; statement without assigning it to a variable."}], "tags": [], "owner": {"reputation": 983, "user_id": 6753444, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9a4459e9cb4ab680f510b698e7002eca?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/6753444/jonathan"}, "is_accepted": true, "score": 0, "last_activity_date": 1485952420, "last_edit_date": 1485952420, "creation_date": 1485952151, "answer_id": 41979859, "question_id": 41979431, "link": "https://stackoverflow.com/questions/41979431/permanently-deleting-unused-excel-rows/41979859#41979859", "title": "Permanently Deleting Unused Excel Rows", "body": "<p>Open VBA and type ActiveSheet.UsedRange in the immediate window. </p>\n\n<p>I added it to my right-click menu since I use it so often. </p>\n\n<p>Edit:</p>\n\n<p>Here's the code I use to add it to the context menu:</p>\n\n<pre><code>Private Sub Auto_Open()\n\nOn Error Resume Next\n'delete the control if it exists\nApplication.CommandBars.FindControl(Tag:=\"MY_TAG\").Delete\n\nOn Error GoTo 0\nWith Application.CommandBars(\"Cell\").Controls\n    'add reset range button\n    With .Add(Type:=msoControlButton)\n        .Caption = \"Reset used range\"\n        .OnAction = ThisWorkbook.Name &amp; \"!ResetRange\"\n        .Tag = \"MY_TAG\"\n        .BeginGroup = True\n    End With\nEnd With\nEnd Sub\n\nPrivate Sub ResetRange()\n\nActiveSheet.UsedRange\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1485952465, "creation_date": 1485952465, "answer_id": 41979968, "question_id": 41979431, "link": "https://stackoverflow.com/questions/41979431/permanently-deleting-unused-excel-rows/41979968#41979968", "title": "Permanently Deleting Unused Excel Rows", "body": "<p>To clear all unused rows and columns in all sheets :</p>\n\n<pre><code>Sub ReduceFileSize()\n    Dim wB As Workbook\n    Dim wS As Worksheet\n    Set wB = ThisWorkbook\n    For Each wS In wB.Sheets\n        DeleteUnUsed wS\n    Next wS\n    wB.Save\nEnd Sub\n\n\nSub DeleteUnUsed(wS As Worksheet)\n    Dim r As Range\n    Dim LastRow As Double\n    LastRow = LastRow_1(wS)\n    Dim LastCol As Double\n    LastCol = LastCol_1(wS)\n    With wS\n        .Range(LastRow + 1 &amp; \":\" &amp; .Rows.Count).EntireRow.Delete\n        .Range(collet(LastCol) &amp; \":\" &amp; collet(.Columns.Count)).EntireColumn.Delete\n    End With\nEnd Sub\n\nPublic Function LastRow_1(wS As Worksheet) As Double\n    With wS\n        If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n            LastRow_1 = .Cells.Find(What:=\"*\", _\n                                After:=.Range(\"A1\"), _\n                                Lookat:=xlPart, _\n                                LookIn:=xlFormulas, _\n                                SearchOrder:=xlByRows, _\n                                SearchDirection:=xlPrevious, _\n                                MatchCase:=False).Row\n        Else\n            LastRow_1 = 1\n        End If\n    End With\nEnd Function\n\nPublic Function LastCol_1(wS As Worksheet) As Double\n    With wS\n        If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n            LastCol_1 = .Cells.Find(What:=\"*\", _\n                                After:=.Range(\"A1\"), _\n                                Lookat:=xlPart, _\n                                LookIn:=xlFormulas, _\n                                SearchOrder:=xlByColumns, _\n                                SearchDirection:=xlPrevious, _\n                                MatchCase:=False).Column\n        Else\n            LastCol_1 = 1\n        End If\n    End With\nEnd Function\n\nPublic Function ColLet(x As Integer) As String\nWith ActiveSheet.Columns(x)\n    ColLet = Left(.Address(False, False), InStr(.Address(False, False), \":\") - 1)\nEnd With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1337, "user_id": 2999781, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kYD9I.gif?s=128&g=1", "display_name": "Jiminy Cricket", "link": "https://stackoverflow.com/users/2999781/jiminy-cricket"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1464, "favorite_count": 0, "accepted_answer_id": 41979859, "answer_count": 2, "score": 1, "last_activity_date": 1485952465, "creation_date": 1485950866, "last_edit_date": 1485951901, "question_id": 41979431, "link": "https://stackoverflow.com/questions/41979431/permanently-deleting-unused-excel-rows", "title": "Permanently Deleting Unused Excel Rows", "body": "<p>When creating a blank Excel Workbook, the file size is kept small by not using all 1,000,000+ rows. However, once data has been added to all of the rows, the rows still exist even if the data is deleted out of them, resulting in a huge filesize. I know these rows still exist because of the size of the scrollbar and the fact that if I scroll to the bottom I end up at row 1,000,000+ which does not happen on a new Workbook. I guess this would be called the UsedRange in VBA?</p>\n\n<p>I have inherited a Workbook from another developer which is in this situation and I'm looking for a way to reduce the size. I can copy the used data only into a new blank Workbook, but does anyone know of a way to reduce the actual UsedRange?</p>\n\n<p>The following code does not work:</p>\n\n<pre><code>Sub test()\nDim r As Range\n\n    Set r = Range(\"10000:1000000\")\n    r.Delete\n\nEnd Sub\n</code></pre>\n\n<p>Nor does highlighting the rows manually, clicking in the header and clicking delete</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6456012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-l3QK9KDc0wQ/AAAAAAAAAAI/AAAAAAAAPNE/lqYa-fWnGzQ/photo.jpg?sz=128", "display_name": "Kenji", "link": "https://stackoverflow.com/users/6456012/kenji"}, "edited": false, "score": 0, "creation_date": 1485964784, "post_id": 41979455, "comment_id": 71146170, "body": "Overlooked that! What a basic mistake :0 Thank You!"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1485950916, "creation_date": 1485950916, "answer_id": 41979455, "question_id": 41979279, "link": "https://stackoverflow.com/questions/41979279/delete-columns-based-on-header-value-vba/41979455#41979455", "title": "Delete columns based on header value VBA", "body": "<p>You are not qualifying your range with a sheet so only the active sheet is searched</p>\n\n<pre><code>Sub x()\n\nDim wsh As Worksheet\nDim A As Range\n\nFor Each wsh In ActiveWorkbook.Worksheets\n    Do\n        Set A = wsh.Rows(1).Find(What:=\"Title\", LookIn:=xlValues, lookat:=xlPart)\n        If A Is Nothing Then Exit Do\n        A.EntireColumn.Delete\n    Loop\nNext wsh\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 3, "creation_date": 1485951408, "post_id": 41979479, "comment_id": 71136713, "body": "actually the <code>lookat:=xlPart</code> parameter suffices to avoid the use of <code>*</code> in <code>What</code>"}, {"owner": {"reputation": 3, "user_id": 6456012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-l3QK9KDc0wQ/AAAAAAAAAAI/AAAAAAAAPNE/lqYa-fWnGzQ/photo.jpg?sz=128", "display_name": "Kenji", "link": "https://stackoverflow.com/users/6456012/kenji"}, "edited": false, "score": 0, "creation_date": 1485964932, "post_id": 41979479, "comment_id": 71146289, "body": "Thank you for the detailed explanation!"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 3, "user_id": 6456012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-l3QK9KDc0wQ/AAAAAAAAAAI/AAAAAAAAPNE/lqYa-fWnGzQ/photo.jpg?sz=128", "display_name": "Kenji", "link": "https://stackoverflow.com/users/6456012/kenji"}, "edited": false, "score": 0, "creation_date": 1485965875, "post_id": 41979479, "comment_id": 71146930, "body": "@Kenji you&#39;re welcome , mark as answer (click the <b>V</b> next to my answer)"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1485951770, "last_edit_date": 1485951770, "creation_date": 1485950976, "answer_id": 41979479, "question_id": 41979279, "link": "https://stackoverflow.com/questions/41979279/delete-columns-based-on-header-value-vba/41979479#41979479", "title": "Delete columns based on header value VBA", "body": "<p>Since you are looking for \"Title A\" (as well for only \"Title\") , you can use the <code>Find</code> in 2 ways:</p>\n\n<ul>\n<li>Add the <code>*</code> wild-card to the searched string, and at the third parameter have xlWhole <code>Find(What:=\"Title*\", LookIn:=xlValues, lookat:=xlWhole)</code></li>\n<li>Don't use the <code>*</code> wild-card, and use xlPart  <code>.Find(What:=\"Title\", LookIn:=xlValues, lookat:=xlPart)</code></li>\n</ul>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub RemoveTitle()\n\nDim wsh As Worksheet\nDim A As Range\n\nFor Each wsh In ActiveWorkbook.Worksheets\n    Do\n        Set A = wsh.Rows(1).Find(What:=\"Title\", LookIn:=xlValues, lookat:=xlPart)\n        If Not A Is Nothing Then\n            A.EntireColumn.Delete\n        End If\n\n    Loop While Not A Is Nothing\nNext wsh\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6456012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-l3QK9KDc0wQ/AAAAAAAAAAI/AAAAAAAAPNE/lqYa-fWnGzQ/photo.jpg?sz=128", "display_name": "Kenji", "link": "https://stackoverflow.com/users/6456012/kenji"}, "edited": false, "score": 0, "creation_date": 1485964841, "post_id": 41979483, "comment_id": 71146218, "body": "I see, this wildcard is very useful! Thank You!"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 3, "user_id": 6456012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-l3QK9KDc0wQ/AAAAAAAAAAI/AAAAAAAAPNE/lqYa-fWnGzQ/photo.jpg?sz=128", "display_name": "Kenji", "link": "https://stackoverflow.com/users/6456012/kenji"}, "edited": false, "score": 0, "creation_date": 1485965007, "post_id": 41979483, "comment_id": 71146348, "body": "@Kenji : Glad I could help! ;) Take a minute to take a tour and discover how SO works : <a href=\"http://stackoverflow.com/tour\">stackoverflow.com/tour</a>"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1485950987, "creation_date": 1485950987, "answer_id": 41979483, "question_id": 41979279, "link": "https://stackoverflow.com/questions/41979279/delete-columns-based-on-header-value-vba/41979483#41979483", "title": "Delete columns based on header value VBA", "body": "<p>You need to specify the sheet in which you use <code>Find</code><br>\nAnd add <code>*</code> (wildcard) to include all possibilities</p>\n\n<pre><code>Dim wsh As Worksheet\nDim A As Range\nFor Each wsh In ActiveWorkbook.Worksheets\n    Do\n        Set A = wsh.Rows(1).Find(What:=\"Title*\", LookIn:=xlValues, lookat:=xlPart)\n        If A Is Nothing Then Exit Do\n        A.EntireColumn.Delete\n    Loop\nNext wsh\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6456012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-l3QK9KDc0wQ/AAAAAAAAAAI/AAAAAAAAPNE/lqYa-fWnGzQ/photo.jpg?sz=128", "display_name": "Kenji", "link": "https://stackoverflow.com/users/6456012/kenji"}, "edited": false, "score": 0, "creation_date": 1485965171, "post_id": 41979742, "comment_id": 71146458, "body": "This gave me a error of &quot;Delete method of Range class failed&quot; at the 4th line from the last..."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 3, "user_id": 6456012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-l3QK9KDc0wQ/AAAAAAAAAAI/AAAAAAAAPNE/lqYa-fWnGzQ/photo.jpg?sz=128", "display_name": "Kenji", "link": "https://stackoverflow.com/users/6456012/kenji"}, "edited": false, "score": 0, "creation_date": 1485967204, "post_id": 41979742, "comment_id": 71147789, "body": "In my tests it worked! What&#39;s the data &quot;face&quot; that gave you that error?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1485951814, "creation_date": 1485951814, "answer_id": 41979742, "question_id": 41979279, "link": "https://stackoverflow.com/questions/41979279/delete-columns-based-on-header-value-vba/41979742#41979742", "title": "Delete columns based on header value VBA", "body": "<p>you may want to delete all columns in one shot</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim wsh As Worksheet\n    Dim A As Range, foundTitle As Range\n    Dim firstAddress As String\n\n    For Each wsh In ActiveWorkbook.Worksheets\n        With wsh.Range(\"A1\", wsh.Cells(1, wsh.Cells.Columns.Count).End(xlToLeft))\n            Set foundTitle = .Offset(1).Resize(1, 1)\n            Set A = .Find(What:=\"Title\", LookIn:=xlValues, lookat:=xlPart)\n            If Not A Is Nothing Then\n                firstAddress = A.Address\n                Do\n                    Set foundTitle = Union(foundTitle, A)\n                    Set A = .FindNext(A)\n                Loop While A.Address &lt;&gt; firstAddress\n            End If\n            Set foundTitle = Intersect(foundTitle, .Cells)\n            If Not foundTitle Is Nothing Then foundTitle.EntireColumn.Delete\n        End With\n    Next wsh\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6456012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-l3QK9KDc0wQ/AAAAAAAAAAI/AAAAAAAAPNE/lqYa-fWnGzQ/photo.jpg?sz=128", "display_name": "Kenji", "link": "https://stackoverflow.com/users/6456012/kenji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3622, "favorite_count": 0, "accepted_answer_id": 41979479, "answer_count": 4, "score": 0, "last_activity_date": 1509106048, "creation_date": 1485950397, "last_edit_date": 1485952287, "question_id": 41979279, "link": "https://stackoverflow.com/questions/41979279/delete-columns-based-on-header-value-vba", "title": "Delete columns based on header value VBA", "body": "<p>I am trying to delete columns that contain the text \"Title\" from all the Worksheets. (It could be Title A, Title B, etc.) \nI wrote the below, but it's not working... Please enlighten me.</p>\n\n<pre><code>Dim wsh As Worksheet\nDim A As Range\n\nFor Each wsh In ActiveWorkbook.Worksheets\n    Do\n        Set A = Rows(1).Find(What:=\"Title\", LookIn:=xlValues, lookat:=xlPart)\n        If A Is Nothing Then Exit Do\n        A.EntireColumn.Delete\n    Loop\nNext wsh\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1485950224, "post_id": 41978875, "comment_id": 71135920, "body": "Probably just <code>Set OCRz = New Tesseract</code> and then <code>OCRz.Something(&quot;C:\\\\Users\\\\aftab\\\\Downloads\\\\ocr\\\\ocr\\\\tesse&zwnj;&#8203;ract\\\\tessdata&quot;, &quot;eng&quot;, OcrEngineMode.OcrEngineMode_TesseractOnly)</code>, i don&#39;t know the command you should use to replace <code>Something</code>, I didn&#39;t saw the doc for VBA on Tesseract..."}, {"owner": {"reputation": 1717, "user_id": 2428355, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ddeda2635eeab20d6634e3783dfe9524?s=128&d=identicon&r=PG", "display_name": "Aftab Ahmed", "link": "https://stackoverflow.com/users/2428355/aftab-ahmed"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485950529, "post_id": 41978875, "comment_id": 71136138, "body": "I have this method OCRz.Init(&quot;C:\\\\Users\\\\aftab\\\\Downloads\\\\ocr\\\\ocr\\\\tesseract\\&zwnj;&#8203;\\tessdata&quot;, &quot;eng&quot;, OcrEngineMode.OcrEngineMode_TesseractOnly) which accepts three parameters but now compile error is changed asking for = sign"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1485950690, "post_id": 41978875, "comment_id": 71136232, "body": "I don&#39;t have the doc like I said, but this method probably return something and if not, just get rid of the parenthesis and add a space between <code>init</code> and the parameters"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485950778, "post_id": 41978875, "comment_id": 71136289, "body": "@GSerg : You know  everything!^^ Or do you happened to find the doc in the Tesseract wiki?"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1485951024, "creation_date": 1485951024, "answer_id": 41979493, "question_id": 41978875, "link": "https://stackoverflow.com/questions/41978875/vba-compile-error-expected-end-of-statement-while-creating-com-object/41979493#41979493", "title": "VBA Compile error: Expected end of statement While creating Com Object", "body": "<p>Try with:</p>\n\n<pre><code>OCRz.Init \"C:\\\\Users\\\\aftab\\\\Downloads\\\\ocr\\\\ocr\\\\tesseract\\\\tessdata\", \"eng\", OcrEngineMode.OcrEngineMode_TesseractOnly\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>Dim Result As Variant\nResult = OCRz.Init(\"C:\\\\Users\\\\aftab\\\\Downloads\\\\ocr\\\\ocr\\\\tesseract\\\\tessdata\", \"eng\", OcrEngineMode.OcrEngineMode_TesseractOnly)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 960, "user_id": 5151278, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ilDIXFcHqdo/AAAAAAAAAAI/AAAAAAAADnQ/j3pEZAQLJ28/photo.jpg?sz=128", "display_name": "Maxime Port&#233;", "link": "https://stackoverflow.com/users/5151278/maxime-port%c3%a9"}, "is_accepted": false, "score": 0, "last_activity_date": 1485956839, "creation_date": 1485956839, "answer_id": 41981386, "question_id": 41978875, "link": "https://stackoverflow.com/questions/41978875/vba-compile-error-expected-end-of-statement-while-creating-com-object/41981386#41981386", "title": "VBA Compile error: Expected end of statement While creating Com Object", "body": "<p>You just need to add a <code>Call</code></p>\n\n<pre><code>Call OCRz.Init(\"C:\\\\Users\\\\aftab\\\\Downloads\\\\ocr\\\\ocr\\\\tesseract\\\\tessdata\", \"eng\", OcrEngineMode.OcrEngineMode_TesseractOnly)\n</code></pre>\n\n<p>And your error should be gone</p>\n\n<p>It's explained in the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251710.aspx\" rel=\"nofollow noreferrer\">MSDN Call Documentation</a> </p>\n"}, {"tags": [], "owner": {"reputation": 1717, "user_id": 2428355, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ddeda2635eeab20d6634e3783dfe9524?s=128&d=identicon&r=PG", "display_name": "Aftab Ahmed", "link": "https://stackoverflow.com/users/2428355/aftab-ahmed"}, "is_accepted": false, "score": 0, "last_activity_date": 1486010866, "creation_date": 1486010866, "answer_id": 41994371, "question_id": 41978875, "link": "https://stackoverflow.com/questions/41978875/vba-compile-error-expected-end-of-statement-while-creating-com-object/41994371#41994371", "title": "VBA Compile error: Expected end of statement While creating Com Object", "body": "<p>I found the solution myself after trying for several hours, unfortunately I have had to learn the hard way.</p>\n\n<p>First i need to generate a COM by setting C# project properties i.e. </p>\n\n<ol>\n<li>Application => Assembly Information => need to check Make assembly COM-Visible</li>\n<li>Build => under Output => Need to check Register for Comp Interop</li>\n</ol>\n\n<p>Secondly i do need to register my dll generated for Tesseract by following this</p>\n\n<blockquote>\n  <p>C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\regasm.exe C:\\Windows\\SysWOW64\\Emgu.CV.OCR.dll /codebase /tlb:C:\\Windows\\SysWOW64\\Emgu.CV.OCR.tlb</p>\n</blockquote>\n\n<p>Now in the excel i need to instantiate the tesseract object as following</p>\n\n<pre><code>Private Sub cmd_run_Click()\n   'process ocr on table\n    Dim OCRz As New Tesseract(\"C:\\\\Users\\\\aftab\\\\Downloads\\\\ocr\\\\ocr\\\\tesseract\\\\tessdata\", \"eng\", OcrEngineMode.OcrEngineMode_TesseractOnly)\n\n    MsgBox \"processing\"\n\n   'display results\n    Me.Requery\nEnd Sub\n</code></pre>\n\n<p>I don't know but the trick was to declare and instantiate the Tesseract object at same point.</p>\n"}], "owner": {"reputation": 1717, "user_id": 2428355, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ddeda2635eeab20d6634e3783dfe9524?s=128&d=identicon&r=PG", "display_name": "Aftab Ahmed", "link": "https://stackoverflow.com/users/2428355/aftab-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 419, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1486010866, "creation_date": 1485949203, "last_edit_date": 1485950731, "question_id": 41978875, "link": "https://stackoverflow.com/questions/41978875/vba-compile-error-expected-end-of-statement-while-creating-com-object", "title": "VBA Compile error: Expected end of statement While creating Com Object", "body": "<p>I am trying to create an object of a class but vba is throwing syntax error</p>\n\n<pre><code>Private Sub cmd_run_Click()\n 'process ocr on table\n  Dim OCRz As Tesseract\n\n  Set OCRz = New Tesseract\n\n  OCRz.Init(\"C:\\\\Users\\\\aftab\\\\Downloads\\\\ocr\\\\ocr\\\\tesseract\\\\tessdata\", \"eng\", OcrEngineMode.OcrEngineMode_TesseractOnly)\n\n  MsgBox \"processing\"\n\n 'display results\n  Me.Requery\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/GMdOH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GMdOH.png\" alt=\"Eror being shown on red \"></a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 7430783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14b68fdb945cc88001fc207ffb442c9b?s=128&d=identicon&r=PG&f=1", "display_name": "kira123", "link": "https://stackoverflow.com/users/7430783/kira123"}, "edited": false, "score": 0, "creation_date": 1485953061, "post_id": 41978961, "comment_id": 71137780, "body": "Thanks a lot for your quick response, it makes sense, I will give it ago and let you know. Still not sure how I can copy past specific cells? would the following work: `  wb1.Sheet(&quot;summary&quot;).Range(&quot;B2&quot;).Value = wb2.ActiveSheet.Range(&quot;B97&quot;)  wb1.Sheet(&quot;summary&quot;).Range(&quot;C2&quot;).Value = wb2.ActiveSheet.Range(&quot;B117&quot;)  `      and just keep repeating that for all the cells I want to copy paste?"}, {"owner": {"reputation": 75, "user_id": 7430783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14b68fdb945cc88001fc207ffb442c9b?s=128&d=identicon&r=PG&f=1", "display_name": "kira123", "link": "https://stackoverflow.com/users/7430783/kira123"}, "edited": false, "score": 0, "creation_date": 1485954148, "post_id": 41978961, "comment_id": 71138462, "body": "I&#39;ve put the new version of the code under <b>EDIT 1</b>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 75, "user_id": 7430783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14b68fdb945cc88001fc207ffb442c9b?s=128&d=identicon&r=PG&f=1", "display_name": "kira123", "link": "https://stackoverflow.com/users/7430783/kira123"}, "edited": false, "score": 0, "creation_date": 1485954517, "post_id": 41978961, "comment_id": 71138725, "body": "I&#39;ve updated the code above so let me know how you get on."}, {"owner": {"reputation": 75, "user_id": 7430783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14b68fdb945cc88001fc207ffb442c9b?s=128&d=identicon&r=PG&f=1", "display_name": "kira123", "link": "https://stackoverflow.com/users/7430783/kira123"}, "edited": false, "score": 0, "creation_date": 1485955665, "post_id": 41978961, "comment_id": 71139534, "body": "I tried it, but I&#39;m still getting the same error for the same line. I double checked the names match, so I don&#39;t think that&#39;s the issue."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 75, "user_id": 7430783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14b68fdb945cc88001fc207ffb442c9b?s=128&d=identicon&r=PG&f=1", "display_name": "kira123", "link": "https://stackoverflow.com/users/7430783/kira123"}, "edited": false, "score": 0, "creation_date": 1485959651, "post_id": 41978961, "comment_id": 71142367, "body": "Ah, replace <code>sheet</code> with <code>sheets</code>. Or better use your <code>sht</code> variable."}, {"owner": {"reputation": 75, "user_id": 7430783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14b68fdb945cc88001fc207ffb442c9b?s=128&d=identicon&r=PG&f=1", "display_name": "kira123", "link": "https://stackoverflow.com/users/7430783/kira123"}, "edited": false, "score": 0, "creation_date": 1485960774, "post_id": 41978961, "comment_id": 71143113, "body": "Oh I see. Also it was copying in reverse, so I switched it around to ws.Range(&quot;B97&quot;).Value = wb1.Sheets(&quot;Summary&quot;).Range(&quot;B5&quot;).Value, and now its working perfectly. Thanks a lot for your help"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1485954474, "last_edit_date": 1485954474, "creation_date": 1485949410, "answer_id": 41978961, "question_id": 41978818, "link": "https://stackoverflow.com/questions/41978818/copy-specific-cells-based-on-a-criteria-to-sheets-with-same-label-as-the-criter/41978961#41978961", "title": "Copy specific cells based on a criteria, to sheets with same label as the criteria in another workbook", "body": "<p>Have updated and added a sheet variable (ws) which points to the relevant sheet for copying (it does not need to be selected or active).</p>\n\n<pre><code>    Sub Summary()\n\n    Dim wb1 As Workbook\n    Dim Sht As Worksheet\n    Dim Rng, Rng2 As Range\n    Dim wb2 As Workbook\n    Dim cell As Range\n    Dim ws as Worksheet\n\n    Set wb1 = ThisWorkbook\n    Set wb2 = Workbooks(\"Measure Templates.xlsx\")\n    Set Sht = wb1.Worksheets(\"Summary\")\n    Set Rng = Sht.Range(\"A5:A\" &amp; Sht.Cells(Sht.Rows.Count, \"A\").End(xlUp).Row)\n\n    For Each cell In Rng\n       Set ws=wb2.Sheets(cell.Text)\n       Select Case ws.Range(\"A4\").Value\n            Case \"Standard Bathroom Template\"\n            wb1.Sheet(\"Summary\").Range(\"B5\").Value = ws.Range(\"B97\").Value\n            wb1.Sheet(\"Summary\").Range(\"C5\").Value = ws.Range(\"B117\").Value\n                Case \"Standard Kitchen Template\"\n                wb1.Sheet(\"Summary\").Range(\"B6\").Value = ws.Range(\"B97\").Value\n                wb1.Sheet(\"Summary\").Range(\"C6\").Value = ws.Range(\"B117\").Value\n                Case \"Standard Bathroom and Kitchen T\"\n                wb1.Sheet(\"Summary\").Range(\"B7\").Value = ws.Range(\"B97\").value\n                wb1.Sheet(\"Summary\").Range(\"C7\").Value = ws.Range(\"B117\").Value\n            End Select\n        Next cell\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 7430783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14b68fdb945cc88001fc207ffb442c9b?s=128&d=identicon&r=PG&f=1", "display_name": "kira123", "link": "https://stackoverflow.com/users/7430783/kira123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 41978961, "answer_count": 1, "score": 0, "last_activity_date": 1485954474, "creation_date": 1485949012, "last_edit_date": 1485954104, "question_id": 41978818, "link": "https://stackoverflow.com/questions/41978818/copy-specific-cells-based-on-a-criteria-to-sheets-with-same-label-as-the-criter", "title": "Copy specific cells based on a criteria, to sheets with same label as the criteria in another workbook", "body": "<p>I am trying to write a code for the following task, but I have been struggling a quite a bit.\nI have 2 workbooks, wb1 and wb2. \nwb1 has a table with a list of names in column A, then column B-V has the data I want to copy to the sheet with the same name as in column A but in a different book (wb2). The location its pasted to is also dependent on another criteria on the destination sheet in wb2. </p>\n\n<p>so for example in wb1 \"John\" is the name in A1, switch to wb2, go to the sheet called John, check the criteria on cell A4 of this sheet:\nThere are 3 criteria which are: Teen, adult or Elder</p>\n\n<p>If Teen, then copy B1 into B97, copy C1 into B135, copy D1 into B147 &amp; B190, copy E4 into B1100</p>\n\n<p>If Adult, then  copy J1 into B97, copy F1 into B135, copy G1 into B147 &amp; B190, copy H4 into B1100</p>\n\n<p>If Elder, then copy B1 into B97, copy C1 into B135, copy D1 into B147 &amp; B190, copy E4 into B1100, copy J1 into B113, copy F1 into B1910, copy G1 into B1473 &amp; B1930, copy H4 into B1190</p>\n\n<p>(The above is just an example, there is a more cells to copy paste than listed above)</p>\n\n<p>This should be looped for all names in column A of wb1.</p>\n\n<p>Below is what macro record gave me, but it doesn't record the criterias. Both workbooks will be open btw.</p>\n\n<pre><code>    Sub Summary()\n\n    Dim wb1 As Workbook\n    Dim Sht As Worksheet\n    Dim Rng, Rng2 As Range\n\n    Set wb1= ThisWorkbook\n    Set Sht = MasterBook.Worksheets(\"Sheet\")\n    Set Rng = Sht.Range(\"A2:A\" &amp; Sht.Cells(Sht.Rows.Count, \"A\").End(xlUp).Row)\n    Dim wb2 As Workbook\n    Dim cell As Range\n    For Each cell In Rng '&lt;---Here is where my first problem is, \n'not sure how to get the excel to switch to the sheet \n'with the same name as in column A then check cell A4 for the criteria'\n\n    If cell.Value = \"Teen\" Then\n    Range(\"C12\").Select\n        Selection.Copy\n        Windows(\"wb2.xlsx\").Activate\n        ActiveWindow.SmallScroll Down:=81\n        Range(\"B97\").Select\n        ActiveSheet.Paste\n        ActiveWindow.SmallScroll Down:=-9\n        Windows(\"wb1.xlsx\").Activate\n        Range(\"D12\").Select\n        Application.CutCopyMode = False\n        Selection.Copy\n        Windows(\"wb2.xlsx\").Activate\n        ActiveWindow.SmallScroll Down:=12\n        Range(\"B95\").Select\n        ActiveSheet.Paste\n        Windows(\"wb1.xlsx\").Activate\n        Range(\"E12\").Select\n        Application.CutCopyMode = False\n        Selection.Copy\n        Windows(\"wb2.xlsx\").Activate\n        ActiveWindow.SmallScroll Down:=-45\n        Range(\"B47\").Select\n        ActiveSheet.Paste\n        ActiveWindow.SmallScroll Down:=63\n        Range(\"B118\").Select\n        ActiveSheet.Paste\n        Windows(\"wb1.xlsx\").Activate\n        Range(\"F12\").Select\n        Application.CutCopyMode = False\n        Selection.Copy\n        Windows(\"wb2.xlsx\").Activate\n        ActiveWindow.SmallScroll Down:=48\n        Range(\"B163\").Select\n        ActiveSheet.Paste\n        Windows(\"wb1.xlsx\").Activate\n        Range(\"G12\").Select\n        Application.CutCopyMode = False\n        Selection.Copy\n        Windows(\"wb2.xlsx\").Activate\n        ActiveWindow.SmallScroll Down:=-66\n        Range(\"B93\").Select\n        ActiveSheet.Paste\n        Windows(\"wb1.xlsx\").Activate\n        Range(\"H12\").Select\n        Application.CutCopyMode = False\n        Selection.Copy\n        Windows(\"wb2.xlsx\").Activate\n        ActiveWindow.SmallScroll Down:=9\n        Range(\"B105\").Select\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n            :=False, Transpose:=False\n        ActiveWindow.SmallScroll Down:=60\n        Range(\"B167\").Select\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n            :=False, Transpose:=False\n        Windows(\"wb1.xlsx\").Activate\n        Range(\"I12\").Select\n        Application.CutCopyMode = False\n        Selection.Copy\n        Windows(\"wb2.xlsx\").Activate\n        ActiveWindow.SmallScroll Down:=-27\n        Range(\"B141\").Select\n        ActiveSheet.Paste\n        Windows(\"wb1.xlsx\").Activate\n        Range(\"J12\").Select\n        Application.CutCopyMode = False\n        Selection.Copy\n        Windows(\"wb2.xlsx\").Activate\n        Range(\"B145\").Select\n        ActiveSheet.Paste\n        ActiveWindow.SmallScroll Down:=138\n        Windows(\"wb1.xlsx\").Activate\n        Windows(\"wb2.xlsx\").Activate\n        ActiveWindow.SmallScroll Down:=51\n        Range(\"B326\").Select\n        ActiveSheet.Paste\n        ActiveWindow.SmallScroll Down:=12\n        Range(\"B339\").Select\n        Application.CutCopyMode = False\n        ActiveCell.FormulaR1C1 = \"1\"\n        Range(\"B317\").Select\n        ActiveCell.FormulaR1C1 = \"1\"\n        Range(\"B312\").Select\n        ActiveCell.FormulaR1C1 = \"1\"\n        Windows(\"wb1.xlsx\").Activate\n        Range(\"K12\").Select\n        Selection.Copy\n        Windows(\"wb2.xlsx\").Activate\n        Range(\"B107\").Select\n        ActiveSheet.Paste\n        ActiveWindow.SmallScroll Down:=-63\n        Range(\"B49\").Select\n        ActiveSheet.Paste\n        ActiveWindow.SmallScroll Down:=-9\n        Windows(\"wb1.xlsx\").Activate\n        Windows(\"wb2.xlsx\").Activate\n        ActiveWindow.SmallScroll Down:=306\n        Windows(\"wb1.xlsx\").Activate\n\n    else If cell.Value = \"Adult\" Then\n    '&lt;-----same stuff as above for different cells copy pasted'\n    else If cell.Value = \"Elder\" Then\n    '&lt;-----same stuff as above for different cells copy pasted'\n end if\n    End Sub\n</code></pre>\n\n<p>Also I don't know if the case function would be useful instead of the If statement here either.</p>\n\n<p>Thanks a lot in advance</p>\n\n<p><strong>EDIT 1</strong></p>\n\n<p>I changed the code as suggested below</p>\n\n<pre><code>Sub Summary()\n\n    Dim wb1 As Workbook\n    Dim Sht As Worksheet\n    Dim Rng, Rng2 As Range\n    Dim wb2 As Workbook\n    Dim cell As Range\n\n    Set wb1 = ThisWorkbook\n    Set wb2 = Workbooks(\"Measure Templates.xlsx\")\n    Set Sht = wb1.Worksheets(\"Summary\")\n    Set Rng = Sht.Range(\"A5:A\" &amp; Sht.Cells(Sht.Rows.Count, \"A\").End(xlUp).Row)\n\n    For Each cell In Rng\n        Select Case wb2.Sheets(cell.Text).Range(\"A4\").Value\n            Case \"Standard Bathroom Template\"\n            wb1.Sheet(\"Summary\").Range(\"B5\").Value = wb2.ActiveSheet.Range(\"B97\") '&lt;--- I'm getting an error here saying \"Object doesn't support this property or method\" \n'I assume that this is not the right way to copy paste.\n'I looked around but everything online uses a specific sheet name for destination\n'which is not the case for me, it should be sheet with same name as in column A \n                wb1.Sheet(\"Summary\").Range(\"C5\").Value = wb2.ActiveSheet.Range(\"B117\")\n                Case \"Standard Kitchen Template\"\n                wb1.Sheet(\"Summary\").Range(\"B6\").Value = wb2.ActiveSheet.Range(\"B97\")\n                wb1.Sheet(\"Summary\").Range(\"C6\").Value = wb2.ActiveSheet.Range(\"B117\")\n                Case \"Standard Bathroom and Kitchen T\"\n                wb1.Sheet(\"Summary\").Range(\"B7\").Value = wb2.ActiveSheet.Range(\"B97\")\n                wb1.Sheet(\"Summary\").Range(\"C7\").Value = wb2.ActiveSheet.Range(\"B117\")\n            End Select\n        Next cell\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 0, "creation_date": 1485958624, "post_id": 41978499, "comment_id": 71141650, "body": "The third formula divides by A1 - just out of curiosity, can you say what that was for because it isn&#39;t mentioned anywhere else?"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 6995291, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b05aa63a7923bd26acfbf514c75941df?s=128&d=identicon&r=PG&f=1", "display_name": "Emna", "link": "https://stackoverflow.com/users/6995291/emna"}, "edited": false, "score": 0, "creation_date": 1485961849, "post_id": 41979292, "comment_id": 71143890, "body": "i have this error the formula you typed contains an error"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1485950443, "creation_date": 1485950443, "answer_id": 41979292, "question_id": 41978499, "link": "https://stackoverflow.com/questions/41978499/count-number-of-visible-rows-with-criteria/41979292#41979292", "title": "Count number of visible rows with criteria", "body": "<p>I don't get exactly your needs but you may want to use</p>\n\n<pre><code>=SUMIFS(F14:F150,F14:F150,\"&gt;0\",A14:A150,\"&gt;0\")\n</code></pre>\n\n<p>or</p>\n\n<pre><code>=COUNTIFS(F14:F150,\"&gt;0\",A14:A150,\"&gt;0\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24193, "user_id": 5811078, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NlknE.png?s=128&g=1", "display_name": "zipa", "link": "https://stackoverflow.com/users/5811078/zipa"}, "is_accepted": true, "score": 2, "last_activity_date": 1485950741, "creation_date": 1485950741, "answer_id": 41979391, "question_id": 41978499, "link": "https://stackoverflow.com/questions/41978499/count-number-of-visible-rows-with-criteria/41979391#41979391", "title": "Count number of visible rows with criteria", "body": "<p>You can add another column with formula:</p>\n\n<pre><code>=IF(SUBTOTAL(103;F14))\n</code></pre>\n\n<p>Because you are using filters this formula will help you determine if your cell is hidden or not.\nNow you can use, assuming that latter formula is in column <code>G</code>:</p>\n\n<pre><code>=COUNTIFS(F14:F150;\"&gt;0\";G14:G150;\"&gt;0\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 0, "creation_date": 1485955461, "post_id": 41980221, "comment_id": 71139400, "body": "It&#39;s really neat but I don&#39;t get what the /A1 is for?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 0, "creation_date": 1485956666, "post_id": 41980221, "comment_id": 71140264, "body": "It was in the original formula."}, {"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 0, "creation_date": 1485957881, "post_id": 41980221, "comment_id": 71141115, "body": "Yes...but OP didn&#39;t define what was in A1. Oh well."}, {"owner": {"reputation": 63, "user_id": 6995291, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b05aa63a7923bd26acfbf514c75941df?s=128&d=identicon&r=PG&f=1", "display_name": "Emna", "link": "https://stackoverflow.com/users/6995291/emna"}, "edited": false, "score": 0, "creation_date": 1485961783, "post_id": 41980221, "comment_id": 71143843, "body": "A1 =&gt; =(SUBTOTAL(3;A14:A1048576)) but i have this error the formula you typed contains an error"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1485962454, "post_id": 41980221, "comment_id": 71144344, "body": "If you use semicolons, replace all the commas in mine with semicolons."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 1, "last_activity_date": 1485953186, "creation_date": 1485953186, "answer_id": 41980221, "question_id": 41978499, "link": "https://stackoverflow.com/questions/41978499/count-number-of-visible-rows-with-criteria/41980221#41980221", "title": "Count number of visible rows with criteria", "body": "<p>Array-entered using Ctrl+Shift+Enter:</p>\n\n<pre><code>=SUMPRODUCT(--(F14:F150&gt;0),IF(SUBTOTAL(3,OFFSET(F14:F150,ROW(F14:F150)-MIN(ROW(F14:F150)),,1)),F14:F150,\"\"))/A1\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 6995291, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b05aa63a7923bd26acfbf514c75941df?s=128&d=identicon&r=PG&f=1", "display_name": "Emna", "link": "https://stackoverflow.com/users/6995291/emna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 591, "favorite_count": 0, "accepted_answer_id": 41979391, "answer_count": 3, "score": 2, "last_activity_date": 1589570453, "creation_date": 1485947997, "last_edit_date": 1485948138, "question_id": 41978499, "link": "https://stackoverflow.com/questions/41978499/count-number-of-visible-rows-with-criteria", "title": "Count number of visible rows with criteria", "body": "<p>In the beginning I used this formula <code>SUBTOTAL(3;(A14:A150&gt;0))</code> and it works perfectly  but now I need to add a condition that I must count the number of rows where the value in the column F is greater than 0. </p>\n\n<p>This formula <code>COUNTIF(F14:F150;\"&gt;0\")</code> return the right result, but when I filter  I don\u2019t have the right one.</p>\n\n<p>I tried also <code>SUMPRODUCT(SUBTOTAL(3;F14:F150)/A1*(F14:F150&gt;0))</code> it return the same thing as the COUNTIF.</p>\n"}, {"tags": ["vba", "excel", "text-to-column"], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485948214, "post_id": 41978404, "comment_id": 71134634, "body": "<code>For j = 1 To 2</code> and <code>Next i</code> ? this is most likely from another answer :)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485948291, "post_id": 41978404, "comment_id": 71134678, "body": "@ShaiRado : My bad, it was a copy/paste from the 1st proposition! I corrected it, thx for pointing it out! ;)"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485948385, "post_id": 41978404, "comment_id": 71134732, "body": "Just another question, why do you need the <code>For</code> loop ? where so you use it ?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485948514, "post_id": 41978404, "comment_id": 71134793, "body": "@ShaiRado : It&#39;s just to repeat the <code>.TextToColumns</code> twice, I thought it was the easiest/more readable way to put. If you have a better way, I&#39;m all eyes! :)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1485948313, "last_edit_date": 1485948313, "creation_date": 1485947734, "answer_id": 41978404, "question_id": 41978133, "link": "https://stackoverflow.com/questions/41978133/text-to-column-for-loop/41978404#41978404", "title": "Text to column for loop", "body": "<p>At least 2 options :</p>\n\n<pre><code>Sub Texscolumn()\nDim j As Integer\nWith Sheets(\"sheet1\")\n    For j = 35 To 36\n        .Range(.Cells(2, j), .Cells(96, j)).TextToColumns Destination:=.Cells(2, j), _\n                            DataType:=xlDelimited, _\n                            TextQualifier:=xlDoubleQuote, _\n                            ConsecutiveDelimiter:=True, _\n                            Tab:=True, _\n                            Semicolon:=False, _\n                            Comma:=False, _\n                            Space:=True, _\n                            Other:=False, _\n                            FieldInfo:=Array(Array(1, 1), Array(2, 9), Array(3, 9), Array(4, 9), Array(5, 9), Array(6, 9), Array(7, 9), Array(8, 9)), _\n                            TrailingMinusNumbers:=True\n    Next i\nEnd With\nEnd Sub\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Sub Texscolumn()\nDim Rg As Range\nDim i As Integer\nSet Rg = Sheets(\"sheet1\").Range(\"AI2:AI96\")\nWith Rg\n    For i = 1 To 2\n        .TextToColumns Destination:=.Cells(1, 1), _\n                            DataType:=xlDelimited, _\n                            TextQualifier:=xlDoubleQuote, _\n                            ConsecutiveDelimiter:=True, _\n                            Tab:=True, _\n                            Semicolon:=False, _\n                            Comma:=False, _\n                            Space:=True, _\n                            Other:=False, _\n                            FieldInfo:=Array(Array(1, 1), Array(2, 9), Array(3, 9), Array(4, 9), Array(5, 9), Array(6, 9), Array(7, 9), Array(8, 9)), _\n                            TrailingMinusNumbers:=True\n        Set Rg = .Offset(0, 1)\n    Next i\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 7464127, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10154510957598702/picture?type=large", "display_name": "Isra Shaikh", "link": "https://stackoverflow.com/users/7464127/isra-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 41978404, "answer_count": 1, "score": 1, "last_activity_date": 1485948347, "creation_date": 1485946992, "last_edit_date": 1485948347, "question_id": 41978133, "link": "https://stackoverflow.com/questions/41978133/text-to-column-for-loop", "title": "Text to column for loop", "body": "<p>So basically I have multiple columns of text that I want to change to numbers.\nNow the issue i face is ive got the code but i dont understand how to run a loop on it to choose the next third column.\nThis is my code:</p>\n\n<pre><code>Sub Texscolumn()\n\nRange(\"AI2:AI96\").Select\nSelection.TextToColumns Destination:=Range(\"AI2\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=True, Tab:=True, _\n    Semicolon:=False, Comma:=False, Space:=True, Other:=False, FieldInfo _\n    :=Array(Array(1, 1), Array(2, 9), Array(3, 9), Array(4, 9), Array(5, 9), Array(6, 9), Array(7, 9), Array(8, 9)), TrailingMinusNumbers:= _\n    True\n End Sub\n</code></pre>\n\n<p>So the next column I want is suppose AJ2:AJ96.\nI cant seem to figure out how to make a for loop with changing columns like this.</p>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "edited": false, "score": 0, "creation_date": 1485947992, "post_id": 41978381, "comment_id": 71134491, "body": "Thank you for the reply. I changed my SQL as per the post but getting Syntax error still"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1485950873, "last_edit_date": 1485950873, "creation_date": 1485947679, "answer_id": 41978381, "question_id": 41978013, "link": "https://stackoverflow.com/questions/41978013/getting-the-selected-year-from-textbox/41978381#41978381", "title": "Getting the selected year from textbox", "body": "<p>If the user selects a <em>year</em>, it should just read:</p>\n\n<pre><code>WHERE Year([Mail Date])=[text48].[value]\n</code></pre>\n\n<p>or rather:</p>\n\n<pre><code>WHERE Year([Mail Date])=[text48]\n</code></pre>\n\n<p>or perhaps:</p>\n\n<pre><code>WHERE Year([Mail Date])=[Forms]![frm_Central_Reporting_Ops]![text48]\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 41978381, "answer_count": 1, "score": 0, "last_activity_date": 1485950873, "creation_date": 1485946713, "last_edit_date": 1485946802, "question_id": 41978013, "link": "https://stackoverflow.com/questions/41978013/getting-the-selected-year-from-textbox", "title": "Getting the selected year from textbox", "body": "<p>I am trying to get my SQL to pick up a year selected in text48 - So if they select year 2016 the SQL will only show accounts in the year 2016.</p>\n\n<p>Below is my SQL:</p>\n\n<pre><code>SELECT tbl_ComplaintsCoded.[Mail Date], \n       tbl_ComplaintsCoded.[Account Number], \n       tbl_ComplaintsCoded.Advisors\nFROM tbl_ComplaintsCoded\nWHERE Year([Mail Date])=Year([text48].[value]) AND \n      Advisors=[forms]![frm_Central_Reporting_Ops]![Text52]);\n</code></pre>\n\n<p>I cant work out where I am going wrong.</p>\n"}, {"tags": ["vba", "runtime-error"], "comments": [{"owner": {"reputation": 25756, "user_id": 925913, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/69de717f8f47bc852b7e452d890ef166?s=128&d=identicon&r=PG&f=1", "display_name": "slackwing", "link": "https://stackoverflow.com/users/925913/slackwing"}, "edited": false, "score": 0, "creation_date": 1485959107, "post_id": 41978008, "comment_id": 71141984, "body": "Is the problem that you&#39;re concatenating a string and an integer?"}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1485960318, "post_id": 41978008, "comment_id": 71142796, "body": "Runtime error 13 means <a href=\"https://msdn.microsoft.com/en-us/library/aa264979(v=vs.60).aspx\" rel=\"nofollow noreferrer\">Type Mismatch</a>. So you are operating on the wrong type of objects. For example, why are you multiplying a control by 35? You multiply numbers, not controls."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1485984924, "post_id": 41978008, "comment_id": 71157659, "body": "Apparently the contents of <code>Input_Wager</code> cannot be implicitly parsed as a number."}], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1485984706, "post_id": 41986390, "comment_id": 71157561, "body": "The OP is using VBA, and that is not a good way to restrict a field to numbers anyway (and it does not handle pasted values). If the OP was using VB.NET, a better approach would be <code>Integer.TryParse</code>."}], "tags": [], "owner": {"reputation": 422, "user_id": 1752419, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Jng3i.jpg?s=128&g=1", "display_name": "AlwaysConfused", "link": "https://stackoverflow.com/users/1752419/alwaysconfused"}, "is_accepted": false, "score": -1, "last_activity_date": 1485971468, "creation_date": 1485971468, "answer_id": 41986390, "question_id": 41978008, "link": "https://stackoverflow.com/questions/41978008/how-to-debug-a-run-time-error-13-in-vba/41986390#41986390", "title": "How to debug a Run-Time Error 13 in VBA?", "body": "<p>As @Andrew and @Raymond said, you are getting a type mismatch error because you are trying to multiply a control/object with an Integer.</p>\n\n<p>First check to see if the value of Input_Wager is an Integer and not a string - do this by not letting it accept anything else than an integer -</p>\n\n<pre><code>Private Sub Input_Wager_KeyPress(sender As Object, e As KeyPressEventArgs) Handles   Input_Wager.KeyPress\n\n    If Not Char.IsNumber(e.KeyChar) AndAlso Not Char.IsControl(e.KeyChar)   Then\n        e.KeyChar = \"\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Now that you know it has an integer value, change your multiplication lines to this -</p>\n\n<pre><code>TextBox2.Text = \"$\" &amp; (Me.Input_Wager.Text * 35)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7499915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/905a2badd2efea316c9274f035931846?s=128&d=identicon&r=PG&f=1", "display_name": "Dareel Dill", "link": "https://stackoverflow.com/users/7499915/dareel-dill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 799, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1485984871, "creation_date": 1485946704, "last_edit_date": 1485984871, "question_id": 41978008, "link": "https://stackoverflow.com/questions/41978008/how-to-debug-a-run-time-error-13-in-vba", "title": "How to debug a Run-Time Error 13 in VBA?", "body": "<p>Here's my entire code below. I keep getting a Run-Time Error 13, any help would be appreciated.</p>\n\n<pre><code>Private Sub Button_Clear_Click()\n    Input_Wager.Text = \"0\"\nEnd Sub\n</code></pre>\n\n<p>The section below, I would like when the command button is pressed that if the Textbox <code>Input_Wager</code> is empty, it displays a message, otherwise it starts the computations in the <code>elseif</code> section</p>\n\n<pre><code>Private Sub Button_Submit_Click()\n    If Me.Input_Wager.Text = \"\" Then\n        MsgBox (\"Display\")\n    ElseIf Me.Input_Wager.Text &lt;&gt; \"\" Then\n        TextBox2.Text = \"$\" &amp; (Me.Input_Wager * 35)\n        TextBox3.Text = \"$\" &amp; (Me.Input_Wager * 17)\n        TextBox4.Text = \"$\" &amp; (Me.Input_Wager * 8)\n        TextBox5.Text = \"$\" &amp; (Me.Input_Wager * 11)\n        TextBox6.Text = \"$\" &amp; (Me.Input_Wager * 6)\n        TextBox7.Text = \"$\" &amp; (Me.Input_Wager * 5)\n        TextBox8.Text = \"$\" &amp; (Me.Input_Wager * 11)\n        TextBox9.Text = \"$\" &amp; (Me.Input_Wager * 17)\n        TextBox10.Text = \"$\" &amp; (Me.Input_Wager * 2)\n        TextBox11.Text = \"$\" &amp; (Me.Input_Wager * 2)\n        TextBox12.Text = \"$\" &amp; (Me.Input_Wager * 1)\n        TextBox13.Text = \"$\" &amp; (Me.Input_Wager * 1)\n        TextBox14.Text = \"$\" &amp; (Me.Input_Wager * 1)\n        TextBox15.Text = \"$\" &amp; (Me.Input_Wager * 1)\n        TextBox16.Text = \"$\" &amp; (Me.Input_Wager * 1)\n        TextBox17.Text = \"$\" &amp; (Me.Input_Wager * 1)\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "indexing", "match"], "answers": [{"comments": [{"owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "edited": false, "score": 0, "creation_date": 1485947014, "post_id": 41977865, "comment_id": 71133883, "body": "thanks for the suggestion, however this only seems to work for the first cell and then causes all the other cells down the column to display #VALUE errors"}, {"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "reply_to_user": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "edited": false, "score": 0, "creation_date": 1485949020, "post_id": 41977865, "comment_id": 71135116, "body": "It works fine in testing on my end, however one flaw with the logic of the existing function is it expects the lookup column to be the first column of the source data. I&#39;ve edited the answer to split out the lookup and return column parameters. This amended function works perfectly on the data structure you have given. (<a href=\"http://i.imgur.com/TmTea9d.png\" rel=\"nofollow noreferrer\">i.imgur.com/TmTea9d.png</a>)"}, {"owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "edited": false, "score": 0, "creation_date": 1485949493, "post_id": 41977865, "comment_id": 71135427, "body": "well i don&#39;t know what i&#39;m doing different but it simply won&#39;t work for me. It keeps saying #Value. i&#39;ve restarted excel, i&#39;ve checked the cells are calculating. If it works for you i&#39;m not sure why it won&#39;t work for me. Are you using excel 2013, as that&#39;s what i&#39;m using if that makes a difference."}, {"owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "edited": false, "score": 0, "creation_date": 1485949529, "post_id": 41977865, "comment_id": 71135443, "body": "does it matter that i have column E in between Column D and F on my data sheet?"}, {"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "reply_to_user": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "edited": false, "score": 0, "creation_date": 1485949775, "post_id": 41977865, "comment_id": 71135617, "body": "Having column E between would be fine. Am I to assume your formula looks like this? (An example row range of course) =SingleCellExtract(B2,Data!$D$1:$F$500,3,1,&quot;,&quot;)"}, {"owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "edited": false, "score": 0, "creation_date": 1485949846, "post_id": 41977865, "comment_id": 71135668, "body": "no i was using the original formula =SingleCellExtract(B14,Data!F:F,-1,&quot;,&quot;). How come i need to change the formula? Should this matter?"}, {"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "reply_to_user": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "edited": false, "score": 0, "creation_date": 1485950059, "post_id": 41977865, "comment_id": 71135806, "body": "That would explain the issue, you&#39;d be using a single column (index 1) as the source data and then asking it to return column (1-0) = 0 (doesn&#39;t exist). Use the new formula and the new function."}, {"owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "edited": false, "score": 0, "creation_date": 1485950850, "post_id": 41977865, "comment_id": 71136353, "body": "just seems to be blank now. See edited question. I have more columns in my range on data sheet"}], "tags": [], "owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "is_accepted": true, "score": 3, "last_activity_date": 1485948895, "last_edit_date": 1485948895, "creation_date": 1485946304, "answer_id": 41977865, "question_id": 41977423, "link": "https://stackoverflow.com/questions/41977423/excel-lookup-all-matching-values-and-place-in-comma-separated-list/41977865#41977865", "title": "Excel: Lookup All Matching Values and place in comma separated list?", "body": "<p>An immediate improvement would be to put the data into an array rather than referencing the cells for each check:</p>\n\n<pre><code>Function SingleCellExtract(LookupValue As String, LookupRange As Range, LookupCol As Long, ReturnCol As Long, Char As String)\n'Updateby20150824\n    Dim varTMP As Variant, I As Long\n    varTMP = LookupRange\n    Dim xRet As String\n    For I = 1 To UBound(varTMP, 1)\n        If varTMP(I, LookupCol) = LookupValue Then\n            If xRet = \"\" Then\n                xRet = varTMP(I, ReturnCol)\n            Else\n                xRet = xRet &amp; Char &amp; varTMP(I, ReturnCol)\n            End If\n        End If\n    Next\n    SingleCellExtract = xRet\nEnd Function\n</code></pre>\n\n<p>I also amended your return line and xRet logic to avoid the need for left/len.</p>\n"}, {"tags": [], "owner": {"reputation": 24193, "user_id": 5811078, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NlknE.png?s=128&g=1", "display_name": "zipa", "link": "https://stackoverflow.com/users/5811078/zipa"}, "is_accepted": false, "score": 0, "last_activity_date": 1485952398, "creation_date": 1485952398, "answer_id": 41979941, "question_id": 41977423, "link": "https://stackoverflow.com/questions/41977423/excel-lookup-all-matching-values-and-place-in-comma-separated-list/41979941#41979941", "title": "Excel: Lookup All Matching Values and place in comma separated list?", "body": "<p>I hope my solution is interesting to you, here it goes:\nIf you are sort your data by two columns you are using, it would look something like this:</p>\n\n<pre><code>SupplierID  Text\n1           Foo\n1           Bar\n1           FooBar\n2           Foo\n2           Bar\n2           FooBar\n</code></pre>\n\n<p>Now just add this formula into <code>Result</code> column:</p>\n\n<pre><code>=IF(A2&lt;&gt;A1,B2,CONCATENATE(C1,\", \",B2))\n</code></pre>\n\n<p>This will create output like this one:</p>\n\n<pre><code>SupplierID  Text    Result\n1           Foo     Foo\n1           Bar     Foo, Bar\n1           FooBar  Foo, Bar, FooBar\n2           Foo     Foo\n2           Bar     Foo, Bar\n2           FooBar  Foo, Bar, FooBar\n</code></pre>\n\n<p>Finally you can apply copy the same text in all columns.\nI hope this helps!</p>\n"}], "owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1867, "favorite_count": 0, "accepted_answer_id": 41977865, "answer_count": 2, "score": 3, "last_activity_date": 1513339256, "creation_date": 1485945072, "last_edit_date": 1513339256, "question_id": 41977423, "link": "https://stackoverflow.com/questions/41977423/excel-lookup-all-matching-values-and-place-in-comma-separated-list", "title": "Excel: Lookup All Matching Values and place in comma separated list?", "body": "<p>I have a Data sheet like so:</p>\n\n<pre><code>Col A    Col B    Col C    Column D   Col E   Column F     Col G    Col H      Col  I    Col J     Col K    \n                           1234               Supplier 1\n                           2222               Supplier 2\n                           3333               Supplier 2\n                           4444               Supplier 1\n</code></pre>\n\n<p>I also have another sheet</p>\n\n<pre><code>Home sheet:\n\nColumn B\nSupplier 1   &lt;-- Values Produced From Index Match Formula\nSupplier 2\n</code></pre>\n\n<p>I want to list all of the item numbers from column D, Data sheet, where the supplier name on Home sheet matches.</p>\n\n<p>However, i want to place all of the matching item numbers in one cell, in a comma separated list like so:</p>\n\n<pre><code>Home sheet:    \n\nColumn B         Column C\nSupplier 1       1234, 4444\nSupplier 2       2222, 3333\n</code></pre>\n\n<p>At the moment i am doing this using a user defined function in vba:</p>\n\n<pre><code>Function SingleCellExtract(LookupValue As String, LookupRange As Range, ColumnNumber As Integer, Char As String)\n'Updateby20150824\n    Dim I As Long\n    Dim xRet As String\n    For I = 1 To LookupRange.Columns(1).Cells.Count\n        If LookupRange.Cells(I, 1) = LookupValue Then\n            If xRet = \"\" Then\n                xRet = LookupRange.Cells(I, ColumnNumber) &amp; Char\n            Else\n                xRet = xRet &amp; \"\" &amp; LookupRange.Cells(I, ColumnNumber) &amp; Char\n            End If\n        End If\n    Next\n    SingleCellExtract = Left(xRet, Len(xRet) - 1)\nEnd Function\n</code></pre>\n\n<p>And then using the following formula to get the result:</p>\n\n<pre><code>=SingleCellExtract(B14,Data!F:F,-1,\",\")\n</code></pre>\n\n<p>This works, however, I have more than 500 lines of data and this method takes about 10 minutes or more to calculate - and sometimes causes the sheet to crash.</p>\n\n<p>Please can someone show me a better way of doing this?</p>\n"}, {"tags": ["java", "excel", "groovy", "vba"], "comments": [{"owner": {"reputation": 21, "user_id": 6619281, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/17c462b017741f922235225229679617?s=128&d=identicon&r=PG&f=1", "display_name": "user6619281", "link": "https://stackoverflow.com/users/6619281/user6619281"}, "edited": false, "score": 0, "creation_date": 1485945175, "post_id": 41977391, "comment_id": 71132587, "body": "Or is there any way to copy contents of HTML page to Excel sheet..."}, {"owner": {"reputation": 42880, "user_id": 982161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/kutcC.png?s=128&g=1", "display_name": "\u03a6Xoc\u0119 \uc6c3 \u041fepe&#250;pa \u30c4", "link": "https://stackoverflow.com/users/982161/%ce%a6xoc%c4%99-%ec%9b%83-%d0%9fepe%c3%bapa-%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1485945394, "post_id": 41977391, "comment_id": 71132765, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/7789780/how-to-call-an-excel-vba-macro-from-java-code\">How to call an Excel VBA Macro from Java Code?</a>"}, {"owner": {"reputation": 21, "user_id": 6619281, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/17c462b017741f922235225229679617?s=128&d=identicon&r=PG&f=1", "display_name": "user6619281", "link": "https://stackoverflow.com/users/6619281/user6619281"}, "reply_to_user": {"reputation": 42880, "user_id": 982161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/kutcC.png?s=128&g=1", "display_name": "\u03a6Xoc\u0119 \uc6c3 \u041fepe&#250;pa \u30c4", "link": "https://stackoverflow.com/users/982161/%ce%a6xoc%c4%99-%ec%9b%83-%d0%9fepe%c3%bapa-%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1486013239, "post_id": 41977391, "comment_id": 71166378, "body": "Hi,  thank you for the suggestion. I tried the option mentioned in the above post. It works fine with excel macro which doesn&#39;t have any arguments to be passed to its function. In my case, I need to pass 2 arguments [SourceFilePath and DestFilePath] from Java code to the excel macro. Please help me on this. The objective of this macro is to copy the contents of html file to an excel file. Else if there is anyother way to acheive the above item please let me know. Thanks."}, {"owner": {"reputation": 21, "user_id": 6619281, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/17c462b017741f922235225229679617?s=128&d=identicon&r=PG&f=1", "display_name": "user6619281", "link": "https://stackoverflow.com/users/6619281/user6619281"}, "reply_to_user": {"reputation": 42880, "user_id": 982161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/kutcC.png?s=128&g=1", "display_name": "\u03a6Xoc\u0119 \uc6c3 \u041fepe&#250;pa \u30c4", "link": "https://stackoverflow.com/users/982161/%ce%a6xoc%c4%99-%ec%9b%83-%d0%9fepe%c3%bapa-%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1486362270, "post_id": 41977391, "comment_id": 71295017, "body": "hey guys, please help me on this..."}], "owner": {"reputation": 21, "user_id": 6619281, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/17c462b017741f922235225229679617?s=128&d=identicon&r=PG&f=1", "display_name": "user6619281", "link": "https://stackoverflow.com/users/6619281/user6619281"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 774, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1505126395, "creation_date": 1485944968, "last_edit_date": 1531164843, "question_id": 41977391, "link": "https://stackoverflow.com/questions/41977391/how-to-trigger-excel-macro-with-arguments-from-java", "title": "How to trigger excel macro [with arguments] from Java", "body": "<p>I need to trigger an excel macro from Java. The function contains arguments to be passed from the Java code like: </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>Sub Convertfile(String SourceFilePath, String DestFilePath)\r\n{\r\nopen html file(SourceFilePath\\ABC.html)\r\nsave file as (DestFilePath\\XYZ.csv)\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><strong><em>SourceFilePath</em></strong> and <strong><em>DestFilePath</em></strong> are derived in the Java code.\nSo how should I call this function from Java. Please help me on this.</p>\n\n<p><em>Note: I am using groovy via Jenkins to execute the Java script.</em></p>\n\n<p>I tried the option mentioned in other post <a href=\"https://stackoverflow.com/questions/7789780/how-to-call-an-excel-vba-macro-from-java-code\">How to call an Excel VBA Macro from Java Code?</a>. It works fine with excel macro which doesn't have any arguments to be passed to its function. In my case, I need to pass 2 arguments [SourceFilePath and DestFilePath] from Java code to the excel macro. Please help me on this. The objective of this macro is to copy the contents of html file to an excel file. Else if there is anyother way to acheive the above item please let me know.</p>\n"}, {"tags": ["vba", "excel", "user-defined-functions"], "comments": [{"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1485945507, "post_id": 41977340, "comment_id": 71132850, "body": "Are you aware of the built-in Evaluate function? That should be involved in your thinking... <code>Application.Evaluate(inputFormula)</code>, I would think, once you remove the &#39;=&#39;, then most things might be solved."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1485945597, "post_id": 41977340, "comment_id": 71132911, "body": "You don&#39;t even need to remove the &#39;= sign."}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1485945773, "post_id": 41977340, "comment_id": 71133047, "body": "didn&#39;t even know that Rory :-). Op, this question will be easily solved if you just use Evaluate..."}], "answers": [{"comments": [{"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1485952137, "post_id": 41977712, "comment_id": 71137220, "body": "I know this won&#39;t work for some functions, like <code>EVAL(&quot;HYPERLINK(&quot;&quot;https:&#47;&#47;www.google.com&quot;&quot;)&quot;)</code> doesn&#39;t give you a link, but at least it doesn&#39;t throw an error! I can see there&#39;s some tweaking to be done for those functions which VBA has its own versions of, but thanks for the starting point!"}], "tags": [], "owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "is_accepted": true, "score": 2, "last_activity_date": 1485945833, "creation_date": 1485945833, "answer_id": 41977712, "question_id": 41977340, "link": "https://stackoverflow.com/questions/41977340/udf-to-evaluate-a-text-string-which-represents-a-formula/41977712#41977712", "title": "UDF to evaluate a text string which represents a formula", "body": "<p>Try this UDF, and see how it works. May need small tweaking, but this is the core of what you need.</p>\n\n<pre><code>Public Function eval(ByVal str As String) As Variant\n  eval = Application.Evaluate(str)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 799, "favorite_count": 1, "accepted_answer_id": 41977712, "answer_count": 1, "score": 2, "last_activity_date": 1485945833, "creation_date": 1485944856, "question_id": 41977340, "link": "https://stackoverflow.com/questions/41977340/udf-to-evaluate-a-text-string-which-represents-a-formula", "title": "UDF to evaluate a text string which represents a formula", "body": "<p>This seems like a very simple problem, but  I simply lack the knowledge to answer, and can't find an answer when googling.</p>\n\n<p>As far as I understand, when you type a formula in a cell in Excel, like <code>=SUM(B1:B3)</code>, you are entering a text string. Pressing the <kbd>Enter</kbd> key evaluates this text string by letting Excel know it's a formula.</p>\n\n<p>In my case I do not type the text string, it is generated in a cell as follows:</p>\n\n<ul>\n<li><code>A1</code> contains <code>'=SUM(x:y)</code> <em>(note the <strong>'</strong>, i.e. as text)</em></li>\n<li><code>A2</code> contains <code>=SUBSTITUTE(SUBSTITUTE(A1,\"x\",\"B1\"),\"y\",\"B3\")</code>\n\n<ul>\n<li>That returns in <code>A2</code>, <code>=SUM(B1:B3)</code> <em>as a text string</em></li>\n</ul></li>\n</ul>\n\n<p>I would like a UDF like '<code>EVALUATE()</code>' in <code>A3</code> which has the same effect as typing the function in <code>A3</code> and pressing <kbd>Enter</kbd> or <kbd>\u21b5</kbd> key.</p>\n\n<ul>\n<li><code>A3</code> contains <code>=EVALUATE(A2)</code> which is the same as <code>=EVALUATE(\"=SUM(B1:B3)\")</code>\n\n<ul>\n<li><em>(perhaps no <code>=</code> sign within the SUM)</em></li>\n</ul></li>\n<li><code>A3</code> then returns the output of the formula that was stored as text, exactly the same as if you had typed <code>=SUM(B1:B3)</code> into it directly</li>\n</ul>\n\n<hr>\n\n<p>I realise at this stage it's customary to give example/ attempted code. Unfortunately my lack of knowledge is in the area which is fundamental to solving the problem, so I fear my code has little to offer. I post it anyway, or at least a skeleton:</p>\n\n<pre><code>Sub EVALUATE_Test() 'a temporary macro to run the EVALUATE function with an input text of \"B1^2\"\nDebug.Print EVALUATE(\"B1^2\")\nEnd Sub\n\nFunction EVALUATE(InputFormula As String) 'defining the UDF and Input - I'm not sure how to dimension evaluate though, as it could output text or a number\n\n'here is where the code goes to evaluate the InputFormula\n\nEVALUATE = InputFormula &amp; \"hi\" 'Obviously the real UDF won't need '&amp; \"hi\" but I put it in to test the debugging!\nEnd Function\n</code></pre>\n\n<p>I hope that's enough to go on, any advice would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 960, "user_id": 5151278, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ilDIXFcHqdo/AAAAAAAAAAI/AAAAAAAADnQ/j3pEZAQLJ28/photo.jpg?sz=128", "display_name": "Maxime Port&#233;", "link": "https://stackoverflow.com/users/5151278/maxime-port%c3%a9"}, "edited": false, "score": 0, "creation_date": 1485944673, "post_id": 41977066, "comment_id": 71132236, "body": "Could you add an example? What is rngPhrase and rngTextBlocks? is is the global value of <code>arr = rngTextBlocks</code> that does not works?"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1485944838, "post_id": 41977066, "comment_id": 71132352, "body": "What do you do with <code>rngTextBlocks</code> and can you show in the code where you load the value back into <code>SelectionReplacer</code>"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1485945030, "post_id": 41977066, "comment_id": 71132483, "body": "added comments as requested... see update. thanks."}, {"owner": {"reputation": 960, "user_id": 5151278, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ilDIXFcHqdo/AAAAAAAAAAI/AAAAAAAADnQ/j3pEZAQLJ28/photo.jpg?sz=128", "display_name": "Maxime Port&#233;", "link": "https://stackoverflow.com/users/5151278/maxime-port%c3%a9"}, "edited": false, "score": 0, "creation_date": 1485945592, "post_id": 41977066, "comment_id": 71132906, "body": "Did you take a look, step by step, of what happen in your <code>For</code> loop? If your code don&#39;t go Inside of it or if your <code>If</code> condition is never valid, your return value will be &quot;&quot; (default string value)"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1485948743, "post_id": 41977066, "comment_id": 71134944, "body": "It goes through the loop fine. The problem is that there is nothing to process in the loop as the variables are zero strings. To be clear. The values from the ranges do not get tranfered to the variables in the code!"}], "answers": [{"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 1, "last_activity_date": 1485945681, "creation_date": 1485945681, "answer_id": 41977648, "question_id": 41977066, "link": "https://stackoverflow.com/questions/41977066/values-from-range-not-passed-to-array-in-a-udf/41977648#41977648", "title": "Values from Range not passed to array in a UDF", "body": "<p>I think slight change will cause it to behave the way you want:</p>\n\n<pre><code>Public Function SelectionReplacer(rngPhrase As Range, rngTextBlocks As Range) As String\n\nDim arr\nDim strTextBlocks As String\nDim strPhrase As String\nDim i As Integer, j As Integer\n\n'set initial phrase (must be a single cell)\nstrPhrase = rngPhrase.Text\n\n'Set text block array\narr = rngTextBlocks\nFor i = LBound(arr, 1) To UBound(arr, 1)\n    If InStr(1, strPhrase, arr(i, 1)) &gt; 0 Then\n        strPhrase = Replace(strPhrase, arr(i, 1), arr(i, 2)) ' alter strPhrase for each iteration\n    End If\nNext i\nSelectionReplacer = strPhrase ' load strPhrase back to SelectionReplacer\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1485949135, "post_id": 41977792, "comment_id": 71135181, "body": "Thanks. This worked. Oddly the code is called twice! On the first time it is passed through the variables remain empty. The second time they actually do work as expected. Any idea why this is?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1486368159, "post_id": 41977792, "comment_id": 71297411, "body": "@rohrl77 : Honestly, I don&#39;t see why... Does it happen every time? Did you activate the iterative calculation mode? I can&#39;t think of anything else because the code is pretty straight forward!"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 2, "last_activity_date": 1485946083, "creation_date": 1485946083, "answer_id": 41977792, "question_id": 41977066, "link": "https://stackoverflow.com/questions/41977066/values-from-range-not-passed-to-array-in-a-udf/41977792#41977792", "title": "Values from Range not passed to array in a UDF", "body": "<p>You were replacing only one of the text, so only the last row of the range.</p>\n\n<p>You need to change <code>strPhrase</code>, with <code>Replace</code> and then assign it to <code>SelectionReplacer</code>.<br>BTW, no need to test before the <code>Replace</code> as it'll only occur if the text is found! ;)</p>\n\n<p>I also added a check to exit properly the function if <code>rngPhrase</code> is more than a single cell :</p>\n\n<pre><code>Public Function SelectionReplacer(rngPhrase As Range, rngTextBlocks As Range) As String\n'(must be a single cell)\nIf rngPhrase.Cells.Count &gt; 1 Then\n    SelectionReplacer = vbNullString\n    Exit Function\nEnd If\n\nDim arr\nDim strTextBlocks As String\nDim strPhrase As String\nDim i As Integer, j As Integer\n\n'set initial phrase\nstrPhrase = rngPhrase.Value\n\n'Set text block array\narr = rngTextBlocks.Value\n\nFor i = LBound(arr, 1) To UBound(arr, 1)\n    strPhrase = Replace(strPhrase, arr(i, 1), arr(i, 2))\nNext i\nSelectionReplacer = strPhrase\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 41977792, "answer_count": 2, "score": 1, "last_activity_date": 1485946083, "creation_date": 1485944014, "last_edit_date": 1485945705, "question_id": 41977066, "link": "https://stackoverflow.com/questions/41977066/values-from-range-not-passed-to-array-in-a-udf", "title": "Values from Range not passed to array in a UDF", "body": "<p>The following function I wrote returns \"\" whenever I attempt to use it on ranges that contain formulas. Oddly, when I test what values are returned for <code>rngPhrase</code> and <code>rngTextBlocks</code> in the immediate window, it returns a correct result.</p>\n\n<p>I can get a correct result for the first range by appending <code>.Text</code> (instead of using the default <code>.value</code> or even <code>.value2</code>) for the first range, but this doesn't work for the Array.</p>\n\n<p>What is happening here and how can I solve it?</p>\n\n<pre><code>    Public Function SelectionReplacer(rngPhrase As Range, rngTextBlocks As Range) As String\n\n    Dim arr\n    Dim strTextBlocks As String\n    Dim strPhrase As String\n    Dim i As Integer, j As Integer\n\n    'set initial phrase (must be a single cell)\n    strPhrase = rngPhrase.Text\n\n    'Set text block array\n    arr = rngTextBlocks\n\n\nFor i = LBound(arr, 1) To UBound(arr, 1)\n    If InStr(1, strPhrase, arr(i, 1)) &gt; 0 Then\n        SelectionReplacer = Replace(strPhrase, arr(i, 1), arr(i, 2))\n    End If\nNext i\n\n    End Function\n</code></pre>\n\n<p>UPDATE\nExamples of Input</p>\n\n<p><code>rngPhrase = Range(\"D34\")</code>  with the value in this cell being calculated by a vlookup function that returns a string <code>\"[Anrede] [FullName] verf\u00fcgt \u00fcber ein \u00e4u\u00dferst [Art1] und [Art2] Fachwissen, das [Gender1] stets effektiv und erfolgreich [K\u00f6nnen1]\u00a0konnte. [K\u00f6nnen2]\"</code></p>\n\n<p><code>rngTextBlocks</code> has similar functions all of which have similar text elements returned by their respective vlookup functions.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 7424162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccaae17fe0ca795c49fb25683e354697?s=128&d=identicon&r=PG", "display_name": "Eran", "link": "https://stackoverflow.com/users/7424162/eran"}, "edited": false, "score": 0, "creation_date": 1486018354, "post_id": 41976405, "comment_id": 71168434, "body": "Thanks again, Shai! I didnt really understand how to use this formula. I keep getting a return value of 1 (im guessing of B2). Is there a way to have it applyed to any merged cells block that I point to with my mouse?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 37, "user_id": 7424162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccaae17fe0ca795c49fb25683e354697?s=128&d=identicon&r=PG", "display_name": "Eran", "link": "https://stackoverflow.com/users/7424162/eran"}, "edited": false, "score": 0, "creation_date": 1486019315, "post_id": 41976405, "comment_id": 71168877, "body": "@Eran you want to use <code>ActiveCell</code> ? the cell you select with your mouse ? if that&#39;s the case use <code>ExtraCharge = MergeSize(ActiveCell)</code> , see edited code (and remove the previous one in your code)"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 37, "user_id": 7424162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccaae17fe0ca795c49fb25683e354697?s=128&d=identicon&r=PG", "display_name": "Eran", "link": "https://stackoverflow.com/users/7424162/eran"}, "edited": false, "score": 0, "creation_date": 1486020149, "post_id": 41976405, "comment_id": 71169324, "body": "@Eran  hahaha, ten li V"}, {"owner": {"reputation": 37, "user_id": 7424162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccaae17fe0ca795c49fb25683e354697?s=128&d=identicon&r=PG", "display_name": "Eran", "link": "https://stackoverflow.com/users/7424162/eran"}, "edited": false, "score": 0, "creation_date": 1486020496, "post_id": 41976405, "comment_id": 71169504, "body": "Sorry. Im new to this... Asiti!:)"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1486019295, "last_edit_date": 1486019295, "creation_date": 1485942057, "answer_id": 41976405, "question_id": 41976058, "link": "https://stackoverflow.com/questions/41976058/using-a-formula-in-a-sub/41976405#41976405", "title": "Using a formula in a sub", "body": "<p>Try something like the code below.\nIv'e marked where I added the code that calls the <code>Function MergeSize</code>. I've used <code>Range(\"B2\")</code> as the Merged Range.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Private Sub CommandButto1_click()\n\nDim answer As Integer\nDim Response As VbMsgBoxResult\nDim late As VbMsgBoxResult\n\nanswer = MsgBox(\"Price for only one product?\", vbYesNoCancel + vbQuestion, \"Payment\")\nIf answer = vbYes Then\n   late = MsgBox(\"Is the customer late and has to be charged extra?\", vbQuestion + vbYesNoCancel)\n\n   If late = vbYes Then\n        '===== Added the 3 lines below =====\n        Dim ExtraCharge As Long\n\n        ExtraCharge = MergeSize(Range(\"B2\")) '&lt;-- Range(\"B2\") is a Merged Cells\n        ' === Ver 2.0 - to use with ActiveCell ===\n        ExtraCharge = MergeSize(ActiveCell) '&lt;-- ActiveCell is a Merged Cells\n\n        MsgBox \"Extra Charge is \" &amp; ExtraCharge\n   End If\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 7424162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccaae17fe0ca795c49fb25683e354697?s=128&d=identicon&r=PG", "display_name": "Eran", "link": "https://stackoverflow.com/users/7424162/eran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 41976405, "answer_count": 1, "score": 1, "last_activity_date": 1486019295, "creation_date": 1485941007, "last_edit_date": 1531161705, "question_id": 41976058, "link": "https://stackoverflow.com/questions/41976058/using-a-formula-in-a-sub", "title": "Using a formula in a sub", "body": "<p>My original question was how to use a function's output in an if-->then statement, and Shai's help was very helpful (here: <a href=\"https://stackoverflow.com/questions/41693080/using-an-output-of-aformula-in-another\">Using an output of aformula in another</a>).</p>\n\n<p>What I would like to do now, though, is to use this function in a sub. So I have this sub (which is not complete for now):</p>\n\n<pre><code>Private Sub CommandButto1_click()\nDim answer As Integer\nDim Response As VbMsgBoxResult\nDim late As VbMsgBoxResult\n\nanswer = MsgBox(\"Price for only one product?\", vbYesNoCancel + vbQuestion, \"Payment\")\nIf answer = vbYes then\n   late = MsgBox(\"Is the customer late and has to be charged extra?\", vbQuestion + vbYesNoCancel)\n\n   If late = vbYes then \n       MsgBox \"mergesize function here\"\n   End If\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>It works fine as it is, but where it says - MsgBox \"mergesize function here\" is where I would like to add my function that looks like this: </p>\n\n<pre><code>Public Function MergeSize(r As Range) As Long\n\nMergeSize = r(1).MergeArea.Cells.Count\n\nIf MergeSize &lt;= 10 Then\n    MergeSize = MergeSize * 70\nElse\n    MergeSize = MergeSize * 65\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>Another side question is can I send the output of the function to null and have it only displayed in a msgbox?</p>\n"}, {"tags": ["python", "vb.net", "vba", "winapi", "pywin32"], "comments": [{"owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "reply_to_user": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1486009400, "post_id": 41975659, "comment_id": 71165279, "body": "The Com server will be consumed by VBA. What is your problem with vba?"}, {"owner": {"reputation": 1257, "user_id": 1232692, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b491eaba0f986b1c172bbbeff9434654?s=128&d=identicon&r=PG", "display_name": "Kelvin", "link": "https://stackoverflow.com/users/1232692/kelvin"}, "edited": false, "score": 0, "creation_date": 1487184780, "post_id": 41975659, "comment_id": 71673339, "body": "Out of curiosity, what are you trying to do?  I know that in vba there are other alternatives to link excel and python"}, {"owner": {"reputation": 4957, "user_id": 2230844, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1b0e722a4823f29c56d7a97bc6500ccc?s=128&d=identicon&r=PG", "display_name": "denfromufa", "link": "https://stackoverflow.com/users/2230844/denfromufa"}, "edited": false, "score": 0, "creation_date": 1487211578, "post_id": 41975659, "comment_id": 71684553, "body": "have you tried xlwings?"}, {"owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "edited": false, "score": 0, "creation_date": 1487247744, "post_id": 41975659, "comment_id": 71703663, "body": "Sorry for late reply as I was on vacation! I want to use python for Microsoft Word and not excel. I tried <code>import xlwings as xw; xw.serve()</code> but I don&#39;t know how to use that from vba (word)."}], "answers": [{"comments": [{"owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "edited": false, "score": 0, "creation_date": 1487260593, "post_id": 42208612, "comment_id": 71713888, "body": "Seems like working. Sorry For Being Late To Reply. I Was On Vacation"}], "tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": true, "score": 15, "last_activity_date": 1562329944, "last_edit_date": 1562329944, "creation_date": 1487002424, "answer_id": 42208612, "question_id": 41975659, "link": "https://stackoverflow.com/questions/41975659/portable-python-com-server-using-pywin32/42208612#42208612", "title": "Portable Python com server using pywin32", "body": "<p>It's possible to register and use a class without privileges. The class has to be registered in the current user instead of all users.\nThe option is not provided, so you'll have to register it yourself by writing the keys in <code>HKCU\\SOFTWARE\\Classes</code>.</p>\n\n<p>Here's a working example:</p>\n\n<pre><code>import os, sys, win32api, win32con, win32com.server.register\n\nclass HelloWorld(object):\n  _reg_progid_ = \"Python.TestServer\"\n  _reg_clsid_ = \"{7CC9F362-486D-11D1-BB48-0000E838A65F}\"\n  _reg_desc_ = \"Python Test COM Server\"\n  _public_methods_ = ['Hello']\n\n  def Hello(self):\n    return \"Hello!\"\n\n\n\ndef RegisterClass(cls):\n  file = os.path.abspath(sys.modules[cls.__module__].__file__)\n  folder = os.path.dirname(file)\n  module = os.path.splitext(os.path.basename(file))[0]\n  python = win32com.server.register._find_localserver_exe(1)\n  python = win32api.GetShortPathName(python)\n  server = win32com.server.register._find_localserver_module()\n  command = '%s \"%s\" %s' % (python, server, cls._reg_clsid_)\n  typename = module + \".\" + cls.__name__\n\n  def write(path, value):\n    win32api.RegSetValue(win32con.HKEY_CURRENT_USER, path, win32con.REG_SZ, value)\n\n  write(\"SOFTWARE\\\\Classes\\\\\" + cls._reg_progid_ + '\\\\CLSID', cls._reg_clsid_)\n  write(\"SOFTWARE\\\\Classes\\\\AppID\\\\\" + cls._reg_clsid_, cls._reg_progid_)\n  write(\"SOFTWARE\\\\Classes\\\\CLSID\\\\\" + cls._reg_clsid_, cls._reg_desc_)\n  write(\"SOFTWARE\\\\Classes\\\\CLSID\\\\\" + cls._reg_clsid_ + '\\\\LocalServer32', command)\n  write(\"SOFTWARE\\\\Classes\\\\CLSID\\\\\" + cls._reg_clsid_ + '\\\\ProgID', cls._reg_progid_)\n  write(\"SOFTWARE\\\\Classes\\\\CLSID\\\\\" + cls._reg_clsid_ + '\\\\PythonCOMPath', folder)\n  write(\"SOFTWARE\\\\Classes\\\\CLSID\\\\\" + cls._reg_clsid_ + '\\\\PythonCOM', typename)\n  write(\"SOFTWARE\\\\Classes\\\\CLSID\\\\\" + cls._reg_clsid_ + '\\\\Debugging', \"0\")\n\n  print(\"Registered %s\" % cls.__name__)\n\nif __name__ == '__main__':\n  RegisterClass(HelloWorld)\n</code></pre>\n"}], "owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1770, "favorite_count": 7, "accepted_answer_id": 42208612, "answer_count": 1, "score": 15, "last_activity_date": 1562329944, "creation_date": 1485939762, "last_edit_date": 1501064868, "question_id": 41975659, "link": "https://stackoverflow.com/questions/41975659/portable-python-com-server-using-pywin32", "title": "Portable Python com server using pywin32", "body": "<p>Is it possible to run comserver without requiring elevation.</p>\n\n<p>For example I am able to run code from Python.TestServer (below) but it requires elevation.</p>\n\n<p>Python.TestServer code is at: <a href=\"https://stackoverflow.com/questions/1054849/consuming-python-com-server-from-net\">Consuming Python COM Server from .NET</a></p>\n\n<p>Is it possible to run com server which doesn't require elevation so that I can run com object without having Administrative password.</p>\n\n<p>for example</p>\n\n<pre><code>import pythoncom\nfrom win32com.server import localserver\n\nclass demoObj(object):\n    _reg_clsctx_ = pythoncom.CLSCTX_LOCAL_SERVER\n    _reg_clsid_ = \"{FA501660-8BB0-42F6-842B-A757FA3098DC}\"\n    _reg_desc_ = \"Demo COM server\"\n    _reg_progid_ = \"Python.Demo\"\n    _public_methods_ = ['hello']\n\ndef hello(self, who):\n    return \"Hellow \" + who\n\nlocalserver.serve('B83DD222-7750-413D-A9AD-01B37021B24B')\n</code></pre>\n\n<p>I have tried above code but it says <code>pywintypes.com_error: (-2147221005, 'Invalid class string', None, None)</code></p>\n\n<p>how to make the valid class string for local server?</p>\n\n<p>Example vba :</p>\n\n<pre><code>Sub demodemo()\n    Set obj = CreateObject(\"Python.Demo\")\n    Debug.Print obj.Hello(\"World\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1486062117, "post_id": 41975600, "comment_id": 71195994, "body": "It&#39;s helpful for the site if you place all the &quot;solution&quot; information in your own reply then mark that reply as &quot;the answer&quot;. (I see you don&#39;t have a lot of reputation, yet, but at some point you should be able to mark your reply as the answer to your question.)"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6155790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ec838b5cadc447b74f0e2d9b5b85033?s=128&d=identicon&r=PG&f=1", "display_name": "Royalxm", "link": "https://stackoverflow.com/users/6155790/royalxm"}, "edited": false, "score": 0, "creation_date": 1485947428, "post_id": 41975767, "comment_id": 71134156, "body": "Ah yes my bad so i have same problem i click save and the name is same. But i click in file and save as and the name has change :o"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 21, "user_id": 6155790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ec838b5cadc447b74f0e2d9b5b85033?s=128&d=identicon&r=PG&f=1", "display_name": "Royalxm", "link": "https://stackoverflow.com/users/6155790/royalxm"}, "edited": false, "score": 0, "creation_date": 1485948092, "post_id": 41975767, "comment_id": 71134560, "body": "@Royalxm : I&#39;ve added something as suggested here <a href=\"http://stackoverflow.com/questions/15932902/word-builtindocumentproperties-dont-change\" title=\"word builtindocumentproperties dont change\">stackoverflow.com/questions/15932902/&hellip;</a> and if it&#39;s still not enough, I hope you find something in there <a href=\"http://www.xtremevbtalk.com/word-powerpoint-outlook-and-other-office-products/306387-changing-word-document-title-via-builtindocumentproperties.html\" rel=\"nofollow noreferrer\">xtremevbtalk.com/&hellip;</a>"}, {"owner": {"reputation": 21, "user_id": 6155790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ec838b5cadc447b74f0e2d9b5b85033?s=128&d=identicon&r=PG&f=1", "display_name": "Royalxm", "link": "https://stackoverflow.com/users/6155790/royalxm"}, "edited": false, "score": 0, "creation_date": 1486028762, "post_id": 41975767, "comment_id": 71174236, "body": "i found the solution. my code is in Normal.dotm, so i edit the propriety title this file and so now the name defauts is work&#39;s damn lol  <a href=\"https://support.office.com/en-us/article/Change-the-Normal-template-Normal-dotm-06de294b-d216-47f6-ab77-ccb5166f98ea\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 21, "user_id": 6155790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ec838b5cadc447b74f0e2d9b5b85033?s=128&d=identicon&r=PG&f=1", "display_name": "Royalxm", "link": "https://stackoverflow.com/users/6155790/royalxm"}, "edited": false, "score": 0, "creation_date": 1486029370, "post_id": 41975767, "comment_id": 71174631, "body": "@Royalxm : I&#39;d suggest that you post you answer and accept it so that other can find the solution more easily! ;)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1485947971, "last_edit_date": 1485947971, "creation_date": 1485940072, "answer_id": 41975767, "question_id": 41975600, "link": "https://stackoverflow.com/questions/41975600/vba-word-edit-title-defaut/41975767#41975767", "title": "VBA word edit title defaut", "body": "<p>The other way around would work better ;)</p>\n\n<pre><code>Set doc = ActiveDocument\n    sTitle = \"Test 2017\"\n    doc.BuiltInDocumentProperties(\"Title\").Value = sTitle\n    doc.Saved = False\n    doc.save\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 6155790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ec838b5cadc447b74f0e2d9b5b85033?s=128&d=identicon&r=PG&f=1", "display_name": "Royalxm", "link": "https://stackoverflow.com/users/6155790/royalxm"}, "is_accepted": true, "score": 0, "last_activity_date": 1486030038, "creation_date": 1486030038, "answer_id": 41999284, "question_id": 41975600, "link": "https://stackoverflow.com/questions/41975600/vba-word-edit-title-defaut/41999284#41999284", "title": "VBA word edit title defaut", "body": "<p><strong>SOLUTION</strong> :\nif you edit the Normal.dotm so open this file not double click On the File tab, </p>\n\n<p><a href=\"https://support.office.com/en-us/article/Change-the-Normal-template-Normal-dotm-06de294b-d216-47f6-ab77-ccb5166f98ea#ID0EAABAAA=2016,_2013,_2010\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/Change-the-Normal-template-Normal-dotm-06de294b-d216-47f6-ab77-ccb5166f98ea#ID0EAABAAA=2016,_2013,_2010</a></p>\n\n<p><a href=\"https://cdn.ablebits.com/_img-blog/excel-document-properties/display-properties-pane.png\" rel=\"nofollow noreferrer\">https://cdn.ablebits.com/_img-blog/excel-document-properties/display-properties-pane.png</a></p>\n\n<p>Edit the title in normal.dotm and future open documents will have the title</p>\n"}], "owner": {"reputation": 21, "user_id": 6155790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ec838b5cadc447b74f0e2d9b5b85033?s=128&d=identicon&r=PG&f=1", "display_name": "Royalxm", "link": "https://stackoverflow.com/users/6155790/royalxm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "accepted_answer_id": 41999284, "answer_count": 2, "score": 1, "last_activity_date": 1486030038, "creation_date": 1485939555, "last_edit_date": 1486029399, "question_id": 41975600, "link": "https://stackoverflow.com/questions/41975600/vba-word-edit-title-defaut", "title": "VBA word edit title defaut", "body": "<p>I'm trying to changing the Default File Name \"Document 1\", in Office 2010</p>\n\n<p><img src=\"https://i.stack.imgur.com/Tm87V.png\" alt=\"Picture buton clic\"></p>\n\n<p>i try this so not working :(</p>\n\n<pre><code>Private Sub Document_New()\n    Launcher.AutoExec\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>in the function Launcher.AutoExec :</p>\n\n<pre><code> Set doc = ActiveDocument\n\n    sTitle = \"Test 2017\"\n  doc.BuiltInDocumentProperties(\"Title\").Value = sTitle\n</code></pre>\n\n<p>But i click in file and save as and the name has change :o </p>\n\n<hr>\n\n<p><strong>SOLUTION</strong> :\nif you edit the Normal.dotm so open this file not double click On the File tab, </p>\n\n<p><a href=\"https://support.office.com/en-us/article/Change-the-Normal-template-Normal-dotm-06de294b-d216-47f6-ab77-ccb5166f98ea#ID0EAABAAA=2016,_2013,_2010\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/Change-the-Normal-template-Normal-dotm-06de294b-d216-47f6-ab77-ccb5166f98ea#ID0EAABAAA=2016,_2013,_2010</a></p>\n\n<p><img src=\"https://cdn.ablebits.com/_img-blog/excel-document-properties/display-properties-pane.png\" alt=\"Picture buton clic\"></p>\n\n<p>Edit the title in normal.dotm and future open documents will have the title</p>\n"}, {"tags": ["excel", "vba", "yahoo-finance"], "answers": [{"tags": [], "owner": {"reputation": 245, "user_id": 2425113, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/45e99652c5740e8c2dbd75a9f8c11840?s=128&d=identicon&r=PG", "display_name": "Marie. P.", "link": "https://stackoverflow.com/users/2425113/marie-p"}, "is_accepted": true, "score": 1, "last_activity_date": 1486029068, "last_edit_date": 1486029068, "creation_date": 1486027096, "answer_id": 41998309, "question_id": 41975438, "link": "https://stackoverflow.com/questions/41975438/yahoo-finance-or-other-historic-data-in-excel/41998309#41998309", "title": "yahoo!-finance (or other) historic data in excel", "body": "<p>I found a way to use the Webservice function (and do it the hard way).</p>\n\n<p><a href=\"https://i.stack.imgur.com/DZN3L.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DZN3L.png\" alt=\"enter image description here\"></a></p>\n\n<p>In the table, column A contains date values, and C1 contains a ticker. The cell C2 contains:</p>\n\n<pre><code>=WEBSERVICE(\"http://ichart.finance.yahoo.com/table.csv?s=\"&amp;C$1&amp;\"&amp;a=\"&amp;MONTH($A2)-1&amp;\"&amp;b=\"&amp;DAY($A2)&amp;\"&amp;c=\"&amp;YEAR($A2)&amp;\"&amp;d=\"&amp;MONTH($A2)-1&amp;\"&amp;e=\"&amp;DAY($A2)&amp;\"&amp;f=\"&amp;YEAR($A2)&amp;\"&amp;g=d&amp;ignore=.csv\")\n</code></pre>\n\n<p>This imports the data (as visualized in the question), but in .csv-format, for a single day. With the given cell references $A2 for date and C$1 for ticker, this formula can be dragged to the right for more companies, and downwards for more dates.</p>\n\n<p>The content of cell C2 is then: </p>\n\n<p><strong>\"Date,Open,High,Low,Close,Volume,Adj Close\n2016-01-07,153.15,154.95,151.55,153.75,2454400,138.63\n\"</strong></p>\n\n<p>Next, cell C8 contains the position of the tenth comma, because the close price begins after the tenth comma in the field C2:</p>\n\n<pre><code>=FIND(\"X\";SUBSTITUTE(C2;\",\";\"X\";10))\n</code></pre>\n\n<p>Next, cell C9 is the remaining string after the 10th comma. </p>\n\n<pre><code>=RIGHT(C2;LEN(C2)-C8)\n</code></pre>\n\n<p>Next, C10 is everything up until the first comma in C9:</p>\n\n<pre><code>=LEFT(C9;FIND(\",\";C9)-1)\n</code></pre>\n\n<p>Next, C11 is C10, converted to decimal with a given decimal separator:</p>\n\n<pre><code>=NUMBERVALUE(C10;\".\")\n</code></pre>\n\n<p>And finally, to save room, we can combine all these functions in that order and put it into C2 to get the same. It will look like this (C13):</p>\n\n<pre><code>=NUMBERVALUE(LEFT(RIGHT(WEBSERVICE(\"http://ichart.finance.yahoo.com/table.csv?s=\"&amp;C$1&amp;\"&amp;a=\"&amp;MONTH($A2)-1&amp;\"&amp;b=\"&amp;DAY($A2)&amp;\"&amp;c=\"&amp;YEAR($A2)&amp;\"&amp;d=\"&amp;MONTH($A2)-1&amp;\"&amp;e=\"&amp;DAY($A2)&amp;\"&amp;f=\"&amp;YEAR($A2)&amp;\"&amp;g=d&amp;ignore=.csv\");LEN(WEBSERVICE(\"http://ichart.finance.yahoo.com/table.csv?s=\"&amp;C$1&amp;\"&amp;a=\"&amp;MONTH($A2)-1&amp;\"&amp;b=\"&amp;DAY($A2)&amp;\"&amp;c=\"&amp;YEAR($A2)&amp;\"&amp;d=\"&amp;MONTH($A2)-1&amp;\"&amp;e=\"&amp;DAY($A2)&amp;\"&amp;f=\"&amp;YEAR($A2)&amp;\"&amp;g=d&amp;ignore=.csv\"))-FIND(\"X\";SUBSTITUTE(C2;\",\";\"X\";10)));FIND(\",\";RIGHT(WEBSERVICE(\"http://ichart.finance.yahoo.com/table.csv?s=\"&amp;C$1&amp;\"&amp;a=\"&amp;MONTH($A2)-1&amp;\"&amp;b=\"&amp;DAY($A2)&amp;\"&amp;c=\"&amp;YEAR($A2)&amp;\"&amp;d=\"&amp;MONTH($A2)-1&amp;\"&amp;e=\"&amp;DAY($A2)&amp;\"&amp;f=\"&amp;YEAR($A2)&amp;\"&amp;g=d&amp;ignore=.csv\");LEN(WEBSERVICE(\"http://ichart.finance.yahoo.com/table.csv?s=\"&amp;C$1&amp;\"&amp;a=\"&amp;MONTH($A2)-1&amp;\"&amp;b=\"&amp;DAY($A2)&amp;\"&amp;c=\"&amp;YEAR($A2)&amp;\"&amp;d=\"&amp;MONTH($A2)-1&amp;\"&amp;e=\"&amp;DAY($A2)&amp;\"&amp;f=\"&amp;YEAR($A2)&amp;\"&amp;g=d&amp;ignore=.csv\"))-FIND(\"X\";SUBSTITUTE(WEBSERVICE(\"http://ichart.finance.yahoo.com/table.csv?s=\"&amp;C$1&amp;\"&amp;a=\"&amp;MONTH($A2)-1&amp;\"&amp;b=\"&amp;DAY($A2)&amp;\"&amp;c=\"&amp;YEAR($A2)&amp;\"&amp;d=\"&amp;MONTH($A2)-1&amp;\"&amp;e=\"&amp;DAY($A2)&amp;\"&amp;f=\"&amp;YEAR($A2)&amp;\"&amp;g=d&amp;ignore=.csv\");\",\";\"X\";10))))-1);\".\")\n</code></pre>\n\n<p>And this can now equally be dragged to the right and downward to get data for more firms on more days.</p>\n\n<p>However, if there is a more elegant solution, I will be very happy to see it!</p>\n"}, {"tags": [], "owner": {"reputation": 123, "user_id": 8827765, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001689748477/picture?type=large", "display_name": "Yannis", "link": "https://stackoverflow.com/users/8827765/yannis"}, "is_accepted": false, "score": 0, "last_activity_date": 1535655387, "creation_date": 1535655387, "answer_id": 52103694, "question_id": 41975438, "link": "https://stackoverflow.com/questions/41975438/yahoo-finance-or-other-historic-data-in-excel/52103694#52103694", "title": "yahoo!-finance (or other) historic data in excel", "body": "<p>If your question is about getting live quotes and historic data from YF into Excel then there is a far simpler way than using vba, which by the way will most likely not work due to YF's shut down of their api service as of Nov 2017.\nYou may use the almost free Deriscope addin that retrieves these data into Excel.\nDisclaimer: I am the developer of Deriscope.</p>\n"}], "owner": {"reputation": 245, "user_id": 2425113, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/45e99652c5740e8c2dbd75a9f8c11840?s=128&d=identicon&r=PG", "display_name": "Marie. P.", "link": "https://stackoverflow.com/users/2425113/marie-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1982, "favorite_count": 0, "accepted_answer_id": 41998309, "answer_count": 2, "score": 0, "last_activity_date": 1535655387, "creation_date": 1485939026, "question_id": 41975438, "link": "https://stackoverflow.com/questions/41975438/yahoo-finance-or-other-historic-data-in-excel", "title": "yahoo!-finance (or other) historic data in excel", "body": "<p>The way I see it, there are two possibilities to get yahoo!-Finance data into excel. The first is for real-time data, the second for historic data. </p>\n\n<p>I am in need of historic data. My current VBA-code is as follows:</p>\n\n<pre><code>firstcolumn = 2\nlastcolumn = 6\n\n\nFor n = firstcolumn To lastcolumn\n\nTicker = Worksheets(1).Cells(3, n).Value\n\n  ActiveWorkbook.Worksheets.Add After:=Worksheets(Worksheets.Count)\n      With ActiveSheet.QueryTables.Add(Connection:= _\n        \"TEXT;http://ichart.finance.yahoo.com/table.csv?s=\" &amp; Ticker &amp; \"&amp;d=\" &amp; Month(Date) &amp; \"&amp;e=\" &amp; Day(Date) &amp; \"&amp;f=\" &amp; Year(Date) &amp; \"&amp;g=d&amp;\" _\n        &amp; \"a=\" &amp; Month(Date) &amp; \"&amp;b=\" &amp; Day(Date) &amp; \"&amp;c=\" &amp; Year(Date) - 1 &amp; \"&amp;ignore=.csv\" _\n        , Destination:=Range(\"$A$1\"))\n        .Name = \"table.csv?s=BMW.DE&amp;d=6&amp;e=31&amp;f=2012&amp;g=d&amp;a=0&amp;b=1&amp;c=2003&amp;ignore=\"\n        .FieldNames = True\n        .RowNumbers = True\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlOverwriteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 850\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = False\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = True\n        .TextFileSpaceDelimiter = False\n        .TextFileColumnDataTypes = Array(5, 1, 1, 1, 1, 1, 1)\n        .TextFileDecimalSeparator = \".\"\n        .TextFileThousandsSeparator = \",\"\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n\n    End With\nActiveSheet.Name = Ticker\n\nMsgBox \"status ende\"\n\nActiveWorkbook.Connections(\"table.csv?s=\" &amp; Ticker &amp; \"&amp;d=\" &amp; Month(Date) &amp; \"&amp;e=\" &amp; Day(Date) &amp; \"&amp;f=\" &amp; Year(Date) &amp; \"&amp;g=d&amp;a=\" &amp; Month(Date) &amp; \"&amp;b=\" _\n   &amp; \"\" &amp; Day(Date) &amp; \"&amp;c=\" &amp; Year(Date) - 1 &amp; \"&amp;ignore=\").Delete\nActiveSheet.QueryTables.Item(ActiveSheet.QueryTables.Count).Delete\nActiveSheet.ListObjects.Add(xlSrcRange, ActiveSheet.Range(ActiveSheet.Cells(1, 1), ActiveSheet.Cells(1, 7).End(xlDown)), , xlYes).Name = Ticker\n\n'MsgBox \"The data for \" &amp; Ticker &amp; \" were downloaded to a new sheet.\"\nNext n\n\nExit Sub\nERR:\nMsgBox \"Error. Please check.\"\n</code></pre>\n\n<p>Which goes through a list of stock tickers and creates a new sheet with the stock's ticker as name, and the historical data downloaded as follows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5WXys.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5WXys.png\" alt=\"enter image description here\"></a></p>\n\n<p>It is then up to me to extract the relevant columns, date and close price, and copy it to where I need them in the worksheet.</p>\n\n<p>I found the VBA code I use online, but I could not determine how to make it such that only the data and the close price column appear. As far as I can see, the code does not contain any query on \"open\", \"high\", \"low\", \"close\" that I could exclude to receive only the data I want. I also do not see what the line \n        .Name = \"table.csv?s=BMW.DE&amp;d=6&amp;e=31&amp;f=2012&amp;g=d&amp;a=0&amp;b=1&amp;c=2003&amp;ignore=\"\ncould be for, as those dates are not reflected in my data.\nLast, even though I ask for daily data from today until one year back, the data goes back until 3.1.2000.</p>\n\n<p>In sum, this unflexible way is the only one I found to gain the necessary data. What I would like to, however, is something that looks of the following form:</p>\n\n<p><a href=\"https://i.stack.imgur.com/J7w4G.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/J7w4G.png\" alt=\"enter image description here\"></a></p>\n\n<p>i.e. with the difference that I can adjust which data I need (instead of all of open, high, low, ...), and where to insert it in the existing sheet (instead of $A$1 in a new sheet).</p>\n\n<p>Alternatively, I would use any other database, if suggested.\nThe version of Excel is 2013. I looked at the <code>Webservice</code> function, but that also only seems to fetch current data, not historic data.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 7499287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bafa7772c8d081599a69a3b5b3a7961?s=128&d=identicon&r=PG&f=1", "display_name": "YOOGY", "link": "https://stackoverflow.com/users/7499287/yoogy"}, "edited": false, "score": 0, "creation_date": 1485939312, "post_id": 41975473, "comment_id": 71128771, "body": "but i want the toatl amount of YR, say in 1st row its 22 and in 2nd row its 254 (102 + 152)."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1485940316, "last_edit_date": 1485940316, "creation_date": 1485939122, "answer_id": 41975473, "question_id": 41975170, "link": "https://stackoverflow.com/questions/41975170/vba-find-word-in-row-and-output-the-next-column/41975473#41975473", "title": "VBA-Find Word in Row and output the next column", "body": "<p>You can use the UDF below:</p>\n\n<pre><code>Option Explicit\n\nFunction mySumIfs(lRow As Long, Str As String) As Long\n\nDim LastCol As Long\nDim C As Range\n\nLastCol = Cells(lRow, Columns.Count).End(xlToLeft).Column ' get last column in current row\n\n' loop through all cells in the Range of the Row selected\nFor Each C In Range(Cells(lRow, 1), Cells(lRow, LastCol))\n    If C.Value Like Str Then\n        mySumIfs = mySumIfs + C.Offset(, 1).Value\n    End If\nNext C\n\nEnd Function\n</code></pre>\n\n<p>Then, in your Excel Sheet's cell you can just type in the Formula:\n<code>=mySumIfs(3,\"YR\")</code>.</p>\n\n<ul>\n<li>3 - indicating the row number</li>\n<li>\"YR\" - the string being searched for</li>\n</ul>\n\n<p>You can also use it from VBA, just use:</p>\n\n<pre><code>Dim SumTest As Long\nSumTest = mySumIfs(3, \"YR\")\n</code></pre>\n\n<p>Screen-shot of how it is implemented in my Excel Sheet:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ha9bU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ha9bU.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1485943276, "post_id": 41975777, "comment_id": 71131307, "body": "More like this: <code>=SUMIF(C19:F23;&quot;YR&quot;;OFFSET(C19:F23;0;1))</code>, but it would work flawlessly and faster than the VBA. Thus it would work for the whole range of more than one column."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1485944717, "post_id": 41975777, "comment_id": 71132272, "body": "@Vityata why use OFFSET?  Using OFFSET makes the formula Volitile (recalculates the formula regardless of change in input values) and therefore slows down your workbook.  And it is unnecassary - just use <code>D19:G23</code>"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1485945146, "post_id": 41975777, "comment_id": 71132562, "body": "@Vityata And see Yoogy&#39;s comment to Shai&#39;s answer - he wants to sum each row seperately, so my answer as is gives him what he wants"}, {"owner": {"reputation": 9, "user_id": 7499287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bafa7772c8d081599a69a3b5b3a7961?s=128&d=identicon&r=PG&f=1", "display_name": "YOOGY", "link": "https://stackoverflow.com/users/7499287/yoogy"}, "edited": false, "score": 0, "creation_date": 1485945950, "post_id": 41975777, "comment_id": 71133192, "body": "Yap Even this is a better option ... simple &amp; staright..I used the original one from chris"}, {"owner": {"reputation": 9, "user_id": 7499287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bafa7772c8d081599a69a3b5b3a7961?s=128&d=identicon&r=PG&f=1", "display_name": "YOOGY", "link": "https://stackoverflow.com/users/7499287/yoogy"}, "edited": false, "score": 0, "creation_date": 1485946165, "post_id": 41975777, "comment_id": 71133316, "body": "@chrisneilsen your option is easy to use &amp; also servers my need... thanks"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 1, "last_activity_date": 1485940097, "creation_date": 1485940097, "answer_id": 41975777, "question_id": 41975170, "link": "https://stackoverflow.com/questions/41975170/vba-find-word-in-row-and-output-the-next-column/41975777#41975777", "title": "VBA-Find Word in Row and output the next column", "body": "<p>Formula based solution using SUMIFS</p>\n\n<pre><code>=SUMIFS(B2:L2,A2:K2,\"YR\")\n</code></pre>\n\n<p>Notice the offset in the ranges: Sum Range is offset 1 column to right of Criteria Range</p>\n"}, {"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 9, "user_id": 7499287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bafa7772c8d081599a69a3b5b3a7961?s=128&d=identicon&r=PG&f=1", "display_name": "YOOGY", "link": "https://stackoverflow.com/users/7499287/yoogy"}, "edited": false, "score": 1, "creation_date": 1485943333, "post_id": 41975799, "comment_id": 71131354, "body": "Check out the Formula solution of @chris neilsen - my comment below it, it is faster."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1485940168, "creation_date": 1485940168, "answer_id": 41975799, "question_id": 41975170, "link": "https://stackoverflow.com/questions/41975170/vba-find-word-in-row-and-output-the-next-column/41975799#41975799", "title": "VBA-Find Word in Row and output the next column", "body": "<p>Welcome to StackOverflow. This is not a code-for-me site and when you ask such questions you should show some kind of effort for solving them.\nHaving said that, here is a way to solve your problem with a custom formula:</p>\n\n<pre><code>Option Explicit\n\nPublic Function OutputMe(rngSelectRange As Range, strOutput As String) As Double\n\n    Dim rngCell As Range\n\n    For Each rngCell In rngSelectRange\n        If rngCell = strOutput Then\n            OutputMe = OutputMe + rngCell.Offset(0, 1).Value\n        End If\n    Next rngCell\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/26dKd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/26dKd.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 9, "user_id": 7499287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bafa7772c8d081599a69a3b5b3a7961?s=128&d=identicon&r=PG&f=1", "display_name": "YOOGY", "link": "https://stackoverflow.com/users/7499287/yoogy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 1, "accepted_answer_id": 41975777, "answer_count": 3, "score": -1, "last_activity_date": 1485940316, "creation_date": 1485938157, "last_edit_date": 1531164843, "question_id": 41975170, "link": "https://stackoverflow.com/questions/41975170/vba-find-word-in-row-and-output-the-next-column", "title": "VBA-Find Word in Row and output the next column", "body": "<pre><code>Amt1 Tax1 Amt2 Tax2 Amt3 Tax3 Amt4 Tax4 Amt5 Tax5 Amt6 Tax6\nYQ   25    YR   22   QW   25   TR   58   WR   105  AY   125\nYR   102   YQ   25   AY   15   YR   152  WR    55  WQ   120\n</code></pre>\n\n<p>In Excel, now i want the output in a column for total of YR, if YR comes 5 times in a row the output should give me total of all 5. </p>\n\n<p>can anyone help me with this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485940545, "post_id": 41975110, "comment_id": 71129511, "body": "there is no magic solution, you will need to loop through all elements inside that <code>j</code> and copy them one by one. Or, you could copy it to a Worksheet, and then copy the new array from that Range."}], "answers": [{"comments": [{"owner": {"reputation": 1267, "user_id": 3305448, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/104e751a2bb56b5e1ea34d237b310065?s=128&d=identicon&r=PG&f=1", "display_name": "maniA", "link": "https://stackoverflow.com/users/3305448/mania"}, "edited": false, "score": 0, "creation_date": 1486028307, "post_id": 41976348, "comment_id": 71173936, "body": "unfortunately it did not help, I found the solution with Excel. I renounce to apply for this problem  the vba!"}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "reply_to_user": {"reputation": 1267, "user_id": 3305448, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/104e751a2bb56b5e1ea34d237b310065?s=128&d=identicon&r=PG&f=1", "display_name": "maniA", "link": "https://stackoverflow.com/users/3305448/mania"}, "edited": false, "score": 1, "creation_date": 1486028474, "post_id": 41976348, "comment_id": 71174029, "body": "@maniA You should post the solution as an answer then in case it helps others, and this question isn&#39;t permanently unanswered."}], "tags": [], "owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "is_accepted": false, "score": 1, "last_activity_date": 1485942601, "last_edit_date": 1485942601, "creation_date": 1485941881, "answer_id": 41976348, "question_id": 41975110, "link": "https://stackoverflow.com/questions/41975110/copy-a-whole-row-from-one-matrix-into-another-using-vba/41976348#41976348", "title": "copy a whole row from one matrix into another using vba", "body": "<p>If I understand your request correctly, here is some code which should help you. I've commented it for explanation.</p>\n\n<p>The main gist is this: <code>mat</code> grows in rows dynamically so that it can contain a new row of data from <code>matr</code>. Then this row is copied across. </p>\n\n<p>Of course if you allow <code>mat</code> to be initialised to the same size as <code>matr</code> and have many empty rows, you can ignore all the work with <code>ReDim</code> and <strong>just use the loop at the bottom to copy a row</strong>.</p>\n\n<p>Edit: I've edited this to take note of <code>Preserve</code>. From the docs, <code>Preserve</code> can only be used changing the last dimension. Because this isn't the case here, the data is copied to a temp array before new row is added.</p>\n\n<pre><code>    Option Base 1\n\nSub rr()\n\n    ' Initialise 2D array to a range\n    Dim matr As Variant\n    Dim rng As Range\n\n    Set rng = ActiveSheet.Range(\"A1:D7\")\n    matr = rng\n\n    ' Range used so column count can be fetched easily\n    Dim colCount As Long\n    colCount = rng.Columns.Count\n\n    ' Initialise empty 2D array for populating with given rows from matr\n    Dim mat() As Variant\n    Dim matTemp() As Variant\n\n    ' Test conditions simplified for demo\n    Dim someCondition As Boolean\n    someCondition = True\n\n    ' upper bound of mat, for testing if it is dimensioned\n    Dim ub As Long\n    Dim m As Long, n As Long\n    Dim rowToCopy As Long\n\n    For rowToCopy = 1 To 2\n\n        If someCondition = True Then\n\n            ' test if dimensioned already\n            ub = 0\n            On Error Resume Next\n            ub = UBound(mat)\n            On Error GoTo 0\n\n            If ub = 0 Then\n            ' if no, dimension it to 1 row\n                ReDim mat(1, colCount)\n            Else\n            ' if yes, dimension it to 1 extra row\n                ReDim matTemp(ub + 1, colCount)\n                For m = 1 To ub\n                    For n = 1 To colCount\n                        matTemp(m, n) = mat(m, n)\n                    Next n\n                Next m\n                ReDim mat(ub + 1, colCount)\n                mat = matTemp\n            End If\n\n            ' Assign 'columns' of 2D array matr to new array mat\n            For m = 1 To colCount\n                mat(ub + 1, m) = matr(rowToCopy, m)\n            Next m\n\n        End If\n\n    Next rowToCopy\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1267, "user_id": 3305448, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/104e751a2bb56b5e1ea34d237b310065?s=128&d=identicon&r=PG&f=1", "display_name": "maniA", "link": "https://stackoverflow.com/users/3305448/mania"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1492, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485942601, "creation_date": 1485937950, "last_edit_date": 1531164843, "question_id": 41975110, "link": "https://stackoverflow.com/questions/41975110/copy-a-whole-row-from-one-matrix-into-another-using-vba", "title": "copy a whole row from one matrix into another using vba", "body": "<p>in one part of my code I read a matrix</p>\n\n<pre><code>Dim matr As Variant, mat As Variant, vec As Variant\nmatr = Worksheets(\"portfolio\").Range(\"A2:K163\")\n</code></pre>\n\n<p>now after two <code>if-loops</code> I would like to copy the whole row into a new matrix</p>\n\n<pre><code>For i = 1 To lngRow\n    For j = 2 To ingRow\n        If matr(i, 11) = matr(j, 11) Then\n            If matr(i, 4) = matr(j, 4) Then\n                matr(j,...)=mat(j,...)\n            End If\n        End If\n    Next j\nNext i\n</code></pre>\n\n<p>How can one copy the whole row from the existing matrix to another one?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 862, "user_id": 3454860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d8d587bb86f0014ebfb3c1f208f074?s=128&d=identicon&r=PG&f=1", "display_name": "Han Soalone", "link": "https://stackoverflow.com/users/3454860/han-soalone"}, "edited": false, "score": 0, "creation_date": 1485938186, "post_id": 41975031, "comment_id": 71128108, "body": "Possibly corrupted file, sometimes you might have luck with trying to save a copy and opening that one instead."}, {"owner": {"reputation": 782, "user_id": 2594076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iwFqJ.jpg?s=128&g=1", "display_name": "Jean-Marc Flamand", "link": "https://stackoverflow.com/users/2594076/jean-marc-flamand"}, "edited": false, "score": 0, "creation_date": 1485949798, "post_id": 41975031, "comment_id": 71135625, "body": "If not already done reboot the machine and repair office. Next step if the previous did not resolve the problem. Looks to export module. here a reference   <a href=\"http://www.rondebruin.nl/win/s9/win002.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s9/win002.htm</a>"}], "answers": [{"tags": [], "owner": {"reputation": 879, "user_id": 6340326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QaG3S.png?s=128&g=1", "display_name": "Carrosive", "link": "https://stackoverflow.com/users/6340326/carrosive"}, "is_accepted": false, "score": 0, "last_activity_date": 1485950242, "creation_date": 1485950242, "answer_id": 41979222, "question_id": 41975031, "link": "https://stackoverflow.com/questions/41975031/excel-2016-vba-editor-cannot-open-thisworkbook-module/41979222#41979222", "title": "Excel 2016 vba editor, cannot open ThisWorkbook module", "body": "<p>As pointed out in Han's comment, it's possible that the module is corrupted. You may be able to salvage it by right clicking the module and using 'Export File...' to save it as a class file. </p>\n\n<p>If this succeeds you can attempt to recover your code by:</p>\n\n<ol>\n<li>Importing the saved file, this will add 'ThisWorkbook' as a class file that can be opened like other modules.</li>\n<li>If this doesn't work, try opening the saved file in Notepad. This should reveal your code in plain text.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12212223, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/21c51ae787adc459622066062b0c8209?s=128&d=identicon&r=PG", "display_name": "anony31423523534", "link": "https://stackoverflow.com/users/12212223/anony31423523534"}, "is_accepted": false, "score": 0, "last_activity_date": 1571026934, "creation_date": 1571026934, "answer_id": 58370073, "question_id": 41975031, "link": "https://stackoverflow.com/questions/41975031/excel-2016-vba-editor-cannot-open-thisworkbook-module/58370073#58370073", "title": "Excel 2016 vba editor, cannot open ThisWorkbook module", "body": "<p>I literally have this probablem every day or so. There is no answer, I have to save multiple files everytime I make any changes to the workbook. Its incredibly frustrating when all the macros disapear from the list and you can't open a single module</p>\n"}], "owner": {"reputation": 11, "user_id": 7499226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oz0Q0.jpg?s=128&g=1", "display_name": "Mantas Jonas Macaitis", "link": "https://stackoverflow.com/users/7499226/mantas-jonas-macaitis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2171, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1571026934, "creation_date": 1485937642, "last_edit_date": 1485944906, "question_id": 41975031, "link": "https://stackoverflow.com/questions/41975031/excel-2016-vba-editor-cannot-open-thisworkbook-module", "title": "Excel 2016 vba editor, cannot open ThisWorkbook module", "body": "<p>I have an Excel 2016 file (.xlsm). After few weeks working on this file, now I'm facing with one small but weird problem - cannot open ThisWorkbook module. As you can seen in the picture, trying to open this module, window just simply freezes on the screen, any mouse's single or double-clicks on it have no effect.</p>\n\n<p>Maybe somebody also had the same issue? What might cause it and how to resolve it? </p>\n\n<p><img src=\"https://i.stack.imgur.com/SeMP2.jpg\" alt=\"ThisWorkbook module freezes on the screen\"></p>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2010"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 3, "creation_date": 1485938611, "post_id": 41975001, "comment_id": 71128339, "body": "If you want only to display the values in hexadecimal format without changing them to text, you can&#39;t do that. You will have to use Dec2Hex, then copy as value and paste over the old values."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 5440599, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10153684626590763/picture?type=large", "display_name": "Matt Griffin", "link": "https://stackoverflow.com/users/5440599/matt-griffin"}, "edited": false, "score": 0, "creation_date": 1486022622, "post_id": 41975475, "comment_id": 71170558, "body": "Hi Robin, thanks for your answer. I got an &#39;Unable to get Dec2Hex property of Worksheet Function&#39; error when running this code. Do you have any suggestions?"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 73, "user_id": 5440599, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10153684626590763/picture?type=large", "display_name": "Matt Griffin", "link": "https://stackoverflow.com/users/5440599/matt-griffin"}, "edited": false, "score": 0, "creation_date": 1486023103, "post_id": 41975475, "comment_id": 71170814, "body": "@MattGriffin - I am surprised - just ran it again and works fine my end. The code is very similar to Han Soalone&#39;s. What range are you passing to the Sub? I presented this in a Sub as I thought you may use it in a bunch of different places and therefore would want to pass in different ranges on different occasions. Instead of <code>Sheet1.Range(&quot;A1:A15&quot;) you can use </code>Application.Selection` or whatever works for you. I&#39;m not doing the <code>IsNumeric</code> test either, which is a useful step."}, {"owner": {"reputation": 73, "user_id": 5440599, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10153684626590763/picture?type=large", "display_name": "Matt Griffin", "link": "https://stackoverflow.com/users/5440599/matt-griffin"}, "edited": false, "score": 0, "creation_date": 1486026512, "post_id": 41975475, "comment_id": 71172678, "body": "I just used a range of T2:AW2 as I wanted to just test it out on one line before using it on the entire sheet. When I do want to use it on the entire sheet though, I shall be using a <code>LastRow</code> and <code>LastCol</code> variable as the dataset that I use can differ."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 73, "user_id": 5440599, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10153684626590763/picture?type=large", "display_name": "Matt Griffin", "link": "https://stackoverflow.com/users/5440599/matt-griffin"}, "edited": false, "score": 1, "creation_date": 1486026683, "post_id": 41975475, "comment_id": 71172812, "body": "I believe any error would because of the data-type in the cell not being able to be converted to hex i.e. it is not a decimal. The accepted answer solves this with the <code>IsNumeric</code> test so if you wanted to use my code example you should put that test in as well. Equally you could parameterize Han Soloane&#39;s code to accept a parameter rather than setting <code>myRange</code> in the code."}, {"owner": {"reputation": 73, "user_id": 5440599, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10153684626590763/picture?type=large", "display_name": "Matt Griffin", "link": "https://stackoverflow.com/users/5440599/matt-griffin"}, "edited": false, "score": 0, "creation_date": 1486029104, "post_id": 41975475, "comment_id": 71174448, "body": "It&#39;s ok Robin I&#39;ve fixed it. Turns out I was passing the wrong range. Though I may have to include the numerical check anyway as some of the cells are blanks. Thanks."}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": false, "score": 3, "last_activity_date": 1485939135, "creation_date": 1485939135, "answer_id": 41975475, "question_id": 41975001, "link": "https://stackoverflow.com/questions/41975001/how-to-convert-a-range-of-cells-from-dec-to-hex-in-excel/41975475#41975475", "title": "How to convert a range of cells from Dec to Hex in Excel", "body": "<p>You can use <code>Dec2Hex</code> in VBA through the <code>WorksheetFunction</code> class:</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\n    ConvertToHex Sheet1.Range(\"A1:A15\")\n\nEnd Sub\n\nSub ConvertToHex(rngData)\n\n    Dim rngCell As Range\n\n    For Each rngCell In rngData\n        rngCell.Value = WorksheetFunction.Dec2Hex(rngCell.Value)\n        rngCell.NumberFormat = \"@\" '&lt;-- tidies formatting of hex\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 862, "user_id": 3454860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d8d587bb86f0014ebfb3c1f208f074?s=128&d=identicon&r=PG&f=1", "display_name": "Han Soalone", "link": "https://stackoverflow.com/users/3454860/han-soalone"}, "reply_to_user": {"reputation": 73, "user_id": 5440599, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10153684626590763/picture?type=large", "display_name": "Matt Griffin", "link": "https://stackoverflow.com/users/5440599/matt-griffin"}, "edited": false, "score": 0, "creation_date": 1485975849, "post_id": 41975701, "comment_id": 71152826, "body": "@MattGriffin no problem, had time to kill ;)"}], "tags": [], "owner": {"reputation": 862, "user_id": 3454860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d8d587bb86f0014ebfb3c1f208f074?s=128&d=identicon&r=PG&f=1", "display_name": "Han Soalone", "link": "https://stackoverflow.com/users/3454860/han-soalone"}, "is_accepted": true, "score": 3, "last_activity_date": 1485939882, "creation_date": 1485939882, "answer_id": 41975701, "question_id": 41975001, "link": "https://stackoverflow.com/questions/41975001/how-to-convert-a-range-of-cells-from-dec-to-hex-in-excel/41975701#41975701", "title": "How to convert a range of cells from Dec to Hex in Excel", "body": "<p>One possible solution ->    </p>\n\n<pre><code>Sub convertRangeToHex() \nDim r As Range \nDim myRange As Range: Set myRange = Application.Selection 'define your range\n\nFor Each r In myRange\n    If IsNumeric(r.Value) Then\n        r.Value = \"0x\" &amp; WorksheetFunction.Dec2Hex(r.Value)\n    End If \nNext \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 5440599, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10153684626590763/picture?type=large", "display_name": "Matt Griffin", "link": "https://stackoverflow.com/users/5440599/matt-griffin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1812, "favorite_count": 0, "accepted_answer_id": 41975701, "answer_count": 2, "score": 2, "last_activity_date": 1485939882, "creation_date": 1485937524, "question_id": 41975001, "link": "https://stackoverflow.com/questions/41975001/how-to-convert-a-range-of-cells-from-dec-to-hex-in-excel", "title": "How to convert a range of cells from Dec to Hex in Excel", "body": "<p>I'm just wondering how I would go about converting a range of cells from decimal to hex without making the spreadsheet huge and very slow. I would also like to use VBA for it as it would be used for analysis.</p>\n\n<p>The way I have thought about doing this would be to convert the cells using the <code>DEC2HEX</code> formula and then hiding all the decimal cells but obviously this makes the spreadsheet quite large. If there is a way to just convert the values and replace those cells with the hex value, it would be very helpful.</p>\n\n<p>Any advice would be much appreciated. Thanks in advance.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "is_accepted": false, "score": 1, "last_activity_date": 1485937972, "creation_date": 1485937972, "answer_id": 41975118, "question_id": 41974996, "link": "https://stackoverflow.com/questions/41974996/saving-excel-sheet-as-pdf/41975118#41975118", "title": "Saving Excel Sheet as PDF", "body": "<p>Syntax error. The correct syntax is either</p>\n\n<pre><code>call Wsa.ExportAsFixedFormat(Type:=xlTypePDF,Filename:=myFile,...)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Wsa.ExportAsFixedFormat Type:=xlTypePDF,Filename:=myFile,...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7499186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8375cc49b402159ca43423f236a0b249?s=128&d=identicon&r=PG&f=1", "display_name": "Anne-Mette Nauerby", "link": "https://stackoverflow.com/users/7499186/anne-mette-nauerby"}, "edited": false, "score": 0, "creation_date": 1485944794, "post_id": 41975939, "comment_id": 71132328, "body": "This fixed the error message, but now when I run the macro, nothing at all happens."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 3, "user_id": 7499186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8375cc49b402159ca43423f236a0b249?s=128&d=identicon&r=PG&f=1", "display_name": "Anne-Mette Nauerby", "link": "https://stackoverflow.com/users/7499186/anne-mette-nauerby"}, "edited": false, "score": 0, "creation_date": 1485945778, "post_id": 41975939, "comment_id": 71133051, "body": "Do you get the <code>PDF file has been created:</code> Msgbox appear?"}, {"owner": {"reputation": 3, "user_id": 7499186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8375cc49b402159ca43423f236a0b249?s=128&d=identicon&r=PG&f=1", "display_name": "Anne-Mette Nauerby", "link": "https://stackoverflow.com/users/7499186/anne-mette-nauerby"}, "edited": false, "score": 0, "creation_date": 1485946123, "post_id": 41975939, "comment_id": 71133294, "body": "No. Nothing happens at all."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 3, "user_id": 7499186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8375cc49b402159ca43423f236a0b249?s=128&d=identicon&r=PG&f=1", "display_name": "Anne-Mette Nauerby", "link": "https://stackoverflow.com/users/7499186/anne-mette-nauerby"}, "edited": false, "score": 0, "creation_date": 1485949408, "post_id": 41975939, "comment_id": 71135377, "body": "Your mandatory fields checker isn&#39;t structured correctly. I&#39;ll alter my answer."}, {"owner": {"reputation": 3, "user_id": 7499186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8375cc49b402159ca43423f236a0b249?s=128&d=identicon&r=PG&f=1", "display_name": "Anne-Mette Nauerby", "link": "https://stackoverflow.com/users/7499186/anne-mette-nauerby"}, "edited": false, "score": 0, "creation_date": 1485950840, "post_id": 41975939, "comment_id": 71136345, "body": "Thanks, that did it :-)"}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 0, "last_activity_date": 1485949526, "last_edit_date": 1485949526, "creation_date": 1485940624, "answer_id": 41975939, "question_id": 41974996, "link": "https://stackoverflow.com/questions/41974996/saving-excel-sheet-as-pdf/41975939#41975939", "title": "Saving Excel Sheet as PDF", "body": "<p>Change your Export command to the following:</p>\n\n<pre><code>Wsa.ExportAsFixedFormat Type:=xlTypePDF, Filename:=myFile, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False\n</code></pre>\n\n<p>Also, you need to change your Mandatory field checks so each looks like:</p>\n\n<pre><code>If Range(\"B3\").Value = \"\" Then\n   MsgBox (\"Please fill in applicant\")\n   Exit Sub\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7499186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8375cc49b402159ca43423f236a0b249?s=128&d=identicon&r=PG&f=1", "display_name": "Anne-Mette Nauerby", "link": "https://stackoverflow.com/users/7499186/anne-mette-nauerby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 41975939, "answer_count": 2, "score": 0, "last_activity_date": 1485949526, "creation_date": 1485937509, "last_edit_date": 1531164843, "question_id": 41974996, "link": "https://stackoverflow.com/questions/41974996/saving-excel-sheet-as-pdf", "title": "Saving Excel Sheet as PDF", "body": "<p>Being an absolute VBA novice, I've pieced together some code that will run through an Excel sheet, checking everything's there, and then saving the sheet as a PDF file. I am, however, having some trouble with the saving part of the code. I keep getting the error \"Compile error: Expected:=\" to this line:</p>\n\n<pre><code>`Wsa.ExportAsFixedFormat(Type:=xlTypePDF,Filename:=myFile,Quality:=xlQualityStandard,IncludeDocProperties:=True,IgnorePrintAreas:=False, OpenAfterPublish:=False)\u00b4\n</code></pre>\n\n<p>Am I just being a complete n00b here?</p>\n\n<p>The whole thing looks like this:</p>\n\n<pre><code>Sub mcrSave()\n\nDim wsA As Worksheet\n\nDim wbA As Workbook\nDim strTime As String\nDim strName As String\nDim strPath As String\nDim strFile As String\nDim strPathFile As String\nDim myFile As Variant\nOn Error GoTo errHandler\n\n'Check for mandatory fields\nIf Range(\"B3\").Value = \"\" Then MsgBox (\"Please fill in applicant\")\nExit Sub\nIf Range(\"C1\").Value = \"\" Then MsgBox (\"Please fill in project title\")\nExit Sub\nIf Range(\"H3\").Value = \"\" Then MsgBox (\"Please fill in date of application\")\nExit Sub\nIf Range(\"C5\").Value = \"\" Then MsgBox (\"Please fill in expected cost\")\nExit Sub\nIf Range(\"C7\").Value = \"\" Then MsgBox (\"Please fill in time schedule\")\nExit Sub\nIf Range(\"B10\").Value = \"\" Then MsgBox (\"Please fill in project description\")\nExit Sub\nIf Range(\"B18\").Value = \"\" Then MsgBox (\"Please fill in potential benefits\")\nExit Sub\nIf Range(\"B26\").Value = \"\" Then MsgBox (\"Please fill in potential drawbacks\")\nExit Sub\nIf Range(\"B34\").Value = \"\" Then MsgBox (\"Please fill in internal/external ressources\")\nExit Sub\n\n\n\nSet wbA = ActiveWorkbook\nSet wsA = ActiveSheet\nstrTime = Format(Now(), \"yyyymmdd\\_hhmm\")\n\n'get active workbook folder, if saved\nstrPath = wbA.Path\nIf strPath = \"\" Then\n  strPath = Application.DefaultFilePath\nEnd If\nstrPath = strPath &amp; \"\\\"\n\n'replace spaces and periods in sheet name\nstrName = Replace(wsA.Name, \" \", \"\")\nstrName = Replace(strName, \".\", \"_\")\n\n'create default name for savng file\nstrFile = strName &amp; \"_\" &amp; strTime &amp; \".pdf\"\nstrPathFile = strPath &amp; strFile\n\n'use can enter name and\n' select folder for file\nmyFile = Application.GetSaveAsFilename(InitialFileName:=strPathFile, FileFilter:=\"PDF Files (*.pdf), *.pdf\", Title:=\"Select Folder and FileName to save\")\n\n'export to PDF if a folder was selected\nIf myFile &lt;&gt; \"False\" Then\n    Wsa.ExportAsFixedFormat(Type:=xlTypePDF,Filename:=myFile,Quality:=xlQualityStandard,IncludeDocProperties:=True,IgnorePrintAreas:=False, OpenAfterPublish:=False)\n    'confirmation message with file info\n    MsgBox \"PDF file has been created: \" &amp; vbCrLf &amp; myFile\nEnd If\n\nexitHandler:\n    Exit Sub\nerrHandler:\n    MsgBox \"Could not create PDF file\"\n    Resume exitHandler\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1485935563, "post_id": 41974438, "comment_id": 71126861, "body": "starts by removing the <code>Select</code> and <code>Selection</code>, and modify the Ranges directly"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 1, "creation_date": 1485935599, "post_id": 41974438, "comment_id": 71126885, "body": "If you search for anything on this topic you will always find a suggestion of turning off screen updating. Why don&#39;t you try searching google first"}, {"owner": {"reputation": 862, "user_id": 3454860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d8d587bb86f0014ebfb3c1f208f074?s=128&d=identicon&r=PG&f=1", "display_name": "Han Soalone", "link": "https://stackoverflow.com/users/3454860/han-soalone"}, "edited": false, "score": 0, "creation_date": 1485935845, "post_id": 41974438, "comment_id": 71127008, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/13016249/how-to-improve-the-speed-of-vba-macro-code\">How to improve the speed of VBA macro code?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 7480128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c69a5513dafec3ce56b4eee88a303ca?s=128&d=identicon&r=PG&f=1", "display_name": "senget", "link": "https://stackoverflow.com/users/7480128/senget"}, "edited": false, "score": 0, "creation_date": 1485945504, "post_id": 41974606, "comment_id": 71132848, "body": "Thank you Sir, for taking time and helping me to find a solution. Its very helpfull"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 6, "last_activity_date": 1485935924, "creation_date": 1485935924, "answer_id": 41974606, "question_id": 41974438, "link": "https://stackoverflow.com/questions/41974438/improve-performance-with-vba-selection-autofill/41974606#41974606", "title": "Improve performance with VBA Selection.AutoFill", "body": "<p>This will be faster :</p>\n\n<pre><code>Sub RMS()\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n        .Calculation = xlCalculationManual\n    End With\n\n    With Sheets(\"m1\")\n        .Range(\"A3\").FormulaR1C1 = \"=LEN(LEFT(m!R[2]C,FIND(\"\"x\"\",m!R[2]C &amp; \"\",\"\")-1))\"\n        .Range(\"A1:A3\").AutoFill Destination:=.Range(\"A1:EZ3\"), Type:=xlFillDefault\n        .Range(\"A1:EZ3\").AutoFill Destination:=.Range(\"A1:EZ600\"), Type:=xlFillDefault\n    End With\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = xlCalculationAutomatic\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 7480128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c69a5513dafec3ce56b4eee88a303ca?s=128&d=identicon&r=PG&f=1", "display_name": "senget", "link": "https://stackoverflow.com/users/7480128/senget"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 792, "favorite_count": 0, "accepted_answer_id": 41974606, "answer_count": 1, "score": 3, "last_activity_date": 1588975428, "creation_date": 1485935215, "last_edit_date": 1485960361, "question_id": 41974438, "link": "https://stackoverflow.com/questions/41974438/improve-performance-with-vba-selection-autofill", "title": "Improve performance with VBA Selection.AutoFill", "body": "<p>I have code like the following:</p>\n\n<pre><code>Sub RMS()\n    Application.Calculation = xlCalculationManual\n    Sheets(\"m1\").Range(\"A3\").FormulaR1C1 = \"=LEN(LEFT(m!R[2]C,FIND(\"\"x\"\",m!R[2]C &amp; \"\",\"\")-1))\"\n    Range(\"A1:A3\").Select\n    Selection.AutoFill Destination:=Range(\"A1:EZ3\"), Type:=xlFillDefault\n    Range(\"A1:EZ3\").Select\n    Selection.AutoFill Destination:=Range(\"A1:EZ600\"), Type:=xlFillDefault\n    Range(\"A1:EZ600\").Select\nEnd Sub\n</code></pre>\n\n<p>This code is running very slow. Is there any help you can give so that code like this could run much faster because I run this code in multiple sheets?</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1485934137, "post_id": 41972999, "comment_id": 71126216, "body": "The function works for me - returns 0.466079 in both Excel and in VBA.  (Hopefully that&#39;s the correct number - at least it is consistent.)  Have you checked that <code>IRRValues</code> and <code>RepayDates</code> have both been set up correctly?  Maybe paste into the question a copy of your code that shows how they have been created, plus the Excel formula that you are using to check against."}, {"owner": {"reputation": 95, "user_id": 3026559, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/6jr0c.jpg?s=128&g=1", "display_name": "yatsky", "link": "https://stackoverflow.com/users/3026559/yatsky"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1485990506, "post_id": 41972999, "comment_id": 71160150, "body": "@YowE3K, yes that&#39;s the answer. the <code>IRRValues</code> and <code>RepayDates</code> are set up correctly because I even tried to write their data to the worksheet and then calculate the XIRR and it worked. I&#39;ll try today and see what&#39;s wrong."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1485994156, "post_id": 41972999, "comment_id": 71161333, "body": "Just because you could write the values out to Excel and it then worked there does <b>not</b> mean that they are correct in the arrays - it just means that the translations being performed as the arrays are being populated are being reversed correctly as the arrays are written back to Excel."}], "answers": [{"tags": [], "owner": {"reputation": 95, "user_id": 3026559, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/6jr0c.jpg?s=128&g=1", "display_name": "yatsky", "link": "https://stackoverflow.com/users/3026559/yatsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1486519633, "creation_date": 1486519633, "answer_id": 42103464, "question_id": 41972999, "link": "https://stackoverflow.com/questions/41972999/excel-worksheetfunction-xirr-and-xirr-gave-different-answers-from-same-input/42103464#42103464", "title": "Excel WorksheetFunction.XIRR and XIRR gave different answers from same input", "body": "<p>Problem resolved!\nI thought the array starts at index 1 but it actually starts at 0!</p>\n"}], "owner": {"reputation": 95, "user_id": 3026559, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/6jr0c.jpg?s=128&g=1", "display_name": "yatsky", "link": "https://stackoverflow.com/users/3026559/yatsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 305, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1486519633, "creation_date": 1485929293, "last_edit_date": 1531164843, "question_id": 41972999, "link": "https://stackoverflow.com/questions/41972999/excel-worksheetfunction-xirr-and-xirr-gave-different-answers-from-same-input", "title": "Excel WorksheetFunction.XIRR and XIRR gave different answers from same input", "body": "<p>I'm trying to do a project using VBA to complete an XIRR calculation. Parts of the code is as follows.</p>\n\n<p><code>Range(\"J3\").Value = WorksheetFunction.IRR(IRRValues())\nRange(\"J2\").Value = Application.WorksheetFunction.Xirr(IRRValues(), RepayDates())</code></p>\n\n<p><code>IRRValues()</code> is an array that contains every repayment that client makes and <code>RepayDates()</code> is an array that contains the corresponding dates of every repayment. </p>\n\n<p><code>IRRValues</code> starts with a negative number as the first cash out. But every time when I ran the VBA <code>WorksheetFunction.XIRR</code>, it gave me a number that's effectively 0. However, if I ran the same data in the worksheet using <code>=XIRR</code>, then it gave me another answer. And the <code>WorksheetFunction.IRR</code> works well. I've tried to change my local setting to \"US\" so date format is correct (mm/dd/yyyy). </p>\n\n<p>Data is like the following and runs to 06/19/2012 with constant repayment of $87.35.</p>\n\n<p>-4000   07/07/2009</p>\n\n<p>$87.35  07/21/2009</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "graph", "vba"], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 7191500, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2FDjM.jpg?s=128&g=1", "display_name": "jmeddy", "link": "https://stackoverflow.com/users/7191500/jmeddy"}, "edited": false, "score": 0, "creation_date": 1486009667, "post_id": 41973644, "comment_id": 71165356, "body": "Hi Shai, thanks for the reply. I should&#39;ve have added the fact that the date/time is not only in Column AA but in every fifth column starting from AA. Can a similiar SerRng be used to define the different date/tiem columns or will this also show up as a number or incorrect date/time? This is very clean though, I&#39;ve picked a few very helpful pointers here."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 109, "user_id": 7191500, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2FDjM.jpg?s=128&g=1", "display_name": "jmeddy", "link": "https://stackoverflow.com/users/7191500/jmeddy"}, "edited": false, "score": 0, "creation_date": 1486013871, "post_id": 41973644, "comment_id": 71166597, "body": "@jmeddy if you could edit your post, share  a sample fo your chart, and where is the data taken from, I think I could understand better what you mean and trying to achieve"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1485932015, "creation_date": 1485932015, "answer_id": 41973644, "question_id": 41972951, "link": "https://stackoverflow.com/questions/41972951/activechart-seriescollection1-xvalues-not-showing-dates/41973644#41973644", "title": "ActiveChart.SeriesCollection(1).XValues not showing Dates", "body": "<p>First you should try setting your <code>ActiveSheet.ChartObjects(\"Location\" &amp; i &amp; \"_1\")</code> object to a <code>ChartObject</code>, and there is no need to use <code>Activate</code> to modify the chart. </p>\n\n<p>You could loop thourgh all <code>SeriesCollection</code> in your <code>ChartObject</code>, by using <code>For j= 1 To .Chart.SeriesCollection.Count</code>.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub AutoChartTest()\n\nDim ChtObj As ChartObject\nDim Ser As SeriesCollection\nDim SerRng  As Range\nDim j As Long, i As Long, RowCount1 As Long\n\n' set the chart object\nSet ChtObj = ActiveSheet.ChartObjects(\"Location\" &amp; i &amp; \"_1\")\n\nWith ChtObj '&lt;-- modify properties of the chart object (without Activating it)\n    For j = 1 To .Chart.SeriesCollection.Count ' &lt;-- loop through all series collections\n        Set SerRng = Range(\"AC1\").Offset(, j - 1)\n\n        .Chart.SeriesCollection(j).Name = \"=\" &amp; \"Location\" &amp; i &amp; \"!\" &amp; SerRng.Address\n        .Chart.SeriesCollection(j).XValues = \"=\" &amp; \"Location\" &amp; i &amp; \"!$AA$1:$AA$\" &amp; RowCount1\n        .Chart.SeriesCollection(j).Values = \"=\" &amp; \"Location\" &amp; i &amp; \"!\" &amp; SerRng.Address &amp; \":$AC$\" &amp; RowCount1\n    Next j\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 7191500, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2FDjM.jpg?s=128&g=1", "display_name": "jmeddy", "link": "https://stackoverflow.com/users/7191500/jmeddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2910, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485932015, "creation_date": 1485929041, "last_edit_date": 1531164843, "question_id": 41972951, "link": "https://stackoverflow.com/questions/41972951/activechart-seriescollection1-xvalues-not-showing-dates", "title": "ActiveChart.SeriesCollection(1).XValues not showing Dates", "body": "<p>I have a worksheet \"Tracker\" with 36 Scatter graphs. The same worksheet contains 12 sets of data, each set containing 3 variables that need to be graphed wrt to the associated date/time. I've named them in such a way that creating a loop is possible to make the code cleaner.</p>\n\n<p>Here's the problem: This works great but the Horizontal Axes of all the charts are not representing the actual values. <code>={\"1/10/2017  12:11:03 PM\",\"1/10/2017  12:11:06 PM\",\"1/10/2017  12:11:09 PM\",\"1/10/2017  12:11:12 PM\",\"1/10/2017  12:11:15 PM\",\"1/10/2017  12:11:19 PM\",\"1/10/2017  12:11:22 PM\",\"1/10/2017  12:11:25 PM\",\"1/10/2017  12:11:28 PM\",\"1/10/2017  12:11:31 PM\"}</code></p>\n\n<p>Above is what the XValues series shows when you go to Select Data, but the chart shows 1/0/00, 1/1/00, 1/2/00, and so for the X values.. I made sure that the date columns are formatted with a date/time format.\nHere's the code:</p>\n\n<pre><code>    For i = 1 To 12\n    k = (i * 4) + 49\n    RowCount = ThisWorkbook.Sheets(\"Tracker\").Cells(1, k).Offset(Sheets(\"Tracker\").Rows.Count - 1, 0).End(xlUp).Row\n    ActiveSheet.ChartObjects(\"Location\" &amp; i &amp; \"_1\").Activate\n    ActiveChart.SeriesCollection(1).Name = Worksheets(\"Tracker\").Cells(1, k + 2).Value\n    **ActiveChart.SeriesCollection(1).XValues = Worksheets(\"Tracker\").Range(Cells(2, k), Cells(RowCount, k)).Value**\n    ActiveChart.SeriesCollection(1).Values = Worksheets(\"Tracker\").Range(Cells(2, k + 2), Cells(RowCount, k + 2)).Value\n    ActiveChart.SeriesCollection(2).Name = Worksheets(\"Tracker\").Cells(1, k + 3).Value\n    **ActiveChart.SeriesCollection(2).XValues = Worksheets(\"Tracker\").Range(Cells(2, k), Cells(RowCount, k)).Value**\n    ActiveChart.SeriesCollection(2).Values = Worksheets(\"Tracker\").Range(Cells(2, k + 3), Cells(RowCount, k + 3)).Value\n\n    ActiveSheet.ChartObjects(\"Location\" &amp; i &amp; \"_2\").Activate\n    ActiveChart.SeriesCollection(1).Name = Worksheets(\"Tracker\").Cells(1, k + 1).Value\n    **ActiveChart.SeriesCollection(1).XValues = Worksheets(\"Tracker\").Range(Cells(2, k), Cells(RowCount, k)).Value**\n    ActiveChart.SeriesCollection(1).Values = Worksheets(\"Tracker\").Range(Cells(2, k + 1), Cells(RowCount, k + 2)).Value\n\n    l = (i * 2) + 102\n    RowCount1 = ThisWorkbook.Sheets(\"Tracker\").Cells(1, l).Offset(Sheets(\"Tracker\").Rows.Count - 1, 0).End(xlUp).Row\n    ActiveSheet.ChartObjects(\"Location\" &amp; i &amp; \"_3\").Activate\n    ActiveChart.SeriesCollection(1).Name = Worksheets(\"Tracker\").Cells(1, l + 1).Value\n    **ActiveChart.SeriesCollection(1).XValues = Worksheets(\"Tracker\").Range(Cells(2, l), Cells(RowCount1, l)).Value**\n    ActiveChart.SeriesCollection(1).Values = Worksheets(\"Tracker\").Range(Cells(2, l + 1), Cells(RowCount1, l + 2)).Value\n\n    Next i\n</code></pre>\n\n<p>When I hover over the data points on the graph, the date shows in the text, but it seems like it is plotting the Y value with numbers starting at 1 and not utlizing the date/time at all.</p>\n\n<p>In the past, I've just written each graph out with the associated series, but since there are 36 graphs, I don;t want to have to do this for each - that's crazy.\nUsing this I have no issues:</p>\n\n<pre><code>    ActiveChart.SeriesCollection(1).Name = \"=\" &amp; \"Location\" &amp; i &amp; \"!$AC$1\"\n    ActiveChart.SeriesCollection(1).XValues = \"=\" &amp; \"Location\" &amp; i &amp; \"!$AA$1:$AA$\" &amp; RowCount1\n    ActiveChart.SeriesCollection(1).Values = \"=\" &amp; \"Location\" &amp; i &amp; \"!$AC$1:$AC$\" &amp; RowCount1\n    ActiveChart.SeriesCollection(2).Name = \"=\" &amp; \"Location\" &amp; i &amp; \"!$AD$1\"\n    ActiveChart.SeriesCollection(2).XValues = \"=\" &amp; \"Location\" &amp; i &amp; \"!$AA$1:$AA$\" &amp; RowCount1\n    ActiveChart.SeriesCollection(2).Values = \"=\" &amp; \"Location\" &amp; i &amp; \"!$AD$1:$AD$\" &amp; RowCount1\n</code></pre>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["vba", "excel", "date"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 1445013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bfdc04b11992e5c325b6df45732689c?s=128&d=identicon&r=PG", "display_name": "tbozeglav", "link": "https://stackoverflow.com/users/1445013/tbozeglav"}, "edited": false, "score": 0, "creation_date": 1485959112, "post_id": 41973679, "comment_id": 71141989, "body": "This appears to be working... I am curious how though - the IFERROR function as I&#39;ve come to understand it simply returns the value of D2 when the VLOOKUP doesn&#39;t return a valid value. That would normally mean that anytime the date used in the VLOOKUP is between those listed in the table, the only value I&#39;d get in return is that of D2 but that doesn&#39;t appear to be the case."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 1, "user_id": 1445013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bfdc04b11992e5c325b6df45732689c?s=128&d=identicon&r=PG", "display_name": "tbozeglav", "link": "https://stackoverflow.com/users/1445013/tbozeglav"}, "edited": false, "score": 0, "creation_date": 1485959671, "post_id": 41973679, "comment_id": 71142379, "body": "The 4th parameter of VLookup is set to TRUE which tells Excel not to look for an exact match (As FALSE would do). See MSDN documentation for further details. Since I solved your question you may want to mark answer as accepted. Thank you!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1485932122, "creation_date": 1485932122, "answer_id": 41973679, "question_id": 41972403, "link": "https://stackoverflow.com/questions/41972403/excel-formula-to-return-value-on-closest-or-equal-date/41973679#41973679", "title": "Excel Formula to Return Value on Closest or Equal Date", "body": "<p>I'd use</p>\n\n<pre><code>=IFERROR(VLOOKUP(E2,A:D,4,TRUE),D2)\n</code></pre>\n\n<p>so that should your date fall before the lowest in column A it'd return the first value of column D (i.e. the value in D2 cell)</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 1445013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bfdc04b11992e5c325b6df45732689c?s=128&d=identicon&r=PG", "display_name": "tbozeglav", "link": "https://stackoverflow.com/users/1445013/tbozeglav"}, "edited": false, "score": 0, "creation_date": 1485958658, "post_id": 41974075, "comment_id": 71141671, "body": "Here is the formula as you suggested. However when it&#39;s showing as an invalid INDEX MATCH function call thus breaking the formula. Can you provide any suggestions to correct it?         <code>=IFERROR(INDEX MATCH(TODAY(),A:D),D2)</code>"}, {"owner": {"reputation": 58, "user_id": 7491234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d12825bdda14c356c67c74f7e823fa2?s=128&d=identicon&r=PG&f=1", "display_name": "Bing", "link": "https://stackoverflow.com/users/7491234/bing"}, "reply_to_user": {"reputation": 1, "user_id": 1445013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bfdc04b11992e5c325b6df45732689c?s=128&d=identicon&r=PG", "display_name": "tbozeglav", "link": "https://stackoverflow.com/users/1445013/tbozeglav"}, "edited": false, "score": 0, "creation_date": 1485987793, "post_id": 41974075, "comment_id": 71159060, "body": "The purpose of the IFERROR is to display something instead of NA or ERROR. The way it works is:  =IFERROR(formula you want to use , formula or value you want instead of NA or ERROR). INDEX MATCH is set up differently to VLOOKUP so you cannot follow the same string: =INDEX(D:D,MATCH(TODAY(),A:A,0)) You should be able to work out what each bit means except the 0 at the end. This can be a -1, 0 or 1. Excel should tell you what these mean. The formula I would use would be: =IFERROR(INDEX(D:D,MATCH(TODAY(),A;A,0)),INDEX(D:D,MATCH(TOD&zwnj;&#8203;AY(),A:A,-1)))"}], "tags": [], "owner": {"reputation": 58, "user_id": 7491234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d12825bdda14c356c67c74f7e823fa2?s=128&d=identicon&r=PG&f=1", "display_name": "Bing", "link": "https://stackoverflow.com/users/7491234/bing"}, "is_accepted": false, "score": 0, "last_activity_date": 1485933721, "creation_date": 1485933721, "answer_id": 41974075, "question_id": 41972403, "link": "https://stackoverflow.com/questions/41972403/excel-formula-to-return-value-on-closest-or-equal-date/41974075#41974075", "title": "Excel Formula to Return Value on Closest or Equal Date", "body": "<p>Use INDEX MATCH instead of VLOOKUP within the IFERROR already suggested above.</p>\n"}], "owner": {"reputation": 1, "user_id": 1445013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bfdc04b11992e5c325b6df45732689c?s=128&d=identicon&r=PG", "display_name": "tbozeglav", "link": "https://stackoverflow.com/users/1445013/tbozeglav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 446, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1485933721, "creation_date": 1485926394, "question_id": 41972403, "link": "https://stackoverflow.com/questions/41972403/excel-formula-to-return-value-on-closest-or-equal-date", "title": "Excel Formula to Return Value on Closest or Equal Date", "body": "<p>I'm working on an excel formula that will reference a table on a different worksheet in the same workbook and return a value based on the current date. Thus far I have been able to use this formula to return the value as I am intending. I've included an example table for the formula to show the methodology. </p>\n\n<p><a href=\"https://i.stack.imgur.com/ThwL0.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/ThwL0.png</a></p>\n\n<pre><code>=VLOOKUP(TODAY(),TRANSACTIONS!A:D,4,FALSE)\n</code></pre>\n\n<p>While this works, the flaw is that it will return #N/A if there are no lines which have an exact matching date. In the case of the above table, the transactions don't occur daily so if the given date returned by TODAY() doesn't match any line in the shown table, it breaks the formula. My table also contains \"planned\" or \"expected\" transactions which exist into the future meaning I can't rely on the MAX() function to provide the correct result</p>\n\n<p>With that said, I am looking for a tweak to this formula that will always return a value even if the current date doesn't match any rows exactly. Using the above image as a reference, if the date returned by TODAY() were to be 2/20/17, the result it should give should be the value in D5, 1566. Conversely if the date is 2/28/17, it should return the value in D7, 1182. </p>\n\n<p>Open to any an all suggestions which will achieve these results. Let me know if you need any further clarification. Thanks! </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 4, "creation_date": 1485925666, "post_id": 41972118, "comment_id": 71122779, "body": "You&#39;re missing concats: <code>&quot;Chr(num2) &amp; 1 &amp; &quot;:&quot; &amp; Chr(num2) &amp; 4&quot;</code>.  But seriously, don&#39;t do this - use <code>.Cells</code> and numeric indexes instead.  You&#39;re doing a ton of parsing that Excel is just going to reverse on the other side of the <code>Range</code> call."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1485926250, "post_id": 41972118, "comment_id": 71122966, "body": "Also, why do you &quot;need&quot; to use <code>.Select</code>? It&#39;s best to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">avoid using <code>.Select</code>/<code>.Activate</code></a> whenever possible.  Also, with @Comintern&#39;s point, can you expand on your main task/issue? It sounds like we may have an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY Problem</a>"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1485935458, "post_id": 41972118, "comment_id": 71126806, "body": "@Comintern too much <code>&quot;</code> in your correction. <code>Chr(num2) &amp; 1 &amp; &quot;:&quot; &amp; Chr(num2) &amp; 4</code> or <code>Chr(num2) &amp; &quot;1:&quot; &amp; Chr(num2) &amp; &quot;4&quot;</code> should work better. But yes, better use indexes."}], "answers": [{"tags": [], "owner": {"reputation": 1337, "user_id": 2999781, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kYD9I.gif?s=128&g=1", "display_name": "Jiminy Cricket", "link": "https://stackoverflow.com/users/2999781/jiminy-cricket"}, "is_accepted": false, "score": 0, "last_activity_date": 1485938851, "creation_date": 1485938851, "answer_id": 41975387, "question_id": 41972118, "link": "https://stackoverflow.com/questions/41972118/how-to-select-range-using-chr/41975387#41975387", "title": "How to select Range using Chr", "body": "<p>It doesn't work because of incorrect concatenation. I'd recommend storing the range string as a separate variable to help you debug as so:</p>\n\n<pre><code>Sub Test()\nDim num2 As Integer\nDim strRange As String\n\n    num2 = 69\n    'Store range string as a variable\n    strRange = Chr(num2) &amp; \"1:\" &amp; Chr(num2) &amp; \"4\"\n    'Pass the variable into the Range function\n    Range(strRange).Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7440066, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c0c0ff891d833438b328df9987193120?s=128&d=identicon&r=PG&f=1", "display_name": "user7440066", "link": "https://stackoverflow.com/users/7440066/user7440066"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 538, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485938851, "creation_date": 1485924599, "question_id": 41972118, "link": "https://stackoverflow.com/questions/41972118/how-to-select-range-using-chr", "title": "How to select Range using Chr", "body": "<p>I need to select the cells \"E1 to E4\" using the <code>Chr</code> function.</p>\n\n<p>I have been trying to use the following lines of code, but there is some problem with it and the code does not compile.</p>\n\n<p>It is giving the run time error '1004' : Method 'Range' of object '_Global' failed.</p>\n\n<pre><code>Dim num2 As Integer\nnum2 = 69\nRange(\"Chr(num2) &amp; 1 : Chr(num2) &amp; 4\").Select\n</code></pre>\n\n<p>Please help. Thanks :)</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 35470, "user_id": 6348498, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/0zu4m.jpg?s=128&g=1", "display_name": "Gurwinder Singh", "link": "https://stackoverflow.com/users/6348498/gurwinder-singh"}, "is_accepted": true, "score": 1, "last_activity_date": 1485922558, "creation_date": 1485922558, "answer_id": 41971795, "question_id": 41971628, "link": "https://stackoverflow.com/questions/41971628/update-rows-with-min-value-in-a-group-on-ms-access/41971795#41971795", "title": "Update rows with min value in a group on MS ACCESS", "body": "<p>In access, you can't use aggregates in update statement because it'll produce the below error:</p>\n\n<blockquote>\n  <p>Operation must use an updatable query.</p>\n</blockquote>\n\n<p>Instead use simple self join to find the row with min Hierarchy for each id and then do the update.</p>\n\n<p>Try this:</p>\n\n<pre><code>UPDATE [EmployeeMaster] t\nleft join [EmployeeMaster] s\non t.[ID] = s.[ID] and t.[Hierarchy] &gt; s.[Hierarchy]\nSET t.[Flag] = 'Yes'\nwhere s.[ID] is null\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 1688194, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5feca08c0a5a01def553f24a177c59dd?s=128&d=identicon&r=PG", "display_name": "user-DY", "link": "https://stackoverflow.com/users/1688194/user-dy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 0, "accepted_answer_id": 41971795, "answer_count": 1, "score": 2, "last_activity_date": 1593954121, "creation_date": 1485921423, "last_edit_date": 1593954121, "question_id": 41971628, "link": "https://stackoverflow.com/questions/41971628/update-rows-with-min-value-in-a-group-on-ms-access", "title": "Update rows with min value in a group on MS ACCESS", "body": "<p>I have the following statement for Select. Value of the [Flag] has been defaulted to 'No'</p>\n\n<pre><code>select t.[Id], t.[Name], t.[NRIC], t.[Flag], t.[Hierarchy], t.[LoadDt] \nfrom [EmployeeMaster] t\ninner join (\nselect ID, LoadDt, Min(Hierarchy) As MinHierarchy\nfrom [EmployeeMaster]\ngroup by ID, LoadDt\n) s on t.[ID] = s.[ID] and t.[Hierarchy] = s.[MinHierarchy]\n</code></pre>\n\n<p>After this, i need to update all the results of the above select statement with a </p>\n\n<pre><code>update [EmployeeMaster] set [EmployeeMaster].[Flag] = 'Yes'\n</code></pre>\n\n<p>How can i combine this into 1 query in MS ACCSS VBA script? </p>\n\n<p>Basically what i wanted to achieve is that given an example of the following EmployeeMaster table:</p>\n\n<pre><code>ID | Name | NRIC | Flag | Hierarchy | LoadDt \n001| ABCD | ZZZZ |  NO  |     6     | 31/1/2017 \n001| ABCD | ZZZZ |  NO  |     5     | 31/1/2017 \n001| ABCD | ZZZZ |  NO  |     1     | 31/1/2017 \n002| WXYZ | YYYY |  NO  |     9     | 31/1/2017 \n002| WXYZ | YYYY |  NO  |     8     | 31/1/2017 \n</code></pre>\n\n<p>I want to be able to achieve the output of: </p>\n\n<pre><code>ID | Name | NRIC | Flag | Hierarchy | LoadDt\n001| ABCD | ZZZZ |  NO  |     6     | 31/1/2017 \n001| ABCD | ZZZZ |  NO  |     5     | 31/1/2017\n001| ABCD | ZZZZ |  Yes |     1     | 31/1/2017\n002| WXYZ | YYYY |  NO  |     9     | 31/1/2017\n002| WXYZ | YYYY |  Yes |     8     | 31/1/2017\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1485919673, "post_id": 41971368, "comment_id": 71121103, "body": "BTW: Effect seems to become more pronounced the more times the loop is run, although that might just be my imagination."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1485921007, "post_id": 41971368, "comment_id": 71121414, "body": "Interesting. I can&#39;t replicate (with Word 2010 on 64-bit Windows 7)."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1485921101, "post_id": 41971368, "comment_id": 71121443, "body": "@JohnColeman I&#39;m jealous what&#39;s your environment? (wow that was quick)"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 4, "creation_date": 1485921188, "post_id": 41971368, "comment_id": 71121466, "body": "I was in the process of adding the environment when you asked about it. I&#39;m the one that is jealous. My IDE seems boring in comparison :)"}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1485921738, "post_id": 41971368, "comment_id": 71121609, "body": "@JohnColeman I have just tried in Win 7 (64), Word 7 (32) and can report the result was satisfyingly boring...  seems like a Windows issue?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1485921979, "post_id": 41971368, "comment_id": 71121678, "body": "Sounds like a Windows issue. If I had to guess, it probably has something to do with Window&#39;s move towards a Unicode world. Exactly how, I have absolutely no idea."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1485921992, "post_id": 41971368, "comment_id": 71121683, "body": "@Mat&#39;sMug - mate... first thing I did was disable RD!  But, it has been repo&#39;d on 3 different machines....  Happy to say RD was innocent :-D"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 1, "creation_date": 1485922198, "post_id": 41971368, "comment_id": 71121727, "body": "any common add-in? seems like they might share some common corrupted component. You can also try <code>Debug.Print VBA.vbCr</code> just in case"}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1485922456, "post_id": 41971368, "comment_id": 71121784, "body": "@Slai Thanks for your interest. No. No common addins; in fact for the most part the VMs are basically clean machines that I use for testing.  As per comment above I disabled RD (RubberDuck for VBA) and a few other VBA IDE addins but that was on my main PC.  I also rebooted and problem persisted."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1485923180, "post_id": 41971368, "comment_id": 71121992, "body": "@Slai Good idea, tried VBA.vbCr and got the same result - but this time on a new VM: Win10, Word10 (64-bit)"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1485935922, "post_id": 41971368, "comment_id": 71127035, "body": "Tried on Office 2016 365, Windows 10, got some <code>8(&#228;BwAjc</code> as a result."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 3, "creation_date": 1485936088, "post_id": 41971368, "comment_id": 71127105, "body": "Tried <code>Debug.Print Chr(13)</code> with the same result, but <code>Debug.Print Chr$(13)</code>is working fine?"}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1485945617, "post_id": 41971368, "comment_id": 71132924, "body": "@VincentG - nice suggestion.  I just tried Chr$(13) and I still get the junk... :-/"}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 1, "creation_date": 1485956343, "post_id": 41971368, "comment_id": 71140019, "body": "I&#39;m Windows 10 Word 2007 (32 bit) and I get  <code>eeeeee  &#165;&#252;Ve.</code> amongst a whole load of other junk. Seeing as <code>Debug.Print vbCrLF</code> works fine, I&#39;d be interested to know what happens on a genuine Mac OS.."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 1, "creation_date": 1485962611, "post_id": 41971368, "comment_id": 71144459, "body": "can&#39;t reproduce on Win 7 (64), Word 2007 (32), so I blame it on the VBA 7. I even tried changing to different mono-space fonts."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1485982367, "post_id": 41971368, "comment_id": 71156338, "body": "@Ambie - thanks for sharing :-)  I&#39;ve a mate with Mac OS so might hit him up for a test..."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 1, "creation_date": 1485982412, "post_id": 41971368, "comment_id": 71156368, "body": "@Slai - I <i>think</i> a pattern is emerging... and Win10 is strongly implicated!"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1485982698, "post_id": 41971368, "comment_id": 71156554, "body": "No-repro: Win7 (64), Word 2003 (32); Win 8.1 (64), Word 2016 (32); WinXP (32), Word 2010 (32)."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1485983420, "post_id": 41971368, "comment_id": 71156957, "body": "@GSerg LOL WinXP - love it! Thanks will update :-)"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 1, "creation_date": 1485984269, "post_id": 41971368, "comment_id": 71157344, "body": "Win 10 (64), Word XP is a repro but different characters, and different characters <i>each</i> time. Win 10 (64) Excel XP is a repro, but all lines show <i>only</i> <code>&#189;s</code>, or <i>only</i> <code>&#189;s</code> and <code>V</code>, or sometimes no repro."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1485984471, "post_id": 41971368, "comment_id": 71157449, "body": "@ThunderFrame I&#39;m getting different characters each time I run this, I&#39;ll make this more clear...  thanks for confirming. Really looks like a Win10 thing"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 1, "creation_date": 1485985212, "post_id": 41971368, "comment_id": 71157779, "body": "Interesting, if I use <code>Debug.Print vbCr;</code> there is no repro. If I use <code>Debug.Print vbCr; vbCr</code>, then <i>many</i> but not <i>all</i> outputs are <code>v</code> or <code>Cr</code>, which suggests a size, offset or null-terminator is out of whack."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1485985432, "post_id": 41971368, "comment_id": 71157880, "body": "@ThunderFrame I just tried <code>debug.print vbcr;</code> and got this: <code>$&#224;.&#170;$\u2020&#182;3@\u02c6</code>  but the output was MUCH cleaner than before... only a little bit of junk"}, {"owner": {"reputation": 10875, "user_id": 2392157, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QEWAU.png?s=128&g=1", "display_name": "miroxlav", "link": "https://stackoverflow.com/users/2392157/miroxlav"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1485986272, "post_id": 41971368, "comment_id": 71158294, "body": "@GSerg - Repro: Win8.1 (64) Word 2013. Output garbage randomly varies if run multiple times."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1485987647, "post_id": 41971368, "comment_id": 71158981, "body": "With a Win10x64 (En) + Office 2007 (x86), both Word and Excel do reproduce similar symptom, however not all lines are gibberish, and sometimes it prints a few characters of my code. But if <code>Debug.Print i &amp; vbCr</code>, it&#39;s clean! Temporary solution is to use <code>vbLf</code> or <code>vbCrLf</code> instead, they don&#39;t reproduce this symptom."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 2, "creation_date": 1485987928, "post_id": 41971368, "comment_id": 71159124, "body": "@GSerg - I&#39;m unsure which is more desperate: using Office 2010 in Windows XP, or Office XP in Windows 10. ;-)"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1486040330, "post_id": 41971368, "comment_id": 71181921, "body": "I stand corrected. Repro on Win 8.1 (64), Office 2016 (32). It just happened so that it looked normal when I tried it a couple of times. Tried five times in a row and it happened. And then it started happening easier (happens straight away after restarting Word/Excel)."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1486040644, "post_id": 41971368, "comment_id": 71182100, "body": "@GSerg awww man you had me all excited... how sad is that?  will amend [oh you did, thanks :-)]"}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1487433576, "post_id": 41971368, "comment_id": 71787965, "body": "I will only use <code>vbNewLine</code>."}], "answers": [{"comments": [{"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1489055827, "post_id": 41990217, "comment_id": 72508388, "body": "I know this &#39;not an answer&#39; but it is the answer that showed me the most new stuff - thanks."}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": true, "score": 2, "last_activity_date": 1485984961, "creation_date": 1485984961, "answer_id": 41990217, "question_id": 41971368, "link": "https://stackoverflow.com/questions/41971368/vba-debug-print-producing-unexpected-and-seemingly-random-output/41990217#41990217", "title": "VBA Debug Print producing unexpected and seemingly random output", "body": "<p>Not an answer, but here's a p-code dump of the word doc in .doc format:</p>\n\n<p>Looks like the vbCr isn't corrupted </p>\n\n<pre><code>_VBA_PROJECT parsing done.\n-------------------------------------------------------------------------------\nModule streams:\nMacros/VBA/ThisDocument - 932 bytes\nMacros/VBA/Module1 - 1478 bytes\nLine #0:\n        Option  (Explicit)\nLine #1:\nLine #2:\n        FuncDefn (Sub test())\nLine #3:\n        Dim\n        VarDefn i (As Integer)\nLine #4:\n        StartForVariable\n        Ld i\n        EndForVariable\n        LitDI2 0x0001\n        LitDI2 0x0064\n        For\nLine #5:\n        Debug\n        PrintObj\n        Ld vbCr\n        PrintItemNL\nLine #6:\n        StartForVariable\n        Next\nLine #7:\n        EndSub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1485989106, "post_id": 41991135, "comment_id": 71159613, "body": "I&#39;ll take a look, did a few more tests: <code>Debug.Print vbCr &amp; &quot; &quot;</code>  is clean <code>Debug.Print vbCr &amp; Chr$(10)</code> is clean <code>Debug.Print Chr$(10)</code> is clean <code>Debug.Print vbCr &amp; &quot;&quot;</code>  is dirty <code>Debug.Print vbCr &amp; vbNullString</code>  is dirty <code>Debug.Print Chr(13)</code> is dirty"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1485990339, "post_id": 41991135, "comment_id": 71160097, "body": "<code>Debug.Print vbCr &amp; Chr(0)</code> appears to be clean."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1485992570, "post_id": 41991135, "comment_id": 71160807, "body": "<code>Debug.Print Chr(0) &amp; vbCr</code> clean     <code>Debug.Print Chr(0)</code> clean"}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 2, "last_activity_date": 1485988646, "last_edit_date": 1495540437, "creation_date": 1485988646, "answer_id": 41991135, "question_id": 41971368, "link": "https://stackoverflow.com/questions/41971368/vba-debug-print-producing-unexpected-and-seemingly-random-output/41991135#41991135", "title": "VBA Debug Print producing unexpected and seemingly random output", "body": "<p>@Comintern and I have long speculated that the Immediate Window is in fact a pipe, or a conduit for <code>stdIn</code>/<code>stdOut</code>.</p>\n\n<p>If we work on that basis, then this answer has some insights:</p>\n\n<p><a href=\"https://stackoverflow.com/a/25843879/5757159\">https://stackoverflow.com/a/25843879/5757159</a></p>\n\n<blockquote>\n  <p>A text stream is an ordered sequence of characters composed into lines, each line consisting of zero or more characters plus a terminating new-line character.</p>\n  \n  <p><strong>Characters may have to be added, altered, or deleted on input and output to conform to differing conventions for representing text in the host environment.</strong></p>\n</blockquote>\n\n<p>So it seems that Windows 10, <em>might</em> be getting something wrong when it processes the streams?</p>\n\n<p>The workaround is to ensure that <code>Debug.Print</code> statements never end in <code>vbCr</code>, <code>Chr(10)</code> or <code>Chr$(10)</code></p>\n"}, {"comments": [{"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1522722343, "post_id": 49617293, "comment_id": 86249550, "body": "Hi there, welcome to SO :-)   Yes, <code>Debug.Print &quot;&quot; </code> is a workaround but more to the point WHY does the <code>Debug.Print</code> statements that include <code>vbCr</code> fail? Anyway - I hope this helped you preserve your sanity :-)"}], "tags": [], "owner": {"reputation": 1, "user_id": 9587651, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216187968279034/picture?type=large", "display_name": "J&#233;r&#233;my", "link": "https://stackoverflow.com/users/9587651/j%c3%a9r%c3%a9my"}, "is_accepted": false, "score": 0, "last_activity_date": 1522696217, "creation_date": 1522696217, "answer_id": 49617293, "question_id": 41971368, "link": "https://stackoverflow.com/questions/41971368/vba-debug-print-producing-unexpected-and-seemingly-random-output/49617293#49617293", "title": "VBA Debug Print producing unexpected and seemingly random output", "body": "<p>I have a similar issue: <code>Debug.Print vbCr</code> prints either a blank line and nothing, or a blank line and \"lls\".\nIt happens randomly, I tried the same fonction with same parameters many times, and each time the printed result is different (either one of the above).</p>\n\n<p>I found an alternative: </p>\n\n<pre><code>Debug.Print \"\"\nDebug.Print \"My text\"\n</code></pre>\n\n<p>This alternative spoils one line of code, but the result is indeed one blank line and \"My Text\", without any extra random text.</p>\n"}], "owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 662, "favorite_count": 3, "accepted_answer_id": 41990217, "answer_count": 3, "score": 12, "last_activity_date": 1522696217, "creation_date": 1485919355, "last_edit_date": 1531164843, "question_id": 41971368, "link": "https://stackoverflow.com/questions/41971368/vba-debug-print-producing-unexpected-and-seemingly-random-output", "title": "VBA Debug Print producing unexpected and seemingly random output", "body": "<p>Can anyone shed some light on this.  In MS Word VBA I have a trivial Sub that produces rather unexpected results. [Edit: this issue has been reproduced on several different installations of MS Word but so far only Win10]</p>\n\n<p>Repro Environments: </p>\n\n<ul>\n<li>Win10, Word 2010 (32-bit) PC</li>\n<li>Win10, Word 2010 (32-bit) VM-Azure</li>\n<li>Win10, Word 2016 (32-bit) PC</li>\n<li>Win10, Word 2010 (64-bit) VM-Azure</li>\n<li>Win10, Word 2016 365 @VincentG</li>\n<li>Win10, Word 2007 (32 bit) @Ambie</li>\n<li>Win10(64), Word XP @ThunderFrame</li>\n<li>Win10(64), Excel XP @ThunderFrame</li>\n<li>Win8.1(64), Word 2013 @miroxlav    (first repro outside of Win10)</li>\n<li>Win8.1(64), Office 2016 (32) @GSerg</li>\n<li>Win10(64), Word 2007 (x86) @PartricK</li>\n<li>Win10(64), Excel 2007 (x86) @PartricK</li>\n</ul>\n\n<p>But no repro in:</p>\n\n<ul>\n<li>Win7 (64), Word 2007 (32-bit) VM Azure</li>\n<li>Win7 (64), Word 2010 (32?) @JohnColeman</li>\n<li>Win7 (64), Word 2007 (32) @Slai</li>\n<li>Win7 (64), Word 2003 (32) @GSerg</li>\n<li>WinXP (32), Word 2010 (32) @GSerg</li>\n<li>Win7 (64), Office 2010 (32)</li>\n</ul>\n\n<p>Steps to reproduce:\nOpen new Word document\nOpen IDE (Alt + F11)\nEnter this code</p>\n\n<pre><code>Option Explicit\n\nSub test()\nDim i As Integer\nFor i = 1 To 100\nDebug.Print vbCr\nNext\nEnd Sub\n</code></pre>\n\n<p>Run the test Sub.</p>\n\n<p>My output varies each time the loop is run:</p>\n\n<pre><code>]\u0152[p^\"\u00ee;{\u00d1[\n\n]\u0152[p^\"\u00ee;{\u00d1[\n\n\\\u00d2Z\u017eU\u00d6\u00e8;q\u00d1Z\n</code></pre>\n\n<p>or </p>\n\n<pre><code>\u00ff\u00ff\n\n\u00fe\u00fe@\u00f8\u00f8\u201d\u00b6(3\n\n\u00ff\u00ff\n</code></pre>\n\n<p>or </p>\n\n<pre><code>&gt;O\n\n&gt;O\n\n&gt;O\n</code></pre>\n\n<p>or</p>\n\n<pre><code>p\n\nG   P\u201aj \u017d\u00b6&amp;3@\n\np\n</code></pre>\n\n<p>Originally I thought I could recognize some content from my document, but now I get similar results for a blank document with nothing else open in Word. </p>\n\n<p>It was quite disconcerting until I reproduced in the other Word installations, now its more of a distraction &amp; puzzlement.  </p>\n\n<p>Any ideas about what's going on?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1485932941, "post_id": 41971343, "comment_id": 71125619, "body": "would you mind adding an example?"}, {"owner": {"reputation": 11, "user_id": 7498201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79a3602c3367f19edb92d53539f18e11?s=128&d=identicon&r=PG&f=1", "display_name": "Chin Yew", "link": "https://stackoverflow.com/users/7498201/chin-yew"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1485938622, "post_id": 41971343, "comment_id": 71128347, "body": "Hi user3598756. What do you mean?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7498201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79a3602c3367f19edb92d53539f18e11?s=128&d=identicon&r=PG&f=1", "display_name": "Chin Yew", "link": "https://stackoverflow.com/users/7498201/chin-yew"}, "edited": false, "score": 0, "creation_date": 1485931049, "post_id": 41971553, "comment_id": 71124769, "body": "Hi A.S.H, thank you for your time to code out. I tested the codes, it returned me And but not the Or part. Means user need to input both in order to search. If 1 input will return nothing."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 11, "user_id": 7498201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79a3602c3367f19edb92d53539f18e11?s=128&d=identicon&r=PG&f=1", "display_name": "Chin Yew", "link": "https://stackoverflow.com/users/7498201/chin-yew"}, "edited": false, "score": 0, "creation_date": 1485933242, "post_id": 41971553, "comment_id": 71125761, "body": "Is it possible that you have &quot;space characters&quot; in the non-entered cell? Also, when only b is entered in cell &quot;B1&quot;, it should be fetched from only column <code>B</code> of <code>Sheet1</code>, right?"}, {"owner": {"reputation": 11, "user_id": 7498201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79a3602c3367f19edb92d53539f18e11?s=128&d=identicon&r=PG&f=1", "display_name": "Chin Yew", "link": "https://stackoverflow.com/users/7498201/chin-yew"}, "edited": false, "score": 0, "creation_date": 1485938595, "post_id": 41971553, "comment_id": 71128331, "body": "You mean if there are any character(s) in other cell, the program might not work? Yes. If I want to search for B, then it will search column B in Sheet1, same for A. If I want to search A and B, it should return me row(s) containing A and B."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 11, "user_id": 7498201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79a3602c3367f19edb92d53539f18e11?s=128&d=identicon&r=PG&f=1", "display_name": "Chin Yew", "link": "https://stackoverflow.com/users/7498201/chin-yew"}, "edited": false, "score": 0, "creation_date": 1485942253, "post_id": 41971553, "comment_id": 71130678, "body": "If you enter only A, in Sheet2!A1, but you left B empty in Sheet2!B1, it will search for A only in column A of Sheet1? right?"}, {"owner": {"reputation": 11, "user_id": 7498201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79a3602c3367f19edb92d53539f18e11?s=128&d=identicon&r=PG&f=1", "display_name": "Chin Yew", "link": "https://stackoverflow.com/users/7498201/chin-yew"}, "edited": false, "score": 0, "creation_date": 1485942796, "post_id": 41971553, "comment_id": 71131028, "body": "Yes, it will search for those value(s) which the user input."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 11, "user_id": 7498201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79a3602c3367f19edb92d53539f18e11?s=128&d=identicon&r=PG&f=1", "display_name": "Chin Yew", "link": "https://stackoverflow.com/users/7498201/chin-yew"}, "edited": false, "score": 0, "creation_date": 1485943202, "post_id": 41971553, "comment_id": 71131262, "body": "Well that&#39;s weird, it works perfectly in my tests. I wonder what is different in yours. Note that the code above seraches for an <code>exact equality</code>  of the values, it is <i>case sensitive</i> and doesn&#39;t do <i>partial matching</i>."}, {"owner": {"reputation": 11, "user_id": 7498201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79a3602c3367f19edb92d53539f18e11?s=128&d=identicon&r=PG&f=1", "display_name": "Chin Yew", "link": "https://stackoverflow.com/users/7498201/chin-yew"}, "edited": false, "score": 0, "creation_date": 1485944392, "post_id": 41971553, "comment_id": 71132039, "body": "Perhaps just now got some error. Now I encountered was it only copied the last row of the correct result to the new sheet, but not all the rows containing the input."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1485924796, "last_edit_date": 1485924796, "creation_date": 1485920895, "answer_id": 41971553, "question_id": 41971343, "link": "https://stackoverflow.com/questions/41971343/excel-marco-vba-checking-of-1-and-or-2-cells-for-values/41971553#41971553", "title": "Excel marco vba - Checking of 1 and/or 2 cells for values", "body": "<p>Supposing user enters the values <code>a</code> and/or <code>b</code> in <code>Sheet2</code> cells <code>A1</code> and <code>B1</code>. Basically, what you want is to ignore any of them if it is not entered. Try this:</p>\n\n<pre><code>Sub mysub()\n    Dim i As Long, finalRow As Long, destRow As Long, a, b\n    destRow = 2\n    a = Sheet2.Range(\"A1\").value ' &lt;-- adjust to the place where user enters a\n    b = Sheet2.Range(\"B1\").value ' &lt;-- and b\n    With Sheet1\n        finalRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n        For i = 2 To finalRow\n            If (IsEmpty(a) Or .Cells(i, 1).value = a) And _\n               (IsEmpty(b) Or .Cells(i, 2).value = b) Then\n                .Cells(i, 1).Resize(1, 7).Copy\n                Sheet2.Cells(destRow, 1).PasteSpecial xlPasteFormulasAndNumberFormats\n                destRow = destRow + 1\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7498201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79a3602c3367f19edb92d53539f18e11?s=128&d=identicon&r=PG&f=1", "display_name": "Chin Yew", "link": "https://stackoverflow.com/users/7498201/chin-yew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 564, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1485924796, "creation_date": 1485919123, "last_edit_date": 1531164843, "question_id": 41971343, "link": "https://stackoverflow.com/questions/41971343/excel-marco-vba-checking-of-1-and-or-2-cells-for-values", "title": "Excel marco vba - Checking of 1 and/or 2 cells for values", "body": "<p>I am new to Excel VBA macro, but I'm tasked to create a project which is to let users input value(s) to the cell(s) in sheet 2, search through the data(sheet 1) and copy paste the filtered data to sheet 2.</p>\n\n<p>Let say A and B are the values inputs. I tried</p>\n\n<pre><code>    For Row = 2 To finalrow\n        If Cells(i, 1).value = a And Cells(i, 2).value = b Then\n            Range(Cells(i, 1), Cells(i, 7)).Copy\n            Sheet2.Select\n            Range(\"A200\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteFormulasAndNumberFormats\n            Sheet1.Select\n        ElseIf Cells(i, 1).Value = A Or Cells(i, 2).Value = B Then\n            Execute\n        End If\n    Next Row\n    Sheet2.Select\n    Range(\"B1\").Select\n    Range(\"B3\").Select\n</code></pre>\n\n<p>If the user input 1 value, the result is correct. But if the user input both A and B, it should return those rows containing the 2 values, but instead it returned me A results and B results.</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1485922551, "post_id": 41971278, "comment_id": 71121818, "body": "Does your code actually have <code>SHEET1NAME</code> or is that a placeholder? If it&#39;s a placeholder, are you literally just using the sheet name there? Because it should be <code>Sheets(&quot;Sheet1Name&quot;).Range(&quot;E13&quot;)</code>, etc."}], "answers": [{"comments": [{"owner": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "edited": false, "score": 0, "creation_date": 1485919998, "post_id": 41971406, "comment_id": 71121173, "body": "My excel formula was...=INDEX(SHEET2NAME!D:D,MATCH($B$13, SHEET2NAME!$A:$A, 0))"}, {"owner": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "edited": false, "score": 0, "creation_date": 1485920160, "post_id": 41971406, "comment_id": 71121209, "body": "B13 is on SHEET1NAME"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "edited": false, "score": 0, "creation_date": 1485920960, "post_id": 41971406, "comment_id": 71121399, "body": "@t.mo you can change the sheet&#39;s name part of the formula. i.e. <code>SHEET1NAME.Range(&quot;13:13&quot;)</code>. But you need to decide which param to use, you cant have 2 params to index in a single column."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "edited": false, "score": 0, "creation_date": 1485921541, "post_id": 41971406, "comment_id": 71121564, "body": "by the way, what are <code>SHEET1NAME</code> and <code>SHEET2NAME</code>? just <i>names</i> or worksheet objects? I guiess the runtime error is complaining that these are just names not objects!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1485931032, "post_id": 41971406, "comment_id": 71124764, "body": "It&#39;s always <b>possible</b> that the sheets&#39; <code>Name</code> and  <code>.CodeName</code> values are the same, but it may be safer to explicitly use <code>wb.Worksheets(&quot;SHEET1NAME&quot;).Range</code> instead of <code>SHEET1NAME.Range</code>."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 2, "last_activity_date": 1485921385, "last_edit_date": 1485921385, "creation_date": 1485919663, "answer_id": 41971406, "question_id": 41971278, "link": "https://stackoverflow.com/questions/41971278/runtime-error-424-object-required/41971406#41971406", "title": "Runtime error 424 Object required", "body": "<p>When you're indexing in a single dimension array, it doesn't make sense to have two parameters for the <code>Index</code>.</p>\n\n<pre><code>.Index(SHEET2NAME.Range(\"D:D\"), .Match(lookup_value, SHEET2NAME.Range(\"A:A\"), 0))\n</code></pre>\n\n<p>Also,</p>\n\n<blockquote>\n  <p><code>.Match(lookup_value, SHEET1NAME.Range(\"B13\"), 0)</code></p>\n</blockquote>\n\n<p>Doesn't make sense because you're searching in a single cell here. May be you meant to search in row 13?</p>\n\n<pre><code>.Match(lookup_value, SHEET1NAME.Range(\"13:13\"), 0)\n</code></pre>\n\n<p>However, you would use 2 parameters for<code>Index</code> only if you're indexing in a two-dimensional range. but then you will need to invert the 2nd and 3rd parameters that you gave to <code>Index</code>, because the 2nd param is a row index, which is fetched in a column, and the 3rd is a column index fetched in the row.</p>\n\n<p>For example, suppose you want to find a cell, in range <code>A1:D20</code> where <code>lookup_value</code> appears on column <code>A</code> (of the same row) and on row 13 (of the same column):</p>\n\n<pre><code>myVariable = .Index(SHEET2NAME.Range(\"D:D\"), _\n    .Match(lookup_value, SHEET2NAME.Range(\"A:A\"), 0), _\n    .Match(lookup_value, SHEET1NAME.Range(\"13:13\"), 0))\n</code></pre>\n\n<p>By the way, what are <code>SHEET1NAME</code> and <code>SHEET2NAME</code>? just names or worksheet objects? All of the above supposed they are Worksheet objects, but I guess the runtime error is complaining that these are just names not objects! In this case, replace them everywhere with <code>Worksheets(SHEET1NAME)</code> and <code>Worksheets(SHEET2NAME)</code>.</p>\n"}], "owner": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 638, "favorite_count": 0, "accepted_answer_id": 41971406, "answer_count": 1, "score": 0, "last_activity_date": 1485921385, "creation_date": 1485918629, "last_edit_date": 1485921232, "question_id": 41971278, "link": "https://stackoverflow.com/questions/41971278/runtime-error-424-object-required", "title": "Runtime error 424 Object required", "body": "<p>I am unable to find my error in the sub listed below. I receive a \"Runtime error 424 Object Required\" message.  </p>\n\n<p>My intention is to convert my excel formula into VBA code.</p>\n\n<pre><code>Private Sub Workbook_INDEXMATCH()\n\n    Dim wb As Workbook, wb1 As Workbook\n    Dim LastRow As Long\n    Set wb = Workbooks(\"WORKBOOK.xlsm\")\n\n    With Application.WorksheetFunction\n        SHEET1NAME.Range(\"E13\") = _\n        .Index(SHEET2NAME.Range(\"D:D\"), .Match(lookup_value, SHEET1NAME.Range(\"B13\"), 0), .Match(lookup_value, SHEET2NAME.Range(\"A:A\"), 0))\n\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1485918269, "post_id": 41970802, "comment_id": 71120765, "body": "To delete the name, meaning named ranges?"}, {"owner": {"reputation": 31, "user_id": 7498179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a63a87d31392d77fa68f925becdde38c?s=128&d=identicon&r=PG&f=1", "display_name": "Charteris", "link": "https://stackoverflow.com/users/7498179/charteris"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1486002312, "post_id": 41970802, "comment_id": 71163481, "body": "yes, named ranges (some are named formulas, not sure if that makes any difference)"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7498179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a63a87d31392d77fa68f925becdde38c?s=128&d=identicon&r=PG&f=1", "display_name": "Charteris", "link": "https://stackoverflow.com/users/7498179/charteris"}, "edited": false, "score": 0, "creation_date": 1486002988, "post_id": 41971012, "comment_id": 71163643, "body": "thanks! this speeded it up a bit (still slow but any gain helps)"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 31, "user_id": 7498179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a63a87d31392d77fa68f925becdde38c?s=128&d=identicon&r=PG&f=1", "display_name": "Charteris", "link": "https://stackoverflow.com/users/7498179/charteris"}, "edited": false, "score": 0, "creation_date": 1486004966, "post_id": 41971012, "comment_id": 71164159, "body": "@Charteris if it&#39;s really that slow, then I am guessing the slow part is not deleting the names, but Excel converting all references to the names into range references."}, {"owner": {"reputation": 31, "user_id": 7498179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a63a87d31392d77fa68f925becdde38c?s=128&d=identicon&r=PG&f=1", "display_name": "Charteris", "link": "https://stackoverflow.com/users/7498179/charteris"}, "edited": false, "score": 0, "creation_date": 1486091988, "post_id": 41971012, "comment_id": 71207353, "body": "thanks -- is it possible to turn that conversion off?"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 31, "user_id": 7498179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a63a87d31392d77fa68f925becdde38c?s=128&d=identicon&r=PG&f=1", "display_name": "Charteris", "link": "https://stackoverflow.com/users/7498179/charteris"}, "edited": false, "score": 0, "creation_date": 1486117103, "post_id": 41971012, "comment_id": 71217730, "body": "not that I know of, but you can probably copy or save the formulas as text to a new file .. which will result in bunch of #REF! errors"}, {"owner": {"reputation": 8136, "user_id": 461212, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/SmGJ1.jpg?s=128&g=1", "display_name": "hornetbzz", "link": "https://stackoverflow.com/users/461212/hornetbzz"}, "edited": false, "score": 0, "creation_date": 1543955610, "post_id": 41971012, "comment_id": 94102315, "body": "on top of DNR, I have also tables. In this case, the code generates an error because of undefined ranges. I had to add &quot;on error resume next&quot; just before the deleting action, within the loop."}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 4, "last_activity_date": 1498597207, "last_edit_date": 1498597207, "creation_date": 1485916574, "answer_id": 41971012, "question_id": 41970802, "link": "https://stackoverflow.com/questions/41970802/excel-vba-deleting-all-names-from-a-workbook-without-a-loop/41971012#41971012", "title": "excel vba, deleting all names from a workbook without a loop", "body": "<p>Not possible without some complicated hacky way or messing with the XML, but this should be faster:</p>\n\n<pre><code>Dim i As Long\nApplication.Calculation = xlCalculationManual\nFor i = ThisWorkbook.Names.Count To 1 Step -1\n    ThisWorkbook.Names(i).Delete\nNext\nApplication.Calculation = xlCalculationAutomatic\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7680348, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hezrC24ef48/AAAAAAAAAAI/AAAAAAAAEVs/e5zyuR_YTAA/photo.jpg?sz=128", "display_name": "matheus silveira", "link": "https://stackoverflow.com/users/7680348/matheus-silveira"}, "is_accepted": false, "score": 1, "last_activity_date": 1489001629, "creation_date": 1489001629, "answer_id": 42680365, "question_id": 41970802, "link": "https://stackoverflow.com/questions/41970802/excel-vba-deleting-all-names-from-a-workbook-without-a-loop/42680365#42680365", "title": "excel vba, deleting all names from a workbook without a loop", "body": "<p>I had the same problem deleting all named ranges, the code was running very slowly. You can fix this by turning off the screen update and the calculation while the loop is running.</p>\n\n<pre><code>Sub deleteAllNames()\n\nApplication.Calculation = xlCalculationManual\nApplication.ScreenUpdating = False\n\nDim xName As Name\n\nFor Each xName In Application.ActiveWorkbook.Names\n       xName.Delete\nNext\n\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7498179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a63a87d31392d77fa68f925becdde38c?s=128&d=identicon&r=PG&f=1", "display_name": "Charteris", "link": "https://stackoverflow.com/users/7498179/charteris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9600, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1498597207, "creation_date": 1485914905, "question_id": 41970802, "link": "https://stackoverflow.com/questions/41970802/excel-vba-deleting-all-names-from-a-workbook-without-a-loop", "title": "excel vba, deleting all names from a workbook without a loop", "body": "<p>I'm trying to delete all names from an excel workbook using VBA\nwithout using a loop.</p>\n\n<p>I'm currently using the code below, but this is very slow as there are several thousand names in the workbook.</p>\n\n<p>Any suggestions would be appreciated!</p>\n\n<pre><code>Sub deleteAllNames()\nDim xName As Name\n\nFor Each xName In Application.ActiveWorkbook.Names\n       xName.Delete\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7443883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd28d1e84d50f7fd59b7ce485629b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Mstuf", "link": "https://stackoverflow.com/users/7443883/mstuf"}, "edited": false, "score": 0, "creation_date": 1485925938, "post_id": 41971100, "comment_id": 71122853, "body": "Thank you  - My Result tells me false -- indicating an errant number but where ?  My Hope is for something that will stop going through the column at the error spots.  I figured there must be an error at some point but the search through 55000 rows is the issue I then face and hope to find a solution to point out the error cells."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 1, "user_id": 7443883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd28d1e84d50f7fd59b7ce485629b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Mstuf", "link": "https://stackoverflow.com/users/7443883/mstuf"}, "edited": false, "score": 0, "creation_date": 1485932902, "post_id": 41971100, "comment_id": 71125603, "body": "@Mstuf I added a VBA macro to spot the error and take you there immediately. Please see the edit."}, {"owner": {"reputation": 1, "user_id": 7443883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd28d1e84d50f7fd59b7ce485629b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Mstuf", "link": "https://stackoverflow.com/users/7443883/mstuf"}, "edited": false, "score": 0, "creation_date": 1485935159, "post_id": 41971100, "comment_id": 71126679, "body": "I do apologize for not thinking of all the variables -  Can you edit this to run from the active cell ?  I have some cells at the beginning of the sheet with Letters in front of them that this version will not make it past.     Sorry for my lack of knowledge and forethought about that,"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 1, "user_id": 7443883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd28d1e84d50f7fd59b7ce485629b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Mstuf", "link": "https://stackoverflow.com/users/7443883/mstuf"}, "edited": false, "score": 0, "creation_date": 1485936353, "post_id": 41971100, "comment_id": 71127240, "body": "@Mstuf ok so the new (edited) version is a macro that will check the sorting starting from the selected cell and downward."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1485936308, "last_edit_date": 1485936308, "creation_date": 1485917154, "answer_id": 41971100, "question_id": 41970778, "link": "https://stackoverflow.com/questions/41970778/excel-macro-to-find-numbers-in-a-column-not-in-ascending-order/41971100#41971100", "title": "Excel - Macro to Find Numbers in a Column not in ascending order", "body": "<p>You can do it with an array formula. If your column is \"A\" and has 55000 rows, enter this array formula in any cell:</p>\n\n<pre><code>=AND(A1:A54999 &lt;= A2:A55000)\n</code></pre>\n\n<p>It's an array formula, type it and press <code>Ctrl+Shift+Enter</code>. It <strong>wont work</strong> if you just press <code>Enter</code> like a normal formula.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>So the problem is not only to know whether there is an error, but to spot it. Here's a VBA macro that will <code>Select</code> the first occurrence of the sorting error, otherwise it informs you of no error. It uses the current selected cell as the first cell in the column to check.</p>\n\n<pre><code>Sub checkColumnSorting() ' &lt;-- uses current selection as first cell in column\n    Dim firstCell As Range, lastCell As Range, i As Long, ar\n    Set firstCell = Selection\n    With firstCell.Parent\n        Set lastCell = .Cells(.Rows.Count, firstCell.Column).End(xlUp)\n        ar = Application.Transpose(.Range(firstCell, lastCell))\n        For i = LBound(ar) To UBound(ar) - 1\n            If ar(i) &gt; ar(i + 1) Then\n                .Activate\n                .Cells(i + firstCell.Row, firstCell.Column).Select\n                msgBox \"Error in ascending sorting at row \" &amp; i + firstCell.Row\n                Exit Sub\n            End If\n        Next\n    End With\n    msgBox \"Ascending sorting is Ok\"\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7443883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd28d1e84d50f7fd59b7ce485629b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Mstuf", "link": "https://stackoverflow.com/users/7443883/mstuf"}, "edited": false, "score": 0, "creation_date": 1486057896, "post_id": 41974268, "comment_id": 71193710, "body": "This will work for me -- Thank  you so much  - I envy your knowledge.  It has pointed out several other things I must fix in my workbook in order to run the whole column as intended."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 1, "user_id": 7443883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd28d1e84d50f7fd59b7ce485629b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Mstuf", "link": "https://stackoverflow.com/users/7443883/mstuf"}, "edited": false, "score": 0, "creation_date": 1486060307, "post_id": 41974268, "comment_id": 71194998, "body": "You are welcome. And don&#39;t envy me: we&#39;re all on our way to learn something more!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1485934424, "creation_date": 1485934424, "answer_id": 41974268, "question_id": 41970778, "link": "https://stackoverflow.com/questions/41970778/excel-macro-to-find-numbers-in-a-column-not-in-ascending-order/41974268#41974268", "title": "Excel - Macro to Find Numbers in a Column not in ascending order", "body": "<p>you could use this function to return all not sorted cells addresses:</p>\n\n<pre><code>Option Explicit\n\nFunction IsItSorted(rng As Range) As Variant\n    Dim vals As Variant\n    Dim nErrs As Long, iVal As Long\n\n    vals = Application.Transpose(rng.Value)\n    ReDim errs(LBound(vals) To UBound(vals)) As String\n\n    For iVal = LBound(vals) To UBound(vals) - 1\n        If vals(iVal) &gt; vals(iVal + 1) Then\n            nErrs = nErrs + 1\n            errs(LBound(vals) - 1 + nErrs) = rng(LBound(vals) - 1 + iVal).address\n        End If\n    Next\n    If nErrs &gt; 0 Then\n        ReDim Preserve errs(LBound(vals) To LBound(vals) - 1 + nErrs) As String\n        IsItSorted = \"Errors at: \" &amp; Join(errs, \",\")\n    Else\n        IsItSorted = \"Sorting: OK\"\n    End If\nEnd Function\n</code></pre>\n\n<p>to be used in your main code as:</p>\n\n<pre><code>Sub main()\n    MsgBox IsItSorted(Range(\"B2:B11\"))\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7443883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd28d1e84d50f7fd59b7ce485629b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Mstuf", "link": "https://stackoverflow.com/users/7443883/mstuf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "accepted_answer_id": 41974268, "answer_count": 2, "score": -2, "last_activity_date": 1602923002, "creation_date": 1485914719, "last_edit_date": 1489494788, "question_id": 41970778, "link": "https://stackoverflow.com/questions/41970778/excel-macro-to-find-numbers-in-a-column-not-in-ascending-order", "title": "Excel - Macro to Find Numbers in a Column not in ascending order", "body": "<p>In researching I found a formula that examines a whole column and answers true of false.    But its not what I need to accomplish.  </p>\n\n<p>I would like to Choose a Column of Numbers  and run a Macro that stops when a number is NOT Larger than then number that proceeds it.  </p>\n\n<p>I have a Column of 55000 supposedly in order numbers in ascending order.  I need to pick out errors in the ascension.  </p>\n\n<p>Thanks </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 435, "user_id": 6459965, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f1ef76de619a4042b74cfa02cc9752e0?s=128&d=identicon&r=PG&f=1", "display_name": "gluc7", "link": "https://stackoverflow.com/users/6459965/gluc7"}, "edited": false, "score": 1, "creation_date": 1485911146, "post_id": 41970121, "comment_id": 71118951, "body": "I didn&#39;t even think of that. Thank you! Though if I remember correctly it always seemed to be a sheet 5 error, but the workbook might always open up to sheet5."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 435, "user_id": 6459965, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f1ef76de619a4042b74cfa02cc9752e0?s=128&d=identicon&r=PG&f=1", "display_name": "gluc7", "link": "https://stackoverflow.com/users/6459965/gluc7"}, "edited": false, "score": 0, "creation_date": 1485911373, "post_id": 41970121, "comment_id": 71119005, "body": "@gluc7 Always use qualified ranges. Unqualified ones lead to unexpected errors and sometimes difficult to explain. I hope this helped."}, {"owner": {"reputation": 435, "user_id": 6459965, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f1ef76de619a4042b74cfa02cc9752e0?s=128&d=identicon&r=PG&f=1", "display_name": "gluc7", "link": "https://stackoverflow.com/users/6459965/gluc7"}, "edited": false, "score": 1, "creation_date": 1485960201, "post_id": 41970121, "comment_id": 71142735, "body": "I have fixed the line in my code now and tested multiple different scenarios that led to the error previously and so far it looks like this change has worked. Thanks again!"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 2, "last_activity_date": 1485911185, "last_edit_date": 1485911185, "creation_date": 1485910012, "answer_id": 41970121, "question_id": 41969945, "link": "https://stackoverflow.com/questions/41969945/excel-error-removed-records-sorting-from-xl-worksheets-sheet5-xml-part/41970121#41970121", "title": "Excel Error: Removed Records: Sorting from /xl/worksheets/sheet5.xml part", "body": "<p>Might be due to unqualified ranges.</p>\n\n<blockquote>\n  <p><code>Worksheets(\"Follow-Ups\").Range(\"A:AD\").Sort Key1:=Range(\"AC2\"), ...</code></p>\n\n<pre><code>                                                  ^^^^^^\n</code></pre>\n</blockquote>\n\n<p>Suppose that at the moment of running this statement, the currently active worksheet is not \"Follow-Ups\", but another one (i.e. <code>Sheet5</code>). You would be sorting a range from \"Follow-Ups\" using a key range that belongs to another worksheet (the currently active one). This leads to a runtime error.</p>\n\n<p>Qualifying the range is mandatory:</p>\n\n<pre><code>Worksheets(\"Follow-Ups\").Range(\"A:AD\").Sort Key1:=Worksheets(\"Follow-Ups\").Range(\"AC2\"), Order1:=xlAscending, Header:=xlYes\n</code></pre>\n\n<p>You can simplify it using a <code>With</code> clause:</p>\n\n<pre><code>With Worksheets(\"Follow-Ups\")\n    .Range(\"A:AD\").Sort Key1:=.Range(\"AC2\"), Order1:=xlAscending, Header:=xlYes\nEnd With\n</code></pre>\n\n<p>The error displayed by VBA is probably due to that <code>Sheet5</code> was the active sheet, and surely it could not use its range \"AC2\" as key.</p>\n"}], "owner": {"reputation": 435, "user_id": 6459965, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f1ef76de619a4042b74cfa02cc9752e0?s=128&d=identicon&r=PG&f=1", "display_name": "gluc7", "link": "https://stackoverflow.com/users/6459965/gluc7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2441, "favorite_count": 0, "accepted_answer_id": 41970121, "answer_count": 1, "score": 1, "last_activity_date": 1485911185, "creation_date": 1485908575, "question_id": 41969945, "link": "https://stackoverflow.com/questions/41969945/excel-error-removed-records-sorting-from-xl-worksheets-sheet5-xml-part", "title": "Excel Error: Removed Records: Sorting from /xl/worksheets/sheet5.xml part", "body": "<p>I am receiving the error stated in the the title when re-opening a macro-enabled excel spreadsheet. The spreadsheet has about 8 tabs and they all formatted almost exactly the same. My macro moves rows to different sheets based on a data validation cell value in the last column. There is only one line of code that sorts anything, and it is sorting Sheet 6, not sheet 5.</p>\n\n<pre><code>Worksheets(\"Follow-Ups\").Range(\"A:AD\").Sort Key1:=Range(\"AC2\"), Order1:=xlAscending, Header:=xlYes\n</code></pre>\n\n<p>I have looked over some of the other similar questions on StackOverflow about this error, but it doesn't seem that there has been any definitive reason stated for why this happens. </p>\n\n<p>I have messed around with some things within my VBA code but the error always seems to return. I am in the process of copying my data over to a brand new workbook and re-doing the code. I will also be saving it as a Binary excel file instead of macro enabled.</p>\n\n<p>Has anyone else encountered this error and what are some other possible solutions I can try to prevent this error from happening again. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 7376921, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/74660847ad790c9a48e3622dfbcdd253?s=128&d=identicon&r=PG&f=1", "display_name": "studiis", "link": "https://stackoverflow.com/users/7376921/studiis"}, "edited": false, "score": 0, "creation_date": 1485907702, "post_id": 41969774, "comment_id": 71118035, "body": "How would I use this to see if the value appears twice?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 95, "user_id": 7376921, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/74660847ad790c9a48e3622dfbcdd253?s=128&d=identicon&r=PG&f=1", "display_name": "studiis", "link": "https://stackoverflow.com/users/7376921/studiis"}, "edited": false, "score": 4, "creation_date": 1485907730, "post_id": 41969774, "comment_id": 71118047, "body": "@studiis - Run it?"}, {"owner": {"reputation": 95, "user_id": 7376921, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/74660847ad790c9a48e3622dfbcdd253?s=128&d=identicon&r=PG&f=1", "display_name": "studiis", "link": "https://stackoverflow.com/users/7376921/studiis"}, "edited": false, "score": 0, "creation_date": 1485907920, "post_id": 41969774, "comment_id": 71118109, "body": "I think your code just checks if the value appears once All you did was add a flag to my code"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 95, "user_id": 7376921, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/74660847ad790c9a48e3622dfbcdd253?s=128&d=identicon&r=PG&f=1", "display_name": "studiis", "link": "https://stackoverflow.com/users/7376921/studiis"}, "edited": false, "score": 1, "creation_date": 1485908001, "post_id": 41969774, "comment_id": 71118130, "body": "@studiis - No, it only displays the <code>MsgBox</code> if the flag is <i>set</i> and the flag only gets set when it finds the first match."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 95, "user_id": 7376921, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/74660847ad790c9a48e3622dfbcdd253?s=128&d=identicon&r=PG&f=1", "display_name": "studiis", "link": "https://stackoverflow.com/users/7376921/studiis"}, "edited": false, "score": 1, "creation_date": 1485909044, "post_id": 41969774, "comment_id": 71118433, "body": "@studiis run it, it does what you want.  a msgbox will come up when it hits the second instance not the first."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 4, "last_activity_date": 1485907526, "creation_date": 1485907526, "answer_id": 41969774, "question_id": 41969746, "link": "https://stackoverflow.com/questions/41969746/how-to-check-if-string-appears-in-worksheet-twice-excel-vba/41969774#41969774", "title": "How to check if string appears in worksheet *twice* Excel VBA?", "body": "<p>Set a flag when you find the first match, then check to see if the flag is set:</p>\n\n<pre><code>Dim first As Boolean\nFor Each curr In wb.Worksheets(1).UsedRange\n    If InStr(1, curr.Value, searchString) &gt; 0 Then\n        If first Then MsgBox (\"searchString appears twice\")\n        first = True\n    End If\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 4, "last_activity_date": 1485907925, "creation_date": 1485907925, "answer_id": 41969839, "question_id": 41969746, "link": "https://stackoverflow.com/questions/41969746/how-to-check-if-string-appears-in-worksheet-twice-excel-vba/41969839#41969839", "title": "How to check if string appears in worksheet *twice* Excel VBA?", "body": "<pre><code>If WorksheetFunction.CountIf(Worksheets(1).UsedRange, \"*\" &amp; searchString &amp; \"*\") &gt; 1 Then \n    MsgBox searchString &amp; \" appears more than once\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 7376921, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/74660847ad790c9a48e3622dfbcdd253?s=128&d=identicon&r=PG&f=1", "display_name": "studiis", "link": "https://stackoverflow.com/users/7376921/studiis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 758, "favorite_count": 0, "accepted_answer_id": 41969839, "answer_count": 2, "score": -2, "last_activity_date": 1485907925, "creation_date": 1485907374, "last_edit_date": 1485907625, "question_id": 41969746, "link": "https://stackoverflow.com/questions/41969746/how-to-check-if-string-appears-in-worksheet-twice-excel-vba", "title": "How to check if string appears in worksheet *twice* Excel VBA?", "body": "<p>I'm trying to check if a certain string appears on a given sheet twice. So far, I'm only able to check if the string appears once:</p>\n\n<pre><code>For Each curr In wb.Worksheets(1).UsedRange\n    If InStr(1, curr.Value, searchString) &gt; 0 Then\n        MsgBox (\"searchString appears once\")\n    End If\nNext\n</code></pre>\n\n<p>How do I check the UsedRange to see if the value appears twice? This needs to be a macro (so far I've found formulas that do this).</p>\n"}, {"tags": ["vba", "excel", "api", "stock"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1485912049, "post_id": 41969520, "comment_id": 71119162, "body": "Possibly relevant: <a href=\"http://stackoverflow.com/q/25097779/4088852\">Getting stock&#39;s historical data</a>."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1485913875, "post_id": 41969520, "comment_id": 71119690, "body": "Does the code above work? If so, are you asking if there&#39;s a more efficient way to get the data? If there are errors, or it&#39;s not working as expected, what&#39;s going wrong, where?"}, {"owner": {"reputation": 1, "user_id": 7497597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a0efb316b87312a6dd7fe7841eac55c?s=128&d=identicon&r=PG&f=1", "display_name": "D.McCloud", "link": "https://stackoverflow.com/users/7497597/d-mccloud"}, "edited": false, "score": 0, "creation_date": 1485921953, "post_id": 41969520, "comment_id": 71121670, "body": "The code above works. I am asking if there is a way to get what turns out to be the third column of the .csv (closing stock price) file that is pulled, then make go to the next stock in the portfolio and pull the data (3 column of each .csv file)"}, {"owner": {"reputation": 1, "user_id": 7497597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a0efb316b87312a6dd7fe7841eac55c?s=128&d=identicon&r=PG&f=1", "display_name": "D.McCloud", "link": "https://stackoverflow.com/users/7497597/d-mccloud"}, "edited": false, "score": 0, "creation_date": 1485922267, "post_id": 41969520, "comment_id": 71121747, "body": "When the code runs it pulls a link (for example, ticker symbol ABT would look like this...<a href=\"http://ichart.finance.yahoo.com/table.csv?s=ABT&amp;a=1&amp;b=25&amp;c=2010&amp;d=1e=16&amp;f=2017&amp;g=d&amp;ignore=.csv\" rel=\"nofollow noreferrer\">ichart.finance.yahoo.com/&hellip;</a>)"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7497597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a0efb316b87312a6dd7fe7841eac55c?s=128&d=identicon&r=PG&f=1", "display_name": "D.McCloud", "link": "https://stackoverflow.com/users/7497597/d-mccloud"}, "is_accepted": true, "score": 0, "last_activity_date": 1485984518, "creation_date": 1485984518, "answer_id": 41990095, "question_id": 41969520, "link": "https://stackoverflow.com/questions/41969520/pulling-historical-stock-data-for-multiple-companies-using-yahoo-api-in-excel/41990095#41990095", "title": "Pulling Historical stock data for multiple companies using YAHOO API in Excel", "body": "<p>FIGURED IT OUT.</p>\n\n<p>Just took lots of splitting and lots of loops. </p>\n\n<p>Although, I'm sure it can be scripted more elegantly. </p>\n\n<p>Cheers!</p>\n\n<pre><code>Dim W As Worksheet: Set W = ActiveSheet\nDim DataW As Worksheet: Set DataW = ActiveWorkbook.Sheets(\"Sheet1\") ' This is where you enter the stocks in your portfolio\nDim Last As Integer: Last = W.Range(\"d2\").End(xlToRight).Column\nDim dataLast As Integer: dataLast = DataW.Range(\"A2\").End(xlDown).Row\n\n\n'*************************************************************************************\nIf Last &lt;&gt; dataLast + 2 Then\n    W.Rows(2).Clear ' clears row if values are different so correct data can be enterred into this row\n        Dim i As Integer\nFor i = 1 To dataLast\n    W.Cells(2, 3 + i).Value = DataW.Cells(1 + i, 1).Value\nNext i\nEnd If\n'*************************************************************************************\n\n\n\nDim strtDate As Date: strtDate = W.Range(\"B4\").Value 'Starting Date\nDim endDate As Date: endDate = W.Range(\"B5\").Value 'End Date\n '-------------------breaks down starting month, day and year to be entered into the URL -------------------\n        Dim strtMonth As String: strtMonth = Month(strtDate) - 1\n        Dim strtDay As String: strtDay = Day(strtDate)\n        Dim strtYear As String: strtYear = Year(strtDate)\n        Dim endMonth As String: endMonth = Month(endDate) - 1\n        Dim endDay As String: endDay = Day(endDate)\n        Dim endYear As String: endYear = Year(endDate)\n'-------------------------------------------------------------------------------------------------------------------------------------\n\nDim urlStartRange As String: urlStartRange = \"&amp;a=\" &amp; strtMonth &amp; \"&amp;b=\" &amp; strtDay &amp; \"&amp;c=\" &amp; strtYear ' This goes into URL for start date\nDim urlEndRange As String: urlEndRange = \"&amp;d=\" &amp; endMonth &amp; \"&amp;e=\" &amp; endDay &amp; \"&amp;f=\" &amp; endYear &amp; \"&amp;g=d&amp;ignore=.csv\" 'this goes into the URL as end date\n'-------------------------------------------------------------------------------------------------------------------------------------\n\n'creates a string of all symbols separated by \"+\"\nDim urlSymbols As String\nFor i = 0 To dataLast\n    urlSymbols = urlSymbols &amp; W.Cells(2, 4 + i).Value &amp; \"+\"\nNext i\nurlSymbols = Left(urlSymbols, Len(urlSymbols) - 3) 'gets rid of extra \"+\" values\n\n Dim splitUrlSymbols As Variant: splitUrlSymbols = Split(urlSymbols, Chr(43))\n For i = 0 To dataLast - 2\n       W.Cells(1, 4 + i).Value = \"http://ichart.finance.yahoo.com/table.csv?s=\" &amp; splitUrlSymbols(i) &amp; urlStartRange &amp; urlEndRange\n Next i\n   'Pulls data from YAHOO Finance --------------\nFor Z = 0 To dataLast - 2\nDim getHttp As New WinHttpRequest\n\n    getHttp.Open \"GET\", W.Cells(1, Z + 4).Value, False ' *********just selected 1 cell for now****************\n    getHttp.Send\n    Dim httpResp As String: httpResp = getHttp.ResponseText\n    Dim dataLines As Variant: dataLines = Split(httpResp, vbLf)\n    Dim closeValue As String\n    Dim x As Integer\n        For x = 1 To UBound(dataLines) - 4: Debug.Print dataLines(2)\n            closeValue = dataLines(x)\n            Dim adjClose As Variant: adjClose = Split(closeValue, \",\")\n                 If InStr(closeValue, \",\") &gt; 0 Then\n            W.Cells(2 + x, Z + 4).Value = adjClose(6)\n                End If\n        Next x\n    Dim y As Integer\n    'Dim adjClose As Variant: adjClose = Split(closeValue, \",\")\n\n\n\nNext Z\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7497597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a0efb316b87312a6dd7fe7841eac55c?s=128&d=identicon&r=PG&f=1", "display_name": "D.McCloud", "link": "https://stackoverflow.com/users/7497597/d-mccloud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1452, "favorite_count": 1, "accepted_answer_id": 41990095, "answer_count": 1, "score": 0, "last_activity_date": 1485984518, "creation_date": 1485906007, "last_edit_date": 1485906636, "question_id": 41969520, "link": "https://stackoverflow.com/questions/41969520/pulling-historical-stock-data-for-multiple-companies-using-yahoo-api-in-excel", "title": "Pulling Historical stock data for multiple companies using YAHOO API in Excel", "body": "<p>I am working on a project in Excel that will give you your portfolio's value and also calculate some other useful statistics about your holdings. (Portfolio's st.dev, your portfolio's beta, etc.).</p>\n\n<p>I have already used the Yahoo Finance to pull the intraday stats, (company name, last trade price, open, high, low, etc). That part was fairly straight forward, you just add the symbol and \"+\" in the URL and it pulls all the data for each stock. </p>\n\n<p>What I am trying to do is pull the historical closing prices for all the stocks in the portfolio (unfortunately the same logic of adding the ticker symbol and \"+\" to the URL does not work for this). </p>\n\n<p>Below is the code I have so far. On \"Sheet1\" is where the portfolio holdings are (Ticker symbols starting at cell A2 and going down).\nSheet 2 will take the ticker symbols and display them across the top in row 2 with the url for each corresponding ticker above it in row 1. </p>\n\n<p>Also the start and end dates are in sheet 2 cells C 4 and 5, respectively. </p>\n\n<p>The goal is to try to get excel to get the .CSV for each ticker symbol, and record the closing price in the corresponding column.</p>\n\n<p>Maybe I am going about it all wrong and there is a much easier way to get this data, but any help would be appreciated.</p>\n\n<p>Thank you in advance!</p>\n\n<pre><code>Private Sub btnHistoricalData_Click()\n\nDim W As Worksheet: Set W = ActiveSheet\nDim DataW As Worksheet: Set DataW = ActiveWorkbook.Sheets(\"Sheet1\") ' This is where you enter the stocks in your portfolio\nDim Last As Integer: Last = W.Range(\"c2\").End(xlToRight).Column\nDim dataLast As Integer: dataLast = DataW.Range(\"A2\").End(xlDown).Row\n\n'*************************************************************************************\nIf Last &lt;&gt; dataLast Then\n    W.Rows(2).Clear ' clears row if values are different so correct data can be enterred into this row\nEnd If\n'*************************************************************************************\nDim i As Integer\nFor i = 1 To dataLast\n    W.Cells(2, 3 + i).Value = DataW.Cells(1 + i, 1).Value\nNext i\n\n\nDim strtDate As Date: strtDate = W.Range(\"B4\").Value 'Starting Date\nDim endDate As Date: endDate = W.Range(\"B5\").Value 'End Date\n '-------------------breaks down starting month, day and year to be entered into the URL -------------------\n        Dim strtMonth As String: strtMonth = Month(strtDate)\n        Dim strtDay As String: strtDay = Day(strtDate)\n        Dim strtYear As String: strtYear = Year(strtDate)\n        Dim endMonth As String: endMonth = Month(endDate)\n        Dim endDay As String: endDay = Day(endDate)\n        Dim endYear As String: endYear = Year(endDate)\n'-------------------------------------------------------------------------------------------------------------------------------------\n\nDim urlStartRange As String: urlStartRange = \"&amp;a=\" &amp; strtMonth &amp; \"&amp;b=\" &amp; strtDay &amp; \"&amp;c=\" &amp; strtYear ' This goes into URL for start date\nDim urlEndRange As String: urlEndRange = \"&amp;d=\" &amp; endMonth &amp; \"e=\" &amp; endDay &amp; \"&amp;f=\" &amp; endYear &amp; \"&amp;g=d&amp;ignore=.csv\" 'this goes into the URL as end date\n'-------------------------------------------------------------------------------------------------------------------------------------\n\n'creates a string of all symbols separated by \"+\"\nDim urlSymbols As String\nFor i = 0 To dataLast\n    urlSymbols = urlSymbols &amp; W.Cells(2, 4 + i).Value &amp; \"+\"\nNext i\nurlSymbols = Left(urlSymbols, Len(urlSymbols) - 3) 'gets rid of extra \"+\" values\n\n Dim splitUrlSymbols As Variant: splitUrlSymbols = Split(urlSymbols, Chr(43))\n For i = 0 To dataLast - 2\n       W.Cells(1, 4 + i).Value = \"http://ichart.finance.yahoo.com/table.csv?s=\" &amp; splitUrlSymbols(i) &amp; urlStartRange &amp; urlEndRange\n Next i\n   'Pulls data from YAHOO Finance --------------\nDim getHttp As New WinHttpRequest\n'For i = 0 To lastdata - 2 **(eventually I need to loop this request through each column for each stock enterred)**\n    getHttp.Open \"GET\", W.Cells(1, 5).Value, False ' *********just selected 1 cell for now****************\n    getHttp.Send\n    Dim httpResp As String: httpResp = getHttp.ResponseText\n    Dim dataLines As Variant: dataLines = Split(httpResp, vbTab)\n    Dim splitDataLines As String\n    Dim dataValues As Variant\n    Dim x As Integer\n        For x = 0 To UBound(dataLines)\n            splitDataLines = dataLines(x)\n\n           dataValues = Split(splitDataLines, \",\")\n\n        Next x\n'----------------------------------------------\n   ' Next i\n    MsgBox (httpResp)\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1135, "user_id": 3165466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef259905fd034ee6a4c74269b89d0457?s=128&d=identicon&r=PG&f=1", "display_name": "Gordon", "link": "https://stackoverflow.com/users/3165466/gordon"}, "edited": false, "score": 0, "creation_date": 1485906188, "post_id": 41969146, "comment_id": 71117557, "body": "Not had time to look at this properly but you appear to be looping through the cells in column B twice so you could maybe do the code to change the colour and code to copy within the same loop.  Put the cell.Interior.Color = vbYellow under the copy code and add an End If below.  Then delete the first For Each ... Next Cell code. Try that in the meantime.  I&#39;m sure there will be someone giving your code the full treatment."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1485935713, "post_id": 41969146, "comment_id": 71126934, "body": "if it&#39;s a working code and you only need to optimize it then post it to <a href=\"http://codereview.stackexchange.com/\">Code Review</a>"}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 7476274, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ee964769913e1665cc9b7e36b81e05ca?s=128&d=identicon&r=PG&f=1", "display_name": "CC268", "link": "https://stackoverflow.com/users/7476274/cc268"}, "edited": false, "score": 0, "creation_date": 1485965322, "post_id": 41969642, "comment_id": 71146555, "body": "Thanks that does help - is there a way to clean up my code above that? I use .Select a lot because of the macro recorder and I know that isn&#39;t best practice. @Gordon"}, {"owner": {"reputation": 1135, "user_id": 3165466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef259905fd034ee6a4c74269b89d0457?s=128&d=identicon&r=PG&f=1", "display_name": "Gordon", "link": "https://stackoverflow.com/users/3165466/gordon"}, "reply_to_user": {"reputation": 73, "user_id": 7476274, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ee964769913e1665cc9b7e36b81e05ca?s=128&d=identicon&r=PG&f=1", "display_name": "CC268", "link": "https://stackoverflow.com/users/7476274/cc268"}, "edited": false, "score": 0, "creation_date": 1485982853, "post_id": 41969642, "comment_id": 71156647, "body": "The macro recorder is a great way to find out what code you need to use.  You can tidy up the sometimes redundant select code by merging the 2 lines e.g. Columns(&quot;L:L&quot;).Select Selection.Copy to Columns(&quot;L:L&quot;).Copy so you replace &quot;Selection&quot; with the range you&#39;ve just selected.  BEWARE the sections where the select is selecting a sheet.  I don&#39;t think you will see too much improvement in speed but it will be tidy things up."}], "tags": [], "owner": {"reputation": 1135, "user_id": 3165466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef259905fd034ee6a4c74269b89d0457?s=128&d=identicon&r=PG&f=1", "display_name": "Gordon", "link": "https://stackoverflow.com/users/3165466/gordon"}, "is_accepted": false, "score": 1, "last_activity_date": 1485906682, "creation_date": 1485906682, "answer_id": 41969642, "question_id": 41969146, "link": "https://stackoverflow.com/questions/41969146/optimize-slow-vba-code/41969642#41969642", "title": "Optimize slow VBA code", "body": "<p>Try combining the 2 for loops that you have at the bottom of the code. They both loop through the column B and run code when the same criteria is met.</p>\n\n<pre><code>With Sheets(\"Sheet2\")\n    For Each cell In .Range(\"B2\", Cells(Rows.Count, \"B\").End(xlUp))\n        If .Range(\"A:A\").Find(What:=cell.Value2, LookAt:=xlWhole) Is Nothing Then\n           Intersect(.UsedRange, cell.EntireRow).Offset(, 1).Copy    Sheets(\"Sheet1\").Cells(Rows.Count, \"L\").End(xlUp).Offset(1)\n           cell.Interior.Color = vbYellow\n       End if\n    Next cell\nEnd With\n</code></pre>\n\n<p>You can then delete the first loop</p>\n\n<pre><code>For Each cell In Range(\"B2\", Cells(Rows.Count, \"B\").End(xlUp))\n  If Range(\"A:A\").Find(What:=cell.Value2, LookAt:=xlWhole) Is Nothing Then cell.Interior.Color = vbYellow\nNext cell\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 7476274, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ee964769913e1665cc9b7e36b81e05ca?s=128&d=identicon&r=PG&f=1", "display_name": "CC268", "link": "https://stackoverflow.com/users/7476274/cc268"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485906682, "creation_date": 1485903965, "question_id": 41969146, "link": "https://stackoverflow.com/questions/41969146/optimize-slow-vba-code", "title": "Optimize slow VBA code", "body": "<p>I have the following code - most of which was recorded with the macro recorder. It is slow and seems to be kind of unreliable (sometimes it takes about 1 minute and other times it takes much longer).</p>\n\n<p>I am wondering if anyone here can help me clean this up and get it to run more efficiently. </p>\n\n<p>Thanks!</p>\n\n<pre><code>Sub RemainingMIUL()\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\n\n    Sheets(\"Sheet2\").Select\n\n    Columns(\"A:A\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n\n    Sheets(\"Sheet1\").Select\n\n    ActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort.SortFields.Add Key:=Range _\n        (\"L1\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n        xlSortTextAsNumbers\n    With ActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\n    Columns(\"L:L\").Select\n    Selection.Copy\n\n    Sheets(\"Sheet2\").Select\n    Range(\"A1\").Select\n    ActiveSheet.Paste\n\n    Sheets(\"Sheet1\").Select\n\n    Application.CutCopyMode = False\n    ActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort.SortFields.Add Key:=Range _\n        (\"A1\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n        xlSortTextAsNumbers\n    With ActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\n    Sheets(\"Sheet2\").Select\n    Range(\"B2\").Select\n\n    Dim cell As Range\n\n    For Each cell In Range(\"B2\", Cells(Rows.Count, \"B\").End(xlUp))\n      If Range(\"A:A\").Find(What:=cell.Value2, LookAt:=xlWhole) Is Nothing Then cell.Interior.Color = vbYellow\n    Next cell\n\n    With Sheets(\"Sheet2\")\n        For Each cell In .Range(\"B2\", Cells(Rows.Count, \"B\").End(xlUp))\n            If .Range(\"A:A\").Find(What:=cell.Value2, LookAt:=xlWhole) Is Nothing Then _\n            Intersect(.UsedRange, cell.EntireRow).Offset(, 1).Copy _\n            Sheets(\"Sheet1\").Cells(Rows.Count, \"L\").End(xlUp).Offset(1)\n        Next cell\n    End With\n\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 1, "creation_date": 1485903256, "post_id": 41968863, "comment_id": 71116551, "body": "<a href=\"http://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices/5925/switch-off-properties-during-macro-execution#t=201701312253281756566\">This</a> will also help speed up your code.  Make sure you try the <code>Application.ScreenUpdating = False</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1485904252, "post_id": 41968863, "comment_id": 71116914, "body": "It probably isn&#39;t hanging - it&#39;s probably just not handed control back to Windows for a while and therefore Windows has stopped allowing screen updates.  (I notice that sort of thing when I include a <code>Application.StatusBar = &quot;...&quot;</code> in my code and forget to include a <code>DoEvents</code> after it - the status bar updates happily for a while, then stops, and then the code finally finishes and all is right with the world again.)"}, {"owner": {"reputation": 479, "user_id": 1617788, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/520166fcd7fc606f421657783d1adbda?s=128&d=identicon&r=PG", "display_name": "Grymjack", "link": "https://stackoverflow.com/users/1617788/grymjack"}, "edited": false, "score": 0, "creation_date": 1485906612, "post_id": 41968863, "comment_id": 71117690, "body": "<code>Application.ScreenUpdating = False</code> is used in the code.  This allows me to track the progress as it updates the cells it is cycling through.  The code, as best as I can tell, should take only about two minutes to complete.  This is based  on how quickly it goes through the first couple hundred cells.  With the pause, it takes about 6-7 minutes to finish.  I tried posting updates to the status bar in different places.  But it always seemed to hang at a different location."}, {"owner": {"reputation": 479, "user_id": 1617788, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/520166fcd7fc606f421657783d1adbda?s=128&d=identicon&r=PG", "display_name": "Grymjack", "link": "https://stackoverflow.com/users/1617788/grymjack"}, "edited": false, "score": 0, "creation_date": 1485907599, "post_id": 41968863, "comment_id": 71118005, "body": "Sometimes, but not always, I get the white blanked out &#39;(Not Responding)&#39; screen."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1485909522, "post_id": 41968863, "comment_id": 71118551, "body": "(a) If you have <code>Application.ScreenUpdating = False</code> then your screen shouldn&#39;t be updating and you shouldn&#39;t be able to see the updates to the cells it is cycling through.  (b) Try putting some <code>DoEvents</code> statements in your code (e.g. after your status bar updates) and see if the problem still occurs."}], "owner": {"reputation": 479, "user_id": 1617788, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/520166fcd7fc606f421657783d1adbda?s=128&d=identicon&r=PG", "display_name": "Grymjack", "link": "https://stackoverflow.com/users/1617788/grymjack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1485902598, "creation_date": 1485902598, "last_edit_date": 1531164843, "question_id": 41968863, "link": "https://stackoverflow.com/questions/41968863/excel-vba-code-that-pause-randomly-but-eventually-finishes-how-do-i-determine", "title": "Excel VBA code that pause randomly, but eventually finishes. How do I determine where the pause is happening?", "body": "<p>I have a large chunk of Excel VBA code that cycles through a group of cells performing a whole series of operations.  It pauses for a long period of time (2 min+-) randomly, or at least in a pattern I cannot detect.  The code will finish eventually without throwing a error.  I know this pause is happening because the cell receiving the end data is selected, centering it in the view of the sheet.  I can visually see that it is temporarily hanging, but not sure where in the code it is happening?  Any ideas on how to find out where this long pause is occurring?  Outside of totally refactoring the code and checking function completion times, I would appreciate any ideas how to come at this to locate the hang point.  One of the factors are up to six different workbooks being accessed for data (yes I know, use a database....legacy issues).</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485929816, "post_id": 41968622, "comment_id": 71124283, "body": "regarding 4. - use <code>Range(&quot;A1&quot;).ClearContents</code>"}], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1485917768, "last_edit_date": 1485917768, "creation_date": 1485902196, "answer_id": 41968771, "question_id": 41968622, "link": "https://stackoverflow.com/questions/41968622/vba-script-code-for-reading-a-xls-and-manipulating-cells/41968771#41968771", "title": "VBA Script Code for reading a xls and manipulating cells", "body": "<blockquote>\n  <ol start=\"2\">\n  <li>I want to read this destFile excel sheet via VBA code. I will doing some cell manipulation so please give me a working code to understand how that whole worksheet is read and how I can access a particular row while in a for loop.</li>\n  </ol>\n</blockquote>\n\n<pre><code>dim sh as Worksheet\nset sh =  Workbooks.Open(destFile).Worksheets(1)\n</code></pre>\n\n<blockquote>\n  <ol start=\"3\">\n  <li>I also want to know the code to add new column title and values to this destFile excel sheet via VBA code.</li>\n  </ol>\n</blockquote>\n\n<pre><code>sh.rows(1).Insert Shift := xlDown\nThisWorkbook.Worksheets(1).Rows(1).Copy sh.Rows(1)\n</code></pre>\n\n<blockquote>\n  <ol start=\"4\">\n  <li>Whats the code for just clearing the cell value via VBA code and not delete the cell.</li>\n  </ol>\n</blockquote>\n\n<pre><code>sh.Range(\"A1\").Value = \"\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1189, "user_id": 804735, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ff7882872b36e55b6633301908a9bccd?s=128&d=identicon&r=PG", "display_name": "Bhavani Kannan", "link": "https://stackoverflow.com/users/804735/bhavani-kannan"}, "is_accepted": true, "score": 0, "last_activity_date": 1486017608, "last_edit_date": 1486017608, "creation_date": 1485991048, "answer_id": 41991630, "question_id": 41968622, "link": "https://stackoverflow.com/questions/41968622/vba-script-code-for-reading-a-xls-and-manipulating-cells/41991630#41991630", "title": "VBA Script Code for reading a xls and manipulating cells", "body": "<p>I managed to get this done with the below code. \nThis is the worst way to code it and does not look anything sophisticated but it gets the job done.\nThanks!</p>\n\n<pre><code>Sub Format()\n\n'Copy and rename the file\nDim SourceFile As String, DestFile As String\nSourceFile = Range(\"D6\")\nSourceString = Range(\"D3\")\nTestSuiteName = Range(\"D2\") &amp; \"\\\"\nDestFile = Split(SourceFile, \".\")(0) + \"_Formated.xls\"\nOn Error GoTo ErrorHandler:\nSet fs = CreateObject(\"Scripting.FileSystemObject\")\nIf Not fs.FileExists(DestFile) Then\n    FileCopy SourceFile, DestFile\nEnd If\n\n'Read DestFile worksheet content\nDim wks As Worksheet\nSet wks = Workbooks.Open(DestFile).Worksheets(1)\n\nDim rowRange As Range\nDim colRange As Range\nDim LastCol As Long\nDim LastRow As Long\n\nLastRow = wks.Cells(wks.rows.Count, \"A\").End(xlUp).Row\n\nFor i = 2 To LastRow\n    If Cells(i, 6).Value = \"Step 1\" Then\n        Cells(i, 7) = \"Other_Migration_Fields\" &amp; Cells(i, 7) &amp; vbLf &amp; vbLf &amp; \"QC Path:\" &amp; Cells(i, 8)\n        Cells(i, 8) = Replace(Cells(i, 8), SourceString, TestSuiteName)\n    Else\n        Cells(i, 1) = \"\"\n        Cells(i, 2) = \"\"\n        Cells(i, 7) = \"\"\n        Cells(i, 8) = \"\"\n    End If\nNext i\n\nErrorHandler:\n    Msg = \"Error # \" &amp; Str(Err.Number) &amp; \" was generated by \" &amp; Err.Source &amp; Chr(13) &amp; \"Error Line: \" &amp; Erl &amp; Chr(13) &amp; Err.Description\n    If Err.Number &lt;&gt; 0 Then\n        MsgBox Msg, , \"Error\", Err.HelpFile, Err.HelpContext\n    Else\n        MsgBox \"Success!\"\n    End If\n    Exit Sub\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1189, "user_id": 804735, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ff7882872b36e55b6633301908a9bccd?s=128&d=identicon&r=PG", "display_name": "Bhavani Kannan", "link": "https://stackoverflow.com/users/804735/bhavani-kannan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 41991630, "answer_count": 2, "score": -2, "last_activity_date": 1486017608, "creation_date": 1485901625, "last_edit_date": 1531164843, "question_id": 41968622, "link": "https://stackoverflow.com/questions/41968622/vba-script-code-for-reading-a-xls-and-manipulating-cells", "title": "VBA Script Code for reading a xls and manipulating cells", "body": "<p>I have an excel sheet with just one worksheet. The first row of this excel sheet has the Title for the columns. </p>\n\n<p>The worksheet has data in below columns and n number of rows:</p>\n\n<p>Columns: A | B | C | D | E | F | G | H </p>\n\n<ol>\n<li><p>First I am creating a copy of the file and renaming it - This WORKS!</p>\n\n<pre><code>'Copy and rename the file\nDim sourceFile As String, destFile As String\nsourcePath = Range(\"D6\")\ndestFile = Split(sourcePath, \".\")(0) + \"_Formated.xls\"\nFileCopy sourcePath, destFile\n</code></pre></li>\n<li><p>I want to read this destFile excel sheet via VBA code. I will doing some cell manipulation so please give me a working code to understand how that whole worksheet is read and how I can access a particular row while in a for loop.</p></li>\n<li><p>I also want to know the code to add new column title and values to this destFile excel sheet via VBA code. </p></li>\n<li><p>Whats the code for just clearing the cell value via VBA code and not delete the cell.</p></li>\n</ol>\n"}, {"tags": ["vba", "excel", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5574077, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-hMwfbRuclHc/AAAAAAAAAAI/AAAAAAAACd8/KXJipRFjXPc/photo.jpg?sz=128", "display_name": "Grant", "link": "https://stackoverflow.com/users/5574077/grant"}, "edited": false, "score": 0, "creation_date": 1485953258, "post_id": 41969270, "comment_id": 71137888, "body": "Thanks for the link to OutlookSpy.  You were right, the FlagDueBy property was set to 1/1/4501, so I was actually getting the right data from outlook.  I should have been using the TaskDueDate property."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 0, "last_activity_date": 1485904703, "creation_date": 1485904703, "answer_id": 41969270, "question_id": 41968569, "link": "https://stackoverflow.com/questions/41968569/issue-passing-date-of-flagged-outlook-email-messages-using-vba/41969270#41969270", "title": "Issue passing date of flagged outlook email messages using vba", "body": "<p>Did you actually step through the code and make sure in the debugger <code>MailItem.FlagDueBy</code> property is set? </p>\n\n<p>Flagged emails do not usually have the <code>FlagDueBy</code> property set - Outlook sets the <code>TaskDueDate</code> property. Take a look at an existing flagged message in <a href=\"http://www.dimastr.com/outspy/\" rel=\"nofollow noreferrer\">OutlookSpy</a> (select the message, click the Item button).</p>\n"}], "owner": {"reputation": 15, "user_id": 5574077, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-hMwfbRuclHc/AAAAAAAAAAI/AAAAAAAACd8/KXJipRFjXPc/photo.jpg?sz=128", "display_name": "Grant", "link": "https://stackoverflow.com/users/5574077/grant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 41969270, "answer_count": 1, "score": 0, "last_activity_date": 1485904703, "creation_date": 1485901397, "question_id": 41968569, "link": "https://stackoverflow.com/questions/41968569/issue-passing-date-of-flagged-outlook-email-messages-using-vba", "title": "Issue passing date of flagged outlook email messages using vba", "body": "<p>I am using the following vba sub in ThisOutlookSession of Outlook to pass information regarding mail items that are flagged:</p>\n\n<pre><code>Private Sub Items_ItemChange(ByVal Item As Object)\n    Dim olNameSpace As Outlook.NameSpace\n    Dim olInbox  As Outlook.MAPIFolder\n    Set olNameSpace = Application.GetNamespace(\"MAPI\")\n    Set olInbox = olNameSpace.GetDefaultFolder(olFolderInbox)\n\n    Dim oXL As Excel.Application\n    Dim oBk As Workbook\n    Set oXL = GetObject(, \"Excel.Application\")\n\n    If TypeOf Item Is Outlook.MailItem Then\n        Debug.Print Item\n        If Item.FlagStatus = olFlagMarked Then\n            Set oBk = oXL.Workbooks(strBookName)\n            oBk.Activate\n            Call oXL.Run(\"DashboardCode.AddTask\", Item.Subject, Item.Body, Item.FlagDueBy, Item.FlagRequest, Item.FlagIcon)\n        End If\n\n        Set Item = Nothing\n    End If\nEnd Sub\n</code></pre>\n\n<p>The following vba function in excel receives the information and stores it in a spreadsheet:</p>\n\n<pre><code>Function AddTask(subject As String, body As String, dueDate As Date, flagText As String, respParty As String) As String\n    tasksFirstEmptyRow = FirstEmptyRow(\"Tasks\")\n    Dim sDate As String\n    sDate = Format(dueDate, \"dd-mm-yyyy\")\n    Sheets(\"Tasks\").Cells(tasksFirstEmptyRow, 1) = dueDate\n    Sheets(\"Tasks\").Cells(tasksFirstEmptyRow, 2) = respParty\n    Sheets(\"Tasks\").Cells(tasksFirstEmptyRow, 4) = flagText\n    Sheets(\"Tasks\").Cells(tasksFirstEmptyRow, 5) = subject\nEnd Function\n</code></pre>\n\n<p>No matter what the due date is for a flagged mail item, excel shows the due date as \"1/1/4501\".  </p>\n\n<p>What am I doing wrong? I've tried passing the .FlagDueBy property as different types and no matter what I do I get the same result.  </p>\n\n<p>Thanks for your help in advance.  </p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1135, "user_id": 3165466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef259905fd034ee6a4c74269b89d0457?s=128&d=identicon&r=PG&f=1", "display_name": "Gordon", "link": "https://stackoverflow.com/users/3165466/gordon"}, "edited": false, "score": 1, "creation_date": 1485900805, "post_id": 41968279, "comment_id": 71115600, "body": "I&#39;m not completely sure I understand what you&#39;re trying to achieve but it sounds like you want to populate an invoice template using a list of purchased products.  To do that you need to learn about vlookup or index search in order to extract data from your list.  It would be useful if you could show an example of your data and also an example of how you would like it to appear.  A picture is better than 1000 words."}], "answers": [{"tags": [], "owner": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "is_accepted": true, "score": 0, "last_activity_date": 1485938257, "last_edit_date": 1485938257, "creation_date": 1485902983, "answer_id": 41968931, "question_id": 41968279, "link": "https://stackoverflow.com/questions/41968279/printing-price-tag-according-to-purchase/41968931#41968931", "title": "Printing price tag according to purchase", "body": "<p>You could set up a dummy table to hold the multiple records that you want. When you click your button, you loop through the purchase order lines and for each line set up a loop for the number of pieces ordered and in that loop add a row to your dummy table. (Unverified) code:</p>\n\n<pre><code>CurrentDB.Execute \"DELETE FROM PriceTags\"   'PriceTags is your dummy table\nSet rsPurchaseLines = CurrentDB.OpenRecordset(\"select * from PurchaseLines where PurchaseNo = \" &amp; txtP_No)\nWith rsPurchaseLines\n    Do While Not .EOF\n        strInsertSQL = \"insert into PriceTags (TagDescription) values (\" &amp; _\n                       !ItemID &amp; \", '\" &amp; Replace(!ItemName, \"'\", \"''\") &amp; \"', \u00a3\" &amp; !ItemPrice &amp; \")\"\n        For intPieces = 1 To !Pieces\n            CurrentDB.Execute strInsertSQL\n        Next intPieces\n        .MoveNext\n    Loop\nEnd With\n\nSet rsPurchaseLines = Nothing\n</code></pre>\n\n<p>Then set up your report's record source to be the dummy PriceTags table.</p>\n"}], "owner": {"reputation": 133, "user_id": 7364729, "user_type": "registered", "profile_image": "https://graph.facebook.com/1810469202541175/picture?type=large", "display_name": "Imtiaz", "link": "https://stackoverflow.com/users/7364729/imtiaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 41968931, "answer_count": 1, "score": -2, "last_activity_date": 1594640560, "creation_date": 1485900023, "last_edit_date": 1594640560, "question_id": 41968279, "link": "https://stackoverflow.com/questions/41968279/printing-price-tag-according-to-purchase", "title": "Printing price tag according to purchase", "body": "<p>All the best to you all.</p>\n\n<p>I am gravely in need of a support. Please help if possible and forgive my weakness in English.</p>\n\n<p>The problem is i need to print various products' price tag in various numbers using an invoice no. I mean according to the amount of purchased products. Suppose pucrchase no 18. 1st purchased product is Pen which is purchased at 50 pieces and 2nd one is Apple at 100 pieces. i need to print pages (report) with 50 (33, Pen, \u00a30.25), 100 (34, Apple,\u00a30.5) etc in it with a single click. Is it possible?</p>\n\n<p>even links or videos will be enough if something like this is already solved.</p>\n\n<p>BTW, I've posted it to another site aas well. Thanks a lot for your time and support.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7497389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d1fb97cccfbe14ba0f219bd73ffa88?s=128&d=identicon&r=PG&f=1", "display_name": "gude1020", "link": "https://stackoverflow.com/users/7497389/gude1020"}, "edited": false, "score": 0, "creation_date": 1486501302, "post_id": 41968410, "comment_id": 71369999, "body": "This worked great! Thank you! You did have one typo though, it should be =IF(C9&gt;0,$C$3-SUM(C$5:C9),&quot;&quot;). Changing the C2 cell to C3."}, {"owner": {"reputation": 414, "user_id": 1401677, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/df98b6bb23a7408659044ce40b9b14c0?s=128&d=identicon&r=PG", "display_name": "Freda K", "link": "https://stackoverflow.com/users/1401677/freda-k"}, "reply_to_user": {"reputation": 3, "user_id": 7497389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d1fb97cccfbe14ba0f219bd73ffa88?s=128&d=identicon&r=PG&f=1", "display_name": "gude1020", "link": "https://stackoverflow.com/users/7497389/gude1020"}, "edited": false, "score": 0, "creation_date": 1486665064, "post_id": 41968410, "comment_id": 71454769, "body": "I fixed it. Thanks."}], "tags": [], "owner": {"reputation": 414, "user_id": 1401677, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/df98b6bb23a7408659044ce40b9b14c0?s=128&d=identicon&r=PG", "display_name": "Freda K", "link": "https://stackoverflow.com/users/1401677/freda-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1486664977, "last_edit_date": 1486664977, "creation_date": 1485900604, "answer_id": 41968410, "question_id": 41968267, "link": "https://stackoverflow.com/questions/41968267/how-to-replace-an-empty-cell-in-formula-with-last-numbered-cell/41968410#41968410", "title": "How to replace an empty cell in formula with last numbered cell", "body": "<p>Try this in cell E9</p>\n\n<pre><code>=IF(C9&gt;0,$C$3-SUM(C$5:C9),\"\")\n</code></pre>\n\n<p>I think this will serve the same purpose as calculating E6 - C9 (i.e. calculating how much of the budget is remaining), but it's simpler code.</p>\n\n<p>You should be able to copy it from E5 to the bottom of your table using regular copy-and-paste.</p>\n"}], "owner": {"reputation": 3, "user_id": 7497389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d1fb97cccfbe14ba0f219bd73ffa88?s=128&d=identicon&r=PG&f=1", "display_name": "gude1020", "link": "https://stackoverflow.com/users/7497389/gude1020"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 1, "accepted_answer_id": 41968410, "answer_count": 1, "score": 0, "last_activity_date": 1486664977, "creation_date": 1485899945, "question_id": 41968267, "link": "https://stackoverflow.com/questions/41968267/how-to-replace-an-empty-cell-in-formula-with-last-numbered-cell", "title": "How to replace an empty cell in formula with last numbered cell", "body": "<p>Working on a budget worksheet. I am trying to get the cell to keep looking up the column for one part of the formula if the previous cell is blank.</p>\n\n<p>I currently have the formula to give a blank cell in the 'Remaining' column (E) if the 'Budgeted' column (C) is blank, as seen here\n<a href=\"https://i.stack.imgur.com/cUHqM.jpg\" rel=\"nofollow noreferrer\">Budget clip</a></p>\n\n<p>The issue comes when trying to get a number in the 'Remaining' column when the previous cell above is blank. I would like it to keep looking up the column until it finds a number, then use that number in the equation.\nSo in the picture, for Expense 5 (A9) I would like it to take cell E6-C9.\nAnd then repeat the formula down the column.</p>\n\n<p>I would like to copy the formula down the column since filled and unfilled cells will change from month to month.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1486062184, "post_id": 41968203, "comment_id": 71196028, "body": "Please include the code you&#39;re using in your question. You can use the EDIT link to do so."}, {"owner": {"reputation": 2537, "user_id": 16162, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/fa04a94ebf6aabb8fbdb12a1818048f5?s=128&d=identicon&r=PG", "display_name": "Chloraphil", "link": "https://stackoverflow.com/users/16162/chloraphil"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1486062485, "post_id": 41968203, "comment_id": 71196204, "body": "Added code as requested"}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1486062768, "creation_date": 1486062768, "answer_id": 42010473, "question_id": 41968203, "link": "https://stackoverflow.com/questions/41968203/how-to-ensure-documentbeforesave-code-runs-only-on-current-document/42010473#42010473", "title": "How to ensure DocumentBeforeSave code runs only on current document", "body": "<p>Word's <code>DocumentBeforeSave</code> event provides the <code>Doc</code> parameter, which carries the document that triggered the event. Test whether that's the Document object in which you're interested. From your question, it seems the macro is part of the document, so something like:</p>\n\n<pre><code>If Doc Is ThisDocument Then Doc.Save\n</code></pre>\n"}], "owner": {"reputation": 2537, "user_id": 16162, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/fa04a94ebf6aabb8fbdb12a1818048f5?s=128&d=identicon&r=PG", "display_name": "Chloraphil", "link": "https://stackoverflow.com/users/16162/chloraphil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "accepted_answer_id": 42010473, "answer_count": 1, "score": 0, "last_activity_date": 1593934055, "creation_date": 1485899713, "last_edit_date": 1593934055, "question_id": 41968203, "link": "https://stackoverflow.com/questions/41968203/how-to-ensure-documentbeforesave-code-runs-only-on-current-document", "title": "How to ensure DocumentBeforeSave code runs only on current document", "body": "<p>I have a macro that runs when my document is saved as described here: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838299.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff838299.aspx</a>, however, this event fires when any open Word document is saved. How do I ensure that it only runs for the document in which the macro is defined?</p>\n\n<p>Edited to add code as requested:</p>\n\n<pre><code>Public WithEvents appWord as Word.Application \n\nPrivate Sub appWord_DocumentBeforeSave _ \n (ByVal Doc As Document, _ \n SaveAsUI As Boolean, _ \n Cancel As Boolean) \n\n Dim intResponse As Integer \n\n intResponse = MsgBox(\"Do you really want to \" _ \n &amp; \"save the document?\", _ \n vbYesNo) \n\n If intResponse = vbNo Then Cancel = True \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1485899038, "post_id": 41967817, "comment_id": 71114827, "body": "<code>On Error Resume Next</code> is a particularly bad idea here IMO. If you can&#39;t create the PowerPoint app instance, your code should bail out, not keep running as if nothing happened."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1485899141, "post_id": 41967817, "comment_id": 71114882, "body": "Can you <a href=\"https://stackoverflow.com/posts/41967817/edit\">edit</a> your question to clarify exactly what that code snippet is? Is it your attempt at making an invisible <code>pptApp</code>? Or an excerpt from the code that opens an existing ppt file? Because that code doesn&#39;t open anything at all, and seems to specify <code>.Visible = False</code>, so it&#39;s not clear how it connects with the actual question."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1485899304, "post_id": 41967817, "comment_id": 71114960, "body": "Also... you seem to have the PowerPoint library referenced (<code>As PowerPoint.Application</code> <i>does</i> compile, right?) - so why then are you late-binding the creation of the application instance? Just do <code>Set pptApp = New PowerPoint.Application</code>."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1485899501, "post_id": 41967817, "comment_id": 71115045, "body": "To clarify, <code>Err.Clear</code> is <b><i>not</i></b> the same thing as <code>On Error GoTo 0</code>.  The first just wipes the logged error - the second one actually re-enables error trapping."}, {"owner": {"reputation": 31, "user_id": 7406478, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c7c176b41a382877e7aa1760be5b08b3?s=128&d=identicon&r=PG&f=1", "display_name": "thePB", "link": "https://stackoverflow.com/users/7406478/thepb"}, "edited": false, "score": 0, "creation_date": 1485955772, "post_id": 41967817, "comment_id": 71139606, "body": "Thanks. I edited my code. I need to have the On error Resume Next because i paste some pictures on the slides and it gives me an error without that code, but wth it it pastes perfectly. Now, with the edited code, the presentation is still visible!"}, {"owner": {"reputation": 31, "user_id": 7406478, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c7c176b41a382877e7aa1760be5b08b3?s=128&d=identicon&r=PG&f=1", "display_name": "thePB", "link": "https://stackoverflow.com/users/7406478/thepb"}, "edited": false, "score": 0, "creation_date": 1485956727, "post_id": 41967817, "comment_id": 71140318, "body": "Also, i made the question really fast (sorry about that) and forgot to erase the .Visible = False, because it doesnt do anything. It even gives me an error saying i cant force the app to not be visible with that code. thanks"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7406478, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c7c176b41a382877e7aa1760be5b08b3?s=128&d=identicon&r=PG&f=1", "display_name": "thePB", "link": "https://stackoverflow.com/users/7406478/thepb"}, "edited": false, "score": 0, "creation_date": 1485955729, "post_id": 41968499, "comment_id": 71139583, "body": "Thanks. Ok, i edited my code according to your post and the other comments. But it is still visible, maybe because of my pptpresestation.add code?"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 2, "creation_date": 1485969077, "post_id": 41968499, "comment_id": 71148937, "body": "Presentations.Add takes an optional parameter, WithWindow.  Set pptPres = Presentations.Add(msoFalse) will give you a reference to a windowless (invisible) presentation that you can do most, if not all, things with."}, {"owner": {"reputation": 742, "user_id": 4056395, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/dd905348fdc682796f2afb6f35bc8b6e?s=128&d=identicon&r=PG&f=1", "display_name": "Ted Fitzpatrick", "link": "https://stackoverflow.com/users/4056395/ted-fitzpatrick"}, "edited": false, "score": 0, "creation_date": 1525730946, "post_id": 41968499, "comment_id": 87463817, "body": "I&#39;m using .Add to open an empty presentation file, then inserting files from an external file. When visible, this works fine however PPT crashes when I try to use invisible presentations..."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 2, "last_activity_date": 1485901082, "creation_date": 1485901082, "answer_id": 41968499, "question_id": 41967817, "link": "https://stackoverflow.com/questions/41967817/how-to-create-a-powerpoint-with-excel-vba-without-seeing-the-application/41968499#41968499", "title": "How to create a PowerPoint with Excel VBA without seeing the application", "body": "<p>Calling <code>.Active</code> on a <code>PowerPoint.Application</code> does just that - it activates it, which makes the window visible:</p>\n\n<pre><code>Dim ppt As PowerPoint.Application\nSet ppt = New PowerPoint.Application\nDebug.Print ppt.Visible  '&lt;--Prints 0 (msoFalse)\nppt.Activate             '&lt;--THIS SHOWS THE WINDOW.\nDebug.Print ppt.Visible  '&lt;--Prints -1 (msoTrue)\n</code></pre>\n\n<p>Just remove the <code>pptApp.Activate</code> line completely.  </p>\n\n<p>As mentioned in the comments, you also need to fix your error handler.  In this case, the best fix is by removing it completely.  <code>GetObject</code> returns an existing instance if it exists.  I'm assuming that when you say \"create a new PPT\" that you <strong><em>don't</em></strong> mean \"attach to a running PowerPoint instance if it exists, otherwise create a new one\".  That is what your code currently does.</p>\n\n<p>Also as mentioned in the comments, if you have a reference to Microsoft PowerPoint X.X Object Library (as evidenced by <code>Dim pptApp As PowerPoint.Application</code>), you shouldn't be using <code>CreateObject</code> either.  That's for late-binding.  If you have a reference, use early-binding.</p>\n\n<p>Finally, when you create a PowerPoint.Application, it's <strong><em>not visible by default</em></strong>. You can \"fix\" your code by reducing it to this one line:</p>\n\n<pre><code>Set pptApp = New PowerPoint.Application\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7406478, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c7c176b41a382877e7aa1760be5b08b3?s=128&d=identicon&r=PG&f=1", "display_name": "thePB", "link": "https://stackoverflow.com/users/7406478/thepb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6283, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1493933724, "creation_date": 1485898159, "last_edit_date": 1493933724, "question_id": 41967817, "link": "https://stackoverflow.com/questions/41967817/how-to-create-a-powerpoint-with-excel-vba-without-seeing-the-application", "title": "How to create a PowerPoint with Excel VBA without seeing the application", "body": "<p>I want to know how I can create a new PPT from Excel VBA (I already have the code) but without seeing the app while it is creating. I have found some insights but it only works when it opens an existing PPT file, but I am creating a new file. </p>\n\n<pre><code>Dim pptApp As PowerPoint.Application\nDim pptPres As PowerPoint.Presentation\nDim pptSlide As PowerPoint.Slide\nDim pptShape As PowerPoint.Shape\nDim excelTable As Excel.Range\nDim SlideTitle As String\nDim SlideText As String\nDim SlideObject As Object\nDim pptTextbox As PowerPoint.Shape\nDim SlideNumber As String\n\nOn Error Resume Next\nSet pptApp = New PowerPoint.Application\nErr.Clear\n\nSet pptPres = pptApp.Presentations.Add\npptPres.PageSetup.SlideSize = ppSlideSizeOnScreen\n</code></pre>\n"}, {"tags": ["vba", "hyperlink", "ms-word", "clipboard", "delphi-7"], "comments": [{"owner": {"reputation": 114, "user_id": 6270710, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ce6aa3c0a6c48501c3c96f4b473764f1?s=128&d=identicon&r=PG&f=1", "display_name": "Admiral Noisey Bottom", "link": "https://stackoverflow.com/users/6270710/admiral-noisey-bottom"}, "edited": false, "score": 0, "creation_date": 1486524317, "post_id": 41967803, "comment_id": 71378013, "body": "Not sure what your question actually is. Do you want to copy the contents of a DBGrid Field (a URL) to the Windows Clipboard?"}], "answers": [{"tags": [], "owner": {"reputation": 114, "user_id": 6270710, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ce6aa3c0a6c48501c3c96f4b473764f1?s=128&d=identicon&r=PG&f=1", "display_name": "Admiral Noisey Bottom", "link": "https://stackoverflow.com/users/6270710/admiral-noisey-bottom"}, "is_accepted": false, "score": 0, "last_activity_date": 1486527000, "creation_date": 1486527000, "answer_id": 42104537, "question_id": 41967803, "link": "https://stackoverflow.com/questions/41967803/delphi-7-0-dbgrid-ms-word-hyperlink/42104537#42104537", "title": "Delphi 7.0 DBGrid Ms-Word Hyperlink", "body": "<p>If what you are trying to do is copy a URL stored in a DBGrid Field you could do the following;</p>\n\n<pre><code>    BEGIN\n    IF DBGrid1.Fields[YourFieldIndex].IsNull THEN\n      ShowMessage('Empty field, nothing to copy!')\n    ELSE\n      clipboard.astext := DBGrid1.fields[YourFieldIndex].asstring\n    END;\n</code></pre>\n\n<p>Include in your Uses clipbrd;</p>\n\n<p>If you don't want to include clipbrd you could do it a quick and dirty way using a standard Edit Box.</p>\n\n<pre><code>Begin\n  Edit1.text := DBGrid1.fields[YourFieldIndex].asstring;\n  Edit1.CopyToClipboard\nEnd;\n</code></pre>\n\n<p>Put the chosen method into the OnClick event for a popup menu or where ever you need it.</p>\n\n<p>Assuming the contents of the field is a valid URL you can paste it anywhere you want, word documents, excel, whatever. </p>\n"}], "owner": {"reputation": 41, "user_id": 7422892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbQJr.jpg?s=128&g=1", "display_name": "SkyRaider", "link": "https://stackoverflow.com/users/7422892/skyraider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593910090, "creation_date": 1485898121, "last_edit_date": 1593910090, "question_id": 41967803, "link": "https://stackoverflow.com/questions/41967803/delphi-7-0-dbgrid-ms-word-hyperlink", "title": "Delphi 7.0 DBGrid Ms-Word Hyperlink", "body": "<p>Delphi, DBGrid, Right Click, Copy\nWhat I want to do is create a hyper link on the clip board, that can then be pasted into Word\nHooked up to a DBGrid on click event </p>\n"}, {"tags": ["vba", "postgresql", "sql-parser"], "answers": [{"comments": [{"owner": {"reputation": 2536, "user_id": 5982962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MMUja.jpg?s=128&g=1", "display_name": "Roman Tkachuk", "link": "https://stackoverflow.com/users/5982962/roman-tkachuk"}, "edited": false, "score": 0, "creation_date": 1486404812, "post_id": 41969508, "comment_id": 71320336, "body": "Are you try to use my function instead upper(json_value::text) ?"}], "tags": [], "owner": {"reputation": 2536, "user_id": 5982962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MMUja.jpg?s=128&g=1", "display_name": "Roman Tkachuk", "link": "https://stackoverflow.com/users/5982962/roman-tkachuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1485905960, "creation_date": 1485905960, "answer_id": 41969508, "question_id": 41967550, "link": "https://stackoverflow.com/questions/41967550/vba-translate-parsed-structure-to-postgresql/41969508#41969508", "title": "VBA: translate parsed structure to PostgreSQL", "body": "<p>Probably query is too complicate, but it does what do you need :-)</p>\n\n<p>Parametrs: \ncmd - just your structure to parsing\nop - possible operations\ntables - jsonb object for translating table names from short form to full (probably you just mean than 'b' -> 'bbg' and 'p' -> 'pulls' instead 'bp' -> 'bbg_pulls'). I run this query on 9.6 and use jsonb. You can change it to just json for 9.3</p>\n\n<pre><code>WITH q AS (\n     WITH param AS (\n        SELECT '[bp2][-1]/[bp5]'::text AS cmd,\n               '+-/%*'::text AS op,\n               '{\"bp\": \"bbg_pools\"}'::jsonb AS tables\n     ), precmd AS (\n        SELECT btrim(replace(translate(cmd, '[]', ',,'), ',,', ','), ',') AS precmd\n        FROM param\n     ), split AS (\n        SELECT i,\n               split_part(precmd, ',', i) AS part\n        FROM (\n            SELECT generate_series(1, length(precmd) - length(translate(precmd, ',', '')) + 1) AS i,\n                   precmd\n            FROM precmd\n            ) AS a\n     ) SELECT *,\n              CASE\n                  WHEN part ~ ('^[' || op || ']$') THEN\n                     ' ) ' || part || ' ( '\n                  WHEN tables-&gt;&gt;(translate(part, '0123456789', '')) != '' THEN\n                     'select val from '::text || (tables-&gt;&gt;(translate(part, '0123456789', '0')))  || ' where id = ' || translate(part, translate(part, '0123456789', '0'), '')\n                  WHEN part ~ '^[-]?[0-9]*$' THEN\n                     ' and val_date = (CURRENT_TIMESTAMP + (''' || part|| ' day'')::interval)::date '\n                  ELSE\n                     ' ERROR '\n                  END AS res\n       FROM param, precmd, split\n       ORDER BY i\n )\n SELECT 'SELECT (' || string_agg(res, ' ') || ')'\n FROM q;\n</code></pre>\n\n<p>Some explanation (for better understanding you can try run query with SELECT * FROM q instead aggregating).</p>\n\n<p>param CTE is just your paramters. In precmd I prepare cmd to split on parts and in split I do it.</p>\n\n<p>Result of this query is:</p>\n\n<pre><code>SELECT (select val from bbg_pools where id = 2  and val_date = (CURRENT_TIMESTAMP + ('-1 day')::interval)::date   ) / (  select val from bbg_pools where id = 5)\n</code></pre>\n"}], "owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1485905960, "creation_date": 1485897083, "last_edit_date": 1492087359, "question_id": 41967550, "link": "https://stackoverflow.com/questions/41967550/vba-translate-parsed-structure-to-postgresql", "title": "VBA: translate parsed structure to PostgreSQL", "body": "<p>I'm looking to translate parsed structure to PostgreSQL. Hopefully, I am asking this correctly. </p>\n\n<p>Is there code out there to do this already?</p>\n\n<p>For more color, the need arose from this question/answer:\n<a href=\"https://dba.stackexchange.com/questions/162784/postgresql-translating-user-defined-calculations-into-executable-calculation-in\">https://dba.stackexchange.com/questions/162784/postgresql-translating-user-defined-calculations-into-executable-calculation-in</a></p>\n\n<p>Note this part of the question: \"Use an off-the-shelf solution that can translate the parsed structure to SQL. Most languages have something that can do this, like SQL::Abstract. If not, you gotta create it.\"</p>\n\n<p>Edit: We are using PostgreSQL 9.3.5, if it matters.</p>\n"}, {"tags": ["vba", "excel", "drop-down-menu", "multipleselection"], "owner": {"reputation": 11, "user_id": 5927691, "user_type": "registered", "profile_image": "https://graph.facebook.com/482639191938415/picture?type=large", "display_name": "Evelyn Stephens", "link": "https://stackoverflow.com/users/5927691/evelyn-stephens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1485896838, "creation_date": 1485896838, "question_id": 41967497, "link": "https://stackoverflow.com/questions/41967497/how-to-combine-two-seperate-excel-code-modifications-to-work-on-one-sheet", "title": "How to combine two seperate excel code modifications to work on one sheet?", "body": "<p>I am making a extremely large excel sheet and adding modifications to suit my needs, however I have come across an issue with getting these two process to apply on the same sheet.</p>\n\n<p>For example, the first modification allows for multiple selections in excel drop down lists:</p>\n\n<pre><code>**Option Explicit\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nDim rngDV As Range\nDim oldVal As String\nDim newVal As String\nDim lUsed As Long\nIf Target.Count &gt; 1 Then GoTo exitHandler\nOn Error Resume Next\nSet rngDV = Cells.SpecialCells(xlCellTypeAllValidation)\nOn Error GoTo exitHandler\nIf rngDV Is Nothing Then GoTo exitHandler\nIf Intersect(Target, rngDV) Is Nothing Then\n   'do nothing\nElse\n  Application.EnableEvents = False\n  newVal = Target.Value\n  Application.Undo\n  oldVal = Target.Value\n  Target.Value = newVal\n  If Target.Column = 3 _\n    Or Target.Column = 9 Then\n    'enter desired column to apply multiple selection before the _\n    'Add code: \"Or Target.Column\" before each column number you wish to apply multiple selection to'\n    'end the last line indicating the columns with no underscore and add \"Then\"\n    If oldVal = \"\" Then\n      'do nothing\n      Else\n      If newVal = \"\" Then\n      'do nothing\n      Else\n        lUsed = InStr(1, oldVal, newVal)\n        If lUsed &gt; 0 Then\n            If Right(oldVal, Len(newVal)) = newVal Then\n                Target.Value = Left(oldVal, Len(oldVal) - Len(newVal) - 2)\n            Else\n                Target.Value = Replace(oldVal, newVal &amp; \", \", \"\")\n            End If\n        Else\n            Target.Value = oldVal _\n              &amp; \", \" &amp; newVal\n        End If\n\n      End If\n    End If\n  End If\nEnd If\nexitHandler:\n  Application.EnableEvents = True\nEnd Sub**\n</code></pre>\n\n<p>And now I want to add a modification that auto completes the drop down selection according to the first couple of letters you type when you double click (for drop down lists that are 100+ entries). They work separately but I cannot get them to work together in one column (or even on the same sheet):</p>\n\n<pre><code>Option Explicit\n' Developed by Contextures Inc.\n' www.contextures.com\nPrivate Sub TempCombo_KeyDown(ByVal _\n        KeyCode As MSForms.ReturnInteger, _\n        ByVal Shift As Integer)\n'move to next cell on Enter and Tab\nDim varVal As Variant\nOn Error Resume Next\n 'change text value to number, if possible\nvarVal = --ActiveCell.Value\nIf IsEmpty(varVal) Then\n  varVal = ActiveCell.Value\nEnd If\n\nSelect Case KeyCode\n  Case 9  'tab\n    ActiveCell.Value = varVal\n    ActiveCell.Offset(0, 1).Activate\n  Case 13 'enter\n    ActiveCell.Value = varVal\n    ActiveCell.Offset(1, 0).Activate\n  Case Else\n    'do nothing\nEnd Select\n\nEnd Sub\n\nPrivate Sub TempCombo_LostFocus()\n  With Me.TempCombo\n    .Top = 10\n    .Left = 10\n    .Width = 0\n    .ListFillRange = \"\"\n    .LinkedCell = \"\"\n    .Visible = False\n    .Value = \"\"\n  End With\nEnd Sub\n\nPrivate Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\nDim str As String\nDim cboTemp As OLEObject\nDim ws As Worksheet\nDim wsList As Worksheet\n\nSet ws = ActiveSheet\nSet wsList = Sheets(\"ValidationLists\")\nSet cboTemp = ws.OLEObjects(\"TempCombo\")\n  On Error Resume Next\n  With cboTemp\n    .ListFillRange = \"\"\n    .LinkedCell = \"\"\n    .Visible = False\n  End With\nOn Error GoTo errHandler\n  If Target.Validation.Type = 3 Then\n   Cancel = True\n    Application.EnableEvents = False\n    str = Target.Validation.Formula1\n    str = Right(str, Len(str) - 1)\n    With cboTemp\n      .Visible = True\n      .Left = Target.Left\n      .Top = Target.Top\n      .Width = Target.Width + 15\n      .Height = Target.Height + 5\n      .ListFillRange = str\n      .LinkedCell = Target.Address\n    End With\n    cboTemp.Activate\n  End If\n\nerrHandler:\n  Application.EnableEvents = True\n  Exit Sub\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1485895811, "post_id": 41967183, "comment_id": 71113219, "body": "Dim <code>sum</code> as <code>Double</code> instead of Single.  Also, use a <code>For Each</code> loop instead of a <code>For i = 1 to nrow</code>"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1485895868, "post_id": 41967183, "comment_id": 71113247, "body": "I&#39;m also assuming you&#39;re doing this as an exercise to practice VBA, because there&#39;s already a built in Excel function to calculate an average <code>=AVERAGE(H2:H10)</code>"}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1485895879, "post_id": 41967183, "comment_id": 71113251, "body": "Is there any particular reason you&#39;re not using the built-in Excel function AVERAGE?"}, {"owner": {"reputation": 19, "user_id": 5387675, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Z2NqE.jpg?s=128&g=1", "display_name": "Weber Chen", "link": "https://stackoverflow.com/users/5387675/weber-chen"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1485896497, "post_id": 41967183, "comment_id": 71113611, "body": "That&#39;s right @tigeravatar. I am practicing VBA."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 5387675, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Z2NqE.jpg?s=128&g=1", "display_name": "Weber Chen", "link": "https://stackoverflow.com/users/5387675/weber-chen"}, "edited": false, "score": 0, "creation_date": 1485896591, "post_id": 41967340, "comment_id": 71113675, "body": "Moreno, I really appreciate that your help. Thank you so much!"}], "tags": [], "owner": {"reputation": 531, "user_id": 6254149, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/1UvBh.jpg?s=128&g=1", "display_name": "Moreno", "link": "https://stackoverflow.com/users/6254149/moreno"}, "is_accepted": false, "score": 0, "last_activity_date": 1485896190, "creation_date": 1485896190, "answer_id": 41967340, "question_id": 41967183, "link": "https://stackoverflow.com/questions/41967183/create-a-function-to-calculate-mean-of-selected-range-in-vba/41967340#41967340", "title": "Create a function to calculate mean of selected range in VBA", "body": "<p>Your mistake is in <code>col</code> initialization because the correct form is:</p>\n\n<pre><code> col=rng.columns.count\n</code></pre>\n\n<p>This code works perfectly:</p>\n\n<pre><code>Option Base 1\nFunction avg(rng As Range) As Single\n\n  Dim i%, nrow%, ncol%, j%\n  Dim sum As Single\n\n  nrow = rng.Rows.Count\n  ncol = rng.Columns.Count\n  sum = 0\n\n  For i = 1 To nrow\n   For j = 1 To ncol\n      sum = sum + rng(i, j)\n      Next j\n  Next i\n  avg = sum / (nrow * ncol)\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 5387675, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Z2NqE.jpg?s=128&g=1", "display_name": "Weber Chen", "link": "https://stackoverflow.com/users/5387675/weber-chen"}, "edited": false, "score": 0, "creation_date": 1485898229, "post_id": 41967473, "comment_id": 71114445, "body": "Thank you so much, Tigeravatar. I would enjoy learning from your code."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1485897621, "last_edit_date": 1485897621, "creation_date": 1485896688, "answer_id": 41967473, "question_id": 41967183, "link": "https://stackoverflow.com/questions/41967183/create-a-function-to-calculate-mean-of-selected-range-in-vba/41967473#41967473", "title": "Create a function to calculate mean of selected range in VBA", "body": "<p>Might be a bit advanced, but here's a more robust version for a VBA Average function, which I hope helps you learn VBA:</p>\n\n<pre><code>Public Function AverageVBA(ParamArray vValues() As Variant) As Variant\n\n    Dim vValue As Variant\n    Dim vSubValue As Variant\n    Dim dSum As Double\n    Dim lCount As Long\n\n    dSum = 0\n    lCount = 0\n\n    For Each vValue In vValues\n        If IsArray(vValue) Or TypeName(vValue) = \"Collection\" Or TypeName(vValue) = \"Range\" Then\n            For Each vSubValue In vValue\n                If IsNumeric(vSubValue) And Len(vSubValue) &gt; 0 Then\n                    lCount = lCount + 1\n                    dSum = dSum + vSubValue\n                End If\n            Next vSubValue\n        Else\n            If IsNumeric(vValue) And Len(vValue) &gt; 0 Then\n                lCount = lCount + 1\n                dSum = dSum + vValue\n            End If\n        End If\n    Next vValue\n\n    If lCount = 0 Then\n        AverageVBA = CVErr(xlErrDiv0)\n    Else\n        AverageVBA = dSum / lCount\n    End If\n\nEnd Function\n</code></pre>\n\n<p><strong>EDIT</strong> After testing and updating the UDF, got it working exactly like the built in Average function</p>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1486194896, "post_id": 41968344, "comment_id": 71249549, "body": "@WeberChen, did you get through it?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1485900300, "creation_date": 1485900300, "answer_id": 41968344, "question_id": 41967183, "link": "https://stackoverflow.com/questions/41967183/create-a-function-to-calculate-mean-of-selected-range-in-vba/41968344#41968344", "title": "Create a function to calculate mean of selected range in VBA", "body": "<p>Since OP is willing to become proficient in VBA it could be useful for him to see what was wrong in its original code</p>\n\n<pre><code>Function avg(rng As Range) As Single\n  Dim cell As Range\n  Dim sum As Double\n\n  For Each cell In rng.SpecialCells(xlCellTypeConstants, xlNumbers) '&lt;--| loop through each single cell of passed range that contains a number\n      sum = sum + cell.Value '&lt;--| update sum\n  Next\n  avg = sum / rng.Count '&lt;--| return average\nEnd Function\n</code></pre>\n\n<p>See <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196157.aspx\" rel=\"nofollow noreferrer\">here</a> for <code>SpecialCells()</code> method</p>\n"}], "owner": {"reputation": 19, "user_id": 5387675, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Z2NqE.jpg?s=128&g=1", "display_name": "Weber Chen", "link": "https://stackoverflow.com/users/5387675/weber-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1888, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1485900300, "creation_date": 1485895599, "question_id": 41967183, "link": "https://stackoverflow.com/questions/41967183/create-a-function-to-calculate-mean-of-selected-range-in-vba", "title": "Create a function to calculate mean of selected range in VBA", "body": "<p>I try to create a user defined function in Excel. In order to get the average number of any selected range, let's say the range of cells of H2 to H10, I create the following function. </p>\n\n<pre><code>Function avg(rng As Range) As Single\n\n  Dim i%, nrow%, col%\n  Dim sum As Single\n\n  nrow = rng.Rows.Count\n  col = rng.Column\n  sum = 0\n\n  For i = 1 To nrow\n      sum = sum + Cells(i, col).Value\n  Next i\n\n  avg = sum / nrow\n\nEnd Function\n</code></pre>\n\n<p>However, when I enter the function in a cell and select the range of H1 to H10, the result gives a wrong average number. I don't even know how the number is calculated. \nThanks for the help.</p>\n"}]