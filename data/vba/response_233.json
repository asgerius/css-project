[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 4, "creation_date": 1561593474, "post_id": 56782226, "comment_id": 100119397, "body": "You&#39;ll need to loop over the <code>Characters</code> collection and check each one in turn"}, {"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1561594162, "post_id": 56782226, "comment_id": 100119512, "body": "May you show an example please?"}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1561602352, "post_id": 56782226, "comment_id": 100120763, "body": "What is the goal you are trying to achieve?"}, {"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1561612369, "post_id": 56782226, "comment_id": 100122757, "body": "I want to identify all formatting in order to analyse later if there is something to fix, for example, some cells that should have some font name or font color have other, then I need to change later accordingly."}], "answers": [{"comments": [{"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1561611860, "post_id": 56782422, "comment_id": 100122617, "body": "Thanks Tim. It helped a lot your example. I was able to include the <code>Characters</code> evaluation in my code."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1561594624, "creation_date": 1561594624, "answer_id": 56782422, "question_id": 56782226, "link": "https://stackoverflow.com/questions/56782226/how-to-identify-all-format-properties-in-each-cell-vba/56782422#56782422", "title": "How to identify all format properties in each cell VBA?", "body": "<p>You'll need to loop over each cell's <code>Characters</code> collection and check each character in turn.</p>\n\n<p>For example:</p>\n\n<pre><code>Sub Tester()\n    Dim rng As Range, c, n As Long\n    Set rng = Range(\"A1\")\n\n    For n = 1 To rng.Characters.Count\n        With rng.Characters(n, 1)\n            Debug.Print n, \"Bold\", .Font.Bold\n            Debug.Print n, \"Color\", .Font.ColorIndex\n        End With\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 56782422, "answer_count": 1, "score": 0, "last_activity_date": 1561614458, "creation_date": 1561592714, "last_edit_date": 1561614458, "question_id": 56782226, "link": "https://stackoverflow.com/questions/56782226/how-to-identify-all-format-properties-in-each-cell-vba", "title": "How to identify all format properties in each cell VBA?", "body": "<p>I want to get the format properties of each cell in column E. I have no issue to identify the properties if the text that is \nin each cell has a unique Font.Name, Font.Size, Font.ColorIndex and Font.FontStyle.</p>\n\n<p>The issue I have is that in some cells there is text with one format and other text with another and in that case my current code it seems that is only printing\n the format of the first character.</p>\n\n<p>for example in one cell is <code>abc def.</code>, where abc is Arial, 9, black, Regular and def is Calibri, 18, green, Bold:</p>\n\n<p>How to identify all format properties in each cell?</p>\n\n<p>My current code is below:</p>\n\n<pre><code>Sub GetFormat()\n    For i = 1 To 8\n        nName = Cells(i, \"E\").Font.Name\n        sSize = Cells(i, \"E\").Font.Size\n        cColor = Cells(i, \"E\").Font.ColorIndex\n        sStyle = Range(\"E\" &amp; i).Font.FontStyle\n        Cells(i, \"A\") = nName\n        Cells(i, \"B\") = sSize\n        Cells(i, \"C\") = cColor\n        Cells(i, \"D\") = sStyle\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2790, "user_id": 5137782, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/b8bQ8.jpg?s=128&g=1", "display_name": "8protons", "link": "https://stackoverflow.com/users/5137782/8protons"}, "edited": false, "score": 0, "creation_date": 1561589336, "post_id": 56781668, "comment_id": 100118552, "body": "What is the value of <code>Cells(i, 83).Value</code> at the time of error? Are you running this in a debugger?"}, {"owner": {"reputation": 11, "user_id": 11699981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6b5ade3618d2ac3fcf99569ddb7af59?s=128&d=identicon&r=PG&f=1", "display_name": "LightBulb", "link": "https://stackoverflow.com/users/11699981/lightbulb"}, "reply_to_user": {"reputation": 2790, "user_id": 5137782, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/b8bQ8.jpg?s=128&g=1", "display_name": "8protons", "link": "https://stackoverflow.com/users/5137782/8protons"}, "edited": false, "score": 0, "creation_date": 1561589690, "post_id": 56781668, "comment_id": 100118638, "body": "In the debugger, value = &quot;Error 2015&quot; and type= &quot;Variant/Error.&quot; Also, Context lists: &quot;Sheet1.Hide_Unused_Rows.&quot;"}, {"owner": {"reputation": 2790, "user_id": 5137782, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/b8bQ8.jpg?s=128&g=1", "display_name": "8protons", "link": "https://stackoverflow.com/users/5137782/8protons"}, "edited": false, "score": 0, "creation_date": 1561590060, "post_id": 56781668, "comment_id": 100118718, "body": "I updated my answer based on your reply"}], "answers": [{"tags": [], "owner": {"reputation": 2790, "user_id": 5137782, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/b8bQ8.jpg?s=128&g=1", "display_name": "8protons", "link": "https://stackoverflow.com/users/5137782/8protons"}, "is_accepted": false, "score": 0, "last_activity_date": 1561590045, "last_edit_date": 1561590045, "creation_date": 1561589663, "answer_id": 56781881, "question_id": 56781668, "link": "https://stackoverflow.com/questions/56781668/how-to-fix-run-time-error-13-type-mismatch-error-in-excel-vba/56781881#56781881", "title": "How to fix &quot;Run-time error &#39;13&#39;: Type mismatch&quot; error in Excel-VBA?", "body": "<p><strong>Edited to remark on your comment:</strong></p>\n\n<p>You commented </p>\n\n<blockquote>\n  <p>In the debugger, value = \"Error 2015\" and type= \"Variant/Error\" </p>\n</blockquote>\n\n<p>This error means that your <code>Value</code> at run time is <code>#VALUE!</code>. You can handle this event properly by first using the following conditional:</p>\n\n<pre><code> If Not IsError(Cells(i, 83).Value) Then\n   ...\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11699981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6b5ade3618d2ac3fcf99569ddb7af59?s=128&d=identicon&r=PG&f=1", "display_name": "LightBulb", "link": "https://stackoverflow.com/users/11699981/lightbulb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 813, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1561614443, "creation_date": 1561587884, "last_edit_date": 1561614443, "question_id": 56781668, "link": "https://stackoverflow.com/questions/56781668/how-to-fix-run-time-error-13-type-mismatch-error-in-excel-vba", "title": "How to fix &quot;Run-time error &#39;13&#39;: Type mismatch&quot; error in Excel-VBA?", "body": "<p>Every time the cell A15 changes, I am trying to run 2 macros.</p>\n\n<ol>\n<li>Unhide all rows, then </li>\n<li>Hide all rows that have a zero value in column 82</li>\n</ol>\n\n<p>I receive an error in my <code>Hide_Unused_Rows</code> macro along my <code>if</code> statement. I am unsure how to go about fixing this issue. I have tried changing it to equal \"\" and it still will not work. I am new to VBA and I am unsure how to fix the <code>If Cells (i, 82).Value = 0</code> condition. </p>\n\n<p>Every once in a while it will run fine but the majority of the time I get this error. </p>\n\n<p>Any advice?</p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Address = \"$A$15\" Then\n        Call UnHideRows\n        Call Hide_Unused_Rows\n    End If\nEnd Sub\n\nSub UnHideRows()\nRows(\"20:258\").Hidden = False\nEnd Sub\n\nSub Hide_Unused_Rows()\n    Dim i As Integer\n    Application.ScreenUpdating = False\n    For i = 20 To 257\n        If Cells(i, 82).Value = 0 Then\n            Rows(i).EntireRow.Hidden = True\n        End If\n    Next\n    MsgBox \"Completed\"\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Type mismatch</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1561608804, "post_id": 56781572, "comment_id": 100121925, "body": "It&#39;s not really clear what you&#39;re looking for / what you&#39;re trying to do. Can you provide some sort of example of what the source is, what result you&#39;re getting and the result you want?"}], "answers": [{"tags": [], "owner": {"reputation": 2670, "user_id": 3826387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0bc3e39607231181fa257d9b280247a?s=128&d=identicon&r=PG&f=1", "display_name": "RobertBaron", "link": "https://stackoverflow.com/users/3826387/robertbaron"}, "is_accepted": false, "score": 0, "last_activity_date": 1561589937, "creation_date": 1561589937, "answer_id": 56781912, "question_id": 56781572, "link": "https://stackoverflow.com/questions/56781572/is-it-possible-to-add-textfield-to-an-array/56781912#56781912", "title": "Is it possible to add textfield to an array?", "body": "<p>This will create a new <code>FormField</code> by adding it to the <code>FormFields</code> collection, and also add the new <code>FormField</code> to array <code>a</code>.</p>\n\n<pre><code>Dim a(1 To 1) As FormField\nSet a(1) = FormFields.Add(Range:=Selection.Range, Type:=wdFieldFormCheckBox)\n</code></pre>\n\n<p>Is this what you want to do?</p>\n"}, {"tags": [], "owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "is_accepted": false, "score": 1, "last_activity_date": 1561676301, "creation_date": 1561676301, "answer_id": 56799304, "question_id": 56781572, "link": "https://stackoverflow.com/questions/56781572/is-it-possible-to-add-textfield-to-an-array/56799304#56799304", "title": "Is it possible to add textfield to an array?", "body": "<p>If you are after just the text of the field you might be able to use:</p>\n\n<p><code>ActiveDocument.Range.TextRetrievalMode.IncludeFieldCodes = False</code></p>\n\n<p>see: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.textretrievalmode\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/word.textretrievalmode</a></p>\n"}], "owner": {"reputation": 1, "user_id": 9329855, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/140Lj.jpg?s=128&g=1", "display_name": "Noah", "link": "https://stackoverflow.com/users/9329855/noah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1561676301, "creation_date": 1561587142, "last_edit_date": 1561608561, "question_id": 56781572, "link": "https://stackoverflow.com/questions/56781572/is-it-possible-to-add-textfield-to-an-array", "title": "Is it possible to add textfield to an array?", "body": "<p>I've set up a macro to convert Word tables to array, but some of the cells contain empty text form fields. I'm wondering if there is a way to include these in a VBA array? Other tables have mixed string and field, which may be a separate problem, I thought I'd start with the simplest version first.</p>\n\n<p>The end goal is to try to get a table with Autocorrect codes in one column and Autocorrect text in the other to automatically get added to Proofing/Autocorrect via AutoCorrect.Entries.AddRichText.</p>\n\n<p>I took a look at the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.formfield\" rel=\"nofollow noreferrer\">FormField object description</a> since this seemed on topic, and I could see how I might use the Add method to insert fields directly into a selection area. But this doesn't help get a field in an array. </p>\n\n<p>I found an <a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.wdfieldtype\" rel=\"nofollow noreferrer\">enumeration for word fields</a> but that likewise doesn't seem useful to add field to an array. </p>\n\n<pre><code>' ... var set up omitted\n\nReDim MyT(TRow - 1, TCol - 1) As Variant\n\n' ... looping through cells of table code omitted\n\nOCell.Select\nIf Selection.Fields.Count &gt; 0 Then\n    MyT(A, B) = wdFieldFormTextInput \nElse\n    MyT(A, B) = Selection.Text\nEnd If\n</code></pre>\n\n<p>I have a later function that displays the array, but for the code above it just subs in the enum value of 70 for the wdFieldFormTextInput, which makes sense but was definitely not what I was hoping for.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1561590122, "post_id": 56781497, "comment_id": 100118735, "body": "What&#39;s the relative path? Is it going to be in the same folder or network share?"}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1561601740, "post_id": 56781497, "comment_id": 100120667, "body": "You could be looking for the <code>Environ()</code> function.  Type <code>?Environ(&quot;USERPROFILE&quot;)</code> or <code>?Environ(&quot;APPDATA&quot;)</code> in the immediate window for a quick example."}], "answers": [{"tags": [], "owner": {"reputation": 1540, "user_id": 4705583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iBboA.jpg?s=128&g=1", "display_name": "Rich Michaels", "link": "https://stackoverflow.com/users/4705583/rich-michaels"}, "is_accepted": false, "score": 0, "last_activity_date": 1561683857, "last_edit_date": 1561683857, "creation_date": 1561602662, "answer_id": 56783128, "question_id": 56781497, "link": "https://stackoverflow.com/questions/56781497/how-i-can-use-a-relative-path-to-access-a-building-block-in-my-macro/56783128#56783128", "title": "How I can use a relative path to access a building block in my macro?", "body": "<p>There are a couple of ways to get the path to Word's STARTUP folder in the user's home directory (the path is relative to each unique user).</p>\n\n<p>The easiest way for your purpose is probably:</p>\n\n<pre><code>Application.Templates(Application.Options.DefaultFilePath(wdStartupPath) &amp; \"\\\" &amp; _\n    \"Templates.dotm\").BuildingBlockEntries(\"Sample_Table\").Insert _\n    Where:=Selection.Range, RichText:=True\n</code></pre>\n\n<p>However, there might be times when you want to scan through all global add-ins and base your decisions on what is found. Below is sample code for how that is done:</p>\n\n<pre><code>Sub FindAddin()\n    Dim WordAddin As Word.AddIn\n    Dim i As Long\n    For i = 1 To Application.AddIns.Count\n        If Application.AddIns(i).Name = \"Templates.dotm\" Then\n            Set WordAddin = Application.AddIns(i)\n            Exit For\n        End If\n    Next\n    If WordAddin Is Nothing Then Exit Sub\n    Application.Templates(WordAddin.path &amp; \"\\\" &amp; _\n        WordAddin.Name).BuildingBlockEntries(\"Sample_Table\").Insert _\n        Where:=Selection.Range, RichText:=True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 9131829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68be4a8c96b33b73cb50cbecd53a674b?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9131829/jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561683857, "creation_date": 1561586573, "last_edit_date": 1561609668, "question_id": 56781497, "link": "https://stackoverflow.com/questions/56781497/how-i-can-use-a-relative-path-to-access-a-building-block-in-my-macro", "title": "How I can use a relative path to access a building block in my macro?", "body": "<p>I want to use a building block of a table that will be stored in a .dotm that is the user's STARTUP folder. However, I only know how to write the macro using an absolute file path but this won't work because the .dotm will be shared.</p>\n\n<p>The .dotm file will also store the building block titled \"sample table\" and has everything formatted. I know I can rebuild the table using VBA but the widths never work out the way I need so I am trying using building blocks. </p>\n\n<pre><code>Application.Templates( _\n    \"C:\\Users\\MYUSER\\AppData\\Roaming\\Microsoft\\Word\\STARTUP\\Templates.dotm\" _\n    ).BuildingBlockEnries(\"sample_table\").Insert Where:=Selection. _\n    Range, RichTest:=True\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": true, "score": 2, "last_activity_date": 1561623425, "last_edit_date": 1561623425, "creation_date": 1561602561, "answer_id": 56783119, "question_id": 56781169, "link": "https://stackoverflow.com/questions/56781169/read-an-f5-configuration-file-in-excel-retrieve-values-between-brackets-in-diff/56783119#56783119", "title": "Read an F5 Configuration File in excel (retrieve values between brackets in different lines)", "body": "<p>It is brute force method parsing of the file though there may be other easy way of parsing the file. You may try this and modify to your requirement. Array used are dimmed as (1 to 100) for quick test, but you may use <code>Redim</code> to make efficient use of it. I made Output format something different to my choice, may also modify it to your choice. </p>\n\n<p>Obviously the code would work correctly only if every starting curly brace have corresponding closing curly brace and nested correctly.</p>\n\n<p>Code:</p>\n\n<pre><code>Option Explicit\nSub ParseConfigFile()\nDim Fno As Integer, Xstr As String, Fname As String\nDim lvl As Integer, i As Integer, x As Integer, y As Integer, Rw As Integer\nDim Ws As Worksheet, Xchr As String\nSet Ws = ThisWorkbook.ActiveSheet\n\nFno = FreeFile\nFname = \"C:\\Users\\user\\Desktop\\ConfigSample.txt\"\nOpen Fname For Input As #Fno\nXstr = Input(LOF(Fno), Fno)\nClose #Fno\n\nXstr = Replace(Xstr, vbCrLf, \"\")\nXstr = Replace(Xstr, \"/\", \"|\")\n\n\nDim Snest(1 To 100, 1 To 100) As Variant, Enest(1 To 100, 1 To 100) As Variant\nDim path(1 To 100) As Variant\n\nFor x = 1 To 100\nFor y = 1 To 100\nSnest(x, y) = 0\nEnest(x, y) = 0\nNext\nNext\n\nlvl = 1\npath(lvl) = 1\nSnest(path(lvl), 1) = 1\nRw = 1\n    For x = 1 To Len(Xstr)\n    Xchr = Mid(Xstr, x, 1)\n        If Xchr = \"{\" Then\n        'Debug.Print \"{\", x, lvl, path(lvl)\n        Enest(path(lvl), lvl) = x - 1\n            'rw = rw + 1\n            'For i = 1 To lvl\n            'Ws.Cells(rw, i).Value = Trim(Mid(Xstr, Snest(path(i), i), Enest(path(i), i) - Snest(path(i), i) + 1))\n            'Next\n        lvl = lvl + 1\n        path(lvl) = path(lvl) + 1\n        Snest(path(lvl), lvl) = x + 1\n        End If\n\n        If Xchr = \"}\" Then\n        'Debug.Print x, lvl, path(lvl)\n        Enest(path(lvl), lvl) = x - 1\n            Rw = Rw + 1\n            For i = 1 To lvl\n            Ws.Cells(Rw, i).Value = Trim(Mid(Xstr, Snest(path(i), i), Enest(path(i), i) - Snest(path(i), i) + 1))\n            Next\n        lvl = lvl - 1\n        path(lvl) = path(lvl) + 1\n        Snest(path(lvl), lvl) = x + 1\n        End If\nNext\nEnd Sub\n</code></pre>\n\n<p>The output from the sample file created by copying sample text 4 times is as follows</p>\n\n<p><a href=\"https://i.stack.imgur.com/tzQeV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tzQeV.png\" alt=\"enter image description here\"></a></p>\n\n<p>Further simplifying for getting pure tree structure on excel cells</p>\n\n<pre><code>Option Explicit\nSub ParseConfigSimple()\nDim Fno As Integer, Xstr As String, Fname As String\nDim lvl As Integer, i As Integer, x As Integer, y As Integer, Rw As Integer\nDim Ws As Worksheet, Xchr As String\nSet Ws = ThisWorkbook.ActiveSheet\n\nFno = FreeFile\nFname = \"C:\\Users\\user\\Desktop\\ConfigSample.txt\"\nOpen Fname For Input As #Fno\nXstr = Input(LOF(Fno), Fno)\nClose #Fno\n\nXstr = Replace(Xstr, vbCrLf, \"\")\nXstr = Replace(Xstr, \"/\", \"|\")\n\n\nDim Spos As Long, Epos As Long, Plen As Long\nDim path(1 To 100) As Variant\n\n\nlvl = 1\nSpos = 1\nRw = 1\n    'Make heading\n    For x = 1 To 50\n    Ws.Cells(Rw, x).Value = \"Level \" &amp; x\n    Next\n\n    'Parse each item in nested level\n    For x = 1 To Len(Xstr)\n    Xchr = Mid(Xstr, x, 1)\n\n        If Xchr = \"{\" Or Xchr = \"}\" Then\n        Epos = x - 1\n        Plen = Epos - Spos + 1\n        path(lvl) = Trim(Mid(Xstr, Spos, Plen))\n            If Len(path(lvl)) &gt; 1 Then\n            Rw = Rw + 1\n            Ws.Cells(Rw, lvl).Value = path(lvl)\n            End If\n        Spos = x + 1\n        Epos = x - 1\n            If Xchr = \"{\" Then\n            lvl = lvl + 1\n            Else\n            lvl = lvl - 1\n            End If\n        End If\nNext\nEnd Sub\n</code></pre>\n\n<p>The output will be like</p>\n\n<p><a href=\"https://i.stack.imgur.com/5wIq6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5wIq6.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 23, "user_id": 11705446, "user_type": "registered", "profile_image": "https://graph.facebook.com/2843744978985251/picture?type=large", "display_name": "N&#233;stor Mu&#241;oz", "link": "https://stackoverflow.com/users/11705446/n%c3%a9stor-mu%c3%b1oz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 56783119, "answer_count": 1, "score": 2, "last_activity_date": 1561623425, "creation_date": 1561584794, "last_edit_date": 1561614435, "question_id": 56781169, "link": "https://stackoverflow.com/questions/56781169/read-an-f5-configuration-file-in-excel-retrieve-values-between-brackets-in-diff", "title": "Read an F5 Configuration File in excel (retrieve values between brackets in different lines)", "body": "<p>I have a configuration file with many blocks like the following (with nested brackets). </p>\n\n<pre><code>ltm pool /Common/This_Is_The_Name {\n    load-balancing-mode least-connections-member\n    members {\n        /Common/Member01 {\n            address 1.2.3.4\n        }\n        /Common/Member02 {\n            address 2.3.4.5\n        }\n    }\n    monitor /Common/tcp\n}\n</code></pre>\n\n<p>I have tried looking for characters like <code>}</code> or <code>{</code> but they appear more than once in the text and the macro fails. Also, not all the configurations are the same or in the same order. </p>\n\n<p>What I did is too long to paste and is not working.</p>\n\n<p>How can I print this in excel in a format, for example:</p>\n\n<pre><code>POOL NAME | LOAD-BALANCING MODE | MEMBER 01 NAME | MEMBER 01 IP | MEMBER 02 NAME | MEMBER 02 IP | MONITOR\nThis is the name | Least-connection-member | Member01 | 1.2.3.4 | Member02 | 2.3.4.5 | /common/tcp\n</code></pre>\n\n<p>I am reading these values from a txt file.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2670, "user_id": 3826387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0bc3e39607231181fa257d9b280247a?s=128&d=identicon&r=PG&f=1", "display_name": "RobertBaron", "link": "https://stackoverflow.com/users/3826387/robertbaron"}, "edited": false, "score": 0, "creation_date": 1561584094, "post_id": 56780924, "comment_id": 100117091, "body": "It might have something to do with <code>LookIn:=xlFormulas</code>. Have you tried <code>xlValues</code> instead?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11705373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57e000eb64cff0be121b54014fe44ff4?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/11705373/max"}, "edited": false, "score": 0, "creation_date": 1561661439, "post_id": 56788259, "comment_id": 100148670, "body": "Worked great, Thanks a bunch!"}], "tags": [], "owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "is_accepted": true, "score": 0, "last_activity_date": 1561646875, "last_edit_date": 1561646875, "creation_date": 1561628554, "answer_id": 56788259, "question_id": 56780924, "link": "https://stackoverflow.com/questions/56780924/a-way-to-find-a-string-within-merged-cells/56788259#56788259", "title": "a way to find a string within merged cells", "body": "<p>Welcome to SO.</p>\n\n<p>The code you have provided is close to what it should be. However, it will only find one occurrence per worksheet. I am not sure if that's by design, so in the following code I'm demonstrating how you can find all the occurrences per worksheet.</p>\n\n<p>Also, I am not sure I understand the logic of how you increase the <code>count</code> in each loop. Currently your code finds the cell whose value is \"Ammonia\" and then goes 3 cells to the right and adds whatever value is there to <code>count</code>. Again I am not sure if that's by design.</p>\n\n<p>Also, you don't need either of   <code>sh.Activate</code> and <code>found.Select</code>.</p>\n\n<p>Below is the code I would suggest, along with comments that explain how it works.</p>\n\n<pre><code>Option Explicit\n\nSub LoopThroughFiles()\n'\n' your code to loop through workbooks\n'\n\nDebug.Print numOfOccurrences(\"Ammonia\", wbk) 'call the search function and print the number of occurrences to the immediate window\n\n'\n' your code continues\n'\n\nEnd Sub\n\nPublic Function numOfOccurrences(keyword As String, wb As Workbook) As Long\n\nDim sht As Worksheet\nDim found As Range\nDim count As Long\nDim firstOccurence As String\ncount = 0\n\nFor Each sht In wb.Worksheets 'loop through sheets\n    Set found = sht.Cells.Find(what:=keyword) 'search for the first occurrence if any\n    If Not found Is Nothing Then 'if the keyword is found once, then we need to search for more occurrences\n        firstOccurence = found.Address 'store the address of the first occurence\n        Do\n            Set found = sht.Cells.FindNext(found) 'search for the next occurrence in the same sheet\n            count = count + 1 'keep track of the number of occurences\n        If found Is Nothing Then\n            GoTo DoneFinding    'this deals with what seems to be a bug when using .FindNext with merged cells\n        End If\n        Loop Until found.Address = firstOccurence 'repeat until the search goes full circle back to the first occurrence\n    End If\nDoneFinding:\nNext sht\nnumOfOccurrences = count\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11705373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57e000eb64cff0be121b54014fe44ff4?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/11705373/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 56788259, "answer_count": 1, "score": 1, "last_activity_date": 1561646875, "creation_date": 1561583337, "last_edit_date": 1561614428, "question_id": 56780924, "link": "https://stackoverflow.com/questions/56780924/a-way-to-find-a-string-within-merged-cells", "title": "a way to find a string within merged cells", "body": "<p>I need to search through files within a directory for the occurrences of a string and return a count. </p>\n\n<p>For testing I have put 4 workbooks with 5 worksheets each into C:\\test directory. I am looking for a count of the occurrences of the word ammonia anywhere within the workbooks. The code I am using is retuning \"0\" even though I am certain it exists. I believe its because lookin does not work with merged cells. Are there any tricks for making this work?</p>\n\n<pre><code>Sub LoopThroughFiles()\nRange(\"'sheet1'!A6:M10000\").ClearContents\n\nDim directory As String, fileName As String, sheet As Worksheet, i As Integer, j As Integer\ndirectory = \"C:\\Test\\\"\nfileName = Dir(directory &amp; \"*.xl??\")\n\n\n\ni = 5\nDo While fileName &lt;&gt; \"\"\n\ni = i + 1\n\nIf fileName &lt;&gt; \"\" Then\nDim wbk As Workbook\nWith wbk\nSet wbk = Workbooks.Open(directory &amp; fileName)\nEnd With\n\n\nDim sh As Worksheet\nDim found As Range\nDim count As Integer\n\nFor Each sh In wbk.Worksheets\n    Set found = sh.Cells.Find(what:=\"Ammonia\", LookIn:=xlFormulas)\n\n\n    If Not found Is Nothing Then\n       sh.Activate\n       found.Select\n        count = count + sh.Range(found.Address).Offset(0, 3).Value\n       Else\n    End If\nNext sh\nwbk.Close\nEnd If\n\n\n\nfileName = Dir()\n\nLoop\n\nRange(\"'Sheet1'!C2\").Value = count\n\nEnd Sub\n</code></pre>\n\n<p>Code is not finding the value in a merged cell.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1561582005, "post_id": 56780454, "comment_id": 100116303, "body": "Normally you don&#39;t need to <code>Activate</code>. Fully qualifying which workbook and worksheet you are working with is what you need."}, {"owner": {"reputation": 17, "user_id": 11609062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb75719ca0b3ecc7f8235d81c7685cbc?s=128&d=identicon&r=PG&f=1", "display_name": "z3115", "link": "https://stackoverflow.com/users/11609062/z3115"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1561582213, "post_id": 56780454, "comment_id": 100116386, "body": "BigBen - please see update. I know &quot;activate&quot; is not necessary, I was just using it as a simple way to troubleshoot - I could replicate the issue with a different action besides &quot;activate&quot;..after closing/reopening and having that fix it, I am wondering if it is a bug with having multiple excel instances open"}, {"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1561582489, "post_id": 56780454, "comment_id": 100116509, "body": "Set a Watch on &quot;wb&quot; and check the FullPath to confirm that it is indeed the file you are expecting it to be."}, {"owner": {"reputation": 17, "user_id": 11609062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb75719ca0b3ecc7f8235d81c7685cbc?s=128&d=identicon&r=PG&f=1", "display_name": "z3115", "link": "https://stackoverflow.com/users/11609062/z3115"}, "edited": false, "score": 0, "creation_date": 1561582657, "post_id": 56780454, "comment_id": 100116559, "body": "Frank - that seems helpful, how exactly do I &quot;set a watch&quot; on a variable? thank you!"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1561583722, "post_id": 56780454, "comment_id": 100116964, "body": "in your code before <code>end sub</code> type <code>debug.print wb.path</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1561584082, "post_id": 56780454, "comment_id": 100117086, "body": "Title is a bit misleading - multiple &quot;instances&quot; typically refers to having more than one instance of the Excel <i>application</i> open (ie two separate Excel instances, each with their own set of open workbooks)."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 11609062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb75719ca0b3ecc7f8235d81c7685cbc?s=128&d=identicon&r=PG&f=1", "display_name": "z3115", "link": "https://stackoverflow.com/users/11609062/z3115"}, "edited": false, "score": 0, "creation_date": 1561644285, "post_id": 56781317, "comment_id": 100140132, "body": "Thanks Tim! So to prevent my code from having issues, should I add a part that checks to see if the wb is already open?"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 3, "last_activity_date": 1561603230, "last_edit_date": 1561603230, "creation_date": 1561585490, "answer_id": 56781317, "question_id": 56780454, "link": "https://stackoverflow.com/questions/56780454/can-having-multiple-instances-of-excel-open-cause-vba-issues/56781317#56781317", "title": "Can having multiple instances of Excel open cause VBA issues?", "body": "<p>There is a subtle bug (I hesitate to call it that, but that's what it looks like) you need to watch out for.</p>\n\n<p>If the workbook you're trying to open via code <em>is already open</em> then occasionally you will see some unexpected behavior (such as the return value from <code>Workbooks.Open()</code> being assigned to <code>ThisWorkbook</code> instead of the file you expect).</p>\n\n<p>For example the code below runs in \"Tester.xlsm\" and is opening \"EmptyTest.xlsx\", but <em>if that file is already open, the <code>Workbooks.Open</code> call fails to correctly assign the <code>wb</code> variable, and it ends up pointing at \"Tester.xlsm\"</em>.  That can cause problems.</p>\n\n<p>To replicate, </p>\n\n<ul>\n<li>open Excel</li>\n<li>open \"EmptyTest.xlsx\"</li>\n<li>open \"Tester.xlsm\"</li>\n<li>run \"Tester\" sub</li>\n</ul>\n\n<p>Test code:</p>\n\n<pre><code>Sub Tester()\n\n    Dim wb As Workbook\n\n    'with \"EmptyTest\" already open\n    Set wb = Workbooks.Open(\"C:\\Tester\\EmptyTest.xlsx\")\n    Debug.Print wb.Name '&gt;&gt; Tester.xlsm  -  oops!\n\n    'close\"EmptyTest\" before proceeding\n    Workbooks(\"EmptyTest.xlsx\").Close False\n\n    'with  \"EmptyTest\" closed\n    Set wb = Workbooks.Open(\"C:\\Tester\\EmptyTest.xlsx\")\n    Debug.Print wb.Name '&gt;&gt;EmptyTest.xlsx - OK\n\nEnd Sub\n</code></pre>\n\n<p>Totally reproducible on my system (win10/Office 365)</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "is_accepted": false, "score": 0, "last_activity_date": 1561586015, "creation_date": 1561586015, "answer_id": 56781413, "question_id": 56780454, "link": "https://stackoverflow.com/questions/56780454/can-having-multiple-instances-of-excel-open-cause-vba-issues/56781413#56781413", "title": "Can having multiple instances of Excel open cause VBA issues?", "body": "<p>I think your problem is that you are <em>opening</em> Workbook B.  You state, if you close and re-open it then it works.</p>\n\n<p>Therefore, any changes you have made to Workbook B will be lost as it will re-open the original workbook. (Auto Save does not actually save the workbook, it saves a separate copy.)  </p>\n\n<p>You need instead to check if the workbook is <em>already</em> open and only re-open it if it is not currently open.</p>\n\n<p>(Very rough code)</p>\n\n<pre><code>Sub test()\n    Dim wb As Workbook\n    For Each wb In ThisWorkbook.Application.Workbooks\n        If wb.Path &amp; \"\\\" &amp; wb.Name = \"U:\\workbookB.xlsx\" Then Exit For\n    Next\n    If wb.Path &amp; \"\\\" &amp; wb.Name &lt;&gt; \"U:\\workbookB.xlsx\" Then Set wb = ThisWorkbook.Application.Workbooks.Open(\"U:\\workbookB.xlsx\")\n    wb.Worksheets(\"ED\").Range(\"Z1\").Value = \"TEST\"\nEnd Sub\n</code></pre>\n\n<p>But (as others have said) you should really check that there are no other instances of Excel running and account for them also.</p>\n"}], "owner": {"reputation": 17, "user_id": 11609062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb75719ca0b3ecc7f8235d81c7685cbc?s=128&d=identicon&r=PG&f=1", "display_name": "z3115", "link": "https://stackoverflow.com/users/11609062/z3115"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1561622362, "creation_date": 1561581075, "last_edit_date": 1561622362, "question_id": 56780454, "link": "https://stackoverflow.com/questions/56780454/can-having-multiple-instances-of-excel-open-cause-vba-issues", "title": "Can having multiple instances of Excel open cause VBA issues?", "body": "<p>I have code in workbook A that opens and does stuff to workbook B. Code runs fine when workbook A and B are the only excel files open (or if workbook A is the only file open). However, if I open up any additional workbook (call it workbook C), the macro does not run correctly. It doesn't cause an error message, it just runs to completion without doing any of the \"stuff\" it's supposed to do (the stuff is basically finding things in workbook B and pasting them into workbook A).</p>\n\n<p>FWIW, I have done the following simple experiment:</p>\n\n<ol>\n<li>Open all 3 workbooks (A, B, &amp; C)</li>\n<li>select workbook C so that it is active and the front window</li>\n<li>run the code workbookB.sheet1.activate (this is not verbatim, I know this code as written will fail)</li>\n</ol>\n\n<p>When I do the above test, it doesn't even make workbook B the active workbook. Again, it doesn't cause excel to throw an error message, it just runs and leave workbook C as the active workbook.</p>\n\n<p>Edit: I've tested more, the code below should change the value of a cell in workbook B, but instead is putting the value into workbook C. I am very confused, since workbook C is not referenced in any way (the module is in workbook A)</p>\n\n<pre><code>Sub test()\n    Dim wb As Workbook\n    Set wb = Workbooks.Open(\"U:\\workbookB.xlsx\")\n    wb.Worksheets(\"ED\").Range(\"Z1\").Value = \"TEST\"\nEnd Sub\n</code></pre>\n\n<p>Edit 2: The issue was occurring when Workbook A and B had been open for several hours, and Workbook C was recently opened. I closed workbook B then re-ran the code and it is working correctly. This leading me to believe that there IS some sort of issue with multiple instances of excel opening. While this is hopefully low-risk, I am still curious if anyone has some way I could code around it as a precaution? Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 6, "creation_date": 1561580785, "post_id": 56780363, "comment_id": 100115801, "body": "put <code>ws.</code> in front of all the <code>Range(...</code>: <code>ws.Range(...</code>"}, {"owner": {"reputation": 1, "user_id": 11705216, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zWi4iUXRBxU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcqBmzQFMp9XFIG-GqTQLAKfrifEg/photo.jpg?sz=128", "display_name": "xhunco", "link": "https://stackoverflow.com/users/11705216/xhunco"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1561580862, "post_id": 56780363, "comment_id": 100115842, "body": "Ah... simple fix. Thank you!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 4, "creation_date": 1561582239, "post_id": 56780363, "comment_id": 100116404, "body": "Alternatively, after the <code>For each ws ...</code> line, add <code>With ws</code>, then you can do <code>If .Name &lt;&gt; ...</code> and <code>.Range(&quot;B2&quot;).Value = ...</code> (note just the <code>.</code>, don&#39;t need <code>ws.</code> since you have it in <code>With ws</code> ...if that makes sense."}], "answers": [{"comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1561595241, "post_id": 56781530, "comment_id": 100119676, "body": "Don&#39;t call it &quot;not explicit&quot;, it is <b>implicit</b> what happens a lot without users care about (or even notice).  Maybe add <a href=\"https://rubberduckvba.wordpress.com/2018/10/25/clean-vba-code-pt-2-avoiding-implicit-code/\" rel=\"nofollow noreferrer\">avoiding implicit code</a>"}, {"owner": {"reputation": 1681, "user_id": 8309643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKYcGO_qCIE/AAAAAAAAAAI/AAAAAAAAB8o/PJdqYRCGzdU/photo.jpg?sz=128", "display_name": "Robert Todar", "link": "https://stackoverflow.com/users/8309643/robert-todar"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1561598893, "post_id": 56781530, "comment_id": 100120225, "body": "@ComputerVersteher could you elaborate? Your comment wasn&#39;t very explicit in what you were trying to communicate ;) I feel like it can be written in either way, either share the implicit default reference, or share that the developer must be explicit in which reference to use."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1561599837, "post_id": 56781530, "comment_id": 100120376, "body": "The usage of implicisms like<code>ActiveSheet</code>, if no sheet supplied or omitting the default-member like<code>.Value()</code> or implicit conversion of data-types, is widespread, but especially beginners, don&#39;t notice what they do, because most time it has the expected behavior. So start with sth like &quot;If you don&#39;t specify the worksheet to a range, <code>AcriveSheet.Range</code>is implicit used as worksheet the range belongs to&#39;  And add the link from my comments as it offers some deeper thougths on implicisms."}], "tags": [], "owner": {"reputation": 1681, "user_id": 8309643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKYcGO_qCIE/AAAAAAAAAAI/AAAAAAAAB8o/PJdqYRCGzdU/photo.jpg?sz=128", "display_name": "Robert Todar", "link": "https://stackoverflow.com/users/8309643/robert-todar"}, "is_accepted": false, "score": 0, "last_activity_date": 1561586869, "creation_date": 1561586869, "answer_id": 56781530, "question_id": 56780363, "link": "https://stackoverflow.com/questions/56780363/vba-loop-to-standardize-header-in-some-worksheets-but-omit-some/56781530#56781530", "title": "VBA - loop to standardize header in some worksheets but omit some", "body": "<p>By default, if you don't explicitly state which worksheet you would like to use with your <code>Range</code> then it will default to the current <code>ActiveSheet</code>.</p>\n\n<p>An example using one of your lines would be <code>ws.Range(\"L2\").Value = \"Unit / Notes\"</code>.</p>\n\n<p>As @BruceWayne stated, using a <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/with-end-with-statement\" rel=\"nofollow noreferrer\"><code>With</code></a> statement will make your code more readable by eliminating repetitive qualifying expressions.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Set_Headings()\n    'loop through each sheet in the workbook except for \"Main\" and \"Overall\" and standardize column headers'\n    Dim ws As Worksheet\n    For Each ws In ThisWorkbook.Worksheets\n        With ws\n            If .Name &lt;&gt; \"Main\" And .Name &lt;&gt; \"Overall\" Then\n                .Range(\"B2\").Value = \"Active / Days Off / Holidays/ Training / MOD / LOA\"\n                .Range(\"E2\").Value = \"Active / Days Off / Holidays/ Training / MOD / LOA\"\n                .Range(\"H2\").Value = \"Active / Days Off / Holidays/ Training / MOD / LOA\"\n                .Range(\"K2\").Value = \"Active / Days Off / Holidays/ Training / MOD / LOA\"\n                .Range(\"C2\").Value = \"Unit / Notes\"\n                .Range(\"F2\").Value = \"Unit / Notes\"\n                .Range(\"I2\").Value = \"Unit / Notes\"\n                .Range(\"L2\").Value = \"Unit / Notes\"\n                .Range(\"G2\").Value = \"Drivers\"\n            End If\n        End With\n    Next ws\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11705216, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zWi4iUXRBxU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcqBmzQFMp9XFIG-GqTQLAKfrifEg/photo.jpg?sz=128", "display_name": "xhunco", "link": "https://stackoverflow.com/users/11705216/xhunco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561586869, "creation_date": 1561580682, "last_edit_date": 1561580732, "question_id": 56780363, "link": "https://stackoverflow.com/questions/56780363/vba-loop-to-standardize-header-in-some-worksheets-but-omit-some", "title": "VBA - loop to standardize header in some worksheets but omit some", "body": "<p>I am trying to loop through 11 of the 13 worksheets I have in my workbook to standardize some column headers. When running the macro, it is only making the changes on the currently active worksheet.</p>\n\n<p>I've tried putting an if statement with the names of the sheets to omit. This is what I have</p>\n\n<pre><code>Sub Set_Headings()\n    Dim ws As Worksheet\n    'loop through each sheet in the workbook except for \"Main\" and \"Overall\" and standardize column headers'\n    For Each ws In ThisWorkbook.Worksheets\n        If ws.Name &lt;&gt; \"Main\" And ws.Name &lt;&gt; \"Overall\" Then\n            Range(\"B2\").Value = \"Active / Days Off / Holidays/ Training / MOD / LOA\"\n            Range(\"E2\").Value = \"Active / Days Off / Holidays/ Training / MOD / LOA\"\n            Range(\"H2\").Value = \"Active / Days Off / Holidays/ Training / MOD / LOA\"\n            Range(\"K2\").Value = \"Active / Days Off / Holidays/ Training / MOD / LOA\"\n            Range(\"C2\").Value = \"Unit / Notes\"\n            Range(\"F2\").Value = \"Unit / Notes\"\n            Range(\"I2\").Value = \"Unit / Notes\"\n            Range(\"L2\").Value = \"Unit / Notes\"\n            Range(\"G2\").Value = \"Drivers\"\n        End If\n    Next ws\nEnd Sub\n</code></pre>\n\n<p>I expect for those headers to be applied in all the sheets except \"Main\" and \"Overall\" but it is only applying the changes to the currently active worksheet.</p>\n"}, {"tags": ["excel", "vba", "ribbon"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1561581105, "post_id": 56780279, "comment_id": 100115955, "body": "That&#39;s strange. I do not see anything wrong with the code..."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1561582000, "post_id": 56780279, "comment_id": 100116300, "body": "Can you test it in a new workbook?"}, {"owner": {"reputation": 628, "user_id": 125371, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/32b2a882b64af94ec20fc54aaebb19ac?s=128&d=identicon&r=PG", "display_name": "cosmarchy", "link": "https://stackoverflow.com/users/125371/cosmarchy"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1561582973, "post_id": 56780279, "comment_id": 100116667, "body": "I have code similar to this working on another workbook; the only difference being the tab ID was different..."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1561583130, "post_id": 56780279, "comment_id": 100116727, "body": "Nothing wrong with the Tab Id. Like I said it works for me. Try this.. Create a new .xlsm file and paste the VBA code. save it as tester.xlsm in desktop. Use CustomUI editor to put the above xml code. save and close. Now open the workbook. Does it work for the new workbook?"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1561589144, "post_id": 56780279, "comment_id": 100118501, "body": "do you get any ribbon UI errors in Excel?"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1561589195, "post_id": 56780279, "comment_id": 100118519, "body": "I see two files with a custom UI. Did you try to use a single custom UI xml file?"}, {"owner": {"reputation": 628, "user_id": 125371, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/32b2a882b64af94ec20fc54aaebb19ac?s=128&d=identicon&r=PG", "display_name": "cosmarchy", "link": "https://stackoverflow.com/users/125371/cosmarchy"}, "edited": false, "score": 0, "creation_date": 1561654766, "post_id": 56780279, "comment_id": 100145900, "body": "Fixed this.  I copied and pasted everything above in to a fresh workbook and it all works as expected.  I suspect Excel got itself in to a muddle somewhere along the lines... Thanks for the suggestions :)"}], "owner": {"reputation": 628, "user_id": 125371, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/32b2a882b64af94ec20fc54aaebb19ac?s=128&d=identicon&r=PG", "display_name": "cosmarchy", "link": "https://stackoverflow.com/users/125371/cosmarchy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 354, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561580316, "creation_date": 1561580316, "question_id": 56780279, "link": "https://stackoverflow.com/questions/56780279/excel-ribbon-not-switching-to-tab-when-opening", "title": "Excel Ribbon Not Switching To Tab When Opening", "body": "<p>I have an Excel 2013 workbook and am trying to switch a custom tab when the it is opened.</p>\n\n<p>I have the following CustomUIx.xml entries:</p>\n\n<p>CustomUI.xml</p>\n\n<pre><code>&lt;customUI onLoad=\"RibbonOnLoad\" xmlns=\"http://schemas.microsoft.com/office/2006/01/customui\"&gt;\n&lt;ribbon&gt;\n    &lt;tabs&gt;\n        &lt;tab id=\"CustomHFG\" label=\"Custom\" insertAfterMso=\"TabDeveloper\"&gt;\n\n        &lt;/tab&gt;\n    &lt;/tabs&gt;\n&lt;/ribbon&gt;\n</code></pre>\n\n<p></p>\n\n<p>CustomUI14.xml</p>\n\n<pre><code>&lt;customUI onLoad=\"RibbonOnLoad\" xmlns=\"http://schemas.microsoft.com/office/2009/07/customui\"&gt;\n&lt;ribbon&gt;\n    &lt;tabs&gt;\n        &lt;tab id=\"CustomHFG\" label=\"Custom\" insertAfterMso=\"TabDeveloper\"&gt;\n\n        &lt;/tab&gt;\n    &lt;/tabs&gt;\n&lt;/ribbon&gt;\n</code></pre>\n\n<p></p>\n\n<p>and the folloing VBA code in a module:</p>\n\n<pre><code>Option Explicit\nPublic ribRibbon As IRibbonUI\n\nPublic Sub RibbonOnLoad(ribbon As IRibbonUI)\n    Set ribRibbon = ribbon\n    ribRibbon.ActivateTab (\"CustomHFG\")\nEnd Sub\n</code></pre>\n\n<p>When I open the workbook, it does not activate the 'CustomHFG' tab.  I believe the RibbonOnLoad sub is being called as I have a <code>debug.asset false</code> statement after the <code>ribRibbon.ActivateTab (\"CustomHFG\")</code> line and it breaks here so I'm sure ActivateTab is being called.</p>\n\n<p>Any suggestions as to why this is not activating the tab on open?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "range"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1561578141, "post_id": 56779906, "comment_id": 100115034, "body": "<code>Set rng = nm.RefersToRange</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1561580321, "post_id": 56779906, "comment_id": 100115586, "body": "Strange, for me the second code works quite ok."}, {"owner": {"reputation": 601, "user_id": 7959614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f104f49cd87068e81f128afbda86a637?s=128&d=identicon&r=PG&f=1", "display_name": "HJA24", "link": "https://stackoverflow.com/users/7959614/hja24"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1561617804, "post_id": 56779906, "comment_id": 100124751, "body": "@tigeravatar; if I inspect <code>nm</code> I see that it has the following error <code>Application-defined or object-defined error</code>"}, {"owner": {"reputation": 601, "user_id": 7959614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f104f49cd87068e81f128afbda86a637?s=128&d=identicon&r=PG&f=1", "display_name": "HJA24", "link": "https://stackoverflow.com/users/7959614/hja24"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1561617850, "post_id": 56779906, "comment_id": 100124787, "body": "@Vityata is it possible that there is something wrong with my defined ranges?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1561641647, "post_id": 56779906, "comment_id": 100138388, "body": "@tigeravatar I came back to the same solution as the simplest approach, since the Sheet names being attached to the string <code>nm</code> appears to be the issue, though I believe that you could use <code>strLoc = InStr(nm,&quot;!&quot;) &#47;&#47; nm = Right(nm,len(nm)-strLoc))</code> as an alternative."}], "answers": [{"comments": [{"owner": {"reputation": 601, "user_id": 7959614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f104f49cd87068e81f128afbda86a637?s=128&d=identicon&r=PG&f=1", "display_name": "HJA24", "link": "https://stackoverflow.com/users/7959614/hja24"}, "edited": false, "score": 0, "creation_date": 1561618817, "post_id": 56780041, "comment_id": 100125255, "body": "Thanks for your time. Unfortunately, your code doesn&#39;t work. Is it possible that there is something wrong with my defined ranges?"}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 1, "last_activity_date": 1561641387, "last_edit_date": 1561641387, "creation_date": 1561578385, "answer_id": 56780041, "question_id": 56779906, "link": "https://stackoverflow.com/questions/56779906/loop-over-all-the-values-of-the-named-ranges/56780041#56780041", "title": "Loop over all the values of the named ranges", "body": "<p>See:</p>\n\n<pre><code>For i = 1 To ActiveWorkbook.Names.Count\n    Set nm = ActiveWorkbook.Names(i)\n    Set rng = ActiveWorkbook.Names(nm.Name) 'This is where the error was\n    MsgBox rng.Address\nNext i\n</code></pre>\n\n<p>I also dropped the rng_name, since you didn't use it.</p>\n\n<hr>\n\n<p><strong>Edit1:</strong></p>\n\n<p>I was unable to get <code>Application.Range(nm.Name)</code> to work originally, but was able to get <code>ActiveWorkbook.Range(nm.Name)</code> to work, using ranges on different sheets named \"c\" and \"d\".  I noted that <code>nm = ActiveWorkbook.Names(i)</code> <em>did not</em> include the sheet name when it was recorded.</p>\n\n<p>When naming ranges with the underscore and number in them (I tried c_1 &amp; c_2) I was unable to get my code to work; on inspecting <code>nm</code> in debug mode, I noticed that it also listed the sheet name.  I had to specify that than rng would <code>.RefersToRange</code> to get the cell address to show up without the sheet name.</p>\n\n<p>I did two additional checks, one with the underscore without number (used \"d_\") and another with a number and no underscore (used \"name2\"), and both <strong>did</strong> give me the same error.  Both scenarios kept the Sheet name in the string <code>nm</code>.</p>\n\n<p>Here is the testing code that I was executing/stepping through to sort that out:</p>\n\n<pre><code>Dim rng As Range, i As Long\nFor i = 1 To ActiveWorkbook.Names.Count\n    Set nm = ActiveWorkbook.Names(i)\n    'Set rng = ActiveWorkbook.Names(nm.Name)\n    Set rng = nm.RefersToRange\n    'Debug.Print rng.Address\n    MsgBox rng.Address\nNext i\n</code></pre>\n\n<p>Using <code>Set rng = nm.RefersToRange</code> worked in all scenarios, while alpha-character only names worked with the <code>Set rng = ActiveWorkbook.Names(nm.Name)</code>.</p>\n\n<p>Suggestion, stick with <code>.RefersToRange</code> as the robust code.</p>\n"}], "owner": {"reputation": 601, "user_id": 7959614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f104f49cd87068e81f128afbda86a637?s=128&d=identicon&r=PG&f=1", "display_name": "HJA24", "link": "https://stackoverflow.com/users/7959614/hja24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 56780041, "answer_count": 1, "score": 0, "last_activity_date": 1561641387, "creation_date": 1561577756, "last_edit_date": 1561619429, "question_id": 56779906, "link": "https://stackoverflow.com/questions/56779906/loop-over-all-the-values-of-the-named-ranges", "title": "Loop over all the values of the named ranges", "body": "<p>I have a number of named ranges within the scope of my <code>Workbook</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/l2S2H.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l2S2H.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Now I want to loop over each named range by following the second answer of this related <a href=\"https://stackoverflow.com/questions/27234134/loop-through-all-named-ranges-in-a-excel-sheet\">topic</a></p>\n\n<pre><code>Sub Range1()\n\nDim i As Integer\n\nFor i = 2 To ActiveWorkbook.Names.Count\n    MsgBox ActiveWorkbook.Names(i).Name\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>This macro shows me all the names such as <code>C_1</code> in a msgbox. I modify the script in the following way to \"call\" each of the ranges based on the name of the corresponding range.</p>\n\n<pre><code>Sub Range2()\n\nDim i As Integer\nDim rng As Range\nDim nm As Name\nDim rng_name As String\n\nFor i = 2 To ActiveWorkbook.Names.Count\n   Set nm = ActiveWorkbook.Names(i)\n   rng_name = nm.Name\n   Set rng = Application.Range(nm.Name)           `This line yields an error\n   MsgBox rng.Address\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>The error I get is:</p>\n\n<blockquote>\n  <p>\"Run-time error '1004': Method 'Range' of object'_ Apolication failed</p>\n</blockquote>\n\n<p>Any idea what I am doing wrong? If I inspect the elements I see that <code>rng_name</code> is equal to \"C_1\".</p>\n\n<p><strong>EDIT</strong> </p>\n\n<p>I believe that it has something to do with how the named ranges are created. This is done in the following way:</p>\n\n<pre><code>Sub createRanges()\n\nDim LastRowAll As Long, LastRowUnique As Long\nDim x, y\nDim rng As Range\nDim rng_name As String\n\nLastRowUnique = Sheets(\"Lists\").Range(\"J2\").End(xlDown).Row\nLastRowAll = Sheets(\"Deribit\").Range(\"D8\").End(xlDown).Row\n\nFor Each x In Sheets(\"Lists\").Range(\"J2:J\" &amp; LastRowUnique)\n    For Each y In Sheets(\"Deribit\").Range(\"D8:D\" &amp; LastRowAll)\n        If y.Offset(0, -1).value = \"Call\" Then\n            If rng Is Nothing And y = x Then\n                Set rng = y.Offset(0, -2)\n            ElseIf y = x Then\n                Set rng = Union(rng, y.Offset(0, -2))\n            End If\n        Else:\n        End If\n    Next y\n    rng_name = \"C_\" &amp; x.Offset(0, -1).value\n    ThisWorkbook.Names.Add Name:=rng_name, RefersTo:=rng.Address\n    Set rng = Nothing\nNext x\n</code></pre>\n"}, {"tags": ["vba", "vlookup", "type-mismatch"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1561577827, "post_id": 56779886, "comment_id": 100114874, "body": "Your range for the second criterion is only one column, yet you are trying to return the value from the 2nd and 3rd columns in that one column range."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1561579458, "post_id": 56779886, "comment_id": 100115267, "body": "also <code>G3</code> as the first criterion should be <code>Worksheets(&quot;SBSS_Assignment_Tool&quot;).Range(&quot;G3&quot;).</code>"}], "owner": {"reputation": 11, "user_id": 11705050, "user_type": "registered", "profile_image": "https://graph.facebook.com/2446938608659649/picture?type=large", "display_name": "Brock Bubar", "link": "https://stackoverflow.com/users/11705050/brock-bubar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1561577642, "creation_date": 1561577642, "question_id": 56779886, "link": "https://stackoverflow.com/questions/56779886/how-do-i-avoid-type-mismatch-in-this-case", "title": "How do I avoid type mismatch in this case?", "body": "<p>I'm trying to use a Vlookup function in order to find a copy of a State code on another worksheet. But the range is not matching up with the string. The range is literally just the 50 states and I'm trying to make it match.</p>\n\n<p>I tried checking out to make sure that the state abbreviation was a string. I've also tried converting the range to a string, but that also caused an error. It's strange because if I just match the specific states together, it says that they equal.</p>\n\n<pre><code>Sub State_Assignment()\nApplication.ScreenUpdating = False\n'On Error Resume Next\n' State_Assignment Macro \nDim Counter As Integer\n    Counter = 1\n   Dim Other As Integer\nOther = 0\n\nDim State As String\nState = \" \"\n\n\n'\n'First, we will check for specialty brokers.\n\n\n\n'Check if Specialty Broker requires a state to assign. In this case, we are making sure to include N and n as options, due to future proofing.\nIf Worksheets(\"SBSS_Assignment_Tool\").Range(\"G3\").Value = \"None\" Then\n\nElseIf CStr(Application.VLookup(G3, Worksheets(\"Special_Cases\").Range(\"A3:A100\"), 2)) = \"N\" Or CStr(Application.VLookup(G3, Worksheets(\"Special_Cases\").Range(\"A3:A100\"), 2)) = \"n\" Then\nE5.Value = WorksheetFunction.VLookup(G3, Worksheets(\"Special_Cases\").Range(\"A3:A100\"), 3)\n\n'If State is needed for Specialty Broker, make sure operator knows. In this case, we are making sure to include Y and y as options, due to future proofing.\nElseIf \"Y\" = CStr(Application.VLookup(G3, Worksheets(\"Special_Cases\").Range(\"A3:A100\"), 2)) Or \"y\" = CStr(Application.VLookup(G3, Worksheets(\"Special_Cases\").Range(\"A3:A100\"), 2)) Then\nMsgBox (\"State is reqired to assign SBSS for this broker.\")\n\n'This only leaves the case of Yes and the state is specified.\nElse\n' Select the cell of the Broker we are looking at.\nWorksheets(\"Special_Cases\").Activate\nRange(\"A3:A100\").Find(CStr(Application.VLookup(G3, Worksheets(\"Special_Cases\").Range(\"A3:A100\"), 1))).Select\n\n' Now check to make sure the State isn't the cell in the same row as it.\n\nIf ActiveCell.Offset(0, 2) = Worksheets(\"SBSS_Assignment_Tool\").Range(G20).Value Then\n\n\nWorksheets(\"SBSS_Assignment_Tool\").Range(J7).Value = ActiveCell.Offset(0, 3)\n\n'See if there are more states to check, by seeing if there is a empty cell below. We use the Counter varible as future-proofing, so specialty brokers can have as many states as they need.\n'The \"Other\" state specification can also be a problem, so if we see it, we will remeber it's cell and use it if none of the other states match up.\nElseIf ActiveCell.Offset(Counter, 0) = \" \" Then\n    If ActiveCell.Offset(Counter, 2) = Worksheets(\"SBSS_Assignment_Tool\").Range(G20).Value Then\n             Worksheets(\"SBSS_Assignment_Tool\").Range(J7).Value = ActiveCell.Offset(Counter, 3)\n    ElseIf ActiveCell.Offset(Counter, 2) = \"Other\" Then\n     Other = Counter\n\n    End If\nCounter = Counter + 1\n\nElse\n'If we check all the states and none match, we use the \"Other\" cell.\nWorksheets(\"SBSS_Assignment_Tool\").Range(J7).Value = ActiveCell.Offset(Other, 3)\nEnd If\n  End If\n\n\n\n\n\n' Looks for State From Drop-Down List and Gather Rules From Cell To The Right of It\n\n Worksheets(\"SBSS_Assignment_Tool\").Range(\"J20\") = Application.VLookup(Worksheets(\"SBSS_Assignment_Tool\").Range(\"G20\").Value, Worksheets(\"State_Assignments\").Range(\"A2:A100\"), 2)\n\n 'Check for Special Broker Rules, first ruling out the No's\nMsgBox (CStr(Worksheets(\"SBSS_Assignment_Tool\").Range(\"G20\").Value) + \" \")\nState = Worksheets(\"SBSS_Assignment_Tool\").Range(\"G20\").Value\nMsgBox (CStr(Worksheets(\"State_Assignments\").Range(\"A16\").Value) + \" \") '\nMsgBox (Worksheets(\"SBSS_Assignment_Tool\").Range(\"G20\").Value = Worksheets(\"State_Assignments\").Range(\"A16\").Value)\nDim X As Range\n\nSet X = Worksheets(\"State_Assignments\").Range(\"A1:A100\")\n\n\n MsgBox (Application.VLookup(State, Worksheets(\"State_Assignments\").Range(\"A2:A51\"), 3))\n If Application.VLookup(Worksheets(\"SBSS_Assignment_Tool\").Range(\"G20\").Value, Worksheets(\"State_Assignments\").Range(\"A1:A100\"), 3) = \"N\" Then\n\n Else\n 'Selec the cell of the SBSS\n Worksheets(\"Special_Cases\").Range(\"A1:AA1\").Find(Application.VLookup(G20, Worksheets(\"State_Assignments\").Range(\"A1:A100\"), 3)).Select\n\n J28.Value = ActiveCell.Offset(1, 0)\n\nEnd If\n</code></pre>\n\n<p>The message boxes work, but once it gets the Vlookups is when it starts to flounder.</p>\n"}, {"tags": ["excel", "vba", "filter", "wildcard"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1561577782, "post_id": 56779831, "comment_id": 100114851, "body": "with spaces around the &amp; it should be fine. &amp; fnm &amp; &quot;*&quot;"}, {"owner": {"reputation": 1, "user_id": 10593017, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wwXfobCCUmk/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCBr1OIuJadco5dntRnYvccQVlX1g/mo/photo.jpg?sz=128", "display_name": "RTD", "link": "https://stackoverflow.com/users/10593017/rtd"}, "reply_to_user": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1561578062, "post_id": 56779831, "comment_id": 100114994, "body": "well im dummy, i should have thought of that... thanks @warcupine"}], "owner": {"reputation": 1, "user_id": 10593017, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wwXfobCCUmk/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCBr1OIuJadco5dntRnYvccQVlX1g/mo/photo.jpg?sz=128", "display_name": "RTD", "link": "https://stackoverflow.com/users/10593017/rtd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 242, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561577356, "creation_date": 1561577356, "question_id": 56779831, "link": "https://stackoverflow.com/questions/56779831/use-wildcard-with-variable-on-autofilter", "title": "Use wildcard with variable on autofilter", "body": "<p>Im working with a data sheet of 25,000+rows of data. i need to apply a formula to each row of data, but i want to narrow it down with filters before applying the formula so im not wasting time waiting for it to loop through 25,000+ rows of data.</p>\n\n<p>I have a variable string of text that takes the first two words of the full string, and i want to filter using that string with a wildcard (*), below is what i have, however it gives me an error with the wildcard, is there another way to accomplish this, or do i have something wrong? thank you.</p>\n\n<pre><code>dim find as integer\ndim fnm as string\n\nfind = Application.WorksheetFunction.find(\" \", isearch.fundnmbox.Value, 3)\nfnm = Left(isearch.fundnmbox.Value, find)\n\nrows(\"1:1\").Select\n    Selection.AutoFilter\n'fnm is the variable string\nActiveSheet.Range(\"$A:$P\").AutoFilter Field:=2, Criteria1:=\"=\"&amp;fnm&amp;\"*\", Operator:=xlAnd\n\n'(theres more to the code, just providing what is relevant)\n</code></pre>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 21, "user_id": 5334189, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H_x5Mir-Ons/AAAAAAAAAAI/AAAAAAAAB3g/BsL_5_cvQY0/photo.jpg?sz=128", "display_name": "Rodrigo Kroehn", "link": "https://stackoverflow.com/users/5334189/rodrigo-kroehn"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1561632925, "post_id": 56779805, "comment_id": 100133123, "body": "@Peh will study this method... Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5334189, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H_x5Mir-Ons/AAAAAAAAAAI/AAAAAAAAB3g/BsL_5_cvQY0/photo.jpg?sz=128", "display_name": "Rodrigo Kroehn", "link": "https://stackoverflow.com/users/5334189/rodrigo-kroehn"}, "edited": false, "score": 0, "creation_date": 1561669729, "post_id": 56793582, "comment_id": 100151552, "body": "Dude,that was perfect! Thank you so much!"}], "tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": true, "score": 0, "last_activity_date": 1561647491, "last_edit_date": 1561647491, "creation_date": 1561646730, "answer_id": 56793582, "question_id": 56779805, "link": "https://stackoverflow.com/questions/56779805/change-pivot-table-columns-filters-with-changing-source-data/56793582#56793582", "title": "Change Pivot Table Columns Filters with changing source data", "body": "<p>You can switch each single \"masterkey\" visible by <code>Pivotitem.Visible</code>.<br>\nPlease be aware, that always at least 1 pivotitem has to remain visible.</p>\n\n<p>The resulting visible \"customers\" can be read from the <code>PivotField.DataRange</code>, which represents all visible pivotitems of that pivotfield. You can address that range cell by cell or assign its value to an array.</p>\n\n<pre><code>Private Sub FilterMasterkeys()\n    Dim pt As PivotTable\n    Dim pfCustomer As PivotField\n    Dim pfMasterkey As PivotField\n    Dim i As Long\n    Dim c As Range ' a cell\n\n    Set pt = ActiveWorkbook.Sheets(\"Din\u00e2mica\").PivotTables(\"Tabela din\u00e2mica2\")\n    pt.RefreshTable\n\n    Set pfCustomer = pt.RowFields(1)\n    Set pfMasterkey = pt.ColumnFields(\"Chave\")\n\n    ' hide all masterkeys except first\n    pfMasterkey.PivotItems(1).Visible = True\n    For i = 2 To pfMasterkey.PivotItems.Count\n        pfMasterkey.PivotItems(i).Visible = False\n    Next i\n\n    ' set each masterkey visible and get corresponig customers\n    For i = 1 To pfMasterkey.PivotItems.Count - 1\n        pfMasterkey.PivotItems(i).Visible = True\n        Debug.Print \"Masterkey \" &amp; pfMasterkey.PivotItems(i).Caption &amp; \" is used by \",\n        For Each c In pfCustomer.DataRange.Cells\n            Debug.Print c.Value,\n        Next c\n        Debug.Print\n\n        pfMasterkey.PivotItems(i + 1).Visible = True\n        pfMasterkey.PivotItems(i).Visible = False\n    Next i\n\n    ' get the last one also\n    Debug.Print \"Masterkey \" &amp; pfMasterkey.PivotItems(i).Caption &amp; \"is used by \",\n    For Each c In pfCustomer.DataRange.Cells\n        Debug.Print c.Value,\n    Next c\n    Debug.Print\n\nEnd Sub\n</code></pre>\n\n<p>If you need all corresponding customers as array, use this after you have switched the next masterkey visible:</p>\n\n<pre><code>Dim arrCustomers() As Variant\narrCustomers = pfCustomer.DataRange.Value\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5334189, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H_x5Mir-Ons/AAAAAAAAAAI/AAAAAAAAB3g/BsL_5_cvQY0/photo.jpg?sz=128", "display_name": "Rodrigo Kroehn", "link": "https://stackoverflow.com/users/5334189/rodrigo-kroehn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 56793582, "answer_count": 1, "score": 1, "last_activity_date": 1561647491, "creation_date": 1561577237, "last_edit_date": 1561646948, "question_id": 56779805, "link": "https://stackoverflow.com/questions/56779805/change-pivot-table-columns-filters-with-changing-source-data", "title": "Change Pivot Table Columns Filters with changing source data", "body": "<p>I have built a macro that connects to SAP, do its thing, gets the response and writes it down on the spreadsheet. The issue is, before the script could do it, I need to have the data by cluster.</p>\n\n<p>For understanding, I have a list of customers with their codes and I have built a master key for each of them, because before I input it to SAP, I need to filter the customers by master key codes that are equal so SAP will accept it. But on the source file I'll have multiples master key codes.</p>\n\n<p>I made a pivot table and put the master key on the columns, so I can see customers code by master key.</p>\n\n<p>With that in hand I filter by master key and I have the specific customer codes for it, and now I can send it to SAP. And repeat for all master keys on the file.\nThis information will change every time from the sales department, so the master keys will change everytime too.</p>\n\n<p>What I need to do is get all the master keys from the file (done that) and, the place I'm stuck, use it to hide and show one at time inside a loop.\nFor example (MK stands for Master Key):</p>\n\n<pre><code>Customer MK1 MK2 MK3 MK4\n   X      1\n   Y          1\n   Z          1\n   A      1\n</code></pre>\n\n<p>So I filter MK1, get customer code for it, run SAP thing, get back to the pivot, filter next existing code, get the customers code, run SAP and do all over again.</p>\n\n<pre><code>If Range(\"A2\") &lt;&gt; \"\" Then\n\n    Range(\"A1\").Select\n    Selection.End(xlDown).Select\n    ActiveCell.Offset(-1, 1).Select\n    Range(Selection, Selection.End(xlUp)).FillDown\n\n    FILTRO2 = ActiveCell\n\n    Range(\"A1\").Select\n\n            Do While ActiveCell &lt;&gt; \"\"\n\n                FILTRO = ActiveCell\n\n                Sheets(\"Din\u00e2mica\").Activate\n\n                ActiveWorkbook.RefreshAll\n\n                With ActiveSheet.PivotTables(\"Tabela din\u00e2mica2\").PivotFields(\"Chave\")\n                    .PivotItems(Split(FILTRO2.Value, \",\")).Visible = False\n                    .PivotItems(FILTRO).Visible = True\n                End With\n</code></pre>\n\n<p>As seen on above code, I'm on a dead end. Isn't working at all.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1561575468, "post_id": 56779359, "comment_id": 100113938, "body": "Is there an issue with just using your filldown and then <code>Columns(&quot;N&quot;).Value = Columns(&quot;N&quot;).Value</code>?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1561575483, "post_id": 56779359, "comment_id": 100113949, "body": "You cannot do an array formula using Application.WorksheetFormula.  The best method is to forget about formulas and use variant arrays and loop the rows till you find the match."}, {"owner": {"reputation": 7, "user_id": 10911974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5546381f14f90be33e9fef7bc392bc9?s=128&d=identicon&r=PG&f=1", "display_name": "dare", "link": "https://stackoverflow.com/users/10911974/dare"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1561575755, "post_id": 56779359, "comment_id": 100114072, "body": "@Scott thanks for the quick advice. Could you please tell me how to go about this. I am really struggling....if i can get a head start that will be helpful. But thanks for understanding my problem"}, {"owner": {"reputation": 7, "user_id": 10911974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5546381f14f90be33e9fef7bc392bc9?s=128&d=identicon&r=PG&f=1", "display_name": "dare", "link": "https://stackoverflow.com/users/10911974/dare"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1561576022, "post_id": 56779359, "comment_id": 100114175, "body": "@Cyril, yeah that works fine when i used copy and paste values but my data set changes every month and i have to hardcode other related parts of the program by changing the ranges every time. Plus others will be using the macro as well and that could mess things up. thanks for the idea"}], "answers": [{"comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1561577557, "post_id": 56779774, "comment_id": 100114764, "body": "Good catch; removed the other answer... managed to forget that was <code>.FormulaArray</code> when my suggestion was relative to <code>.Formula</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1561577594, "post_id": 56779774, "comment_id": 100114774, "body": "That is why we are here, to help."}, {"owner": {"reputation": 7, "user_id": 10911974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5546381f14f90be33e9fef7bc392bc9?s=128&d=identicon&r=PG&f=1", "display_name": "dare", "link": "https://stackoverflow.com/users/10911974/dare"}, "edited": false, "score": 0, "creation_date": 1561578456, "post_id": 56779774, "comment_id": 100115160, "body": "@scott, thanks so much, I am going through this now and i will give you an update asap but it look good to me...Thanks stay tuned"}, {"owner": {"reputation": 7, "user_id": 10911974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5546381f14f90be33e9fef7bc392bc9?s=128&d=identicon&r=PG&f=1", "display_name": "dare", "link": "https://stackoverflow.com/users/10911974/dare"}, "edited": false, "score": 0, "creation_date": 1561579716, "post_id": 56779774, "comment_id": 100115356, "body": "@Scott, My wedding day was my most astonished day up until now..You are a certified magician. THANK YOU!!! it works like a charm!!!! I am so trilled..been on this for over a month. You dont have an idea how helpful this is for me man...I am very grateful...I didnt have any issue at all...Thanks man..."}, {"owner": {"reputation": 7, "user_id": 10911974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5546381f14f90be33e9fef7bc392bc9?s=128&d=identicon&r=PG&f=1", "display_name": "dare", "link": "https://stackoverflow.com/users/10911974/dare"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1561583091, "post_id": 56779774, "comment_id": 100116715, "body": "@Cyril, Thanks for you input as well, I am very grateful"}, {"owner": {"reputation": 7, "user_id": 10911974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5546381f14f90be33e9fef7bc392bc9?s=128&d=identicon&r=PG&f=1", "display_name": "dare", "link": "https://stackoverflow.com/users/10911974/dare"}, "edited": false, "score": 0, "creation_date": 1561584726, "post_id": 56779774, "comment_id": 100117286, "body": "@Scott, I will like to clarify with you why in the for loop, the var Y was not declared like the x as long..."}, {"owner": {"reputation": 7, "user_id": 10911974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5546381f14f90be33e9fef7bc392bc9?s=128&d=identicon&r=PG&f=1", "display_name": "dare", "link": "https://stackoverflow.com/users/10911974/dare"}, "edited": false, "score": 0, "creation_date": 1561615499, "post_id": 56779774, "comment_id": 100123770, "body": "@Scott, thanks again for the clarification...hope i can come back to you at other time...you have been very helpful... ."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1561584801, "last_edit_date": 1561584801, "creation_date": 1561577079, "answer_id": 56779774, "question_id": 56779359, "link": "https://stackoverflow.com/questions/56779359/how-to-write-index-and-match-in-vba/56779774#56779774", "title": "How to write index and match in VBA", "body": "<p>When using vba, most of the time it is better to avoid using worksheet formulas and just loop variant arrays.</p>\n\n<pre><code>With test1Ws\n    Dim inpt() As Variant\n    inpt = .Range(.Cells(3, 2), .Cells(Test1LastRow, 7)).Value\n\n    Dim detlstrw As Long\n    detlstrw = Worksheets(\"DETAILS2\").Cells(Rows.Count, 1).End(xlUp).Row\n\n    Dim search() As Variant\n    search = Worksheets(\"DETAILS2\").Range(Worksheets(\"DETAILS2\").Cells(1, 1), Worksheets(\"DETAILS2\").Cells(detlstrw, 25)).Value\n\n    Dim outpt() As Variant\n    ReDim outpt(1 To UBound(inpt, 1), 1 To 1)\n\n    Dim x As Long\n    For x = LBound(inpt, 1) To UBound(inpt, 1)\n        outpt(x, 1) = 0\n        Dim Y as Long\n        For y = LBound(search, 1) To UBound(search, 1)\n            If inpt(x, 1) = search(y, 1) And inpt(x, 2) = search(y, 2) And inpt(x, 5) = search(y, 24) And inpt(x, 6) = search(y, 25) Then\n                outpt(x, 1) = search(y, 18)\n                Exit For\n            End If\n        Next y\n    Next x\n\n    .Range(\"N3\").Resize(UBound(outpt, 1), 1).Value = outpt\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 10911974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5546381f14f90be33e9fef7bc392bc9?s=128&d=identicon&r=PG&f=1", "display_name": "dare", "link": "https://stackoverflow.com/users/10911974/dare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 1, "accepted_answer_id": 56779774, "answer_count": 1, "score": 0, "last_activity_date": 1561584801, "creation_date": 1561575130, "last_edit_date": 1561575503, "question_id": 56779359, "link": "https://stackoverflow.com/questions/56779359/how-to-write-index-and-match-in-vba", "title": "How to write index and match in VBA", "body": "<p>I am getting blank results in my worksheet when i run index and match in VBA and i dont know why...please help.  </p>\n\n<p>I have some data in details2 worksheet which contains ID, names, servicetype cost and dates in different columns. I also have partly similar information in another worksheet called forecast but without the dates column. Because a client can have multiple service type starting at different dates, I have matched the ID, names, servicetype and cost to extract the desired dates. But I want to write this using VBA to make it flexible because i carry out this every month and the data ranges can change. I have already tried using array formula and copied it down which work fine. but when i put it in a loop the cells output is blank. I expect date values from DETAILS2 worksheet in column N of another sheet \n    but my column N is blank...other part of the program works fine.</p>\n\n<p>This is the code That I have tried which works:</p>\n\n<pre><code> With Test1Ws                   \n  .Range(\"N3\").FormulaArray = \"=IFNA(INDEX(DETAILS2!$A$3:$Z$780,MATCH(1, \n  (DETAILS2!$A$3:$A$780=B3)*(DETAILS2!$B$3:$B$780=C3)* \n  (details2!$X$3:$X$780=F3)*(details2!$Y$3:$Y$780=G3),0),18),0)\"\n  .Range(\"N3\").AutoFill .Range(\"N3:N\" &amp; Test1LastRow)\n End With\n</code></pre>\n\n<p>This is the code i wrote trying to make it flexible to change the ranges:</p>\n\n<pre><code> With Test1Ws\n  For x = 3 To Test1LastRow\n      On Error Resume Next\n      Test1Ws.Range(\"N\" &amp; x).Value = \n      Application.WorksheetFunction.IfNa(\n      Application.WorksheetFunction.Index(CurrDeIndexRng,\n      Application.WorksheetFunction.Match(1,(CurDeIdRng = .Range(\"B\" &amp; \n      x).Value) * (CurDeNameRng = .Range(\"C\" &amp; x).Value) * (CurDeServRng = \n      .Range(\"F\" &amp; x).Value) * (CurDeCstRng = .Range(\"G\" &amp; x).Value), 0), \n      18), 0)\n   Next x\n End With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1561574275, "post_id": 56779073, "comment_id": 100113406, "body": "Will you also need to <i>Unhide</i> items?"}, {"owner": {"reputation": 31, "user_id": 6835996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d084d58d7a8d906791beaf50c3cd69fe?s=128&d=identicon&r=PG&f=1", "display_name": "FonR", "link": "https://stackoverflow.com/users/6835996/fonr"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1561574999, "post_id": 56779073, "comment_id": 100113729, "body": "No need for unhiding any items for this. @TimWilliams"}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 1, "creation_date": 1561647797, "post_id": 56779073, "comment_id": 100142407, "body": "Please be aware that ALWAYS at least 1 pivotitem has to remain visible. Worst case: If the last item is invisible and should be the only visible one, the you&#39;ll get an error at the second last item, as in this short moment every item is invisible."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6835996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d084d58d7a8d906791beaf50c3cd69fe?s=128&d=identicon&r=PG&f=1", "display_name": "FonR", "link": "https://stackoverflow.com/users/6835996/fonr"}, "edited": false, "score": 0, "creation_date": 1561574860, "post_id": 56779150, "comment_id": 100113678, "body": "Awesome! Thank you @Shai Rado! This is exactly what I&#39;m looking for."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1561574195, "creation_date": 1561574195, "answer_id": 56779150, "question_id": 56779073, "link": "https://stackoverflow.com/questions/56779073/using-an-array-to-check-pivotitems-name-array-then-pivotitems-visible-false/56779150#56779150", "title": "Using an Array to check PivotItems.Name &lt;&gt; Array Then PivotItems.Visible = False", "body": "<p>You can use <code>Application.Match</code> to check it. Combined with <code>IsError</code> in front of it, it will check if a current <code>PivotItem</code> name is not found within the entire <code>Supply</code> array).</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Supply = Array(\"X Marketplace\", \"Y Marketplace\")\n\nWith PivFid\n    For i = 1 To .PivotItems.Count\n        If IsError(Application.Match(.PivotItems(i).Name, Supply, 0)) Then .PivotItems(i).Visible = False\n    Next i\nEnd With\n</code></pre>\n\n<p><strong>Just in case</strong> you need to show the other ones:</p>\n\n<pre><code>With PivFid\n    For i = 1 To .PivotItems.Count\n        If IsError(Application.Match(.PivotItems(i).Name, Supply, 0)) Then\n            .PivotItems(i).Visible = False\n        Else\n            .PivotItems(i).Visible = True\n        End If\n    Next i\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6835996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d084d58d7a8d906791beaf50c3cd69fe?s=128&d=identicon&r=PG&f=1", "display_name": "FonR", "link": "https://stackoverflow.com/users/6835996/fonr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 56779150, "answer_count": 1, "score": 2, "last_activity_date": 1561575117, "creation_date": 1561573850, "last_edit_date": 1561575117, "question_id": 56779073, "link": "https://stackoverflow.com/questions/56779073/using-an-array-to-check-pivotitems-name-array-then-pivotitems-visible-false", "title": "Using an Array to check PivotItems.Name &lt;&gt; Array Then PivotItems.Visible = False", "body": "<p>I am attempting to use an array to check the filtered pivot items in the pivot table to see if it should be visible or not. Currently I have it hard coded with the code below. However, I would like to use an Array when I have more then one item to check against the filter. </p>\n\n<p>The goal is to only filter on the items needed.</p>\n\n<pre><code>Supply = Array(\"X Marketplace\", \"Y Marketplace\")\n\nWith PivFid\n    For i = 1 To .PivotItems.Count\n        If .PivotItems(i).Name &lt;&gt; \"X Marketplace\" Then .PivotItems(i).Visible = False\n    Next i\nEnd With\n</code></pre>\n\n<p>This is something I am trying to accomplish but I'm not sure how to loop through the array against the filtered items.</p>\n\n<pre><code>With PivFid\n    For i = 1 To .PivotItems.Count\n        If .PivotItems(i).Name &lt;&gt; Supply Then .PivotItems(i).Visible = False\n    Next i\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 2, "last_activity_date": 1561574057, "creation_date": 1561574057, "answer_id": 56779121, "question_id": 56779067, "link": "https://stackoverflow.com/questions/56779067/why-vba-is-replacing-sn-sh-as-zeros-in-the-word-snapshot-as-00ap00ot/56779121#56779121", "title": "Why vba is replacing SN-Sh as zeros in the Word Snapshot as 00ap00ot?", "body": "<p>Your sheet name should be: </p>\n\n<pre><code>SheetName = Format(Date, \"mm-dd\") &amp; \" snapshot\"\n</code></pre>\n\n<p>You are formatting a <code>Date</code>, which has a time associated... use of \"s\", etc., are related to seconds, etc.</p>\n\n<p>See: <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/format-function-visual-basic-for-applications\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/format-function-visual-basic-for-applications</a></p>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1561581049, "creation_date": 1561581049, "answer_id": 56780443, "question_id": 56779067, "link": "https://stackoverflow.com/questions/56779067/why-vba-is-replacing-sn-sh-as-zeros-in-the-word-snapshot-as-00ap00ot/56780443#56780443", "title": "Why vba is replacing SN-Sh as zeros in the Word Snapshot as 00ap00ot?", "body": "<p>You are seeing the zeroes, because <code>s</code>,<code>n</code>&amp; <code>h</code> are <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/format-function-visual-basic-for-applications\" rel=\"nofollow noreferrer\">special letters in Format</a>. If you like to define the format additionally, this is a way to do it:</p>\n\n<pre><code>Sub SheetNameAsCurrentDate()\n\n    Dim sheetName As String\n    sheetName = Format(Date, \"mm-dd \"\"snapshot\"\"\")\n    Debug.Print sheetName\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11704425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e04a318d86627a373c0dfb897d153897?s=128&d=identicon&r=PG&f=1", "display_name": "Leouser4041", "link": "https://stackoverflow.com/users/11704425/leouser4041"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1561581049, "creation_date": 1561573828, "last_edit_date": 1561573988, "question_id": 56779067, "link": "https://stackoverflow.com/questions/56779067/why-vba-is-replacing-sn-sh-as-zeros-in-the-word-snapshot-as-00ap00ot", "title": "Why vba is replacing SN-Sh as zeros in the Word Snapshot as 00ap00ot?", "body": "<p>When I am trying to add new sheets with today's \"mm-dd snapshot\"\nthe letters sn-sh are replaced by 00 like \"00ap00ot\"</p>\n\n<pre><code>Sub SheetNameAsCurrentDate()\nDim SheetName As String\n    'I am trying to add a new sheet with date &amp; name\n     SheetName = Format(Date, \"mm-dd snapshot\")\n     Sheets. Add, Worksheets(Worksheets.Count)\n    ActiveSheet.Name = SheetName\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "logging", "barcode-scanner", "inventory"], "owner": {"reputation": 21, "user_id": 11703396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_PQrrKRqerM/AAAAAAAAAAI/AAAAAAAACvU/Uo6ahrJNPwY/photo.jpg?sz=128", "display_name": "Ykeshia Zamore", "link": "https://stackoverflow.com/users/11703396/ykeshia-zamore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1561614109, "creation_date": 1561572399, "last_edit_date": 1561614109, "question_id": 56778729, "link": "https://stackoverflow.com/questions/56778729/how-do-you-create-a-form-to-scan-part-numbers-and-auto-populate-inventory-amount", "title": "How do you create a form to scan part numbers and auto-populate inventory amount into spreadsheet?", "body": "<p>I am working on a log system for a machine shop and each part has a part number. I am creating an excel spreadsheet to account for the time of checkout, bin location, part #, and check out quantity. I have worked out the kinks to add a time stamp but I am still having issues with figuring out how to auto-populate the part numbers and the quantity of parts checked out (i.e. I checked out 20 ball bearings, part #-50000; check out quantity-20) </p>\n\n<p>I have already done the time stamp using circular reference. My first attempt was trying to use Consolidate and I attempted to do the check out quantity using a <code>COUNTIFS</code> formula.</p>\n\n<pre><code>[Countifs formula][1]\n=COUNTIFS(C:C, C2)\n</code></pre>\n\n<p>I got excel to count the number of parts scanned with the same part #, but when I use the consolidate feature and the statement below pops up. I am unsure what it means. Is there any easier way to scan 20 parts with the same part number so the check out system is similar to a grocery checkout? </p>\n\n<p><a href=\"https://i.stack.imgur.com/yGWsg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yGWsg.png\" alt=\"Consolidate 1\"></a>  </p>\n\n<p><a href=\"https://i.stack.imgur.com/dcLaJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dcLaJ.png\" alt=\"Consolidate 2\"></a></p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 2608120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6578ed3ec4e94b8deb8413bb71e5cc4a?s=128&d=identicon&r=PG", "display_name": "Bestinc", "link": "https://stackoverflow.com/users/2608120/bestinc"}, "edited": false, "score": 1, "creation_date": 1561572737, "post_id": 56778711, "comment_id": 100112699, "body": "The controls method works. Thank you! I am happy to learn that"}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 4, "last_activity_date": 1561572326, "creation_date": 1561572326, "answer_id": 56778711, "question_id": 56778590, "link": "https://stackoverflow.com/questions/56778590/textbox-is-reference-to-another-textbox-need-to-return-the-value-of-whats-in-th/56778711#56778711", "title": "Textbox is reference to another Textbox, need to return the value of whats in the second textbox", "body": "<p>You could obtain the control from the Controls collection, e.g.:</p>\n\n<pre><code>test = Forms(\"Your Form Name\").Controls(Forms![Form]![CFMon]).Value\n</code></pre>\n\n<p>Alternatively, you could use the <a href=\"https://support.office.com/en-us/article/eval-function-8c4a1b10-85ba-40db-b0c8-5290da4d4166\" rel=\"nofollow noreferrer\"><code>eval</code></a> function, but I would advise against this:</p>\n\n<pre><code>test = eval(\"Forms![Your Form Name]![\" &amp; Forms![Form]![CFMon] &amp; \"].Value\")\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 2608120, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6578ed3ec4e94b8deb8413bb71e5cc4a?s=128&d=identicon&r=PG", "display_name": "Bestinc", "link": "https://stackoverflow.com/users/2608120/bestinc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 56778711, "answer_count": 1, "score": 1, "last_activity_date": 1594714834, "creation_date": 1561571787, "last_edit_date": 1594714834, "question_id": 56778590, "link": "https://stackoverflow.com/questions/56778590/textbox-is-reference-to-another-textbox-need-to-return-the-value-of-whats-in-th", "title": "Textbox is reference to another Textbox, need to return the value of whats in the second textbox", "body": "<p>There is probably a simple solution to this, but it is eluding me. </p>\n\n<p>I have a textbox (name = CFMon), that references a month textbox. The user will submit values for all months, but they select a key month that is used for a calculation. I need to use their selected key month to get the value from the appropriate month textbox (each month is named mon1, mon2, etc)</p>\n\n<p>When not using VBA, I would simply use the indirect function to evaluate all of the string. </p>\n\n<pre><code>test = Forms![Form]![CFMon] &amp; \".value\" \n</code></pre>\n\n<p>this does exactly what it is supposed to do and just regurgitate the text string</p>\n\n<p>I am hoping the evaluate the reference and return the appropriate month value. For Example. The user selects CFMon = Mon3, the value will return the value the user inputs in the Mon3 (March) textbox</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 8696481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1ac759f87c4bdfdabc7c532a647d003?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/8696481/joe"}, "edited": false, "score": 0, "creation_date": 1561575269, "post_id": 56778663, "comment_id": 100113852, "body": "what is <code>FK</code> in <code>HID (FK)</code> and how do you assign it?  Thanks for help by the way"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 53, "user_id": 8696481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1ac759f87c4bdfdabc7c532a647d003?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/8696481/joe"}, "edited": false, "score": 0, "creation_date": 1561580225, "post_id": 56778663, "comment_id": 100115548, "body": "<code>FK</code> stands for <a href=\"https://en.wikipedia.org/wiki/Foreign_key\" rel=\"nofollow noreferrer\">Foreign Key</a>; <code>PK</code> stands for <a href=\"https://en.wikipedia.org/wiki/Primary_key\" rel=\"nofollow noreferrer\">Primary Key</a>. The foreign key in my proposed &#39;detail&#39; table contains the value of the <code>ID</code> primary key field in the &#39;header&#39; table."}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 1, "last_activity_date": 1561580291, "last_edit_date": 1561580291, "creation_date": 1561572089, "answer_id": 56778663, "question_id": 56778447, "link": "https://stackoverflow.com/questions/56778447/how-to-group-data-by-rows/56778663#56778663", "title": "How to group data by rows?", "body": "<p>You are encountering issues because your data does not follow basic <a href=\"https://support.microsoft.com/en-gb/help/283878/description-of-the-database-normalization-basics\" rel=\"nofollow noreferrer\">database normalisation rules</a> - it has no structure and is merely presented in a list as you might use in Excel.</p>\n\n<p>Consider that MS Access works with <strong>unordered datasets</strong>, and therefore <strong>you cannot rely on the order of records output by a query unless an <code>order by</code> clause is specified.</strong> </p>\n\n<p>For your dataset, this means that there is nothing relating the <code>DISCONNECT BUS 1</code> record to the <code>CONTINGENCY 'AA:P1_AA'</code> record.</p>\n\n<p>As a start, I would suggest splitting your data into two separate tables: the first might contain the <code>'header'</code> information, such as:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>+---------+------------------------+----------+\n| ID (PK) |          Data          | Location |\n+---------+------------------------+----------+\n|       1 | CONTINGENCY 'AA:P1_AA' | X        |\n|       2 | CONTINGENCY 'AB:P1_AB' | X        |\n|       3 | CONTINGENCY 'AC:P1_AC' | X        |\n+---------+------------------------+----------+\n</code></pre>\n\n<p>The second (call it <code>'detail'</code>) would have the contents of each <code>'header'</code> record, linked on the primary key in the <code>'header'</code> table, e.g.:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>+---------+----------+-------------------+\n| ID (PK) | HID (FK) |       Data        |\n+---------+----------+-------------------+\n|       1 |        1 | DISCONNECT BUS 1  |\n|       2 |        1 | DISCONNECT BUS 2  |\n|       3 |        1 | DISCONNECT BUS 3  |\n|       4 |        1 | DISCONNECT BUS 4  |\n|       5 |        1 | DISCONNECT BUS 5  |\n|       6 |        1 | DISCONNECT BUS 6  |\n|       7 |        1 | DISCONNECT BUS 7  |\n|       8 |        2 | DISCONNECT BUS 8  |\n|       9 |        2 | DISCONNECT BUS 9  |\n|      10 |        2 | DISCONNECT BUS 10 |\n|      11 |        3 | DISCONNECT BUS 11 |\n|      12 |        3 | DISCONNECT BUS 12 |\n|      13 |        3 | DISCONNECT BUS 13 |\n+---------+----------+-------------------+\n</code></pre>\n\n<p>Here, <code>FK</code> stands for <a href=\"https://en.wikipedia.org/wiki/Foreign_key\" rel=\"nofollow noreferrer\">Foreign Key</a>; <code>PK</code> stands for <a href=\"https://en.wikipedia.org/wiki/Primary_key\" rel=\"nofollow noreferrer\">Primary Key</a>. The foreign key in my proposed <code>'detail'</code> table contains the value of the ID primary key field in the <code>'header'</code> table.</p>\n\n<p>That way, you can easily create a query with obtains the required results, e.g.:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>select header.data, detail.data\nfrom header inner join detail on header.id = detail.hid\nwhere header.id = [Please enter an ID:] and header.location = [Please enter a location:]\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 8696481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1ac759f87c4bdfdabc7c532a647d003?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/8696481/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 56778663, "answer_count": 1, "score": 0, "last_activity_date": 1594714848, "creation_date": 1561571102, "last_edit_date": 1594714848, "question_id": 56778447, "link": "https://stackoverflow.com/questions/56778447/how-to-group-data-by-rows", "title": "How to group data by rows?", "body": "<p>I am finding difficulty grouping rows by using identifiers. I have 3 columns <code>Data</code>, <code>ID</code>, and <code>Location</code>. I am trying to use queries to somehow search up the location and ID number so data would show up for one particular data point. The issue is, my data is in rows instead of columns: My table is shown below:</p>\n\n<pre><code>    Data                    ID  Location\n\n    CONTINGENCY 'AA:P1_AA'   1     X\n     DISCONNECT BUS 1        \n     DISCONNECT BUS 2        \n     DISCONNECT BUS 3        \n     DISCONNECT BUS 4        \n     DISCONNECT BUS 5        \n     DISCONNECT BUS 6        \n     DISCONNECT BUS 7        \n    END      \n    CONTINGENCY 'AB:P1_AB'   2     X\n     DISCONNECT BUS 8        \n     DISCONNECT BUS 9        \n     DISCONNECT BUS 10           \n    END      \n    CONTINGENCY 'AC:P1_AC'   3     X\n     DISCONNECT BUS 11       \n     DISCONNECT BUS 12       \n     DISCONNECT BUS 13       \n    END             \n</code></pre>\n\n<p>I tried use two queries where I search up the ID and Location and some data would show up in front of me. The issue is when I search it, only one line of data pops up. \nFor example:\n<code>[Please enter Location:]</code> Lets say I type in X\n<code>[Please enter ID #:]</code> Lets say I pick 1</p>\n\n<p>The output from access when running Query would be:\n<code>CONTINGENCY 'AB:P1_AB'</code></p>\n\n<p>My desired output is </p>\n\n<pre><code>CONTINGENCY 'AB:P1_AB'      \n DISCONNECT BUS 8        \n DISCONNECT BUS 9        \n DISCONNECT BUS 10           \nEND\n</code></pre>\n\n<p>I do realize I can just type in 1's and X's for all those lines of data but it would be inefficient. Is there some way where I can group all those lines of code together when I do search queries.</p>\n\n<pre><code>FROM Sheet2\nWHERE (((Sheet2.Location)=[Please enter Location:]) AND ((Sheet2.ID)=[Please enter ID #:]));```\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1561570807, "post_id": 56778281, "comment_id": 100111898, "body": "Can you share the url or paste the html using the snippet tool via <a href=\"https://stackoverflow.com/posts/56778281/edit\">edit</a> so we can copy paste for testing"}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1561599017, "post_id": 56778281, "comment_id": 100120247, "body": "From the picture of your HTML code it looks like what you are trying to select is a span tag which does not has any event. If you post your sample HTML than we can try to run it and check its structure. Than we can make a test with the VBA code may help to get idea about how to accomplish your requirement."}], "answers": [{"tags": [], "owner": {"reputation": 83, "user_id": 7133824, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210514513757244/picture?type=large", "display_name": "B&#225;lint Kolosi", "link": "https://stackoverflow.com/users/7133824/b%c3%a1lint-kolosi"}, "is_accepted": false, "score": 0, "last_activity_date": 1561572157, "creation_date": 1561572157, "answer_id": 56778674, "question_id": 56778281, "link": "https://stackoverflow.com/questions/56778281/how-to-access-option-from-dropdown-menu-in-vba/56778674#56778674", "title": "How to access option from dropdown menu in VBA", "body": "<p>A url would be helpful indeed but what you are looking for must be in that select tag element.</p>\n\n<p>HTML name attributes are not always unique but assuming that's the first one with this name you can set the select element into an object this way:</p>\n\n<pre><code>Set objSelect = ie3.getElementsByName(\"selectedHostId\")(0)\n</code></pre>\n\n<p>If you expand that element, you'll see that it has child elements with option tag. \nOption tags have value and also innertext which are not always the same. You have to use the value.</p>\n\n<pre><code>objSelect.Value = \"ValeOfOptionElementYouNeed\"\n</code></pre>\n\n<p>The dropdown has an onChange event. You might need to \"fire\" it in order to imitate a manual selection:</p>\n\n<pre><code>objSelect.FireEvent \"onChange\"\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 11563365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6fa7d4d493cf720f17567c3b9eaa2?s=128&d=identicon&r=PG&f=1", "display_name": "Celine N", "link": "https://stackoverflow.com/users/11563365/celine-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1561572157, "creation_date": 1561570343, "question_id": 56778281, "link": "https://stackoverflow.com/questions/56778281/how-to-access-option-from-dropdown-menu-in-vba", "title": "How to access option from dropdown menu in VBA", "body": "<p>I am new to VBA and i have to select option 2 from a dropdown menu in one of the internet explorer pages of a specific website. </p>\n\n<p>Here is a snapshot of the html code of the webpage. \n<a href=\"https://i.stack.imgur.com/spP2H.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/spP2H.png\" alt=\"enter image description here\"></a></p>\n\n<p>I cannot figure out a way of accessing the dropdown option in VBA. \nI tried using this but ist doesn't seem to target the element i want. </p>\n\n<pre><code>Set objShell3 = CreateObject(\"Shell.Application\")\n              IE_count = objShell3.Windows.Count\n              For x = 0 To (IE_count - 1)\n            On Error Resume Next\n            my_url = objShell3.Windows(x).document.Location\n            my_title = objShell3.Windows(x).document.Title\n             MsgBox (\"The title of this page is: \" &amp; my_title)\n\n\n         If my_title Like \"Export to Excel\" &amp; \"*\" Then\n        Set ie3 = objShell3.Windows(x).document\n        my_title3 = ie3.Title\n        MsgBox (\"The title of Export to Excel is: \" &amp; my_title3)\n        Exit For\n    Else\nEnd If\n\nNext\n\n      For Each element In ie3.getElementsByTagName(\"a\")\n  If element.innerText = \"Option2\" Then\n\n    element.Click\n      Exit For\n        Else\n    End If\nNext\n</code></pre>\n\n<p>Is there any specific syntax to access the options of a dropdown menu in vba? </p>\n\n<p>Thank you :) </p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1561569682, "post_id": 56777899, "comment_id": 100111358, "body": "How should they appear in the same worksheet? Side by side? One above the other?"}, {"owner": {"reputation": 23, "user_id": 11703627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f57cccf049334acbb97e2694b9653074?s=128&d=identicon&r=PG&f=1", "display_name": "Turtlemp", "link": "https://stackoverflow.com/users/11703627/turtlemp"}, "reply_to_user": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1561576522, "post_id": 56777899, "comment_id": 100114358, "body": "one above the other"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11703627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f57cccf049334acbb97e2694b9653074?s=128&d=identicon&r=PG&f=1", "display_name": "Turtlemp", "link": "https://stackoverflow.com/users/11703627/turtlemp"}, "edited": false, "score": 0, "creation_date": 1561576564, "post_id": 56778214, "comment_id": 100114378, "body": "I am a noob to this and pieced this together so i apologize but how would that look?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 23, "user_id": 11703627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f57cccf049334acbb97e2694b9653074?s=128&d=identicon&r=PG&f=1", "display_name": "Turtlemp", "link": "https://stackoverflow.com/users/11703627/turtlemp"}, "edited": false, "score": 0, "creation_date": 1561579689, "post_id": 56778214, "comment_id": 100115345, "body": "You would probably have to open Excel and create the workbook, worksheet, and names ranges via automation."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1561570078, "creation_date": 1561570078, "answer_id": 56778214, "question_id": 56777899, "link": "https://stackoverflow.com/questions/56777899/access-vba-to-run-multiple-select-queries-and-export-to-excel-on-different-works/56778214#56778214", "title": "Access VBA To run multiple select queries and export to excel on different worksheets", "body": "<p>Create the worksheet in the file and create two <em>Named Range</em>s in this. </p>\n\n<p>Name these as, say, <em>NamedRangeName1</em> and <em>NamedRangeName2</em>.</p>\n\n<p>Then run:</p>\n\n<pre><code>DoCmd.TransferSpreadsheet acExport, , \"temp1\", strFolder &amp; \"Validated.xlsx\", True, \"NamedRangeName1\"\nDoCmd.TransferSpreadsheet acExport, , \"temp2\", strFolder &amp; \"Validated.xlsx\", True, \"NamedRangeName2\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 11703627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f57cccf049334acbb97e2694b9653074?s=128&d=identicon&r=PG&f=1", "display_name": "Turtlemp", "link": "https://stackoverflow.com/users/11703627/turtlemp"}, "edited": false, "score": 0, "creation_date": 1561586504, "post_id": 56780392, "comment_id": 100117808, "body": "My goal is to eventually add around 20 queries that check various things. Is there a way to combine them all with union? Better way to group mutiple queries together by declaring the variables together to one variable such as qry1 and qry2 = to qry3?"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 23, "user_id": 11703627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f57cccf049334acbb97e2694b9653074?s=128&d=identicon&r=PG&f=1", "display_name": "Turtlemp", "link": "https://stackoverflow.com/users/11703627/turtlemp"}, "edited": false, "score": 0, "creation_date": 1561590434, "post_id": 56780392, "comment_id": 100118803, "body": "Using this method, all queries must have the same number of columns of the same data types, so 20 unioned queries may not be a viable solution. With that said, if the queries are outputting different data, why would you want them above one another as opposed to in separate worksheets/workbooks?"}, {"owner": {"reputation": 23, "user_id": 11703627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f57cccf049334acbb97e2694b9653074?s=128&d=identicon&r=PG&f=1", "display_name": "Turtlemp", "link": "https://stackoverflow.com/users/11703627/turtlemp"}, "edited": false, "score": 0, "creation_date": 1561645674, "post_id": 56780392, "comment_id": 100141062, "body": "These are going to be queries that validate propagation between tables and other things to make sure there are no errors.  It would be easier if all errors could show on one worksheet especially if there are like 20 queries."}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 0, "last_activity_date": 1561580800, "creation_date": 1561580800, "answer_id": 56780392, "question_id": 56777899, "link": "https://stackoverflow.com/questions/56777899/access-vba-to-run-multiple-select-queries-and-export-to-excel-on-different-works/56780392#56780392", "title": "Access VBA To run multiple select queries and export to excel on different worksheets", "body": "<p>Since you are looking for the results of the queries to be output <em>one above the other</em> in the worksheet, I might suggest altering your SQL to combine the results of the two queries using a <code>union</code>, and then output the results of this <strong>single</strong> query to a spreadsheet:</p>\n\n<pre><code>select distinct \n    IIf(IsDate([models].[startdate])=False,'No  ' &amp; [models.Startdate],'Yes') as StartDate, \n    IIf(IsDate([models].[Enddate])=False,'No  ' &amp; [models.Enddate],'Yes') as EndDate,\n    null as Expr1\nfrom \n    [Models]\nunion all\nselect distinct \n    Left([pages.imagefile],InStr([pages.imagefile],'_')-1) as Pages_Series, \n    Left([parts.imagefile],InStr([parts.imagefile],'_')-1) as Parts_ImgSeries, \n    IIf([Pages_Series]=[Parts_ImgSeries],'Yes','No') as Expr1 \nfrom \n    [Pages], [Parts]\n</code></pre>\n\n<p>I would also suggest using the <strong>ampersand operator</strong> (<code>&amp;</code>) for concatenation, as this will always treat the arguments as strings, whereas the addition operator (<code>+</code>) will first attempt to interpret the numerical content of the data before resorting to concatenation if the data is non-numerical.</p>\n"}], "owner": {"reputation": 23, "user_id": 11703627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f57cccf049334acbb97e2694b9653074?s=128&d=identicon&r=PG&f=1", "display_name": "Turtlemp", "link": "https://stackoverflow.com/users/11703627/turtlemp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 180, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594714861, "creation_date": 1561568754, "last_edit_date": 1594714861, "question_id": 56777899, "link": "https://stackoverflow.com/questions/56777899/access-vba-to-run-multiple-select-queries-and-export-to-excel-on-different-works", "title": "Access VBA To run multiple select queries and export to excel on different worksheets", "body": "<p>I am trying to export multiple queries to the same excel worksheet and name the excel worksheet.  I can get it to export to multiple worksheets in the same spreadsheet but not the same one.</p>\n\n<p>Option Compare Database</p>\n\n<pre><code>Sub validate()\n\nDim db As Database\nSet db = CurrentDb\nDim strFolder As String\nDim rst1 As DAO.Recordset\nDim rst2 As DAO.Recordset\nDim qry1 As String\nDim qry2 As String\n\nqry1 = \"SELECT DISTINCT IIf(IsDate([models].[startdate])=False,'No' + '  ' + [models.Startdate],'Yes') AS StartDate, IIf(IsDate([models].[Enddate])=False,\" &amp; _\n            \"'No' + '  ' + [models.Enddate],'Yes') AS EndDate FROM [Models]\"\n db.CreateQueryDef \"temp1\", qry1\n\n\n\nqry2 = \"SELECT DISTINCT Left([pages.imagefile],InStr([pages.imagefile],'_')-1) AS Pages_Series, \" &amp; _\n       \"Left([parts.imagefile],InStr([parts.imagefile],'_')-1) AS Parts_ImgSeries, IIf([Pages_Series]=[Parts_ImgSeries],'Yes','No') AS Expr1 FROM [Pages], [Parts]\"\n\n db.CreateQueryDef \"temp2\", qry2\n\n\n\nstrFolder = CurrentProject.Path &amp; \"\\\"\n\n    DoCmd.TransferSpreadsheet acExport, , \"temp1\", strFolder &amp; \"Validated.xlsx\", True\n    DoCmd.TransferSpreadsheet acExport, , \"temp2\", strFolder &amp; \"Validated.xlsx\", True\n\n  CurrentDb.QueryDefs.Delete \"temp1\"\n  CurrentDb.QueryDefs.Delete \"temp2\"\n\nEnd Sub\n</code></pre>\n\n<p>This will put both queries into 2 different worksheets but I need them both in the same worksheet. Also how to name the worksheet too.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1561568251, "post_id": 56777490, "comment_id": 100110726, "body": "Is a formula an option for this? I think you could easily use <code>COUNTIFS</code> and an <code>IF</code> to get the result you want, if I understand what you are trying to do."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1561568500, "post_id": 56777490, "comment_id": 100110834, "body": "To answer the question in your code about <code>If Not C Is Nothing Then</code>: If <code>C</code> is <code>Nothing</code>, it&#39;s because the <code>find</code> did not find anything, you want to check before doing anything with <code>C</code> that it is indeed something (i.e. <code>Not</code> Nothing) or errors are likely to occur. This is what your <code>If</code> statement does"}, {"owner": {"reputation": 3, "user_id": 11700263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53d4c78c9d78907b9a4decdb7c27ac88?s=128&d=identicon&r=PG&f=1", "display_name": "oexemant", "link": "https://stackoverflow.com/users/11700263/oexemant"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1561569039, "post_id": 56777490, "comment_id": 100111062, "body": "@BigBen I am not sure how I would use a formula for this... would you mind explaining a little further?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1561569788, "post_id": 56777490, "comment_id": 100111413, "body": "<code>=IF(COUNTIFS(CurrentBSCOA!E:E,C1,CurrentBSCOA!F:F,D1),&quot;Previ&zwnj;&#8203;ously Added&quot;, &quot;Added by Tom&quot;)</code>  I may have the columns to search switched."}, {"owner": {"reputation": 3, "user_id": 11700263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53d4c78c9d78907b9a4decdb7c27ac88?s=128&d=identicon&r=PG&f=1", "display_name": "oexemant", "link": "https://stackoverflow.com/users/11700263/oexemant"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1561570040, "post_id": 56777490, "comment_id": 100111539, "body": "The formula is returning the same responses as the macro... could it be due to the fact that the cells on the new sheet are not in the same relative spot as the original sheet? @ScottCraner"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11700263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53d4c78c9d78907b9a4decdb7c27ac88?s=128&d=identicon&r=PG&f=1", "display_name": "oexemant", "link": "https://stackoverflow.com/users/11700263/oexemant"}, "edited": false, "score": 0, "creation_date": 1561569682, "post_id": 56777960, "comment_id": 100111357, "body": "Thank you for your help! what would the &quot;Then&quot; statement look like for that then... I am confused on what to tell the code to do next"}, {"owner": {"reputation": 111, "user_id": 11682371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6aef3eb1f706c18fff41556dcdbbc31?s=128&d=identicon&r=PG&f=1", "display_name": "dasche", "link": "https://stackoverflow.com/users/11682371/dasche"}, "reply_to_user": {"reputation": 3, "user_id": 11700263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53d4c78c9d78907b9a4decdb7c27ac88?s=128&d=identicon&r=PG&f=1", "display_name": "oexemant", "link": "https://stackoverflow.com/users/11700263/oexemant"}, "edited": false, "score": 0, "creation_date": 1561570107, "post_id": 56777960, "comment_id": 100111578, "body": "That was an example of a positive look for a blank cell. I should have probably included if you only want to do &quot;stuff&quot; on non-blank cells you can change it to be <code>If c.value &lt;&gt; &quot;&quot; then</code> and then have all the code sitting inside that if statement that is supposed to run"}, {"owner": {"reputation": 111, "user_id": 11682371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6aef3eb1f706c18fff41556dcdbbc31?s=128&d=identicon&r=PG&f=1", "display_name": "dasche", "link": "https://stackoverflow.com/users/11682371/dasche"}, "reply_to_user": {"reputation": 3, "user_id": 11700263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53d4c78c9d78907b9a4decdb7c27ac88?s=128&d=identicon&r=PG&f=1", "display_name": "oexemant", "link": "https://stackoverflow.com/users/11700263/oexemant"}, "edited": false, "score": 0, "creation_date": 1561571411, "post_id": 56777960, "comment_id": 100112145, "body": "I&#39;m not sure which blank cells are the issue but if I&#39;m reading correctly it&#39;s where the test is <code>If C.Offset(0, 1).Value = SubValueToFind Then</code>  you could add in an extra condition so it looks like this <code>If C.Offset(0, 1).Value = SubValueToFind and C.Offset(0,1).value &lt;&gt; &quot;&quot; Then</code>"}, {"owner": {"reputation": 3, "user_id": 11700263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53d4c78c9d78907b9a4decdb7c27ac88?s=128&d=identicon&r=PG&f=1", "display_name": "oexemant", "link": "https://stackoverflow.com/users/11700263/oexemant"}, "edited": false, "score": 0, "creation_date": 1561572431, "post_id": 56777960, "comment_id": 100112565, "body": "Thank you, this worked! Your advice led me to solving the issue."}], "tags": [], "owner": {"reputation": 111, "user_id": 11682371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6aef3eb1f706c18fff41556dcdbbc31?s=128&d=identicon&r=PG&f=1", "display_name": "dasche", "link": "https://stackoverflow.com/users/11682371/dasche"}, "is_accepted": true, "score": 0, "last_activity_date": 1561569023, "creation_date": 1561569023, "answer_id": 56777960, "question_id": 56777490, "link": "https://stackoverflow.com/questions/56777490/vba-find-not-returning-correct-values-when-cells-are-blank/56777960#56777960", "title": "VBA Find Not Returning Correct Values When Cells Are Blank", "body": "<p>When you do <code>Set C = .Find(AcctValueToFind)</code> that will potentially find the cell you are looking for and running the check <code>If Not C Is Nothing</code> is good practice but doesn't mean that it found a blank cell. If <code>C Is Nothing</code> is TRUE that means it couldn't find a match and therefore won't be referencing any range anywhere, hence being called \"Nothing\".</p>\n\n<p>A way to check if a cell is blank is <code>If c.value = \"\" Then</code>. So I would nest/modify that statement where it fits appropriately (probably inside the <code>If Not C Is Nothing Then</code> block).</p>\n"}], "owner": {"reputation": 3, "user_id": 11700263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53d4c78c9d78907b9a4decdb7c27ac88?s=128&d=identicon&r=PG&f=1", "display_name": "oexemant", "link": "https://stackoverflow.com/users/11700263/oexemant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 56777960, "answer_count": 1, "score": 0, "last_activity_date": 1561569023, "creation_date": 1561567135, "last_edit_date": 1561568322, "question_id": 56777490, "link": "https://stackoverflow.com/questions/56777490/vba-find-not-returning-correct-values-when-cells-are-blank", "title": "VBA Find Not Returning Correct Values When Cells Are Blank", "body": "<p>I have this code that is supposed to return one of two text values in column J based on whether or not two adjacent values in that worksheet are found in another worksheet (they MUST be adjacent to each other in both worksheets). If the adjacent values in the one worksheet are found adjacent to each other found in the other worksheet , it returns  \"Previously Added,\" if not, it returns \"Tom Added.\" The code runs, however, if the \"SubValueToFind\" is a blank value, it may return the wrong text, that is, it may mean to return a \"Previously Added,\" when it actually returns \"Tom Added.\" </p>\n\n<p>Any cell that is classified as \"Previously Added\" is correct, even if there is a blank cell in the SubValueToFind. However, if that value is blank, which many are, it can mistakenly classify it as \"Tom Added,\" when it should be \"Previously Added,\" as it is in the other worksheet. Again, it only happens when there is a blank value in the Sub column. </p>\n\n<pre><code>Sub UpdateTomAdd()\n\nDim LR As Long, i As Long\nDim AcctSearchRange As Range\nDim AcctFindRange As Range, C As Range, Cel As Range, D As Range\nDim AcctValueToFind As Variant\nDim SubValueToFind As Variant\nDim CurrentSheet As Worksheet\nDim xlSheet As Worksheet, Xfound As Boolean\nDim firstAddress  As String\n\nSet CurrentSheet = ActiveWorkbook.ActiveSheet\nSet xlSheet = ActiveWorkbook.Worksheets(\"CurrentBSCOA\")\nSet AcctSearchRange = xlSheet.Range(\"E1:E\" &amp; xlSheet.Range(\"E\" &amp; Rows.Count).End(xlUp).Row)\nSet AcctFindRange = CurrentSheet.Range(\"C1:C\" &amp; CurrentSheet.Range(\"C\" &amp; Rows.Count).End(xlUp).Row)\n\nFor Each Cel In AcctFindRange.Cells\n    Xfound = False\n    AcctValueToFind = Cel.Value\n    SubValueToFind = Cel.Offset(0, 1).Value\n    With AcctSearchRange\n        Set C = .Find(AcctValueToFind)\n        If Not C Is Nothing Then 'does this mean if the sub value on the new sheet is blank?'\n            firstAddress = C.Address\n            Do\n                If C.Offset(0, 1).Value = SubValueToFind Then\n                    Xfound = True\n                    Exit Do\n                End If\n                Set C = .FindNext(C)\n            Loop While Not C Is Nothing And C.Address &lt;&gt; firstAddress\n        End If\n    End With\n\n    Cel.Offset(0, 7).Value = IIf(Xfound, \"Previously Added\", \"Added by Tom\")\n    Next Cel\nEnd Sub\n</code></pre>\n\n<p>If the adjacent values are found to be adjacent to each other in the other worksheet, it should say: \"Previously Added.\"\nIf the adjacent values are not found to be adjacent to each other in the other worksheet, it should say: \"Tom Added.\"</p>\n\n<p>Blank cells in the Sub column are causing errors.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1561568315, "post_id": 56777423, "comment_id": 100110749, "body": "Perhaps unrelated to your main question, but did you mean to tag this question as &quot;excel&quot; and not &quot;outlook&quot;? Also, what is <code>Item</code>? You are using <code>Emails(i)</code> everywhere else in the loop."}, {"owner": {"reputation": 105, "user_id": 11595922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7ff5f0abcc6a9e22b54df381f080164?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo_north", "link": "https://stackoverflow.com/users/11595922/tokyo-north"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1561569601, "post_id": 56777423, "comment_id": 100111320, "body": "@BigBen yes this is within an excel file. Also, that was just a recent typo. Even with <code>Emails(i)</code> in there it doesn&#39;t filter correctly."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1561570582, "post_id": 56777423, "comment_id": 100111790, "body": "Can you share the rest of your code, for better context?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1561578238, "post_id": 56777423, "comment_id": 100115074, "body": "Use olMail Class - Example <a href=\"https://stackoverflow.com/a/42547062/4539709\">stackoverflow.com/a/42547062/4539709</a> or Value 43, <a href=\"https://stackoverflow.com/a/56778847/4539709\">sid</a> answer should work."}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1561572947, "creation_date": 1561572947, "answer_id": 56778847, "question_id": 56777423, "link": "https://stackoverflow.com/questions/56777423/detecting-if-email-is-not-a-calendar-invite/56778847#56778847", "title": "Detecting if Email is not a calendar invite", "body": "<p>This works just fine for me. It skips the calendar invites</p>\n\n<pre><code>Option Explicit\n\nSub Sample()\n    Dim OutApp As Object\n    Dim oMail As Object, Item As Object\n    Dim objNS As Object, olFolder As Object\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set objNS = OutApp.GetNamespace(\"MAPI\")\n    Set olFolder = objNS.GetDefaultFolder(6) '&lt;~~ olFolderInbox = 6\n\n    For Each Item In olFolder.Items\n        'https://docs.microsoft.com/en-us/office/vba/api/outlook.olobjectclass\n        If Item.Class = 43 Then\n            Set oMail = Item\n            Debug.Print oMail.Subject\n            Debug.Print oMail.SenderEmailAddress\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 11595922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7ff5f0abcc6a9e22b54df381f080164?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo_north", "link": "https://stackoverflow.com/users/11595922/tokyo-north"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 56778847, "answer_count": 1, "score": 0, "last_activity_date": 1561573201, "creation_date": 1561566836, "last_edit_date": 1561573201, "question_id": 56777423, "link": "https://stackoverflow.com/questions/56777423/detecting-if-email-is-not-a-calendar-invite", "title": "Detecting if Email is not a calendar invite", "body": "<p>I have some code that imports emails into a form. However, it gets caught up on calender invites an such. As a response, I would like to filter out all these calender invites so they are not even trying to import in the first place. This is the code i have so far:</p>\n\n<pre><code>    Dim SenderCheck As String\n'Build the list selection box\nj = 0\nFor i = 1 To Emails.Count\n    With ListBox_Emails\n    If TypeName(Item) = \"MailItem\" Then\n    SenderCheck = Emails(i).Sender.Address\n    If InStr(1, SenderCheck, \"express-scripts.com\") &gt; 0 Then\n        .AddItem Emails(i).Sender\n        .List(j, 1) = Emails(i).Subject\n        .List(j, 2) = Emails(i).ReceivedTime\n        .List(j, 3) = \"N\"\n        j = j + 1\n        Else: MsgBox \"error\"\n        End If\n    Else: MsgBox \"not mail item\"\n    End If\n            End With\n    On Error GoTo TEMP\n</code></pre>\n\n<p>The issue is with the line <code>If TypeName(Item)=\"MailItem\" then</code> as everything is now deemed not a mail item and I get the \"Not a mail item\" error.</p>\n\n<p>How would I go about fixing this issue? I think the syntax is incorrect but I can not figure out how to correct it.</p>\n"}, {"tags": ["excel", "vba", "sorting", "button", "filtering"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1561566871, "post_id": 56777349, "comment_id": 100110161, "body": "What type of button are you using?  Forms, or ActiveX?  To be honest you&#39;d find it much more reliable to use hyperlinks in stead of buttons, since they&#39;d never end up getting mis-positioned.  <a href=\"https://stackoverflow.com/questions/32660492/running-vba-from-a-hyperlink/32662063#32662063\" title=\"running vba from a hyperlink\">stackoverflow.com/questions/32660492/&hellip;</a>  or <a href=\"https://stackoverflow.com/questions/56370308/activex-command-button-that-unhides-next-to-a-cell-if-a-value-is-entered-and-hi/56371769#56371769\" title=\"activex command button that unhides next to a cell if a value is entered and hi\">stackoverflow.com/questions/56370308/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 11704358, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_YiY9k9w42Y/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcFL_-0wRvFMuLAI5j7NSuDeeUUnQ/photo.jpg?sz=128", "display_name": "Carolina Bhering", "link": "https://stackoverflow.com/users/11704358/carolina-bhering"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1561567503, "post_id": 56777349, "comment_id": 100110407, "body": "This is a great idea that I hadn&#39;t thought of. Thanks a lot! I&#39;ll try to make it work with the hyperlinks and see if that works. Thanks for the references too!  I was using Forms, by the way."}], "owner": {"reputation": 1, "user_id": 11704358, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_YiY9k9w42Y/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcFL_-0wRvFMuLAI5j7NSuDeeUUnQ/photo.jpg?sz=128", "display_name": "Carolina Bhering", "link": "https://stackoverflow.com/users/11704358/carolina-bhering"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561566819, "creation_date": 1561566591, "last_edit_date": 1561566819, "question_id": 56777349, "link": "https://stackoverflow.com/questions/56777349/can-i-associate-excel-buttons-to-a-line-so-that-they-can-be-included-in-sort-fil", "title": "Can I associate Excel buttons to a line so that they can be included in sort/filter?", "body": "<p>I'm trying to make a spreadsheet with VBA that allows the use of filters and sorting, with buttons associated to each line, as in the following picture:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Yu92g.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Yu92g.png\" alt=\"\"></a></p>\n\n<p>When I sort/filter the sheet, the buttons don't naturally follow the sorting/filtering because they're not associated to the cells - so if I sort \"Document Number Z to A\" I'll have Y -> X, but the buttons will remain X->Y.\nIs there anyway I can associate the buttons to the cell or any other way you guys can think of that would enable the buttons to be contemplated by the sorting/filtering?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba", "office365"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1561567129, "post_id": 56777344, "comment_id": 100110264, "body": "It will be read-only if some other process (such as another instance of excel, which may not be visible) has it open."}, {"owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1561567258, "post_id": 56777344, "comment_id": 100110314, "body": "I have ensured that Excel is completely closed, I open Excel, and I still am in the same situation. Would anything else have it open? How can I tell if another process has it open?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1561567281, "post_id": 56777344, "comment_id": 100110325, "body": "Any file in <code>%USERPROFILE%\\AppData\\Roaming\\Microsoft\\Excel\\XLSTART</code> (i believe Personal is saved in that) is opened as Excel starts, making it &quot;in-use&quot;.  Options could be <b>A)</b> saving a macro that, upon opening Excel workbooks to Load your .XLAM file (you mentioned it was opened alongside a workbook to be able to edit), or <b>B)</b> saving your code to XLSTART and utilizing it via QAB or the VBA Project.  I would recommend naming it something other than &quot;Personal&quot; as that has come connotations in itself."}, {"owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "edited": false, "score": 0, "creation_date": 1561567612, "post_id": 56777344, "comment_id": 100110449, "body": "I do have it saved in the XLSTART folder. I want the file to automatically open any time I open a workbook, and that is happening because it&#39;s in the XLSTART folder, right?. I also want to be able to edit the Personal.XLAM file. (I do have it named differently, but I thought it would help others find this question if I used that filename instead.)"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1561567769, "post_id": 56777344, "comment_id": 100110515, "body": "@Robby I&#39;d probably with with suggestion A, then.  Save your file in another location (non- AppData) and have your file opened Upon loading a new workbook, so it becomes editable.  Being in the folder used for initializing Excel, you won&#39;t be able to edit anything in there while Excel is open (though you can continually add new things to it)."}, {"owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "edited": false, "score": 0, "creation_date": 1561567989, "post_id": 56777344, "comment_id": 100110613, "body": "Is that something new to Office 365? As I said, I was able to have it in the XLSTART folder using an earlier version of Excel."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1561568351, "post_id": 56777344, "comment_id": 100110770, "body": "@Robby In searching, this microsoft forums post describes it: <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/all/unable-to-save-edits-to-xlam/fe7e663f-2d22-4b3a-9aae-adf4a939ca04\" rel=\"nofollow noreferrer\">answers.microsoft.com/en-us/msoffice/forum/all/&hellip;</a>  I won&#39;t speculate further, as this could be umpteen thigns without knowing more specifics about your system, which leads to this being inappropriate for StackOverflow and more appropriate for SuperUser."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1561569361, "post_id": 56777344, "comment_id": 100111210, "body": "@Robby You could check that this isn&#39;t also listed in your shared folders (via compmgmt.msc), though that seems less likely considering there&#39;re several posts about stating that people have the same issue with newer software (appears to be editing anything in the AppData file the related file is open is a no-no, from some very quick reading)."}, {"owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "edited": false, "score": 0, "creation_date": 1561573025, "post_id": 56777344, "comment_id": 100112831, "body": "I&#39;m at work, so all the computers are administered, so I don&#39;t know if this is normal or not. But the C drive is listed as a Shared folder there."}], "answers": [{"tags": [], "owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "is_accepted": true, "score": 1, "last_activity_date": 1561574489, "creation_date": 1561574489, "answer_id": 56779209, "question_id": 56777344, "link": "https://stackoverflow.com/questions/56777344/personal-xlam-is-being-opened-as-read-only/56779209#56779209", "title": "PERSONAL.XLAM is being opened as read-only", "body": "<p>I figured it out. I actually had code in <code>Workbook_Open</code> that looked at the <code>Application.UserName</code>. If it wasn't a match for what it checked against, it made the Personal file read-only. And as I mentioned before, I got a new computer and my name was set to something different. After I changed my username back to what I used to use, everything is back to the way it was.</p>\n\n<p>If it wasn't for that \"security check,\" I wouldn't have had any issues. In other words, you <strong>can</strong> have the XLAM file in the XLSTART folder and make changes to it while you have it open, which is what I wanted.</p>\n\n<p><em>This is obviously a self-imposed, yet accidental, issue. I'll mark it as answered, but if it would be better to close it, that's fine too.</em></p>\n"}], "owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 0, "accepted_answer_id": 56779209, "answer_count": 1, "score": 0, "last_activity_date": 1561574489, "creation_date": 1561566577, "last_edit_date": 1561573283, "question_id": 56777344, "link": "https://stackoverflow.com/questions/56777344/personal-xlam-is-being-opened-as-read-only", "title": "PERSONAL.XLAM is being opened as read-only", "body": "<p>I've been using a PERSONAL.XLAM file for years in Excel 2013(?) with no issue. I am now using Excel for Office 365 and am having a problem using the same file.</p>\n\n<p>I used to be able to open a workbook, PERSONAL.XLAM would open along with it, and I could go into Developer > Visual Basic, and change VBA code and save. Perfect.</p>\n\n<p>Now, with Office 365, I get an error saying I can't save because PERSONAL.XLAM is read-only. I checked the Windows file attributes, and the Read-only checkbox is not checked, so I'm not sure why it would be opening as read-only.</p>\n\n<p>In addition to now using Office 365, I'm also on an entirely new PC, so there might be something I'm missing, but I don't know what to do.</p>\n\n<p>Edit: I think I found a new wrinkle. I moved the Personal file from my XLSTART folder to my desktop. If I open the Personal file directly from there, I get an error that says, \"Sorry, Excel can't open two workbooks with the same name at the same time.\" Does that mean it is open somewhere else already?</p>\n"}, {"tags": ["html", "excel", "vba", "internet-explorer-8"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1561565279, "post_id": 56776714, "comment_id": 100109374, "body": "force some delay before (and after) the click. something like .. ` Application.Wait DateAdd(&quot;s&quot;, 10, Now) `"}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1561601472, "post_id": 56776714, "comment_id": 100120619, "body": "Try to wait after each click and make a tests in small portion. after you notice that your small portion start working properly than after append another block of code may help to move further step by step. Let us know by this way it is working or not. We will try to provide further suggestions if needed."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 11563365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6fa7d4d493cf720f17567c3b9eaa2?s=128&d=identicon&r=PG&f=1", "display_name": "Celine N", "link": "https://stackoverflow.com/users/11563365/celine-n"}, "edited": false, "score": 0, "creation_date": 1561565571, "post_id": 56777027, "comment_id": 100109526, "body": "i tried doing that but nothing changed. It is not solving the problem"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1561566028, "post_id": 56777027, "comment_id": 100109744, "body": "it won&#39;t. 99% pages use Ajax now."}, {"owner": {"reputation": 1681, "user_id": 8309643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKYcGO_qCIE/AAAAAAAAAAI/AAAAAAAAB8o/PJdqYRCGzdU/photo.jpg?sz=128", "display_name": "Robert Todar", "link": "https://stackoverflow.com/users/8309643/robert-todar"}, "reply_to_user": {"reputation": 115, "user_id": 11563365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6fa7d4d493cf720f17567c3b9eaa2?s=128&d=identicon&r=PG&f=1", "display_name": "Celine N", "link": "https://stackoverflow.com/users/11563365/celine-n"}, "edited": false, "score": 0, "creation_date": 1561566729, "post_id": 56777027, "comment_id": 100110085, "body": "@CelineN I added the sleep API above, you can play with a mixture of the two above. Let me know if this helps, or if there are still issues?"}, {"owner": {"reputation": 1681, "user_id": 8309643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKYcGO_qCIE/AAAAAAAAAAI/AAAAAAAAB8o/PJdqYRCGzdU/photo.jpg?sz=128", "display_name": "Robert Todar", "link": "https://stackoverflow.com/users/8309643/robert-todar"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1561566869, "post_id": 56777027, "comment_id": 100110160, "body": "@cyboashu could you explain more about why Ajax doesn&#39;t work with this method?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1561567021, "post_id": 56777027, "comment_id": 100110224, "body": "from wikipedia: Ajax (also AJAX /\u02c8e\u026ad\u0292&#230;ks/; short for asynchronous JavaScript and XML)[1][2] is a set of web development techniques using many web technologies on the client side to create asynchronous web applications. With Ajax, web applications can send and retrieve data from a server asynchronously (in the background) without interfering with the display and behavior of the existing page. By decoupling the data interchange layer from the presentation layer, Ajax allows web pages and, by extension, web applications, to change content dynamically without the need to reload the entire page."}, {"owner": {"reputation": 1681, "user_id": 8309643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKYcGO_qCIE/AAAAAAAAAAI/AAAAAAAAB8o/PJdqYRCGzdU/photo.jpg?sz=128", "display_name": "Robert Todar", "link": "https://stackoverflow.com/users/8309643/robert-todar"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1561567413, "post_id": 56777027, "comment_id": 100110377, "body": "@cyboashu Ajax still looks for the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/readyState\" rel=\"nofollow noreferrer\">readystate</a> though, doesn&#39;t it? Or is it because VBA <code>InternetExplorer</code> doesn&#39;t have <code>onReadyStateChange</code> event?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1561567532, "post_id": 56777027, "comment_id": 100110424, "body": "The ReadyStateChange never changes when async method(s) are used. That&#39;s why the event never fires."}], "tags": [], "owner": {"reputation": 1681, "user_id": 8309643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKYcGO_qCIE/AAAAAAAAAAI/AAAAAAAAB8o/PJdqYRCGzdU/photo.jpg?sz=128", "display_name": "Robert Todar", "link": "https://stackoverflow.com/users/8309643/robert-todar"}, "is_accepted": false, "score": 2, "last_activity_date": 1561566656, "last_edit_date": 1561566656, "creation_date": 1561565240, "answer_id": 56777027, "question_id": 56776714, "link": "https://stackoverflow.com/questions/56776714/how-to-make-sure-all-the-parts-of-a-macro-are-running-correctly/56777027#56777027", "title": "How to make sure all the parts of a macro are running correctly?", "body": "<p>If timing is an issue then you can wait for Internet Explorer to not be busy and the <code>readystate</code> is equal to 4.</p>\n\n<p>Try placing <code>While Ie.readyState &lt;&gt; 4 Or Ie.Busy: DoEvents: Wend</code> in sections where the page might be loading. (after navigation, button clicks, etc.).</p>\n\n<hr>\n\n<p>If all said that this isn't sufficient enough, you could always play with the sleep API.</p>\n\n<pre><code>#If VBA7 And Win64 Then\n    Private Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n#Else\n    Private Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n#End If\n</code></pre>\n\n<p>I would only do this if you can't get the wait above to work.</p>\n\n<hr>\n\n<p><strong>Readystate 4</strong> means that the request had been sent, the server had finished returning the response and the browser had finished downloading the response content.</p>\n\n<p><strong>Busy</strong> from <a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa752050(v%3Dvs.85)\" rel=\"nofollow noreferrer\">Microsofts Documentation</a> is described as:</p>\n\n<blockquote>\n  <p>Gets a value that indicates whether the object is engaged in a navigation or downloading operation.</p>\n</blockquote>\n"}], "owner": {"reputation": 115, "user_id": 11563365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6fa7d4d493cf720f17567c3b9eaa2?s=128&d=identicon&r=PG&f=1", "display_name": "Celine N", "link": "https://stackoverflow.com/users/11563365/celine-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561569570, "creation_date": 1561564201, "last_edit_date": 1561569570, "question_id": 56776714, "link": "https://stackoverflow.com/questions/56776714/how-to-make-sure-all-the-parts-of-a-macro-are-running-correctly", "title": "How to make sure all the parts of a macro are running correctly?", "body": "<p>I have this piece of code that basically should click on several buttons from a website successively.</p>\n\n<pre><code>For Each Element In Ie.getElementsByTagName(\"a\")\n    If Element.innerText = \"Advanced Search\" Then\n        'Debug.Print element.innerText\n        '**element.Click**\n        Exit For\n    Else\n    End If\nNext Element\n\nSet objShell2 = CreateObject(\"Shell.Application\")\nIE_count = objShell2.Windows.Count\n\nFor X = 0 To (IE_count - 1)\n    On Error Resume Next\n    my_url = objShell2.Windows(X).Document.Location\n    my_title = objShell2.Windows(X).Document.Title\n    MsgBox (\"The title of this page is: \" &amp; my_title)\n\n\n    If my_title Like \"Client List Management\" &amp; \"*\" Then\n        Set ie2 = objShell2.Windows(X).Document\n        my_title3 = ie2.Title\n        MsgBox (\"The title of Client List Management is: \" &amp; my_title3)\n        Exit For\n    Else\n    End If\n\nNext\n\nFor Each Element In ie2.getElementsByTagName(\"a\")\n    If Element.innerText = \"Accounts\" Then\n        'Debug.Print element.innerText\n        '**element.Click**\n        Exit For\n    Else\n    End If\nNext\n\nFor Each Element In ie2.getElementsByTagName(\"a\")\n  If Element.innerText = \"SEARCH\" Then\n        'Debug.Print element.innerText\n        '**element.Click**\n        Exit For\n    Else\n\n    End If\nNext\n\nFor Each Element In ie2.getElementsByTagName(\"a\")\n    If Element.innerText = \"BATCH EXPORT\" Then\n        'Debug.Print element.innerText\n        '**element.Click**\n        Exit For\n    Else\n    End If\nNext\n</code></pre>\n\n<p>The problem is that when I run the whole macro, only the first button is being clicked (button \"Advanced Search\") and nothing happens with the others that should be clicked after the \"Advanced Search\" button is clicked. </p>\n\n<p>However, when I try to debug my code and step into every step of the program, each and every button that should be clicked is being clicked. Everything works perfectly when I debut. The only problem resides when the program is actually running by its own. </p>\n\n<p>Do you know how to fix this problem? </p>\n\n<p>Thank you :) </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11574173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cf7276b0453cde1f6c1e1cb636b8b85?s=128&d=identicon&r=PG&f=1", "display_name": "Steffi", "link": "https://stackoverflow.com/users/11574173/steffi"}, "edited": false, "score": 0, "creation_date": 1561568895, "post_id": 56776727, "comment_id": 100110996, "body": "Oh I see your point. Could you tell me if I&#39;m able to find last row within Offset?"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "reply_to_user": {"reputation": 3, "user_id": 11574173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cf7276b0453cde1f6c1e1cb636b8b85?s=128&d=identicon&r=PG&f=1", "display_name": "Steffi", "link": "https://stackoverflow.com/users/11574173/steffi"}, "edited": false, "score": 0, "creation_date": 1561569233, "post_id": 56776727, "comment_id": 100111145, "body": ".Cells(.Rows.Count, &quot;A&quot;).End(xlUp).row + 1"}, {"owner": {"reputation": 3, "user_id": 11574173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cf7276b0453cde1f6c1e1cb636b8b85?s=128&d=identicon&r=PG&f=1", "display_name": "Steffi", "link": "https://stackoverflow.com/users/11574173/steffi"}, "edited": false, "score": 0, "creation_date": 1561578958, "post_id": 56776727, "comment_id": 100115210, "body": ".Cells(.Rows.Count, c1).End(xlUp).Offset(1, 0).Resize(rngDataColumn.Rows.Count, rngDataColumn.Columns.Count).Value = rngDataColumn.Value   - I do get an error when i try this. sorry but i&#39;m new to vba"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "reply_to_user": {"reputation": 3, "user_id": 11574173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cf7276b0453cde1f6c1e1cb636b8b85?s=128&d=identicon&r=PG&f=1", "display_name": "Steffi", "link": "https://stackoverflow.com/users/11574173/steffi"}, "edited": false, "score": 0, "creation_date": 1561638093, "post_id": 56776727, "comment_id": 100136015, "body": "@Steffi you want cl.Offset(.Cells(.Rows.Count, &quot;A&quot;).End(xlUp).row, 0).Resize(rngDataColumn.Rows.Count, rngDataColumn.Columns.Count).Value = rngDataColumn.Value that"}], "tags": [], "owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "is_accepted": true, "score": 0, "last_activity_date": 1561564244, "creation_date": 1561564244, "answer_id": 56776727, "question_id": 56776478, "link": "https://stackoverflow.com/questions/56776478/unable-to-append-data-to-existing-data/56776727#56776727", "title": "Unable to append data to existing data", "body": "<p>I think this line:</p>\n\n<pre><code>cl.Offset(1, 0).Resize(rngDataColumn.Rows.Count, rngDataColumn.Columns.Count).Value = rngDataColumn.Value\n</code></pre>\n\n<p>Needs to take the last used row, it is currently offset by 1 from the header row.</p>\n"}], "owner": {"reputation": 3, "user_id": 11574173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cf7276b0453cde1f6c1e1cb636b8b85?s=128&d=identicon&r=PG&f=1", "display_name": "Steffi", "link": "https://stackoverflow.com/users/11574173/steffi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 56776727, "answer_count": 1, "score": 0, "last_activity_date": 1561585495, "creation_date": 1561563486, "last_edit_date": 1561585495, "question_id": 56776478, "link": "https://stackoverflow.com/questions/56776478/unable-to-append-data-to-existing-data", "title": "Unable to append data to existing data", "body": "<p>I have a master data set with some data on it already. I'm trying to append additional data from another Excel sheet into this master data set by matching the column names and copy pasting corresponding data into my master file which I'm unable to do.</p>\n\n<p>My master data set has the data in a different order from that of my new data that I need appended. So my code looks for matching headers in target (master data set) and source (new data in Excel)  and tries to copy and paste corresponding values under matching columns. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>\nSub AppendData()\n\n' AppendData Macro\n\nApplication.ScreenUpdating = False\n\n' create worksheet objects\nDim shtSource As Worksheet\nDim shtTarget As Worksheet\nDim strFile As String\n\nSet shtTarget = ActiveWorkbook.Sheets(\"MASTER - Formatted\")\nstrFile = ActiveWorkbook.Worksheets(\"Macro\").Range(\"C2\").Value\nIf CStr(strFile) &lt;&gt; \"False\" Then\n\n        Set shtSource = Workbooks.Open(strFile).Sheets(1)\n\n        ' create range objects\n        Dim rngSourceHeaders As Range: Set rngSourceHeaders = shtSource.Range(\"B1:S1\")\n\n        shtTarget.Activate\n        With shtTarget\n            Dim rngTargetHeaders As Range: Set rngTargetHeaders = .Range(\"K1:AA1\") '.Cells(1, 1), .Cells(1, .Columns.Count).End(xlToLeft))\n            Dim rngPastePoint As Range: Set rngPastePoint = .Cells(.Rows.Count, 1).End(xlUp).Offset(1) 'Shoots up from the bottom of the sheet untill it bumps into something and steps one down\n        End With\n\nDim rngDataColumn As Range\n\n        ' process data\n        Dim cl As Range, i As Integer\n        For Each cl In rngTargetHeaders ' loop through each cell in target header row\n\n\n            ' identify source location\n            shtSource.Activate\n            i = 0 ' reset I\n            On Error Resume Next ' ignore errors, these are where the value can't be found and will be tested later\n                i = Application.Match(cl.Value, rngSourceHeaders, 0) 'Finds the matching column name\n            On Error GoTo 0 ' switch error handling back off\n\n            ' report if source location not found\n            If i = 0 Then\n                intErrCount = intErrCount + 1\n                Debug.Print \"unable to locate item [\" &amp; cl.Value &amp; \"] at \" &amp; cl.Address ' this reports to Immediate Window (Ctrl + G to view)\n                GoTo nextCL\n            End If\n\n        ' create source data range object\n            With rngSourceHeaders.Cells(1, i)\n                Set rngDataColumn = Range(.Cells(2, 1), .Cells(1000000, 1).End(xlUp))\n            End With\n\n            ' pass to target range object\n            shtTarget.Activate\n            cl.Offset(1, 0).Resize(rngDataColumn.Rows.Count, rngDataColumn.Columns.Count).Value = rngDataColumn.Value\n\nnextCL:\n        Next cl\n\n        Application.CutCopyMode = False\n\n        shtSource.Activate\n        ActiveWorkbook.Close False\n\n\n        Else\n\n        Application.ScreenUpdating = True\n\n        MsgBox \"No valid file selected\", vbOKOnly + vbInformation, \"Copy Error\"\n\n\nEnd If\n\nEnd Sub\n\n\n</code></pre>\n\n<p>Currently my code works perfectly fine if my master sheet only has the header and no existing data on it. If I run this code it will paste all the new data under matching columns from row 2 (row 1 is header).</p>\n\n<p>But it does not append to the last existing row which is my desired output. </p>\n\n<p>I have 20000 rows approx currently in master data set and I need to append new data from row 20001 for instance. </p>\n\n<p>Would appreciate some help with this code.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba", "pdf", "page-break"], "comments": [{"owner": {"reputation": 341, "user_id": 8826022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb38589eec35643089af93724c1d9b3?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Murphy", "link": "https://stackoverflow.com/users/8826022/michael-murphy"}, "edited": false, "score": 1, "creation_date": 1561564914, "post_id": 56776476, "comment_id": 100109174, "body": "Have you tried manually setting the page break like <code>Screen.HPageBreaks.Add</code>?"}, {"owner": {"reputation": 300, "user_id": 4832718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b5544ae8dbdac9ad4cda754d5c5359?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/4832718/dan"}, "reply_to_user": {"reputation": 341, "user_id": 8826022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb38589eec35643089af93724c1d9b3?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Murphy", "link": "https://stackoverflow.com/users/8826022/michael-murphy"}, "edited": false, "score": 0, "creation_date": 1561565453, "post_id": 56776476, "comment_id": 100109463, "body": "Yes, using the code Rows(52).PageBreak = xlPageBreakManual. I tried .HPageBreaks.Add Range(&quot;A52&quot;) and there doesn&#39;t seem to be any difference. Both generate a page break at row 52 but there is still a dotted line at row 50. I can generate the page breaks fine it just appears that excel throws in default dotted lines that screw things up..."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1561565784, "post_id": 56776476, "comment_id": 100109631, "body": "<code>Block.DisplayPageBreaks = False</code>"}, {"owner": {"reputation": 185, "user_id": 11116312, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xpSGIRqI4b4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNPsVUDBiaRp_oj3KvxIxzBXkndA/mo/photo.jpg?sz=128", "display_name": "David Podolak", "link": "https://stackoverflow.com/users/11116312/david-podolak"}, "edited": false, "score": 2, "creation_date": 1561565815, "post_id": 56776476, "comment_id": 100109641, "body": "Have you tried adding a print area?"}, {"owner": {"reputation": 300, "user_id": 4832718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b5544ae8dbdac9ad4cda754d5c5359?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/4832718/dan"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1561566210, "post_id": 56776476, "comment_id": 100109828, "body": "@GMalc I added the line of code but no change. I modified the original post to include some further information."}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 1, "creation_date": 1561566653, "post_id": 56776476, "comment_id": 100110050, "body": "If your data is too large for the first (automatic) page and you want the data to be smaller to fit to a page, then page breaks after the first automatic page never help. Tell Excel within the page setup, that it has to print on 1 page height or with a smaller zoom size than 100%."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1561567060, "post_id": 56776476, "comment_id": 100110232, "body": "Did you add the code before you took the screen shot?"}, {"owner": {"reputation": 300, "user_id": 4832718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b5544ae8dbdac9ad4cda754d5c5359?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/4832718/dan"}, "reply_to_user": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1561567231, "post_id": 56776476, "comment_id": 100110304, "body": "@Asger Got it. This is what I was trying to get at (i.e. changing the automatic page size). Would you be able to walk me through how this might work in a loop situation? So my code iterates through a loop and each time the takes a screenshot of the results and pastes it into a screenshot tab. In the end the screenshot tab has (for example) 10 different screenshots spaced out in a vertical row and each one should be an individual page when I go to export to pdf..."}, {"owner": {"reputation": 300, "user_id": 4832718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b5544ae8dbdac9ad4cda754d5c5359?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/4832718/dan"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1561567371, "post_id": 56776476, "comment_id": 100110356, "body": "@GMalc Yes I added it before the screen shot."}], "answers": [{"tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": true, "score": 0, "last_activity_date": 1561634410, "last_edit_date": 1592644375, "creation_date": 1561634410, "answer_id": 56789910, "question_id": 56776476, "link": "https://stackoverflow.com/questions/56776476/using-vba-to-print-data-from-excel-to-pdf/56789910#56789910", "title": "Using VBA to Print Data From Excel to PDF", "body": "<p>By following code you can paste some example ranges as screenshots to the destination worksheet, each with a manual page break between them.</p>\n<p>I left 1 row blank before and after each screenshot (reason: when a border of a shape is directly placed at a page break, the border might be printed on the adjacent page too).</p>\n<p>Please adapt the zoom level in the last code line, to get even the largest screenshot printed on 1 page (e. g. 54 %). If you want to get it calculated automatically, see the second code part of this answer.</p>\n<pre><code>Private Sub CollectScreenshots()\n    Dim wsSource As Worksheet, wsDestination As Worksheet\n    Dim rngExampleRanges As Range\n    Dim rngCopy As Range\n    Dim rowPaste As Long\n    Dim shpScreenshot As Shape\n\n    Dim dlg As Dialog\n        \n    Application.DisplayStatusBar = True\n\n    Set wsSource = Sheets(&quot;BlockChart&quot;)\n    Set rngExampleRanges = wsSource.Range(&quot;A1:N51, A52:B53, C60:E99&quot;)\n    \n    Set wsDestination = Sheets(&quot;Screenshots&quot;)\n    \n    ' Copy all ranges as screenshot into destination worksheet:\n    rowPaste = 1\n    With wsDestination\n        .ResetAllPageBreaks\n        For Each rngCopy In rngExampleRanges.Areas\n            rngCopy.CopyPicture Appearance:=xlScreen, Format:=xlPicture\n            DoEvents\n            \n            If rowPaste &gt; 1 Then .HPageBreaks.Add Before:=.Rows(rowPaste)\n            .Paste Destination:=.Cells(rowPaste + 1, 1), Link:=False\n            DoEvents\n            \n            Set shpScreenshot = .Shapes(.Shapes.Count)\n            rowPaste = shpScreenshot.BottomRightCell.Row + 1\n        Next rngCopy\n    End With\n    Application.CutCopyMode = False\n    \n    ' set appropriate zoom level\n    wsDestination.PageSetup.Zoom = 54\n    \nEnd Sub\n</code></pre>\n<hr />\n<h1>Automatic Zoom Level</h1>\n<p>If you want Excel to calculate the optimum zoom level, it is a bit more complicated.</p>\n<p>If you have a cell range, e. g. A1:N51, which has to be printed on 1 page, then you can set the page dialog parameters manually like this:</p>\n<ul>\n<li>define the print area as A1:N51</li>\n<li>set scaling to 1 page width and 1 page height</li>\n<li>Then you can visually see the calculated zoom level within the page setup dialog.</li>\n</ul>\n<p>Unfortunately you can not read this zoom level directly via VBA, as <code>Worksheet.PageSetup.Zoom</code> in this case returns <code>False</code> only. If you urge Excel to use the zoom level, e. g. by setting <code>FitToPagesWide</code> to <code>False</code>, Excel calculates a new zoom level.</p>\n<p>To read the calculated zoom level, you have to send a keyboard shortcut to the page setup dialog. To get the correct keyboard shortcut for that, please check within your page setup dialog, which shortcut is used for zoom level. In my German Excel version, it's <kbd>Alt</kbd> + <kbd>V</kbd>.</p>\n<p>Then exchange the last line from above code by following:</p>\n<pre><code>    ' get cell dimensions of the largest screenshot:\n    Dim maxVerticalCells, maxHorizontalCells\n    For Each shpScreenshot In wsDestination.Shapes\n        maxVerticalCells = Application.WorksheetFunction.Max( _\n            maxVerticalCells, _\n            shpScreenshot.BottomRightCell.Row - shpScreenshot.TopLeftCell.Row + 1)\n        maxHorizontalCells = Application.WorksheetFunction.Max( _\n            maxHorizontalCells, _\n            shpScreenshot.BottomRightCell.Column - shpScreenshot.TopLeftCell.Column + 1)\n    Next shpScreenshot\n    \n    ' set appropriate zoom level\n    With wsDestination\n        \n        ' Simulate a print area with required dimensions to get it printed to 1 page\n        .PageSetup.Zoom = False\n        .PageSetup.FitToPagesWide = 1\n        .PageSetup.FitToPagesTall = 1\n        .PageSetup.PrintArea = _\n            .Range(.Cells(1, 1), .Cells(maxVerticalCells, maxHorizontalCells)).Address\n    \n        ' change the page setup to automatic and keep previous zoom level\n        ' by sending keys to page setup dialog\n        .Activate\n        \n        Dim strKeys As String\n        strKeys = &quot;P&quot;               ' key &quot;P&quot; for first tab in that dialog\n        strKeys = strKeys &amp; &quot;%V&quot;    ' key &lt;Alt&gt;+&lt;V&gt; for automatic zoom (German, might be %A in other countries)\n        strKeys = strKeys &amp; &quot;~&quot;     ' key &lt;Enter&gt;\n        SendKeys strKeys            ' send keys to following dialog\n        Application.Dialogs(xlDialogPageSetup).Show\n        Dim myZoomlevel As Double\n        myZoomlevel = .PageSetup.Zoom\n    \n        ' Reset print area, reset automatic page adaption, use previous zoom level\n        .PageSetup.PrintArea = &quot;&quot;\n        .PageSetup.FitToPagesWide = False\n        .PageSetup.FitToPagesTall = False\n        .PageSetup.Zoom = myZoomlevel\n    End With\n</code></pre>\n"}], "owner": {"reputation": 300, "user_id": 4832718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b5544ae8dbdac9ad4cda754d5c5359?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/4832718/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 56789910, "answer_count": 1, "score": 1, "last_activity_date": 1561634410, "creation_date": 1561563474, "last_edit_date": 1561566421, "question_id": 56776476, "link": "https://stackoverflow.com/questions/56776476/using-vba-to-print-data-from-excel-to-pdf", "title": "Using VBA to Print Data From Excel to PDF", "body": "<p>Seemingly very simple question but I have an excel spreadsheet that uses vba code to take a screenshot of something, pastes it into a 'Screenshot' tab and then exports that tab to a pdf. My issue is that the page break that I pass does not line up with the dotted page break line that seems to be produced by default(?)...  </p>\n\n<p>Section of Code:</p>\n\n<pre><code>Set Screen = Sheets(\"Screenshots\")\nSet Block = Sheets(\"BlockChart\")\nSet CopyRangeBlock = Block.Range(\"A1:N51\")\nSet PasteRange = Screen.Cells(1, 1)\nApplication.DisplayStatusBar = True\nCopyRangeBlock.CopyPicture xlScreen, xlPicture\nDoEvents\nScreen.Paste Destination:=PasteRange\nDoEvents\nSheets(\"Screenshots\").Rows(52).PageBreak = xlPageBreakManual\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>The range of the data to screenshot is from \"A1:N:51\" and therefore I place a page break at row 52. However, a dotted page break line appears (seemingly by default) at row 50. This screws up my export to pdf and produces blank pages. This is particularly an issue when I loop through the code to generate multiple pages in a pdf. How can I make it so that the dotted line either doesn't appear or matches with the page break that I set so that I'm not getting extra blank pages?</p>\n\n<p>Example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/tVF3G.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tVF3G.png\" alt=\"enter image description here\"></a></p>\n\n<p>Just to reiterate the point, the whole worksheet has pre-determined dotted lines for the print area. I essentially want to modify these (via manual breaks or something) so that each page printed to a pdf is a custom size that fits the data I screenshot.</p>\n\n<p><a href=\"https://i.stack.imgur.com/lv0NT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lv0NT.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "copy-paste"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 4, "creation_date": 1561563556, "post_id": 56776446, "comment_id": 100108417, "body": "Probably not your problem but in general, you want to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid activate and select</a> in your code."}, {"owner": {"reputation": 11, "user_id": 11704085, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xyHpt9RTO0M/AAAAAAAAAAI/AAAAAAAADkk/l9iByfyrsRU/photo.jpg?sz=128", "display_name": "R. Voogt", "link": "https://stackoverflow.com/users/11704085/r-voogt"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1561564414, "post_id": 56776446, "comment_id": 100108910, "body": "Yes, adding that or removing that does not solve the problem. I&#39;ll remove it."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1561567736, "post_id": 56776446, "comment_id": 100110501, "body": "Try adding <code>DoEvents</code> after the Copy line"}, {"owner": {"reputation": 11, "user_id": 11704085, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xyHpt9RTO0M/AAAAAAAAAAI/AAAAAAAADkk/l9iByfyrsRU/photo.jpg?sz=128", "display_name": "R. Voogt", "link": "https://stackoverflow.com/users/11704085/r-voogt"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1561612826, "post_id": 56776446, "comment_id": 100122900, "body": "@TimWilliams That does seem to make the code work (a lot) better. It copies all the images (but in the back of my mind a voice says that it is just luck that it works now :) ), but sometimes a pasted image has a little cross and the text &quot;image cannot be displayed&quot; in it."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1561614020, "post_id": 56776446, "comment_id": 100123262, "body": "Yes I&#39;ve found that <code>DoEvents</code> helps but it doesn&#39;t fix 100% of issues.  I&#39;ve not seen the &quot;image cannot be displayed&quot; problem though."}, {"owner": {"reputation": 11, "user_id": 11704085, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xyHpt9RTO0M/AAAAAAAAAAI/AAAAAAAADkk/l9iByfyrsRU/photo.jpg?sz=128", "display_name": "R. Voogt", "link": "https://stackoverflow.com/users/11704085/r-voogt"}, "edited": false, "score": 0, "creation_date": 1561616313, "post_id": 56776446, "comment_id": 100124069, "body": "As expected, after 5 good runs, it fails again. Also, rarely I also get this warning: The key you specified was not found in the collection."}], "owner": {"reputation": 11, "user_id": 11704085, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xyHpt9RTO0M/AAAAAAAAAAI/AAAAAAAADkk/l9iByfyrsRU/photo.jpg?sz=128", "display_name": "R. Voogt", "link": "https://stackoverflow.com/users/11704085/r-voogt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1561566723, "creation_date": 1561563325, "last_edit_date": 1561566723, "question_id": 56776446, "link": "https://stackoverflow.com/questions/56776446/runtime-error-1004-at-random-when-copying-images", "title": "Runtime Error 1004 at random when copying images", "body": "<p>I have code that copies images from 1 workbook to another. Excel decides to stop the code once in a while with:</p>\n\n<blockquote>\n  <p>Error 1004 \"PasteSpecial method of Range class failed\"</p>\n</blockquote>\n\n<p>Sometimes it successfully copies all images, but most of the time a few are left out (when on error resume next is set). If I choose \"Debug\" on the error and then press F8, the image is copied. (but <code>on error resume next</code> does not have the same effect)</p>\n\n<p>Other ways of copying images, like <code>.CopyPicture</code> End result is the same.</p>\n\n<pre><code>    'Code below is in a loop\n\n    vArr3 = Split(Cells(1, i).Address(True, False), \"$\")\n    t = vArr3(0)\n\n    Application.Goto Workbooks(BOM).Worksheets(\"Blad1\").Range(\"a2\")\n    Workbooks(BOM).Worksheets(\"Blad1\").Shapes.Range(Array(\"Afbeelding \" &amp; im)).Select\n\n    Selection.Copy\n\n    Workbooks(Template).Worksheets(\"Sheet1\").Activate\n\n    Application.Goto Workbooks(Template).Worksheets(\"Sheet1\").Range(t &amp; rs)\n    Workbooks(Template).Worksheets(\"Sheet1\").Range(t &amp; rs).Select\n\n    Workbooks(Template).Worksheets(\"Sheet1\").Range(t &amp; rs).PasteSpecial 'Error here\n\n    rs = rs + 5\n    im = im + 2\n</code></pre>\n\n<p>I expect Excel to always work 100% correctly. The images (and number of) that are left out is random.</p>\n"}, {"tags": ["vba", "ms-access", "ms-access-forms"], "comments": [{"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 2, "creation_date": 1561567237, "post_id": 56776244, "comment_id": 100110308, "body": "As far as I can tell, the Access CheckBox object does not have the <code>CursorOnHover</code>, <code>DisplayAsHyperlink</code>, or <code>IsHyperlink</code> properties. Thus the error. You might be able to force a fix for this, but may I humbly suggest that it isn&#39;t worth your time? Instead, use a Hyperlink object to manage your links."}, {"owner": {"reputation": 1451, "user_id": 4406670, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bc474af2baef160870a2478d40adcbbf?s=128&d=identicon&r=PG", "display_name": "Daniel L. VanDenBosch", "link": "https://stackoverflow.com/users/4406670/daniel-l-vandenbosch"}, "reply_to_user": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 1, "creation_date": 1561575977, "post_id": 56776244, "comment_id": 100114157, "body": "I want the hyperlink had to indicate to the use &quot;hey this object does something&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1561575937, "post_id": 56778047, "comment_id": 100114134, "body": "I tested this, and it doesn&#39;t work for me. The CommandButton &#39;Hyperlink Hand&#39; cursor only shows when over parts of the command button that are <i>not</i> covered by the CheckBox. The cursor reverts back to normal when it is over the CheckBox. YMMV."}, {"owner": {"reputation": 86, "user_id": 7008757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3916e74c7724d1a7abd05da3285d5c0f?s=128&d=identicon&r=PG&f=1", "display_name": "JennyW", "link": "https://stackoverflow.com/users/7008757/jennyw"}, "edited": false, "score": 1, "creation_date": 1561616744, "post_id": 56778047, "comment_id": 100124239, "body": "Put the invisible CommandButton over the CheckBox. Write vba for the OnClick of the CommandButton that checks the current state of the CheckBox and then changes it. Then you can have your cursor and the CheckBox as you want."}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "reply_to_user": {"reputation": 86, "user_id": 7008757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3916e74c7724d1a7abd05da3285d5c0f?s=128&d=identicon&r=PG&f=1", "display_name": "JennyW", "link": "https://stackoverflow.com/users/7008757/jennyw"}, "edited": false, "score": 0, "creation_date": 1561654865, "post_id": 56778047, "comment_id": 100145940, "body": "@JennyW: That&#39;s a whole lot of extra work for no tangible gain. For example, I have 904 CheckBox controls in one project I work with. Do I really want to add 904 CommandButtons and 904 event handlers, just to put up a non-standard cursor? No! This marginal idea doesn&#39;t justify this amount of complexity!"}, {"owner": {"reputation": 86, "user_id": 7008757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3916e74c7724d1a7abd05da3285d5c0f?s=128&d=identicon&r=PG&f=1", "display_name": "JennyW", "link": "https://stackoverflow.com/users/7008757/jennyw"}, "edited": false, "score": 1, "creation_date": 1561655092, "post_id": 56778047, "comment_id": 100146033, "body": "Fair enough- it\u2019s not an option in that situation, i agree. It is an option for anyone who only needs it one or two places, and the op seems to be."}, {"owner": {"reputation": 24, "user_id": 11465415, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vQuVBgqNlZM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reGkfcYCxRP9Xt92tJIychdCCxFag/mo/photo.jpg?sz=128", "display_name": "Phenide", "link": "https://stackoverflow.com/users/11465415/phenide"}, "reply_to_user": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1562010115, "post_id": 56778047, "comment_id": 100235081, "body": "@kismert: In a situation like that, I think you could also write a VBA sub to search all forms / reports / objects in the current project folder for all objects on them to begin with and then have it place a transparent CommandButton over each of them with the same length and width, top and left dims as the CheckBox. You could then add in the suggestion from JennyW regarding the OnClick event when the CommandButtons are generated."}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1562016754, "post_id": 56778047, "comment_id": 100237247, "body": "@Phenide: Can you do that? Yes. Should  you do it? I see no valid argument. I am fully able to write the complex code to automate adding complexity to every form that has a CheckBox. What is the result? 99% of users would never notice it. This is effort that would be much better spent (for example) by adding comprehensive error handling, or formal transactions for all data operations."}, {"owner": {"reputation": 24, "user_id": 11465415, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vQuVBgqNlZM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reGkfcYCxRP9Xt92tJIychdCCxFag/mo/photo.jpg?sz=128", "display_name": "Phenide", "link": "https://stackoverflow.com/users/11465415/phenide"}, "reply_to_user": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 1, "creation_date": 1562091506, "post_id": 56778047, "comment_id": 100266168, "body": "@kismert I understand that. I was just providing a solution to the expanded problem you had described as framed in the context of the initial question (regardless of whether a user would notice or not). By all means I can understand effort being better used elsewhere, but in context of the initial question, the ability to expand some solution to a wider scope seems reasonable to propose. By all means I do appreciate the perspective you provide though, as it is understandable and I am new to the world of development in any context. Thank you for your comments and have a great day!"}], "tags": [], "owner": {"reputation": 24, "user_id": 11465415, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vQuVBgqNlZM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reGkfcYCxRP9Xt92tJIychdCCxFag/mo/photo.jpg?sz=128", "display_name": "Phenide", "link": "https://stackoverflow.com/users/11465415/phenide"}, "is_accepted": true, "score": 0, "last_activity_date": 1561569416, "creation_date": 1561569416, "answer_id": 56778047, "question_id": 56776244, "link": "https://stackoverflow.com/questions/56776244/display-hyperlink-hand-cursor-for-check-box-on-ms-access-form/56778047#56778047", "title": "Display Hyperlink Hand Cursor for Check Box on MS Access Form", "body": "<p>CursorOnHover is a property for CommandButton objects. A simple work-around would be to place a transparent button behind your check boxes and set the CursorOnHover property to acHyperlink hand from the Property Sheet.</p>\n"}], "owner": {"reputation": 1451, "user_id": 4406670, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bc474af2baef160870a2478d40adcbbf?s=128&d=identicon&r=PG", "display_name": "Daniel L. VanDenBosch", "link": "https://stackoverflow.com/users/4406670/daniel-l-vandenbosch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 56778047, "answer_count": 1, "score": 0, "last_activity_date": 1594714874, "creation_date": 1561562662, "last_edit_date": 1594714874, "question_id": 56776244, "link": "https://stackoverflow.com/questions/56776244/display-hyperlink-hand-cursor-for-check-box-on-ms-access-form", "title": "Display Hyperlink Hand Cursor for Check Box on MS Access Form", "body": "<p>How do I make check boxes in an ms access report have a hyperlink hand on hover? </p>\n\n<pre><code>If cc.ControlType = acCheckBox Then\n    'cc.DisplayAsHyperlink = acDisplayAsHyperlinkAlways\n    ' cc.IsHyperlink = True\n    'cc.CursorOnHover = acCursorOnHoverHyperlinkHand\nEnd If\n</code></pre>\n\n<p>But I get this error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/fEXQL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fEXQL.png\" alt=\"Object doesn&#39;t support this property or method\"></a></p>\n"}, {"tags": ["excel", "vba", "select", "resize", "range"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1561562925, "post_id": 56776103, "comment_id": 100108061, "body": "Normally you don&#39;t need to <code>Select</code> - see <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>. I think you&#39;re looking for <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.entirerow\" rel=\"nofollow noreferrer\"><code>Range.EntireRow</code></a>."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1561563159, "post_id": 56776103, "comment_id": 100108190, "body": "Also FYI, if you just need the values (and not formula, format, etc) you can set ranges equal -- <code>Range([dest range]).Value = Range([origin range]).Value</code>, so <code>Range(&quot;H1&quot;).Value= Range(&quot;A1&quot;).Value</code>."}], "owner": {"reputation": 23, "user_id": 10682956, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-eYH19KoFzJQ/AAAAAAAAAAI/AAAAAAAAGVc/0-bDyiMYXo4/photo.jpg?sz=128", "display_name": "Manuel Ramirez", "link": "https://stackoverflow.com/users/10682956/manuel-ramirez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561562196, "creation_date": 1561562196, "question_id": 56776103, "link": "https://stackoverflow.com/questions/56776103/vba-select-rows-based-on-dynamic-selection", "title": "VBA select rows based on dynamic selection", "body": "<p>I need to mimic key shortcuts to select a range that will vary every time. I managed to select a range and need to extend the selection to the entire rows of the selected range. A solution would be to just apply 'shift+spacebar'</p>\n\n<p>Tried resize but I need to select the whole rows.</p>\n\n<pre><code>Sub Clean()\n'fill an empty header to apply filter later\nRange(\"A1\").Copy\nRange(\"H1\").PasteSpecial Paste:=xlPasteValues\n\n'stand on row 3 to then move to 2 with offset, work around\nRange(\"E3\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Offset(-1, 0).Select\n</code></pre>\n\n<p>At this point I got a selection E2:E#, # being the last empty cell before my data starts. I need to extend the selection to the whole rows, which manually would do by pressing Shift+SpaceBar, then delete the entire rows. I couldn't find a way to keysend shift+SpaceBar</p>\n"}, {"tags": ["vba", "vb.net", "visio"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 3, "creation_date": 1561562042, "post_id": 56775913, "comment_id": 100107563, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/api/visio.document.executeline\" rel=\"nofollow noreferrer\">ExecuteLine</a>"}], "answers": [{"tags": [], "owner": {"reputation": 103, "user_id": 3721744, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6e5e0f2b7349b728c323ea0492c9a38d?s=128&d=identicon&r=PG&f=1", "display_name": "Cit", "link": "https://stackoverflow.com/users/3721744/cit"}, "is_accepted": true, "score": 0, "last_activity_date": 1562134076, "creation_date": 1562134076, "answer_id": 56863891, "question_id": 56775913, "link": "https://stackoverflow.com/questions/56775913/how-to-run-visio-macro-on-vb-net-application/56863891#56863891", "title": "How to run visio-macro on vb.net-application?", "body": "<p>Thank you Vinvent G! The solution is: Document.ExecuteLine(\"MyMakroName\")</p>\n"}], "owner": {"reputation": 103, "user_id": 3721744, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6e5e0f2b7349b728c323ea0492c9a38d?s=128&d=identicon&r=PG&f=1", "display_name": "Cit", "link": "https://stackoverflow.com/users/3721744/cit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 56863891, "answer_count": 1, "score": 0, "last_activity_date": 1562134076, "creation_date": 1561561563, "last_edit_date": 1561561633, "question_id": 56775913, "link": "https://stackoverflow.com/questions/56775913/how-to-run-visio-macro-on-vb-net-application", "title": "How to run visio-macro on vb.net-application?", "body": "<p>I have a visio document which contains macros. I have my own vb.net application which manipulates the visio document by the COM-Interface (Microsoft.Office.Interop.Visio). I want to run a macro of the visio document triggered by the vb.net application. </p>\n\n<p>I know that this is working with excel documents. (Excel.Application.Run() )</p>\n\n<p>I don't find anything similar in Visio-API.\nHow can I do?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 1, "creation_date": 1561561436, "post_id": 56775677, "comment_id": 100107195, "body": "@ArcherBird The line break within a cell (that was created with Alt+Enter) actually is <code>vbLf</code> which is <code>Chr(10)</code> but <code>vbNewLine</code> is <code>Chr(13)</code> wich is the same as same as <code>vbCr</code> (While a line break in Windows means <code>vbCrLf</code>). \u2022 TextToColumns will not work because as its name sais it splits a cell into <i>columns</i> not rows as the OP wishes."}, {"owner": {"reputation": 1, "user_id": 11703795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d7f2d0ac766492bd5bf1a0d042f25e3?s=128&d=identicon&r=PG&f=1", "display_name": "cmajor2709", "link": "https://stackoverflow.com/users/11703795/cmajor2709"}, "reply_to_user": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 0, "creation_date": 1561561585, "post_id": 56775677, "comment_id": 100107289, "body": "@ArcherBird I tried using that, but it overwrites the data to the right. Plus, I need to get the data into another row, not another column."}, {"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1561563303, "post_id": 56775677, "comment_id": 100108268, "body": "@P\u1d07\u029c I misunderstood the OP&#39;s question. But thanks for the clarification on <code>vbnewline</code>. I learned something!"}], "answers": [{"tags": [], "owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "is_accepted": false, "score": 0, "last_activity_date": 1561563283, "creation_date": 1561563283, "answer_id": 56776436, "question_id": 56775677, "link": "https://stackoverflow.com/questions/56775677/split-cells-by-line-break-while-keeping-other-data/56776436#56776436", "title": "Split cells by line break while keeping other data", "body": "<p>I just did a brief test, might not be perfect. If you have a ton of rows and columns this might be a tad slow aswell.</p>\n\n<pre><code>    Dim rowiter As Long\n    Dim coliter As Long\n    Dim lastrow As Long\n    Dim lastcol As Long\n    Dim rowcount As Long\n    Dim rowadd As Boolean\n    With ActiveSheet\n        lastrow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        lastcol = .Cells.Find(What:=\"*\", after:=ActiveSheet.Cells(1, 1), LookIn:=xlFormulas, LookAt:= _\n                xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlPrevious, MatchCase:=False).Column\n        rowcount = lastrow + 1\n\n        For rowiter = 1 To lastrow\n            rowadd = False\n            For coliter = 1 To lastcol\n                If InStr(1, .Cells(rowiter, coliter), vbLf) Then\n                    .Cells(rowcount, coliter).Value = Split(.Cells(rowiter, coliter), vbLf)(1)\n                    .Cells(rowiter, coliter).Value = Split(.Cells(rowiter, coliter), vbLf)(0)\n                    rowadd = True\n                End If\n            Next\n            If rowadd = True Then\n                For coliter = 1 To lastcol\n                    If .Cells(rowcount, coliter).Value = \"\" Or IsNull(.Cells(rowcount, coliter).Value) Then\n                        .Cells(rowcount, coliter).Value = .Cells(rowiter, coliter).Value\n                    End If\n                Next\n                rowcount = rowcount + 1\n            End If\n            rowadd = False\n        Next\n        .Range(Cells(1, 1), Cells(rowcount, lastcol)).Sort Key1:=Columns(\"A\"), Order1:=xlDescending\n    End With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1561616461, "creation_date": 1561616461, "answer_id": 56785055, "question_id": 56775677, "link": "https://stackoverflow.com/questions/56775677/split-cells-by-line-break-while-keeping-other-data/56785055#56785055", "title": "Split cells by line break while keeping other data", "body": "<p>Actually you were almost there:</p>\n\n<ul>\n<li>You need to split by <code>vbLf</code> instead of <code>\",\"</code></li>\n<li>You need to split column E and F into seperate arrays</li>\n</ul>\n\n<p>So you end up with:</p>\n\n<pre><code>Option Explicit\n\nSub splitByCol()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    Dim CurrentCell As Range\n    Set CurrentCell = ws.Range(\"E\" &amp; ws.Rows.Count).End(xlUp)\n\n    Dim ArrE As Variant   'split array for column E\n    Dim ArrF As Variant   'split array for column F\n\n    Do While CurrentCell.Row &gt; 1\n        ArrE = Split(CurrentCell.Value, vbLf)\n        ArrF = Split(CurrentCell.Offset(ColumnOffset:=1).Value, vbLf)\n\n        If UBound(ArrE) &gt;= 0 Then CurrentCell.Value = ArrE(0)\n        If UBound(ArrF) &gt;= 0 Then CurrentCell.Offset(ColumnOffset:=1).Value = ArrF(0)\n\n        Dim i As Long\n        For i = UBound(ArrE) To 1 Step -1\n            CurrentCell.EntireRow.Copy\n            CurrentCell.Offset(1).EntireRow.Insert\n\n            CurrentCell.Offset(1).Value = ArrE(i)\n            If UBound(ArrF) &gt;= i Then\n                CurrentCell.Offset(1, 1).Value = ArrF(i)\n            Else\n                CurrentCell.Offset(1, 1).Value = vbNullString\n            End If\n        Next i\n        Set CurrentCell = CurrentCell.Offset(-1)\n    Loop\nEnd Sub\n</code></pre>\n\n<p><strong>Input</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/8IfVK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8IfVK.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Output</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/Crqz4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Crqz4.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 11703795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d7f2d0ac766492bd5bf1a0d042f25e3?s=128&d=identicon&r=PG&f=1", "display_name": "cmajor2709", "link": "https://stackoverflow.com/users/11703795/cmajor2709"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1561616461, "creation_date": 1561560902, "last_edit_date": 1561561025, "question_id": 56775677, "link": "https://stackoverflow.com/questions/56775677/split-cells-by-line-break-while-keeping-other-data", "title": "Split cells by line break while keeping other data", "body": "<p>I have multiple rows in a spreadsheet set up like the following:</p>\n\n<pre><code>TEST    1   Y   N    TEST_1            1234      Derived\n                     TEST_2            56\n</code></pre>\n\n<p>I need to split the cells that have a line break while copying the remaining cells into the new row:</p>\n\n<pre><code>TEST    1   Y   N    TEST_1            1234      Derived\nTEST    1   Y   N    TEST_2            56        Derived\n</code></pre>\n\n<p>I tested code by changing line breaks to commas (I don't know the VBA symbol for linebreak). The code I tried only works for one column E, not Column F:</p>\n\n<pre><code>Sub splitByCol()\n  Dim r As Range, i As Long, ar\n  Set r = Worksheets(\"Sheet1\").Range(\"E999999:F999999\").End(xlUp)\n  Do While r.row &gt; 1\n    ar = Split(r.value, \",\")\n    If UBound(ar) &gt;= 0 Then r.value = ar(0)\n    For i = UBound(ar) To 1 Step -1\n      r.EntireRow.Copy\n      r.Offset(1).EntireRow.Insert\n      r.Offset(1).value = ar(i)\n    Next\n    Set r = r.Offset(-1)\n  Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql-server", "excel", "vba", "adodb"], "comments": [{"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1561561364, "post_id": 56775570, "comment_id": 100107155, "body": "Can you post the table definitions, some sample data, desired output etc..."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1561562042, "post_id": 56775570, "comment_id": 100107564, "body": "Since they are distinct codes something built around keys comes to mind, Dictionary maybe, for if key exists don&#39;t do anything, if it doesn&#39;t, add the record.  You could also build a &quot;recordset&quot; along the way of missing recordsets this way.  It is likely looping and more tedious code than using DB functions like JOIN and MERGE.  But if I was doing the recordset analysis in Excel I might approach it this way.  Unique says keys to me, fast and easy.  FYI - wouldn&#39;t meet your single query: It&#39;s a query PULL (1st), compare in Excel, INSERT (2nd Query or DB statement)."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1561562443, "post_id": 56775570, "comment_id": 100107780, "body": "@SeanLange added Fiddle, example expected output and test data"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1561562776, "post_id": 56775570, "comment_id": 100107972, "body": "@Wookies-Will-Code I reckon a single query would be possible. I am able to do it thanks to <a href=\"https://stackoverflow.com/a/56673239/10540017\">this answer</a> but I had not yet encountered such combinations.."}], "answers": [{"tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": false, "score": 0, "last_activity_date": 1561633073, "last_edit_date": 1561633073, "creation_date": 1561632637, "answer_id": 56789387, "question_id": 56775570, "link": "https://stackoverflow.com/questions/56775570/query-to-select-records-that-do-not-appear-in-db/56789387#56789387", "title": "Query to select records that do not appear in DB", "body": "<p><strong>Not the final answer, as the method below is SLOW</strong></p>\n\n<p>In this method I use a loop that populates a variable which helps populating a temp table with all component-asset type combinations which should be checked. I then compare the values in the database with the temp table using a CTE. </p>\n\n<p>Creating the temp table and executing the second query lasts for 5 seconds (with 1250 records in <code>#Temp</code>), which I deem to be too slow</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>arr = Range(\"B3:J\" &amp; LRow)\nFor i = 1 To LRow - 2\n    ComponentCodeTemp = ComponentCodeTemp &amp; \"Insert Into #Temp (Component, AssetType) Values ('\" &amp; arr(i, 1) &amp; \"','\" &amp; arr(i, 9) &amp; \"');\"\nNext i\n\n'Query\nSet rs = getdata(\"Create Table #Temp(Component nvarchar(50) Collate Latin1_General_BIN, AssetType nvarchar(50) Collate Latin1_General_BIN) \" &amp; ComponentCodeTemp &amp; _\n    \"; With Compare As (Select T.* From #Temp T), DBD As (Select Distinct Compare.Component,  Compare.AssetType From astComponents C Join astAssetTypes AT ON AT.Id = C.AssetTypeId Right Join #Temp Compare ON Compare.AssetType = AT.Code And Compare.Component = C.Code Where C.Code is null) \" &amp; _\n    \"Select * From DBD\")\n</code></pre>\n\n<p>A better markup for the SQL query:</p>\n\n<pre><code>WITH \n    Compare AS (\n                Select T.* FROM #Temp T\n               ),\n    DBD AS (\n            Select Distinct Compare.Component,  Compare.AssetType From astComponents C\n            Join astAssetTypes AT ON AT.Id = C.AssetTypeId\n            Right Join #Temp Compare ON Compare.AssetType = AT.Code And Compare.Component = C.Code\n            Where C.Code is null\n            )\nSelect * From DBD\n</code></pre>\n"}], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561633073, "creation_date": 1561560537, "last_edit_date": 1561632218, "question_id": 56775570, "link": "https://stackoverflow.com/questions/56775570/query-to-select-records-that-do-not-appear-in-db", "title": "Query to select records that do not appear in DB", "body": "<p>I am trying to add missing data to the DB and am therefore trying to collect this missing data through queries.</p>\n\n<p>In my excel sheet I have two columns: <code>col A</code> is populated with component codes, while <code>col J</code> holds its respective asset type codes.</p>\n\n<p>I want to find all non-existing component-asset type combinations <strong>in one query</strong>.</p>\n\n<p>Currently, I am looping through the excel sheet like in the following example:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>arr = Range(\"B3:J5000\")\nFor i = 1 To 5000-2\n    Set rs = cnn.Execute(\"Select Top 1 AT.Code From astComponents C Join astAssetTypes AT ON AT.Id = C.AssetTypeId Where C.Code = '\" &amp; arr(i, 1) &amp; \"' And AT.Code = '\" &amp; arr(i, 9) &amp; \"'\")\n    If rs.EOF Then\n        'Missing data was found\n    End If\nNext i\n</code></pre>\n\n<p>This is however not to my satisfaction. I want to end up with a recordset with the component-asset type combinations that are missing. This would significantly improve the speed of my program (120 times as fast)</p>\n\n<p>I tried to use <code>Except</code> but this resulted in no records where I did expect them:</p>\n\n<pre><code>Select Distinct C.Code, AT.Code \nFROM dbo.astComponents C \nJOIN dbo.astAssetTypes AT ON AT.Id = C.AssetTypeId \n\nWHERE (C.Code= '0738.D100' AND AT.Code = '0738.M00_03.03') Or (C.Code= '0738.D101' AND AT.Code = '0738.L00_04.04')\n\nExcept Select C.Code, AT.Code From astComponents C Join astAssetTypes AT ON AT.Id = C.AssetTypeId\n</code></pre>\n\n<p><strong>EDIT</strong><br>\nAs already mentioned, the desired output should be the missing component-asset type combinations. Example:</p>\n\n<pre><code>Component      Asset Type\n0738.D101      0990.D10_03.03\n0150.C101      0738.L00_04.04\n</code></pre>\n\n<p><strong><a href=\"http://sqlfiddle.com/#!18/6fbb0\" rel=\"nofollow noreferrer\">SQL-Fiddle</a></strong><br>\n<strong>Task</strong>: check whether the component-asset type combinations below exist in the fiddle database. If not, add these combinations to the output.</p>\n\n<pre><code>Component      Asset Type\n0738.D100      0990.D10_03.03\n0738.D101      0990.D10_03.03\n0150.C101      0738.L00_04.04\n0738.L004      0738.M00_03.03\n0990.D103      0738.M00_03.03\n</code></pre>\n"}, {"tags": ["excel", "vba", "performance", "time", "coding-efficiency"], "comments": [{"owner": {"reputation": 286, "user_id": 2101161, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/14b33674a7952dec3c13c2f38cd4ff06?s=128&d=identicon&r=PG", "display_name": "unseen_rider", "link": "https://stackoverflow.com/users/2101161/unseen-rider"}, "edited": false, "score": 0, "creation_date": 1561560189, "post_id": 56775262, "comment_id": 100106362, "body": "Input &amp; output data updated to show non-matching line example - <code>ABC005</code>"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1561560473, "post_id": 56775262, "comment_id": 100106566, "body": "Rather than just assigning the array to the range (which I suspect is what&#39;s taking time), try <code>WorksheetFunction.Transpose</code>. I find that it works a lot faster"}, {"owner": {"reputation": 286, "user_id": 2101161, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/14b33674a7952dec3c13c2f38cd4ff06?s=128&d=identicon&r=PG", "display_name": "unseen_rider", "link": "https://stackoverflow.com/users/2101161/unseen-rider"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 2, "creation_date": 1561560593, "post_id": 56775262, "comment_id": 100106657, "body": "The time is being taken by the loops block actually"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1561560597, "post_id": 56775262, "comment_id": 100106662, "body": "will there <i>ever</i> be more than two of the same serial numbers? e.g., one serial number exists once with boolan=0 but has two or more entries with boolean=1?"}, {"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 1, "creation_date": 1561560791, "post_id": 56775262, "comment_id": 100106772, "body": "<i>&quot;There is currently over 125000 rows of data and this is set to increase gradually over next few months.&quot;</i> Sounds like its time to use a database instead of excel?"}, {"owner": {"reputation": 286, "user_id": 2101161, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/14b33674a7952dec3c13c2f38cd4ff06?s=128&d=identicon&r=PG", "display_name": "unseen_rider", "link": "https://stackoverflow.com/users/2101161/unseen-rider"}, "edited": false, "score": 0, "creation_date": 1561560823, "post_id": 56775262, "comment_id": 100106807, "body": "No for this data there should only be one line for a unique <code>serial</code> where <code>boolean1</code> is 1"}, {"owner": {"reputation": 286, "user_id": 2101161, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/14b33674a7952dec3c13c2f38cd4ff06?s=128&d=identicon&r=PG", "display_name": "unseen_rider", "link": "https://stackoverflow.com/users/2101161/unseen-rider"}, "edited": false, "score": 0, "creation_date": 1561560904, "post_id": 56775262, "comment_id": 100106857, "body": "Client won&#39;t allow us to use a database - so this isn&#39;t an option"}], "answers": [{"comments": [{"owner": {"reputation": 286, "user_id": 2101161, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/14b33674a7952dec3c13c2f38cd4ff06?s=128&d=identicon&r=PG", "display_name": "unseen_rider", "link": "https://stackoverflow.com/users/2101161/unseen-rider"}, "edited": false, "score": 0, "creation_date": 1561566633, "post_id": 56775697, "comment_id": 100110040, "body": "I&#39;m giving an upvote for the framework. The code gave a compile error, but it was straightforward to fix."}, {"owner": {"reputation": 286, "user_id": 2101161, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/14b33674a7952dec3c13c2f38cd4ff06?s=128&d=identicon&r=PG", "display_name": "unseen_rider", "link": "https://stackoverflow.com/users/2101161/unseen-rider"}, "edited": false, "score": 0, "creation_date": 1561570422, "post_id": 56775697, "comment_id": 100111712, "body": "Much faster - went from 8 mins to 2 seconds - thank you"}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 1, "last_activity_date": 1561561556, "last_edit_date": 1561561556, "creation_date": 1561560950, "answer_id": 56775697, "question_id": 56775262, "link": "https://stackoverflow.com/questions/56775262/excel-vba-updating-dates-efficiently-with-non-unique-string-values-and-boolean-d/56775697#56775697", "title": "Excel VBA updating dates efficiently with non-unique string values and boolean data", "body": "<p>This should do it if your boolean1 is always 0 or 1:</p>\n\n<pre><code>Option Explicit\nSub Test()\n\n    Dim MyArr As Variant\n    Dim DictDates As New Scripting.Dictionary\n    Dim i As Long\n\n    With ThisWorkbook.Sheets(\"MySheet\") 'change MySheet for your sheetname\n        MyArr = .UsedRange.Value 'store the whole sheet inside the array\n        'loop through row 2 to last row to store data inside the dictionary\n        For i = 2 To UBound(MyArr)\n            'Check if the concatenate Serial &amp; boolean doesn't already exists and add it giving the date as item\n            If Not DictDates.Exists(MyArr(i, 1) &amp; MyArr(i, 2)) Then\n                DictDates.Add MyArr(i, 1) &amp; MyArr(i, 2), MyArr(i, 3)\n            End If\n        Next i\n        'loop through row 2 to last row to fill the data for boolean1 = 0\n        For i = 2 To UBound(MyArr)\n            'Check if the boolean1 = 0 and if the serial with boolean = 1 exists in your dictionary\n            If MyArr(i, 2) = 0 And DictDates.Exists(MyArr(i, 1) &amp; 1) Then\n                MyArr(i, 4) = DictDates(MyArr(i, 1) &amp; 1)\n            'for boolean1 = 1 copies the date2 to date1\n            ElseIf MyArr(i, 2) = 1 Then\n                MyArr(i, 4) = MyArr(i, 3)\n            End If\n        Next i\n        .UsedRange.Value = MyArr\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1561564421, "creation_date": 1561564421, "answer_id": 56776776, "question_id": 56775262, "link": "https://stackoverflow.com/questions/56775262/excel-vba-updating-dates-efficiently-with-non-unique-string-values-and-boolean-d/56776776#56776776", "title": "Excel VBA updating dates efficiently with non-unique string values and boolean data", "body": "<p>Unless there are some other edge cases (e.g., a Serial exists with Boolean=1 only but <strong>not</strong> 0), I think this can be done with a worksheet formula. Assuming Serial in column A, etc.:</p>\n\n<pre><code>=IF(COUNTIF($A:$A,$A2)=2,IFERROR(VLOOKUP($A2,$A3:$C$10,3,FALSE),C2),\"\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/9p5RK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9p5RK.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 286, "user_id": 2101161, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/14b33674a7952dec3c13c2f38cd4ff06?s=128&d=identicon&r=PG", "display_name": "unseen_rider", "link": "https://stackoverflow.com/users/2101161/unseen-rider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 56775697, "answer_count": 2, "score": 1, "last_activity_date": 1561564421, "creation_date": 1561559562, "last_edit_date": 1561563723, "question_id": 56775262, "link": "https://stackoverflow.com/questions/56775262/excel-vba-updating-dates-efficiently-with-non-unique-string-values-and-boolean-d", "title": "Excel VBA updating dates efficiently with non-unique string values and boolean data", "body": "<p>I am looking for a way in VBA for Excel that's quicker than arrays for updating dates from data. I have tried using <code>scripting.dictionary</code> but got stuck. Sample data and current code that works are below. </p>\n\n<p>Values for <code>serial</code> are non-unique. Hence currently thinking that these need to be looped over twice for considering each row.</p>\n\n<p>The objective of the code is to set <code>dates1</code> to be value of <code>dates2</code> when there is a match on <code>serial</code> and value of <code>boolean1</code> is <code>1</code>, then to output this back to the sheet.</p>\n\n<p>There is currently over 125000 rows of data and this is set to increase gradually over next few months.</p>\n\n<p>There should only be one line with unique <code>serial</code> and also having <code>boolean1</code> of <code>1</code>.</p>\n\n<p>Currently the code below takes 8 mins on an i7 processor. <strong>The main aim is to reduce this time if possible.</strong> An index match formula might be quicker, but also looking for other solutions such as dictionaries, collections etc.</p>\n\n<p>Sample input data:</p>\n\n<pre><code>serial    boolean1    dates2    dates1\nABC001    0    01/01/19    \nABC002    0    02/01/19    \nABC003    0    03/01/19    \nABC004    0    02/01/19 \nABC005    0    02/01/19   \nABC001    1    11/01/19    \nABC002    1    12/01/19    \nABC003    1    13/01/19    \nABC004    1    12/01/19    \n</code></pre>\n\n<p>Expected output data:</p>\n\n<pre><code>serial    boolean1    dates2   dates1\nABC001    0    01/01/19    11/01/19      \nABC002    0    02/01/19    12/01/19   \nABC003    0    03/01/19    13/01/19   \nABC004    0    02/01/19    12/01/19 \nABC005    0    02/01/19  \nABC001    1    11/01/19    11/01/19    \nABC002    1    12/01/19    12/01/19 \nABC003    1    13/01/19    13/01/19 \nABC004    1    12/01/19    12/01/19 \n</code></pre>\n\n<p>Current code:</p>\n\n<pre><code>serial() = sheetnm1.Range(\"serial_nr\").Value \nboolean1() = sheetnm1.Range(\"boolean_nr\").Value\ndates1() = sheetnm1.Range(\"dates1_nr\").Value\ndates2() = sheetnm1.Range(\"dates2_nr\").Value\n\ny = 1\nFor x = 1 To UBound(boolean1, 1)\n    If boolean1(x, 1) = 1 Then\n        For y = 1 To UBound(boolean1, 1)\n            If serial(y, 1) = serial(x, 1) Then\n                dates1(y, 1) = dates2(x, 1)\n            End If\n        Next y\n    End If\nNext x\n\nsheetnm1.Range(\"dates1_nr\") = dates1\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "internet-explorer-11"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1561561714, "post_id": 56775106, "comment_id": 100107363, "body": "Have you tried to: after your <code>element.FireEvent (&quot;OnClick&quot;)</code>, set <code>frm</code> to <code>nothing</code>. Then try to reset it to: <code>Set frm = ie.document.getElementByID(&quot;form1&quot;)</code>. Make sure that <code>form1</code> still exists"}, {"owner": {"reputation": 1681, "user_id": 8309643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKYcGO_qCIE/AAAAAAAAAAI/AAAAAAAAB8o/PJdqYRCGzdU/photo.jpg?sz=128", "display_name": "Robert Todar", "link": "https://stackoverflow.com/users/8309643/robert-todar"}, "edited": false, "score": 0, "creation_date": 1561561857, "post_id": 56775106, "comment_id": 100107453, "body": "Possibly need a wait after <code>element.FireEvent (&quot;OnClick&quot;)</code>?"}, {"owner": {"reputation": 1681, "user_id": 8309643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKYcGO_qCIE/AAAAAAAAAAI/AAAAAAAAB8o/PJdqYRCGzdU/photo.jpg?sz=128", "display_name": "Robert Todar", "link": "https://stackoverflow.com/users/8309643/robert-todar"}, "edited": false, "score": 0, "creation_date": 1561563221, "post_id": 56775106, "comment_id": 100108231, "body": "Just noticed, you are using <code>getElementById</code> and are trying to access an index in it. <code>getElementById</code> only returns a single node not an array of nodes. This is because <code>id</code> in HTML has to be unique. Try removing the index: <code>frm.getElementByID(&quot;fv_RRFC_txtOtherModel&quot;).Value = &quot;test model&quot;</code>"}, {"owner": {"reputation": 21, "user_id": 11703698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fa67cf8742be6b106a2e2f3f0171e1a?s=128&d=identicon&r=PG&f=1", "display_name": "gramzad", "link": "https://stackoverflow.com/users/11703698/gramzad"}, "edited": false, "score": 0, "creation_date": 1561567637, "post_id": 56775106, "comment_id": 100110463, "body": "I tried using getElementById with no index and had the same issue. I had added the index to see if that would fix it and forgot to remove it. I tried setting frm  to nothing, and it then gives Runtime error 91 (Object variable or With block variable not set). Even if I add a While ie.readyState &lt;&gt; 4 : DoEvents : Wend after the FireEvent (&quot;OnClick&quot;), I still get the Runtime Error 438"}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1561612270, "post_id": 56775106, "comment_id": 100122729, "body": "@gramzad, Try to create an object of document and after showing the field on the page again try to assign that object and check whether it helps to find the new elements on the page or not."}], "owner": {"reputation": 21, "user_id": 11703698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fa67cf8742be6b106a2e2f3f0171e1a?s=128&d=identicon&r=PG&f=1", "display_name": "gramzad", "link": "https://stackoverflow.com/users/11703698/gramzad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1597531825, "creation_date": 1561559076, "last_edit_date": 1561559467, "question_id": 56775106, "link": "https://stackoverflow.com/questions/56775106/how-to-add-elements-revealed-by-click-action-to-elements-list-in-excel-vba-for-a", "title": "How to add elements revealed by click action to elements list in Excel VBA for an html web form", "body": "<p>I'm trying to set up an Excel form that auto-fills an HTML web form. I've figured out how to use VBA to get the elements and cycle through them to add values. My issue is with a text field that is revealed with the click of a check box. I can't have Excel check the box until after I've obtained the elements for the form.</p>\n\n<p>I've looked at the html, and it looks like the field is hidden to some degree when the form is first loaded, as the id and everything can only be found in the tree once the box is checked. The problem is, this field won't show up in the VBA elements list no matter what I try. I've tried re-doing the Set command, and gotten an error when I do that. I'm not sure how to refresh the elements list in VBA to include the new input box.</p>\n\n<p>I used the <code>Set</code> command to get all the elements</p>\n\n<p><code>Set frm = ie.document.getElementByID(\"form1\")</code></p>\n\n<p>This is fine, but I can't use that same command to try to re-Set the element list. I get the run-time error 438 (Object doesn't support this property or method)</p>\n\n<p>I tried making a Variant titled <code>frm2</code>, but I get the same error</p>\n\n<pre><code>Sub formFill()\n    Dim ie      As Object\n    Dim frm     As Variant\n    Dim element As Variant\n\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    ie.navigate \"THIS IS THE URL\"\n    While ie.readyState &lt;&gt; 4: DoEvents: Wend\n\n    'Get form by ID\n    Set frm = ie.document.getElementByID(\"form1\")\n\n    ie.Visible = True\n\n    For Each element In frm.elements\n\n        Select Case element.Name\n            Case \"fv_RRFC$chkOtherModel\"\n                element.Checked = True\n                element.FireEvent (\"OnClick\")\n                frm.getElementByID(\"fv_RRFC_txtOtherModel\")(0).Value = \"test model\" 'I tried using the command here, but it didn't work\n            Case \"fv_RRFC$txtRRFC_PROGRAM\"\n                element.Value = \"test\"\n            Case \"fv_RRFC$txtOtherModel\"\n                element.Value = \"test model\"\n                'My attempt to add it to the Select Case. Not surprised this didn't work, as the for Each loop uses the list it had before\n        End Select\n    Next\nEnd Sub\n</code></pre>\n\n<p>I expected to be able to re-load the elements list to interact and fill the newly revealed box, but I've had no luck finding a way to do that.</p>\n"}, {"tags": ["excel", "vba", "datatable"], "comments": [{"owner": {"reputation": 1, "user_id": 11703604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e898d5767e9153f21c38b1dcf9dcc8d?s=128&d=identicon&r=PG&f=1", "display_name": "Littlecurt", "link": "https://stackoverflow.com/users/11703604/littlecurt"}, "edited": false, "score": 0, "creation_date": 1561559518, "post_id": 56775095, "comment_id": 100105933, "body": "Hey BigBen, Just edited my Question. Sorry this is my first post."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1561559911, "post_id": 56775095, "comment_id": 100106198, "body": "It looks like you have a table with multiple columns, named <code>OTRSData</code>. In the <code>TextToColumns</code> function, it&#39;s unclear to the function what you&#39;re specifying as the column to convert because you&#39;re including the <code>[#Headers]</code> tag. Try reducing the reference to <code>OTRSData[Close Time]</code> and see if that works."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1561562871, "post_id": 56775095, "comment_id": 100108026, "body": "You may also want to try <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoiding the use of selections in your code</a>"}], "owner": {"reputation": 1, "user_id": 11703604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e898d5767e9153f21c38b1dcf9dcc8d?s=128&d=identicon&r=PG&f=1", "display_name": "Littlecurt", "link": "https://stackoverflow.com/users/11703604/littlecurt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561559659, "creation_date": 1561559039, "last_edit_date": 1561559659, "question_id": 56775095, "link": "https://stackoverflow.com/questions/56775095/delimit-date-to-remove-time-stamp", "title": "Delimit Date to remove Time stamp", "body": "<p>I am currently making a report based off of Stats in my company. The raw data that I receive has date with a Time Stamp (2 Date Columns - Created/Received). To Remove the time stamp, I set the a custom format to m/d/yyyy and then Delimit each column separately which gives me the correct date. Once I assign my Macro to a button and add new Raw Data I receive this error ----</p>\n\n<p><a href=\"https://i.stack.imgur.com/22RRT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/22RRT.png\" alt=\"enter image description here\"></a></p>\n\n<p>Does anyone have any tips or understand why I am getting this error even though I am only Delimiting one column at a time? </p>\n\n<pre><code>Sub ComplianceOTRSMacro()\n    ' ComplianceOTRSMacro Macro\n    ' Format Date - Refresh Pivot Tables\n\n    Columns(\"D:E\").Select\n    Selection.NumberFormat = \"m/d/yyyy\"\n    Columns(\"D:D\").Select\n    Selection.TextToColumns Destination:=Range(\"OTRSData[[#Headers],[Created]]\") _\n        , DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, _\n        ConsecutiveDelimiter:=False, Tab:=False, Semicolon:=False, Comma:=False _\n        , Space:=False, Other:=False, FieldInfo:=Array(1, 1), _\n        TrailingMinusNumbers:=True\n\n    Columns(\"E:E\").Select\n    Selection.TextToColumns Destination:=Range( _\n        \"OTRSData[[#Headers],[Close Time]]\"), DataType:=xlDelimited, TextQualifier _\n        :=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, Semicolon:= _\n        False, Comma:=False, Space:=False, Other:=False, FieldInfo:=Array(1, 1) _\n        , TrailingMinusNumbers:=True\n    Range(\"OTRSData[[#Headers],[Ticket'#]]\").Select\n    Sheets(\"Dashboard\").Select\n    ActiveWorkbook.RefreshAll\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1561559210, "post_id": 56775026, "comment_id": 100105759, "body": "You can&#39;t copy the file from disk because you have it open and running the code!. You could use saveas to save a copy, followed by a second saveas to re-point the open file to the original location"}, {"owner": {"reputation": 11, "user_id": 11703713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46d6ab49253164652e50b9275c1535ab?s=128&d=identicon&r=PG&f=1", "display_name": "dziegler", "link": "https://stackoverflow.com/users/11703713/dziegler"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1561560665, "post_id": 56775026, "comment_id": 100106699, "body": "Thank you @HarassedDad, many thanks. Updated easily to ThisWorkbook.SaveCopyAs Filename:=archivePath."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1561562483, "post_id": 56775026, "comment_id": 100107809, "body": "I guess I am not sure what your issues truly are, you simply need a method that processes each workbook you open based on worksheet Name, CodeName, or position in the workbook, Do your work (copies and Title changes) based on your worksheet conditions, then close the workbook, onto the next one.  I do something similar to this with multiple workbooks and worksheets almost daily.  But your method is unique to you, your data, and your naming conventions.  Items 6-12 are just initiated from inside your Master Workbook, processing a directory the user chooses, it&#39;ll come together once you start."}, {"owner": {"reputation": 11, "user_id": 11703713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46d6ab49253164652e50b9275c1535ab?s=128&d=identicon&r=PG&f=1", "display_name": "dziegler", "link": "https://stackoverflow.com/users/11703713/dziegler"}, "reply_to_user": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1561562937, "post_id": 56775026, "comment_id": 100108073, "body": "@Wookies-Will-Code I think that last sentiment is spot-on. Perhaps just having a hard time catching that first &quot;thread&quot; of code to point me in the right direction."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1561572850, "post_id": 56775026, "comment_id": 100112751, "body": "Posted some code for you below, it is not done for you, but it should give you the framework to see this through."}], "answers": [{"comments": [{"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1562182186, "post_id": 56856428, "comment_id": 100302190, "body": "I am very glad that it worked out.  Keep on coding."}], "tags": [], "owner": {"reputation": 11, "user_id": 11703713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46d6ab49253164652e50b9275c1535ab?s=128&d=identicon&r=PG&f=1", "display_name": "dziegler", "link": "https://stackoverflow.com/users/11703713/dziegler"}, "is_accepted": true, "score": 0, "last_activity_date": 1562083853, "creation_date": 1562083853, "answer_id": 56856428, "question_id": 56775026, "link": "https://stackoverflow.com/questions/56775026/copying-data-from-multiple-worksheets-in-workbooks-to-differing-worksheets-in-se/56856428#56856428", "title": "Copying Data from Multiple Worksheets in Workbooks to Differing Worksheets in Separate Workbook - VBA Excel", "body": "<p>Posting my solution below. The issue I had stemmed from not setting the object variable <code>wsCopy = wbCopy.Worksheets(i)</code>. It should have been <code>Set wsCopy = wbCopy.Worksheets(i)</code>.</p>\n\n<p>Here is the Master Sub and Global Declarations</p>\n\n<pre><code>Option Explicit\n\n'These are Global to this MODULE, no need to pass to Subs\nDim wbMSTR As Workbook\nDim wsMSTR_XXF19 As Worksheet\nDim wsMSTR_Transfer As Worksheet\nDim wsMSTR_Travel As Worksheet\n\n'You will increment the rows in your procedure\nDim rowMSTR_F19 As Long\nDim rowMSTR_Transfer As Long\nDim rowMSTR_Travel As Long\n\nSub MasterWorkbookCompile()\n\n'Declaring Variables\nDim myPath As String\nDim archivePath As String\nDim fName As String\nDim wbCopy As Workbook\n\n'Initialize\nSet wbMSTR = ThisWorkbook\nSet wsMSTR_XXF19 = wbMSTR.Worksheets(\"XX FY19 Source\")\nSet wsMSTR_Transfer = wbMSTR.Worksheets(\"Transfer Funds\")\nSet wsMSTR_Travel = wbMSTR.Worksheets(\"Travel-Events Calendar\")\n\nfName = Dir(Application.ThisWorkbook.FullName)\nmyPath = Application.ThisWorkbook.FullName\narchivePath = \"C:\\XXXX\\\" &amp; (fName) 'Change to folder for archive subfolder\n\n'Set your Master data rows HERE\nrowMSTR_F19 = 2\nrowMSTR_Transfer = 2\nrowMSTR_Travel = 5\n\n'Debug.Print myPath, archivePath\n\n'****** TURNED THIS OFF FOR TESTING *******\n'Saving current file to archive folder\nThisWorkbook.SaveCopyAs Filename:=archivePath\n\n'Unfilters data on last worksheet\nOn Error Resume Next\nwsMSTR_Travel.ListObjects(\"Table2\").AutoFilter.ShowAllData\n\n'Clearing data in relevant worksheets\nwsMSTR_XXF19.Range(wsMSTR_XXF19.Range(\"A2:M2\"), wsMSTR_XXF19.Range(\"A2:M2\").End(xlDown)).ClearContents\nwsMSTR_Transfer.Range(wsMSTR_Transfer.Range(\"A2:M2\"), wsMSTR_Transfer.Range(\"A2:M2\").End(xlDown)).ClearContents\n\nWith wsMSTR_Travel.ListObjects(\"Table2\")\n   .Range.AutoFilter\n   .DataBodyRange.Offset(1).Resize(.DataBodyRange.Rows.Count - 1, .DataBodyRange.Columns.Count).Rows.ClearContents\n   .DataBodyRange.Rows(1).SpecialCells(xlCellTypeConstants).ClearContents\nEnd With\nOn Error GoTo 0\n\n'Opens all .xlsx files\n    Dim xStrPath As String\n    Dim xFileDialog As FileDialog\n    Dim xFile As String\n\n    Set xFileDialog = Application.FileDialog(msoFileDialogFolderPicker)\n\n    With xFileDialog\n        .AllowMultiSelect = False\n        .Title = \"Select a folder\"\n        .InitialFileName = \"C:\\Users\\XXX\" 'to be set to initial folder selection path\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        xStrPath = .SelectedItems(1) &amp; \"\\\"\n    End With\n\n'Handle Cancel\nNextCode:\n        xStrPath = xStrPath\n        If xStrPath = \"\" Then GoTo LeaveCode\n        xFile = Dir(xStrPath &amp; \"*.xls*\")\n\n'Make work fast, shut off some items, no screen flicker, kill clipboard alert\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n  Application.Calculation = xlCalculationManual\n  Application.DisplayAlerts = False\n\n'Disables all macros in newly opened files\n  Application.AutomationSecurity = msoAutomationSecurityForceDisable\n\n    Do While xFile &lt;&gt; \"\"\n\n        'Set up your event code here, get the Workbook\n        Set wbCopy = Workbooks.Open(Filename:=xStrPath &amp; xFile, UpdateLinks:=0)\n\n        'Ensure Workbook has opened before moving on to next line of code\n        DoEvents\n\n        '***********************************\n        ' PERFORM ACTIONS ON THIS COPYBOOK SHEETS HERE\n        '***********************************\n        Call processData(wbCopy)\n\n        'Save and Close the COPY Workbook\n        wbCopy.Close SaveChanges:=False\n\n        'Ensure Workbook has closed before moving on to next line of code\n        DoEvents\n\n\n      'Get Next File to Process\n       xFile = Dir\n\n    Loop\n\n    'Delete empty rows in Travel Sheet\n    Call DeleteEmptyRows(wbCopy)\n\n    'Message Box when tasks are completed\n    MsgBox \"Master Update Complete\"\n\nLeaveCode:\n'Turn things back on\n  Application.ScreenUpdating = True\n  Application.EnableEvents = True\n  Application.Calculation = xlCalculationAutomatic\n  Application.DisplayAlerts = True\n\n'Refreshes all PivotTable and PivotGraph Links\nwbMSTR.RefreshAll\n\nEnd Sub\n</code></pre>\n\n<p>Here is the data processing sub:</p>\n\n<pre><code>'Handle your data transfer here, it will be cleaner\n'the same workbook variable name is used here in the args\n'it doesn't have to be named the same, it is a pointer to the actual object ByRef\nPublic Sub processData(ByRef wbCopy As Workbook)\n\n'***** GLOBAL TO MODULE *****\n'These are Global to this MODULE, no need to pass to Subs\n'Dim wbMSTR As Workbook\n'Dim wsMSTR_XXF19 As Worksheet\n'Dim wsMSTR_Transfer As Worksheet\n'Dim wsMSTR_Travel As Worksheet\n\n'You will increment the rows\n'Dim rowMSTR_F19 As Long\n'Dim rowMSTR_Transfer As Long\n'Dim rowMSTR_Travel As Long\n'***** GLOBAL TO MODULE *****\n\n'Defining our variables as the relevant Worksheet locations we want to copy\nDim wsCopy_F19 As Long\nDim wsCopy_Transfer As Long\nDim wsCopy_Travel As Long\nDim wsCopy_XXX2 As Long\nDim wsCopy_XXX1 As Long\n\n'This is the Worksheet we will target and its name\nDim wsCopy As Worksheet\nDim wsCopyName As String\n\n'Variables related to looping through Worksheets in Workbook\nDim numWs As Double\nDim i As Double\n\n'Target copy range\nDim Target1 As Range\nDim Target2 As Range\nDim Target3 As Range\nDim Target4 As Range\nDim Target5 As Range\n\n\n'Gets the number of Worksheets in the Workbook\nnumWs = wbCopy.Worksheets.Count\n\n'For worksheets 1 to the final number... do the below\nFor i = 1 To numWs\n With wbCopy\n\n    Set wsCopy = wbCopy.Worksheets(i)\n    wsCopyName = wsCopy.Name\n\n    If wsCopyName = \"A 19 Source\" Or wsCopyName = \"B 19 Source\" Or wsCopyName = \"C FY19 Source\" Or wsCopyName = \"D FY19 Source\" Or wsCopyName = \"E FY19 Source\" Or wsCopyName = \"F 19 Source\" Or wsCopyName = \"G FY19 Source\" Or wsCopyName = \"H FY19 Source\" Then\n\n        wsCopy_F19 = wsCopy.Cells(Rows.Count, 1).End(xlUp).Row\n        Set Target1 = wsCopy.Range(\"A2:M\" &amp; wsCopy_F19)\n        Target1.Copy\n        wsMSTR_XXF19.Range(\"A\" &amp; rowMSTR_F19).PasteSpecial Paste:=xlValues\n        rowMSTR_F19 = wsMSTR_XXF19.Cells(Rows.Count, 1).End(xlUp).Row + 1\n\n    ElseIf wsCopyName = \"XXX3 FY19 Source\" Then\n        wsCopy_Transfer = wsCopy.Cells(Rows.Count, 1).End(xlUp).Row\n        Set Target2 = wsCopy.Range(\"A2:M\" &amp; wsCopy_Transfer)\n        Target2.Copy\n        wsMSTR_Transfer.Range(\"A\" &amp; rowMSTR_Transfer).PasteSpecial Paste:=xlValues\n        rowMSTR_Transfer = wsMSTR_Transfer.Cells(Rows.Count, 1).End(xlUp).Row + 1\n\n'                   **************************************************************************************************************\n    ''THIS IS COMMENTED OUT BECAUSE THERE IS NO XXX2 FUNDING - COMMENT BACK IN IF FUNDING OCCURS''\n'                   **************************************************************************************************************\n'                   ElseIf wsCopyName = \"XXX2\" Then\n'                        wsCopy_XXX2 = wsCopy.Cells(Rows.Count, 1).End(xlUp).Row\n'                        Set Target4 = wsCopy.Range(\"A2:M\" &amp; wsCopy_XXX2)\n'                        Target4.Copy\n'                        wsMSTR_Transfer.Range(\"A\" &amp; rowMSTR_Transfer).PasteSpecial Paste:=xlValues\n'                        rowMSTR_Transfer = wsMSTR_Transfer.Cells(Rows.Count, 1).End(xlUp).Row + 1\n\n'                   **************************************************************************************************************\n    ''THIS IS COMMENTED OUT BECAUSE THERE IS NO XXX1 FUNDING - COMMENT BACK IN IF FUNDING OCCURS''\n'                   **************************************************************************************************************\n'                   ElseIf wsCopyName = \"ENTER XXX1 FUNDING SHEET NAME\" Then\n'                        wsCopy_XXX1 = wsCopy.Cells(Rows.Count, 1).End(xlUp).Row\n'                        Set Target5 = wsCopy.Range(\"A2:M\" &amp; wsCopy_XXX1)\n'                        Target5.Copy\n'                        wsMSTR_Transfer.Range(\"A\" &amp; rowMSTR_Transfer).PasteSpecial Paste:=xlValues\n'                        rowMSTR_Transfer = wsMSTR_Transfer.Cells(Rows.Count, 1).End(xlUp).Row + 1\n\n    ElseIf wsCopyName = \"Travel-Events Calendar\" Or wsCopyName = \"Travel - Events Calendar\" Then\n        wsCopy_Travel = wsCopy.Cells(Rows.Count, 1).End(xlUp).Row\n        wsCopy.ListObjects(1).AutoFilter.ShowAllData\n        Set Target3 = wsCopy.Range(\"A5:L\" &amp; wsCopy_Travel)\n        Target3.Copy\n        wsMSTR_Travel.Range(\"A\" &amp; rowMSTR_Travel).PasteSpecial Paste:=xlValues\n        rowMSTR_Travel = wsMSTR_Travel.Cells(Rows.Count, 1).End(xlUp).Row + 1\n\n    Else\n\n    End If\n    End With\nNext\n\nEnd Sub\n</code></pre>\n\n<p>Big thanks to @Wookies-Will-Code for their invaluable help.</p>\n"}], "owner": {"reputation": 11, "user_id": 11703713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46d6ab49253164652e50b9275c1535ab?s=128&d=identicon&r=PG&f=1", "display_name": "dziegler", "link": "https://stackoverflow.com/users/11703713/dziegler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 56856428, "answer_count": 1, "score": 1, "last_activity_date": 1562083853, "creation_date": 1561558803, "last_edit_date": 1561747154, "question_id": 56775026, "link": "https://stackoverflow.com/questions/56775026/copying-data-from-multiple-worksheets-in-workbooks-to-differing-worksheets-in-se", "title": "Copying Data from Multiple Worksheets in Workbooks to Differing Worksheets in Separate Workbook - VBA Excel", "body": "<p>I have found varying solutions online to this, but haven't been able to conform them to what I want. Here is the problem set:</p>\n\n<ol>\n<li><p>Open all .xlsx files in selected folder <strong>DONE</strong></p></li>\n<li><p>Copy Master Workbook to Archive folder (selected folder path/Archive) <strong>DONE</strong></p></li>\n<li><p>Clear data in Master Workbook in Worksheet titled \"FY19 Source\" (Worksheet 3) from Row 2 and below. <strong>DONE</strong></p></li>\n<li><p>Clear data in Master Workbook in Worksheet titled \"Travel-Events Calendar\" (Worksheet 4) from Row 2 and below. <strong>DONE</strong></p></li>\n<li><p>Clear data in Master Workbook in Worksheet titled \"Transfer\" (Worksheet 5) from Row 5 and below. <strong>DONE</strong></p></li>\n<li><p>For each open Workbook (except Master Workbook), copy the non-hidden/non-null data from all rows south of A2:M2 in Worksheets titled \"FY19 Source\"</p></li>\n<li><p>Paste data continuously in Master Workbook's \"FY19 Source\" Worksheet starting on Row 2.</p></li>\n<li><p>For each open Workbook, if they have a Worksheet labeled \"Transfer\" OR \"Transfer2\" OR \"Transfer 3\", copy the non-hidden/non-null data from all rows south of A2:M2 for each.</p></li>\n<li><p>Paste data continuously in Master Workbooks \"Transfer\" Worksheet starting on Row 2</p></li>\n<li><p>For each open Workbook clear filters from the Worksheets titled \"Travel-Events Calendar\"</p></li>\n<li><p>For each open Workbook (except Master Workbook), copy the non-hidden/non-null data from all rows south of A5:L5</p></li>\n<li><p>Paste data continuously in Master Workbooks \"Travel-Events Calendar\" Worksheet starting on Row 5.</p></li>\n<li><p>Execute Refresh Links in Master Workbooks <strong>DONE</strong></p></li>\n</ol>\n\n<p>I could really use help with the copying/combining aspect of this from open workbooks as noted above.</p>\n\n<p>I have found a couple of like-minded questions during my research but can't seem to apply them totally to this which is really frustrating :( It seems like I can do most of these steps in turn but I can't put anything together that works! Any guidance would be extremely appreciated. Thank you!</p>\n\n<p>Code I have so far annotated: </p>\n\n<pre><code>Sub MasterWorkbookCompile()\n\n'Declaring Variables\nDim myPath As String\nDim archivePath As String\nDim endSourceSheet As Worksheet\nDim endTransferSheet As Worksheet\nDim endTravelSheet As Worksheet\n\nfName = Dir(Application.ThisWorkbook.FullName)\nmyPath = Application.ThisWorkbook.FullName\narchivePath = \"C:\\Users\\XX\\\" &amp; (fName)\n\n'Debug.Print myPath, archivePath\n\n'Saving current file to archive folder\nThisWorkbook.SaveCopyAs Filename:=archivePath\n\n'Unfilters data on last worksheet\nOn Error Resume Next\nThisWorkbook.Worksheets(\"Travel-Events Calendar\").ListObjects(\"Table2\").AutoFilter.ShowAllData\n\n'Clearing data in relevant worksheets\nThisWorkbook.Sheets(\"XXFY19 Source\").Range(ThisWorkbook.Sheets(\"XXFY19 Source\").Range(\"A2:M2\"), ThisWorkbook.Sheets(\"XXFY19 Source\").Range(\"A2:M2\").End(xlDown)).ClearContents\nThisWorkbook.Sheets(\"Transfer Funds\").Range(ThisWorkbook.Sheets(\"Transfer Funds\").Range(\"A2:M2\"), ThisWorkbook.Sheets(\"Transfer Funds\").Range(\"A2:M2\").End(xlDown)).ClearContents\n\nWith ThisWorkbook.Sheets(\"Travel-Events Calendar\").ListObjects(\"Table2\")\n   .Range.AutoFilter\n   .DataBodyRange.Offset(1).Resize(.DataBodyRange.Rows.Count - 1, .DataBodyRange.Columns.Count).Rows.ClearContents\n   .DataBodyRange.Rows(1).SpecialCells(xlCellTypeConstants).ClearContents\nEnd With\nOn Error GoTo 0\n\n'Opens all .xlsx files\n    Dim xStrPath As String\n    Dim xFileDialog As FileDialog\n    Dim xFile As String\n    On Error Resume Next\n    Set xFileDialog = Application.FileDialog(msoFileDialogFolderPicker)\n    xFileDialog.AllowMultiSelect = False\n    xFileDialog.Title = \"Select a folder\"\n    xFileDialog.InitialFileName = \"C:\\Users\\XX\"\n    If xFileDialog.Show = -1 Then\n        xStrPath = xFileDialog.SelectedItems(1)\n    End If\n    If xStrPath = \"\" Then Exit Sub\n    xFile = Dir(xStrPath &amp; \"\\*.xlsx\")\n    Do While xFile &lt;&gt; \"\"\n        If Not ActiveWorkbook Then\n            Workbooks.Open xStrPath &amp; \"\\\" &amp; xFile\n            xFile = Dir\n        End If\n    Loop\n\n\n\n'Refreshes any PivotTable Links\nThisWorkbook.RefreshAll\n\nEnd Sub\n</code></pre>\n\n<p>DATA PROCESSING</p>\n\n<pre><code>                Dim wsCopy_F19 As Long\n                Dim wsCopy_Transfer As Long\n                Dim wsCopy_Travel As Long\n\n                Dim wsCopy As Worksheet\n                Dim numWs As Double\n                Dim i As Double\n                Dim wsCopyName As String\n                Dim Target1 As Range\n                Dim Target2 As Range\n                Dim Target3 As Range\n\n                numWs = wbCopy.Worksheets.Count\n\n                For i = 0 To numWs\n\n                    wsCopy = wbCopy.Worksheets(i)\n                    wsCopyName = wsCopy.Name\n\n                    If wsCopyName = \"FY19 Source\" Then\n\n                        wsCopy_F19 = wsCopy.Cells(Rows.Count, 1).End(xlUp).Row\n                        Set Target1 = wsCopy.Range(\"A2:M\" &amp; wsCopy_F19)\n                        Target1.Copy Destination:=wsMSTR_XXF19.Range(\"A\" &amp; rowMSTR_F19).PasteSpecial(xlPasteValues)\n                        rowMSTR_F19 = wsMSTR_XXF19.Cells(Rows.Count, 1).End(xlUp).Row + 1\n\n                    ElseIf InStr(wsCopyName, \"Transfer\") &gt; 0 Then\n\n                        wsCopy_Transfer = wsCopy.Cells(Rows.Count, 1).End(xlUp).Row\n                        Set Target2 = wsCopy.Range(\"A2:M\" &amp; wsCopy_Transfer)\n                        Target2.Copy Destination:=wsMSTR_Transfer.Range(\"A\" &amp; rowMSTR_Transfer).PasteSpecial(xlPasteValues)\n                        rowMSTR_Transfer = wsMSTR_Transfer.Cells(Rows.Count, 1).End(xlUp).Row + 1\n\n                    ElseIf wsCopyName = \"Travel-Events Calendar\" Then\n\n                        wsCopy_Travel = wsCopy.Cells(Rows.Count, 1).End(xlUp).Row\n                        Set Target3 = wsCopy.Range(\"A2:M\" &amp; wsCopy_Travel)\n                        Target3.Copy Destination:=wsMSTR_Travel.Range(\"A\" &amp; rowMSTR_Travel).PasteSpecial(xlPasteValues)\n                        rowMSTR_Travel = wsMSTR_Travel.Cells(Rows.Count, 1).End(xlUp).Row + 1\n\n                    Else\n\n                    End If\n            Next\n</code></pre>\n"}, {"tags": ["vba", "loops", "ms-word"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1561557406, "post_id": 56774504, "comment_id": 100104534, "body": "Input your variables inside one array and loop through it, if you have so many I&#39;d write them into cells in one worksheet and then <code>MyArray = Sheets(&quot;MySheet&quot;).Range(&quot;A1:A100&quot;).Value</code> for example, you will get a 2d array that you can loop and your filenames will be on <code>MyArray(i, 1)</code>"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1561558598, "post_id": 56774504, "comment_id": 100105341, "body": "Where are these variables coming from? Is this static text of some kind? Or is it being pulled in from a data source? Do you really mean Word&#39;s mail merge functionality, or when you say &quot;mail merge&quot; you mean merging information into a Word document, generally? Right off-hand, I&#39;d question hard-coding the information for 70 variables into the macro. If any of these locations changes it means changing the macro. Better to read the information from a more easily managed source?"}], "answers": [{"tags": [], "owner": {"reputation": 181, "user_id": 7398924, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uF3-0rZE7iE/AAAAAAAAAAI/AAAAAAAARNQ/mnS_OgRO0H0/photo.jpg?sz=128", "display_name": "Nirostar", "link": "https://stackoverflow.com/users/7398924/nirostar"}, "is_accepted": true, "score": 0, "last_activity_date": 1561558117, "creation_date": 1561558117, "answer_id": 56774813, "question_id": 56774504, "link": "https://stackoverflow.com/questions/56774504/can-a-loop-be-performed-to-run-through-a-set-of-defined-variables/56774813#56774813", "title": "Can a loop be performed to run through a set of defined variables?", "body": "<p>I would recommend using Arrays. You can use <code>Dim fund(1 To 4) As String</code> to declare an array and <code>fund(1)</code> to get the value at position 1, <code>fund(2)</code> to get the value at position 2, etc.</p>\n\n<p>You can iterate over them by either using an index counter</p>\n\n<pre><code>For i = LBound(fund) To UBound(fund)\n   MsgBox fund(i)\nNext i\n</code></pre>\n\n<p>or with a for each</p>\n\n<pre><code>For Each element In fund\n   MsgBox element\nNext element\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 9871136, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QrQkdb1ybgo/AAAAAAAAAAI/AAAAAAAABcQ/koRfTrmmIQE/photo.jpg?sz=128", "display_name": "Ken_among_men", "link": "https://stackoverflow.com/users/9871136/ken-among-men"}, "is_accepted": false, "score": 0, "last_activity_date": 1561561987, "creation_date": 1561561987, "answer_id": 56776047, "question_id": 56774504, "link": "https://stackoverflow.com/questions/56774504/can-a-loop-be-performed-to-run-through-a-set-of-defined-variables/56776047#56776047", "title": "Can a loop be performed to run through a set of defined variables?", "body": "<p>Thank you Nirostar - your answer was what I needed. This quickly loops through all the files!</p>\n\n<pre><code>For i = LBound(fund) To UBound(fund)\n\n    With ActiveDocument.MailMerge\n        .Destination = wdSendToNewDocument\n        .SuppressBlankLines = True\n        With .DataSource\n            .FirstRecord = ActiveDocument.MailMerge.DataSource.ActiveRecord\n            .LastRecord = ActiveDocument.MailMerge.DataSource.ActiveRecord\n        End With\n        .Execute Pause:=False\n    End With\n    ActiveDocument.SaveAs2 FileName:=filepath &amp; \"\\\" &amp; fund(i) &amp; \"\\NCSR 302 Certifications\" &amp; fundabbv(i) &amp; \".docx\"\n    ActiveDocument.Close\n\n    Windows(mainfile).Activate\n    ActiveDocument.MailMerge.DataSource.ActiveRecord = wdNextRecord\n\nNext i\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9871136, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QrQkdb1ybgo/AAAAAAAAAAI/AAAAAAAABcQ/koRfTrmmIQE/photo.jpg?sz=128", "display_name": "Ken_among_men", "link": "https://stackoverflow.com/users/9871136/ken-among-men"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 56774813, "answer_count": 2, "score": 0, "last_activity_date": 1561561987, "creation_date": 1561557195, "question_id": 56774504, "link": "https://stackoverflow.com/questions/56774504/can-a-loop-be-performed-to-run-through-a-set-of-defined-variables", "title": "Can a loop be performed to run through a set of defined variables?", "body": "<p>I\u2019m working on some code and wondering if a loop is possible. I\u2019m actually writing this code for Word and not Excel which I normally do but I don\u2019t think that matters. My vba skill level is beginner-intermediate I\u2019d say. The code is meant to use the mail merge feature in Word which changes a few features in the document, and then perform a save-as on the file, then move on to the next file. </p>\n\n<pre><code>Sub Finsh_Merge_Save_302()\n\n\nDim date1 As String\nDim date2 As String\nDim filepath As String\nDim mainfile As String\n\n\n\nDim fund1 As String, fund2 As String, fund3 As String, fund4 As String 'etc.\n\nDim fundabbv1 As String, fundabbv2 As String, fundabbv3 As String, fundabbv4 As String ' etc.\n\nmainfile = ActiveDocument.Name\n\nfund1 = \"blah blah blah 1\"\nfund2 = \"blah blah blah 2\"\nfund3 = \"blah blah blah x\"\nfund4 = \"blah blah blah y\"\n'etc.\n\nfundabbv1 = \" stuff here 1\"\nfundabbv2 = \" stuff here 2\"\nfundabbv3 = \" stuff here x\"\nfundabbv4 = \" stuff here y\"\n'etc.\n\n\n\n\n    date1 = InputBox(\"Enter year of filing: 20xx\")\n    date2 = InputBox(\"Enter full date of filing: mm-dd-yyyy\")\n    filepath = \"\\\\Bp211\\sys\\FAD\\FA\\TRES (March 2015)\\Financial Reporting\\Certifications\\SOX Compliance and Certifications\\N-CSR Certifications\\NCSR Filings\\\" &amp; date1 &amp; \"\\\" &amp; date2\n\nApplication.ScreenUpdating = False\n\n\n    With ActiveDocument.MailMerge\n        .Destination = wdSendToNewDocument\n        .SuppressBlankLines = True\n        With .DataSource\n            .FirstRecord = ActiveDocument.MailMerge.DataSource.ActiveRecord\n            .LastRecord = ActiveDocument.MailMerge.DataSource.ActiveRecord\n        End With\n        .Execute Pause:=False\n    End With\n    ActiveDocument.SaveAs2 FileName:=filepath &amp; \"\\\" &amp; fund1 &amp; \"\\NCSR 302 Certifications\" &amp; fundabbv1 &amp; \".docx\"\n    ActiveDocument.Close\n\n    Windows(mainfile).Activate\n    ActiveDocument.MailMerge.DataSource.ActiveRecord = wdNextRecord\n\n\n\n    With ActiveDocument.MailMerge\n        .Destination = wdSendToNewDocument\n        .SuppressBlankLines = True\n        With .DataSource\n            .FirstRecord = ActiveDocument.MailMerge.DataSource.ActiveRecord\n            .LastRecord = ActiveDocument.MailMerge.DataSource.ActiveRecord\n        End With\n        .Execute Pause:=False\n    End With\n    ActiveDocument.SaveAs2 FileName:=filepath &amp; \"\\\" &amp; fund2 &amp; \"\\NCSR 302 Certifications\" &amp; fundabbv2 &amp; \".docx\"\n    ActiveDocument.Close\n\n    Windows(mainfile).Activate\n    ActiveDocument.MailMerge.DataSource.ActiveRecord = wdNextRecord\n\n</code></pre>\n\n<p>You can see where I'm using defined variables to save the file to the correct file location with the correct file name. Currently this works without a problem. The issue is I have many defined variables, 70+, so I was wondering if I could create a loop instead of writing that section of code 70+ times.</p>\n"}, {"tags": ["excel", "vba", "matching"], "comments": [{"owner": {"reputation": 5, "user_id": 11703493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef76f3258c419a9a26bf3d4f4a8d92b?s=128&d=identicon&r=PG&f=1", "display_name": "Dflanders", "link": "https://stackoverflow.com/users/11703493/dflanders"}, "edited": false, "score": 0, "creation_date": 1561556816, "post_id": 56774295, "comment_id": 100104134, "body": "Thanks for the edit Damian. Not sure why it pasted over like that"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1561556932, "post_id": 56774295, "comment_id": 100104220, "body": "Thought this is offtopic, once you paste your code, select it and press ctrl+k"}, {"owner": {"reputation": 5, "user_id": 11703493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef76f3258c419a9a26bf3d4f4a8d92b?s=128&d=identicon&r=PG&f=1", "display_name": "Dflanders", "link": "https://stackoverflow.com/users/11703493/dflanders"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1561557175, "post_id": 56774295, "comment_id": 100104398, "body": "I appreciate the info!"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1561557198, "post_id": 56774295, "comment_id": 100104415, "body": "Could you please post images from the inputs and the desired output?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1561557418, "post_id": 56774295, "comment_id": 100104546, "body": "Maybe you can do it without a loop? The formula <code>=SUMPRODUCT(--$E$5=&#39;Sheet 2&#39;!$E$5:$E$9))</code> will return 1 if E5 as a value equal to one in the range Sheet 2!E5:E9."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11703493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef76f3258c419a9a26bf3d4f4a8d92b?s=128&d=identicon&r=PG&f=1", "display_name": "Dflanders", "link": "https://stackoverflow.com/users/11703493/dflanders"}, "edited": false, "score": 1, "creation_date": 1561559738, "post_id": 56774837, "comment_id": 100106087, "body": "Mikku you are a god"}, {"owner": {"reputation": 5, "user_id": 11703493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef76f3258c419a9a26bf3d4f4a8d92b?s=128&d=identicon&r=PG&f=1", "display_name": "Dflanders", "link": "https://stackoverflow.com/users/11703493/dflanders"}, "edited": false, "score": 0, "creation_date": 1561588839, "post_id": 56774837, "comment_id": 100118428, "body": "So the only piece that I am concerned with at this point is that a student could input a single correct value 5 times are still receive credit. Obviously there would be no reason to do this without knowledge of the code being used, but I am still curious to see if I can prevent that by having the sub ignore a range entry after a match is found. Any ideas?"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 5, "user_id": 11703493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef76f3258c419a9a26bf3d4f4a8d92b?s=128&d=identicon&r=PG&f=1", "display_name": "Dflanders", "link": "https://stackoverflow.com/users/11703493/dflanders"}, "edited": false, "score": 0, "creation_date": 1561604059, "post_id": 56774837, "comment_id": 100121052, "body": "It ignores once the match is found. Did you try the scenario that you are talking about ?"}, {"owner": {"reputation": 5, "user_id": 11703493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef76f3258c419a9a26bf3d4f4a8d92b?s=128&d=identicon&r=PG&f=1", "display_name": "Dflanders", "link": "https://stackoverflow.com/users/11703493/dflanders"}, "edited": false, "score": 0, "creation_date": 1561652994, "post_id": 56774837, "comment_id": 100145161, "body": "I did. I can currently put the same value in 5 times and still get an output of 1. I&#39;ll give it another look"}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 1, "last_activity_date": 1561558196, "creation_date": 1561558196, "answer_id": 56774837, "question_id": 56774295, "link": "https://stackoverflow.com/questions/56774295/how-can-i-effectively-use-if-statements-with-multiple-conditions-in-vba-compari/56774837#56774837", "title": "How can I effectively use If statements with multiple conditions in VBA, comparing user input to a range?", "body": "<p>Little Complex :) </p>\n\n<pre><code>Sub Q1()\n\nDim i As Integer\nDim j As Integer\n\nDim chck(5 To 9) As Boolean\n\nFor i = 5 To 9\n\n    For j = 5 To 9\n\n        If Sheet1.Cells(i, 5) = Sheet2.Cells(j, 5) Then\n\n            chck(i) = True\n            Exit For\n        Else: chck(i) = False\n\n        End If\n    Next\n\nNext\n\nj = 0\n\nFor i = LBound(chck) To UBound(chck)\n\n    If chck(i) = True Then j = j + 1\n\nNext\n\nIf j = 5 Then\nSheet1.Cells(5, 6) = 1\nElse: Sheet1.Cells(5, 6) = 0\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1561559641, "creation_date": 1561559641, "answer_id": 56775283, "question_id": 56774295, "link": "https://stackoverflow.com/questions/56774295/how-can-i-effectively-use-if-statements-with-multiple-conditions-in-vba-compari/56775283#56775283", "title": "How can I effectively use If statements with multiple conditions in VBA, comparing user input to a range?", "body": "<p>Does this really need to be VBA? A formula can perform this calculation. Use this in 'Sheet1' cell F5:</p>\n\n<pre><code>=--(SUMPRODUCT(COUNTIF(Sheet2!E5:E9,E5:E9))&gt;0)\n</code></pre>\n\n<p>If at least one of the values in 'Sheet1'!E5:E9 (the user entered values) exists in your 'Sheet2'!E5:E9 list, the formula will return a <code>1</code> else <code>0</code> which is the desired result based on your description.</p>\n"}], "owner": {"reputation": 5, "user_id": 11703493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef76f3258c419a9a26bf3d4f4a8d92b?s=128&d=identicon&r=PG&f=1", "display_name": "Dflanders", "link": "https://stackoverflow.com/users/11703493/dflanders"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 56774837, "answer_count": 2, "score": 0, "last_activity_date": 1561570323, "creation_date": 1561556545, "last_edit_date": 1561570323, "question_id": 56774295, "link": "https://stackoverflow.com/questions/56774295/how-can-i-effectively-use-if-statements-with-multiple-conditions-in-vba-compari", "title": "How can I effectively use If statements with multiple conditions in VBA, comparing user input to a range?", "body": "<p>I am attempting to create an Auto-grading test of sorts in Excel.</p>\n\n<p>I have 5 values in <code>Sheet1</code> that are input by a user in cells <code>E5:E9</code>. These should then be compared against a range of 5 more cells in <code>Sheet2</code> (also cells <code>E5:E9</code>).</p>\n\n<p>As the user might not always list these entries in the same order that I have in my Sheet2 range, I decided that I should loop through the range for each cell's input. </p>\n\n<p>The next step would be to be able to ignore the value in the range once a match has been found but I need to get this part working correctly. Currently, the values absolutely match. However, I am not getting the correct output. </p>\n\n<pre><code>Sub Q1()\n\n    Dim i As Integer\n    For i = 5 To 9\n        If (Sheet1.Cells(5, 5) = Sheet2.Cells(i, 5)) And (Sheet1.Cells(6, 5) = Sheet2.Cells(i, 5)) And (Sheet1.Cells(7, 5) = Sheet2.Cells(i, 5)) And (Sheet1.Cells(8, 5) = Sheet2.Cells(i, 5)) And (Sheet1.Cells(9, 5) = Sheet2.Cells(i, 5)) Then\n            Sheet1.Cells(5, 6) = 1\n            Exit For\n        Else\n            Sheet1.Cells(5, 6) = 0\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>I would expect the output of 1 to <code>Sheet1</code> cell <code>E6</code> but I am currently getting 0. Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1561555792, "post_id": 56773981, "comment_id": 100103482, "body": "Please read <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and try to build one from your code so the issue is reproducible. That would it make much easier to help you. From your current description it is hard to tell what actually happens there. That would be more guessing than really helping."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1561556177, "post_id": 56773981, "comment_id": 100103733, "body": "I suspect that your form is not set as modeless. If the form is not set as modeless, clicking on the form will always bring the workbook where the form originated from. Try setting your form as modeless"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 2, "creation_date": 1561556287, "post_id": 56773981, "comment_id": 100103802, "body": "as mentioned above in the <code>Userform_Show</code> command add <code>vbModeless</code>, so it would look like this <code>Userform_Show vbModeless</code>"}, {"owner": {"reputation": 47, "user_id": 11599133, "user_type": "registered", "profile_image": "https://graph.facebook.com/2072161339559504/picture?type=large", "display_name": "Ben", "link": "https://stackoverflow.com/users/11599133/ben"}, "reply_to_user": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1561558572, "post_id": 56773981, "comment_id": 100105322, "body": "@ZackE didn&#39;t work. Interacting with the userform still brings the original workbook to the front."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1561558875, "post_id": 56773981, "comment_id": 100105532, "body": "Try setting the <code>ShowNodal</code> property of the form to <code>False</code>"}, {"owner": {"reputation": 47, "user_id": 11599133, "user_type": "registered", "profile_image": "https://graph.facebook.com/2072161339559504/picture?type=large", "display_name": "Ben", "link": "https://stackoverflow.com/users/11599133/ben"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1561559296, "post_id": 56773981, "comment_id": 100105806, "body": "@Zac isn&#39;t that the same as doing uf_ColSelectA.Show vbModeless"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1561559494, "post_id": 56773981, "comment_id": 100105916, "body": "Almost. If you set the property of the form as modeless, form is opened as modeless. If you do it through VBA, it tends to be a bit <b>flaky</b> as form is already created at that point. All <code>show</code> does is render the form visible"}, {"owner": {"reputation": 47, "user_id": 11599133, "user_type": "registered", "profile_image": "https://graph.facebook.com/2072161339559504/picture?type=large", "display_name": "Ben", "link": "https://stackoverflow.com/users/11599133/ben"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1561559945, "post_id": 56773981, "comment_id": 100106217, "body": "@Zac tried it: didn&#39;t work"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1561560122, "post_id": 56773981, "comment_id": 100106319, "body": "Hmm, how bizarre, I just tried that and it works for me"}, {"owner": {"reputation": 47, "user_id": 11599133, "user_type": "registered", "profile_image": "https://graph.facebook.com/2072161339559504/picture?type=large", "display_name": "Ben", "link": "https://stackoverflow.com/users/11599133/ben"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1561560564, "post_id": 56773981, "comment_id": 100106628, "body": "@Zac I don&#39;t know what to tell ya. Thanks for trying!"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1561562188, "post_id": 56773981, "comment_id": 100107643, "body": "Did you try moving <code>uf_ColSelectA.Show vbModeless</code> outside of the loop?  Im wondering if having the call for the UserForm in the <code>Loop</code> is causing the issue."}], "owner": {"reputation": 47, "user_id": 11599133, "user_type": "registered", "profile_image": "https://graph.facebook.com/2072161339559504/picture?type=large", "display_name": "Ben", "link": "https://stackoverflow.com/users/11599133/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1611336245, "creation_date": 1561555638, "last_edit_date": 1611336245, "question_id": 56773981, "link": "https://stackoverflow.com/questions/56773981/keeping-secondary-workbook-visible-while-interacting-with-original-workbook-user", "title": "Keeping secondary workbook visible while interacting with original workbook userform", "body": "<p>I have code which opens a secondary workbook (using a hyperlink to that workbook which is written in a cell in my original workbook). Then, a userform opens (a listbox which is populated with values from a row in the secondary workbook) along with the secondary workbook.</p>\n<p>The problem:<br />\nEvery time you click on the userform (even just to move it), the original workbook appears on top of the secondary workbook so that it's no longer visible.<br />\nFor the purpose of the macro, I need the secondary workbook and the userform to stay visible at all times until the button at the bottom is clicked.</p>\n<p>I tried many combinations of <code>.Activate</code>, <code>.Show</code>, <code>.xlMinimize</code>, <code>.xlMaximize</code>, <code>.Visible</code>, turn off screen updating, etc.<br />\nI think the problem is that the userform is an object of the original workbook so clicking it will always bring the original workbook to the front.</p>\n<p>From one module:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub findColumns_button_Click()  'finds selected shelf options, starts building table in data sheet\n    uf_TestSelector.Hide\n        \n    Dim i As Integer, j As Integer\n    Set selected_index = New Collection\n    Set hyperlinks = New Collection\n        \n    For i = 0 To descriptions.count - 1\n        If ts_listBox.Selected(i) = True Then\n            selected_index.Add i\n                \n            Dim hyplnk As Variant\n            hyplnk = ThisWorkbook.Worksheets(&quot;Test Results&quot;).Cells(i + 3, 7).Value\n            hyperlinks.Add hyplnk\n        End If\n    Next i\n        \n    ...\n        \n    Dim k As Integer\n    For k = 1 To selected_index.count   'cycles through selected options, sets 'hyperlink to be opened, shows next userform\n        ...\n        hyperlink_A = hyperlinks(k)\n        uf_ColSelectA.Show vbModeless  'shows the userform that needs to be 'interacted with\n    Next k  \n    ...\nEnd Sub\n</code></pre>\n<p>From uf_ColSelectA:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub UserForm_Activate()\n    Dim copyBook As Workbook\n    Set copyBook = Workbooks.Open(Filename:=hyperlink_A)   'copyBook = secondary workbook\n        \n    Call findListBoxValues(shelves, copyBook)\n    linkA_Lbox.MultiSelect = 1\n    linkA_Lbox.List = shelves()\n        \n    copyBook.Activate\nEnd Sub\n</code></pre>\n"}, {"tags": ["python", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11645238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38a1135121fe3e6fea7be356c5f781d?s=128&d=identicon&r=PG&f=1", "display_name": "An P", "link": "https://stackoverflow.com/users/11645238/an-p"}, "edited": false, "score": 0, "creation_date": 1561564373, "post_id": 56774036, "comment_id": 100108888, "body": "Can you go into more detail on the syntax perhaps.  If I saved the excel file to my desktop and the name is test.xlsm and the sheet I want to perform a macro in is &#39;Sheet1&#39; how would that look in the syntax?"}, {"owner": {"reputation": 181, "user_id": 7398924, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uF3-0rZE7iE/AAAAAAAAAAI/AAAAAAAARNQ/mnS_OgRO0H0/photo.jpg?sz=128", "display_name": "Nirostar", "link": "https://stackoverflow.com/users/7398924/nirostar"}, "reply_to_user": {"reputation": 21, "user_id": 11645238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38a1135121fe3e6fea7be356c5f781d?s=128&d=identicon&r=PG&f=1", "display_name": "An P", "link": "https://stackoverflow.com/users/11645238/an-p"}, "edited": false, "score": 0, "creation_date": 1561623483, "post_id": 56774036, "comment_id": 100127636, "body": "you have to set the filename instead of &quot;excelsheet.xlsm&quot; like <code>C:\\Users\\{Username}\\Desktop\\test.xlsm</code>. What do you mean by, the Macro is in Sheet1? Isn&#39;t it located in a Module?"}, {"owner": {"reputation": 181, "user_id": 7398924, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uF3-0rZE7iE/AAAAAAAAAAI/AAAAAAAARNQ/mnS_OgRO0H0/photo.jpg?sz=128", "display_name": "Nirostar", "link": "https://stackoverflow.com/users/7398924/nirostar"}, "reply_to_user": {"reputation": 21, "user_id": 11645238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38a1135121fe3e6fea7be356c5f781d?s=128&d=identicon&r=PG&f=1", "display_name": "An P", "link": "https://stackoverflow.com/users/11645238/an-p"}, "edited": false, "score": 0, "creation_date": 1561764845, "post_id": 56774036, "comment_id": 100182103, "body": "@AnP Is everything clear? Or do you have any further problems?"}], "tags": [], "owner": {"reputation": 181, "user_id": 7398924, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uF3-0rZE7iE/AAAAAAAAAAI/AAAAAAAARNQ/mnS_OgRO0H0/photo.jpg?sz=128", "display_name": "Nirostar", "link": "https://stackoverflow.com/users/7398924/nirostar"}, "is_accepted": false, "score": 0, "last_activity_date": 1561623636, "last_edit_date": 1561623636, "creation_date": 1561555783, "answer_id": 56774036, "question_id": 56773905, "link": "https://stackoverflow.com/questions/56773905/using-python-to-call-a-excel-macro/56774036#56774036", "title": "Using python to call a excel macro", "body": "<p>I found this Code on Stackoverflow. Maybe it helps you.</p>\n\n<p>Resource:\n<a href=\"https://stackoverflow.com/questions/19616205/running-an-excel-macro-via-python\">Running an Excel macro via Python?</a></p>\n\n<pre><code>import win32com.client\n\nif os.path.exists(\"excelsheet.xlsm\"):\n    xl = win32com.client.Dispatch(\"Excel.Application\")\n    wb = xl.Workbooks.Open(os.path.abspath(\"C:\\Users\\{Username}\\Desktop\\test.xlsm\"), ReadOnly=0)\n    wb.Sheets('Sheet1').Select()\n    xl.Application.Run(\"test.xlsm!Module1.macroname\")\n##    xl.Application.Save() # if you want to save then uncomment this line and change delete the \", ReadOnly=1\" part from the open function.\n    xl.Application.Quit() # Comment this out if your excel script closes\n    del xl```\n\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11645238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38a1135121fe3e6fea7be356c5f781d?s=128&d=identicon&r=PG&f=1", "display_name": "An P", "link": "https://stackoverflow.com/users/11645238/an-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561623636, "creation_date": 1561555425, "last_edit_date": 1561555480, "question_id": 56773905, "link": "https://stackoverflow.com/questions/56773905/using-python-to-call-a-excel-macro", "title": "Using python to call a excel macro", "body": "<p>I'm trying to write a python code that will run a macro in a excel workbook.  I know the file name and name of the vba macro.  I don't need to read any information into the python file I simple need to perform this function.</p>\n\n<p>I ultimately want to run this python code periodically and I want it to call the same VBA function multiple times in a day.</p>\n\n<pre><code>import openpyxl\n\n\nexcel_document = openpyxl.load_workbook('python test.xlsm')\nprint type(excel_document)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "edited": false, "score": 1, "creation_date": 1561555718, "post_id": 56773815, "comment_id": 100103444, "body": "Have a look at this answer ... <a href=\"https://stackoverflow.com/a/31845993/5040941\">stackoverflow.com/a/31845993/5040941</a>"}], "answers": [{"comments": [{"owner": {"reputation": 893, "user_id": 1169587, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/d9041a0d7dc608f6f375d51ab3120465?s=128&d=identicon&r=PG", "display_name": "user1169587", "link": "https://stackoverflow.com/users/1169587/user1169587"}, "edited": false, "score": 0, "creation_date": 1561558779, "post_id": 56773860, "comment_id": 100105465, "body": "In fact I think it should still be shown, just when user press run button, force user to assign input parameter value"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 893, "user_id": 1169587, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/d9041a0d7dc608f6f375d51ab3120465?s=128&d=identicon&r=PG", "display_name": "user1169587", "link": "https://stackoverflow.com/users/1169587/user1169587"}, "edited": false, "score": 1, "creation_date": 1561559019, "post_id": 56773860, "comment_id": 100105634, "body": "@user1169587 then remove the parameter from the procedure (so it is shown), and make the procedure ask the user for input unsing the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.inputbox\" rel=\"nofollow noreferrer\">Application.InputBox method</a>."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1561555330, "creation_date": 1561555330, "answer_id": 56773860, "question_id": 56773815, "link": "https://stackoverflow.com/questions/56773815/excel-macro-button-not-show-macro-with-parameter/56773860#56773860", "title": "Excel Macro button not show macro with parameter", "body": "<p>The macro is not shown because you have forced a parameter to be passed as part of the procedure, thus rendering the procedure unavailable to be run on a stand-alone basis.</p>\n"}], "owner": {"reputation": 893, "user_id": 1169587, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/d9041a0d7dc608f6f375d51ab3120465?s=128&d=identicon&r=PG", "display_name": "user1169587", "link": "https://stackoverflow.com/users/1169587/user1169587"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 56773860, "answer_count": 1, "score": 0, "last_activity_date": 1561555330, "creation_date": 1561555195, "last_edit_date": 1561555313, "question_id": 56773815, "link": "https://stackoverflow.com/questions/56773815/excel-macro-button-not-show-macro-with-parameter", "title": "Excel Macro button not show macro with parameter", "body": "<p>I am new to Excel macro, I try to write a testing macro named Test without parameter, and then in Excel workbook, press the macro button, the testing macro is shown as follow:</p>\n\n<p><a href=\"https://i.stack.imgur.com/T3Cud.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/T3Cud.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/oUJr1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oUJr1.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>but if I add a parameter to the macro Test as </p>\n\n<pre><code>Public Sub Test(var1 As String)\n</code></pre>\n\n<p>then when I return to the workbook, press the macro button, the Test macro is not shown, why? Is macro cannot with parameter?</p>\n\n<p><a href=\"https://i.stack.imgur.com/i6fsL.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/i6fsL.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/WYXxJ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WYXxJ.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "header"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1561555271, "post_id": 56773787, "comment_id": 100103114, "body": "<i>&quot;I need a macro&quot;</i> means you will have to write that macro. Please note that because this is no free code writing service it is necessary to show either what you have tried so far and where you got stuck or errors (by showing your code) or at least to show what you have researched and the effort you made. Otherwise it is just asking us to do all the work for you. Reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> might help you to improve your question."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9969443, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SRp7nRNqICM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0Zp0Cf3mO73suNDrtSzEnz3JPB8w/mo/photo.jpg?sz=128", "display_name": "470corner", "link": "https://stackoverflow.com/users/9969443/470corner"}, "edited": false, "score": 0, "creation_date": 1561653198, "post_id": 56773944, "comment_id": 100145241, "body": "Hi there! I really appreciate this macro you provided but it didn&#39;t work and kept getting stuck on this line: Range(Cells(6, x), Cells(n, x)) = &quot;Finance&quot;.  I think I might run into the same issue with the other vba because the issue I had was the yellow highlighted row is always changing depending on the data I receive daily. The macro has to find the words&quot; cont type&quot; first in the header row and then add the word &quot;finance&quot; below the yellow highlighted row. For today the yellow row is on row 75"}, {"owner": {"reputation": 71, "user_id": 11639881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01caa2982f2ba5cbcaea49ff22a2d622?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Data", "link": "https://stackoverflow.com/users/11639881/mr-data"}, "reply_to_user": {"reputation": 1, "user_id": 9969443, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SRp7nRNqICM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0Zp0Cf3mO73suNDrtSzEnz3JPB8w/mo/photo.jpg?sz=128", "display_name": "470corner", "link": "https://stackoverflow.com/users/9969443/470corner"}, "edited": false, "score": 0, "creation_date": 1561653963, "post_id": 56773944, "comment_id": 100145576, "body": "Right so you&#39;ll need to make the range Range(Cells(75, x)\u2026.  what error did you receive?  worked for  me when I ran it."}, {"owner": {"reputation": 1, "user_id": 9969443, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SRp7nRNqICM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0Zp0Cf3mO73suNDrtSzEnz3JPB8w/mo/photo.jpg?sz=128", "display_name": "470corner", "link": "https://stackoverflow.com/users/9969443/470corner"}, "edited": false, "score": 0, "creation_date": 1561654317, "post_id": 56773944, "comment_id": 100145714, "body": "Hi, I changed as you suggested and it gave the error &quot;Run-time error &#39;1004&#39;: Application-defined or object-defined error&quot;.  Would I always have to change the row number in the macro every time I run it?  What if tomorrow, the row is 90?"}, {"owner": {"reputation": 71, "user_id": 11639881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01caa2982f2ba5cbcaea49ff22a2d622?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Data", "link": "https://stackoverflow.com/users/11639881/mr-data"}, "reply_to_user": {"reputation": 1, "user_id": 9969443, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SRp7nRNqICM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0Zp0Cf3mO73suNDrtSzEnz3JPB8w/mo/photo.jpg?sz=128", "display_name": "470corner", "link": "https://stackoverflow.com/users/9969443/470corner"}, "edited": false, "score": 0, "creation_date": 1561656913, "post_id": 56773944, "comment_id": 100146736, "body": "you&#39;ll have to set something so it knows dynamically what row to use.  Why 90?  Why 75?  what drives that row number?  Based on that, you would set another variable (y) equal to what the row &#39;should be&#39;"}], "tags": [], "owner": {"reputation": 71, "user_id": 11639881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01caa2982f2ba5cbcaea49ff22a2d622?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Data", "link": "https://stackoverflow.com/users/11639881/mr-data"}, "is_accepted": false, "score": 0, "last_activity_date": 1561555547, "creation_date": 1561555547, "answer_id": 56773944, "question_id": 56773787, "link": "https://stackoverflow.com/questions/56773787/copy-and-paste-below-the-yellow-highlighted-row/56773944#56773944", "title": "Copy and paste below the yellow highlighted row", "body": "<p>You'll need to use a loop to do so.  So something like this:</p>\n\n<pre><code>x = 1 'the starting column to look for content type\nDo While cells(1, x) &lt;&gt; \"\" 'look in every column until your columns are empty\nIf Cells(1, x) = \"Cont Type\" Then\nRange(Cells(6, x), Cells(n, x)) = \"Finance\" 'With n equaling your last column to insert this to\nElse\nEnd If\nx = x + 1 'go to the next column to look\nLoop\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 9969443, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SRp7nRNqICM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0Zp0Cf3mO73suNDrtSzEnz3JPB8w/mo/photo.jpg?sz=128", "display_name": "470corner", "link": "https://stackoverflow.com/users/9969443/470corner"}, "edited": false, "score": 0, "creation_date": 1561651202, "post_id": 56774470, "comment_id": 100144292, "body": "Hi there!  I really appreciate this macro you provided but it didn&#39;t work because the issue I had was the yellow highlighted row is always changing depending on the data I receive daily.  The macro has to find the yellow highlighted row and put in the word &quot;Finance&quot; below it.  For today the yellow row is on row 75."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 1, "user_id": 9969443, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SRp7nRNqICM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0Zp0Cf3mO73suNDrtSzEnz3JPB8w/mo/photo.jpg?sz=128", "display_name": "470corner", "link": "https://stackoverflow.com/users/9969443/470corner"}, "edited": false, "score": 0, "creation_date": 1561651689, "post_id": 56774470, "comment_id": 100144567, "body": "The yellow row is the line after tha lastdata?"}, {"owner": {"reputation": 1, "user_id": 9969443, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SRp7nRNqICM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0Zp0Cf3mO73suNDrtSzEnz3JPB8w/mo/photo.jpg?sz=128", "display_name": "470corner", "link": "https://stackoverflow.com/users/9969443/470corner"}, "edited": false, "score": 0, "creation_date": 1561653979, "post_id": 56774470, "comment_id": 100145585, "body": "HI, the yellow row was the last row of the original data but then I added a macro to copy everything (original data) from columns A-L (minus the header) and paste in the first empty cell (column A) below the data."}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1561557098, "creation_date": 1561557098, "answer_id": 56774470, "question_id": 56773787, "link": "https://stackoverflow.com/questions/56773787/copy-and-paste-below-the-yellow-highlighted-row/56774470#56774470", "title": "Copy and paste below the yellow highlighted row", "body": "<p>Try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim LastColumn As Long, i As Long\n\n    'Change sheet name if needed\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        'Find LastColumn of row 1\n        LastColumn = .Cells(1, .Columns.Count).End(xlToLeft).Column\n\n        'Loop Cells of the first row\n        For i = 1 To LastColumn\n\n            'If cells in row 1 and column i is \"Cont Type\"\n            If .Cells(1, i).Value = \"Cont Type\" Then\n                'Import in range\n                .Range(.Cells(6, i), .Cells(9, i)).Value = \"Finance\"\n            End If\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Results:</p>\n\n<p><a href=\"https://i.stack.imgur.com/a1S6l.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/a1S6l.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 9969443, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SRp7nRNqICM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0Zp0Cf3mO73suNDrtSzEnz3JPB8w/mo/photo.jpg?sz=128", "display_name": "470corner", "link": "https://stackoverflow.com/users/9969443/470corner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1561557098, "creation_date": 1561555104, "last_edit_date": 1561557054, "question_id": 56773787, "link": "https://stackoverflow.com/questions/56773787/copy-and-paste-below-the-yellow-highlighted-row", "title": "Copy and paste below the yellow highlighted row", "body": "<p>Not sure if this is a possibility but here goes.  I'm at a standstill for this vba code.  I tried attaching a picture example - not sure if it'll show up correctly.</p>\n\n<p><em>Everything in blue font, I have created a vba code to copy it directly from the top rows down</em></p>\n\n<p>1) I need a macro that would look in all the cells in the header row 1 for \"Cont Type\" and if it finds in it any cell, then in the same column directly below the yellow highlighted row (in this case, it's row 5 but it could change because the data will be updated daily), put in the word \"Finance\" and the word \"Finance\" has to go all the way down to match the number of rows in column A.</p>\n\n<p>click on the link to see example of what I'm trying to accomplish\n<a href=\"https://i.stack.imgur.com/0HmwN.png\" rel=\"nofollow noreferrer\">Example</a></p>\n"}, {"tags": ["sql", "vba", "ms-access", "dlookup"], "comments": [{"owner": {"reputation": 274, "user_id": 3757755, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000520518503/picture?type=large", "display_name": "Antonio Veneroso Contreras", "link": "https://stackoverflow.com/users/3757755/antonio-veneroso-contreras"}, "edited": false, "score": 0, "creation_date": 1561555335, "post_id": 56773694, "comment_id": 100103168, "body": "You are assigning your string to txtbox, that&#39;s why you see it there. You need to execute your statement and assign that result to the txtbox."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1561948671, "post_id": 56773694, "comment_id": 100211282, "body": "Are you searching for existing record or are you creating a new record? If this is search for existing then either apply filter criteria or go to record. If this is a new record, select name in a multi-column combobox then expressions in textboxes reference columns of combobox. No VBA, no DLookup for the latter."}], "answers": [{"comments": [{"owner": {"reputation": 994, "user_id": 1285450, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/f6c9b3206b191569185d0389db3cc266?s=128&d=identicon&r=PG", "display_name": "cjb110", "link": "https://stackoverflow.com/users/1285450/cjb110"}, "edited": false, "score": 1, "creation_date": 1561555897, "post_id": 56773998, "comment_id": 100103549, "body": "That is the basics, but you might get more than one result, esp with undefined search like the one in the question, so should ideally check that."}, {"owner": {"reputation": 587, "user_id": 11481315, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rZK97.png?s=128&g=1", "display_name": "viilpe", "link": "https://stackoverflow.com/users/11481315/viilpe"}, "edited": false, "score": 1, "creation_date": 1561558373, "post_id": 56773998, "comment_id": 100105166, "body": "How about rs.Close and Set rs = Nothing? And It is better to check rs.Recordcount because if there is no records returned you will get an error in &quot;rs(0)&quot;"}, {"owner": {"reputation": 166, "user_id": 11348379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e157387f24dcebef764066025520d0?s=128&d=identicon&r=PG&f=1", "display_name": "SomeNerdAtWork", "link": "https://stackoverflow.com/users/11348379/somenerdatwork"}, "edited": false, "score": 0, "creation_date": 1561558522, "post_id": 56773998, "comment_id": 100105284, "body": "These are both good points, however not asked in the question so I didn&#39;t mention them. Also much like the question, I&#39;m entirely positive that this information is widely available with a 5 second search."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1561581798, "post_id": 56773998, "comment_id": 100116220, "body": "A simple check for<code>Not rs.EOF</code>is sufficent as if there is at least one record if true after opening the rs. Or use<code>on Error Resume Next</code>in front of<code>rs(0)</code>and handle no resuilt, by checking <code>Err.Nr</code>&lt;&gt; 0."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1561582138, "post_id": 56773998, "comment_id": 100116353, "body": "And use parameters like in <a href=\"https://stackoverflow.com/a/56667682/9439330\">stackoverflow.com/a/56667682/9439330</a> (e.g try a double-quote in SearchInput to raise an error). ALso eacj line of sql string should start or end with a blank (try MsgBox SQL)!"}], "tags": [], "owner": {"reputation": 166, "user_id": 11348379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e157387f24dcebef764066025520d0?s=128&d=identicon&r=PG&f=1", "display_name": "SomeNerdAtWork", "link": "https://stackoverflow.com/users/11348379/somenerdatwork"}, "is_accepted": true, "score": 0, "last_activity_date": 1561948276, "last_edit_date": 1561948276, "creation_date": 1561555666, "answer_id": 56773998, "question_id": 56773694, "link": "https://stackoverflow.com/questions/56773694/outputting-the-result-of-an-sql-query-into-a-text-box/56773998#56773998", "title": "Outputting the result of an SQL query into a text box", "body": "<p>I'm pretty sure this is a duplicate, but it's faster to answer than hunt for the other posts.</p>\n\n<p>You need to declare a recordset and assign the data returned from the select statement to it. This will leave you with something very similar to an array. After that you need to just line up the array element to the positions of the columns. IE. rs(0)=name in the select statement above.</p>\n\n<pre><code>Dim rs As Recordset\nDim SQL As String, SearchInput As String\nSQL = \"SELECT name \" &amp; _\n  \"FROM tablename INNER JOIN othertablename ON tablename.name = othertablename.name \" &amp; _\n  \"WHERE tablename.name LIKE \"\"*\" &amp; SearchInput &amp; \"*\"\"\n   Set rs = CurrentDb.OpenRecordset(strSQL, dbOpenSnapshot)\n\nMe.txtBox = rs(0)\n</code></pre>\n\n<p>That should work.</p>\n"}, {"tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 0, "last_activity_date": 1561570701, "creation_date": 1561570701, "answer_id": 56778359, "question_id": 56773694, "link": "https://stackoverflow.com/questions/56773694/outputting-the-result-of-an-sql-query-into-a-text-box/56778359#56778359", "title": "Outputting the result of an SQL query into a text box", "body": "<p>Since you are new to MS Access &amp; VBA in general, I'll propose a solution which avoids VBA entirely.</p>\n\n<hr>\n\n<p>In your current code, I assume that <code>SearchInput</code> is sourcing its value from another control on your form.</p>\n\n<p>I would suggest creating a new saved query (called it <code>MyQuery</code>) with the following SQL:</p>\n\n<pre><code>select table2.name from table1 inner join table2 on table1.name = table2.name\n</code></pre>\n\n<p>Then, in the Control Source for your textbox, use a <code>DLookup</code> expression with the following arguments:</p>\n\n<pre><code>=dlookup(\"[name]\", \"MyQuery\", \"table1.name like '*\" &amp; [SearchInput] &amp; \"*'\")\n</code></pre>\n\n<p>Here, <code>[SearchInput]</code> refers to the name of the control on your form containing the search criteria.</p>\n"}], "owner": {"reputation": 7, "user_id": 9317139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NFxxC.jpg?s=128&g=1", "display_name": "Moneyhun", "link": "https://stackoverflow.com/users/9317139/moneyhun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 56773998, "answer_count": 2, "score": 0, "last_activity_date": 1561948276, "creation_date": 1561554859, "last_edit_date": 1561555130, "question_id": 56773694, "link": "https://stackoverflow.com/questions/56773694/outputting-the-result-of-an-sql-query-into-a-text-box", "title": "Outputting the result of an SQL query into a text box", "body": "<p>I'm creating a form that displays information about an individual that is taken from two tables when a name is entered by the user. I want the fields to be output into they're own text boxes. My code looks similar to what's below.</p>\n\n<p>When I run the code it displays the literal query \"SELECT name etc...\" in the textbox.  I saw Dlookup works for textboxes but to my understanding it doesn't work well with more than one table. Any advice would be greatly appreciated!</p>\n\n<p>PS I'm a VBA/access newbie</p>\n\n<pre><code>Dim SQL, SearchInput As String\n\nSQL = \"SELECT name\" &amp; _\n      \"FROM tablename INNER JOIN othertablename ON tablename.name = othertablename.name\" &amp; _\n      \"WHERE  tablename.name LIKE \"\"*\" &amp; SearchInput &amp; \"*\"\"\n\nMe.txtbox = SQL\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 11669731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda1ade6332a0e11d7b63e96f11ee4e7?s=128&d=identicon&r=PG&f=1", "display_name": "YaraK", "link": "https://stackoverflow.com/users/11669731/yarak"}, "edited": false, "score": 0, "creation_date": 1561556114, "post_id": 56773682, "comment_id": 100103694, "body": "I have added this however it is giving me a type 91 error  ``` VaRcomp = wb.Worksheets(&quot;VaR Comparison&quot;)  rng1 = VaRcomp.Range(&quot;P11:AA11&quot;)  rng2 = VaRcomp.Range(&quot;J16:J1000&quot;)  sheet.Cells(index, dateColumn + 5).Value = Application.WorksheetFunction.Min(rng1) sheet.Cells(index, dateColumn + 6).Value = Application.WorksheetFunction.Max(rng2) ```"}, {"owner": {"reputation": 47, "user_id": 11669731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda1ade6332a0e11d7b63e96f11ee4e7?s=128&d=identicon&r=PG&f=1", "display_name": "YaraK", "link": "https://stackoverflow.com/users/11669731/yarak"}, "edited": false, "score": 0, "creation_date": 1561556207, "post_id": 56773682, "comment_id": 100103754, "body": "at this line VaRcomp = wb.Worksheets(&quot;VaR Comparison&quot;)"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 47, "user_id": 11669731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda1ade6332a0e11d7b63e96f11ee4e7?s=128&d=identicon&r=PG&f=1", "display_name": "YaraK", "link": "https://stackoverflow.com/users/11669731/yarak"}, "edited": false, "score": 0, "creation_date": 1561556434, "post_id": 56773682, "comment_id": 100103893, "body": "Create a new module, paste my code, change the names of <code>wb</code> &amp; <code>ws</code> and tell me if you get the same error"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 1, "last_activity_date": 1561554834, "creation_date": 1561554834, "answer_id": 56773682, "question_id": 56773429, "link": "https://stackoverflow.com/questions/56773429/how-to-find-the-maximum-and-minimum-value-of-ranges-that-are-in-another-workbook/56773682#56773682", "title": "How to find the maximum and minimum value of ranges that are in another workbook?", "body": "<p>Modify &amp; Try:</p>\n\n<pre><code> Sub test()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim rng As Range\n\n    Dim Max As Double, Min As Double\n\n    'Set the workbook\n    Set wb = Workbooks(\"Book1\")\n    'Set the worksheet\n    Set ws = wb.Worksheets(\"Sheet1\")\n    'Set range\n    Set rng = ws.Range(\"A1:A10\")\n\n    Max = Application.WorksheetFunction.Max(rng)\n    Debug.Print Max\n    Min = Application.WorksheetFunction.Min(rng)\n    Debug.Print Min\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 7606364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0110b20be705b6c95737730acdea88a?s=128&d=identicon&r=PG&f=1", "display_name": "FriedEgg", "link": "https://stackoverflow.com/users/7606364/friedegg"}, "is_accepted": false, "score": 0, "last_activity_date": 1561558321, "creation_date": 1561558321, "answer_id": 56774875, "question_id": 56773429, "link": "https://stackoverflow.com/questions/56773429/how-to-find-the-maximum-and-minimum-value-of-ranges-that-are-in-another-workbook/56774875#56774875", "title": "How to find the maximum and minimum value of ranges that are in another workbook?", "body": "<p>One of the answers was very good.</p>\n\n<p>If you're looking to just add a few lines to yours you can try for the minimum:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=MIN(R[1]C[-9]:R[37]C[-2])\"\nRange(\"CELL YOU WANT IT IN\").Select\n</code></pre>\n\n<p>And for max:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=MAX(R[1]C[-11]:R[37]C[-4])\"\nRange(\"CELL YOU WANT IT IN\").Select\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 11669731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda1ade6332a0e11d7b63e96f11ee4e7?s=128&d=identicon&r=PG&f=1", "display_name": "YaraK", "link": "https://stackoverflow.com/users/11669731/yarak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1561559651, "creation_date": 1561554002, "last_edit_date": 1561559651, "question_id": 56773429, "link": "https://stackoverflow.com/questions/56773429/how-to-find-the-maximum-and-minimum-value-of-ranges-that-are-in-another-workbook", "title": "How to find the maximum and minimum value of ranges that are in another workbook?", "body": "<p>I have created VBA code that automatically copies data from other workbooks, based on a certain date and portfolio, to the active sheet.</p>\n\n<p>I have successfully copied all the information I need, however, I am missing 2 parts.</p>\n\n<p>I want to find the minimum value in a certain range in the other workbook (that I open using the <code>For</code> loop) and copy it to my active sheet.\nSame goes for the maximum of another range in the opened workbook.</p>\n\n<p>Following is the code I have so far. Somehow the </p>\n\n<pre><code>Application.Max(Workbooks(portfolioName).Worksheets(\"VaR Comparison\").Range(\"J16:J1000\")) \n</code></pre>\n\n<p>functions are simply returning a value of zero.</p>\n\n<pre><code>Option Explicit\n\nFunction MatchHeader(strSearch As String) As Long\nDim myRight As Long, Colcount As Long\n\nmyRight = ActiveSheet.Cells(1, ActiveSheet.Columns.Count).End(xlToLeft).Column\n\nFor Colcount = 1 To myRight \n    If ActiveSheet.Cells(1, Colcount) = strSearch Then\n        MatchHeader = Colcount\n        Exit For          \n    End If\nNext Colcount\nEnd Function\n\nSub StressTest()\n\nDim index As Integer\nDim dateColumn As Integer\nDim portfolioDate As String\nDim portfolioName As Variant\nDim ParametricVar As Double\nDim AuM As Double\nDim PreviousVar As Double\nDim PreviousAuM As Double\n\nDim strPath As String\nDim strFilePath As String\nDim wb As Workbook\nDim sheet As Worksheet\n\nSet wb = ThisWorkbook\nSet sheet = ActiveSheet\n\nportfolioDate = InputBox(\"Please enter date under the following form : YYYY-MM\", \"Date at the time of Stress Test\", \"Type Here\")\nDebug.Print \"InputBox provided value is: \" &amp; portfolioDate\n\nFor index = 26 To Cells(Rows.Count, \"B\").End(xlUp).Row    \n  dateColumn = MatchHeader(portfolioDate)\n  portfolioName = ActiveSheet.Range(\"B\" &amp; index &amp; \"\").Value\n\n  strPath = \"G:\\Risk\\Risk Reports\\VaR-Stress test\\\" &amp; portfolioDate &amp; \"\\\" &amp; portfolioName &amp; \"\"\n\n  Set wb = Workbooks.Open(strPath)\n\n  ParametricVar = Workbooks(portfolioName).Worksheets(\"VaR Comparison\").Range(\"B19\")\n  AuM = Workbooks(portfolioName).Worksheets(\"Holdings - Main View\").Range(\"E11\")\n  PreviousVar = sheet.Cells(index, dateColumn + 7).Value\n  PreviousAuM = sheet.Cells(index, dateColumn + 9).Value\n\n  sheet.Cells(index, dateColumn).Value = ParametricVar / AuM\n  sheet.Cells(index, dateColumn + 2).Value = AuM\n  sheet.Cells(index, dateColumn + 1).Value = (ParametricVar - PreviousVar) / PreviousVar\n  sheet.Cells(index, dateColumn + 3).Value = (AuM - PreviousAuM) / PreviousAuM\n\n  sheet.Cells(index, dateColumn + 5).Value = Application.Min(Workbooks(portfolioName).Worksheets(\"VaR Comparison\").Range(\"P11:AA11\"))\n  sheet.Cells(index, dateColumn + 6).Value = Application.Max(Workbooks(portfolioName).Worksheets(\"VaR Comparison\").Range(\"J16:J1000\"))\n\n  wb.Close Savechanges:=False\n\nNext index\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1561552972, "post_id": 56773005, "comment_id": 100101689, "body": "Check &quot;File Block Settings&quot; in the Trust Center. See <a href=\"https://docs.microsoft.com/en-us/office/troubleshoot/settings/file-blocked-in-office\" rel=\"nofollow noreferrer\">Error message in Office when a file is blocked by registry policy settings</a>"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1561553021, "post_id": 56773005, "comment_id": 100101720, "body": "Did you yourself choose those settings that make your computer open to every last bit of Office malware, or did you <i>end up</i> with them?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1561553061, "post_id": 56773005, "comment_id": 100101743, "body": "Possible duplicate of: <a href=\"https://stackoverflow.com/questions/25777899/run-time-error-upon-opening-excel-file\">Run-time error upon opening excel file</a>"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1561553326, "post_id": 56773005, "comment_id": 100101913, "body": "@GSerg reminds me of another SO member who mentioned those settings were the company&#39;s policy... I think management <i>wanted</i> their systems hijacked and plundered"}, {"owner": {"reputation": 1, "user_id": 9329514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa97e5db3c1cc56ef317dc5e537c0602?s=128&d=identicon&r=PG&f=1", "display_name": "Kai", "link": "https://stackoverflow.com/users/9329514/kai"}, "edited": false, "score": 0, "creation_date": 1561553370, "post_id": 56773005, "comment_id": 100101938, "body": "Apparently it works with this code,  Application.ProtectedViewWindows.Open Filename:=Directory1 Application.ActiveProtectedViewWindow.Edit  ,but it&#39;s slower"}, {"owner": {"reputation": 1, "user_id": 9329514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa97e5db3c1cc56ef317dc5e537c0602?s=128&d=identicon&r=PG&f=1", "display_name": "Kai", "link": "https://stackoverflow.com/users/9329514/kai"}, "edited": false, "score": 0, "creation_date": 1561553528, "post_id": 56773005, "comment_id": 100102031, "body": "I chose the setting myself"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1561553604, "post_id": 56773005, "comment_id": 100102076, "body": "<i>&quot;I chose the setting myself&quot;</i> Worst idea, highly recommended to go back (at least) to default settings. \u2022 Didn&#39;t you see the <i>&quot;Not recommended, dangerous&quot;</i> warning behind the macro setting? \u2022 Which filetype is <code>Directory1</code>? and what are your  &quot;File Block Settings&quot; in the Trust Center?"}, {"owner": {"reputation": 1, "user_id": 9329514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa97e5db3c1cc56ef317dc5e537c0602?s=128&d=identicon&r=PG&f=1", "display_name": "Kai", "link": "https://stackoverflow.com/users/9329514/kai"}, "edited": false, "score": 0, "creation_date": 1561553869, "post_id": 56773005, "comment_id": 100102240, "body": "thank you guys. I just had to unticked some options in &quot;File Block Settings&quot;. I have changed back to the default setting."}], "owner": {"reputation": 1, "user_id": 9329514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa97e5db3c1cc56ef317dc5e537c0602?s=128&d=identicon&r=PG&f=1", "display_name": "Kai", "link": "https://stackoverflow.com/users/9329514/kai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1326, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561552950, "creation_date": 1561552577, "last_edit_date": 1561552950, "question_id": 56773005, "link": "https://stackoverflow.com/questions/56773005/vba-run-time-error-2147021892-80070bbc", "title": "VBA Run-time error &#39;-2147021892 (80070bbc)&#39;", "body": "<p>When I try to run my VBA</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Workbooks.Open Directory1\n</code></pre>\n\n<p>Excel gives me the following error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ykP9L.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ykP9L.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have these settings in Excel:</p>\n\n<p><a href=\"https://i.stack.imgur.com/rXTj4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rXTj4.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/LcTGn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LcTGn.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "performance", "loops", "replace"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 3, "creation_date": 1561553523, "post_id": 56772914, "comment_id": 100102030, "body": "Bring your block of data into an internal VBA array.  Then loop on the array."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1561553690, "post_id": 56772914, "comment_id": 100102121, "body": "Create &amp; loop an array then modify array dimensions position to meet sheet address in order to format correctly."}, {"owner": {"reputation": 73, "user_id": 11703150, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Cv0jPgDp2DY/AAAAAAAAAAI/AAAAAAAAADw/yeUQa5ZqoEE/photo.jpg?sz=128", "display_name": "Jason Torpy", "link": "https://stackoverflow.com/users/11703150/jason-torpy"}, "edited": false, "score": 0, "creation_date": 1561556673, "post_id": 56772914, "comment_id": 100104038, "body": "The array should be faster. thanks. got any more details on how to do that efficiently?"}], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 3, "creation_date": 1561553243, "post_id": 56773115, "comment_id": 100101867, "body": "<i>&quot;A for loop is obvious, and I&#39;m open to that, but I&#39;m looking for a speed improvement. &quot;</i>"}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1561553673, "post_id": 56773115, "comment_id": 100102107, "body": "@GSerg Updated answer with slight improvement :)"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 1, "creation_date": 1561553822, "post_id": 56773115, "comment_id": 100102203, "body": "@Micha\u0142Turczyn in my opinion no need to loop. just use <code>.UsedRange</code>. Moreover <code>col = 1 To 6</code> is wrong. it should be <code>col = 1 To 60</code>"}, {"owner": {"reputation": 73, "user_id": 11703150, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Cv0jPgDp2DY/AAAAAAAAAAI/AAAAAAAAADw/yeUQa5ZqoEE/photo.jpg?sz=128", "display_name": "Jason Torpy", "link": "https://stackoverflow.com/users/11703150/jason-torpy"}, "edited": false, "score": 0, "creation_date": 1561556709, "post_id": 56773115, "comment_id": 100104067, "body": "I can do a loop for sure. Any thoughts on Replace with an inequality?"}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1561554855, "last_edit_date": 1561554855, "creation_date": 1561552941, "answer_id": 56773115, "question_id": 56772914, "link": "https://stackoverflow.com/questions/56772914/vba-replace-using-inequality/56773115#56773115", "title": "VBA Replace using inequality", "body": "<p>Try:</p>\n\n<pre><code>Sub Highlight()\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    Dim row As Long, col As Long, ws As Variant\n    For Each ws In Worksheets\n    For row = 1 To 3000\n    For col = 1 To 60\n        If ws.Cells(row, col).Value &gt; 5 Then ws.Cells(row, col).Interior.ColorIndex = 4 'light green\n    Next\n    Next\n    Next\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 11703150, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Cv0jPgDp2DY/AAAAAAAAAAI/AAAAAAAAADw/yeUQa5ZqoEE/photo.jpg?sz=128", "display_name": "Jason Torpy", "link": "https://stackoverflow.com/users/11703150/jason-torpy"}, "edited": false, "score": 0, "creation_date": 1561563980, "post_id": 56774514, "comment_id": 100108689, "body": "This is promising. Thanks so much. I am getting an improper result if no values in a column match. In that case, the whole column becomes yellow. I put a conditional on the yellow highlighting. Let me know if you think of any other simplification. Thanks  <code>If .SpecialCells(xlCellTypeVisible).Cells.Count &gt; 1 Then</code>"}, {"owner": {"reputation": 73, "user_id": 11703150, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Cv0jPgDp2DY/AAAAAAAAAAI/AAAAAAAAADw/yeUQa5ZqoEE/photo.jpg?sz=128", "display_name": "Jason Torpy", "link": "https://stackoverflow.com/users/11703150/jason-torpy"}, "edited": false, "score": 1, "creation_date": 1561581084, "post_id": 56774514, "comment_id": 100115945, "body": "This is working really well. marked correct. I thought autofilter would operate more slowly, but it&#39;s doing a lot of good. Thanks for the idea."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 73, "user_id": 11703150, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Cv0jPgDp2DY/AAAAAAAAAAI/AAAAAAAAADw/yeUQa5ZqoEE/photo.jpg?sz=128", "display_name": "Jason Torpy", "link": "https://stackoverflow.com/users/11703150/jason-torpy"}, "edited": false, "score": 1, "creation_date": 1561582574, "post_id": 56774514, "comment_id": 100116536, "body": "@jasontoroy, glad it helped you out :). Surprised how fast this routine can be indeed. Did you do a timecomparison by any chance?"}, {"owner": {"reputation": 73, "user_id": 11703150, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Cv0jPgDp2DY/AAAAAAAAAAI/AAAAAAAAADw/yeUQa5ZqoEE/photo.jpg?sz=128", "display_name": "Jason Torpy", "link": "https://stackoverflow.com/users/11703150/jason-torpy"}, "edited": false, "score": 0, "creation_date": 1584623550, "post_id": 56774514, "comment_id": 107497102, "body": "yes and no. I actually added a timer for everything. it runs in 30sec or so but up to 2min depending on input size and error quantity. source data is a changing collection of 1-6 imported csv files. Anyway, it&#39;s pretty fast with the autofilter (and running only when necessary)"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 4, "last_activity_date": 1561557668, "last_edit_date": 1561557668, "creation_date": 1561557228, "answer_id": 56774514, "question_id": 56772914, "link": "https://stackoverflow.com/questions/56772914/vba-replace-using-inequality/56774514#56774514", "title": "VBA Replace using inequality", "body": "<p>Maybe this is an interesting approuch?</p>\n\n<pre><code>Sub Highlight()\n\nDim WS As Worksheet\n\nFor Each WS In ThisWorkbook.Worksheets\n    For X = 1 To 60\n        On Error Resume Next\n        With Intersect(WS.UsedRange, WS.Columns(X))\n            .AutoFilter 1, \"&gt;5\"\n            .Offset(1).Resize(.Rows.Count - 1).Interior.Color = vbYellow\n            .AutoFilter\n        End With\n        On Error GoTo 0\n    Next X\nNext WS\n\nEnd Sub\n</code></pre>\n\n<p>Obviously there is plenty of room for improvement (turn of screenupdating and calculation for example) but you should get the idea. I have no clue if it is faster :). At least you won't be looping all cells.</p>\n\n<p><a href=\"https://i.stack.imgur.com/FeH2B.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FeH2B.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/MyTMM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MyTMM.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 73, "user_id": 11703150, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Cv0jPgDp2DY/AAAAAAAAAAI/AAAAAAAAADw/yeUQa5ZqoEE/photo.jpg?sz=128", "display_name": "Jason Torpy", "link": "https://stackoverflow.com/users/11703150/jason-torpy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 1, "accepted_answer_id": 56774514, "answer_count": 2, "score": 4, "last_activity_date": 1561557668, "creation_date": 1561552326, "last_edit_date": 1561553080, "question_id": 56772914, "link": "https://stackoverflow.com/questions/56772914/vba-replace-using-inequality", "title": "VBA Replace using inequality", "body": "<p>I have a frequent data process for a client that has to be Excel VBA. It's 3000x60 grid of cells on 6 tabs, so it can take a while to loop. The test task is to find values <code>&gt;5</code> and highlight them.</p>\n\n<p>Conditional formatting is not an option for various reasons.</p>\n\n<p>A for loop is obvious, and I'm open to that, but I'm looking for a speed improvement. </p>\n\n<p>Replace seems faster. I want to try Selection.Replace What:=\">5\" but that looks for the string not the inequality I really want.</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 2, "creation_date": 1561553332, "post_id": 56773067, "comment_id": 100101914, "body": "Why would you want to activate it? Just get <code>Rng1.Row</code>."}], "tags": [], "owner": {"reputation": 1668, "user_id": 2990703, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/oQCIc.jpg?s=128&g=1", "display_name": "Ashok", "link": "https://stackoverflow.com/users/2990703/ashok"}, "is_accepted": false, "score": 0, "last_activity_date": 1561553445, "last_edit_date": 1561553445, "creation_date": 1561552774, "answer_id": 56773067, "question_id": 56772897, "link": "https://stackoverflow.com/questions/56772897/how-to-get-the-value-of-the-row-number-in-which-the-value-is-found-in-this-code/56773067#56773067", "title": "How to get the value of the row number in which the value is found in this code?", "body": "<p>Activate the <code>Rng1</code> and then get active cell row like below.</p>\n\n<pre><code>With wsSource.Range(\"A:A\") 'searches all of column A\n      Set Rng1 = .Find(What:=FindString, _\n      After:=.Cells(.Cells.Count), _\n      LookIn:=xlValues, _\n      LookAt:=xlWhole, _\n      SearchOrder:=xlByRows, _\n      SearchDirection:=xlNext, _\n      MatchCase:=False)\n      If Not Rng1 Is Nothing Then\n           'Your code\n           Rng1.Activate\n           'Get Row number\n           MsgBox ActiveCell.Row\n           'Get Row value\n           MsgBox ActiveCell.Value\n      Else\n           MsgBox \"Nothing found\" 'value not found\n      End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561553445, "creation_date": 1561552267, "question_id": 56772897, "link": "https://stackoverflow.com/questions/56772897/how-to-get-the-value-of-the-row-number-in-which-the-value-is-found-in-this-code", "title": "How to get the value of the row number in which the value is found in this code?", "body": "<p>How do I get the range or the row number in which the value is found in the following code?\nIn the If section, I want the row number instead of going to the value like here in this piece of code</p>\n\n<pre><code>With wsSource.Range(\"A:A\") 'searches all of column A\n      Set Rng1 = .Find(What:=FindString, _\n      After:=.Cells(.Cells.Count), _\n      LookIn:=xlValues, _\n      LookAt:=xlWhole, _\n      SearchOrder:=xlByRows, _\n      SearchDirection:=xlNext, _\n      MatchCase:=False)\n      If Not Rng1 Is Nothing Then\n           Application.Goto Rng1, True 'value found\n      Else\n           MsgBox \"Nothing found\" 'value not found\n      End If\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 2, "creation_date": 1561551865, "post_id": 56772680, "comment_id": 100100913, "body": "Why have you chosen to make some if your variables <code>Integer</code> rather than <code>Long</code> ??"}, {"owner": {"reputation": 13, "user_id": 10738998, "user_type": "registered", "profile_image": "https://graph.facebook.com/2088443494547813/picture?type=large", "display_name": "Mazilu Isabela Elena", "link": "https://stackoverflow.com/users/10738998/mazilu-isabela-elena"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1561552047, "post_id": 56772680, "comment_id": 100101043, "body": "I am new in this area and I don&#39;t know which is better to use."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1561552199, "post_id": 56772680, "comment_id": 100101147, "body": "@MaziluIsabelaElena Row counting variabes have to be <code>Long</code> because Excel has more rows than fit into <code>Integer</code>. In general there is no benefit of using <code>Integer</code> in VBA."}, {"owner": {"reputation": 13, "user_id": 10738998, "user_type": "registered", "profile_image": "https://graph.facebook.com/2088443494547813/picture?type=large", "display_name": "Mazilu Isabela Elena", "link": "https://stackoverflow.com/users/10738998/mazilu-isabela-elena"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1561552478, "post_id": 56772680, "comment_id": 100101339, "body": "@Gary&#39;sStudent, I put Long instead of Integer, but nothing changed."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1561553742, "post_id": 56772680, "comment_id": 100102161, "body": "@P\u1d07\u029c Doesn&#39;t current VBA automatically convert <code>Integer</code> (2-byte) to <code>Long</code> (4-byte), while maintaining the range limit of the dimensioned variable ( -33k ~ +33k) ?  That would make it inherently bad to use <code>Integer</code> in this day and age, no?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1561553883, "post_id": 56772680, "comment_id": 100102247, "body": "@Cyril Yes, it does. See <a href=\"https://stackoverflow.com/questions/26409117/why-use-integer-instead-of-long/26409520#26409520\">Why Use Integer Instead of Long?</a>"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1561554627, "post_id": 56772680, "comment_id": 100102682, "body": "@P\u1d07\u029c <i>purely tangential comment/question in reflection of that post</i> (also thanks for posting that, I thought I had read that elsewhere, but apparently it was on SO)... the use of <code>Variant</code> versus <code>Long</code> might be the question when it comes to dimensioning?  I believe <code>Variant</code> will dimension as 12-byte, so if you&#39;re not simply looping through the rows/columns in Excel, where <code>Long</code> is appropriate, e.g., summing/multiplying values within a loop, then <code>Dim i as Variant</code> would be an appropriate approach, yes?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1561554945, "post_id": 56772680, "comment_id": 100102908, "body": "@Cyril Actually <code>Variant</code> is the worst type you can choose (only use it if you cannot be more explicit). It is always better no find the type that is more explicit to your data. <i>&quot;Generally, numeric Variant data is maintained in its original data type within the Variant. For example, if you assign an Integer to a Variant, subsequent operations treat the Variant as an Integer.&quot;</i> That means a Variant can be Variant/Integer or Variant/Long etc."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1561625557, "post_id": 56772680, "comment_id": 100128892, "body": "Where are you defining <code>JResult</code>?  You defined <code>lastrow</code>, <code>I</code>, <code>icount</code>, <code>j</code>, <code>jcount</code> and <code>LResult</code> - make sure that <i>every</i> module has <code>Option Explicit</code> at the top.  Tools &gt; Options &gt; Require Variable Declaration will do that automatically for you.  If you step through manually line-by-line with F8, at which point does it do something different to what you want?  Put a Break Point on <code>icount = icount + 1</code> to see if that <code>IF</code> statement is ever <code>True</code>"}], "answers": [{"comments": [{"owner": {"reputation": 48, "user_id": 10685860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d10ef2ab0f6dfa921e7d9564904e1c76?s=128&d=identicon&r=PG&f=1", "display_name": "DMcLaren", "link": "https://stackoverflow.com/users/10685860/dmclaren"}, "reply_to_user": {"reputation": 13, "user_id": 10738998, "user_type": "registered", "profile_image": "https://graph.facebook.com/2088443494547813/picture?type=large", "display_name": "Mazilu Isabela Elena", "link": "https://stackoverflow.com/users/10738998/mazilu-isabela-elena"}, "edited": false, "score": 0, "creation_date": 1561630875, "post_id": 56773272, "comment_id": 100132014, "body": "@MaziluIsabelaElena Chronocidal&#39;s comment on your question would be the next thing I would try. If your criteria in your IF statement are never met then you won&#39;t find any results."}], "tags": [], "owner": {"reputation": 48, "user_id": 10685860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d10ef2ab0f6dfa921e7d9564904e1c76?s=128&d=identicon&r=PG&f=1", "display_name": "DMcLaren", "link": "https://stackoverflow.com/users/10685860/dmclaren"}, "is_accepted": false, "score": 0, "last_activity_date": 1561553454, "creation_date": 1561553454, "answer_id": 56773272, "question_id": 56772680, "link": "https://stackoverflow.com/questions/56772680/instr-function-with-two-conditions/56773272#56773272", "title": "Instr function with two conditions", "body": "<p>I think your problem is here: </p>\n\n<pre><code>LResult = Sheets(\"Sheet2\").Range(\"A1\")\nLResult = Left(LResult, 4)\nJResult = Sheets(\"Sheet2\").Range(\"A2\")\nJResult = Left(LResult, 2)\n</code></pre>\n\n<p>should that last line not be <code>JResult = Left(JResult, 2)</code> ?</p>\n\n<p>the way it works at the moment, it will overwrite the value you assign from sheet2 cell A2, with the left most 2 characters in sheet2 cell A1. If this value then doesnt appear in column AA, then the criteria in your if statement will never evaluate as true.</p>\n"}], "owner": {"reputation": 13, "user_id": 10738998, "user_type": "registered", "profile_image": "https://graph.facebook.com/2088443494547813/picture?type=large", "display_name": "Mazilu Isabela Elena", "link": "https://stackoverflow.com/users/10738998/mazilu-isabela-elena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561628941, "creation_date": 1561551597, "last_edit_date": 1561628941, "question_id": 56772680, "link": "https://stackoverflow.com/questions/56772680/instr-function-with-two-conditions", "title": "Instr function with two conditions", "body": "<p>I have a string in the cell \"A1\" and another string in the cell \"A2\" of Sheet2   which I take them using the LEFT Function. These are changing at every import. I'm trying to find the first string in the column \"AP\" and the second string in the column \"AA\" of Sheet1 and sort the sheet by these values. Then I want to copy the entire Sheet1 and paste it in Sheet2. My code gives me nothing. Why is wrong?</p>\n\n<pre><code>Sub rc1()\n    Dim lastrow As Long\n    Dim i As Integer, icount As Integer\n    Dim j As Integer, jcount As Integer\n    Dim LResult As String\n\n    LResult = Sheets(\"Sheet2\").Range(\"A1\")\n    LResult = Left(LResult, 4)\n    JResult = Sheets(\"Sheet2\").Range(\"A2\")\n    JResult = Left(JResult, 2)\n\n    lastrow = Sheets(\"Sheet1\").Range(\"A30000\").End(xlUp).Row\n\n    Sheets(\"Sheet2\").Activate\n    Sheets(\"Sheet2\").Range(\"B2:AQ\" &amp; lastrow).Select\n    Selection.ClearContents\n\n    icount = 1\n    For i = 2 To lastrow\n        For j = 2 To lastrow\n            If InStr(1, LCase(Sheets(\"Sheet1\").Range(\"AP\" &amp; i)), LCase(LResult)) &lt;&gt; 0 And InStr(1, LCase(Sheets(\"Sheet1\").Range(\"AA\" &amp; j)), LCase(JResult)) &lt;&gt; 0 Then\n                icount = icount + 1\n                Sheets(\"Sheet2\").Range(\"B\" &amp; icount &amp; \":AQ\" &amp; icount) = Sheets(\"Sheet1\").Range(\"A\" &amp; i &amp; \":AP\" &amp; i).Value\n            End If\n        Next j\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "edited": false, "score": 2, "creation_date": 1561551687, "post_id": 56772618, "comment_id": 100100802, "body": "What have you tried?  Look into the Replace function, your example also calls for the use of Trim"}, {"owner": {"reputation": 223, "user_id": 7250187, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cc66c5bfbabeb30dfb2b17739a5cd4fa?s=128&d=identicon&r=PG&f=1", "display_name": "jhovyn", "link": "https://stackoverflow.com/users/7250187/jhovyn"}, "reply_to_user": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "edited": false, "score": 0, "creation_date": 1561552270, "post_id": 56772618, "comment_id": 100101201, "body": "Hi Sir. I already used the Replace function but all the negative sign was removed. i only need to remove the negative sign from the first character. Example -ABC-xyz the output should be ABC-xyz"}], "answers": [{"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1561552950, "post_id": 56773040, "comment_id": 100101672, "body": "This appears to remove the first character after the dash as well."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1561553126, "post_id": 56773040, "comment_id": 100101789, "body": "@Gary&#39;sStudent as i can see from the picture upload by OP, there is a space between negative sign and the first letter. that why i modify the code to delete also the space"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1561553290, "post_id": 56773040, "comment_id": 100101894, "body": "That&#39;s not how it looks like in his latest comment though :S"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1561553994, "post_id": 56773040, "comment_id": 100102320, "body": "I would opt for <code>=IFERROR(TRIM(MID(A1,SEARCH(&quot;-&quot;,A1)+1,LEN(A1))),A1)</code> this would work on all possible examples."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1561554167, "post_id": 56773040, "comment_id": 100102418, "body": "@JvdV what will be happen if the cell contains more than one &quot;-&quot; as OP mention above?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1561554819, "post_id": 56773040, "comment_id": 100102806, "body": "@Error1004 now I see :). I though he meant to say value1 <code>-ABC</code>, value2 <code>-XYZ</code>. In that case <code>=IF(IFERROR(SEARCH(&quot;-&quot;,TRIM(A1)),0)=1,TRIM(MID(A1,SEARCH(&quot;-&quot;&zwnj;&#8203;,A1)+1,LEN(A1))),A1)</code> should work for all possible examples."}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 3, "last_activity_date": 1561553414, "last_edit_date": 1561553414, "creation_date": 1561552690, "answer_id": 56773040, "question_id": 56772618, "link": "https://stackoverflow.com/questions/56772618/how-to-remove-negative-sign-from-a-characters-or-text/56773040#56773040", "title": "how to remove negative sign from a characters or text?", "body": "<p>You could try:</p>\n\n<p>If there <strong>IS</strong> space between negative sigh &amp; the first letter</p>\n\n<p><code>=IF(LEFT(A1,1)=\"-\",MID(A1,FIND(\"-\",A1,1)+2,LEN(A1)-FIND(\"-\",A1,1)-1),\"\")</code></p>\n\n<p>If there <strong>IS NOT</strong> space between negative sigh &amp; the first letter</p>\n\n<p><code>=IF(LEFT(A1,1)=\"-\",MID(A1,FIND(\"-\",A1,1)+1,LEN(A1)-FIND(\"-\",A1,1)),\"\")</code></p>\n"}], "owner": {"reputation": 223, "user_id": 7250187, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cc66c5bfbabeb30dfb2b17739a5cd4fa?s=128&d=identicon&r=PG&f=1", "display_name": "jhovyn", "link": "https://stackoverflow.com/users/7250187/jhovyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561554570, "creation_date": 1561551393, "last_edit_date": 1561554570, "question_id": 56772618, "link": "https://stackoverflow.com/questions/56772618/how-to-remove-negative-sign-from-a-characters-or-text", "title": "how to remove negative sign from a characters or text?", "body": "<p>Please help! How to remove the negative sign(-) from a characters or text? Let say I have this text -ABC. The output should be ABC.See sample below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/PzTkQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PzTkQ.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 1, "creation_date": 1561556363, "post_id": 56772535, "comment_id": 100103855, "body": "Side note: Since you&#39;re using late binding, you&#39;ll need to replace the constant olFolderInbox with the actual value, which would be 6."}, {"owner": {"reputation": 25, "user_id": 11447921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8450ff6fb9a0ba204877cb39d059c9f5?s=128&d=identicon&r=PG&f=1", "display_name": "Stack", "link": "https://stackoverflow.com/users/11447921/stack"}, "reply_to_user": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 0, "creation_date": 1561557412, "post_id": 56772535, "comment_id": 100104540, "body": "Thank you very much Domenic. You were correct I had to change to a 6. I did not know I had to do this for late binding, as I thought once I had changed the set olApp that the rest would fall into place! How did you know that it needed changing?"}, {"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 1, "creation_date": 1561560508, "post_id": 56772535, "comment_id": 100106589, "body": "The constant is defined within the Outlook object library.  As such, without a reference to the library, the constant can&#39;t be resolved at compiled time, hence the error.  So the actual value needs to be used."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11447921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8450ff6fb9a0ba204877cb39d059c9f5?s=128&d=identicon&r=PG&f=1", "display_name": "Stack", "link": "https://stackoverflow.com/users/11447921/stack"}, "edited": false, "score": 0, "creation_date": 1561557611, "post_id": 56773439, "comment_id": 100104669, "body": "Thank you very much for explaining and it worked perfectly!"}], "tags": [], "owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "is_accepted": true, "score": 2, "last_activity_date": 1561554051, "creation_date": 1561554051, "answer_id": 56773439, "question_id": 56772535, "link": "https://stackoverflow.com/questions/56772535/late-binding-compile-error-user-defined-type-not-defined-referencing-outlook-ma/56773439#56773439", "title": "Late binding compile error: User-defined type not defined referencing Outlook mailitem in Excel VBA", "body": "<p>I'm guessing the reason you get the error is because you no longer have a reference to the outlook object library, and thus <code>MailItem</code> is an unknown type.</p>\n\n<p>Instead of using <code>TypeOf</code></p>\n\n<pre><code>If TypeOf olMail Is MailItem Then\n</code></pre>\n\n<p>use the <code>TypeName</code> function to compare the object type name to a string...</p>\n\n<pre><code>If TypeName(olMail) = \"MailItem\" Then\n</code></pre>\n\n<p>(note I'm assuming the type name will be <code>MailItem</code>, but you can always throw in <code>MsgBox TypeName(olMail)</code> just to be sure!)</p>\n"}, {"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1561753468, "creation_date": 1561753468, "answer_id": 56812858, "question_id": 56772535, "link": "https://stackoverflow.com/questions/56772535/late-binding-compile-error-user-defined-type-not-defined-referencing-outlook-ma/56812858#56812858", "title": "Late binding compile error: User-defined type not defined referencing Outlook mailitem in Excel VBA", "body": "<p>Type Name function is somewhat expensive. <code>Class</code> property (implemented by all OOM objects) would be a better aalternative. Check that <code>oMail.Class = 43</code> (43 is <code>OlObjectClass.olMail</code> constant) </p>\n"}], "owner": {"reputation": 25, "user_id": 11447921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8450ff6fb9a0ba204877cb39d059c9f5?s=128&d=identicon&r=PG&f=1", "display_name": "Stack", "link": "https://stackoverflow.com/users/11447921/stack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 56773439, "answer_count": 2, "score": 1, "last_activity_date": 1561956421, "creation_date": 1561551123, "last_edit_date": 1561956421, "question_id": 56772535, "link": "https://stackoverflow.com/questions/56772535/late-binding-compile-error-user-defined-type-not-defined-referencing-outlook-ma", "title": "Late binding compile error: User-defined type not defined referencing Outlook mailitem in Excel VBA", "body": "<p>I am using late binding from Excel.</p>\n\n<p>I get</p>\n\n<blockquote>\n  <p>Compiler Error: User defined type not defined</p>\n</blockquote>\n\n<p>for:</p>\n\n<pre><code>If TypeOf olMail Is MailItem Then\n</code></pre>\n\n<p>I declare the following variables:</p>\n\n<pre><code>Dim olApp As Object\nDim olNs As Object\nDim Fldr As Object\nDim olItms As Object\nDim olMail As Object\n\nSet olApp = CreateObject(\"Outlook.Application\")\nSet olNs = olApp.GetNamespace(\"MAPI\")\nSet Fldr = olNs.GetDefaultFolder(olFolderInbox)\nSet olItms = Fldr.Items\n</code></pre>\n\n<p>The code was working but I had to change to late binding because a user is not using the same Outlook version.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 11203145, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-53A3mtFrJMU/AAAAAAAAAAI/AAAAAAAAABc/AhWQS0ICwUQ/photo.jpg?sz=128", "display_name": "Beno&#238;t Laurent", "link": "https://stackoverflow.com/users/11203145/beno%c3%aet-laurent"}, "is_accepted": false, "score": 0, "last_activity_date": 1564041899, "creation_date": 1564041899, "answer_id": 57197114, "question_id": 56772382, "link": "https://stackoverflow.com/questions/56772382/pastespecial-and-inputbox-error-code-1004/57197114#57197114", "title": "PasteSpecial and InputBox error code 1004", "body": "<p>What is the range selected by the line <code>ActiveSheet.AutoFilter.Range.Copy</code>? If the range selected is not found you receive the error 1004. </p>\n\n<p>Also you don't need to select the cell before using <code>PasteSpecial</code>. </p>\n\n<p>Replace : </p>\n\n<pre><code>StartCell.Select\nSelection.PasteSpecial\n</code></pre>\n\n<p>by :</p>\n\n<pre><code>Range(StartCell).PasteSpecial Paste:=PasteAll\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9907329, "user_type": "registered", "profile_image": "https://graph.facebook.com/1996366630376544/picture?type=large", "display_name": "Kobi Ilnizki", "link": "https://stackoverflow.com/users/9907329/kobi-ilnizki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564041899, "creation_date": 1561550622, "question_id": 56772382, "link": "https://stackoverflow.com/questions/56772382/pastespecial-and-inputbox-error-code-1004", "title": "PasteSpecial and InputBox error code 1004", "body": "<p>I'm trying to copy AutoFilter and  pastespecial to range I take from inputbox\nput I getting 1004 error, any ideas?</p>\n\n<pre><code> Sub CopyFiltred2()\nDim StartCell As Range\nDim StartCell2 As Range\nActiveSheet.AutoFilter.Range.Copy\n\n\nSet StartCell = Excel.Application.InputBox(\"Range?\" &amp; vbNewLine &amp; \"Please select the cell:\" _\n                                , \"Insert Table of Contents\", , , , , , 8)\n\nStartCell.Select\nSelection.PasteSpecial\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 587, "user_id": 11481315, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rZK97.png?s=128&g=1", "display_name": "viilpe", "link": "https://stackoverflow.com/users/11481315/viilpe"}, "edited": false, "score": 0, "creation_date": 1561553816, "post_id": 56772022, "comment_id": 100102199, "body": "In your code I see no attempts to delete existing controls. Are you sure that control that should be created did not exist when you run your Sub with button?"}, {"owner": {"reputation": 175, "user_id": 8935349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-4iOAaJzmDJA/AAAAAAAAAAI/AAAAAAAAApM/ZYP8Z_g9o80/photo.jpg?sz=128", "display_name": "Lux Claridge", "link": "https://stackoverflow.com/users/8935349/lux-claridge"}, "reply_to_user": {"reputation": 587, "user_id": 11481315, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rZK97.png?s=128&g=1", "display_name": "viilpe", "link": "https://stackoverflow.com/users/11481315/viilpe"}, "edited": false, "score": 0, "creation_date": 1561554027, "post_id": 56772022, "comment_id": 100102336, "body": "Woops, forgot to include that bit. The deletion is in a separate sub. Originally it was in the same sub but split it when I added the button so I wouldn&#39;t delete the controls I was suppose to be adding onto. I guess I tend to forget that I split the operations."}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 8935349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-4iOAaJzmDJA/AAAAAAAAAAI/AAAAAAAAApM/ZYP8Z_g9o80/photo.jpg?sz=128", "display_name": "Lux Claridge", "link": "https://stackoverflow.com/users/8935349/lux-claridge"}, "edited": false, "score": 0, "creation_date": 1561551518, "post_id": 56772400, "comment_id": 100100693, "body": "Except I&#39;ve been able to. I get that access has a max of 255 controls, but since my controls have the same name, I assume, I can get around this. I&#39;ve created, deleted, and recreated 160 controls several times over the course of a few days to test this limitation."}, {"owner": {"reputation": 175, "user_id": 8935349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-4iOAaJzmDJA/AAAAAAAAAAI/AAAAAAAAApM/ZYP8Z_g9o80/photo.jpg?sz=128", "display_name": "Lux Claridge", "link": "https://stackoverflow.com/users/8935349/lux-claridge"}, "edited": false, "score": 0, "creation_date": 1561551565, "post_id": 56772400, "comment_id": 100100728, "body": "That all said, in this particular case, I can create 10 controls when opening from the main menu. However, if I create 5 controls then try to add 5 more later I get the error. So I don&#39;t think my issue is this limitation."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 175, "user_id": 8935349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-4iOAaJzmDJA/AAAAAAAAAAI/AAAAAAAAApM/ZYP8Z_g9o80/photo.jpg?sz=128", "display_name": "Lux Claridge", "link": "https://stackoverflow.com/users/8935349/lux-claridge"}, "edited": false, "score": 2, "creation_date": 1561552520, "post_id": 56772400, "comment_id": 100101363, "body": "It is far more than 255, but can&#39;t recall the figure. In any case, to delete and recreate  is a dead end with a full stop."}, {"owner": {"reputation": 2892, "user_id": 1935222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gx2zd.png?s=128&g=1", "display_name": "4dmonster", "link": "https://stackoverflow.com/users/1935222/4dmonster"}, "edited": false, "score": 1, "creation_date": 1561555460, "post_id": 56772400, "comment_id": 100103263, "body": "@Gustav is absolutelly right !!! Try to save your form to file <code>SaveAsText acForm ,&quot;FormName&quot;,&quot;c:\\tempFormFile&quot;</code> And look at line with <code>ItemSuffix =</code>. This is internal access counter wich is never decremented. BUT you can do such workaround: 1. save form <code>SaveAsText acForm ,&quot;FormName&quot;,&quot;c:\\tempFormFile&quot;</code> 2. open file and 2.1. delete line <code>Checksum = ....</code>  2.2. set <code>ItemSuffix =</code> to any save value 2.3. save file 3. load it back to access <code>LoadFromText acForm ,&quot;FormName&quot;,&quot;c:\\tempFormFile&quot;</code> ."}, {"owner": {"reputation": 2892, "user_id": 1935222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gx2zd.png?s=128&g=1", "display_name": "4dmonster", "link": "https://stackoverflow.com/users/1935222/4dmonster"}, "edited": false, "score": 0, "creation_date": 1561556129, "post_id": 56772400, "comment_id": 100103703, "body": "It looks like at Access2010 this limitation is removed. And Access gives name with negative numbers like <code>Label-32767</code>"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 2, "last_activity_date": 1561550690, "creation_date": 1561550690, "answer_id": 56772400, "question_id": 56772022, "link": "https://stackoverflow.com/questions/56772022/sub-to-add-controls-works-when-called-from-one-sub-but-the-other/56772400#56772400", "title": "Sub to add controls works when called from one sub but the other", "body": "<p>You can't do this. A form or report can only hold a certain amount of controls, deleted or not, so - eventually - it will not accept more controls. At that point, you must recreate the form from scratch.</p>\n\n<p>So, don't delete the controls. Create those you may need and, at any time, hide those not needed and rename the rest if necessary. </p>\n"}], "owner": {"reputation": 175, "user_id": 8935349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-4iOAaJzmDJA/AAAAAAAAAAI/AAAAAAAAApM/ZYP8Z_g9o80/photo.jpg?sz=128", "display_name": "Lux Claridge", "link": "https://stackoverflow.com/users/8935349/lux-claridge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594714887, "creation_date": 1561549416, "last_edit_date": 1594714887, "question_id": 56772022, "link": "https://stackoverflow.com/questions/56772022/sub-to-add-controls-works-when-called-from-one-sub-but-the-other", "title": "Sub to add controls works when called from one sub but the other", "body": "<p>I am getting an error that I just can't figure out. I wrote a sub that opens a form in Design view, deletes all of the dynamic controls, then adds the requested number. </p>\n\n<p>The sub gets called in two different ways. The user opening the form (via a Main Menu form) to fill out a new form (so the dynamic controls are deleted then recreated) <strong>OR</strong> after the form is created, the user can click a button on the form to add more rows of controls. Both the Main Menu and button form call the same sub, <strong>BUT</strong> when the button is clicked the code gets stuck and error 29054 '<strong>Microsoft Access can't add, rename, or delete the control(s) you requested.</strong>' is thrown. The button to debug is deactivated so I can't see what line is actually getting stuck, but when I step through the code this is the last line before the error pops up (the last indent block in the context below):</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>    With Application.CreateControl(\"BOM5\", acComboBox, acDetail, frm.Controls(\"Tabs\").Pages(PageNum).Name, , ChangeTypeLeft, LastControlTop, ChangeTypeWidth, ControlHeight)\n</code></pre>\n\n<p>The rest of the code is as follows.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>    DoCmd.OpenForm \"BOM5\", acDesign\n    Set frm = Application.Forms(\"BOM5\")\n\n    ' Cycle through controls and set LastControlTop based on the last dynamic control, if any\n    For i = 0 To frm.Controls.Count - 1\n        Set ctl = frm.Controls(i)\n        Debug.Print ctl.Name\n        If ctl.Tag Like DYNAMIC_TAG &amp; \"*\" Then\n            If ctl.ControlType = acComboBox Or ctl.ControlType = acTextBox Then\n                LastControlTop = ctl.Top + ControlHeight + ControlPadding\n                FormRowCount = FormRowCount + 1\n            End If\n        Else\n            FormRowCount = (FormRowCount / 6) + 1      ' Convert number of fields to number of rows then add one to start new batch of controls\n\n            Exit For\n        End If\n    Next\n\n    PageNum = frm.Controls(\"Tabs\").Pages.Count - 1      ' .Pages has an index of 0. Getting PageNum to follow suit with the -1\n\n    ' Add controls for inputting parts\n    For FormRowCount = FormRowCount To NewControlCount\n        With Application.CreateControl(\"BOM5\", acComboBox, acDetail, frm.Controls(\"Tabs\").Pages(PageNum).Name, , ChangeTypeLeft, LastControlTop, ChangeTypeWidth, ControlHeight)\n            .Name = \"ChangeType\" &amp; FormRowCount\n            .Tag = DYNAMIC_TAG\n            .RowSourceType = \"Table/Query\"\n            .RowSource = \"ChangeType\"\n        End With\n</code></pre>\n\n<p>The last for loop has 5 other With Application.CreatControl statements, but I just showed the first one. The other 5 are similar except text boxes instead of combo.</p>\n\n<p>I've had this error before, but I think I resolved it by moving the DoCmd.OpenForm statement to a different part of the code (like out of an if statement or for loop or somewhere that wasn't letting it get called) but I don't think that will resolve it. Besides, the first for loop iterates correctly since I see it grabbing the control height of the last dynamic control.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1561548397, "post_id": 56771636, "comment_id": 100098803, "body": "<code>Range(Target.Address).Activate</code> works for me in event <code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)</code>. But why you would do that? <code>Target</code> is already the active cell so, you are activating something that it&#39;s already active."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 1, "creation_date": 1561549099, "post_id": 56771636, "comment_id": 100099240, "body": "<code>Activate</code>, just like <code>Select</code>, is rarely of any use. What do you need it for?"}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 5595777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/246c2ecb285bf035ff797026640f8269?s=128&d=identicon&r=PG&f=1", "display_name": "DanM", "link": "https://stackoverflow.com/users/5595777/danm"}, "edited": false, "score": 0, "creation_date": 1561549540, "post_id": 56771757, "comment_id": 100099508, "body": "thanks for the input, got it resolved by doing an activate on the sheet first"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 175, "user_id": 5595777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/246c2ecb285bf035ff797026640f8269?s=128&d=identicon&r=PG&f=1", "display_name": "DanM", "link": "https://stackoverflow.com/users/5595777/danm"}, "edited": false, "score": 0, "creation_date": 1561549630, "post_id": 56771757, "comment_id": 100099566, "body": "@DanM  Good Job!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1611321405, "last_edit_date": 1611321405, "creation_date": 1561548485, "answer_id": 56771757, "question_id": 56771636, "link": "https://stackoverflow.com/questions/56771636/how-to-activate-a-target/56771757#56771757", "title": "How to activate a Target", "body": "<p>In most cases, <code>Target</code> is a <code>Range</code> Object.  Therefore:</p>\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Target.Activate\nEnd Sub\n</code></pre>\n<p>will usually work. The code above moves you back to the same cell you have just modified.</p>\n<p><em>(Just be sure that you have <strong>not</strong> changed worksheets, because <code>Target</code> can be activated only if its Sheet is also active.  While this is not usually a problem, it <strong>can</strong> be tricky for some hyperlink or other sheet change Events.)</em></p>\n"}], "owner": {"reputation": 175, "user_id": 5595777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/246c2ecb285bf035ff797026640f8269?s=128&d=identicon&r=PG&f=1", "display_name": "DanM", "link": "https://stackoverflow.com/users/5595777/danm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1611321405, "creation_date": 1561548020, "last_edit_date": 1611321375, "question_id": 56771636, "link": "https://stackoverflow.com/questions/56771636/how-to-activate-a-target", "title": "How to activate a Target", "body": "<p>I am trying to activate a target.address and am getting error:</p>\n<blockquote>\n<p>runtime error 1004</p>\n</blockquote>\n<p>I tried this:</p>\n<pre><code>range(Target).activate\n</code></pre>\n<p>And this:</p>\n<pre><code>range(Target.Address).activate\n</code></pre>\n<p>And this:</p>\n<pre><code>target.activate\n\nrun time error 1004\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "named-ranges"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1561547007, "post_id": 56771254, "comment_id": 100097961, "body": "Are you doing this so that you always have the latest version of .bas files in your project?"}, {"owner": {"reputation": 101, "user_id": 8490765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fdcfa0b3de9e6b40afd5959fa7a4ce9?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Hall", "link": "https://stackoverflow.com/users/8490765/robert-hall"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1561547126, "post_id": 56771254, "comment_id": 100098051, "body": "@Zac yes it is. there are four people that need the latest versions and they are spread out through the country."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1561547359, "post_id": 56771254, "comment_id": 100098203, "body": "Without going through your code (which I presume does successfully import the .bas files), I would remove the complication of checking for dates. I&#39;ve done this in the past where everytime the workbook open, I import the .bas file(s) from the folder. This folder always has the latest version. This way no matter who opens the file, they will always get the correct version. Only complication is that all users must have access to the folder"}, {"owner": {"reputation": 101, "user_id": 8490765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fdcfa0b3de9e6b40afd5959fa7a4ce9?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Hall", "link": "https://stackoverflow.com/users/8490765/robert-hall"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1561547860, "post_id": 56771254, "comment_id": 100098487, "body": "I have tried that but for a paper flow reason, i need to log the date of the last import for each file. Originally i held the files online but but it would not work with multiple files, so they are now in a rar file that gets downloaded, extracts then imports."}], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1561547567, "creation_date": 1561547567, "answer_id": 56771520, "question_id": 56771254, "link": "https://stackoverflow.com/questions/56771254/how-to-loop-through-named-ranges/56771520#56771520", "title": "How to loop through named ranges", "body": "<pre><code>Sub test()\nDim r As Range\nFor Each r In ThisWorkbook.Names(\"MacroName\").RefersToRange\n    Debug.Print r.Address\nNext r\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 8490765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fdcfa0b3de9e6b40afd5959fa7a4ce9?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Hall", "link": "https://stackoverflow.com/users/8490765/robert-hall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1561552540, "creation_date": 1561546687, "last_edit_date": 1561552540, "question_id": 56771254, "link": "https://stackoverflow.com/questions/56771254/how-to-loop-through-named-ranges", "title": "How to loop through named ranges", "body": "<p>I have some code that imports .bas files and i need it to run though 2 named ranges. The first (MacroName) would be a list of file names (e.g exam.bas, print.bas...) and the second (ImportDate) will be the date that the file was imported.</p>\n\n<p>The code below loops though the folder that contains .bas files. It then checks the date modified of the file against the ImportDate named range. But I can't think of a way to loop the named ranges</p>\n\n<pre><code>For Each objFile In objFSO.GetFolder(szImportPath).Files\n    If objFile.Name Like \"*Import*\" Then GoTo skipImport ' Skips the Import Module\n    If (objFSO.GetExtensionName(objFile.Name) = \"cls\") Or _\n        (objFSO.GetExtensionName(objFile.Name) = \"frm\") Or _\n        (objFSO.GetExtensionName(objFile.Name) = \"bas\") And _\n        objFile.DateLastModified &gt; Range(\"ImportDate\") Then\n\n        Dim CurrentModuleName\n\n        CurrentModuleName = Left(objFile.Name, (InStrRev(objFile.Name, \".\", -1, vbTextCompare) - 1))\n        '^ Gets the file name of the module being imported and removes the extension\n\n        Dim VBProj As VBIDE.VBProject\n        Dim VBComp As VBIDE.VBComponent\n\n        Set VBProj = ActiveWorkbook.VBProject\n        Set VBComp = VBProj.VBComponents(CurrentModuleName)\n        VBProj.VBComponents.Remove VBComp\n        '^ Removes the module that is to be replaced\n\n        Range(\"MacroName\") = objFile.Name\n        Range(\"ImportDate\") = Format(Date, \"dd/mm/yyyy\") &amp; \" \" &amp; Format(Time, \"hh.nn.ss\")\n        '^ Keep time as without, it will import the same module throughout the day when opened.\n\n        cmpComponents.Import objFile.path\n    End If      \nskipImport:\nNext objFile\n</code></pre>\n\n<p>I am hoping that it reads the name of the file, checks the date and then if the date modified of the imported file is greater, deletes the current and replaces.</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1561547574, "post_id": 56771225, "comment_id": 100098337, "body": "If your array is getting the value from a range, you don&#39;t need to do this through your array. If you do a <code>find and replace</code> (can be done with VBA) where find value is: <b>&quot; *&quot;</b> (NOTE: the space before the <code>*</code> character) and no value in replace, it will remove time from your range and leave the date"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1561548494, "post_id": 56771225, "comment_id": 100098871, "body": "Do you have <code>Option Explicit</code> turned on?  There are a <b>lot</b> of variables in your code that you do not <code>Dim</code>, such as <code>data_ws, ows, NumRows, NumberOfZombies, tofind, toreplace, rw, col, a(), b()</code> - if these are not defined, then defined them.  If they <i>are</i> defined, then please include the definitions.  Otherwise, this is not a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1561549737, "post_id": 56771225, "comment_id": 100099626, "body": "If the array holds Date types on that column you could just do this <code>Data(i, 2) = Year(Data(i, 2))</code>"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1561550381, "post_id": 56771225, "comment_id": 100099987, "body": "@Damian The wording seems more to me like the contents are <code>26&#47;06&#47;2019 01:23</code>, and OP just wants <code>26&#47;06&#47;2019</code>.  So, perhaps <code>Data(i, 2) = Int(Data(i, 2))</code> instead?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1561553758, "post_id": 56771225, "comment_id": 100102170, "body": "True that @Chronocidal but that should be formated, or else it will print the date number for excel, right?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1561555617, "post_id": 56771225, "comment_id": 100103366, "body": "@Damian I think the actual issue would be the opposite:  If the content is string, then you need to <code>CDate</code> before you can <code>Int</code>.  But, to be extra-safe <code>Data(i, 2) = Format(Int(cDate(Data(i, 2))),&quot;dd&#47;mm&#47;yyyy&quot;)</code>?  xD"}, {"owner": {"reputation": 1, "user_id": 11636077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45d90a9f09eb9b77909c9913e9c16cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/11636077/julian"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1561598418, "post_id": 56771225, "comment_id": 100120157, "body": "@Zac the copied range to sheet is a prototyping step, so i had a copy of the test data to array  actual data has thousands of entries and find and replace is a bit processor intensive."}], "owner": {"reputation": 1, "user_id": 11636077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45d90a9f09eb9b77909c9913e9c16cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/11636077/julian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561609375, "creation_date": 1561546609, "last_edit_date": 1561609375, "question_id": 56771225, "link": "https://stackoverflow.com/questions/56771225/editing-array-values-vba-using-instr-split-date-output-eccentricities", "title": "editing array values VBA -- using Instr &amp; Split -- Date output eccentricities", "body": "<p>Have a 2d Array, need to search through one of the columns finding a string and deleting everything after it. </p>\n\n<p>I have a list of dates, but the format it is currently in has a long Time value\nafter the date ending in 2019. I would like to find and replace 2019 + time\nwith just 2019. </p>\n\n<p><strong>Edit</strong>  code </p>\n\n<p>The date isn't stored as a date, for all intents and purposes it's a string that looks something like \"****#### 2019 ######\"   and I am just looking for a method to remove everything after a value, (2019) . \nRight now, it steps through it all nicely checks array value by value\nbut doesn't actually change anything.\n<strong>Edit2</strong> \nFound workable solution using Instr &amp; Split functions.\nBUT the weirdest bug crept in, \nsome dates appear fine in debug.print \neg : 11/06/2019  BUT after printing to a range   06/11/2019\n     13/06/2019                                  13/06/2019\nEven if the format of the destination is pre-defined</p>\n\n<p>Public Sub PrintArray(Data As Variant, Cl As Range)\n    Cl.Resize(UBound(Data, 1), UBound(Data, 2)) = Data\nEnd Sub\nPrivate Sub Test()</p>\n\n<pre><code>Dim Name_col As Integer\nDim Date_col As Integer\nDim Hours_col As Integer\nDim Department_col As Integer\nDim Data_row As Integer\n\nName_col = 1\nDate_col = 2\nHours_col = 3\nDepartment_col = 4\nData_row = 2\n\nDim i As Integer\nDim zom As Integer\n\nDim DirArray As Variant\nDim col As Integer\n\nDim LString As String\nDim LArray() As String\n\nzom = 0\ni = 2\ncol = 2\n\n\nDim X As Integer\nApplication.ScreenUpdating = False\n\nDo While Sheets(\"Sheet2\").Cells(i, 1).Value &lt;&gt; \"\"\n    i = i + 1\n    zom = zom + 1\nLoop\n  Application.ScreenUpdating = True\n\n\n\nNumberOfZombies = zom\n\nDebug.Print \"Number of zombies\" &amp; NumberOfZombies\nWorksheets(\"Sheet2\").Activate\nDirArray = Sheets(\"Sheet2\").Range(Cells(Data_row, Name_col), Cells(zom, Department_col)).Value\n\n\nFor rw = LBound(DirArray) To UBound(DirArray)\n    For col = LBound(DirArray) To UBound(DirArray, 2)\n\n\n     LString = DirArray(rw, col)\n     If InStr(LString, \"2019\") &gt; 0 Then\n     LArray = Split(LString)\n     Debug.Print LArray(0)\n     DirArray(rw, col) = LArray(0)\n     End If\n     Debug.Print DirArray(rw, col)\n    Next\nNext\n\nPrintArray DirArray, Sheets(\"Sheet3\").[A1]\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1561546434, "post_id": 56770610, "comment_id": 100097638, "body": "This code should work but I would suggest that OP should have a button (or maybe a menu option) to launch the form. I suspect that OP copied the code from somewhere but maybe his form is not called <code>UserForm1</code> and that&#39;s why it&#39;s not launching?"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1561546523, "post_id": 56770610, "comment_id": 100097695, "body": "@Zac OP requests code to open up the VBE but is showing us code that should open up a UserForm. I don&#39;t think the latter is of any interest"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1561546748, "post_id": 56770610, "comment_id": 100097822, "body": "I&#39;m not suggestion that you haven&#39;t answered the question. I however am questioning OP&#39;s approach. Not sure why they would want to do this with code. Could open the editor with shortcut keys or excel <b>Developer</b> menu. Don&#39;t see why OP wants to do it this way"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1561546851, "post_id": 56770610, "comment_id": 100097879, "body": "Maybe OP is tired of the very lengthy and difficult ALT+F11 shortcut each time he opens up his project WB"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1561546921, "post_id": 56770610, "comment_id": 100097912, "body": ":).. I have no idea how to respond to that :D"}, {"owner": {"reputation": 35, "user_id": 11552254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hDXTO.jpg?s=128&g=1", "display_name": "rediffusion", "link": "https://stackoverflow.com/users/11552254/rediffusion"}, "edited": false, "score": 1, "creation_date": 1561548210, "post_id": 56770610, "comment_id": 100098696, "body": "Wait a minute! I&#39;m tried this <code>Module1.Show</code> not working! @Tim Stack you&#39;re right! I&#39;m testing lot of codes. But to work you need to reopen &#171;Excel&#187;. I&#39;m really tired to pressing on <code>ALT+F11</code>. Thanks for the code above."}, {"owner": {"reputation": 35, "user_id": 11552254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hDXTO.jpg?s=128&g=1", "display_name": "rediffusion", "link": "https://stackoverflow.com/users/11552254/rediffusion"}, "edited": false, "score": 0, "creation_date": 1561704950, "post_id": 56770610, "comment_id": 100158833, "body": "@TimStack &#183;&#183;&#183; This code does not work in the <code>.xlam</code> it works in <code>.xlsm</code>. Is it normal? What to do to work in all types of books?"}], "tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": true, "score": 2, "last_activity_date": 1561545171, "last_edit_date": 1561545171, "creation_date": 1561544867, "answer_id": 56770610, "question_id": 56770447, "link": "https://stackoverflow.com/questions/56770447/how-do-i-open-a-visual-basic-when-i-start-excel/56770610#56770610", "title": "How do I open a Visual Basic when I start Excel?", "body": "<p>To open the Virtual Basic Editor (VBE) on a specific module, try the following</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Application.VBE.MainWindow.Visible = True\n    Me.VBProject.VBComponents(\"Module1\").Activate\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1561545229, "post_id": 56770728, "comment_id": 100096985, "body": "<code>SendKeys</code> is iffy, causes a lot of issues. Especially when sending keys for the VBE, I have seen cases where people had their entire code deleted"}, {"owner": {"reputation": 35, "user_id": 11552254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hDXTO.jpg?s=128&g=1", "display_name": "rediffusion", "link": "https://stackoverflow.com/users/11552254/rediffusion"}, "edited": false, "score": 0, "creation_date": 1561548750, "post_id": 56770728, "comment_id": 100099018, "body": "@L8n This code is also working! But I&#39;d better listen to our &#183;&#183;&#183; Tim stack&#39;s code."}, {"owner": {"reputation": 35, "user_id": 11552254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hDXTO.jpg?s=128&g=1", "display_name": "rediffusion", "link": "https://stackoverflow.com/users/11552254/rediffusion"}, "edited": false, "score": 0, "creation_date": 1561553675, "post_id": 56770728, "comment_id": 100102110, "body": "@L8n One more question to you! What if i open The default tab, i have my own tab called <code>My Macro</code>. I used this <code>SendKeys &quot;%BP{F6}&quot;</code> but it&#39;s not working! Also i put this code in <code>PERSONAL.XLSB</code> to work in all the books.. Not working  &#183;&#183;&#183;&#183; Compile error: Ambiguous name detected: Workbook.Open &#183;&#183;&#183;&#183; I have other code with <code>Workbook_Open</code>. How to use it all together?"}], "tags": [], "owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "is_accepted": false, "score": 0, "last_activity_date": 1561545159, "creation_date": 1561545159, "answer_id": 56770728, "question_id": 56770447, "link": "https://stackoverflow.com/questions/56770447/how-do-i-open-a-visual-basic-when-i-start-excel/56770728#56770728", "title": "How do I open a Visual Basic when I start Excel?", "body": "<p>Alternative to @TimStack:<br>\n(althought I do prefer his Method)</p>\n\n<pre><code>Private Sub Workbook_Open()\n    SendKeys \"%{F11}\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1100264"}, "is_accepted": false, "score": 1, "last_activity_date": 1561550338, "creation_date": 1561550338, "answer_id": 56772292, "question_id": 56770447, "link": "https://stackoverflow.com/questions/56770447/how-do-i-open-a-visual-basic-when-i-start-excel/56772292#56772292", "title": "How do I open a Visual Basic when I start Excel?", "body": "<p>Note that Private Sub Workbook_Open() should be located in ThisWorkbook, not in a module, if so, then it's not being called.</p>\n"}], "owner": {"reputation": 35, "user_id": 11552254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hDXTO.jpg?s=128&g=1", "display_name": "rediffusion", "link": "https://stackoverflow.com/users/11552254/rediffusion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 56770610, "answer_count": 3, "score": 0, "last_activity_date": 1565103237, "creation_date": 1561544378, "last_edit_date": 1565103237, "question_id": 56770447, "link": "https://stackoverflow.com/questions/56770447/how-do-i-open-a-visual-basic-when-i-start-excel", "title": "How do I open a Visual Basic when I start Excel?", "body": "<p>I find this code on <a href=\"https://www.automateexcel.com/vba/auto-open-macro/#Load_Form_Every_Time_Workbook_Opens\" rel=\"nofollow noreferrer\" title=\"Load Form Every Time Workbook Opens\">site</a>.</p>\n\n<pre><code>Private Sub Workbook_Open()\n    UserForm1.Show\nEnd Sub\n</code></pre>\n\n<p>It's not working.\nI want to open \u00abVisual Basic\u00bb after starting Excel then open the window <code>Module1</code> for example. Is it feasible?</p>\n"}, {"tags": ["vba", "ms-access", "combobox", "textbox"], "comments": [{"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1561547474, "post_id": 56770338, "comment_id": 100098271, "body": "I don&#39;t think this makes a whole lot of sense.  Can you rephrase your question?  What are you actually trying to accomplish here?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1561570101, "post_id": 56770338, "comment_id": 100111577, "body": "So the field is a lookup on SharePoint list? This means table also has lookup setting on field? I don&#39;t use SharePoint. Why would a query not work with this? What does &#39;not work&#39; mean - error message, wrong result, nothing happens?"}], "owner": {"reputation": 77, "user_id": 11702448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8537c2ea3cee08b15aa7135303718542?s=128&d=identicon&r=PG&f=1", "display_name": "Sapehi", "link": "https://stackoverflow.com/users/11702448/sapehi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561549894, "creation_date": 1561544024, "last_edit_date": 1561549894, "question_id": 56770338, "link": "https://stackoverflow.com/questions/56770338/copy-table-with-a-column-combo-box-into-a-new-table-having-the-combo-box-column", "title": "Copy table with a column combo box into a new table having the combo box column as text box", "body": "<p>In MS Access, I have a table populated from sharepoint. One of the columns is combo box. I need this column to be converted to text box automatically, as I need to run some queries after, and they do not work if one of the columns is combo box.</p>\n\n<ul>\n<li>I have tried to change the type in the populated table, but the change can't be done as it is populated from sharepoint and thus read-only.</li>\n<li>I have tried to copy and paste into a new table, and then make the change, but the combo box column doesn't get pasted (only blanks are transferred)</li>\n</ul>\n"}, {"tags": ["regex", "excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1561544257, "post_id": 56770316, "comment_id": 100096303, "body": "Count the number of <code>$</code>"}, {"owner": {"reputation": 315, "user_id": 4448963, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000060642111/picture?type=large", "display_name": "Tam Le", "link": "https://stackoverflow.com/users/4448963/tam-le"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1561544749, "post_id": 56770316, "comment_id": 100096657, "body": "@Mikku I don&#39;t think that would work at all. <code>$A4&gt;C5</code> is different from <code>$B4&gt;C5</code>"}, {"owner": {"reputation": 315, "user_id": 4448963, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000060642111/picture?type=large", "display_name": "Tam Le", "link": "https://stackoverflow.com/users/4448963/tam-le"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1561544904, "post_id": 56770316, "comment_id": 100096760, "body": "@Mikku Are you the one that downvote my question?"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1561557114, "post_id": 56770316, "comment_id": 100104359, "body": "I would have mentioned something if I did."}], "answers": [{"comments": [{"owner": {"reputation": 315, "user_id": 4448963, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000060642111/picture?type=large", "display_name": "Tam Le", "link": "https://stackoverflow.com/users/4448963/tam-le"}, "edited": false, "score": 0, "creation_date": 1561549338, "post_id": 56771416, "comment_id": 100099396, "body": "This is so much simpler than Regex. Thanks you very much."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 1, "last_activity_date": 1561547258, "creation_date": 1561547258, "answer_id": 56771416, "question_id": 56770316, "link": "https://stackoverflow.com/questions/56770316/find-real-formula-for-a-formula-group/56771416#56771416", "title": "Find &quot;real&quot; formula for a formula group", "body": "<p>Convert your formulas to display in R1C1 format by using File,Options,Formulas and ticking R1C1 style. In such a style your four example formulas would display (If they were entered in column 3) as</p>\n\n<pre><code>=IF(R4C[-2]&gt;RC1,\"Long\",\"Short\")\n=IF(R4C[-1]&gt;R[-1]C1,\"Long\",\"Short\")\n=IF(R4C[-2]&gt;R[-1]C1,\"Long\",\"Short\")\n=IF(R4C[-2]&gt;R2C1,\"Long\",\"Short\")\n</code></pre>\n\n<p>The fixed portions of the addresses don't have braces [] so if you remove the braces and their contents you get</p>\n\n<pre><code>R4C&gt;RC1\nR4C&gt;RC1\nR4C&gt;RC1\nR4C&gt;R2C1\n</code></pre>\n\n<p>and no 4 is different from the others</p>\n"}], "owner": {"reputation": 315, "user_id": 4448963, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000060642111/picture?type=large", "display_name": "Tam Le", "link": "https://stackoverflow.com/users/4448963/tam-le"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 56771416, "answer_count": 1, "score": -1, "last_activity_date": 1561549984, "creation_date": 1561543977, "last_edit_date": 1561549984, "question_id": 56770316, "link": "https://stackoverflow.com/questions/56770316/find-real-formula-for-a-formula-group", "title": "Find &quot;real&quot; formula for a formula group", "body": "<p>I am trying to find the \"real\" formula of a group. For example, these are the formulas</p>\n\n<pre><code>=If(A$4&gt;$A1,\"Long\",\"Short\") \n=If(B$4&gt;$A1,\"Long\",\"Short\") \n=If(A$4&gt;$A2,\"Long\",\"Short\")\n=If(A$4&gt;$A$2,\"Long\",\"Short)\n</code></pre>\n\n<p>The forth formula is a different one. The first 3 formulas should be the same formula that is a cell fixed 4th row compare to a cell fixed at column A. The result should show 2 \"real\" formula. Something like this</p>\n\n<pre><code>=If($4&gt;$A,\"Long\",\"Short\")\n=If($4&gt;$A$2,\"Long\",\"Short\")\n</code></pre>\n\n<p>How do I design a regex (or any other method) in VBA to extract that \"real\" formula from the \"nominal\" formulas?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "is_accepted": true, "score": 1, "last_activity_date": 1561568225, "creation_date": 1561568225, "answer_id": 56777753, "question_id": 56770247, "link": "https://stackoverflow.com/questions/56770247/creating-a-range-with-only-the-even-number-col/56777753#56777753", "title": "Creating a range with only the even number col", "body": "<p>Try this instead of <code>Rng = Range(Cells(k, 12), Cells(k, 9999))</code>:</p>\n\n<pre><code>With ThisWorkbook.ActiveSheet\n    Dim Rng As Range\n    Dim i As Long\n    i = 12\n    Set Rng = .Cells(k, i)\n    i = i + 2\n    Do While i &lt; 9999\n        Set Rng = Union(Rng, .Cells(k, i))\n        i = i + 2\n    Loop\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 8335171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3549cc51906e5b76f996d4dc3d9a27c?s=128&d=identicon&r=PG&f=1", "display_name": "fauxpas", "link": "https://stackoverflow.com/users/8335171/fauxpas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 56777753, "answer_count": 1, "score": 0, "last_activity_date": 1561568225, "creation_date": 1561543798, "last_edit_date": 1561549947, "question_id": 56770247, "link": "https://stackoverflow.com/questions/56770247/creating-a-range-with-only-the-even-number-col", "title": "Creating a range with only the even number col", "body": "<p>I am interested to have <code>rng</code> select only even columns (within Col 12 to 9999). I have attached my code below. Please assist, thank you!</p>\n\n<pre><code>Sub calDailyGC()\n    Application.Calculation = xlCalculationManual\n    Application.ScreenUpdating = False\n    Set w = Application.WorksheetFunction\n    Dim gc As Double\n\n    numGC = Cells(46, 7).Value\n    numDays = Cells(47, 7).Value\n\n    For k = 3 To numDays + 1\n        Rng = Range(Cells(k, 12), Cells(k, 9999))\n        sumRate = 0\n        For j = 1 To numGC\n            gc = Application.WorksheetFunction.Large(Rng, j)\n            Debug.Print gc\n            sumRate = sumRate + gc\n        Next j\n    Next k\n    avgGCRate = sumRate / numGC\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 11079965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c65a1114270b45de7bd929ae95e800a?s=128&d=identicon&r=PG", "display_name": "Arain", "link": "https://stackoverflow.com/users/11079965/arain"}, "edited": false, "score": 0, "creation_date": 1561558530, "post_id": 56770134, "comment_id": 100105290, "body": "P.S. The columns in Sheet(&quot;Imported Data&quot;) often will be in random order (one day &quot;SroNum&quot; column may be in column A, the other B etc. - thus i was using worksheetfunction.match"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11079965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c65a1114270b45de7bd929ae95e800a?s=128&d=identicon&r=PG", "display_name": "Arain", "link": "https://stackoverflow.com/users/11079965/arain"}, "is_accepted": false, "score": -1, "last_activity_date": 1561642659, "creation_date": 1561642659, "answer_id": 56792308, "question_id": 56770134, "link": "https://stackoverflow.com/questions/56770134/copy-entire-columns-based-on-specific-headers-from-one-sheet-to-another-in-ot/56792308#56792308", "title": "Copy entire columns (based on specific headers) from one sheet to another (in other order) does not work on Excel 365", "body": "<p>Two things cause this problem:</p>\n\n<ol>\n<li>In Excel 365 \"SRO\" is a predefined constant - thus i needed to change it to SR0 </li>\n<li>Excel 365 needs to have all of the values (like SR0, Descpt, Stats etc.) predefined with DIM (as simple as that):</li>\n</ol>\n\n<pre><code>Private Sub Generate2()\n\n'warning! it's ZERO in all SR0, not O!\n        Dim SR0 As Double\n        Dim Descpt As Double\n        Dim Stats As Double\n        Dim Project As Double\n        Dim SR0lead As Double\n        Dim OpenDate As Double\n        Dim CloseDate As Double\n        Dim TPT As Double\n        Dim STATUSnew As Double\n        Dim WRKstat As Double\n        Dim OpCode As Double\n        Dim Priority As Double\n        Dim OpPartner As Double\n        Dim DUT As Double\n        Dim OpDesc As Double\n        Dim OpStatus As Double\n        Dim CreatedBy As Double\n\n            Application.EnableEvents = False\n            Application.ScreenUpdating = False\n\n                ActiveWorkbook.Sheets(\"Imported Data\").Activate\n\n'tis where You select what columns You want to copy and name them\n            SR0 = Application.WorksheetFunction.Match(\"SroNum\", Rows(\"1:1\"), 0)\n            Descpt = WorksheetFunction.Match(\"Description\", Rows(\"1:1\"), 0)\n            Stats = WorksheetFunction.Match(\"Status\", Rows(\"1:1\"), 0)\n            Project = WorksheetFunction.Match(\"srouf_platform\", Rows(\"1:1\"), 0)\n            SR0lead = WorksheetFunction.Match(\"Name\", Rows(\"1:1\"), 0)\n            OpenDate = WorksheetFunction.Match(\"CreateDate\", Rows(\"1:1\"), 0)\n            CloseDate = WorksheetFunction.Match(\"Close Date\", Rows(\"1:1\"), 0)\n            TPT = WorksheetFunction.Match(\"SroTPTinDays\", Rows(\"1:1\"), 0)\n            STATUSnew = WorksheetFunction.Match(\"srouf_intel_sro_status\", Rows(\"1:1\"), 0)\n            WRKstat = WorksheetFunction.Match(\"Status Code\", Rows(\"1:1\"), 0)\n            OpCode = WorksheetFunction.Match(\"OperationCode\", Rows(\"1:1\"), 0)\n            Priority = WorksheetFunction.Match(\"Priority Code\", Rows(\"1:1\"), 0)\n            OpPartner = WorksheetFunction.Match(\"OperationPartnerName\", Rows(\"1:1\"), 0)\n            DUT = WorksheetFunction.Match(\"LineSerialNum\", Rows(\"1:1\"), 0)\n            OpDesc = WorksheetFunction.Match(\"OperationDescription\", Rows(\"1:1\"), 0)\n            OpStatus = WorksheetFunction.Match(\"OperationStatus\", Rows(\"1:1\"), 0)\n            CreatedBy = WorksheetFunction.Match(\"CreatedBy\", Rows(\"1:1\"), 0)\n\n'adding new sheet - CROPPED DATA\n           Sheets.Add(After:=Sheets(Sheets.Count)).Name = \"Cropped Data\"\n\n'tis where You copy selected columns to CROPPED DATA in specific A-Q order\n            Sheets(\"Imported Data\").Columns(SR0).Copy Destination:=Sheets(\"Cropped Data\").Range(\"A1\")\n            Sheets(\"Imported Data\").Columns(Descpt).Copy Destination:=Sheets(\"Cropped Data\").Range(\"B1\")\n            Sheets(\"Imported Data\").Columns(Stats).Copy Destination:=Sheets(\"Cropped Data\").Range(\"C1\")\n            Sheets(\"Imported Data\").Columns(Project).Copy Destination:=Sheets(\"Cropped Data\").Range(\"D1\")\n            Sheets(\"Imported Data\").Columns(SR0lead).Copy Destination:=Sheets(\"Cropped Data\").Range(\"E1\")\n            Sheets(\"Imported Data\").Columns(OpenDate).Copy Destination:=Sheets(\"Cropped Data\").Range(\"F1\")\n            Sheets(\"Imported Data\").Columns(CloseDate).Copy Destination:=Sheets(\"Cropped Data\").Range(\"G1\")\n            Sheets(\"Imported Data\").Columns(TPT).Copy Destination:=Sheets(\"Cropped Data\").Range(\"H1\")\n            Sheets(\"Imported Data\").Columns(STATUSnew).Copy Destination:=Sheets(\"Cropped Data\").Range(\"I1\")\n            Sheets(\"Imported Data\").Columns(WRKstat).Copy Destination:=Sheets(\"Cropped Data\").Range(\"J1\")\n            Sheets(\"Imported Data\").Columns(Priority).Copy Destination:=Sheets(\"Cropped Data\").Range(\"K1\")\n            Sheets(\"Imported Data\").Columns(CreatedBy).Copy Destination:=Sheets(\"Cropped Data\").Range(\"L1\")\n            Sheets(\"Imported Data\").Columns(OpPartner).Copy Destination:=Sheets(\"Cropped Data\").Range(\"M1\")\n            Sheets(\"Imported Data\").Columns(DUT).Copy Destination:=Sheets(\"Cropped Data\").Range(\"N1\")\n            Sheets(\"Imported Data\").Columns(OpCode).Copy Destination:=Sheets(\"Cropped Data\").Range(\"O1\")\n            Sheets(\"Imported Data\").Columns(OpDesc).Copy Destination:=Sheets(\"Cropped Data\").Range(\"P1\")\n            Sheets(\"Imported Data\").Columns(OpStatus).Copy Destination:=Sheets(\"Cropped Data\").Range(\"Q1\")\n\n</code></pre>\n\n<p>Hope this helps anyone else :)</p>\n"}], "owner": {"reputation": 1, "user_id": 11079965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c65a1114270b45de7bd929ae95e800a?s=128&d=identicon&r=PG", "display_name": "Arain", "link": "https://stackoverflow.com/users/11079965/arain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1561642659, "creation_date": 1561543435, "last_edit_date": 1561550051, "question_id": 56770134, "link": "https://stackoverflow.com/questions/56770134/copy-entire-columns-based-on-specific-headers-from-one-sheet-to-another-in-ot", "title": "Copy entire columns (based on specific headers) from one sheet to another (in other order) does not work on Excel 365", "body": "<p>got a problem i can't overcome alone:</p>\n\n<p>Below code works fine on my Win 8.1 running Excel 2013 Pro (32-bit). It fails miserably on Win 10 with Excel 365 (also 32-bit).</p>\n\n<p>The VBA console is highlighting names i'm assigning to the columns (SRO, Desc, Status, Project ect.) in blue and the \"Private Sub Generate()\" in yellow.</p>\n\n<pre><code>Private Sub Generate()\n\n    Application.EnableEvents = False\n    Application.ScreenUpdating = False\n\n        ActiveWorkbook.Sheets(\"Imported Data\").Activate\n\n'tis where You select what columns You want to copy and name them\n\n            SRO = WorksheetFunction.Match(\"SroNum\", Rows(\"1:1\"), 0)\n            Desc = WorksheetFunction.Match(\"Description\", Rows(\"1:1\"), 0)\n            Status = WorksheetFunction.Match(\"Status\", Rows(\"1:1\"), 0)\n            Project = WorksheetFunction.Match(\"srouf_platform\", Rows(\"1:1\"), 0)\n            SROlead = WorksheetFunction.Match(\"Name\", Rows(\"1:1\"), 0)\n            OpenDate = WorksheetFunction.Match(\"CreateDate\", Rows(\"1:1\"), 0)\n            CloseDate = WorksheetFunction.Match(\"Close Date\", Rows(\"1:1\"), 0)\n            TPT = WorksheetFunction.Match(\"SroTPTinDays\", Rows(\"1:1\"), 0)\n            STATUSnew = WorksheetFunction.Match(\"srouf_intel_sro_status\", Rows(\"1:1\"), 0)\n            WRKstat = WorksheetFunction.Match(\"Status Code\", Rows(\"1:1\"), 0)\n            OpCode = WorksheetFunction.Match(\"OperationCode\", Rows(\"1:1\"), 0)\n            Priority = WorksheetFunction.Match(\"Priority Code\", Rows(\"1:1\"), 0)\n            OpPartner = WorksheetFunction.Match(\"OperationPartnerName\", Rows(\"1:1\"), 0)\n            DUT = WorksheetFunction.Match(\"LineSerialNum\", Rows(\"1:1\"), 0)\n            OpDesc = WorksheetFunction.Match(\"OperationDescription\", Rows(\"1:1\"), 0)\n            OpStatus = WorksheetFunction.Match(\"OperationStatus\", Rows(\"1:1\"), 0)\n            CreatedBy = WorksheetFunction.Match(\"CreatedBy\", Rows(\"1:1\"), 0)\n\n\n'adding new sheet - CROPPED DATA\n        Sheets.Add(After:=Sheets(Sheets.Count)).Name = \"Cropped Data\"\n\n'tis where You copy selected columns to CROPPED DATA in specific A-Q order\n            Sheets(\"Imported Data\").Columns(SRO).Copy Destination:=Sheets(\"Cropped Data\").Range(\"A1\")\n            Sheets(\"Imported Data\").Columns(Desc).Copy Destination:=Sheets(\"Cropped Data\").Range(\"B1\")\n            Sheets(\"Imported Data\").Columns(Status).Copy Destination:=Sheets(\"Cropped Data\").Range(\"C1\")\n            Sheets(\"Imported Data\").Columns(Project).Copy Destination:=Sheets(\"Cropped Data\").Range(\"D1\")\n            Sheets(\"Imported Data\").Columns(SROlead).Copy Destination:=Sheets(\"Cropped Data\").Range(\"E1\")\n            Sheets(\"Imported Data\").Columns(OpenDate).Copy Destination:=Sheets(\"Cropped Data\").Range(\"F1\")\n            Sheets(\"Imported Data\").Columns(CloseDate).Copy Destination:=Sheets(\"Cropped Data\").Range(\"G1\")\n            Sheets(\"Imported Data\").Columns(TPT).Copy Destination:=Sheets(\"Cropped Data\").Range(\"H1\")\n            Sheets(\"Imported Data\").Columns(STATUSnew).Copy Destination:=Sheets(\"Cropped Data\").Range(\"I1\")\n            Sheets(\"Imported Data\").Columns(WRKstat).Copy Destination:=Sheets(\"Cropped Data\").Range(\"J1\")\n            Sheets(\"Imported Data\").Columns(Priority).Copy Destination:=Sheets(\"Cropped Data\").Range(\"K1\")\n            Sheets(\"Imported Data\").Columns(CreatedBy).Copy Destination:=Sheets(\"Cropped Data\").Range(\"L1\")\n            Sheets(\"Imported Data\").Columns(OpPartner).Copy Destination:=Sheets(\"Cropped Data\").Range(\"M1\")\n            Sheets(\"Imported Data\").Columns(DUT).Copy Destination:=Sheets(\"Cropped Data\").Range(\"N1\")\n            Sheets(\"Imported Data\").Columns(OpCode).Copy Destination:=Sheets(\"Cropped Data\").Range(\"O1\")\n            Sheets(\"Imported Data\").Columns(OpDesc).Copy Destination:=Sheets(\"Cropped Data\").Range(\"P1\")\n            Sheets(\"Imported Data\").Columns(OpStatus).Copy Destination:=Sheets(\"Cropped Data\").Range(\"Q1\")\n\nEnd Sub\n</code></pre>\n\n<p>The error I get is: </p>\n\n<blockquote>\n  <p>Compile error in hidden module: Generate.</p>\n</blockquote>\n\n<p>Any other alternatives?\nHow ought i rephrase this, so excel 365 would work?\nI need this code to be as light as possible - tons of data are being processed.</p>\n\n<p>The task stands: find specific header columns in sheet \"Imported Data\" and copy them to new sheet \"cropped data\" but in a different order (and not all of them!).</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1561541410, "post_id": 56769417, "comment_id": 100094655, "body": "If you must use the spacebar to call a macro and don&#39;t wish to lose the space character then your macro should insert the space character at the insertion point when it is called."}, {"owner": {"reputation": 1036, "user_id": 3971072, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3bec54e5385a2523aa6ea6e1c0906ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Vinc199789", "link": "https://stackoverflow.com/users/3971072/vinc199789"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1561542210, "post_id": 56769417, "comment_id": 100095120, "body": "@Freeflow the spacebar was just an example. That example also has the disadvantage that I have to assign a binding for each character on the keyboard."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1561543227, "post_id": 56769417, "comment_id": 100095725, "body": "In that case I think what you want to do is near impossible in VBA."}, {"owner": {"reputation": 1036, "user_id": 3971072, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3bec54e5385a2523aa6ea6e1c0906ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Vinc199789", "link": "https://stackoverflow.com/users/3971072/vinc199789"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1561546608, "post_id": 56769417, "comment_id": 100097743, "body": "@Freeflow What part is impossible? If I can detect a specific keypress, why is it then near impossible to detect multiple keys. In javascript you can, for example, say if keys with the code 30 to 40 are pressed then..."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1561550422, "post_id": 56769417, "comment_id": 100100008, "body": "You need to detect each character (which isn&#39;t clear in your original post) but you don&#39;t want to assign a binding for each character.  Thus you need to intercept the stream of key presses coming into Word.  AFAIK there is no event to do that for Word itself, only when you are in a form or control.  If it were easy I would find lots of solutions when I google.  The fact I don&#39;t find these solutions is telling. I don&#39;t think I can help further."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1561552223, "post_id": 56769417, "comment_id": 100101167, "body": "Word&#39;s built-in ability is limited to keybindings, so yes, it&#39;s necessary to define a binding for each character that should be &quot;trapped&quot;. Note that you could do this once, in a template, then create the documents from that template or possibly load it as an add-in. The only other possibility is to use the Windows API to create &quot;keyboard hooks&quot;. This is not something I&#39;ve ever done &quot;seriously&quot;; I have heard it&#39;s not terribly reliable in Word (Office, generally) due to how the application interfaces handle things, so YMMV."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1561552289, "post_id": 56769417, "comment_id": 100101218, "body": "Some possibly useful links from a Google search: <a href=\"https://renenyffenegger.ch/notes/development/languages/VBA/Win-API/examples/key-press\" rel=\"nofollow noreferrer\">renenyffenegger.ch/notes/development/languages/VBA/Win-API/&hellip;</a>&zwnj;&#8203;, <a href=\"http://www.cpearson.com/excel/keytest.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/keytest.aspx</a>"}, {"owner": {"reputation": 1036, "user_id": 3971072, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3bec54e5385a2523aa6ea6e1c0906ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Vinc199789", "link": "https://stackoverflow.com/users/3971072/vinc199789"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1561650642, "post_id": 56769417, "comment_id": 100144014, "body": "@CindyMeister I found a workaround that works perfectly. See my answer"}], "answers": [{"comments": [{"owner": {"reputation": 1036, "user_id": 3971072, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3bec54e5385a2523aa6ea6e1c0906ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Vinc199789", "link": "https://stackoverflow.com/users/3971072/vinc199789"}, "edited": false, "score": 0, "creation_date": 1561554945, "post_id": 56773220, "comment_id": 100102909, "body": "Thanks for your answer but this does not work for me because a shortcut has to to be for example ctrl + a and I only need &#39;a&#39;  or one of the other letters of the alphabet."}, {"owner": {"reputation": 1540, "user_id": 4705583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iBboA.jpg?s=128&g=1", "display_name": "Rich Michaels", "link": "https://stackoverflow.com/users/4705583/rich-michaels"}, "reply_to_user": {"reputation": 1036, "user_id": 3971072, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3bec54e5385a2523aa6ea6e1c0906ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Vinc199789", "link": "https://stackoverflow.com/users/3971072/vinc199789"}, "edited": false, "score": 0, "creation_date": 1561556007, "post_id": 56773220, "comment_id": 100103611, "body": "@Vinc199789, if you are looking for a two key sequence I suggest Alt+a because the Ctrl key is primarily used by the OS and/or the Office applications."}, {"owner": {"reputation": 1036, "user_id": 3971072, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3bec54e5385a2523aa6ea6e1c0906ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Vinc199789", "link": "https://stackoverflow.com/users/3971072/vinc199789"}, "edited": false, "score": 0, "creation_date": 1561650580, "post_id": 56773220, "comment_id": 100143991, "body": "I found a solution, see my answer"}], "tags": [], "owner": {"reputation": 1540, "user_id": 4705583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iBboA.jpg?s=128&g=1", "display_name": "Rich Michaels", "link": "https://stackoverflow.com/users/4705583/rich-michaels"}, "is_accepted": false, "score": 1, "last_activity_date": 1561553250, "creation_date": 1561553250, "answer_id": 56773220, "question_id": 56769417, "link": "https://stackoverflow.com/questions/56769417/run-word-macro-on-keypress-in-document/56773220#56773220", "title": "Run word macro on keypress in document", "body": "<p>Since your question implies that you are doing this for yourself and not trying to deploy this macro to others, you can simply assign a keyboard shortcut to the macro from Word Options and you don't have to write custom keyboard trapping VBA to do this.</p>\n\n<ol>\n<li>From Word's File tab select Options</li>\n<li>Click Customize Ribbon</li>\n<li>Click Keyboard shortcuts: Customize...</li>\n<li>Select Macros from the All Commands Categories list</li>\n<li>Locate your custom Macro and Assign a custom keyboard sequence</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/cvRgO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cvRgO.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1561588566, "post_id": 56774853, "comment_id": 100118359, "body": "Wow - this looks interesting, can you expand on this example and perhaps share your experience about getting this set up in MS Word? +1"}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1561672155, "post_id": 56774853, "comment_id": 100152295, "body": "Hey Vinc - I disappeared down a AHK rabbit hole yesterday and wow, ... it looks fantastic. Really glad to hear no noticeable speed loss - thanks"}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1561978091, "post_id": 56774853, "comment_id": 100220699, "body": "For anyone following along... this is an interesting read: <a href=\"https://www.autohotkey.com/boards/viewtopic.php?f=7&amp;t=8978\" rel=\"nofollow noreferrer\">autohotkey.com/boards/viewtopic.php?f=7&amp;t=8978</a>"}], "tags": [], "owner": {"reputation": 1036, "user_id": 3971072, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3bec54e5385a2523aa6ea6e1c0906ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Vinc199789", "link": "https://stackoverflow.com/users/3971072/vinc199789"}, "is_accepted": true, "score": 1, "last_activity_date": 1561650492, "last_edit_date": 1561650492, "creation_date": 1561558239, "answer_id": 56774853, "question_id": 56769417, "link": "https://stackoverflow.com/questions/56769417/run-word-macro-on-keypress-in-document/56774853#56774853", "title": "Run word macro on keypress in document", "body": "<p>Via links that were shared in the post, I came across a program called AutoHotKey. After some research, I set up a system where AutoHotkey does the detecting part and then calls the macro in word. I use the following hotkey script:</p>\n\n<pre><code>Keybinding for a-x before this\ny::\n    send y\n    StartLabel(\"a\")\n    return\nz::\n    send z\n    StartLabel(\"a\")\n    return\nSpace::\n    send {Space}\n    StartLabel(\"a\")\n    return\nBackspace::\n    send {Backspace}\n    StartLabel(\"a\")\n    return\n^Backspace::\n    send ^{Backspace} \n    StartLabel(\"a\")\n    return  \n\nStartLabel(x)\n{\n    word:=ComObjActive(\"word.application\")\n    word.run( \"Writeass\" )  &lt;-- macro name. No need to define the module first\n}\n</code></pre>\n\n<p>This script calls the macro every time one of de defined keys is pressed.</p>\n\n<p>With a simple bat file I can start and close the script (to make sure it does not run in the background when wordt is not open). \nBat code to start the script:</p>\n\n<pre><code>start C:\\path to Autohotkey script\\WriteAssistant.ahk\n</code></pre>\n\n<p>Bat code to end the script (killing the autoHotKey process)</p>\n\n<pre><code>taskkill /im AutoHotkey.exe\n</code></pre>\n\n<p>I use the following vba script to start and close the hotkeyscript from a word macro (in my case I made a button in the ribbonbar to start the macro and the first thing it does is start the autoHotKey script):</p>\n\n<pre><code>Path = \"C:\\path\\start.bat\"\nShell Path\n</code></pre>\n\n<p>And best of all, I didn't notice any speed loss. </p>\n"}], "owner": {"reputation": 1036, "user_id": 3971072, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3bec54e5385a2523aa6ea6e1c0906ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Vinc199789", "link": "https://stackoverflow.com/users/3971072/vinc199789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 864, "favorite_count": 0, "accepted_answer_id": 56774853, "answer_count": 2, "score": 1, "last_activity_date": 1561650492, "creation_date": 1561541075, "last_edit_date": 1561552293, "question_id": 56769417, "link": "https://stackoverflow.com/questions/56769417/run-word-macro-on-keypress-in-document", "title": "Run word macro on keypress in document", "body": "<p>What I am trying to create is a writing assistant for MS word that gives me advice during writing. In order for that, I need to check whether the letter or number keys on a keyboard are pressed and if so, run a macro that shows the assistant popup and do the background work.</p>\n\n<p>The problem is that I can't get the keypress detection to work. I tried multiple things like the two examples below but they don't give me the desired effect.</p>\n\n<pre><code>Private Sub document_KeyPress(KeyAscii As Integer)\nIf KeyAscii &gt; -1 Then\n    MsgBox (\"You Pressed a key\")\nEnd If\nEnd Sub\n\nPrivate Sub document_open()\n    'This line may differ depending on whether you are running this from a document template or an add-in.\n    Application.CustomizationContext = ThisDocument.AttachedTemplate\n    ' Create the keybinding.\n    KeyBindings.Add KeyCode:=BuildKeyCode(wdKeySpacebar), KeyCategory:=wdKeyCategoryMacro, Command:=\"MyMacro\"\nEnd Sub\n</code></pre>\n\n<p>The first one is not working at all and the seconds overwrites the keybinding which makes the spacebar in this example useless. With the second example, I also have to assign a binding for each character.</p>\n\n<p>Any advice would be appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1561543550, "post_id": 56769336, "comment_id": 100095912, "body": "So you have no question, that&#39;s great :). If you actually have a question please see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> a question with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and edit your question accordingly so we could help you out where your get stuck."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11702019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1592ddeb8a805f99add53218494b4d40?s=128&d=identicon&r=PG&f=1", "display_name": "omar magdy", "link": "https://stackoverflow.com/users/11702019/omar-magdy"}, "edited": false, "score": 0, "creation_date": 1561575071, "post_id": 56771119, "comment_id": 100113762, "body": "do i have to write the names of all files?"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 1, "user_id": 11702019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1592ddeb8a805f99add53218494b4d40?s=128&d=identicon&r=PG&f=1", "display_name": "omar magdy", "link": "https://stackoverflow.com/users/11702019/omar-magdy"}, "edited": false, "score": 0, "creation_date": 1561584252, "post_id": 56771119, "comment_id": 100117145, "body": "Not sure I understand your question.  Try the code and see if it does what you need.  Post back if you have additional questions."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1561546292, "creation_date": 1561546292, "answer_id": 56771119, "question_id": 56769336, "link": "https://stackoverflow.com/questions/56769336/finding-values-from-several-workbooks-using-the-directory/56771119#56771119", "title": "finding values from several workbooks using the directory", "body": "<p>This will do what you want.</p>\n\n<pre><code>Sub Example()\n    Dim MyPath As String, FilesInPath As String\n    Dim MyFiles() As String, Fnum As Long\n    Dim mybook As Workbook\n    Dim CalcMode As Long\n    Dim sh As Worksheet\n    Dim ErrorYes As Boolean\n\n    'Fill in the path\\folder where the files are\n    MyPath = \"C:\\your_path_here\\\"\n\n    'Add a slash at the end if the user forget it\n    If Right(MyPath, 1) &lt;&gt; \"\\\" Then\n        MyPath = MyPath &amp; \"\\\"\n    End If\n\n    'If there are no Excel files in the folder exit the sub\n    FilesInPath = Dir(MyPath &amp; \"*.xl*\")\n    If FilesInPath = \"\" Then\n        MsgBox \"No files found\"\n        Exit Sub\n    End If\n\n    'Fill the array(myFiles)with the list of Excel files in the folder\n    Fnum = 0\n    Do While FilesInPath &lt;&gt; \"\"\n        Fnum = Fnum + 1\n        ReDim Preserve MyFiles(1 To Fnum)\n        MyFiles(Fnum) = FilesInPath\n        FilesInPath = Dir()\n    Loop\n\n    'Change ScreenUpdating, Calculation and EnableEvents\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    'Loop through all files in the array(myFiles)\n    If Fnum &gt; 0 Then\n        For Fnum = LBound(MyFiles) To UBound(MyFiles)\n            Set mybook = Nothing\n            On Error Resume Next\n            Set mybook = Workbooks.Open(MyPath &amp; MyFiles(Fnum))\n            On Error GoTo 0\n\n            If Not mybook Is Nothing Then\n\n\n                ' do your copy process here ...\n\n\n                If Err.Number &gt; 0 Then\n                    ErrorYes = True\n                    Err.Clear\n                    'Close mybook without saving\n                    mybook.Close savechanges:=False\n                Else\n                    'Save and close mybook\n                    mybook.Close savechanges:=True\n                End If\n                On Error GoTo 0\n            Else\n                'Not possible to open the workbook\n                ErrorYes = True\n            End If\n\n        Next Fnum\n    End If\n\n    If ErrorYes = True Then\n        MsgBox \"There are problems in one or more files, possible problem:\" _\n             &amp; vbNewLine &amp; \"protected workbook/sheet or a sheet/range that not exist\"\n    End If\n\n    'Restore ScreenUpdating, Calculation and EnableEvents\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = CalcMode\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://www.rondebruin.nl/win/s3/win010.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s3/win010.htm</a></p>\n"}], "owner": {"reputation": 1, "user_id": 11702019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1592ddeb8a805f99add53218494b4d40?s=128&d=identicon&r=PG&f=1", "display_name": "omar magdy", "link": "https://stackoverflow.com/users/11702019/omar-magdy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561546292, "creation_date": 1561540833, "last_edit_date": 1561540992, "question_id": 56769336, "link": "https://stackoverflow.com/questions/56769336/finding-values-from-several-workbooks-using-the-directory", "title": "finding values from several workbooks using the directory", "body": "<p>I want to copy data from several workbooks </p>\n\n<p>the directory of the workbooks have order like this </p>\n\n<pre><code>c:\\sheets\\#number #month\\worksheet #date\n</code></pre>\n\n<p>I would like to copy the same range in all workbooks</p>\n\n<p><li>The month format is <code>MMM</code> \n<li>The date format us <code>DD-MMM-YYYY</code></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31833, "user_id": 23574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff71c4381eaf3816bffda6c6fe53d33e?s=128&d=identicon&r=PG", "display_name": "shahkalpesh", "link": "https://stackoverflow.com/users/23574/shahkalpesh"}, "edited": false, "score": 0, "creation_date": 1561540821, "post_id": 56769238, "comment_id": 100094315, "body": "Why would you do <code>change_array(&quot;A1:AX2&quot;,2,2,0.5,1)</code> when it doesnt accept any arguments?"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1561540891, "post_id": 56769238, "comment_id": 100094346, "body": "Your first step should be to put &#39;option explicit&#39; as the first line of your module.  When you have done this the VBA IDE will highlight all the lines in your code which have syntax errors.  &#39;change_array(&quot;A1:AX2&quot;,2,2,0.5,1)&#39; will fail because &#39;Public Sub change_array()&#39; does not include a parameter list.  This omission suggests you should spend some time working through a VBA tutorial."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1561541205, "post_id": 56769238, "comment_id": 100094530, "body": "The only place where you will get <code>Syntax Error</code> is at <code>End Sub</code> line. Remove &quot;```&quot; after end sub"}, {"owner": {"reputation": 205, "user_id": 11584674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0e894de9590680030fbee6c0436e59?s=128&d=identicon&r=PG&f=1", "display_name": "Julia", "link": "https://stackoverflow.com/users/11584674/julia"}, "edited": false, "score": 0, "creation_date": 1561541442, "post_id": 56769238, "comment_id": 100094673, "body": "I only put &quot;```&quot; here, so that the code would be displayed, it is not in my code. Thanks for your comments"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1561541799, "post_id": 56769238, "comment_id": 100094872, "body": "Then the code should compile. I just tested it. Which line gets highlighted when you get the message <code>&quot;Syntax error: cannot be compiled&quot;</code>"}, {"owner": {"reputation": 205, "user_id": 11584674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0e894de9590680030fbee6c0436e59?s=128&d=identicon&r=PG&f=1", "display_name": "Julia", "link": "https://stackoverflow.com/users/11584674/julia"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1561541873, "post_id": 56769238, "comment_id": 100094913, "body": "@SiddharthRout I got it now, many thanks"}], "owner": {"reputation": 205, "user_id": 11584674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0e894de9590680030fbee6c0436e59?s=128&d=identicon&r=PG&f=1", "display_name": "Julia", "link": "https://stackoverflow.com/users/11584674/julia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561542764, "creation_date": 1561540496, "last_edit_date": 1561542764, "question_id": 56769238, "link": "https://stackoverflow.com/questions/56769238/syntax-error-in-vba-code-cant-be-executed", "title": "Syntax error in VBA, code cant be executed", "body": "<p>I wrote the sub \"change_array\". When I try to use it <code>change_array(\"A1:AX2\",2,2,0.5,1)</code>and run it, I get the \"Syntax error: cannot be compiled\".</p>\n\n<p>I tried to use dimension \"As String\" for \"cellref\", yet it did not result in any improvements.</p>\n\n<pre><code>Public Sub change_array() 'Sub does not return value, only executes\n\n     Dim cellref As Range\n     Dim row_number As Long\n     Dim column_number As Long\n     Dim x As Double 'Number, which will be added or multiplied by chosen cell value in an array\n     Dim method As Integer 'One for multiplication, two for addition\n\n     If method = 1 Then\n        Cells(row_number, column_number) = Cells(row_number, column_number) * \"x\"\n    ElseIf method = 2 Then\n        Cells(row_number, column_number) = Cells(row_number, column_number) + \"x\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Expected result would be, that the corresponding value from the chosen array (in this case B2) is multiplied by 0.5</p>\n"}, {"tags": ["sql-server", "excel", "vba", "adodb"], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1561543332, "last_edit_date": 1561543332, "creation_date": 1561541853, "answer_id": 56769642, "question_id": 56769159, "link": "https://stackoverflow.com/questions/56769159/edit-an-ado-recordset-without-altering-the-database/56769642#56769642", "title": "Edit an ADO recordset without altering the database", "body": "<p>You can disconnect the ADO recordset before making the edits. However, depending upon if the recordset is actually updateable, you can still run into errors.</p>\n\n<p>To disconnect the recordset, simply remove the connection:</p>\n\n<pre><code>Set rs.ActiveConnection = Nothing\n</code></pre>\n\n<p>That will prevent it from sending any changes back to the server.</p>\n\n<p>Disconnected recordsets are still dependent on the database with regard to what's writable. They can get reconnected, and should then be able to submit the changes back to the database.</p>\n\n<p>If you want to adjust things that aren't writable on the database side, I recommend moving the recordset to an array. You can use the <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/getrows-method-ado?view=sql-server-2017\" rel=\"nofollow noreferrer\">GetRows method</a> to efficiently move the data.</p>\n"}], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 435, "favorite_count": 0, "accepted_answer_id": 56769642, "answer_count": 1, "score": 0, "last_activity_date": 1561543332, "creation_date": 1561540238, "question_id": 56769159, "link": "https://stackoverflow.com/questions/56769159/edit-an-ado-recordset-without-altering-the-database", "title": "Edit an ADO recordset without altering the database", "body": "<p>I am trying to add some data to a recordset before I paste its contents to a worksheet. I want to treat the recordset disconnected from the DB, thus only changing the imported data itself.  </p>\n\n<p>I used the method from <a href=\"http://www.vbforums.com/showthread.php?508650-Change-recordset-value\" rel=\"nofollow noreferrer\">this thread</a>, but unfortunately I end up with the error:</p>\n\n<blockquote>\n  <p>Multiple-step operation generated errors. Check each status value.</p>\n</blockquote>\n\n<p>In short, I have a query with an empty field which I populate before pasting the rs to the ws.</p>\n\n<p>Note that I have left out a lot of code. All variables are declared.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function getdata(query As String) As ADODB.Recordset\nDim cnn As ADODB.Connection\nDim connstring As String\nSet cnn = New ADODB.Connection\n\nconnstring = \"omitted\"\ncnn.Open connstring\n\nSet getdata = New ADODB.Recordset\n    getdata.CursorLocation = adUseClient\ngetdata.Open query, connstring, adOpenStatic, adLockBatchOptimistic\n\ncnn.Close\nEnd Function\n\n'----------------------------------\n\nSub Start()\n'Code\nDim rs As ADODB.RecordSet\n\nSet rs = getdata(\"Select Code, '' From (values\" &amp; RegularCode &amp; \",\" &amp; RegularCodeBase &amp; \") As AT(Code) Except Select Code, '' From astAssetTypes\")\n\nrs.Fields(1).Value = \"TestValue\" 'Error on this line\n\n'Code\nEnd Sub\n</code></pre>\n\n<p>Alternatively I could populate an array with the recordset and edit that array, but I feel that's a step I needn't to take</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1561541858, "post_id": 56769119, "comment_id": 100094905, "body": "Did you check out PivotTables? See <a href=\"https://www.contextures.com/excel-pivot-table-subtotals.html\" rel=\"nofollow noreferrer\">Excel Pivot Table Subtotals</a>"}, {"owner": {"reputation": 173, "user_id": 7898021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2f50f9ecf7be9e75eabfa654b688fbe?s=128&d=identicon&r=PG&f=1", "display_name": "M. Salem", "link": "https://stackoverflow.com/users/7898021/m-salem"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1561542062, "post_id": 56769119, "comment_id": 100095027, "body": "Yes, but this macro Code is part of another bigger macro where every single part is being imported from differet MIS Systems, and using Pivot table on them is impossible. The table I just represented is not my real date, but to simplify my Question so that experts here understand what I look for."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1561549709, "post_id": 56769119, "comment_id": 100099603, "body": "What is &#39;SUMME&#39;?  I&#39;ve never heard of that before.  Maybe some kind of international setting/configuration, or you are concatenating some characters into your SUM function."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1561549781, "post_id": 56769119, "comment_id": 100099647, "body": "@asher It&#39;s a German Excel so the formulas are localized (german). <code>SUMME</code> is actually <code>SUM</code>."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1561550056, "post_id": 56769119, "comment_id": 100099833, "body": "Oh, I see.  How about firing up the macro recorder then adding subtotals by clicking through the logic you need?  I think that will give you the VBA you need.  I just did the same thing less than 1 hour ago."}, {"owner": {"reputation": 173, "user_id": 7898021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2f50f9ecf7be9e75eabfa654b688fbe?s=128&d=identicon&r=PG&f=1", "display_name": "M. Salem", "link": "https://stackoverflow.com/users/7898021/m-salem"}, "reply_to_user": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1561562532, "post_id": 56769119, "comment_id": 100107834, "body": "@asher, sorry, my operating System is in German and that is why Excel is in German."}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 7898021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2f50f9ecf7be9e75eabfa654b688fbe?s=128&d=identicon&r=PG&f=1", "display_name": "M. Salem", "link": "https://stackoverflow.com/users/7898021/m-salem"}, "edited": false, "score": 0, "creation_date": 1561562455, "post_id": 56772011, "comment_id": 100107793, "body": "Thanks a lot for your help! What you wrote is a strong macro. Your help means a lot."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1561550434, "last_edit_date": 1561550434, "creation_date": 1561549387, "answer_id": 56772011, "question_id": 56769119, "link": "https://stackoverflow.com/questions/56769119/multiple-nested-subtotal-vba-code-with-inserting-sum-formula-in-the-subtotal/56772011#56772011", "title": "Multiple (nested) Subtotal VBA Code with Inserting Sum Formula in the Subtotal", "body": "<p>Actually this is much more complicated then it looks like:</p>\n\n<p>It can do this for unlimited criteria columns and unlimited subtotal sum rows. Just don't forget to adjust the costants:</p>\n\n<pre><code>Const StartRow As Long = 2      'omit headers\nConst CriteriaCount As Long = 3 'amount of criteria columns (here countries + cities + Houses)\nConst SumtotalCount As Long = 3 'amount columns to sumtotal\n</code></pre>\n\n<p>The code:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub CreateSubtotals()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Example\")\n\n    Const StartRow As Long = 2      'omit headers\n    Const CriteriaCount As Long = 3 'amount of criteria columns (here countries + cities + Hauses)\n    Const SumtotalCount As Long = 3 'amount columns to sumtotal\n\n    Dim Criteria() As Variant\n    Criteria = ws.Cells(StartRow, 1).Resize(ColumnSize:=CriteriaCount).Value\n\n    ReDim StartRows(1 To CriteriaCount)\n    Dim i As Long\n    For i = LBound(StartRows) To UBound(StartRows)\n        StartRows(i) = StartRow\n    Next i\n\n    Dim iRow As Long, iCol As Long\n    iRow = StartRow + 1\n\n    Dim LastRow As Long\n    LastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\n    Dim RowsAdded As Long, CriteriaChanged As Boolean\n\n    Do While iRow &lt; LastRow + 2\n        For iCol = CriteriaCount To 1 Step -1\n            CriteriaChanged = False\n            For i = 1 To iCol\n                If Criteria(1, i) &lt;&gt; ws.Cells(iRow, i).Value Then CriteriaChanged = True\n            Next i\n\n            If CriteriaChanged Then\n                ws.Rows(iRow).Insert\n                RowsAdded = RowsAdded + 1\n\n                ws.Cells(iRow, iCol).Value = \"Subtotal \" &amp; Criteria(1, iCol)\n                If iCol = CriteriaCount Then\n                    ws.Cells(iRow, CriteriaCount + 1).Resize(ColumnSize:=SumtotalCount).Formula = \"=Sum(\" &amp; ws.Cells(StartRows(iCol), CriteriaCount + 1).Resize(RowSize:=iRow - StartRows(iCol)).Address(True, False) &amp; \")\"\n                Else\n                    ws.Cells(iRow, CriteriaCount + 1).Resize(ColumnSize:=SumtotalCount).Formula = \"=Sumif(\" &amp; ws.Cells(StartRows(iCol), iCol + 1).Resize(RowSize:=iRow - StartRows(iCol)).Address(True, True) &amp; \",\"\"Subtotal*\"\",\" &amp; ws.Cells(StartRows(iCol), CriteriaCount + 1).Resize(RowSize:=iRow - StartRows(iCol)).Address(True, False) &amp; \")\"\n                End If\n\n                ws.Cells(iRow, iCol).Resize(ColumnSize:=SumtotalCount + CriteriaCount - iCol + 1).Interior.ThemeColor = 7 + iCol 'whatever you want\n\n                For i = iCol To UBound(StartRows)\n                    StartRows(i) = 0\n                Next i\n                iRow = iRow + 1\n            End If\n        Next iCol\n\n        If RowsAdded &lt;&gt; 0 Then\n            Criteria = ws.Cells(iRow, 1).Resize(ColumnSize:=CriteriaCount).Value\n            For i = LBound(StartRows) To UBound(StartRows)\n                If StartRows(i) = 0 Then StartRows(i) = iRow\n            Next i\n\n            LastRow = LastRow + RowsAdded 'if we insert a row we must increas last row\n            RowsAdded = 0\n        End If\n\n        iRow = iRow + 1\n    Loop\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/3MmVo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3MmVo.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 173, "user_id": 7898021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2f50f9ecf7be9e75eabfa654b688fbe?s=128&d=identicon&r=PG&f=1", "display_name": "M. Salem", "link": "https://stackoverflow.com/users/7898021/m-salem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1006, "favorite_count": 0, "accepted_answer_id": 56772011, "answer_count": 1, "score": 0, "last_activity_date": 1561550434, "creation_date": 1561540076, "last_edit_date": 1561543243, "question_id": 56769119, "link": "https://stackoverflow.com/questions/56769119/multiple-nested-subtotal-vba-code-with-inserting-sum-formula-in-the-subtotal", "title": "Multiple (nested) Subtotal VBA Code with Inserting Sum Formula in the Subtotal", "body": "<p>I would like to create a nested subtotal macro, meaning to have one subtotal for column \u201ccountries\u201d and one subtotal for column \u201ccities.\u201d I use the below code to get the subtotal for countries, but I don\u2019t know how to expand the code to get subtotal for cities.</p>\n\n<p>One condition in my code is that the sum formula should exist in the subtotal row to make sure having the correct range.  </p>\n\n<p>I tried different ways to get the subtotal for cities, but the range of sum formula will be changed as the macro inserts a new to create for a new subtotal.</p>\n\n<p>My idea is to have a code in two steps:</p>\n\n<ol>\n<li>Get the subtotal for countries as hard values ---> having hard values help us avoid the distortion of formula as macro creates subtotal for cities</li>\n<li>Get the subtotal for cities as sum formulas \nHere is the current code I used to create subtotal for countries as sum formula inside.</li>\n</ol>\n\n<p>The Code I use for creating a subtotal for column countries:</p>\n\n<pre><code>Dim iCol As Integer 'number of columns\nDim i As Integer 'Macro starts from this row number\nDim j As Integer 'Macro continues with this row number in the loop\n\nWorksheets(\"Example\").Activate\n\nApplication.ScreenUpdating = False\ni = 2 'starts from row 2\nj = i\n'Loops throught Col A Checking for match then when there is no match add Sum\nDo While Range(\"A\" &amp; i) &lt;&gt; \"\"\n    If Range(\"A\" &amp; i) &lt;&gt; Range(\"A\" &amp; (i + 1)) Then\n        Rows(i + 1).Insert\n        Range(\"A\" &amp; (i + 1)) = \"Subtotal \" &amp; Range(\"A\" &amp; i).Value\n        For iCol = 3 To 4 'Columns to Sum\n            Cells(i + 1, iCol).Formula = \"=SUM(R\" &amp; j &amp; \"C:R\" &amp; i &amp; \"C)\"\n        Next iCol\n        Range(Cells(i + 1, 1), Cells(i + 1, 4)).Font.Bold = True\n        Range(Cells(i + 1, 1), Cells(i + 1, 4)).Interior.Color = RGB(221, 237, 245)\n        i = i + 2\n        j = i\n    Else\n        i = i + 1\n    End If\nLoop\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>Here is the screenshot of what I would like to have after running the code.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Kngo3.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Kngo3.jpg\" alt=\"Original Data Before Implemeting the code\"></a></p>\n\n<p>This is my desired output</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ou7kD.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ou7kD.jpg\" alt=\"This is my desired output\"></a></p>\n\n<p>I appreciate your help.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1561540274, "post_id": 56769151, "comment_id": 100094040, "body": "I think the variable is <code>lrow</code>.  See the last 2 lines of the code :)"}, {"owner": {"reputation": 13, "user_id": 11491641, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207460409348921/picture?type=large", "display_name": "Nicola Bazinga Dragoni", "link": "https://stackoverflow.com/users/11491641/nicola-bazinga-dragoni"}, "edited": false, "score": 0, "creation_date": 1561540473, "post_id": 56769151, "comment_id": 100094127, "body": "Hi Nick and thanks for your answer.  I added the code you suggested but now I get error 1004 for this part of the code : ActiveCell.FormulaR1C1 = _         &quot;=IFERROR(VLOOKUP(RC[-12],[petest.xlsx]Sheet1!A1:&quot; &amp; lrow2 &amp; &quot;,8,FALSE),RC[-1])&quot;"}, {"owner": {"reputation": 2465, "user_id": 2570277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0483cce5f2ea53671a36477fed79898b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2570277/nick"}, "reply_to_user": {"reputation": 13, "user_id": 11491641, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207460409348921/picture?type=large", "display_name": "Nicola Bazinga Dragoni", "link": "https://stackoverflow.com/users/11491641/nicola-bazinga-dragoni"}, "edited": false, "score": 0, "creation_date": 1561540534, "post_id": 56769151, "comment_id": 100094166, "body": "@NicolaBazingaDragoni, change the lrow2 to lrow"}, {"owner": {"reputation": 2465, "user_id": 2570277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0483cce5f2ea53671a36477fed79898b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2570277/nick"}, "reply_to_user": {"reputation": 13, "user_id": 11491641, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207460409348921/picture?type=large", "display_name": "Nicola Bazinga Dragoni", "link": "https://stackoverflow.com/users/11491641/nicola-bazinga-dragoni"}, "edited": false, "score": 0, "creation_date": 1561540662, "post_id": 56769151, "comment_id": 100094224, "body": "@NicolaBazingaDragoni ok let me test the code. By the way can you post the code you are using to count the rows? i take it you are trying to enter the formula down a column?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 13, "user_id": 11491641, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207460409348921/picture?type=large", "display_name": "Nicola Bazinga Dragoni", "link": "https://stackoverflow.com/users/11491641/nicola-bazinga-dragoni"}, "edited": false, "score": 0, "creation_date": 1561540844, "post_id": 56769151, "comment_id": 100094327, "body": "@NicolaBazingaDragoni: Try changing <code>Sheet1!A1:&quot; &amp; lrow &amp; &quot;</code> to <code>Sheet1!A1:J&quot; &amp; lrow &amp; &quot;</code> You are missing an end column in the table"}, {"owner": {"reputation": 2465, "user_id": 2570277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0483cce5f2ea53671a36477fed79898b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2570277/nick"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1561541046, "post_id": 56769151, "comment_id": 100094434, "body": "@SiddharthRout good point, just edited the answer to add that."}], "tags": [], "owner": {"reputation": 2465, "user_id": 2570277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0483cce5f2ea53671a36477fed79898b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2570277/nick"}, "is_accepted": false, "score": 1, "last_activity_date": 1561540999, "last_edit_date": 1561540999, "creation_date": 1561540204, "answer_id": 56769151, "question_id": 56769063, "link": "https://stackoverflow.com/questions/56769063/how-to-use-vlookup-in-vba/56769151#56769151", "title": "How to use Vlookup in vba", "body": "<p>Try changing this line :</p>\n\n<pre><code> ActiveCell.FormulaR1C1 = _\n    \"=IFERROR(VLOOKUP(RC[-12],[petest.xlsx]Sheet1!A1:\"&amp;lrow2,8,FALSE),RC[-1])\"\n</code></pre>\n\n<p>to</p>\n\n<pre><code> ActiveCell.FormulaR1C1 = _\n        \"=IFERROR(VLOOKUP(RC[-12],[petest.xlsx]Sheet1!A1:L\" &amp; lrow &amp; \",8,FALSE),RC[-1])\"\n</code></pre>\n\n<p>This will insert the actual value of lrow into the formula</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>You need to add \"L\" to the vlookup formula so it has A1:L and not just A1. I have edited the code above. Try that please</p>\n"}], "owner": {"reputation": 13, "user_id": 11491641, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207460409348921/picture?type=large", "display_name": "Nicola Bazinga Dragoni", "link": "https://stackoverflow.com/users/11491641/nicola-bazinga-dragoni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561540999, "creation_date": 1561539883, "last_edit_date": 1561540112, "question_id": 56769063, "link": "https://stackoverflow.com/questions/56769063/how-to-use-vlookup-in-vba", "title": "How to use Vlookup in vba", "body": "<p>I am trying to use vlookup through VBA to fetch values across two different workbooks (A,B) and fill some values in a column of workbook A</p>\n\n<p>The important requirment for me is that the search range in workbook B should be dynamic.</p>\n\n<p>Therefore I have already calculated the number of rows of the table in workbook B.</p>\n\n<p>Here is the code I tried to write.It does not compile due to the syntax error inside the Vlookup:</p>\n\n<pre><code>ActiveWorkbook.Sheets(\"Sheet1\").Activate\n     Columns(\"M:M\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(\"M2\").Select\n    ActiveCell.FormulaR1C1 = _\n        \"=IFERROR(VLOOKUP(RC[-12],[petest.xlsx]Sheet1!A1:\"&amp;lrow2,8,FALSE),RC[-1])\"\n    Range(\"M2\").Select\n    Selection.AutoFill Destination:=Range(\"M2:M\" &amp; lrow)\n    Range(\"M2:M\" &amp; lrow).Select\n</code></pre>\n\n<p>Here lrow contains the last column of the table of the first workbook while lrow2 the last column in the second workbook ( the one I am searching into)</p>\n"}, {"tags": ["excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1561540487, "post_id": 56768951, "comment_id": 100094136, "body": "Try describing your post by mentioning the visible text of that desired button."}, {"owner": {"reputation": 45, "user_id": 10298432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eac9c30a3e52a54aca50dbadc60ae9cc?s=128&d=identicon&r=PG&f=1", "display_name": "v1787v", "link": "https://stackoverflow.com/users/10298432/v1787v"}, "reply_to_user": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1561541201, "post_id": 56768951, "comment_id": 100094523, "body": "Thank sir.. Button : Search.  elements(&quot;cbSite_I&quot;) : &quot;Container delivery area&quot; Box.  elements(&quot;txtItemNo_I&quot;) : &quot;Container (*)&quot; Box"}, {"owner": {"reputation": 45, "user_id": 10298432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eac9c30a3e52a54aca50dbadc60ae9cc?s=128&d=identicon&r=PG&f=1", "display_name": "v1787v", "link": "https://stackoverflow.com/users/10298432/v1787v"}, "reply_to_user": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1561590428, "post_id": 56768951, "comment_id": 100118802, "body": "@SIM : Any update sir?"}, {"owner": {"reputation": 45, "user_id": 10298432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eac9c30a3e52a54aca50dbadc60ae9cc?s=128&d=identicon&r=PG&f=1", "display_name": "v1787v", "link": "https://stackoverflow.com/users/10298432/v1787v"}, "reply_to_user": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1561634713, "post_id": 56768951, "comment_id": 100134174, "body": "Pls kindly help me !!!!"}], "owner": {"reputation": 45, "user_id": 10298432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eac9c30a3e52a54aca50dbadc60ae9cc?s=128&d=identicon&r=PG&f=1", "display_name": "v1787v", "link": "https://stackoverflow.com/users/10298432/v1787v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 659, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561615527, "creation_date": 1561539472, "last_edit_date": 1561541899, "question_id": 56768951, "link": "https://stackoverflow.com/questions/56768951/web-scraping-to-select-drop-down-list-in-website", "title": "Web scraping to Select drop down list in website", "body": "<p>After button element \"ContentPlaceHolder2_btnSearch\" is click, element \"cbSite_I\" returns to blank. I want element \"cbSite_I\" to have value \n\"C\u00e1t L\u00e1i\" after element \"ContentPlaceHolder2_btnSearch\" is click. Pls kindly help me accordingly. Thanks. </p>\n\n<pre><code>Sub Web()\n\nDim IE As New SHDocVw.InternetExplorer\n\nOn Error GoTo Errorcatch\nApplication.ScreenUpdating = False\n\nIE.Visible = True\n\nIE.Navigate \"https://eport.saigonnewport.com.vn/Pages/Common/Containers_new\"\n\nDo While IE.ReadyState &lt;&gt; READYSTATE_COMPLETE Or IE.Busy\nDoEvents\nLoop\n\n'Application.Wait Now + TimeSerial(0, 0, 5)\n\nIE.document.forms(\"form2\").elements(\"cbSite_I\").Value = \"C\u00e1t L\u00e1i\"\nIE.document.forms(\"form2\").elements(\"txtItemNo_I\").Value = \"MSKU1183832\"\nIE.document.forms(\"form2\").elements(\"ContentPlaceHolder2_btnSearch\").Click\n\nDo While IE.ReadyState &lt;&gt; READYSTATE_COMPLETE Or IE.Busy\nDoEvents\nLoop\n\n'Application.Wait Now + TimeSerial(0, 0, 5)\n\nRange(\"A2\").Value = IE.document.getElementById(\"grdContainer_DXDataRow0\").Children(17).textContent\n\nSet IE = Refresh\nSet IE = Nothing\nIE.Quit\n\nExit Sub\nErrorcatch:\nMsgBox Err.Description\nSet IE = Nothing\nIE.Quit\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1561538249, "post_id": 56768506, "comment_id": 100092832, "body": "<code>Workbooks.Open filename, UpdateLinks:=False)</code> or True"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "edited": false, "score": 0, "creation_date": 1561538639, "post_id": 56768552, "comment_id": 100093054, "body": "Worked well with two pop-ups. Still, get one. See my edit to view the image of the pop-up"}], "tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": true, "score": 3, "last_activity_date": 1561538937, "last_edit_date": 1561538937, "creation_date": 1561538038, "answer_id": 56768552, "question_id": 56768506, "link": "https://stackoverflow.com/questions/56768506/how-do-i-prevent-pop-up-boxes-from-coming-up-while-executing-the-code/56768552#56768552", "title": "How do I prevent pop-up boxes from coming up while executing the code?", "body": "<p>Display messages can easily be avoided like so:</p>\n\n<pre><code>Sub test()\nApplication.DisplayAlerts = False\n\n'Code\n\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong><br>\nTo avoid the Update warning:</p>\n\n<pre><code>Sub test()\nApplication.AskToUpdateLinks = False\nApplication.DisplayAlerts = False\n\n'Code\n\nApplication.AskToUpdateLinks = True\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>And in case you're just opening a workbook, this is sufficient:</p>\n\n<pre><code>Application.Workbooks.Open Filename:=\"C:\\test.xlsx\", UpdateLinks:=False\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 56768552, "answer_count": 1, "score": 1, "last_activity_date": 1561538937, "creation_date": 1561537878, "last_edit_date": 1561538677, "question_id": 56768506, "link": "https://stackoverflow.com/questions/56768506/how-do-i-prevent-pop-up-boxes-from-coming-up-while-executing-the-code", "title": "How do I prevent pop-up boxes from coming up while executing the code?", "body": "<p><a href=\"https://i.stack.imgur.com/eDyqd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eDyqd.png\" alt=\"POP UP\"></a>I have a code which copied data between files. Some of these files have links to other files. So, when I run my macro to automatically copy data to other files, I get these pop-ups asking me whether I want to update these links. And after selecting \"update\", I get another pop-up saying that these links cannot be updated and asking me whether I would like to continue. Even while saving the file after copying, I get a pop-up saying \"Be careful....\"\nI do not want these pop-ups to appear while running the code. I want it to be fully automatic i.e. without any manual intervention</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1561540722, "post_id": 56768377, "comment_id": 100094260, "body": "Are these SELECT queries (where you want to open the datasheet) or UPDATE queries (that you want to execute)?"}, {"owner": {"reputation": 17, "user_id": 11338421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d2f693194b6dbe28f46019c2307f8f?s=128&d=identicon&r=PG&f=1", "display_name": "Stewillo1", "link": "https://stackoverflow.com/users/11338421/stewillo1"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1561541242, "post_id": 56768377, "comment_id": 100094552, "body": "Hi @Andre , they are just SELECT queries where I want to open the datasheet. Hope that helps."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 11338421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d2f693194b6dbe28f46019c2307f8f?s=128&d=identicon&r=PG&f=1", "display_name": "Stewillo1", "link": "https://stackoverflow.com/users/11338421/stewillo1"}, "edited": false, "score": 0, "creation_date": 1561545265, "post_id": 56770642, "comment_id": 100097003, "body": "Thanks for the help Andre. So if I was to amend the above, based on my combo box being called &#39;Combo97&#39;, would the code be as follows? Private Sub cmdRun_Click()      DoCmd.OpenQuery Me.cboCombo97.Value  End Sub"}, {"owner": {"reputation": 17, "user_id": 11338421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d2f693194b6dbe28f46019c2307f8f?s=128&d=identicon&r=PG&f=1", "display_name": "Stewillo1", "link": "https://stackoverflow.com/users/11338421/stewillo1"}, "edited": false, "score": 0, "creation_date": 1561546139, "post_id": 56770642, "comment_id": 100097441, "body": "I have amended the combo box name to cboQuery and ran the above that you suggested however just get the Macros box pop up, asking for a macro name and then giving the option to create. Any idea where I am going wrong?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 17, "user_id": 11338421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d2f693194b6dbe28f46019c2307f8f?s=128&d=identicon&r=PG&f=1", "display_name": "Stewillo1", "link": "https://stackoverflow.com/users/11338421/stewillo1"}, "edited": false, "score": 0, "creation_date": 1561546229, "post_id": 56770642, "comment_id": 100097504, "body": "Sorry, but please Google for &quot;access vba tutorial&quot;. This is not the place."}, {"owner": {"reputation": 17, "user_id": 11338421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d2f693194b6dbe28f46019c2307f8f?s=128&d=identicon&r=PG&f=1", "display_name": "Stewillo1", "link": "https://stackoverflow.com/users/11338421/stewillo1"}, "edited": false, "score": 1, "creation_date": 1561641504, "post_id": 56770642, "comment_id": 100138296, "body": "Managed to figure it out based on the code you sent - thanks for your help."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1561544951, "creation_date": 1561544951, "answer_id": 56770642, "question_id": 56768377, "link": "https://stackoverflow.com/questions/56768377/is-vba-required-to-run-a-sql-query-based-on-the-name-in-the-combo-box/56770642#56770642", "title": "Is VBA required to run a SQL query based on the name in the combo box?", "body": "<p>Just use the <code>On Click</code> event of the button (use the \"...\" button to build an event procedure):</p>\n\n<pre><code>Private Sub cmdRun_Click()\n\n    DoCmd.OpenQuery Me.cboQuery.Value\n\nEnd Sub\n</code></pre>\n\n<p>Adapt control names to your form.</p>\n"}], "owner": {"reputation": 17, "user_id": 11338421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d2f693194b6dbe28f46019c2307f8f?s=128&d=identicon&r=PG&f=1", "display_name": "Stewillo1", "link": "https://stackoverflow.com/users/11338421/stewillo1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 56770642, "answer_count": 1, "score": 0, "last_activity_date": 1594714900, "creation_date": 1561537461, "last_edit_date": 1594714900, "question_id": 56768377, "link": "https://stackoverflow.com/questions/56768377/is-vba-required-to-run-a-sql-query-based-on-the-name-in-the-combo-box", "title": "Is VBA required to run a SQL query based on the name in the combo box?", "body": "<p>I have a form in Access 2010 with a number of queries existing in the same Database. I've created a combo box which provides a list of all of the query names using SQL in the Row Source box in the property sheet:</p>\n\n<pre><code>SELECT m.[name] FROM msysobjects AS m WHERE m.type=5 and m.name not alike \"~%\" ORDER BY m.name; \n</code></pre>\n\n<p>The Row/Source type is set to 'Table/Query' and the Bound column is set to '1'. I have also created a command button which I want to link to the combo box (currently called 'Run'). </p>\n\n<p>What I'm looking to do is for the command button to run whichever query name the user selects from the Combo Box list, however I'm unsure how this would be achieved. I believe it may require some VBA which I'm not experienced in unfortunately.</p>\n\n<p>I have tried to link the command button directly to the Combo Box however have been unsuccessful, as above I believe this may require some sort of VBA code.</p>\n\n<p>Any help on the above would be really appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1561536799, "post_id": 56767976, "comment_id": 100092069, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/36024342/how-to-put-excel-vba-into-git\">How to put Excel VBA into git</a>"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1561536867, "post_id": 56767976, "comment_id": 100092108, "body": "@P\u1d07\u029c That doesn&#39;t provide a way to do it through VBA."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1561536894, "post_id": 56767976, "comment_id": 100092127, "body": "Or make use of one of the tools that already exist. Don&#39;t re-invent the wheel: Just one example (you will find more on Google): <a href=\"https://xltools.net/version-control-for-vba-macros/\" rel=\"nofollow noreferrer\">xltools.net/version-control-for-vba-macros</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1561537240, "post_id": 56767976, "comment_id": 100092296, "body": "@ErikA Yes, but since the <i>&quot;Reason for this is to allow code revision control&quot;</i> under git it, is not necessary to do this with VBA. See <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">What is the x/y problem</a>. Sometimes people just ask for X because they didn&#39;t realise that their actual problem is Y."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1561537267, "post_id": 56767976, "comment_id": 100092310, "body": "If you want to run the VBA code from a text file then you can do this. <b>[1]</b> At run time, create a copy of the text file <b>[2]</b> Rename the file to <code>.vbs</code> <b>[3]</b> Execute the <code>.vbs</code> file <b>[4]</b> Delete the copy. <b>[Note]</b> I would recommend slightly amending the code to make it compatible for <code>vbscript</code>. It is almost same to vba :)"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1561537565, "post_id": 56767976, "comment_id": 100092477, "body": "@P\u1d07\u029c The XY problem is not a valid close reason, just a reason why a question might be silly. This one isn&#39;t, in my opinion. Importing modules from text files has many uses, such as actively updating the VBA part of Excel files with managed content."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1561537750, "post_id": 56767976, "comment_id": 100092570, "body": "@ErikA did you see the git project in the second answer of my duplicate link? It provides VBA code which <i>&quot;\u2026 primary use case is for you to use this code as it is, without modifying it, as a tool for importing/exporting your own code.&quot;</i> \u2026 to <i>&quot;put it under version control e.g. Git.&quot;</i>"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1561537812, "post_id": 56767976, "comment_id": 100092613, "body": "@P\u1d07\u029c Yes, but this question is narrowly defined. While the larger goal can be achieved with the duplicate, this specific approach is not covered, and the question is about a specific approach..."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1561537962, "post_id": 56767976, "comment_id": 100092681, "body": "@raf Check if this VBA module meets your requirements <a href=\"https://github.com/ColmBhandal/VbaSync\" rel=\"nofollow noreferrer\">github.com/ColmBhandal/VbaSync</a>"}, {"owner": {"reputation": 936, "user_id": 5069105, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/fbdb2960bb10756e3121a0512456b405?s=128&d=identicon&r=PG&f=1", "display_name": "Raf", "link": "https://stackoverflow.com/users/5069105/raf"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1561538564, "post_id": 56767976, "comment_id": 100093012, "body": "@P\u1d07\u029c Thanks for the link. It looks interesting but the work around is larger than my module I&#39;m trying to import - it feels like using a cannon to kill a fly =)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1561538774, "post_id": 56767976, "comment_id": 100093127, "body": "@Raf Well, don&#39;t get how this is an argument not to use it. Eg. the code of git is even larger than your code, so you cannot use this too?"}, {"owner": {"reputation": 936, "user_id": 5069105, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/fbdb2960bb10756e3121a0512456b405?s=128&d=identicon&r=PG&f=1", "display_name": "Raf", "link": "https://stackoverflow.com/users/5069105/raf"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1561539016, "post_id": 56767976, "comment_id": 100093276, "body": "@P\u1d07\u029c KISS - see Erik A answer below. Just testing it before I accept."}], "answers": [{"comments": [{"owner": {"reputation": 936, "user_id": 5069105, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/fbdb2960bb10756e3121a0512456b405?s=128&d=identicon&r=PG&f=1", "display_name": "Raf", "link": "https://stackoverflow.com/users/5069105/raf"}, "edited": false, "score": 0, "creation_date": 1561546148, "post_id": 56768453, "comment_id": 100097450, "body": "Thanks Erik. This seems to be the right way to go. For completeness would be good to include code to handle previous existence of a module with same name and also removing the module when done so it doesn&#39;t stick to the excel file. Also, worth mentioning that it only works for unprotected projects."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 936, "user_id": 5069105, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/fbdb2960bb10756e3121a0512456b405?s=128&d=identicon&r=PG&f=1", "display_name": "Raf", "link": "https://stackoverflow.com/users/5069105/raf"}, "edited": false, "score": 0, "creation_date": 1561546332, "post_id": 56768453, "comment_id": 100097561, "body": "Feel free to edit that in if you feel it&#39;s relevant, these things seem obvious to me. I&#39;ll try to review it before it goes through the queue/"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 3, "last_activity_date": 1561537695, "creation_date": 1561537695, "answer_id": 56768453, "question_id": 56767976, "link": "https://stackoverflow.com/questions/56767976/how-to-have-excel-to-run-vba-code-saved-in-a-text-file/56768453#56768453", "title": "How to have Excel to run VBA code saved in a text file?", "body": "<p>You can easily import a VBA file using a simple one-liner:</p>\n\n<pre><code>Application.VBE.ActiveVBProject.VBComponents.Import \"C:\\Path\\To\\File.bas\"\n</code></pre>\n\n<p>This works with files exported from the VBA IDE, which include information like module name and other properties that can be configured on a per-module basis.</p>\n\n<p>You need to enable <em>Trust access to the VBA project object model</em> for this to work. You can find that in the trust center settings, under <em>Macro Settings</em>.</p>\n"}], "owner": {"reputation": 936, "user_id": 5069105, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/fbdb2960bb10756e3121a0512456b405?s=128&d=identicon&r=PG&f=1", "display_name": "Raf", "link": "https://stackoverflow.com/users/5069105/raf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 0, "accepted_answer_id": 56768453, "answer_count": 1, "score": 1, "last_activity_date": 1561537843, "creation_date": 1561535994, "last_edit_date": 1561537843, "question_id": 56767976, "link": "https://stackoverflow.com/questions/56767976/how-to-have-excel-to-run-vba-code-saved-in-a-text-file", "title": "How to have Excel to run VBA code saved in a text file?", "body": "<p>Instead of having the VBA code saved in a module inside the Excel file, I would like to have the code saved in a text file, for example <code>module1.vba</code>. In Excel, <code>module1.vba</code> would be loaded or imported and run as it was a normal module.</p>\n\n<p>Is that possible? How to do that?</p>\n\n<p>In Excel, in the VBA editor, there is the option <code>Insert &gt; File...</code> in the menu that does sort of what I want, but I don't know how to automate that with a minimal VBA code to load the real code saved as text.</p>\n\n<p>Reason for this is to allow code revision control using text based applications like <code>git</code>.</p>\n\n<p>--- edit ---</p>\n\n<p>This <a href=\"https://stackoverflow.com/a/45877392/5069105\">answer</a> shows a good alternative work around. However I'm still not too happy in duplicating things. </p>\n"}, {"tags": ["vba", "outlook", "notifications", "status"], "answers": [{"comments": [{"owner": {"reputation": 525, "user_id": 1635670, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/158f329295d4e01d527802628153fa4e?s=128&d=identicon&r=PG", "display_name": "jumpjack", "link": "https://stackoverflow.com/users/1635670/jumpjack"}, "edited": false, "score": 0, "creation_date": 1561707483, "post_id": 56781231, "comment_id": 100159921, "body": "It looks like the easiest and fastest method is to create my own form, as large as the screen, 30 pixels high and with yellow background, to simulate the &quot;message bar&quot;."}], "tags": [], "owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "is_accepted": false, "score": 2, "last_activity_date": 1561585030, "creation_date": 1561585030, "answer_id": 56781231, "question_id": 56767968, "link": "https://stackoverflow.com/questions/56767968/how-to-access-message-bar-in-outlook/56781231#56781231", "title": "How to access &quot;message bar&quot; in Outlook?", "body": "<p>The area you are referring to is used to implement <a href=\"https://docs.microsoft.com/en-us/exchange/clients-and-mobile-in-exchange-online/mailtips/mailtips\" rel=\"nofollow noreferrer\">Mail Tips</a>. Although you can create custom ones through the Exchange Admin Center , they cannot be interacted with via code.</p>\n\n<p>Manipulating Ribbon controls to show states or user messages is not really recommended, as the Ribbon is generally a static thing (except in case of menus, dropdowns and Galleries).</p>\n\n<p>If your goal is to show a transient alert, a better approach would be to use the Windows SDK to show Windows notifications. If having your alert hosted in Outlook is of the utmost importance, then look into using Form Regions or an add-in with Task Panes to display your messaging. Or even a simple VBA MessageBox or User Form.</p>\n\n<p>Also note that your usage of the CommandBar is really only applicable to Outlook 2007 and earlier - there are no more CommandBars in newer versions, just the Ribbon.</p>\n"}], "owner": {"reputation": 525, "user_id": 1635670, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/158f329295d4e01d527802628153fa4e?s=128&d=identicon&r=PG", "display_name": "jumpjack", "link": "https://stackoverflow.com/users/1635670/jumpjack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1608939258, "creation_date": 1561535964, "last_edit_date": 1608939258, "question_id": 56767968, "link": "https://stackoverflow.com/questions/56767968/how-to-access-message-bar-in-outlook", "title": "How to access &quot;message bar&quot; in Outlook?", "body": "<p>When I enable &quot;Out Of Office&quot; automatic messages in Outlook 2010, the &quot;message bar&quot; is filled in with a warning text. I would like to use such a feature to  inform the user of my own feature being enabled.</p>\n<p>I cannot find any reference to programmatic access to this bar. I found something about the statusbar, but it is not usable in VBA in Outlook.</p>\n<p>I am not even sure the proper English name of this feature is &quot;message bar&quot;; I am referring to the same bar which in Word is used to inform user that a document is &quot;dangerous&quot; because coming from internet.</p>\n<p>Is this message bar exposed in VBA for Outlook?</p>\n<p>I tried finding other methods to inform the user, so I started studying the Ribbon: if I could make my own tab visible I could use it as a &quot;message bar&quot;, but Ribbon is managed by Outlook differently from other Office programs, so most of examples available around are not applicable/working in Outlook.</p>\n<p>I was able to programmatically create a tab and add a button to it, but then I can't make the tab visible.</p>\n<p>I also tried using property &quot;position&quot; of the commandbar: not just msoBarTop but also msoBarBottom or msoBarPopup, but Outlook ignores my efforts.</p>\n<p>But maybe managing the Ribbon in Outlook with VBA should be addressed in a separate question (there are some questions about it here, but I could not find useful tips for me; I have no access to VB VSTO).</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1561536015, "post_id": 56767910, "comment_id": 100091701, "body": "<code>k</code> is not defined so <code>k</code> is <code>0</code> and row <code>0</code> does not exist so <code>Cells(k, 12)</code> fails. The code in your picture is not the code in your question! Be clear what we are talking about. \u2022 Also specify in which worksheet your cells and ranges are like <code>Worksheets(&quot;Sheet1&quot;).Range(\u2026)</code> otherwise Excel cannot know it and guesses (and may guess wrong). \u2022 If you turn <code>ScreenUpdating = False</code>  don&#39;t forget to turn it <code>True</code> in the end. Same for <code>Calculation = xlCalculationManual</code> which you might want to turn back to automatic."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1561536368, "post_id": 56767910, "comment_id": 100091855, "body": "Aso make sure you use <code>Option Explicit</code> and declare <b>all</b> your variables properly."}, {"owner": {"reputation": 93, "user_id": 8335171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3549cc51906e5b76f996d4dc3d9a27c?s=128&d=identicon&r=PG&f=1", "display_name": "fauxpas", "link": "https://stackoverflow.com/users/8335171/fauxpas"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1561536424, "post_id": 56767910, "comment_id": 100091887, "body": "@P\u1d07\u029c thanks for your help! I resolved some of your comments in the updated code. And I have faced a new issue..."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1561536536, "post_id": 56767910, "comment_id": 100091956, "body": "In which line is the errror? Please take into account also the other issues I mentioned in my comments. All of them are quite important to produce a solid code."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1561537255, "post_id": 56767910, "comment_id": 100092306, "body": "Please, specify both the workbook and worksheet for each range object. Otherwise VBA will refer to the active workbook and -sheet"}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 8335171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3549cc51906e5b76f996d4dc3d9a27c?s=128&d=identicon&r=PG&f=1", "display_name": "fauxpas", "link": "https://stackoverflow.com/users/8335171/fauxpas"}, "edited": false, "score": 0, "creation_date": 1561539292, "post_id": 56768447, "comment_id": 100093457, "body": "Thank you so much! That works, I would like to check, for the line: Rng = Range(Cells(k, 12), Cells(k,9999))  I only need the even number cols, how should I do it? Aka Range(Cells(k,12), Cells(k, 14), ..., Cells(k,9998))"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 93, "user_id": 8335171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3549cc51906e5b76f996d4dc3d9a27c?s=128&d=identicon&r=PG&f=1", "display_name": "fauxpas", "link": "https://stackoverflow.com/users/8335171/fauxpas"}, "edited": false, "score": 0, "creation_date": 1561540030, "post_id": 56768447, "comment_id": 100093888, "body": "<code>For k = 3 To numDays + 1</code> If you want even numbers then start from <code>4</code> instead of <code>3</code> and use <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/fornext-statement\" rel=\"nofollow noreferrer\">STEP</a>"}, {"owner": {"reputation": 93, "user_id": 8335171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3549cc51906e5b76f996d4dc3d9a27c?s=128&d=identicon&r=PG&f=1", "display_name": "fauxpas", "link": "https://stackoverflow.com/users/8335171/fauxpas"}, "edited": false, "score": 0, "creation_date": 1561541175, "post_id": 56768447, "comment_id": 100094504, "body": "It&#39;s more of the Rng = Range(.Cells(k, 12), .Cells(k, 9999)), where I need to make 12, 14, 16, ..., 9998"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 93, "user_id": 8335171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3549cc51906e5b76f996d4dc3d9a27c?s=128&d=identicon&r=PG&f=1", "display_name": "fauxpas", "link": "https://stackoverflow.com/users/8335171/fauxpas"}, "edited": false, "score": 0, "creation_date": 1561541291, "post_id": 56768447, "comment_id": 100094587, "body": "Ah the columns you mean... In that case, please post a separate question for that and we can handle that query there :)"}, {"owner": {"reputation": 93, "user_id": 8335171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3549cc51906e5b76f996d4dc3d9a27c?s=128&d=identicon&r=PG&f=1", "display_name": "fauxpas", "link": "https://stackoverflow.com/users/8335171/fauxpas"}, "edited": false, "score": 0, "creation_date": 1561543891, "post_id": 56768447, "comment_id": 100096118, "body": "Cheers (: I have shared the question with you: <a href=\"https://stackoverflow.com/questions/56770247/creating-a-range-with-only-the-even-number-col\" title=\"creating a range with only the even number col\">stackoverflow.com/questions/56770247/&hellip;</a>"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 2, "last_activity_date": 1561537675, "last_edit_date": 1592644375, "creation_date": 1561537675, "answer_id": 56768447, "question_id": 56767910, "link": "https://stackoverflow.com/questions/56767910/dynamic-range-setting/56768447#56768447", "title": "Dynamic Range Setting", "body": "<blockquote>\n<p>Function call on left-hand side of assignment must return Variant or Object.</p>\n<p>rate = Application.WorksheetFunction.Large(Rng, j)</p>\n</blockquote>\n<p>Do not use <code>Rate</code>. It is a reserved word in VBA. You can read about <code>Rate</code> <a href=\"https://www.excelfunctions.net/vba-rate-function.html\" rel=\"nofollow noreferrer\">here</a></p>\n<p>Change it to say</p>\n<pre><code>LargeVal = Application.WorksheetFunction.Large(Rng, j)\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 8335171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3549cc51906e5b76f996d4dc3d9a27c?s=128&d=identicon&r=PG&f=1", "display_name": "fauxpas", "link": "https://stackoverflow.com/users/8335171/fauxpas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 56768447, "answer_count": 1, "score": 1, "last_activity_date": 1561537675, "creation_date": 1561535773, "last_edit_date": 1561536387, "question_id": 56767910, "link": "https://stackoverflow.com/questions/56767910/dynamic-range-setting", "title": "Dynamic Range Setting", "body": "<p>I am trying to set range dynamically. However, I have faced some error: </p>\n\n<blockquote>\n  <p>Function call on left-hand side of assignment must return Variant or Object.</p>\n</blockquote>\n\n<pre><code>Sub calDailyGC()\n\n    Application.Calculation = xlCalculationManual\n    Application.ScreenUpdating = False\n    Dim Rng As Range\n\n    numGC = Cells(46, 7).Value\n    numDays = Cells(47, 7).Value\n\n    Debug.Print numGC\n    Debug.Print numDays\n\n    For k = 3 To numDays + 1\n        Set Rng = Range(Cells(k, 12), Cells(k, 9999))\n        sumRate = 0\n        For j = 1 To numGC\n            rate = Application.WorksheetFunction.Large(Rng, j)\n            sumRate = sumRate + rate\n        Next j\n        avgGCRate = sumRate / numGC\n    Next k\n    Debug.Print avgGCRate\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 106, "user_id": 10396068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6440bc7f96d2200162628e880337288b?s=128&d=identicon&r=PG", "display_name": "wisniadj", "link": "https://stackoverflow.com/users/10396068/wisniadj"}, "is_accepted": true, "score": 0, "last_activity_date": 1561627019, "last_edit_date": 1561627019, "creation_date": 1561543314, "answer_id": 56770099, "question_id": 56767867, "link": "https://stackoverflow.com/questions/56767867/error-when-running-a-macro-from-a-different-excel-file/56770099#56770099", "title": "Error when running a macro from a different excel file", "body": "<p>I have done some investigation and it looks like the new version of Microsoft (16.0.11727.20188) is causing the problem. I can suggest to downgrade to the older one which will resolve the issue.</p>\n"}], "owner": {"reputation": 393, "user_id": 9679198, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mDg3QlN0jBg/AAAAAAAAAAI/AAAAAAAAADU/koBgZ3Mth7A/photo.jpg?sz=128", "display_name": "Asgeir Bjelland", "link": "https://stackoverflow.com/users/9679198/asgeir-bjelland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 56770099, "answer_count": 1, "score": 0, "last_activity_date": 1561627019, "creation_date": 1561535628, "last_edit_date": 1561536654, "question_id": 56767867, "link": "https://stackoverflow.com/questions/56767867/error-when-running-a-macro-from-a-different-excel-file", "title": "Error when running a macro from a different excel file", "body": "<p>I have two macro enabled Excel files in one directory. One of them being SH.xlsm, which has a macro that should run a macro in my P.xlsm file. Preferably, it should be able to run the code without opening the P.xlsm workbook.</p>\n\n<p>Here is what I currently have in the SH.xlsm file to run the macro called InsertImageTest in P.xlsm.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    ' Call InsertImageTest\n    codeWorkBookPath = \"C:\\Users\\AsgeirA\\OneDrive\\Documents\\PowerApps\\Signature Signer\\\"\n    codeWorkBookName = \"P.xlsm\"\n    codeWorkBookFullPathName = UCase(Trim(codeWorkBookPath)) &amp; UCase(Trim(codeWorkBookName))\n    Debug.Print codeWorkBookFullPathName\n    codeWorkbookAlreadyOpen = IsWorkBookOpen(codeWorkBookPath &amp; codeWorkBookName)\n    If Not codeWorkbookAlreadyOpen Then\n        Workbooks.Open FileName:=codeWorkBookFullPathName, UpdateLinks:=False, ReadOnly:=True\n    End If\n\n    Workbooks(\"SH.xlsm\").Activate\n    Sheets(\"Data\").Activate\n\n    argString = \"'\" &amp; Trim(codeWorkBookName) &amp; \"'!\" &amp; Trim(\"InsertImageTest\")\n    Application.Run argString\nEnd Sub\n\nFunction IsWorkBookOpen(FileName As String)\n    Dim ff As Long, ErrNo As Long\n\n    On Error Resume Next\n    ff = FreeFile()\n    Open FileName For Input Lock Read As #ff\n    Close ff\n    ErrNo = Err\n    On Error GoTo 0\n\n    Select Case ErrNo\n    Case 0:    IsWorkBookOpen = False\n    Case 70:   IsWorkBookOpen = True\n    Case Else: Error ErrNo\n    End Select\nEnd Function\n</code></pre>\n\n<p>The first minor issue with my code is that it opens the P.xlsm workbook. The second issue is that the \"InsertImageTest\" macro is not being run. I just opens the second workbook and displays this.</p>\n\n<pre><code>Run-time error '1004':\n\nCannot run the macro \"P.xlsm'!InsertImageTest'. The macro may not be available in this workbook or all macros may be disabled.\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1561538844, "post_id": 56767837, "comment_id": 100093172, "body": "There is still an error in the code, <code>&amp; tod &quot;:&quot;</code> there is <code>&amp;</code> missing. Why the output looks like <code>&quot;For dates  to :&quot;</code> is because the <code>Option Explicit</code> is missing. Without this statement, the <code>fromd</code> and <code>tod</code> are actually created as local variables of the <code>Click</code> procedure. So add <code>Option Explicit</code> and then you will get compile error. So then you will need to declare the variable outside of the procedure, at the module level and they will be accessible form all the procedures in that module. <a href=\"https://wellsr.com/vba/excel/vba-variable-scope/\" rel=\"nofollow noreferrer\">More info</a>."}, {"owner": {"reputation": 133, "user_id": 11640386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/367b8583c4167d4e026090ade9282c1d?s=128&d=identicon&r=PG&f=1", "display_name": "Valwrie", "link": "https://stackoverflow.com/users/11640386/valwrie"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1561539213, "post_id": 56767837, "comment_id": 100093410, "body": "@dee Thank you! How do I go about declaring the variable outside of the procedure? I still don&#39;t quite get the details on the link"}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 11640386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/367b8583c4167d4e026090ade9282c1d?s=128&d=identicon&r=PG&f=1", "display_name": "Valwrie", "link": "https://stackoverflow.com/users/11640386/valwrie"}, "edited": false, "score": 0, "creation_date": 1561539816, "post_id": 56768963, "comment_id": 100093766, "body": "that was all it took! Thank you! I&#39;ve just added <code>Dim fromd As String</code> and <code>Dim tod As String</code> all the way up top and it worked!"}], "tags": [], "owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "is_accepted": true, "score": 2, "last_activity_date": 1561539528, "creation_date": 1561539528, "answer_id": 56768963, "question_id": 56767837, "link": "https://stackoverflow.com/questions/56767837/how-can-i-use-values-found-in-sub-a-in-sub-b/56768963#56768963", "title": "How can I use values found in sub a in sub b", "body": "<p>Declaring a variable outside of a procedure is quite simple, as you can see in this example:</p>\n\n<pre><code>Dim a As Integer\n\nSub test1()\n a = a + 1\nEnd Sub\n\nSub test2()\na = a + 1\nEnd Sub\n\nSub test3()\na = Range(\"A1\").Value\nEnd Sub\n</code></pre>\n\n<p>I've launched <code>test3()</code>, after having put value 4 in cell <code>A1</code>, then I've run <code>test1()</code> two times and <code>test2()</code> one time. Then I put a breakpoint in <code>test1()</code>, and in the immediate window, I've entered:</p>\n\n<pre><code>? a\n</code></pre>\n\n<p>The response was 7.</p>\n"}], "owner": {"reputation": 133, "user_id": 11640386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/367b8583c4167d4e026090ade9282c1d?s=128&d=identicon&r=PG&f=1", "display_name": "Valwrie", "link": "https://stackoverflow.com/users/11640386/valwrie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 56768963, "answer_count": 1, "score": 2, "last_activity_date": 1561539528, "creation_date": 1561535520, "last_edit_date": 1561539224, "question_id": 56767837, "link": "https://stackoverflow.com/questions/56767837/how-can-i-use-values-found-in-sub-a-in-sub-b", "title": "How can I use values found in sub a in sub b", "body": "<p>The value obtained in the first sub does not carry onto the next, how do I go about doing so?</p>\n\n<p>This is just a small part of the codes, there are many other variables and other user inputs that do not allow me to combine the subs.</p>\n\n<pre><code>Private Sub lbEY_AfterUpdate()\n\nDim sd As Date\nDim ed As Date\nDim fromd As String\nDim tod As String\n\nsm = Month(DateValue(\"01-\" &amp; lbSM &amp; \"-1900\"))\nem = Month(DateValue(\"01-\" &amp; lbEM &amp; \"-1900\"))\n\nsd = DateSerial(lbSY, sm, 1)\ned = DateSerial(lbEY, em, 1)\n\n    fromd = Format(sd, \"mmmm yyyy\")\n    tod = Format(ed, \"mmmm yyyy\")\n\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\n\nRange(\"A1\").Value = \"For dates \" &amp; fromd &amp; \" to \" &amp; tod &amp; \":\"\n'This prints out \"For dates  to :\"\n\nEnd Sub\n</code></pre>\n\n<p>e.g. fromd is January 2019 and tod is March 2019.\nThe ideal outcome would be for the value in Range A1 to be\" For dates January 2019 to March 2019:\"\nThanks in advance!</p>\n"}, {"tags": ["excel", "vba", "split", "conditional-statements"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1561535015, "post_id": 56767655, "comment_id": 100091195, "body": "Read up on <code>Text To Columns</code> :) No loop required. In fact record a macro and then <code>Select the relevant Column ==&gt; Data tab ==&gt; Text To Columns</code>."}, {"owner": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1561535038, "post_id": 56767655, "comment_id": 100091208, "body": "I need to know first whether the content of any cell having more than one <b><i>&quot;;&quot;</i></b>. I can&#39;t understand the logic to apply. I know I can use len property but how?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1561535119, "post_id": 56767655, "comment_id": 100091256, "body": "You do not need to know if the cell contains &quot;;&quot; or not. If it is present, text to columns will take care of it, else it will leave the cell alone..."}, {"owner": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1561535259, "post_id": 56767655, "comment_id": 100091332, "body": "you can see that I&#39;ve included vba tag to do the operation using maco. Thanks."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1561535379, "post_id": 56767655, "comment_id": 100091390, "body": "And you can see that in my first comment, I mentioned that you can record a macro. Give it a try and you will get the code that you seek :)"}, {"owner": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1561536231, "post_id": 56767655, "comment_id": 100091805, "body": "I&#39;ve edited my post to make it clearer the result I&#39;m after. Thanks."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1561536457, "post_id": 56767655, "comment_id": 100091905, "body": "So you do not want to split the words? Just count the number of occurances of &quot;;&quot;?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1561537619, "post_id": 56767655, "comment_id": 100092500, "body": "I&#39;m puzzled with what you want, the method @SiddharthRout described does exactly what the answer below does. Or is the key here to skip the single values?"}, {"owner": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1561537834, "post_id": 56767655, "comment_id": 100092623, "body": "Yes, the tricky part always get someone puzzled. SiddharthRout suggested me to go for excel in the first place. Check out the title of this post to understand what I expected @JvdV."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1561539614, "post_id": 56767655, "comment_id": 100093664, "body": "<b>[1]</b> As far as the title of the question goes, it has been changed so many times. See the unedited version. The original title was &quot;Can&#39;t split content of different cells and rearrange them to columns conditionally&quot; <b>[2]</b> There is nothing tricky about what you asked. It is a simple question. Excel has inbuilt <code>.TextToColumns</code>. If you would have recorded a macro like I suggested in the 1st comment, you would have got a 1-2 line code which you could have edited to get what you wanted. You do not need a loop to split the text (which is what you originally wanted)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1561539619, "post_id": 56767655, "comment_id": 100093669, "body": "<b>[3]</b> VBA is not on the verge of extinction. It is a myth. And I am not sure which developers you are talking about who have lost hope :D Look around in the VBA tag, does it look like people have given up hope? <b>[4]</b> As far as &quot;ability&quot; is concerned, let&#39;s not go down that road... Feel free to go ahead with the accepted answer :)"}], "answers": [{"comments": [{"owner": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 0, "creation_date": 1561536865, "post_id": 56768061, "comment_id": 100092103, "body": "Yes, it does the job perfectly. Could you tell me how can I count the occurrences of this signs <b><i><code>;</code></i></b> in each cell?"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 0, "last_activity_date": 1561569842, "last_edit_date": 1561569842, "creation_date": 1561536293, "answer_id": 56768061, "question_id": 56767655, "link": "https://stackoverflow.com/questions/56767655/cant-count-certain-sign-appeared-in-each-cell/56768061#56768061", "title": "Can&#39;t count certain sign appeared in each cell", "body": "<p>Try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim LastRow As Long, i As Long, arr As Variant\n    Dim NumberOfOccu As Long\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        'Find last row of column A\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        'Loop from row 1 to lastrow\n        For i = 1 To LastRow\n\n            If InStr(.Range(\"A\" &amp; i).Value, \";\") Then\n                'Number of characters\n                NumberOfOccu = InStr(.Range(\"A\" &amp; i).Value, \";\")\n                arr = Split(.Range(\"A\" &amp; i).Value, \";\")\n                .Range(\"C\" &amp; i).Resize(, UBound(arr) + 1) = arr\n\n            End If\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Results:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5j4QV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5j4QV.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 56768061, "answer_count": 1, "score": -3, "last_activity_date": 1561569842, "creation_date": 1561534804, "last_edit_date": 1561538553, "question_id": 56767655, "link": "https://stackoverflow.com/questions/56767655/cant-count-certain-sign-appeared-in-each-cell", "title": "Can&#39;t count certain sign appeared in each cell", "body": "<p>I'm trying to create a macro which is supposed to check for a number of range to find out if there are multiple items separated by semicolon <code>;</code> within certain cells. If it finds one then the macro will count how many times that sign <strong><em><code>;</code></em></strong> has appeared in each cell:</p>\n\n<p>For example, in Range(\"A1\") that sign has appeared 3 times:</p>\n\n<pre><code>apple;orange;guava;malta\n</code></pre>\n\n<p>I've tried so far:</p>\n\n<pre><code>Sub DistributeItemsToColumns()\n    Dim cel As Range\n\n    For Each cel In Range(\"A1:L4\")\n        If InStr(cel, \";\") &gt; 0 Then\n            Debug.Print cel  'can't think further\n        End If\n    Next cel\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1561532389, "post_id": 56766841, "comment_id": 100089840, "body": "Search for <code>&quot; cat&quot;</code>? With a space before the word? And if the left most word is cat then use partial match and search using <code>&quot;cat&quot;</code>. Then check if it is the left most word <code>Ucase(Left(trim(cell.value),3)) =&quot;CAT&quot;</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1561532468, "post_id": 56766841, "comment_id": 100089884, "body": "It also depends on different kind of words.. For example what would you like to do with words like &quot;this.cat&quot;, &quot;that.cat&quot;, &quot;Category&quot; etc..."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1561532623, "post_id": 56766841, "comment_id": 100089979, "body": "I reccomend to use the powerful <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">Regular Expressions (regex)</a>: <a href=\"https://regex101.com/r/BuVKxJ/1\" rel=\"nofollow noreferrer\">regex101.com/r/BuVKxJ/1</a>"}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1561535670, "post_id": 56767526, "comment_id": 100091518, "body": "This will not recognize if a cell begins with <code>&quot;cat&quot;</code> but is not exactly <code>&quot;cat&quot;</code> like in <code>cat in the house</code>. You will need a third subtitution criteria: <code>=IF(EXACT(A5,&quot;cat&quot;),&quot;mr.cat&quot;,SUBSTITUTE(SUBSTITUTE(A5,&quot; cat&quot;,&quot; mr.cat&quot;),&quot;cat &quot;,&quot;mr.cat &quot;))</code> that covers <code>&quot;cat &quot;</code>."}], "tags": [], "owner": {"reputation": 53, "user_id": 11678793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ea454011da2a9743fb594d933b11e55?s=128&d=identicon&r=PG&f=1", "display_name": "Pan", "link": "https://stackoverflow.com/users/11678793/pan"}, "is_accepted": true, "score": 0, "last_activity_date": 1561535468, "last_edit_date": 1561535468, "creation_date": 1561534364, "answer_id": 56767526, "question_id": 56766841, "link": "https://stackoverflow.com/questions/56766841/how-to-find-and-replace-exact-match-text-but-not-match-entire-cell-contents/56767526#56767526", "title": "How to find and replace exact match text but not match entire cell contents", "body": "<p>Add another column and include the following formula</p>\n\n<pre><code> =IF(EXACT(A5,\"cat\"),\"mr.cat\",SUBSTITUTE(A5,\" cat\",\" mr.cat\")) \n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/kw7Z0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kw7Z0.png\" alt=\"example\"></a></p>\n"}], "owner": {"reputation": 5, "user_id": 7029741, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Wt0gBgVF2nk/AAAAAAAAAAI/AAAAAAAAABk/8P3sNvR43lY/photo.jpg?sz=128", "display_name": "nichkhun", "link": "https://stackoverflow.com/users/7029741/nichkhun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1063, "favorite_count": 0, "accepted_answer_id": 56767526, "answer_count": 1, "score": 0, "last_activity_date": 1561535468, "creation_date": 1561531961, "last_edit_date": 1561532245, "question_id": 56766841, "link": "https://stackoverflow.com/questions/56766841/how-to-find-and-replace-exact-match-text-but-not-match-entire-cell-contents", "title": "How to find and replace exact match text but not match entire cell contents", "body": "<p>So basically just find and replace but some of my data is so messy</p>\n\n<p>For example I wanna find the word \"cat\" and replace it with \"mr.cat\"</p>\n\n<p>but there are some word like \"redcat\" that will show up in my search too </p>\n\n<p><a href=\"https://i.stack.imgur.com/8Sofj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8Sofj.png\" alt=\"img\"></a></p>\n\n<p>and If I use the match entire cell contents some word like \"the cat\" will not show</p>\n\n<p><a href=\"https://i.stack.imgur.com/nkuo5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nkuo5.png\" alt=\"img2\"></a></p>\n"}, {"tags": ["excel", "vba", "api"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1561533707, "post_id": 56766756, "comment_id": 100090524, "body": "Is <a href=\"https://prnt.sc/o6sgkl\" rel=\"nofollow noreferrer\">THIS</a> what you are trying?"}, {"owner": {"reputation": 71, "user_id": 10209200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1cdef65f77239e2ccb32937bbee6459?s=128&d=identicon&r=PG&f=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/10209200/antonio"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1561536652, "post_id": 56766756, "comment_id": 100091998, "body": "Yes, something like that in run time, but with the top of userform2 &quot;touching&quot; the bottom of CommandButton1"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 10209200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1cdef65f77239e2ccb32937bbee6459?s=128&d=identicon&r=PG&f=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/10209200/antonio"}, "edited": false, "score": 0, "creation_date": 1561648544, "post_id": 56779644, "comment_id": 100142829, "body": "Nice solution for placing userform2! Thank you. Your code put me in the right way to find a solution for calculating the border sizes of a userform, regardless its controls: the key is the ClientToScreen API function, which replaces the \u201cframe\u201d used in my previous code to find a reference inside the userform. The relevant code is shown in the reply below."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 3, "last_activity_date": 1561576418, "creation_date": 1561576418, "answer_id": 56779644, "question_id": 56766756, "link": "https://stackoverflow.com/questions/56766756/how-to-get-the-border-sizes-of-a-userform/56779644#56779644", "title": "How to get the border sizes of a userform?", "body": "<p><strong>Logic:</strong></p>\n\n<ol>\n<li>Show Userform1 as modeless. This is required so that Userform2 can be shown as modeless</li>\n<li>Show Userform2 as modeless. This is required so that Userform2 can be moved</li>\n<li>Move Userform2 to the relevant position</li>\n</ol>\n\n<p><strong>New Position Calculations:</strong></p>\n\n<p>Can be much better explained with the below image</p>\n\n<p><a href=\"https://i.stack.imgur.com/O6h6D.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O6h6D.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>In a Module:</strong></p>\n\n<pre><code>Option Explicit\n\nSub Sample()\n    UserForm1.Show vbModeless\nEnd Sub\n</code></pre>\n\n<p><strong>In <code>Userform1</code> code area:</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Declare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" _\n(ByVal lpClassName As String, ByVal lpWindowName As String) As Long\n\nPrivate Declare Function ClientToScreen Lib \"user32\" _\n(ByVal hwnd As Long, lpPoint As POINTAPI) As Long\n\nPrivate Declare Function GetDeviceCaps Lib \"Gdi32\" _\n(ByVal hDC As Long, ByVal nIndex As Long) As Long\n\nPrivate Declare Function GetDC Lib \"user32\" (ByVal hwnd As Long) As Long\n\nPrivate Declare Function ReleaseDC Lib \"user32\" _\n(ByVal hwnd As Long, ByVal hDC As Long) As Long\n\nPrivate Declare Function SetWindowPos Lib \"user32\" ( _\nByVal hwnd As Long, ByVal hWndInsertAfter As Long, _\nByVal x As Long, ByVal y As Long, ByVal cx As Long, _\nByVal cy As Long, ByVal wFlags As Long) As Long\n\nPrivate Const LOGPIXELSX = 88\nPrivate Const LOGPIXELSY = 90\n\nPrivate Type POINTAPI\n    x As Long\n    y As Long\nEnd Type\n\nPrivate Const HWND_TOP = 0\nPrivate Const SWP_NOSIZE = &amp;H1\n\nPrivate Sub CommandButton1_Click()\n    RepositionForm UserForm2, CommandButton1\nEnd Sub\n\nPublic Sub RepositionForm(f As Object, c As Object)\n    Dim P As POINTAPI\n    Dim meHwnd As Long, hwnd As Long\n\n    meHwnd = FindWindow(vbNullString, Me.Caption)\n\n    P.x = (c.Left - (f.Width / 4)) / PointsPerPixelX\n    P.y = (c.Top + c.Height) / PointsPerPixelY\n\n    '~~&gt; The ClientToScreen function converts the client coordinates\n    '~~&gt; of a specified point to screen coordinates.\n    ClientToScreen meHwnd, P\n\n    UserForm2.Show vbModeless\n\n    '~~&gt; Get Handle of Userform2\n    hwnd = FindWindow(\"ThunderDFrame\", \"UserForm2\")\n\n    '~~&gt; Move the form to relevant location\n    SetWindowPos hwnd, HWND_TOP, P.x, P.y, 0, 0, SWP_NOSIZE\nEnd Sub\n\nPrivate Function PointsPerPixelX() As Double\n    Dim hDC As Long\n    hDC = GetDC(0)\n    PointsPerPixelX = 72 / GetDeviceCaps(hDC, LOGPIXELSX)\n    ReleaseDC 0, hDC\nEnd Function\n\nPublic Function PointsPerPixelY() As Double\n    Dim hDC As Long\n    hDC = GetDC(0)\n    PointsPerPixelY = 72 / GetDeviceCaps(hDC, LOGPIXELSY)\n    ReleaseDC 0, hDC\nEnd Function\n</code></pre>\n\n<p><strong>Screenshot</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/HR8hp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HR8hp.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 10209200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1cdef65f77239e2ccb32937bbee6459?s=128&d=identicon&r=PG&f=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/10209200/antonio"}, "is_accepted": false, "score": 2, "last_activity_date": 1561648458, "creation_date": 1561648458, "answer_id": 56794133, "question_id": 56766756, "link": "https://stackoverflow.com/questions/56766756/how-to-get-the-border-sizes-of-a-userform/56794133#56794133", "title": "How to get the border sizes of a userform?", "body": "<p>I can answer to my own question now after reading Siddharth Rout\u2019s code. The key is to use the ClientToScreen API function to find the \u201cscreen\u201d coordinates of the upper left corner of the client window (of the userform).</p>\n\n<p>I am leaving here the code, in case someone needs to know the border sizes of a userform.</p>\n\n<p>In a ordinary module:</p>\n\n<pre><code>Option Explicit\n'\n'API Declarations\n'\n#If VBA7 Then\n    Declare PtrSafe Function GetDC Lib \"user32\" (ByVal hWnD As Long) As Long\n    Declare PtrSafe Function ReleaseDC Lib \"user32\" (ByVal hWnD As Long, ByVal hDC As Long) As Long\n    Declare PtrSafe Function GetDeviceCaps Lib \"gdi32\" (ByVal hDC As Long, ByVal Index As Long) As Long\n    Declare PtrSafe Function GetWindowRect Lib \"user32\" (ByVal hWnD As Long, ByRef lpRect As udtRECT) As Long\n    Declare PtrSafe Function GetClientRect Lib \"user32\" (ByVal hWnD As Long, ByRef lpRect As udtRECT) As Long\n    Declare PtrSafe Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\n    Declare PtrSafe Function ClientToScreen Lib \"user32\" (ByVal hWnD As Long, ByRef lpPoint As PointAPI) As Long\n#Else\n    Declare Function GetDC Lib \"user32\" (ByVal hWnD As Long) As Long\n    Declare Function ReleaseDC Lib \"user32\" (ByVal hWnD As Long, ByVal hDC As Long) As Long\n    Declare Function GetDeviceCaps Lib \"gdi32\" (ByVal hDC As Long, ByVal Index As Long) As Long\n    Declare Function GetWindowRect Lib \"user32\" (ByVal hWnD As Long, ByRef lpRect As udtRECT) As Long\n    Declare Function GetClientRect Lib \"user32\" (ByVal hWnD As Long, ByRef lpRect As udtRECT) As Long\n    Declare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\n    Declare Function ClientToScreen Lib \"user32\" (ByVal hWnD As Long, ByRef lpPoint As PointAPI) As Long\n#End If\n'\nPublic Type udtRECT\n    Left As Long\n    Top As Long\n    Right As Long\n    Bottom As Long\nEnd Type\n'\nPublic Type PointAPI\n    x As Long\n    y As Long\nEnd Type\n'\nPublic Type BorderSize\n    TopHeight As Single\n    LeftWidth As Single\n    BottomHeight As Single\n    RightWidth As Single\nEnd Type\n'\n' To determine the sizes of the borders\n'\nPublic Function FormBorders(ByVal FormHandler As Long) As BorderSize\n'\n' Credits to Siddharth Rout for the usage of ClientToScreen API function in this context.\n'\n    Dim rectWindow As udtRECT\n    Dim rectClient As udtRECT\n    Dim P As PointAPI\n    Dim VerBorders As Single\n    Dim HorBorders As Single\n    Dim Trash As Long\n'\n    Trash = GetWindowRect(FormHandler, rectWindow)\n    Trash = GetClientRect(FormHandler, rectClient)\n'\n'   Sets the upper left corner of the \"client\" window...\n    P.x = 0\n    P.y = 0\n    Trash = ClientToScreen(FormHandler, P)      '...and gets its screen coordinates.\n'\n'   Total dimensions of the borders in points, after converting pixels to points:\n    VerBorders = ConvertPixelsToPoints((rectWindow.Right - rectWindow.Left) - (rectClient.Right - rectClient.Left), \"X\")\n    HorBorders = ConvertPixelsToPoints((rectWindow.Bottom - rectWindow.Top) - (rectClient.Bottom - rectClient.Top), \"Y\")\n'\n'   Now the individual borders, one by one, in points:\n    FormBorders.TopHeight = ConvertPixelsToPoints(P.y - rectWindow.Top, \"Y\")\n    FormBorders.BottomHeight = HorBorders - FormBorders.TopHeight\n    FormBorders.LeftWidth = ConvertPixelsToPoints(P.x - rectWindow.Left, \"X\")\n    FormBorders.RightWidth = VerBorders - FormBorders.LeftWidth\n'\n    Debug.Print FormBorders.TopHeight, FormBorders.LeftWidth, FormBorders.BottomHeight, FormBorders.RightWidth\n'\nEnd Function\n'\n'To convert pixels to points\n'\nPublic Function ConvertPixelsToPoints(ByVal sngPixels As Single, ByVal sXorY As String) As Single\n'\n'Credits to: https://bettersolutions.com/vba/userforms/positioning.htm\n'\n    Dim hDC As Long\n'\n    hDC = GetDC(0)\n    If sXorY = \"X\" Then\n        ConvertPixelsToPoints = sngPixels * (72 / GetDeviceCaps(hDC, 88))\n    End If\n'\n    If sXorY = \"Y\" Then\n        ConvertPixelsToPoints = sngPixels * (72 / GetDeviceCaps(hDC, 90))\n    End If\n    Call ReleaseDC(0, hDC)\n'\nEnd Function\n</code></pre>\n\n<p>In the code sheet of the userform:</p>\n\n<p>Option Explicit</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n'\n    Dim MeBorders As BorderSize\n\n    MeBorders = FormBorders(FindWindow(vbNullString, Me.Caption))\n\n    Debug.Print MeBorders.TopHeight, MeBorders.LeftWidth, MeBorders.BottomHeight, MeBorders.RightWidth\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 10209200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1cdef65f77239e2ccb32937bbee6459?s=128&d=identicon&r=PG&f=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/10209200/antonio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 543, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1587060829, "creation_date": 1561531684, "last_edit_date": 1561533069, "question_id": 56766756, "link": "https://stackoverflow.com/questions/56766756/how-to-get-the-border-sizes-of-a-userform", "title": "How to get the border sizes of a userform?", "body": "<p>I have a userform (userform1) with several controls. One control is a command button which will open a second userform (userform2).</p>\n\n<p>I want that userform2 opens immediately bellow the button and centered with it.</p>\n\n<p>To have the same behavior regardless the system/themes definitions for Windows, I need to know the sizes of the borders of userform1.</p>\n\n<p>After digging during 3 days, I used API functions GetWindowRect and GetWindowClient. With these two API routines, I can find the TOTAL sizes of the horizontal borders (upper plus lower) and of the vertical borders (left plus right), but not them individually.</p>\n\n<p>For vertical borders, it is common sense that they will have the same thickness (width) \u2014 in fact, I\u2019ve never seen a window with different left and right borders. So, the solution is to divide by 2 the total size. However, for horizontal borders this cannot be used, since the upper border is usually thicker that the lower.</p>\n\n<p>Eventually, I found a workaround for the problem, but it cannot be applied always. That is, if there is a frame control inside userform1, then the API function GetWindowRect can be used to find the \u201cabsolute\u201d coordinates of the frame, i.e., referred to the screen, not to userform1. Then, the upper border size is given by: frame.top_Absolute \u2013 (Userform1.top_Absolute - frame.top_RelativeToUserform1).</p>\n\n<p>The problem of this approach is, userforms have not frame controls always. On the other hand, not all controls have a \u201crectangle\u201d property; therefore, GetWindowRect cannot be used for all controls.</p>\n\n<p>Question: is there a \u201cdirect\u201d way to find the size of the borders of a userform?</p>\n\n<p>Code</p>\n\n<p>In an ordinary module:</p>\n\n<pre><code>Option Explicit\n\n'API Declarations\n\n#If VBA7 Then\nDeclare PtrSafe Function GetSystemMetrics Lib \"user32\" (ByVal Index As Long) As Long\nDeclare PtrSafe Function GetDC Lib \"user32\" (ByVal hWnD As Long) As Long\nDeclare PtrSafe Function ReleaseDC Lib \"user32\" (ByVal hWnD As Long, ByVal hDC As Long) As Long\nDeclare PtrSafe Function GetDeviceCaps Lib \"gdi32\" (ByVal hDC As Long, ByVal Index As Long) As Long\nDeclare PtrSafe Function GetWindowRect Lib \"user32\" (ByVal hWnD As Long, ByRef lpRect As udtRECT) As Long\nDeclare PtrSafe Function GetClientRect Lib \"user32\" (ByVal hWnD As Long, ByRef lpRect As udtRECT) As Long\nDeclare PtrSafe Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\n#Else\nDeclare Function GetSystemMetrics Lib \"user32\" (ByVal Index As Long) As Long\nDeclare Function GetDC Lib \"user32\" (ByVal hWnD As Long) As Long\nDeclare Function ReleaseDC Lib \"user32\" (ByVal hWnD As Long, ByVal hDC As Long) As Long\nDeclare Function GetDeviceCaps Lib \"gdi32\" (ByVal hDC As Long, ByVal Index As Long) As Long\nDeclare Function GetWindowRect Lib \"user32\" (ByVal hWnD As Long, ByRef lpRect As udtRECT) As Long\nDeclare Function GetClientRect Lib \"user32\" (ByVal hWnD As Long, ByRef lpRect As udtRECT) As Long\nDeclare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\n#End If\n\nType udtRECT\n    Left As Long\n    Top As Long\n    Right As Long\n    Bottom As Long\nEnd Type\n\nPublic Type BorderSize\n    TopHeight As Long\n    LeftWidth As Long\n    BottomHeight As Long\n    RightWidth As Long\nEnd Type\n\nPublic FormBorders As BorderSize\n\n'To determine the sizes of the borders\n\nPublic Sub GetFormBorders(ByVal FormHandler As Long, ByVal FrameHandler As Long)\n\nDim rectForm As udtRECT\nDim rectFrame As udtRECT\nDim rectClientForm As udtRECT\nDim Trash As Long\n\nTrash = GetWindowRect(FormHandler, rectForm)\nTrash = GetWindowRect(FrameHandler, rectFrame)\nTrash = GetClientRect(FormHandler, rectClientForm)\n\nFormBorders.TopHeight = ConvertPixelsToPoints(rectFrame.Top - rectForm.Top, \"Y\") - frmFlyschGSI.fraRockProp.Top         'userform1.frame.top\nFormBorders.LeftWidth = ConvertPixelsToPoints(rectFrame.Left - rectForm.Left, \"X\") - frmFlyschGSI.fraRockProp.Left\nFormBorders.BottomHeight = ConvertPixelsToPoints(rectForm.Bottom - rectForm.Top, \"Y\") - FormBorders.TopHeight - _\n                           ConvertPixelsToPoints(rectClientForm.Bottom - rectClientForm.Top, \"Y\")\nFormBorders.RightWidth = ConvertPixelsToPoints(rectForm.Right - rectForm.Left, \"X\") - FormBorders.LeftWidth - _\n                         ConvertPixelsToPoints(rectClientForm.Right - rectClientForm.Left, \"X\")\n\nDebug.Print FormBorders.TopHeight, FormBorders.LeftWidth, FormBorders.BottomHeight, FormBorders.RightWidth\n\nEnd Sub\n\n'To convert pixels to points\n\nPublic Function ConvertPixelsToPoints(ByVal sngPixels As Single, ByVal sXorY As String) As Single\n\n'Credits to: https://bettersolutions.com/vba/userforms/positioning.htm\n\nDim hDC As Long\n\nhDC = GetDC(0)\n\nIf sXorY = \"X\" Then\n    ConvertPixelsToPoints = sngPixels * (72 / GetDeviceCaps(hDC, 88))\nEnd If\n\nIf sXorY = \"Y\" Then\n    ConvertPixelsToPoints = sngPixels * (72 / GetDeviceCaps(hDC, 90))\nEnd If\n\nCall ReleaseDC(0, hDC)\n\nEnd Function\n</code></pre>\n\n<p>'In the Userform code sheet:</p>\n\n<pre><code>Option Explicit\n\n\nPrivate Sub UserForm_Initialize()\n\n'Some code here\n\nIf Me.Visible = False Then\n    Call GetFormBorders(FindWindow(vbNullString, frmFlyschGSI.Caption), frmFlyschGSI.fraRockProp.[_GethWnd])\nEnd If\n\n'More code here\n\nEnd Sub\n\n\nPrivate Sub cmdMiHarder_Click()\n\nDim FrameBorder As udtRECT\nDim Trash As Long\nDim sngTopBorder As Single\nDim sngLeftBorder As Single\n\n'Some code here\n\nTrash = GetWindowRect(Me.fraRockProp.[_GethWnd], FrameBorder)\n\nsngTopBorder = ConvertPixelsToPoints(FrameBorder.Top, \"Y\") - (Me.Top + Me.fraRockProp.Top)\nsngLeftBorder = ConvertPixelsToPoints(FrameBorder.Left, \"X\") - (Me.Left + Me.fraRockProp.Left)\n\n'More code here\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 91, "user_id": 11629973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9006e1e0583b7364d8bdf2474ed22677?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony14", "link": "https://stackoverflow.com/users/11629973/anthony14"}, "edited": false, "score": 0, "creation_date": 1561531905, "post_id": 56766652, "comment_id": 100089623, "body": "Want to get column C, can see above my attempt"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1561532085, "post_id": 56766652, "comment_id": 100089710, "body": "You have data in column A and you need to remove the Bold part and paste the string in column C?"}, {"owner": {"reputation": 91, "user_id": 11629973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9006e1e0583b7364d8bdf2474ed22677?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony14", "link": "https://stackoverflow.com/users/11629973/anthony14"}, "reply_to_user": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1561532154, "post_id": 56766652, "comment_id": 100089734, "body": "yeap, but I should save italic font"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1561532322, "post_id": 56766652, "comment_id": 100089812, "body": "is there a chance to have Bold characters in different parts of the string or only add the beginning?"}, {"owner": {"reputation": 91, "user_id": 11629973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9006e1e0583b7364d8bdf2474ed22677?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony14", "link": "https://stackoverflow.com/users/11629973/anthony14"}, "reply_to_user": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1561532448, "post_id": 56766652, "comment_id": 100089872, "body": "bold words can be only at the beginning"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1561532695, "post_id": 56766652, "comment_id": 100090013, "body": "@Anthony14 do the bold words end always with a dot? because there you can split the string."}, {"owner": {"reputation": 91, "user_id": 11629973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9006e1e0583b7364d8bdf2474ed22677?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony14", "link": "https://stackoverflow.com/users/11629973/anthony14"}, "edited": false, "score": 0, "creation_date": 1561532831, "post_id": 56766652, "comment_id": 100090084, "body": "yes, bold words end with a dot, but I should save italic font in my text"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1561532890, "post_id": 56766652, "comment_id": 100090109, "body": "@Anthony14 then try the code in my answer."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1561533119, "post_id": 56766652, "comment_id": 100090226, "body": "the italics appears many time?"}, {"owner": {"reputation": 91, "user_id": 11629973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9006e1e0583b7364d8bdf2474ed22677?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony14", "link": "https://stackoverflow.com/users/11629973/anthony14"}, "edited": false, "score": 0, "creation_date": 1561533198, "post_id": 56766652, "comment_id": 100090258, "body": "yes, the italics can be several times in each string"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1561541694, "post_id": 56766652, "comment_id": 100094804, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/56700110/how-to-merge-several-cells-using-vba\">How to merge several cells using VBA</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 0, "last_activity_date": 1561532810, "creation_date": 1561532810, "answer_id": 56767068, "question_id": 56766652, "link": "https://stackoverflow.com/questions/56766652/how-cut-a-substring/56767068#56767068", "title": "How cut a substring?", "body": "<p>If your bold string always ends with a dot this will do it for you:</p>\n\n<pre><code>Option Explicit\nPublic Function GetDefinition(ByVal rngText As Range) As String\n\n    Dim SplitBold As Variant\n\n    SplitBold = Split(rngText, \". \")\n    GetDefinition = Trim(SplitBold(1))\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 91, "user_id": 11629973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9006e1e0583b7364d8bdf2474ed22677?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony14", "link": "https://stackoverflow.com/users/11629973/anthony14"}, "edited": false, "score": 0, "creation_date": 1561538716, "post_id": 56767503, "comment_id": 100093102, "body": "works good. But I have a question, I noticed, that if string big, it doesnt work ( I attached screen with example). Can you help me with this problem?"}, {"owner": {"reputation": 91, "user_id": 11629973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9006e1e0583b7364d8bdf2474ed22677?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony14", "link": "https://stackoverflow.com/users/11629973/anthony14"}, "edited": false, "score": 0, "creation_date": 1561539478, "post_id": 56767503, "comment_id": 100093577, "body": "255 character limit"}, {"owner": {"reputation": 91, "user_id": 11629973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9006e1e0583b7364d8bdf2474ed22677?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony14", "link": "https://stackoverflow.com/users/11629973/anthony14"}, "edited": false, "score": 0, "creation_date": 1561540368, "post_id": 56767503, "comment_id": 100094083, "body": "I tried, but i need to save italic font and cut bold at the beginning"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 91, "user_id": 11629973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9006e1e0583b7364d8bdf2474ed22677?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony14", "link": "https://stackoverflow.com/users/11629973/anthony14"}, "edited": false, "score": 0, "creation_date": 1561541592, "post_id": 56767503, "comment_id": 100094753, "body": "@Anthony14 what to you mean by 255 character limit? the code code the whole cell (value &amp; formatting) and them remove the BOLD pieces. i can not understand where is the issue"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 1, "last_activity_date": 1561534284, "creation_date": 1561534284, "answer_id": 56767503, "question_id": 56766652, "link": "https://stackoverflow.com/questions/56766652/how-cut-a-substring/56767503#56767503", "title": "How cut a substring?", "body": "<p>I think you could use this:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim LastRow As Long, i As Long, j As Long, PositionOfDot As Long\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        'Find last row of column A\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        'Loop from row 1 to lastrow\n        For i = 1 To LastRow\n            'Copy paste from column A to C keeping formatting\n            .Range(\"A\" &amp; i).Copy .Range(\"C\" &amp; i)\n            'Find the position of \".\"\n            PositionOfDot = InStr(1, .Range(\"A\" &amp; i), \".\")\n            'Delete characters starting from the first one up to PositionOfDot+1\n            .Range(\"C\" &amp; i).Characters(1, PositionOfDot + 1).Delete\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Results:</p>\n\n<p><a href=\"https://i.stack.imgur.com/M2j8o.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M2j8o.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 91, "user_id": 11629973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9006e1e0583b7364d8bdf2474ed22677?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony14", "link": "https://stackoverflow.com/users/11629973/anthony14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 56767503, "answer_count": 2, "score": 1, "last_activity_date": 1561538753, "creation_date": 1561531287, "last_edit_date": 1561538753, "question_id": 56766652, "link": "https://stackoverflow.com/questions/56766652/how-cut-a-substring", "title": "How cut a substring?", "body": "<p>I have a lot of string which can contain italic font. I want to copy this string with this font. In each new string I have bold word</p>\n\n<p>Example: <a href=\"https://i.stack.imgur.com/NJq4y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NJq4y.png\" alt=\"enter image description here\"></a></p>\n\n<p>BIG STRING: <a href=\"https://i.stack.imgur.com/tnmft.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tnmft.png\" alt=\"enter image description here\"></a></p>\n\n<p>I tried: </p>\n\n<pre><code>Public Function GetDefinition(ByVal rngText As Range) As String\nDim theCell As Range\nSet theCell = rngText.Cells(1, 1)\n\nFor I = 1 To Len(theCell.Value)\n    If theCell.Characters(I, 1).Font.Bold = False Then\n        If theCell.Characters(I + 1, 1).Text = \" \" Then\n            theChar = theCell.Characters(I, 1).Text\n            Else\n            theChar = theCell.Characters(I, 1).Text\n        End If\n        Results = Results &amp; theChar\n    End If\nNext I\nGetDefinition = Results\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11697524, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8OM3ckWM2Fs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc6_Xi2iJdnemxQXl_rbqEJJjksYg/photo.jpg?sz=128", "display_name": "Nathathai A", "link": "https://stackoverflow.com/users/11697524/nathathai-a"}, "edited": false, "score": 0, "creation_date": 1561531380, "post_id": 56766600, "comment_id": 100089388, "body": "hey, what if I want it to be American by default (locale to always be American) do I have to set it from application?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 13, "user_id": 11697524, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8OM3ckWM2Fs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc6_Xi2iJdnemxQXl_rbqEJJjksYg/photo.jpg?sz=128", "display_name": "Nathathai A", "link": "https://stackoverflow.com/users/11697524/nathathai-a"}, "edited": false, "score": 0, "creation_date": 1561532068, "post_id": 56766600, "comment_id": 100089701, "body": "@NathathaiA If you want it to be American (Gregorian) you need to <a href=\"https://www.windowscentral.com/how-change-date-and-time-formats-windows-10\" rel=\"nofollow noreferrer\">change your Windows date format</a> to American (Gregorian)."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1561531012, "creation_date": 1561531012, "answer_id": 56766600, "question_id": 56766425, "link": "https://stackoverflow.com/questions/56766425/changing-data-format-to-american-format/56766600#56766600", "title": "Changing data format to american format", "body": "<p>You would need to calculate, you cannot just format.<br>\nSee <a href=\"https://www.google.com/search?q=vba+convert+gregorian+to+thai+date\" rel=\"nofollow noreferrer\">https://www.google.com/search?q=vba+convert+gregorian+to+thai+date</a></p>\n\n<p>So you must subtract <code>543</code> from your buddhist year.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub header_adding()\n    Dim GregorianDate As String\n    GregorianDate = Format$(DateSerial(Year(Date) - 543, Month(Date), Day(Date)), \"dd.mm.yyyy\")\n\n    ws.Range(\"J1\").Value = \"GI status as of\" &amp; \" \" &amp; GregorianDate \nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 11697524, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8OM3ckWM2Fs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc6_Xi2iJdnemxQXl_rbqEJJjksYg/photo.jpg?sz=128", "display_name": "Nathathai A", "link": "https://stackoverflow.com/users/11697524/nathathai-a"}, "edited": false, "score": 0, "creation_date": 1561531733, "post_id": 56766614, "comment_id": 100089536, "body": "hey, what if I want it to be American by default (locale to always be American) do I have to set it from application?"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 13, "user_id": 11697524, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8OM3ckWM2Fs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc6_Xi2iJdnemxQXl_rbqEJJjksYg/photo.jpg?sz=128", "display_name": "Nathathai A", "link": "https://stackoverflow.com/users/11697524/nathathai-a"}, "edited": false, "score": 0, "creation_date": 1561531976, "post_id": 56766614, "comment_id": 100089651, "body": "From how I understood the thread I linked to, if you set your system clock to American format, Excel should also use this. I.e. you just need to right click the clock in your toolbar, select adjust time and date settings, and then change the date there to the format you want. @NathathaiA"}], "tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": true, "score": 0, "last_activity_date": 1561531077, "creation_date": 1561531077, "answer_id": 56766614, "question_id": 56766425, "link": "https://stackoverflow.com/questions/56766425/changing-data-format-to-american-format/56766614#56766614", "title": "Changing data format to american format", "body": "<p>According to <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/all/excel-change-deault-year/fc7760b5-4965-43b6-a68b-6ffa1e3fa10a\" rel=\"nofollow noreferrer\">the answers to this question on the Microsoft Community forums</a>, Excel does not have a setting of its own for deciding on what the default year is. However you can change your system date to the \"American\" one, and Excel should now use this new year as the default. </p>\n\n<p>The answers also links <a href=\"https://excel.tips.net/T003360_Modifying_Default_Year_for_Dates.html\" rel=\"nofollow noreferrer\">to this page by Allen Wyatt</a> which presents a macro for modifying the default year if you are in the first few months of the year. Modifying it to modify the year of <em>any</em> date you enter should be simple enough:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Cells.CountLarge &gt; 1 Then Exit Sub\n    If Target = \"\" Then Exit Sub\n    If Not IsDate(Target) Then Exit Sub\n\n    Application.EnableEvents = False\n        Target = DateAdd(\"yyyy\", -543, Target)\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11697524, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8OM3ckWM2Fs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc6_Xi2iJdnemxQXl_rbqEJJjksYg/photo.jpg?sz=128", "display_name": "Nathathai A", "link": "https://stackoverflow.com/users/11697524/nathathai-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 56766614, "answer_count": 2, "score": 1, "last_activity_date": 1561531164, "creation_date": 1561530247, "last_edit_date": 1561531164, "question_id": 56766425, "link": "https://stackoverflow.com/questions/56766425/changing-data-format-to-american-format", "title": "Changing data format to american format", "body": "<p>I would like to get some advice regarding how to change to date format to the Gregorian calendar (american) one (mine is in Bhuddist calendar (thai) with year in Bhuddist calendar for the year part). </p>\n\n<p>I ran the code and the date came up as <code>26.06.2562</code> where I want it to be <code>26.06.2019</code>.</p>\n\n<pre><code>Sub header_adding ()\n    dates = Now()\n    dates = Format(Date, \"dd.mm.yyyy\")\n\n    ws.Range(\"J1\").Value = \"GI status as of\" &amp; \" \" &amp; dates\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1561530305, "post_id": 56766365, "comment_id": 100088901, "body": "What is wrong with your code? Where did you get stuck? Any errors (if so which and where)? What does your code vs. what did you expect from your code? Please <a href=\"https://stackoverflow.com/posts/56766365/edit\">edit</a> your original question to add all these information. \u2022 Also you might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1561569888, "last_edit_date": 1561569888, "creation_date": 1561531727, "answer_id": 56766766, "question_id": 56766365, "link": "https://stackoverflow.com/questions/56766365/question-about-looping-a-code-through-rows-cant-get-to-work/56766766#56766766", "title": "Question about looping a code through rows, cant get to work", "body": "<p>You could use:    </p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim StartPoint As Long, EndPoint As Long, LastRow As Long, i As Long\n    Dim str As String\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        'Find last row of column A\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        'Loop from row 1 to lastrow\n        For i = 1 To LastRow\n\n            StartPoint = .Range(\"A\" &amp; i).Value\n            EndPoint = .Range(\"B\" &amp; i).Value\n\n            Do Until StartPoint = EndPoint + 1\n\n                If str = \"\" Then\n                    str = StartPoint\n                Else\n                    str = str &amp; \", \" &amp; StartPoint\n                End If\n\n                StartPoint = StartPoint + 1\n\n            Loop\n\n            'Paste re results in Column C row i\n            .Range(\"C\" &amp; i).Value = str\n\n            'Clear str variable\n            str = \"\"\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Results:</p>\n\n<p><a href=\"https://i.stack.imgur.com/4zmrm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4zmrm.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 11701261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4742e268ac98d2feff644e88fb5171a6?s=128&d=identicon&r=PG&f=1", "display_name": "mike weaver", "link": "https://stackoverflow.com/users/11701261/mike-weaver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1561569888, "creation_date": 1561529975, "last_edit_date": 1561530110, "question_id": 56766365, "link": "https://stackoverflow.com/questions/56766365/question-about-looping-a-code-through-rows-cant-get-to-work", "title": "Question about looping a code through rows, cant get to work", "body": "<p>I have a table of numbers with two columns, the lower number is on the left and the higher is on the right. I need a code which goes through each row and prints every number between column A and B including the start and end point. After printing those it needs to go to the next row and repeat the process. </p>\n\n<p>I tried looking online but can't get any help</p>\n\n<pre><code>Sub Values_between_dates()\n    Application.ScreenUpdating = False\n    Dim rng As Range\n    Dim row As Range\n    Dim cell As Range\n\n    Set rng = Range(\"z3:AA11\")\n\n    For Each row In rng.Rows\n        For Each cell In row.Cells\n            cell = numone\n            Print numone.Range(\"AB3\")\n        Next cell\n\n        cell = \"numtwo\"\n        Range(\"AC3\").Select\n        Range(\"AC3\") = numone\n        numone = numone + 1\n\n        Do While numone &lt; Format(numtwo + 1, \"00000000000\")\n            ActiveCell.Offset(1, 0).Range(\"A1\").Select\n            ActiveCell.Value = numone\n            numone = Format(numone + 1, \"00000000000\")    \n        Loop\n    Next row\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1561531324, "post_id": 56765913, "comment_id": 100089361, "body": "Sounds doable through formula tbh"}, {"owner": {"reputation": 5, "user_id": 11701083, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lpbPrwlTSIw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdr8hNwsjLrcYoYaq0vD3CqfH-_EQ/photo.jpg?sz=128", "display_name": "NSH", "link": "https://stackoverflow.com/users/11701083/nsh"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1561533374, "post_id": 56765913, "comment_id": 100090362, "body": "Please provide with solution @JvdV , actually there is lot more test in between 2 accounts &amp; further i have to copy paste all combined data to another new sheet"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11701083, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lpbPrwlTSIw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdr8hNwsjLrcYoYaq0vD3CqfH-_EQ/photo.jpg?sz=128", "display_name": "NSH", "link": "https://stackoverflow.com/users/11701083/nsh"}, "edited": false, "score": 0, "creation_date": 1561536694, "post_id": 56767706, "comment_id": 100092019, "body": "i tried but not working can you please elaborate, how exactly it work"}, {"owner": {"reputation": 5, "user_id": 11701083, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lpbPrwlTSIw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdr8hNwsjLrcYoYaq0vD3CqfH-_EQ/photo.jpg?sz=128", "display_name": "NSH", "link": "https://stackoverflow.com/users/11701083/nsh"}, "edited": false, "score": 0, "creation_date": 1561617983, "post_id": 56767706, "comment_id": 100124862, "body": "Awesome Man @Asusual thnxsssssss a Lot"}, {"owner": {"reputation": 5, "user_id": 11701083, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lpbPrwlTSIw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdr8hNwsjLrcYoYaq0vD3CqfH-_EQ/photo.jpg?sz=128", "display_name": "NSH", "link": "https://stackoverflow.com/users/11701083/nsh"}, "edited": false, "score": 0, "creation_date": 1561628792, "post_id": 56767706, "comment_id": 100130802, "body": "i have found d way of completing d task  @AsUsual  but ur 1st piece of code is awesome"}, {"owner": {"reputation": 459, "user_id": 10547271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/59Gqb.png?s=128&g=1", "display_name": "AsUsual", "link": "https://stackoverflow.com/users/10547271/asusual"}, "reply_to_user": {"reputation": 5, "user_id": 11701083, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lpbPrwlTSIw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdr8hNwsjLrcYoYaq0vD3CqfH-_EQ/photo.jpg?sz=128", "display_name": "NSH", "link": "https://stackoverflow.com/users/11701083/nsh"}, "edited": false, "score": 0, "creation_date": 1561636387, "post_id": 56767706, "comment_id": 100135048, "body": "@Nitin I was probably an idiot for helping you with this, as in &quot;setting a bad example&quot;, but I&#39;m no expert either. You should not post another question as an answer to your question, this should be a new question, tags doesn&#39;t work in the description text and you should really read this <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> if you expect an answer in the future."}], "tags": [], "owner": {"reputation": 459, "user_id": 10547271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/59Gqb.png?s=128&g=1", "display_name": "AsUsual", "link": "https://stackoverflow.com/users/10547271/asusual"}, "is_accepted": true, "score": 0, "last_activity_date": 1561550434, "last_edit_date": 1561550434, "creation_date": 1561534975, "answer_id": 56767706, "question_id": 56765913, "link": "https://stackoverflow.com/questions/56765913/find-specific-word-in-column-and-copy-the-adjacent-value-to-different-column/56767706#56767706", "title": "Find specific word in column and copy the adjacent value to different column", "body": "<p>Try this..</p>\n\n<pre><code>Sub ApplyHeader()\n    Dim c As Range, Acc$, Grp$\n\n    'Loops through first to last used i column C\n    For Each c In Range(Cells(1, 3), Cells(Rows.Count, 3).End(xlUp))\n\n        'Stores value from adjacent cell if it says \"Account\".\n        If c.Value = \"Account\" Then Acc = c.Offset(, 1).Value\n\n        'Stores value from adjacent cell if it says \"Group\".\n        If c.Value = \"Group\" Then Grp = c.Offset(, 1).Value\n\n        'Applies stored values in columns to the left if first character is numerical.\n        If IsNumeric(Left(c.Value, 1)) Then\n            c.Offset(, -2).Value = Acc\n            c.Offset(, -1).Value = Grp\n        End If\n    Next c\n\n    'Removes stored values from \"memory\".\n    Acc = \"\": Grp = \"\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5, "user_id": 11701083, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lpbPrwlTSIw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdr8hNwsjLrcYoYaq0vD3CqfH-_EQ/photo.jpg?sz=128", "display_name": "NSH", "link": "https://stackoverflow.com/users/11701083/nsh"}, "is_accepted": false, "score": 0, "last_activity_date": 1561628676, "creation_date": 1561628676, "answer_id": 56788301, "question_id": 56765913, "link": "https://stackoverflow.com/questions/56765913/find-specific-word-in-column-and-copy-the-adjacent-value-to-different-column/56788301#56788301", "title": "Find specific word in column and copy the adjacent value to different column", "body": "<p>@AsUsual  </p>\n\n<p>I have found d way --> </p>\n\n<pre><code>Sub Copy()\nDim c As Range\nDim j As Integer\nDim Source As Worksheet\nDim Target As Worksheet\n\n\nSet Source = ActiveWorkbook.Worksheets(\"Input\")\nSet Target = ActiveWorkbook.Worksheets(\"Output\")\n\nj = 1\nFor Each c In Source.Range(\"C1:C4000\")\n    If IsNumeric(Left(c.Value, 1)) Then\n       Source.Rows(c.Row).Copy Target.Rows(j)\n       j = j + 1\n    End If\nNext c\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 5, "user_id": 11701083, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lpbPrwlTSIw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdr8hNwsjLrcYoYaq0vD3CqfH-_EQ/photo.jpg?sz=128", "display_name": "NSH", "link": "https://stackoverflow.com/users/11701083/nsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 56767706, "answer_count": 2, "score": -1, "last_activity_date": 1561628676, "creation_date": 1561527631, "last_edit_date": 1561559207, "question_id": 56765913, "link": "https://stackoverflow.com/questions/56765913/find-specific-word-in-column-and-copy-the-adjacent-value-to-different-column", "title": "Find specific word in column and copy the adjacent value to different column", "body": "<p>I need a help in excel VBA</p>\n\n<p><a href=\"https://i.stack.imgur.com/ORtI2.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ORtI2.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I would need to find a text (header - e.g. Account) The cell with word \"Account\" will be always in the column C\nand copy value from adjacent column C and paste them on same sheet to Column A\ntill the value present in column C (like - 09:00-09:30 till it end )</p>\n\n<p>Column \nA   B   C</p>\n\n<pre><code>    Account Test1\n    Group   XXX\n    Date    Mon24 Jun, 2019\n\n    09:00-09:30 \n    09:30-10:00 \n    10:00-10:30 \n    10:30-11:00 \n    11:00-11:30 \n    11:30-12:00 \n    12:00-12:30 \n    12:30-13:00 \n    13:00-13:30 \n    17:30-18:00 \n\n\n    Account Test2\n    Group   YYY\n    Date    Mon24 Jun, 2019\n\n    09:00-09:30 \n    09:30-10:00 \n    10:00-10:30 \n    10:30-11:00 \n    11:00-11:30 \n    11:30-12:00 \n    12:00-12:30 \n    12:30-13:00 \n    13:00-13:30 \n    17:30-18:00 \n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 1, "creation_date": 1561525635, "post_id": 56765435, "comment_id": 100087255, "body": "can&#39;t you use <code>Activecell.Select</code> ?  what is the purpose of this scroll ?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 1, "creation_date": 1561530212, "post_id": 56765435, "comment_id": 100088855, "body": "@Mikku: <code>Activecell.Select</code> will not move the active cell to the 1st visible row which I think is what the user is trying :)"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 10644084, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161218016605525/picture?type=large", "display_name": "Scottyp", "link": "https://stackoverflow.com/users/10644084/scottyp"}, "edited": false, "score": 0, "creation_date": 1561585371, "post_id": 56766170, "comment_id": 100117487, "body": "That doesn&#39;t work, however it is 99% of what I need. I just needed to substitute Column with Row. Thanks"}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": true, "score": 2, "last_activity_date": 1561613389, "last_edit_date": 1561613389, "creation_date": 1561528979, "answer_id": 56766170, "question_id": 56765435, "link": "https://stackoverflow.com/questions/56765435/vba-scroll-to-top-not-left/56766170#56766170", "title": "VBA Scroll to top (not left)", "body": "<p>Just try:</p>\n\n<pre><code>Sub Scroll()\n    ActiveWindow.ScrollRow = ActiveCell.Row\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 10644084, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161218016605525/picture?type=large", "display_name": "Scottyp", "link": "https://stackoverflow.com/users/10644084/scottyp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1489, "favorite_count": 0, "accepted_answer_id": 56766170, "answer_count": 1, "score": 2, "last_activity_date": 1561613389, "creation_date": 1561524978, "last_edit_date": 1561529008, "question_id": 56765435, "link": "https://stackoverflow.com/questions/56765435/vba-scroll-to-top-not-left", "title": "VBA Scroll to top (not left)", "body": "<p>I am trying to write a command that scrolls the current <code>ActiveCell</code> to the top of the page. </p>\n\n<p>As <code>Activecell</code> is in column <code>C</code>, if I use the below code it moves <code>A</code> &amp; <code>B</code> out of sight. </p>\n\n<p>How do I use active cell to scroll up without moving A &amp; B out of the field of view. </p>\n\n<p>Thanks</p>\n\n<pre><code>Application.Goto ActiveCell, Scroll:=True\n</code></pre>\n"}, {"tags": ["arrays", "vba", "search", "range", "matching"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1561522425, "post_id": 56765065, "comment_id": 100086418, "body": "Well you can&#39;t use <code>.Find</code> on an array. It&#39;s <code>Range.Find</code>..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1561522473, "post_id": 56765065, "comment_id": 100086429, "body": "Arrays (or their contents in this case, unless they happen to be Range&#39;s) don&#39;t have a <code>Find</code> method.  It&#39;s really unclear what you want to do here."}, {"owner": {"reputation": 3, "user_id": 7377226, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PCwOL8kaVuw/AAAAAAAAAAI/AAAAAAAAASA/btO9UQspcig/photo.jpg?sz=128", "display_name": "Daniel Flanders Thedanflan", "link": "https://stackoverflow.com/users/7377226/daniel-flanders-thedanflan"}, "edited": false, "score": 0, "creation_date": 1561522551, "post_id": 56765065, "comment_id": 100086449, "body": "So instead of trying to use the array, I should just plant the values in a range of cells?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1561528946, "post_id": 56765065, "comment_id": 100088338, "body": "You can use a <code>Scripting.Dictionary</code> which has the property <code>.Exists</code> and can give you an array collection. <a href=\"http://www.snb-vba.eu/VBA_Dictionary_en.html\" rel=\"nofollow noreferrer\">A guide here</a>"}], "owner": {"reputation": 3, "user_id": 7377226, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PCwOL8kaVuw/AAAAAAAAAAI/AAAAAAAAASA/btO9UQspcig/photo.jpg?sz=128", "display_name": "Daniel Flanders Thedanflan", "link": "https://stackoverflow.com/users/7377226/daniel-flanders-thedanflan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561522363, "creation_date": 1561522294, "last_edit_date": 1561522363, "question_id": 56765065, "link": "https://stackoverflow.com/questions/56765065/in-vba-trying-to-search-through-array-with-input-from-a-range", "title": "In VBA, Trying to search through array with input from a range", "body": "<p>I am attempting to take 5 inputs from 5 cells in a column (all numbers) and see if they match an array I have set. Ideally I would like for an array value to be ignored once a match has been found. Once a match is found I just need to change a cell value to a 1 or 0 (I have this part down pat haha)</p>\n\n<p>I've tried .Find and a few other things. Obviously the code here will not work</p>\n\n<pre><code>Sub Q1()\n    Dim arr1(5) As Variant\n        arr1(0) = 100\n        arr1(1) = 125\n        arr1(2) = 150\n        arr1(3) = 252\n        arr1(4) = 253\n\nDim Find1 As String\n\nDim rng As Range\n\nSet rng = arr1(5).Find()\n\nIf rng Is Nothing Then\n\n    Debug.Print \"Nope\"\n\nElse\n\n    Debug.Print \"Correct\"\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Getting a run time 424 error.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1561521422, "post_id": 56764913, "comment_id": 100086208, "body": "Why can&#39;t you make two functions ?  <code>do_something_to_string</code> &amp; <code>do_something_to_range</code>"}, {"owner": {"reputation": 11643, "user_id": 239923, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/f4ZA3.jpg?s=128&g=1", "display_name": "xiaodai", "link": "https://stackoverflow.com/users/239923/xiaodai"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1561521471, "post_id": 56764913, "comment_id": 100086217, "body": "you can do sum(1,2,3) or sum(a1:a3). I think it&#39;s better the way I proposed."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1561521784, "post_id": 56764913, "comment_id": 100086285, "body": "What do you want to do in the case of the <code>String</code> argument?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1561522144, "post_id": 56764913, "comment_id": 100086367, "body": "Your plan for the range seems to be replicating <code>TEXTJOIN</code>, which if you don&#39;t have access to in your version of Excel, you can still find an example of a UDF that does the trick here on SO."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1561522181, "post_id": 56764913, "comment_id": 100086373, "body": "<code>doSomeThing(arg As Variant)</code> then check <code>TypeName(arg)</code> to see what was passed in"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10307643"}, "is_accepted": true, "score": 2, "last_activity_date": 1561522977, "last_edit_date": 1561522977, "creation_date": 1561522609, "answer_id": 56765097, "question_id": 56764913, "link": "https://stackoverflow.com/questions/56764913/how-do-i-make-excel-user-defined-function-udf-accept-arguments-of-string-type/56765097#56765097", "title": "How do I make Excel user-defined function (UDF) accept arguments of String type and range type?", "body": "<p>Either use optional arguments or a variant:</p>\n\n<pre><code>Function MyFunction1(Optional Str As String, Optional Rng As Range) As String\n    Dim C As Range, S As String\n    If Rng Is Nothing Then\n        MyFunction1 = Str\n    Else\n        S = \"\"\n        For Each C In Rng\n            S = S &amp; CStr(C.Value)\n        Next\n        MyFunction1 = S\n    End If\nEnd Function\n\nFunction MyFunction2(V As Variant) As String\n    Dim C As Range, S As String\n    If VarType(V) = vbString Then\n        MyFunction2 = V\n    ElseIf TypeName(V) = \"Range\" Then\n        S = \"\"\n        For Each C In V\n            S = S &amp; CStr(C.Value)\n        Next\n        MyFunction2 = S\n    Else\n        Err.Raise 13, , \"The argument must be a String or a Range.\"\n    End If\nEnd Function\n</code></pre>\n\n<p>Then try:</p>\n\n<pre><code>Debug.Print MyFunction1(\"test\")\nDebug.Print MyFunction1(, Range(\"A1:B3\"))\nDebug.Print MyFunction2(\"test\")\nDebug.Print MyFunction2(Range(\"A1:B3\"))\n</code></pre>\n"}], "owner": {"reputation": 11643, "user_id": 239923, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/f4ZA3.jpg?s=128&g=1", "display_name": "xiaodai", "link": "https://stackoverflow.com/users/239923/xiaodai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8666, "favorite_count": 0, "accepted_answer_id": 56765097, "answer_count": 1, "score": 1, "last_activity_date": 1561528770, "creation_date": 1561521108, "last_edit_date": 1561528770, "question_id": 56764913, "link": "https://stackoverflow.com/questions/56764913/how-do-i-make-excel-user-defined-function-udf-accept-arguments-of-string-type", "title": "How do I make Excel user-defined function (UDF) accept arguments of String type and range type?", "body": "<p>I am trying to make a function <code>do_something_to_string(one_arg)</code> where one_arg can be of string type or be a range.</p>\n\n<p>In the case of a range, I want to concatenate every cell of the range into one long string but processing. But I can't seem to make a function that can accept either a string or a Range as argument.</p>\n"}, {"tags": ["vba", "replace", "find"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 3, "creation_date": 1561520864, "post_id": 56764873, "comment_id": 100086095, "body": "<code>Sht.Range(\u201cA1\u201d).Replace</code> will do (this looks in cell A1 of course). This can also be modified to by more dynamic by using <code>Sht.Cells(1, 1).Replace</code> where the column or row number can be replaced with any <i>numeric</i> variable"}], "answers": [{"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 1, "last_activity_date": 1561520960, "creation_date": 1561520960, "answer_id": 56764892, "question_id": 56764873, "link": "https://stackoverflow.com/questions/56764873/how-to-modify-find-replace-to-refer-to-one-cell-only/56764892#56764892", "title": "How to Modify Find/Replace to refer to one cell only", "body": "<p>Use this:\n Change A1 to your respective cell</p>\n\n<pre><code> fnd = \" himself \"\n rplc = \" herself \"\n\n 'Perform the Find/Replace All\n sht.Range(\"A1\").Replace What:=fnd, Replacement:=rplc, _\n LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=True, _\n SearchFormat:=False, ReplaceFormat:=False\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 8815333, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-SrBM9CvK0GI/AAAAAAAAAAI/AAAAAAAAAAw/oxZ1Qk8DIKU/photo.jpg?sz=128", "display_name": "Chas", "link": "https://stackoverflow.com/users/8815333/chas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561528296, "creation_date": 1561520742, "last_edit_date": 1561528296, "question_id": 56764873, "link": "https://stackoverflow.com/questions/56764873/how-to-modify-find-replace-to-refer-to-one-cell-only", "title": "How to Modify Find/Replace to refer to one cell only", "body": "<p>I have the Find/Replace code below which uses the keyword \"Cells\", but the result is in changing everything in the sheet.  I have not been able to figure out how to make it refer to ONLY one cell.</p>\n\n<pre><code>     fnd = \" himself \"\n     rplc = \" herself \"\n\n     'Perform the Find/Replace All\n     sht.Cells.Replace What:=fnd, Replacement:=rplc, _\n     LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=True, _\n     SearchFormat:=False, ReplaceFormat:=False\n</code></pre>\n\n<p>I need to refer to change only one cell. It changes everything.</p>\n"}, {"tags": ["excel", "vba", "ssrs-2012"], "comments": [{"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1561534094, "post_id": 56764805, "comment_id": 100090713, "body": "How are these Cells colored? Conditional formatting or by changing the cell directly? Is the new file a openXML type? (.xlsm, .xlsx)"}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1561534244, "post_id": 56764805, "comment_id": 100090782, "body": "<code>Filename:=&quot;C:\\Users\\merge.xls&quot;, FileFormat:=xlOpenXMLWorkbook,</code> doesn&#39;t match,  should be an .xlsx file"}, {"owner": {"reputation": 883, "user_id": 1025057, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/6b264217845006b81c173044e2b29d7e?s=128&d=identicon&r=PG", "display_name": "0537", "link": "https://stackoverflow.com/users/1025057/0537"}, "reply_to_user": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1561542570, "post_id": 56764805, "comment_id": 100095319, "body": "I even tried changing from .xls to .xlsx, still the same."}, {"owner": {"reputation": 883, "user_id": 1025057, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/6b264217845006b81c173044e2b29d7e?s=128&d=identicon&r=PG", "display_name": "0537", "link": "https://stackoverflow.com/users/1025057/0537"}, "reply_to_user": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1561542635, "post_id": 56764805, "comment_id": 100095364, "body": "source files are generated from SSRS, coloring is done in the .RDL file"}], "answers": [{"tags": [], "owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "is_accepted": false, "score": 0, "last_activity_date": 1561543878, "creation_date": 1561543878, "answer_id": 56770287, "question_id": 56764805, "link": "https://stackoverflow.com/questions/56764805/color-formatting-is-lost-after-merging-multiple-workbooks-into-one/56770287#56770287", "title": "Color formatting is lost after merging multiple workbooks into one", "body": "<p>Use <code>.Copy</code> and <code>.PasteSpecial</code>, usually those should be avoided, but in this case they seem to be the only solution...</p>\n\n<blockquote>\n  <p>Cause:<br>\n  The problem occurs because both SQL Server Reporting Services 2008 and SQL Server Reporting services 2008 R2 use a customized Color Palette instead of the built-in palette that ships with Excel. The first 56 unique colors used in the report are defined in a custom palette.</p>\n  \n  <p>Workaround:<br>\n  You can work around this problem using one of the following methods depending on the version of Excel you use in your environment:</p>\n  \n  <p>Excel 2007 or Excel 2010: Use one of the following methods:</p>\n  \n  <p>Method 1: Use Ctrl+C and Ctrl+V combination with the following steps:</p>\n  \n  <p>Copy the source data by pressing Ctrl+C in the source workbook.\n  In the new workbook use one of the following methods to retain source formatting:\n  Right click and choose Paste Special option from the Edit Menu and then paste the data by selecting Using all source theme option.\n  or\n  After pressing Ctrl+V in the new worksheet choose Keep source formatting in Paste Options.</p>\n  \n  <p>One caveat that you need to be aware of when using this method is that the row height and column width may not carry over to the new workbook. To keep row height and column width, you can first do Move or Copy Sheet to the new workbook to ensure column width and row height are acceptable and then copy the content using source format again.</p>\n  \n  <p>Method 2:Use Move or Copy Sheet operations with the following additional steps:</p>\n  \n  <p>After doing Move or Copy Sheet to copy the sheet to another workbook do the following:\n  Go to File menu and select Options in the left pane.\n  In the Excel Options page, select Save option.\n  Click Colors\u2026 button under Preserve visual appearance of the workbook.\n  In the Color page, in the Copy colors from list box, select the source excel file that is exported from SQL Server Reporting Services.\n  Click OK twice to close all the option windows.</p>\n  \n  <p>You can also automate this workaround using a Macro Code that is similar to the following:</p>\n\n<pre><code>Sub Sample() \n    Sheets(\"OriginalExcelSheetExportedFromReport\").Select \n    Sheets(\"OriginalExcelSheetExportedFromReport \").Copy \n    ActiveWorkbook.Colors = Workbooks(\"OriginalExcelSheetExportedFromReport.xls\").Colors \nEnd Sub\n</code></pre>\n  \n  <p>Excel 2003: Use Move or Copy Sheet  operations with the following additional steps:</p>\n  \n  <p>After doing Move or Copy sheet to copy the sheet to another workbook do the following:\n  Go to Tools menu and click Options.\n  Select the Color tab, and in the Copy colors from list box, select the source excel file that is exported from SQL Server Reporting Services. Click OK to close the dialog box.</p>\n</blockquote>\n\n<p>Source: <a href=\"https://support.microsoft.com/en-sg/help/2465477/colors-get-distorted-when-you-copy-an-excel-worksheet-that-is-exported\" rel=\"nofollow noreferrer\">Microsoft Support 2465477</a><br>\nSimiliar Question: <a href=\"https://stackoverflow.com/a/6447743/10223558\">https://stackoverflow.com/a/6447743/10223558</a></p>\n\n<p>While we're at it you could try the code below to avoid <code>ActiveWorkbook</code></p>\n\n<pre><code>Do While Filename &lt;&gt; \"\"\n    With Workbooks.Open(Filename:=Path &amp; Filename, ReadOnly:=True)\n        For Each Sheet In .Sheets\n            Sheet.Copy After:=ThisWorkbook.Sheets(1)\n        Next Sheet\n        .Close\n    End With\n    Filename = Dir()\nLoop\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 883, "user_id": 1025057, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/6b264217845006b81c173044e2b29d7e?s=128&d=identicon&r=PG", "display_name": "0537", "link": "https://stackoverflow.com/users/1025057/0537"}, "is_accepted": false, "score": 0, "last_activity_date": 1561545863, "creation_date": 1561545863, "answer_id": 56770965, "question_id": 56764805, "link": "https://stackoverflow.com/questions/56764805/color-formatting-is-lost-after-merging-multiple-workbooks-into-one/56770965#56770965", "title": "Color formatting is lost after merging multiple workbooks into one", "body": "<p>I found out the issue, made a change in the code, added a single line which copies the color from the source file to the new file without any changes.</p>\n\n<pre><code>Workbooks.Open Filename:=Path &amp; Filename, ReadOnly:=True\nFor Each Sheet In ActiveWorkbook.Sheets\nSheet.Copy After:=ThisWorkbook.Sheets(1)  \n\n***ActiveWorkbook.Colors = Workbooks(Filename).Colors***  \n</code></pre>\n"}], "owner": {"reputation": 883, "user_id": 1025057, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/6b264217845006b81c173044e2b29d7e?s=128&d=identicon&r=PG", "display_name": "0537", "link": "https://stackoverflow.com/users/1025057/0537"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1561545863, "creation_date": 1561520138, "last_edit_date": 1561520951, "question_id": 56764805, "link": "https://stackoverflow.com/questions/56764805/color-formatting-is-lost-after-merging-multiple-workbooks-into-one", "title": "Color formatting is lost after merging multiple workbooks into one", "body": "<p>I have a couple of SSRS reports (.xls files) with different Structures:</p>\n\n<ul>\n<li>Report 1 has 3 excel sheets inside it.  </li>\n<li>Report 2 has 2 excel sheets inside it.  </li>\n<li>Report 3 has 4 excel sheets inside it.  </li>\n</ul>\n\n<p>I want all these 9 excel sheets to be merged into single Excel file having different sheets, that is, my final excel file should have all these 9 sheets where I am able to achieve using the below macro code. </p>\n\n<pre><code>Path = \"C:\\Users\\FILES\\\" ' This will fetch all the files form the mentioned location\nFilename = Dir(Path &amp; \"*.xls\")\nDo While Filename &lt;&gt; \"\"\n    Workbooks.Open Filename:=Path &amp; Filename, ReadOnly:=True\n    For Each Sheet In ActiveWorkbook.Sheets\n        Sheet.Copy After:=ThisWorkbook.Sheets(1)\n    Next Sheet\n    Workbooks(Filename).Close\n    Filename = Dir()\nLoop\n\nApplication.DisplayAlerts = False ' Delete an extra sheet\nWorksheets(\"SHEET1\").Delete\nApplication.DisplayAlerts = True\n\nApplication.DisplayAlerts = False ' This will create a new excel file and stores all the data in to it.\nThisWorkbook.CheckCompatibility = False\nThisWorkbook.SaveAs Filename:=\"C:\\Users\\merge.xls\", FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\nApplication.DisplayAlerts = True\n\nApplication.DisplayAlerts = False ' Save and exit\nThisWorkbook.Save\nApplication.DisplayAlerts = True\nApplication.Quit  \n</code></pre>\n\n<p>The only problem I am facing is while merging the files my VBA code excluding the colors applied to a few cells in my SSRS reports.  </p>\n\n<p>How can I copy the excel files without losing the color format already applied?</p>\n"}, {"tags": ["excel", "vba", "if-statement", "sum"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1561519103, "post_id": 56764670, "comment_id": 100085804, "body": "Add <code>Option Explicit</code> at the very top of the module, then declare all variables. <code>Dim myRange As Range</code>. Then add <code>Set</code> before <code>myRange = ...</code>."}, {"owner": {"reputation": 17, "user_id": 11601808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aecbedd3be6c93b9485582be0f07b26?s=128&d=identicon&r=PG&f=1", "display_name": "Nabil", "link": "https://stackoverflow.com/users/11601808/nabil"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1561519352, "post_id": 56764670, "comment_id": 100085851, "body": "Sorry, still doesn&#39;t work (msgbox says please review when clearly the sum of the range in one workbook equals the cell in another workbook"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1561519442, "post_id": 56764670, "comment_id": 100085866, "body": "Do any of the values have numbers after the decimal point?"}, {"owner": {"reputation": 17, "user_id": 11601808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aecbedd3be6c93b9485582be0f07b26?s=128&d=identicon&r=PG&f=1", "display_name": "Nabil", "link": "https://stackoverflow.com/users/11601808/nabil"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1561519501, "post_id": 56764670, "comment_id": 100085882, "body": "They do not, but most likely would in the future"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1561519546, "post_id": 56764670, "comment_id": 100085890, "body": "Then you can&#39;t use <code>As Long</code>. I&#39;d get rid of <code>x</code> entirely and check if the value equals the sum."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1561519683, "post_id": 56764670, "comment_id": 100085912, "body": "you need <code>As Double</code> . Also you might not be reliably taking the last row."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1561519761, "post_id": 56764670, "comment_id": 100085925, "body": "you should also debug the MyRange.Address to see if it is what you expect it to be."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1561519776, "post_id": 56764670, "comment_id": 100085926, "body": "Or just do a sum on the entire column and scrap finding the last row, unless you specifically don&#39;t want the entire column. <code>Sum</code> can handle an entire column pretty easily. Also remove the parentheses following the <code>MsgBox</code>."}, {"owner": {"reputation": 17, "user_id": 11601808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aecbedd3be6c93b9485582be0f07b26?s=128&d=identicon&r=PG&f=1", "display_name": "Nabil", "link": "https://stackoverflow.com/users/11601808/nabil"}, "edited": false, "score": 0, "creation_date": 1561520025, "post_id": 56764670, "comment_id": 100085961, "body": "lol can I have an example set out"}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 0, "last_activity_date": 1561520525, "creation_date": 1561520525, "answer_id": 56764852, "question_id": 56764670, "link": "https://stackoverflow.com/questions/56764670/how-to-use-if-then-conditional-across-workbooks-in-vba/56764852#56764852", "title": "How to use If-Then Conditional Across Workbooks in VBA?", "body": "<p>As an example:</p>\n\n<pre><code>Sub MyCode()\n    Dim myRange As Range\n    Set myRange = Workbooks(\"Book2\").Sheets(\"Sheet1\").Columns(2)\n\n    If Workbooks(\"Book1\").Sheets(\"Sheet1\").Range(\"A1\").Value = WorksheetFunction.Sum(myRange) Then\n        MsgBox \"Values equal\"\n    Else\n        MsgBox \"Please review values\"\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 11601808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aecbedd3be6c93b9485582be0f07b26?s=128&d=identicon&r=PG&f=1", "display_name": "Nabil", "link": "https://stackoverflow.com/users/11601808/nabil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561520525, "creation_date": 1561518913, "last_edit_date": 1561519237, "question_id": 56764670, "link": "https://stackoverflow.com/questions/56764670/how-to-use-if-then-conditional-across-workbooks-in-vba", "title": "How to use If-Then Conditional Across Workbooks in VBA?", "body": "<p>I want to use if-then statement across two workbooks.</p>\n\n<p>I've defined x as Long but x does not appear to hold the value of the sum of all cells in column B</p>\n\n<p>But the code looks right, any thoughts?</p>\n\n<pre><code>Sub mycode()\n\n\n       Dim x As Long\n\n\n       myRange = Workbooks(\"Book2\").Sheets(\"Sheet1\").Range(\"B1\", _ \n       Range(\"B1\").End(xlDown))\n\n\n       x = WorksheetFunction.Sum(myRange)    '&lt;&lt;does not seem to hold value\n\n\n\n      If Workbooks(\"Book1\").Sheets(\"Sheet1\").Range(\"A1\").Value = x Then\n\n         MsgBox (\"values equal\")\n\n      Else\n\n         MsgBox (\"please review values\")\n\n      End If\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "function", "combobox"], "answers": [{"comments": [{"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "reply_to_user": {"reputation": 1, "user_id": 11700287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6726e77a023e6f16055d0cb6f1e23409?s=128&d=identicon&r=PG", "display_name": "Messi2019", "link": "https://stackoverflow.com/users/11700287/messi2019"}, "edited": false, "score": 0, "creation_date": 1561583206, "post_id": 56765547, "comment_id": 100116761, "body": "@Messi2019: The easy Stack Overflow way to thank someone is to accept their answer (the tick on the left hand side of the answer). Actually, this works across the full range of Stack Exchange."}], "tags": [], "owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "is_accepted": false, "score": 1, "last_activity_date": 1561525643, "creation_date": 1561525643, "answer_id": 56765547, "question_id": 56764552, "link": "https://stackoverflow.com/questions/56764552/pass-a-combobox-as-an-argument-in-a-sub-or-function/56765547#56765547", "title": "Pass a ComboBox as an argument in a Sub or Function", "body": "<p>Your problem lies in how you call the subroutine</p>\n\n<pre><code>SortCBox (Me.ComboBox1) ' &lt;-- Wrong!\n</code></pre>\n\n<p>which will evaluate <code>Me.ComboBox1</code> depending on the default value, so most likely will call <code>SortCBox</code> with a string parameter - which is not what you want. </p>\n\n<p>You should call the subroutine through</p>\n\n<pre><code>SortCBox Me.ComboBox1 ' &lt;-- Right!\n</code></pre>\n\n<p>which will pass it through as intended.</p>\n\n<p>The simple explanation is provided by Microsoft (<a href=\"https://docs.microsoft.com/en-us/office/vba/language/concepts/getting-started/using-parentheses-in-code\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/language/concepts/getting-started/using-parentheses-in-code</a>).</p>\n"}], "owner": {"reputation": 1, "user_id": 11700287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6726e77a023e6f16055d0cb6f1e23409?s=128&d=identicon&r=PG", "display_name": "Messi2019", "link": "https://stackoverflow.com/users/11700287/messi2019"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561526966, "creation_date": 1561517844, "question_id": 56764552, "link": "https://stackoverflow.com/questions/56764552/pass-a-combobox-as-an-argument-in-a-sub-or-function", "title": "Pass a ComboBox as an argument in a Sub or Function", "body": "<p>I have problems passing a ComboBox as an argument in a Subprocess. Before I used a subprocess to order the content of each ComboBox and what I try now is to reduce code.</p>\n\n<p>I explain:\nThe form contains N ComboBox (1, 2, ... N) that is filled with the contents of a table column each. For example:</p>\n\n<pre><code>Set NColumn = TStaff.ListColumns(\"NameStaff\").DataBodyRange\nMe.ComboBox1.List = NColumn.value\nSortComboBox1\n\nSet IDColumn = TStaff.ListColumns(\"IDStaff\").DataBodyRange\nMe.ComboBox2.List = IDColumn.value\nSortComboBox2\n\n...\n\nSortComboBoxN\n</code></pre>\n\n<p>The code used to order the content of each ComboBox is the following:</p>\n\n<pre><code>Private Sub SortComboBox1()\nDim i As Long\nDim j As Long\nDim sTemp As String\nDim LbList As Variant\n\nLbList = Me.ComboBox1.List\n\nFor i = LBound(LbList, 1) To UBound(LbList, 1) - 1\n    For j = i + 1 To UBound(LbList, 1)\n        If LbList(i, 0) &gt; LbList(j, 0) Then\n\n            sTemp = LbList(i, 0)\n            LbList(i, 0) = LbList(j, 0)\n            LbList(j, 0) = sTemp\n        End If\n    Next j\nNext i\n\nMe.ComboBox1.Clear\n\nMe.ComboBox1.List = LbList\nEnd Sub\n\nPrivate Sub SortComboBox2()\n...\nEnd sub\n\n...\n\nPrivate Sub SortComboBoxN()\n...\nEnd sub\n</code></pre>\n\n<p>What I'm looking for is a subprocess that receives as an argument any ComboBox (or its content) and avoid repeating the same code to order each ComboBox.</p>\n\n<p>My first approach was this but the \"error 424\" occurs (an object is required):</p>\n\n<p>Modulo1:</p>\n\n<pre><code>Public CBox As ComboBox\n</code></pre>\n\n<p>UserForm(Code)</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n...\nMe.ComboBox1.List = NColumn.value\nSortCBox (Me.ComboBox1)\nMe.ComboBox2.List = IDColumn.value\nSortCBox (Me.ComboBox2)\nEnd Sub\n\nPrivate Sub SortCBox(ByRef CBox As MSForms.ComboBox)\nDim i As Long\nDim j As Long\nDim sTemp As String\nDim LbList As Variant\n\nLbList = CBox.List \n\nFor i = LBound(LbList, 1) To UBound(LbList, 1) - 1\n    For j = i + 1 To UBound(LbList, 1)\n        If LbList(i, 0) &gt; LbList(j, 0) Then\n            sTemp = LbList(i, 0)\n            LbList(i, 0) = LbList(j, 0)\n            LbList(j, 0) = sTemp\n        End If\n    Next j\nNext i\n\nCBox.Clear\n\nCBox.List = LbList\nEnd Sub\n</code></pre>\n\n<p>Where is the problem??\n* If someone has another approach, thank you for the suggestions</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1561516363, "post_id": 56764282, "comment_id": 100085331, "body": "When deleting, you need to move from the end to the beginning, or you run off them end of the array, which means that <code>remarkRange</code> returns nothing towrard the end and you&#39;re calling <code>Delete</code> on an invalid range.. Reverse your loop to go from UBound() to LBound() instead with a -1 step."}, {"owner": {"reputation": 70, "user_id": 7972633, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Jzxm.gif?s=128&g=1", "display_name": "TryHarder", "link": "https://stackoverflow.com/users/7972633/tryharder"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1561516726, "post_id": 56764282, "comment_id": 100085392, "body": "@KenWhite Thanks for the suggestion. Is there another way to do it since before executing the <b>If condition</b> , there is others condition that i need to check, where the counter <b>I</b> will affect my output. I did try to set  <b>remarkRange(I, 1)=&quot; &quot;</b> where is the condition is true is will set the specific element in array to <b>&quot;&quot;</b>.    May i know your suggestion about this? Thankss."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1561517155, "post_id": 56764282, "comment_id": 100085477, "body": "I don&#39;t know why the <code>if</code> changes anything, but I don&#39;t know what <i>there is other condition that I need to check</i> means. You&#39;ve asked why you&#39;re getting the error you&#39;re getting, and I&#39;ve explained that and given you a way to prevent it. I&#39;m not sure why <code>if (some condition is true)</code> would be affected by reversing the order of the loop."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1561517445, "post_id": 56764282, "comment_id": 100085520, "body": "An array doesn&#39;t have a <code>Delete</code> method, so you can&#39;t <code>Delete</code> an element from it. What do you want to do with the array? Changing one element to <code>&quot;&quot;</code> might be an option. Note that it&#39;s confusing to call your array a <code>Range</code>. Maybe consider a different name entirely."}, {"owner": {"reputation": 70, "user_id": 7972633, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Jzxm.gif?s=128&g=1", "display_name": "TryHarder", "link": "https://stackoverflow.com/users/7972633/tryharder"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1561520305, "post_id": 56764282, "comment_id": 100086015, "body": "@KenWhite Thanks brother, your solution did help me to solve my error, but the output of using this way is not the output that I expected. Thanks, I learned new stuff again, Happy Learning &lt;3"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1563343230, "post_id": 56764282, "comment_id": 100662715, "body": "Maybe Dictionary or ArrayList will be more suitable for your task."}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1561518438, "creation_date": 1561518438, "answer_id": 56764627, "question_id": 56764282, "link": "https://stackoverflow.com/questions/56764282/error-424-when-trying-to-delete-element-in-array-vba/56764627#56764627", "title": "Error 424 when trying to delete element in array vba", "body": "<p>An array doesn't have a <code>Delete</code> method. It's also misleading to have the <code>Range</code> in <code>remarkRange</code> when it's an array, not a <code>Range</code>. Maybe a different name, e.g. <code>remarks</code> or whatever is clear to you.</p>\n\n<p>If you're going to write the array back to the worksheet, then I see no problem changing an element to a blank string.</p>\n\n<pre><code>For i = LBound(remarks, 1) To UBound(remarks, 1)\n    If some condition Then\n        remarks(i, 1) = \"\"\n    End If\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 1, "last_activity_date": 1561520239, "last_edit_date": 1561520239, "creation_date": 1561519794, "answer_id": 56764764, "question_id": 56764282, "link": "https://stackoverflow.com/questions/56764282/error-424-when-trying-to-delete-element-in-array-vba/56764764#56764764", "title": "Error 424 when trying to delete element in array vba", "body": "<p>It seems you'll need to decide what you mean by 'delete'. I'm not aware of a <code>Delete</code> property of an array of variants so while your code might compile it would throw an object required error.</p>\n\n<p>However, your point about previously using the <code>Clear</code> method on a <code>Range</code> object, suggests that you just want to read your range values into an array, remove the contents if certain conditions aren't me, and then re-write your array to the range. If that's the case, you probably wouldn't want to resize your array as the rows or columns wouldn't line up - more commonly, you'd set the item of your variant array to <code>Empty</code>.</p>\n\n<p>The code below shows how to do this in a simple routine of taking 10 numbers from column A, removing all odd numbers and re-writing the numbers to Column C - but with the rows still matching:</p>\n\n<pre><code>Public Sub EmptyItemsAndKeepArraySize()\n    Dim inArr() As Variant\n    Dim i As Long\n\n    'Read range into arrays.\n    inArr = Sheet1.Range(\"A1:A10\").Value2\n\n    'Clear all numbers that are not even.\n    For i = 1 To UBound(inArr, 1)\n        If inArr(i, 1) Mod 2 &lt;&gt; 0 Then inArr(i, 1) = Empty\n    Next\n\n    'Write cleared array to column C\n    Sheet1.Range(\"c1\").Resize(UBound(inArr, 1)).Value = inArr\nEnd Sub\n</code></pre>\n\n<p>If, however, you really do want to remove and resize your array, then a simple way of doing it is to populate a temporary collection first, resizing an output array and then populating that with the collection items. In the example below the code removes all odd numbers and then writes the array to column B - but as an array reduced in size (ie contiguous rows):</p>\n\n<pre><code>Public Sub DeleteItemsAndShrinkArray()\n    Dim inArr() As Variant, outArr() As Variant\n    Dim i As Long\n    Dim temp As Collection\n    Dim v As Variant\n\n    'Read range into arrays.\n    inArr = Sheet1.Range(\"A1:A10\").Value2\n\n    'Keep all even numbers in a temporary collection.\n    Set temp = New Collection\n    For i = 1 To UBound(inArr, 1)\n        If inArr(i, 1) Mod 2 = 0 Then temp.Add inArr(i, 1)\n    Next\n\n    'Dimension the output array.\n    ReDim outArr(1 To temp.Count, 1 To 1)\n\n    'Populate new array from temp collection.\n    i = 1\n    For Each v In temp\n        outArr(i, 1) = v\n        i = i + 1\n    Next\n\n    'Write reduced array to column B\n    Sheet1.Range(\"B1\").Resize(UBound(outArr, 1)).Value = outArr\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 70, "user_id": 7972633, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Jzxm.gif?s=128&g=1", "display_name": "TryHarder", "link": "https://stackoverflow.com/users/7972633/tryharder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "closed_date": 1605088959, "accepted_answer_id": 56764627, "answer_count": 2, "score": -2, "last_activity_date": 1561527013, "creation_date": 1561515564, "last_edit_date": 1561527013, "question_id": 56764282, "link": "https://stackoverflow.com/questions/56764282/error-424-when-trying-to-delete-element-in-array-vba", "closed_reason": "Duplicate", "title": "Error 424 when trying to delete element in array vba", "body": "<p>I was trying to delete the specific element in the array vba when certain condition are true but i end up getting error 424. May I know the right way to do it? I tired to use redim, however it doesn't suit my condition as after the comparing with others array i need to store the data back into excel file where the location in the excel file is already sorted.</p>\n\n<p>Before changing the remarkRange to array variant, I used it as <strong>Dim remarkRange \n As Range</strong> where I can just use <strong>.Clear</strong> to clear the range item in a specific element.</p>\n\n<p>I tried <code>remarkRange(I, 1)=\" \"</code> it runs without error but im not sure if its suitable.  May I know the correct way to do it? Thanks.</p>\n\n<pre><code>Dim remarkRange() As Variant\nremarkRange= wb.Sheets(\"wb\").Range(\"A1:A5\").Value2 \n\nFor I = LBound(remarkRange) To UBound(remarkRange)\n   If (some condition is true) then\n       remarkRange(I, 1).Delete\n   End If\nNext I\n</code></pre>\n\n<p>I expected the element in the specific cell in the array to be empty, but I got error 424</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1561515599, "post_id": 56764268, "comment_id": 100085197, "body": "You aren&#39;t using <code>Range()</code> correctly - where&#39;s the last row you want to paste to? What have you tried, there are a bunch of ways to get the last row via VBA. (You&#39;ll need to eventually do, like <code>objASheets.Range(&quot;$O$2:$O$&quot; &amp; iRowCount1)...</code>)"}, {"owner": {"reputation": 187, "user_id": 4539537, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-OC3ljdVUWTI/AAAAAAAAAAI/AAAAAAAAAAA/rWbxfhRAFGk/photo.jpg?sz=128", "display_name": "Srini", "link": "https://stackoverflow.com/users/4539537/srini"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1561515820, "post_id": 56764268, "comment_id": 100085237, "body": "Thank you for the quick response, I know I am not using range function correctly. How can I attach sample excel file?"}, {"owner": {"reputation": 187, "user_id": 4539537, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-OC3ljdVUWTI/AAAAAAAAAAI/AAAAAAAAAAA/rWbxfhRAFGk/photo.jpg?sz=128", "display_name": "Srini", "link": "https://stackoverflow.com/users/4539537/srini"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1561516696, "post_id": 56764268, "comment_id": 100085386, "body": "I have added the image of excel here, on the ones in blue is existing entries, yellow ones are added out of which red ones are identified and removed as duplicates. How to achieve this?"}, {"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1561533655, "post_id": 56764268, "comment_id": 100090506, "body": "I find your question quite hard to follow as it seems you have several requirements/Questions inside? If so maybe you should make several short and clear questions instead of this one"}], "owner": {"reputation": 187, "user_id": 4539537, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-OC3ljdVUWTI/AAAAAAAAAAI/AAAAAAAAAAA/rWbxfhRAFGk/photo.jpg?sz=128", "display_name": "Srini", "link": "https://stackoverflow.com/users/4539537/srini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561530033, "creation_date": 1561515418, "last_edit_date": 1561530033, "question_id": 56764268, "link": "https://stackoverflow.com/questions/56764268/how-to-select-range-and-update-in-excel-by-finding-last-row-in-vba", "title": "How to select range and update in excel by finding last row in VBA?", "body": "<p>I am trying to copy paste specific columns from one sheet to another sheet which already has some values:</p>\n\n<p>Example:\nSheet 1 has 20 entries with Columns A to H\nSheet 2 has 100 entries and data filtered and now 50 entries show up\nFrom Sheet 2 select Column C get all the values and copy\nPaste it in Sheet 1 from row 21 of column C (as first 2 rows has data)\nAgain from sheet 2 Column D get all values and copy\nPaste it in Sheet 2 from row 21 of column D</p>\n\n<p>From Column C to Column H, remove duplicate entries</p>\n\n<p>I am trying to SpecialCells(xlCellTypeVisible).Copy and PasteSpecial Paste:=xlPasteAll</p>\n\n<pre><code>iRowCount1 = objASheets.UsedRange.Rows.Count\niRowCount2 = objBSheets.UsedRange.Rows.Count\nobjASheets.Range(\"$O$2:O\").SpecialCells(xlCellTypeVisible).Copy\nobjBSheets.Range(\"$C$2:C\").PasteSpecial Paste:=xlPasteAll\nobjASheets.Range(\"J$2:J\").SpecialCells(xlCellTypeVisible).Copy\nobjBSheets.Range(\"$D$2:D\").PasteSpecial Paste:=xlPasteAll\nApplication.CutCopyMode = False\nobjBSheets.Range(\"$G$2:G\").Value = \"FAIL\"\nobjBSheets.Range(\"$H$2:H\").Value = \"Not found\"\n</code></pre>\n\n<p>I want to be able to parameterize iRowCount1 and iRowCount2 into the range function, get the list updated and remove duplicates.</p>\n\n<p>First 10 rows (ignore the 1st row as its header) exists in the file, next 13 rows are added out of which needs to be removed from bottom half and not from top.</p>\n\n<p><a href=\"https://i.stack.imgur.com/7M26e.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7M26e.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["sql", "vba", "ms-access", "concatenation", "rows"], "comments": [{"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1561513636, "post_id": 56764071, "comment_id": 100084821, "body": "Are there only two values?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1561518512, "post_id": 56764071, "comment_id": 100085709, "body": "So according to error msg, RootReq is a multi-value field. You would be better off normalizing data structure."}, {"owner": {"reputation": 33, "user_id": 11700384, "user_type": "registered", "profile_image": "https://graph.facebook.com/2549336945101287/picture?type=large", "display_name": "Stefan87", "link": "https://stackoverflow.com/users/11700384/stefan87"}, "edited": false, "score": 0, "creation_date": 1561524286, "post_id": 56764071, "comment_id": 100086880, "body": "there can be many values, not only 2..."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11700384, "user_type": "registered", "profile_image": "https://graph.facebook.com/2549336945101287/picture?type=large", "display_name": "Stefan87", "link": "https://stackoverflow.com/users/11700384/stefan87"}, "edited": false, "score": 0, "creation_date": 1561529536, "post_id": 56764729, "comment_id": 100088574, "body": "&quot;Query1&quot; works fine but when I try later use ConcatRelated() function I am getting error 3464 Data type mismatch in criteria expression. What I did wrong?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 33, "user_id": 11700384, "user_type": "registered", "profile_image": "https://graph.facebook.com/2549336945101287/picture?type=large", "display_name": "Stefan87", "link": "https://stackoverflow.com/users/11700384/stefan87"}, "edited": false, "score": 0, "creation_date": 1561530289, "post_id": 56764729, "comment_id": 100088891, "body": "Hard to say. I built tables to replicate your posted data and then built queries which work perfect for me. What do I need to know about your table structures? Are fields all text type?"}, {"owner": {"reputation": 33, "user_id": 11700384, "user_type": "registered", "profile_image": "https://graph.facebook.com/2549336945101287/picture?type=large", "display_name": "Stefan87", "link": "https://stackoverflow.com/users/11700384/stefan87"}, "edited": false, "score": 0, "creation_date": 1561530646, "post_id": 56764729, "comment_id": 100089057, "body": "in table SW_requirements, column &quot;RootReq&quot; is number... it was created like this by Access when Ive created look up rule to filed &quot;CR_ReqID &quot; in Contract_Requirements... I cant change RootReq to text..."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 33, "user_id": 11700384, "user_type": "registered", "profile_image": "https://graph.facebook.com/2549336945101287/picture?type=large", "display_name": "Stefan87", "link": "https://stackoverflow.com/users/11700384/stefan87"}, "edited": false, "score": 0, "creation_date": 1561530831, "post_id": 56764729, "comment_id": 100089148, "body": "Then CR_ReqID must also be number type or there is another field in Contract_Requirements that is key field for joining to RootReq. Remove apostrophes delimiting CR_ReqID."}, {"owner": {"reputation": 33, "user_id": 11700384, "user_type": "registered", "profile_image": "https://graph.facebook.com/2549336945101287/picture?type=large", "display_name": "Stefan87", "link": "https://stackoverflow.com/users/11700384/stefan87"}, "edited": false, "score": 0, "creation_date": 1561530983, "post_id": 56764729, "comment_id": 100089210, "body": "and I dont have idea how to check what is the data type of &quot;SW_Requirements.RootReq.Value&quot;..."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 33, "user_id": 11700384, "user_type": "registered", "profile_image": "https://graph.facebook.com/2549336945101287/picture?type=large", "display_name": "Stefan87", "link": "https://stackoverflow.com/users/11700384/stefan87"}, "edited": false, "score": 0, "creation_date": 1561531028, "post_id": 56764729, "comment_id": 100089231, "body": "You already said that field is number type. Now what type is the corresponding field in Contract_Requirements? You said they are related so they must be same data type."}, {"owner": {"reputation": 33, "user_id": 11700384, "user_type": "registered", "profile_image": "https://graph.facebook.com/2549336945101287/picture?type=large", "display_name": "Stefan87", "link": "https://stackoverflow.com/users/11700384/stefan87"}, "edited": false, "score": 0, "creation_date": 1561532663, "post_id": 56764729, "comment_id": 100089998, "body": "it is weir and I feel like idiot now... now I&#39;ve noticed that when I was using lookup Wizard to connect RootReq with CR_ReqID, in relationship window connection was between [ID] from Contract_Requirements and [RootReq] in SW_Requirements...I&#39;ve made [CR_ReqID] as a primary key and then linked it with RootReq via lookup wizard... now everything is working like a charm... THANK YOU!!!"}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 1, "last_activity_date": 1561520080, "last_edit_date": 1561520080, "creation_date": 1561519434, "answer_id": 56764729, "question_id": 56764071, "link": "https://stackoverflow.com/questions/56764071/concatenating-multiple-rows-with-multiple-values-in-it-into-single-line-in-ms/56764729#56764729", "title": "Concatenating multiple rows, with multiple values in it, into single line in MS Access", "body": "<p>Build a query that expands the multi-value field elements to individual records.</p>\n\n<p>Query1</p>\n\n<pre><code>SELECT SW_Requirements.Title, SW_Requirements.SW_ReqID, SW_Requirements.RootReq.Value \nFROM SW_Requirements;\n</code></pre>\n\n<p>Then use that query as source for ConcatRelated() function.</p>\n\n<pre><code>SELECT Contract_Requirements.*, \nConcatRelated(\"SW_ReqID\",\"Query1\",\"[SW_Requirements.RootReq.Value]='\" &amp; [CR_ReqID] &amp; \"'\") AS WhereUsed\nFROM Contract_Requirements;\n</code></pre>\n\n<p>Advise not to use spaces nor punctuation/special characters in naming convention.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 11700384, "user_type": "registered", "profile_image": "https://graph.facebook.com/2549336945101287/picture?type=large", "display_name": "Stefan87", "link": "https://stackoverflow.com/users/11700384/stefan87"}, "edited": false, "score": 0, "creation_date": 1561535024, "post_id": 56767598, "comment_id": 100091201, "body": "THank you for your post, will try it also :)"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1561534605, "creation_date": 1561534605, "answer_id": 56767598, "question_id": 56764071, "link": "https://stackoverflow.com/questions/56764071/concatenating-multiple-rows-with-multiple-values-in-it-into-single-line-in-ms/56767598#56767598", "title": "Concatenating multiple rows, with multiple values in it, into single line in MS Access", "body": "<p>You can also use my <em>DJoin</em> function as this will accept SQL as the source, thus you won't need additional saved queries:</p>\n\n<pre><code>' Returns the joined (concatenated) values from a field of records having the same key.\n' The joined values are stored in a collection which speeds up browsing a query or form\n' as all joined values will be retrieved once only from the table or query.\n' Null values and zero-length strings are ignored.\n'\n' If no values are found, Null is returned.\n'\n' The default separator of the joined values is a space.\n' Optionally, any other separator can be specified.\n'\n' Syntax is held close to that of the native domain functions, DLookup, DCount, etc.\n'\n' Typical usage in a select query using a table (or query) as source:\n'\n'   Select\n'       KeyField,\n'       DJoin(\"[ValueField]\", \"[Table]\", \"[KeyField] = \" &amp; [KeyField] &amp; \"\") As Values\n'   From\n'       Table\n'   Group By\n'       KeyField\n'\n' The source can also be an SQL Select string:\n'\n'   Select\n'       KeyField,\n'       DJoin(\"[ValueField]\", \"Select ValueField From SomeTable Order By SomeField\", \"[KeyField] = \" &amp; [KeyField] &amp; \"\") As Values\n'   From\n'       Table\n'   Group By\n'       KeyField\n'\n' To clear the collection (cache), call DJoin with no arguments:\n'\n'   DJoin\n'\n' Requires:\n'   CollectValues\n'\n' 2019-06-24, Cactus Data ApS, Gustav Brock\n'\nPublic Function DJoin( _\n    Optional ByVal Expression As String, _\n    Optional ByVal Domain As String, _\n    Optional ByVal Criteria As String, _\n    Optional ByVal Delimiter As String = \" \") _\n    As Variant\n\n    ' Expected error codes to accept.\n    Const CannotAddKey      As Long = 457\n    Const CannotReadKey     As Long = 5\n    ' SQL.\n    Const SqlMask           As String = \"Select {0} From {1} {2}\"\n    Const SqlLead           As String = \"Select \"\n    Const SubMask           As String = \"({0}) As T\"\n    Const FilterMask        As String = \"Where {0}\"\n\n    Static Values   As New Collection\n\n    Dim Records     As DAO.Recordset\n    Dim Sql         As String\n    Dim SqlSub      As String\n    Dim Filter      As String\n    Dim Result      As Variant\n\n    On Error GoTo Err_DJoin\n\n    If Expression = \"\" Then\n        ' Erase the collection of keys.\n        Set Values = Nothing\n        Result = Null\n    Else\n        ' Get the values.\n        ' This will fail if the current criteria hasn't been added\n        ' leaving Result empty.\n        Result = Values.Item(Criteria)\n        '\n        If IsEmpty(Result) Then\n            ' The current criteria hasn't been added to the collection.\n            ' Build SQL to lookup values.\n            If InStr(1, LTrim(Domain), SqlLead, vbTextCompare) = 1 Then\n                ' Domain is an SQL expression.\n                SqlSub = Replace(SubMask, \"{0}\", Domain)\n            Else\n                ' Domain is a table or query name.\n                SqlSub = Domain\n            End If\n            If Trim(Criteria) &lt;&gt; \"\" Then\n                ' Build Where clause.\n                Filter = Replace(FilterMask, \"{0}\", Criteria)\n            End If\n            ' Build final SQL.\n            Sql = Replace(Replace(Replace(SqlMask, \"{0}\", Expression), \"{1}\", SqlSub), \"{2}\", Filter)\n\n            ' Look up the values to join.\n            Set Records = CurrentDb.OpenRecordset(Sql, dbOpenSnapshot)\n            CollectValues Records, Delimiter, Result\n            ' Add the key and its joined values to the collection.\n            Values.Add Result, Criteria\n        End If\n    End If\n\n    ' Return the joined values (or Null if none was found).\n    DJoin = Result\n\nExit_DJoin:\n    Exit Function\n\nErr_DJoin:\n    Select Case Err\n        Case CannotAddKey\n            ' Key is present, thus cannot be added again.\n            Resume Next\n        Case CannotReadKey\n            ' Key is not present, thus cannot be read.\n            Resume Next\n        Case Else\n            ' Some other error. Ignore.\n            Resume Exit_DJoin\n    End Select\n\nEnd Function\n\n' To be called from DJoin.\n'\n' Joins the content of the first field of a recordset to one string\n' with a space as delimiter or an optional delimiter, returned by\n' reference in parameter Result.\n'\n' 2019-06-11, Cactus Data ApS, Gustav Brock\n'\nPrivate Sub CollectValues( _\n    ByRef Records As DAO.Recordset, _\n    ByVal Delimiter As String, _\n    ByRef Result As Variant)\n\n    Dim SubRecords  As DAO.Recordset\n\n    Dim Value       As Variant\n\n    If Records.RecordCount &gt; 0 Then\n        While Not Records.EOF\n            Value = Records.Fields(0).Value\n            If Records.Fields(0).IsComplex Then\n                ' Multi-value field (or attachment field).\n                Set SubRecords = Records.Fields(0).Value\n                CollectValues SubRecords, Delimiter, Result\n            ElseIf Nz(Value) = \"\" Then\n                ' Ignore Null values and zero-length strings.\n            ElseIf IsEmpty(Result) Then\n                ' First value found.\n                Result = Value\n            Else\n                ' Join subsequent values.\n                Result = Result &amp; Delimiter &amp; Value\n            End If\n            Records.MoveNext\n        Wend\n    Else\n        ' No records found with the current criteria.\n        Result = Null\n    End If\n    Records.Close\n\nEnd Sub\n</code></pre>\n\n<p>Full documentation can be found in my article: </p>\n\n<p><a href=\"https://www.experts-exchange.com/articles/33612/Join-concat-values-from-one-field-from-a-table-or-query.html\" rel=\"nofollow noreferrer\">Join (concat) values from one field from a table or query</a> </p>\n\n<p>If you don't have an account, browse to the link: Read the full article.</p>\n\n<p>Code is also on <strong>GitHub</strong>: <a href=\"https://github.com/GustavBrock/VBA.DJoin\" rel=\"nofollow noreferrer\">VBA.DJoin</a></p>\n"}], "owner": {"reputation": 33, "user_id": 11700384, "user_type": "registered", "profile_image": "https://graph.facebook.com/2549336945101287/picture?type=large", "display_name": "Stefan87", "link": "https://stackoverflow.com/users/11700384/stefan87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 643, "favorite_count": 0, "accepted_answer_id": 56764729, "answer_count": 2, "score": 3, "last_activity_date": 1594714913, "creation_date": 1561513581, "last_edit_date": 1594714913, "question_id": 56764071, "link": "https://stackoverflow.com/questions/56764071/concatenating-multiple-rows-with-multiple-values-in-it-into-single-line-in-ms", "title": "Concatenating multiple rows, with multiple values in it, into single line in MS Access", "body": "<p>I am trying to create simple requirements management database. Basically I have 2 tables like below:</p>\n\n<p>Contract_requirements with 2 columns:</p>\n\n<pre><code>CR_ReqID    |   Description\nreqCR1      |   Contract req description 1\nreqCR2      |   Contract req description 2\n</code></pre>\n\n<p>SW_requirements</p>\n\n<pre><code>Title               |   SW_ReqID     |  RootReq\nSW req description 1|   reqSW1       |   reqCR1, reqCR2\nSW req description 2|   reqSW2       |   reqCR1\nSW req description 3|   reqSW3       |   reqCR2\n</code></pre>\n\n<p>And I would like to write query to receive such a table:</p>\n\n<pre><code>CR_ReqID  |Description                  |where used?\nreqCR1    |Contract req description 1   |reqSW1, reqSW2  \nreqCR2    |Contract req description 2   |reqSW1, reqSW3\n</code></pre>\n\n<p>Tables \"Contract requirements\" and \"SW requirements\" are in relation via column \"RootReq\"</p>\n\n<p>Ive tried to implement code from Allen Browne \n<a href=\"http://allenbrowne.com/func-concat.html#Top\" rel=\"nofollow noreferrer\">http://allenbrowne.com/func-concat.html#Top</a></p>\n\n<p>This is my query </p>\n\n<pre><code>SELECT Contract_requirements.CR_ReqID, ConcatRelated(\"SW_ReqID     \",\"SW_requirements\",\"RootReq = \"\"\" &amp; [CR_ReqID] &amp; \"\"\"\") AS Expr1\nFROM Contract_requirements;\n</code></pre>\n\n<p>but I get error in Access </p>\n\n<blockquote>\n  <p>\"Error3831: The multi-valued field 'RootReq' cannot be used in a WHERE or HAVING clause\"</p>\n</blockquote>\n\n<p>Could you guys help me to make this working?\nThanks in advance</p>\n"}, {"tags": ["excel", "xml", "vba"], "comments": [{"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1561967844, "post_id": 56763848, "comment_id": 100215748, "body": "<code>is not appearing in its relevant tag</code> - what does it mean exactly? There is no such tag, or its contents is not correct?"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1561979057, "post_id": 56763848, "comment_id": 100221173, "body": "An OLE Object is attached to a <code>Sheet</code> and not a <code>Range&#47;Cell</code>. Use <code>ActiveSheet.OLEObjects</code> to retrieve it. The content may be accessible with <code>obj.Object.Text</code> depending on the type. If not then <a href=\"https://www.mrexcel.com/forum/excel-questions/941857-ole-objects-path-file-location.html\" rel=\"nofollow noreferrer\">duplicate the object and locate the temp file</a> or <a href=\"https://www.mrexcel.com/forum/excel-questions/937480-play-embedded-wav-file-when-workbook-opens-but-without-showing-media-player-2.html\" rel=\"nofollow noreferrer\">copy/parse</a> the clipboard."}, {"owner": {"reputation": 2670, "user_id": 3826387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0bc3e39607231181fa257d9b280247a?s=128&d=identicon&r=PG&f=1", "display_name": "RobertBaron", "link": "https://stackoverflow.com/users/3826387/robertbaron"}, "edited": false, "score": 0, "creation_date": 1562153379, "post_id": 56763848, "comment_id": 100286763, "body": "What is it that you want to add to the XML file? The name of the attachment? Its content?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562327562, "post_id": 56763848, "comment_id": 100349778, "body": "Actually a XML doucument is plain text, so what you can add to it is plain text. That could be a URL or path to a file, or the (plain text) content of a file. You need to be more precise in how your result should look like."}], "answers": [{"tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": false, "score": 0, "last_activity_date": 1562011671, "creation_date": 1562011671, "answer_id": 56841831, "question_id": 56763848, "link": "https://stackoverflow.com/questions/56763848/insert-an-attachment-to-an-xml-tag-using-vba/56841831#56841831", "title": "insert an attachment to an XML tag using VBA", "body": "<p>You have to declare variable type of <code>OleObject</code>:</p>\n\n<pre><code>Dim ol As OLEObject\n</code></pre>\n\n<p>Then, inside a <code>for next</code> loop:</p>\n\n<pre><code>Set ol = ActiveSheet.OLEObjects.Add(....)\nWith ol\n    .Top = rng.Top\n    .Left = rng.Left\nEnd With\n</code></pre>\n\n<p>For further details, please see: <a href=\"https://stackoverflow.com/questions/26911105/vba-macro-to-embed-oleobject-based-on-cell\">vba macro to embed OLEobject based on cell</a></p>\n"}], "owner": {"reputation": 859, "user_id": 2901545, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e99f0e740e64b32a2fece89ed33a4c29?s=128&d=identicon&r=PG&f=1", "display_name": "scb998", "link": "https://stackoverflow.com/users/2901545/scb998"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 250, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1562011671, "creation_date": 1561511208, "last_edit_date": 1561529873, "question_id": 56763848, "link": "https://stackoverflow.com/questions/56763848/insert-an-attachment-to-an-xml-tag-using-vba", "title": "insert an attachment to an XML tag using VBA", "body": "<p>I am using the below code to cycle through data in a spreadsheet to create an XML file:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub btn_Submit_Click()\n    Dim colIndex As Integer\n    Dim rwIndex As Integer\n    Dim asCols() As String\n    Dim oWorkSheet As Worksheet\n    Dim sName As String\n    Dim lCols As Long, lRows As Long\n    Dim iFileNum As Integer\n    Dim str_switch As String ' To use first column as node\n    Dim blnSwitch As Boolean\n    Dim rng As Range\n\n    For Each rng In ActiveSheet.UsedRange\n        If Application.WorksheetFunction.IsText(rng) Then\n            i = i + 1\n        End If\n    Next rng\n\n    Set oWorkSheet = ThisWorkbook.Worksheets(\"Sheet1\")\n    sName = oWorkSheet.Name\n    lCols = i\n\n    iFileNum = FreeFile\n    Open \"C:\\temp\\test2.xml\" For Output As #iFileNum\n\n    Print #iFileNum, \"&lt;?xml version=\"\"1.0\"\"?&gt;\"\n    Print #iFileNum, \"&lt;\" &amp; sName &amp; \"&gt;\" ' add sheet name to xml file as First Node\n    i = 1\n    Do Until i = lCols + 1\n        Print #iFileNum, \" &lt;\" &amp; oWorkSheet.Cells(1, i).Text &amp; \"&gt;\" &amp; Trim(oWorkSheet.Cells(2, i).Value) &amp; \"&lt;/\" &amp; oWorkSheet.Cells(1, i).Text &amp; \"&gt;\"\n        i = i + 1\n    Loop\n\n    Print #iFileNum, \"&lt;/\" &amp; sName &amp; \"&gt;\"\n\n    Close #iFileNum\n    MsgBox (\"Complete\")\nErrorHandler:\n    If iFileNum &gt; 0 Then Close #iFileNum\n    Exit Sub\nEnd Sub\n</code></pre>\n\n<p>This process is working perfectly to create the tag names I want, and inserting the text entered. The problem arises where I need to insert an attachment which is stored in one of the cells using the following little chunk of code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set rng = Range(\"AH2\")  'Name the cell in which you want to place the attachment\nrng.RowHeight = 56\nOn Error Resume Next\nfpath = Application.GetOpenFilename(\"All Files,*.*\", Title:=\"Select file\", MultiSelect:=True)\nFor i = 1 To UBound(fpath)\n    rng.Select\n    rng.ColumnWidth = 12\n    ActiveSheet.OLEObjects.Add _\n    Filename:=fpath(i), _\n    Link:=False, _\n    DisplayAsIcon:=True, _\n    IconFileName:=\"excel.exe\", _\n    IconIndex:=0, _\n    IconLabel:=extractFileName(fpath(i))\n    Set rng = rng.Offset(0, 1)\nNext i\nMsgBox (\"Document Uploaded\")\n</code></pre>\n\n<p>For some reason, the document is not appearing in its relevant tag. Does anyone know where I am going wrong, or if I am attempting the impossible!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1561507420, "post_id": 56763389, "comment_id": 100083819, "body": "Seems like MS anticipated this.  When Excel starts it reads the key from the registry, and always uses this value.  When Excel closes it writes the stored value back to the registry, overwriting your change."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1561507972, "post_id": 56763389, "comment_id": 100083915, "body": "One workaround would be to place your code in an add-in and load it from the server when the workbook opens.  It&#39;s a bit more complex but still easier than trying to live-update the code in the workbook."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1561508540, "post_id": 56763389, "comment_id": 100084013, "body": "I&#39;ve seen a workaround for this somewhere,  can&#39;t find it atm. IIRC it involved involves writing a script to change the registry setting with Excel closed.  Can be orchestrated from within Vba: basically 1. Generate the script 2. Schedule the script to run soon 3. Exit Excel.  In the script  1. Change registry 2. Start Excel"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1561532207, "post_id": 56763389, "comment_id": 100089757, "body": "Yup, I tend to use self-destructing VBScript files for things like that. You can start the script directly, poll every few seconds if Excel is still open (using <code>GetObject</code>), and if it isn&#39;t, make the modification to the registry. That avoids the mess with scheduling. Note that some antivirus software doesn&#39;t like self-destructing VBScript files that modify the registry."}], "owner": {"reputation": 136, "user_id": 3543239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3897acf89102562103c50506daaef51?s=128&d=identicon&r=PG&f=1", "display_name": "DeBugOfen", "link": "https://stackoverflow.com/users/3543239/debugofen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 218, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1580307436, "creation_date": 1561506417, "last_edit_date": 1580307436, "question_id": 56763389, "link": "https://stackoverflow.com/questions/56763389/change-programmatic-access-in-excel-via-vba-code-in-registry", "title": "Change Programmatic Access in Excel via VBA code in registry", "body": "<p>I want to try to load updates of my modules into an Excel workbook every time it is started and there where changes made in the module on the server.</p>\n\n<p>I do not want the \"Developer Macro Settings - Trust Access to the VBA project object model\" to stay \"active\" for every user. My goal is to activate it before I load the new modules and deactivate it afterwards. I tried it via the registry and the checkbox is checked afterwards but I do not have access to the Object Model. After a restart of Excel the checkbox is unchecked so it seems that I did not set the right registry entry.</p>\n\n<pre><code>HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\15.0\\Excel\\Security\\AccessVBOM\n</code></pre>\n\n<p>This is the regkey I set via </p>\n\n<pre><code>WshShell.RegWrite \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\15.0\\Excel\\Security\\AccessVBOM\", 1, \"REG_DWORD\"\n</code></pre>\n\n<p>I know there could be </p>\n\n<pre><code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Office\\15.0\\Excel\\Security\\AccessVBOM\n</code></pre>\n\n<p>as well, but this does not seem to be in this case.</p>\n"}, {"tags": ["excel", "vba"], "owner": {"reputation": 11, "user_id": 11700221, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vk6aRt_SRMo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdBJBdbk-yB_4D40VHaWD83_6a6Ig/photo.jpg?sz=128", "display_name": "Mithos Riot", "link": "https://stackoverflow.com/users/11700221/mithos-riot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1561529701, "creation_date": 1561505398, "last_edit_date": 1561529701, "question_id": 56763274, "link": "https://stackoverflow.com/questions/56763274/application-match-returns-a-value-where-one-does-not-exist", "title": "application.match returns a value where one does not exist", "body": "<p>I am not great at this yet, but I am trying to do this without copy-pasting code... not sure its the best idea.</p>\n\n<p>I am trying to search for to different values in two columns and then return a different if both columns match.  In the end I will be pulling from about 9 different workbooks.</p>\n\n<pre><code>Dim wbACF As Workbook\nDim wsDiv As Worksheet\nDim rng As Range\nDim WC As String\nDim vCELL As Variant\nDim switch As Variant\nDim nvCell As Variant\nDim lastCell As Variant\nSet wbACF = Workbooks(\"ACF.xls\")\nWC = Sheet1.Cells(5, 14).Value\nnvCell = \"A1\"\nlastCell = \"A999\"\nSet wsDiv = wbACF.Worksheets(WC)\nSet rng = wsDiv.Range(nvCell, lastCell)\nswitch = 1\nDo While switch = 1\n    vCELL = Application.Match(\"test\", rng, 0)\n    If wsDiv.Cells(vCELL, 7).Value = Sheet1.Cells(5, 13).Value Then\n        Sheet1.Cells(11, 1).Value = wsDiv.Cells(vCELL, 4)\n        switch = 0\n    Else\n        nvCell = \"A\" &amp; vCELL + 1\n        Set rng = wsDiv.Range(nvCell, lastCell)\n    End If\nLoop\n</code></pre>\n\n<p>for my test files, rows 10, 70, 150 and 210 match for test, but only row 210 match for both test and Sheet1.Cells(5, 13).Value</p>\n\n<p>vCELL becomes 10 in the first loop, and then executes the else portion, on the second loop vCELL becomes 60 and then never changes.  I am sure my coding is poor, and is a contributing factor, but any help would be appriciated.</p>\n"}, {"tags": ["vba", "pivot-table"], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 8260869, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5896f962504315fcbb5945e08d3713b9?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/8260869/j-doe"}, "edited": false, "score": 0, "creation_date": 1561507010, "post_id": 56763407, "comment_id": 100083750, "body": "I feel so dumb now, and this is embarrassing. Thank you, that was the cause of the problem. I just added &quot;s&quot; to both, and it fixed the problem. Just wow."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 149, "user_id": 8260869, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5896f962504315fcbb5945e08d3713b9?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/8260869/j-doe"}, "edited": false, "score": 2, "creation_date": 1561507478, "post_id": 56763407, "comment_id": 100083832, "body": "We&#39;ve all stared at something like that for hours and not seen it."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1561506568, "creation_date": 1561506568, "answer_id": 56763407, "question_id": 56763257, "link": "https://stackoverflow.com/questions/56763257/why-is-my-code-not-producing-a-correct-pivot-table/56763407#56763407", "title": "Why is my code not producing a correct pivot table?", "body": "<p>Has the \"s\" (two)</p>\n\n<pre><code>With ActiveSheet.PivotTables(\"MyPivot\").PivotFields(\"ColumnName2\")\n                           ^                      ^\n</code></pre>\n\n<p>missing two \"s\"</p>\n\n<pre><code>With ActiveSheet.PivotTable(PivotTableName).PivotField(ArrayRowField(counter))\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 8260869, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5896f962504315fcbb5945e08d3713b9?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/8260869/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 56763407, "answer_count": 1, "score": 2, "last_activity_date": 1561506568, "creation_date": 1561505300, "last_edit_date": 1561506280, "question_id": 56763257, "link": "https://stackoverflow.com/questions/56763257/why-is-my-code-not-producing-a-correct-pivot-table", "title": "Why is my code not producing a correct pivot table?", "body": "<p>I have written a VBA program to create a pivot table and fill data. It works as expected, but it has lots of hard-coded parts, so I am rewriting it to make it more generic so I can reuse the subroutine. However, the rewritten code does not produce the same result as the original, and I don't know why.</p>\n\n<p>I am passing the correct arguments, and it doesn't return any error. It actually creates an empty PivotTable, but it does not fill the data (RowFields).</p>\n\n<p>Because there are many lines of code, I am only going to show the problematic part. (Please do let me know if you need more code to answer my question)</p>\n\n<pre><code>'This is the portion adding RowField, and this works, but it is hard coded. Too much of repetitive code!\nWith ActiveSheet.PivotTables(\"MyPivot\").PivotFields(\"ColumnName1\")\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\nWith ActiveSheet.PivotTables(\"MyPivot\").PivotFields(\"ColumnName2\")\n    .Orientation = xlRowField\n    .Position = 2\nEnd With\nWith ActiveSheet.PivotTables(\"MyPivot\").PivotFields(\"ColumnName3\")\n    .Orientation = xlRowField\n    .Position = 3\nEnd With\n\n'And this is the rewritten code with loop, but it does not add any data to the pivot table.\n'Argument1: ArrayRowField - a string array containing \"Column1\", \"Column2\", and \"Column3\"\n'Argument2: PivotTableName - a string containing \"MyPivot\"\nDim counter As Integer\nFor counter = 0 To UBound(ArrayRowField)\n    With ActiveSheet.PivotTable(PivotTableName).PivotField(ArrayRowField(counter))\n        .Orientation = xlRowField\n        .Position = (counter + 1)\n    End With\nNext counter\n</code></pre>\n\n<p>To me, these two look like they should behave the same way. But only the top one works, adding rowfields to the orientation, but the bottom one doesn't.\nCan anyone tell me what I am doing wrong?</p>\n\n<p>Edit: I just tried taking <code>with</code> statement outside the loop, but it didn't make any difference.</p>\n\n<pre><code>'This did nothing to fix my problem\nDim counter As Integer\nWith ActiveSheet.PivotTable(PivotTableName).PivotField(ArrayRowField(counter))\n    For counter = 0 To UBound(ArrayRowField)\n        .Orientation = xlRowField\n        .Position = (counter + 1)\n    Next counter\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7, "user_id": 10124358, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6GZaTaXk4mY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7q6U9a1KradEyPj99MFgBeP7X7acw/mo/photo.jpg?sz=128", "display_name": "Rachel Roberts", "link": "https://stackoverflow.com/users/10124358/rachel-roberts"}, "edited": false, "score": 0, "creation_date": 1561503612, "post_id": 56763001, "comment_id": 100083090, "body": "So I did change that, and I am no longer getting an error but it is no longer copying and pasting values. Is this because of the value I&#39;m assigning it?"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1561503731, "post_id": 56763001, "comment_id": 100083116, "body": "Why do you assign a value of 3 in <code>i = 3</code> then the very next executable line you assign a value of 1 in <code>For i = 1 To ...</code>?, then you <code>i = i + 1</code> when your <code>For i</code> statement would automatically increment this value anyway."}, {"owner": {"reputation": 7, "user_id": 10124358, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6GZaTaXk4mY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7q6U9a1KradEyPj99MFgBeP7X7acw/mo/photo.jpg?sz=128", "display_name": "Rachel Roberts", "link": "https://stackoverflow.com/users/10124358/rachel-roberts"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1561503906, "post_id": 56763001, "comment_id": 100083147, "body": "You&#39;re right that is also another mistake of mine. I have fixed that and have gotten the code to work. Thank you."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1561505033, "post_id": 56763001, "comment_id": 100083382, "body": "<code>i = i + 1</code> it&#39;s typically a good thing to never change the value of your loop counter inside the loop itself..."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1561503364, "creation_date": 1561503364, "answer_id": 56763012, "question_id": 56763001, "link": "https://stackoverflow.com/questions/56763001/how-read-in-values-from-a-column-and-use-these-values-in-an-if-statement-inside/56763012#56763012", "title": "How read in values from a column and use these values in an If statement inside a loop", "body": "<pre><code>If sht1.Range(\"F\" &amp; ii &lt; 0.5) Then\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>If sht1.Range(\"F\" &amp; ii) &lt; 0.5 Then\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 10124358, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6GZaTaXk4mY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7q6U9a1KradEyPj99MFgBeP7X7acw/mo/photo.jpg?sz=128", "display_name": "Rachel Roberts", "link": "https://stackoverflow.com/users/10124358/rachel-roberts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 56763012, "answer_count": 1, "score": 0, "last_activity_date": 1561503364, "creation_date": 1561503203, "last_edit_date": 1561503334, "question_id": 56763001, "link": "https://stackoverflow.com/questions/56763001/how-read-in-values-from-a-column-and-use-these-values-in-an-if-statement-inside", "title": "How read in values from a column and use these values in an If statement inside a loop", "body": "<p>My goal is to make a code that takes in the percent error from sheet 1 (column F) and then if the percent error if below 0.5% it takes the values from columns A:D that correspond with column f (for example if F6 had a percent error below 0.5% the program would copy A6:D6) and copies the cells and pastes them into sheet 2. Then this program needs to loop through all the values in column f and repeat this process. </p>\n\n<p>I have had success with copying and pasting the cells I need using the code below without the If statement. However, I cannot seems to get a code that depends on the percent error. </p>\n\n<p>'The start of the command button</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n\nDim i As Long\nDim ii As Long\nDim i3 As Long\nDim LastRow As Long\nDim wb As Workbook\nDim sht1 As Worksheet\nDim sht2 As Worksheet\nDim Myrange As Range\nDim PerecntError As Integer\n\n\n\nSet wb = ThisWorkbook\nSet sht1 = wb.Sheets(\"RawData\")\nSet sht2 = wb.Sheets(\"FilteredData\")\n\n'Find the last row (in column A) with data.\nLastRow = sht1.Range(\"A:A\").Find(\"*\", searchdirection:=xlPrevious).Row\nii = 2\ni = 3\n\n'This is the beginning of the loop\n\nFor i = 1 To LastRow\n\nIf sht1.Range(\"F\" &amp; ii &lt; 0.5) Then\n\n        'First activity\n\n        sht2.Range(\"A\" &amp; ii) = sht1.Range(\"A\" &amp; i).Value    \n        sht2.Range(\"B\" &amp; ii) = sht1.Range(\"B\" &amp; i).Value  \n        sht2.Range(\"C\" &amp; ii) = sht1.Range(\"C\" &amp; i).Value\n        sht2.Range(\"D\" &amp; ii) = sht1.Range(\"D\" &amp; i).Value\n\n        ii = ii + 1\n\n      i = i + 1\n\nEnd If\n\nNext\n\n\nEnd Sub\n</code></pre>\n\n<p>The error I am getting is that \"Type mismatch\" \nfor this line: \"If sht1.Range(\"F\" &amp; ii &lt; 0.5) Then\"</p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "excel-2010"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1561502841, "post_id": 56762832, "comment_id": 100082915, "body": "<code>Set ex = New Excel.Application</code> - no need for this - you can use the existing instance where your code is running. So <code>Set wrkbk = Workbooks.Open(folder &amp; books(i))</code> for example"}], "answers": [{"tags": [], "owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "is_accepted": false, "score": 0, "last_activity_date": 1561502664, "creation_date": 1561502664, "answer_id": 56762924, "question_id": 56762832, "link": "https://stackoverflow.com/questions/56762832/is-there-a-way-to-clear-data-in-a-sheet-from-another-workbook/56762924#56762924", "title": "Is there a way to clear data in a sheet from another workbook?", "body": "<p>You're missing a backslash:\nChange:</p>\n\n<pre><code>folder = \"C:\\Users\\arocmag\\Documents\\MasterLog\"\n</code></pre>\n\n<p>to</p>\n\n<pre><code>folder = \"C:\\Users\\arocmag\\Documents\\MasterLog\\\"\n</code></pre>\n\n<p>Also, nice error handling with the ScreenUpdating and DisplayAlerts.  Too often people don't handle those correctly.</p>\n\n<p>You also don't need to be doing the \"Selects\".  The section </p>\n\n<pre><code>sht.Range(\"A2:H2\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.ClearContents\n</code></pre>\n\n<p>can be simplified to:</p>\n\n<pre><code>Range(sht.Range(\"A2:H2\"), sht.Range(\"A2:H2\").End(xlDown)).ClearContents\n</code></pre>\n\n<p>Read up on avoiding \"Selects\" in VBA and you'll end up with much simpler code that executes much faster.</p>\n"}], "owner": {"reputation": 11, "user_id": 11546190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7967dc151f1d3f97bc8c9c937d4e3146?s=128&d=identicon&r=PG&f=1", "display_name": "m2212a", "link": "https://stackoverflow.com/users/11546190/m2212a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 316, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561529693, "creation_date": 1561501834, "last_edit_date": 1561529693, "question_id": 56762832, "link": "https://stackoverflow.com/questions/56762832/is-there-a-way-to-clear-data-in-a-sheet-from-another-workbook", "title": "Is there a way to clear data in a sheet from another workbook?", "body": "<p>I have a \"Master Sheet\" where I merge multiple workbooks where data is inputted (Station workbooks) into one Master file.I would like to clear the data in the Station workbooks when I press a command button in the Master Sheet, clearing all the data and saving as today's date. It also needs to erase specific ranges in the workbooks...</p>\n\n<p>I tried and it works when I clear the data only within the Master Sheet, but the code I tried involving the other sheets seems to be stuck. I used array to erase from multiple workbooks. I only tried it in Station 1 file.</p>\n\n<pre><code> Sub ClearAll()\n\n 'ClearAll &amp; Save Macro\n\n Dim answer As Integer\n\n answer = MsgBox(\"All entries will be cleared. Are you sure?\", vbYesNo + vbQuestion, \"Empty Sheet\")\n\n\n\nIf answer = vbYes Then\n\n'clears station data\n\nDim ex As Excel.Application\nDim wrkbk As Workbook\nDim sht As Worksheet\nDim books As Variant\nDim folder As String\nDim i As Integer\n\nfolder = \"C:\\Users\\arocmag\\Documents\\MasterLog\"\nbooks = Array(\"Station 1 Daily Log.xlsm\")\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nOn Error GoTo errH:\nSet ex = New Excel.Application\nFor i = 0 To UBound(books)\n    Set wrkbk = ex.Workbooks.Open(folder &amp; books(i))\n    Set sht = wrkbk.Sheets(1)\n    sht.Range(\"A2:H2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.ClearContents\n    wrkbk.Close True\nNext\nex.Quit\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\nExit Sub\nerrH:\nex.Quit\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\nMsgBox Err.Description\n\n\n\n'clears Master Sheet\nRange(\"A2:H2\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.ClearContents\nRange(\"I1\").Select\nActiveWorkbook.Worksheets(\"Master Log\").AutoFilter.Sort.SortFields.Clear\nSelection.AutoFilter\n\n ActiveWorkbook.SaveCopyAs (\"C:\\Users\\arocmarg\\Documents\\Rotation 3 - Warehouse Leader\\01 - Capstone\\6_20_2019\\MasterLog\" &amp; \" \" &amp; Format(Now(), \"mmddyyyy\") &amp; \".xlsm\")\n\n\nElse\n 'do nothing\n End If\n\n\n End Sub\n</code></pre>\n\n<p>I want the station files to be cleared and SAVED (not saved as) + master file to be cleared and SAVED AS.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11699891, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6WLp_s7qVDI/AAAAAAAAAAI/AAAAAAAACiM/nr9ESio-oqM/photo.jpg?sz=128", "display_name": "Kipp G", "link": "https://stackoverflow.com/users/11699891/kipp-g"}, "edited": false, "score": 0, "creation_date": 1561517009, "post_id": 56762564, "comment_id": 100085444, "body": "Thank you Tim, for the quick response. I also thought about creating a foreach loop to find a match to the worksheet CodeName that I wanted, but I was really hoping for a built-in method to do this for me."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 11699891, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6WLp_s7qVDI/AAAAAAAAAAI/AAAAAAAACiM/nr9ESio-oqM/photo.jpg?sz=128", "display_name": "Kipp G", "link": "https://stackoverflow.com/users/11699891/kipp-g"}, "edited": false, "score": 0, "creation_date": 1561519632, "post_id": 56762564, "comment_id": 100085902, "body": "Well I also thought there might be something, but even <code>CallByName</code>, my usual go-to, does not work."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1561499833, "creation_date": 1561499833, "answer_id": 56762564, "question_id": 56762472, "link": "https://stackoverflow.com/questions/56762472/how-can-i-get-a-worksheet-object-from-a-specific-workbook-not-thisworkbook-u/56762564#56762564", "title": "How can I get a worksheet object from a specific workbook (not &#39;ThisWorkbook&#39;) using the worksheets CodeName?", "body": "<p>You can do something like this:</p>\n\n<pre><code>Sub Tester()\n\n    Dim ws As Worksheet\n\n    Set ws = SheetFromCodeName(ActiveWorkbook, \"Sheet1\")\n\n    Debug.Print ws.Name\n\nEnd Sub\n\nFunction SheetFromCodeName(wb As Workbook, cn As String)\n    Dim s, rv As Worksheet\n    For Each s In wb.Worksheets\n        If s.CodeName = cn Then\n            Set rv = s\n            Exit For\n        End If\n    Next s\n    Set SheetFromCodeName = rv\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11699891, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6WLp_s7qVDI/AAAAAAAAAAI/AAAAAAAACiM/nr9ESio-oqM/photo.jpg?sz=128", "display_name": "Kipp G", "link": "https://stackoverflow.com/users/11699891/kipp-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 56762564, "answer_count": 1, "score": 0, "last_activity_date": 1561499833, "creation_date": 1561499280, "question_id": 56762472, "link": "https://stackoverflow.com/questions/56762472/how-can-i-get-a-worksheet-object-from-a-specific-workbook-not-thisworkbook-u", "title": "How can I get a worksheet object from a specific workbook (not &#39;ThisWorkbook&#39;) using the worksheets CodeName?", "body": "<p>I want to obtain a worksheet object from a specific workbook, like so:</p>\n\n<pre><code> Set ws = Application.Workbooks(\"WorkBookName.xlsm\").Worksheets(\"sheet1\")\n</code></pre>\n\n<p>However, I want to use the CodeName of the worksheet since the sheet's name can be changed. For example:</p>\n\n<pre><code> Set ws = Application.Workbooks(\"WorkBookName.xlsm\").Sheet1\n</code></pre>\n\n<p>Now, I know this doesn't work since Sheet1 is a global variable create by the VBA editor for convenience. </p>\n\n<p>I also know I could use the index (i.e. Worksheets(1)) to obtain the worksheet object, but if someone moves the worksheets in the workbook around, functions will not work properly. </p>\n\n<p>So my question is: How can I get a worksheet object from a specific workbook (not 'ThisWorkbook') and store it in a variable using the CodeName?</p>\n\n<p>Here is a sample snippet (I'm very new to posting in stackoverflow.com):</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>\nPublic Sub Main()\n\n    ' Test Class\n    Dim test As New StoreContestModel\n    test.StoreID = \"28\"\n    test.StoreName = \"Kippersville\"\n\n    ' Other workbook\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim r As Range\n    Dim v As String\n\n    ' Showing test StoreID in other workbook. Code is broken up because as one-line it did not work.\n    Set wb = Application.Workbooks(\"Contest.xlsm\")\n    Set ws = Application.Workbooks(\"Contest.xlsm\").Sheet1 ' wb.Sheet1 didn't work\n    Set r = ws.Range(\"N2\")\n    r.value = test.StoreID\n\nEnd Sub\n\n</code></pre>\n\n<p>I want the StoreID to show up in the cell specified in the other workbook. However, I get this error:</p>\n\n<p>Run-time error '438':</p>\n\n<p>Object doesn't support this property or method</p>\n"}]