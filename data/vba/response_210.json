[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1547683063, "post_id": 54227096, "comment_id": 95280317, "body": "use .RemoveDuplicates"}, {"owner": {"reputation": 33, "user_id": 10054520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2b27bbbd317802385e3dcd6f22a6a6?s=128&d=identicon&r=PG&f=1", "display_name": "MyNameHere", "link": "https://stackoverflow.com/users/10054520/mynamehere"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1547684554, "post_id": 54227096, "comment_id": 95280618, "body": "How would I do that?  Everything I create is from combining examples I find and I couldn&#39;t find anything for this."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1547686280, "post_id": 54227096, "comment_id": 95280947, "body": "maybe take a look at the documentation page? You need code to identify the range and perform a RemoveDuplicates on the identified range. It is not clear which range your data lives in, so I can&#39;t write a code suggestion with your ranges."}], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1547686550, "creation_date": 1547686550, "answer_id": 54227563, "question_id": 54227096, "link": "https://stackoverflow.com/questions/54227096/add-code-to-existing-module-remove-duplicate-values-in-row-2/54227563#54227563", "title": "Add code to existing module: remove duplicate values in row 2", "body": "<p>Identify the range that the data lives in, then apply the <code>RemoveDuplicates</code> method.</p>\n\n<pre><code> ActiveSheet.Range(\"$A$1:$C$20\").RemoveDuplicates Columns:=2, Header:=xlYes\n</code></pre>\n\n<p>Your range may be constructed by looking up the row number after the data has been imported with your previous code</p>\n\n<pre><code>Dim myrow As Long\n    ' get the row number of the last row of data in column A\n    myrow = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\n    ' remove rows with duplicates in the second column, column B, in\n    ' the table that sits in A1 to Cx\n    ActiveSheet.Range(\"$A$1:$C\" &amp; myrow).RemoveDuplicates Columns:=2, Header:=xlYes\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10054520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2b27bbbd317802385e3dcd6f22a6a6?s=128&d=identicon&r=PG&f=1", "display_name": "MyNameHere", "link": "https://stackoverflow.com/users/10054520/mynamehere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547708972, "creation_date": 1547682589, "last_edit_date": 1547708972, "question_id": 54227096, "link": "https://stackoverflow.com/questions/54227096/add-code-to-existing-module-remove-duplicate-values-in-row-2", "title": "Add code to existing module: remove duplicate values in row 2", "body": "<p>I created an existing module that will import text file into my spreadsheet and that works fine.  What I would like to do to speed up my process is to automatically remove rows.  The imported data size can vary so I can't use a fixed range.</p>\n\n<pre><code>Sub Import_Data()\n    Dim Ret\n\n    Ret = Application.GetOpenFilename(\"Text Files (*.txt), *.txt\")\n\n    If Ret &lt;&gt; False Then\n        With ActiveSheet.QueryTables.Add(Connection:= _\n        \"TEXT;\" &amp; Ret, Destination:=Application.InputBox(prompt:=\"Select Input Cell\", Type:=8))\n\n        .Name = \"Sample\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 437\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = False\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = True\n        .TextFileSpaceDelimiter = False\n        .TextFileColumnDataTypes = Array(2, 2, 1, 2, 2, 1)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n\n        End With\nEnd If\nEnd Sub\n</code></pre>\n\n<p>What I would like to happen is to scan the new file that is imported.  If any duplicate values exist in column 2, remove duplicate rows.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 10891585, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KEPtpyeTH8A/AAAAAAAAAAI/AAAAAAAAAJY/ZPyAt8AVL5c/photo.jpg?sz=128", "display_name": "randy dickinson", "link": "https://stackoverflow.com/users/10891585/randy-dickinson"}, "edited": false, "score": 0, "creation_date": 1547682514, "post_id": 54226910, "comment_id": 95280194, "body": "Perfect. Thank you"}, {"owner": {"reputation": 19, "user_id": 10891585, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KEPtpyeTH8A/AAAAAAAAAAI/AAAAAAAAAJY/ZPyAt8AVL5c/photo.jpg?sz=128", "display_name": "randy dickinson", "link": "https://stackoverflow.com/users/10891585/randy-dickinson"}, "edited": false, "score": 0, "creation_date": 1547766185, "post_id": 54226910, "comment_id": 95315588, "body": "This code worked perfect last night. Then I saved it and now it wont work. I have tried to save it and I have tried to create a new sheet but still no luck. Any thoughts?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 19, "user_id": 10891585, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KEPtpyeTH8A/AAAAAAAAAAI/AAAAAAAAAJY/ZPyAt8AVL5c/photo.jpg?sz=128", "display_name": "randy dickinson", "link": "https://stackoverflow.com/users/10891585/randy-dickinson"}, "edited": false, "score": 0, "creation_date": 1547766261, "post_id": 54226910, "comment_id": 95315612, "body": "What do you mean by &quot;won&#39;t work&quot;? Does the event fire?  What does it do instead of work?"}, {"owner": {"reputation": 19, "user_id": 10891585, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KEPtpyeTH8A/AAAAAAAAAAI/AAAAAAAAAJY/ZPyAt8AVL5c/photo.jpg?sz=128", "display_name": "randy dickinson", "link": "https://stackoverflow.com/users/10891585/randy-dickinson"}, "edited": false, "score": 0, "creation_date": 1547767033, "post_id": 54226910, "comment_id": 95315829, "body": "The only function that does not work is the &quot;z-&quot; returning the cursor to original column +next row when scanned.  The value scanned is entered in the same row +1 column. Your code worked perfectly last night and accomplished exactly what I intended.But today it did not. Very strange. I will try your fix tomorrow. Thank you so much for your help."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 19, "user_id": 10891585, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KEPtpyeTH8A/AAAAAAAAAAI/AAAAAAAAAJY/ZPyAt8AVL5c/photo.jpg?sz=128", "display_name": "randy dickinson", "link": "https://stackoverflow.com/users/10891585/randy-dickinson"}, "edited": false, "score": 0, "creation_date": 1547767355, "post_id": 54226910, "comment_id": 95315929, "body": "Have the &quot;Z&quot; values being scanned in changed?  The code checks for the pattern &quot;Z-[digit][other stuff]&quot; so if it doesn&#39;t match that pattern it will not go to the next row."}, {"owner": {"reputation": 19, "user_id": 10891585, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KEPtpyeTH8A/AAAAAAAAAAI/AAAAAAAAAJY/ZPyAt8AVL5c/photo.jpg?sz=128", "display_name": "randy dickinson", "link": "https://stackoverflow.com/users/10891585/randy-dickinson"}, "edited": false, "score": 0, "creation_date": 1547767626, "post_id": 54226910, "comment_id": 95316004, "body": "Yes it has worked. I am not great with vba and I am trying to learn so please forgive me if I don&#39;t explain things the best."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 19, "user_id": 10891585, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KEPtpyeTH8A/AAAAAAAAAAI/AAAAAAAAAJY/ZPyAt8AVL5c/photo.jpg?sz=128", "display_name": "randy dickinson", "link": "https://stackoverflow.com/users/10891585/randy-dickinson"}, "edited": false, "score": 0, "creation_date": 1547768004, "post_id": 54226910, "comment_id": 95316103, "body": "No problem - it&#39;s a little difficult for me to offer much help though: I think the code works &quot;as designed&quot; but I might have misunderstood your exact needs."}, {"owner": {"reputation": 19, "user_id": 10891585, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KEPtpyeTH8A/AAAAAAAAAAI/AAAAAAAAAJY/ZPyAt8AVL5c/photo.jpg?sz=128", "display_name": "randy dickinson", "link": "https://stackoverflow.com/users/10891585/randy-dickinson"}, "edited": false, "score": 0, "creation_date": 1548201804, "post_id": 54226910, "comment_id": 95456240, "body": "Can I ask you to look at 1 more issue I am trying to resolve? <a href=\"https://stackoverflow.com/questions/54317166/merge-into-2-columns-the-value-in-column-a-if-duplicate-are-found-in-columns-b1\" title=\"merge into 2 columns the value in column a if duplicate are found in columns b1\">stackoverflow.com/questions/54317166/&hellip;</a>"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1547766397, "last_edit_date": 1547766397, "creation_date": 1547681234, "answer_id": 54226910, "question_id": 54226818, "link": "https://stackoverflow.com/questions/54226818/return-to-original-cell-next-row-with-specified-beginning-cheracter-of-scanned-v/54226910#54226910", "title": "return to original cell next row with specified beginning cheracter of scanned value", "body": "<p>Something like this should work</p>\n\n<p>edit: added some error handling to make sure events don't get stuck \"off\"</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim v\n\n    'skip multi-cell updates\n    If Target.CountLarge &gt; 1 Then Exit Sub\n\n    With Target\n        v = Trim(.Value)\n        If Len(v) &gt; 0 And .Column &gt; 2 Then\n            If v Like \"Z-#*\" Then\n                On Error Goto haveError\n                Application.EnableEvents = False \n                With Me.Cells(.Row + 1, 3)\n                    .Value = Right(v, Len(v) - 2)\n                    .Offset(0, 1).Select '? select next cell in new row ?\n                End With\n                .Value = \"\" 'clear the original \"Z\" scan?\n                Application.EnableEvents = True\n            Else\n                Me.Cells(.Row, .Column + 1).Select\n            End If\n        End If\n    End With\n\n    Exit sub\n\nhaveError:\n    Msgbox Err.Description\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 10891585, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KEPtpyeTH8A/AAAAAAAAAAI/AAAAAAAAAJY/ZPyAt8AVL5c/photo.jpg?sz=128", "display_name": "randy dickinson", "link": "https://stackoverflow.com/users/10891585/randy-dickinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 54226910, "answer_count": 1, "score": 0, "last_activity_date": 1547766397, "creation_date": 1547680596, "last_edit_date": 1547708961, "question_id": 54226818, "link": "https://stackoverflow.com/questions/54226818/return-to-original-cell-next-row-with-specified-beginning-cheracter-of-scanned-v", "title": "return to original cell next row with specified beginning cheracter of scanned value", "body": "<p>I am scanning multiple \"numerical only\"  barcodes across same row until \"Z-xxx\" is scanned, then auto return to original column +1 row. I want to include the 3 characters that are on the same scan but only after \"Z-\" in the new cell on the new row. Example: if I scan \"Z-123\" I want to return to original column and +1 row with cell value = \"123\".</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    With Target\n        If Len(.Value) And .Column &gt; 2 Then\n            If .Value = \"Z\" Then\n                Cells(.Row + 1, 3).Select\n            Else\n                Cells(.Row, .Column + 1).Select\n            End If\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1547681067, "post_id": 54226799, "comment_id": 95279835, "body": "Find and replace would make this pretty easy"}, {"owner": {"reputation": 3, "user_id": 10925033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96fed2f5939e18775c33525205193b31?s=128&d=identicon&r=PG&f=1", "display_name": "Josh B", "link": "https://stackoverflow.com/users/10925033/josh-b"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1547681590, "post_id": 54226799, "comment_id": 95279958, "body": "How would you do that if there&#39;s an underscore and random number appended to it?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1547682158, "post_id": 54226799, "comment_id": 95280122, "body": "Well that question is pretty different than the original. You will need to split your cells by spaces and do some loops"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1547683708, "post_id": 54226799, "comment_id": 95280450, "body": "how many unique values are in column A?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10925033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96fed2f5939e18775c33525205193b31?s=128&d=identicon&r=PG&f=1", "display_name": "Josh B", "link": "https://stackoverflow.com/users/10925033/josh-b"}, "edited": false, "score": 0, "creation_date": 1547686262, "post_id": 54227274, "comment_id": 95280944, "body": "That worked!  I had no idea you could use wild cards in excel.  Thank you!!"}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1547683951, "creation_date": 1547683951, "answer_id": 54227274, "question_id": 54226799, "link": "https://stackoverflow.com/questions/54226799/check-if-column-b-contains-a-specific-string-that-exists-in-column-a-and-then-re/54227274#54227274", "title": "Check if column B contains a specific string that exists in column A and then remove it from the cell in column B", "body": "<p>If the values you want to remove all have the pattern <code>TL_xxxx</code> you can use wildcards to replace them.</p>\n\n<p>Ctrl-H to open the Find and Replace dialog, put <code>TL_????</code> into the <code>Find what</code> box and leave the <code>Replace with</code> box blank.</p>\n\n<p>You may need a second pass to replace two spaces or two line breaks with just one.</p>\n"}], "owner": {"reputation": 3, "user_id": 10925033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96fed2f5939e18775c33525205193b31?s=128&d=identicon&r=PG&f=1", "display_name": "Josh B", "link": "https://stackoverflow.com/users/10925033/josh-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 54227274, "answer_count": 1, "score": -1, "last_activity_date": 1547683951, "creation_date": 1547680445, "last_edit_date": 1547683232, "question_id": 54226799, "link": "https://stackoverflow.com/questions/54226799/check-if-column-b-contains-a-specific-string-that-exists-in-column-a-and-then-re", "title": "Check if column B contains a specific string that exists in column A and then remove it from the cell in column B", "body": "<p>So I want either an excel function or VBA script that searches through column B for a specific string that exists in column A, and then once there's a match I want to remove that string from the cell in column B and return the rest of the cell contents into column C.</p>\n\n<p>I can't use a simple \"find and replace\" because, as you can see in the picture, the text in each of the cells is in the form of an ID with an underscore followed by a random number appended to it.  And I have around 100,000 rows to search through.</p>\n\n<p>An example table of what I'd like is shown below:</p>\n\n<p><img src=\"https://i.stack.imgur.com/NRMVb.png\" alt=\"Example table\"></p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1547681111, "post_id": 54226757, "comment_id": 95279843, "body": "I never use dynamic parameterized query. The embedded query should be able to reference form controls as parameters. Post your query SQL statement."}, {"owner": {"reputation": 61, "user_id": 10429930, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rp3ogmNMJGI/AAAAAAAAAAI/AAAAAAAAAK4/kIfiLQ4Xju8/photo.jpg?sz=128", "display_name": "David Cady", "link": "https://stackoverflow.com/users/10429930/david-cady"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1547682231, "post_id": 54226757, "comment_id": 95280138, "body": "I tried posting the Query the actual report is based off of, but it is a big query and this comment box won&#39;t let me paste the whole thing... how should I do that?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1547693386, "post_id": 54226757, "comment_id": 95282210, "body": "You should edit your question. Moot point now because you seem to have a solution."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 10429930, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rp3ogmNMJGI/AAAAAAAAAAI/AAAAAAAAAK4/kIfiLQ4Xju8/photo.jpg?sz=128", "display_name": "David Cady", "link": "https://stackoverflow.com/users/10429930/david-cady"}, "edited": false, "score": 0, "creation_date": 1547683641, "post_id": 54227036, "comment_id": 95280437, "body": "This method worked great. I really appreciate the help!"}], "tags": [], "owner": {"reputation": 37, "user_id": 10877532, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kbSxc.jpg?s=128&g=1", "display_name": "Bullschmidt", "link": "https://stackoverflow.com/users/10877532/bullschmidt"}, "is_accepted": true, "score": 0, "last_activity_date": 1547682041, "creation_date": 1547682041, "answer_id": 54227036, "question_id": 54226757, "link": "https://stackoverflow.com/questions/54226757/how-do-i-set-parameters-for-an-embedded-query-on-an-access-report-from-an-access/54227036#54227036", "title": "How do I set parameters for an embedded query on an Access report from an Access form?", "body": "<p>How about having the queries that the report and report field are based on store the \"link\" to the form's fields something like this (query by form concept)...</p>\n\n<p>In the query's criteria for an appropriate field:<br>\n= [Forms]![MyForm]![CSRNameCB]</p>\n\n<p>And:<br>\nBetween [Forms]![MyForm]![StartDate] And [Forms]![MyForm]![EndDate]</p>\n\n<p>And then on the form that opens the report you don't have to set any parameters at all.</p>\n"}], "owner": {"reputation": 61, "user_id": 10429930, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rp3ogmNMJGI/AAAAAAAAAAI/AAAAAAAAAK4/kIfiLQ4Xju8/photo.jpg?sz=128", "display_name": "David Cady", "link": "https://stackoverflow.com/users/10429930/david-cady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 54227036, "answer_count": 1, "score": 0, "last_activity_date": 1547682041, "creation_date": 1547680209, "last_edit_date": 1547680256, "question_id": 54226757, "link": "https://stackoverflow.com/questions/54226757/how-do-i-set-parameters-for-an-embedded-query-on-an-access-report-from-an-access", "title": "How do I set parameters for an embedded query on an Access report from an Access form?", "body": "<p>I have an existing Access report that runs off a Query. In the existing report I have the parameters set with brackets; [CSRName], [StartDate], and [EndDate]. I have those parameters being filled form a form using the VBA below;</p>\n\n<p>All of this works just fine. My problem is this; I have this query counting the total number of errors a CSR makes. I can easily display in the report the total number of errors. What I'd like to do is have another textbox on the report that shows the total number of completed items by the CSR. In order to do this I need to embed the Control Source for the textbox with another query. I have that query written and it works outside the form. What I need to do though is pass the same parameters that I am using to generate the report into this embedded query on the report. I can't figure out how to do that. I can pass the parameters to the report itself, and it works fine, but trying to do the same won't pass the parameters to the embedded query in the report. It keeps popping up an input box and asking me to give it the variables.</p>\n\n<p>I assumed I could treat the embedded query the same that I could the query the report is based off, so I used the same process to try to pass the parameters to it as well, but it did not work.</p>\n\n<pre><code>Private Sub RunQuery_Click()\n\n    DoCmd.SetParameter \"CSRName\", Me.CSRNameCB\n    DoCmd.SetParameter \"StartDate\", \"#\" &amp; Me.StartDate &amp; \"#\"\n    DoCmd.SetParameter \"EndDate\", \"#\" &amp; Me.EndDate &amp; \"#\"\n\n    DoCmd.OpenReport \"rpt_CSRErrorTracking\", acViewPreview\n\nEnd Sub\n</code></pre>\n\n<p>What I need is the method to pass the parameters from the form to both the query that the report is based off, and the query embedded in the report itself.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1547684282, "post_id": 54226709, "comment_id": 95280569, "body": "If there&#39;s an existing tab &quot;003&quot; but no &quot;002&quot; should a new tab copied from &quot;001&quot; be named &quot;004&quot; or &quot;002&quot; ?"}, {"owner": {"reputation": 1, "user_id": 10924968, "user_type": "registered", "profile_image": "https://graph.facebook.com/2037236396363923/picture?type=large", "display_name": "John Pritchard", "link": "https://stackoverflow.com/users/10924968/john-pritchard"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1547774071, "post_id": 54226709, "comment_id": 95317483, "body": "Hi Tim, thanks for the response. Ideally the next tab to be created would be the next lowest number. Therefore it would be &quot;002&quot; as in your example."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10924968, "user_type": "registered", "profile_image": "https://graph.facebook.com/2037236396363923/picture?type=large", "display_name": "John Pritchard", "link": "https://stackoverflow.com/users/10924968/john-pritchard"}, "edited": false, "score": 0, "creation_date": 1547842439, "post_id": 54249016, "comment_id": 95345809, "body": "When I run &quot;Tester&quot;, I get the following error: &quot;Run-time error &#39;1004&#39;: Cannon rename a sheet to the same name as another sheet, a referenced object library or a workbook referenced by Visual Basic&quot;. This error popped up after attempting to perform the first duplication and named the tab &quot;001 (2)&quot;."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 10924968, "user_type": "registered", "profile_image": "https://graph.facebook.com/2037236396363923/picture?type=large", "display_name": "John Pritchard", "link": "https://stackoverflow.com/users/10924968/john-pritchard"}, "edited": false, "score": 0, "creation_date": 1547851192, "post_id": 54249016, "comment_id": 95348787, "body": "I made a slight edit to make the sheet references more explicit - try that out.  If it still errors then let me know exactly what the existing sheet names are before you ran it, and whether you have any hidden sheets in your workbook (and if yes what their names are)"}, {"owner": {"reputation": 1, "user_id": 10924968, "user_type": "registered", "profile_image": "https://graph.facebook.com/2037236396363923/picture?type=large", "display_name": "John Pritchard", "link": "https://stackoverflow.com/users/10924968/john-pritchard"}, "edited": false, "score": 0, "creation_date": 1548085349, "post_id": 54249016, "comment_id": 95407130, "body": "First, Thank you for helping me out with this.      There were 4 existing sheets before i ran it named: &quot;SBOM&quot;, &quot;001&quot;, &quot;Dropdown Lists&quot;, &amp; &quot;Instructions&quot;. All of the sheets were unhidden and there were no other hidden tabs. When I run the code, it puts out the same error. When I hit debug, it  highlights &quot;wb.Sheets(sht.Index + 1).Name = nm&quot;"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 10924968, "user_type": "registered", "profile_image": "https://graph.facebook.com/2037236396363923/picture?type=large", "display_name": "John Pritchard", "link": "https://stackoverflow.com/users/10924968/john-pritchard"}, "edited": false, "score": 0, "creation_date": 1548086050, "post_id": 54249016, "comment_id": 95407567, "body": "What&#39;s the value of <code>nm</code> when it fails?"}, {"owner": {"reputation": 1, "user_id": 10924968, "user_type": "registered", "profile_image": "https://graph.facebook.com/2037236396363923/picture?type=large", "display_name": "John Pritchard", "link": "https://stackoverflow.com/users/10924968/john-pritchard"}, "edited": false, "score": 0, "creation_date": 1548250609, "post_id": 54249016, "comment_id": 95474972, "body": "The code fails at the first iteration, so I would assume that nm = 2 (Format: &quot;002&quot;)"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1547851060, "last_edit_date": 1547851060, "creation_date": 1547794378, "answer_id": 54249016, "question_id": 54226709, "link": "https://stackoverflow.com/questions/54226709/how-to-duplicate-and-rename-a-tab-containing-numbers-incrementally/54249016#54249016", "title": "How to duplicate and rename a tab containing numbers incrementally", "body": "<p>Here's one way to do it:</p>\n\n<pre><code>Sub Tester()\n    CreateSheets 4\nEnd Sub\n\n\n'EDIT: added specific workbook reference to qualify sheet references\nSub CreateSheets(howMany As Long)\n    Dim nm As String, sht As Worksheet\n    Dim i As Long, n As Long, wb As Workbook\n\n    Set wb = ThisWorkbook\n    For n = 1 To howMany\n        i = 2\n        Do\n            nm = Format(i, \"000\")\n            Set sht = Nothing\n            'see if this sheet exists...\n            On Error Resume Next\n            Set sht = wb.Sheets(nm)\n            On Error GoTo 0\n            If sht Is Nothing Then\n                'get the sheet to copy the template after\n                Set sht = wb.Sheets(Format(i - 1, \"000\"))\n                wb.Sheets(\"001\").Copy after:=sht\n                wb.Sheets(sht.Index + 1).Name = nm\n                Exit Do 'made our copy\n            End If\n            i = i + 1\n        Loop\n    Next n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10924968, "user_type": "registered", "profile_image": "https://graph.facebook.com/2037236396363923/picture?type=large", "display_name": "John Pritchard", "link": "https://stackoverflow.com/users/10924968/john-pritchard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1547851060, "creation_date": 1547679887, "last_edit_date": 1547708950, "question_id": 54226709, "link": "https://stackoverflow.com/questions/54226709/how-to-duplicate-and-rename-a-tab-containing-numbers-incrementally", "title": "How to duplicate and rename a tab containing numbers incrementally", "body": "<p>I am trying to create a code that will duplicate and rename a template tab named \"001\". The thing is, I want each duplicated tab to be named as \"001 +1\". So the duplicated tabs' names would be \"002,003,...,010,011...100,101, etc.</p>\n\n<p>The number of duplicates will be decided by the number entered into a message box that will appear asking \"How many copies would you like to make?\". Also I would like for there to be no duplicates or tabs named \"001 (2)\" if more tab copies were to be added at a later time.</p>\n\n<p>I really appreciate your help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1547679266, "post_id": 54226575, "comment_id": 95279229, "body": "A couple of screenshots along with corresponding outputs would be pretty useful here.  Might help also to explain &quot;cabinet&quot;, &quot;access point&quot; since we don&#39;t know what you&#39;re looking  at."}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1547686039, "post_id": 54226575, "comment_id": 95280917, "body": "Refer to <a href=\"https://stackoverflow.com/questions/52908312/vb-rotate-line-about-a-point/52915518#52915518\">This</a>"}, {"owner": {"reputation": 23, "user_id": 6789700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee2e7ee0bf5fb747da3f9fc8db6e0a76?s=128&d=identicon&r=PG&f=1", "display_name": "Icewing726", "link": "https://stackoverflow.com/users/6789700/icewing726"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1547687520, "post_id": 54226575, "comment_id": 95281160, "body": "@TimWilliams  Added the screen shots."}, {"owner": {"reputation": 23, "user_id": 6789700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee2e7ee0bf5fb747da3f9fc8db6e0a76?s=128&d=identicon&r=PG&f=1", "display_name": "Icewing726", "link": "https://stackoverflow.com/users/6789700/icewing726"}, "reply_to_user": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1547687554, "post_id": 54226575, "comment_id": 95281165, "body": "@Dy.Lee Please see the additional info."}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1547737737, "post_id": 54226575, "comment_id": 95302123, "body": "Please, Insert image not image  link. It is more easy to  understand  your problem."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6789700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee2e7ee0bf5fb747da3f9fc8db6e0a76?s=128&d=identicon&r=PG&f=1", "display_name": "Icewing726", "link": "https://stackoverflow.com/users/6789700/icewing726"}, "edited": false, "score": 0, "creation_date": 1547736063, "post_id": 54231436, "comment_id": 95301079, "body": "Thank you for the reply, I feel like we may still have a disconnect on what I&#39;m doing (my fault).  The shape is a measuring tape in my program.  The user puts one end on the cabinet and one end on the access point and it gives the distance.  The part that&#39;s giving me fits is that when you stretch further to the right or left instead of up or down the object rotates.  When rotation is 90 or 270 the coordinates on the stationary side shift.  I&#39;m not sure how this code identifies that issue."}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1547712202, "creation_date": 1547712202, "answer_id": 54231436, "question_id": 54226575, "link": "https://stackoverflow.com/questions/54226575/shape-top-and-shape-left-issues/54231436#54231436", "title": "Shape.Top and Shape.Left Issues", "body": "<p>I sympathized with your problem recognition and I did not understand this phenomenon, but after testing, it seems that the original coordinates are preserved even if the figure is rotated. This is because even if the rotation is performed again, the rotation is performed by the original coordinate value. If you artificially align the position, the coordinates appear to move accordingly. I tested it as follows.</p>\n\n<pre><code>Sub Measure()\nDim rngT As Range\nDim sp As Shape\nSet sp = ActiveSheet.Shapes(\"Measurement\")\n\n'MsgBox (sp.Top &amp; \"//\" &amp; sp.Left)\nSet rngT = Range(\"k\" &amp; Rows.Count).End(xlUp).Offset(1, 0)\nrngT = sp.Top\nrngT.Offset(, 1) = sp.Left\nEnd Sub\n\nSub test()\n    Dim sp As Shape\n    Dim Ws As Worksheet\n    Dim vDB\n    Dim i As Integer, t As Single, l As Single\n    Dim r As Integer\n    vDB = Range(\"k2\", Range(\"L\" &amp; Rows.Count).End(xlUp))\n\n    Set Ws = ActiveSheet\n    r = UBound(vDB, 1)\n    For i = 1 To r\n        t = vDB(i, 1)\n        l = vDB(i, 2)\n        Set sp = Ws.Shapes.AddShape(msoShapeRectangle, l, t, 10, 10)\n    Next i\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 6789700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee2e7ee0bf5fb747da3f9fc8db6e0a76?s=128&d=identicon&r=PG&f=1", "display_name": "Icewing726", "link": "https://stackoverflow.com/users/6789700/icewing726"}, "is_accepted": false, "score": 0, "last_activity_date": 1547739475, "creation_date": 1547739475, "answer_id": 54239308, "question_id": 54226575, "link": "https://stackoverflow.com/questions/54226575/shape-top-and-shape-left-issues/54239308#54239308", "title": "Shape.Top and Shape.Left Issues", "body": "<p>I figured it out guys.</p>\n\n<p>So in orientation 0 or 180 the Shape.top and Shape.Left give accurate consistent measurements.</p>\n\n<p>In the 90 or 270 the top and left have to be adjusted to give accurate consistent measurements.</p>\n\n<p>The code is Shape.Top-((Shape.Width-Shape.Height)/2) and Shape.Left+((Shape.Width-Shape.Height)/2)<br>\n(NOTE: THIS ADJUSTMENT ONLY APPLIES WHEN OBJECT IS ROTATED 90 or 270//Shape.Rotation)</p>\n\n<p>Also, the shape used here is an elbow connector</p>\n"}], "owner": {"reputation": 23, "user_id": 6789700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee2e7ee0bf5fb747da3f9fc8db6e0a76?s=128&d=identicon&r=PG&f=1", "display_name": "Icewing726", "link": "https://stackoverflow.com/users/6789700/icewing726"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1058, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1547739475, "creation_date": 1547679065, "last_edit_date": 1547708940, "question_id": 54226575, "link": "https://stackoverflow.com/questions/54226575/shape-top-and-shape-left-issues", "title": "Shape.Top and Shape.Left Issues", "body": "<p>I have some code that looks at the position of a line that a user can edit.  The purpose of editing this line is to get rough measurements from a plot plan which works so far.  I'm working on making it much more interactive by recording measured positions as well.</p>\n\n<p>Here's the issue.  When this shape (a connector elbow) is on the cabinet and the access point it records its position in points using shape.top and shape.left (code below).  When I resize this line to put the access point end on another access point, the cabinet position changes as well even though it didn't move.  I did notice that the scale height and width changed on the drawing but I can't figure out why that would affect the initial point. </p>\n\n<p>It's worth noting that as you rotate the elbow connector the value of width and height rotate.  That means sometimes height is up and down and sometimes its the value you'd expect width to be.  Still the left position only stays constant when the connector is rotated 180 degrees.</p>\n\n<p>Is there a relation between scale height/width and the top/left value? </p>\n\n<pre><code>Sub Measure()\n\nSet sp = ActiveSheet.Shapes(\"Measurement\")\n\nMsgbox(sp.Top &amp; \"//\" &amp; sp.Left)\n\nend sub\n\n</code></pre>\n\n<p>Edit: So I realize I mentioned a lot about the program, the real problem is why do the top left measurements change despite the top left staying stationary on the screen? And only in the 270/90 rotation (happens automatically depending how you drag the line)</p>\n\n<p>Add Screen Shots (Measurements are Top then left)\n<a href=\"https://i.stack.imgur.com/wCK7R.jpg\" rel=\"nofollow noreferrer\">This is the first screen shot with a 270 rotation</a>\n<a href=\"https://i.stack.imgur.com/1UTn7.jpg\" rel=\"nofollow noreferrer\">This is the second, notice the top left stayed stationary but the points changed</a>\nThis next group is with a 180/0 rotation (shape auto rotates, otherwise I would just lock it and be done).\n<a href=\"https://i.stack.imgur.com/BJiOU.jpg\" rel=\"nofollow noreferrer\">Rotated 180 first screen shot</a>\n<a href=\"https://i.stack.imgur.com/HuIzp.jpg\" rel=\"nofollow noreferrer\">Rotated 180 second screen shot</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1547687891, "post_id": 54226272, "comment_id": 95281227, "body": "Can you share the url"}, {"owner": {"reputation": 45, "user_id": 10298432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eac9c30a3e52a54aca50dbadc60ae9cc?s=128&d=identicon&r=PG&f=1", "display_name": "v1787v", "link": "https://stackoverflow.com/users/10298432/v1787v"}, "reply_to_user": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1547688483, "post_id": 54226272, "comment_id": 95281331, "body": "Autocheck.com, sir"}, {"owner": {"reputation": 45, "user_id": 10298432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eac9c30a3e52a54aca50dbadc60ae9cc?s=128&d=identicon&r=PG&f=1", "display_name": "v1787v", "link": "https://stackoverflow.com/users/10298432/v1787v"}, "reply_to_user": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1547689235, "post_id": 54226272, "comment_id": 95281497, "body": "IE.Document.forms(&quot;vinSummaryForm&quot;).elements     (&quot;test_vinSummary_carSpecification_$4&quot;).Value = Range(&quot;A10&quot;).Value  It is error at this point, sir"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 10298432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eac9c30a3e52a54aca50dbadc60ae9cc?s=128&d=identicon&r=PG&f=1", "display_name": "v1787v", "link": "https://stackoverflow.com/users/10298432/v1787v"}, "edited": false, "score": 0, "creation_date": 1547692752, "post_id": 54227916, "comment_id": 95282091, "body": "Sir.. I works perfectly when I run it 2 or 3 times at first time, but now it is still error with &quot;IE.Document.forms(&quot;vinSearchForm&quot;).elements(&quot;vin&quot;).Value = &quot;JTDKB22U140021007&quot; : Error :  Run-time error &#39;424&#39;: Object required . May you assist to fix it sir?"}, {"owner": {"reputation": 45, "user_id": 10298432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eac9c30a3e52a54aca50dbadc60ae9cc?s=128&d=identicon&r=PG&f=1", "display_name": "v1787v", "link": "https://stackoverflow.com/users/10298432/v1787v"}, "edited": false, "score": 0, "creation_date": 1547693782, "post_id": 54227916, "comment_id": 95282290, "body": "Sir, I know it. Because of IE is still running so it is error. May you advise which code for closing IE from background?"}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "reply_to_user": {"reputation": 45, "user_id": 10298432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eac9c30a3e52a54aca50dbadc60ae9cc?s=128&d=identicon&r=PG&f=1", "display_name": "v1787v", "link": "https://stackoverflow.com/users/10298432/v1787v"}, "edited": false, "score": 0, "creation_date": 1547693898, "post_id": 54227916, "comment_id": 95282311, "body": "@v1787v IE.Quit Set IE = Nothing"}, {"owner": {"reputation": 45, "user_id": 10298432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eac9c30a3e52a54aca50dbadc60ae9cc?s=128&d=identicon&r=PG&f=1", "display_name": "v1787v", "link": "https://stackoverflow.com/users/10298432/v1787v"}, "edited": false, "score": 0, "creation_date": 1547697775, "post_id": 54227916, "comment_id": 95283076, "body": "Sir, I want to get this result too &quot;Style / Body: Hatchback 4D Engine: 1.5L I4 EFI&quot; So I add code &quot;Range(&quot;A11&quot;).Value = Split(IE.Document.getElementById(&quot;test_vinSummary_carSpecifi&zwnj;&#8203;cation_$4&quot;).innerTex&zwnj;&#8203;t, vbNewLine)(6)&quot;  But the result has only &quot;Style / Body: Hatchback 4D&quot;  May you help me one more step, sir? So Sorry Sir for repeating !!!"}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "reply_to_user": {"reputation": 45, "user_id": 10298432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eac9c30a3e52a54aca50dbadc60ae9cc?s=128&d=identicon&r=PG&f=1", "display_name": "v1787v", "link": "https://stackoverflow.com/users/10298432/v1787v"}, "edited": false, "score": 0, "creation_date": 1547698125, "post_id": 54227916, "comment_id": 95283136, "body": "@v1787v ofcourse Sir,  <code>Split(IE.Document.getelementbyid(&quot;test_vinSummary_carSpecifi&zwnj;&#8203;cation_$4&quot;).innerTex&zwnj;&#8203;t, vbNewLine)(6)</code> here you go sir, no problem sir!!!"}, {"owner": {"reputation": 45, "user_id": 10298432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eac9c30a3e52a54aca50dbadc60ae9cc?s=128&d=identicon&r=PG&f=1", "display_name": "v1787v", "link": "https://stackoverflow.com/users/10298432/v1787v"}, "edited": false, "score": 0, "creation_date": 1550726063, "post_id": 54227916, "comment_id": 96376470, "body": "Sir... So sorry to disturb you again.. May you guide me how to pull data from this web : <a href=\"https://vehicleverification.esma.gov.ae/\" rel=\"nofollow noreferrer\">vehicleverification.esma.gov.ae</a>. HTML in this website is not the same as above web. VIn Test : SCA664S53FUX53460. Appreciated your help sir !!"}, {"owner": {"reputation": 45, "user_id": 10298432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eac9c30a3e52a54aca50dbadc60ae9cc?s=128&d=identicon&r=PG&f=1", "display_name": "v1787v", "link": "https://stackoverflow.com/users/10298432/v1787v"}, "edited": false, "score": 0, "creation_date": 1550728693, "post_id": 54227916, "comment_id": 96377341, "body": "Sir, I can not find \u201cForm\u201d and \u201cID\u201d in Inspection element on this new website so I can not make it work"}], "tags": [], "owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "is_accepted": true, "score": 0, "last_activity_date": 1547697244, "last_edit_date": 1547697244, "creation_date": 1547689976, "answer_id": 54227916, "question_id": 54226272, "link": "https://stackoverflow.com/questions/54226272/pull-data-to-workbook-in-excel/54227916#54227916", "title": "pull data to workbook in excel", "body": "<p>Although not the best way but should work for you</p>\n\n<pre><code>Option Explicit\nSub Autocheck()\n\n    Dim IE As New SHDocVw.InternetExplorer\n\n    IE.Visible = True\n\n    IE.Navigate \"Autocheck.com\"\n\n    Do While IE.ReadyState &lt;&gt; READYSTATE_COMPLETE Or IE.Busy\n        DoEvents\n    Loop\n\n    Application.Wait Now + TimeSerial(0, 0, 5)\n    IE.Document.forms(\"vinSearchForm\").elements(\"vin\").Value = \"JTDKB22U140021007\"\n    IE.Document.forms(\"vinSearchForm\").elements(\"vinSearch\").Click\n\n    Do While IE.ReadyState &lt;&gt; READYSTATE_COMPLETE Or IE.Busy\n        DoEvents\n    Loop\n\n    Application.Wait Now + TimeSerial(0, 0, 5)\n    Range(\"A10\").Value = Split(IE.Document.getelementbyid(\"test_vinSummary_carSpecification_$4\").innerText, vbNewLine)(1)\n\n    IE.Quit\n    Set IE = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 10298432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eac9c30a3e52a54aca50dbadc60ae9cc?s=128&d=identicon&r=PG&f=1", "display_name": "v1787v", "link": "https://stackoverflow.com/users/10298432/v1787v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 54227916, "answer_count": 1, "score": 1, "last_activity_date": 1547804387, "creation_date": 1547677236, "last_edit_date": 1547804387, "question_id": 54226272, "link": "https://stackoverflow.com/questions/54226272/pull-data-to-workbook-in-excel", "title": "pull data to workbook in excel", "body": "<p>I have a problem when trying to scrape data from website. It is Run-time error '424': Object required\nMy code:</p>\n\n<pre><code>Option Explicit\nSub GetData()\n\nDim IE As New SHDocVw.InternetExplorer\n\nIE.Visible = True\n\nIE.Navigate \"abc.com\"\n\nDo While IE.ReadyState &lt;&gt; READYSTATE_COMPLETE\nLoop\n\nIE.Document.forms(\"vinSearchForm\").elements(\"vin\").Value = \n\"******\"\nIE.Document.forms(\"vinSearchForm\").elements(\"vinSearch\").Click\nSheets(\"Sheet1\").Select\nRange(\"A10\").Select \nIE.Document.forms(\"vinSummaryForm\").elements\n(\"test_vinSummary_carSpecification_$4\").Value = Range(\"A10\").Value\n\nEnd Sub\n</code></pre>\n\n<p>What I want is that to show result \"2004*********\" in Range(\"A10\").\nPls kindly help me accordingly. Thanks.</p>\n"}, {"tags": ["excel", "vba", "file"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 1, "creation_date": 1547673929, "post_id": 54225586, "comment_id": 95277101, "body": "You&#39;ve said &quot;The whole macro will use the <i>same file</i> and tab to run each time, but the <i>file name and tab name the macro is in is never the same</i>&quot; (emphasis mine) - you have to pick either the file is the same or it&#39;s not, it can&#39;t be both"}, {"owner": {"reputation": 3, "user_id": 10924652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e22998cee59718e66a0ffe06934ada1?s=128&d=identicon&r=PG&f=1", "display_name": "C Mig", "link": "https://stackoverflow.com/users/10924652/c-mig"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1547819370, "post_id": 54225586, "comment_id": 95334543, "body": "The file that is being used will be the same name for each line in the macro run. I.e. the file to run all 50 placement of data will be \u201cData Found Here\u201d. However, the next time it\u2019s run the file name might be \u201cFile Also Here\u201d so I can\u2019t use a static file name. As for the tab it won\u2019t be the same name as the file it might be \u201cData Set 1\u201d in The first file and \u201cNew Data\u201d in the next file. I\u2019m willing to choose the file name and sheet the first time but I don\u2019t want to have to select it for every single placement of data."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10924652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e22998cee59718e66a0ffe06934ada1?s=128&d=identicon&r=PG&f=1", "display_name": "C Mig", "link": "https://stackoverflow.com/users/10924652/c-mig"}, "edited": false, "score": 0, "creation_date": 1547820533, "post_id": 54225809, "comment_id": 95335186, "body": "I tried this but it gives a compile error: Invalid outside Procedure at Set Sht = ActiveSheet.   Dim wb As Workbook, sht As Worksheet, pth          Set sht = ActiveSheet     pth = &quot;=&#39;[&quot; &amp; sht.Parent.Name &amp; &quot;]&quot; &amp; sht.Name &amp; &quot;&#39;!&quot;          Set wb = Workbooks.Open(&quot;\\\\FS3\\Users$\\UsersName\\Desktop\\Costing Template Test.xlsx&quot;)          With wb.Sheets(&quot;Open Quote&quot;)     .Range(&quot;B3:C3&quot;).FormulaR1C1 = pth &amp; &quot;R6C2&quot;     .Range(&quot;B4:C4&quot;).FormulaR1C1 = pth &amp; &quot;R3C4&quot;     .Range(&quot;B6:C6&quot;).FormulaR1C1 = pth &amp; &quot;R1C15&quot;     .Range(&quot;B7:C7&quot;).FormulaR1C1 = pth &amp; &quot;R5C7&quot; End With"}, {"owner": {"reputation": 3, "user_id": 10924652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e22998cee59718e66a0ffe06934ada1?s=128&d=identicon&r=PG&f=1", "display_name": "C Mig", "link": "https://stackoverflow.com/users/10924652/c-mig"}, "edited": false, "score": 0, "creation_date": 1547832062, "post_id": 54225809, "comment_id": 95341474, "body": "I was able to figure it out. I forgot to ad the sub back to the top/bottom. Thank you!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1547674823, "creation_date": 1547674823, "answer_id": 54225809, "question_id": 54225586, "link": "https://stackoverflow.com/questions/54225586/how-to-select-a-file-name-variable-once-and-use-that-same-file-name-for-each-f/54225809#54225809", "title": "How to select a file name (variable) once and use that same file name for each following execution without having to choose the file", "body": "<p>Something like this:</p>\n\n<pre><code>Dim wb as Workbook, sht as worksheet, pth\n\nSet sht = ActiveSheet\npth = \"='[\" &amp; sht.parent.name &amp; \"]\" &amp; sht.Name &amp; \"'!\"\n\n\n\n'ChDir \"\\\\FS3\\Users$\\UsersName\\Desktop\" 'not needed here...\nset wb = Workbooks.Open(\"\\\\FS3\\Users$\\UsersName\\Desktop\\Costing Template Test.xlsx\")\n\nWith wb.Sheets(\"Open Quote\")\n\n    .Range(\"B3\").FormulaR1C1 = pth &amp; \"R6C2\"\n\n    'etc etc\n\nEnd with\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10924652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e22998cee59718e66a0ffe06934ada1?s=128&d=identicon&r=PG&f=1", "display_name": "C Mig", "link": "https://stackoverflow.com/users/10924652/c-mig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 54225809, "answer_count": 1, "score": 0, "last_activity_date": 1547674823, "creation_date": 1547673748, "last_edit_date": 1547673846, "question_id": 54225586, "link": "https://stackoverflow.com/questions/54225586/how-to-select-a-file-name-variable-once-and-use-that-same-file-name-for-each-f", "title": "How to select a file name (variable) once and use that same file name for each following execution without having to choose the file", "body": "<p>I'm building a macro to open a constant named file but use a varying file name and tab name that the macro is run from.</p>\n\n<p>I build the code originally to open one specific file name and one specific tab name but then realized as I saved the file as a different name that the code always went back to the original file not the new named file and the same issue once I started changing tab names. The whole macro will use the same file and tab to run each time, but the file name and tab name the macro is in is never the same. I've changed the first ActiveCell.FormulaR1C1 formula to specify the file name and tab name and left the same for the following lines to try and better explain what I'm trying to execute.</p>\n\n<pre><code>Sub Costingnon1()\n'\n' Costing***** Macro\n' Create Costing Sheet\n'\n'\n\n    ChDir \"\\\\FS3\\Users$\\UsersName\\Desktop\"\n    Workbooks.Open Filename:= _\n        \"\\\\FS3\\Users$\\UsersName\\Desktop\\Costing Template Test.xlsx\"\n    Sheets(\"Open Quote\").Select\n    Range(\"B3:C3\").Select\n    ActiveCell.FormulaR1C1 = _\n        \"='[File Name That Varies]Tab Name That Varies'!R6C2\"\n    Range(\"B4:C4\").Select\n    ActiveCell.FormulaR1C1 = _\n        \"='[QFCS-071  Request for Quotation Test 1.xlsm]Quote Data 1'!R3C4\"\n    Range(\"B6:C6\").Select\n    ActiveCell.FormulaR1C1 = _\n        \"='[QFCS-071  Request for Quotation Test 1.xlsm]Quote Data 1'!R1C15\"\n</code></pre>\n\n<p>I expect the file to open and execute each step without having to choose the file name and file tab for every cell. I've gotten it to prompt me to pick a file and tab but the macro is filling in over 50 cells when it's executed so it's not any faster than just manually transferring the data by hand.</p>\n"}, {"tags": ["excel", "vba", "selenium-chromedriver"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 10918667, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8Chk6tO-CE8/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbO3XFbfQwoA6JTwaSylv9yIwIuJw/mo/photo.jpg?sz=128", "display_name": "Alex", "link": "https://stackoverflow.com/users/10918667/alex"}, "edited": false, "score": 0, "creation_date": 1547677125, "post_id": 54225787, "comment_id": 95278438, "body": "Thank you very much this is just what I needed. Also thank you for showing me selenium I have been messing around with it and it seems really useful!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 35, "user_id": 10918667, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8Chk6tO-CE8/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbO3XFbfQwoA6JTwaSylv9yIwIuJw/mo/photo.jpg?sz=128", "display_name": "Alex", "link": "https://stackoverflow.com/users/10918667/alex"}, "edited": false, "score": 0, "creation_date": 1547677577, "post_id": 54225787, "comment_id": 95278669, "body": "It\u2019s awesome isn\u2019t it?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1547675818, "last_edit_date": 1547675818, "creation_date": 1547674715, "answer_id": 54225787, "question_id": 54225263, "link": "https://stackoverflow.com/questions/54225263/how-do-i-grab-a-specific-element-from-html-with-vba-using-a-selenium-wrapper/54225787#54225787", "title": "How do i grab a specific element from html with vba using a selenium wrapper", "body": "<p>You can use pseudo class selector of <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/:nth-of-type\" rel=\"nofollow noreferrer\"><code>:nth-of-type</code></a> to specify the column number (<code>nth td</code> cell within a row)</p>\n\n<pre><code>Option Explicit\nPublic Sub SearchVin()\n    Dim d As WebDriver, hTable As Object, ws As Worksheet, t As Date\n    Dim headers(), vin As String\n    Const MAX_WAIT_SEC As Long = 10\n    Set d = New ChromeDriver\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Const URL = \"https://www.autoreturn.com/indianapolis-in/find-vehicle/\"\n\n    vin = \"1G4HD57287U218052\"\n\n    With d\n        .Start \"Chrome\"\n        .get URL\n\n        .FindElementById(\"vin\").SendKeys vin     '&lt;== vin\n\n        Application.Wait Now + TimeSerial(0, 0, 1)\n\n        .FindElementByCss(\"[onclick='submitVin()']\").Click\n\n        t = Timer\n        Do\n            DoEvents\n            On Error Resume Next\n            Set hTable = .FindElementByCss(\"table\")  'use tag name of results table to target table\n            On Error GoTo 0\n            If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n        Loop While hTable Is Nothing\n        'do something with results\n        Dim towDates As Object, towDate As Object\n        If Not hTable Is Nothing Then\n            Set towDates = .FindElementsByCss(\"table tr.results-row td:nth-of-type(9)\")\n            For Each towDate In towDates\n                Debug.Print towDate.Text\n            Next\n        End If\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Results look like:</p>\n\n<p><img src=\"https://i.stack.imgur.com/I1rcY.png\" width=\"300\"></p>\n\n<hr>\n\n<p><strong>Restricting row</strong></p>\n\n<p>You can of course add another <code>nth-of-type</code> selector to restrict the row retrieved as well. Say you wanted the tow datetime for row 2:</p>\n\n<pre><code>table tr:nth-of-type(2).results-row td:nth-of-type(9)\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/3GUJD.png\" width=\"300\"></p>\n\n<p>Note that as I am using a class <code>\".\"</code> selector as well then I am limiting returned rows in the above selectors to exclude the header row.</p>\n\n<hr>\n\n<p><strong>Using last-child:</strong></p>\n\n<p>As the desired column is the last <code>td</code> cell in a row (last column), you can use a <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/:last-child\" rel=\"nofollow noreferrer\"><code>:last-child</code></a> pseudo class selector instead of <code>:nth-of-type</code> e.g.</p>\n\n<pre><code>Set towDates = .FindElementsByCss(\"table tr.results-row td:last-child\")\n</code></pre>\n\n<p>and</p>\n\n<pre><code>table tr:nth-of-type(2).results-row td:last-child\n</code></pre>\n\n<hr>\n\n<p><strong>Single return value versus list:</strong></p>\n\n<p>If you are expecting a single value then you apply the css selector with</p>\n\n<pre><code>.FindElementByCss\n</code></pre>\n\n<p>e.g.  </p>\n\n<pre><code>.FindElementsByCss(\"table tr:nth-of-type(2).results-row td:last-child\")\n</code></pre>\n\n<p>If you are expecting a list of values then you apply the css selector with</p>\n\n<pre><code>.FindElementsByCss\n</code></pre>\n\n<p>e.g.</p>\n\n<pre><code>.FindElementsByCss(\"table tr.results-row td:last-child\")\n</code></pre>\n\n<hr>\n\n<p><strong>first-child selector:</strong></p>\n\n<p>Also worth noting you have access to <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/:first-child\" rel=\"nofollow noreferrer\"><code>:first-child</code></a> selector, for example to grab first result row.</p>\n\n<hr>\n\n<p><strong>Writing out entire table:</strong></p>\n\n<p>If you want to write out the entire table I refer you to my answer <a href=\"https://stackoverflow.com/questions/54205360/why-is-sendkey-enter-not-working-with-chrome-browser\">here</a>.</p>\n"}], "owner": {"reputation": 35, "user_id": 10918667, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8Chk6tO-CE8/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbO3XFbfQwoA6JTwaSylv9yIwIuJw/mo/photo.jpg?sz=128", "display_name": "Alex", "link": "https://stackoverflow.com/users/10918667/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 533, "favorite_count": 0, "accepted_answer_id": 54225787, "answer_count": 1, "score": 1, "last_activity_date": 1547675818, "creation_date": 1547672257, "last_edit_date": 1547672460, "question_id": 54225263, "link": "https://stackoverflow.com/questions/54225263/how-do-i-grab-a-specific-element-from-html-with-vba-using-a-selenium-wrapper", "title": "How do i grab a specific element from html with vba using a selenium wrapper", "body": "<p>How can i call just the 8th cell of a table from html using vba with a selenium wrapper? I am trying to print the date of these impounds into cells in excel. Here is an example where the search has returned the vehicle being impounded 3 times with 3 different dates.</p>\n\n<p>view-source: <a href=\"https://www.autoreturn.com/indianapolis-in/find-vehicle/results\" rel=\"nofollow noreferrer\">https://www.autoreturn.com/indianapolis-in/find-vehicle/results</a></p>\n\n<p>I have tried a couple different variatons of <code>.Findelement</code> such as</p>\n\n<pre><code>Sheets(\"VinCheck\").Cells(i, \"D\").Value = chromeDriver.FindElementByClass(\"input-item\").Text\n</code></pre>\n\n<p>but nothing seems to be working. This just returns a seemingly blank value. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1547670190, "post_id": 54224711, "comment_id": 95275407, "body": "Welcome to SO. Can you specify exactly what your question is / what is the problem you have currently? This will help us help you. Please see: <a href=\"http://meta.stackoverflow.com/q/284236\">Why is \u201cCan someone help me?\u201d not an actual question?</a> as regards my edit (note that requests for &quot;urgent help&quot; will probably go unheeded - a detailed explanation of your problem and what you&#39;ve tried specifically is more likely to produce an effect, as opposed to a list of requirements and request for code.)"}, {"owner": {"reputation": 1, "user_id": 10924469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/544b8dec261baf75fa401cab3303ec12?s=128&d=identicon&r=PG&f=1", "display_name": "sotirisninis", "link": "https://stackoverflow.com/users/10924469/sotirisninis"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1547670752, "post_id": 54224711, "comment_id": 95275679, "body": "@BigBen Noted. My problem as i explained is that i have listboxes with multiple items and when the item &quot;Autre&quot; is selected among other items in a listbox (in other words when the selection contains &quot;Autre&quot;, i need to copy all the items in the listbox to a table but also the text in the corresponding textbox (which is a description of &quot;Autre&quot;."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1547677127, "post_id": 54224711, "comment_id": 95278440, "body": "@sotirisninis That sounds like more of a need/request than a problem. Are you getting an error message? What have you tried so far? What is the current behavior?"}, {"owner": {"reputation": 1, "user_id": 10924469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/544b8dec261baf75fa401cab3303ec12?s=128&d=identicon&r=PG&f=1", "display_name": "sotirisninis", "link": "https://stackoverflow.com/users/10924469/sotirisninis"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1547748897, "post_id": 54224711, "comment_id": 95308235, "body": "@dwirony the current behaviour is when I select multiple items in a listbox including the item &quot;Autre&quot;, it copies all items to the table as required but the text in the textbox is not copied. Do you get what I mean?"}, {"owner": {"reputation": 1, "user_id": 10924469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/544b8dec261baf75fa401cab3303ec12?s=128&d=identicon&r=PG&f=1", "display_name": "sotirisninis", "link": "https://stackoverflow.com/users/10924469/sotirisninis"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1547749085, "post_id": 54224711, "comment_id": 95308335, "body": "@dwirony  - If rng.Parent.Cells(LastRow + 1, 12).Value = &quot;Autre&quot; Then rng.Parent.Cells(LastRow + 1, 12).Value = Me.listDejavenu.Value &amp; &quot;: &quot; &amp; Me.txtDejavenu.Value Else: rng.Parent.Cells(LastRow + 1, 12).Value = myVar   --- it is that bit of code that is not working I think"}], "owner": {"reputation": 1, "user_id": 10924469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/544b8dec261baf75fa401cab3303ec12?s=128&d=identicon&r=PG&f=1", "display_name": "sotirisninis", "link": "https://stackoverflow.com/users/10924469/sotirisninis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547669977, "creation_date": 1547669846, "last_edit_date": 1547669977, "question_id": 54224711, "link": "https://stackoverflow.com/questions/54224711/when-specific-item-is-selected-in-listbox-on-userform-text-in-another-textbox-m", "title": "When specific item is selected in listbox on userform, text in another textbox must be copied to table cell", "body": "<p>I have created a userform with listboxes and textboxes. The listbox contains multiple items but when the particular item \"Autre\" is selected on one of the listboxes, I want the items selected in the listbox and also the text in the correspoding textbox (which is a description of \"Autre\") to be copied into the table. </p>\n\n<p>Here is what my code looks like for now:</p>\n\n<pre><code>Private Sub cmdSauvegarder_Click()\n\nDim rng As Range\nSet rng = ActiveSheet.ListObjects(\"Tableau1\").Range\nDim LastRow As Long\nLastRow = rng.Find(What:=\"*\", _\nAfter:=rng.Cells(1), _\nLookat:=xlPart, _\nLookIn:=xlFormulas, _\nSearchOrder:=xlByRows, _\nSearchDirection:=xlPrevious, _\nMatchCase:=False).Row\n\n        rng.Parent.Cells(LastRow + 1, 1).Value = Me.txtDate.Value\n        rng.Parent.Cells(LastRow + 1, 2).Value = Me.txtNom.Value\n        rng.Parent.Cells(LastRow + 1, 3).Value = Me.txtPrenom.Value\n        rng.Parent.Cells(LastRow + 1, 4).Value = Me.cboAge.Value\n        rng.Parent.Cells(LastRow + 1, 5).Value = Me.cboGenre.Value\n        rng.Parent.Cells(LastRow + 1, 6).Value = Me.txtNationalite.Value\n        rng.Parent.Cells(LastRow + 1, 7).Value = Me.txtAdresse.Value\n        rng.Parent.Cells(LastRow + 1, 8).Value = Me.txtTelephone.Value\n        rng.Parent.Cells(LastRow + 1, 9).Value = Me.cboQuartier.Value\n        rng.Parent.Cells(LastRow + 1, 10).Value = Me.cboProfessionnel.Value\n        If rng.Parent.Cells(LastRow + 1, 10).Value = \"Autre\" Then rng.Parent.Cells(LastRow + 1, 10).Value = \"Autre: \" &amp; Me.txtProfessionnel.Value\n        rng.Parent.Cells(LastRow + 1, 11).Value = Me.cboMarital.Value\n        If rng.Parent.Cells(LastRow + 1, 11).Value = \"Autre\" Then rng.Parent.Cells(LastRow + 1, 11).Value = \"Autre: \" &amp; Me.txtMarital.Value\n\n        myVar = \"\"\n        For x = 0 To Me.listDejavenu.ListCount - 1\n            If Me.listDejavenu.Selected(x) Then\n                If myVar = \"\" Then\n                    myVar = Me.listDejavenu.List(x, 0)\n                Else\n                    myVar = myVar &amp; \", \" &amp; Me.listDejavenu.List(x, 0)\n                End If\n            End If\n            If rng.Parent.Cells(LastRow + 1, 12).Value = \"Autre\" Then rng.Parent.Cells(LastRow + 1, 12).Value = Me.listDejavenu.Value &amp; \": \" &amp; Me.txtDejavenu.Value Else: rng.Parent.Cells(LastRow + 1, 12).Value = myVar\n\n            Next\n\n        myWar = \"\"\n        For y = 0 To Me.ListBesoinExprime.ListCount - 1\n            If Me.ListBesoinExprime.Selected(y) Then\n                If myWar = \"\" Then\n                      myWar = Me.ListBesoinExprime.List(y, 0)\n                Else\n                    myWar = myWar &amp; \", \" &amp; Me.ListBesoinExprime.List(y, 0)\n                End If\n            End If\n            If rng.Parent.Cells(LastRow + 1, 13).Value = \"Autre\" Then rng.Parent.Cells(LastRow + 1, 13).Value = Me.ListBesoinExprime.Value &amp; \": \" &amp; Me.txtBesoinExprime.Value Else: rng.Parent.Cells(LastRow + 1, 13).Value = myWar\n\n        Next\n\n      myTar = \"\"\n        For Z = 0 To Me.ListDejaSuivi.ListCount - 1\n            If Me.ListDejaSuivi.Selected(Z) Then\n                If myTar = \"\" Then\n                      myTar = Me.ListDejaSuivi.List(Z, 0)\n                Else\n                    myTar = myTar &amp; \", \" &amp; Me.ListDejaSuivi.List(Z, 0)\n                End If\n            End If\n            If rng.Parent.Cells(LastRow + 1, 14).Value = \"Autre\" Then rng.Parent.Cells(LastRow + 1, 14).Value = Me.ListDejaSuivi.Value &amp; \": \" &amp; Me.txtDejaSuivi.Value Else: rng.Parent.Cells(LastRow + 1, 14).Value = myTar\n\n        Next\n\n     myPar = \"\"\n        For v = 0 To Me.ListRedirigeVers.ListCount - 1\n            If Me.ListRedirigeVers.Selected(v) Then\n                If myPar = \"\" Then\n                      myPar = Me.ListRedirigeVers.List(v, 0)\n                Else\n                    myPar = myPar &amp; \", \" &amp; Me.ListRedirigeVers.List(v, 0)\n                End If\n            End If\n            If rng.Parent.Cells(LastRow + 1, 15).Value = \"Autre\" Then rng.Parent.Cells(LastRow + 1, 15).Value = Me.ListRedirigeVers.Value &amp; \": \" &amp; Me.txtRedirigevers.Value Else: rng.Parent.Cells(LastRow + 1, 15).Value = myPar\n\n        Next\n\n\nCall resetform\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1547670731, "post_id": 54224677, "comment_id": 95275666, "body": "It&#39;s not clear why you&#39;re putting two workbooks into array..."}, {"owner": {"reputation": 81, "user_id": 9580425, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DtGSwIfKFNY/AAAAAAAAAAI/AAAAAAAACV0/E8Ub_vcSMv8/photo.jpg?sz=128", "display_name": "Matt Williams", "link": "https://stackoverflow.com/users/9580425/matt-williams"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1547670996, "post_id": 54224677, "comment_id": 95275780, "body": "How would you suggest comparing the data between the two workbooks and deleting the rows from Master one?"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1547672330, "post_id": 54224677, "comment_id": 95276354, "body": "Check <a href=\"https://1drv.ms/x/s!AvqfUD6Rp0UClAVo9LHHd2j36wta\" rel=\"nofollow noreferrer\">this workbook</a>. <code>Sheet2</code> emulates daily worksheet and <code>Sheet1</code> - master worksheet. The idea is to filter master sheet by values from daily sheet and then check filtered range for presence of &quot;PAID&quot; word."}], "answers": [{"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1547679333, "creation_date": 1547679333, "answer_id": 54226624, "question_id": 54224677, "link": "https://stackoverflow.com/questions/54224677/deleting-rows-based-on-multiple-criteria-across-2-workbooks-in-vba/54226624#54226624", "title": "Deleting rows based on multiple criteria across 2 workbooks in VBA", "body": "<h1>Lost in VBA</h1>\n\n<p>Cannot determine what's going on. Sorry.</p>\n\n<pre><code>Option Explicit\n\nPublic startCell As Range\n\nFunction IsInArray(stringToBeFound As String, arr As Variant) As Boolean\n\n    Dim i As Long\n\n    For i = LBound(arr) To UBound(arr)\n        If arr(i, 1) = stringToBeFound Then\n            IsInArray = True\n            Exit For\n        End If\n    Next\n\nEnd Function\n\nSub AmendMaster()\n\n    Const cSource As Variant = \"Sheet1\"     ' Source Worksheet Name/Index\n    Const cSrc1 As Variant = \"A\"            ' Source Column 1 Letter/Number\n    Const cSrc2 As Variant = \"AC\"           ' Source Column 2 Letter/Number\n    Const cSrcFirstR As Long = 3            ' Source First Row Number\n\n    Const cTarget As Variant = \"Main_Data\"  ' Target Worksheet Name/Index\n    Const cTgt1 As Variant = \"A\"            ' Target Column 1 Letter/Number\n    Const cTgt2 As Variant = \"AB\"           ' Target Column 2 Letter/Number\n    Const cTgtFirstR As Long = 2            ' Target First Row Number\n\n    Dim ws As Worksheet     ' Source Worksheet\n    Dim rngU As Range       ' Union Range\n    Dim vntSrc As Variant   ' Source Array\n    Dim vntTgt As Variant   ' Target Array\n    Dim srcLastR As Long    ' Source Last Row Number\n    Dim tgtLastR As Long    ' Target Last Row Number\n    Dim i As Long           ' Array Row Counter\n    Dim j As Long\n\n    With ThisWorkbook.Worksheets(cTarget)\n        tgtLastR = .Cells(.Rows.Count, cTgt1).End(xlUp).Row\n        vntTgt = .Range(.Cells(cTgtFirstR, cTgt1), .Cells(tgtLastR, cTgt2))\n    End With\n\n    For i = 1 To Workbooks.Count\n        If Workbooks(i).Name &lt;&gt; ThisWorkbook.Name _\n                And Windows(Workbooks(i).Name).Visible = True Then\n            Debug.Print Workbooks(i).Name\n            With Workbooks(i).Worksheets(cSource)\n                srcLastR = .Cells(.Rows.Count, cSrc1).End(xlUp).Row\n                vntSrc = .Range(.Cells(cSrcFirstR, cSrc1), _\n                        .Cells(srcLastR, cSrc2))\n            End With\n            Exit For\n        End If\n    Next\n\n    For i = 1 To UBound(vntSrc)\n        For j = 1 To UBound(vntTgt)\n            If vntTgt(i, UBound(vntTgt, 2)) = \"PAID\" _\n                    And vntSrc(i, 1) = vntTgt(j, 1) Then\n                With ThisWorkbook.Worksheets(cTarget)\n                    .Rows(j).Hidden = True ' Delete\n                End With\n            End If\n        Next\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 9580425, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DtGSwIfKFNY/AAAAAAAAAAI/AAAAAAAACV0/E8Ub_vcSMv8/photo.jpg?sz=128", "display_name": "Matt Williams", "link": "https://stackoverflow.com/users/9580425/matt-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547679333, "creation_date": 1547669715, "question_id": 54224677, "link": "https://stackoverflow.com/questions/54224677/deleting-rows-based-on-multiple-criteria-across-2-workbooks-in-vba", "title": "Deleting rows based on multiple criteria across 2 workbooks in VBA", "body": "<p>I have 2 workbooks. 1 used as the Master and 1 that it ran out of Oracle Cloud on a daily basis with new information relevant to the Master Workbook. I want to compare two values between workbooks and if there is a match delete the corresponding row in the Master spreadsheet. The columns in question are column A in both workbooks which is a unique number identifying the invoice and column AB which either is \"PAID\" or \"UNPAID\" but should only be used to determine if the row should be deleted or updated between workbooks.</p>\n\n<p>If the value in column AB is \"PAID\" and is in the daily workbook(let's call it WB2) and the value in column A of WB2 is in Master then delete the row in Master.</p>\n\n<p>Below is the code that i've currently got. I've went down the route of putting both the ranges in an array and then was hoping to do something like check if the values in the array match (which i've done previously) but I'm not really sure how to then move onto deleting the corresponding row from the correct WB when the conditions have been met.</p>\n\n<pre><code>Public startCell As Range\n\nFunction IsInArray(stringToBeFound As String, arr As Variant) As Boolean\n  Dim i As Long\n  Dim j As Integer\n  j = 0\n\n  For i = LBound(arr) To UBound(arr)\n    If arr(i, 1) = stringToBeFound Then\n        IsInArray = True\n        j = 1\n    End If\n  Next i\n  If j = 0 Then IsInArray = False\nEnd Function\n\nSub AmendMaster()\n\nSet startCell = ActiveWorkbook.Sheets(\"Main_Data\").Cells(Rows.Count, \n\"A\").End(xlUp)\n\nDim mainRng As Range\nDim newRng As Range\n\nDim cell As Range\n\nDim mainArr As Variant\n\nDim wb As Workbook\nDim wbs(1) As Workbook\n\n\nDim i As Long\nDim j As Long\nDim RowMatch As Long\na = 0\n\nSet mainRng = ActiveWorkbook.Sheets(\"Main_Data\").Range(\"A2\", ActiveWorkbook.Sheets(\"Main_Data\").Cells(Rows.Count, \"A\").End(xlUp).Offset(0,27)) 'Column A is the Cust Transaction ID on the Main Report\n\n\nmainArr = mainRng.Value\n\nFor Each wb In Workbooks\n\nSet wbs(a) = wb\na = a + 1\n\nNext wb\n\nSet newRng = wbs(1).Sheets(\"Sheet1\").Range(\"A3\", wbs(1).Sheets(\"Sheet1\").Cells(Rows.Count, \"A\").End(xlUp).Offset(0,28)) 'Column A is the Cust Transaction ID on the Daily Report\nnewArr = newRng.Value\n\nFor Each cell In mainRng\n    cell.Value = cell.Value * 1\nNext cell\nFor Each cell in newRng\n    cell.Value = cell.Value * 1\nNext cell\n\nnewRng.NumberFormat = \"0\"\nnewRng.NumberFormat = \"0\"\n\nmainRng = newRng.Value\n\n\nFor i = 1 To UBound(newArr)\nmatch = False\nFor j = 1 To UBound(mainArr)\n    If newArr(i,28) = \"PAID\" And newArr(i,1) = mainArr(j,1) THEN \n        .Rows(i).Delete\n    End If\nNext i\n\n\nEnd Sub\n</code></pre>\n\n<p>The expected result should be if the Master spreadsheet has 10 rows that are in  WB2 and those 10 rows are in WB2 also have \"PAID\" in column AB then the VBA should delete the 10 matching rows in Master. If AB is \"UNPAID\" then although it may match then it just needs to copy and overwrite all the columns from A:V in Master workbook but for the purpose of this post i'm just wanting to focus on deleting rows as I'm pretty sure I could figure out pasting values.</p>\n\n<p>Any help would be great as I've tried to understanding deleting values but not sure how to do it via array or even what's the best way to tackle this problem so i'm completely open to any tips or suggestions so I can improve coding.</p>\n\n<p>If there's anything else that you need from me to better understand the problem or try please don't hesitate to let me know.</p>\n\n<p>Regards,</p>\n\n<p>Matt</p>\n"}, {"tags": ["excel", "vba", "internet-explorer", "windows-10"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1547672167, "post_id": 54224550, "comment_id": 95276290, "body": "Is <code>Response_123</code> defined/assigned anywhere?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1547678482, "post_id": 54224550, "comment_id": 95278983, "body": "If you cannot share the URL, you should at least share the HTML that you try to interact with. Also, you should show how <code>Response_123</code> is defined as @MathieuGuindon suggests."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547678861, "post_id": 54224550, "comment_id": 95279098, "body": "Also, why the initial DoEvents? And use .Navigate2 and after that line use a proper page load wait of While IE.Busy Or IE.readyState &lt; 4: DoEvents: Wend. And document.All is rarely (if ever) an efficient and desirable method for targeting an element."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1547681227, "post_id": 54224550, "comment_id": 95279875, "body": "Voting to close for lack of a proper <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 7371254, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc8d874641b78c812b9fd3676f8b9f24?s=128&d=identicon&r=PG&f=1", "display_name": "R S", "link": "https://stackoverflow.com/users/7371254/r-s"}, "edited": false, "score": 0, "creation_date": 1547742075, "post_id": 54228035, "comment_id": 95304801, "body": "Deepak.. I changed my code to exactly what you have, but instead of &quot;first name&quot; using the ID that shows up when I right click &gt; inspect on the textbox. It&#39;s still not filling in the textboxes unfortunately.. they remain blank."}], "tags": [], "owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "is_accepted": false, "score": 1, "last_activity_date": 1547691008, "creation_date": 1547691008, "answer_id": 54228035, "question_id": 54224550, "link": "https://stackoverflow.com/questions/54224550/windows-10-internet-explorer-is-not-working-with-old-vba-code/54228035#54228035", "title": "Windows 10 Internet Explorer is not working with old VBA code", "body": "<p>You can see that your code was not written in an efficient way. For an alternative approach, You can refer example below which is working fine with Windows 10.</p>\n\n<pre><code>Dim IE As Object\n\nSub demo()\n    Application.ScreenUpdating = False\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    IE.Visible = True\n    IE.Navigate \"C:\\Users\\Administrator\\Desktop\\sample.html\"\n\n\n    While IE.Busy\n        DoEvents\n    Wend\n\n    wait 1\n    IE.Document.getElementById(\"firstname\").Value = ThisWorkbook.Sheets(\"Sheet1\").Range(\"A1\")\n    wait 1\n    IE.Document.getElementById(\"lastname\").Value = ThisWorkbook.Sheets(\"Sheet1\").Range(\"A2\")\n    wait 1\n    IE.Document.getElementById(\"submit_btn\").Click\n\n    IE.Quit\n    Set IE = Nothing\n\n    Application.ScreenUpdating = True\nEnd Sub\n\nPrivate Sub wait(seconds As Long)\n    Dim endTime As Date\n    endTime = DateAdd(\"s\", seconds, Now())\n    Do While Now() &lt; endTime\n        DoEvents\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>Output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Zyizv.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Zyizv.gif\" alt=\"enter image description here\"></a></p>\n\n<p>If we talk about your above posted code than you can try to put the break point on that line and try to debug the code. Check that Which value contained by Cell B5 and check whether that line get execute successfully or not. For testing purpose, try to assign static value to that textbox. </p>\n"}], "owner": {"reputation": 41, "user_id": 7371254, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc8d874641b78c812b9fd3676f8b9f24?s=128&d=identicon&r=PG&f=1", "display_name": "R S", "link": "https://stackoverflow.com/users/7371254/r-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2327, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547890257, "creation_date": 1547669153, "last_edit_date": 1547890257, "question_id": 54224550, "link": "https://stackoverflow.com/questions/54224550/windows-10-internet-explorer-is-not-working-with-old-vba-code", "title": "Windows 10 Internet Explorer is not working with old VBA code", "body": "<p>I wrote code in VBA a couple years ago to open a website in IE and fill in textboxes with data from an excel file. Unfortunately I am using windows 10 now and this program is not working anymore. It opens the website with no problem, but cannot transpose the data into the textboxes. It simply opens the website and stalls (no data is entered). </p>\n\n<p>The program still works in IE in windows 7, without any problem. I tried multiple laptops with windows 10 and the problem reoccurs. </p>\n\n<p>I honestly don't know how to fix this.</p>\n\n<pre><code>DoEvents\nWebAddress = \"CONFIDENTIAL URL HERE\" &amp; WebID &amp; \"&amp;t=\" \n\n        Dim IE As Object\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n\n  Set IE = CreateObject(\"InternetExplorer.Application\")\n\n  IE.Navigate WebAddress\n  IE.Visible = True\n  While IE.busy\n    DoEvents  'wait until IE is done loading page.\n  Wend\n\n  Application.Wait (Now + TimeSerial(0, 0, 4))\n\n  IE.Document.All(\"Response_123\").Value = ThisWorkbook.Sheets(\"Sheet1\").Range(\"B5\")\n</code></pre>\n\n<p>The last line of code should transfer data from the excel file to the textbox in internet explorer, however nothing happens and the textbox remains blank. Do I need to change anything in my code to account for windows 10 IE?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1547669687, "post_id": 54224523, "comment_id": 95275144, "body": "No way to tell what the original data is, so no way to tell why the format is used. Post the underlying data."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1547671685, "post_id": 54224523, "comment_id": 95276074, "body": "If your Windows Regional settings are MDY, your results are expected."}, {"owner": {"reputation": 197, "user_id": 1005363, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/b0vTT.jpg?s=128&g=1", "display_name": "Geoff", "link": "https://stackoverflow.com/users/1005363/geoff"}, "edited": false, "score": 0, "creation_date": 1547671912, "post_id": 54224523, "comment_id": 95276188, "body": "This is the original:"}, {"owner": {"reputation": 197, "user_id": 1005363, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/b0vTT.jpg?s=128&g=1", "display_name": "Geoff", "link": "https://stackoverflow.com/users/1005363/geoff"}, "edited": false, "score": 0, "creation_date": 1547672394, "post_id": 54224523, "comment_id": 95276385, "body": "My regional settings are dd/mm/yyyy for the short date and dd MMMM yyyy for the long date"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1547672477, "post_id": 54224523, "comment_id": 95276418, "body": "Hmm VBA is sometimes US-centric with regard to dates.  Try the answer I posted."}, {"owner": {"reputation": 197, "user_id": 1005363, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/b0vTT.jpg?s=128&g=1", "display_name": "Geoff", "link": "https://stackoverflow.com/users/1005363/geoff"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1547674095, "post_id": 54224523, "comment_id": 95277180, "body": "@RonRosenfeld Thanks very much, that worked fine!"}], "answers": [{"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 0, "last_activity_date": 1547672389, "creation_date": 1547672389, "answer_id": 54225294, "question_id": 54224523, "link": "https://stackoverflow.com/questions/54224523/splitting-date-time-column-in-excel-vba-to-two-separate-columns-gives-different/54225294#54225294", "title": "Splitting date time column in excel vba to two separate columns gives different results depending on whether dd part is greater than 12 or no", "body": "<p>Something like the following should work:</p>\n\n<pre><code>Sub SplitDateTime()\nDim dDate As Date\nDim dTime As Date\nDim x As Integer\n\nMsgBox \"Split Date Time\"\nFor x = 2 To 21\n    'Sets the date in the cell of the first column\n    dDate = Cells(x, 2)\n    With Cells(x, 2)\n        .Value = Int(dDate)\n        .NumberFormat = \"dd/mm/yy\"\n    End With\n\n    'Sets the time in the cell of the second column\n    With Cells(x, 3)\n        .Value = dDate - Int(dDate)\n        .NumberFormat = \"hh:mm\"\n    End With\nNext x\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 1005363, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/b0vTT.jpg?s=128&g=1", "display_name": "Geoff", "link": "https://stackoverflow.com/users/1005363/geoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 54225294, "answer_count": 1, "score": 0, "last_activity_date": 1547708921, "creation_date": 1547668998, "last_edit_date": 1547708921, "question_id": 54224523, "link": "https://stackoverflow.com/questions/54224523/splitting-date-time-column-in-excel-vba-to-two-separate-columns-gives-different", "title": "Splitting date time column in excel vba to two separate columns gives different results depending on whether dd part is greater than 12 or no", "body": "<p>I use the following code:</p>\n\n<pre><code>Sub SplitDateTime()\nDim dDate As Date\nDim dTime As Date\nDim x As Integer\n\nMsgBox \"Split Date Time\"\n\nFor x = 2 To 21\n    'Sets the date in the cell of the first column\n    dDate = Cells(x, 2)\n    dTime = Cells(x, 2)\n    Cells(x, 2).Value = Format(dDate, \"dd/mm/yyyy\")\n\n    'Sets the time in the cell of the second column\n    Cells(x, 3).Value = Format(dTime, \"hh:mm\")\nNext x\n</code></pre>\n\n<p>When this is run I get the following:</p>\n\n<p><a href=\"https://i.stack.imgur.com/h7G10.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/h7G10.png\" alt=\"excel table\"></a></p>\n\n<p>Notice that the 2nd to the 6th row of dates weren't converted properly. It seems that these rows were changed to mm/dd/yyyy instead of dd/mm/yyyy (they were originally 12/01/2019...), possibly because the conversion is inconsistent, and then the time was inserted as 00:00. Has anyone any suggestions on how to correct this?</p>\n\n<p>This is the original:</p>\n\n<p><a href=\"https://i.stack.imgur.com/tsvzk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tsvzk.png\" alt=\"Original columns, the first column was subsequently deleted\"></a></p>\n\n<p>Original columns, the first column was subsequently deleted</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1547670016, "post_id": 54224490, "comment_id": 95275330, "body": "The loop is not the problem. What happens in the <code>CELLS GET TO THE OTHER FILE HERE</code> is the problem. If the data is in tables, consider using Power Query and merging the two tables on a key field."}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1547672404, "post_id": 54224490, "comment_id": 95276389, "body": "if you sort the planillaDestino data, and use binary search, it will be much faster. can you do so?"}, {"owner": {"reputation": 59, "user_id": 10875682, "user_type": "registered", "profile_image": "https://graph.facebook.com/760692174287105/picture?type=large", "display_name": "Ray&#233;n", "link": "https://stackoverflow.com/users/10875682/ray%c3%a9n"}, "reply_to_user": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1547673749, "post_id": 54224490, "comment_id": 95277016, "body": "@MacroMarc I&#39;m no familiar with binary search, if you mean VLOOKUP I gave up with that yesterday."}, {"owner": {"reputation": 300, "user_id": 1978495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ccacccf34d5d2a9c0668b3b734bb09f?s=128&d=identicon&r=PG", "display_name": "drgs", "link": "https://stackoverflow.com/users/1978495/drgs"}, "edited": false, "score": 0, "creation_date": 1547802267, "post_id": 54224490, "comment_id": 95325434, "body": "Sounds like inner join on two tables"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 10875682, "user_type": "registered", "profile_image": "https://graph.facebook.com/760692174287105/picture?type=large", "display_name": "Ray&#233;n", "link": "https://stackoverflow.com/users/10875682/ray%c3%a9n"}, "edited": false, "score": 0, "creation_date": 1547673929, "post_id": 54224710, "comment_id": 95277100, "body": "By the second it runs everything excel related goes blank (literally) so I cant see the status. But i&#39;ll consider it for my next attempts! Thanks."}], "tags": [], "owner": {"reputation": 168, "user_id": 6619157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bpzjW.png?s=128&g=1", "display_name": "Wilhelm", "link": "https://stackoverflow.com/users/6619157/wilhelm"}, "is_accepted": false, "score": 0, "last_activity_date": 1547669965, "last_edit_date": 1547669965, "creation_date": 1547669845, "answer_id": 54224710, "question_id": 54224490, "link": "https://stackoverflow.com/questions/54224490/optimize-macro-for-millions-of-calculations/54224710#54224710", "title": "Optimize macro for millions of calculations", "body": "<p>First I would add Application.Statusbar value to control how long it is running\nSecond I would add an exit for if a value is found in the inner loop to prevent unneccessary steps in the loop like :</p>\n\n<pre><code>For filaIndiceFuente = 2 To filaFuenteUltima\n    criterioFuente = planillaFuente.Range(\"A\" &amp; filaIndiceFuente).Value\n    if filaIndiceFuente  mod 50 = 0 then \n      **Application.statusbar = filaIndiceFuente**  \n    end if\n    For filaIndiceDestino = 2 To filaDestinoUltima\n        ' filaIndiceDestino = filaIndiceDestino + 1\n        If planillaDestino.Range(\"A\" &amp; filaIndiceDestino).Value = criterioFuente Then\n\n        'CELLS GET TO THE OTHER FILE HERE\n        **exit for**\n        End If\n    Next filaIndiceDestino\nNext filaIndiceFuente\nApplication.statusbar = \"\"\n</code></pre>\n\n<p>You can have the statusbar info inside the inner loop</p>\n\n<pre><code>For filaIndiceFuente = 2 To filaFuenteUltima\n    criterioFuente = planillaFuente.Range(\"A\" &amp; filaIndiceFuente).Value\n\n    For filaIndiceDestino = 2 To filaDestinoUltima\n        ' filaIndiceDestino = filaIndiceDestino + 1\n        if filaIndiceDestino mod 50 = 0 then \n            **Application.statusbar = filaIndiceFuente &amp; \" - \" &amp; filaIndiceDestino **  \n        end if\n        If planillaDestino.Range(\"A\" &amp; filaIndiceDestino).Value = criterioFuente Then\n\n        'CELLS GET TO THE OTHER FILE HERE\n        **exit for**\n        End If\n    Next filaIndiceDestino\nNext filaIndiceFuente\nApplication.statusbar = \"\"\n</code></pre>\n\n<p>I do not see a way to make comparsion faster, but maybe some other has a better idea. See this as a first step to identify the reason for taking a long time.</p>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 10875682, "user_type": "registered", "profile_image": "https://graph.facebook.com/760692174287105/picture?type=large", "display_name": "Ray&#233;n", "link": "https://stackoverflow.com/users/10875682/ray%c3%a9n"}, "edited": false, "score": 0, "creation_date": 1547672682, "post_id": 54224828, "comment_id": 95276502, "body": "The code runs entirely, but it doesn&#39;t add any data to the other sheet, doing the step by step (debug) doesn&#39;t seem to show what the code it&#39;s lacking."}, {"owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "reply_to_user": {"reputation": 59, "user_id": 10875682, "user_type": "registered", "profile_image": "https://graph.facebook.com/760692174287105/picture?type=large", "display_name": "Ray&#233;n", "link": "https://stackoverflow.com/users/10875682/ray%c3%a9n"}, "edited": false, "score": 1, "creation_date": 1547673234, "post_id": 54224828, "comment_id": 95276772, "body": "Does it ever get to the <code>&#39;CELLS GET TO THE OTHER FILE HERE</code> portion of the code?"}, {"owner": {"reputation": 59, "user_id": 10875682, "user_type": "registered", "profile_image": "https://graph.facebook.com/760692174287105/picture?type=large", "display_name": "Ray&#233;n", "link": "https://stackoverflow.com/users/10875682/ray%c3%a9n"}, "edited": false, "score": 0, "creation_date": 1547673451, "post_id": 54224828, "comment_id": 95276870, "body": "Yep, every single line. It may be how I paste the cells but It works on the loop I made. Here&#39;s one of the lines: <code>planillaDestino.Cells(filaIndiceDestino, &quot;P&quot;).Value = planillaFuente.Cells(filaIndiceFuente, &quot;D&quot;).Value</code>"}, {"owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "reply_to_user": {"reputation": 59, "user_id": 10875682, "user_type": "registered", "profile_image": "https://graph.facebook.com/760692174287105/picture?type=large", "display_name": "Ray&#233;n", "link": "https://stackoverflow.com/users/10875682/ray%c3%a9n"}, "edited": false, "score": 1, "creation_date": 1547673899, "post_id": 54224828, "comment_id": 95277090, "body": "Okay, I see what&#39;s happening. <code>filaIndiceFuente = filaFuenteUltima</code> in the code snippet above, so you&#39;re likely always returning a blank value. You would need to reference the Dictionary value which, as noted, is a pointer to the row in <code>planillaFuente</code>.  You&#39;d need to change  <code>planillaFuente.Cells(filaIndiceFuente, &quot;D&quot;).Value</code> to <code>planillaFuente.Cells(dict(CStr(planillaDestino.Range(&quot;A&quot; &amp; filaIndiceDestino).Value)), &quot;D&quot;).Value</code> to reference column &quot;D&quot; of the row stored in the Dictionary."}, {"owner": {"reputation": 59, "user_id": 10875682, "user_type": "registered", "profile_image": "https://graph.facebook.com/760692174287105/picture?type=large", "display_name": "Ray&#233;n", "link": "https://stackoverflow.com/users/10875682/ray%c3%a9n"}, "edited": false, "score": 0, "creation_date": 1547813977, "post_id": 54224828, "comment_id": 95331639, "body": "Thank you so much! Finally had the time to try it and so far it&#39;s working (checking random rows currently). Other thing, could be possible calling a long range (not the entire row) instead of calling each column?"}], "tags": [], "owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "is_accepted": true, "score": 1, "last_activity_date": 1547673253, "last_edit_date": 1547673253, "creation_date": 1547670280, "answer_id": 54224828, "question_id": 54224490, "link": "https://stackoverflow.com/questions/54224490/optimize-macro-for-millions-of-calculations/54224828#54224828", "title": "Optimize macro for millions of calculations", "body": "<p>Usually when I have a large dataset that I'm iterating through for matches, I find that using a <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/dictionary-object\" rel=\"nofollow noreferrer\">Dictionary</a> is faster even than a .<code>Find()</code> operation or iterating through every row.</p>\n\n<p>I would try something like</p>\n\n<pre><code>Dim dict As New Scripting.Dictionary\n\nFor filaIndiceFuente = 2 To filaFuenteUltima\n    dict.Add CStr(planillaFuente.Range(\"A\" &amp; filaIndiceFuente).Value), filaIndiceFuente '&lt;- this will act as a pointer to the row where your match data is\nNext filaIndiceFuente\n\nFor filaIndiceDestino = 2 To filaDestinoUltima\n    If dict.Exists(CStr(planillaDestino.Range(\"A\" &amp; filaIndiceDestino).Value)) Then\n        'CELLS GET TO THE OTHER FILE HERE\n    End If\nNext filaIndiceDestino\n\nSet dict = Nothing\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "is_accepted": false, "score": 0, "last_activity_date": 1547675738, "creation_date": 1547675738, "answer_id": 54225993, "question_id": 54224490, "link": "https://stackoverflow.com/questions/54224490/optimize-macro-for-millions-of-calculations/54225993#54225993", "title": "Optimize macro for millions of calculations", "body": "<p>First sort the planillaDest range ascending by column A, then:</p>\n\n<pre><code>Dim lookupRange As Range\nSet lookupRange = planillaDestino.Range(\"A2:A\" &amp; filaDestinoUltima)\n\nFor filaIndiceFuente = 2 To filaFuenteUltima\n    criterioFuente = planillaFuente.Cells(filaIndiceFuente, \"A\").Value\n    Dim matchRow As Long\n    matchRow = Application.WorksheetFunction.Match(criterioFuente, lookupRange, 1)\n    If lookupRange.Cells(matchRow, 1).Value = criterioFuente Then\n        'CELLS GET TO THE OTHER FILE HERE\n        ' If row to move from planillaFuente to planillaDest, then:\n        planillaDest.Cells(matchRow + 1, \"P\").Value = planillaFuente.Cells(filaIndiceFuente, \"D\").Value\n\n    End If\nNext filaIndiceFuente\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 116, "user_id": 5982062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFQvV.jpg?s=128&g=1", "display_name": "wallyeye", "link": "https://stackoverflow.com/users/5982062/wallyeye"}, "is_accepted": false, "score": 1, "last_activity_date": 1547688661, "creation_date": 1547688661, "answer_id": 54227763, "question_id": 54224490, "link": "https://stackoverflow.com/questions/54224490/optimize-macro-for-millions-of-calculations/54227763#54227763", "title": "Optimize macro for millions of calculations", "body": "<p>I would probably take it a step further, load the data into arrays, then loop through the arrays.  The indice will be off by 1 due the offset on reading the array data.  There is a bit of fluff in the loadscp routine, I built it for reuse.  I suspect you won\u2019t need the status bar.</p>\n\n<pre><code>Dim scpFuente   As scripting.dictionary\nDim arrFuente    As variant \nDim arrDest       As variant \n\nArrfuente = planillaFuente.range(\u201ca2\u201d).resize(filaFuenteUltima-1,1).value\nArrDest = planillaDestino.range(\u201ca2\u201d).resize(filaDestinaUltima-1,1).value\n\nSet scpFuente = loadscp(arrfuente)\n\n\nFor filaIndiceDestino = lbound(arrDest,1) to ubound(arrDest,1) \n    ' filaIndiceDestino = filaIndiceDestino + 1\n    If scpFuente.exists(arrdest(filaindicedestino,1)) Then\n\n    'CELLS GET TO THE OTHER FILE HERE\n\n    End If\nNext filaIndiceDestino\n</code></pre>\n\n<p>The loadscp function:</p>\n\n<pre><code>Public Function Loadscp(ByVal varList As Variant, Optional ByVal intCol As Integer = 1, _\nOptional ByVal intCols As Integer = 1, Optional ByVal strDelim As String = \".\") As Scripting.Dictionary\n\nDim scpList             As Scripting.Dictionary\n\nDim arrVals             As Variant\n\nDim lngLastRow          As Long\nDim lngRow              As Long\nDim intABSCol           As Integer\nDim intColCurr          As Integer\nDim strVal              As String\nDim intRngCol           As Integer\n\nSet Loadscp = New Scripting.Dictionary\nLoadscp.CompareMode = vbTextCompare\n\nintABSCol = Abs(intCol)\nIf IsArray(varList) Then\n    arrVals = varList\nElseIf TypeName(varList) = \"Range\" Then\n    intRngCol = varList.Column\n    lngLastRow = LastRow(varList.Parent, intCol)\n\n    If lngLastRow &gt; varList.Row Then\n        arrVals = varList.Offset(1, intABSCol - 1).Resize(lngLastRow - varList.Row, 1)\n    End If\nElseIf TypeName(varList) = \"Dictionary\" Then\n    Set scpList = varList\n    ReDim arrVals(1 To scpList.Count, 1 To 1)\n    For lngRow = 1 To scpList.Count\n        arrVals(lngRow, 1) = scpList.Keys(lngRow - 1)\n    Next lngRow\nEnd If\n\nIf IsArray(arrVals) Then\n    For lngRow = LBound(arrVals, 1) To UBound(arrVals, 1)\n        strVal = arrVals(lngRow, intCol)\n        For intColCurr = intCol + 1 To intCol + intCols - 1\n            strVal = strVal &amp; strDelim &amp; arrVals(lngRow, intColCurr)\n        Next intColCurr\n        If Not Loadscp.Exists(strVal) Then\n            Loadscp.Item(strVal) = lngRow\n        End If\n    Next lngRow\nEnd If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 10875682, "user_type": "registered", "profile_image": "https://graph.facebook.com/760692174287105/picture?type=large", "display_name": "Ray&#233;n", "link": "https://stackoverflow.com/users/10875682/ray%c3%a9n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 54224828, "answer_count": 4, "score": 1, "last_activity_date": 1547688661, "creation_date": 1547668889, "question_id": 54224490, "link": "https://stackoverflow.com/questions/54224490/optimize-macro-for-millions-of-calculations", "title": "Optimize macro for millions of calculations", "body": "<p>I'm matching ids on separate files, if a match happens the row on the source gets retrieved to the other file. I did a FOR statement for both files to scan each row, the source workbook has over 27000 rows and the other about 8000, if I understand right that is 216M+ calculations until the end of the loops. I've implemented <code>screenUpdating = False</code> and <code>xlCalculationManual</code>. But here am I, I've waited about 30 minutes and there is no sign of the code finishing (both VBA editor and Excel are \"not responding\").</p>\n\n<pre><code>For filaIndiceFuente = 2 To filaFuenteUltima\n    criterioFuente = planillaFuente.Range(\"A\" &amp; filaIndiceFuente).Value\n    For filaIndiceDestino = 2 To filaDestinoUltima\n        ' filaIndiceDestino = filaIndiceDestino + 1\n        If planillaDestino.Range(\"A\" &amp; filaIndiceDestino).Value = criterioFuente Then\n\n        'CELLS GET TO THE OTHER FILE HERE\n\n        End If\n    Next filaIndiceDestino\nNext filaIndiceFuente\n</code></pre>\n\n<p>On test files I implemented the code and it runs almost instantly with positive results. If you could hint me other ways of improving my code I'll be thankful.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1547668652, "post_id": 54224387, "comment_id": 95274698, "body": "<code>Val=lRange.Row</code> ? <code>Val</code> is not an array so cannot have elements. Also your <code>With</code> is redundant."}, {"owner": {"reputation": 11, "user_id": 10923901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ff16c2cd5b4341fe19dfd4f6d540d49?s=128&d=identicon&r=PG&f=1", "display_name": "Katya", "link": "https://stackoverflow.com/users/10923901/katya"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1547670249, "post_id": 54224387, "comment_id": 95275436, "body": "Thank you so much for your comment. Would it make sense to set up Val as an array to store row number, which then becomes an input to a range reference? Or is there another way to store row numbers for each iteration?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1547672727, "post_id": 54224387, "comment_id": 95276522, "body": "The error 91 is caused by the unconditional <code>lRange.Row</code> member call, whenever the <code>Range.Find</code> call fails to find <code>Str</code>, the function returns <code>Nothing</code> - you need to make sure whether <code>Not lRage Is Nothing</code> is true before you can make member calls against <code>lRange</code>."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1547672774, "post_id": 54224387, "comment_id": 95276544, "body": "Yes if you need to store them all, an array is the way to go. You should also check first that <code>str</code> is found before assigning Val to avoid an error."}], "owner": {"reputation": 11, "user_id": 10923901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ff16c2cd5b4341fe19dfd4f6d540d49?s=128&d=identicon&r=PG&f=1", "display_name": "Katya", "link": "https://stackoverflow.com/users/10923901/katya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547668564, "creation_date": 1547668448, "last_edit_date": 1547668564, "question_id": 54224387, "link": "https://stackoverflow.com/questions/54224387/what-is-the-right-way-to-store-a-values-of-a-row-from-i-to-n-to-be-used-late", "title": "What is the right way to store a value(s) of a row (from i to n) to be used later in code? (VBA Lookup/matching function)", "body": "<p>I'm new to VBA, so your help is really appreciated.  My code is taking a partial value from a string in each row of a range (in sheet \"Lookup\"), looking up this partial value in a range (in sheet \"CF\"), and outputting the value corresponding to the partial value (but located in a different column) to a specific range in sheet \"Lookup\".  The following code works for the very first instance of a loop and then spits out an error \"Object variable not set or With missing\".  It looks like the issue is Val variable, but I can't get this to work.  Could you please help me understand, if I'm not defining Val correctly? I'm using Val to store the row number that corresponds to the position of the value I'm trying to look up. Perhaps there's a faster way to do this lookup (the value of interest is in a different column from lookup value)? Thank you!</p>\n\n<pre><code>Sub CF_Lookup()\n\nDim Lastrow As Long\nDim i As Integer\nDim Str As String\nDim lRange As Range\nDim Val As Long\n\nWith Sheets(\"Lookup\")\n      Lastrow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n      For i = 2 To Lastrow\n          With .Range(\"A\" &amp; i &amp; \":A\" &amp; Lastrow)\n              Str = Left(Cells(i, 1).Value, 8)\n              Set lRange = Worksheets(\"CF\").Range(\"A:M\").Find(Str, Lookat:=xlPart)\n              Val(i) = lRange.Row\n              Worksheets(\"Lookup\").Range(\"P\" &amp; i).Value = Worksheets(\"CF\").Range(\"M\" &amp; Val(i)).Value\n          End With\n      Next i\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1547669090, "creation_date": 1547669090, "answer_id": 54224541, "question_id": 54224292, "link": "https://stackoverflow.com/questions/54224292/selecting-rows-and-copy-values-to-another-range/54224541#54224541", "title": "Selecting rows and copy values to another range", "body": "<p>Try this. I'd use <code>range1</code> or something other than <code>range</code> for a variable name. Also read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba?r=SearchResults&amp;s=1%7C346.0321\">how to avoid select</a>. You'll probably have to check the size of the ranges, range1 should be a single cell or the same size as rangesrc.</p>\n\n<pre><code>Sub main()\n\nDim rangeSrc As range, range1 As range\n\nSet rangeSrc = Application.InputBox(\"Select src Range\", \"select src range\", Type:=8) 'type 8 = range\nSet range1 = Application.InputBox(\"select des range\", \"select des range\", Type:=8)\n\nIf Not rangeSrc Is Nothing And Not range1 Is Nothing Then\n    rangeSrc.Copy range1\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 8019981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70b73577d2cc6cd4907e3e34d846e983?s=128&d=identicon&r=PG&f=1", "display_name": "Khesht", "link": "https://stackoverflow.com/users/8019981/khesht"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 54224541, "answer_count": 1, "score": 0, "last_activity_date": 1547708904, "creation_date": 1547668096, "last_edit_date": 1547708904, "question_id": 54224292, "link": "https://stackoverflow.com/questions/54224292/selecting-rows-and-copy-values-to-another-range", "title": "Selecting rows and copy values to another range", "body": "<p>So today I tried to select a row from an Excel file then paste it in another row (in another Excel file)</p>\n\n<p>I've searched the web and Stack Overflow and nothing helped me. I don't know anything about VB and I don't have time because I need this by Saturday and almost everything is vague for me but this is my code:</p>\n\n<pre><code>Sub main()\n\nDim rangeSrc As range, range As range\n\nSet rangeSrc = Application.InputBox(\"Select src Range\", \"select src range\")\nSet range = Application.InputBox(\"select des range\", \"select des range\")\nrangeSrc.Select\nSelection.Copy\n\nrange.Select\nActiveSheet.Paste\n\nEnd Sub \n</code></pre>\n\n<p>There is what I have gathered form all around the web . </p>\n\n<p>The first problem is that it keeps giving me <code>OBJECT REQUIRED</code> error.</p>\n\n<p>The second problem is that if (in the future) I want to add a condition to selecting rows, what should I do? </p>\n\n<p>Thanks</p>\n"}, {"tags": ["python-3.x", "vba", "xlwings"], "comments": [{"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 1, "creation_date": 1547667421, "post_id": 54223734, "comment_id": 95274133, "body": "The path <code>ThisWorkbook.FullName</code> probably has a special slash character in it that Python is interpreting as something else. What characters follow the slashes in the path?"}, {"owner": {"reputation": 161, "user_id": 5749908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d971397e0480b7dff07ca7add59afe94?s=128&d=identicon&r=PG&f=1", "display_name": "FishMonkey", "link": "https://stackoverflow.com/users/5749908/fishmonkey"}, "reply_to_user": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1547668081, "post_id": 54223734, "comment_id": 95274426, "body": "@MBB70 when I run <code>Debug.Print ThisWorkbook.FullName</code> it outputs <code>C:\\Users\\gageb\\Desktop\\test.xlsm</code>"}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 1, "creation_date": 1547668313, "post_id": 54223734, "comment_id": 95274538, "body": "Your error is telling you that there is a problem at character 2-3...so I would suspect <code>\\U</code>...Can you hard code the workbook path, or will it vary? If you can, try the answer I suggested. <code>r&#39;&#39;&#39;C:\\Users\\gageb\\Desktop\\test.xlsm&#39;&#39;&#39;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 5749908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d971397e0480b7dff07ca7add59afe94?s=128&d=identicon&r=PG&f=1", "display_name": "FishMonkey", "link": "https://stackoverflow.com/users/5749908/fishmonkey"}, "edited": false, "score": 0, "creation_date": 1547668205, "post_id": 54224210, "comment_id": 95274479, "body": "Yes, this would work, but this macro will be running on an Excel template, I need to know where the user has saved the file."}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "reply_to_user": {"reputation": 161, "user_id": 5749908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d971397e0480b7dff07ca7add59afe94?s=128&d=identicon&r=PG&f=1", "display_name": "FishMonkey", "link": "https://stackoverflow.com/users/5749908/fishmonkey"}, "edited": false, "score": 0, "creation_date": 1547668582, "post_id": 54224210, "comment_id": 95274672, "body": "Try ... <code>myWBName = &quot;r&#39;&#39;&#39;&quot; &amp; ThisWorkbook.FullName &amp; &quot;&#39;&#39;&#39;&quot;</code> then <code>RunPython (&quot;import exceltest; exceltest.excelTest(&#39;&quot; &amp; myWBName &amp; &quot;&#39;)&quot;)</code>"}], "tags": [], "owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "is_accepted": true, "score": 1, "last_activity_date": 1547667728, "creation_date": 1547667728, "answer_id": 54224210, "question_id": 54223734, "link": "https://stackoverflow.com/questions/54223734/passing-argument-in-xlwings-runpython-vba-function/54224210#54224210", "title": "passing argument in xlwings RunPython VBA function", "body": "<p>Use the full path of your workbook (the actual path instead of <code>ThisWorkbook.FullName</code> and structure it like this <code>r'''myfullpath\\mysubfolder\\myExcelfile'''</code></p>\n"}, {"comments": [{"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 1, "creation_date": 1547669373, "post_id": 54224547, "comment_id": 95275014, "body": "It would be good if you could tell me if the method I suggested worked also. I don&#39;t have xlwings installed. If the only difference between your answer and mine is slightly different quote structure, I&#39;d like to know."}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 1, "creation_date": 1547677816, "post_id": 54224547, "comment_id": 95278759, "body": "&quot;Any help would be greatly appreciated!&quot;"}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 1, "creation_date": 1547740575, "post_id": 54224547, "comment_id": 95303989, "body": "&quot;Great appreciation&quot; would be minimally expressed with at the very least an upvote of my comments and/or answer. It would take you less than a second to do this. I don&#39;t need a pat on the back here, but the fact is that my insight led you directly to your answer. It doesn&#39;t seem right for you to treat this community like an answer-mill, turning your back once you have what you need. I&#39;m new too, but it&#39;s clear already to me that there is a culture of mutual respect here."}], "tags": [], "owner": {"reputation": 161, "user_id": 5749908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d971397e0480b7dff07ca7add59afe94?s=128&d=identicon&r=PG&f=1", "display_name": "FishMonkey", "link": "https://stackoverflow.com/users/5749908/fishmonkey"}, "is_accepted": false, "score": 0, "last_activity_date": 1547669142, "creation_date": 1547669142, "answer_id": 54224547, "question_id": 54223734, "link": "https://stackoverflow.com/questions/54223734/passing-argument-in-xlwings-runpython-vba-function/54224547#54224547", "title": "passing argument in xlwings RunPython VBA function", "body": "<p>I needed to use <code>RunPython (\"import exceltest; exceltest.excelTest(r'\" &amp; ThisWorkbook.FullName &amp; \"')\")</code></p>\n"}], "owner": {"reputation": 161, "user_id": 5749908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d971397e0480b7dff07ca7add59afe94?s=128&d=identicon&r=PG&f=1", "display_name": "FishMonkey", "link": "https://stackoverflow.com/users/5749908/fishmonkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 563, "favorite_count": 0, "accepted_answer_id": 54224210, "answer_count": 2, "score": 0, "last_activity_date": 1547669142, "creation_date": 1547665662, "last_edit_date": 1547666895, "question_id": 54223734, "link": "https://stackoverflow.com/questions/54223734/passing-argument-in-xlwings-runpython-vba-function", "title": "passing argument in xlwings RunPython VBA function", "body": "<p>I am getting some data from excel sheets using python. I'm using xlwings to accomplish this. I am trying to pass the path to the current workbook to my file, where it can use it to find the Excel book. I cannot use xlwings UDF's.</p>\n\n<p>Here's my VBA code:</p>\n\n<pre><code>Sub Button1_Click()\n\n    RunPython (\"import exceltest; exceltest.excelTest('\" &amp; ThisWorkbook.FullName &amp; \"')\")\n\nEnd Sub\n</code></pre>\n\n<p>Here's my exceltest.py Python code:</p>\n\n<pre><code>def excelTest(path_of_file):\n    print (path_of_file)\n</code></pre>\n\n<p>Here's the error I'm getting:</p>\n\n<hr>\n\n<h2>Error</h2>\n\n<pre><code>  File \"&lt;string&gt;\", line 1\n\nSyntaxError: (unicode error) 'unicodeescape' codec can't decode bytes in position 2-3: truncated \\UXXXXXXXX escape\n</code></pre>\n\n<p>Any help would be greatly appreciated!</p>\n"}, {"tags": ["javascript", "excel", "vba", "internet-explorer", "web-scraping"], "comments": [{"owner": {"reputation": 1340, "user_id": 9898651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633ab16a76904ee3826867715fd6d5cd?s=128&d=identicon&r=PG&f=1", "display_name": "Adam H", "link": "https://stackoverflow.com/users/9898651/adam-h"}, "edited": false, "score": 0, "creation_date": 1547667708, "post_id": 54223728, "comment_id": 95274259, "body": "I tried building a solution for you but couldn&#39;t get IE to actually run VBScript for me :( basically you need to access the <code>box.innerHTML</code> or <code>box.text</code> to get the actual text content from the element."}, {"owner": {"reputation": 37, "user_id": 10292234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d03925dfd265b9b15ab2c4ad8b2b2041?s=128&d=identicon&r=PG&f=1", "display_name": "Emein", "link": "https://stackoverflow.com/users/10292234/emein"}, "reply_to_user": {"reputation": 1340, "user_id": 9898651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633ab16a76904ee3826867715fd6d5cd?s=128&d=identicon&r=PG&f=1", "display_name": "Adam H", "link": "https://stackoverflow.com/users/9898651/adam-h"}, "edited": false, "score": 0, "creation_date": 1547668226, "post_id": 54223728, "comment_id": 95274490, "body": "Thanks for the attempt, I&#39;ll give it a shot."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 10292234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d03925dfd265b9b15ab2c4ad8b2b2041?s=128&d=identicon&r=PG&f=1", "display_name": "Emein", "link": "https://stackoverflow.com/users/10292234/emein"}, "edited": false, "score": 0, "creation_date": 1547668325, "post_id": 54224062, "comment_id": 95274547, "body": "I&#39;ll try a couple other things first. If I can&#39;t get it working do you know how to execute the jquery from VBA or VBS?"}], "tags": [], "owner": {"reputation": 1743, "user_id": 2844215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X3158.jpg?s=128&g=1", "display_name": "IMParasharG", "link": "https://stackoverflow.com/users/2844215/imparasharg"}, "is_accepted": false, "score": 1, "last_activity_date": 1547667078, "creation_date": 1547667078, "answer_id": 54224062, "question_id": 54223728, "link": "https://stackoverflow.com/questions/54223728/vba-cycle-through-check-boxes-in-javascript-generated-table/54224062#54224062", "title": "VBA Cycle through check boxes in JavaScript Generated Table", "body": "<p>Might be below code help I am using jquery :</p>\n\n<pre><code>&lt;table id=\"tableId\"&gt;\n&lt;tr&gt;\n&lt;td align=\"center\"&gt;&lt;input type=\"checkbox\" name=\"chkToPay\"  value=\"0\"&gt;&lt;/td&gt;\n\n&lt;td align=\"center\"&gt;&lt;input type=\"checkbox\" name=\"chkToPay\"  value=\"1\"&gt;&lt;/td&gt;\n\n&lt;td align=\"center\"&gt;&lt;input type=\"checkbox\" name=\"chkToPay\"  value=\"2\"&gt;&lt;/td&gt;\n\n&lt;td align=\"center\"&gt;&lt;input type=\"checkbox\" name=\"chkToPay\" value=\"3\"&gt;&lt;/td&gt;\n&lt;/tr&gt;\n\n\n$(document).on(\"click\", '#tableId tbody :checkbox[name=\"chkToPay\"]', function(event) {\nvar currentRows = $('#tableId');\n\n$.each(currentRows, function() {\n        $(this).find(':checkbox[name=chkToPay]').each(function() {\n            if($(this). prop(\"checked\") == true){\n                var parentTr = $(this).parents(\"tr\");\n                $(this).prop('checked', true);\n        alert($(this).val());\n        // if you need text from another td you can access by below line\n                //alert(parentTr.children(\"td\").eq(0).text());\n\n            }\n        });\n    });\n        });\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 10292234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d03925dfd265b9b15ab2c4ad8b2b2041?s=128&d=identicon&r=PG&f=1", "display_name": "Emein", "link": "https://stackoverflow.com/users/10292234/emein"}, "edited": false, "score": 1, "creation_date": 1547674559, "post_id": 54224586, "comment_id": 95277361, "body": "Dude this is perfect! Thanks for the help."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1547670417, "last_edit_date": 1547670417, "creation_date": 1547669376, "answer_id": 54224586, "question_id": 54223728, "link": "https://stackoverflow.com/questions/54223728/vba-cycle-through-check-boxes-in-javascript-generated-table/54224586#54224586", "title": "VBA Cycle through check boxes in JavaScript Generated Table", "body": "<p>Would help to see more html. Looks like perhaps you can use an attribute = value selector for example. In the following I target the name attribute and associated value</p>\n\n<pre><code>Dim list As Object, i As Long\nSet list = ie.document.querySelectorAll(\"[name=chkToPay]\")\nFor i = 0 To list.Length - 1\n    Debug.Print list.item(i).Value\nNext\n</code></pre>\n\n<p>You can also combine with a parent id if exists</p>\n\n<pre><code>Dim list As Object, i As Long\nSet list =  ie.document.querySelectorAll(\"#tableId [name=chkToPay]\")\nFor i = 0 To list.Length - 1\n    Debug.Print list.item(i).Value\nNext\n</code></pre>\n\n<p>You can also combine with another attribute to enhance specificity.</p>\n\n<pre><code>Dim list As Object, i As Long\nSet list =  ie.document.querySelectorAll(\"#tableId [type=checkbox][name=chkToPay]\")\nFor i = 0 To list.Length - 1\n    Debug.Print list.item(i).Value\nNext\n</code></pre>\n\n<p>You get the idea.</p>\n\n<p>If you want to check a specific one add in the <code>value</code> attribute</p>\n\n<pre><code>ie.document.querySelector(\"#tableId [name=chkToPay][value='1']\").Click\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 10292234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d03925dfd265b9b15ab2c4ad8b2b2041?s=128&d=identicon&r=PG&f=1", "display_name": "Emein", "link": "https://stackoverflow.com/users/10292234/emein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 54224586, "answer_count": 2, "score": 2, "last_activity_date": 1547670466, "creation_date": 1547665631, "last_edit_date": 1547670466, "question_id": 54223728, "link": "https://stackoverflow.com/questions/54223728/vba-cycle-through-check-boxes-in-javascript-generated-table", "title": "VBA Cycle through check boxes in JavaScript Generated Table", "body": "<p>I'm trying to check all of of the boxes in a JS generated table named tblItems</p>\n\n<p>I have tried to getElementsByTagName(\"td\") but it just loads everything as an HTML obj and I can't use InStr to find anything that differentiates them.\nThis is what I was trying to use to find a value I could use to pick out the check boxes.</p>\n\n<pre><code>Set AllChkBoxes = appIE.document.getElementById(\"tblItems\").getElementsByTagName(\"td\")\n    For Each box In AllChkBoxes\n        If InStr(UCase(box), \"\") &lt;&gt; 0 Then\n            MsgBox (box)\n\n        Else\n            MsgBox (box)\n            End If\n    Next box\nEnd Sub\n</code></pre>\n\n<p>This is what the check boxes look like I was trying to cycle through the value but was unable to. there are a bunch of other td tag names but they are just values in the table or hrefs</p>\n\n<pre><code>&lt;td align=\"center\"&gt;&lt;input type=\"checkbox\" name=\"chkToPay\" checked=\"\" value=\"0\"&gt;&lt;/td&gt;\n\n&lt;td align=\"center\"&gt;&lt;input type=\"checkbox\" name=\"chkToPay\" checked=\"\" value=\"1\"&gt;&lt;/td&gt;\n\n&lt;td align=\"center\"&gt;&lt;input type=\"checkbox\" name=\"chkToPay\" checked=\"\" value=\"2\"&gt;&lt;/td&gt;\n\n&lt;td align=\"center\"&gt;&lt;input type=\"checkbox\" name=\"chkToPay\" checked=\"\" value=\"3\"&gt;&lt;/td&gt;\n</code></pre>\n\n<p>Thanks to anyone that can help.</p>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 370, "user_id": 9864779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fdaba5974f4b2af45b2cf1c0d870564?s=128&d=identicon&r=PG&f=1", "display_name": "visualnotsobasic", "link": "https://stackoverflow.com/users/9864779/visualnotsobasic"}, "is_accepted": false, "score": 0, "last_activity_date": 1547763330, "creation_date": 1547763330, "answer_id": 54245047, "question_id": 54223705, "link": "https://stackoverflow.com/questions/54223705/how-to-repeat-saving-my-powerpoint-file-every-5-minutes/54245047#54245047", "title": "How to Repeat Saving my Powerpoint file every 5 minutes?", "body": "<p>I could be wrong, but most answers I've seen regarding saving in intervals use the OnTime method. This isn't actually available in PowerPoint, so I'm not actually sure that what you're wanting to do is possible.</p>\n"}, {"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 1, "last_activity_date": 1548359298, "creation_date": 1548359298, "answer_id": 54354289, "question_id": 54223705, "link": "https://stackoverflow.com/questions/54223705/how-to-repeat-saving-my-powerpoint-file-every-5-minutes/54354289#54354289", "title": "How to Repeat Saving my Powerpoint file every 5 minutes?", "body": "<p>I don't think you'll be able to do this with a simple macro, but you might be able to make it work with an add-in.</p>\n\n<p>The add-in would:</p>\n\n<ul>\n<li><p>Trap events, specifically the SelectionChanged event. </p></li>\n<li><p>Every time the event fires, the event handling code compares the current time to the time it last fired (stored in a static variable).</p></li>\n<li><p>If more than x minutes have elapsed since the event last fired, saves the presentation and resets the last-fired time.</p></li>\n</ul>\n\n<p>If the event never fires during a session, it means that nothing changed, so no real reason to save.</p>\n\n<p>A further refinement: before or after checking the time difference, check the presentation's .Saved property. If True, then nothing has changed in the presentation, so again, no reason to save.</p>\n"}], "owner": {"reputation": 1, "user_id": 10924202, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lUuZA_iTtMM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZ4ygjX5fdm_JNGtE0JAAYSlHx4eQ/mo/photo.jpg?sz=128", "display_name": "Christian Lavoie", "link": "https://stackoverflow.com/users/10924202/christian-lavoie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1548359298, "creation_date": 1547665574, "question_id": 54223705, "link": "https://stackoverflow.com/questions/54223705/how-to-repeat-saving-my-powerpoint-file-every-5-minutes", "title": "How to Repeat Saving my Powerpoint file every 5 minutes?", "body": "<p>I've been wanting to write a macro to automatically save my powerpoint file every 5 minutes. Can anyone help?</p>\n\n<p>I know there's an auto-save built-in but that's only good for auto recover. I'm attempting to have this ppt being saved every 5 mins so that other users using it at the same time will see the updates come in (using Office 365).</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["html", "vba", "web-scraping", "winhttp"], "comments": [{"owner": {"reputation": 77, "user_id": 10747068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee45f050dc0ba5301c3edab48f051726?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Carney", "link": "https://stackoverflow.com/users/10747068/jim-carney"}, "edited": false, "score": 0, "creation_date": 1547670366, "post_id": 54223572, "comment_id": 95275496, "body": "Quick update. I just manually posted the full cookie into my code by capturing it in Fiddler &amp; then let my code run &amp; I downloaded the file perfectly. So It tells me most of the code is working but I need to get to the whole cookie with the session id, etc. So that&#39;s the crux of the question."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1547671554, "post_id": 54223572, "comment_id": 95276021, "body": "Make sure there are no redirections. Take a look at <a href=\"https://stackoverflow.com/a/49102412/2165759\">the example</a> where <code>auth_token</code> can be retrieved from response headers with disabled redirections only."}, {"owner": {"reputation": 77, "user_id": 10747068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee45f050dc0ba5301c3edab48f051726?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Carney", "link": "https://stackoverflow.com/users/10747068/jim-carney"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1547675225, "post_id": 54223572, "comment_id": 95277663, "body": "Omegastripes, thank you. I added: &quot;WinHttpReq.Option(WinHttpRequestOption_EnableRedirects) = False&quot; right below my first get statement. I see more of the cookie now, I can get the session ID, but its not the complete info. I tried getting the responseBody but that had mainly gibberish. Should I change where my redirects = false line is processed?"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1547676005, "post_id": 54223572, "comment_id": 95277987, "body": "Please add to the answer what headers do you get after disabling redirects? Try to save <code>.responseBody</code> and open as .zip archive."}, {"owner": {"reputation": 77, "user_id": 10747068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee45f050dc0ba5301c3edab48f051726?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Carney", "link": "https://stackoverflow.com/users/10747068/jim-carney"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1547676933, "post_id": 54223572, "comment_id": 95278363, "body": "So the response body zip won&#39;t open &amp; the If WinHttpReq.Status = 200 line to verify it&#39;s ready fails so it skips the download unless i remove that. Headers were added to my original post."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1547707714, "post_id": 54223572, "comment_id": 95285752, "body": "As you can see after disabling redirection there is <code>Location</code> response header received which redirects you to expired error page. I guess you need to repeat the first request with the proper SessionId to fix the error."}, {"owner": {"reputation": 77, "user_id": 10747068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee45f050dc0ba5301c3edab48f051726?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Carney", "link": "https://stackoverflow.com/users/10747068/jim-carney"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1547762547, "post_id": 54223572, "comment_id": 95314348, "body": "Well I have solved the cookies. i removed the redirect disable. Both cookies are there but don&#39;t print on debug. I save all headers to an array &amp; split them out. So to get the session id an authentication token I put strDocCookie = IE.Document.cookie at the top of my code after i login. That gets me everything. Then i just split the parts and rebuild them to look like the one that worked. However in my quest to get the cookies it seems like I&#39;ve changed something in my code &amp; it is not downloading successfully even when I feed it manually, so going thru that now to figure out what I changed."}, {"owner": {"reputation": 77, "user_id": 10747068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee45f050dc0ba5301c3edab48f051726?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Carney", "link": "https://stackoverflow.com/users/10747068/jim-carney"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1547842344, "post_id": 54223572, "comment_id": 95345762, "body": "Small update. So by running fiddler concurrent to my code i see two cookies change from the home page to the reports page. I&#39;m capturing one successfully &amp; just need to capture the last one &amp; I think i&#39;ll be there. so it does look like it&#39;ll take multiple get requests to get the last guy, but I think this has put me on the right path, thank you!"}, {"owner": {"reputation": 77, "user_id": 10747068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee45f050dc0ba5301c3edab48f051726?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Carney", "link": "https://stackoverflow.com/users/10747068/jim-carney"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1547847263, "post_id": 54223572, "comment_id": 95347573, "body": "Ok so my question remains. How do I get the right ASP session ID. I&#39;m getting one but it&#39;s the wrong one compared to fiddler. I&#39;ve disabled redirects. In your comment about repeating the request with the right session ID, how do I do that since its the Asp session ID I&#39;m looking for.  Thank you!"}], "owner": {"reputation": 77, "user_id": 10747068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee45f050dc0ba5301c3edab48f051726?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Carney", "link": "https://stackoverflow.com/users/10747068/jim-carney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1074, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1547676421, "creation_date": 1547665014, "last_edit_date": 1547676421, "question_id": 54223572, "link": "https://stackoverflow.com/questions/54223572/how-to-download-file-from-secure-website-with-winhttprequest-5-1", "title": "How to download file from secure website with WinHTTPRequest.5.1", "body": "<p>I'm trying to download files(PDFs) silently from a website with VBA. So far I login without issue entering UserName &amp; Password on the initial screen, navigate to the reports page within the site, get my list of files successfully in a table. I get the URL of the file in question without issue. Here's where I hit a wall.  I do download a file but get a security warning when i open it that I must be logged in to view it.  I can simulate this warning by pasting a URL into any browser when I'm not logged in &amp; they look the same. So I'm downloading but not authenticating. </p>\n\n<p>The code just on the download issue:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim strCookie As String\nDim strResponse As String\nDim xobj As Object\nDim WinHttpReq As Object\nDim WinHttpReq2 As Object\nDim oStream As Object\n\n' Set xobj = New WinHttp.WinHttpRequest\nstrDocLink = \"https://atlasbridge.com\" &amp; strDocLink &amp; \"&amp;RT=PREVMAIL\"\nDebug.Print strDocLink\n' launch tab &amp; goto url/doc\n' try to download the link(this is the url of the file)\n' strDocLink\nSet WinHttpReq = CreateObject(\"WINHTTP.WinHTTPRequest.5.1\")\nstrUrl = \"https://atlasbridge.com/search/AgencyReports.aspx\"\nWinHttpReq.Open \"GET\", strUrl, False\nWinHttpReq.Option(WinHttpRequestOption_EnableRedirects) = False\nWinHttpReq.setRequestHeader \"Referer\", \"https://atlasbridge.com/search/AgencyReports.aspx\"\nWinHttpReq.setRequestHeader \"User-Agent\", \"Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko\"\nWinHttpReq.setRequestHeader \"Connection\", \"keep-alive\"\nWinHttpReq.setRequestHeader \"Accept\", \"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\"\nWinHttpReq.setRequestHeader \"Accept-Language\", \"en-US,en;q=0.5\"\nWinHttpReq.Send\nIf WinHttpReq.Status = 200 Then\n    strResponse = WinHttpReq.responseText\n    Debug.Print strResponse\n    strCookie = WinHttpReq.getResponseHeader(\"Set-Cookie\") ' this only gets the cookie; cookie seems include the session id\n    resp = WinHttpReq.getAllResponseHeaders\n    ' resp = WinHttpReq.responseBody\n    ' strCookie = WinHttpReq.getResponseHeader(\"Cookie\") ' doesnt find the requested header\n    Debug.Print strCookie\n    Debug.Print resp\n    End If\n' then open second session &amp; try to get document\nSet WinHttpReq2 = CreateObject(\"WINHTTP.WinHTTPRequest.5.1\")\nWinHttpReq2.Open \"GET\", strDocLink, False\nWinHttpReq2.setRequestHeader \"User-Agent\", \"Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko\"\nWinHttpReq2.setRequestHeader \"Accept\", \"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\"\nWinHttpReq2.setRequestHeader \"Accept-Language\", \"en-US,en;q=0.5\"\nWinHttpReq2.setRequestHeader \"Referer\", \"https://atlasbridge.com/search/AgencyReports.aspx\"\nWinHttpReq2.setRequestHeader \"Connection\", \"keep-alive\"\nWinHttpReq2.setRequestHeader \"Host\", \"atlasbridge.com:443\" '\nWinHttpReq2.setRequestHeader \"Accept-Encoding\", \"gzip, deflate, br\"\n' WinHttpReq2.setRequestHeader \"Transfer-Encoding\", \"chunked\"\n' doesnt like this one causes error on the .send\nWinHttpReq2.setRequestHeader \"Cache-Control\", \"private\"\nWinHttpReq2.setRequestHeader \"Upgrade-Insecure-Requests\", \"1\"\nWinHttpReq2.setRequestHeader \"Content-Type\", \"application/pdf\"\nWinHttpReq2.setRequestHeader \"Cookie\", strCookie\nWinHttpReq2.Send\nIf WinHttpReq2.Status = 200 Then\n    Set oStream = CreateObject(\"ADODB.Stream\")\n    oStream.Open\n    oStream.Type = 1\n    oStream.Write WinHttpReq2.responseBody\n    oStream.SaveToFile \"C:\\Users\\MyUserName\\Desktop\\DownloadedMail\\atlasreportdownload.ashx.pdf\", 1 ' 1 = no overwrite, 2 = overwrite\n    oStream.Close\nEnd If\n</code></pre>\n\n<p>I've tried a few different things, but I don't believe I'm getting the full cookie &amp; session ID.</p>\n\n<p>The cookie I get back in <code>WinHttpReq.getResponseHeader(\"Set-Cookie\")</code> or <code>getAllResponseHeaders</code> looks like:</p>\n\n<blockquote>\n  <p>NSC_bumbtcsjehf.dpn_TTM_443_MCWT=ffffffffc3a00a0a000000000005e445a4a423660;Version=1;Max-Age=2400;path=/;secure;httponly</p>\n</blockquote>\n\n<p>But when I use LiveHeaders in Firefox I see:</p>\n\n<blockquote>\n  <p>Cookie: ASP.NET_SessionId=z2e4adilfjgiyynx2mntnh1k; NSC_bumbtcsjehf.dpn_TTM_443_MCWT=ffffffffc3a00a0a000000000005e445a4a423660; AuthToken=0be22946-a97a-442e-bd93-c80f0c96a525; AtlasLastMessage=1173; lc_sso7549731=1546651094987; __lc.visitor_id.7549731=S1546651090.26728e19e6</p>\n</blockquote>\n\n<p>But I can't seem to expose that full cookie with AuthToken &amp; Session ID, etc. when I <code>Debug.Print</code> the response. Can someone point me in the right direction so I can test a variation on what I'm doing? Thank you in advance.</p>\n\n<p>Update: The response headers from the first request:</p>\n\n<pre><code> Cache-Control: private\n Date: Wed, 16 Jan 2019 22:04:54 GMT\n Content-Length: 164\n Content-Type: text/html; charset=utf-8\n Location: /default.aspx?err=Expired&amp;dest=%2fhome.aspx\n Server: Microsoft-IIS/7.0\n Set-Cookie: ASP.NET_SessionId=mo0owzztbul5of0litxox5kx; path=/; secure; HttpOnly\n Set-Cookie: NSC_bumbtcsjehf.dpn_TTM_443_MCWT=ffffffffc3a00a1a45525d5f4f58455e445a4a423660;Version=1;Max-Age=2400;path=/;secure;httponly\n X-AspNet-Version: 4.0.30319\n X-UA-Compatible: IE=edge\n X-Powered-By: ASP.NET\n</code></pre>\n\n<p>I'm working on downloading the response body now.</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1547667108, "post_id": 54223444, "comment_id": 95273990, "body": "What is the actual language of the error? Also put <code>print &quot;SELECT * INTO [;DATABA-SE=&quot; &amp;  sDBFile &amp; &quot;;].&quot; &amp; sTableName1 &amp; &quot;FROM [Excel 12.0;HDR=Yes;DATABASE=&quot; &amp; sXLSFile &amp; &quot;;].[&quot; &amp; sSheet1 &amp; &quot;$];&quot;</code> in the Immediate pane and enter the result in your question above."}, {"owner": {"reputation": 11, "user_id": 10728212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093298a7a26a7f4348ec618f94d07f26?s=128&d=identicon&r=PG&f=1", "display_name": "Broady", "link": "https://stackoverflow.com/users/10728212/broady"}, "reply_to_user": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1547667252, "post_id": 54223444, "comment_id": 95274053, "body": "Run time error 3067 Query input must contain at last one table or query"}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 1, "creation_date": 1547667914, "post_id": 54223444, "comment_id": 95274355, "body": "Are you familiar with the use of the Immediate window? Actually seeing the final Select statement will help significantly in troubleshooting your issue."}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1547667998, "post_id": 54223444, "comment_id": 95274388, "body": "With the VBE open, click CTRL-g...then paste in the print statement from above and hit enter after you execute the line that defines sTableName1."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 2, "creation_date": 1547668001, "post_id": 54223444, "comment_id": 95274390, "body": "You need a space before the <code>FROM</code> clause."}, {"owner": {"reputation": 11, "user_id": 10728212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093298a7a26a7f4348ec618f94d07f26?s=128&d=identicon&r=PG&f=1", "display_name": "Broady", "link": "https://stackoverflow.com/users/10728212/broady"}, "edited": false, "score": 0, "creation_date": 1547669261, "post_id": 54223444, "comment_id": 95274961, "body": "SELECT * [;DATABASE=;] .FROM [Excel 12.0 ;HDR=Yes;DATABASE=;].[$];"}, {"owner": {"reputation": 11, "user_id": 10728212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093298a7a26a7f4348ec618f94d07f26?s=128&d=identicon&r=PG&f=1", "display_name": "Broady", "link": "https://stackoverflow.com/users/10728212/broady"}, "edited": false, "score": 0, "creation_date": 1547669285, "post_id": 54223444, "comment_id": 95274974, "body": "output from the immediate window"}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1547670757, "post_id": 54223444, "comment_id": 95275683, "body": "You need to execute the print statement while the code is running."}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1547670896, "post_id": 54223444, "comment_id": 95275741, "body": "The table and sheet names would appear in your statement if they are defined (as you step through your code)"}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1547670987, "post_id": 54223444, "comment_id": 95275778, "body": "Also, you&#39;ve dimmed <code>sDBFile</code> and <code>sXLSFILE</code> but at no point have you assigned anything to those variables."}, {"owner": {"reputation": 11, "user_id": 10728212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093298a7a26a7f4348ec618f94d07f26?s=128&d=identicon&r=PG&f=1", "display_name": "Broady", "link": "https://stackoverflow.com/users/10728212/broady"}, "edited": false, "score": 0, "creation_date": 1547741691, "post_id": 54223444, "comment_id": 95304550, "body": "I have the pathway set just  I missed including that portion once I made this post"}], "owner": {"reputation": 11, "user_id": 10728212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093298a7a26a7f4348ec618f94d07f26?s=128&d=identicon&r=PG&f=1", "display_name": "Broady", "link": "https://stackoverflow.com/users/10728212/broady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594619595, "creation_date": 1547664382, "last_edit_date": 1594619595, "question_id": 54223444, "link": "https://stackoverflow.com/questions/54223444/how-to-fix-run-time-errorr-3067-query-input", "title": "How to fix Run time errorr 3067 Query input", "body": "<p>I am trying to import an excel sheet on the backend of my split database but I am having complications with this error that states I do not have any  queries as an input which I believe I have my query formatted wrong but I have no idea how to fix it. Please advise. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim sDBFile AS String \nDim sXLSFILE AS String \nDim sSheet AS String \nDim sTableName As String\n\nsSheet1 = \"BJS Commit\"\nsTableName1 = \"tblUpdateBJS Commit\"\n  CurrentDb.Execute \"SELECT * INTO [;DATABA-SE=\" &amp; _\n  sDBFile &amp; \";].\" &amp; sTableName1 &amp; _\n  \"FROM [Excel 12.0;HDR=Yes;DATABASE=\" &amp; _\n  sXLSFile &amp; \";].[\" &amp; sSheet1 &amp; \"$];\", dbFailOnError\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1547664484, "post_id": 54222645, "comment_id": 95272772, "body": "So it fails on this line <code>wkbTemp.Close (False)</code> ?"}, {"owner": {"reputation": 21, "user_id": 9557191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bb257e252c29c3a4923a53b521fd854?s=128&d=identicon&r=PG&f=1", "display_name": "William Young", "link": "https://stackoverflow.com/users/9557191/william-young"}, "reply_to_user": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1547667778, "post_id": 54222645, "comment_id": 95274291, "body": "Yes - but if I skip this line, it will also fail on the wkball.SaveAs"}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1547668228, "post_id": 54222645, "comment_id": 95274491, "body": "You can also try <code>.Checkin</code> since they are SharePoint Files, then call <code>.Close</code> after they are checked in, shouldn&#39;t be the reason why its crashing tho"}, {"owner": {"reputation": 21, "user_id": 9557191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bb257e252c29c3a4923a53b521fd854?s=128&d=identicon&r=PG&f=1", "display_name": "William Young", "link": "https://stackoverflow.com/users/9557191/william-young"}, "reply_to_user": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1547725154, "post_id": 54222645, "comment_id": 95294851, "body": "Thanks for your reply Kubie. Unfortunately neither approach seems to help - still crashes when attempting to close the file. I should also mention that the same thing happens when working with local files!"}, {"owner": {"reputation": 21, "user_id": 9557191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bb257e252c29c3a4923a53b521fd854?s=128&d=identicon&r=PG&f=1", "display_name": "William Young", "link": "https://stackoverflow.com/users/9557191/william-young"}, "reply_to_user": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1547727550, "post_id": 54222645, "comment_id": 95296164, "body": "Ah! I have looked at the crash log, and  &quot;chart.dll&quot; was flagged - could be something wrong with my chart merging operation... any ideas?"}, {"owner": {"reputation": 21, "user_id": 9557191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bb257e252c29c3a4923a53b521fd854?s=128&d=identicon&r=PG&f=1", "display_name": "William Young", "link": "https://stackoverflow.com/users/9557191/william-young"}, "reply_to_user": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1547727695, "post_id": 54222645, "comment_id": 95296237, "body": "From event viewer: Faulting application path: C:\\Program Files (x86)\\Microsoft Office\\root\\Office16\\EXCEL.EXE Faulting module path: C:\\Program Files (x86)\\Microsoft Office\\root\\Office16\\chart.dll"}], "owner": {"reputation": 21, "user_id": 9557191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bb257e252c29c3a4923a53b521fd854?s=128&d=identicon&r=PG&f=1", "display_name": "William Young", "link": "https://stackoverflow.com/users/9557191/william-young"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 509, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1547731953, "creation_date": 1547660846, "last_edit_date": 1547731953, "question_id": 54222645, "link": "https://stackoverflow.com/questions/54222645/excel-crashes-during-workbook-save-or-workbook-close", "title": "Excel crashes during workbook.save or workbook.close", "body": "<p>I've written a short piece of code that copies charts from various temporary workbooks and merges them in a separate file.  </p>\n\n<p>The actual manipulation process seen below runs fine, and the results file is generated as expected. <strong>However, I run into problems after trying to close the workbook (workbook.close) or or save the results file (workbook.save) near the end, when Excel crashes.</strong> </p>\n\n<p>I have put DoEvents either side of each statement to try to give excel to catch up with itself, but to no avail!</p>\n\n<p>I have also tried disabling COM addins but this doesn't seem to have helped. </p>\n\n<p>Any ideas as to why this might be crashing? </p>\n\n<p>Thank you so much in advance!!</p>\n\n<pre><code>Sub CompareResults()\nDim wkbAll As Workbook\nDim FilesToOpen\nDim x As Integer\nDim wkbTemp As Workbook\nDim wkbAllname As Variant\nDim wkbfirst As Workbook\nDim nofiles As Integer\nDim seriesname As String\n\n'Create the new workbook\nWorkbooks.Add\nSet wkbAll = ActiveWorkbook\n\n'Select which files to merge\nFilesToOpen = Application.GetOpenFilename(fileFilter:=\"Excel Files (*.xlsx), *.xlsx\", MultiSelect:=True, Title:=\"Arbin Results Files\")\n\nIf TypeName(FilesToOpen) = \"Boolean\" Then\n    MsgBox \"No Files were selected\"\nEnd If\n\n'How many files?\nnofiles = UBound(FilesToOpen)\n\n'Set up the first graphs\nSet wkbfirst = Workbooks.Open(filename:=FilesToOpen(1))\nSet wkbfirst = ActiveWorkbook\n\n\nActiveSheet.Shapes.Range(Array(\"ESR\", \"GravCap\", \"VolCap\", \"ActGravCap\", \"CapRet\", \"DisTime\")).Select\n\n\nSelection.Copy\n\nwkbAll.Activate\n\nRange(\"A1\").Select\nActiveSheet.Paste\n\n\n'Copy each set of graphs to wkball\n\nx = 2\nWhile x &lt;= UBound(FilesToOpen)\nSet wkbTemp = Workbooks.Open(filename:=FilesToOpen(x))\nSet wkbTemp = ActiveWorkbook\nSet wkbTemp = wkbTemp\nwkbTemp.Activate\n\n'Copy ESR Graph\nActiveSheet.ChartObjects(\"ESR\").Activate\nActiveChart.ChartArea.Copy\nwkbAll.Activate\nActiveSheet.ChartObjects(\"ESR\").Activate\nActiveChart.Paste\nwkbTemp.Activate\n\n'Copy GravCap Graph\nActiveSheet.ChartObjects(\"GravCap\").Activate\nActiveChart.ChartArea.Copy\nwkbAll.Activate\nActiveSheet.ChartObjects(\"GravCap\").Activate\nActiveChart.Paste\nwkbTemp.Activate\n\n'Copy ActGrav Graph\nActiveSheet.ChartObjects(\"ActGravCap\").Activate\nActiveChart.ChartArea.Copy\nwkbAll.Activate\nActiveSheet.ChartObjects(\"ActGravCap\").Activate\nActiveChart.Paste\nwkbTemp.Activate\n\n'Copy VolCap Graph\nActiveSheet.ChartObjects(\"VolCap\").Activate\nActiveChart.ChartArea.Copy\nwkbAll.Activate\nActiveSheet.ChartObjects(\"VolCap\").Activate\nActiveChart.Paste\nwkbTemp.Activate\n\n'Copy CapRet Graph\nActiveSheet.ChartObjects(\"CapRet\").Activate\nActiveChart.ChartArea.Copy\nwkbAll.Activate\nActiveSheet.ChartObjects(\"CapRet\").Activate\nActiveChart.Paste\nwkbTemp.Activate\n\n'Copy DisTime Graph\nActiveSheet.ChartObjects(\"DisTime\").Activate\nActiveChart.ChartArea.Copy\nwkbAll.Activate\nActiveSheet.ChartObjects(\"DisTime\").Activate\nActiveChart.Paste\n\nDoEvents\n\nwkbTemp.Close (False)\n\nDoEvents\n\n  x = x + 1\n\nWend\n\nDoEvents\n\n'Save the merged File\nwkbAllname = Application.GetSaveAsFilename(\"merged\", fileFilter:=\"microsoft \nexcel files (*.xlsx), *.xlsx\")\nIf wkbAllname &lt;&gt; False Then\nMsgBox \"File Saved as \" &amp; wkbAllname\nElse: End\nEnd If\n\nDoEvents\n\nwkbAll.SaveAs wkbAllname\n\nDoEvents\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1547663960, "post_id": 54222611, "comment_id": 95272530, "body": "Yes it is possible, but I think you will get better help if you reduce your code to a minimum. There is far too much code now to give you a good answer."}, {"owner": {"reputation": 11, "user_id": 10923791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d780b48f84a99b44e30a82e834bb9cbe?s=128&d=identicon&r=PG&f=1", "display_name": "fireFly", "link": "https://stackoverflow.com/users/10923791/firefly"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 1, "creation_date": 1547666455, "post_id": 54222611, "comment_id": 95273675, "body": "My apologies, its my first time. I thought if I added all of it it would help answer a few questions that may pop up. How about now? I could possibly shave it down a bit more."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1547668159, "post_id": 54222611, "comment_id": 95274457, "body": "Much better! You are looking for a recursive algorithm."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1555618489, "post_id": 54222611, "comment_id": 98182697, "body": "For 2nd level folders see <a href=\"https://stackoverflow.com/questions/39225235/how-to-extract-emails-for-outlook-for-subfolders\" title=\"how to extract emails for outlook for subfolders\">stackoverflow.com/questions/39225235/&hellip;</a>. For all folders see <a href=\"https://stackoverflow.com/questions/2272361/can-i-iterate-through-all-outlook-emails-in-a-folder-including-sub-folders\" title=\"can i iterate through all outlook emails in a folder including sub folders\">stackoverflow.com/questions/2272361/&hellip;</a>"}], "owner": {"reputation": 11, "user_id": 10923791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d780b48f84a99b44e30a82e834bb9cbe?s=128&d=identicon&r=PG&f=1", "display_name": "fireFly", "link": "https://stackoverflow.com/users/10923791/firefly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1557382061, "creation_date": 1547660713, "last_edit_date": 1557382061, "question_id": 54222611, "link": "https://stackoverflow.com/questions/54222611/list-emails-in-2nd-level-outlook-subfolders-using-excel-vba", "title": "List emails in 2nd level Outlook subfolders using Excel VBA", "body": "<p>I have four mailboxes ABC@123.com, DEF@123.com, GHI@123.com, and JKL@123.com. </p>\n\n<p>The coding below goes to my tab named refTables gets the list of mailboxes. Goes to those INBOXES only.</p>\n\n<p>I want to grab the emails from all subfolders as well. </p>\n\n<p>Example subfolder names: InProgress, Pending Reply, and Ticket Submitted. </p>\n\n<pre><code>Private Function getEmails(emailAddress, folderName, destinationSheet)\n\n'retrieves emails form outlook given address, folder, and destination sheet\n\nRow = 2\nFor Each Folder In Outlook.Session.Folders\n    If Folder.Name = emailAddress Then\n        For Each subfolder In Folder.Folders\n            If subfolder.Name = folderName Then\n                For Each Item In subfolder.Items\n                    If TypeName(Item) = \"MailItem\" And Item.MessageClass &lt;&gt; \"IPM.Outlook.Recall\" Then\n                        Sheets(destinationSheet).Cells(Row, 1) = Item.ReceivedTime\n                        Sheets(destinationSheet).Cells(Row, 2) = Round(Now() - Item.ReceivedTime, 0)\n                        Sheets(destinationSheet).Cells(Row, 3) = Item.Categories\n                        Sheets(destinationSheet).Cells(Row, 4) = Item.SenderName\n                        Sheets(destinationSheet).Cells(Row, 5) = Item.Subject\n                        Sheets(destinationSheet).Cells(Row, 6) = Item.TaskCompletedDate\n                        Sheets(destinationSheet).Cells(Row, 7) = Folder.Name\n                        Sheets(destinationSheet).Cells(Row, 8) = Item.LastModificationTime\n                        Sheets(destinationSheet).Cells(Row, 9) = Round(Item.TaskCompletedDate - Item.ReceivedTime)\n                         Row = Row + 1\n                    End If\n                Next\n            End If\n        Next\n    End If\nNext\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": false, "score": 0, "last_activity_date": 1547660826, "creation_date": 1547660826, "answer_id": 54222638, "question_id": 54222543, "link": "https://stackoverflow.com/questions/54222543/vba-code-to-select-table-at-cursor-which-avoids-a-crash-when-there-is-no-table-a/54222638#54222638", "title": "VBA code to select table at cursor which avoids a crash when there is no table at the cursor", "body": "<p>The best method would involve removing the <code>Selection</code> and <code>.Select</code> elements entirely as you don't need to use them to interact with anything on your document.  However as I don't know enough about what you're doing, this should work for your needs:</p>\n\n<pre><code>Sub FormatTable(control As IRibbonControl)\n'\n' FormatTable Macro\n'\nOn Error Resume Next ' allow code to progress even if an error occurs\nSelection.Tables(1).Select\nIf Err.Number &lt;&gt; 0 Then Goto ErrHandler    ' Detect an error and step out to handle it\nSelection.Tables(1).Style = \"Prime Table 1\"\nSelection.Style = ActiveDocument.Styles(\"Normal\")\n\nOn Error Goto 0 'switch off the On Error Resume Next as you really want to limit its use\n\nErrHandler:\nMsgBox \"Please Select a Table First\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1547666012, "last_edit_date": 1547666012, "creation_date": 1547660833, "answer_id": 54222640, "question_id": 54222543, "link": "https://stackoverflow.com/questions/54222543/vba-code-to-select-table-at-cursor-which-avoids-a-crash-when-there-is-no-table-a/54222640#54222640", "title": "VBA code to select table at cursor which avoids a crash when there is no table at the cursor", "body": "<p>This can be done by counting the number of tables in the current selection. If there's none, it will be zero. In the code sample, below, if there are zero tables, a message is shown, but this can, of course, be removed.</p>\n\n<pre><code>Sub FormatTable(control As IRibbonControl)\n'\n' FormatTable Macro\n'\n\n  If Selection.Tables.Count &gt; 0 Then\n    Selection.Tables(1).Select\n    Selection.Tables(1).Style = \"Prime Table 1\"\n    Selection.Style = ActiveDocument.Styles(\"Normal\")\n  Else\n    MsgBox \"There's no table at the current selection.\"\n  End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1547673999, "creation_date": 1547673999, "answer_id": 54225639, "question_id": 54222543, "link": "https://stackoverflow.com/questions/54222543/vba-code-to-select-table-at-cursor-which-avoids-a-crash-when-there-is-no-table-a/54225639#54225639", "title": "VBA code to select table at cursor which avoids a crash when there is no table at the cursor", "body": "<p>Try:</p>\n\n<pre><code>Sub FormatTable(control As IRibbonControl)\nWith Selection\n  If .Information(wdWithInTable) = True Then\n    .Tables(1).Style = \"Prime Table 1\"\n    .Style = \"Normal\"\n  Else\n    MsgBox \"There's no table at the current selection.\"\n  End If\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 3936742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98723e7ef67e59b9feea80f01c321373?s=128&d=identicon&r=PG&f=1", "display_name": "Jo Pedder", "link": "https://stackoverflow.com/users/3936742/jo-pedder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 54222640, "answer_count": 3, "score": 1, "last_activity_date": 1547673999, "creation_date": 1547660427, "question_id": 54222543, "link": "https://stackoverflow.com/questions/54222543/vba-code-to-select-table-at-cursor-which-avoids-a-crash-when-there-is-no-table-a", "title": "VBA code to select table at cursor which avoids a crash when there is no table at the cursor", "body": "<p>I have the following VBA macro which selects a table at the cursor point, formats the table and formats the text.</p>\n\n<p>I want to avoid it crashing (runtime error) when the cursor is not in a table and instead put up a message like \"Select Table First\".</p>\n\n<pre><code>Sub FormatTable(control As IRibbonControl)\n'\n' FormatTable Macro\n'\n\nSelection.Tables(1).Select\nSelection.Tables(1).Style = \"Prime Table 1\"\nSelection.Style = ActiveDocument.Styles(\"Normal\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1547658835, "post_id": 54221850, "comment_id": 95270005, "body": "You could try <code>Range(&quot;B&quot; &amp; Cell.Row &amp; &quot;:U&quot; &amp; Cell.Row).Delete</code>"}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1547673581, "post_id": 54222152, "comment_id": 95276926, "body": "OP says &quot; if the value in column A begins with &quot;ABC&quot; so test should be <code>If UCase(Left$(Range(&quot;A&quot; &amp; row).Value), 3) = &quot;ABC&quot; Then</code> .  Trimming may or may not be desired.  Case insensitivite as per OP.&#39;s code.  Might be worth mentioning <code>.ClearContents</code> leaves (other) formatting in place, alternative is to use <code>.Clear</code>"}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1547674213, "post_id": 54222152, "comment_id": 95277239, "body": "@chrisneilsen thank you I overlooked the &quot;begins with&quot; part of the OP&#39;s question"}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1548341610, "post_id": 54222152, "comment_id": 95514056, "body": "Did you try this?"}], "tags": [], "owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "is_accepted": false, "score": 1, "last_activity_date": 1547674290, "last_edit_date": 1547674290, "creation_date": 1547658948, "answer_id": 54222152, "question_id": 54221850, "link": "https://stackoverflow.com/questions/54221850/how-to-delete-entire-row-except-column-a-in-vba-loop/54222152#54222152", "title": "How to delete entire row except column A in VBA loop?", "body": "<p>Here is pretty straightforward approach:</p>\n\n<pre><code>Dim lastRow As Long\nDim row As Long\nDim temp As String\n\n' insert your sheet name here\nWith ThisWorkbook.Worksheets(\"your sheet name\")\n\n    lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n    ' you can change the starting row, right now its 1\n    For row = 1 To lastRow\n\n        ' store whats in col A in a temporary variable\n        temp = Trim(CStr(.Range(\"A\" &amp; row).Value))\n\n        ' if col A isn't 'ABC' clear &amp; grey entire row\n        If UCase(Left(.Range(\"A\" &amp; row).Value), 3) &lt;&gt; \"ABC\" Then\n\n            .Rows(row).ClearContents\n            .Rows(row).Interior.ColorIndex = 15\n\n            ' place temp variable value back in col A and make interior No Fill\n            .Range(\"A\" &amp; row).Value = temp\n            .Range(\"A\" &amp; row).Interior.ColorIndex = 0\n\n        End If\n    Next\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1547679596, "creation_date": 1547679596, "answer_id": 54226673, "question_id": 54221850, "link": "https://stackoverflow.com/questions/54221850/how-to-delete-entire-row-except-column-a-in-vba-loop/54226673#54226673", "title": "How to delete entire row except column A in VBA loop?", "body": "<p>Here is another example; you stated \"clear everything to the right\" so I added offset to clear the contents of the cells not in column A.</p>\n\n<pre><code>Dim x As Long\n\nFor x = 1 To Cells(Rows.Count, 1).End(xlUp).Row\n    If UCase(Left(Cells(x, 1).Value, 3)) = \"ABC\" Then\n        Range(Cells(x, 1), Cells(x, Columns.Count).End(xlToLeft)).Interior.ColorIndex = 15\n        Range(Cells(x, 1).Offset(, 1), Cells(x, Columns.Count).End(xlToLeft)).ClearContents\n    End If\nNext x  \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10923670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f440797b1896a3dcfc80a34f7f9199c9?s=128&d=identicon&r=PG&f=1", "display_name": "John O", "link": "https://stackoverflow.com/users/10923670/john-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1547708793, "creation_date": 1547657851, "last_edit_date": 1547708793, "question_id": 54221850, "link": "https://stackoverflow.com/questions/54221850/how-to-delete-entire-row-except-column-a-in-vba-loop", "title": "How to delete entire row except column A in VBA loop?", "body": "<p>I'm trying to highlight the entire row grey if the value in column A begins with \"ABC\" as well as delete everything right of that cell. Any ideas on how to do this?</p>\n\n<pre><code>Dim DataRange As Range\nSet DataRange = Range(\"A1:U\" &amp; LastRow)\n\nSet MyRange = Range(\"A2:A\" &amp; LastRow)\n\nFor Each Cell In MyRange\nIf UCase(Left(Cell.Value, 3)) = \"ABC\" Then\n    Cell.EntireRow.Interior.ColorIndex = 15\n\n\nElse\n\n\nEnd If\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1547658493, "post_id": 54221437, "comment_id": 95269833, "body": "If your code works and you&#39;re looking for feedback on any/all aspects of it and want to ultimately end up with code that&#39;s as good as it gets, consider putting it up on <a href=\"https://codereview.stackexchange.com\">Code Review</a>, with a description of what it does. I can think of several improvements, but FWIW no, I don&#39;t think there&#39;s any way around opening and saving-as-with-a-password, since adding a password involves saving-as."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1547659571, "post_id": 54221437, "comment_id": 95270403, "body": "Adding to @MathieuGuindon &#39;s comment: When a file is saved with a password it&#39;s also encrypted. That means the Excel application is required to do the encrypting (&quot;Save As&quot;). For this reason, it&#39;s also not possible to use the Open XML file format for password protecting Office files."}], "owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1547659452, "creation_date": 1547656388, "last_edit_date": 1547659452, "question_id": 54221437, "link": "https://stackoverflow.com/questions/54221437/is-there-a-quicker-way-to-batch-protect-the-files", "title": "Is there a quicker way to batch protect the files?", "body": "<p>Is there a way to edit something like this: </p>\n\n<pre><code>Sub password()\nDim wb As Workbook\nDim StrPassword As String, strFile As String, strFolder As String\n\nStrPassword = \"xxxxxxx\"\nstrFolder = \"C:\\\"\nstrFile = Dir(strFolder &amp; \"*Report.xlsx\", vbNormal)\n\nFastMode True\n\n\nWhile strFile &lt;&gt; \"\"\n\n   Set wb = Workbooks.Open(filename:=strFolder &amp; strFile)\n\n    With wb\n        .password = StrPassword\n        .SaveAs filename:=wb.FullName, password:=StrPassword\n        .Close\n    End With\n    strFile = Dir()\n\nWend\n\nFastMode False\n\nEnd Sub\n\n\n\nPublic Sub FastMode(ByVal Toggle As Boolean)\n    Application.ScreenUpdating = Not Toggle\n    Application.EnableEvents = Not Toggle\n    Application.DisplayAlerts = Not Toggle\n    Application.EnableAnimations = Not Toggle\n    Application.DisplayStatusBar = Not Toggle\n    Application.PrintCommunication = Not Toggle\n    Application.Calculation = IIf(Toggle, xlCalculationManual, xlCalculationAutomatic)\nEnd Sub\n</code></pre>\n\n<p>I was wondering if there was a way to assign a pathway directory and eliminate the need to open-password protect-close each file? I can tell that the process of that is what takes up 99% of the time it takes to execute the code. </p>\n\n<p>Are there ways to batch-append a password without actually taking that much action to open/close the files individually?</p>\n\n<p>It takes about 20 minutes to password protect 2500 files, which isn't bad, but I'm wondering if it can be done much quicker?</p>\n"}, {"tags": ["excel", "vba", "module"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1547656113, "post_id": 54221055, "comment_id": 95268489, "body": "Note: Remove <code>On Error Resume Next</code> and see if there are any errors. This makes you blind because it just hides all error messages but the error still occur. Errors you don&#39;t see cannot be fixed."}, {"owner": {"reputation": 21, "user_id": 10923028, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Roek9ooGJ88/AAAAAAAAAAI/AAAAAAAAQ7s/8M8uXSqb3NQ/photo.jpg?sz=128", "display_name": "Arturo Pino", "link": "https://stackoverflow.com/users/10923028/arturo-pino"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1547656472, "post_id": 54221055, "comment_id": 95268707, "body": "I did run this with the error resume next and on error goto 0 statements commented out, but did not receive any errors. The code runs the same, creating the module in the other open workbook."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10923028, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Roek9ooGJ88/AAAAAAAAAAI/AAAAAAAAQ7s/8M8uXSqb3NQ/photo.jpg?sz=128", "display_name": "Arturo Pino", "link": "https://stackoverflow.com/users/10923028/arturo-pino"}, "edited": false, "score": 0, "creation_date": 1547656645, "post_id": 54221443, "comment_id": 95268797, "body": "Wow! Bigben, this worked for me as well, but I&#39;m not exactly sure why? Does referencing the .Application refer to all open modules in excel, regardless of workbook? If so, then this would explain why simply setting Set wbModules = .Modules keeps it contained within the workbook."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 21, "user_id": 10923028, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Roek9ooGJ88/AAAAAAAAAAI/AAAAAAAAQ7s/8M8uXSqb3NQ/photo.jpg?sz=128", "display_name": "Arturo Pino", "link": "https://stackoverflow.com/users/10923028/arturo-pino"}, "edited": false, "score": 3, "creation_date": 1547656682, "post_id": 54221443, "comment_id": 95268815, "body": "@ArturoPino <code>Application</code> is the top-level object, i.e. the <code>Excel</code> application instance, the <i>host</i>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 21, "user_id": 10923028, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Roek9ooGJ88/AAAAAAAAAAI/AAAAAAAAQ7s/8M8uXSqb3NQ/photo.jpg?sz=128", "display_name": "Arturo Pino", "link": "https://stackoverflow.com/users/10923028/arturo-pino"}, "edited": false, "score": 0, "creation_date": 1547656959, "post_id": 54221443, "comment_id": 95268988, "body": "@ArturoPino could only find the Access <a href=\"https://docs.microsoft.com/en-us/office/vba/api/access.modules\" rel=\"nofollow noreferrer\"><code>Modules</code></a> documentation, but yes the <code>Modules</code> collection contains all open modules."}, {"owner": {"reputation": 21, "user_id": 10923028, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Roek9ooGJ88/AAAAAAAAAAI/AAAAAAAAQ7s/8M8uXSqb3NQ/photo.jpg?sz=128", "display_name": "Arturo Pino", "link": "https://stackoverflow.com/users/10923028/arturo-pino"}, "edited": false, "score": 0, "creation_date": 1547763095, "post_id": 54221443, "comment_id": 95314534, "body": "I&#39;m running into some more issues: I&#39;ve corrected the code as shown above, but it seems that it will randomly not rename the Module in the n.Name = &quot;Library&quot; line, and leaves it as &quot;Module10&quot; or &quot;Module11&quot;, etc.   However, when I debug.print the m.Names for each module that was added, it prints the name I intended, i.e. &quot;Library.&quot; Somehow, it&#39;s changing the name, but not displaying the new name in the Modules folder. So when I try to delete the module by name, it doesn&#39;t find it, but when I try to re-add a new module, it thinks the name already exists... I have no idea what&#39;s going on."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1547765201, "post_id": 54221443, "comment_id": 95315231, "body": "Hmm, not sure what to make of that. If it persists you could always ask a new question to start a new thread on that different issue."}, {"owner": {"reputation": 21, "user_id": 10923028, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Roek9ooGJ88/AAAAAAAAAAI/AAAAAAAAQ7s/8M8uXSqb3NQ/photo.jpg?sz=128", "display_name": "Arturo Pino", "link": "https://stackoverflow.com/users/10923028/arturo-pino"}, "edited": false, "score": 0, "creation_date": 1547767532, "post_id": 54221443, "comment_id": 95315976, "body": "@BigBen It seems to happen if I import a library from within an imported library... In other words, if I import a library that has code that imports another library. I modified my code to only import libraries from modules that stay in the workbook, and it looks like it works fine. I&#39;m not sure what the reason for that is, but it&#39;s very strange. I probably won&#39;t spend any more time on it."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 6, "last_activity_date": 1547664877, "last_edit_date": 1547664877, "creation_date": 1547656426, "answer_id": 54221443, "question_id": 54221055, "link": "https://stackoverflow.com/questions/54221055/excel-vba-import-module-from-text-file-without-requiring-trust-center/54221443#54221443", "title": "Excel-VBA Import Module from text file (without requiring trust center)", "body": "<p>Making the following changes seemed to work for me.</p>\n\n<ol>\n<li>Change <code>Dim wbModules As Modules</code> to <code>Dim wbModules</code>. Otherwise I get a type-mismatch error.</li>\n<li>Remove the <code>.Application</code> in <code>Set wbModules = .Application.Modules</code>.</li>\n</ol>\n\n<p><strong>EDIT:</strong></p>\n\n<p>As <a href=\"https://stackoverflow.com/users/1188513/mathieu-guindon\">@Mathieu Guindon</a> has pointed out in a comment, but worth preserving in the question body, <code>Application</code> refers to the <code>Excel</code> application instance, the <em>host</em>. The <code>Modules</code> collection contains all open modules, regardless of the workbook.</p>\n"}], "owner": {"reputation": 21, "user_id": 10923028, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Roek9ooGJ88/AAAAAAAAAAI/AAAAAAAAQ7s/8M8uXSqb3NQ/photo.jpg?sz=128", "display_name": "Arturo Pino", "link": "https://stackoverflow.com/users/10923028/arturo-pino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 862, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1547664877, "creation_date": 1547655032, "last_edit_date": 1547656016, "question_id": 54221055, "link": "https://stackoverflow.com/questions/54221055/excel-vba-import-module-from-text-file-without-requiring-trust-center", "title": "Excel-VBA Import Module from text file (without requiring trust center)", "body": "<p>I'm trying to create a custom library of subs and functions saved as .txt files in a network location where various users of the workbook I'm creating can import them based on which userform function they select. The users of the workbook are only going to be using the workbook through the userforms. I don't want to require them to modify their security trust center settings for this import libraries code to work, so I don't want to use the <code>wb.VBproject.References.import</code> command, or make them add-in. </p>\n\n<p>I found this method which works great, but only as long as no other workbooks are open. If another workbook is open, this code ends up inserting a new module in that other workbook instead, and then the userform calls are meaningless.</p>\n\n<p>I don't understand how this is possible, since I'm referencing all of this code within a \"With ThisWorkbook\" statement. What am I doing wrong?</p>\n\n<pre><code>Sub importLib(libName As String)\n  Application.DisplayAlerts = False\n\n  Path = \"C:\\Users\\(username)\\Desktop\\excelLibraries\\\" 'Example only, my path is actually a network location\n  lib = Path &amp; libName\n  Dim wb As Workbook\n  Set wb = ThisWorkbook\n  With wb\n    On Error Resume Next\n    Dim wbModules As Modules\n\n    Set wbModules = .Application.Modules 'wb=ThisWorkbook, but doesn't point to this workbook when other workbooks open???\n\n    'wb.VBProject.VBComponents.Import lib '---&gt; library saved as .bas, but this requires the user to change their security settings\n    'wb.VBProject.References.AddFromFile lib '---&gt; library saved as add-in reference, but this requires user to change security settings\n\n'----This method works when no other workbooks are open\n    For Each a In wbModules 'Clear any previous Library Module\n        If a.Name = \"Library\" Then\n            a.Delete\n            Exit For\n        End If\n    Next\n\n    Set m = wbModules.Add 'Create a new Library Module\n    m.Name = \"Library\"\n    m.InsertFile lib 'Insert the code\n   On Error GoTo 0\n End With\n Application.DisplayAlerts = True\n\n End Sub\n\n Sub callsub()\n  importLib \"library1.txt\"\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1547653807, "post_id": 54220694, "comment_id": 95267130, "body": "You&#39;re missing the equals sign: <code>ActiveCell.Formula = &quot;=SUM(B2:B&quot; &amp; lastRow &amp; &quot;)&quot;</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1547653939, "post_id": 54220694, "comment_id": 95267203, "body": "Please read and apply <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a> to make your code fast and reliable."}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1547655350, "post_id": 54220694, "comment_id": 95268019, "body": "Another alternative is to use dynamic named ranges, if you don&#39;t mind having your SUM() function in a cell other than the one right below your column. Define a Named Range (e.g. SumRange) and then copy the following into the Refers to box <code>=OFFSET(Sheet1!$B$2,0,0,COUNTA(Sheet1!$B:$B),1)</code> ... then enter <code>=SUM(SumRange)</code> in the cell you want the sum to appear. Anything you add to the end of the range in column B will automatically be included in your sum. Note that no gaps are allowed in column B."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1547655640, "post_id": 54220694, "comment_id": 95268201, "body": "@MBB70 worth to mention that <code>Offset</code> is volatile, so the sum is recalculated on <i>any</i> calculation Excel performs not only on calculations that the sum depends on."}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1547655998, "post_id": 54220694, "comment_id": 95268413, "body": "agreed on the inefficiency issue...this method is however handy nonetheless so I thought I&#39;d share."}, {"owner": {"reputation": 197, "user_id": 10186814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70a16739b4f390d68b13008f18c6108?s=128&d=identicon&r=PG&f=1", "display_name": "Xavi", "link": "https://stackoverflow.com/users/10186814/xavi"}, "edited": false, "score": 0, "creation_date": 1547656506, "post_id": 54220694, "comment_id": 95268726, "body": "thanks a lot to all of you for your help!"}], "owner": {"reputation": 197, "user_id": 10186814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70a16739b4f390d68b13008f18c6108?s=128&d=identicon&r=PG&f=1", "display_name": "Xavi", "link": "https://stackoverflow.com/users/10186814/xavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547653814, "creation_date": 1547653710, "last_edit_date": 1547653814, "question_id": 54220694, "link": "https://stackoverflow.com/questions/54220694/problem-to-sum-from-all-datas-of-my-column-b-b2-to-last-row", "title": "Problem to sum from all datas of my column B (B2 to last row)", "body": "<p>I have a macro for which I would like that it calculates me the sum of all my value contains in column B (from cell B2 to last row). I configured my macro in order that it selects the first cell empty just under the <code>lastrow</code> of my column B (until the penultimate line of my VBA code, my macro works perfectly, I tested it). </p>\n\n<p>My problem is that the last line of my VBA code does not work, apparently the last line of my VBA code: <code>ActiveCell.Formula \"=SUM(B2:B\" &amp; lastrow &amp; \")\"</code> is not correct and because of this line, the macro returns me the error message </p>\n\n<blockquote>\n  <p>Compile error: invalid use or property. </p>\n</blockquote>\n\n<p>If someone could help me, that would be great.\nThanks a lot in advance.\nXavi</p>\n\n<pre><code>Sub Process()   \n    Dim lastrow As Long\n\n    lastrow = ActiveSheet.Cells(ActiveSheet.Rows.Count, \"B\").End(xlUp).Row\n    ActiveSheet.Cells(ActiveSheet.Rows.Count,Selection.Column).End(xlUp).Select\n    ActiveCell.Offset(1, 1).Select\n\n    ActiveCell.Formula \"=SUM(B2:B\" &amp; lastrow &amp; \")\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1547654807, "post_id": 54220461, "comment_id": 95267732, "body": "Your code looks okay at first glance, so what is your question ?"}, {"owner": {"reputation": 25, "user_id": 10900186, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-INV6z7TEHHc/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbqcXBmcTLu0aJJZskbnoyiIUMQsA/mo/photo.jpg?sz=128", "display_name": "Calum Graham", "link": "https://stackoverflow.com/users/10900186/calum-graham"}, "reply_to_user": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1547655340, "post_id": 54220461, "comment_id": 95268013, "body": "Case Is = [ParticipationDate]             CourseStatus = &quot;Not Refreshed&quot;  This part doesnt work"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10900186, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-INV6z7TEHHc/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbqcXBmcTLu0aJJZskbnoyiIUMQsA/mo/photo.jpg?sz=128", "display_name": "Calum Graham", "link": "https://stackoverflow.com/users/10900186/calum-graham"}, "edited": false, "score": 0, "creation_date": 1547655812, "post_id": 54221193, "comment_id": 95268303, "body": "Case is = 0 doesnt appear to work.   I have some test data  part date = 16/01/1919 Ref Date = 16/01/2019 Status = Not Refreshed"}, {"owner": {"reputation": 25, "user_id": 10900186, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-INV6z7TEHHc/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbqcXBmcTLu0aJJZskbnoyiIUMQsA/mo/photo.jpg?sz=128", "display_name": "Calum Graham", "link": "https://stackoverflow.com/users/10900186/calum-graham"}, "edited": false, "score": 0, "creation_date": 1547656004, "post_id": 54221193, "comment_id": 95268418, "body": "I need it to run this part of the code before comparing the date"}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "reply_to_user": {"reputation": 25, "user_id": 10900186, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-INV6z7TEHHc/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbqcXBmcTLu0aJJZskbnoyiIUMQsA/mo/photo.jpg?sz=128", "display_name": "Calum Graham", "link": "https://stackoverflow.com/users/10900186/calum-graham"}, "edited": false, "score": 0, "creation_date": 1547656581, "post_id": 54221193, "comment_id": 95268766, "body": "That would be correct the date diff between 16/01/1919 and 16/01/2019 isn&#39;t 0 ?"}], "tags": [], "owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "is_accepted": false, "score": 0, "last_activity_date": 1547655554, "creation_date": 1547655554, "answer_id": 54221193, "question_id": 54220461, "link": "https://stackoverflow.com/questions/54220461/how-to-compare-two-dates-in-text-boxes/54221193#54221193", "title": "How to compare two dates in text boxes?", "body": "<p>Sorry I didn't read your code super accurately.\nYour datediff function returns a integer value not a date. You should use </p>\n\n<pre><code>Case is 0 \n</code></pre>\n\n<p>to check for a date match.</p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1547656918, "creation_date": 1547656918, "answer_id": 54221592, "question_id": 54220461, "link": "https://stackoverflow.com/questions/54220461/how-to-compare-two-dates-in-text-boxes/54221592#54221592", "title": "How to compare two dates in text boxes?", "body": "<p>You might use something like this:</p>\n\n<pre><code>If Len(RefDate2) &gt; 0 And IsDate(RefDate2) Then\n\n    Select Case DateDiff(\"d\", Date, RefDate2)\n        Case Is &gt; 60\n            CourseStatus = \"In Date\"\n        Case Is &gt; 0\n            CourseStatus = \"Expiring\"\n        Case Else\n            If DateDiff(\"d\", RefDate2, [ParticipationDate]) = 0 Then\n                CourseStatus = \"Not Refreshed\"\n            Else\n                CourseStatus = \"Expired\"\n            End If\n    End Select        \nElse\n    CourseStatus = \"Please Book\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10900186, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-INV6z7TEHHc/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbqcXBmcTLu0aJJZskbnoyiIUMQsA/mo/photo.jpg?sz=128", "display_name": "Calum Graham", "link": "https://stackoverflow.com/users/10900186/calum-graham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1607255579, "creation_date": 1547652970, "last_edit_date": 1607255579, "question_id": 54220461, "link": "https://stackoverflow.com/questions/54220461/how-to-compare-two-dates-in-text-boxes", "title": "How to compare two dates in text boxes?", "body": "<p>I want to compare two dates in text boxes.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function CourseStatus(ByVal RefDate2 As Variant) As String\n\n    Dim Description As String   \n     \n    If Len(RefDate2) &gt; 0 And IsDate(RefDate2) Then\n\n        Select Case DateDiff(&quot;d&quot;, Date, RefDate2)\n            Case Is &gt; 60\n                CourseStatus = &quot;In Date&quot;\n            Case Is &gt; 0\n                CourseStatus = &quot;Expiring&quot;\n            Case Is = [ParticipationDate]\n                CourseStatus = &quot;Not Refreshed&quot;\n            Case Else\n                CourseStatus = &quot;Expired&quot;\n        End Select        \n    Else\n        CourseStatus = &quot;Please Book&quot;\n    End If\n        \nEnd Function\n</code></pre>\n<p>If <code>[ParticipationDate]</code> &amp; <code>[RefDate2]</code> match return &quot;Not Refreshed&quot; as CourseStatus.</p>\n<p>I need to do this before running the rest of the code to give &quot;in Date&quot; &quot;Expiring&quot; &quot;Expired&quot; and if none of this applies display &quot;Please Book&quot;.</p>\n<p>e.g<br />\nParticipationDate 1/1/19<br />\nRefDate2 1/1/19<br />\nCourseStatus &quot;Not Refreshed&quot;</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "edited": false, "score": 0, "creation_date": 1547652547, "post_id": 54220159, "comment_id": 95266356, "body": "It is working- you have to set test variable value by running &quot;variablen&quot; Sub, after that the &quot;testpublic&quot; Sub is working as you expect. If you run only testpublic, than test variable is empty. But the below solution is better than setting variable value in Sub."}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 7975619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dcb452e9b50c0e856f3e7ee62b359bc?s=128&d=identicon&r=PG&f=1", "display_name": "wit4r7", "link": "https://stackoverflow.com/users/7975619/wit4r7"}, "edited": false, "score": 1, "creation_date": 1547653559, "post_id": 54220345, "comment_id": 95266959, "body": "Thanks, that&#39;s exactly what I was looking for."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1547652501, "creation_date": 1547652501, "answer_id": 54220345, "question_id": 54220159, "link": "https://stackoverflow.com/questions/54220159/defining-cross-module-variables-with-values/54220345#54220345", "title": "Defining cross-module variables with values", "body": "<p>I recommend to use a constant instead of a variable:</p>\n\n<p><strong>Module 1</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Const MyPath As String = \"C:\\Temp\"\n</code></pre>\n\n<p><strong>Module 2</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Sub ShowPath()\n    MsgBox MyPath\nEnd Sub\n</code></pre>\n\n<p>I also recommend to activate <code>Option Explicit</code>: In the VBA editor go to <em>Tools</em> \u203a <em>Options</em> \u203a <em><a href=\"https://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a></em>.</p>\n\n<hr>\n\n<p>If you do it like you did <code>test</code> is empty until it was initialized by running the procedure <code>variablen</code> first. If you use <code>Public Const</code> no initialization is required.</p>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1547656111, "creation_date": 1547656111, "answer_id": 54221354, "question_id": 54220159, "link": "https://stackoverflow.com/questions/54220159/defining-cross-module-variables-with-values/54221354#54221354", "title": "Defining cross-module variables with values", "body": "<blockquote>\n  <p><em>so that I don't have to manually adjust the paths in every macro if it changes</em></p>\n</blockquote>\n\n<p>If it ever needs to change, then it semantically isn't a <code>Const</code>. The key to writing code that you don't constantly need to modify is to separate the <em>code</em> from the <em>data</em>.</p>\n\n<p>A file path that <em>sometimes</em> needs to change can be seen as some kind of configuration setting.</p>\n\n<p>Have a module that is able to read the settings from wherever they are, and return the value of a setting given some <em>key</em>.</p>\n\n<p>The settings themselves can live on a (hidden?) worksheet, in a <code>ListObject</code> table with <code>Key</code> and <code>Value</code> columns, and looked up with <code>INDEX</code>+<code>MATCH</code> functions (using the early-bound <code>WorksheetFunction</code> functions will throw run-time errors given a non-existing key string):</p>\n\n<pre><code>Option Explicit\n\nPublic Function GetSettingValue(ByVal key As String) As Variant\n    With SettingsSheet.ListObjects(1)\n        GetSettingValue = Application.WorksheetFunction.Index( _\n            .ListColumns(\"Value\").DataBodyRange, _\n            Application.WorksheetFunction.Match(key, .ListColumns(\"Key\").DataBodyRange, 0))\n    End With\nEnd Function\n</code></pre>\n\n<p>The <code>Variant</code> will retain the subtype of the <code>Value</code>, so for a <code>String</code> value you get a <code>Variant/String</code>; for a <code>Date</code> value you get a <code>Variant/Date</code>, for a numeric value you get a <code>Variant/Double</code>, and for a TRUE/FALSE value you get a <code>Variant/Boolean</code>.</p>\n\n<p>Now when the file path needs to change, your code does not:</p>\n\n<pre><code>Dim path As String\npath = GetSettingValue(\"ImageFolderPath\")\n</code></pre>\n\n<p>And if you need more settings, you have no code to add, either:</p>\n\n<pre><code>Dim otherThing As String\notherThing = GetSettingValue(\"OtherThing\")\n</code></pre>\n\n<p>All you need to do is to make sure the string keys being used match the contents of the <code>Key</code> column in your <code>SettingsSheet</code>.</p>\n"}], "owner": {"reputation": 93, "user_id": 7975619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dcb452e9b50c0e856f3e7ee62b359bc?s=128&d=identicon&r=PG&f=1", "display_name": "wit4r7", "link": "https://stackoverflow.com/users/7975619/wit4r7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 54220345, "answer_count": 2, "score": 1, "last_activity_date": 1547656111, "creation_date": 1547651898, "last_edit_date": 1547652322, "question_id": 54220159, "link": "https://stackoverflow.com/questions/54220159/defining-cross-module-variables-with-values", "title": "Defining cross-module variables with values", "body": "<p>I'm developing a bunch of Excel Macros for making my life easier. One part of different macros is inserting a picture into sheets. For this reason, I would like to save the path to the images in a global location and then access it via a variable (so that I don't have to manually adjust the paths in every macro if it changes). I use one module per macro</p>\n\n<p>In my own module \"Variables\" I defined a variable as Public or Global and then assigned a value via a sub. If I now access this variable via another module, I get an empty MsgBox. \nFor test purposes I use a string which I want to display via an MsgBox. </p>\n\n<p>Modul 1: </p>\n\n<pre><code>Public test As String\nSub variablen()\n    test = \"String for Test \"\nEnd Sub\n</code></pre>\n\n<p>Modul 2: </p>\n\n<pre><code>Public Sub testpublic()\n    MsgBox (test)\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1547651815, "post_id": 54220073, "comment_id": 95265920, "body": "ComboBox Properties =&gt; Open in Design View =&gt;  Data tab =&gt; Look for Default Value property and enter your value"}, {"owner": {"reputation": 23, "user_id": 10923135, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wuHaD4WRwkM/AAAAAAAAAAI/AAAAAAAAGb4/I3XDbq3kfIU/photo.jpg?sz=128", "display_name": "Jerry ", "link": "https://stackoverflow.com/users/10923135/jerry"}, "reply_to_user": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1547652276, "post_id": 54220073, "comment_id": 95266173, "body": "Thats where I am entering it. The combo box is linked to the following query SELECT MsysObjects.Name FROM MsysObjects WHERE (((Left$([Name],1))&lt;&gt;&quot;~&quot;) AND ((MsysObjects.Type)=-32764)) ORDER BY MsysObjects.Name;           when I enter a default value the button mentioned above thinks that &quot;Select Report&quot; is an actual report."}], "answers": [{"tags": [], "owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "is_accepted": true, "score": 0, "last_activity_date": 1547655448, "creation_date": 1547655448, "answer_id": 54221165, "question_id": 54220073, "link": "https://stackoverflow.com/questions/54220073/what-is-proper-code-to-add-a-default-value-in-combo-box/54221165#54221165", "title": "What is proper code to add a Default value in Combo Box?", "body": "<p>Below code will work for you</p>\n\n<pre><code>Private Sub Command531_Click()\n     If Nz(ComboReports, \"\") &lt;&gt; \"\" And Nz(ComboReports, \"\") &lt;&gt; \"Select Report\" Then\n        DoCmd.OpenReport ComboReports, acViewPreview, acWindowNormal\n   Else\n     MsgBox (\"You Must First Select a Report To Open!\")\n     ComboReports.SetFocus\n   End If\n   ComboReports = \"\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 0, "last_activity_date": 1547671010, "creation_date": 1547671010, "answer_id": 54224980, "question_id": 54220073, "link": "https://stackoverflow.com/questions/54220073/what-is-proper-code-to-add-a-default-value-in-combo-box/54224980#54224980", "title": "What is proper code to add a Default value in Combo Box?", "body": "<p>You problem is that you are trying to assign a default value to your comb box that does not belong to the its value set.</p>\n\n<p>If your <code>RowSource</code> is</p>\n\n<pre><code>SELECT MsysObjects.Name FROM MsysObjects WHERE (((Left$([Name],1))&lt;&gt;\"~\") AND ((MsysObjects.Type)=-32764)) ORDER BY MsysObjects.Name\n</code></pre>\n\n<p>try using this for <code>RowSource</code></p>\n\n<pre><code>SELECT Name FROM MsysObjects WHERE Left(Name,1)&lt;&gt;'~' AND Type=-32764\nUNION\nSELECT ' Select Report' AS Name\nORDER BY Name\n</code></pre>\n\n<p>The space in ' Select Report' is intentional to push it to the top of the order.</p>\n"}], "owner": {"reputation": 23, "user_id": 10923135, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wuHaD4WRwkM/AAAAAAAAAAI/AAAAAAAAGb4/I3XDbq3kfIU/photo.jpg?sz=128", "display_name": "Jerry ", "link": "https://stackoverflow.com/users/10923135/jerry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 54221165, "answer_count": 2, "score": 1, "last_activity_date": 1547671010, "creation_date": 1547651621, "last_edit_date": 1547655649, "question_id": 54220073, "link": "https://stackoverflow.com/questions/54220073/what-is-proper-code-to-add-a-default-value-in-combo-box", "title": "What is proper code to add a Default value in Combo Box?", "body": "<p>While my current code works to open an report If i enter a value into the Default of the Combo Box it thinks it is a report to open. Current code...</p>\n\n<pre><code>Private Sub Command531_Click()\n   If Not IsNull(ComboReports) And ComboReports &lt;&gt; \"\" Then\nDoCmd.OpenReport ComboReports, acViewPreview, acWindowNormal\n   Else\n     MsgBox (\"You Must First Select a Report To Open!\")\n     ComboReports.SetFocus\n   End If\n   ComboReports = \"\"\nEnd Sub\n</code></pre>\n\n<p>I would like to have \"Select Report\" as the default value in the Combo box. What am I doing Wrong?? </p>\n\n<p>Thanks in Advance,\nJerry</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1547654540, "post_id": 54220071, "comment_id": 95267581, "body": "What exactly is your stumbling block? Looks like you know how to copy between sheets. As an aside, I suggest you read this <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 10775569, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eLayO2t4lDw/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jHcSOVKKwy_VTqJslbkEJzSTS_3w/mo/photo.jpg?sz=128", "display_name": "Liz H", "link": "https://stackoverflow.com/users/10775569/liz-h"}, "edited": false, "score": 0, "creation_date": 1548072597, "post_id": 54227219, "comment_id": 95400034, "body": "Hi Tim, this looks great. There&#39;s just a few things I can&#39;t get to work. When I try to run the macro, the debugger says that the line &quot;.Offset(1, 0) = workOrderDescription&quot;, the variable isn&#39;t defined? Is there a line I need to add to define workOrderDescription? And should add &quot;.Row&quot; to the end of &quot;wsSplits.Cells(Rows.Count, &quot;A&quot;).End(xlUp)&quot;. Also, the autofilter code was in case somebody else had filtered the sheet before you copied things onto it, to remove the filter so nothing got overwritten. Is this not necessary? Thanks so much for all your help; sorry to load you with more questions!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 147, "user_id": 10775569, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eLayO2t4lDw/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jHcSOVKKwy_VTqJslbkEJzSTS_3w/mo/photo.jpg?sz=128", "display_name": "Liz H", "link": "https://stackoverflow.com/users/10775569/liz-h"}, "edited": false, "score": 0, "creation_date": 1548086244, "post_id": 54227219, "comment_id": 95407680, "body": "<code>workOrderDescription</code> is from your original code - I don&#39;t know where it&#39;s from.  Do not add <code>.Row</code>.  I left out the autofilter code to shorten my example - sorry I was not suggesting you delete it."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1547683507, "creation_date": 1547683507, "answer_id": 54227219, "question_id": 54220071, "link": "https://stackoverflow.com/questions/54220071/userform-enters-data-into-a-separate-worksheet-how-do-i-make-it-then-extrapolat/54227219#54227219", "title": "Userform enters data into a separate worksheet. How do I make it then extrapolate that data to another worksheet, on two new rows?", "body": "<p>You can do something like this:</p>\n\n<pre><code>Option Explicit\n\nDim originalRow As Range\n\nPrivate Sub UserForm_Initialize()\n    Set originalRow = ActiveCell.EntireRow '&lt;&lt; store this row in a global variable\n    With Me\n        .OriginalTourCode.Value = originalRow.Cells(1).Value\n        .OriginalStartDate.Value = originalRow.Cells(2).Value\n        .OriginalEndDate.Value = originalRow.Cells(3).Value\n    End With\nEnd Sub\n\nPrivate Sub SplitTourCommand_Click()\n\n    Dim ctrl As Control\n    Dim wsSplits As Worksheet\n    Set wsSplits = Sheets(\"Splits\")\n    Dim wsTours As Worksheet\n    Set wsTours = Sheets(\"Final Tours\")\n    Dim WSheet As Variant\n    Dim DTable As Variant, RowCount As Long\n\n    'snipped autofilter code...\n\n    With wsSplits.Cells(Rows.Count, \"A\").End(xlUp)\n        .Offset(1, 0) = workOrderDescription\n        With .Offset(2, 0).EntireRow\n            .Cells(1) = OriginalTourCode.Text\n            .Cells(2) = OriginalStartDate.Text\n            .Cells(3) = OriginalEndDate.Text\n            'etc etc for the other cells\n        End With\n    End With\n\n    'no need to copy from the Splits sheet since you have the data\n    ' in the form fields\n    With wsTours.Cells(Rows.Count, \"A\").End(xlUp)\n        .Offset(1, 0).Value = NewTourCode1.Text\n        .Offset(1, 1).Value = NewStartDate1.Text\n        .Offset(1, 2).Value = NewEndDate1.Text\n        .Offset(2, 0).Value = NewTourCode2.Text\n        .Offset(2, 1).Value = NewStartDate2.Text\n        .Offset(2, 2).Value = NewEndDate2.Text\n    End With\n\n    originalRow.Delete 'remove the row the the split tour\n\n    MsgBox \"Tour \" &amp; ws.Cells(ActiveCell.Row, \"A\").Value &amp; _\n      \" has been split to \" &amp; ws.Cells(ActiveCell.Row, \"D\").Value &amp; _\n      \" and \" &amp; ws.Cells(ActiveCell.Row, \"G\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 10775569, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eLayO2t4lDw/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jHcSOVKKwy_VTqJslbkEJzSTS_3w/mo/photo.jpg?sz=128", "display_name": "Liz H", "link": "https://stackoverflow.com/users/10775569/liz-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548094091, "creation_date": 1547651610, "last_edit_date": 1548094091, "question_id": 54220071, "link": "https://stackoverflow.com/questions/54220071/userform-enters-data-into-a-separate-worksheet-how-do-i-make-it-then-extrapolat", "title": "Userform enters data into a separate worksheet. How do I make it then extrapolate that data to another worksheet, on two new rows?", "body": "<p>I've created a UserForm which opens when I select a command button. The purpose of it is to capture data from a selected row concerning a \"tour\" - i.e. the tour code, start date and end date, and then for me to \"split\" the tour, for which I need to enter new tour codes, start dates and end dates.</p>\n\n<p>The data from the form goes into a separate sheet (called \"splits\"), so that I have a record of the original tour details, and the new tour details in one sheet. The data is laid out as follows:</p>\n\n<p>[A] Original tour code | [B] Original start date | [C] Original end date | [D] New tour code 1 | [E] New start date 1 | [F] New end date 1 | [G] New tour code 2 | [H] New start date 2 | [I] New end date 2 | [J] Reason for split</p>\n\n<p>So the userform inserts all the data into these columns - this works fine, and I'm happy with it.</p>\n\n<p>I'm trying to then make it then copy the details of the new tours onto the bottom two rows of the original worksheet (\"Final tours\"), and delete the old tour details from this sheet. But I don't know how to make it copy the new tour details (so D:F and G:H on the \"Splits\" sheet), and then delete the original row?</p>\n\n<p>This is my code at the moment:</p>\n\n<pre><code>Object Explicit\n\n    Dim originalRow As Range\n\nPrivate Sub UserForm_Initialize()\n    Set originalRow = ActiveCell.EntireRow\n    With Me\n        .OriginalTourCode.Value = originalRow.Cells(1).Value\n        .OriginalStartDate.Value = originalRow.Cells(2).Value\n        .OriginalEndDate.Value = originalRow.Cells(3).Value\n    End With\nEnd Sub\n\nPrivate Sub SplitTourCommand_Click()\n\n    Dim ctrl As Control\n    Dim wsSplits As Worksheet\n    Set wsSplits = Sheets(\"Splits\")\n    Dim wsTours As Worksheet\n    Set wsTours = Sheets(\"Final Tours\")\n    Dim WSheet As Variant\n    Dim DTable As Variant, RowCount As Long\n\n Application.ActiveWorkbook.Save\n\n    For Each WSheet In ActiveWorkbook.Worksheets\n        If wsTours.AutoFilterMode Then\n            If wsTours.FilterMode Then\n                wsTours.ShowAllData\n            End If\n        End If\n        For Each DTable In wsTours.ListObjects\n            If DTable.ShowAutoFilter Then\n                DTable.Range.AutoFilter\n                DTable.Range.AutoFilter\n            End If\n        Next DTable\n    Next WSheet\n\n    With wsSplits.Cells(Rows.Count, \"A\").End(xlUp).Row\n        With .Offset(2, 0).EntireRow.Row\n            .Cells(1) = OriginalTourCode.Text\n            .Cells(2) = OriginalStartDate.Text\n            .Cells(3) = OriginalEndDate.Text\n            .Cells(4) = NewTourCode1.Text\n   .Cells(5) = NewStartDate1.Text\n    .Cells(6) = NewEndDate1.Text\n    .Cells(7) = NewTourCode2.Text\n    .Cells(8) = NewStartDate2.Text\n    .Cells(9) = NewEndDate2.Text\n    .Cells(10) = ReasonForSplit.Text\n    .Cells(11).Value = Date\n\n        End With\n    End With\n\n    'no need to copy from the Splits sheet since you have the data\n    ' in the form fields\n    With wsTours.Cells(Rows.Count, \"A\").End(xlUp)\n        .Offset(1, 0).Value = NewTourCode1.Text\n        .Offset(1, 1).Value = NewStartDate1.Text\n        .Offset(1, 2).Value = NewEndDate1.Text\n        .Offset(2, 0).Value = NewTourCode2.Text\n        .Offset(2, 1).Value = NewStartDate2.Text\n        .Offset(2, 2).Value = NewEndDate2.Text\n    End With\n\n    originalRow.Delete 'remove the row the the split tour\n\n    MsgBox \"Tour \" &amp; wsSplits.Cells(ActiveCell.Row, \"A\").Value &amp; _\n      \" has been split to \" &amp; wsSplits.Cells(ActiveCell.Row, \"D\").Value &amp; _\n      \" and \" &amp; wsSplits.Cells(ActiveCell.Row, \"G\")\n\nEnd Sub\n\n\nPrivate Sub CloseCommand_Click()\n\nUnload Me\n\nEnd Sub\n</code></pre>\n\n<p>Any thoughts? All help much appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1547653429, "post_id": 54220056, "comment_id": 95266882, "body": "<code>Sheets(&quot;Sheet2&quot;).Cells(j, 1).Interior.Color = Sheets(&quot;Sheet1&quot;).Cells(i, 1).Interior.Color</code>?"}, {"owner": {"reputation": 43, "user_id": 7571785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jyq8d.jpg?s=128&g=1", "display_name": "zgivod", "link": "https://stackoverflow.com/users/7571785/zgivod"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1547660864, "post_id": 54220056, "comment_id": 95271042, "body": "no doesn&#39;t work still comes up as black"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1547661212, "post_id": 54220056, "comment_id": 95271204, "body": "I misunderstood, I thought you wanted to keep the cell&#39;s colour, not the font&#39;text&#39;s colour. Try: <code>Sheets(&quot;Sheet2&quot;).Cells(j, 1).Font.Color = Sheets(&quot;Sheet1&quot;).Cells(i, 1).Font.Color</code> (note this will only work if all the text has the same colour)"}, {"owner": {"reputation": 43, "user_id": 7571785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jyq8d.jpg?s=128&g=1", "display_name": "zgivod", "link": "https://stackoverflow.com/users/7571785/zgivod"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1547663252, "post_id": 54220056, "comment_id": 95272240, "body": "thanks and if all the text is not the same color?"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1547663425, "post_id": 54220056, "comment_id": 95272316, "body": "It might be easier to get the format of the cell in Sheet2, copy the cell from sheet1into it, then apply the original formatting back on it."}, {"owner": {"reputation": 43, "user_id": 7571785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jyq8d.jpg?s=128&g=1", "display_name": "zgivod", "link": "https://stackoverflow.com/users/7571785/zgivod"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1547663699, "post_id": 54220056, "comment_id": 95272427, "body": "never mind it works. as long as each cell is one color but a1 and a2 can be diffrent colors. thanks"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1547663770, "post_id": 54220056, "comment_id": 95272452, "body": "Yes, by &quot;note this will only work if all the text has the same colour&quot; I mean &quot;note this will only work if all the text <b>in a given cell</b> has the same colour&quot;. I&#39;ll post this as an answer"}], "answers": [{"tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": true, "score": 1, "last_activity_date": 1547663887, "creation_date": 1547663887, "answer_id": 54223320, "question_id": 54220056, "link": "https://stackoverflow.com/questions/54220056/vba-paste-sheet1-values-and-keep-original-source-color-but-not-font-and-other-fo/54223320#54223320", "title": "vba paste sheet1 values and keep original source color but not font and other formats...?", "body": "<p>You can also have VBA apply the formatting to the cell:</p>\n\n<pre><code>Sub Transfer_Data()\n\n\nDim i As Long, j As Long\n\nj = 1\n\nFor i = 1 To 6\n    If Sheets(\"Sheet1\").Cells(i, 1).Value &lt;&gt; \"\" Then\n        Sheets(\"Sheet2\").Cells(j, 1).Value = Sheets(\"Sheet1\").Cells(i, 1).Value\n        Sheets(\"Sheet2\").Cells(j, 1).Font.Color = Sheets(\"Sheet1\").Cells(i, 1).Font.Color\n        j = j + 1\n    End If\n\nIf j &gt; 3 Then Exit For\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Note that this will only work if all the text in a given cell has the same colour</p>\n"}], "owner": {"reputation": 43, "user_id": 7571785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jyq8d.jpg?s=128&g=1", "display_name": "zgivod", "link": "https://stackoverflow.com/users/7571785/zgivod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 54223320, "answer_count": 1, "score": 0, "last_activity_date": 1547663887, "creation_date": 1547651579, "last_edit_date": 1547652238, "question_id": 54220056, "link": "https://stackoverflow.com/questions/54220056/vba-paste-sheet1-values-and-keep-original-source-color-but-not-font-and-other-fo", "title": "vba paste sheet1 values and keep original source color but not font and other formats...?", "body": "<p>I have up to 6 cells with potential data coming from 6 different places. I am trying to get only the first three cells with data transferred to another sheet WITH THE ORIGINAL SHEET1 COLOR but not FORMAT</p>\n\n<pre><code> Sub Transfer_Data()\n\n\nDim i As Long, j As Long\n\nj = 1\n\nFor i = 1 To 6\n    If Sheets(\"Sheet1\").Cells(i, 1).Value &lt;&gt; \"\" Then\n        Sheets(\"Sheet2\").Cells(j, 1).Value = Sheets(\"Sheet1\").Cells(i, 1).Value\n        j = j + 1\n    End If\n\nIf j &gt; 3 Then Exit For\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>what happens is it displays the sheet2 format and color when im trying to keep sheet1.\ni tried this also but its keeping sheet1 formats.....</p>\n\n<pre><code>Sub Transfer_Data()\n\nDim i As Long, j As Long\n\nj = 1\n\nFor i = 1 To 6\n    If Sheets(\"Sheet1\").Cells(i, 1).Value &lt;&gt; \"\" Then\n        Sheets(\"Sheet1\").Cells(i, 1).Copy\n        Sheets(\"Sheet2\").Cells(j, 1).PasteSpecial xlPasteFormats\n        Sheets(\"Sheet2\").Cells(j, 1).PasteSpecial xlPasteValues\n        j = j + 1\n    End If\n\nIf j &gt; 3 Then Exit For\nNext i\nApplication.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1547650615, "post_id": 54219683, "comment_id": 95265165, "body": "Loop columns and then nest a row loop. You can use <code>Offset</code> to move columns over on the same row to refer to other cells."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1547650619, "post_id": 54219683, "comment_id": 95265168, "body": "I wonder if named ranges would assist or not. I havent tried it but maybe you could look into it"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1547650997, "post_id": 54219683, "comment_id": 95265431, "body": "check this out <a href=\"https://stackoverflow.com/questions/13039437/loop-through-cells-in-named-range\" title=\"loop through cells in named range\">stackoverflow.com/questions/13039437/&hellip;</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1547651658, "post_id": 54219683, "comment_id": 95265837, "body": "Please <a href=\"https://stackoverflow.com/posts/54219683/edit\">edit</a> your post to include your <code>For Each</code> loop... and describe the shape of the range being iterated, or include a screenshot."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1547654815, "last_edit_date": 1547654815, "creation_date": 1547653207, "answer_id": 54220530, "question_id": 54219683, "link": "https://stackoverflow.com/questions/54219683/non-contiguous-for-each-loop-per-row-instead-of-column/54220530#54220530", "title": "Non-contiguous For Each loop per row instead of column", "body": "<p>The order in which a <code>For Each</code> iterates an object collection is implementation-dependent (IOW blame Excel, not VBA) and, while likely deterministic &amp; predictable, there is nothing in its specification that guarantees a specific iteration order. So VBA code written to iterate an object collection, should not be written with the assumption of a specific iteration order, since that's something that can very well change between versions of the type library involved (here Excel's).</p>\n\n<p>It's very unclear what the shape of your <code>Range</code> / <code>Selection</code> is, but if you need to iterate the selected cells in a specific order, then a <code>For Each</code> loop should not be used, at least not for iterating the cells per se.</p>\n\n<p>Since the ranges are not contiguous, the <code>Range</code> will have multiple <code>Areas</code>; you'll want to iterate the <code>Selection.Areas</code>, and <em>for each</em> selected area, iterate the cells in a particular order. <code>For Each</code> is, by far, the <a href=\"https://analystcave.com/vba-for-loop-vs-for-each-loop/\" rel=\"nofollow noreferrer\">most efficient way to iterate an object collection</a>, which <code>Range.Areas</code> is.</p>\n\n<pre><code>Debug.Assert TypeOf Selection Is Excel.Range\n\nDim currentArea As Range\nFor Each currentArea In Selection.Areas\n    'todo\nNext\n</code></pre>\n\n<p>Instead of <a href=\"https://blog.codinghorror.com/flattening-arrow-code/\" rel=\"nofollow noreferrer\">nesting the loops</a>, make a separate procedure that takes the <code>currentArea</code> as a parameter - that procedure is where you'll be iterating the individual cells:</p>\n\n<pre><code>Private Sub ProcessContiguousArea(ByVal area As Range)\n    Dim currentRow As Long\n    For currentRow = 1 To area.Rows.Count\n        Debug.Print area.Cells(currentRow, 1).Address\n    Next\nEnd Sub\n</code></pre>\n\n<p>Now the outer loop looks like this:</p>\n\n<pre><code>Debug.Assert TypeOf Selection Is Excel.Range\n\nDim currentArea As Range\nFor Each currentArea In Selection.Areas\n    ProcessContiguousArea currentArea\nNext\n</code></pre>\n\n<p>The <code>ProcessContiguousArea</code> procedure is free to do whatever it needs to do with a given contiguous area, using a <code>For</code> loop to iterate the range by rows, without needing to care for the actual address of the selected area: using <code>Range.Cells(RowIndex, ColumnIndex)</code>, row 1 / column 1 represents the top-left cell of that range, regardless of where that range is located in the worksheet.</p>\n\n<p>Non-selected cells can be accessed with <code>Range.Offset</code>:</p>\n\n<pre><code>        Debug.Print area.Cells(currentRow, 1).Offset(ColumnOffset:=10).Address\n</code></pre>\n\n<p>The top-left cell's row of the <code>area</code> on the worksheet is returned by <code>area.Row</code>, and the top-left cell's column of the <code>area</code> on the worksheet is retrieved with <code>area.Column</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1547654663, "post_id": 54220583, "comment_id": 95267649, "body": "I&#39;m very tempted to upvote, for this is a very similar approach to mine (key being <code>Selection.Areas</code>, missed by the other answer), however triple-nested loops and repetitive dereferencing of the <code>.Areas(k)</code> reference, combined with the poor variable names and confusing data types used (there&#39;s not really any reason to use <code>Integer</code> anywhere other than in Win32 API calls that require it), are holding me back. <code>For</code> loop iterating the areas is a missed opportunity: a <code>For Each</code> would dereference the current area only once per iteration, vs. 6 times here. Also the type of <code>Selection</code> is assumed."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1547656837, "post_id": 54220583, "comment_id": 95268911, "body": "@Mathieu Guindon: Believe it or not, I have no clue what you&#39;re talking about. I am recognizing the following issues you&#39;re addressing: &#39;Repetitive Dereferencing&#39; (probably connected to For Each), &#39;Integer Anywhere&#39; and &#39;Type of Selection&#39;. I would appreciate any clarification or links to them."}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1547657284, "post_id": 54220583, "comment_id": 95269179, "body": "Though I understand why i, j, and k are &quot;poor variable names,&quot; I just wanted to say that I (also) use those all the time in nested loops. It makes sense to me to iterate through matrices of data with single-letter variables as it&#39;s reminiscent of linear algebra. Just my take."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 1, "creation_date": 1547657905, "post_id": 54220583, "comment_id": 95269519, "body": "There&#39;s an old, excellent <i>Coding Horror</i> <a href=\"https://blog.codinghorror.com/flattening-arrow-code/\" rel=\"nofollow noreferrer\">article</a> about &quot;arrow code&quot; that does a better job than I ever could at explaining how nested structures can be &quot;flattened&quot;. @MBB70 we&#39;re all guilty ;-)  ...I just wish VBA answers on SO upped the bar a bit, so that online references for VBA (esp. for newcomers) illustrate better code than what the &quot;<a href=\"https://insights.stackoverflow.com/survey/2018/#technology-most-loved-dreaded-and-wanted-languages\" rel=\"nofollow noreferrer\">VBA sucks</a>&quot; trope wants us to believe VBA code looks like (I know, wishful thinking)."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1547658163, "post_id": 54220583, "comment_id": 95269669, "body": "Also <a href=\"https://stackoverflow.com/a/26409520/1188513\">Integer vs Long</a>. As for multiple/repetitive dereferencing, the <code>With .Areas(k)</code> block that was added is correctly addressing it, although at the expense of increased nesting. What I meant about the type of <code>Selection</code>, is that if the code is executed while the <code>Selection</code> is a <code>Chart</code> or some <code>Shape</code>, then <code>.Areas</code> will throw error 438, for member calls against <code>Selection</code> are resolved at run-time (since it&#39;s <code>Variant&#47;Object</code>); assigning it to a <code>Range</code>, or <code>Debug.Assert</code>ing its type, eliminates the assumption. Anyway, upvoted now :)"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1547662039, "post_id": 54220583, "comment_id": 95271625, "body": "@Mathieu Guindon: Many thanks for the extensive help (resources). Referring to <b>Integer vs Long</b>: Feels like I&#39;ve been living under a rock. But the problem is that a large percentage of my posts contain integers. I guess I&#39;ll have to do some serious editing. A funny thing is that years ago, I read a similar article: <b>Byte vs Integer</b>."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 1, "last_activity_date": 1547661051, "last_edit_date": 1547661051, "creation_date": 1547653373, "answer_id": 54220583, "question_id": 54219683, "link": "https://stackoverflow.com/questions/54219683/non-contiguous-for-each-loop-per-row-instead-of-column/54220583#54220583", "title": "Non-contiguous For Each loop per row instead of column", "body": "<h1>Non-Contiguous</h1>\n\n<p>By looping through the <strong>rows first</strong> (<strong>i</strong>), you will get the '<strong>By Row sequence</strong>' e.g.  A1,B1,C1, ...</p>\n\n<h2>The Code</h2>\n\n<pre><code>Sub NonContiguous()\n\n    Dim i As Long\n    Dim j As Long\n    Dim k As Long\n\n    With Selection\n        For k = 1 To .Areas.Count\n            With .Areas(k)\n                For i = .Row To .Rows.Count + .Row - 1\n                     For j = .Column To .Columns.Count + .Column - 1\n\n                         Debug.Print .Parent.Cells(i, j).Address &amp; \" = \" _\n                                 &amp; .Parent.Cells(i, j)\n\n                     Next\n                Next\n            End With\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1547655475, "creation_date": 1547655475, "answer_id": 54221169, "question_id": 54219683, "link": "https://stackoverflow.com/questions/54219683/non-contiguous-for-each-loop-per-row-instead-of-column/54221169#54221169", "title": "Non-contiguous For Each loop per row instead of column", "body": "<p>This is based on urdearboy's suggestion:<br><br>\n1. loop over columns<br>\n2. within a column, loop over cells<br></p>\n\n<pre><code>Sub disjoint()\n    Dim r As Range, rInt As Range\n    Dim nLastColumn As Long\n    Dim nFirstColumn As Long, msg As String\n    Dim N As Long\n\n    Set r = Range(\"C3,C9,E6,E13,E15,G1,G2,G3,G4\")\n\n    nFirstColumn = Columns.Count\n    nLastColumn = 0\n    msg = \"\"\n\n    For Each rr In r\n        N = rr.Column\n        If N &lt; nFirstColumn Then nFirstColumn = N\n        If N &gt; nLastColumn Then nLastColumn = N\n    Next rr\n\n    For N = nFirstColumn To nLastColumn\n        Set rInt = Intersect(Columns(N), r)\n        If rInt Is Nothing Then\n        Else\n            For Each rr In rInt\n                msg = msg &amp; vbCrLf &amp; rr.Address(0, 0)\n            Next rr\n        End If\n    Next N\n    MsgBox msg\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/O60WI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O60WI.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 53, "user_id": 10923044, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WXajMmSu9R4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYTs8YTUyssy-h0TSk5_11ncpp7Dg/mo/photo.jpg?sz=128", "display_name": "Alan Beavers", "link": "https://stackoverflow.com/users/10923044/alan-beavers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 1, "accepted_answer_id": 54221169, "answer_count": 3, "score": 5, "last_activity_date": 1547731788, "creation_date": 1547650379, "last_edit_date": 1547716587, "question_id": 54219683, "link": "https://stackoverflow.com/questions/54219683/non-contiguous-for-each-loop-per-row-instead-of-column", "title": "Non-contiguous For Each loop per row instead of column", "body": "<p>I have a non-contiguous selection spanning rows and columns, and I want to do a For Each loop on it. Excel VBA does this by looping firstly down column 1, then 2,3 etc.; but I want it to loop along the row first instead.</p>\n\n<p>(My sheet looks something like the picture below, I need to loop down the selection (version) each column in turn, and retrieve the Doc. No. and other information. The number of rows and version columns in the sheet is not fixed).</p>\n\n<p>Short of writing a fairly large Sort function and creating an array of references, I was wondering if there was a 'built-in' way to do this?</p>\n\n<p>I don't need code, just an explanation.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Nug9z.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Nug9z.jpg\" alt=\"Non-contiguous selection\"></a></p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 3649, "user_id": 10404329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/489c51b790b37922d4e80d59b9873cec?s=128&d=identicon&r=PG", "display_name": "Corion", "link": "https://stackoverflow.com/users/10404329/corion"}, "edited": false, "score": 1, "creation_date": 1547649190, "post_id": 54219252, "comment_id": 95264240, "body": "<code>#9&#47;23&#47;2020#</code> is not valid SQL."}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 1, "creation_date": 1547649312, "post_id": 54219252, "comment_id": 95264335, "body": "Take the SQL over to SSMS and try to submit it directly to your SQL Server instance. You should get better diagnostics."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10891568"}, "reply_to_user": {"reputation": 3649, "user_id": 10404329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/489c51b790b37922d4e80d59b9873cec?s=128&d=identicon&r=PG", "display_name": "Corion", "link": "https://stackoverflow.com/users/10404329/corion"}, "edited": false, "score": 0, "creation_date": 1547649442, "post_id": 54219252, "comment_id": 95264416, "body": "@Corion what is the proper way to submit the date ? Instead of using &quot; # &quot; ?"}, {"owner": {"reputation": 3649, "user_id": 10404329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/489c51b790b37922d4e80d59b9873cec?s=128&d=identicon&r=PG", "display_name": "Corion", "link": "https://stackoverflow.com/users/10404329/corion"}, "edited": false, "score": 0, "creation_date": 1547649492, "post_id": 54219252, "comment_id": 95264462, "body": "Most likely <code>&#39;2020-09-23&#39;</code>, but that depends on your database settings."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10891568"}, "edited": false, "score": 0, "creation_date": 1547649737, "post_id": 54219252, "comment_id": 95264625, "body": "Here&#39;s what doesn&#39;t make sense to me, why do these queries work in Create &gt; Query ?"}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 1, "creation_date": 1547649859, "post_id": 54219252, "comment_id": 95264698, "body": "When run through the query window Access will use it&#39;s interpreter to handle the dates the correct way, when invoked in VBA you are passing the query directly to the ODBC connection which doesn&#39;t understand the Access syntax."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10891568"}, "reply_to_user": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1547651730, "post_id": 54219252, "comment_id": 95265877, "body": "@Minty I see, I can\u2019t seem to find how QODBC wants the dates formatted"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10891568"}, "edited": false, "score": 0, "creation_date": 1547653421, "post_id": 54219252, "comment_id": 95266879, "body": "Please take a look at my update"}, {"owner": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "reply_to_user": {"reputation": 3649, "user_id": 10404329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/489c51b790b37922d4e80d59b9873cec?s=128&d=identicon&r=PG", "display_name": "Corion", "link": "https://stackoverflow.com/users/10404329/corion"}, "edited": false, "score": 1, "creation_date": 1547654035, "post_id": 54219252, "comment_id": 95267260, "body": "@Corion #9/23/2020# is correct ACCESS SQL usage for dates. The use of &quot;# # &quot; is how you indicate dates in Access."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10891568"}, "reply_to_user": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "edited": false, "score": 0, "creation_date": 1547654173, "post_id": 54219252, "comment_id": 95267330, "body": "@Karlomanio Yes its the right Access SQL usage but the wrong syntax  for QODBC"}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1547654180, "post_id": 54219252, "comment_id": 95267334, "body": "Can you link to the Quickbooks tables? If so what data type does access think the date columns are? They maybe text bizarrely. Accounts packages are weird..."}, {"owner": {"reputation": 3649, "user_id": 10404329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/489c51b790b37922d4e80d59b9873cec?s=128&d=identicon&r=PG", "display_name": "Corion", "link": "https://stackoverflow.com/users/10404329/corion"}, "edited": false, "score": 0, "creation_date": 1547654456, "post_id": 54219252, "comment_id": 95267519, "body": "Did you use single quotes around your date attempts? <code>&#39;01-10-2005&#39;</code>, not <code>01-10-2005</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10891568"}, "edited": false, "score": 0, "creation_date": 1547654666, "post_id": 54219252, "comment_id": 95267653, "body": "I looked in the linked table for invoice and the column for txnDate just shows the &quot; mm/dd/yyyy &quot; format"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10891568"}, "reply_to_user": {"reputation": 3649, "user_id": 10404329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/489c51b790b37922d4e80d59b9873cec?s=128&d=identicon&r=PG", "display_name": "Corion", "link": "https://stackoverflow.com/users/10404329/corion"}, "edited": false, "score": 0, "creation_date": 1547654693, "post_id": 54219252, "comment_id": 95267671, "body": "@Corion Yes single quotes"}, {"owner": {"reputation": 31833, "user_id": 23574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff71c4381eaf3816bffda6c6fe53d33e?s=128&d=identicon&r=PG", "display_name": "shahkalpesh", "link": "https://stackoverflow.com/users/23574/shahkalpesh"}, "edited": false, "score": 0, "creation_date": 1547655617, "post_id": 54219252, "comment_id": 95268187, "body": "While I dont have any clue of qodbc, if you dont have all the fields as required, try running a minimal insert statements living other fields as null and add fields to the statement one by one to see what field is causing the problem? Is <code>memo</code> a reserved word?"}], "answers": [{"comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1547656642, "post_id": 54221159, "comment_id": 95268796, "body": "Simply use <code>Format</code>: <code>Format(Now(), &quot;YYYY-MM-DD&quot;)</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10891568"}, "edited": false, "score": 0, "creation_date": 1547656718, "post_id": 54221159, "comment_id": 95268836, "body": "I just tried to submit the date as , {d&#39;2005-09-23&#39;},"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10891568"}, "edited": false, "score": 0, "creation_date": 1547656741, "post_id": 54221159, "comment_id": 95268853, "body": "Still no luck, same issue"}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 1, "creation_date": 1547657050, "post_id": 54221159, "comment_id": 95269034, "body": "Note there is a space between the d and the &#39;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10891568"}, "edited": false, "score": 0, "creation_date": 1547657598, "post_id": 54221159, "comment_id": 95269333, "body": "The problem is still the same, but quick side question, is it correct to have two separate sSQL = &quot; &quot; query statements for queries that are related? Or could have the two query statements under the same sSQL= &quot; &quot; ?"}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1547657739, "post_id": 54221159, "comment_id": 95269425, "body": "No you are inserting data into two separate tables, so that requires two queries."}], "tags": [], "owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "is_accepted": false, "score": 1, "last_activity_date": 1547655751, "last_edit_date": 1547655751, "creation_date": 1547655432, "answer_id": 54221159, "question_id": 54219252, "link": "https://stackoverflow.com/questions/54219252/why-does-this-sql-query-work-in-query-designer-but-not-in-vba-for-access/54221159#54221159", "title": "Why does this SQL query work in query designer but not in VBA for Access?", "body": "<p>Have a read here <a href=\"https://support.flexquarters.com/esupport/index.php?/Knowledgebase/Article/View/2638/44/qodbc-desktop-troubleshooting---how-to-use-date-and-dateadd-function-in-qodbc\" rel=\"nofollow noreferrer\">https://support.flexquarters.com/esupport/index.php?/Knowledgebase/Article/View/2638/44/qodbc-desktop-troubleshooting---how-to-use-date-and-dateadd-function-in-qodbc</a> </p>\n\n<p>The correct format appears to be {d 'YYYY-MM-DD'} \nThere is a function provided to make a date the correct string;</p>\n\n<p>Function: </p>\n\n<pre><code>Function fncqbDate(myDate As Date) As String\nmyDate = Nz(myDate, Now)\nfncqbDate = \"{d '\" &amp; Year(myDate) &amp; \"-\" &amp; Right(\"00\" &amp; Month(myDate), 2) &amp; \"-\" &amp; Right(\"00\" &amp; Day(myDate), 2) &amp; \"'}\"\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10891568"}, "edited": false, "score": 0, "creation_date": 1547661907, "post_id": 54222428, "comment_id": 95271560, "body": "Ok so I tried your code right under &quot;Quickbooks ODBC&quot; it seemed to work because now I get a different error: [QODBC] Not supported - At least one Line record is required. Please insert Child/Detail record(s) before inserting Parent/Header record. For more details please visit:godbc.comilinks/2953 &quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10891568"}, "edited": false, "score": 0, "creation_date": 1547661999, "post_id": 54222428, "comment_id": 95271611, "body": "The issue is that InvoiceLine, the first piece of code I posted is the child its looking for"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10891568"}, "edited": false, "score": 0, "creation_date": 1547662081, "post_id": 54222428, "comment_id": 95271648, "body": "I know for a fact that both should work because once again it did in Query Designer"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1547665393, "post_id": 54222428, "comment_id": 95273209, "body": "Usually, the parent table rows are inserted before related children as this appears to be a relationships issue in Quickbooks. Did you go to their url: <a href=\"https://support.flexquarters.com/esupport/index.php?/Knowledgebase/Article/View/2953/\" rel=\"nofollow noreferrer\">support.flexquarters.com/esupport/index.php?/Knowledgebase/&hellip;</a>&zwnj;&#8203;? Like the Query Designer runs, you will also need to run both append queries but think carefully the order. Possibly too this query relates to other tables like <i>Customer</i> (which should exist prior to <i>Invoice</i>). Even more, your earlier test runs may invalidate next test runs since keys may need to be unique. Try testing on new invoice example."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10891568"}, "edited": false, "score": 0, "creation_date": 1547667620, "post_id": 54222428, "comment_id": 95274225, "body": "It should just append itself once the first query runs, right?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1547735527, "post_id": 54222428, "comment_id": 95300770, "body": "Unless Quickbooks has triggers set in place for the two tables to connect then yes. Nonetheless, your immediate issue of queries not working should be resolved, right? <i>I know for a fact that both should work because once again it did in Query Designer</i> ... once again, you used a <i>different</i> engine to make the <i>same</i> SQL command and SQL dialects differ in engines (German &lt;&gt; English even if both say the same thing!). The beauty of parameterization is no matter what the data types or database, you abstract away dialect specific escapes or formatting. Please consider the last option."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 1, "last_activity_date": 1547660025, "creation_date": 1547660025, "answer_id": 54222428, "question_id": 54219252, "link": "https://stackoverflow.com/questions/54219252/why-does-this-sql-query-work-in-query-designer-but-not-in-vba-for-access/54222428#54222428", "title": "Why does this SQL query work in query designer but not in VBA for Access?", "body": "<p>As @Minty commented and posted, your dates are the issue. </p>\n\n<ul>\n<li>When running queries inside the MS Access GUI such as with Query Designer, you are governed to the Access SQL dialect. </li>\n<li>When connecting via ODBC driver to an external database, you are governed to the connecting database's SQL dialect, here being Quickbooks. </li>\n</ul>\n\n<p>No two SQL dialects are ever the same but most attempt to conform to ANSI standards. Therefore, the same queries <em>can</em> fail between Query Designer and VBA.</p>\n\n<h2>MS Access</h2>\n\n<p>MS Access dates if sent literally, should be encapsulated with hashtags, <code>#</code>:</p>\n\n\n\n<pre class=\"lang-sql prettyprint-override\"><code>INSERT INTO Invoice (CustomerRefListID, ARAccountRefListID, TxnDate, RefNumber,\n                     BillAddressAddr1, BillAddressAddr2, BillAddressCity, BillAddressState, \n                     BillAddressPostalCode, BillAddressCountry, IsPending, TermsRefListID, \n                     DueDate, ShipDate, ItemSalesTaxRefListID, [Memo], IsToBePrinted, \n                     CustomerSalesTaxCodeRefListID) \nVALUES ('800001F6-1482536280', '8000001E-1478562986', #9/23/2020#, '1', 'Brad Lamb', \n        '1921 Appleseed Lane', 'Bayshore', 'CA', '94326', 'USA', 0, '80000002-1478562832', \n         #10/31/2020#, #10/01/2020#, '8000295C-1541711590', \n         'Memo Test', 0, '80000001-1478562826')\n</code></pre>\n\n<p>Alternatively, use <code>CDate()</code> to convert string to date:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>INSERT INTO Invoice (CustomerRefListID, ARAccountRefListID, TxnDate, RefNumber,\n                     BillAddressAddr1, BillAddressAddr2, BillAddressCity, BillAddressState, \n                     BillAddressPostalCode, BillAddressCountry, IsPending, TermsRefListID, \n                     DueDate, ShipDate, ItemSalesTaxRefListID, [Memo], IsToBePrinted, \n                     CustomerSalesTaxCodeRefListID) \nVALUES ('800001F6-1482536280', '8000001E-1478562986', CDate('9/23/2020'), '1', 'Brad Lamb', \n        '1921 Appleseed Lane', 'Bayshore', 'CA', '94326', 'USA', 0, '80000002-1478562832', \n        CDate('10/31/2020'), CDate('10/01/2020'), '8000295C-1541711590', \n        'Memo Test', 0, '80000001-1478562826')\n</code></pre>\n\n<hr>\n\n<h2>Quickbooks ODBC</h2>\n\n<p>In Quickbooks, you must adhere to its date requirement of <code>{d 'YYYY-MM-DD'}</code> or  the functional form <code>fncqbDate()</code>. However, documentation on these methods is sparse to non-existent and can vary with ODBC driver versions.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>sql = \"INSERT INTO Invoice (CustomerRefListID, ARAccountRefListID, TxnDate, RefNumber, \" _\n       &amp; \"                  BillAddressAddr1, BillAddressAddr2, BillAddressCity,  \" _\n       &amp; \"                  BillAddressState, BillAddressPostalCode, BillAddressCountry,  \" _\n       &amp; \"                  IsPending, TermsRefListID, DueDate, ShipDate,  \" _\n       &amp; \"                  ItemSalesTaxRefListID, [Memo], IsToBePrinted,  \" _\n       &amp; \"                  CustomerSalesTaxCodeRefListID)  \" _\n       &amp; \" VALUES ('800001F6-1482536280', '8000001E-1478562986', {d '2020-09-23'}, '1',  \" _\n       &amp; \"         'Brad Lamb', '1921 Appleseed Lane', 'Bayshore', 'CA', '94326', 'USA', 0,  \" _ \n       &amp; \"         '80000002-1478562832', {d '2020-10-31'}, {d '2020-10-01'},  \" _\n       &amp; \"         '8000295C-1541711590', 'Memo Test', 0, '80000001-1478562826')\"\n</code></pre>\n\n<hr>\n\n<h2>Parameterization</h2>\n\n<p>With that said, even if above does not work, this is yet another good reason for parameterization, a programming industry standard for any application layer like VBA to run SQL. Parameterization facilitates data type mapping between client and server without the need of quote or other symbolic closures. ADO does support parameters with <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/createparameter-method-ado?view=sql-server-2017\" rel=\"nofollow noreferrer\">CreateParameter</a> method inside an <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/command-object-ado?view=sql-server-2017\" rel=\"nofollow noreferrer\">ADO Command</a> object (not ADO recordset).</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>' PREPARED STATEMENT WITH PLACEHOLDERS (NO LITERAL DATA)\nsql = \"INSERT INTO Invoice (CustomerRefListID, ARAccountRefListID, TxnDate, RefNumber, \" _\n       &amp; \"                  BillAddressAddr1, BillAddressAddr2, BillAddressCity,  \" _\n       &amp; \"                  BillAddressState, BillAddressPostalCode, BillAddressCountry,  \" _\n       &amp; \"                  IsPending, TermsRefListID, DueDate, ShipDate,  \" _\n       &amp; \"                  ItemSalesTaxRefListID, [Memo], IsToBePrinted,  \" _\n       &amp; \"                  CustomerSalesTaxCodeRefListID)  \" _\n       &amp; \" VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?,\" _ \n       &amp; \"         ?, ?, ?, ?, ?, ?, ?, ?, ?)\"\n\n' OPEN CONNECTION\nSet oConnection = CreateObject(\"ADODB.Connection\")   \noConnection.Open sConnectString\n\n' INITIALIZE AND RUN COMMAND\nSet oCmd = CreateObject(\"ADODB.Command\")              ' NEW ADO OBJECT\nWith oCmd\n   .ActiveConnection = oConnection\n   .CommandText = sql\n   .CommandType = adCmdText\n\n   ' BIND PARAMETERS\n   .Parameters.Append .CreateParameter(\"pm1\", adVarChar, adParamInput, ,\"800001F6-1482536280\")\n   .Parameters.Append .CreateParameter(\"pm2\", adVarChar, adParamInput, ,\"8000001E-1478562986\") \n   .Parameters.Append .CreateParameter(\"pm3\", adDate, adParamInput, , CDate(\"9/23/2020\"), \n   .Parameters.Append .CreateParameter(\"pm4\", adVarChar, adParamInput, ,\"1\") \n   .Parameters.Append .CreateParameter(\"pm5\", adVarChar, adParamInput, ,\"Brad Lamb\")\n   .Parameters.Append .CreateParameter(\"pm6\", adVarChar, adParamInput, ,\"1921 Appleseed Lane\")\n   .Parameters.Append .CreateParameter(\"pm7\", adVarChar, adParamInput, ,\"Bayshore\")\n   .Parameters.Append .CreateParameter(\"pm8\", adVarChar, adParamInput, ,\"CA\")\n   .Parameters.Append .CreateParameter(\"pm9\", adVarChar, adParamInput, ,\"94326\")\n   .Parameters.Append .CreateParameter(\"pm10\", adVarChar, adParamInput, ,\"USA\")\n   .Parameters.Append .CreateParameter(\"pm11\", adInteger, adParamInput, , 0)\n   .Parameters.Append .CreateParameter(\"pm12\", adVarChar, adParamInput, ,\"80000002-1478562832\")\n   .Parameters.Append .CreateParameter(\"pm13\", adDate, adParamInput, , CDate(\"10/31/2020\"))\n   .Parameters.Append .CreateParameter(\"pm14\", adDate, adParamInput, , CDate(\"10/01/2020\")) \n   .Parameters.Append .CreateParameter(\"pm15\", adVarChar, adParamInput, ,\"8000295C-1541711590\")\n   .Parameters.Append .CreateParameter(\"pm16\", adVarChar, adParamInput, ,\"Memo Test\")\n   .Parameters.Append .CreateParameter(\"pm17\", adInteger, adParamInput, ,0)\n   .Parameters.Append .CreateParameter(\"pm18\", adVarChar, adParamInput, ,\"80000001-1478562826\")\n\n   ' RUN PARAMETERIZED QUERY\n   .Execute\nEnd With\n\noConnection.Close\nSet oCmd = Nothing: Set oConnection = Nothing\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10891568"}, "edited": false, "score": 0, "creation_date": 1547691524, "post_id": 54226821, "comment_id": 95281877, "body": "I\u2019d consider that, but I also using a form with text boxes for input in the query. The code I am using in my post includes only static inputs I have made up for the example. Can what you are proposing also include inputs from a form?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1547734849, "post_id": 54226821, "comment_id": 95300357, "body": "@RichardWalton, you can point values in a saved query to form controls: <code>Forms!myForm!mycontrol</code> (no quotes or other enclosures). Then call <code>DoCmd.OpenQuery</code>. Alternatively, you can pass parameters to a saved query using <a href=\"https://stackoverflow.com/a/48810100/1422451\">QueryDefs</a> but this uses DAO (not ADO) implementation. Finally, you can use ADO as I proposed above, passing dynamic values into <code>CreateParameter</code> calls (last argument). Did you attempt this? StackOverflow has many, many <a href=\"https://stackoverflow.com/search?q=%5Bvba%5D+parameterization\">posts</a> on SQL parameterization in VBA."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10891568"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1547738713, "post_id": 54226821, "comment_id": 95302797, "body": "@Parfait I got the saved query to work, is there a way to make the all of the prompts that appear, auto accept (press yes on its own)?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1547739310, "post_id": 54226821, "comment_id": 95303202, "body": "It should not prompt you if the form is open to screen for controls to be available by query. If form is open, then you mis-typed the absolute form control path. Do note subforms have different paths. Consider bookmarking this page: <a href=\"http://access.mvps.org/access/forms/frm0031.htm\" rel=\"nofollow noreferrer\">access.mvps.org/access/forms/frm0031.htm</a> (do not use <code>Me.</code>, the relative reference). And remember no quotes, hashtags, or other enclosures."}], "tags": [], "owner": {"reputation": 573, "user_id": 8497252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d67538554b474d977f956003e2febeaf?s=128&d=identicon&r=PG&f=1", "display_name": "Cahaba Data", "link": "https://stackoverflow.com/users/8497252/cahaba-data"}, "is_accepted": false, "score": 0, "last_activity_date": 1547735100, "last_edit_date": 1547735100, "creation_date": 1547680611, "answer_id": 54226821, "question_id": 54219252, "link": "https://stackoverflow.com/questions/54219252/why-does-this-sql-query-work-in-query-designer-but-not-in-vba-for-access/54226821#54226821", "title": "Why does this SQL query work in query designer but not in VBA for Access?", "body": "<p>If this is an Access application, I would recommend that instead of rewriting the query into sql/vba code to instead take another approach:  leave the working query as a query object and instead use vba to trigger it: </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DoCmd.OpenQuery \"QueryName\"\n</code></pre>\n\n<p>This has the advantage of having that query object existing in the navigation pane so that you can run it manually for testing - without having to run any vba.  It is a much simpler debug strategy.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10891568"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 361, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1547735100, "creation_date": 1547648926, "last_edit_date": 1547653374, "question_id": 54219252, "link": "https://stackoverflow.com/questions/54219252/why-does-this-sql-query-work-in-query-designer-but-not-in-vba-for-access", "title": "Why does this SQL query work in query designer but not in VBA for Access?", "body": "<p>When I execute the following two queries in Create > Query one after the other they work perfectly. When I attempt to execute the queries in VBA only the first one (invoiceline) works. </p>\n\n<p>I know for a fact it is not the query itself that is the problem, it is the way that I am perhaps establishing the connection. I get the error invalid lexical when attempting to execute the query.</p>\n\n<p><strong>When pressing a button this query is executed correctly</strong></p>\n\n<p>buttonOne_Click()</p>\n\n<pre><code>Const adOpenStatic = 3\nConst adLockOptimistic = 3\n\n\nDim oConnection\nDim oRecordset\nDim sMsg\nDim sConnectString\nDim sSQL\nsConnectString = \"DSN=Quickbooks Data;OLE DB Services=-2;\"\n\nsSQL = \"INSERT INTO InvoiceLine (InvoiceLineItemRefListID, InvoiceLineDesc, InvoiceLineRate, InvoiceLineAmount, InvoiceLineSalesTaxCodeRefListID, FQSaveToCache) VALUES ('80002436-1519061496', 'Building permit 1', 1.00000, 1.00, '80000001-1478562826', 1)\"\n\nSet oConnection = CreateObject(\"ADODB.Connection\")\nSet oRecordset = CreateObject(\"ADODB.Recordset\")\noConnection.Open sConnectString\noConnection.Execute (sSQL)\nsMsg = sMsg &amp; \"Invoice details were gathered!\"\nMsgBox sMsg\n\nEnd Sub\n</code></pre>\n\n<p><strong>This one fails with error</strong></p>\n\n<p>buttonTwo_Click()</p>\n\n<pre><code>Const adOpenStatic = 3\nConst adLockOptimistic = 3\n\n\nDim oConnection\nDim oRecordset\nDim sMsg\nDim sConnectString\nDim sSQL\n\n\n\n\nsConnectString = \"DSN=Quickbooks Data;OLE DB Services=-2;\"\n\nsSQL = \"INSERT INTO Invoice (CustomerRefListID, ARAccountRefListID, TxnDate, RefNumber, BillAddressAddr1, BillAddressAddr2, BillAddressCity, BillAddressState, BillAddressPostalCode, BillAddressCountry, IsPending, TermsRefListID, DueDate, ShipDate, ItemSalesTaxRefListID, Memo, IsToBePrinted, CustomerSalesTaxCodeRefListID) VALUES ('800001F6-1482536280', '8000001E-1478562986', #9/23/2020#, '1', 'Brad Lamb', '1921 Appleseed Lane', 'Bayshore', 'CA', '94326', 'USA', 0, '80000002-1478562832', #10/31/2020#, #10/01/2020#, '8000295C-1541711590', 'Memo Test', 0, '80000001-1478562826')\"\n\n\nSet oConnection = CreateObject(\"ADODB.Connection\")\nSet oRecordset = CreateObject(\"ADODB.Recordset\")\noConnection.Open sConnectString\noConnection.Execute (sSQL)\nsMsg = sMsg &amp; \"Invoice was Sent to QuickBooks\"\nMsgBox sMsg\n\nEnd Sub\n</code></pre>\n\n<p>The second one relies on the first one to finish, once again both queries work perfectly in the Query designer in Microsoft Access, but the second one fails when running in VBA SQL in a macro or procedure.</p>\n\n<p>This is the error I see:</p>\n\n<p>Run-time error '-2147217900 (80040e14)':</p>\n\n<p>[QODBC] [sql syntax error] Expected lexical element not found: =)</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I have tried all of these with no luck, any other suggestions? </p>\n\n<p>01-10-2005</p>\n\n<p>2005-01-10</p>\n\n<p>01/10/2005</p>\n\n<p>2005/01/10</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1547648754, "creation_date": 1547648754, "answer_id": 54219189, "question_id": 54219147, "link": "https://stackoverflow.com/questions/54219147/vba-excel-include-a-if-statement-in-email-form/54219189#54219189", "title": "VBA Excel include a IF statement in email form", "body": "<p>You mean like this:</p>\n\n<pre><code>If Worksheets(\"MyData\").Range(\"R2\").Value2 = \"yyy@gmail.com\" Then\n    .CC = \"zzz@gmail.com; aaa@gmail.com\"\nElse\n    .CC = \"yyy@gmail.com; zzz@gmail.com; aaa@gmail.com\"\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1547849606, "post_id": 54219392, "comment_id": 95348300, "body": "I propose to use <code>Replace(.cc, addr, vbNullString, , , vbTextCompare)</code> to catch upper/lowercase adresses also. After replacement there may remain some unnecessary spaces within the string, which could have been trimmed before, but that should be no problem with email adresses."}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 2, "last_activity_date": 1547649407, "creation_date": 1547649407, "answer_id": 54219392, "question_id": 54219147, "link": "https://stackoverflow.com/questions/54219147/vba-excel-include-a-if-statement-in-email-form/54219392#54219392", "title": "VBA Excel include a IF statement in email form", "body": "<p>I wouldn't use an if statement for this. Instead I would remove each recipient from the cc line after setting both</p>\n\n<pre><code>.to = \"yyy@gmail.com\"\n.cc = \"yyy@gmail.com; zzz@gmail.com; aaa@gmail.com\"\nFor Each addr In Split(.to, \";\")\n    .cc = Replace(.cc, addr, vbNullString)\nNext addr\n.BCC = \"\"\n.Subject = \"TEST\"\n.Body = \"Hello\"\n.Attachments.Add ThisWorkbook.Path &amp; \"\\ME\\\" &amp; Check &amp; \" \" &amp; Format(Now, \"dd-mmm-yy\") &amp; \".xlsx\"\n.Display\n</code></pre>\n\n<p>The for loop splits the to line on the semi-colon character <code>;</code> and then loops through each one removing it from the <code>.cc</code> This will handle both single and multiple recipients in both the <code>.To</code> and <code>.CC</code> line</p>\n"}, {"comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1547649546, "post_id": 54219425, "comment_id": 95264500, "body": "Have a look at my answer - it covers multiple recipients"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1547649871, "last_edit_date": 1547649871, "creation_date": 1547649487, "answer_id": 54219425, "question_id": 54219147, "link": "https://stackoverflow.com/questions/54219147/vba-excel-include-a-if-statement-in-email-form/54219425#54219425", "title": "VBA Excel include a IF statement in email form", "body": "<p>Just use <code>Replace</code> to remove the address in <code>.To</code> from your list in <code>.CC</code></p>\n\n<pre><code>.To = Worksheets(\"MyData\").Range(\"R2\").Value\n.CC = Replace(\"yyy@gmail.com; zzz@gmail.com; aaa@gmail.com\", .To, vbNullString)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": false, "score": 0, "last_activity_date": 1548086817, "last_edit_date": 1548086817, "creation_date": 1547651280, "answer_id": 54219976, "question_id": 54219147, "link": "https://stackoverflow.com/questions/54219147/vba-excel-include-a-if-statement-in-email-form/54219976#54219976", "title": "VBA Excel include a IF statement in email form", "body": "<p>By this the addresses are trimmed and compared case insensitive:</p>\n\n<pre><code>    .To = Worksheets(\"MyData\").Range(\"R2\").Value\n    .CC = \"\"\n    Dim check As Variant\n    For Each check In Split(\"yyy@gmail.com; zzz@gmail.com; aaa@gmail.com\", \";\")\n        If Not InStr(1, .To, Trim(check), vbTextCompare) &gt; 0 Then _\n            .CC = .CC &amp; \"; \" &amp; check\n    Next check\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10922888, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gpAErjpj5W4/AAAAAAAAAAI/AAAAAAAAAE4/TUE8kH9yZOw/photo.jpg?sz=128", "display_name": "TheReddsable", "link": "https://stackoverflow.com/users/10922888/thereddsable"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1548086817, "creation_date": 1547648599, "last_edit_date": 1547649239, "question_id": 54219147, "link": "https://stackoverflow.com/questions/54219147/vba-excel-include-a-if-statement-in-email-form", "title": "VBA Excel include a IF statement in email form", "body": "<p>I can't seem to include a IF formula in my code, in the part where the email is being sent to some people included in column R2 of my Excel file</p>\n\n<p>I would like to exclude from <code>.CC</code> the email <code>yyy@gmail.com</code> if this user is already in column R2 (so in <code>.To</code>). How could I write the code? Otherwise, my user <code>yyy@gmail.com</code> is receiving the email twice, once because the user is in <code>.To</code> and once because he is in <code>.CC</code></p>\n\n<pre><code>.To = Worksheets(\"MyData\").Range(\"R2\").Value\n.CC = \"yyy@gmail.com; zzz@gmail.com; aaa@gmail.com\"\n.BCC = \"\"\n.Subject = \"TEST\"\n.Body = \"Hello\"\n.Attachments.Add ThisWorkbook.Path &amp; \"\\ME\\\" &amp; Check &amp; \" \" &amp; Format(Now, \"dd-mmm-yy\") &amp; \".xlsx\"\n.Display\n'.Send\n</code></pre>\n\n<p>What could be the code to do that?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1547648028, "post_id": 54218844, "comment_id": 95263457, "body": "A user defined function (UDF) always returns <code>#VALUE!</code> if there is an unhandled error in the function. To debug it make an additional procedure that calls <code>Debug.Print TIMEAVERAGE(Worksheets(&quot;MySheet&quot;).Range(&quot;B2&quot;))</code> then go through the code step by step using F8 to see where you get any errors. Tell us which errors you get and where."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 2, "creation_date": 1547648070, "post_id": 54218844, "comment_id": 95263487, "body": "<code>CurRng</code> is neither declared nor initialized"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1547648312, "post_id": 54218844, "comment_id": 95263644, "body": "Please note that if <code>CurRng</code> is meant to be a <code>Range</code> object. Then <code>CurRng = rng.Offset(CurOffset, 0)</code> won&#39;t work because a UDF is <b>not</b> allowed to change other cell&#39;s values. \u2022 I recommend to activate <code>Option Explicit</code>: In the VBA editor go to <i>Tools</i> \u203a <i>Options</i> \u203a <i><a href=\"https://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a></i> to force proper variable declaration."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1547648995, "post_id": 54218844, "comment_id": 95264098, "body": "@PEH: Probably the OP meant to <code>Set</code> the variable"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1547651289, "post_id": 54218844, "comment_id": 95265615, "body": "<code>..a UDF is not allowed to change other cell&#39;s values...</code> @P\u1d07\u029c That is not true ;)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547651613, "post_id": 54218844, "comment_id": 95265815, "body": "I believe you are using the formula as <code>=TIMEAVERAGE(A2)</code> in Cell B2. But with <code>CurTime = rng.Offset(0, -1)</code>, your formula will give an error for Cell B2 as you are trying to access a column which is on the left of Col A which doesn&#39;t exist."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547651620, "post_id": 54218844, "comment_id": 95265816, "body": "@SiddharthRout But not without any fancy tricks. I only see the trick doing it <a href=\"https://stackoverflow.com/questions/12501759/vba-update-other-cells-via-user-defined-function\">indirectly</a>. But any direct cell value change like <code>Cells(1, 1) = &quot;AAAA&quot;</code> will cause <code>#VALUE!</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1547651713, "post_id": 54218844, "comment_id": 95265868, "body": "@P\u1d07\u029c: No Fancy Tricks.. :D A simple <code>.Evaluate</code>... You may want to see <a href=\"https://stackoverflow.com/questions/23433096/using-a-udf-in-excel-to-update-the-worksheet\">This</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547652024, "post_id": 54218844, "comment_id": 95266034, "body": "@SiddharthRout Well not that <i>fancy</i> but still tricked and no direct change of a cell value. To do this you first have to learn/understand that any <i>direct</i> value change will not work."}, {"owner": {"reputation": 1, "user_id": 9842220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6R9lJdL_WQo/AAAAAAAAAAI/AAAAAAAAAj0/gopw6YbwQN0/photo.jpg?sz=128", "display_name": "eoncarlyle", "link": "https://stackoverflow.com/users/9842220/eoncarlyle"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1547652910, "post_id": 54218844, "comment_id": 95266559, "body": "I saw the observation made by @FunThomas and added <code>Dim CurRng As Range</code> after initializing <code>CurOffset</code> as well as <code>CurRng = rng</code> immediately before the while loop. during the debugging suggestsed by @PEH, I received this dialogue box: run-time error &#39;91&#39;: Object variable r With block variable not set, with the <code>CurRng = rng</code> line highlighted. This error is also producted if this highlighted line is replaced with CurRng = rng.Offset(CurOffset, 0). Is this related to the second comments by @FunThomas and @PEH?"}, {"owner": {"reputation": 1, "user_id": 9842220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6R9lJdL_WQo/AAAAAAAAAAI/AAAAAAAAAj0/gopw6YbwQN0/photo.jpg?sz=128", "display_name": "eoncarlyle", "link": "https://stackoverflow.com/users/9842220/eoncarlyle"}, "edited": false, "score": 0, "creation_date": 1547653027, "post_id": 54218844, "comment_id": 95266622, "body": "To clarify, this is the subroutine I have used for debugging:Sub <code>TimeAverageDebug()</code>      <code>Debug.Print TIMEAVERAGE(Worksheets(&quot;Testbed&quot;).Range(&quot;B2&quot;))</code>  <code>End Sub</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1547653291, "post_id": 54218844, "comment_id": 95266781, "body": "If <code>CurRng</code> is a <code>Range</code> it means it is an <i>object</i> and for objects you have to use <code>Set</code> like <code>Set CurRng = rng</code>."}, {"owner": {"reputation": 1, "user_id": 9842220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6R9lJdL_WQo/AAAAAAAAAAI/AAAAAAAAAj0/gopw6YbwQN0/photo.jpg?sz=128", "display_name": "eoncarlyle", "link": "https://stackoverflow.com/users/9842220/eoncarlyle"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1547653665, "post_id": 54218844, "comment_id": 95267039, "body": "I was able to fix the problem, by using @FunThomas and @PEH&#39;s advice to use <code>Set</code>. I replaced the <code>CurRng = rng.Offset(CurOffset, 0)</code> lines with <code>Set CurRng = rng.Offset(CurOffset, 0)</code>."}], "owner": {"reputation": 1, "user_id": 9842220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6R9lJdL_WQo/AAAAAAAAAAI/AAAAAAAAAj0/gopw6YbwQN0/photo.jpg?sz=128", "display_name": "eoncarlyle", "link": "https://stackoverflow.com/users/9842220/eoncarlyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547648171, "creation_date": 1547647620, "last_edit_date": 1547648171, "question_id": 54218844, "link": "https://stackoverflow.com/questions/54218844/value-error-returned-by-user-written-time-weighted-average-function", "title": "#VALUE! error returned by user written time-weighted average function", "body": "<p>I am trying to write a function in VBA that computes a time-weighted average, but the <code>#VALUE!</code> error appears when I try to use the function in my worksheet.</p>\n\n<p>While trying to debug I have been able to validate my approach to change <code>CurRPM</code> by iterating <code>CurOffset</code> and using <code>CurRng = rng.Offset(CurOffset, 0)</code>. The effect of changing <code>CurRng</code> is to iterate down the RPM column, checking if the cell under <code>CurRng</code> is either empty, the same as <code>CurRPM</code>, or non-empty and different from <code>CurRPM</code>.</p>\n\n<pre><code>Public Function TIMEAVERAGE(rng As Range) As Long\n\n'Initializing Variables\nDim CurTime As Integer\nDim CurRPM As Integer\nDim CurSum As Integer\nDim CurOffset As Integer\nCurOffset = 0\nCurSum = 0\n\n'The input cell is the first RPM\n'The cell to the left of the input cell is the second RPM\nCurTime = rng.Offset(0, -1)\nCurRPM = rng\n\n'Keep calculating as long as the cell below CurRng isn't empty\nWhile IsEmpty(CurRng.Offset(1, 0)) = False\n    'If the cell below has the same RPM, look at next cell\n    If CurRng.Offset(1, 0) = CurRPM Then\n        CurOffset = CurOffset + 1\n        CurRng = rng.Offset(CurOffset, 0)\n    Else:\n        'Otherwise, add the previous RPM's contribution to the average\n        'CurTime, as shown, is the start of the previous RPM\n        CurSum = CurSum + CurRPM * (CurRng.Offset(0, -1) - CurTime)\n        'Change CurRPM and CurTime for the new RPM\n        CurRPM = CurRng.Offset(1, 0)\n        CurTime = CurRng.Offset(0, -1)\n        CurOffset = CurOffset + 1\n        CurRng = rng.Offset(CurOffset, 0)\n    End If\n\nWend\n\n'Add the contributions of the final RPM\nCurSum = CurSum + CurRPM * (CurRng.Offset(0, -1) - CurTime)\n\n'Return the final TIMEAVERAGE\nTIMEAVERAGE = CurSum / CurRng.Offset(0, -1)\n\nEnd Function\n</code></pre>\n\n<p>The desired result from this program is returning 150 if the user enters <code>=TIMEAVERAGE(B2)</code> for the cells below. Instead, a <code>#VALUE!</code> error is returned.</p>\n\n<pre><code>       A       B        \n ________________    \n1|    Time | RPM\n2|    0    | 100\n3|    1    | 100\n4|    2    | 100\n5|    3    | 200\n6|    4    | 200\n7|    5    | 200\n8|    6    | 200\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1547647864, "post_id": 54218875, "comment_id": 95263336, "body": "Thanks for the reply but your codes deletes the whole sheet."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 1, "creation_date": 1547647892, "post_id": 54218875, "comment_id": 95263365, "body": "@sc1324 is your color in column A white ? or empty ?"}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1547648042, "post_id": 54218875, "comment_id": 95263466, "body": "There are no blank cells in any of the columns except column E to column H. In column A some cells have color some don&#39;t so I am trying to remove rows if there is a cell color in column A."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1547648221, "post_id": 54218875, "comment_id": 95263577, "body": "@sc1324 not empty as values, and color. try edited code."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1547648243, "post_id": 54218875, "comment_id": 95263595, "body": "I mean the blank cells in column A will mean if we reach the end of the data range and that is why we have <code>lastrow</code> defined."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1547648322, "post_id": 54218875, "comment_id": 95263653, "body": "Sweet thank you, I have been trying to get this to work since last night. Greatly appreciated for your efforts."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1547648261, "last_edit_date": 1547648261, "creation_date": 1547647735, "answer_id": 54218875, "question_id": 54218778, "link": "https://stackoverflow.com/questions/54218778/delete-rows-based-on-cell-value-not-working/54218875#54218875", "title": "Delete rows based on cell value not working", "body": "<p>Try the code below:</p>\n\n<pre><code>Option Explicit\n\nSub deleterow()\n\nDim i As Long, LastRow As Long\n\nWith Worksheets(\"New\")\n    LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n    For i = LastRow To 1 Step -1\n        'If .Cells(i, 1).Interior.Color &lt;&gt; xlNone Then\n        ' replace RGB(255, 255, 255) with the \"white\" color\n        If .Cells(i, 1).Interior.Color &lt;&gt; RGB(255, 255, 255) Then\n            .Rows(i).Delete\n        End If\n    Next i\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1547651175, "creation_date": 1547651175, "answer_id": 54219944, "question_id": 54218778, "link": "https://stackoverflow.com/questions/54218778/delete-rows-based-on-cell-value-not-working/54219944#54219944", "title": "Delete rows based on cell value not working", "body": "<h1>Delete No Color Row</h1>\n\n<h2>Union Version</h2>\n\n<pre><code>Option Explicit\n\nSub DeleteNoColorRow()\n\n    Const cSheet As Variant = \"Sheet1\"  ' Worksheet Name/Index\n    Const cFirstR As Integer = 1        ' First Row\n    Const cColumn As Variant = \"A\"      ' Column Letter/Number\n\n    Dim rngU As Range     ' Union Range\n    Dim lastRow As Long   ' Last Row\n    Dim i As Long         ' Row Counter\n\n    With ThisWorkbook.Worksheets(cSheet)\n        lastRow = .Cells(.Rows.Count, cColumn).End(xlUp).Row\n        For i = cFirstR To lastRow\n            If .Cells(i, cColumn).Interior.ColorIndex &lt;&gt; xlNone Then\n                If Not rngU Is Nothing Then\n                    Set rngU = Union(rngU, .Cells(i, cColumn))\n                  Else\n                    Set rngU = .Cells(i, cColumn)\n                End If\n            End If\n        Next\n    End With\n\n    If Not rngU Is Nothing Then\n        rngU.EntireRow.Delete ' Hidden = True\n        Set rngU = Nothing\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 1, "accepted_answer_id": 54218875, "answer_count": 2, "score": 1, "last_activity_date": 1547651175, "creation_date": 1547647422, "last_edit_date": 1547650216, "question_id": 54218778, "link": "https://stackoverflow.com/questions/54218778/delete-rows-based-on-cell-value-not-working", "title": "Delete rows based on cell value not working", "body": "<p>I have some data in sheet called New, and my data are in column A to column K. However, column E to H are intentionally left blank for data analysis purposes and I have no header so my data starts from cell A1. Now in column A we have color in cell, I would like to delete any rows that aren't white so keep rows that don't have color in it.</p>\n\n<p>I did some research but all of the codes I got online either delete the whole sheet or just pass through codes and nothing happens. Below are the ones I am currently using that doesn't do anything. I use F8 and still no error.</p>\n\n<p>See image for my sample data and I am trying to get the results with cells that don't have any color in it. I tried to remove quotation mark for the color index but still it doesn't work.</p>\n\n<pre><code> Sub deleterow()\n\n lastRow = Worksheets(\"New\").Cells(Rows.Count, \"A\").End(xlUp).Row\n For i = lastRow To 1 Step -1\n      If Worksheets(\"New\").Cells(i, 1).Interior.ColorIndex &lt;&gt; \"2\" Then\n           Rows(i).EntireRow.Delete\n           i = i + 1\n      End If\n Next I\n\n End Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/IlDLD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IlDLD.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/4bmjM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4bmjM.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1547648407, "post_id": 54218769, "comment_id": 95263711, "body": "<a href=\"https://www.bing.com/search?q=get+all+files+in+folder+vba&amp;src=IE-TopResult&amp;FORM=IETR02&amp;conversationid=\" rel=\"nofollow noreferrer\">bing.com/&hellip;</a>"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 1, "creation_date": 1547648590, "post_id": 54218769, "comment_id": 95263835, "body": "Please share what you have done so far! You will get a better answer if you show what you have tried and what your problem is."}, {"owner": {"reputation": 1, "user_id": 10922789, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lRgv1RdWMX0/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcY0TjnjaFc3PlGlK4nNRakPdytCIQ/mo/photo.jpg?sz=128", "display_name": "yujy", "link": "https://stackoverflow.com/users/10922789/yujy"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1547649769, "post_id": 54218769, "comment_id": 95264646, "body": "@ Nathan i know it can be done, a found myself several examples but i couldn&#39;t adapt it to my case (to the code i already have). @Sam My problem now is that i want to change the code that it will attach all files in the specified directory (example, i have 300 email to send 2 times a month, each with attachments, attachments that have different names every time )"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1547649778, "post_id": 54218769, "comment_id": 95264655, "body": "@yujy so why not use the example to loop the files and adjust your <code>.Attachments.Add </code> accordingly?"}, {"owner": {"reputation": 1, "user_id": 10922789, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lRgv1RdWMX0/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcY0TjnjaFc3PlGlK4nNRakPdytCIQ/mo/photo.jpg?sz=128", "display_name": "yujy", "link": "https://stackoverflow.com/users/10922789/yujy"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1547650623, "post_id": 54218769, "comment_id": 95265169, "body": "@Nathan_Sav, i have no idea how to do that. I&#39;ve been trying the last 2 days to do that, but it wont work, like i said i&#39;m  new at vba."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1547650855, "post_id": 54218769, "comment_id": 95265336, "body": "<a href=\"https://stackoverflow.com/questions/10380312/loop-through-files-in-a-folder-using-vba\" title=\"loop through files in a folder using vba\">stackoverflow.com/questions/10380312/&hellip;</a>    hint change <code>Debug.Print StrFile</code> to your attachement adding code and add this functionality to your existing code."}, {"owner": {"reputation": 1, "user_id": 10922789, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lRgv1RdWMX0/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcY0TjnjaFc3PlGlK4nNRakPdytCIQ/mo/photo.jpg?sz=128", "display_name": "yujy", "link": "https://stackoverflow.com/users/10922789/yujy"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1547651830, "post_id": 54218769, "comment_id": 95265930, "body": "@Nathan_sav maybe i wasn&#39;t clear sry for that, the a.m. code sends an email for every line: A2 - email address; B2 - CC address; C2 - email name; D2 through Z2 attachments. The attachments i have to write the directory + name of said attachment (invoice.pdf for example; if i have 20 attachments i have to whrite 20 addresses).  I just want to change so that the email attaches all files in said directory."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1547651974, "post_id": 54218769, "comment_id": 95266001, "body": "<code>For Each FileCell In rng.SpecialCells(xlCellTypeConstants)</code> you need to change your code <code>rng.SpecialCells(xlCellTypeConstants)</code> instead of this, loop every cell in the last column, so <code>rng.column(rng.columns.count-1).SpecialCells(xlCellTypeConst&zwnj;&#8203;ants)</code> may not need the -1, cant test at the minute"}, {"owner": {"reputation": 1, "user_id": 10922789, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lRgv1RdWMX0/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcY0TjnjaFc3PlGlK4nNRakPdytCIQ/mo/photo.jpg?sz=128", "display_name": "yujy", "link": "https://stackoverflow.com/users/10922789/yujy"}, "edited": false, "score": 0, "creation_date": 1547652941, "post_id": 54218769, "comment_id": 95266575, "body": "It doesn&#39;t work, error Compile Error, Wrong number of arguments or invalid property assigment"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1547666233, "post_id": 54218769, "comment_id": 95273572, "body": "What column will your Attachment Path be? Example <a href=\"https://stackoverflow.com/a/38303646/4539709\">stackoverflow.com/a/38303646/4539709</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10922789, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lRgv1RdWMX0/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcY0TjnjaFc3PlGlK4nNRakPdytCIQ/mo/photo.jpg?sz=128", "display_name": "yujy", "link": "https://stackoverflow.com/users/10922789/yujy"}, "edited": false, "score": 0, "creation_date": 1547653217, "post_id": 54219708, "comment_id": 95266734, "body": "I don&#39;t see how this helps me, a just needed to add all files in a specified directory to an email (300 different mail each with 300 different directories, each directory with many different files - mostly pdf), i can&#39;t even begin to add yr. code to my existing code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "reply_to_user": {"reputation": 1, "user_id": 10922789, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lRgv1RdWMX0/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcY0TjnjaFc3PlGlK4nNRakPdytCIQ/mo/photo.jpg?sz=128", "display_name": "yujy", "link": "https://stackoverflow.com/users/10922789/yujy"}, "edited": false, "score": 0, "creation_date": 1547653633, "post_id": 54219708, "comment_id": 95267014, "body": "Did you read my comment <b>Attach file with your own code from here</b>? There you make a call to a sub that attach the found file to your email: <b><i>.Attachments.Add Path &amp; theFile</i></b>"}, {"owner": {"reputation": 1, "user_id": 10922789, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lRgv1RdWMX0/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcY0TjnjaFc3PlGlK4nNRakPdytCIQ/mo/photo.jpg?sz=128", "display_name": "yujy", "link": "https://stackoverflow.com/users/10922789/yujy"}, "edited": false, "score": 0, "creation_date": 1547660146, "post_id": 54219708, "comment_id": 95270693, "body": "I tried but i couldn&#39;t make it work. Do i have to make 4 different macro&#39;s?!, I found a way to retrieve all named attachments from excel as a work around (therefore i don;t need to edit my original code). Sorry for wasting yr. time,  vba is beyond my capability."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "is_accepted": false, "score": 0, "last_activity_date": 1547652950, "last_edit_date": 1547652950, "creation_date": 1547650477, "answer_id": 54219708, "question_id": 54218769, "link": "https://stackoverflow.com/questions/54218769/how-to-attach-all-files-in-folder-to-an-email-vba-code/54219708#54219708", "title": "How to attach all files in folder to an email - vba code", "body": "<p>General approach to find specific files in a folder and optionally in subfolders.</p>\n\n<pre><code>'******************************************************************\n'* Find files in current folder and optionally in subfolders\n'*\nOption Explicit\n\nConst ROOTFOLDER = \"C:\\Test\"  'Change as desired\nConst EXTENSION = \"txt\"       'Change as desired\n\nConst FILES = \"*.\" &amp; EXTENSION\n\nDim g_FolderCount As Integer\nDim g_FileCount As Integer\n'**********************************\n'* Test code only\n'*\nSub Test()\n    Dim Path As String\n\n    g_FileCount = 0\n    g_FolderCount = 0\n    Path = ROOTFOLDER\n    GetSubFolders Path, True\n    Debug.Print \"Number of folders: \" &amp; g_FolderCount &amp; \". Number of files: \" &amp; g_FileCount\nEnd Sub\n'****************************************************************\n'* Recursive sub to find path and files\n'*\nSub GetSubFolders(Path As String, subFolders As Boolean)\n    Dim FSO As Object           'Late binding: Scripting.FileSystemObject\n    Dim myFolder As Object      'Late binding: Folder\n    Dim mySubFolder As Object\n\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set myFolder = FSO.GetFolder(Path)\n    If subFolders Then\n        If myFolder.subFolders.Count &lt;&gt; 0 Then\n            ProcessFiles Path                             'First branch (root)\n            For Each mySubFolder In myFolder.subFolders\n                g_FolderCount = g_FolderCount + 1\n                GetSubFolders mySubFolder.Path, subFolders\n            Next\n        Else  'No more subfolders in Path, process files in current path\n            ProcessFiles Path\n        End If\n    Else 'No subdirectories, process current only\n       ProcessFiles Path\n    End If\nEnd Sub\n'*********************************************\n'* Callback from GetSubFolders\n'* Process files in the found folder\n'*\nSub ProcessFiles(ByVal Path As String)\n    Dim theFilePattern As String\n    Dim theFile As String\n\n    Path = Path &amp; \"\\\"\n    theFilePattern = Path &amp; FILES\n    theFile = Dir(theFilePattern)\n    While theFile &lt;&gt; \"\"    'Attach file with your own code from here\n        g_FileCount = g_FileCount + 1\n        Debug.Print Path &amp; theFile\n        theFile = Dir()    ' Next file if any\n    Wend\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10922789, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lRgv1RdWMX0/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcY0TjnjaFc3PlGlK4nNRakPdytCIQ/mo/photo.jpg?sz=128", "display_name": "yujy", "link": "https://stackoverflow.com/users/10922789/yujy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1402, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592693653, "creation_date": 1547647383, "last_edit_date": 1592693653, "question_id": 54218769, "link": "https://stackoverflow.com/questions/54218769/how-to-attach-all-files-in-folder-to-an-email-vba-code", "title": "How to attach all files in folder to an email - vba code", "body": "<p>I have the following code in vba, all works well but i need to change to attach all files in selected folder (the way it is now i have to write the name of said attachment). \nUnfortunately i'm a noob when it comes to vba programming.</p>\n\n<pre><code>Sub Send_Files()\n\nDim OutApp As Object\nDim OutMail As Object\nDim sh As Worksheet\nDim cell As Range\nDim FileCell As Range\nDim rng As Range\n\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\n\nSet sh = Sheets(\"Sheet1\")\n\nSet OutApp = CreateObject(\"Outlook.Application\")\n\nFor Each cell In sh.Columns(\"A\").Cells.SpecialCells(xlCellTypeConstants)\n\n    Set rng = sh.Cells(cell.Row, 1).Range(\"D1:Z1\")\n\n    If cell.Value Like \"?*@?*.?*\" And _\n    Application.WorksheetFunction.CountA(rng) &gt; 0 Then\n        Set OutMail = OutApp.CreateItem(0)\n\n        With OutMail\n            .To = sh.Cells(cell.Row, 1).Value\n            .CC = sh.Cells(cell.Row, 2).Value\n            .Subject = \"Decont UTA\"\n            .Body = sh.Cells(cell.Row, 3).Value\n\n            For Each FileCell In rng.SpecialCells(xlCellTypeConstants)\n                If Trim(FileCell.Value) &lt;&gt; \"\" Then\n                    If Dir(FileCell.Value) &lt;&gt; \"\" Then\n                        .Attachments.Add FileCell.Value\n                    End If\n                End If\n            Next FileCell\n\n            .Send 'Or use .Display/Send\n        End With\n\n        Set OutMail = Nothing\n    End If\nNext cell\n\nSet OutApp = Nothing\n\nWith Application\n    .EnableEvents = True\n    .ScreenUpdating = True\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "object-reference"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1547645753, "post_id": 54218053, "comment_id": 95262019, "body": "Which line gets the error?"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 1, "creation_date": 1547646030, "post_id": 54218053, "comment_id": 95262199, "body": "Also, with the copying happening outside of the for loop, only data from <b>one</b> workbook will get copied over....."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1547646050, "post_id": 54218053, "comment_id": 95262214, "body": "<code>Wb2.Sheets(&quot;Forecast_Data&quot;)</code> is correct, and so is <code>wB2.Sheets(&quot;Sheet4&quot;)</code>. If you get a subscript error, <code>wb2</code> does not have such sheets."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1547646811, "post_id": 54218053, "comment_id": 95262693, "body": "Also, if you have ever saved macros in the PERSONAL workbook (the default save location), that could be causing this issue because once it exists, the PERSONAL workbook is always open in the background while Excel is running. If your code is cycling through all workbooks, that would include PERSONAL."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10921939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5217c7f72affc954e17706ee2254a777?s=128&d=identicon&r=PG&f=1", "display_name": "M Breganski", "link": "https://stackoverflow.com/users/10921939/m-breganski"}, "edited": false, "score": 0, "creation_date": 1547649026, "post_id": 54218602, "comment_id": 95264120, "body": "So basically <code>wb2</code> is just a variable, I have <code>set wb2</code> at the beginning of the code = this workbook. This helps because each template I need to copy over has a different name. I sort of understand what you and @ GSerg are saying, that there is no such worksheet as <code>wb2.Sheets(&quot;Forecast_data&quot;)</code> because my workbook is named &quot;consolidation&quot;?  If this is the case why does <code>wb2.Sheets(7)</code> work without any problems?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 1, "user_id": 10921939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5217c7f72affc954e17706ee2254a777?s=128&d=identicon&r=PG&f=1", "display_name": "M Breganski", "link": "https://stackoverflow.com/users/10921939/m-breganski"}, "edited": false, "score": 0, "creation_date": 1547657044, "post_id": 54218602, "comment_id": 95269031, "body": "@MBreganski It does not matter what your workbook is named. Does the file that contains the <code>CopyData</code> macro has a sheet named <code>Forecast_data</code>?"}, {"owner": {"reputation": 1, "user_id": 10921939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5217c7f72affc954e17706ee2254a777?s=128&d=identicon&r=PG&f=1", "display_name": "M Breganski", "link": "https://stackoverflow.com/users/10921939/m-breganski"}, "edited": false, "score": 0, "creation_date": 1547736786, "post_id": 54218602, "comment_id": 95301504, "body": "Yeah it does - weird thing is I can run separate subs with those reference names without any issues (reference then excludes the <code>wb2</code> bit). So I thought it may have to do with the part I have <code>set wb2 = ThisWorkbook</code> ? Do I need to be consistent or should the referencing work interchangeably between numerical sheet sequence / sheet names? Functionally I can manage by referencing the sheets numerically but I&#39;d really like to know the reason behind the issue..."}], "tags": [], "owner": {"reputation": 86, "user_id": 10909019, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YOo6Vs9JdO0/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYmLl4ifKqGoLe0lWsiqnDpYjIUMw/mo/photo.jpg?sz=128", "display_name": "David Weber", "link": "https://stackoverflow.com/users/10909019/david-weber"}, "is_accepted": false, "score": 0, "last_activity_date": 1547646818, "creation_date": 1547646818, "answer_id": 54218602, "question_id": 54218053, "link": "https://stackoverflow.com/questions/54218053/change-excel-sheet-reference-from-numerical-sequence-to-sheet-name/54218602#54218602", "title": "Change excel sheet reference from numerical sequence to sheet name", "body": "<p>I think @GSerg already gave you the most important hint.</p>\n\n<p>I assume you created a workbook with the name WB2, but it does not contain any of those sheets you want to write in.</p>\n\n<p>Either create them manually in your template (WB2) or have a look at <a href=\"https://stackoverflow.com/questions/20697706/how-to-add-a-named-sheet-at-the-end-of-all-excel-sheets\">How to Add a Named Sheet at the end of all excel sheets</a> to create them with your VBA.</p>\n"}], "owner": {"reputation": 1, "user_id": 10921939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5217c7f72affc954e17706ee2254a777?s=128&d=identicon&r=PG&f=1", "display_name": "M Breganski", "link": "https://stackoverflow.com/users/10921939/m-breganski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547646818, "creation_date": 1547645091, "last_edit_date": 1547645906, "question_id": 54218053, "link": "https://stackoverflow.com/questions/54218053/change-excel-sheet-reference-from-numerical-sequence-to-sheet-name", "title": "Change excel sheet reference from numerical sequence to sheet name", "body": "<p>I have a relatively simple question. Currently I have some code that is working well but not efficient. I have about 500 cost centres each with their own workbook which I have consolidated into a central repository (reference - <code>Wb2</code> in code below). The code copies ranges from each open template (<code>Wb1</code>) into my consolidation (<code>Wb2</code>). Sample code below (full code not necessary).</p>\n\n<pre><code>Option Explicit\n\nSub CopyData()\n    Dim Wb1 As Workbook, wb2 As Workbook, wB As Workbook\n    Dim rngToCopy1 As Range\n    Dim rngToCopy2 As Range\n    Dim rngToCopy3 As Range\n    Dim rngToCopy4 As Range\n    Dim rngToCopy5 As Range\n    Set wb2 = ThisWorkbook\n    Application.Calculation = xlManual\n\n    For Each wB In Application.Workbooks\n        If Not Left(wB.Name, 18) = \"Consolidation Test\" Then\n            Set Wb1 = wB\n            Exit For\n        End If\n    Next\n\n    'Forecast Data\n    With Wb1.Sheets(1)\n        Set rngToCopy1 = .Range(\"A11:O11\", .Cells(.Rows.Count, \"A\").End(xlUp))\n    End With\n    wb2.Sheets(7).Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Resize(rngToCopy1.Rows.Count, 15).Value = rngToCopy1.Value\n    wb2.Sheets(7).Range(\"P\" &amp; Rows.Count).End(xlUp).Offset(1).Resize(rngToCopy1.Rows.Count).Value = Sheets(3).Range(\"J1\").Value\n</code></pre>\n\n<p>I have tried to simply change as an example <code>wB2.Sheets(7)</code> to <code>Wb2.Sheets(\"Forecast_Data\")</code> as well as the original name in VBE <code>wB2.Sheets(\"Sheet4\")</code> but I get a subscript out of range error?</p>\n\n<p>In addition to the solution, please also provide background on why the fix is not so simple, has it got to do with how my variables are declared?</p>\n"}, {"tags": ["vba", "email", "outlook", "attachment", "email-attachments"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1547807963, "post_id": 54223081, "comment_id": 95328515, "body": "Thank you for the answer - It is working! I just have one additional question now because I sometimes have pictures in my signature. Is it possible to design it so it doesn&#39;t count these without changing the number in the VBA code manually every time I have a different number of pictures?"}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "reply_to_user": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1547821944, "post_id": 54223081, "comment_id": 95335935, "body": "What type of attachments are you sending?  Are you sending images IN your email or attaching them at the subject line?  Generally speaking trying to identify only the signature images is tricky unless you define a static list of them."}, {"owner": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1547822677, "post_id": 54223081, "comment_id": 95336364, "body": "I am sending word-files and excel-files primarily and they are attached at the subject line, and I only want the message to show up, if I have something attached at the subject line, so it doesn&#39;t pop-up if i have a signature or something else in the body of the mail."}, {"owner": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1548323165, "post_id": 54223081, "comment_id": 95502921, "body": "I can see that the code is now updated, but it still gives me the message box when I have no attachments but a picture in my signature. Maybe it is because that PR_Attachments_HIDDEN doesn&#39;t work for me?"}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "reply_to_user": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1548365848, "post_id": 54223081, "comment_id": 95526493, "body": "See final code block.  Another check was added to review the content tag against the items in the email to ensure we don&#39;t mistakenly flag items that are embedded images."}, {"owner": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1548409989, "post_id": 54223081, "comment_id": 95539598, "body": "Perfect! Thank you so much - it is working when I send emails now. Is there a way for it to work when I reply on mails and have attachments, because it only works when I send a mail."}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "reply_to_user": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1548448283, "post_id": 54223081, "comment_id": 95559122, "body": "Hmm, not sure why that&#39;s happening.  This is triggering every time I send, forward or reply to an email."}, {"owner": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "edited": false, "score": 0, "creation_date": 1549443041, "post_id": 54223081, "comment_id": 95899401, "body": "I have tried it for a week now, and it still won&#39;t show up when I reply to an email, but I want to thank you anyway - this really helped me still!"}], "tags": [], "owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "is_accepted": true, "score": 0, "last_activity_date": 1548365816, "last_edit_date": 1548365816, "creation_date": 1547662811, "answer_id": 54223081, "question_id": 54217619, "link": "https://stackoverflow.com/questions/54217619/outlook-attachment-check/54223081#54223081", "title": "Outlook attachment check", "body": "<p>I would reference <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Outlook.Application.ItemSend\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/Outlook.Application.ItemSend</a></p>\n\n<p>and <a href=\"https://stackoverflow.com/questions/35806335/how-can-i-automatically-run-a-macro-when-an-email-is-sent-in-outlook\">How can I automatically run a macro when an email is sent in Outlook?</a></p>\n\n<p>as well as <a href=\"https://social.msdn.microsoft.com/Forums/sqlserver/en-US/c4f47790-8e7b-425a-bf7e-f7bc5b725e81/determine-attechments-in-mail-item?forum=outlookdev\" rel=\"nofollow noreferrer\">https://social.msdn.microsoft.com/Forums/sqlserver/en-US/c4f47790-8e7b-425a-bf7e-f7bc5b725e81/determine-attechments-in-mail-item?forum=outlookdev</a></p>\n\n<p>These detail the ItemSend event with the example shown below.</p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\nDim prompt As String\nprompt = \"Are you sure you want to send \" &amp; Item.Subject &amp; \"?\"\nIf MsgBox(prompt, vbYesNo + vbQuestion, \"Sample\") = vbNo Then\n    Cancel = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>The property of the <code>MailItem</code> you're looking for is <code>Attachments</code>.</p>\n\n<p>The above example passes in the Item as an object-which should be a <code>MailItem</code> by default, so checking <code>Item.Attachments.Count &lt;&gt; 0</code> would be true if it had attachments.</p>\n\n<p>Try something along the lines of</p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal Item as Object, Cancel as Boolean)\nIf Item.Attachments.Count &gt; 0 Then\n   If Msgbox(\"Items attached to email. Send?\", vbYesNo) = vbNo Then\n     Cancel = True\n   End If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>To only flag messages with attachments at the subject line we can use the Attachment Property \"PR_ATTACHMENT_HIDDEN\" If it exists and the value is FALSE, it indicates an attached-at-subject-line attachment as opposed to an embedded image.  </p>\n\n<p>The quick On Error Resume Next is to catch the exception if PR_ATTACHMENT_HIDDEN isn't on any objects.  It will throw an exception if it doesn't exist.</p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n\nConst PR_ATTACHMENT_HIDDEN As String = \"http://schemas.microsoft.com/mapi/proptag/0x7FFE000B\"\n\nDim aFound As Boolean\n\naFound = False\n\n    If TypeOf Item Is Outlook.MailItem Then\n\n        For Each a In Item.Attachments\n            On Error Resume Next ' to avoid the error thrown when no items within attachments have this property\n\n            If a.PropertyAccessor.GetProperty(PR_ATTACHMENT_HIDDEN) = False Then\n                aFound = True\n                Exit For\n            End If\n\n            On Error GoTo 0\n         Next a\n\n        If aFound = True Then\n            If MsgBox(\"Items attached to email. Send?\", vbYesNo) = vbNo Then\n                Cancel = True\n            End If\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>If you are trying to discriminate between images within signatures and embedded images we need to review the content ID against the HTML body of the email for the tag.  I added another check to the code to find those and disregard them as false positives.</p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n\nConst PR_ATTACH_CONTENT_ID As String = \"http://schemas.microsoft.com/mapi/proptag/0x3712001F\"\nConst PR_ATTACHMENT_HIDDEN As String = \"http://schemas.microsoft.com/mapi/proptag/0x7FFE000B\"\n\nDim aFound As Boolean\n\naFound = False\n\n    If TypeOf Item Is Outlook.MailItem Then\n\n        For Each a In Item.Attachments\n            On Error Resume Next ' to avoid the error thrown when no items within attachments have this property\n            If a.PropertyAccessor.GetProperty(PR_ATTACHMENT_HIDDEN) = False Then\n                If Len(a.PropertyAccessor.GetProperty(PR_ATTACH_CONTENT_ID)) &gt; 0 And InStr(Application.ActiveInspector.CurrentItem.HTMLBody, a.PropertyAccessor.GetProperty(PR_ATTACH_CONTENT_ID)) Then\n                Else\n                aFound = True\n                Exit For\n                End If\n            End If\n\n            On Error GoTo 0\n         Next a\n\n        If aFound = True Then\n            If MsgBox(\"Items attached to email. Send?\", vbYesNo) = vbNo Then\n                Cancel = True\n            End If\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10800338, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IgoxpuwTTvA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g1qQKwlTLXFzgOC5JaQzHBut1zaA/mo/photo.jpg?sz=128", "display_name": "Mads Stecher", "link": "https://stackoverflow.com/users/10800338/mads-stecher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "accepted_answer_id": 54223081, "answer_count": 1, "score": 0, "last_activity_date": 1548365816, "creation_date": 1547643629, "last_edit_date": 1547715116, "question_id": 54217619, "link": "https://stackoverflow.com/questions/54217619/outlook-attachment-check", "title": "Outlook attachment check", "body": "<p>How do I make a VBA code or set up my mail in a way so that a message box shows up if I am sending an email with an attachment? \nI have searched through many posts and haven't found a solution to this problem - I have found many solutions to check for missing attachments but so far I haven't found one where an alert is shown if an email has an attachment.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1547648564, "post_id": 54217606, "comment_id": 95263817, "body": "Look at using a <code>function</code> rather than a <code>sub</code> you can then say <code>fnUpdate(curweek as long, employee1 as string,rowstr as string)</code> for example.  You can then loop the range and say <code>fnUpdate(range(&quot;a&quot; &amp; counter).value, range(&quot;b&quot; &amp; counter).value ........ </code>"}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1547649212, "post_id": 54217606, "comment_id": 95264255, "body": "Show us the loops you&#39;ve tried and we will help."}, {"owner": {"reputation": 67, "user_id": 10758799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8872e70c5874947701d57516acd9d9c?s=128&d=identicon&r=PG&f=1", "display_name": "Jelle van der Heijden", "link": "https://stackoverflow.com/users/10758799/jelle-van-der-heijden"}, "reply_to_user": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1547649296, "post_id": 54217606, "comment_id": 95264324, "body": "and where do i say what the loop must do (i don&#39;t have any experience with loops) @nicomp i don&#39;t have any loops yet because i dont know how they work sorry"}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 1, "creation_date": 1547653968, "post_id": 54217606, "comment_id": 95267223, "body": "@JellevanderHeijden The point of SO is that you make an attempt and we help. If you don &#39;t know anything about loops, that&#39;s OK, but we expect you to study up a little then we will help you. I would observe that you posted some moderately complex code that, if you wrote it, indicates you have the skillz to figure out a little loop knowledge."}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1547652114, "last_edit_date": 1547652114, "creation_date": 1547650781, "answer_id": 54219813, "question_id": 54217606, "link": "https://stackoverflow.com/questions/54217606/making-a-loop-to-execute-same-code-multiple-times/54219813#54219813", "title": "Making a loop to execute same code multiple times", "body": "<p>Since we cannot do all the work for you, this should give you an idea how the loop could look like:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub MyUpdateProcedure()\n    Dim Employees As Range 'define the range of employees\n    Set Employees = ThisWorkbook.Worksheets(\"SheetName\").Range(\"F82:F96\")\n\n    Dim CurrentWorkbook As Workbook\n    Const EmployePath As String = \"J:\\Planning\\Medewerkers\\\"\n\n\n    Dim Employe As Range\n    For Each Employe In Employees 'loop throug all employees\n        'open the workbook\n        Set CurrentWorkbook = Workbooks.Open(EmployePath &amp; Employe.Value &amp; \".xlsm\")\n\n        With CurrentWorkbook.Sheets(\"Blad1\")\n            'your stuff here\n        End With\n\n\n        'your other stuff here\n\n        'save and close workbook\n        CurrentWorkbook.Close SaveChanges:=True\n    Next Employe\nEnd Sub\n</code></pre>\n\n<p>Note that you have to avoid <code>ActiveWorkbook</code> and instead set the opened workbook into a variable like <code>Set CurrentWorkbook = Workbooks.Open</code> that you can easily use then.</p>\n\n<p>Also make sure that <strong>all</strong> your <code>Range(\u2026)</code> objects have a workbook/worksheet specified like <code>ThisWorkbook.Worksheets(\"SheetName\").Range(\u2026)</code> otherwise Excel guesses which worksheet you mean.</p>\n\n<hr>\n\n<p>Also be aware of errors:</p>\n\n<pre><code>Set CurrentWorkbook = Workbooks.Open(EmployePath &amp; Employe.Value &amp; \".xlsm\")\n</code></pre>\n\n<p>will throw an error if the workbook does not exist so you might want to catch it:</p>\n\n<pre><code>    'open the workbook\n    Set CurrentWorkbook = Nothing 'initialize since we are in a loop!\n    On Error Resume Next 'next line throws an error if file not found so catch it\n    Set CurrentWorkbook = Workbooks.Open(EmployePath &amp; Employe.Value &amp; \".xlsm\")\n    On Error GoTo 0 'always re-activate error reporting!\n\n    If Not CurrentWorkbook Is Nothing Then\n        'file for employee was found\n        With CurrentWorkbook.Sheets(\"Blad1\")\n            'your stuff here\n        End With\n\n\n        'your other stuff here\n\n        'save and close workbook\n        CurrentWorkbook.Close SaveChanges:=True\n    Else\n        'file for employee was not found\n    End If\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 10758799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8872e70c5874947701d57516acd9d9c?s=128&d=identicon&r=PG&f=1", "display_name": "Jelle van der Heijden", "link": "https://stackoverflow.com/users/10758799/jelle-van-der-heijden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 54219813, "answer_count": 1, "score": -1, "last_activity_date": 1547652114, "creation_date": 1547643579, "last_edit_date": 1547651969, "question_id": 54217606, "link": "https://stackoverflow.com/questions/54217606/making-a-loop-to-execute-same-code-multiple-times", "title": "Making a loop to execute same code multiple times", "body": "<p>I need some help to create a loop from my code</p>\n\n<p>The code has two main functions:</p>\n\n<ol>\n<li>Copy and paste general data to another workbook</li>\n<li>Copy and paste employee data to another workbook</li>\n</ol>\n\n<p>I want to make a loop of my code (code is shown below). I can make this code 15 times and it will work but I think that a loop is better. I don't have any experience with loops.</p>\n\n<p>So when I press a button on my sheet it copies the general data and opens a other workbook, then it goes back tot he main workbook and copies the employee data and paste them in the other workbook.</p>\n\n<p>The workbook that needs to be opened is found in range F82:F96, so first F82 then F83... and so on, until it reaches F96 and then the code must stop.</p>\n\n<p>The general data is always found in row 15 &amp; 16.</p>\n\n<p>The employee data is found with the same string as the workbook that must be opened. The row after the string must me copied and paste in the other workbook. So for example (G82:DI82).</p>\n\n<p><strong>What I have</strong></p>\n\n<p>I made a code that works for 1 employee in cell(F82) the code below opens the workbook of this employee then copies the general data then find the right column and row to paste. Then I paste the data then it goes back tot he main workbook and copies the data which belongs to he employee (G82:DI82) an paste this data in the other workbook. Then it saves closes the opened workbook. The main workbook stays open.</p>\n\n<p><strong>What I expect</strong></p>\n\n<p>I need a loop to repeat the code. So first the employee wich is in (F82) then the employee which in (F83) and so on. </p>\n\n<p>The code:</p>\n\n<pre><code>Private Sub mUpdate_Click()\n\nDim General As Range\nDim employe1hours As Range\nDim employepaste As Range\nDim employepastehours As Range\nDim CurrentweekColumn As Range\nDim Currentweekpaste As Range\n\nDim employepath As String\nDim employe1 As String\nDim rowstr As String\nDim Foundrow As Range\nDim Currentweek As String\n\n\nemployepath = \"J:\\Planning\\Medewerkers\\\"\nCurrentweek = Range(\"B7\").Value\nemploye1 = Range(\"F82\").Value\nrowstr = Range(\"A2\").Value\n\n    With ActiveWorkbook.Sheets(\"Planning\").Range(\"14:14\")\n    Set CurrentweekColumn = .find(what:=Currentweek, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n    End With\n\n        Set General = ActiveWorkbook.Sheets(\"Planning\").Range(Cells(15, CurrentweekColumn.Column), Cells(16, CurrentweekColumn.Offset(0, 106).Column))\n        General.Copy\n\n        Workbooks.Open (employepath &amp; employe1 &amp; \".xlsm\")\n\n            With ActiveWorkbook.Sheets(\"Blad1\").Range(\"14:14\")\n            Set Currentweekpaste = .find(what:=Currentweek, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n            End With\n\n            With ActiveWorkbook.Sheets(\"Blad1\").Range(\"A:A\")\n            Set Foundrow = .find(what:=rowstr, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n            End With\n\n            Set employepaste = ActiveWorkbook.Sheets(\"Blad1\").Range(Cells(Foundrow.Row, Currentweekpaste.Column).Address)\n            employepaste.PasteSpecial Paste:=xlPasteFormats\n            employepaste.PasteSpecial Paste:=xlPasteValues\n\n                Workbooks(rowstr &amp; \".xlsm\").Activate\n                Set employe1hours = ActiveWorkbook.Sheets(\"Planning\").Range(Cells(82, CurrentweekColumn.Column), Cells(82, CurrentweekColumn.Offset(0, 106).Column))\n                employe1hours.Copy\n\n                Workbooks(employe1 &amp; \".xlsm\").Activate\n                Set employepastehours = ActiveWorkbook.Sheets(\"Blad1\").Range(Cells(Foundrow.Offset(2, 0).Row, Currentweekpaste.Column).Address)\n                employepastehours.PasteSpecial Paste:=xlPasteValues\n\n                ActiveWorkbook.Save\n                ActiveWorkbook.Close\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1547642056, "post_id": 54217116, "comment_id": 95259932, "body": "Don&#39;t use <code>Selection</code>. Instead specify the specific sheet <code>sh</code> and a range like <code>sh.Range(&quot;K8&quot;)</code>. Also see <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>"}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1547643649, "creation_date": 1547643649, "answer_id": 54217621, "question_id": 54217116, "link": "https://stackoverflow.com/questions/54217116/copy-paste-value-to-the-end-of-datatable-for-each-worksheet-in-workbook/54217621#54217621", "title": "copy &amp; paste value to the end of datatable for each worksheet in workbook", "body": "<p>It's not clear how you define the last row. I have used J as the reference column so change to suit. As PEH says, using Select(ion) is dicey as</p>\n\n<pre><code>Sub x()\n\nDim sh As Worksheet, n As Long\n\nFor Each sh In ActiveWorkbook.Worksheets\n    If (sh.Name &lt;&gt; \"bla\") And (sh.Name &lt;&gt; \"blub\") Then\n        With sh\n            n = .Range(\"J\" &amp; Rows.Count).End(xlUp).Row\n            .Range(\"K8:K\" &amp; n).Value = .Range(\"C1\").Value\n        End With\n    End If\nNext sh\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 6654188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65e6ddcbdbb138229132aec3750880b6?s=128&d=identicon&r=PG&f=1", "display_name": "Ramon", "link": "https://stackoverflow.com/users/6654188/ramon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 54217621, "answer_count": 1, "score": 0, "last_activity_date": 1547643649, "creation_date": 1547641779, "last_edit_date": 1547641961, "question_id": 54217116, "link": "https://stackoverflow.com/questions/54217116/copy-paste-value-to-the-end-of-datatable-for-each-worksheet-in-workbook", "title": "copy &amp; paste value to the end of datatable for each worksheet in workbook", "body": "<p>I have different sheets in a Workbook. In each sheet in \"C1\" is a value I want to have applied to all rows starting from \"K8\" until the last row of data. I want to do this for each sheet. </p>\n\n<p>I've managed to copy and paste the value per sheet. But filling the value to the end of the data is the tricky part for me. </p>\n\n<p>The Selection.AutoFill only works for the active sheet. It does the job correct, but all the other sheets, only have \"K8\" filled. </p>\n\n<pre><code>Dim sh As Worksheet\n\nFor Each sh In ActiveWorkbook.Worksheets\n        If (sh.Name &lt;&gt; \"bla\") And (sh.Name &lt;&gt; \"blub\") Then\n            With sh\n            sh.Range(\"C1\").Copy\n            sh.Range(\"K8\").PasteSpecial Paste:=xlPasteValues\n            Selection.AutoFill Destination:=Range(Selection, ActiveCell.Offset(0, -1).End(xlDown).Offset(0, 1))\n            End With\n        End If\n    Next sh\n</code></pre>\n\n<p>I'd like to have the Autofill part work for all the sheets in the workbook. Can anyone help? </p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1547641285, "post_id": 54216860, "comment_id": 95259552, "body": "If you have Adobe Acrobat Pro (not reader), you can use COM automation to achieve this. If you don&#39;t, you can&#39;t reliably automate actions on PDFs (barring hacky solutions using Internet Explorer to open the PDF file and print it)."}, {"owner": {"reputation": 2892, "user_id": 1935222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gx2zd.png?s=128&g=1", "display_name": "4dmonster", "link": "https://stackoverflow.com/users/1935222/4dmonster"}, "edited": false, "score": 0, "creation_date": 1547642384, "post_id": 54216860, "comment_id": 95260102, "body": "We use FoxIt PDF to view an print PDFs. It is fast and handy."}, {"owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "edited": false, "score": 0, "creation_date": 1547644762, "post_id": 54216860, "comment_id": 95261425, "body": "This seems to be an issue of the Foxit installation. Maybe try to reinstall it? You wrote &quot;Acrobat Reader is installed&quot;. So only one of both can have the &#39;print&#39; verb. Maybe the current situation came from having both installed."}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 10874206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2faa66fb63023f555d37d6827f353ab3?s=128&d=identicon&r=PG&f=1", "display_name": "Ezra", "link": "https://stackoverflow.com/users/10874206/ezra"}, "is_accepted": false, "score": 1, "last_activity_date": 1547646343, "creation_date": 1547646343, "answer_id": 54218414, "question_id": 54216860, "link": "https://stackoverflow.com/questions/54216860/printing-pdf-file-with-vba-is-not-doing-anything/54218414#54218414", "title": "Printing pdf file with VBA is not doing anything", "body": "<p>I found the issue, the problem was that the default application for pdf was Microsoft Edge, I changed it to Acrobat Reader, and now it is printing.</p>\n"}], "owner": {"reputation": 111, "user_id": 10874206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2faa66fb63023f555d37d6827f353ab3?s=128&d=identicon&r=PG&f=1", "display_name": "Ezra", "link": "https://stackoverflow.com/users/10874206/ezra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 548, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1547646343, "creation_date": 1547640830, "last_edit_date": 1547645433, "question_id": 54216860, "link": "https://stackoverflow.com/questions/54216860/printing-pdf-file-with-vba-is-not-doing-anything", "title": "Printing pdf file with VBA is not doing anything", "body": "<p>I want to print external pdf files from MS-Access using VBA.</p>\n\n<p>I use this command:</p>\n\n<pre><code>CreateObject(\"Shell.Application\").Namespace(0).ParseName(\"file_to_print.pdf\").InvokeVerb(\"Print\")\n</code></pre>\n\n<p>Printing with this command text files (*.txt) works fine, but pdf does not.</p>\n\n<p>The context menu when right clicking on the pdf file has no print Option:</p>\n\n<p><img src=\"https://i.stack.imgur.com/M8pqL.png\" alt=\"\">]</p>\n\n<p>The context menu of the text file has a print command. I read somewhere that this is needed for the above printing to work.</p>\n\n<p>Any solution for this?</p>\n\n<p>I use Windows 10, and Acrobat Reader is installed.</p>\n"}, {"tags": ["excel", "vba", "object"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 2, "creation_date": 1547638677, "post_id": 54216170, "comment_id": 95258053, "body": "The rule is to ask one question per thread. Perhaps you like to amend your post to contain only one question and ask another one to quench your additional thirst for knowledge."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10921939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5217c7f72affc954e17706ee2254a777?s=128&d=identicon&r=PG&f=1", "display_name": "M Breganski", "link": "https://stackoverflow.com/users/10921939/m-breganski"}, "edited": false, "score": 0, "creation_date": 1547640166, "post_id": 54216373, "comment_id": 95258937, "body": "Ah I did think that this may be the case, however I also tried changing the WS reference to the default shown in VBE, so from <code>With Wb1.Sheets(1)</code> to <code>With Wb1.Sheets(&quot;Sheet1&quot;)</code> but still get same error. Can you be a little more specific with the application? Not sure if this would correct: <code>With Wb1.Debug.Print Worksheets(&quot;MySheet&quot;).Name Debug.Print Sheet1.Name </code>"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1547645476, "post_id": 54216373, "comment_id": 95261865, "body": "Try changing your <code>With</code> statement to <code>With WB1.Sheet1</code> as suggested by Variatus"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1547684190, "post_id": 54216373, "comment_id": 95280555, "body": "Don&#39;t understand the error you get, unless it is in With Wb1.Debug.Print. Debug isn&#39;t a member of the workbook object. The code runs just as I published it without any &quot;With&quot;. The print appears in the Immediate window."}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1547639070, "creation_date": 1547639070, "answer_id": 54216373, "question_id": 54216170, "link": "https://stackoverflow.com/questions/54216170/delete-rows-based-on-cell-criteria-in-another-sheet/54216373#54216373", "title": "Delete rows based on cell criteria in another sheet", "body": "<p>Each worksheet has a <code>Name</code> and a <code>CodeName</code>. By default both of them are the same. However, once the user changes the tab name they will be different. This is because the <code>CodeName</code> can't be changed from the spreadsheet interface. It takes access to VBA to change it. Therefore, if you refer to the worksheets by their <code>CodeName</code> in your code the user could give whatever name to the sheet and it wouldn't bother your code. Example.</p>\n\n<p>Name = \"MySheet\"\nCodeName = \"Sheet1\" (You can change this name in the VBE's property window)\nNow refer to the sheet in the code as shown below.</p>\n\n<pre><code>Debug.Print Worksheets(\"MySheet\").Name\nDebug.Print Sheet1.Name\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10921939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5217c7f72affc954e17706ee2254a777?s=128&d=identicon&r=PG&f=1", "display_name": "M Breganski", "link": "https://stackoverflow.com/users/10921939/m-breganski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547639070, "creation_date": 1547638289, "last_edit_date": 1547638973, "question_id": 54216170, "link": "https://stackoverflow.com/questions/54216170/delete-rows-based-on-cell-criteria-in-another-sheet", "title": "Delete rows based on cell criteria in another sheet", "body": "<p>I have a relatively simple question. Currently I have some code that is working well but not efficient. I have about 500 cost centres each with their own workbook which I have consolidated into a central repository (reference - Wb2 in code below). The code copies ranges from each open template (Wb1) into my consolidation (Wb2). Questions are enumerated after current code tagged below:</p>\n\n<pre><code>\nSub CopyData()\n    Dim Wb1 As Workbook, wb2 As Workbook, wB As Workbook\n    Dim rngToCopy1 As Range\n    Dim rngToCopy2 As Range\n    Dim rngToCopy3 As Range\n    Dim rngToCopy4 As Range\n    Dim rngToCopy5 As Range\n    Set wb2 = ThisWorkbook\n    Application.Calculation = xlManual\n\n    For Each wB In Application.Workbooks\n            If Not Left(wB.Name, 18) = \"Consolidation Test\" Then\n            Set Wb1 = wB\n            Exit For\n            End If\n    Next\n\n        'Forecast Data\n        With Wb1.Sheets(1)\n        Set rngToCopy1 = .Range(\"A11:O11\", .Cells(.Rows.Count, \"A\").End(xlUp))\n        End With\n            wb2.Sheets(7).Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Resize(rngToCopy1.Rows.Count, 15).Value = rngToCopy1.Value\n            wb2.Sheets(7).Range(\"P\" &amp; Rows.Count).End(xlUp).Offset(1).Resize(rngToCopy1.Rows.Count).Value = Sheets(3).Range(\"J1\").Value\n\n        'Planning (budget) Data\n        With Wb1.Sheets(3)\n        Set rngToCopy2 = .Range(\"A10:S10\", .Cells(.Rows.Count, \"A\").End(xlUp))\n        End With\n            wb2.Sheets(8).Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Resize(rngToCopy2.Rows.Count, 19).Value = rngToCopy2.Value\n            wb2.Sheets(8).Range(\"T\" &amp; Rows.Count).End(xlUp).Offset(1).Resize(rngToCopy2.Rows.Count).Value = Sheets(3).Range(\"J1\").Value\n\n        'Travel Data\n        With Wb1.Sheets(5)\n        Set rngToCopy3 = .Range(\"A6:AA6\", .Cells(.Rows.Count, \"A\").End(xlUp))\n        End With\n            wb2.Sheets(9).Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Resize(rngToCopy3.Rows.Count, 27).Value = rngToCopy3.Value\n            wb2.Sheets(9).Range(\"AB\" &amp; Rows.Count).End(xlUp).Offset(1).Resize(rngToCopy3.Rows.Count).Value = Sheets(3).Range(\"J1\").Value\n\n        'Vacancy Data\n        With Wb1.Sheets(6)\n        Set rngToCopy4 = .Range(\"A6:O6\", .Cells(.Rows.Count, \"A\").End(xlUp))\n        End With\n            wb2.Sheets(10).Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Resize(rngToCopy4.Rows.Count, 15).Value = rngToCopy4.Value\n            wb2.Sheets(10).Range(\"P\" &amp; Rows.Count).End(xlUp).Offset(1).Resize(rngToCopy4.Rows.Count).Value = Sheets(3).Range(\"J1\").Value\n\n        'Manpower Data\n        With Wb1.Sheets(7)\n        Set rngToCopy5 = .Range(\"A6:O6\", .Cells(.Rows.Count, \"A\").End(xlUp))\n        End With\n            wb2.Sheets(11).Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Resize(rngToCopy5.Rows.Count, 15).Value = rngToCopy5.Value\n            wb2.Sheets(11).Range(\"P\" &amp; Rows.Count).End(xlUp).Offset(1).Resize(rngToCopy5.Rows.Count).Value = Sheets(3).Range(\"J1\").Value\n\n\n\nEnd Sub\n</code></pre>\n\n<p>I am now dealing with reiterations of template submissions so the exercise below becomes one of deleting as opposed to just copying and pasting. I'll need some sample code to check if Range(\"J1\") on Sheets(3) appears in any of the other ranges I am pasting to: </p>\n\n<pre><code>With Wb1.Sheets(1)\n        Set rngToCopy1 = .Range(\"A11:O11\", .Cells(.Rows.Count, \"A\").End(xlUp))\n        End With\n            wb2.Sheets(7).Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Resize(rngToCopy1.Rows.Count, 15).Value = rngToCopy1.Value\n            wb2.Sheets(7).Range(\"P\" &amp; Rows.Count).End(xlUp).Offset(1).Resize(rngToCopy1.Rows.Count).Value = Sheets(3).Range(\"J1\").Value\n</code></pre>\n\n<p>In other words, what code would I use to check if J11 on sheet 3 first appears anywhere in column P on sheet 7 and if so delete? Only then should the paste operation run. The aim here is to delete data from any cost centres that have already been imported into my sheet.</p>\n\n<p>Hope question and description of issue are clear? Reason I need a new post is because it is difficult for a novice to adapt already posted examples out there to my current code.</p>\n\n<p>Thanks for your expertise!   </p>\n"}, {"tags": ["excel", "vba", "radio-button"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 2, "creation_date": 1547637070, "post_id": 54215738, "comment_id": 95257125, "body": "...GroupName &amp;&amp; n doesn&#39;t look right. One &amp; should suffice."}, {"owner": {"reputation": 34, "user_id": 8532023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05a30b1229a2d2205b0cd582b50813fe?s=128&d=identicon&r=PG&f=1", "display_name": "Zr.Ms. Bruinvis", "link": "https://stackoverflow.com/users/8532023/zr-ms-bruinvis"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1547640909, "post_id": 54215738, "comment_id": 95259354, "body": "Thanks Variatus, this was the solution (I will proceed to bump my head against the wall for the coming minutes)"}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1547641891, "post_id": 54216988, "comment_id": 95259851, "body": "No answer needed, because the question is off-topic due to <i>&quot;Questions about a problem that can no longer be reproduced or that was caused by a simple typographical error. While similar questions may be on-topic here, these are often resolved in a manner unlikely to help future readers. &quot;</i> Therefore it should be close voted I think."}, {"owner": {"reputation": 34, "user_id": 8532023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05a30b1229a2d2205b0cd582b50813fe?s=128&d=identicon&r=PG&f=1", "display_name": "Zr.Ms. Bruinvis", "link": "https://stackoverflow.com/users/8532023/zr-ms-bruinvis"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1547733440, "post_id": 54216988, "comment_id": 95299459, "body": "If anyone wants to copy an excel sheet with radiobuttons with separate groups then this or similar code would be needed.  Whether or not this code is useful to others is not something I&#39;d know"}], "tags": [], "owner": {"reputation": 34, "user_id": 8532023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05a30b1229a2d2205b0cd582b50813fe?s=128&d=identicon&r=PG&f=1", "display_name": "Zr.Ms. Bruinvis", "link": "https://stackoverflow.com/users/8532023/zr-ms-bruinvis"}, "is_accepted": true, "score": 0, "last_activity_date": 1547641283, "creation_date": 1547641283, "answer_id": 54216988, "question_id": 54215738, "link": "https://stackoverflow.com/questions/54215738/handling-activex-radio-buttons-groupname-when-duplicating-sheet-with-activex-r/54216988#54216988", "title": "Handling ActiveX radio buttons (groupname) when duplicating sheet with ActiveX radio", "body": "<blockquote>\n  <p>.GroupName &amp;&amp; n doesn't look right. One &amp; should suffice. \u2013 Variatus </p>\n</blockquote>\n"}], "owner": {"reputation": 34, "user_id": 8532023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05a30b1229a2d2205b0cd582b50813fe?s=128&d=identicon&r=PG&f=1", "display_name": "Zr.Ms. Bruinvis", "link": "https://stackoverflow.com/users/8532023/zr-ms-bruinvis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 54216988, "answer_count": 1, "score": 0, "last_activity_date": 1547641283, "creation_date": 1547636865, "last_edit_date": 1547640906, "question_id": 54215738, "link": "https://stackoverflow.com/questions/54215738/handling-activex-radio-buttons-groupname-when-duplicating-sheet-with-activex-r", "title": "Handling ActiveX radio buttons (groupname) when duplicating sheet with ActiveX radio", "body": "<p>I have an excel source sheet with many ActiveX radiobuttons which I'm copying using a VBA script.</p>\n\n<p>For this to work I need to adapt the groupname of the radiobuttons to the name of the sheet (available as variable n )</p>\n\n<p>The solution I'm going for is to add the name of the sheet to the end or start of each groupname; </p>\n\n<pre><code>currentradiobuttongroupname = currentradiobuttongroupname + n\n</code></pre>\n\n<p>So far I have:</p>\n\n<pre><code>Sub radioomzetter(ActiveSheet, n)\n  Dim Ctrl As OLEObject\n  For Each Ctrl In ActiveSheet.OLEObjects\n      If TypeName(Ctrl.Object) = \"OptionButton\" Then\n          Ctrl.Object.GroupName = Ctrl.Object.GroupName &amp;&amp; n\n      End If\n  Next Ctrl\nEnd Sub\n</code></pre>\n\n<p>Unfortunately, this gives a syntax error. I'd appreciate any and all help.</p>\n"}, {"tags": ["excel", "vba", "loops", "if-statement", "range"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10921695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c9541deb3f47fd55317913fa38f0e8?s=128&d=identicon&r=PG&f=1", "display_name": "Uru", "link": "https://stackoverflow.com/users/10921695/uru"}, "edited": false, "score": 1, "creation_date": 1547637041, "post_id": 54215614, "comment_id": 95257099, "body": "Hi SJR,  Thanks! Using the offset solved it. No, using SUMIFS it not what I am looking for at the moment."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1547636481, "creation_date": 1547636481, "answer_id": 54215614, "question_id": 54215470, "link": "https://stackoverflow.com/questions/54215470/how-to-write-two-if-statements-for-different-ranges-in-a-loop-vba/54215614#54215614", "title": "How to write two IF statements for different ranges in a loop, VBA", "body": "<p>Does this solve your problem - referencing the relevant cell in column C? OFFSET provides a relative reference, in this case look 3 columns to the left of F.</p>\n\n<pre><code>Sub Test1()\n\nDim rngnumbers As Range, rngnames As Range, MultipleRange As Range, numb As Range\n\nSet rngnumbers = Sheet2.Range(\"F2:F999\")\nSet rngnames = Sheet2.Range(\"C2:C999\")\nSet MultipleRange = Union(rngnumbers, rngnames)\n\nFor Each numb In rngnumbers\n    If numb.Value &gt;= 100 Then\n        If numb.Offset(, -3) = \"John\" Or numb.Offset(, -3) = \"Tom\" Then\n            Sheet1.Range(\"I999\").End(xlUp).Offset(1, 0).Value = numb.Value\n        End If\n    End If\nNext numb\n\nEnd Sub\n</code></pre>\n\n<p>Have you considered SUMIFS instead?</p>\n"}, {"tags": [], "owner": {"reputation": 172, "user_id": 10627624, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-q24pnMMCBhM/AAAAAAAAAAI/AAAAAAAAAI0/9V6VmJktiDI/photo.jpg?sz=128", "display_name": "Alexey C", "link": "https://stackoverflow.com/users/10627624/alexey-c"}, "is_accepted": false, "score": 1, "last_activity_date": 1547637084, "creation_date": 1547637084, "answer_id": 54215805, "question_id": 54215470, "link": "https://stackoverflow.com/questions/54215470/how-to-write-two-if-statements-for-different-ranges-in-a-loop-vba/54215805#54215805", "title": "How to write two IF statements for different ranges in a loop, VBA", "body": "<p>You want something like this?</p>\n\n<pre><code>Sub Test1()\n\n        Dim lRow As Long, r As Long\n        lRow = 1000 'last row in your data\n        Dim ws As Worksheet\n        Set ws = Worksheets(\"List with your data\")\n\n        For i = 2 To lRow\n            If ws.Range(\"F\" &amp; i) &gt; 100 Then\n                If ws.Range(\"C\" &amp; i).Value = \"John\" Or ws.Range(\"C\" &amp; i).Value = \"Tom\" Then\n                    Worksheets(\"Another sheet sheet\").Range(\"A\" &amp; r) = Range(\"C\" &amp; i).Value ' r - Row, where we want to enter uor text\n                    r = r + 1 'if you want to put next name on the next row\n                End If\n            End If\n        Next\n\n    End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 1, "last_activity_date": 1547638221, "creation_date": 1547638221, "answer_id": 54216152, "question_id": 54215470, "link": "https://stackoverflow.com/questions/54215470/how-to-write-two-if-statements-for-different-ranges-in-a-loop-vba/54216152#54216152", "title": "How to write two IF statements for different ranges in a loop, VBA", "body": "<h1>Two Ifs in a Loop</h1>\n\n<h2>Union Version</h2>\n\n<pre><code>Option Explicit\n\nSub Test1()\n\n    Const cFirst As Integer = 2\n    Const cLast As Integer = 999\n    Const cCol1 As Variant = \"F\"\n    Const cCol2 As Variant = \"C\"\n    Const cCol3 As Variant = \"I\"\n\n    Dim i As Integer\n    Dim rngU As Range\n\n    With Sheet2\n        For i = cFirst To cLast\n            If IsNumeric(.Cells(i, cCol1)) And .Cells(i, cCol1) &gt;= 100 Then\n                If .Cells(i, cCol2) = \"John\" _\n                        Or .Cells(i, cCol2) = \"Tom\" Then\n                    If Not rngU Is Nothing Then\n                        Set rngU = Union(rngU, .Cells(i, cCol1))\n                      Else\n                        Set rngU = .Cells(i, cCol1)\n                    End If\n                End If\n            End If\n        Next\n    End With\n\n    If Not rngU Is Nothing Then\n        rngU.Copy Sheet1.Cells(cLast, cCol3).End(xlUp).Offset(1, 0)\n        Set rngU = Nothing\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 116, "user_id": 5982062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFQvV.jpg?s=128&g=1", "display_name": "wallyeye", "link": "https://stackoverflow.com/users/5982062/wallyeye"}, "is_accepted": false, "score": 0, "last_activity_date": 1547643427, "creation_date": 1547643427, "answer_id": 54217565, "question_id": 54215470, "link": "https://stackoverflow.com/questions/54215470/how-to-write-two-if-statements-for-different-ranges-in-a-loop-vba/54217565#54217565", "title": "How to write two IF statements for different ranges in a loop, VBA", "body": "<p>I normally work with arrays:</p>\n\n<pre><code>Sub Test1()\n\nDim rngnumbers    As Excel.Range\n\nDim arrVals       As variant \n\nDim lngRow        As long\n\nArrvals = Sheet2.Range(\"C2:F999\").value\n\n    For Lngrow = lbound(arrvals,1) to ubound(arrvals,1)\n        If arrvals(lngrow,4) &gt;= 100 Then\n                If arrvals(lngrow,1)= \"John\" Or arrvals(lngrow,1) = \"Tom\" Then '''The problem here is that it only looks at the cell C2 and not the adjacent cell\n                    Sheet1.Range(\"I999\").End(xlUp).Offset(1, 0).Value = arrvals(lngrow,4)\n                Else\n                End If\n        End If\n    Next lngrow \n\nEnd Sub\n</code></pre>\n\n<p>Actually I would probably build an output array as well, but my thumb is tired...</p>\n"}], "owner": {"reputation": 25, "user_id": 10921695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c9541deb3f47fd55317913fa38f0e8?s=128&d=identicon&r=PG&f=1", "display_name": "Uru", "link": "https://stackoverflow.com/users/10921695/uru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 552, "favorite_count": 0, "accepted_answer_id": 54215614, "answer_count": 4, "score": 2, "last_activity_date": 1547643427, "creation_date": 1547635973, "last_edit_date": 1547641111, "question_id": 54215470, "link": "https://stackoverflow.com/questions/54215470/how-to-write-two-if-statements-for-different-ranges-in-a-loop-vba", "title": "How to write two IF statements for different ranges in a loop, VBA", "body": "<p>I am working on an Excel document using VBA. This document contains a database with multiple columns, but for simplicity, let's say I have 2 columns:</p>\n\n<ul>\n<li>Column C corresponds to names</li>\n<li>Column F corresponds to numbers.</li>\n</ul>\n\n<p>I'm trying to create a macro that checks all the numbers in column F (with a loop). If the number is above 100, then check the adjacent cell in column C. If the name corresponds to a condition (let's say corresponds to John or Tom), then add the value of the number in another sheet. If none of those apply, check the next cell.</p>\n\n<p>My problem is that I can't find a way to define the cells in column C (Creating a variable/object to call the cells or calling directly the adjacent cell).</p>\n\n<p>My code looks like this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Test1()\n\n    Dim rngnumbers, rngnames, MultipleRange As Range\n\n    Set rngnumbers = Sheet2.Range(\"F2:F999\")    \n    Set rngnames = Sheet2.Range(\"C2:C999\")\n    Set MultipleRange = Union(rngnumbers, rngnames)\n\n        For Each numb In rngnumbers\n            If numb.Value &gt;= 100 Then\n                    If Sheet2.Range(\"C2\") = \"John\" Or Sheet2.Range(\"C2\") = \"Tom\" Then '''The problem here is that it only looks at the cell C2 and not the adjacent cell\n                        Sheet1.Range(\"I999\").End(xlUp).Offset(1, 0).Value = numb.Value\n                    Else\n                    End If\n            End If\n        Next numb\n\nEnd Sub\n</code></pre>\n\n<p>I tried modifying the line:</p>\n\n<p><code>'If Sheet2.Range(\"C2\") = \"John\" Or Sheet2.Range(\"C2\") = \"Tom\"</code> Then'\nto something like:\n<code>'newname.String = \"John\" '</code></p>\n\n<p>But I can't find a way to define <code>newname</code>.\nAnother idea would be to increment the If statement for the names within the For loop.</p>\n\n<p>Additional note:\nI am also not using formulas directly within Excel as I don't want any blank cells or zeros when the if functions are False.</p>\n"}, {"tags": ["excel", "vba", "vlookup"], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1547636036, "creation_date": 1547636036, "answer_id": 54215485, "question_id": 54215179, "link": "https://stackoverflow.com/questions/54215179/how-to-create-an-auto-updatable-named-range-with-all-my-sheet-names/54215485#54215485", "title": "How to create an auto updatable named range with all my sheet names?", "body": "<p>You could try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim ws As Worksheet\n    Dim SearchString As String\n    Dim LookUpRange As Range, FoundRange As Range\n    Dim VLookupCol As Long\n\n    SearchString = \"Bingo\"\n\n    'Number of columns  for VLookup\n    VLookupCol = 3\n\n    For Each ws In ThisWorkbook.Worksheets\n        'Search in each worksheet used range\n\n        With ws\n            Set LookUpRange = .UsedRange\n            'Found range\n            Set FoundRange = LookUpRange.Find(what:=SearchString, LookIn:=xlValues, LookAt:=xlPart, MatchCase:=False)\n\n            If Not FoundRange Is Nothing Then\n                MsgBox .Cells(FoundRange.Row, FoundRange.Column + VLookupCol).Value\n            End If\n        End With\n\n    Next ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10921800, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206594888684339/picture?type=large", "display_name": "Pedro Paulo Gon&#231;alves Bernardo", "link": "https://stackoverflow.com/users/10921800/pedro-paulo-gon%c3%a7alves-bernardo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1547636341, "creation_date": 1547634934, "last_edit_date": 1547636341, "question_id": 54215179, "link": "https://stackoverflow.com/questions/54215179/how-to-create-an-auto-updatable-named-range-with-all-my-sheet-names", "title": "How to create an auto updatable named range with all my sheet names?", "body": "<p>I am trying to create a VLOOKUP to search strings in all my worksheets. I found the code to do that however I need to have a named range with all my sheet names on it. However the file I am creating will have new sheets added to it every week and because of this I need to have that named range with all my sheet names automatically update when I add, rename or remove sheets.</p>\n\n<p>How can I go about this?</p>\n"}, {"tags": ["excel", "vba", "excel-2016"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1547634045, "post_id": 54214756, "comment_id": 95255437, "body": "<a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a> should speed it up. Test if it takes the same/similar amount of time if you do it manually with ctrl+x/ctrl+v. If yes then it is no programming issue, but an issue with your worksheet and the data it contains."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1547634489, "post_id": 54214756, "comment_id": 95255688, "body": "Are you sure that you only have 300 rows? This is executed in no time if the sheet is small, but takes forever if a cell  far down/right is filled (maybe accidently)."}, {"owner": {"reputation": 391, "user_id": 6370369, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/77985c9576ec365d3dc4172ee88517df?s=128&d=identicon&r=PG", "display_name": "RShome", "link": "https://stackoverflow.com/users/6370369/rshome"}, "edited": false, "score": 0, "creation_date": 1547635329, "post_id": 54214756, "comment_id": 95256180, "body": "Hi, I have tried this and still an issue on line                                     Selection.Insert Shift:=xlToRight, I even tried using a named range to only select the 300 rows in the column with data and still takes ages"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1547635347, "post_id": 54214756, "comment_id": 95256190, "body": "Have you tried any other methods, like insert the column, then cut and paste it, but just the data.  Also, maybe worth as @FunThomas says, checking what data you have.  Maybe try calculation off for this operation to?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1547636270, "post_id": 54214756, "comment_id": 95256686, "body": "I ask again: How long does it take if you do it manually with ctrl+x/ctrl+v?"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1547636273, "post_id": 54214756, "comment_id": 95256689, "body": "Could you post the whole code. If it is taking forever, you might have the code in an Event and it should be written differently."}, {"owner": {"reputation": 391, "user_id": 6370369, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/77985c9576ec365d3dc4172ee88517df?s=128&d=identicon&r=PG", "display_name": "RShome", "link": "https://stackoverflow.com/users/6370369/rshome"}, "edited": false, "score": 0, "creation_date": 1547636623, "post_id": 54214756, "comment_id": 95256855, "body": "Yes it takes the same amount of time copying and pasting manually."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1547636887, "post_id": 54214756, "comment_id": 95257012, "body": "Press Control-Shift - End  - this will take you to the bottom right of the occupied area of the spread sheet. Is that actually row 300?"}, {"owner": {"reputation": 391, "user_id": 6370369, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/77985c9576ec365d3dc4172ee88517df?s=128&d=identicon&r=PG", "display_name": "RShome", "link": "https://stackoverflow.com/users/6370369/rshome"}, "edited": false, "score": 0, "creation_date": 1547637013, "post_id": 54214756, "comment_id": 95257085, "body": "Yes it takes the same amount of time copying and pasting manually. Actually I tried just copying one call and pasting and it still took a while. The data in the cell is just &#39;ID&quot; ! I&#39;m not able to paste full code due to security where I work."}, {"owner": {"reputation": 391, "user_id": 6370369, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/77985c9576ec365d3dc4172ee88517df?s=128&d=identicon&r=PG", "display_name": "RShome", "link": "https://stackoverflow.com/users/6370369/rshome"}, "edited": false, "score": 0, "creation_date": 1547637808, "post_id": 54214756, "comment_id": 95257519, "body": "Nope definitely only 300 rows of data after pressing CTRL+SHIFT+END"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1547641131, "post_id": 54214756, "comment_id": 95259464, "body": "\u2022 Do you have any events in VBA if so please show their code. \u2022 Did you try to copy paste the data into a completely new workbook and test it their if you got the same issues?"}, {"owner": {"reputation": 391, "user_id": 6370369, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/77985c9576ec365d3dc4172ee88517df?s=128&d=identicon&r=PG", "display_name": "RShome", "link": "https://stackoverflow.com/users/6370369/rshome"}, "edited": false, "score": 0, "creation_date": 1547642428, "post_id": 54214756, "comment_id": 95260128, "body": "Yes I copied all the sheets and macros to a new workbook and still the same performance issues. The file itself is only 10MB so not a massive workbook by any means. No events in VBA either. I think it is to do with the fact there is fair bit of data in multiple sheets?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1547644183, "post_id": 54214756, "comment_id": 95261124, "body": "Well it can can happen if there are many formulas in your sheet especially if they are volatile they can cause a heavy load on re-calculation. Is it slow too if you set calculation to manual before you cut/paste?"}], "answers": [{"comments": [{"owner": {"reputation": 391, "user_id": 6370369, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/77985c9576ec365d3dc4172ee88517df?s=128&d=identicon&r=PG", "display_name": "RShome", "link": "https://stackoverflow.com/users/6370369/rshome"}, "edited": false, "score": 0, "creation_date": 1547737677, "post_id": 54222041, "comment_id": 95302081, "body": "Thanks very much but unfortunately this did not work. I don;t have any formulas or external references. If I ever find a solution I will update this post"}], "tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": false, "score": 2, "last_activity_date": 1547658522, "creation_date": 1547658522, "answer_id": 54222041, "question_id": 54214756, "link": "https://stackoverflow.com/questions/54214756/serious-slow-performance-when-inserting-a-column-in-excel-2016/54222041#54222041", "title": "Serious slow performance when inserting a column in Excel 2016", "body": "<p>Do you have formulas and maybe even external references? Then please try this:</p>\n\n<pre><code>ActiveWorkbook.UpdateLinks = xlUpdateLinksNever\nActiveWorkbook.UpdateRemoteReferences = False\nApplication.Calculation = xlManual\n\nActiveSheet.Columns(\"E:E\").Cut\nActiveSheet.Columns(\"C:C\").Insert Shift:=xlToRight\n\nActiveWorkbook.UpdateLinks = xlUpdateLinksAlways\nActiveWorkbook.UpdateRemoteReferences = True\nApplication.Calculation = xlCalculationAutomatic\n\n' If it's faster, then uncomment following line additionally\n' Application.CalculateFull\n</code></pre>\n"}], "owner": {"reputation": 391, "user_id": 6370369, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/77985c9576ec365d3dc4172ee88517df?s=128&d=identicon&r=PG", "display_name": "RShome", "link": "https://stackoverflow.com/users/6370369/rshome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 618, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547658522, "creation_date": 1547633549, "last_edit_date": 1547634003, "question_id": 54214756, "link": "https://stackoverflow.com/questions/54214756/serious-slow-performance-when-inserting-a-column-in-excel-2016", "title": "Serious slow performance when inserting a column in Excel 2016", "body": "<p>In Excel 2007 there was no issue but when I hit the below line in Excel 2016, it now takes over a minute each time. There are only 300 rows in the column. All I want to do is cut a column and paste it next to another column.</p>\n\n<pre><code>Selection.Insert Shift:=xlToRight\n</code></pre>\n\n<p>Sample code is as follows, but I have 30 odd of these so it is taking half an hour.</p>\n\n<pre><code>Columns(\"E:E\").Select\nSelection.Cut\nColumns(\"C:C\").Select\nSelection.Insert Shift:=xlToRight\n</code></pre>\n\n<p>Any ideas why?</p>\n"}, {"tags": ["iphone", "vba", "macos"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user65839"}, "edited": false, "score": 0, "creation_date": 1547652892, "post_id": 54214731, "comment_id": 95266543, "body": "If you want help with code, you&#39;re going to need to post the code. VB6 doesn&#39;t exist on Mac, so I suspect that&#39;s not the language you mean. (There are a lot of languages that start with &quot;VB&quot; which are slightly or not-so-slightly different.) Also, how does the <a href=\"https://stackoverflow.com/questions/tagged/iphone\">iphone</a> tag apply?"}, {"owner": {"reputation": 1, "user_id": 9923455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd1f37aafba0454250f957189990165?s=128&d=identicon&r=PG&f=1", "display_name": "dip", "link": "https://stackoverflow.com/users/9923455/dip"}, "edited": false, "score": 0, "creation_date": 1549277238, "post_id": 54214731, "comment_id": 95831948, "body": "@PeterCooperJr. Are you sure Windows VB Excel macros not supported to Mac Excel macros?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user65839"}, "edited": false, "score": 0, "creation_date": 1549294913, "post_id": 54214731, "comment_id": 95841960, "body": "This question was initially tagged as <a href=\"https://stackoverflow.com/questions/tagged/vb6\">vb6</a>, though VB Excel macros aren&#39;t the same thing. Some versions of Excel have VBA with similar (though slightly different) functionality. I don&#39;t know how or if VBA or Excel macros work on Mac, I just know that VB6 doesn&#39;t. It looks like somebody changed the wording and tagging to be <a href=\"https://stackoverflow.com/questions/tagged/vba\">vba</a> instead, which might be what you&#39;re looking for. In any event, saying that your code has a method that isn&#39;t found, without posting that code and what method it is that isn&#39;t being found, makes it difficult to know what help you are looking for."}], "owner": {"reputation": 1, "user_id": 9923455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd1f37aafba0454250f957189990165?s=128&d=identicon&r=PG&f=1", "display_name": "dip", "link": "https://stackoverflow.com/users/9923455/dip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547728985, "creation_date": 1547633447, "last_edit_date": 1547728985, "question_id": 54214731, "link": "https://stackoverflow.com/questions/54214731/facing-issue-to-run-vba-functionality-in-macbook", "title": "Facing issue to run VBA functionality in MacBook", "body": "<p>Using Mac book performing operation on Excel. </p>\n\n<p>From MVC application downloading excel template and performing operations. This I can do it successfully in Windows, but not in Mac book. Facing issue 'Method or data member not found\" while opening excel sheet. </p>\n"}, {"tags": ["excel", "vba", "reference"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10921634, "user_type": "registered", "profile_image": "https://graph.facebook.com/2462627200478979/picture?type=large", "display_name": "Tomohiro Kobayashi", "link": "https://stackoverflow.com/users/10921634/tomohiro-kobayashi"}, "edited": false, "score": 0, "creation_date": 1547737984, "post_id": 54217652, "comment_id": 95302298, "body": "Hello Charles, Thank you so much for your speedy response.  It works very well when indirect function only refers to one cell such as &quot;=INDIRECT(Address(2, 1, , , &quot;&quot;Sheet2&quot;&quot;))&quot; That is alright, but if possible, I would like to detect that even if there are more than 1  cell."}, {"owner": {"reputation": 1, "user_id": 10921634, "user_type": "registered", "profile_image": "https://graph.facebook.com/2462627200478979/picture?type=large", "display_name": "Tomohiro Kobayashi", "link": "https://stackoverflow.com/users/10921634/tomohiro-kobayashi"}, "edited": false, "score": 0, "creation_date": 1547739109, "post_id": 54217652, "comment_id": 95303082, "body": "For instance, when I put &quot;=INDEX(A1:A4, MATCH(INDIRECT(C5&amp;&quot;!B3&quot;),Sheet1!$A$3:$A$7,0))&quot; in cell B4 while cell C5 contains &quot;Sheet2&quot;, oRng.Parent.Name is &quot;Sheet1&quot; meaning I cannot detect cell B4 refers to a cell in Sheet2. So, are there any other way to know all sheets that a particular cell refers to? Your support is much appreciated"}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "reply_to_user": {"reputation": 1, "user_id": 10921634, "user_type": "registered", "profile_image": "https://graph.facebook.com/2462627200478979/picture?type=large", "display_name": "Tomohiro Kobayashi", "link": "https://stackoverflow.com/users/10921634/tomohiro-kobayashi"}, "edited": false, "score": 0, "creation_date": 1547743972, "post_id": 54217652, "comment_id": 95305843, "body": "Not without parsing the formula into expressions and evaluating the expressions individually. There are also a lot of corner cases for things like intersections, multiple range operators etc. See my Beta 4.2 of Formula Explorer Pro. <a href=\"http://www.decisionmodels.com/fxl_mgrpro_beta2.htm\" rel=\"nofollow noreferrer\">decisionmodels.com/fxl_mgrpro_beta2.htm</a>"}, {"owner": {"reputation": 1, "user_id": 10921634, "user_type": "registered", "profile_image": "https://graph.facebook.com/2462627200478979/picture?type=large", "display_name": "Tomohiro Kobayashi", "link": "https://stackoverflow.com/users/10921634/tomohiro-kobayashi"}, "edited": false, "score": 0, "creation_date": 1547946281, "post_id": 54217652, "comment_id": 95368219, "body": "Thank you, Charles. Your tool works in a fantastic way! I also would like to write a code to see all the precedents in my VBA code, are there any hints (e.g., functions to be used) for me to realize finding all precedents? Your expertise is highly appreciated because there are no other websites that I can refer to..."}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "reply_to_user": {"reputation": 1, "user_id": 10921634, "user_type": "registered", "profile_image": "https://graph.facebook.com/2462627200478979/picture?type=large", "display_name": "Tomohiro Kobayashi", "link": "https://stackoverflow.com/users/10921634/tomohiro-kobayashi"}, "edited": false, "score": 0, "creation_date": 1547975558, "post_id": 54217652, "comment_id": 95372227, "body": "Maybe you can parse out the INDIRECT and OFFSET functions, use the Evaluate trick in the code above to convert them to range adresses and substitute back into the formula?"}], "tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1547643749, "creation_date": 1547643749, "answer_id": 54217652, "question_id": 54214700, "link": "https://stackoverflow.com/questions/54214700/evaluated-result-of-indirect-function-in-vba/54217652#54217652", "title": "evaluated result of indirect function in VBA", "body": "<p>Try this code:</p>\n\n<pre><code>Sub getRangeAddress()\n    Dim oRng As Range\n    Set oRng = Evaluate(\"=INDIRECT(Address(2, 1, , , \"\"Sheet2\"\"))\")\n    If oRng.Parent.Name &lt;&gt; ActiveSheet.Name Then\n        MsgBox oRng.Address(, , , True)\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10921634, "user_type": "registered", "profile_image": "https://graph.facebook.com/2462627200478979/picture?type=large", "display_name": "Tomohiro Kobayashi", "link": "https://stackoverflow.com/users/10921634/tomohiro-kobayashi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 304, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1547643749, "creation_date": 1547633335, "last_edit_date": 1547636156, "question_id": 54214700, "link": "https://stackoverflow.com/questions/54214700/evaluated-result-of-indirect-function-in-vba", "title": "evaluated result of indirect function in VBA", "body": "<p>I'm coding VBA and would like to evaluate whether a particular cell is referring to cells in other sheets or not.  I usually evaluate this by analyzing the characters in the cell's value before \"!\".</p>\n\n<p>However, this method doesn't work when the cell refers to cells in another sheet using an \"indirect\" function. </p>\n\n<p>For example, <code>=INDIRECT (ADDRESS(row, col,,,sheet_name))</code> or <code>=INDIRECT (\"SUM(\" &amp; A1(cell containing sheet_name) &amp;\"B2:B3)\")</code> refer to cells in other sheets, but I cannot detect this in VBA because there is no expression like \"!\" in the formula.</p>\n\n<p>So, could someone help me to find whether there is any method to evaluate indirect functions in VBA, specifically a method to convert <code>=INDIRECT (ADDRESS(2, 1,,,\"sheet2\"))</code> into <code>=sheet2!A2</code>, or another way to know whether a cell that contains \"indirect\" function refers to cells in other sheets or not.</p>\n\n<p>Thank you for your support in advance!</p>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1547634485, "post_id": 54214685, "comment_id": 95255685, "body": "What value does <code>erow</code> contain?  (And what data type has it been defined as?)  You can use <code>Debug.Print</code> to output it to the Immediate Window"}, {"owner": {"reputation": 147, "user_id": 10775569, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eLayO2t4lDw/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jHcSOVKKwy_VTqJslbkEJzSTS_3w/mo/photo.jpg?sz=128", "display_name": "Liz H", "link": "https://stackoverflow.com/users/10775569/liz-h"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1547634676, "post_id": 54214685, "comment_id": 95255795, "body": "As I say, I&#39;m new to VBA so I don&#39;t know what you mean by what value is erow? I thought that string of code just meant that it would find the next empty row on the &quot;Splits&quot; sheet? Where do I put Debug.print ?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1547634889, "post_id": 54214685, "comment_id": 95255935, "body": "If you put, for example <code>Debug.Print erow</code> after the <code>erow = ..</code> row, then it will output the value for you to look at - but, you would actually get an error before that (see my answer below)"}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 10775569, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eLayO2t4lDw/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jHcSOVKKwy_VTqJslbkEJzSTS_3w/mo/photo.jpg?sz=128", "display_name": "Liz H", "link": "https://stackoverflow.com/users/10775569/liz-h"}, "edited": false, "score": 0, "creation_date": 1547634414, "post_id": 54214762, "comment_id": 95255648, "body": "I&#39;m still getting the runtime error when I do it? The debugger highlights this row of code: &quot;erow = ws.Cells(Rows.Count, 1).End(x1Up).Offset(1, 0)&quot;"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 147, "user_id": 10775569, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eLayO2t4lDw/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jHcSOVKKwy_VTqJslbkEJzSTS_3w/mo/photo.jpg?sz=128", "display_name": "Liz H", "link": "https://stackoverflow.com/users/10775569/liz-h"}, "edited": false, "score": 0, "creation_date": 1547634798, "post_id": 54214762, "comment_id": 95255869, "body": "Whoops, missed that - you need a ,row at the end of that line. ws.Cells(Rows.Count, 1).End(x1Up).Offset(1, 0) defines a cell, and erow wants the row number - returned by the .row property of the cell. So ws.Cells(Rows.Count, 1).End(x1Up).Offset(1, 0).Row"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1547635045, "post_id": 54214762, "comment_id": 95256021, "body": "@HarassedDad Also, <code>xlUp</code> is an Enum with value <code>-4162</code>, but this code uses <code>x1Up</code> which is an undeclared variable, defaulting to <code>0</code>"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1547633581, "creation_date": 1547633581, "answer_id": 54214762, "question_id": 54214685, "link": "https://stackoverflow.com/questions/54214685/userform-opens-when-selecting-command-button-how-do-i-make-data-input-into-the/54214762#54214762", "title": "Userform opens when selecting command button. How do I make data input into the textboxes in the form insert onto row in separate sheet?", "body": "<p>You were so close</p>\n\n<pre><code>Dim ctrl As Control\n    Dim ws As Worksheet\n    Set ws = Sheets(\"Splits\")\n\nerow = ws.Cells(Rows.Count, 1).End(x1Up).Offset(1, 0)\n    ws.Cells(erow, 1) = OriginalTourCode.Text\n    ws.Cells(erow, 2) = OriginalStartDate.Text\n    ws.Cells(erow, 3) = OriginalEndDate.Text\n    ws.Cells(erow, 4) = NewTourCode1.Text\n    ws.Cells(erow, 5) = NewStartDate1.Text\n    ws.Cells(erow, 6) = NewEndDate1.Text\n    ws.Cells(erow, 7) = NewTourCode2.Text\n    ws.Cells(erow, 8) = NewStartDate2.Text\n    ws.Cells(erow, 9) = NewEndDate2.Text\n    ws.Cells(erow, 10) = ReasonForSplit.Text\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1547635613, "last_edit_date": 1547635613, "creation_date": 1547634461, "answer_id": 54215040, "question_id": 54214685, "link": "https://stackoverflow.com/questions/54214685/userform-opens-when-selecting-command-button-how-do-i-make-data-input-into-the/54215040#54215040", "title": "Userform opens when selecting command button. How do I make data input into the textboxes in the form insert onto row in separate sheet?", "body": "<h1>No Object Variable Necessary</h1>\n\n<p>The End Parameter is <strong><code>xlUp</code></strong> not <code>x1Up</code>.</p>\n\n<h2>Array Version</h2>\n\n<pre><code>Option Explicit\n\nPrivate Sub SplitTourCommand_Click()\n\n    Const cSheet As String = \"Splits\"\n\n    Dim erow As Long\n    Dim vnt As Variant\n\n    ReDim vnt(1 To 1, 1 To 10) As String\n\n    vnt(1, 1) = OriginalTourCode.Text\n    vnt(1, 2) = OriginalStartDate.Text\n    vnt(1, 3) = OriginalEndDate.Text\n    vnt(1, 4) = NewTourCode1.Text\n    vnt(1, 5) = NewStartDate1.Text\n    vnt(1, 6) = NewEndDate1.Text\n    vnt(1, 7) = NewTourCode2.Text\n    vnt(1, 8) = NewStartDate2.Text\n    vnt(1, 9) = NewEndDate2.Text\n    vnt(1, 10) = ReasonForSplit.Text\n\n    With Worksheets(cSheet)\n        erow = .Cells(.Rows.Count, 1).End(xlUp).Row + 1\n        .Cells(erow, 1).Resize(, 10) = vnt\n    End With\n\nEnd Sub\n</code></pre>\n\n<h2>Range Version</h2>\n\n<pre><code>Option Explicit\n\nPrivate Sub SplitTourCommand_Click()\n\n    Const cSheet As String = \"Splits\"\n\n    Dim erow As Long\n\n    With Worksheets(cSheet)\n        erow = .Cells(.Rows.Count, 1).End(xlUp).Row + 1\n        .Cells(erow, 1) = OriginalTourCode.Text\n        .Cells(erow, 2) = OriginalStartDate.Text\n        .Cells(erow, 3) = OriginalEndDate.Text\n        .Cells(erow, 4) = NewTourCode1.Text\n        .Cells(erow, 5) = NewStartDate1.Text\n        .Cells(erow, 6) = NewEndDate1.Text\n        .Cells(erow, 7) = NewTourCode2.Text\n        .Cells(erow, 8) = NewStartDate2.Text\n        .Cells(erow, 9) = NewEndDate2.Text\n        .Cells(erow, 10) = ReasonForSplit.Text\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": true, "score": 0, "last_activity_date": 1547634797, "creation_date": 1547634797, "answer_id": 54215143, "question_id": 54214685, "link": "https://stackoverflow.com/questions/54214685/userform-opens-when-selecting-command-button-how-do-i-make-data-input-into-the/54215143#54215143", "title": "Userform opens when selecting command button. How do I make data input into the textboxes in the form insert onto row in separate sheet?", "body": "<pre><code>erow = ws.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n</code></pre>\n\n<p>There were 2 errors in your code.  First, the command is <code>xlUp</code>, not <code>x1Up</code> - \"xl\" is short for \"Excel\", not \"X One\" - this is a perfect example of why you should almost always use <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/option-explicit-statement\" rel=\"nofollow noreferrer\"><code>Option Explicit</code></a></p>\n\n<p>Second: your code as-is will try to put the <code>.Value</code> from the cell into untyped variable <code>erow</code> - since the cell is blank (as the cell <em>below</em> the last cell with data), this means that <code>erow</code> will <strong>always</strong> be <code>0</code>.  And Row 0 does not exist to put data into.</p>\n\n<p>Instead, by using <code>Range.Row</code>, we get the next row number to insert data on</p>\n"}], "owner": {"reputation": 147, "user_id": 10775569, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eLayO2t4lDw/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jHcSOVKKwy_VTqJslbkEJzSTS_3w/mo/photo.jpg?sz=128", "display_name": "Liz H", "link": "https://stackoverflow.com/users/10775569/liz-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 54215143, "answer_count": 3, "score": 1, "last_activity_date": 1547635613, "creation_date": 1547633287, "last_edit_date": 1547633819, "question_id": 54214685, "link": "https://stackoverflow.com/questions/54214685/userform-opens-when-selecting-command-button-how-do-i-make-data-input-into-the", "title": "Userform opens when selecting command button. How do I make data input into the textboxes in the form insert onto row in separate sheet?", "body": "<p>I'm trying to create a UserForm which will open when I select a command button.  The purpose of it is to capture data from a selected row concerning a \"tour\" - i.e. the tour code, start date and end date, and then for me to \"split\" the tour, for which I need to enter new tour codes, start dates and end dates.</p>\n\n<p>I need the data from the form to go into a separate sheet (called \"splits\"), so that I have a record of the original tour details, and the new tour details in one sheet. But I get a Run-Time error '1004' (Application-defined or object-defined error) when I try to run the macro. I'm new to VBA and I don't know what I've done wrong!</p>\n\n<p>This is my code so far:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    With Me\n        .OriginalTourCode.Value = Cells(ActiveCell.Row, \"A\").Value\n        .OriginalStartDate.Value = Cells(ActiveCell.Row, \"B\").Value\n        .OriginalEndDate.Value = Cells(ActiveCell.Row, \"C\").Value\n    End With\nEnd Sub\n\nPrivate Sub SplitTourCommand_Click()\n\nDim ctrl As Control\n    Dim ws As Worksheet\n    Set ws = Sheets(\"Splits\")\n\nerow = ws.Cells(Rows.Count, 1).End(x1Up).Offset(1, 0)\n    Cells(erow, 1) = OriginalTourCode.Text\n    Cells(erow, 2) = OriginalStartDate.Text\n    Cells(erow, 3) = OriginalEndDate.Text\n    Cells(erow, 4) = NewTourCode1.Text\n    Cells(erow, 5) = NewStartDate1.Text\n    Cells(erow, 6) = NewEndDate1.Text\n    Cells(erow, 7) = NewTourCode2.Text\n    Cells(erow, 8) = NewStartDate2.Text\n    Cells(erow, 9) = NewEndDate2.Text\n    Cells(erow, 10) = ReasonForSplit.Text\n\n\nEnd Sub\n\nPrivate Sub CloseCommand_Click()\n\nUnload Me\n\nEnd Sub\n</code></pre>\n\n<p>The Userform Intitialise section automatically fills in the first three cells of the UserForm, and then I'll use the form to enter the new data. </p>\n\n<p>The Close command section is just a separate button on the form to exit out.</p>\n\n<p>How to I get the form, when I click the \"split tour\" command button, to enter the data into the next empty row of the \"splits\" sheet?</p>\n\n<p>Thanks so much in advance for helping.</p>\n"}, {"tags": ["excel", "vba", "api", "web-scraping"], "comments": [{"owner": {"reputation": 111, "user_id": 3447974, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/583541986/picture?type=large", "display_name": "JPS", "link": "https://stackoverflow.com/users/3447974/jps"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547654513, "post_id": 54214459, "comment_id": 95267566, "body": "@qharr this works great much appreciated, not tried the late binding yet but expect that will work on my system, much appreciated"}], "answers": [{"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547641488, "post_id": 54216377, "comment_id": 95259653, "body": "It works with Early Binding but fails with LateBinding? Also for <code>&quot;https:&#47;&#47;www.google.co.uk&#47;search?q=sid&quot;</code> it fails in Early Binding as well..."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547641670, "post_id": 54216377, "comment_id": 95259735, "body": "@SiddharthRout   Everyone will have access to html object library so shouldn&#39;t be a huge problem. I guess some difficult IT departments might forbid adding but Microsoft paid a lot of money to ensure all installs had this library. For the q=sid I would imagine for telephone numbers you don&#39;t use this and instead use the telephone number concantenated in as shown in my url example. I will have a quick look at late binding but I know it doesn&#39;t expose querySelector as a method via the interface."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547641859, "post_id": 54216377, "comment_id": 95259827, "body": "@SiddharthRout Added a late bound version. Not sure where q=sid comes from as OP is using q=telNumber."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547649109, "post_id": 54216377, "comment_id": 95264176, "body": "OP mentiond <code>with text its fine,....</code> So I am assuming that he might want to use it for both... Also ran you LB version for numbers.. Getting a permission denied (Error 70) error... Let me delve into the code later tonight. Thanks for looking into it :)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547649230, "post_id": 54216377, "comment_id": 95264277, "body": "@SiddharthRout Good call: Code works for me  both number and text. With respect to permission denied - which line are you getting this on please? I ran the above without problem."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1547649409, "post_id": 54216377, "comment_id": 95264393, "body": "<code>.send</code>. Let me change my ISP for a moment and check with that as well."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547649501, "post_id": 54216377, "comment_id": 95264468, "body": "++ AHA!!! My ISP was the culprit. Your code works for both numbers and text"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547649620, "post_id": 54216377, "comment_id": 95264551, "body": "Let&#39;s see if the OP decides to feedback. In the meantime @SiddharthRout have you read anything on the insides of querySelector method  of htmldocument anywhere? I am trying to understand whether a cssdom is created to facilitate querySelector method."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547649723, "post_id": 54216377, "comment_id": 95264612, "body": "Actually no. I have seen you using <code>querySelectorAll</code> to reply to many posts recently. I was intrigued as to how it works and hence my interest in this post :)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547650053, "post_id": 54216377, "comment_id": 95264803, "body": "@SiddharthRout This is my concern though.... I understand it from a css point of view but finding anything &quot;internals&quot;, from vba implementation point of view, has proven difficult. I am starting to question the certainty of some statements I have made when it comes to applying css selectors via htmldocument as opposed to a browser. I guess I can race the horses but am really interested in understanding the vba implementation details in depth."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547650375, "post_id": 54216377, "comment_id": 95264998, "body": "Let me know if you find anything. I would definitely be interested in learning that :) BTW, I was earlier trying to go through <a href=\"https://www.w3schools.com/jsref/met_document_queryselector.asp\" rel=\"nofollow noreferrer\">This</a> Let&#39;s see where does it take me"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547650434, "post_id": 54216377, "comment_id": 95265040, "body": "And <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelector#A_more_complex_selector\" rel=\"nofollow noreferrer\">This</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1547650437, "post_id": 54216377, "comment_id": 95265045, "body": "It is my current research topic (only vaguely started) so yeah will defo let you know if I can arrive at least at some theory I can posit for critique."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547650461, "post_id": 54216377, "comment_id": 95265065, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/186796/discussion-between-siddharth-rout-and-qharr\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1547649724, "last_edit_date": 1547649724, "creation_date": 1547639089, "answer_id": 54216377, "question_id": 54214459, "link": "https://stackoverflow.com/questions/54214459/google-search-via-vba-no-results-if-use-a-phone-number/54216377#54216377", "title": "Google search via VBA no results if use a phone number", "body": "<p>There is a class name <code>r</code>. Observe the following:</p>\n\n<pre><code>Option Explicit\nPublic Sub GetLinks()\n    Dim html As HTMLDocument, links As Object, i As Long, counter As Long\n    Set html = New HTMLDocument\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"https://www.google.co.uk/search?q=03701116565\", False\n        .send\n        html.body.innerHTML = StrConv(.responseBody, vbUnicode)\n    End With\n\n    With html\n        Set links = .querySelectorAll(\".r &gt; [href] , .r h3\")\n    End With\n    For i = 0 To links.Length - 1 Step 2\n        counter = counter + 1\n        ActiveSheet.Cells(counter, 1) = links.item(i)\n        ActiveSheet.Cells(counter, 2) = links.item(i + 1).innerText\n    Next\nEnd Sub\n</code></pre>\n\n<p>The actual <code>href</code> is associated with a child <code>a</code> tag which precedes the <code>h3</code> header tag element which you are targeting by class. The <code>r</code> is the class of the parent of the <code>a</code> tag.</p>\n\n<p><a href=\"https://i.stack.imgur.com/mKBXu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mKBXu.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>If you want to use late bound, and a similar approach to yours, you can use the less efficient following method. Note that the parent div elements are selected so access to the <code>a</code> tag and <code>h3</code> are possible for qualifying classes.</p>\n\n<pre><code>Option Explicit\nPublic Sub GetLinks()\n    Dim html As Object, i As Long\n    Dim objResultDiv As Object, objH3 As Object, link As Object\n\n    Set html = CreateObject(\"htmlfile\")\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"https://www.google.co.uk/search?q=03701116565\", False\n        .send\n        html.body.innerHTML = .responseText\n    End With\n\n    Set objResultDiv = html.getElementById(\"rso\")\n    Set objH3 = objResultDiv.getElementsByTagName(\"div\")\n    For Each link In objH3\n        If link.className = \"r\" Then\n            i = i + 1\n            On Error Resume Next\n            ActiveSheet.Cells(i, 2) = link.getElementsByTagName(\"a\")(0).href\n            ActiveSheet.Cells(i, 3) = link.getElementsByTagName(\"h3\")(0).innerText\n            On Error GoTo 0\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 3447974, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/583541986/picture?type=large", "display_name": "JPS", "link": "https://stackoverflow.com/users/3447974/jps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 54216377, "answer_count": 1, "score": 1, "last_activity_date": 1547649724, "creation_date": 1547632599, "last_edit_date": 1547640670, "question_id": 54214459, "link": "https://stackoverflow.com/questions/54214459/google-search-via-vba-no-results-if-use-a-phone-number", "title": "Google search via VBA no results if use a phone number", "body": "<p>Using following code I found on web it does not return results when searching for phone numbers, with text its fine, brings back weblink and title</p>\n\n<p>I have noticed that when search for number there is no className \"r\" in link.className, how would I fix to use with phone numbers</p>\n\n<pre><code>Sub XMLHTTP()\n\nDim url As String, lastRow As Long, i As Long\nDim XMLHTTP As Object, html As Object, objResultDiv As Object, objH3 As Object, link As Object\n\nlastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 2 To lastRow\n\n  url = \"https://www.google.co.uk/search?q=03701116565\" &amp; \"&amp;rnd=\" &amp; WorksheetFunction.RandBetween(1, 10000)\n\n    Set XMLHTTP = CreateObject(\"MSXML2.serverXMLHTTP\")\n    XMLHTTP.Open \"GET\", url, False\n    XMLHTTP.setRequestHeader \"Content-Type\", \"text/xml\"\n    XMLHTTP.setRequestHeader \"User-Agent\", \"Mozilla/5.0 (Windows NT 6.1; rv:25.0) Gecko/20100101 Firefox/25.0\"\n    XMLHTTP.send\n\n    Set html = CreateObject(\"htmlfile\")\n    html.body.innerHTML = XMLHTTP.ResponseText\n    Set objResultDiv = html.getelementbyid(\"rso\")\n\n    Set objH3 = objResultDiv.getelementsbytagname(\"h3\")\n\n    For Each link In objH3\n        If link.className = \"r\" Then\n            Cells(i, 2) = link.innerText\n            Cells(i, 3) = link.getelementsbytagname(\"a\")(0).href\n            DoEvents\n        End If\n    Next\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "sharepoint"], "answers": [{"comments": [{"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1547636302, "post_id": 54214832, "comment_id": 95256697, "body": "Yep this solution works perfectly even with dynamic Table names. Thank you!"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1547633803, "creation_date": 1547633803, "answer_id": 54214832, "question_id": 54214360, "link": "https://stackoverflow.com/questions/54214360/importing-a-list-from-sharepoint-to-excel-as-a-range-or-with-a-fixed-table-name/54214832#54214832", "title": "Importing a list from SharePoint to Excel as a Range (or with a fixed Table name)", "body": "<p>Do this </p>\n\n<p>[1] Change <code>RData.UsedRange.ClearContents</code> to <code>RData.Cells.Clear</code>. This will clear the sheet completely. Removes formats, text, tables etc..</p>\n\n<p>[2] Once the table is imported, add this code. Since there is going to be only one table, you can use the table number to work with it.</p>\n\n<pre><code>Dim tbl As ListObject\nSet tbl = RData.ListObjects(1)\n\nDim tblRng As Range\nSet tblRng = tbl.Range\n\n'~~&gt; Convert table to range\ntbl.Unlist\n\n'~~&gt; Comment this in case you do not\n'~~&gt; want to remove the formatting\nWith tblRng\n    .Interior.ColorIndex = xlColorIndexNone\n    .Font.ColorIndex = xlColorIndexAutomatic\n    .Borders.LineStyle = xlLineStyleNone\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1547634072, "creation_date": 1547634072, "answer_id": 54214919, "question_id": 54214360, "link": "https://stackoverflow.com/questions/54214360/importing-a-list-from-sharepoint-to-excel-as-a-range-or-with-a-fixed-table-name/54214919#54214919", "title": "Importing a list from SharePoint to Excel as a Range (or with a fixed Table name)", "body": "<p>You can query a Sharepoint list using ADODB. Check the following code (untested because I don't have Sharepoint available, but have used something similar in the past)</p>\n\n<pre><code>Const SERVER As String = \"xxxx.xxxxx.xxx.net/xxxx/xxxx\" 'SP server\nConst LISTNAME As String = \"{1234567-1234-1234-1234-1234567891}\" 'SP List ID\n\nDim connStr As String\nDim conn As New ADODB.Connection\nDim rs As ADODB.Recordset\n\nconnStr = \"Provider=Microsoft.ACE.OLEDB.12.0;WSS;IMEX=1;RetrieveIds=Yes;\" _\n        &amp; \"DATABASE=\" &amp; SERVER _\n        &amp; \";LIST=\" &amp; LISTNAME &amp; \";\"\nconn.Open connStr\nSet rs = conn.Execute(\"select * from list\")\n\nDim rData As Worksheet\nSet rData = thisworknbook.Sheets(\"rawdata\") 'reset import sheet\nrData.UsedRange.ClearContents\nrData.Range(\"A1\").CopyFromRecordset rs\nconn.Close\n</code></pre>\n"}], "owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 54214832, "answer_count": 2, "score": 0, "last_activity_date": 1547634072, "creation_date": 1547632316, "last_edit_date": 1547632326, "question_id": 54214360, "link": "https://stackoverflow.com/questions/54214360/importing-a-list-from-sharepoint-to-excel-as-a-range-or-with-a-fixed-table-name", "title": "Importing a list from SharePoint to Excel as a Range (or with a fixed Table name)", "body": "<p>so I have the code below that pulls a list from SharePoint and imports it to Excel. My problem is, it imports it as a Table not as a Range and I cannot automatically convert it to range as the Table name is different every time I run the script (Table1, Table2, ... and so on).</p>\n\n<p>My question is the following: Can I import the list from SharePoint as an Excel Range straight away, so that I don't have to convert it? If not, can I make it so every time I run the import procedure the name of the imported Table is fix?</p>\n\n<p>Here's my code:</p>\n\n<pre><code>   Sub SharePoint_Import()\n        Dim objMyList As ListObject\n        Dim objWksheet As Worksheet\n        Dim strSPServer As String\n        Const SERVER As String = \"xxxx.xxxxx.xxx.net/xxxx/xxxx\" 'SP server\n        Const LISTNAME As String = \"{1234567-1234-1234-1234-1234567891}\" 'SP List ID\n        Const VIEWNAME As String = \"\" \n\n            Set RData = Sheets(\"rawdata\") 'reset import sheet\n            RData.UsedRange.ClearContents\n\n        strSPServer = \"https://\" &amp; SERVER &amp; \"/_vti_bin\" '&lt;- _vti_bin is necessary\n        Set objWksheet = RData\n\n          Set objMyList = objWksheet.ListObjects.Add(xlSrcExternal, Array(strSPServer, LISTNAME, VIEWNAME), False, , Range(\"A1\"))\n          Set objMyList = Nothing\n          Set objWksheet = Nothing\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "runtime-error"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1547631851, "post_id": 54214172, "comment_id": 95254104, "body": "What does <code>AmountofRows</code> and <code>AmountofColumns</code> equal?"}, {"owner": {"reputation": 189, "user_id": 10639239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875a1144623e974f785366d0e177ca82?s=128&d=identicon&r=PG&f=1", "display_name": "G.M", "link": "https://stackoverflow.com/users/10639239/g-m"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1547632108, "post_id": 54214172, "comment_id": 95254264, "body": "82 and 493 respectively. Which are the right values, so this part is working fine. They count the rows/columns a few lines above. No errors and the numbers a correct so this shouldnt be the issue. But thanks for the fast idea!"}, {"owner": {"reputation": 505, "user_id": 9204831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KwPAL.png?s=128&g=1", "display_name": "Lodi", "link": "https://stackoverflow.com/users/9204831/lodi"}, "edited": false, "score": 0, "creation_date": 1547632216, "post_id": 54214172, "comment_id": 95254337, "body": "Instead of &quot;Cells&quot;, use ThisWorkbook.Worksheets(&quot;Test&quot;).Cells"}, {"owner": {"reputation": 505, "user_id": 9204831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KwPAL.png?s=128&g=1", "display_name": "Lodi", "link": "https://stackoverflow.com/users/9204831/lodi"}, "edited": false, "score": 0, "creation_date": 1547632312, "post_id": 54214172, "comment_id": 95254404, "body": "In other words: add the specific and complete reference to the Cell you need, including which Workbook (in this case, ThisWorkbook) and which Worksheet (in this case, Worksheets(&quot;Test&quot;)"}, {"owner": {"reputation": 189, "user_id": 10639239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875a1144623e974f785366d0e177ca82?s=128&d=identicon&r=PG&f=1", "display_name": "G.M", "link": "https://stackoverflow.com/users/10639239/g-m"}, "edited": false, "score": 0, "creation_date": 1547633415, "post_id": 54214172, "comment_id": 95255100, "body": "Now i get it okay, so the used &quot;cells didnt really know what to reference but the . in front of it makes sure they use the before stated &quot;path&quot; so in this case &quot;This workbook&quot;, Thanks :D got it now ^^"}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 10639239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875a1144623e974f785366d0e177ca82?s=128&d=identicon&r=PG&f=1", "display_name": "G.M", "link": "https://stackoverflow.com/users/10639239/g-m"}, "edited": false, "score": 0, "creation_date": 1547632567, "post_id": 54214336, "comment_id": 95254575, "body": "Worked just fine, thank you alot!  just because of curiosity, shouldnt &quot;thisworkbook&quot; always refere to the one which th e code is written in?  Well anyway it works, thanks ^^"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 189, "user_id": 10639239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875a1144623e974f785366d0e177ca82?s=128&d=identicon&r=PG&f=1", "display_name": "G.M", "link": "https://stackoverflow.com/users/10639239/g-m"}, "edited": false, "score": 0, "creation_date": 1547632625, "post_id": 54214336, "comment_id": 95254606, "body": "Yes it does but it is the sheet reference that throws it out of place. You&#39;re defining the Range on one sheet and then using references to another sheet causing the issue with the copy"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 3, "last_activity_date": 1547632240, "creation_date": 1547632240, "answer_id": 54214336, "question_id": 54214172, "link": "https://stackoverflow.com/questions/54214172/use-of-range-variable-causes-an-runtime-error-in-vba/54214336#54214336", "title": "Use of .Range variable causes an runtime error in vba", "body": "<p>I suspect it's due to you not being on the <code>Active</code> sheet when you run the command. </p>\n\n<p>Try using this instead</p>\n\n<pre><code>With ThisWorkbook.Worksheets(\"Test\")\n    .Range(.Cells(8, 2), .Cells(AmountofRows, AmountofColumns)).Copy\nEnd With\n</code></pre>\n\n<p>The way you have used <code>Cells</code> will just use the active sheet which will then fail when you try to copy with a mixed declaration. Make sure you always define your ranges fully</p>\n"}], "owner": {"reputation": 189, "user_id": 10639239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875a1144623e974f785366d0e177ca82?s=128&d=identicon&r=PG&f=1", "display_name": "G.M", "link": "https://stackoverflow.com/users/10639239/g-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 54214336, "answer_count": 1, "score": 0, "last_activity_date": 1547632240, "creation_date": 1547631768, "last_edit_date": 1547631793, "question_id": 54214172, "link": "https://stackoverflow.com/questions/54214172/use-of-range-variable-causes-an-runtime-error-in-vba", "title": "Use of .Range variable causes an runtime error in vba", "body": "<p>hope you can help me with a little issue. I want to copy a range of my current workbook to another open workbook.</p>\n\n<p>Doesnt sound like an issue but it already crashes within the copy line.</p>\n\n<p>I already tried to save the current/active Worksheet/book in a varaible and execute it like that but the error still appears. I used the combination of range and cells a ew times already so i doubt that this is the issue.</p>\n\n<p>Maybe some of you had a similar problem already?\nOr possible there is a better way of doing it?</p>\n\n<p>Thanks alot in advance.</p>\n\n<pre><code>ThisWorkbook.Worksheets(\"Test\").Range(Cells(8, 2), Cells(AmountofRows, AmountofColumns)).Copy\n</code></pre>\n"}, {"tags": ["excel", "vba", "csv", "select", "merge"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1547630735, "post_id": 54213538, "comment_id": 95253437, "body": "I don&#39;t understand what you mean by <i>&quot;run it from an Excel cell&quot;</i>."}, {"owner": {"reputation": 169, "user_id": 4765179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/73d9656254cdbadf55e9b1b1ff6825a8?s=128&d=identicon&r=PG&f=1", "display_name": "Javi", "link": "https://stackoverflow.com/users/4765179/javi"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1547631393, "post_id": 54213538, "comment_id": 95253813, "body": "I mean to call the function from a cell: <code>=GetData(path,file,name,operations)</code>"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1547633038, "post_id": 54213538, "comment_id": 95254855, "body": "Why do you want do so? You read the data once, right? After that, you want to query it multiple times? Have you thought about putting the data into a real database where you don&#39;t have the 255 field limitation?"}, {"owner": {"reputation": 169, "user_id": 4765179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/73d9656254cdbadf55e9b1b1ff6825a8?s=128&d=identicon&r=PG&f=1", "display_name": "Javi", "link": "https://stackoverflow.com/users/4765179/javi"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1547633834, "post_id": 54213538, "comment_id": 95255327, "body": "I can put it in a database, but users must use Excel to retrieve the data point they want."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1547634186, "post_id": 54213538, "comment_id": 95255509, "body": "How does the user tells the program what he wants?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1547634503, "post_id": 54213538, "comment_id": 95255697, "body": "Users can still use Excel as a front end but have the data sitting in a database in the back end"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1547634642, "post_id": 54213538, "comment_id": 95255776, "body": "Sure, but you wrote <i>&quot;the operations called by user could be like&quot;</i> - how tells the user which operations he want?"}, {"owner": {"reputation": 169, "user_id": 4765179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/73d9656254cdbadf55e9b1b1ff6825a8?s=128&d=identicon&r=PG&f=1", "display_name": "Javi", "link": "https://stackoverflow.com/users/4765179/javi"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1547634689, "post_id": 54213538, "comment_id": 95255805, "body": "@Zac All Excel connections I know to databases or csv files or even names or ranges to another Excel workbook have the limit of 255 columns. Do you know any ADODB provider that doesn&#39;t have this limit?"}, {"owner": {"reputation": 169, "user_id": 4765179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/73d9656254cdbadf55e9b1b1ff6825a8?s=128&d=identicon&r=PG&f=1", "display_name": "Javi", "link": "https://stackoverflow.com/users/4765179/javi"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1547634943, "post_id": 54213538, "comment_id": 95255963, "body": "@FunThomas The operations is a string parameter in the function. As I said, it can be &quot;x1+x5-x873&quot; or whatever"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1547635156, "post_id": 54213538, "comment_id": 95256080, "body": "Sql Server ado connection supports 4K columns for a SELECT statement"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1547636679, "post_id": 54213538, "comment_id": 95256887, "body": "Why would you ever want 255 (or more) columns in a table? It&#39;s a database. You can design it so that you have multiple tables for multitude of reasons. You might have 1k columns coming in your <code>csv</code> file, but you add them to relevant tables.. maybe I&#39;m missing something"}, {"owner": {"reputation": 169, "user_id": 4765179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/73d9656254cdbadf55e9b1b1ff6825a8?s=128&d=identicon&r=PG&f=1", "display_name": "Javi", "link": "https://stackoverflow.com/users/4765179/javi"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1547637138, "post_id": 54213538, "comment_id": 95257157, "body": "@Zac Please read the question carefully. The users may want to access to each of the (1,000) fields or to a sum of some of them. So there&#39;s nothing like &quot;relevant&quot; or &quot;non-relevant&quot; fields."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1547637816, "post_id": 54213538, "comment_id": 95257526, "body": "@Javi: I believe I&#39;ve missed a point here. I don&#39;t see an issue using this in a database but don&#39;t want to waste OP&#39;s time. OP, please ignore my comments because I must be missing something"}], "answers": [{"comments": [{"owner": {"reputation": 169, "user_id": 4765179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/73d9656254cdbadf55e9b1b1ff6825a8?s=128&d=identicon&r=PG&f=1", "display_name": "Javi", "link": "https://stackoverflow.com/users/4765179/javi"}, "edited": false, "score": 0, "creation_date": 1547634863, "post_id": 54215114, "comment_id": 95255915, "body": "Can you elaborate your answer more? Maybe some code?"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 1, "last_activity_date": 1547634692, "creation_date": 1547634692, "answer_id": 54215114, "question_id": 54213538, "link": "https://stackoverflow.com/questions/54213538/merging-csv-files-in-query-to-retrieve-its-data-from-excel-through-a-udf-and-ad/54215114#54215114", "title": "Merging .csv files in query to retrieve its data from Excel through a UDF and ADODB connection", "body": "<p>You could stuff the data into a mdb file using ado and bypass the 256 column limitation. However, using UDF's to retrieve data directly from any external datasource is going to be very slow if you have more than a few. I would create a class to hold the data, with a load method called on opening the spreadsheet, and have your functions query the object. So your load method takes your csv as a datastream and fills a disconected ado recordset defined as a static variable, and then you define a getdata method that returns your desired value based on the parameters passed to it.</p>\n"}], "owner": {"reputation": 169, "user_id": 4765179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/73d9656254cdbadf55e9b1b1ff6825a8?s=128&d=identicon&r=PG&f=1", "display_name": "Javi", "link": "https://stackoverflow.com/users/4765179/javi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547634692, "creation_date": 1547629511, "question_id": 54213538, "link": "https://stackoverflow.com/questions/54213538/merging-csv-files-in-query-to-retrieve-its-data-from-excel-through-a-udf-and-ad", "title": "Merging .csv files in query to retrieve its data from Excel through a UDF and ADODB connection", "body": "<p>My goal is to run some code in <code>vba</code> and call the function from an Excel cell to retrieve some data from a closed <code>.csv</code> file or <code>.xlsx</code> file.</p>\n\n<p>This could be done in several ways, but all I've tried have an important constraint. </p>\n\n<p>I start with a very large <code>.csv</code> file. Very large is around 4,000 rows and more than 1,000 columns. </p>\n\n<p><strong>First try:</strong> </p>\n\n<p>Save the <code>.csv</code> in an Excel worksheet and use <code>ExecuteExcel4Macro</code> to retrieve the data. This works fine when running a <code>Sub</code>, and even when running a <code>Function</code>. But, unfortunately, you can't use <code>ExecuteExcel4Macro</code> and call it from an Excel cell. The first try is done. </p>\n\n<p><strong>Second try</strong></p>\n\n<p>Use an <code>ADODB Connection</code> and run a query directly from the <code>.csv</code> file or from the saved <code>.xlsx</code> file. This can be used from a cell, but, surprise, surprise, it has a limit of 255 columns or fields. I mean, when you run a query and try to read a field that is positioned in a column number greater than 255, the function does nothing. Second try done.</p>\n\n<p><strong>Third (and last (by now)) try. Need your help here!</strong></p>\n\n<p>Ok, I could divide the original table, which has too many fields into several tables containing a maximum of 255 fields each. </p>\n\n<p>Note: the first column contains the ids of firms, banks or whatever. The rest of the fields are named x1, x2,...x1050 and they correspond to fields of financial statements, so they are all numeric and they are all useful for the analysis. </p>\n\n<p>If I split the big table in different ones, the aspect would be like:</p>\n\n<pre><code>Table 1:\nName     x1     x2     x5    x6    x15...\nmyName1  15025  1546   6546  548   98663\nmyName2  867486 4684   68786 876   68997\nmyName3  87663  43397  87987 457   -4554\netc.\n\n...\n\nTable n:\nName     x928     x929     x940    x1005    x1250\nmyName1  765454   541546   76546   74548    18663\nmyName2  6564     544684   686     41876    58997\nmyName3  4687     64397    9887    879457   8554\n</code></pre>\n\n<p>I can do this by running some vba before I store the files, so now I have <code>n</code> <code>.csv</code> files. The point is that I want the formula called from a cell like this:</p>\n\n<pre><code>=GetData(path,file,name,operations)\n</code></pre>\n\n<p>I mean, the user wants to locate a <code>name</code> in a <code>file</code> and make some <code>operations</code> with \"all\" the fiels available, from 1 to 1250. </p>\n\n<p>Let's suposse the first splitted table goes from x1 field to x250 field. The second would go from x251 to x500, etc. All of the tables would have a first column with the <code>names</code> field, of course, and all tables would have the same number of rows (not the same number of columns, as not all x's fields exist).</p>\n\n<p>But, important, the <code>operations</code> called by user could be like:</p>\n\n<pre><code>\"x3\"                      --&gt; User requests only one field.\n\"x5+x150\"                 --&gt; User requests the sum of two fields that would be in the same table (as the x150 field is not greater than x250 field)\n\"x452+x535-x900+x1200-x1\" --&gt; User requests operations with many fields that would be kept in different files. \n</code></pre>\n\n<p>When the user requests only a field, I can write a small routine in the beggining of the function to tell the function in which <code>.csv</code> file is that field stored, like:</p>\n\n<pre><code>if singleField&lt;=250 then \n  fileToLookAt=\"SplittedCSV_1\"\nend if \nif singleField&gt;250 and singleField&lt;=500 then \n  fileToLookAt=\"SplittedCSV_2\"\nend if \n</code></pre>\n\n<p>Then, using an <code>ADODB Connection</code> and <code>Microsoft.Jet.OLEDB.4.0</code> provider, I would run the query like:</p>\n\n<pre><code>MyQuery = \"SELECT x\" &amp; singleField &amp; \" AS MyData FROM [\" &amp; fileToLookAt &amp; \".csv] WHERE Name='\" &amp; name &amp; \"'\"\n</code></pre>\n\n<p>But, what happens when the user wants an operation involving x's fields stored in all different files, like the third example I gave? I would have to \"merge\" all tables, using <code>Name</code> field as the key for merging then. </p>\n\n<p>How would you proceed? Is it merging the tables in the <code>Select</code> the best option? How would the <code>Select</code> be?</p>\n\n<p>I mean the Query would be like:</p>\n\n<pre><code>MyQuery = \"SELECT x452+x535-x900+x1200-x1 AS MyData FROM [\" &amp; MergedTable &amp; \".csv] WHERE Name='\" &amp; name &amp; \"'\"\n</code></pre>\n\n<p>Thanks a lot for your time.</p>\n"}, {"tags": ["excel", "vba", "time", "counting"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1547637809, "post_id": 54212631, "comment_id": 95257520, "body": "<code>CellS</code>is not a good name for a variable, because it already has a meaning in Excel (it is the range of all cells in the active worksheet). <code>(StartS &gt; Timer)</code> evaluate to <code>True</code> or <code>False</code>, that are changed to <code>-1</code> or <code>0</code>, so you are only subtracting one second when the test is True. Finally, the parameters for TimeSerial second is Variant(Interger), so the maximal value is 32767 seconds"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1547639242, "post_id": 54212631, "comment_id": 95258400, "body": "Aside from @VincentG accurate comments, what does <b><i>gets a bug</i></b> mean? Does everything freeze at that time?  What is in A2? Are there any error messages?  In general, and for future reference, that kind of information can be quite helpful in figuring out the problem."}, {"owner": {"reputation": 5, "user_id": 10805811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5728265d11f97ec567f86511de4ec5f0?s=128&d=identicon&r=PG&f=1", "display_name": "MMO", "link": "https://stackoverflow.com/users/10805811/mmo"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1547916988, "post_id": 54212631, "comment_id": 95361485, "body": "Thanks @VincentG. A later test showed me the problem while I got an Erro 6 - overflow after appx. 9 hours of running. I tryed to change SINGLE to LONG for StartS, but it diddent help. Do you have any idea how to fix the limite"}, {"owner": {"reputation": 5, "user_id": 10805811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5728265d11f97ec567f86511de4ec5f0?s=128&d=identicon&r=PG&f=1", "display_name": "MMO", "link": "https://stackoverflow.com/users/10805811/mmo"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1547917149, "post_id": 54212631, "comment_id": 95361528, "body": "Thanks @Ron Rosenfeld for guiding me. I&#39;m new int this field. It stops right at 23:59:59 even though I try toe uses (Starts &gt; Timer) to add one day. It stops at: CellS.Value = CountUPS + TimeSerial(0, 0, Timer - StartS + (StartS &gt; Timer)). A2 is used for a preset time that the counter starts to count from, and it is A2 that gives med problems when it reach midnight. A1 is always countion up from 0."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1547933973, "post_id": 54212631, "comment_id": 95366033, "body": "I cannot reproduce your problem.  When I use your code as you show it (commenting out the <code>b_pause=</code> line since you never declare, nor use, that variable), and enter a start time in A2, it does NOT stop at 23:59:59.  What are you not telling us?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1547950946, "post_id": 54212631, "comment_id": 95368810, "body": "Of course, your other problem with overflow is different, and due to the time arguments being limited to integers. And there is a solution for that, but let&#39;s figure out what&#39;s going on with your stopping problem."}, {"owner": {"reputation": 5, "user_id": 10805811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5728265d11f97ec567f86511de4ec5f0?s=128&d=identicon&r=PG&f=1", "display_name": "MMO", "link": "https://stackoverflow.com/users/10805811/mmo"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1548001718, "post_id": 54212631, "comment_id": 95378831, "body": "Yes you are right @RonRosenfeld. If I simulate a midnight situation in daytime, with typing in 23:59:55 at cell A2, it will continue counting time. But If I stay up until midnight and watch the counter, it stops right after 23:59:59. I tryed it again last Friday. And then it gives me a Debug in the counter  algoritme."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1548011476, "post_id": 54212631, "comment_id": 95381702, "body": "And is there any error associated with the Debug? If so, can you tell us what it is? And exactly what line it is on?"}, {"owner": {"reputation": 5, "user_id": 10805811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5728265d11f97ec567f86511de4ec5f0?s=128&d=identicon&r=PG&f=1", "display_name": "MMO", "link": "https://stackoverflow.com/users/10805811/mmo"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1548143590, "post_id": 54212631, "comment_id": 95426835, "body": "@RonRosenfeld When it reach midnight I get <b>Run-time error 6 - Overflow</b> and it fails at line: <code>Cellt.Value = CountUP + TimeSerial(0, 0, Timer - StartS + (Starts &gt; Timer ))</code>. But it shouldn\u2019t have used the limited of 32767 seconds while it has only counted for appx 2 hours. If I restart the code it gets me another error: <b>Run-time error 1004 \u2013 Application-defined or object-defined error</b>. It fails in the line: <code>Cells.Value = CountUPS + TimeSerial(0, 0, Timer \u2013 StartS + (StartS&gt;Timer))</code> in the loop. When I restarts from ties two debugs, it will count over midnight with no problem."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10805811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5728265d11f97ec567f86511de4ec5f0?s=128&d=identicon&r=PG&f=1", "display_name": "MMO", "link": "https://stackoverflow.com/users/10805811/mmo"}, "edited": false, "score": 0, "creation_date": 1549533675, "post_id": 54307054, "comment_id": 95939111, "body": "I am trying to use the same code but changed one of the two counters to a count down timer form a preset time. But with the math in your code it gives me an Error when it research Zero. (I asume that it will try to * 0 ). The additional code looks like this. <code>Dim CountDown As Date</code> _<code>CountDown = TimeSerial(0, 0, 10)    &#39;Set takttime</code>   _  <code>Cell.Value = CountDown - (Timer - Start - 86400 * (Start &gt; Timer)) &#47; 86400</code> Do you have an idear how to solve the problem."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 5, "user_id": 10805811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5728265d11f97ec567f86511de4ec5f0?s=128&d=identicon&r=PG&f=1", "display_name": "MMO", "link": "https://stackoverflow.com/users/10805811/mmo"}, "edited": false, "score": 0, "creation_date": 1549538939, "post_id": 54307054, "comment_id": 95942268, "body": "@MMO No, not with the information you have provided. I suggest you post this problem as a new question, but first, please read the HELP pages for information as to <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask a Good Question</a>, and <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a> and formulate your question accordingly, so the respondents do not have to ask multiple other questions in order to clarify the problem."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 0, "last_activity_date": 1548244387, "last_edit_date": 1548244387, "creation_date": 1548155605, "answer_id": 54307054, "question_id": 54212631, "link": "https://stackoverflow.com/questions/54212631/time-counting-over-midnight/54307054#54307054", "title": "Time counting over midnight", "body": "<p>The error messages clear up a lot of issues.</p>\n\n<ul>\n<li>The <code>overflow</code> error, as has been pointed out, is because of the integer constraints on the <code>TimeSerial</code> function arguments.</li>\n<li>The <code>1004</code> error, occurring at midnight, is because, when <code>Timer</code> reverts to <code>0</code> at midnight, your expression for seconds is a negative number.  Unless you are using the 1904 date system, you cannot express negative times in Excel. </li>\n<li>In trying to adjust for \"passing midnight\" you are conflating seconds and days, and Excel and VBA.  You are, in your macro, trying to add one second, whereas you probably really want to add one day.  Also, since <code>True</code> in VBA equates to <code>-1</code>, you are actually subtracting instead of adding anyway!</li>\n</ul>\n\n<p>I think the following modifications may work, but have not tested them extensively. <code>86400</code> is the number of seconds in a day.</p>\n\n<pre><code>Option Explicit\nSub RunMe()\n\nDim StartS As Single\nDim CellS As Range\nDim Cellt As Range\nDim CountUPS As Date\nDim CountUp As Date\n\n'Timer is the number of seconds since midnight.\n'Store timer at this point in a variable\nStartS = TIMER\n\n'Store A1 in a variable to make it easier to refer\n'to it later. Also, if the cell changes, you only\n'have to change it in one place\nSet CellS = Sheet1.Range(\"A1\")\n\n'This is the starting value.\nCountUPS = TimeSerial(0, 0, 0)\n\n'Set our cell to the starting value\nCellS.Value = CountUPS\n\nSet Cellt = Sheet1.Range(\"A2\")\nCountUp = Sheet1.Range(\"A2\")\n\n'b_pause = True\n\nDo While CellS.Value &gt;= 0\n\n    CellS.Value = CountUPS + (TIMER - StartS - 86400 * (StartS &gt; TIMER)) / 86400\n    Cellt.Value = CountUp + (TIMER - StartS - 86400 * (StartS &gt; TIMER)) / 86400\n    DoEvents\nLoop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10805811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5728265d11f97ec567f86511de4ec5f0?s=128&d=identicon&r=PG&f=1", "display_name": "MMO", "link": "https://stackoverflow.com/users/10805811/mmo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 54307054, "answer_count": 1, "score": 0, "last_activity_date": 1548244387, "creation_date": 1547625936, "last_edit_date": 1547633363, "question_id": 54212631, "link": "https://stackoverflow.com/questions/54212631/time-counting-over-midnight", "title": "Time counting over midnight", "body": "<p>Counting time over midnight fails</p>\n\n<p>Counting time over midnight fails\nI have made a code with two counters  - one (CountUPS) that counts seconds from 0 every time I start the program (A1) and one(CountUP) that counts seconds from a preset time (A2).\nIt works fine while it counts within the same day, but it gets a bug  every time it shall count over midnight. It stops when A2 reach 23:37:53 in time.\nIs something wrong in my definition of values?</p>\n\n<pre><code>Sub RunMe()\n\nDim StartS As Single\nDim CellS As Range\nDim Cellt As Range\nDim CountUPS As Date\nDim CountUp As Date\n\n'Timer is the number of seconds since midnight.\n'Store timer at this point in a variable\nStartS = Timer\n\n'Store A1 in a variable to make it easier to refer\n'to it later. Also, if the cell changes, you only\n'have to change it in one place\nSet CellS = Sheet1.Range(\"A1\")\n\n'This is the starting value.\nCountUPS = TimeSerial(0, 0, 0)\n\n'Set our cell to the starting value\nCellS.Value = CountUPS\n\nSet Cellt = Sheet1.Range(\"A2\")\nCountUp = Sheet1.Range(\"A2\")\n\nb_pause = True\n\nDo While CellS.Value &gt;= 0\n\n    CellS.Value = CountUPS + TimeSerial(0, 0, Timer - StartS + (StartS &gt; Timer))\n    Cellt.Value = CountUp + TimeSerial(0, 0, Timer - StartS + (StartS &gt; Timer))\n    DoEvents\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "edited": false, "score": 0, "creation_date": 1547626488, "post_id": 54212610, "comment_id": 95251325, "body": "Sorry but I didn&#39;t understood you. In the cells I have &quot; just once and not two &quot;&quot;. Can you show me inside my code the changes that you would do?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "edited": false, "score": 0, "creation_date": 1547626568, "post_id": 54212610, "comment_id": 95251363, "body": "I already showed it to you :) See the last line in the above post"}, {"owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "edited": false, "score": 0, "creation_date": 1547626677, "post_id": 54212610, "comment_id": 95251398, "body": "THE LAST LINE BECOMES RED WHEN i PASTE THIS"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "edited": false, "score": 0, "creation_date": 1547626760, "post_id": 54212610, "comment_id": 95251434, "body": "Yes becuase you have <code>&quot;</code> at the end of that line <code>MatchCase:=False&quot;</code>... Remove that..."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 2, "last_activity_date": 1547625818, "creation_date": 1547625818, "answer_id": 54212610, "question_id": 54212409, "link": "https://stackoverflow.com/questions/54212409/error-when-trying-to-find-replace-the-qoute-sign-with-range-replace/54212610#54212610", "title": "Error when trying to find &amp; replace the qoute sign &quot; with Range.Replace", "body": "<p><code>\"</code> in VBA can be written as <code>\"\"\"\"</code> or <code>Chr(34)</code></p>\n\n<p><code>\"\"\"</code> is not the same as <code>\"\"\"\"</code></p>\n\n<p>In the immediate window type this</p>\n\n<pre><code>?Chr(34)\n\"    '&lt;~~ This is what you will get\n</code></pre>\n\n<p>and then this</p>\n\n<pre><code>?\"\"\"\" = Chr(34)\nTrue '&lt;~~ This is what you will get\n</code></pre>\n\n<p>Now try </p>\n\n<pre><code>?\"\"\" = Chr(34)\n</code></pre>\n\n<p>See what you get :)</p>\n\n<p>In your code, replace <code>\"\"\"</code> by <code>\"\"\"\"</code> or <code>Chr(34)</code> so it becomes <code>What:=\"\"\"\"</code></p>\n"}], "owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17, "favorite_count": 0, "accepted_answer_id": 54212610, "answer_count": 1, "score": 1, "last_activity_date": 1547626187, "creation_date": 1547624817, "last_edit_date": 1547626187, "question_id": 54212409, "link": "https://stackoverflow.com/questions/54212409/error-when-trying-to-find-replace-the-qoute-sign-with-range-replace", "title": "Error when trying to find &amp; replace the qoute sign &quot; with Range.Replace", "body": "<p>I have a macro file that split files and names them by specific list The names of the files in this list that contain the quote sign <code>\"</code> is not getting created and I want to find and replace all of them with regular space in that range only. </p>\n\n<p>But when I run the macro it returns me </p>\n\n<blockquote>\n  <p>Argument not optional. </p>\n</blockquote>\n\n<p>Can someone find where is my problem?</p>\n\n<pre><code>'Loop for creating files\nFor i = 2 To FilesCounter\n    NewWBName = EmailWS.Cells(i, 1).Value\n    Set NewWB = Workbooks.Add\n\n    With SplitWS\n        .Range(.Cells(1, 1), .Cells(LastRow, LastColumn)).AutoFilter Field:=1, Criteria1:=NewWBName\n        .Range(.Cells(1, 2), .Cells(LastRow, LastColumn)).SpecialCells(xlCellTypeVisible).Copy  'Copy cells starting from column B\n    End With\n\n    With NewWB.Worksheets(1)\n        .Cells(1, 1).PasteSpecial xlPasteFormats\n        .Cells(1, 1).PasteSpecial xlPasteValues\n        .Cells.EntireColumn.AutoFit\n    End With\n\n    'find and replace all th \" in the WB names list\n    With EmailWS\n        .Range(\"$A:$A\").Replace What:=\"\"\", Replacement:=\"\", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False\"\n        .Cells(i, 1).Value = NameForFile &amp; \"\" &amp; NewWBName\n    End With\n\n    NewWB.SaveAs fileName:=DesPath &amp; \"\\\" &amp; NameForFile &amp; \"\" &amp; NewWBName &amp; \".xlsx\", Password:=PassFile\n    NewWB.Close\n\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba", "multiple-columns", "userform", "checkedlistbox"], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1547625676, "last_edit_date": 1547625676, "creation_date": 1547624623, "answer_id": 54212376, "question_id": 54212202, "link": "https://stackoverflow.com/questions/54212202/could-not-set-the-selected-property-of-a-multi-column-listbox-in-excel-vba-userf/54212376#54212376", "title": "Could not set the selected property of a multi-column ListBox in Excel VBA UserForm", "body": "<p>You must subtract <code>-1</code> from your <code>.ListCount</code> \u2026 </p>\n\n<pre><code>lstPreConditionLogic.Selected(lstPreConditionLogic.ListCount - 1) = True\n</code></pre>\n\n<p>Because the list index stats counting at <code>0</code> but eg if the <code>ListCount = 5</code> then the index of these 5 entries are <code>0</code>, <code>1</code>, <code>2</code>, <code>3</code>, <code>4</code> which means the last valid index is <code>.ListCount - 1</code>.</p>\n"}], "owner": {"reputation": 585, "user_id": 4381453, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/6GMuA.png?s=128&g=1", "display_name": "Sujoy", "link": "https://stackoverflow.com/users/4381453/sujoy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "accepted_answer_id": 54212376, "answer_count": 1, "score": 1, "last_activity_date": 1547625676, "creation_date": 1547623671, "last_edit_date": 1547624141, "question_id": 54212202, "link": "https://stackoverflow.com/questions/54212202/could-not-set-the-selected-property-of-a-multi-column-listbox-in-excel-vba-userf", "title": "Could not set the selected property of a multi-column ListBox in Excel VBA UserForm", "body": "<p>I am unable to check an item in a multi-column user-form ListBox. The line <code>lstPreConditionLogic.Selected(lstPreConditionLogic.ListCount) = True</code> generates the following error:</p>\n\n<blockquote>\n  <p>Run-time error '380': Could not set the Selected property. Invalid property value</p>\n</blockquote>\n\n<p>I tried setting the value to <code>-1</code> , <code>checked</code> but it did not work.</p>\n\n<p><strong>VBA Code</strong></p>\n\n<pre><code>Private Function FillPreConditionLogicList()\n    Dim varTemp             As Variant\n    Dim intLoop             As Integer\n    Dim strExpression       As String\n    Dim PreConditionLogic   As clsPreConditionLogic\n\n    With lstPreConditionLogic\n        .ColumnCount = 3\n        .ListStyle = fmListStyleOption\n        .MultiSelect = fmMultiSelectMulti\n        strExpression = TrimBlank(shtExpressionEditor.Range(\"rngExpText\").Offset(, 1).Value)\n        For intLoop = 0 To mDicPreConditionLogic.Count - 1\n            Set PreConditionLogic = mDicPreConditionLogic.Items(intLoop)\n            .AddItem\n            .List(intLoop, 0) = PreConditionLogic.Name\n            .List(intLoop, 1) = PreConditionLogic.StartEnclosure\n            .List(intLoop, 2) = PreConditionLogic.EndEnclosure\n            varTemp = GetEnclosedString(strExpression, PreConditionLogic.StartEnclosure, PreConditionLogic.EndEnclosure)\n            If varTemp &lt;&gt; \"\" Then\n                lstPreConditionLogic.Selected(lstPreConditionLogic.ListCount) = True '//Gives Error\n                strExpression = varTemp\n            End If\n        Next\n    End With\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1547624106, "post_id": 54211809, "comment_id": 95250445, "body": "Can you share the excel file?"}, {"owner": {"reputation": 105, "user_id": 10920729, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_ltMaFtzIv4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYYlgRs7xn98OGe-4tYHU7MgKgl9w/mo/photo.jpg?sz=128", "display_name": "stella", "link": "https://stackoverflow.com/users/10920729/stella"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1547785900, "post_id": 54211809, "comment_id": 95319804, "body": "hello 0m3r, i added a link to the file thank you"}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 10920729, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_ltMaFtzIv4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYYlgRs7xn98OGe-4tYHU7MgKgl9w/mo/photo.jpg?sz=128", "display_name": "stella", "link": "https://stackoverflow.com/users/10920729/stella"}, "edited": false, "score": 0, "creation_date": 1547790896, "post_id": 54248241, "comment_id": 95320915, "body": "HEY THANK YOU SO MUCH!!! THE FIRST PROBLEM WORKED!! However, the problem 2 isn&#39;t working yet. nothing happens whever i click the UPDATE BTN."}, {"owner": {"reputation": 105, "user_id": 10920729, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_ltMaFtzIv4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYYlgRs7xn98OGe-4tYHU7MgKgl9w/mo/photo.jpg?sz=128", "display_name": "stella", "link": "https://stackoverflow.com/users/10920729/stella"}, "edited": false, "score": 0, "creation_date": 1547790922, "post_id": 54248241, "comment_id": 95320926, "body": "but thank you so much for the 1st problem tho!! You are so good!"}, {"owner": {"reputation": 436, "user_id": 5444290, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/m1koV.jpg?s=128&g=1", "display_name": "Venkatesh R", "link": "https://stackoverflow.com/users/5444290/venkatesh-r"}, "reply_to_user": {"reputation": 105, "user_id": 10920729, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_ltMaFtzIv4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYYlgRs7xn98OGe-4tYHU7MgKgl9w/mo/photo.jpg?sz=128", "display_name": "stella", "link": "https://stackoverflow.com/users/10920729/stella"}, "edited": false, "score": 0, "creation_date": 1547796674, "post_id": 54248241, "comment_id": 95322996, "body": "Express your appreciation by accepting and upvoting helpful answers :) <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>"}, {"owner": {"reputation": 105, "user_id": 10920729, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_ltMaFtzIv4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYYlgRs7xn98OGe-4tYHU7MgKgl9w/mo/photo.jpg?sz=128", "display_name": "stella", "link": "https://stackoverflow.com/users/10920729/stella"}, "edited": false, "score": 0, "creation_date": 1548122330, "post_id": 54248241, "comment_id": 95420752, "body": "Hellooo I upvoted it but stackoverflow prompts &quot;Thanks for the feedback! Votes cast by those with less than 15 reputation are recorded, but do not change the publicly displayed post score.&quot;"}], "tags": [], "owner": {"reputation": 436, "user_id": 5444290, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/m1koV.jpg?s=128&g=1", "display_name": "Venkatesh R", "link": "https://stackoverflow.com/users/5444290/venkatesh-r"}, "is_accepted": true, "score": 1, "last_activity_date": 1547791136, "last_edit_date": 1547791136, "creation_date": 1547789792, "answer_id": 54248241, "question_id": 54211809, "link": "https://stackoverflow.com/questions/54211809/how-to-update-the-selected-row-in-the-listbox/54248241#54248241", "title": "How to update the selected row in the listbox?", "body": "<p>Use the below code for <strong>Problem1</strong></p>\n\n<p>Used Change event for combobox so if user changes any value the list box and combo box will be populated based on the value selected in the combo box.</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n    x = Sheets(\"PRESTAGEDB\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    For y = 2 To x\n        If Sheets(\"PRESTAGEDB\").Cells(y, 1).Text = ComboBox1.Value Then\n            cmbSchema.Text = Sheets(\"PRESTAGEDB\").Cells(y, 1)\n            cmbEnvironment.Text = Sheets(\"PRESTAGEDB\").Cells(y, 2)\n            cmbHost.Text = Sheets(\"PRESTAGEDB\").Cells(y, 3)\n            cmbIP.Text = Sheets(\"PRESTAGEDB\").Cells(y, 4)\n            cmbAccessible.Text = Sheets(\"PRESTAGEDB\").Cells(y, 5)\n            cmbLast.Text = Sheets(\"PRESTAGEDB\").Cells(y, 6)\n            cmbConfirmation.Text = Sheets(\"PRESTAGEDB\").Cells(y, 7)\n            cmbProjects.Text = Sheets(\"PRESTAGEDB\").Cells(y, 8)\n\n            UserForm1.ListBox1.RowSource = \"A\" + CStr(y) + \": H\" + CStr(y)\n            Exit For\n        End If\n    Next y\nEnd Sub\n</code></pre>\n\n<p>Please accept if resolves your issue</p>\n"}, {"comments": [{"owner": {"reputation": 105, "user_id": 10920729, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_ltMaFtzIv4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYYlgRs7xn98OGe-4tYHU7MgKgl9w/mo/photo.jpg?sz=128", "display_name": "stella", "link": "https://stackoverflow.com/users/10920729/stella"}, "edited": false, "score": 0, "creation_date": 1547791670, "post_id": 54248457, "comment_id": 95321132, "body": "Hello, I don&#39;t know if I&#39;m correct but I copied your code and still nothing happens. My original code was cmbEnvironment so i added .Value in the end but nothing still works. What am I missing?"}, {"owner": {"reputation": 105, "user_id": 10920729, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_ltMaFtzIv4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYYlgRs7xn98OGe-4tYHU7MgKgl9w/mo/photo.jpg?sz=128", "display_name": "stella", "link": "https://stackoverflow.com/users/10920729/stella"}, "edited": false, "score": 0, "creation_date": 1547791872, "post_id": 54248457, "comment_id": 95321204, "body": "I don&#39;t get any errors tho. it just happen that whenever i try to update the value in he combobox it, it is still not updated on the list/spreadsheet. It just goes back to it&#39;s own value."}, {"owner": {"reputation": 105, "user_id": 10920729, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_ltMaFtzIv4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYYlgRs7xn98OGe-4tYHU7MgKgl9w/mo/photo.jpg?sz=128", "display_name": "stella", "link": "https://stackoverflow.com/users/10920729/stella"}, "edited": false, "score": 0, "creation_date": 1547792096, "post_id": 54248457, "comment_id": 95321274, "body": "Try clicking the &quot;VIEW DATA&quot; button and all the details in the spreadsheet are displayed. What i&#39;m trying to do is that I will click a row from the listbox and edit the value to the combobox and save it using the Update button. However, it doesn&#39;t work. I&#39;m still trying to figure it out. I appreciate all the help from you, VENKATESH. Many thanks!"}, {"owner": {"reputation": 436, "user_id": 5444290, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/m1koV.jpg?s=128&g=1", "display_name": "Venkatesh R", "link": "https://stackoverflow.com/users/5444290/venkatesh-r"}, "reply_to_user": {"reputation": 105, "user_id": 10920729, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_ltMaFtzIv4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYYlgRs7xn98OGe-4tYHU7MgKgl9w/mo/photo.jpg?sz=128", "display_name": "stella", "link": "https://stackoverflow.com/users/10920729/stella"}, "edited": false, "score": 0, "creation_date": 1547792686, "post_id": 54248457, "comment_id": 95321458, "body": "I have changed the work sheet name so use you original code and append .Value. Sheets(&quot;PRESTAGE DB&quot;).Cells(y, 2) in Add watch and check the value is get changed when respective code is executed."}, {"owner": {"reputation": 105, "user_id": 10920729, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_ltMaFtzIv4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYYlgRs7xn98OGe-4tYHU7MgKgl9w/mo/photo.jpg?sz=128", "display_name": "stella", "link": "https://stackoverflow.com/users/10920729/stella"}, "edited": false, "score": 0, "creation_date": 1547793628, "post_id": 54248457, "comment_id": 95321795, "body": "ohhh i see the problem now. It only works on the cmbEnvironment column but not in any other columns. I was typing on PROJECTS combobox but it didn&#39;t work."}, {"owner": {"reputation": 105, "user_id": 10920729, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_ltMaFtzIv4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYYlgRs7xn98OGe-4tYHU7MgKgl9w/mo/photo.jpg?sz=128", "display_name": "stella", "link": "https://stackoverflow.com/users/10920729/stella"}, "edited": false, "score": 0, "creation_date": 1547793681, "post_id": 54248457, "comment_id": 95321823, "body": "it only allows me to edit the Environment column but not the HOST to PROJECTS"}, {"owner": {"reputation": 436, "user_id": 5444290, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/m1koV.jpg?s=128&g=1", "display_name": "Venkatesh R", "link": "https://stackoverflow.com/users/5444290/venkatesh-r"}, "reply_to_user": {"reputation": 105, "user_id": 10920729, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_ltMaFtzIv4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYYlgRs7xn98OGe-4tYHU7MgKgl9w/mo/photo.jpg?sz=128", "display_name": "stella", "link": "https://stackoverflow.com/users/10920729/stella"}, "edited": false, "score": 0, "creation_date": 1547795108, "post_id": 54248457, "comment_id": 95322365, "body": "Have verified. It is worked fine for me. I gone to Macro window (Microsoft Visual Basic for Applications). Pressed F5 from key board. Selected &quot;L_MA_MEMRE/MDCOREDI&quot; from Combo box which is at top left. Entered the value &quot;Test&quot; Environment combobox and &#39;N&#39; in Accessible combo box. Clicked &quot;Update Row&quot;. The details are updated in the spread sheet. Please let me know if i missing something here"}, {"owner": {"reputation": 436, "user_id": 5444290, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/m1koV.jpg?s=128&g=1", "display_name": "Venkatesh R", "link": "https://stackoverflow.com/users/5444290/venkatesh-r"}, "reply_to_user": {"reputation": 105, "user_id": 10920729, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_ltMaFtzIv4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYYlgRs7xn98OGe-4tYHU7MgKgl9w/mo/photo.jpg?sz=128", "display_name": "stella", "link": "https://stackoverflow.com/users/10920729/stella"}, "edited": false, "score": 0, "creation_date": 1547796861, "post_id": 54248457, "comment_id": 95323081, "body": "Please check whether multiple spread sheet opened. If so please close the other excel sheet and try it."}], "tags": [], "owner": {"reputation": 436, "user_id": 5444290, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/m1koV.jpg?s=128&g=1", "display_name": "Venkatesh R", "link": "https://stackoverflow.com/users/5444290/venkatesh-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1547791551, "last_edit_date": 1547791551, "creation_date": 1547791179, "answer_id": 54248457, "question_id": 54211809, "link": "https://stackoverflow.com/questions/54211809/how-to-update-the-selected-row-in-the-listbox/54248457#54248457", "title": "How to update the selected row in the listbox?", "body": "<p>For <strong>Problem2</strong></p>\n\n<p>Use .Value to get the value from the field and then set the value to the spread sheet -> cmbEnvironment.Value</p>\n\n<pre><code>Private Sub cmbUpdate_Click()\n\n    Dim x As Long\n    Dim y As Long\n\n    x = Sheets(\"PRESTAGEDB\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    For y = 2 To x\n        If Sheets(\"PRESTAGEDB\").Cells(y, 1).Text = cmbSchema.Value Then\n            Sheets(\"PRESTAGEDB\").Cells(y, 2) = cmbEnvironment.Value\n            Sheets(\"PRESTAGEDB\").Cells(y, 3) = cmbHost.Value\n            Sheets(\"PRESTAGEDB\").Cells(y, 4) = cmbIP.Value\n            Sheets(\"PRESTAGEDB\").Cells(y, 5) = cmbAccessible.Value\n            Sheets(\"PRESTAGEDB\").Cells(y, 6) = cmbLast.Value\n            Sheets(\"PRESTAGEDB\").Cells(y, 7) = cmbConfirmation.Value\n            Sheets(\"PRESTAGEDB\").Cells(y, 8) = cmbProjects.Value\n            Exit For\n        End If\n    Next y\nEnd Sub\n</code></pre>\n\n<p>When i Change the value in the combobox it is set the updated value in the cell. Please debug the code and share the details if not working.</p>\n"}], "owner": {"reputation": 105, "user_id": 10920729, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_ltMaFtzIv4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYYlgRs7xn98OGe-4tYHU7MgKgl9w/mo/photo.jpg?sz=128", "display_name": "stella", "link": "https://stackoverflow.com/users/10920729/stella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1819, "favorite_count": 0, "accepted_answer_id": 54248241, "answer_count": 2, "score": 1, "last_activity_date": 1547791551, "creation_date": 1547621786, "last_edit_date": 1547785874, "question_id": 54211809, "link": "https://stackoverflow.com/questions/54211809/how-to-update-the-selected-row-in-the-listbox", "title": "How to update the selected row in the listbox?", "body": "<p>Hello so I'm trying to develop a UserForm and it's my first time. </p>\n\n<p><a href=\"https://i.stack.imgur.com/hPLj0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hPLj0.png\" alt=\"UI\"></a></p>\n\n<p>I'm having a problem with my ComboBox and ListBox (pretty much not functioning well). </p>\n\n<p>You see, I have a ComboBox right above the ListBox and that's where I would choose a value and the row values should be displayed BOTH on the ListBox and the ComboBoxes.</p>\n\n<p><strong>Problem 1:</strong> The values only show in the ComboBoxes BUT NOT in the ListBox.</p>\n\n<p>If I clicked on the \"VIEW DATA\" button, all the values from the spreadsheet are displayed on the ListBox with 8 columns. If clicked on a row from the ListBox (obviously it will be highlighted) it will also be displayed on the ComboBoxes below. </p>\n\n<p><strong>Problem 2:</strong> Whenever I try to edit the values in the ComboBox and click the update button, nothing happens. It doesn't update anything. </p>\n\n<p>I'm looking for answers everywhere but I can't seem to find one. </p>\n\n<pre><code>     Private Sub btnDelete_Click()\n\n        Dim a As Integer\n\n            If MsgBox(\"Are you sure you want to delete this row?\", vbYesNo + vbQuestion, \"Yes\") = vbYes Then\n\n                For a = 1 To Range(\"A100000\").End(xlUp).Row\n                    If Cells(a, 1) = listHeader.List(listHeader.ListIndex) Then\n                    Rows(a).Select\n                    Selection.Delete\n                End If\n            Next a\n        End If\n\n    End Sub\n\nPrivate Sub btnSearch_Click()\n\n'IM THINKING ABOUT REMOVING THE SEARCH BUTTON BECAUSE THE COMBOBOX ITSELF CAN BE USED FOR SEARCHING THE ROW\n'IT MAKES THE SEARCH BUTTON USELESS\n\n'Dim x As Long\n'Dim y As Long\n\n'x = Sheets(\"PRESTAGE DB\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n'For y = 2 To x\n\n'If Sheets(\"PRESTAGE DB\").Cells(y, 1).Text = cmbSearch.Value Then\n    'cmbSchema.Text = Sheets(\"PRESTAGE DB\").Cells(y, 1)\n    'cmbEnvironment.Text = Sheets(\"PRESTAGE DB\").Cells(y, 2)\n    'cmbHost.Text = Sheets(\"PRESTAGE DB\").Cells(y, 3)\n    'cmbIP.Text = Sheets(\"PRESTAGE DB\").Cells(y, 4)\n    'cmbAccessible.Text = Sheets(\"PRESTAGE DB\").Cells(y, 5)\n    'cmbLast.Text = Sheets(\"PRESTAGE DB\").Cells(y, 6)\n    'cmbConfirmation.Text = Sheets(\"PRESTAGE DB\").Cells(y, 7)\n    'cmbProjects.Text = Sheets(\"PRESTAGE DB\").Cells(y, 8)\n\n'End If\n'Next y\n\nEnd Sub\n\n    Private Sub btnView_Click()\n\n        listHeader.RowSource = \"A4:H200\"\n\n    End Sub\n\nPrivate Sub cmbAdd_Click()\n    Dim sheet As Worksheet\n    Set sheet = ThisWorkbook.Sheets(\"PRESTAGE DB\")\n\n    nextrow = sheet.Cells(Rows.Count, 1).End(xlUp).Row + 1\n\n    sheet.Cells(nextrow, 1) = Me.cmbSchema\n    sheet.Cells(nextrow, 2) = Me.cmbEnvironment\n    sheet.Cells(nextrow, 3) = Me.cmbHost\n    sheet.Cells(nextrow, 4) = Me.cmbIP\n    sheet.Cells(nextrow, 5) = Me.cmbAccessible\n    sheet.Cells(nextrow, 6) = Me.cmbLast\n    sheet.Cells(nextrow, 7) = Me.cmbConfirmation\n    sheet.Cells(nextrow, 8) = Me.cmbProjects\n\n    MsgBox \"Data Added!\"\n\nEnd Sub\n\nPrivate Sub cmbClearFields_Click()\n\n    cmbSchema.Text = \"\"\n    cmbEnvironment.Text = \"\"\n    cmbHost.Text = \"\"\n    cmbIP.Text = \"\"\n    cmbAccessible.Text = \"\"\n    cmbLast.Text = \"\"\n    cmbConfirmation.Text = \"\"\n    cmbProjects.Text = \"\"\n    cmbSearch.Text = \"\"\n\nEnd Sub\n\nPrivate Sub cmbSearch_Change()\n\nDim x As Long\nDim y As Long\n\nx = Sheets(\"PRESTAGE DB\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor y = 2 To x\n\nIf Sheets(\"PRESTAGE DB\").Cells(y, 1).Text = cmbSearch.Value Then\n    cmbSchema.Text = Sheets(\"PRESTAGE DB\").Cells(y, 1)\n    cmbEnvironment.Text = Sheets(\"PRESTAGE DB\").Cells(y, 2)\n    cmbHost.Text = Sheets(\"PRESTAGE DB\").Cells(y, 3)\n    cmbIP.Text = Sheets(\"PRESTAGE DB\").Cells(y, 4)\n    cmbAccessible.Text = Sheets(\"PRESTAGE DB\").Cells(y, 5)\n    cmbLast.Text = Sheets(\"PRESTAGE DB\").Cells(y, 6)\n    cmbConfirmation.Text = Sheets(\"PRESTAGE DB\").Cells(y, 7)\n    cmbProjects.Text = Sheets(\"PRESTAGE DB\").Cells(y, 8)\n\nEnd If\nNext y\n\nEnd Sub\n\n    Private Sub cmbUpdate_Click()\n\n    Dim x As Long\n    Dim y As Long\n\n    x = Sheets(\"PRESTAGE DB\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    For y = 2 To x\n    If Sheets(\"PRESTAGE DB\").Cells(y, 1).Text = cmbSchema.Value Then\n    Sheets(\"PRESTAGE DB\").Cells(y, 2) = cmbEnvironment\n    Sheets(\"PRESTAGE DB\").Cells(y, 3) = cmbHost\n    Sheets(\"PRESTAGE DB\").Cells(y, 4) = cmbIP\n    Sheets(\"PRESTAGE DB\").Cells(y, 5) = cmbAccessible\n    Sheets(\"PRESTAGE DB\").Cells(y, 6) = cmbLast\n    Sheets(\"PRESTAGE DB\").Cells(y, 7) = cmbConfirmation\n    Sheets(\"PRESTAGE DB\").Cells(y, 8) = cmbProjects\n\n    End If\n    Next y\n\n    End Sub\n\n    Private Sub CommandButton5_Click()\n        listHeader.RowSource = \"\"\n\n    End Sub\n\n\nPrivate Sub CommandButton7_Click()\n\nEnd Sub\n\n    Private Sub listHeader_Click()\n\n        cmbSchema.Value = UserForm1.listHeader.Column(0)\n        cmbEnvironment.Value = UserForm1.listHeader.Column(1)\n        cmbHost.Value = UserForm1.listHeader.Column(2)\n        cmbIP.Value = UserForm1.listHeader.Column(3)\n        cmbAccessible.Value = UserForm1.listHeader.Column(4)\n        cmbLast.Value = UserForm1.listHeader.Column(5)\n        cmbConfirmation.Value = UserForm1.listHeader.Column(6)\n        cmbProjects.Value = UserForm1.listHeader.Column(7)\n\n    End Sub\n\n\n    Private Sub UserForm_Initialize()\n\n        cmbSearch.List = Sheets(\"PRESTAGE DB\").Range(\"A4:A10000\").Value\n\n    End Sub\n</code></pre>\n\n<p>file: <a href=\"https://jmp.sh/cZj8e4q\" rel=\"nofollow noreferrer\">https://jmp.sh/cZj8e4q</a></p>\n"}, {"tags": ["excel", "vba", "byref"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1547621475, "post_id": 54211677, "comment_id": 95249389, "body": "You should <i>always</i> put <code>Option Explicit</code> at the top of <i>every</i> code module. And you should <i>always</i> <code>Dim</code> every variable you use. Aside from that, try <code>buttonclick (nr-1) to perform the calculation *before* passing anything to </code>buttonclick<code>and see if that helps. If not, put in a line </code>nr = nr -1` before the <code>buttonclick</code> line."}, {"owner": {"reputation": 123, "user_id": 10914591, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/f33d02d4c189e6054790d894887b72f4?s=128&d=identicon&r=PG", "display_name": "catcat", "link": "https://stackoverflow.com/users/10914591/catcat"}, "edited": false, "score": 0, "creation_date": 1547626848, "post_id": 54211677, "comment_id": 95251480, "body": "Your <code>function nextrow</code> doesn&#39;t return a value, the definition of a function. So it&#39;s actually a sub. <code>nr</code> will never equal anything."}, {"owner": {"reputation": 189, "user_id": 10898526, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XV76tGqrBMc/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaEc9_K-EQi4o9OEHN68apEDP8Gzg/mo/photo.jpg?sz=128", "display_name": "Lawrence", "link": "https://stackoverflow.com/users/10898526/lawrence"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1547678932, "post_id": 54211677, "comment_id": 95279119, "body": "@Cindy, thanks for the tips.  @catcat, that&#39;s a good point. If I changed it, do you think I would still need to <code>dim nr</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 10898526, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XV76tGqrBMc/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaEc9_K-EQi4o9OEHN68apEDP8Gzg/mo/photo.jpg?sz=128", "display_name": "Lawrence", "link": "https://stackoverflow.com/users/10898526/lawrence"}, "edited": false, "score": 0, "creation_date": 1547678492, "post_id": 54211792, "comment_id": 95278988, "body": "Thanks for the writeup, it really clarified things for me"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1547622574, "last_edit_date": 1547622574, "creation_date": 1547621666, "answer_id": 54211792, "question_id": 54211677, "link": "https://stackoverflow.com/questions/54211677/vba-byref-argument-type-mismatch-is-inconsistent/54211792#54211792", "title": "VBA ByRef argument type mismatch is inconsistent?", "body": "<p>Since you are dealing with rows, I would recommned using <code>Long</code> instead of <code>Integer</code>. You are getting that error because in <code>Private Sub buttonclick(nr As Integer)</code>, it is expecting an <code>Integer</code> and you are passing a <code>Variant</code></p>\n\n<p>Change <code>Private Sub buttonclick(nr As Integer)</code> to <code>Private Sub buttonclick(nr As Long)</code></p>\n\n<p>and use this</p>\n\n<pre><code>Private Sub distract2()\n    Dim nr As Long\n    Dim nVal As Long\n\n    nr = nextrow\n\n    If nr = 2 Then Exit Sub\n\n    nVal = nr - 1\n\n    buttonclick nVal\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>However, when I remove -1 from after nr, VBA throws a ByRef error.\n  Two questions:\n  Does anyone know why this happens?\n  Is it better to dim nr as Integer or not?</p>\n</blockquote>\n\n<p>When you keep <code>-1</code>, it is subtracting the value by <code>1</code> and the result is of <code>Integer</code> type and hence you do not get an error. If <code>nr</code> was <code>104857</code> then it would give an error. <a href=\"https://stackoverflow.com/questions/10890892/use-of-symbol-hash-in-vba-macro/10891051#10891051\">Interesting Read</a></p>\n\n<p>Yes it is better to dim your variables as relevant datatype. However in your case it should be <code>Long</code> instead of <code>Integer</code> as mentioned above</p>\n\n<p>Your complete code can be written as</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub distract2()\n    Dim nr As Long\n    Dim nVal As Long\n\n    nr = nextrow\n\n    If nr = 2 Then Exit Sub\n\n    nVal = nr - 1\n\n    buttonclick nVal\nEnd Sub\n\nFunction nextrow() As Long\n    With ActiveSheet\n        nextrow = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1\n    End With\nEnd Function\n\nPrivate Sub buttonclick(nr As Long)\n    With ActiveSheet\n        .Cells(nr, 2) = Now\n        If nr = 2 Then Exit Sub\n        .Cells(nr - 1, 3) = .Cells(nr, 2) - .Cells(nr - 1, 2)\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 10898526, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XV76tGqrBMc/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaEc9_K-EQi4o9OEHN68apEDP8Gzg/mo/photo.jpg?sz=128", "display_name": "Lawrence", "link": "https://stackoverflow.com/users/10898526/lawrence"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 54211792, "answer_count": 1, "score": 1, "last_activity_date": 1547622574, "creation_date": 1547620983, "question_id": 54211677, "link": "https://stackoverflow.com/questions/54211677/vba-byref-argument-type-mismatch-is-inconsistent", "title": "VBA ByRef argument type mismatch is inconsistent?", "body": "<p>I'm writing a short script in VBA that prints and compares timestamps in various cells. The code is working fine, however I'm confused with the inconsistency of the \"ByRef arugement type mismatch\". My code is below.</p>\n\n<pre><code>Function nextrow()\nWith ActiveSheet\n    nextrow = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1\n    End With\n\nEnd Function\n____\n\nPrivate Sub buttonclick(nr As Integer)\nWith ActiveSheet\n    .Cells(nr, 2) = Now\n    If nr = 2 Then Exit Sub\n        dur = .Cells(nr, 2) - .Cells(nr - 1, 2)\n        .Cells(nr - 1, 3) = dur\n    End With\n\nEnd Sub\n____\n\nPrivate Sub distract2()\nnr = nextrow\n\nIf nr = 2 Then Exit Sub\n    buttonclick nr - 1\n\nEnd Sub\n</code></pre>\n\n<p>If you look at <code>distract2</code>, you'll notice I haven't defined nr as an integer, but even so it passes through to <code>buttonclick</code> without a problem. </p>\n\n<p>However, when I remove <code>-1</code> from after nr, VBA throws a ByRef error.</p>\n\n<p>Two questions:</p>\n\n<ul>\n<li>Does anyone know why this happens?</li>\n<li>Is it better to <code>dim nr as Integer</code> or not?</li>\n</ul>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1547621765, "post_id": 54211388, "comment_id": 95249506, "body": "Your autofill method seems to be wrong correct example is <code>Set sourceRange = Worksheets(&quot;Sheet1&quot;).Range(&quot;A1:A2&quot;)  Set fillRange = Worksheets(&quot;Sheet1&quot;).Range(&quot;A1:A20&quot;)  sourceRange.AutoFill Destination:=fillRange</code> Secondly compiler giving problem on the code line <code>.Range(.Cells(3, 1).Address, .Cells(lastR, lastC).Address)</code>"}, {"owner": {"reputation": 113, "user_id": 10904582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2944732016e320662ac914dab5f66b5d?s=128&d=identicon&r=PG&f=1", "display_name": "j.doe", "link": "https://stackoverflow.com/users/10904582/j-doe"}, "reply_to_user": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1547622025, "post_id": 54211388, "comment_id": 95249594, "body": "the code works fine if i run it separately for each sheet"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1547622744, "post_id": 54211388, "comment_id": 95249870, "body": "Note that <b>all</b> your <code>Range</code> have to start with a dot like <code>.Range</code> otherwise they don&#39;t make use of the <code>With</code> statement. Some of your <code>Range</code> are missing the dot."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1547624113, "post_id": 54211388, "comment_id": 95250452, "body": "Can you edit your question to show code for one sheet only in addition to existing code which is working for that sheet to help in debugging the problem. It is giving error of Autofill method failed."}, {"owner": {"reputation": 31833, "user_id": 23574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff71c4381eaf3816bffda6c6fe53d33e?s=128&d=identicon&r=PG", "display_name": "shahkalpesh", "link": "https://stackoverflow.com/users/23574/shahkalpesh"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1547624303, "post_id": 54211388, "comment_id": 95250515, "body": "What is the line at which you are getting the error? Did you look @P\u1d07\u029c&#39;s suggestion on using <code>.Range</code>?"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1547624444, "post_id": 54211388, "comment_id": 95250575, "body": "In Excel 2010 Autofill works in a single direction only, either horizontal or vertical. Therefore, if you wish to fill a 2-dimensional range you should first fill one row horizontally (including the source cell) and then use that row as source copy the entire row down. Please check your Excel Version also."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1547624886, "post_id": 54211388, "comment_id": 95250753, "body": "@Peh I have checked the code after putting dot before Range , even then Autofill method of Range Class Fails."}, {"owner": {"reputation": 113, "user_id": 10904582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2944732016e320662ac914dab5f66b5d?s=128&d=identicon&r=PG&f=1", "display_name": "j.doe", "link": "https://stackoverflow.com/users/10904582/j-doe"}, "edited": false, "score": 0, "creation_date": 1547624974, "post_id": 54211388, "comment_id": 95250780, "body": "error 1004 got solved but now i am getting &quot;Autofill method of range class failed&quot; error is what i am getting"}, {"owner": {"reputation": 113, "user_id": 10904582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2944732016e320662ac914dab5f66b5d?s=128&d=identicon&r=PG&f=1", "display_name": "j.doe", "link": "https://stackoverflow.com/users/10904582/j-doe"}, "edited": false, "score": 0, "creation_date": 1547625303, "post_id": 54211388, "comment_id": 95250883, "body": "@peh you&#39;re suggestion worked thanks :)"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1547625710, "post_id": 54211388, "comment_id": 95251029, "body": "Autofill is filling the range but code gives the error"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1547626360, "post_id": 54211388, "comment_id": 95251271, "body": "@j.doe Just curious to know what main change corrected the program to work correctly."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1547632504, "post_id": 54211388, "comment_id": 95254530, "body": "@skkakkar I assume that the OP has the line after <code>AutoFill</code> in the same line as <code>AutoFill</code> so <code>.Range(.Cells(3, 1).Address, .Cells(lastR, lastC).Address)</code> is the destination parameter for <code>Autofill</code> otherwise that all doesn&#39;t make any sense. So that it is 2 lines in the question is just a formatting issue I think. \u2022 I posted it as an answer."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1547633204, "post_id": 54211388, "comment_id": 95254976, "body": "@PEH Thanks for clarifying the matter. I agree with your assessment."}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1547632612, "creation_date": 1547632612, "answer_id": 54214461, "question_id": 54211388, "link": "https://stackoverflow.com/questions/54211388/combine-3-vba-codes-and-run-it-as-a-single-piece-of-code/54214461#54214461", "title": "Combine 3 VBA codes and run it as a single piece of code", "body": "<p>Note that all your <code>Range</code> have to start with a dot like <code>.Range</code> otherwise they don't make use of the <code>With</code> statement. Some of your <code>Range</code> are missing the dot.</p>\n\n<p>So instead of </p>\n\n<pre><code>With wsS2\n    lastC = .Cells(3, Columns.Count).End(xlToLeft).Column\n    Range(.Cells(3, 1).Address, .Cells(3, lastC).Address).AutoFill \n    .Range(.Cells(3, 1).Address, .Cells(lastR, lastC).Address)\nEnd With\n</code></pre>\n\n<p>it should be</p>\n\n<pre><code>With wsS2\n    lastC = .Cells(3, Columns.Count).End(xlToLeft).Column\n    .Range(.Cells(3, 1).Address, .Cells(3, lastC).Address).AutoFill .Range(.Cells(3, 1).Address, .Cells(lastR, lastC).Address)\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 10904582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2944732016e320662ac914dab5f66b5d?s=128&d=identicon&r=PG&f=1", "display_name": "j.doe", "link": "https://stackoverflow.com/users/10904582/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 54214461, "answer_count": 1, "score": 0, "last_activity_date": 1547632612, "creation_date": 1547619427, "last_edit_date": 1547622627, "question_id": 54211388, "link": "https://stackoverflow.com/questions/54211388/combine-3-vba-codes-and-run-it-as-a-single-piece-of-code", "title": "Combine 3 VBA codes and run it as a single piece of code", "body": "<p>I have 3 VBA codes that do the same actions on 3 different sheets. I want to run all 3 codes as a single code. </p>\n\n<p>I did it like this but it gives </p>\n\n<blockquote>\n  <p>application error (Error 1004)</p>\n</blockquote>\n\n<pre><code>Sub lastRow()\n    Dim wsS1 As Worksheet 'Sheet1\n    Dim wsS2 As Worksheet 'sheet2\n    Dim lastR As Long, lastC As Long\n\n    Set wsS1 = Sheets(\"Instru Input\")\n    Set wsS2 = Sheets(\"Final Input\")\n    Set wsS3 = Sheets(\"FinalInputFile\")\n\n    With wsS1\n        lastR = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row - 4\n    End With\n\n    With wsS2\n        lastC = .Cells(3, Columns.Count).End(xlToLeft).Column\n        Range(.Cells(3, 1).Address, .Cells(3, lastC).Address).AutoFill \n        .Range(.Cells(3, 1).Address, .Cells(lastR, lastC).Address)\n    End With\n\n    with wsS1\n        lastR = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row - 4\n    End With\n\n    With wsS3\n        lastC = .Cells(3, Columns.Count).End(xlToLeft).Column\n        Range(.Cells(3, 1).Address, .Cells(3, lastC).Address).AutoFill \n        .Range(.Cells(3, 1).Address, .Cells(lastR, lastC).Address)\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "pivot"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1547622568, "post_id": 54211245, "comment_id": 95249796, "body": "A pivot table wouldn&#39;t be a good fit here - if you show your existing code someone might have suggestions for fixing it."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1547640098, "post_id": 54211245, "comment_id": 95258892, "body": "Why not just use a filter?"}, {"owner": {"reputation": 349, "user_id": 9029949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a4a54ec7a7d786836ba38f198775d8?s=128&d=identicon&r=PG&f=1", "display_name": "Chopin", "link": "https://stackoverflow.com/users/9029949/chopin"}, "edited": false, "score": 0, "creation_date": 1547679968, "post_id": 54211245, "comment_id": 95279486, "body": "@ Ron Rosenfeld. That&#39;s how I originally conceptualised it. But that database is being continuously used by other parties. There needs to be a separate sheet that filters the data so the central database can be used without interruption."}, {"owner": {"reputation": 349, "user_id": 9029949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a4a54ec7a7d786836ba38f198775d8?s=128&d=identicon&r=PG&f=1", "display_name": "Chopin", "link": "https://stackoverflow.com/users/9029949/chopin"}, "edited": false, "score": 0, "creation_date": 1547680231, "post_id": 54211245, "comment_id": 95279571, "body": "@ Tim Williams. I can insert the <code>code</code> but It&#39;s redundant. Due to the large amount of data in central database it blows up <code>Excel</code> if I run a macro that copies over specific values. The file goes from around <code>5MB</code> to over <code>300MB</code> if i had in that code. I need something more flexible that only displays values from the last <i>n</i> period of time."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1547972556, "post_id": 54211245, "comment_id": 95371714, "body": "First, if you&#39;d use pivot table, you&#39;d almost doubles the size of file because pivot table creates <i>cache</i> - it&#39;s a copy of your data. Second, you could use SQL to query data - it&#39;s very fast."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 1, "creation_date": 1547995769, "post_id": 54211245, "comment_id": 95377111, "body": "@JPA0888 : I&#39;m surprised that you say the central database can&#39;t handle some of your queries.  What is it?  SQL Server or Access?  If it is an open source DB then you can set up replication to get your own instance at no cost.  Then you run your own queries on your own instance.  <a href=\"https://en.wikipedia.org/wiki/Replication_(computing)#Database_replication\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/&hellip;</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1547998267, "post_id": 54211245, "comment_id": 95377835, "body": "Is <code>Sheet1</code> the &quot;central database&quot;, or is it <i>connecting</i> to one?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1548001248, "post_id": 54211245, "comment_id": 95378696, "body": "Are the dates under A actual <i>dates</i> that Excel understands as such? i.e. is it possible to filter them with <code>MONTH(A) = MONTH(NOW)</code>? Or they&#39;re just strings and the &quot;month&quot; needs to be parsed out of them?"}, {"owner": {"reputation": 349, "user_id": 9029949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a4a54ec7a7d786836ba38f198775d8?s=128&d=identicon&r=PG&f=1", "display_name": "Chopin", "link": "https://stackoverflow.com/users/9029949/chopin"}, "edited": false, "score": 0, "creation_date": 1548022988, "post_id": 54211245, "comment_id": 95384884, "body": "Sorry for the confusion. Sheet1 is the central database. The users entering in data need something simple like an Excel table."}, {"owner": {"reputation": 349, "user_id": 9029949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a4a54ec7a7d786836ba38f198775d8?s=128&d=identicon&r=PG&f=1", "display_name": "Chopin", "link": "https://stackoverflow.com/users/9029949/chopin"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1548048494, "post_id": 54211245, "comment_id": 95389233, "body": "@MathieuGuindon, The dates are formatted as such. I can filter via them but I still need to display values from the alst month without filtering."}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 2, "creation_date": 1548050208, "post_id": 54211245, "comment_id": 95389702, "body": "What is the frequency of refresh of Sheet2? How often does the extract run?  Does Sheet2 start empty at the beginning of the month? or does Sheet2 contain a rolling 30-day span? Can Sheet2 be in a separate workbook, a different filename from Sheet1?  What front end do users have to insert new rows into Sheet1?  What is frequency of Insert? of Update? (of Delete?) for rows in Sheet1?"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 7, "creation_date": 1548067927, "post_id": 54211245, "comment_id": 95397452, "body": "If Excel crashes because of the size of the data, it&#39;s high time to change to a database."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 2, "creation_date": 1548081121, "post_id": 54211245, "comment_id": 95404733, "body": "I think it would be better to have 2 files: 1central database, and then other workbook that queries the central database, where you can specify parameters like dates. You can connect 2 workbooks using SQL sentences and it would be easy to refresh (and also, you can set up an autorefresh timer). Check <a href=\"https://superuser.com/a/421493\">How do I join two worksheets in Excel as I would in SQL?</a>"}, {"owner": {"reputation": 349, "user_id": 9029949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a4a54ec7a7d786836ba38f198775d8?s=128&d=identicon&r=PG&f=1", "display_name": "Chopin", "link": "https://stackoverflow.com/users/9029949/chopin"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1548111135, "post_id": 54211245, "comment_id": 95418142, "body": "@FunThomas, It only crashes upon transferring the data. There&#39;s around 10-15 separate macros that pull out specific info out of a large database. I understand the need to transfer and this is underway. It&#39;s an old-school work environment. I&#39;m batting one out trying to change a department. This takes some time to change and I need some stop gaps in the meantime"}, {"owner": {"reputation": 349, "user_id": 9029949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a4a54ec7a7d786836ba38f198775d8?s=128&d=identicon&r=PG&f=1", "display_name": "Chopin", "link": "https://stackoverflow.com/users/9029949/chopin"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1548111177, "post_id": 54211245, "comment_id": 95418158, "body": "Thanks @FoxfireAndBurnsAndBurns, this is a good suggestion. I&#39;ll look into it"}, {"owner": {"reputation": 349, "user_id": 9029949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a4a54ec7a7d786836ba38f198775d8?s=128&d=identicon&r=PG&f=1", "display_name": "Chopin", "link": "https://stackoverflow.com/users/9029949/chopin"}, "reply_to_user": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1548111462, "post_id": 54211245, "comment_id": 95418250, "body": "@donPablo, I&#39;ll update your queries I can update your queries in the question if youre going to look inot this. The refresh on sheet2 would be done a few times a day. Never more than 5. This would be a rolling 30 day span, it would never be empty. I&#39;d prefer to keep it in the same workbook as I have numerous sheets all relating to the central database. Data entered into sheet1 is at random but is approx 20-30 times a day.Can be more sometimes."}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1548114897, "post_id": 54211245, "comment_id": 95419147, "body": "Does Excel crash when users are entering new row(s)?  Or scrolling to see entire Sheet1? Or looking at Sheet3::thru::Sheet900? Or only crash when Sheet2 extract is being run? Is xls open concurrantly to multiple users?  Does extract Delete Sheet2, &amp; create new Sheet2? Or does it use existing Sheet2, clear ALL rows, &amp; paste in entire new set of rows.  I need to understand crash reason, &amp; not propose a solution known to crash. Please attach your extract code as a txt file (not jpg...). What line of code does it crash on?   Is extract code a module in Sheet1 xlsm? Or separate xlsm?"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1548195292, "post_id": 54211245, "comment_id": 95454329, "body": "I do not see date tags in your original data structure. Have you tried to use <code>ADODB.Recordset</code> +  <code>Range.CopyFromRecordset</code>?"}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1548273752, "post_id": 54211245, "comment_id": 95487090, "body": "Is the main database sheet being opened and closed by other users or is it being left open?"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1548276274, "post_id": 54211245, "comment_id": 95488062, "body": "Goes from &quot;5MB to over 300MB&quot;?   You should post your code on <a href=\"https://codereview.stackexchange.com/\">CodeReview</a>."}], "answers": [{"comments": [{"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1548264922, "post_id": 54328131, "comment_id": 95483154, "body": "Excellent answer.  I would convert it to late binding because there are multiple user and possibly multiple versions of the ADO library."}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": true, "score": 4, "last_activity_date": 1586867105, "last_edit_date": 1586867105, "creation_date": 1548249324, "answer_id": 54328131, "question_id": 54211245, "link": "https://stackoverflow.com/questions/54211245/pivot-full-text-instead-of-counts-excel/54328131#54328131", "title": "Pivot full text instead of counts - Excel", "body": "<p>As others have mentioned in the comments, using SQL with ADODB is likely a better approach than using PivotTables. I'd also recommend separating your data (Sheet1) from your presentation layer (Excel). E.g. store your data in an <em>actual</em> database like Access, SQL Server etc. </p>\n\n<p>However, as you are looking for a stop gap, I figured I could give you an approach that might fill the need temporarily. The code is commented, but feel free to ask questions. You will need to add a reference to <code>Microsoft Active X Data Object 2.8 or greater</code> to get this working. <a href=\"https://www.myonlinetraininghub.com/calling-vba-in-add-ins-from-vba-modules\" rel=\"nofollow noreferrer\">How to add a reference?</a></p>\n\n<hr>\n\n<p><strong>Early Binding Approach</strong></p>\n\n<pre><code>Option Explicit\nPublic Sub DisplayView(StartDate As Date, EndDate As Date)\n    'Add a reference to Microsoft Active X Data Object 2.8 or greater\n    Dim dbConnection  As ADODB.Connection\n    Dim dbRecordset   As ADODB.Recordset\n    Dim dbCommand     As ADODB.Command\n    Dim OutputSheet   As Excel.Worksheet\n    Dim dbField       As Variant\n    Dim fieldCounter  As Long\n\n    Set dbConnection = New ADODB.Connection\n    Set dbRecordset = New ADODB.Recordset\n    Set dbCommand = New ADODB.Command\n    Set OutputSheet = ThisWorkbook.Worksheets(\"Sheet2\")\n\n    'Do a quick check to determine the correct connection string\n    'if one of these don't work, have a look here --&gt; https://www.connectionstrings.com/excel/\n    If Left$(ThisWorkbook.FullName, 4) = \"xlsm\" Then\n        dbConnection.connectionstring = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; _\n        ThisWorkbook.FullName &amp; \";Extended Properties='Excel 12.0 Macro;HDR=YES';\"\n    Else\n        dbConnection.connectionstring = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; _\n        ThisWorkbook.FullName &amp; \";Extended Properties='Excel 12.0;HDR=YES';\"\n    End If\n\n    'Open the connection and parameterize the query\n    dbConnection.Open\n    With dbCommand\n        .ActiveConnection = dbConnection\n        .CommandType = adCmdText\n        'A in B in the text below are the field names in your Sheet 1\n        'I wasn't sure what the names of the fields are so I named them as they appeared\n        'That being Column A is called A, Column B is called B etc\n        .CommandText = \"Select * from [Sheet1$] where B in ('A','X') and A &gt;= @StartDate and A &lt; @EndDate\"\n        .Parameters.Append .CreateParameter(\"@StartDate\", adDate, adParamInput, , StartDate)\n        .Parameters.Append .CreateParameter(\"@EndDate\", adDate, adParamInput, , EndDate)\n        Set dbRecordset = .Execute\n    End With\n\n    'Clear the Output Sheet\n    OutputSheet.Cells.Clear\n\n    'Add Headers to output\n    For Each dbField In dbRecordset.Fields\n        fieldCounter = fieldCounter + 1\n        OutputSheet.Cells(1, fieldCounter).Value2 = dbField.Name\n    Next\n\n    'Dump the found records\n    OutputSheet.Range(\"A2\").CopyFromRecordset dbRecordset\n    If dbConnection.State = adStateOpen Then dbConnection.Close\nEnd Sub\n\n'Run from here\nPublic Sub ExampleRunner()\n    'Supply the dates you want to filter for\n    DisplayView #1/1/2019#, #1/20/2019#\nEnd Sub\n</code></pre>\n\n<p>As requested, here is the <strong>Late Binding Approach</strong> that doesn't require an explicit reference to <code>Microsoft Active X Data Object</code>.</p>\n\n<pre><code>Option Explicit\nPrivate Const adCmdText As Long = 1\nPrivate Const adDate As Long = 7\nPrivate Const adParamInput As Long = 1\nprivate const adStateOpen as long = 1\n\nPublic Sub DisplayView(StartDate As Date, EndDate As Date)\n    'Add a reference to Microsoft Active X Data Object 2.8 or greater\n    Dim dbField       As Variant\n    Dim fieldCounter  As Long\n    Dim dbConnection  As Object\n    Dim dbRecordset   As Object\n    Dim dbCommand     As Object\n    Dim OutputSheet   As Excel.Worksheet\n\n    Set dbConnection = CreateObject(\"ADODB.Connection\")\n    Set dbRecordset = CreateObject(\"ADODB.Recordset\")\n    Set dbCommand = CreateObject(\"ADODB.Command\")\n\n    Set OutputSheet = ThisWorkbook.Worksheets(\"Sheet2\")\n\n    'Do a quick check to determine the correct connection string\n    'if one of these don't work, have a look here --&gt; https://www.connectionstrings.com/excel/\n    If Left$(ThisWorkbook.FullName, 4) = \"xlsm\" Then\n        dbConnection.connectionstring = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; _\n        ThisWorkbook.FullName &amp; \";Extended Properties='Excel 12.0 Macro;HDR=YES';\"\n    Else\n        dbConnection.connectionstring = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; _\n        ThisWorkbook.FullName &amp; \";Extended Properties='Excel 12.0;HDR=YES';\"\n    End If\n\n    'Open the connection and parameterize the query\n    dbConnection.Open\n    With dbCommand\n        .ActiveConnection = dbConnection\n        .CommandType = adCmdText\n        'A in B in the text below are the field names in your Sheet 1\n        'I wasn't sure what the names of the fields are so I named them as they appeared\n        'That being Column A is called A, Column B is called B etc\n        .CommandText = \"Select * from [Sheet1$] where B in ('A','X') and A &gt;= @StartDate and A &lt; @EndDate\"\n        .Parameters.Append .CreateParameter(\"@StartDate\", adDate, adParamInput, , StartDate)\n        .Parameters.Append .CreateParameter(\"@EndDate\", adDate, adParamInput, , EndDate)\n        Set dbRecordset = .Execute\n    End With\n\n    'Clear the Output Sheet\n    OutputSheet.Cells.Clear\n\n    'Add Headers to output\n    For Each dbField In dbRecordset.Fields\n        fieldCounter = fieldCounter + 1\n        OutputSheet.Cells(1, fieldCounter).Value2 = dbField.Name\n    Next\n\n    'Dump the found records\n    OutputSheet.Range(\"A2\").CopyFromRecordset dbRecordset\n    If dbConnection.State = adStateOpen Then dbConnection.Close\nEnd Sub\n\n'Run from here\nPublic Sub ExampleRunner()\n    'Supply the dates you want to filter for\n    DisplayView #1/1/2019#, #1/20/2019#\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "is_accepted": false, "score": 0, "last_activity_date": 1548398305, "last_edit_date": 1548398305, "creation_date": 1548277208, "answer_id": 54335554, "question_id": 54211245, "link": "https://stackoverflow.com/questions/54211245/pivot-full-text-instead-of-counts-excel/54335554#54335554", "title": "Pivot full text instead of counts - Excel", "body": "<p>Here are some screenshots of the Results of the below mentioned Power Query.  I selected (In Excel 2003) Data->Import External Data->New Database Query\nThen, I chose \"Excel Files\" and added the data I wanted. Make sure to select \"is not null\" in the query options. I then added the auto sort feature.</p>\n\n<p><a href=\"https://i.stack.imgur.com/C8hoy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/C8hoy.png\" alt=\"ScreenShot1\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/u1dnk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u1dnk.png\" alt=\"ScreenShot2\"></a></p>\n\n<p>You could use a <a href=\"https://support.office.com/en-us/article/Import-data-from-external-data-sources-Power-Query-be4330b3-5356-486c-a168-b68e9e616f5a\" rel=\"nofollow noreferrer\">Power Query</a> in the Sheet2 Excel Workbook. <a href=\"https://support.office.com/en-us/article/connect-to-another-workbook-3a557ddb-70f3-400b-b48c-0c86ce62b4f5\" rel=\"nofollow noreferrer\">Another link here</a>. This way you could update the data whenever you need to. Then, use SQL to query what you need.</p>\n\n<p>It is pretty simple to use and doesn't take any coding (unless you want to use SQL).</p>\n\n<p>This can be done and then in your other workbook you can do the filtering and sorting.</p>\n\n<p>@ryan-wildry 's post is pretty great (and so is his command text for SQL), but if you do not want to use vba or a database then, you can use this (as well as his SQL text).</p>\n\n<p>An example would be:\n  SELECT * FROM [Sheet1$] WHERE Column2='X';</p>\n\n<p>The only problem would be if you have mixed datatypes in the same column.  As can be seen with rows 1 &amp; 4 (they were not able to come across with the query because the values are not the same type. (This is using Excel 2003 so if you have a newer version then, you may be able to check it with that).</p>\n\n<p>I've been doing some research and found that Excel's Power Query will handle mixed data types so, you should be set if you are using Power Query.</p>\n"}], "owner": {"reputation": 349, "user_id": 9029949, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a4a54ec7a7d786836ba38f198775d8?s=128&d=identicon&r=PG&f=1", "display_name": "Chopin", "link": "https://stackoverflow.com/users/9029949/chopin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 54328131, "answer_count": 2, "score": 4, "last_activity_date": 1586867105, "creation_date": 1547618637, "last_edit_date": 1548048616, "question_id": 54211245, "link": "https://stackoverflow.com/questions/54211245/pivot-full-text-instead-of-counts-excel", "title": "Pivot full text instead of counts - Excel", "body": "<p>I'm trying to determine the most efficient/effective way to display specific rows from a central table on <code>sheet1</code> as text on <code>sheet2</code>. </p>\n\n<p>I have setup a table that contains numerous events that is continually being used by multiple people. This sheet acts as a central database and is shared with multiple people who are all using it in real time. </p>\n\n<p>I want to provide a table on <code>sheet2</code> that allows other users to view specific events from the central database. So I need to export specific values from <code>sheet1</code> to <code>sheet2</code>. I understand this can easily be done using a filter but the table on <code>sheet1</code> is constantly being used and it can't be disrupted.</p>\n\n<p><strong>I can't just do a sort or filter on the <code>sheet1</code> table because it needs to be used by other parties at all times</strong> </p>\n\n<p>I really only need to view specific values from <code>sheet1</code> for the last month. I've got code the exports all rows based off a specific value entered into a designated column on <code>Sheet1</code>. But due to the size of the file Excel constantly crashes. </p>\n\n<p>I then thought a pivot table may be easier and I wouldn't have to use VBA. Is it possible to pivot out specific rows as text, which can be grouped by date, e.g. month?</p>\n\n<p>For instance, if I want to view all <code>['A's']</code> and <code>['X's']</code> from <code>Column B</code> from the last month as full text it would look like the following:</p>\n\n<p>Central Database table <code>Sheet1</code></p>\n\n<pre><code>   A   B  C   D\n0 11/1 A Big Dog\n1 10/1 X  1   2 \n2 11/1 Y  Y   Y\n3 1/2  A Big Cat\n4 1/2  X  3   4 \n5 1/2  Y  Y   Y\n</code></pre>\n\n<p>Output table <code>Sheet2</code></p>\n\n<pre><code>   A  B  C   D\n1 1/2 A Big Cat\n2 1/2 X  3   4\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 172, "user_id": 10627624, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-q24pnMMCBhM/AAAAAAAAAAI/AAAAAAAAAI0/9V6VmJktiDI/photo.jpg?sz=128", "display_name": "Alexey C", "link": "https://stackoverflow.com/users/10627624/alexey-c"}, "edited": false, "score": 0, "creation_date": 1547622394, "post_id": 54211244, "comment_id": 95249724, "body": "Hello. This links will help you, i think. <a href=\"https://stackoverflow.com/questions/14390123/removing-newline-from-a-csv-file\" title=\"removing newline from a csv file\">stackoverflow.com/questions/14390123/&hellip;</a> and <a href=\"https://stackoverflow.com/questions/39447740/how-to-remove-newline-characters-from-csv-file\" title=\"how to remove newline characters from csv file\">stackoverflow.com/questions/39447740/&hellip;</a>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1547641383, "post_id": 54211244, "comment_id": 95259602, "body": "You are going to have to replace both the <code>\\n</code> and also the <code>newline</code> character (which might be a <code>cr</code>, <code>lf</code> or both depending on how the csv was generated.."}, {"owner": {"reputation": 1, "user_id": 10920158, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UpQjWWTUNZ0/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwca5KzZXgk_G7SuWNnGsYMh6LR28rQ/mo/photo.jpg?sz=128", "display_name": "wisnu aditya", "link": "https://stackoverflow.com/users/10920158/wisnu-aditya"}, "reply_to_user": {"reputation": 172, "user_id": 10627624, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-q24pnMMCBhM/AAAAAAAAAAI/AAAAAAAAAI0/9V6VmJktiDI/photo.jpg?sz=128", "display_name": "Alexey C", "link": "https://stackoverflow.com/users/10627624/alexey-c"}, "edited": false, "score": 0, "creation_date": 1547701027, "post_id": 54211244, "comment_id": 95283744, "body": "Thank you for the link @AlexeyC, I don&#39;t have knowledge of phyton yet, but I will try to understand it."}, {"owner": {"reputation": 1, "user_id": 10920158, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UpQjWWTUNZ0/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwca5KzZXgk_G7SuWNnGsYMh6LR28rQ/mo/photo.jpg?sz=128", "display_name": "wisnu aditya", "link": "https://stackoverflow.com/users/10920158/wisnu-aditya"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1547701035, "post_id": 54211244, "comment_id": 95283745, "body": "@RonRosenfeld If I understand correctly, Instead of steps 2-5, I could just replaced &quot;cr\\n&quot; or &quot;lf\\n&quot; or crlf\\n&quot; with &quot; &quot;? Sadly I don&#39;t know how the csv was generated"}], "owner": {"reputation": 1, "user_id": 10920158, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UpQjWWTUNZ0/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwca5KzZXgk_G7SuWNnGsYMh6LR28rQ/mo/photo.jpg?sz=128", "display_name": "wisnu aditya", "link": "https://stackoverflow.com/users/10920158/wisnu-aditya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547618632, "creation_date": 1547618632, "question_id": 54211244, "link": "https://stackoverflow.com/questions/54211244/how-to-search-and-concatenate-cells-based-on-search-results", "title": "How to search and concatenate cells based on search results", "body": "<p>first off, I'm still learning excel VBA and it seems i'm trying to bite more than I can chew here. I tried to search for my problem but I cant find issues that close to mine.</p>\n\n<p>So, i have a csv dataset that looks like this:</p>\n\n<pre><code>date,\"0000000000\",\"SAO\",\"32\",\"Description\",\"5000\",\"REF\"\ndate,\"0000000000\",\"SAO\",\"32\",\"Reversal from \n\\nDescription\",\"-5000\",\"REF\"\ndate,\"0000000000\",\"SAO\",\"32\",\"Description\",\"10000\",\"REF\"\n</code></pre>\n\n<p>What I want the data to look like is this:</p>\n\n<pre><code>date,\"0000000000\",\"SAO\",\"32\",\"Description\",\"5000\",\"REF\"\ndate,\"0000000000\",\"SAO\",\"32\",\"Reversal from Description\",\"-5000\",\"REF\"\ndate,\"0000000000\",\"SAO\",\"32\",\"Description\",\"10000\",\"REF\"\n</code></pre>\n\n<p>Manually it's so simple, but, there's more than 3000 lines that needs to be corrected, so I need to automate this problem. I tried recording macros but it didn't work.</p>\n\n<p>The steps needed to be done is:\n1. search for \"\\n\"\nI believe this could be done with this?</p>\n\n<pre><code>set result = Find(What:=\"\\n\", After:=ActiveCell, LookIn:=xlFormulas, LookAt:= _xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)    \n</code></pre>\n\n<ol start=\"2\">\n<li>copy the search result values</li>\n<li>paste the search result values in the cell before the search result so it looked like this</li>\n</ol>\n\n<pre><code>date,\"0000000000\",\"SAO\",\"32\",\"Description\",\"5000\",\"REF\"\ndate,\"0000000000\",\"SAO\",\"32\",\"Reversal from \\nDescription\",\"-5000\",\"REF\"\n\ndate,\"0000000000\",\"SAO\",\"32\",\"Description\",\"10000\",\"REF\"\n</code></pre>\n\n<ol start=\"4\">\n<li>delete the blank cells.</li>\n<li>delete the \\n from \"Reversal from \\nDescription\" so it doesn't get processed again</li>\n<li>start from 1 again.</li>\n</ol>\n\n<p>I don't have the knowledge on how to do this, please help?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 2, "creation_date": 1547610470, "post_id": 54210111, "comment_id": 95246375, "body": "Can you share your regex attempt? This will give us some insight as to what your criteria may be. Is there any consistent rule that can be applied at all? In your given example, you could easily split the string by spaces and see if each value in array has any non-alpha characters. One example isn&#39;t really enough to extrapolate to a full blown solution though..."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 2, "creation_date": 1547611772, "post_id": 54210111, "comment_id": 95246636, "body": "regex <a href=\"https://regex101.com/r/zJMqBA/2\" rel=\"nofollow noreferrer\">regex101.com/r/zJMqBA/2</a>"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1547615221, "post_id": 54210111, "comment_id": 95247478, "body": "For the sample data you get the right string with <code>=LEFT(A1,(SEARCH(&quot;HTTP??&quot;,A1,1)-1))</code> where <code>A1</code> contains your string."}], "answers": [{"tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 0, "last_activity_date": 1547638916, "creation_date": 1547638916, "answer_id": 54216330, "question_id": 54210111, "link": "https://stackoverflow.com/questions/54210111/how-to-replace-words-larger-than-30-characters-from-a-string-via-vba/54216330#54216330", "title": "How to replace words larger than 30 characters from a string via vba", "body": "<p>As others have said in comments, the task of identifying \"words that have no meaning\" really requires you to define what \"no meaning\" actually means for your context.</p>\n\n<p>Taking your question literally, you might want to look at the <code>CheckSpelling()</code> function, which returns <code>False</code> if a word doesn't exist in the current or specified dictionary. You'd call the function as below:</p>\n\n<pre><code>Dim items() As String\nDim i As Long\n\nitems = Split(\"The quick brown fox ran over the lazy dog https//kidsnursuery.com/ghyds/\", \" \")\n\nFor i = 0 To UBound(items)\n    If Not Application.CheckSpelling(items(i)) Then\n        items(i) = vbNullString\n    End If\nNext\n\nDebug.Print Join(items, \" \")\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 10884222, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eyIePF9YL2c/AAAAAAAAAAI/AAAAAAAAApw/gIN_IGQoUHg/photo.jpg?sz=128", "display_name": "Shriya Kumar", "link": "https://stackoverflow.com/users/10884222/shriya-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1547638916, "creation_date": 1547610241, "last_edit_date": 1547622430, "question_id": 54210111, "link": "https://stackoverflow.com/questions/54210111/how-to-replace-words-larger-than-30-characters-from-a-string-via-vba", "title": "How to replace words larger than 30 characters from a string via vba", "body": "<p>I am trying to extract words that have no meaning from a paragraph or have some special characters - they could be random links to a </p>\n\n<p>I tried using regex but couldn't achieve successful results .</p>\n\n<p>Input sample</p>\n\n<pre><code> The quick brown fox ran over the lazy dog https//kidsnursuery.com/ghyds/  \n</code></pre>\n\n<p>Output sample</p>\n\n<pre><code>The quick brown fox ran over the lazy dog\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1547608177, "post_id": 54209843, "comment_id": 95245918, "body": "Try: .Cells(.Rows.Count, &quot;C&quot;).End(xlUp).Offset(1).Value = &quot;Business Interruption&quot;"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1547610246, "post_id": 54209843, "comment_id": 95246330, "body": "On which line are you getting error?"}, {"owner": {"reputation": 29, "user_id": 10328624, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ix0Xp0iUgmM/AAAAAAAAAAI/AAAAAAAAAQk/vSXhsIEYzRs/photo.jpg?sz=128", "display_name": "Roaku Sezoire", "link": "https://stackoverflow.com/users/10328624/roaku-sezoire"}, "edited": false, "score": 0, "creation_date": 1547611525, "post_id": 54209843, "comment_id": 95246584, "body": "I am getting the error on the .Cells(.Rows.Count,&quot;C&quot;)...etcetc."}, {"owner": {"reputation": 29, "user_id": 10328624, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ix0Xp0iUgmM/AAAAAAAAAAI/AAAAAAAAAQk/vSXhsIEYzRs/photo.jpg?sz=128", "display_name": "Roaku Sezoire", "link": "https://stackoverflow.com/users/10328624/roaku-sezoire"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1547611761, "post_id": 54209843, "comment_id": 95246635, "body": "@Variatus I have tried, in copies it only for the first empty cell but not for the whole range unfortunately."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1547612893, "post_id": 54209843, "comment_id": 95246908, "body": "Try: SpecialText.Copy .Cells(..."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1547613007, "post_id": 54209843, "comment_id": 95246932, "body": "Failure to copy is unrelated to the error you asked about. Your code is incomplete. It assigns the range SpecialText but doesn&#39;t copy its value, nor pastes its value elsewhere."}, {"owner": {"reputation": 29, "user_id": 10328624, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ix0Xp0iUgmM/AAAAAAAAAAI/AAAAAAAAAQk/vSXhsIEYzRs/photo.jpg?sz=128", "display_name": "Roaku Sezoire", "link": "https://stackoverflow.com/users/10328624/roaku-sezoire"}, "edited": false, "score": 0, "creation_date": 1547690480, "post_id": 54209843, "comment_id": 95281706, "body": "I dont want to copy the range, I want to paste special text for the range i.e. the range gives me how many rows will apply (this variable could change) and based on the range say 10, this formula is to paste into C at next empty &quot;Business Interruption&quot; for the next 10 rows."}], "owner": {"reputation": 29, "user_id": 10328624, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ix0Xp0iUgmM/AAAAAAAAAAI/AAAAAAAAAQk/vSXhsIEYzRs/photo.jpg?sz=128", "display_name": "Roaku Sezoire", "link": "https://stackoverflow.com/users/10328624/roaku-sezoire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547607816, "creation_date": 1547607816, "question_id": 54209843, "link": "https://stackoverflow.com/questions/54209843/pasting-special-based-on-filter-range-error-1004", "title": "Pasting Special based on filter range Error 1004", "body": "<p><strong>Goal:</strong> My range is all rows for which Parish has an AICOW \"true\" value, then in Column C, at the next empty row, I would like to paste, for the range, special text \"Business Interruption\". </p>\n\n<p><strong>Code:</strong> My code however is getting error 1004 Application-defined or object-defined error. I am not sure how I am meant to edit this to make my goal work. </p>\n\n<pre><code>Dim RPDataTbl As ListObject\nDim ParishCol As ListColumn, AICOW As ListColumn\nDim SpecialText As Range\n\nSet RPDataTbl = Sheets(\"Risk Partner Data\").ListObjects(\"RPdata\")\nWith RPDataTbl\n    Set ParishCol = .ListColumns(\"Parish\")\n    Set AICOWcol = .ListColumns(\"AICOW\")\n\n    .Range.AutoFilter Field:=AICOWcol.Index, Criteria1:=\"TRUE\"\nEnd With\n\nOn Error Resume Next\nSet SpecialText = ParishCol.DataBodyRange.SpecialCells(xlCellTypeVisible)\nOn Error GoTo 0\n\nIf Not SpecialText Is Nothing Then\n\n    With Sheets(\"Calc Data\")\n        .Cells(.Rows.Count, \"C\").End(xlUp).Offset(1).PasteSpecial Format:=\"Business Interruption\"\n    End With\n\n\nEnd If\n\nRPDataTbl.Range.AutoFilter Field:=AICOWcol.Index\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Thank for the assist. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 7571785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jyq8d.jpg?s=128&g=1", "display_name": "zgivod", "link": "https://stackoverflow.com/users/7571785/zgivod"}, "edited": false, "score": 0, "creation_date": 1547651093, "post_id": 54209623, "comment_id": 95265480, "body": "im sorry if i didnt word the question clear. i just want the color pasted not the font and format"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 43, "user_id": 7571785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jyq8d.jpg?s=128&g=1", "display_name": "zgivod", "link": "https://stackoverflow.com/users/7571785/zgivod"}, "edited": false, "score": 0, "creation_date": 1547664362, "post_id": 54209623, "comment_id": 95272716, "body": "I just tried the code on some dummy data and it worked perfectly fine. Can you upload the sample file on One drive, Google drive or Dropbox and share the link so that I can see why it is not working as desired?"}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 0, "last_activity_date": 1547652196, "last_edit_date": 1547652196, "creation_date": 1547605870, "answer_id": 54209623, "question_id": 54209576, "link": "https://stackoverflow.com/questions/54209576/vba-paste-sheet1-values-and-keep-original-source-formatting/54209623#54209623", "title": "vba paste sheet1 values and keep original source formatting?", "body": "<p>Try it like this...</p>\n\n<pre><code>Sub Transfer_Data()\n\nDim i As Long, j As Long\n\nj = 1\n\nFor i = 1 To 6\n    If Sheets(\"Sheet1\").Cells(i, 1).Value &lt;&gt; \"\" Then\n        Sheets(\"Sheet1\").Cells(i, 1).Copy\n        Sheets(\"Sheet2\").Cells(j, 1).PasteSpecial xlPasteFormats\n        Sheets(\"Sheet2\").Cells(j, 1).PasteSpecial xlPasteValues\n        j = j + 1\n    End If\n\n    If j &gt; 3 Then Exit For\nNext i\nApplication.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p><strong>Edited code as per the new requirement:</strong></p>\n\n<pre><code>Sub Transfer_Data()\n\nDim i As Long, j As Long\n\nj = 1\n\nFor i = 1 To 6\n    If Sheets(\"Sheet1\").Cells(i, 1).Value &lt;&gt; \"\" Then\n        Sheets(\"Sheet2\").Cells(j, 1).Value = Sheets(\"Sheet1\").Cells(i, 1).Value\n        Sheets(\"Sheet2\").Cells(j, 1).Interior.Color = Sheets(\"Sheet1\").Cells(i, 1).Interior.Color\n        j = j + 1\n    End If\n\n    If j &gt; 3 Then Exit For\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7571785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jyq8d.jpg?s=128&g=1", "display_name": "zgivod", "link": "https://stackoverflow.com/users/7571785/zgivod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547652196, "creation_date": 1547605488, "last_edit_date": 1547622417, "question_id": 54209576, "link": "https://stackoverflow.com/questions/54209576/vba-paste-sheet1-values-and-keep-original-source-formatting", "title": "vba paste sheet1 values and keep original source formatting?", "body": "<p>I have up to 6 cells with potential data coming from 6 different places. I am trying to get only the first three cells with data transferred to another sheet WITH THE ORIGINAL FORMAT Sub Transfer_Data()</p>\n\n<pre><code>Sub Transfer_Data()\n\nDim i As Long, j As Long\n\nj = 1\n\nFor i = 1 To 6\n    If Sheets(\"Sheet1\").Cells(i, 1).Value &lt;&gt; \"\" Then\n        Sheets(\"Sheet2\").Cells(j, 1).Value = Sheets(\"Sheet1\").Cells(i, 1).Value\n        j = j + 1\n    End If\n\n    If j &gt; 3 Then Exit For\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>what happens is it displays the sheet2 format and color when im trying to keep sheet1</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1547611373, "post_id": 54209218, "comment_id": 95246557, "body": "I&#39;ve only used this method of <code>Envelope</code> once, but I don&#39;t see a loop anywhere so not sure what you mean by it stops working on the 500 mark give or take. It seems this is just sending 1 email"}, {"owner": {"reputation": 11, "user_id": 10919793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6ce01b4b9adc7509e1bbdbec43708c?s=128&d=identicon&r=PG&f=1", "display_name": "Jarrett B", "link": "https://stackoverflow.com/users/10919793/jarrett-b"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1547675101, "post_id": 54209218, "comment_id": 95277604, "body": "There&#39;s another Sub moving data into place that calls this, it contains the loop, but the error is always within this part of the code."}], "owner": {"reputation": 11, "user_id": 10919793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6ce01b4b9adc7509e1bbdbec43708c?s=128&d=identicon&r=PG&f=1", "display_name": "Jarrett B", "link": "https://stackoverflow.com/users/10919793/jarrett-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 367, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1547606146, "creation_date": 1547602024, "last_edit_date": 1547606146, "question_id": 54209218, "link": "https://stackoverflow.com/questions/54209218/run-time-error-440-the-object-does-not-support-this-method-when-sending-multi", "title": "run-time error &quot;440&quot;: The object does not support this method when sending multiple emals", "body": "<p>I'm getting a</p>\n\n<blockquote>\n  <p>run-time error \"440\": The object does not support this method. </p>\n</blockquote>\n\n<p>The macro is designed to send multiple different emails and works until it gets to about email 500. The line the error is on is either <code>.To=em</code> or <code>.BCC=\"\"</code> Any ideas what would cause it work so many time and then give me the error?</p>\n\n<pre><code>Sub TM_Email()\n\n\n    Dim AWorksheet As Worksheet\n    Dim Sendrng As Range\n    Dim Subject As String\n    Dim LastRow As Long\n    Dim em As String\n    Dim y As Long\n    Dim Result As Integer\n\n\n    y = Range(\"A1\").Value\n\n    LastRow = Range(\"A1048576\").End(xlUp).Row\n\n    em = Range(\"H2\").Value\n\n    Subject = \"Urgent - action needed!\"\n\n    'On Error GoTo StopMacro\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    Set Sendrng = ActiveSheet.Range(\"A2:D\" &amp; LastRow)\n\n    'Remember the activesheet\n    Set AWorksheet = ActiveSheet\n\n    With Sendrng\n\n        ' Select the worksheet with the range you want to send\n        .Parent.Select\n\n        'Select the range you want to mail\n        .Select\n\n        ' Create the mail and send it\n        ActiveWorkbook.EnvelopeVisible = True\n        With .Parent.MailEnvelope\n\n\n\n            With .Item\n                .SentOnBehalfOfName = \"CompanyEmail\"\n                .To = em\n                .CC = \" \"\n                .BCC = \" \"\n                .Subject = Subject\n\n                If y = 2 Then\n\n                .display\n\n                Result = MsgBox(\"Does this look ok?\", vbYesNo)\n\n                    If Result = vbNo Then\n\n\n            ActiveWorkbook.EnvelopeVisible = False\n\n                    End\n                    End If\n\n                End If\n\n                .Send\n            End With\n\n        End With\n\n    End With\n\n    AWorksheet.Select\n\n\nStopMacro:\n\n\nWith Application\n        .ScreenUpdating = False\n        .EnableEvents = True\n    End With\n    ActiveWorkbook.EnvelopeVisible = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 10891585, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KEPtpyeTH8A/AAAAAAAAAAI/AAAAAAAAAJY/ZPyAt8AVL5c/photo.jpg?sz=128", "display_name": "randy dickinson", "link": "https://stackoverflow.com/users/10891585/randy-dickinson"}, "edited": false, "score": 0, "creation_date": 1547676487, "post_id": 54209436, "comment_id": 95278196, "body": "This works great! Is there a way to have it look for any value at scan that begins with &quot;$&quot; and ends with 3 digits. example &quot;$123&quot;. this will return to original column and advance to next row and leave just &quot;123&quot; in the first cell of the new row?"}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": true, "score": 0, "last_activity_date": 1547716684, "last_edit_date": 1547716684, "creation_date": 1547604124, "answer_id": 54209436, "question_id": 54209106, "link": "https://stackoverflow.com/questions/54209106/how-to-auto-return-to-original-column-but-next-row-when-is-scanned/54209436#54209436", "title": "How to auto return to original column but next row when # is scanned", "body": "<p>This should work for you.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim Scan As Variant\n\nScan = Trim(Target.Value)\nIf Len(Scan) And Target.Column &gt; 2 Then\n    If Left(Scan, 1) = \"$\" Then\n        Scan = Mid(Scan, 2)\n        With Application\n            .ScreenUpdating = False\n            .EnableEvents = False\n        End With\n        If Target.Column &gt; 3 Then\n            Target.ClearContents\n            Set Target = Cells(Target.Row + 1, 3)\n        End If\n        Target.Value = Scan\n        With Application\n            .EnableEvents = True\n            .ScreenUpdating = True\n        End With\n    End If\n\n    Target.Offset(0, Sgn(Val(Scan))).Select\nEnd If\n</code></pre>\n\n<p>End Sub</p>\n\n<p>The code was expanded to include the new requirements as per your comment.</p>\n"}], "owner": {"reputation": 19, "user_id": 10891585, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KEPtpyeTH8A/AAAAAAAAAAI/AAAAAAAAAJY/ZPyAt8AVL5c/photo.jpg?sz=128", "display_name": "randy dickinson", "link": "https://stackoverflow.com/users/10891585/randy-dickinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 54209436, "answer_count": 1, "score": 0, "last_activity_date": 1547716684, "creation_date": 1547601161, "last_edit_date": 1547622406, "question_id": 54209106, "link": "https://stackoverflow.com/questions/54209106/how-to-auto-return-to-original-column-but-next-row-when-is-scanned", "title": "How to auto return to original column but next row when # is scanned", "body": "<p>I want to continuously scan barcodes into excel. Each scan will go into the same row separate cell until \"$\" is scanned and return to original column and next row. </p>\n\n<p>I have tried this:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    Select Case Target.Column\n        Case 3                              'column c\n            If Target.Value &lt;&gt; \"\" Then\n                Target.Offset(0, 1).Select  'move right\n            End If\n        Case 4                              'column d\n            If Target.Value &lt;&gt; \"\" Then\n                Target.Offset(0, 1).Select  'move right\n            End If\n        Case 5                              'column E\n            If Target.Value &lt;&gt; \"\" Then\n                Target.Offset(1, -2).Select 'move down and back to column C\n            End If\n    End Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1547602233, "post_id": 54208996, "comment_id": 95244805, "body": "<code>Nz(fld, &quot;&quot;) = &quot;&quot;</code>  should work. Code seems to be okay."}, {"owner": {"reputation": 11, "user_id": 10919689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wNy7aVswGZw/AAAAAAAAAAI/AAAAAAAAAGg/T7GsNfM4TEw/photo.jpg?sz=128", "display_name": "redletter.tech", "link": "https://stackoverflow.com/users/10919689/redletter-tech"}, "reply_to_user": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1547602846, "post_id": 54208996, "comment_id": 95244918, "body": "@Santosh Just tried it again and unfortunately, it returns the same error: 3001 Invalid Argument."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1547613899, "post_id": 54208996, "comment_id": 95247146, "body": "Does it error on first iteration of loop?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1547614371, "post_id": 54208996, "comment_id": 95247273, "body": "I am testing your code and I get Type Mismatch error on the SaveResponse function in the BeforeUpdate event."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1547615800, "post_id": 54208996, "comment_id": 95247616, "body": "I don&#39;t see how this code will ever do what you want. What if the form&#39;s recordset is 5,000 records? Also, a new record not yet committed to table is not in the form&#39;s Recordset. Could set fields as required in table and let Access nag users. Can also use ValidationRule and ValidationText properties. Users will eventually learn to avoid these annoyances."}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1547623813, "post_id": 54208996, "comment_id": 95250332, "body": "I have tested and this code works. Does it get stuck at any specific control? Can you add screenshot of the UI."}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1547624589, "post_id": 54208996, "comment_id": 95250630, "body": "@June7 Try this <code>Private Sub Form_BeforeUpdate(Cancel As Integer)     Dim rs As DAO.Recordset     Set rs = Me.RecordsetClone     SaveResponse rs End Sub</code> to call SaveResponse function from the event."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1547626000, "post_id": 54208996, "comment_id": 95251146, "body": "Okay, that doesn&#39;t error. Code runs when I enter new record, however, the record from recordset that code looks at is first record in form&#39;s recordset, not new record. I already confirmed new record is not yet in the recordset. I used rs.MoveLast and Debug.Print to verify."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1547633882, "post_id": 54208996, "comment_id": 95255338, "body": "when Error 3001 appears, does it highlights line <code>Nz(fld.Value, &quot;&quot;) = &quot;&quot;</code> ??? Anyways, have you tried using <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/isnull-function\" rel=\"nofollow noreferrer\">IsNull function</a>?"}, {"owner": {"reputation": 11, "user_id": 10919689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wNy7aVswGZw/AAAAAAAAAAI/AAAAAAAAAGg/T7GsNfM4TEw/photo.jpg?sz=128", "display_name": "redletter.tech", "link": "https://stackoverflow.com/users/10919689/redletter-tech"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1547643930, "post_id": 54208996, "comment_id": 95260985, "body": "@FoxfireAndBurnsAndBurns Yes, I tried replacing with IsNull."}, {"owner": {"reputation": 11, "user_id": 10919689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wNy7aVswGZw/AAAAAAAAAAI/AAAAAAAAAGg/T7GsNfM4TEw/photo.jpg?sz=128", "display_name": "redletter.tech", "link": "https://stackoverflow.com/users/10919689/redletter-tech"}, "reply_to_user": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1547656537, "post_id": 54208996, "comment_id": 95268743, "body": "@Santosh It gets stuck at the first required field that is blank. I&#39;ve added new code to the question though. Have a look!"}, {"owner": {"reputation": 11, "user_id": 10919689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wNy7aVswGZw/AAAAAAAAAAI/AAAAAAAAAGg/T7GsNfM4TEw/photo.jpg?sz=128", "display_name": "redletter.tech", "link": "https://stackoverflow.com/users/10919689/redletter-tech"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1547656606, "post_id": 54208996, "comment_id": 95268784, "body": "@June7 I&#39;ve added code (see edit to question) to address your point regarding new records not yet being a part of the recordset. I&#39;m getting a different error now. Any ideas?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1547667958, "post_id": 54208996, "comment_id": 95274370, "body": "Won&#39;t work if controls are on a subform. Can&#39;t pass a subform as a Form object. Code loops through ALL controls, some of which won&#39;t have ControlSource property and therefore code fails - labels for instance are not data controls. One way to deal with is to use Tag property. Use some string in Tag, such as &quot;Validate&quot;, then in code test Tag property for that string and if match, run validation."}], "owner": {"reputation": 11, "user_id": 10919689, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wNy7aVswGZw/AAAAAAAAAAI/AAAAAAAAAGg/T7GsNfM4TEw/photo.jpg?sz=128", "display_name": "redletter.tech", "link": "https://stackoverflow.com/users/10919689/redletter-tech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1547656217, "creation_date": 1547600274, "last_edit_date": 1547656217, "question_id": 54208996, "link": "https://stackoverflow.com/questions/54208996/3001-invalid-argument-required-fields", "title": "3001: Invalid Argument - Required Fields", "body": "<p>I'm working on an Access database that I'd like to gain more control over when a record is saved. One of the things I'd like to do is check that all required fields on whatever form is calling my SaveResponse function have been filled in. Here's the relevant bits of code I've come up with.</p>\n\n<pre><code>Private Sub Form_BeforeUpdate(Cancel As Integer)\n    SaveResponse(Form.Recordset)\nEnd Sub\n\nPublic Function SaveResponse(rs As Recordset) As Long\n    Dim response As VbMsgBoxResult, fld As Field    \n    response = MsgBox(\"Do you want to save changes to this record?\", vbQuestion + vbYesNo, \"Save Record\")\n\n    If response = vbYes Then\n        For Each fld In rs.Fields\n            If fld.Required = True And Nz(fld, \"\") = \"\" Then\n                MsgBox \"The \" &amp; fld.Name &amp; \" field is required.\"\n                SaveResponse = 2\n                Exit Function\n            End If\n        Next\n    ElseIf response = vbNo Then\n        CodeContextObject.Undo\n        SaveResponse = 1\n        Exit Function\n    End If\nEnd Function\n</code></pre>\n\n<p>When running, I get an error: \"3001: Invalid Argument\"</p>\n\n<p>I think I've narrowed this issue down to where I am actually checking if a given field in the record set is null (the code below).</p>\n\n<pre><code>Nz(fld, \"\") = \"\"\n</code></pre>\n\n<p>I've tried the following alternatives with no luck...</p>\n\n<pre><code>Nz(fld.Value, \"\") = \"\"\n\nNz(rs.Fields(fld.Name).Value, \"\") = \"\"\n\nIsNull(fld.Value)\n\nIsNull(rs.Fields(fld.Name).Value)\n</code></pre>\n\n<p>What am I missing? How can I check required fields in the record set for null values?</p>\n\n<p><strong>Edit:</strong> New code below addresses new records not yet in the recordset, but returns \"3265 Item not found in this collection.\" </p>\n\n<pre><code>Private Sub Form_BeforeUpdate(Cancel As Integer)\n    SaveResponse(Form)\nEnd Sub\n\nPublic Function SaveResponse(frm as Form) As Long\n    Dim response As VbMsgBoxResult, rs as Recordset, ctl As Control, fldName As String   \n    response = MsgBox(\"Do you want to save changes to this record?\", vbQuestion + vbYesNo, \"Save Record\")\n\n    If response = vbYes Then\n        Set rs = frm.Recordset\n        For Each ctl In frm.Controls\n            fldName = ctl.ControlSource\n            If rs(fldName).Required And Nz(fldName, \"\") = \"\" Then\n                MsgBox \"The \" &amp; fldName &amp; \" field is required.\"\n                SaveResponse = 2\n                Exit Function\n            End If\n        Next\n    ElseIf response = vbNo Then\n        CodeContextObject.Undo\n        SaveResponse = 1\n        Exit Function\n    End If\nEnd Function\n</code></pre>\n\n<p>This time, I believe the issue is with the line <code>If rs(fldName).Required</code>. Any ideas?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 3, "creation_date": 1547599915, "post_id": 54208859, "comment_id": 95244307, "body": "I&#39;m voting to close this question as off-topic because <a href=\"https://codereview.stackexchange.com\">Code Review</a> is the place for getting help with refactoring working code."}, {"owner": {"reputation": 96, "user_id": 7263804, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-nFnvMFoJP_8/AAAAAAAAAAI/AAAAAAAAUf0/OSlU3cT4o1E/photo.jpg?sz=128", "display_name": "Tejkaran Samra", "link": "https://stackoverflow.com/users/7263804/tejkaran-samra"}, "reply_to_user": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 0, "creation_date": 1547599967, "post_id": 54208859, "comment_id": 95244312, "body": "Im happy for you to do so. I did not know code review existed and it seems the right place to go"}, {"owner": {"reputation": 7441, "user_id": 1575353, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rvz3i.png?s=128&g=1", "display_name": "S\u1d00\u1d0d On\u1d07\u1d0c\u1d00", "link": "https://stackoverflow.com/users/1575353/s%e1%b4%80%e1%b4%8d-on%e1%b4%87%e1%b4%8c%e1%b4%80"}, "reply_to_user": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 2, "creation_date": 1547600191, "post_id": 54208859, "comment_id": 95244358, "body": "@KenY-N In the future, please don&#39;t use the existence of the Code Review site as a reason to close questions. Evaluate the request &amp; use a reason like <i>too broad</i>, <i>primarily opinion-based</i>, etc. Then you can mention to the OP that it can be posted on Code Review if it is <a href=\"https://codereview.stackexchange.com/help/on-topic\">on-topic</a> and <a href=\"https://meta.stackoverflow.com/a/266750/1575353\">Flag it for Mod intervention</a>. Please see the section <b>What you should not do</b> in <a href=\"https://codereview.meta.stackexchange.com/a/5778/120114\">this answer to <i>A guide to Code Review for Stack Overflow users</i></a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1547601320, "post_id": 54208859, "comment_id": 95244609, "body": "I&#39;d vote for more use of With blocks (main benefit would be readability), and assigning cell values as blocks from arrays instead of cell-by-cell (better performance)."}, {"owner": {"reputation": 96, "user_id": 7263804, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-nFnvMFoJP_8/AAAAAAAAAAI/AAAAAAAAUf0/OSlU3cT4o1E/photo.jpg?sz=128", "display_name": "Tejkaran Samra", "link": "https://stackoverflow.com/users/7263804/tejkaran-samra"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1547601706, "post_id": 54208859, "comment_id": 95244687, "body": "@TimWilliams How would i go about doing it in blocks? Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 96, "user_id": 7263804, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-nFnvMFoJP_8/AAAAAAAAAAI/AAAAAAAAUf0/OSlU3cT4o1E/photo.jpg?sz=128", "display_name": "Tejkaran Samra", "link": "https://stackoverflow.com/users/7263804/tejkaran-samra"}, "edited": false, "score": 0, "creation_date": 1547604456, "post_id": 54209267, "comment_id": 95245184, "body": "is it possible to format outside of accessing the worksheet?"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 96, "user_id": 7263804, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-nFnvMFoJP_8/AAAAAAAAAAI/AAAAAAAAUf0/OSlU3cT4o1E/photo.jpg?sz=128", "display_name": "Tejkaran Samra", "link": "https://stackoverflow.com/users/7263804/tejkaran-samra"}, "edited": false, "score": 0, "creation_date": 1547604617, "post_id": 54209267, "comment_id": 95245221, "body": "No, formatting must be applied to the worksheet range. But it&#39;s faster to apply a format to a group of cells than to format each cell individually like happens in a loop."}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 1, "last_activity_date": 1547602486, "creation_date": 1547602486, "answer_id": 54209267, "question_id": 54208859, "link": "https://stackoverflow.com/questions/54208859/how-can-i-speed-this-vba-code-up-which-involves-formatting/54209267#54209267", "title": "How can I speed this vba code up which involves formatting?", "body": "<p>Your handling of the collect array is inefficient. Consider reading the entire Client Register into an array with MyArray = Range.Value. Then prepare the output array in memory and write it to the worksheet after all looping is done, in one go, with TargetRange.Value = collect.</p>\n\n<p>Avoid inserting rows. What's wrong with the existing? If you are preparing all data in an array to be pasted to the worksheet, empty array elements will produce empty worksheet cells. In this way all inserting can be avoided and all you need to do is to format.</p>\n\n<p>There is time cost for every access to the worksheet, whether to read or write. Even for formatting, try to create ranges that are treated in the same manner. Avoid accessing the worksheet in loops.</p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1547602507, "creation_date": 1547602507, "answer_id": 54209270, "question_id": 54208859, "link": "https://stackoverflow.com/questions/54208859/how-can-i-speed-this-vba-code-up-which-involves-formatting/54209270#54209270", "title": "How can I speed this vba code up which involves formatting?", "body": "<p>Example of With and block assignment from an array:</p>\n\n<pre><code>'copy from database to the pricing schedule as a \n'   non formatted list of all the info - this runs quickly, \n'   but I am open to changing it\nWith Range(\"Client_Register\")\n\n    For Each rw In .Rows\n        If .Cells(rw.Row, 2) = selectedClient Then\n\n            collect(i, 1) = .Range(\"E\" &amp; rw.Row)\n            collect(i, 2) = .Range(\"D\" &amp; rw.Row)\n            collect(i, 3) = .Range(\"F\" &amp; rw.Row)\n            collect(i, 4) = .Range(\"J\" &amp; rw.Row)\n            collect(i, 5) = .Range(\"K\" &amp; rw.Row)\n            collect(i, 6) = .Range(\"L\" &amp; rw.Row)\n            collect(i, 7) = .Range(\"M\" &amp; rw.Row)\n            collect(i, 8) = .Range(\"P\" &amp; rw.Row)\n            collect(i, 9) = .Range(\"I\" &amp; rw.Row)\n            collect(i, 10) = .Range(\"H\" &amp; rw.Row)\n\n            'you could even skip the row-by-row population of values\n            '  and assign as a block after exiting the loop\n            ws2.Range(\"B\" &amp; i + 6).Resize(1, 10).Value = _\n                    Array(collect(i, 1), collect(i, 2), collect(i, 3), _\n                          collect(i, 4), collect(i, 5), collect(i, 6), _\n                          collect(i, 7), collect(i, 8), collect(i, 9), _\n                          collect(i, 10))\n\n            i = i + 1\n        End If\n    Next\n\nEnd With\n</code></pre>\n\n<p>Note this will break if your <code>Client_Register</code> refers to a range which doesn't start on Row1, because of the relative range references.</p>\n\n<p>Eg:</p>\n\n<pre><code> Range(\"A1:A10\").Range(\"A1\") 'refers to A1\n Range(\"A2:A10\").Range(\"A1\") 'refers to A2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 96, "user_id": 7263804, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-nFnvMFoJP_8/AAAAAAAAAAI/AAAAAAAAUf0/OSlU3cT4o1E/photo.jpg?sz=128", "display_name": "Tejkaran Samra", "link": "https://stackoverflow.com/users/7263804/tejkaran-samra"}, "edited": false, "score": 0, "creation_date": 1547610301, "post_id": 54209322, "comment_id": 95246339, "body": "Thanks for the comments. I found the last issue to bethe biggest one. I added in a line on the &#39;array&#39; part to say if the line category is the same as the one below, do 1+2. This way I dont need to insert any lines. I had to re-engineer some stuff later on but it only takes 3s now, rather than 10. so big improvement. Thanks"}], "tags": [], "owner": {"reputation": 106, "user_id": 5084013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a53c7e8d047c9b80d252bafdc888195?s=128&d=identicon&r=PG&f=1", "display_name": "Hansraj", "link": "https://stackoverflow.com/users/5084013/hansraj"}, "is_accepted": true, "score": 1, "last_activity_date": 1547602964, "creation_date": 1547602964, "answer_id": 54209322, "question_id": 54208859, "link": "https://stackoverflow.com/questions/54208859/how-can-i-speed-this-vba-code-up-which-involves-formatting/54209322#54209322", "title": "How can I speed this vba code up which involves formatting?", "body": "<p>I found a few lines that could save you some execution time. </p>\n\n<pre><code>'****EDIT****Changed this to direct range reference rather than go through the Names collection.\n'Set namedRange1 = file1.Names(\"Client_Register\").RefersToRange\n'Set namedRange2 = file1.Names(\"Pricing_Range\").RefersToRange\nSet namedRange1 = file1.Range(\"Client_Register\")\nSet namedRange2 = file1.Range(\"Pricing_Range\")\n\n</code></pre>\n\n<p><strong>Used range takes more time rather use .cells directly</strong></p>\n\n<pre><code>'delete everything from the pricing schedule/reset\n'****EDIT***\nWith ws2 'Sheets(\"Pricing Schedule\")\n    'used range takes more time rather use .cells directly\n    .Cells.ClearContents\n</code></pre>\n\n<p><strong>Rather than use arrays you can directly update values as shown below</strong></p>\n\n<pre><code>'I am using i for the row count\n        ws2.Range(\"B\" &amp; i + 6).Value = namedRange1.Cells(i, 5).Value\n        ws2.Range(\"C\" &amp; i + 6).Value = namedRange1.Cells(i, 4).Value\n        ws2.Range(\"D\" &amp; i + 6).Value = namedRange1.Cells(i, 6).Value\n        ws2.Range(\"E\" &amp; i + 6).Value = namedRange1.Cells(i, 10).Value\n        ws2.Range(\"F\" &amp; i + 6).Value = namedRange1.Cells(i, 11).Value\n        ws2.Range(\"G\" &amp; i + 6).Value = namedRange1.Cells(i, 12).Value\n        ws2.Range(\"H\" &amp; i + 6).Value = namedRange1.Cells(i, 12).Value\n        ws2.Range(\"I\" &amp; i + 6).Value = namedRange1.Cells(i, 16).Value\n        ws2.Range(\"J\" &amp; i + 6).Value = namedRange1.Cells(i, 9).Value\n        ws2.Range(\"K\" &amp; i + 6).Value = namedRange1.Cells(i, 8).Value\n        i = i + 1\n</code></pre>\n\n<p><strong>The main culprit for your slower performance is the insert operation</strong>. try to work the logic to not having insert. If not possible, try to insert rows outside the loop in a single operation rather than in the loop</p>\n\n<pre><code>        Range(\"Pricing_Range\").Rows(i + 1).Insert Shift:=xlShiftDown\n        Range(\"Pricing_Range\").Rows(i + 1).Insert Shift:=xlShiftDown\n</code></pre>\n"}], "owner": {"reputation": 96, "user_id": 7263804, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-nFnvMFoJP_8/AAAAAAAAAAI/AAAAAAAAUf0/OSlU3cT4o1E/photo.jpg?sz=128", "display_name": "Tejkaran Samra", "link": "https://stackoverflow.com/users/7263804/tejkaran-samra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 54209322, "answer_count": 3, "score": 0, "last_activity_date": 1547623103, "creation_date": 1547599123, "last_edit_date": 1547623103, "question_id": 54208859, "link": "https://stackoverflow.com/questions/54208859/how-can-i-speed-this-vba-code-up-which-involves-formatting", "title": "How can I speed this vba code up which involves formatting?", "body": "<p>I am setting up a new pricing schedule which reads selected information from a 'Register' tab, based on selected criteria, and copying this into a new tab. This data is formatted so it looks aesthetically pleasing.\nI am finding formatting the code is slowing down the run speed significantly. If possible I would like to speed this up as I will be iterating this multiple times.</p>\n\n<p>I hae sped the program up a reasonable amount. Initially it took 30s, whereas now it is about 10s.\nI have followed information from this website as best as I can:\n<a href=\"https://www.soa.org/News-and-Publications/Newsletters/Compact/2012/january/com-2012-iss42-roper.aspx\" rel=\"nofollow noreferrer\">https://www.soa.org/News-and-Publications/Newsletters/Compact/2012/january/com-2012-iss42-roper.aspx</a></p>\n\n<p>I feel there is still scope to improve more, though I am unsure how, and am reaching out to see if there is, or are, better ways to improve the code so it runs quicker.</p>\n\n<pre><code>Option Explicit\nSub create_pricing_schedule()\n\n'define workbook variables\nDim Start_Time As Double, End_Time As Double\nDim file1 As Workbook\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim ws3 As Worksheet\nDim ws4 As Worksheet\nDim namedRange1 As Range\nDim namedRange2 As Range\nSet file1 = ThisWorkbook\nSet ws2 = file1.Worksheets(\"Pricing Schedule\")\nSet ws3 = file1.Worksheets(\"Control\")\nSet ws4 = file1.Worksheets(\"Register\")\nSet namedRange1 = file1.Names(\"Client_Register\").RefersToRange\nSet namedRange2 = file1.Names(\"Pricing_Range\").RefersToRange\n\n'define general variables\nDim i As Integer\nDim collect(1 To 500, 1 To 10) As Variant\nDim rw As Range\nDim selectedClient As String\nDim lastrow As Integer, lastrow2 As Integer, lastrow3 As Integer\n\ni = 1\n\n'time how long it takes to improve efficiency\nStart_Time = Timer\n\n'speedup so less lagg\nCall speedup\n\n'delete everything from the pricing schedule/reset\nWith Sheets(\"Pricing Schedule\")\n    .UsedRange.ClearContents\n    .Cells.Interior.ColorIndex = 0\n    .Cells.Borders.LineStyle = xlNone\n    .Cells.HorizontalAlignment = xlLeft\n    .Cells.MergeCells = False\n    .Range(\"A:Z\").WrapText = False\n    .Rows.RowHeight = \"15\"\nEnd With\n\n'resize the client register\nlastrow = ws4.Range(\"A100000\").End(xlUp).Row\nWith ActiveWorkbook.Names(\"Client_Register\")\n    .RefersTo = \"=Register!$A$1:$AE$\" &amp; lastrow\nEnd With\n\nselectedClient = ws3.Range(\"B3\").Value\n'copy from database to the pricing schedule as a non formatted list of all the info - this runs quickly, but I am open to changing it\nFor Each rw In Range(\"Client_Register\").Rows\n    If Range(\"Client_Register\").Cells(rw.Row, 2) = selectedClient Then\n        collect(i, 1) = Range(\"Client_Register\").Range(\"E\" &amp; rw.Row)\n        collect(i, 2) = Range(\"Client_Register\").Range(\"D\" &amp; rw.Row)\n        collect(i, 3) = Range(\"Client_Register\").Range(\"F\" &amp; rw.Row)\n        collect(i, 4) = Range(\"Client_Register\").Range(\"J\" &amp; rw.Row)\n        collect(i, 5) = Range(\"Client_Register\").Range(\"K\" &amp; rw.Row)\n        collect(i, 6) = Range(\"Client_Register\").Range(\"L\" &amp; rw.Row)\n        collect(i, 7) = Range(\"Client_Register\").Range(\"M\" &amp; rw.Row)\n        collect(i, 8) = Range(\"Client_Register\").Range(\"P\" &amp; rw.Row)\n        collect(i, 9) = Range(\"Client_Register\").Range(\"I\" &amp; rw.Row)\n        collect(i, 10) = Range(\"Client_Register\").Range(\"H\" &amp; rw.Row) ' used to determine if pass through fee\n\n        ws2.Range(\"B\" &amp; i + 6) = collect(i, 1)\n        ws2.Range(\"C\" &amp; i + 6) = collect(i, 2)\n        ws2.Range(\"D\" &amp; i + 6) = collect(i, 3)\n        ws2.Range(\"E\" &amp; i + 6) = collect(i, 4)\n        ws2.Range(\"F\" &amp; i + 6) = collect(i, 5)\n        ws2.Range(\"G\" &amp; i + 6) = collect(i, 6)\n        ws2.Range(\"H\" &amp; i + 6) = collect(i, 7)\n        ws2.Range(\"I\" &amp; i + 6) = collect(i, 8)\n        ws2.Range(\"J\" &amp; i + 6) = collect(i, 9)\n        ws2.Range(\"K\" &amp; i + 6) = collect(i, 10)\n\n        i = i + 1\n    End If\nNext\n\n'add in the colour and count how many rows there are\nlastrow2 = ws2.Range(\"C5000\").End(xlUp).Row\nWith ActiveWorkbook.Names(\"Pricing_Range\")\n    .RefersTo = \"='Pricing Schedule'!$A$1:$K$\" &amp; lastrow2\nEnd With\n\nws2.Range(\"B7\" &amp; \":\" &amp; \"J\" &amp; lastrow2).Interior.Color = RGB(242, 242, 242)\n\n'==========this bit is slow, can it be quicker?==========\n'add spacing, titles, and colour to sub headers\ni = 7\nFor Each rw In Range(\"Pricing_Range\").Rows\n    If Range(\"Pricing_Range\").Cells(i, 3) &lt;&gt; Range(\"Pricing_Range\").Cells(i + 1, 3) Then\n        Range(\"Pricing_Range\").Rows(i + 1).Insert Shift:=xlShiftDown\n        Range(\"Pricing_Range\").Rows(i + 1).Insert Shift:=xlShiftDown\n        Range(\"Pricing_Range\").Rows(i + 1).Interior.ColorIndex = 0\n        Range(\"Pricing_Range\").Rows(i + 2).Interior.ColorIndex = 0\n\n        Range(\"Pricing_Range\").Range(\"B\" &amp; i + 2 &amp; \":\" &amp; \"J\" &amp; i + 2).Interior.Color = RGB(255, 128, 1)\n        Range(\"Pricing_Range\").Range(\"B\" &amp; i + 2 &amp; \":\" &amp; \"J\" &amp; i + 2).Borders(xlEdgeTop).Color = RGB(0, 0, 0)\n        Range(\"Pricing_Range\").Range(\"B\" &amp; i + 2 &amp; \":\" &amp; \"J\" &amp; i + 2).Borders(xlEdgeBottom).Color = RGB(0, 0, 0)\n        Range(\"Pricing_Range\").Range(\"B\" &amp; i + 2).Value = Range(\"Pricing_Range\").Range(\"C\" &amp; i + 3).Value\n\n        'if it is a pass through fee then add it in to the sub headers\n        If Range(\"Pricing_Range\").Range(\"K\" &amp; i + 3).Value = \"Pass-Through\" Then\n            Range(\"Pricing_Range\").Range(\"J\" &amp; i + 2).Value = \"Pass-Through Fees\"\n            Range(\"Pricing_Range\").Range(\"J\" &amp; i + 2).HorizontalAlignment = xlRight\n        End If\n        i = i + 3\n\n        Else\n        i = i + 1\n    End If\nNext\n'==================================================\n\n'set up the main title rows\nws2.Select\nRange(\"Pricing_Range\").Range(\"B2\").Value = ws3.Range(\"B3\").Value\nRange(\"Pricing_Range\").Range(\"B2\").Font.Size = 20\nRange(\"Pricing_Range\").Range(\"B2\").Font.Bold = True\nRange(\"Pricing_Range\").Range(\"B2\").Font.FontStyle = \"Calibri Light\"\nRange(\"Pricing_Range\").Range(\"B2:J3\").Select\nWith Selection\n    .HorizontalAlignment = xlCenter\n    .VerticalAlignment = xlCenter\n    .WrapText = False\n    .MergeCells = True\n    .Cells.Interior.Color = RGB(255, 128, 1)\n    .Cells.Borders(xlEdgeTop).Color = RGB(0, 0, 0)\n    .Cells.Borders(xlEdgeBottom).Color = RGB(0, 0, 0)\nEnd With\n\n'tidy up things in the sheet\nWith Worksheets(\"Pricing Schedule\")\n'set up the headers and first title\n    .Range(\"B6\") = .Range(\"C7\")\n    .Range(\"B5:J6\").Interior.Color = RGB(255, 128, 1)\n    .Range(\"B5:J5\").Borders(xlEdgeTop).Color = RGB(0, 0, 0)\n    .Range(\"B5:J5\").Borders(xlEdgeBottom).Color = RGB(0, 0, 0)\n    .Range(\"B6:J6\").Borders(xlEdgeTop).Color = RGB(0, 0, 0)\n    .Range(\"B6:J6\").Borders(xlEdgeBottom).Color = RGB(0, 0, 0)\n    .Range(\"B5\").Value = \"Fee Code\"\n    .Range(\"C5\").Value = \"Product Line\"\n    .Range(\"D5\").Value = \"Item\"\n    .Range(\"E5\").Value = \"Volume From\"\n    .Range(\"F5\").Value = \"Volume To\"\n    .Range(\"G5\").Value = \"Frequency\"\n    .Range(\"H5\").Value = \"Location\"\n    .Range(\"I5\").Value = \"Price\"\n    .Range(\"J5\").Value = \"Nature of Fee\"\n\n'tidy up column widths\n    .Range(\"A5\").RowHeight = 30\n    .Range(\"A1\").ColumnWidth = 2\n    .Range(\"B1\").ColumnWidth = 15\n    .Range(\"C1\").ColumnWidth = 40\n    .Range(\"D1\").ColumnWidth = 45\n    .Range(\"E1\").ColumnWidth = 11\n    .Range(\"F1\").ColumnWidth = 11\n    .Range(\"G1\").ColumnWidth = 35\n    .Range(\"H1\").ColumnWidth = 15\n    .Range(\"I1\").ColumnWidth = 12\n    .Range(\"J1\").ColumnWidth = 50\n    .Range(\"J:J\").WrapText = True\n    .Range(\"K:K\").Delete\nEnd With\n\n'clear the extra orange line at the end\nlastrow3 = ws2.Range(\"B1000\").End(xlUp).Row\nWith ws2.Rows(lastrow3 + 2)\n    .Cells.Interior.ColorIndex = 0\n    .Cells.Borders.LineStyle = xlNone\n    .ClearContents\nEnd With\n\n'add print area\nWith Worksheets(\"Pricing Schedule\")\n    .PageSetup.Zoom = False\n    .PageSetup.Orientation = xlPortrait\n    .PageSetup.PrintArea = \"$B$2:$J$\" &amp; lastrow3\n    .PageSetup.FitToPagesWide = 1\n    .PageSetup.FitToPagesTall = False\n    .PageSetup.PrintTitleRows = \"$2:$6\"\nEnd With\n\n'return to normal\nCall slowdown\n\n'time how long it takes to improve efficiency\nEnd_Time = Timer\nWorksheets(\"Control\").Cells(6, 2) = End_Time - Start_Time\nEnd Sub\n\nSub speedup()\nApplication.Calculation = xlManual\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.DisplayStatusBar = False\n\nEnd Sub\n\nSub slowdown()\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\nApplication.DisplayStatusBar = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "userform"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1547593553, "post_id": 54207401, "comment_id": 95242906, "body": "File/Options, the entry to customize the Ribbon. You&#39;ll find the Keyboard Shortcuts button there. That dialog box enables you to assign a keyboard shortcut to any command or macro, just choose the category from the list on the left. Pay special attention to the &quot;container&quot; where this is saved - you&#39;ll want to save it in the template with the user form and <i>not</i> in the default Normal.dotm. Note, however, that you&#39;ll need to create a &quot;plain&quot; macro in a normal module for the keyboard shortcut - the document events in <code>ThisDocument</code> will not be accessible for keyboard shortcuts."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10918865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c9010759edac36cbdd1cf05e7b4d34b?s=128&d=identicon&r=PG&f=1", "display_name": "meander", "link": "https://stackoverflow.com/users/10918865/meander"}, "is_accepted": false, "score": 0, "last_activity_date": 1547656151, "creation_date": 1547656151, "answer_id": 54221364, "question_id": 54207401, "link": "https://stackoverflow.com/questions/54207401/word-userform-hotkey/54221364#54221364", "title": "Word Userform Hotkey", "body": "<p>I found the answer on a thread about keybinding, but I can't refind that thread. I added 2 new modules to my document, module1 has:</p>\n\n<p>Option Explicit</p>\n\n<pre><code>Sub AddKeyBinding()\n    With Application\n         ' \\\\ Do customization in THIS document\n        .CustomizationContext = ThisDocument\n\n         ' \\\\ Add keybinding to this document Shorcut: Alt+r\n        .KeyBindings.Add KeyCode:=BuildKeyCode(wdKeyAlt, wdKeyR), _\n        KeyCategory:=wdKeyCategoryCommand, _\n        Command:=\"TestKeybinding\"\n\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Module 2</p>\n\n<pre><code>Option Explicit\n\n ' \\\\ Test sub for keybinding\nSub TestKeybinding()\n    Channel_Select.Show\nEnd Sub\n</code></pre>\n\n<p>Run the AddKeyBinding macro, then alt+r will launch the userform on the document</p>\n"}], "owner": {"reputation": 1, "user_id": 10918865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c9010759edac36cbdd1cf05e7b4d34b?s=128&d=identicon&r=PG&f=1", "display_name": "meander", "link": "https://stackoverflow.com/users/10918865/meander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547656151, "creation_date": 1547589172, "last_edit_date": 1547590802, "question_id": 54207401, "link": "https://stackoverflow.com/questions/54207401/word-userform-hotkey", "title": "Word Userform Hotkey", "body": "<p>I currently use word templates in my business to help create customer mailings. There's a existing userform coding on our templates that insert the proper return address, phone number, legal entity, etc... onto the letter. Lately we've been having issues with a subset of users (seemingly random, we've been through exhaustive testing and cant find rhyme/reason) who do not receive the popup to choose whatever items they need when they enable macros. In testing we've found that the users have been able to go into vbasic and run the userform manually. I'd like to build in a hotkey option to initialize the userform, please help! Currently, the ThisDocument object has this code to run the userform: </p>\n\n<pre><code>Private Sub Document_New()\n\nChannel_Select.Show\n\nEnd Sub\n</code></pre>\n\n<p>From  what I've been able to find online, something like the OnKey Command from excel could be used, but I cant find the Word version. Does anyone have experience in this? </p>\n"}, {"tags": ["excel", "vba", "loops", "if-statement"], "comments": [{"owner": {"reputation": 127, "user_id": 8430114, "user_type": "registered", "profile_image": "https://graph.facebook.com/1110412778996271/picture?type=large", "display_name": "Eddy Howard", "link": "https://stackoverflow.com/users/8430114/eddy-howard"}, "edited": false, "score": 0, "creation_date": 1547589089, "post_id": 54207349, "comment_id": 95241325, "body": "My VBA is a bit rusty, but... Do 2 foreach loops. Foreach and then set a dim to the 2nd column (or increase an index and do arr[index] then do another foreach within that foreach on the same array but selecting the first column. Set the first column to another variable within the second foreach, then do a compare statement."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1547589615, "post_id": 54207349, "comment_id": 95241547, "body": "This would be easier to answer if we had sample data and expected result. Also, &quot;...smaller than one hundredths&quot; can be interpreted is more than one way (smaller than <code>0.01</code> or smaller than <code>1&#47;100th</code> of the values being compared?). Can you please <a href=\"https://stackoverflow.com/posts/54207349/edit\">edit your question</a> to provide some more info? WHat you&#39;ve tried so far would also be useful"}, {"owner": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "edited": false, "score": 0, "creation_date": 1547589692, "post_id": 54207349, "comment_id": 95241575, "body": "It sounds like a formula would be easier and more efficient way of doing this. Just put it in the third column.  If A1=B1 then &quot;YEAH&quot;, else &quot;AH man!&quot;"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1547590716, "post_id": 54207349, "comment_id": 95241965, "body": "What does &quot;error between the two&quot; mean? Please share sample data and expected outcomes from that sample data. It&#39;s not clear what you are doing here."}, {"owner": {"reputation": 3, "user_id": 9791001, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mfyHmBoAS8U/AAAAAAAAAAI/AAAAAAAABFo/SL_6X8t05YY/photo.jpg?sz=128", "display_name": "baha eren", "link": "https://stackoverflow.com/users/9791001/baha-eren"}, "edited": false, "score": 0, "creation_date": 1547591720, "post_id": 54207349, "comment_id": 95242334, "body": "Okay, I&#39;ve added an image of an example data set and clarified what I meant."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9791001, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mfyHmBoAS8U/AAAAAAAAAAI/AAAAAAAABFo/SL_6X8t05YY/photo.jpg?sz=128", "display_name": "baha eren", "link": "https://stackoverflow.com/users/9791001/baha-eren"}, "edited": false, "score": 0, "creation_date": 1547668244, "post_id": 54207833, "comment_id": 95274498, "body": "Thank you Tim this is exactly what I needed!"}, {"owner": {"reputation": 3, "user_id": 9791001, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mfyHmBoAS8U/AAAAAAAAAAI/AAAAAAAABFo/SL_6X8t05YY/photo.jpg?sz=128", "display_name": "baha eren", "link": "https://stackoverflow.com/users/9791001/baha-eren"}, "edited": false, "score": 0, "creation_date": 1547669654, "post_id": 54207833, "comment_id": 95275126, "body": "Do you mind explanining to me why it needs to be in array nomenclature? And when I tried using index match before I think it was not allowing the values to be stored because there was no exact match yet you have gotten around that here."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1547673824, "last_edit_date": 1547673824, "creation_date": 1547591681, "answer_id": 54207833, "question_id": 54207349, "link": "https://stackoverflow.com/questions/54207349/looping-through-two-columns-storing-the-value-if-a-certain-conditoin-is-met/54207833#54207833", "title": "Looping through two columns, storing the value if a certain conditoin is met", "body": "<p>Using an array formula you can do something like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/nn0Xc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nn0Xc.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here's how the formula evaluates step-by-step (selecting parts of the formula and then hitting F9 to evaluate the selected part and replace with the result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/GYwsH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GYwsH.png\" alt=\"enter image description here\"></a></p>\n\n<p>Multiplying the array of TRUE/FALSE coerces it to an array of 1/0, and that's what we feed to MATCH(), looking for the first 1.</p>\n"}], "owner": {"reputation": 3, "user_id": 9791001, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mfyHmBoAS8U/AAAAAAAAAAI/AAAAAAAABFo/SL_6X8t05YY/photo.jpg?sz=128", "display_name": "baha eren", "link": "https://stackoverflow.com/users/9791001/baha-eren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "closed_date": 1547629516, "accepted_answer_id": 54207833, "answer_count": 1, "score": 0, "last_activity_date": 1547673824, "creation_date": 1547588904, "last_edit_date": 1547629084, "question_id": 54207349, "link": "https://stackoverflow.com/questions/54207349/looping-through-two-columns-storing-the-value-if-a-certain-conditoin-is-met", "closed_reason": "Needs more focus", "title": "Looping through two columns, storing the value if a certain conditoin is met", "body": "<p>I'm very amateur at vba but I have two columns of data Column 1 and Column 2 - both of varying lengths </p>\n\n<p>This should be able to be done in a nested for loop with an if statement.</p>\n\n<p>---- sorry here is an image that will help with waht I'm trying to say ---\nSo I want compare each value in column 2 to column 1, if the difference of the two divided by the original is &lt;0.01 I want to store the Description next to column 2 so \"apple\" into the details of Column 1.</p>\n\n<p>if it doesn't fit that match then try the second value in column 1, if a fit is found the column 2 value is done, now go to the next  value. Repeat recycle</p>\n\n<p>I hope this is a better explanation.</p>\n\n<p>Image of problem:</p>\n\n<p><a href=\"https://i.stack.imgur.com/PFnLS.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PFnLS.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "excel-2010", "wscript.shell"], "comments": [{"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1547591073, "post_id": 54207254, "comment_id": 95242085, "body": "Is there a reason you cannot use Shell &quot;cmd /c &lt;python_path&gt;\\python.exe &lt;python_path&gt;\\test1.py --arg1=ABC &gt; C:\\logs\\test.log&quot;?"}, {"owner": {"reputation": 501, "user_id": 7904019, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f824b6d3bb6e8dfd1447fbfc926e61ad?s=128&d=identicon&r=PG&f=1", "display_name": "D.prd", "link": "https://stackoverflow.com/users/7904019/d-prd"}, "reply_to_user": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1547655783, "post_id": 54207254, "comment_id": 95268285, "body": "I am using anaconda so want to avoid using/launching the default windows cmd."}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1547656072, "post_id": 54207254, "comment_id": 95268457, "body": "First try command = &quot;python C:\\test1.py --arg1=ABC&quot; and see if it works.  If it does, try command = &quot;python C:\\test1.py --arg1=ABC &gt; C:\\logs\\test.log&quot;.  I don&#39;t have anaconda and couldn&#39;t test it out."}, {"owner": {"reputation": 501, "user_id": 7904019, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f824b6d3bb6e8dfd1447fbfc926e61ad?s=128&d=identicon&r=PG&f=1", "display_name": "D.prd", "link": "https://stackoverflow.com/users/7904019/d-prd"}, "reply_to_user": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1547657074, "post_id": 54207254, "comment_id": 95269052, "body": "the first command (without redirection to log file) works. The 2nd does not work. Is that because &#39;&gt;&#39; can be used with &#39;cmd /c&#39; only? With &#39;cmd /c&#39;, the &#39;&gt;&#39; works but the performance is bad for some reason. Without &#39;cmd /c&#39;, the anaconda prompt takes effect and command run is much faster but &#39;&gt;&#39; redirection to log file does not work."}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1547657958, "post_id": 54207254, "comment_id": 95269539, "body": "The &#39;&gt;&#39; can be used without cmd /c.  Have you tried to type the commend on a CMD window and it works?  Just want to make sure the target path / file is accessible."}, {"owner": {"reputation": 501, "user_id": 7904019, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f824b6d3bb6e8dfd1447fbfc926e61ad?s=128&d=identicon&r=PG&f=1", "display_name": "D.prd", "link": "https://stackoverflow.com/users/7904019/d-prd"}, "reply_to_user": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1547658890, "post_id": 54207254, "comment_id": 95270038, "body": "Just retested: The command &quot;python C:\\test1.py --arg1=ABC &gt; C:\\logs\\test.log&quot;  works fine from CMD window but not from within the VBA when used with wsh like this: command = &quot;python C:\\test1.py --arg1=ABC &gt; C:\\logs\\test.log&quot; and then wsh.Run"}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1547663380, "post_id": 54207254, "comment_id": 95272297, "body": "I assume you run the command line from CMD window with the default C:\\ path (i.e.it looks like: C:\\&gt; &quot;python C:\\test1.py --arg1=ABC &gt; C:\\logs\\test.log).  I don&#39;t have any more suggestion at the moment as It might have something to do with how anaconda call up python script for piping output.  Also just curious if you tried &quot;&gt;&gt;&quot; instead of &quot;&gt;&quot;"}], "owner": {"reputation": 501, "user_id": 7904019, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f824b6d3bb6e8dfd1447fbfc926e61ad?s=128&d=identicon&r=PG&f=1", "display_name": "D.prd", "link": "https://stackoverflow.com/users/7904019/d-prd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 468, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1587622980, "creation_date": 1547588447, "last_edit_date": 1547622305, "question_id": 54207254, "link": "https://stackoverflow.com/questions/54207254/how-to-capture-shell-wscript-shell-output-from-excel-vba-without-using-cmd", "title": "How to capture shell WScript Shell output from Excel VBA without using cmd?", "body": "<p>I have used the various posts similar to this and come up with the following, but not sure why this doesn't work for me. I have a UserForm wherein I am trying to run a script and capture the output, including any errors. However, the console window quickly disappears as soon as I run this code:</p>\n\n<pre><code>Sub test()\n    Dim wsh As Object\n    Set wsh = VBA.CreateObject(\"WScript.Shell\")\n    Dim waitOnReturn As Boolean: waitOnReturn = True\n    Dim windowStyle As Integer: windowStyle = 1\n\ncommand = \"python \"\"C:\\test1.py --arg1=ABC\"\" &gt; \"\"C:\\logs\\test.log\"\"\"\nwsh.Run command, windowStyle, waitOnReturn\n\nEnd Sub\n</code></pre>\n\n<p>The script runs just fine by itself until I add the redirection ('>'). My python script needs to be launched with 'python' keyword preceded in the command as shown above and so I cannot use 'cmd /c'. Is it possible to capture the output without using 'cmd /c' and while using wsh.Run (preferably) instead of wsh.Exec?</p>\n\n<p>Thanks. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1547588145, "post_id": 54207147, "comment_id": 95240949, "body": "There are contract programming sites for this type of thing. Stack Overflow isn&#39;t one of those.  If you&#39;d like to make a stab at actually writing the code, people here will help, but we don&#39;t do your project for you."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8852434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0c241a0a8bc17511928e8279c5cf486?s=128&d=identicon&r=PG&f=1", "display_name": "Brooke W", "link": "https://stackoverflow.com/users/8852434/brooke-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1547591877, "creation_date": 1547591877, "answer_id": 54207865, "question_id": 54207147, "link": "https://stackoverflow.com/questions/54207147/select-range-with-specific-criteria-to-export-into-multiple-csv-files/54207865#54207865", "title": "Select range with specific criteria to export into multiple CSV files", "body": "<pre><code>Sub ExportRangetoFile()\n\nDim Rng As Range\nDim WorkRng As Range\nDim xFile As Variant\nDim xFileString As String\n\nOn Error Resume Next\nxTitleId = \"KutoolsforExcel\"\nSet WorkRng = Application.Selection\nSet WorkRng = Application.InputBox(\"Range\", xTitleId, WorkRng.Address, Type:=8)\nApplication.ActiveSheet.Copy\nApplication.ActiveSheet.Cells.Clear\nWorkRng.Copy Application.ActiveSheet.Range(\"A1\")\nSet xFile = CreateObject(\"Scripting.FileSystemObject\")\nxFileString = Application.GetSaveAsFilename(\"\", filefilter:=\"Comma Separated Text (*.CSV), *.CSV\")\nApplication.ActiveWorkbook.SaveAs Filename:=xFileString, FileFormat:=xlCSV, CreateBackup:=False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8852434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0c241a0a8bc17511928e8279c5cf486?s=128&d=identicon&r=PG&f=1", "display_name": "Brooke W", "link": "https://stackoverflow.com/users/8852434/brooke-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1547592179, "creation_date": 1547587977, "question_id": 54207147, "link": "https://stackoverflow.com/questions/54207147/select-range-with-specific-criteria-to-export-into-multiple-csv-files", "title": "Select range with specific criteria to export into multiple CSV files", "body": "<p>I would like to convert the attached Excel file into multiple CVS files in the following manner:</p>\n\n<ol>\n<li>Column A = Column C values (Source Value) from Excel under a static Header title = Source Value</li>\n<li>Column B = Column G values (Target Value) from Excel under a static Header title = Target Value</li>\n<li>Naming convention of the CVS file = Column E (Controlling Picklist Field Name)_Column A (Display Name)_Column B (Field Name) --- e.g. Type_ClientType_PICK_004 --- please note that I have attached an example CVS file for what the output should look at</li>\n</ol>\n\n<p>In addition to the above - I would like the VBA code to be a loop to find the UNIQUE values in Column E (Controlling Picklist Field Name) and separate the CVS files utilizing this column. For example, all rows under Column E criteria = 'Type', THEN create a new CVS file... all rows under criteria Column E = 'Industry', THEN create a new CVS file... etc.</p>\n\n<p>If I could get the above VBA code and have all the CVS files be saved in a determined file path that would be AMAZING! Thanks so much.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 8308768, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ecd14388deeb33874cb5d1b7fdcc8db1?s=128&d=identicon&r=PG&f=1", "display_name": "rdplanglois", "link": "https://stackoverflow.com/users/8308768/rdplanglois"}, "edited": false, "score": 0, "creation_date": 1547650461, "post_id": 54207288, "comment_id": 95265064, "body": "I edited my post to provide further details into how the print page picks the items to be printed from the database. I have a Google Sheets copy of the database, if that will help. It seems to me that the code you wrote would check a defined range (my destination cells are not contiguous) and copy over from literally a few columns over (my source cells are also not contiguous, though they are all in the same column, and they are in a different tab besides). I&#39;m ok having many macros run concurrently, one for each destination, but they need to pick the correct row from the source."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 77, "user_id": 8308768, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ecd14388deeb33874cb5d1b7fdcc8db1?s=128&d=identicon&r=PG&f=1", "display_name": "rdplanglois", "link": "https://stackoverflow.com/users/8308768/rdplanglois"}, "edited": false, "score": 0, "creation_date": 1547662083, "post_id": 54207288, "comment_id": 95271649, "body": "<code>Me.Range(&quot;A1:A24&quot;)</code> could just as easily be <code>Me.Range(&quot;A1,A5,A10,A15,A20&quot;)</code>  Even after reading your update I&#39;m still not so crear on what you need to do so screenshots or a shared workbook would be a big help."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 77, "user_id": 8308768, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ecd14388deeb33874cb5d1b7fdcc8db1?s=128&d=identicon&r=PG&f=1", "display_name": "rdplanglois", "link": "https://stackoverflow.com/users/8308768/rdplanglois"}, "edited": false, "score": 0, "creation_date": 1547668694, "post_id": 54207288, "comment_id": 95274715, "body": "If your &quot;database&quot; sheet has formatted data then you could consider copying cells as pictures, then pasting those onto your &quot;print&quot; sheet in the required position.  Then you&#39;ll get the exact formatting."}, {"owner": {"reputation": 77, "user_id": 8308768, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ecd14388deeb33874cb5d1b7fdcc8db1?s=128&d=identicon&r=PG&f=1", "display_name": "rdplanglois", "link": "https://stackoverflow.com/users/8308768/rdplanglois"}, "edited": false, "score": 0, "creation_date": 1547754180, "post_id": 54207288, "comment_id": 95310708, "body": "Thank you Tim. I&#39;ve added a link to the spreadsheet. I&#39;ve tried referencing the source cells as images, which does indeed copy over the data with formatting intact. Unfortunately, the destination cells are all different heights, which means the data winds up being stretched or squished (vertically).  The <code>Me.Range</code> adjustment you posted makes sense, but I&#39;m still struggling to find a way to adjust the source cell based on the row chosen from the VLookup."}, {"owner": {"reputation": 77, "user_id": 8308768, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ecd14388deeb33874cb5d1b7fdcc8db1?s=128&d=identicon&r=PG&f=1", "display_name": "rdplanglois", "link": "https://stackoverflow.com/users/8308768/rdplanglois"}, "edited": false, "score": 0, "creation_date": 1547844035, "post_id": 54207288, "comment_id": 95346431, "body": "Thank you so much Tim! I was able to make sense of that (woe my insufficient skills), and should be able to run forward. Sorry the spreadsheet didn&#39;t help. Thanks again!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1547760644, "last_edit_date": 1547760644, "creation_date": 1547588575, "answer_id": 54207288, "question_id": 54206616, "link": "https://stackoverflow.com/questions/54206616/how-to-reference-many-text-filled-cells-and-have-all-the-formatting-copy-too/54207288#54207288", "title": "How to reference many text-filled cells and have ALL the formatting copy too?", "body": "<p>Like this using a loop (based on your posted code):</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim rng\n    Set rng = Application.Intersect(Target, Me.Range(\"A1:A24\"))\n    'Any changes in the range of interest?\n    If Not rng Is Nothing Then\n        Application.EnableEvents = False  'suspend event handling\n        'Loop over the changed cells...\n        For each c in rng.cells\n            ProcessChange c '&lt;&lt; handle any lookups\n        Next c\n        Application.EnableEvents = True 'restore event handling\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>EDIT: your posted workbook doesn't help much because it's too complex for me to spend time figuring it out, but here's a general approach which should give you a framework for how to look up matches and copy information/formatting from your \"listing\" sheet.</p>\n\n<pre><code>'called for each changed cell\nSub ProcessChange(c As Range)\n\n    Dim m, shtLookup As Workbook, valueCell As Range\n\n    Set shtLookup = ThisWorkbook.Sheets(\"Database\")\n\n    'find the new value in the lookup sheet (in the first column)\n    Set m = Application.Match(c.Value, shtLookup.Range(\"A:A\"), 0)\n    If Not IsError(m) Then\n\n        'got a match: get the corresponding cell from col CD\n        Set valueCell = shtLookup.Range(\"CD:CD\").Cells(m)\n\n        'do something with this cell\n        With c.Offset(5, 5) '&lt;&lt; some place relative to the changed cell\n            .Value = valueCell.Value   'copy value\n            .Width = valueCell.Width   'copy width\n            .Height = valueCell.Height 'copy height\n        End With\n    Else\n        MsgBox \"no match for '\" &amp; c.Value &amp; \"'\"\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 8308768, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ecd14388deeb33874cb5d1b7fdcc8db1?s=128&d=identicon&r=PG&f=1", "display_name": "rdplanglois", "link": "https://stackoverflow.com/users/8308768/rdplanglois"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547760644, "creation_date": 1547585489, "last_edit_date": 1547753935, "question_id": 54206616, "link": "https://stackoverflow.com/questions/54206616/how-to-reference-many-text-filled-cells-and-have-all-the-formatting-copy-too", "title": "How to reference many text-filled cells and have ALL the formatting copy too?", "body": "<p>I wrote an essay first, but whittled down to this:\nI've got <strong>a lot</strong> of data, and need to be able to have my Vlookup functions copy over the formatting as well as the text itself.</p>\n\n<p>I found this from the \"Similar Questions\" list: <a href=\"https://stackoverflow.com/questions/42486765/reference-a-cell-but-keep-formatting-of-text-from-source-cell\">reference a cell but keep formatting of text from source cell</a> which included this code snippet:</p>\n\n<pre><code>Private changing As Boolean\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\nIf Not Target.Address = [A1].Address Or changing Then Exit Sub\nchanging = True\n[A1].Copy [B1]\nchanging = False\n\nEnd Sub\n</code></pre>\n\n<p>Now, that actually looks like it will work for me. But, I need a way of having it check one of 24 cells on my receiving sheet, and copy over the contents of the correct source cell (of 3500+ rows by 60+ columns) on the source sheet. Right now, the source cells are found using VLookup; but how can I tie the macro above to check the correct source cells? I could make 24 copies of the above snippet, one for each destination cell, I think that would work as far as checking the destination cells only when they're changed is concerned, but the B1 reference in the snippet won't work, because the source cell changes with each entry.</p>\n\n<p>Simply: I'm not good at VBA and don't know how to use VLookup and the above snippet together.</p>\n\n<p>Thanks for your ideas!</p>\n\n<hr>\n\n<p>edit: I was asked for more details on how the source data is being found. I have a printable page with four drop-down lists (they use Validation against the Title column of the database) that let me pick (separately) four of the entries from my database. Those selections then trigger VLookups that port in the relevant data from the database into the printing page. The database is 3556 rows by 60 columns, only 17 of which are pulled to the printing page.</p>\n\n<p>Most of these datapoints are pulled over just fine. Setting the destination cell to \"Shrink to fit\" is sufficient to make sure the data, well, <em>fits</em>. For five of these, however, \"Shrink to fit\" is unavailable, as they are (usually) multi-line entries, and so \"Wrap text\" must be on, which makes \"Shrink to fit\" unavailable. This means I must manually fit in the text of those 5 datapoints, for each of the four selections on my print page. This can get quite time-consuming, especially when I have a hundred or more to print off.</p>\n\n<p>Alternatively, as I have mostly done this already, I could manually edit each original entry (setting the column widths and font the same as the print page), and, once they have been made to fit, they could be copied whole to the destination cells on the print page.</p>\n\n<p>So, ideally, the code proposed above could be mashed to check when each of the various 24 cells (they are not continuous) are changed, and then to find the correct source cell (each cell that changes would only ever receive data from a cell in a particular column, so, for example, H5, H77, H149, and H221 will always receive their data from column CD in the database, whereas V5, V77, V149, and V221 will always receive their data from column BZ in the database) and copy over the source data (including all text formatting).</p>\n\n<hr>\n\n<p>edit 2: <a href=\"https://drive.google.com/open?id=1VWWK_R-c2tNGojrf6MprTDEMfq1oT9S2\" rel=\"nofollow noreferrer\">A link to my spreadsheet</a>. Should've done that to begin with... :p</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 2, "creation_date": 1547585403, "post_id": 54206548, "comment_id": 95239864, "body": "A search for &quot;excel cascading drop down menus&quot; should yields several results on how to do this"}, {"owner": {"reputation": 45, "user_id": 9755460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aWng3.jpg?s=128&g=1", "display_name": "G.Aurelien", "link": "https://stackoverflow.com/users/9755460/g-aurelien"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1547585464, "post_id": 54206548, "comment_id": 95239884, "body": "But it seems like your data need to be structured a certain way"}], "answers": [{"comments": [{"owner": {"reputation": 106, "user_id": 5084013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a53c7e8d047c9b80d252bafdc888195?s=128&d=identicon&r=PG&f=1", "display_name": "Hansraj", "link": "https://stackoverflow.com/users/5084013/hansraj"}, "reply_to_user": {"reputation": 45, "user_id": 9755460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aWng3.jpg?s=128&g=1", "display_name": "G.Aurelien", "link": "https://stackoverflow.com/users/9755460/g-aurelien"}, "edited": false, "score": 0, "creation_date": 1547784073, "post_id": 54209756, "comment_id": 95319421, "body": "Can you please share where exactly you are getting the error."}, {"owner": {"reputation": 45, "user_id": 9755460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aWng3.jpg?s=128&g=1", "display_name": "G.Aurelien", "link": "https://stackoverflow.com/users/9755460/g-aurelien"}, "edited": false, "score": 0, "creation_date": 1548194387, "post_id": 54209756, "comment_id": 95454045, "body": "If c.Value = ActiveSheet.Range(&quot;H7&quot;).Value Then &#39;selected country   @Hansraj that where I am getting the error"}, {"owner": {"reputation": 106, "user_id": 5084013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a53c7e8d047c9b80d252bafdc888195?s=128&d=identicon&r=PG&f=1", "display_name": "Hansraj", "link": "https://stackoverflow.com/users/5084013/hansraj"}, "reply_to_user": {"reputation": 45, "user_id": 9755460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aWng3.jpg?s=128&g=1", "display_name": "G.Aurelien", "link": "https://stackoverflow.com/users/9755460/g-aurelien"}, "edited": false, "score": 0, "creation_date": 1548287387, "post_id": 54209756, "comment_id": 95491972, "body": "As you can see from the code the cells are all hard coded. please make sure all the cell references are correct in your specific context. A snap shot of your worksheet will help to identify the problem."}], "tags": [], "owner": {"reputation": 106, "user_id": 5084013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a53c7e8d047c9b80d252bafdc888195?s=128&d=identicon&r=PG&f=1", "display_name": "Hansraj", "link": "https://stackoverflow.com/users/5084013/hansraj"}, "is_accepted": false, "score": 1, "last_activity_date": 1547607067, "creation_date": 1547607067, "answer_id": 54209756, "question_id": 54206548, "link": "https://stackoverflow.com/questions/54206548/dependent-drop-down-list-excel/54209756#54209756", "title": "Dependent drop down list excel", "body": "<p>Yes it is possible to use VBA to do this. However named ranges are possible only if you intend to use countries and cities as a contiguous list i.e. all rows sorted on countries and cities in that order. \nThe  below code will allow you to create this feature irrespective of the sorting order, i.e. even if data is not sorted. \nThis is a basic code not written for performance but works, please edit accordingly .\nHope this solves your problem.</p>\n\n<pre><code>Sub SetupCountry() 'run this on workbook open event\n    Dim rng As Range\n    Set rng = ActiveSheet.Range(\"H7\")  'choose your cell(s) here\n    With rng.Validation\n        FRM = GetUniqueCountries()\n        .Delete\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n        xlBetween, Formula1:=FRM\n        .IgnoreBlank = True\n        .InCellDropdown = True\n        .InputTitle = \"\"\n        .ErrorTitle = \"\"\n        .InputMessage = \"\"\n        .ErrorMessage = \"\"\n        .ShowInput = True\n        .ShowError = True\n    End With\nEnd Sub\n\nSub SetupCity()  'run this sub on the change event of Country cell\n    Dim rng As Range\n    Set rng = ActiveSheet.Range(\"I7\")  'choose your cell(s) here\n    With rng.Validation\n        FRM = GetCities()\n        .Delete\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n        xlBetween, Formula1:=FRM\n        .IgnoreBlank = True\n        .InCellDropdown = True\n        .InputTitle = \"\"\n        .ErrorTitle = \"\"\n        .InputMessage = \"\"\n        .ErrorMessage = \"\"\n        .ShowInput = True\n        .ShowError = True\n    End With\nEnd Sub\n\n\nFunction GetUniqueCountries() As String\n    Dim sOut As String\n    Dim v, c\n    Dim rngList As Range\n\n    Set rngList = ActiveSheet.Range(\"D7:D28\") 'edit the range where your country list is stored\n    sOut = \"\"\n\n    For Each c In rngList\n        If InStr(1, sOut, c.Value &amp; \",\") = 0 Then  'check if the value is already in the upload list and add if not there\n            sOut = c.Value &amp; \",\" &amp; sOut\n        End If\n    Next c\n    'remove first ,\n    If sOut &lt;&gt; \"\" Then\n        sOut = Left(sOut, Len(sOut) - 1)\n    End If\n    GetUniqueCountries = sOut\nEnd Function\nFunction GetCities() As String\n     Dim sOut As String\n    Dim v, c\n    Dim rngSearch As Range\n\n    Set rngSearch = ActiveSheet.Range(\"D7:D28\") 'edit the range where your cities list exists\n    sOut = \"\"\n\n    For Each c In rngSearch\n        If c.Value = ActiveSheet.Range(\"H7\").Value Then 'selected country\n            sOut = sOut &amp; \",\" &amp; ActiveSheet.Range(\"E\" &amp; c.Row).Value\n        End If\n    Next c\n    'remove first ,\n    If sOut &lt;&gt; \"\" Then\n        sOut = Mid(sOut, 2)\n    End If\n    GetCities = sOut\nEnd Function\n\n\n</code></pre>\n\n<p>If you are ok sorting the the data along country and cities then named ranges would be a more elegant solution. \nWhere the datavalidation formula for city would then refer to a named range e.g. CITIES \nyou would need to reset the range for CITIES based on value of country ( using a similar construct of getCities() function. </p>\n\n<p>one simple way to change the range reference for a named range is show below. The formula can be updated based on the search output. </p>\n\n<pre><code>\nActiveWorkbook.Names(\"SOMENAMEDRANGE\").RefersTo = \"=Sheet1!$D$5:$L$25\"\n\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 9755460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aWng3.jpg?s=128&g=1", "display_name": "G.Aurelien", "link": "https://stackoverflow.com/users/9755460/g-aurelien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547636307, "creation_date": 1547585125, "last_edit_date": 1547636307, "question_id": 54206548, "link": "https://stackoverflow.com/questions/54206548/dependent-drop-down-list-excel", "title": "Dependent drop down list excel", "body": "<p>I have a question about how to create a drop down column that is based on previous column. What I am struggling with is how my data is structure. </p>\n\n<p>My first column A has all the country names. The header of that column is named Country. The second Column(column B) has all the city names. The header of that column is named Cities. I want to be able to select a country and then the next column should only show cities for that country for me to select.</p>\n\n<p>My approach\nI try to use name range for my 2 columns. Then I go to the next sheet and create 2 columns(CountryInput, CitiesInput). In the column named CountryInput I go into data validation tools to create the first drop down list. The column CitiesInput which should depend on CountryInput is what I am having problem with. I tried to use indirect=A2 function but nothing happens.</p>\n\n<p>Also can I use vba or macro to do this?</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1547586588, "post_id": 54206418, "comment_id": 95240331, "body": "%userprofile%/documents, etc., get you a non-login specific location"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1547587749, "post_id": 54206418, "comment_id": 95240785, "body": "<code>INDIRECT</code> may help, but also may hinder if you have tons of formulas as it is volatile formula."}, {"owner": {"reputation": 1, "user_id": 10918772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a77d8ea18e9eb1981aae7e358fa854dc?s=128&d=identicon&r=PG&f=1", "display_name": "Troy", "link": "https://stackoverflow.com/users/10918772/troy"}, "edited": false, "score": 0, "creation_date": 1547587898, "post_id": 54206418, "comment_id": 95240844, "body": "Cyril, Thank you for your response. I don&#39;t understand what you re referring to."}, {"owner": {"reputation": 1, "user_id": 10918772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a77d8ea18e9eb1981aae7e358fa854dc?s=128&d=identicon&r=PG&f=1", "display_name": "Troy", "link": "https://stackoverflow.com/users/10918772/troy"}, "edited": false, "score": 0, "creation_date": 1547587943, "post_id": 54206418, "comment_id": 95240864, "body": "Scott, Thank you for your response.  The users wont have the data spread sheet open so INDIRECT won&#39;t work. But again, thank you for responding..."}], "owner": {"reputation": 1, "user_id": 10918772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a77d8ea18e9eb1981aae7e358fa854dc?s=128&d=identicon&r=PG&f=1", "display_name": "Troy", "link": "https://stackoverflow.com/users/10918772/troy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547622296, "creation_date": 1547584450, "last_edit_date": 1547622296, "question_id": 54206418, "link": "https://stackoverflow.com/questions/54206418/trying-to-use-file-paths-based-on-user-within-a-cell-formula", "title": "Trying to use file path&#39;s based on user within a cell formula", "body": "<p>I have a spreadsheet with a slew of IF, VLOOKUP, etc formulas with references to data from other worksheets within the same spreadsheets. I will eventually have many of these spreadsheets for each project I am running.</p>\n\n<p>Instead of updating the referenced data in each, I will make one master spreadsheet with the referenced data and the project spreadsheets will reference that master spreadsheet for the data. The problem I have is that other users will use these project spreadsheets and the master spreadsheet will be located on a OneDrive sync'd to the users PC. Now I have to deal with different file paths within the formulas. </p>\n\n<p>I found a VB script that will return the user's PC name. I can build a table that depending on the users name it will point to the right file path. I have tried the file path as a Defined Name but it doesn't work. </p>\n\n<p>This formula works:</p>\n\n<p><code>=VLOOKUP('CTC Review'!F3&amp;'CTC Review'!G1&amp;'CTC Review'!A13,'C:\\Users\\user1\\OneDrive\\Operations\\Financials\\CTC\\CTC Data\\[CTC Data Jan-19.xlsx]C2CDataExtractForLabor'!A2:M5000,7)</code></p>\n\n<p>What I am trying to get to work is:</p>\n\n<p><code>=VLOOKUP('CTC Review'!F3&amp;'CTC Review'!G1&amp;'CTC Review'!A13,'DEFINEDNAME &amp; C2CDataExtractForLabor'!A2:M5000,7)</code></p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "ms-access", "qodbc"], "comments": [{"owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "edited": false, "score": 0, "creation_date": 1547584099, "post_id": 54206284, "comment_id": 95239368, "body": "Are these two statements being executed via VBA or just as stored queries?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10891568"}, "reply_to_user": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "edited": false, "score": 0, "creation_date": 1547584158, "post_id": 54206284, "comment_id": 95239387, "body": "They are being executed via VBA"}, {"owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "edited": false, "score": 1, "creation_date": 1547584513, "post_id": 54206284, "comment_id": 95239535, "body": "I don&#39;t see why you couldn&#39;t just place them both in the same module and have them execute sequentially. Can you post the code you&#39;ve tried and maybe I can get a better idea of what issues you&#39;re having?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1547584626, "post_id": 54206284, "comment_id": 95239577, "body": "So... where&#39;s the VBA code that&#39;s executing them? The queries themselves are rather irrelevant."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10891568"}, "edited": false, "score": 0, "creation_date": 1547585544, "post_id": 54206284, "comment_id": 95239915, "body": "Please take a look at my update"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1547598170, "post_id": 54206284, "comment_id": 95243944, "body": "As long as connection is actually established, the SQL should work."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1547601837, "post_id": 54206284, "comment_id": 95244713, "body": "<a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/execute-method-ado-connection?view=sql-server-2017\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/sql/ado/reference/ado-api/&hellip;</a> - look into using the <code>RecordsAffected</code> parameter, which should return 1 if your insert is successful.  If there&#39;s a problem with the insert in this case it should also raise an error though..."}], "owner": {"user_type": "does_not_exist", "display_name": "user10891568"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547585527, "creation_date": 1547583753, "last_edit_date": 1547585527, "question_id": 54206284, "link": "https://stackoverflow.com/questions/54206284/how-can-i-run-this-sql-script-in-vba-after-the-first-one-succeeds", "title": "How can I run this SQL script in VBA after the first one succeeds?", "body": "<p>I currently have this SQL query:</p>\n\n<pre><code>INSERT INTO InvoiceLine (InvoiceLineItemRefListID, InvoiceLineDesc, InvoiceLineRate, InvoiceLineAmount, InvoiceLineSalesTaxCodeRefListID, FQSaveToCache) VALUES ('80002436-1519061496', 'Building permit 1', 1.00000, 1.00, '80000001-1478562826', 1)\n</code></pre>\n\n<p>Once it is successful, I would like this query to run:</p>\n\n<pre><code>INSERT INTO Invoice (CustomerRefListID, ARAccountRefListID, TxnDate, RefNumber, BillAddressAddr1, BillAddressAddr2, BillAddressCity, BillAddressState, BillAddressPostalCode, BillAddressCountry, IsPending, TermsRefListID, DueDate, ShipDate, ItemSalesTaxRefListID, Memo, IsToBePrinted, CustomerSalesTaxCodeRefListID) VALUES ('800001F6-1482536280', '8000001E-1478562986', #9/23/2020#, '1', 'Brad Lamb', '1921 Appleseed Lane', 'Bayshore', 'CA', '94326', 'USA', 0, '80000002-1478562832', #10/31/2020#, #10/01/2020#, '8000295C-1541711590', 'Memo Test', 0, '80000001-1478562826')\n</code></pre>\n\n<p>What can I add in between the two queries? Maybe an \"if\" \"then\" statement?</p>\n\n<p><strong>UPDATE</strong> </p>\n\n<p>Running them sequentially does work, but there seems to be another issue I'm seeing:</p>\n\n<p>When just running the second query in Access everything works fine, but when running the second query in VBA SQL I receive the error:</p>\n\n<p>\" [QODBC] [sql syntax error] expected lexical element not found \"</p>\n\n<p>All values are hard coded, so I don't understand what the issue is?</p>\n\n<p>Code:</p>\n\n<pre><code>Private Sub send_Click()\n\nConst adOpenStatic = 3\nConst adLockOptimistic = 3\n\n\nDim oConnection\nDim oRecordset\nDim sMsg\nDim sConnectString\nDim sSQL\n\n\n\n\nsConnectString = \"DSN=Quickbooks Data;OLE DB Services=-2;\"\n\nsSQL = \"INSERT INTO Invoice (CustomerRefListID, ARAccountRefListID, TxnDate, RefNumber, BillAddressAddr1, BillAddressAddr2, BillAddressCity, BillAddressState, BillAddressPostalCode, BillAddressCountry, IsPending, TermsRefListID, DueDate, ShipDate, ItemSalesTaxRefListID,IsToBePrinted, CustomerSalesTaxCodeRefListID) VALUES ('800001F6-1482536280', '8000001E-1478562986', #9/23/2005#, '1', 'Brad Lamb', '1921 Appleseed Lane', 'Bayshore', 'CA', '94326', 'USA', 0, '80000002-1478562832', #10/31/2005#, #10/01/2005#, '8000295C-1541711590', 0, '80000001-1478562826') \"\n\n\nSet oConnection = CreateObject(\"ADODB.Connection\")\nSet oRecordset = CreateObject(\"ADODB.Recordset\")\noConnection.Open sConnectString\noConnection.Execute (sSQL)\nsMsg = sMsg &amp; \"Invoice was Sent to QuickBooks\"\nMsgBox sMsg\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-access-2010"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1547583398, "post_id": 54206184, "comment_id": 95239088, "body": "If it comes from <code>Split()</code>, <code>MyList</code> would be an array rather than a string. Declare it as <code>Dim MyList As Variant</code>"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1547583844, "post_id": 54206184, "comment_id": 95239277, "body": "As far as your question goes, something like <code>ComboBox1.List = Split(txt)</code> in the form&#39;s initialize event should be enough."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1547584072, "post_id": 54206184, "comment_id": 95239355, "body": "Side note, the <code>[square-brackets]</code> shouldn&#39;t be needed, unless you use illegal characters to name your controls (e.g. whitespace)."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 10918880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ac0884d458e07e76a2d055b05cbf76d?s=128&d=identicon&r=PG&f=1", "display_name": "SharonIsKaren", "link": "https://stackoverflow.com/users/10918880/sharoniskaren"}, "edited": false, "score": 0, "creation_date": 1547645320, "post_id": 54207523, "comment_id": 95261759, "body": "Thank you all for your contribution. I am not very good at correct punctuation and format when it comes to code. The ComboBox is on a subform and the textbox is not. How would I refer to the combobox and its rowsource since Me.Combobox will not work? Something like Forms![Name of Subform].[Combobox Name].Rowsource? Too many &quot;!&quot; and &quot;.&quot; that I put in the wrong spot. Thanks."}, {"owner": {"reputation": 39, "user_id": 10918880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ac0884d458e07e76a2d055b05cbf76d?s=128&d=identicon&r=PG&f=1", "display_name": "SharonIsKaren", "link": "https://stackoverflow.com/users/10918880/sharoniskaren"}, "edited": false, "score": 0, "creation_date": 1547645848, "post_id": 54207523, "comment_id": 95262084, "body": "Thank you @June7 this worked perfectly! I forgot to change the RowSource Type property to ValueList."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 3, "last_activity_date": 1547591727, "last_edit_date": 1547591727, "creation_date": 1547589766, "answer_id": 54207523, "question_id": 54206184, "link": "https://stackoverflow.com/questions/54206184/is-there-an-easy-vba-code-using-split-function-to-get-a-list-of-values-for-a-c/54207523#54207523", "title": "Is there an easy VBA code using Split() Function to get a list of values for a combo box that was originally from a text box as a string?", "body": "<p>First, combobox RowSourceType property must be set to ValueList. Next, VBA sets RowSource property, not Value. List is not a property of combobox in Access. Simply:</p>\n\n<p><code>Me.myComboBox.RowSource = Replace(Me.myTextBoxField, \"/\", \";\")</code></p>\n\n<p>Form Load event should be appropriate.</p>\n"}], "owner": {"reputation": 39, "user_id": 10918880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ac0884d458e07e76a2d055b05cbf76d?s=128&d=identicon&r=PG&f=1", "display_name": "SharonIsKaren", "link": "https://stackoverflow.com/users/10918880/sharoniskaren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 54207523, "answer_count": 1, "score": 0, "last_activity_date": 1547591727, "creation_date": 1547583199, "last_edit_date": 1547583326, "question_id": 54206184, "link": "https://stackoverflow.com/questions/54206184/is-there-an-easy-vba-code-using-split-function-to-get-a-list-of-values-for-a-c", "title": "Is there an easy VBA code using Split() Function to get a list of values for a combo box that was originally from a text box as a string?", "body": "<p>On my access form, I have a text box that will be a string of characters with multiple \"/\"s throughout the string. I want to use the split function to separate this string into a list of values to use for my combo box on a subform. </p>\n\n<p>I know it's somewhere along the lines of:</p>\n\n<pre><code>Public Function MakeList()\nDim MyList as String\nDim txt as String\n\ntxt = [myTextBoxField].Value\nMyList = Split(txt,\"/\")\n</code></pre>\n\n<p>Either:</p>\n\n<pre><code>[myComboBox].Value = MyList\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>[myTextBoxField].Value = MyList\n\nEnd Sub\n</code></pre>\n\n<p>I am not sure if this is supposed to be on \"Form Load\" or in a module for the Public Function.</p>\n\n<p>All other code shows a <code>For</code> Loop or <code>Debug.Print</code>. I am looking to store this list as a field in my table and then use that field for my Row Source in my combo box.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1547583878, "post_id": 54206131, "comment_id": 95239288, "body": "FWIW an <code>input</code> HTML tag has absolutely nothing to do with an <code>InputBox</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1547583926, "post_id": 54206131, "comment_id": 95239308, "body": "Does the value of the placeholder change, or is it just the CSS styling is not updated when you set the value via VBA? What do you get if you use <code>Debug.Print ie.document.getElementById (&quot;linkInput0&quot;).value</code> immediately after setting the value?"}, {"owner": {"reputation": 3, "user_id": 10918882, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1WwVb.jpg?s=128&g=1", "display_name": "Envid Ghajar", "link": "https://stackoverflow.com/users/10918882/envid-ghajar"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1547585394, "post_id": 54206131, "comment_id": 95239860, "body": "@TimWilliams   i write this code after setting the value  MsgBox ie.document.getElementById(&quot;linkInput0&quot;).Value And the sample was inside the msgbox  but in ie the value of element Still empty"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547587069, "post_id": 54206131, "comment_id": 95240534, "body": "Is there an url we can use please?"}, {"owner": {"reputation": 3, "user_id": 10918882, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1WwVb.jpg?s=128&g=1", "display_name": "Envid Ghajar", "link": "https://stackoverflow.com/users/10918882/envid-ghajar"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547632501, "post_id": 54206131, "comment_id": 95254526, "body": "@QHarr  <a href=\"https://www.aparat.com/uploadnew\" rel=\"nofollow noreferrer\">aparat.com/uploadnew</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547637453, "post_id": 54206131, "comment_id": 95257322, "body": "Do you have access to using selenium basic for vba?"}], "owner": {"reputation": 3, "user_id": 10918882, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1WwVb.jpg?s=128&g=1", "display_name": "Envid Ghajar", "link": "https://stackoverflow.com/users/10918882/envid-ghajar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547583930, "creation_date": 1547582892, "last_edit_date": 1547583930, "question_id": 54206131, "link": "https://stackoverflow.com/questions/54206131/changing-the-value-of-html-input-tag", "title": "Changing the value of HTML input tag", "body": "<p>I want to change the value of an <code>input</code> tag in internet explorer with the help of VBA.</p>\n\n<p>The markup for the element is as follows:</p>\n\n<pre><code>&lt;input class = \"sc-jTzLTM gyzInv\" name = \"linkInput0\" placeholder = \"Ex: http://www.youtube.com/watch?v=WW_aUQ\" type = \"text\" data-icon = \"youtube\" id = \"linkInput0\" value = \"\" /&gt;\n</code></pre>\n\n<p>When I use the following code</p>\n\n<pre><code>ie.document.getElementById (\"linkInput0\").value = \"sample\"\n</code></pre>\n\n<p>Instead of changing the value, the value of the placeholder changes to \"sample\"</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1548084799, "post_id": 54205384, "comment_id": 95406784, "body": "Is your question answered with the additional information about naming of a range? If yes, please consider to &quot;accept the answer&quot; as explained here: <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4529441, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/kGPQA.gif?s=128&g=1", "display_name": "jparks54", "link": "https://stackoverflow.com/users/4529441/jparks54"}, "edited": false, "score": 0, "creation_date": 1547581964, "post_id": 54205743, "comment_id": 95238473, "body": "Awesome thank you i will start playing with that. Is there away to get it to just reference the group so that if some one comes in behind me and adds a item/row to the check list inside of the group the code wont have to be modified?"}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "reply_to_user": {"reputation": 23, "user_id": 4529441, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/kGPQA.gif?s=128&g=1", "display_name": "jparks54", "link": "https://stackoverflow.com/users/4529441/jparks54"}, "edited": false, "score": 1, "creation_date": 1547586864, "post_id": 54205743, "comment_id": 95240445, "body": "If you give the range a name, then you may exchange <code>Range(&quot;6:10&quot;)</code> by <code>Range(&quot;GivenName&quot;)</code>"}], "tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": false, "score": 1, "last_activity_date": 1547628865, "last_edit_date": 1547628865, "creation_date": 1547581085, "answer_id": 54205743, "question_id": 54205384, "link": "https://stackoverflow.com/questions/54205384/hide-rows-on-another-sheet-based-on-a-group-of-cells-then-print/54205743#54205743", "title": "Hide rows on another sheet based on a group of cells then print", "body": "<p>Here is your example, either hiding the rows or grouping them and showing rowlevel 1.</p>\n\n<p>If you give a name (by Formulas | Name Manager) to each relevant area on your checklist, then you may exchange <code>Range(\"6:10\")</code> by <code>Range(\"RowsToBeHiddenByB14\")</code>. If someone else later adds some rows within a named range on the checklist, the code still works - otherwise he has to adapt the range of that name within Excel's Name Manager.</p>\n\n<pre><code>Private Sub HideOrGroupSomeRows()\n    Dim MainSheet As Worksheet\n    Dim CheckSheet As Worksheet\n\n    Set MainSheet = ActiveWorkbook.Sheets(\"Main\")\n    Set CheckSheet = ActiveWorkbook.Sheets(\"CheckList\")\n\n    ' Either just hide the rows:\n    CheckSheet.Range(\"6:10\").EntireRow.Hidden = _\n        StrComp(MainSheet.Range(\"B14\").Value, \"x\", vbTextCompare) = 0\n    CheckSheet.Range(\"106:116\").EntireRow.Hidden = _\n        StrComp(MainSheet.Range(\"B15\").Value, \"x\", vbTextCompare) = 0\n\n    ' Or group them and show rowlevel 1:\n    CheckSheet.UsedRange.ClearOutline\n    With CheckSheet.Outline\n        .AutomaticStyles = False\n        .SummaryRow = xlAbove\n        .SummaryColumn = xlLeft\n    End With\n    If StrComp(MainSheet.Range(\"B14\").Value, \"x\", vbTextCompare) = 0 Then _\n        CheckSheet.Range(\"6:10\").EntireRow.Group\n    If StrComp(MainSheet.Range(\"B15\").Value, \"x\", vbTextCompare) = 0 Then _\n        CheckSheet.Range(\"106:116\").EntireRow.Group\n    CheckSheet.Outline.ShowLevels RowLevels:=1\n\n    Set MainSheet = Nothing\n    Set CheckSheet = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4529441, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/kGPQA.gif?s=128&g=1", "display_name": "jparks54", "link": "https://stackoverflow.com/users/4529441/jparks54"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547628865, "creation_date": 1547579432, "last_edit_date": 1547604075, "question_id": 54205384, "link": "https://stackoverflow.com/questions/54205384/hide-rows-on-another-sheet-based-on-a-group-of-cells-then-print", "title": "Hide rows on another sheet based on a group of cells then print", "body": "<p>I have 2 worksheets \"Main\" and \"CheckList\".</p>\n\n<p>The \"Main\" worksheet has selections in cells B14:B29 and in cells E14:E21 (by selections I mean I have made is so that when these cells are activated they auto fill with an X). I also have a button on the page labeled \"Print\"</p>\n\n<p>The \"CheckList\" page is a check list.</p>\n\n<p>I want to when I press the button labeled \"Print\" to \n - filter out/hide rows on the \"CheckList\" based on what boxes are selected on the \"Main\" worksheet\n - print the \"CheckList\" to the default printer.</p>\n\n<p>For example if Main B14 has an X (can I also make it where it isn't case sensitive?) then rows 6-10 will be hidden, if B15 has an X then rows 106-116 will be hidden. It'll be a different set of rows for every X in the ranges I mentioned.</p>\n\n<p>I was also curious if this can be accomplished using groups so that it will be easier for someone to come behind me and add items to the check list with out changing the code.</p>\n"}, {"tags": ["excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547579613, "post_id": 54205360, "comment_id": 95237549, "body": "Have you considered using selenium basic wrapper for vba?"}, {"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 1, "creation_date": 1547579706, "post_id": 54205360, "comment_id": 95237584, "body": "Try <code>Application.SendKeys &quot;~&quot;, True</code> without the brackets"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1547582510, "post_id": 54205360, "comment_id": 95238693, "body": "@JoshEller - Alternatively, <code>{ENTER}</code>"}, {"owner": {"reputation": 35, "user_id": 10918667, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8Chk6tO-CE8/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbO3XFbfQwoA6JTwaSylv9yIwIuJw/mo/photo.jpg?sz=128", "display_name": "Alex", "link": "https://stackoverflow.com/users/10918667/alex"}, "edited": false, "score": 0, "creation_date": 1547583420, "post_id": 54205360, "comment_id": 95239097, "body": "I have tried using {ENTER} and it does not seem to register either."}, {"owner": {"reputation": 35, "user_id": 10918667, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8Chk6tO-CE8/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbO3XFbfQwoA6JTwaSylv9yIwIuJw/mo/photo.jpg?sz=128", "display_name": "Alex", "link": "https://stackoverflow.com/users/10918667/alex"}, "edited": false, "score": 0, "creation_date": 1547588187, "post_id": 54205360, "comment_id": 95240975, "body": "I just tried the ~ without the brackets and it worked, Thank you very much!"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 10918667, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8Chk6tO-CE8/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbO3XFbfQwoA6JTwaSylv9yIwIuJw/mo/photo.jpg?sz=128", "display_name": "Alex", "link": "https://stackoverflow.com/users/10918667/alex"}, "edited": false, "score": 0, "creation_date": 1547583335, "post_id": 54205541, "comment_id": 95239053, "body": "Thank you very much for replying. Here is an example of a vin that would be found 1G4HD57287U218052."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 35, "user_id": 10918667, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8Chk6tO-CE8/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbO3XFbfQwoA6JTwaSylv9yIwIuJw/mo/photo.jpg?sz=128", "display_name": "Alex", "link": "https://stackoverflow.com/users/10918667/alex"}, "edited": false, "score": 0, "creation_date": 1547586928, "post_id": 54205541, "comment_id": 95240470, "body": "I have added an example of submitting and retrieving values."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1547587377, "last_edit_date": 1547587377, "creation_date": 1547580173, "answer_id": 54205541, "question_id": 54205360, "link": "https://stackoverflow.com/questions/54205360/why-is-sendkey-enter-not-working-with-chrome-browser/54205541#54205541", "title": "Why is SendKey Enter not working with Chrome browser", "body": "<p>I would give <a href=\"https://github.com/florentbr/SeleniumBasic/releases/tag/v2.0.9.0\" rel=\"nofollow noreferrer\">selenium basic wrapper</a> for vba a try if you are allowed to install. After installation you add a reference to selenium type library via vbe > tool > references. You need the latest chrome install and chromedriver and the chromedriver.exe should be in the same folder as the selenium executables.</p>\n\n<p>Then the syntax for your task is nice and descriptive. I haven't added a loop over vins but the essential elements for the search are shown. I provide a sub to write out results to a worksheet.</p>\n\n<p>I'd like to be able to remove the explicit wait after SendKeys but there doesn't appear to be any page event/change I can monitor to determine when to click the button and have the sent vin included. A 1 sec wait appears consistently to be sufficient. You could explore reducing this depending on how many searches you are performing.</p>\n\n<pre><code>Option Explicit\nPublic Sub SearchVins()\n    Dim d As WebDriver, hTable As Object, ws As Worksheet, t As Date\n    Dim headers(), vin As String\n    Const MAX_WAIT_SEC As Long = 10\n    Set d = New ChromeDriver\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Const URL = \"https://www.autoreturn.com/indianapolis-in/find-vehicle/\"\n\n    headers = Array(\"License\", \"State\", \"Make\", \"Model\", \"Color\", \"Vin\", \"Status\", \"Tow date and Time\")\n    vin = \"1G4HD57287U218052\"\n\n    With d\n        .Start \"Chrome\"\n        .get URL\n\n        .FindElementById(\"vin\").SendKeys vin     '&lt;== vin\n\n        Application.Wait Now + TimeSerial(0, 0, 1)\n\n        .FindElementByCss(\"[onclick='submitVin()']\").Click\n\n        t = Timer\n        Do\n            DoEvents\n            On Error Resume Next\n            Set hTable = .FindElementByCss(\"table\")  'use tag name of results table to target table\n            On Error GoTo 0\n            If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n        Loop While hTable Is Nothing\n        'do something with results\n        If Not hTable Is Nothing Then\n            WriteTable hTable, LastRow(ws) + 2, ws\n            Set hTable = Nothing\n        End If\n\n        .FindElementByCss(\"a.more-link\").Click   '&lt;== search again button\n        'Another search for example.....\n        Stop                                     '&lt;==Delete me later\n        ws.Cells(2, 2).Resize(1, UBound(headers) + 1) = headers '&lt;== Finally add headers\n        .Quit\n    End With\nEnd Sub\n\nPublic Sub WriteTable(ByVal hTable As Object, ByVal startRow As Long, ByVal ws As Worksheet)\n    Dim tr As Object, td As Object, r As Long, c As Long\n    r = startRow\n    For Each tr In hTable.FindElementsByTag(\"tr\")\n        c = 1\n        For Each td In tr.FindElementsByTag(\"td\")\n            ws.Cells(r, c) = td.Text\n            c = c + 1\n        Next\n        r = r + 1\n    Next\nEnd Sub\nPublic Function LastRow(ByVal sh As Worksheet) As Long\n    On Error Resume Next\n    LastRow = sh.Cells.Find(What:=\"*\", _\n                            After:=sh.Range(\"A1\"), _\n                            Lookat:=xlPart, _\n                            LookIn:=xlFormulas, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Row\n    On Error GoTo 0\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 10918667, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8Chk6tO-CE8/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbO3XFbfQwoA6JTwaSylv9yIwIuJw/mo/photo.jpg?sz=128", "display_name": "Alex", "link": "https://stackoverflow.com/users/10918667/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1953, "favorite_count": 0, "accepted_answer_id": 54205541, "answer_count": 1, "score": 2, "last_activity_date": 1547587377, "creation_date": 1547579327, "last_edit_date": 1547586992, "question_id": 54205360, "link": "https://stackoverflow.com/questions/54205360/why-is-sendkey-enter-not-working-with-chrome-browser", "title": "Why is SendKey Enter not working with Chrome browser", "body": "<p>I am trying to check several vins entered into excel in a chrome browser, this code will open the browser and enter them in but it wont hit enter to click the button. Not sure what I am doing wrong but i have tried several variations and cant seem to come up with anything.</p>\n\n<p>Sorry if my formatting is terrible this is my first time posting here.</p>\n\n<pre><code>chromePath = \"\"\"C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe\"\"\"\n\nStartRow = 2\nEndRow = InputBox(\"Please enter how many vins to check!\")\n\nRowIndex = 2\nEndRow = 1 + EndRow\n\nFor i = StartRow To EndRow\nVin = Sheets(\"VinCheck\").Cells(i, \"A\")\nbrowser = Shell(chromePath &amp; \" -url https://www.autoreturn.com/indianapolis-in/find-vehicle/ \")\n\nApplication.Wait Now + 0.00003\n\n\n\nApplication.SendKeys \"{Tab}\", True\nApplication.SendKeys \"{Tab}\", True\nApplication.SendKeys \"{Tab}\", True\nApplication.SendKeys \"{Tab}\", True\n\nApplication.SendKeys Vin, True\nApplication.SendKeys \"{~}\", True\n\nApplication.SendKeys \"{Tab}\", True \nApplication.Wait Now + 0.00003\n\n\nMsg = \"Was Vehicle Found?\" &amp; vbCrLf &amp; \"Click Yes to move on to the next Vin\"\nMsgBox Msg, vbYesNo, \"Advanced Excel Training\"\nIf Response = vnYes Then\nSheets(\"VinCheck\").Cells(i, \"B\").Value = \"Found\"\nElse\nSheets(\"VinCheck\").Cells(i, \"B\").Value = \"Vehicle Not Found\"\nEnd If\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "vbe"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1547579333, "post_id": 54205305, "comment_id": 95237430, "body": "You can right-click on any module and export it to a text file.  Or use a tool such as MZTools which has a &quot;code library&quot; feature."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1547581724, "post_id": 54205305, "comment_id": 95238367, "body": "@Close-Voters: this question is in no way asking about a tool or book or other off-site resource. It is about features of the Visual Basic Editor, the IDE for VBA - IDE questions are perfectly on-topic. The &quot;tool&quot; part is in no way central to the question, and was edited out."}, {"owner": {"reputation": 19, "user_id": 10875002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a3bad97e201b08028d48899f8082ff?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Avidan", "link": "https://stackoverflow.com/users/10875002/dan-avidan"}, "edited": false, "score": 0, "creation_date": 1547630346, "post_id": 54205305, "comment_id": 95253239, "body": "Can&#39;t find the option to export to a txt file. Only to the vba format."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1547581457, "creation_date": 1547581457, "answer_id": 54205819, "question_id": 54205305, "link": "https://stackoverflow.com/questions/54205305/making-dictionary/54205819#54205819", "title": "Making &quot;dictionary&quot;", "body": "<p>Yes. Simply select <strong>Export File...</strong> from the <em>Project Explorer</em> toolwindow:</p>\n\n<p><img src=\"https://i.stack.imgur.com/rzIHy.png\" alt=\"vanilla functionality\"></p>\n\n<p>If you're using <a href=\"http://www.github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">Rubberduck</a> (disclaimer: I manage this OSS project), you can also do that from the <em>Code Explorer</em> toolwindow:</p>\n\n<p><img src=\"https://i.stack.imgur.com/6iBii.png\" alt=\"Rubberduck functionality\"></p>\n\n<p>To use the exported module(s) in other VBA projects, you'll need to <strong>Import</strong> it back. You can do that one file at a time with the VBE's <em>Project Explorer</em>, or all files at once with Rubberduck's <em>Code Explorer</em>.</p>\n\n<p>Or you can simply drag-and-drop the files into the <em>Project Explorer</em>.</p>\n\n<p>Standard modules will have a .bas file extension; Class modules will have .cls; UserForm modules will have a .frm file and likely a .frx binary that needs to be in the same folder as the .frm for it to import back correctly.</p>\n\n<p>Document modules (e.g. workbook and worksheet modules, like <code>Sheet1</code> and <code>ThisWorkbook</code>) can't be imported, but you can export them as .cls files from the <em>Project Explorer</em>, or as .doccls files from Rubberduck.</p>\n\n<p>The reason Rubberduck exports document modules with a different file extension, is because they can't be imported back, so module and member attributes (which you can only discover by opening the exported files in a text editor e.g. Notepad++) can't be tweaked the same way normal class modules can.</p>\n"}], "owner": {"reputation": 19, "user_id": 10875002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a3bad97e201b08028d48899f8082ff?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Avidan", "link": "https://stackoverflow.com/users/10875002/dan-avidan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1547581819, "creation_date": 1547579085, "last_edit_date": 1547581819, "question_id": 54205305, "link": "https://stackoverflow.com/questions/54205305/making-dictionary", "title": "Making &quot;dictionary&quot;", "body": "<p>I have a lot of code I wrote, for various different projects.</p>\n\n<p>I want to save them in 1 file, to have like a \"repository\" of working code modules. So for new VBA projects I can copy the modules from there.</p>\n\n<p>Is there a way to save the code files outside of the VBA editor? Like a text file or something like that?</p>\n"}, {"tags": ["arrays", "excel", "vba", "for-loop", "if-statement"], "comments": [{"owner": {"reputation": 1796, "user_id": 1591041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7cdc283788ab7a4aa092416939414a0?s=128&d=identicon&r=PG", "display_name": "krsteeve", "link": "https://stackoverflow.com/users/1591041/krsteeve"}, "edited": false, "score": 0, "creation_date": 1547579307, "post_id": 54205158, "comment_id": 95237418, "body": "Can you add information about the error you&#39;re getting?"}], "answers": [{"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1547579392, "post_id": 54205344, "comment_id": 95237449, "body": "Consider using <b>Cells(i,8)</b> rather than <b>Range(i,8)</b>"}, {"owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1547579479, "post_id": 54205344, "comment_id": 95237491, "body": "@Gary&#39;sStudent Thanks for the spot check."}, {"owner": {"reputation": 67, "user_id": 10918598, "user_type": "registered", "profile_image": "https://graph.facebook.com/2329969930369485/picture?type=large", "display_name": "Paige Hilliard", "link": "https://stackoverflow.com/users/10918598/paige-hilliard"}, "edited": false, "score": 0, "creation_date": 1547579605, "post_id": 54205344, "comment_id": 95237544, "body": "@TateGarringer Thank you both! But it&#39;s still not working for me, I&#39;m getting an error of &quot;mismatch&quot; and it highlights the 4th line of code (with If)"}, {"owner": {"reputation": 67, "user_id": 10918598, "user_type": "registered", "profile_image": "https://graph.facebook.com/2329969930369485/picture?type=large", "display_name": "Paige Hilliard", "link": "https://stackoverflow.com/users/10918598/paige-hilliard"}, "edited": false, "score": 0, "creation_date": 1547579663, "post_id": 54205344, "comment_id": 95237565, "body": "Sub PleaseWork()      Dim i As Double, j As Double          &#39;Worksheets(&quot;Calculations&quot;).Range(&quot;H33&quot;).Value = &quot;Hi&quot;       For i = 26 To 33         &#39;For j = 8 To 8             If Worksheets(&quot;Calculations&quot;).Range(i, 8) = &quot;Yes&quot; Then Or &quot;No Requirement&quot; Then                 Worksheets(&quot;Calculations&quot;).Range(&quot;H33&quot;).Value = &quot;Yes&quot;             Else                 Worksheets(&quot;Calculations&quot;).Range(&quot;H33&quot;).Value = &quot;No&quot;             End If         Next i                         End Sub"}, {"owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "edited": false, "score": 0, "creation_date": 1547579712, "post_id": 54205344, "comment_id": 95237589, "body": "<code>Or &quot;No Requirement&quot;</code> needs to be <code>Or Worksheets(&quot;Calculations&quot;).Cells(i, 8) = &quot;No Requirement&quot;</code>"}, {"owner": {"reputation": 1352, "user_id": 10814503, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QsZ5pJcPoLg/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jT3DgOvSVgL4Sa6iCfK8mLTYcOsw/mo/photo.jpg?sz=128", "display_name": "Angel M.", "link": "https://stackoverflow.com/users/10814503/angel-m"}, "edited": false, "score": 0, "creation_date": 1547580012, "post_id": 54205344, "comment_id": 95237709, "body": "Also, remove line Dim matrix(i, j) As Double as you are defining a variable that is never used and cause error"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1547580072, "post_id": 54205344, "comment_id": 95237739, "body": "Nice job! <i>(+1)</i>"}], "tags": [], "owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "is_accepted": false, "score": 1, "last_activity_date": 1547579539, "last_edit_date": 1547579539, "creation_date": 1547579268, "answer_id": 54205344, "question_id": 54205158, "link": "https://stackoverflow.com/questions/54205158/if-statement-within-a-for-loop/54205344#54205344", "title": "If statement within a For-Loop", "body": "<p><code>Next i</code> needs to be outside your <code>If-End If</code> and you'd need to add <code>Next j</code> within your <code>For i</code> loop for the code to even run. Additionally, if <code>j = 8</code> your second loop will only ever run once and you can eliminate that entirely.</p>\n\n<p>it would be much easier to say</p>\n\n<pre><code>For i = 26 To 33\n    If Worksheets(\"Calculations\").Cells(i, 8) = \"Yes\" Or Worksheets(\"Calculations\").Cells(i, 8) = \"No Requirement\" Then\n        Worksheets(\"Calculations\").Range(\"H33\").Value = \"Yes\"\n    Else\n        Worksheets(\"Calculations\").Range(\"H33\").Value = \"No\"\n    End If\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 370, "user_id": 9864779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fdaba5974f4b2af45b2cf1c0d870564?s=128&d=identicon&r=PG&f=1", "display_name": "visualnotsobasic", "link": "https://stackoverflow.com/users/9864779/visualnotsobasic"}, "is_accepted": false, "score": 0, "last_activity_date": 1547580310, "last_edit_date": 1547580310, "creation_date": 1547579963, "answer_id": 54205502, "question_id": 54205158, "link": "https://stackoverflow.com/questions/54205158/if-statement-within-a-for-loop/54205502#54205502", "title": "If statement within a For-Loop", "body": "<p>I'm not sure why you'd use a matrix here if you're just looking through the one column.</p>\n\n<p>The below code will check through the column (I can make it a dynamic range if you so choose) and stop at the first cell with value \"No Requirement\" - it then outputs the address of the cell with the value and \"No\" and exits the loop.</p>\n\n<pre><code>Sub RandomCol()\n\nFor Each cell In Worksheets(\"Calculations\").Range(\"A1:A50\")\n\n    If cell.Value = \"Yes\" Or cell.Value = \"No Requirement\" Then\n\n    ElseIf cell.Value = \"No\" Then\n        Range(\"H33\").Value = (cell.Address + \" \" + \"No\")\n        Exit For\n    End If\n\nNext cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "is_accepted": false, "score": 0, "last_activity_date": 1548221994, "creation_date": 1548221994, "answer_id": 54320646, "question_id": 54205158, "link": "https://stackoverflow.com/questions/54205158/if-statement-within-a-for-loop/54320646#54320646", "title": "If statement within a For-Loop", "body": "<p>I hope this helps.</p>\n\n<p>The following should work for you purposes:</p>\n\n<pre><code>    Sub RunIt()\n      '          A, E, 1, 5\n      PleaseWork 1, 5, 1, 5\n    End Sub\n\n    Sub PleaseWork(intFromCol As Integer, intToCol As Integer, intFromRow As Integer, _\n                   intToRow As Integer)\n\n        Dim intI As Integer\n        Dim intJ As Integer\n        Dim blnFoundNo As Boolean\n        Dim strOut As String\n\n        strOut = \"Yes\"\n        blnFoundNo = False\n        For intI = intFromCol To intToCol\n            For intJ = intFromRow To intToRow\n                '                                     Row , Col\n                With Worksheets(\"Calculations\").Cells(intJ, intI)\n                    If LCase(Trim(.Value)) = \"no\" Then\n                        strOut = Replace(Cstr(.Address), \"$\", \"\") &amp; \" = No\"\n                        blnFoundNo = True\n                        Exit For\n                    End If\n                End With\n            Next intJ\n            If blnFoundNo Then Exit For\n        Next intI\n\n        Worksheets(\"Calculations\").Range(\"H33\").Value = strOut\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 10918598, "user_type": "registered", "profile_image": "https://graph.facebook.com/2329969930369485/picture?type=large", "display_name": "Paige Hilliard", "link": "https://stackoverflow.com/users/10918598/paige-hilliard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1548221994, "creation_date": 1547578319, "question_id": 54205158, "link": "https://stackoverflow.com/questions/54205158/if-statement-within-a-for-loop", "title": "If statement within a For-Loop", "body": "<p>I'm trying to have a for loop go through a column to find \"No\" and if \"No\" is not found it outputs \"Yes\" in a different cell. So my thought process is having the for-loop and then an if statement saying that if the cell says \"Yes\" or \"No Requirement\" then it continues looking for a \"No\" and if a \"No\" isn't found it outputs \"Yes\" and if it is found the loop stops and it outputs \"No\". </p>\n\n<p>I'm making a tool to pull data from different sheets on the same excel workbook. </p>\n\n<pre><code>Sub PleaseWork()\n\nDim matrix(i, j) As Double\n\n\nFor i = 26 To 33\n    For j = 8 To 8\n        If Worksheets(\"Calculations\").Range(i, j) = \"Yes\" Or \"No Requirement\" Then\n            Worksheets(\"Calculations\").Range(\"H33\").Value = \"Yes\"\n            Next i\n        Else\n            Worksheets(\"Calculations\").Range(\"H33\").Value = \"No\"\n        End If\n\n\n\nEnd Sub\n</code></pre>\n\n<p>This code won't even run, I get a compile error every time I try to run it. I'm new to VBA and know this is probably super easy but I just can't seem to get it. </p>\n"}, {"tags": ["excel", "vba", "excel-2016"], "comments": [{"owner": {"reputation": 1352, "user_id": 10814503, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QsZ5pJcPoLg/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jT3DgOvSVgL4Sa6iCfK8mLTYcOsw/mo/photo.jpg?sz=128", "display_name": "Angel M.", "link": "https://stackoverflow.com/users/10814503/angel-m"}, "edited": false, "score": 3, "creation_date": 1547580105, "post_id": 54205104, "comment_id": 95237749, "body": "Hi &amp; welcome to Stack Overflow! This forum is not for questions about technologies or to find somebody doing the work for free (search some freelance service for that). See <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/mcve\">Create Minimal Complete and Verifiable Example</a> for ideas about what kind of questions can be made and how to ask."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10918571"}, "edited": false, "score": 0, "creation_date": 1547583231, "post_id": 54205343, "comment_id": 95239013, "body": "This works great, thanks! Is there any way the code can be adapted so that when the data is transferred to the new sheet, formatting is not copied? (e.g. cell shading)"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1547587350, "post_id": 54205343, "comment_id": 95240633, "body": "Instead of <code>SourceSheet.Range(SourceSheet.Cells(SourceRow, 2), SourceSheet.Cells(SourceRow, 5)).Copy  DestinationSheet.Cells(DestinationRow, 2)</code> use <code>DestinationSheet.Cells(DestinationRow, 2).Value = SourceSheet.Range(SourceSheet.Cells(SourceRow, 2), SourceSheet.Cells(SourceRow, 5)).Value</code>"}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1547653229, "post_id": 54205343, "comment_id": 95266744, "body": "@chris, I also prefer direct range assignment over clipboard copies, but as the source range is larger (4 cells) than the destination range (1 cell), your proposal would only copy the first cell content."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1547661117, "post_id": 54205343, "comment_id": 95271167, "body": "@Asher fair enough, I hadn&#39;t noticed that.  But then I&#39;d apply a <code>Resize</code> to the destination"}], "tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": true, "score": 0, "last_activity_date": 1547671959, "last_edit_date": 1547671959, "creation_date": 1547579265, "answer_id": 54205343, "question_id": 54205104, "link": "https://stackoverflow.com/questions/54205104/how-can-i-copy-range-from-sheet-to-sheet-based-on-column-value/54205343#54205343", "title": "How can I copy range from sheet to sheet based on column value?", "body": "<pre><code>Private Sub CopySomeCells()\n    Dim SourceSheet As Worksheet\n    Dim DestinationSheet As Worksheet\n    Dim SourceRow As Long\n    Dim DestinationRow As Long\n\n    Set SourceSheet = ActiveWorkbook.Sheets(2)\n    Set DestinationSheet = ActiveWorkbook.Sheets(1)\n\n    DestinationRow = 8\n    For SourceRow = 2 To SourceSheet.UsedRange.Rows.Count\n        If SourceSheet.Range(\"AK\" &amp; SourceRow).Value &gt; 0 Then\n            SourceSheet.Range(SourceSheet.Cells(SourceRow, 2), SourceSheet.Cells(SourceRow, 5)).Copy _\n                DestinationSheet.Cells(DestinationRow, 2)\n            DestinationRow = DestinationRow + 1\n        End If\n    Next SourceRow\n    Application.CutCopyMode = False\n\n    Set SourceSheet = Nothing\n    Set DestinationSheet = Nothing\nEnd Sub\n</code></pre>\n\n<p>If you just want to paste the values (and not the format) then change two rows by this:</p>\n\n<pre><code>SourceSheet.Range(SourceSheet.Cells(SourceRow, 2), SourceSheet.Cells(SourceRow, 5)).Copy\nDestinationSheet.Cells(DestinationRow, 2).PasteSpecial Paste:=xlPasteValues\n</code></pre>\n\n<p>Or better by this (faster and without clipboard):</p>\n\n<pre><code>DestinationSheet.Cells(DestinationRow, 2).Resize(1, 4).Value = _\n    SourceSheet.Cells(SourceRow, 2).Resize(1, 4).Value\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10918571"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 54205343, "answer_count": 1, "score": 0, "last_activity_date": 1547671959, "creation_date": 1547578048, "last_edit_date": 1547622275, "question_id": 54205104, "link": "https://stackoverflow.com/questions/54205104/how-can-i-copy-range-from-sheet-to-sheet-based-on-column-value", "title": "How can I copy range from sheet to sheet based on column value?", "body": "<p>I am trying to copy a specified range of cells from one sheet (Sheet2) to a specified range of cells in another sheet (Sheet1) based on a condition. There are hundreds of rows of data, and I would like VBA code that looks at each row, and if the condition is met for that row, copies the specified cell range from sheet2 to sheet1. It is not the entire row being copied, just four cells out of a row with many more cells that contain data.</p>\n\n<p>In more specific terms, I would like to copy columns B through E for each row (starting at row 2) IF the value in column AK for each row is greater than 0. I would like for this data to be pasted into columns B through E in sheet1, starting at row 8. So, for example, if row 2 in Sheet 2 meets the criteria, I would like for B2 through E2 in sheet 2 to be copied to B8 through E8 in sheet 1. </p>\n\n<p>I have tried to adapt code found in other questions on StackOverFlow and other sources but I am very new to VBA and have not been successful. Any help would be greatly appreciated.</p>\n"}, {"tags": ["javascript", "excel", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1547576368, "post_id": 54204465, "comment_id": 95236170, "body": "It&#39;s possible that <code>tbltems</code> gets re-drawn and your <code>allLinks</code> collection then points to nothing (since those original elements are now gone from the page).  You might need to refresh that collection each time through the link and use a counter to keep track of where you are in the table."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1547576477, "post_id": 54204465, "comment_id": 95236205, "body": "Store the URLs of <code>allLinks</code> in a collection or array <i>before</i> you start navigating them - iterate that collection of string URLs, it won&#39;t be tied to <code>appIE.document</code> anymore."}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1547603176, "post_id": 54204465, "comment_id": 95244959, "body": "Can you please inform us, What changes occurred in the original window after the code clicks on popup and close the another window? How many links are in your web page and how many of them are empty? Can you please provide a sample HTML page that we can run with the above VBA code? It may help to narrow down the issue."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547615724, "post_id": 54204465, "comment_id": 95247607, "body": "Can you share the url?"}, {"owner": {"reputation": 37, "user_id": 10292234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d03925dfd265b9b15ab2c4ad8b2b2041?s=128&d=identicon&r=PG&f=1", "display_name": "Emein", "link": "https://stackoverflow.com/users/10292234/emein"}, "edited": false, "score": 0, "creation_date": 1547659438, "post_id": 54204465, "comment_id": 95270341, "body": "I can&#39;t share the site it&#39;s on our intranet. I&#39;m going to work it later today. I think Tim is right and the table gets re-drawn so I lose all of my values. I&#39;ll try a counter and see if I can get it working."}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 1, "creation_date": 1548057603, "post_id": 54204465, "comment_id": 95392203, "body": "@Emein, Is your issue solved? If yes, Can you please share the solution? If not, Can you inform us the current status for your issue. We will try to provide further suggestions."}, {"owner": {"reputation": 37, "user_id": 10292234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d03925dfd265b9b15ab2c4ad8b2b2041?s=128&d=identicon&r=PG&f=1", "display_name": "Emein", "link": "https://stackoverflow.com/users/10292234/emein"}, "edited": false, "score": 0, "creation_date": 1548272997, "post_id": 54204465, "comment_id": 95486765, "body": "I did get it to work. The &quot;Exit For&quot; at the end of the If statement was kicking it all the way out so I was losing my allLinks I commented it out and it&#39;s fine now. I  but I have another issue with it on the last loop it wont do the last click."}], "owner": {"reputation": 37, "user_id": 10292234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d03925dfd265b9b15ab2c4ad8b2b2041?s=128&d=identicon&r=PG&f=1", "display_name": "Emein", "link": "https://stackoverflow.com/users/10292234/emein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1548347731, "creation_date": 1547575184, "last_edit_date": 1548347731, "question_id": 54204465, "link": "https://stackoverflow.com/questions/54204465/having-trouble-with-a-vba-for-loop", "title": "Having trouble with a VBA For loop", "body": "<p>So this there is a JavaScript table generated on a web page that I'm trying to loop through and click the links. The links open a popup and then the VBA clicks a button in the pop up that updates and closes the window. It works perfectly for the first popup but when it hits the last line \"Next link\" it goes back up to the <code>For</code> but the variable for \"link\" is empty but there are 2 more links and it throws an error because link = empty. </p>\n\n<p>I have made another simple loop that just cycles through links in <code>allLinks</code> to make sure it's seeing them and it does work so they are loaded. </p>\n\n<p>I would be grateful for any help thanks for everyone's time. </p>\n\n<p>Oh and the <code>Application.Wait</code>'s are temporary I will replace them with <code>Do While</code> when I get this guy running right. </p>\n\n<p>It looks like link loses it's properties after the button click on\n<code>wd.document.getElementById(\"btnAddItem\").Click</code></p>\n\n<pre><code>Set allLinks = appIE.document.getElementById(\"tblItems\").getElementsByTagName(\"a\")\nFor Each link In allLinks\n    appIE.Navigate link\n    Application.Wait (Now + TimeValue(\"0:00:03\"))\n\n    For Each wd In CreateObject(\"Shell.Application\").Windows\n        If wd = \"Internet Explorer\" Then\n            If InStr(UCase(wd.document.Title), \"ITEM\") &lt;&gt; 0 Then\n                Application.Wait (Now + TimeValue(\"0:00:01\"))\n                wd.document.getElementById(\"btnAddItem\").Click\n                Application.Wait (Now + TimeValue(\"0:00:01\"))\n\n                Exit For\n\n            End If\n        End If\n    Next wd\nNext link\n</code></pre>\n\n<p>I just had to Comment out the Exit For it was kicking out of both for loops</p>\n\n<pre><code>Set allLinks = appIE.document.getElementById(\"tblItems\").getElementsByTagName(\"a\")\nFor Each link In allLinks\n    appIE.Navigate link\n    Application.Wait (Now + TimeValue(\"0:00:03\"))\n\n    For Each wd In CreateObject(\"Shell.Application\").Windows\n        If wd = \"Internet Explorer\" Then\n            If InStr(UCase(wd.document.Title), \"ITEM\") &lt;&gt; 0 Then\n                Application.Wait (Now + TimeValue(\"0:00:01\"))\n                wd.document.getElementById(\"btnAddItem\").Click\n                Application.Wait (Now + TimeValue(\"0:00:01\"))\n\n                'Exit For\n\n            End If\n        End If\n    Next wd\nNext link\n</code></pre>\n"}, {"tags": ["excel", "vba", "listbox", "userform"], "comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1547574705, "post_id": 54204164, "comment_id": 95235406, "body": "The <code>.AddItem</code> method has a limitation and Default set of only 10 columns in your <code>.List</code>; as it is zero-based you can only add up to <code>.List(x, 9)</code>.  Use the array method instead. Will add this as answer later :-)"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1547585294, "post_id": 54204164, "comment_id": 95239822, "body": "Added the promised solution via the <b>array method</b> and the relatively unknown listbox <code>.Column</code> property which might be helpful for other readers, too."}], "answers": [{"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1547671462, "post_id": 54206396, "comment_id": 95275971, "body": "Would appreciate your feedback and possible acceptance/upvote. Allow me a remark as you already posed 33 questions with a low percentage of acceptance: It&#39;s good use and also helpful for other readers to mark a valid answer as accepted if you found it helpful (acceptance is indicated by a colored checkmark next to the answer). C.f. <a href=\"https://stackoverflow.com/help/someone-answers\">&quot;Someone answers&quot;</a>"}], "tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1547584317, "creation_date": 1547584317, "answer_id": 54206396, "question_id": 54204164, "link": "https://stackoverflow.com/questions/54204164/listbox-error-could-not-set-the-list-property-invalid-property-value/54206396#54206396", "title": "Listbox Error &quot; Could not Set the List property. Invalid Property Value.&quot;", "body": "<p><strong>Array method overcoming 10 columns limitation</strong></p>\n\n<p>The <code>.AddItem</code> method has a limitation and default setting of only <strong>10 columns</strong> that can be created in a Listbox (or Combobox); <code>List</code> indices are zero-based, you can only add up to <code>.List(x, 9)</code>. </p>\n\n<p>If you want to overcome this built in restriction you have to used the <em>Array method</em> allowing to assign a whole array to the <code>.List</code> property in one statement. </p>\n\n<p>As you are increasing the listbox row elements with each event click in order to add new control values, you have to redimension the whole data set by one new row element. </p>\n\n<p>A <code>ReDim Preserve</code> statement, however, can only be executed in its last dimension. So you'll have to use a 2-dim array where the 'row' index follows after the invariable 'column' index to provide a correctly dimensioned array. </p>\n\n<p><strong>Trick:</strong> Instead of re-transposing this array and assigning it back to the listboxes <code>.List</code> property, you can use the <code>.Column</code> property instead which already accepts the inverted (=transposed) dimension order.</p>\n\n<p><strong>Example code</strong></p>\n\n<p>Added a control names string for further convenience, as it allows to get the used control values in a loop via the <code>Controls</code> collection which allows to reference them by name.</p>\n\n<pre><code>Private Sub cmdSave_Click()\n' Define a control names string to be used to append to Listbox1\n  Const USEDCONTROLS$ = \"txtdate,txtgrouphead,txtcontrolhead,cmbaccounthead,cmbtrans,txtamount\"\n  Dim x&amp;, i&amp;, v, myCtrls\n  myCtrls = Split(USEDCONTROLS, \",\")        ' create flat array myCtrls out of control names\n\n  x = Me.ListBox1.ListCount                 ' get current list count\n\nIf Me.cmbtrans.value = \"Debit\" Then\n  With Me.ListBox1\n    .Enabled = True\n    .ColumnWidths = \"49.95 pt;10 pt;114.95 pt;10 pt;114.95 pt;10 pt;114.95 pt;10 pt;75 pt;10 pt;49.95 pt;10 pt;49.95 pt\"\n    .ColumnCount = 13\n\n    If .ListCount &gt; 0 Then\n       ' [1] write existing listbox elements to array(column index, row index)\n         v = .Column\n       ' [2] increment to new row index x in 2nd (sic!) dimension\n       '     as a ReDim Preserve can only change the last array dimension.\n       '     (with the .Column property you are using the\n       '     transposed counterpart of the .List property)\n         ReDim Preserve v(UBound(v), x)\n    Else\n       ' [1-2] redimension array v the first time (no existing listbox values so long)\n         ReDim v(.ColumnCount - 1, 0)           ' 13 counted columns equal a zerobased index of 12\n    End If\n\n    ' [3a] assign current values to array\n      For i = 0 To UBound(myCtrls)\n          v(i * 2, x) = Me.Controls(myCtrls(i))\n      Next i\n    ' [3b] write separators after each data input\n      For i = 1 To UBound(v) - 1 Step 2: v(i, x) = \"|\": Next i\n\n    ' [4] reassign array to listbox property .Column (~ transposed .List property)\n    .Column = v\n  End With\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 4768600, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d2a65f7a22db523ca8fbd651be01e011?s=128&d=identicon&r=PG&f=1", "display_name": "Salman Khan", "link": "https://stackoverflow.com/users/4768600/salman-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2827, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1547584317, "creation_date": 1547573876, "last_edit_date": 1547578145, "question_id": 54204164, "link": "https://stackoverflow.com/questions/54204164/listbox-error-could-not-set-the-list-property-invalid-property-value", "title": "Listbox Error &quot; Could not Set the List property. Invalid Property Value.&quot;", "body": "<p>I have userform with a Listbox, textbox and comboboxes and a Save button. Below is my save button code.</p>\n\n<pre><code>Private Sub cmdsave_Click()\nDim x As Integer\n        x = Me.ListBox1.ListCount\n\nIf Me.cmbtrans.Value = \"Debit\" Then\n    With Me.ListBox1\n        .Enabled = True\n        .ColumnCount = 13\n        .ColumnWidths = \"49.95 pt;10 pt;114.95 pt;10 pt;114.95 pt;10 pt;114.95 pt;10 pt;75 pt;10 pt;49.95 pt;10 pt;49.95 pt\"\n            .AddItem\n            .List(x, 0) = Me.txtdate\n            .List(x, 1) = \"|\"\n            .List(x, 2) = Me.txtgrouphead\n            .List(x, 3) = \"|\"\n            .List(x, 4) = Me.txtcontrolhead\n            .List(x, 5) = \"|\"\n            .List(x, 6) = Me.cmbaccounthead\n            .List(x, 7) = \"|\"\n            .List(x, 8) = Me.cmbtrans\n            .List(x, 9) = \"|\"\n            .List(x, 10) = Me.txtamount\n      End With\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>It shows the error at the Add item Level <code>.List(x, 10) = Me.txtamount</code>.\nhowever, it runs smoothly till add item level <code>.List(x, 9) = \"|\"</code>.</p>\n\n<p>I am unable to understand why it is giving error at last line.</p>\n"}, {"tags": ["excel", "vba", "null"], "comments": [{"owner": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 0, "creation_date": 1547573637, "post_id": 54204067, "comment_id": 95234893, "body": "Like the actual &quot;Nul&quot;? Try Char 0."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1547573645, "post_id": 54204067, "comment_id": 95234895, "body": "Did you try using the <code>Asc</code> function to identify the characters&#39; code number?"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1547573749, "post_id": 54204067, "comment_id": 95234945, "body": "That website shows you the hexadecimal character codes, what are they for your data?"}, {"owner": {"reputation": 1531, "user_id": 1058210, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ae4c04e0b159f7eb2ccfd8bfd083f832?s=128&d=identicon&r=PG", "display_name": "user1058210", "link": "https://stackoverflow.com/users/1058210/user1058210"}, "edited": false, "score": 1, "creation_date": 1547574019, "post_id": 54204067, "comment_id": 95235085, "body": "the asc function is saying it is 160"}, {"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 0, "creation_date": 1547598673, "post_id": 54204067, "comment_id": 95244057, "body": "VBA doesn&#39;t use ASCII (as evidenced by <code>Asc</code> returning 160, which is greater than 127). It uses UTF-16. Use <code>AscW</code> because <code>Asc</code> doesn&#39;t do what you think it does. You are lucky this time that it returns the same value as <code>AscW</code>. (And, use <code>ChrW</code>/<code>ChrW$</code> instead of <code>Chr</code>/<code>Chr$</code>.)"}], "answers": [{"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 1, "last_activity_date": 1547575013, "last_edit_date": 1547575013, "creation_date": 1547574452, "answer_id": 54204290, "question_id": 54204067, "link": "https://stackoverflow.com/questions/54204067/vba-identifying-null-string/54204290#54204290", "title": "VBA - Identifying null string", "body": "<h1>Chr(160) Issue</h1>\n\n<p>160 is the code number of a <strong>Non-Breaking Space</strong>.</p>\n\n<p>Let us say the cell is A1.</p>\n\n<p>In any cell write <code>=CODE(A1)</code> and in another (e.g. next to) write <code>=CODE(MID(A1,2,1))</code>.</p>\n\n<p>The results are the code numbers (integers e.g. a and b) of the characters.</p>\n\n<p>Now in VBA you can use:</p>\n\n<pre><code>If Cells(1, 1) = Chr(a) &amp; Chr(b) Then\n\nEnd If \n</code></pre>\n\n<p>or e.g.</p>\n\n<pre><code>If Left(Cells(1, 1), 1) = Chr(160) then\n\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1547576472, "post_id": 54204469, "comment_id": 95236199, "body": "Could you explain the use of the $ sign in Trim$ and Chr$?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 1, "creation_date": 1547576555, "post_id": 54204469, "comment_id": 95236239, "body": "@VBasic2008 <code>Trim</code> takes and returns a <code>Variant</code>. <code>Trim$</code> takes and returns a <code>String</code>. They&#39;re aliases. Internally in VBA7.DLL, <code>Trim</code> invokes <code>B_VAR_TRIM</code>, while <code>Trim$</code> invokes <code>B_STR_TRIM</code>."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 4, "last_activity_date": 1547575188, "creation_date": 1547575188, "answer_id": 54204469, "question_id": 54204067, "link": "https://stackoverflow.com/questions/54204067/vba-identifying-null-string/54204469#54204469", "title": "VBA - Identifying null string", "body": "<p>A string value that \"appears to be blank but has a length of 2 characters\" is said to be <em>whitespace</em>, not <em>blank</em>, not <em>null</em>, not <em>empty</em>.</p>\n\n<p>Use the <code>Trim</code> function (or its <code>Trim$</code> stringly-typed little brother) to strip leading/trailing whitespace characters, then test the result against <code>vbNullString</code> (or <code>\"\"</code>):</p>\n\n<pre><code>If Trim$(value) = vbNullString Then\n</code></pre>\n\n<p>The <code>Trim</code> function won't strip non-breaking spaces though. You can write a function that does:</p>\n\n<pre><code>Public Function TrimStripNBSP(ByVal value As String) As String\n    TrimStripNBSP = Trim$(Replace(value, Chr$(160), Chr$(32)))\nEnd Function\n</code></pre>\n\n<p>This replaces non-breaking spaces with ASCII 32 (a \"normal\" space character), then trims it and returns the result.</p>\n\n<p>Now you can use it to test against <code>vbNullString</code> (or <code>\"\"</code>):</p>\n\n<pre><code>If TrimStripNBSP(value) = vbNullString Then\n</code></pre>\n\n<p>The <code>IsEmpty</code> function can only be used with a <code>Variant</code> (only returns a meaningful result given a <code>Variant</code> anyway), to determine whether that variant contains a value.</p>\n\n<p>The <code>IsNull</code> function has extremely limited use in Excel-hosted VBA, and shouldn't be needed since nothing is ever going to be <code>Null</code> in an Excel worksheet - especially not a string with a length of 2.</p>\n"}], "owner": {"reputation": 1531, "user_id": 1058210, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ae4c04e0b159f7eb2ccfd8bfd083f832?s=128&d=identicon&r=PG", "display_name": "user1058210", "link": "https://stackoverflow.com/users/1058210/user1058210"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1196, "favorite_count": 0, "accepted_answer_id": 54204469, "answer_count": 2, "score": 3, "last_activity_date": 1547621910, "creation_date": 1547573568, "last_edit_date": 1547621910, "question_id": 54204067, "link": "https://stackoverflow.com/questions/54204067/vba-identifying-null-string", "title": "VBA - Identifying null string", "body": "<p>One of my cells appears to be blank but has a length of 2 characters.  I copied the string to <a href=\"http://onlinecalculators.brainmeasures.com/Conversions/StringtoAsciiCalculator.aspx\" rel=\"nofollow noreferrer\">this</a> website and it has identified it as a null string.</p>\n\n<p>I have tried using <code>IsNull</code> and <code>IsEmpty</code>, as well as testing to see if it is equivalent to the <code>vbNullString</code> but it is still coming up as <code>False</code>.</p>\n\n<p>How do I identify this string as being <code>Null</code>?  </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 2, "creation_date": 1547573315, "post_id": 54203935, "comment_id": 95234741, "body": "Changing the expression to <code>\\d+\\.?(\\d?)+</code> will allow for multiple optional digits after the decimal"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1547574056, "post_id": 54203935, "comment_id": 95235104, "body": "@Sam I utilized Regular Expression based solution to be more familiar with Regular Expressions among various alternatives in the linked SO post. Can you throw more color on this approach vs other approaches in the linked post."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1547574567, "post_id": 54203935, "comment_id": 95235345, "body": "Getting fluent in regular expressions is a good enough reason to use it in many cases. Splitting (as @alex-k &#39;s example) is probably easier to read and I could go for either. Oftentimes I pick regexp if there are other uses for it in the same system, and avoid it if there is only a single place where it could be used."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1547574778, "post_id": 54203935, "comment_id": 95235455, "body": "@Sam Thanks for your frank and clear opinion. I would like to do little bit more of testing before deciding on either of the approaches."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1547577200, "post_id": 54203935, "comment_id": 95236503, "body": "@Sam Thanks for leading me to the right direction. I also feel getting fluent in regular expressions is a good enough reason to use it in many cases"}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": true, "score": 2, "last_activity_date": 1547573520, "last_edit_date": 1547573520, "creation_date": 1547573014, "answer_id": 54203935, "question_id": 54203687, "link": "https://stackoverflow.com/questions/54203687/to-get-appropriate-maximum-number-from-a-string/54203935#54203935", "title": "To get appropriate maximum number from a string", "body": "<p>There are one or two issues with your code. The first one is that the regular expression isn't looking for decimal numbers. If you change it to</p>\n\n<pre><code>.Pattern = \"\\d+\\.?(\\d?)+\"\n</code></pre>\n\n<p>it will work better. In short:<br>\n\\d+ = At least one digit<br>\n.? = An optional dot<br>\n(\\d?)+ = Optional numbers  </p>\n\n<p>This is not a waterproof expression, but it works to some extent at least.</p>\n\n<p>The second issue is the potential problem of differing decimal symbols, in which case you will need to do some search and replace before processing.</p>\n"}, {"comments": [{"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1547577110, "post_id": 54204029, "comment_id": 95236462, "body": "Your solution gives correct results for original stated sample data string. Since this solution utilizes <code>InStr(tokens(i), &quot;=&quot;)</code> in code it may limit flexibility in case <code>=</code> signs get omitted in some data strings. Thanks for your kind indulgence. However I am opting for a regex based solution to get more fluent on regex based solutions."}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1547573409, "creation_date": 1547573409, "answer_id": 54204029, "question_id": 54203687, "link": "https://stackoverflow.com/questions/54203687/to-get-appropriate-maximum-number-from-a-string/54204029#54204029", "title": "To get appropriate maximum number from a string", "body": "<p>If its always <em>x=number</em> I think it's simpler to loop over each delimited value then read past the <code>=</code> for the value:</p>\n\n<pre><code>Function MaxValue(data As String)\n    Dim i As Long, value As Double\n    Dim tokens() As String: tokens = Split(data, \",\")\n\n    For i = 0 To UBound(tokens)\n        '// get the value after = as a double\n        value = CDbl(Trim$(Mid$(tokens(i), InStr(tokens(i), \"=\") + 1)))\n        If (value &gt; MaxValue) Then MaxValue = value\n    Next\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1547576828, "post_id": 54204277, "comment_id": 95236347, "body": "Your solution gives correct results even if equal sign before the numeric values are omitted. Thanks for your kind indulgence. However I am opting for a regex based solution to get more fluent on regex based solutions."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1547574403, "creation_date": 1547574403, "answer_id": 54204277, "question_id": 54203687, "link": "https://stackoverflow.com/questions/54203687/to-get-appropriate-maximum-number-from-a-string/54204277#54204277", "title": "To get appropriate maximum number from a string", "body": "<p>Without <code>Regex</code>:</p>\n\n<pre><code>Public Function maxNums(str As String) As Double\n    Dim i As Long, L As Long, s As String, wf As WorksheetFunction, brr()\n    Set wf = Application.WorksheetFunction\n    L = Len(str)\n\n    For i = 1 To L\n        s = Mid(str, i, 1)\n        If s Like \"[0-9]\" Or s = \".\" Then\n        Else\n            Mid(str, i, 1) = \" \"\n        End If\n    Next i\n\n    str = wf.Trim(str)\n    arr = Split(str, \" \")\n\n    ReDim brr(LBound(arr) To UBound(arr))\n\n    For i = LBound(arr) To UBound(arr)\n        brr(i) = CDbl(arr(i))\n    Next i\n\n    maxNums = wf.Max(brr)\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/K4xSL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K4xSL.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 54203935, "answer_count": 3, "score": 0, "last_activity_date": 1547574403, "creation_date": 1547572081, "question_id": 54203687, "link": "https://stackoverflow.com/questions/54203687/to-get-appropriate-maximum-number-from-a-string", "title": "To get appropriate maximum number from a string", "body": "<p>My string is <code>su=45, nita = 30.8, raj = 60, gita = 40.8</code> . This has reference to SO question <a href=\"https://stackoverflow.com/questions/48610932/extract-maximum-number-from-a-string/48612231#48612231\">Extract maximum number from a string</a>\nI am utilizing <code>maxNums</code> function and getting result as 40.8 whereas I would like it to be 60. Where an amendment in code line would get me the desired result.Code reproduced below to avoid cross reference.If this string contains all numbers with decimal point then I get the correct result but the data in consideration from external sources could have whole numbers.</p>\n\n<pre><code>Option Explicit\nOption Base 0    '&lt;~~this is the default but I've included it because it has to be 0\n\nFunction maxNums(str As String)\n    Dim n As Long, nums() As Variant\n    Static rgx As Object, cmat As Object\n\n    'with rgx as static, it only has to be created once; beneficial when filling a long column with this UDF\n    If rgx Is Nothing Then\n        Set rgx = CreateObject(\"VBScript.RegExp\")\n    End If\n    maxNums = vbNullString\n\n    With rgx\n        .Global = True\n        .MultiLine = False\n        .Pattern = \"\\d*\\.\\d*\"\n        If .Test(str) Then\n            Set cmat = .Execute(str)\n            'resize the nums array to accept the matches\n            ReDim nums(cmat.Count - 1)\n            'populate the nums array with the matches\n            For n = LBound(nums) To UBound(nums)\n                nums(n) = CDbl(cmat.Item(n))\n            Next n\n            'test array\n            'Debug.Print Join(nums, \", \")\n            'return the maximum value found\n            maxNums = Application.Max(nums)\n        End If\n    End With\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "oracle"], "comments": [{"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1547571910, "post_id": 54203464, "comment_id": 95234032, "body": "Can you put some detail to &quot;oracle is 32 bit&quot;. Is it the driver?"}, {"owner": {"reputation": 11, "user_id": 10918003, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tfmvgwr-HQM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaSjvqokXPRJLpeYOeGo7Fwq6L62g/mo/photo.jpg?sz=128", "display_name": "Chaman Singh", "link": "https://stackoverflow.com/users/10918003/chaman-singh"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1547572326, "post_id": 54203464, "comment_id": 95234236, "body": "Oracle is database.... and the version is 11g(32 bit)."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1547572388, "post_id": 54203464, "comment_id": 95234257, "body": "You must also make sure that your Oracle Client runs 32 bit, since you have Office 32 bit."}, {"owner": {"reputation": 160176, "user_id": 266304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bdb6217d08dcea7d67ff75f5f255081?s=128&d=identicon&r=PG", "display_name": "Alex Poole", "link": "https://stackoverflow.com/users/266304/alex-poole"}, "edited": false, "score": 0, "creation_date": 1547572497, "post_id": 54203464, "comment_id": 95234333, "body": "Presumably you&#39;re getting that error when you try to use the connection i.e. issue a query over it? Is your code checking for (or suppressing) any error thrown at the point you connect?"}, {"owner": {"reputation": 11, "user_id": 10918003, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tfmvgwr-HQM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaSjvqokXPRJLpeYOeGo7Fwq6L62g/mo/photo.jpg?sz=128", "display_name": "Chaman Singh", "link": "https://stackoverflow.com/users/10918003/chaman-singh"}, "edited": false, "score": 0, "creation_date": 1547572981, "post_id": 54203464, "comment_id": 95234582, "body": "The code throws an error at Conn.open in VBA"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1547573924, "post_id": 54203464, "comment_id": 95235039, "body": "Would help a lot to show your actual code.  Maybe also check here:  <a href=\"https://stackoverflow.com/questions/23003631/how-do-i-resolve-the-error-ora-06413-connection-not-open\" title=\"how do i resolve the error ora 06413 connection not open\">stackoverflow.com/questions/23003631/&hellip;</a>"}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1547577194, "post_id": 54203464, "comment_id": 95236501, "body": "Please show us your code where the error happens."}], "answers": [{"tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": false, "score": 1, "last_activity_date": 1547577268, "creation_date": 1547577268, "answer_id": 54204932, "question_id": 54203464, "link": "https://stackoverflow.com/questions/54203464/error-connecting-to-oracle-dba-connection-not-open/54204932#54204932", "title": "Error connecting to Oracle DBA: connection not open", "body": "<p><strong>ADO example</strong></p>\n\n<p>Maybe you have to update your connection string.\nPlease refer to <a href=\"https://www.connectionstrings.com\" rel=\"nofollow noreferrer\">https://www.connectionstrings.com</a> for examples.</p>\n\n<p>Microsoft ActiveX Data Objects (ADO)\nneeds a reference to \"Microsoft ActiveX Data Objects x.x Library\"</p>\n\n<pre><code>Sub ConnectToOracleViaADO()\n    Dim cn As ADODB.Connection\n    Dim rs As ADODB.Recordset\n    Dim myResult As String\n\n    Set cn = New ADODB.Connection\n\n    cn.ConnectionString = \"{Microsoft ODBC for Oracle};Server=myServerAddress; _\n        Uid=myUsername;Pwd=myPassword;\"\n    cn.ConnectionTimeout = 5\n    cn.Open\n\n    If cn.State &lt;&gt; adStateOpen Then\n        MsgBox \"Sorry, couldn't open database connection.\", _\n            vbCritical + vbOKOnly, \"Error\"\n        Exit Sub\n    End If\n\n    cn.CommandTimeout = 1\n\n    Set rs = New ADODB.Recordset\n    rs.Open Source:=\"SELECT something;\", _\n        ActiveConnection:=cn, _\n        CursorType:=adOpenStatic, _\n        LockType:=adLockReadOnly, _\n        Options:=adCmdUnspecified\n    myResult = rs.Fields(0).Value\n\n    rs.Close\n    cn.Close\n    Set rs = Nothing\n    Set cn = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10918003, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tfmvgwr-HQM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaSjvqokXPRJLpeYOeGo7Fwq6L62g/mo/photo.jpg?sz=128", "display_name": "Chaman Singh", "link": "https://stackoverflow.com/users/10918003/chaman-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1547577268, "creation_date": 1547571296, "last_edit_date": 1547571564, "question_id": 54203464, "link": "https://stackoverflow.com/questions/54203464/error-connecting-to-oracle-dba-connection-not-open", "title": "Error connecting to Oracle DBA: connection not open", "body": "<p>I have written code in VBA to connect to Oracle DBA. But after running the code the error pops up </p>\n\n<blockquote>\n  <p>ORA-06413: Connection not open.</p>\n</blockquote>\n\n<p>My System </p>\n\n<ul>\n<li>Windows 8 64 bit </li>\n<li>Microsoft office professional plus 2013 32 bit.</li>\n<li>oracle is 32 bit.</li>\n<li>ODBC DSN is set as myORA 32 bit.</li>\n</ul>\n\n<p>The code is running well in windows 7. I want to fix this ot also work on Windows 8 because of an upgrade in the system.</p>\n"}, {"tags": ["vba", "properties", "constants"], "comments": [{"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1547572110, "post_id": 54203347, "comment_id": 95234124, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/23678033/unicode-string-literals-in-vba\" title=\"unicode string literals in vba\">stackoverflow.com/questions/23678033/&hellip;</a>"}, {"owner": {"reputation": 741, "user_id": 2896364, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/qyTjW.jpg?s=128&g=1", "display_name": "Moe", "link": "https://stackoverflow.com/users/2896364/moe"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1547612702, "post_id": 54203347, "comment_id": 95246865, "body": "Thanks @sam! I hadn&#39;t came across this one! Useful info"}], "answers": [{"comments": [{"owner": {"reputation": 741, "user_id": 2896364, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/qyTjW.jpg?s=128&g=1", "display_name": "Moe", "link": "https://stackoverflow.com/users/2896364/moe"}, "edited": false, "score": 0, "creation_date": 1547586740, "post_id": 54203918, "comment_id": 95240393, "body": "Thanks Mathieu Guindon, I tried the in-module property declaration and experiencing a little bit of strange behavior. It sometimes give me out of memory or automation error or crashes excel. The project I am working on is a bit code-heavy. Also I am only using this string at a few places. Have you had any experience with the memory usage of the property declaration outside the class ? I am trying to minimize the memory load with the change to this string."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 741, "user_id": 2896364, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/qyTjW.jpg?s=128&g=1", "display_name": "Moe", "link": "https://stackoverflow.com/users/2896364/moe"}, "edited": false, "score": 0, "creation_date": 1547586879, "post_id": 54203918, "comment_id": 95240450, "body": "What kind of string are we talking about? <code>&quot;\\R;;&quot; &amp; Chr(163)</code> is definitely not the cause of any memory issues..."}, {"owner": {"reputation": 741, "user_id": 2896364, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/qyTjW.jpg?s=128&g=1", "display_name": "Moe", "link": "https://stackoverflow.com/users/2896364/moe"}, "edited": false, "score": 0, "creation_date": 1547589326, "post_id": 54203918, "comment_id": 95241439, "body": "Yeah, I was a bit surprised to see the issues for one simple string, could be something temporary. I am gonna try some more after a few clean excel restart to see if it happens again."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1547573453, "last_edit_date": 1547573453, "creation_date": 1547572959, "answer_id": 54203918, "question_id": 54203347, "link": "https://stackoverflow.com/questions/54203347/vba-use-of-public-property-get-in-place-of-const-for-non-unicode-characters/54203918#54203918", "title": "VBA: Use of Public Property Get in place of Const (for Non-Unicode Characters)", "body": "<p>The main issue is the name of the module, <code>Constants</code> - it's misleading, since neither a public/global <em>variable</em> nor a public get-only <em>property</em> are <em>constants</em>.</p>\n\n<p>Side node, constants not being assignable to non-constant expressions isn't a limitation that's specific to VBA.</p>\n\n<p>Properties are perfectly legal in standard modules, and public get-only properties are a perfectly fine way to expose a read-only value that needs to be constructed at run-time.</p>\n\n<blockquote>\n  <p><em>the public variables get cleared when error happens or the code stops</em></p>\n</blockquote>\n\n<p>Assuming \"when error happens\" involves clicking <kbd>End</kbd> and effectively ending the execution context, that is true of <em>everything</em> exposed anywhere, whether it's a global variable, a public property, an object, or anything that exists in-memory at run-time... and that's just normal stuff - the value is simply available on-demand any time.</p>\n\n<p>Again there's no need to have a class module for this, this is perfectly legal in a standard module:</p>\n\n<pre><code>Option Explicit\n\nPublic Property Get MyString() As String\n    MyString = \"\\R;;\" &amp; Chr(163)\nEnd Property\n</code></pre>\n\n<p>If re-creating the string every time the property getter is accessed is a problem, then you need a way to persist its value in a backing field - but then, this backing field (whether it's in a class or standard module) only has a value when the execution context exists, meaning it has exactly the same problem a global variable would have: execution stops, it's gone.</p>\n\n<p>One work-around could be to use a class with the <code>VB_PredeclaredId</code> attribute set to <code>True</code> (default is <code>False</code>).</p>\n\n<pre><code>VERSION 1.0 CLASS\nBEGIN\n  MultiUse = -1  'True\nEND\nAttribute VB_Name = \"Class1\"\nAttribute VB_GlobalNameSpace = False\nAttribute VB_Creatable = False\nAttribute VB_PredeclaredId = True\nAttribute VB_Exposed = True\nOption Explicit\n\nPrivate internalString As String\n\nPrivate Sub Class_Initialize()\n    internalString = \"\\R;;\" &amp; Chr(163)\nEnd Sub\n\nPublic Property Get MyString() As String\n    MyString = internalString\nEnd Property\n</code></pre>\n\n<p>And now VBA will automatically create an instance of <code>Class1</code> whenever it's referenced, <em>as soon as it's referenced</em>, and that instance remains \"alive\" until an <code>End</code> statement is explicitly executed, or the execution context is otherwise terminated. Exactly like, say, a <code>UserForm</code> class, you access this <em>default instance</em> using the class name as an identifier:</p>\n\n<pre><code>Debug.Print Class1.MyString\n</code></pre>\n\n<p>If the default instance existed when <code>Class1</code> was referenced, the <code>internalString</code> is returned. If it didn't, then <code>Class_Initialize</code> executes, then the <code>internalString</code> is returned.</p>\n"}], "owner": {"reputation": 741, "user_id": 2896364, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/qyTjW.jpg?s=128&g=1", "display_name": "Moe", "link": "https://stackoverflow.com/users/2896364/moe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 54203918, "answer_count": 1, "score": 2, "last_activity_date": 1547573453, "creation_date": 1547570926, "last_edit_date": 1547571884, "question_id": 54203347, "link": "https://stackoverflow.com/questions/54203347/vba-use-of-public-property-get-in-place-of-const-for-non-unicode-characters", "title": "VBA: Use of Public Property Get in place of Const (for Non-Unicode Characters)", "body": "<p>I have a VBA code where I need to define a constant string containing Non-Unicode characters (\u00a3). As some might know, VBA Editor doesn't support non-unicode and uses windows \"System Locale\" setting in regional and language setting to parse/map these characters. The machine I develop the code is set to English system Locale but some of the users have that setting as other languages, e.g. Chinese which turns the string constant to question mark (\u00a3 --> ?).</p>\n\n<p>Now, \u00a3 = chr(163), however, you cannot use chr as part of defining a constant in VBA. So while this is <strong>allowed</strong>:</p>\n\n<pre><code>public const mystring = \"reference constant string with \u00a3\"\n</code></pre>\n\n<p>this is <strong>not allowed</strong> in VBA\"</p>\n\n<pre><code>public const mystring = \"reference constant string with \" &amp; chr(163).\n</code></pre>\n\n<p>One way around is to define mystring as a public/global variable:</p>\n\n<blockquote>\n  <p>Constants.bas</p>\n</blockquote>\n\n<pre><code>public mystring as string\n</code></pre>\n\n<p>and then set the public variable on start of running code or Excel opening.</p>\n\n<blockquote>\n  <p>ThisWorkbook</p>\n</blockquote>\n\n<pre><code>Private Sub Workbook_Open()\n    mystring = \"reference constant string with \" &amp; chr(163).\nEnd Sub\n</code></pre>\n\n<p>One issue with this process is the public variables get cleared when error happens or the code stops. To keep the value an alternate I came across was to avoid public variable and instead use a public property get. Note that I have to include this a part of a class.</p>\n\n<blockquote>\n  <p>**.cls</p>\n</blockquote>\n\n<pre><code>Public Property Get mystring () As String\n    mystring = \"\\R;;\" &amp; Chr(163)\nEnd Property\n</code></pre>\n\n<p>So, now I am wondering if there will be any issue with this approach? or perhaps there is a better approach to address the constant variable with non-unicode character.</p>\n"}, {"tags": ["sql", "database", "vba", "ms-access-2016"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1547571485, "post_id": 54203340, "comment_id": 95233825, "body": "Change your code to add this before the line that adds the value:  IF PURCHASEID &gt; 0 Then ..."}, {"owner": {"reputation": 369, "user_id": 3494110, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/ac58b2f6acf43bd3615e5d43a0e33776?s=128&d=identicon&r=PG&f=1", "display_name": "user3494110", "link": "https://stackoverflow.com/users/3494110/user3494110"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1547572260, "post_id": 54203340, "comment_id": 95234194, "body": "Such a simple fix. Looks like this worked. Thank you sir =]."}], "owner": {"reputation": 369, "user_id": 3494110, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/ac58b2f6acf43bd3615e5d43a0e33776?s=128&d=identicon&r=PG&f=1", "display_name": "user3494110", "link": "https://stackoverflow.com/users/3494110/user3494110"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 317, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547570908, "creation_date": 1547570908, "question_id": 54203340, "link": "https://stackoverflow.com/questions/54203340/ms-access-subform-adding-multiple-rows", "title": "MS Access Subform adding multiple rows", "body": "<p>I have a form that I use for memo generation which I just added a new subform to which handles contract info. It is a small table which only has the PurchaseID (linked to the main table) and then the contract fields shown as text boxes/combo boxes.</p>\n\n<p>My Issue: Originally what was happening was when a user didn't click into the sub-form shown, no row would be created in the Contract table. If you look at the picture, when the form loads the \"PurchaseID\" field is populated because it's an autonum linked to the main table. However even though that field is populated, if a user doesn't physically click into the sub-form, no row gets created. I just want the blank row with the default options to be added to the table. </p>\n\n<p>My attempt to fix it: \nWhat I tried doing to fix this is on the event \"On Current\", I wrote 1 line of code that just sets the value of the combo box to a value. I think this sets the sub-form as a focus and it does end up creating the record. The problem is, now whenever the form loads, it initially tries to add a blank row with the ID of 0 to the Contract table, essentially making a duplicate blank row every time the form opens. I think the reason is because the \"On Current\" event is happening before the \"PurchaseID\" field is linking to the main table, resulting in a PurchaseID of \"0\" continuing to duplicate when the form is opened.</p>\n\n<p>What I need:\nLooking at the picture below. How do I make it so when a user does <em>not</em> click in that subform box when going through everything, a new record is added to the sub-form table with the default values selected (procurement/notrequired/etc.).</p>\n\n<p>Picture of form. Sub-form that has issue is circled.</p>\n\n<p><a href=\"https://i.stack.imgur.com/LoTgn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LoTgn.png\" alt=\"enter image description here\"></a> </p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4332613, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--FwfR3FYoTo/AAAAAAAAAAI/AAAAAAAABIQ/0ea0eQRRYvU/photo.jpg?sz=128", "display_name": "Mohamed Abdelrahman", "link": "https://stackoverflow.com/users/4332613/mohamed-abdelrahman"}, "edited": false, "score": 0, "creation_date": 1547624675, "post_id": 54203707, "comment_id": 95250671, "body": "thanks Minty , But i need the 2 forms opened at same time there"}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "reply_to_user": {"reputation": 23, "user_id": 4332613, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--FwfR3FYoTo/AAAAAAAAAAI/AAAAAAAABIQ/0ea0eQRRYvU/photo.jpg?sz=128", "display_name": "Mohamed Abdelrahman", "link": "https://stackoverflow.com/users/4332613/mohamed-abdelrahman"}, "edited": false, "score": 0, "creation_date": 1547633563, "post_id": 54203707, "comment_id": 95255175, "body": "Then move your code to the form you are calling. As I said you can&#39;t move focus off the popup form, so you have to make it work from there."}], "tags": [], "owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "is_accepted": false, "score": 1, "last_activity_date": 1547572154, "creation_date": 1547572154, "answer_id": 54203707, "question_id": 54203120, "link": "https://stackoverflow.com/questions/54203120/cannot-pass-values-between-2-popup-forms-in-access-2013/54203707#54203707", "title": "Cannot Pass Values Between 2 popup forms in Access 2013", "body": "<p>A dialog Popup form stops all code on the calling form until the 2nd form opened is closed.</p>\n\n<p>Pass the value(s) in an Openargs property to the Popup.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 4332613, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--FwfR3FYoTo/AAAAAAAAAAI/AAAAAAAABIQ/0ea0eQRRYvU/photo.jpg?sz=128", "display_name": "Mohamed Abdelrahman", "link": "https://stackoverflow.com/users/4332613/mohamed-abdelrahman"}, "edited": false, "score": 0, "creation_date": 1547624680, "post_id": 54203810, "comment_id": 95250674, "body": "Thanks for your feedback , but actually it workig when forms popup property = false but when set it true Form2 not read the passed value i assume that because it already opened so didn&#39;t call Form_Load()  Event , all i need tiger in form 2 to get values from OpenArgs"}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "reply_to_user": {"reputation": 23, "user_id": 4332613, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--FwfR3FYoTo/AAAAAAAAAAI/AAAAAAAABIQ/0ea0eQRRYvU/photo.jpg?sz=128", "display_name": "Mohamed Abdelrahman", "link": "https://stackoverflow.com/users/4332613/mohamed-abdelrahman"}, "edited": false, "score": 0, "creation_date": 1547624819, "post_id": 54203810, "comment_id": 95250730, "body": "Before opening the second form add the following code <code>Docmd.Close acForm, Me.Name</code> to close the form."}, {"owner": {"reputation": 23, "user_id": 4332613, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--FwfR3FYoTo/AAAAAAAAAAI/AAAAAAAABIQ/0ea0eQRRYvU/photo.jpg?sz=128", "display_name": "Mohamed Abdelrahman", "link": "https://stackoverflow.com/users/4332613/mohamed-abdelrahman"}, "edited": false, "score": 0, "creation_date": 1547626850, "post_id": 54203810, "comment_id": 95251482, "body": "but i dont need to close it"}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "reply_to_user": {"reputation": 23, "user_id": 4332613, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--FwfR3FYoTo/AAAAAAAAAAI/AAAAAAAABIQ/0ea0eQRRYvU/photo.jpg?sz=128", "display_name": "Mohamed Abdelrahman", "link": "https://stackoverflow.com/users/4332613/mohamed-abdelrahman"}, "edited": false, "score": 0, "creation_date": 1547652440, "post_id": 54203810, "comment_id": 95266284, "body": "@MohamedAbdelrahman I tested the code by setting both popup=true and popup=false and it works"}], "tags": [], "owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "is_accepted": true, "score": 0, "last_activity_date": 1547572527, "creation_date": 1547572527, "answer_id": 54203810, "question_id": 54203120, "link": "https://stackoverflow.com/questions/54203120/cannot-pass-values-between-2-popup-forms-in-access-2013/54203810#54203810", "title": "Cannot Pass Values Between 2 popup forms in Access 2013", "body": "<ol>\n<li><p>You can use TempVars or Pubic Variable defined in module to store the value and later access them in other form.</p></li>\n<li><p>Best option is to use OpenArgs option as already mentioned by Minty.</p></li>\n</ol>\n\n<p><strong>Form1</strong></p>\n\n<pre><code>Private Sub listBox_DblClick(Cancel As Integer)\n    Dim lstStr As String\n    lstStr = Me.listBox.Column(1)\n    DoCmd.OpenForm \"SearchFrm\", acNormal, , , , acDialog, lstStr \nEnd Sub\n</code></pre>\n\n<p><strong>Form2</strong></p>\n\n<pre><code>Private Sub Form_Load()\n    If Not IsNull(Me.OpenArgs) Then\n        MsgBox Me.OpenArgs\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4332613, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--FwfR3FYoTo/AAAAAAAAAAI/AAAAAAAABIQ/0ea0eQRRYvU/photo.jpg?sz=128", "display_name": "Mohamed Abdelrahman", "link": "https://stackoverflow.com/users/4332613/mohamed-abdelrahman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 54203810, "answer_count": 2, "score": 1, "last_activity_date": 1594619685, "creation_date": 1547570149, "last_edit_date": 1594619685, "question_id": 54203120, "link": "https://stackoverflow.com/questions/54203120/cannot-pass-values-between-2-popup-forms-in-access-2013", "title": "Cannot Pass Values Between 2 popup forms in Access 2013", "body": "<p>I have a <strong>ListBox</strong> in access 2013 , I need to pass values from (<strong>form1</strong>) to (<strong>form2</strong>) after double click on Lisbox in (<strong>form1</strong>). I have already try this way:\nThe below code when (<strong>form2</strong>) is activated , it worked normally but if forms \nproperty popup = true</p>\n\n<p>It not working , values cannot read in (<strong>form2</strong>)    .</p>\n\n<pre><code>Private Sub Form_Activate()\n    If CurrentProject.AllForms(\"SearchFrm\").IsLoaded = True Then\n        BBAIDHidenTxt.Value = Forms![SearchFrm]![SearchList].Column(0)\n        PrNumberHidenTxt.Value = Forms![SearchFrm]![SearchList].Column(1)\n        SupplierHidenTxt.Value = Forms![SearchFrm]![SearchList].Column(2)\n        OrderDateHidenTxt.Value = Forms![SearchFrm]![SearchList].Column(3)\n        TransactionTypeHidenTxt.Value = Forms![SearchFrm]![SearchList].Column(4)\n        TotalValueHidenTxt.Value = Forms![SearchFrm]![SearchList].Column(5)\n     End If\nEnd Sub\n</code></pre>\n\n<p>note : i'm new in access database developing </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1547569887, "post_id": 54202875, "comment_id": 95232985, "body": "This is more of a code review question. Saying that, is the sheet where you are trying to apply these filters in the same workbook as your code?"}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1547569961, "post_id": 54202875, "comment_id": 95233029, "body": "@Zac yes, there is a <code>with</code> statement above that I didn&#39;t include, but it explicitly references the correct workbook/worksheet"}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1547570334, "creation_date": 1547570334, "answer_id": 54203178, "question_id": 54202875, "link": "https://stackoverflow.com/questions/54202875/is-there-a-way-to-make-this-series-of-autofiltering-more-elegant/54203178#54203178", "title": "Is there a way to make this series of autofiltering more elegant?", "body": "<p>Create a new sub or function with just the three lines that repeat in the current code. Define parameters for the things that change. Then call the sub/function for each set of parameters. Something like</p>\n\n<pre><code>'call the sub/function from other code\nDoAutoFilterArray ws, 5, \"xxxxxx\", Cells(2, 5), Cells(lr, 5), Cells(2, 3), Cells(lr, 3)\nDoAutoFilterString ws, 18, \"xxxxxx\", Cells(2, 3), Cells(lr, 3), \"FULL ACCOUNT UPGRADE\"\n\nSub DoAutoFilterArray(ws as Worksheet, filterField as Long, criteria as String, _\n                 sourceCell1 as Range, sourceCell2 as Range, _\n                 targetCell1 as Range, targetCell2 as Range)\n\n  With ws\n    .Cells.AutoFilter Field:=filterField, Criteria1:=criteria\n    .Range(sourceCell1, sourceCell2).SpecialCells(xlCellTypeVisible).Value = .Range(targetCell1, targetCell2).SpecialCells(xlCellTypeVisible)\n    .Cells.Autofiler\n  End With\nEnd Sub\n\nSub DoAutoFilterString(ws as Worksheet, filterField as Long, criteria as String, _\n                 sourceCell1 as Range, sourceCell2 as Range, _\n                 targetValue as String)\n\n  With ws\n    .Cells.AutoFilter Field:=filterField, Criteria1:=criteria\n    .Range(sourceCell1, sourceCell2).SpecialCells(xlCellTypeVisible).Value = targetValue\n    .Cells.Autofiler\n  End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 54203178, "answer_count": 1, "score": 0, "last_activity_date": 1547570334, "creation_date": 1547569353, "last_edit_date": 1547569647, "question_id": 54202875, "link": "https://stackoverflow.com/questions/54202875/is-there-a-way-to-make-this-series-of-autofiltering-more-elegant", "title": "Is there a way to make this series of autofiltering more elegant?", "body": "<p>I have a ton of filters I need to accomplish, but it ends up in a massive amount of code blocks that seem like they're able to be truncated. </p>\n\n<p>How could I minimize all of this: </p>\n\n<pre><code>        .Cells.AutoFilter Field:=5, Criteria1:=\"xxxxxx\"\n        .Range(Cells(2, 5), Cells(lr, 5)).SpecialCells(xlCellTypeVisible).Value = .Range(Cells(2, 3), Cells(lr, 3)).SpecialCells(xlCellTypeVisible)\n        .Cells.Autofiler\n\n        .Cells.AutoFilter Field:=18, Criteria1:=\"xxxxxx\"\n        .Range(Cells(2, 3), Cells(lr, 3)).SpecialCells(xlCellTypeVisible).Value = \"FULL ACCOUNT UPGRADE\"\n        .Cells.AutoFilter\n        .Cells.AutoFilter Field:=18, Criteria1:=\"xxxxxx\"\n        .Range(Cells(2, 3), Cells(lr, 3)).SpecialCells(xlCellTypeVisible).Value = \"LIGHT ACCOUNT ESTABLISHED\"\n        .Cells.AutoFilter\n\n            .Cells.AutoFilter Field:=18, Criteria1:=\"xxxxxx\", Criteria2:=\"xxxxxx2\"\n            .Cells.AutoFilter Field:=27, Criteria1:=\"YES\"\n            .Cells.AutoFilter Field:=17, Criteria1:=\"Public\"\n            .Range(Cells(2, 3), Cells(lr, 3)).SpecialCells(xlCellTypeVisible).Value = \"LIGHT ACCOUNT ESTABLISHED\"\n            .Cells.AutoFilter\n\n                .Cells.AutoFilter Field:=18, Criteria1:=\"xxxxxx\", Criteria2:=\"Light Enablement through Payment Proposal\"\n                .Cells.AutoFilter Field:=27, Criteria1:=\"YES\"\n                .Cells.AutoFilter Field:=17, Criteria1:=\"Private\"\n                .Range(Cells(2, 3), Cells(lr, 3)).SpecialCells(xlCellTypeVisible).Value = \"ACTIVATED FOR AFTER FULL USE TRR WAS SENT/ACCEPTED\"\n                .Cells.AutoFilter\n\n                    .Cells.AutoFilter Field:=18, Criteria1:=\"xxxxxx\", Criteria2:=\"xxxxxx2\"\n                    .Cells.AutoFilter Field:=27, Criteria1:=\"NO\"\n                    .Cells.AutoFilter Field:=17, Criteria1:=\"Private\"\n                    .Cells.AutoFilter Field:=66, Criteria1:=\"YES\"\n                    .Range(Cells(2, 3), Cells(lr, 3)).SpecialCells(xlCellTypeVisible).Value = \"ACTIVATED FOR -- PO SENT BUT NOT RESPONDED TO\"\n                    .Cells.AutoFilter\n                    .Cells.AutoFilter Field:=18, Criteria1:=\"xxxxxx\", Criteria2:=\"xxxxxx2\"\n                    .Cells.AutoFilter Field:=27, Criteria1:=\"NO\"\n                    .Cells.AutoFilter Field:=17, Criteria1:=\"Private\"\n                    .Cells.AutoFilter Field:=66, Criteria1:=\"NO\"\n                    .Range(Cells(2, 3), Cells(lr, 3)).SpecialCells(xlCellTypeVisible).Value = \"ACTIVATED FOR -- PO NOT SENT\"\n                    .Cells.AutoFilter\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1547569699, "post_id": 54202550, "comment_id": 95232886, "body": "Don&#39;t completely understand the question but if you just want to pick up the value from column B row 4, you could just do this: <code>TestSheet.Range(&quot;B4&quot;).Value</code>. Although I don&#39;t understand how that is <b>dynamic</b> if it&#39;s always the same cell"}, {"owner": {"reputation": 1, "user_id": 10914380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a376ee90d724f6a8e0775053e70670d?s=128&d=identicon&r=PG&f=1", "display_name": "Osennecho", "link": "https://stackoverflow.com/users/10914380/osennecho"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1547570810, "post_id": 54202550, "comment_id": 95233467, "body": "I meant dynamic in the sense that the workbook it will need to pull from will ultimately vary by the identifiers and not just be the <i>231a</i> I hardcoded. Ie open asdas-101-V2 copy D6 and paste next to identifier 101. Then if next identifier in the column is 108b open xyz-108b-V3 copy D6 from it and paste in the source workbook next to identifier 108b"}], "owner": {"reputation": 1, "user_id": 10914380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a376ee90d724f6a8e0775053e70670d?s=128&d=identicon&r=PG&f=1", "display_name": "Osennecho", "link": "https://stackoverflow.com/users/10914380/osennecho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547569021, "creation_date": 1547568191, "last_edit_date": 1547569021, "question_id": 54202550, "link": "https://stackoverflow.com/questions/54202550/vba-based-on-identifiers-dynamically-open-workbooks-in-a-directory-paste-a", "title": "VBA - Based on identifiers, dynamically open workbooks in a directory &amp; paste a value from each?", "body": "<p>I have a few hundred or so excel files in a directory each with a unique identifier somewhere in the name, 103, 208c, 231a, etc. Identifiers are housed in a column in the workbook with the code. Based on these identifiers I'm trying to dynamically open the workbook containing the string of text and paste a single cell to be next to it's workbooks identifier. </p>\n\n<p>I tried to get it to work for a single case below but after the would be dynamic file opens the macro ends rather than selecting the value and pasting it. If anyone has any suggestions on how to fix that or how to switch this code from single case to dynamic/loop based I'd greatly appreciate it. I'm relatively new to coding VBA. Normally only need to rarely read it/step thru existing code.</p>\n\n<pre><code>Option Explicit\nSub Process()\nOn Error Resume Next\nApplication.DisplayAlerts = False\nApplication.AskToUpdateLinks = False\n\nDim sFound As String, fPath As String\nDim BaseFile As Workbook\nDim TestSheet As Worksheet\nDim WB1 As Workbook\nSet TestSheet = ThisWorkbook.Sheets(\"TestSheet\")\nSet BaseFile = ThisWorkbook\n\nfPath = \"\\\\WhateverDirectory\\\"\nsFound = Dir(fPath &amp; \"*231a*\") '231a should be values in column B row 4 on in the TestSheet\nIf sFound &lt;&gt; \"\" Then\n    Set WB1 = Workbooks.Open(fPath &amp; sFound)\n    WB1.Sheets(\"RCM\").Range(\"D6\").Copy\n    BaseFile.Activate\n    TestSheet.Range(\"C4\").PasteSpecial xlPasteValues\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "audio", "office365", "ms-office", "powerpoint"], "comments": [{"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 1, "creation_date": 1547568455, "post_id": 54202542, "comment_id": 95232242, "body": "Welcome to SO. When you say &#39;it doesn&#39;t work&#39; please be more specific. What happens, what have you tried? Here are some guidelines about how to ask a question on this forum: <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1547586693, "post_id": 54202542, "comment_id": 95240375, "body": "This code works just fine for me in 2016 if the path is correct and there is an appropriate file to process. Make sure you actually have a file called <code>G:\\Music\\track1.mp3</code> and that it contains all of the codecs."}, {"owner": {"reputation": 11, "user_id": 10917859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bae87794c66f9850b4e3fa6fff4a493?s=128&d=identicon&r=PG&f=1", "display_name": "Alejo Colorado", "link": "https://stackoverflow.com/users/10917859/alejo-colorado"}, "edited": false, "score": 0, "creation_date": 1547658555, "post_id": 54202542, "comment_id": 95269868, "body": "Thanks for your answers. It does work so I will update the question with what I want to achieve with the code, which is getting a dialog box where I can input an audio list, which would be then inserted into the presentation, slide by slide, with settings specified in the code"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1547923291, "post_id": 54202542, "comment_id": 95363374, "body": "Assuming a Windows version of PowerPoint, look up VBA help for FileDialog. You can use the FileDialog object to return a user-selected list of files. There&#39;s a decent explanation with useful examples here:  <a href=\"https://analystcave.com/vba-application-filedialog-select-file/\" rel=\"nofollow noreferrer\">analystcave.com/vba-application-filedialog-select-file</a>"}], "owner": {"reputation": 11, "user_id": 10917859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bae87794c66f9850b4e3fa6fff4a493?s=128&d=identicon&r=PG&f=1", "display_name": "Alejo Colorado", "link": "https://stackoverflow.com/users/10917859/alejo-colorado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 321, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1547658728, "creation_date": 1547568171, "last_edit_date": 1547658728, "question_id": 54202542, "link": "https://stackoverflow.com/questions/54202542/insert-and-automatically-play-audio-files-in-powerpoint", "title": "Insert and automatically play audio files in Powerpoint?", "body": "<p>I have this code (credit to Shyam Pillai):</p>\n\n<pre><code>Sub SampleTest()\nCall InsertAudio(\"G:\\Music\\track1.mp3\", ActivePresentation.Slides(1))\nCall InsertAudio(\"G:\\Music\\track2.mp3\", ActivePresentation.Slides(2))\n\nEnd Sub\n\nSub InsertAudio(Track As String, oSlide As Slide)\nDim oShp As Shape\nDim oEffect As Effect\n\n'Add the audio shape\nSet oShp = oSlide.Shapes.AddMediaObject2(Track, True, False, 10, 10)\n\n'Set audio to play automatically\nSet oEffect = oSlide.TimeLine.MainSequence.AddEffect(oShp, msoAnimEffectMediaPlay, , msoAnimTriggerWithPrevious)\noEffect.MoveTo 1\n\n'Hide during slide show\nWith oEffect\n    .EffectInformation.PlaySettings.HideWhileNotPlaying = True\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>The code works but I would like to know what can I add to it so when I run the code it opens a dialog box where I can insert an audio list from a file, which would be then inserted one by one, slide by slide with the settings in the code (automatic, hide during show).</p>\n\n<p>Thanks in advance for your help </p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1547568663, "post_id": 54202284, "comment_id": 95232359, "body": "Do you get an error with this code?"}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1547568927, "creation_date": 1547568927, "answer_id": 54202763, "question_id": 54202284, "link": "https://stackoverflow.com/questions/54202284/how-to-modify-a-word-table-in-a-document-embedded-in-excel/54202763#54202763", "title": "How to modify a Word table in a document embedded in Excel", "body": "<p>In order to modify the content of an embedded Word document it's first necessary to access the embedded application, then the document itself. Once the code has accessed the <code>OLEObject</code> it then needs the actual <code>Object</code>, through which the application and the document can be addressed.</p>\n\n<p>Note that it might be expedient to assign the OLE object a name, rather than relying on the one generated by Excel. Such names have a nasty tendency to change if additional objects are added or others deleted. Any name assigned explicitly will remain untouched. This needs to be run only one time on the worksheet (bases on the full sample code):</p>\n\n<pre><code>ws.OLEObjects(\"Object 4\").Name = \"WordDoc\" 'for example, can be any string you prefer\n</code></pre>\n\n<p>Then, if you decide to do this, in the full code, it would be <code>ws.OLEObjects(\"WordDoc\")</code></p>\n\n<p>At the end of the procedure the line <code>ws.Cells(1, 1).Select</code> deactivates the embedded object by selecting a cell on the sheet. If you want to leave the Word document active for the user to work with, simply remove that line.</p>\n\n<pre><code>Sub ok()\n    Dim wb As Excel.Workbook\n    Dim ws As Excel.Worksheet\n    Dim doc As Object 'Word.Document\n    Dim wdObj As Object, wdTable As Object 'Word.Table\n\n    Set wb = ActiveWorkbook\n    Set ws = wb.Sheets(\"Sheet1\")\n    Set wdObj = ws.OLEObjects(\"Object 4\")\n    wdObj.Activate\n    Set doc = wdObj.Object.Application.ActiveDocument\n    Set wdTable = doc.Tables(1)\n    wdTable.PreferredWidthType = 2 ' Word.WdPreferredWidthType.wdPreferredWidthPercent\n    wdTable.PreferredWidth = 95\n    ws.Cells(1, 1).Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 54202763, "answer_count": 1, "score": 0, "last_activity_date": 1547569141, "creation_date": 1547567312, "last_edit_date": 1547569141, "question_id": 54202284, "link": "https://stackoverflow.com/questions/54202284/how-to-modify-a-word-table-in-a-document-embedded-in-excel", "title": "How to modify a Word table in a document embedded in Excel", "body": "<p>I have so far been able to activate a Word document embedded in Excel, but I'm not able to modify the table's preferredwidth. How can I access this property through Excel VBA?</p>\n\n<p>Here's what i have so far</p>\n\n<pre><code>Sub ok()\n\nSet WDObj = Sheets(\"Sheet1\").OLEObjects(\"Object 4\")\n\nWDObj.Activate\nWDObj.ActiveDocument.Tables(1).PreferredWidthType = wdPreferredWidthPercent\nWDObj.ActiveDocument.Tables(1).PreferredWidth = 95\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 3, "creation_date": 1547567421, "post_id": 54202273, "comment_id": 95231582, "body": "Read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>. Avoid any <code>Selection</code>, <code>Select</code> and <code>Activate</code> statements."}], "answers": [{"tags": [], "owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "is_accepted": false, "score": 0, "last_activity_date": 1547568151, "creation_date": 1547568151, "answer_id": 54202533, "question_id": 54202273, "link": "https://stackoverflow.com/questions/54202273/macro-is-clearing-all-cells-instead-of-those-that-equal-0-after-a-vlookup/54202533#54202533", "title": "Macro is clearing all cells instead of those that equal 0 after a Vlookup", "body": "<p>I completely agree with PEH's comment about avoiding select statements and the like and further I would add its best to avoid things like Activesheet - instead always specify what sheet you're referring to.</p>\n\n<p>in any case, there are many way to do what you're looking for. One way would be to use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.find\" rel=\"nofollow noreferrer\">Find method</a> of the Range class, this works much like the find and replace dialogue you get when you press Ctrl+F.</p>\n\n<pre><code>Cells.Copy\nCells.PasteSpecial xlPasteValues ' replace formulas with their result\nCells.Replace What:=\"0\", Replacement:=\"\", LookAt:=xlWhole ' replace \"0\" with an empty string\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1547568778, "creation_date": 1547568778, "answer_id": 54202711, "question_id": 54202273, "link": "https://stackoverflow.com/questions/54202273/macro-is-clearing-all-cells-instead-of-those-that-equal-0-after-a-vlookup/54202711#54202711", "title": "Macro is clearing all cells instead of those that equal 0 after a Vlookup", "body": "<p>Try the code below, it will clear the values of all cells with <code>0</code> in column \"I\". Explanations inside the code's comments.</p>\n\n<pre><code>Option Explicit\n\nSub ClearZerosOnly()\n\nDim Rng As Range, myRange As Range\nDim LastRow As Long\nDim Sht As Worksheet\n\nSet Sht = ThisWorkbook.Sheets(\"Sheet1\") ' change \"sheet1\" to your sheet's name\nWith Sht\n    LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    .Range(\"A1\").AutoFilter\n\n    Set Rng = .Range(\"A1:V\" &amp; LastRow)\n    Rng.AutoFilter Field:=9, Criteria1:=\"0\" ' set the Auto-Filter criteria \n\n    ' set the Visible range and column I (from row 2, without header)\n    Set myRange = Application.Intersect(Rng.SpecialCells(xlCellTypeVisible), .Range(\"I2:I\" &amp; LastRow))\nEnd With\n\nIf Not myRange Is Nothing Then myRange.ClearContents\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10917777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/373fd481b46d5c25f172b70b711657a3?s=128&d=identicon&r=PG&f=1", "display_name": "MEG315", "link": "https://stackoverflow.com/users/10917777/meg315"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1547568778, "creation_date": 1547567285, "last_edit_date": 1547567379, "question_id": 54202273, "link": "https://stackoverflow.com/questions/54202273/macro-is-clearing-all-cells-instead-of-those-that-equal-0-after-a-vlookup", "title": "Macro is clearing all cells instead of those that equal 0 after a Vlookup", "body": "<p>I have a macro that runs and formats a weekly report of aging invoices. It runs a <code>Vlookup</code> against the previous week's file to return the updates input by the Buyers. I have an IFERROR put in so that I don't get <code>#N/A</code> returned. We also have some code written that was intended to change any cells equal to \"0,\" but it's not working. </p>\n\n<p>Instead of changing just the cells equal to 0 to blank, it's clearing ALL cell values, including the updates that were input by the Vlookup. I am nowhere near a code expert, and the person who was helping me with this has taken a new role and is quite busy. I managed to fix a couple other issues with the code, but this has me stumped.</p>\n\n<pre><code>Selection.AutoFilter\nActiveSheet.Range(\"A1:V\" &amp; LastRow).AutoFilter Field:=9, Criteria1:=\"0\"\nRange(\"I2\", \"I\" &amp; LastRow).SpecialCells(xlCellTypeVisible).Select\n\nSet myrange = Selection\nIf myrange Is Nothing Then\n\nElse\n    Selection.ClearContents\n    Selection.FillDown\n    Selection.AutoFilter\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1547565016, "post_id": 54201552, "comment_id": 95230100, "body": "Welcome to StackOverflow! Please provide the code you already have and exactly where you got stuck with it. Make it specific. Right now this question is too broad: it sounds too much like &quot;please write the code for me&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 7686680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89c8a8699aca4c0b17c7850a44bc1a47?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/7686680/pablo"}, "edited": false, "score": 0, "creation_date": 1547566904, "post_id": 54201777, "comment_id": 95231237, "body": "I really appreciate this. Thank you very much."}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "reply_to_user": {"reputation": 9, "user_id": 7686680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89c8a8699aca4c0b17c7850a44bc1a47?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/7686680/pablo"}, "edited": false, "score": 0, "creation_date": 1547568455, "post_id": 54201777, "comment_id": 95232241, "body": "@Pablo If it helped, you should mark it as accepted (green check mark on the left side)."}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1547565524, "creation_date": 1547565524, "answer_id": 54201777, "question_id": 54201552, "link": "https://stackoverflow.com/questions/54201552/creating-new-records-with-comma-delimited-values/54201777#54201777", "title": "Creating new records with comma delimited values", "body": "<p>Try following code (comments are in code):</p>\n\n<pre><code>Option Explicit\nSub FillWS()\n    Dim ws1 As Worksheet, ws2 As Worksheet\n    ' Set references to worksheets\n    Set ws1 = Worksheets(\"Worksheet1\")\n    Set ws2 = Worksheets(\"Worksheet2\")\n    ' Determine last row in column C in worksheet1\n    Dim lastRow As Long\n    lastRow = ws1.Cells(ws1.Rows.Count, 3).End(xlUp).Row\n\n    Dim i As Long, j As Long, currentRow As Long, name As String, period() As String\n    currentRow = 1\n    ' Loop through first worksheet\n    For i = 1 To lastRow\n        name = ws1.Cells(i, 3).Value\n        period = Split(ws1.Cells(i, 7).Value, \",\")\n        For j = LBound(period) To UBound(period)\n            ws2.Cells(currentRow, 1) = name\n            ws2.Cells(currentRow, 2) = period(j)\n            currentRow = currentRow + 1\n        Next\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 7686680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89c8a8699aca4c0b17c7850a44bc1a47?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/7686680/pablo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "closed_date": 1547565023, "accepted_answer_id": 54201777, "answer_count": 1, "score": -1, "last_activity_date": 1547565562, "creation_date": 1547564683, "last_edit_date": 1547565562, "question_id": 54201552, "link": "https://stackoverflow.com/questions/54201552/creating-new-records-with-comma-delimited-values", "closed_reason": "Needs more focus", "title": "Creating new records with comma delimited values", "body": "<p>I have a table in worksheet1 where one column \"G\" allows multiple values that are separated by comma, e.g. 12,24,72. In worksheet2, I want to read the table or worksheet1 and write new records (rows) with select columns C &amp; G. If a comma is identified in G, worksheet1 I would like to have it create a new row for each instance in worksheet2.</p>\n\n<p>Worksheet1</p>\n\n<pre><code>ID(A) | Name(C) | Period(G)\n1     | Paul    | 12\n2     | Sam     | 12,14,72\n3     | Karen   | 36\n</code></pre>\n\n<p>Worksheet2</p>\n\n<pre><code>Paul  | 12\nSam   | 12\nSam   | 14\nSam   | 72\nKaren | 36\n</code></pre>\n"}]