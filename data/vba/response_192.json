[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 4, "creation_date": 1536796733, "post_id": 52304847, "comment_id": 91557313, "body": "Put a breakline on the last line (that isn&#39;t working), run the code until it stops itself, and then check the values of related variables.  My <i>guess</i> would be that you&#39;re not explicitly referring to the correct destination sheet, which you&#39;re manually choosing it when running the code line by line.  Also I&#39;m going to edit your post to remove irrelevant stuff like commented-out code. Check out the <a href=\"https://stackoverflow.com/tour\">tour</a> (you&#39;ll earn your first badge!) and also see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; as well as how to create an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1536797264, "post_id": 52304847, "comment_id": 91557401, "body": "If you add the line <code>Option Explicit</code> to the top of the module, it will help &quot;force&quot; you to properly declare/handle your variables.  Also, note that you posted your password. I changed it but it&#39;s still permanently viewable in the history. If it&#39;s of concern then you can flag a mod to help."}, {"owner": {"reputation": 9, "user_id": 10355782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b73bdf71e4824a42e284ad4522f6da63?s=128&d=identicon&r=PG&f=1", "display_name": "JIgnaski", "link": "https://stackoverflow.com/users/10355782/jignaski"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1536804291, "post_id": 52304847, "comment_id": 91558632, "body": "I think what the problem is, it is not copying even when true."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1536809933, "post_id": 52304847, "comment_id": 91559833, "body": "<code>Set CurrentHours = Range(&quot;CurrentHours&quot;)</code> looks suspect because it&#39;s implicitly referencing the <code>ActiveSheet</code>. Try qualifying your call to <code>Range</code>."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1536833550, "post_id": 52304847, "comment_id": 91569960, "body": "Failing to copy when running at full speed, but working fine when &#39;stepping&#39; <i>might</i> suggest that the code is moving on to the next line before the last copy or paste has completed..? To rule this out, add a <code>DoEvents</code> line after <b>every</b> <code>Copy</code> and <code>Paste</code> within the loop that&#39;s failing. This will cause Excel to pause until any events, such as recalcs and large copy/pastes have completed before continuing."}, {"owner": {"reputation": 9, "user_id": 10355782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b73bdf71e4824a42e284ad4522f6da63?s=128&d=identicon&r=PG&f=1", "display_name": "JIgnaski", "link": "https://stackoverflow.com/users/10355782/jignaski"}, "edited": false, "score": 0, "creation_date": 1538146658, "post_id": 52304847, "comment_id": 92054502, "body": "Found the error. Thank you everyone for your help. Turns out there was a reference error. Once i got rid of all the &quot;activates&quot; and added the reference to everything it works flawlessly."}], "owner": {"reputation": 9, "user_id": 10355782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b73bdf71e4824a42e284ad4522f6da63?s=128&d=identicon&r=PG&f=1", "display_name": "JIgnaski", "link": "https://stackoverflow.com/users/10355782/jignaski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536797176, "creation_date": 1536796074, "last_edit_date": 1536797176, "question_id": 52304847, "link": "https://stackoverflow.com/questions/52304847/vba-excel-macro-executes-correctly-in-debug-but-does-not-run-sub-when-executed", "title": "VBA: Excel Macro executes correctly in debug, but does not run sub when executed", "body": "<p>My code is to reference a named range(Pump Number), find the last instance in a table(another sheet), copy the row it was found in and paste that data in the new row that was created in the table. It is then to loop trough a series of cells on another sheet and find true values. If the value is true it is to copy another named range(Hours) and paste that value into the table in the correct column. The code executes correctly in debug, stepping through one line at a time, but when ran  normally, it does not copy the last line of data in the table and paste the values in the new row. The code where it does not work properly starts at line 90</p>\n\n<pre><code>Sub SavePumpMaintenance()\n    Application.Calculation = xlCalculationManual\n    Application.ScreenUpdating = False\n\n    Dim tbla As ListObject, last_row, total_stage As Integer\n    Dim issue, pump, pump_hrs, main_date, main_code As String\n    Dim correct_plunger, correct_part As Boolean, Data As Worksheet\n    Dim Maint As Worksheet, wSheet As Worksheet, r As Long\n    Dim tbl As ListObject, newrow As ListRow, i As Long\n    Dim cells As Range, LR As Integer, Hist As Worksheet\n\n    Set Hist = Sheet26\n    Set CurrentHours = Range(\"CurrentHours\")\n    Set tbl = Hist.ListObjects(\"Historical\")\n    Set newrow = tbl.ListRows.Add\n    Set Data = Sheet5\n    Set Maint = Sheet3\n    Set tbla = Maint.ListObjects(\"MaintPerformed\")\n    correct_plunger = Data.Range(\"N6\").Value\n    correct_part = Data.Range(\"N10\").Value\n    main_code = Data.Range(\"Y8\").Value\n    issue = Data.Range(\"Y11\").Value\n    last_row = Data.Range(\"N11\").Value\n    pump = Maint.Range(\"C6\").Value\n    pump_hrs = Maint.Range(\"C7\").Value\n    main_date = Maint.Range(\"C8\").Value\n    total_stage = Maint.Range(\"C9\").Value\n    LR = tbl.Range(Rows.Count).End(xlUp).Row\n\n    'Unprotect all sheets\n    For Each wSheet In Worksheets\n        wSheet.Unprotect Password:=\"SomePassword\"\n    Next wSheet\n    If pump = \"\" Then\n        MsgBox \"Please select a pump.\"\n        Application.Calculation = xlCalculationAutomatic\n        Exit Sub\n    End If\n    If pump_hrs = \"\" Then\n        MsgBox \"Please enter hours.\"\n        Application.Calculation = xlCalculationAutomatic\n        Exit Sub\n    End If\n    If Range(\"Date\") = \"\" Then\n        MsgBox \"Please enter date and time of maintenance.\"\n        Application.Calculation = xlCalculationAutomatic\n        Exit Sub\n    End If\n    If correct_plunger = False Then\n        MsgBox \"Incorrect plunger type selected\"\n        Application.Calculation = xlCalculationAutomatic\n        Exit Sub\n    End If\n    If correct_part = False Then\n        MsgBox \"Incorrect part type selected\"\n        Application.Calculation = xlCalculationAutomatic\n        Exit Sub\n    End If\n    Data.Range(\"T3:T37\").Copy 'Copy used parts/pump info to maintenance table\n    Maint.Range(\"O1\").Offset(last_row,0).PasteSpecial xlValues,Transpose:=True\n    Data.Range(\"U3:U12\").Copy\n    Maint.Range(\"BJ1\").Offset(last_row,0).PasteSpecial xlValues,Transpose:=True\n    Maint.Range(\"J1\").Offset(last_row, 0).Value = pump\n    Maint.Range(\"J1\").Offset(last_row, 1).Value = pump_hrs\n    Maint.Range(\"J1\").Offset(last_row, 2).Value = total_stage\n    Maint.Range(\"J1\").Offset(last_row, 3).Value = main_date\n    Maint.Range(\"J1\").Offset(last_row, 4).Value = main_code\n    Maint.Range(\"J1\").Offset(last_row, 63).Value = issue\n\n    'Copy last set of historical data for pump 'add maintenance to history\n    For r = 1 To LR Step 1\n        If tbl.Range(r, 1).Value = Range(\"Pumpnumber\") Then\n            Range(\"H\" &amp; r &amp; \":V\" &amp; r).Copy\n            newrow.Range(8).PasteSpecial Paste:=xlValues\n        End If\n    Next r\n    With newrow 'Paste current pump information\n        .Range(1) = Range(\"Pumpnumber\")\n        .Range(2) = Range(\"Date\")\n        .Range(3) = CurrentHours\n        .Range(4) = Range(\"Position\")\n        .Range(5) = Range(\"Fleet\")\n        .Range(6) = Range(\"WFNumb\")\n        .Range(7) = Range(\"OStage\")\n    End With\n\n    'copy hours from maintenance if checked into maint. history\n    For i = 1 To 5\n        If Maint.cells(13, i + 2).Value = True Then\n            CurrentHours.Copy\n            newrow.Range(7 + i).PasteSpecial xlPasteValues\n        End If\n        If Maint.cells(16, i + 2).Value = True Then\n            CurrentHours.Copy\n            newrow.Range(12 + i).PasteSpecial xlPasteValues\n        End If\n        If Maint.cells(21, i + 2).Value = True Then\n            CurrentHours.Copy\n            newrow.Range(17 + i).PasteSpecial xlPasteValues\n        End If\n        If Maint.cells(22, i + 2).Value = True Then\n            CurrentHours.Copy\n            newrow.Range(17 + i).PasteSpecial xlPasteValues\n        End If\n    Next i\n    Application.CutCopyMode = False\n\n    Dim mp As Range, P As Range 'Copy Current hrs to Equipment Sheet\n    Set mp = Range(\"MyPumps\")\n    For Each P In mp\n        If P.Value = Range(\"PumpNumber\") Then\n            P.Offset(0, 5).Value = Range(\"CurrentHours\")\n        End If\n    Next P\n\n    Sheet3.Protect Password:=\"MyPassword\"  'Protect sheets\n    Sheet5.Protect Password:=\"MyPassword\"\n    Sheet16.Protect Password:=\"MyPassword\"\n    Sheet25.Protect Password:=\"MyPassword\"\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1536796084, "post_id": 52304825, "comment_id": 91557181, "body": "Are you saying this works fine as-is (with no specific problems) and you&#39;d like advice on how to make it more efficient?  If so, this may not be the correct place for your post. <b>See the <a href=\"https://stackoverflow.com/help/on-topic\">help center</a></b> for more information about what&#39;s on topic on this site, as well as &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1536796525, "post_id": 52304825, "comment_id": 91557277, "body": "Questions asking to make working code more efficient are possibly better suited to <a href=\"https://codereview.stackexchange.com/help/on-topic\">Stack Exchange Code Review</a>, a question and answer site for seeking peer review of your code."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1536800738, "post_id": 52304825, "comment_id": 91557991, "body": "@ashleedawg <a href=\"https://codereview.meta.stackexchange.com/questions/5777/a-guide-to-code-review-for-stack-overflow-users\">please read this</a> before recommending moving to CR"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10355805, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rZ_93Cm6lKM/AAAAAAAAAAI/AAAAAAAAAEM/g-s8oxZy9GI/photo.jpg?sz=128", "display_name": "alonso gutierrez", "link": "https://stackoverflow.com/users/10355805/alonso-gutierrez"}, "edited": false, "score": 0, "creation_date": 1536848840, "post_id": 52305249, "comment_id": 91579105, "body": "Thank you very much! that improved time a lot. i changed the if statement to better suit my needs.  -&gt;  If InStr(1, src(i, 1), lup) &lt;&gt; 0 Then"}, {"owner": {"reputation": 11, "user_id": 10355805, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rZ_93Cm6lKM/AAAAAAAAAAI/AAAAAAAAAEM/g-s8oxZy9GI/photo.jpg?sz=128", "display_name": "alonso gutierrez", "link": "https://stackoverflow.com/users/10355805/alonso-gutierrez"}, "edited": false, "score": 0, "creation_date": 1536849093, "post_id": 52305249, "comment_id": 91579262, "body": "also, I had to add If Not IsEmpty(lup) Then before the For so it does not make any computation if lup is empty."}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 0, "last_activity_date": 1536800912, "last_edit_date": 1536800912, "creation_date": 1536800312, "answer_id": 52305249, "question_id": 52304825, "link": "https://stackoverflow.com/questions/52304825/udf-for-index-match-combo-using-instr-vba-excel/52305249#52305249", "title": "UDF for index match combo using instr vba excel", "body": "<p>Moving the data into a Variant Array before doing the loop will improve time a lot - how much depends on the size of the ranges.</p>\n\n<pre><code>Public Function AGSIndexMatch( _\n  result_column As Range, _\n  lookup As Range, _\n  lookup_column As Range) As Variant\n\n    Dim rsc As Variant, src As Variant, lup As Variant\n    rsc = result_column.Value2\n    src = lookup_column.Value2\n    lup = lookup.Value2\n    Dim i As Long\n    Dim res As String\n\n    On Error GoTo error_handler:\n    For i = 1 To UBound(src, 1)\n        If src(i, 1) = lup Then\n            res = res &amp; Chr(10) &amp; rsc(i, 1)\n        End If\n    Next\n    AGSIndexMatch = Mid$(res, 2)\n\nExit Function\nerror_handler:\n    AGSIndexMatch = Err.Description\nEnd Function\n</code></pre>\n\n<p>There might be other ways that perform better, depending of the nature of your data</p>\n"}], "owner": {"reputation": 11, "user_id": 10355805, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rZ_93Cm6lKM/AAAAAAAAAAI/AAAAAAAAAEM/g-s8oxZy9GI/photo.jpg?sz=128", "display_name": "alonso gutierrez", "link": "https://stackoverflow.com/users/10355805/alonso-gutierrez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1536800912, "creation_date": 1536795876, "last_edit_date": 1536796252, "question_id": 52304825, "link": "https://stackoverflow.com/questions/52304825/udf-for-index-match-combo-using-instr-vba-excel", "title": "UDF for index match combo using instr vba excel", "body": "<p>I wrote this code for a UDF but it taker a lot of time to calculate when i use it in many cells. Is there a more efficient way?</p>\n\n<pre><code>Public Function AGSIndexMatch(result_column As Range, lookup As Range, _\n                                           lookup_column As Range) As Variant\n    Dim cel As Range\n    Dim b As String\n    Dim i As Variant\n    i = 1\n    For Each cel In lookup_column\n        On Error GoTo error_handler:\n        If Not IsEmpty(cel) Then\n            If InStr(1, cel.Value, lookup) &lt;&gt; 0 Then\n                AGSIndexMatch = AGSIndexMatch &amp; Application _\n                  .WorksheetFunction.Index(result_column, i, 1) &amp; Chr(10)\n            End If\n        End If\n        i = i + 1\n    Next cel\n    If Len(AGSIndexMatch) &lt;&gt; 0 Then\n        AGSIndexMatch = Left(AGSIndexMatch, Len(AGSIndexMatch) - 1)\n    End If\n    Exit Function\nerror_handler:\n    AGSIndexMatch = Err.Description\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1536793164, "post_id": 52304247, "comment_id": 91556570, "body": "Use <code>Dir()</code> to loop over the matching files, and attach the ones matching the date criteria."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1536793582, "post_id": 52304247, "comment_id": 91556660, "body": "...or loop over your existing array from Split(), and use <code>FileDateTime()</code> to check its age."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 8469383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19b5245cb10bc7a58733181e266b1254?s=128&d=identicon&r=PG&f=1", "display_name": "go.surf13", "link": "https://stackoverflow.com/users/8469383/go-surf13"}, "edited": false, "score": 0, "creation_date": 1536862363, "post_id": 52304616, "comment_id": 91586418, "body": "So far this one works like a charm! Very much appreciated!"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 2, "last_activity_date": 1536793851, "creation_date": 1536793851, "answer_id": 52304616, "question_id": 52304247, "link": "https://stackoverflow.com/questions/52304247/selecting-all-excel-files-with-504-in-the-title-made-modified-on-todays-date/52304616#52304616", "title": "Selecting all excel files with &quot;504&quot; in the title made/modified on today&#39;s date", "body": "<p>Using <code>Dir</code> and <code>FileDateTime</code> </p>\n\n<p>(With email portion commented out for my testing, but shows where to put this code)</p>\n\n<pre><code>Sub Demo()\n    Dim Path As String\n    Dim Patt As String\n    Dim fl As String\n    Dim FileDate As Date\n    Dim TodayDate As Date\n\n    Path = \"C:\\Folder\\\"\n    Patt = \"504*.xlsm\"\n    TodayDate = Int(Now())\n\n' your other code ...\n\n'    With OMail\n'        .To = \"anybody@gmail.com\"\n'        .Subject = \"504 \" &amp; Sheet4.Range(\"D3\")\n'        .body = mail_body &amp; vbNewLine &amp; Signature\n        fl = Dir(Path &amp; Patt)\n        Do While fl &lt;&gt; vbNullString\n            FileDate = Int(FileDateTime(fl))\n            If FileDate = TodayDate Then\n                '.Attachments.Add Path &amp; fl\n            End If\n            fl = Dir()\n        Loop\n'        .display\n'    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1536794038, "creation_date": 1536794038, "answer_id": 52304640, "question_id": 52304247, "link": "https://stackoverflow.com/questions/52304247/selecting-all-excel-files-with-504-in-the-title-made-modified-on-todays-date/52304640#52304640", "title": "Selecting all excel files with &quot;504&quot; in the title made/modified on today&#39;s date", "body": "<pre><code>Sub Tester()\n    Const folder As String = \"C:\\Folder\\\"\n    Dim arr, f\n    arr = Split(CreateObject(\"wscript.shell\").exec(\"cmd /c Dir /b /o-d \"\"\" &amp; _\n                             folder &amp; \"504*.xlsm\"\"\").stdout.readall, vbCrLf)\n\n    For Each f In arr\n        If Len(f) &gt; 0 Then\n            'attach if less than 24hrs old\n            If (Now - FileDateTime(folder &amp; f)) &lt; 1 Then\n                Debug.Print \"Attaching\", f\n                'attach the file...\n            End If\n        End If\n    Next f\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 8469383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19b5245cb10bc7a58733181e266b1254?s=128&d=identicon&r=PG&f=1", "display_name": "go.surf13", "link": "https://stackoverflow.com/users/8469383/go-surf13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 52304616, "answer_count": 2, "score": 0, "last_activity_date": 1536794038, "creation_date": 1536790784, "question_id": 52304247, "link": "https://stackoverflow.com/questions/52304247/selecting-all-excel-files-with-504-in-the-title-made-modified-on-todays-date", "title": "Selecting all excel files with &quot;504&quot; in the title made/modified on today&#39;s date", "body": "<p>I'd like to be able to attach all my excel (xlsm) files that have \"504\" in the title that were made on today's date to an Outlook email. I can have 1 or 10+ files with \"504\" in the title made in one day.</p>\n\n<p>Below you can see my current code. This code allows me to attach 1 excel file but it also most be the most recently modified (created). </p>\n\n<pre><code>Sub Attach()\nDim folder As String\nDim file As String\nDim mail_body As String\nDim signature As String\nDim OApp As Object\nDim OMail As Object\n\nSheet1.Visible = False\nSheet2.Visible = False\nSheet3.Visible = False\nSheet4.Visible = False\nSheet5.Visible = False\n\nfolder = \"C:Folder\\504\"\nfile = Split(CreateObject(\"wscript.shell\").exec(\"cmd /c Dir /b /o-d \"\"\" &amp; folder &amp; \"\"\"*.xlsm\").stdout.readall, vbCrLf)(0)\nmail_body = \"Hello,\" &amp; vbCrLf &amp; vbCrLf &amp; \"Attached is the 504 for \" &amp; Sheet4.Range(\"D4\") &amp; \".\" &amp; vbCrLf &amp; vbCrLf &amp; \"Thank you,\"\n\n\nSet OApp = CreateObject(\"Outlook.Application\")\nSet OMail = OApp.CreateItem(0)\n    With OMail\n    .display\n    End With\n        signature = OMail.body\n\n\n\nWith OMail\n    .To = \"anybody@gmail.com\"\n    .Subject = \"504 \" &amp; Sheet4.Range(\"D3\")\n    .body = mail_body &amp; vbNewLine &amp; signature\n    .Attachments.Add folder &amp; file\n    .display\nEnd With\n\n\nMsgBox (\"Please confirm email and click SEND. Once the payoff has bee sent \nthe process is now complete! Thank you!\")\n\nEnd Sub\n</code></pre>\n\n<p>Any help would be great!!</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1536795113, "post_id": 52304181, "comment_id": 91556990, "body": "what have you tried so far? this is not hard"}, {"owner": {"reputation": 79, "user_id": 10210525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4030dd1b1bfea81d3fa842fe92bd2eb?s=128&d=identicon&r=PG&f=1", "display_name": "Valborg", "link": "https://stackoverflow.com/users/10210525/valborg"}, "edited": false, "score": 0, "creation_date": 1536847525, "post_id": 52304181, "comment_id": 91578194, "body": "I added where I&#39;m at in the code"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 79, "user_id": 10210525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4030dd1b1bfea81d3fa842fe92bd2eb?s=128&d=identicon&r=PG&f=1", "display_name": "Valborg", "link": "https://stackoverflow.com/users/10210525/valborg"}, "edited": false, "score": 0, "creation_date": 1536851771, "post_id": 52315550, "comment_id": 91581003, "body": "That new requirement has nothing to do with your sample data. Perhaps it is a new question since it invalidates this one."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1536847692, "creation_date": 1536847692, "answer_id": 52315550, "question_id": 52304181, "link": "https://stackoverflow.com/questions/52304181/add-lines-and-duplicate-data-a-set-number-of-times/52315550#52315550", "title": "Add lines and duplicate data a set number of times", "body": "<p>Try this after renaming the referenced worksheet.</p>\n\n<pre><code>Sub expandMonths()\n    'https://stackoverflow.com/questions/52304181\n    Dim i As Long, j As Long, m As Long, a As Variant\n\n    With Worksheets(\"sheet1\")\n\n        i = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        Do While i &gt; 1\n            a = Array(.Cells(i, \"A\").Value2, .Cells(i, \"B\").Value2, 0, 0, 0, 0)\n            m = .Cells(i, \"C\").Value2\n            j = Application.Match(.Cells(i, \"A\").Value2, .Columns(\"A\"), 0)\n\n            If i - j &lt; m Then\n                .Rows(j).Resize(m - (i - j) - 1, 1).EntireRow.Insert\n                .Cells(j, \"A\").Resize(m - (i - j) - 1, UBound(a) + 1) = a\n                .Cells(j, \"C\").Resize(m - (i - j) - 1, 4).NumberFormat = \"0\"\n            End If\n\n            i = j - 1\n        Loop\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 10210525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4030dd1b1bfea81d3fa842fe92bd2eb?s=128&d=identicon&r=PG&f=1", "display_name": "Valborg", "link": "https://stackoverflow.com/users/10210525/valborg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 52315550, "answer_count": 1, "score": -2, "last_activity_date": 1536847692, "creation_date": 1536790451, "last_edit_date": 1536847494, "question_id": 52304181, "link": "https://stackoverflow.com/questions/52304181/add-lines-and-duplicate-data-a-set-number-of-times", "title": "Add lines and duplicate data a set number of times", "body": "<p>I am trying to write a VBA Excel Macro to look through hundreds of thousands of lines of data to make sure that each unique entry in column A has a number of entries equal to column C.</p>\n\n<p>For example:\n<a href=\"https://i.stack.imgur.com/mkqXg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mkqXg.png\" alt=\"Messy Data\"></a></p>\n\n<p>Source Account Id 84512 occurs 6 times but there needs to be 12 occurrences (as indicated by column C). This means I need to add 6 lines, before (or after) the existing 6 lines. </p>\n\n<p>Next we see Source Account Id 64857 occurs once but needs to occur 5 times. I would add 4 lines above and have the same Source Account Id code and the same Account Name. The rest of the cells can be \"0\".</p>\n\n<p>Here is an example of the finished product:\n<a href=\"https://i.stack.imgur.com/sUaSF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sUaSF.png\" alt=\"Clean Data\"></a></p>\n\n<p>Here is what I have so far:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub InsertRowAtChangeInValue()\r\n   Dim lRow As Long\r\n   Dim nMonths As Long\r\n   \r\n   For lRow = Cells(Cells.Rows.count, \"A\").End(xlUp).Row To 2 Step -1\r\n    nMonths = 12 - Cells(Application.ActiveCell.Row, 3).Value\r\n      If Cells(lRow, \"A\") &lt;&gt; Cells(lRow - 1, \"A\") Then Rows(lRow).EntireRow.Resize(nMonths).Insert\r\n   Next lRow\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Please let me know if you have any suggestions.</p>\n\n<p>*All data in these examples is fictional</p>\n"}, {"tags": ["excel", "vba", "macos", "shapes"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1536794957, "post_id": 52304133, "comment_id": 91556937, "body": "My first suggestion is to take advantage of the fact the Office 2016 for Windows is <b>free for <a href=\"https://www.microsoft.com/education/products/office/default.aspx\" rel=\"nofollow noreferrer\">students</a> or <a href=\"https://dev.office.com/devprogram/devprogram-details\" rel=\"nofollow noreferrer\">developers</a></b>. There&#39;s a reason not even Microsoft supports VBA on Macs any more... My other thought is to (assuming there&#39;s a macro recorder on the Mac version) <b>record a macro</b> doing whatever steps you want to automate, and then edit/adjust the VBA code Excel generates for you, as necessary."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1536795046, "post_id": 52304133, "comment_id": 91556969, "body": "There are a few resources online too like this one: <a href=\"https://support.office.com/article/add-or-change-the-fill-color-in-office-for-mac-b8b83901-5256-42b9-a720-b83157dd1d00\" rel=\"nofollow noreferrer\">support.office.com/article/&hellip;</a>  ... they&#39;re just extra tricky to find since there are so few Office/Mac users.  Good luck!"}], "owner": {"reputation": 1, "user_id": 10355611, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209987132234275/picture?type=large", "display_name": "Yen Lee", "link": "https://stackoverflow.com/users/10355611/yen-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 355, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593562777, "creation_date": 1536790046, "last_edit_date": 1593562777, "question_id": 52304133, "link": "https://stackoverflow.com/questions/52304133/fail-to-change-button-color-with-vba-in-mac", "title": "Fail to change button color with vba in mac", "body": "<p>I am trying to write a macro to change the button color when it is clicked. The code I used is </p>\n\n<pre><code>Sheet1.Shapes(\"Button 6\").TextFrame.Characters.Font.ColorIndex = 1\n</code></pre>\n\n<p>It works in Excel for Windows but not <strong>Excel for Mac</strong>. </p>\n\n<p>When I click the button in mac, the error message:</p>\n\n<blockquote>\n  <p><code>Run-time error 1004: Method \"TextFrame\" of object \"Shape\" failed</code></p>\n</blockquote>\n\n<p>It would be a great help if anyone could help me. Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1536795376, "post_id": 52304075, "comment_id": 91557040, "body": "<i>Welcome to <a href=\"https://stackoverflow.com\">Stack Overflow</a>!</i> This is a site where programmers <i>write their own code</i> and share a <i>specific problem</i> after trying to solve it on their own. If you have a particular issue after <a href=\"//meta.stackoverflow.com/q/261592\">researching</a> existing answers, please <a href=\"https://stackoverflow.com/posts/52304075/edit\">edit</a> your post to share some background info and a <b><a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of your code</b> and relevant data. More tips here: <i>&quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot;</i> and in the <a href=\"https://stackoverflow.com/help/on-topic\">help center</a>, as well as this <a href=\"//codeblog.jonskeet.uk/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">checklist</a> from the sites&#39; top user. Here&#39;s an excellent <a href=\"//www.homeandlearn.org/\" rel=\"nofollow noreferrer\"><b>tutorial</b></a> to get you started."}], "answers": [{"tags": [], "owner": {"reputation": 136, "user_id": 10339521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e86d72af9f77e310c9e902d135cae3?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan L", "link": "https://stackoverflow.com/users/10339521/dylan-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1536798664, "last_edit_date": 1536798664, "creation_date": 1536798345, "answer_id": 52305066, "question_id": 52304075, "link": "https://stackoverflow.com/questions/52304075/vba-how-to-find-a-specific-number-based-on-variable-then-priority/52305066#52305066", "title": "VBA How to find a Specific Number based on Variable then Priority", "body": "<p>So I've put something together for you that should get you most of the way there. </p>\n\n<p>You'll need to do a few things to get this working for your file (learning opportunity!):</p>\n\n<p>(1) Adjust the ranges as relevant to your file\n(2) Print the output to the worksheet. As of right now the output is being printed to the immediate debug window.</p>\n\n<p>What this code will do is sort out each letters values into a collection named after the letters.</p>\n\n<p>From there we convert the collection to an array. We then utilize the \"Small\" worksheet function on the arrays, and loop through the 6 lowest values.</p>\n\n<p>Happy to help with any further questions you may have!</p>\n\n<pre><code>Public Function CollectionToArray(myCol As Collection) As Variant\n'Thanks to user Vityata for this converter function (https://stackoverflow.com/users/5448626/vityata).\n\n    Dim result  As Variant\n    Dim cnt     As Long\n\n    ReDim result(myCol.Count - 1)\n    For cnt = 0 To myCol.Count - 1\n        result(cnt) = myCol(cnt + 1)\n    Next cnt\n    CollectionToArray = result\n\nEnd Function\n\nSub ArraySort()\n\nDim Cell As Range\n\nDim KeyMultiple As String\n\nDim collA As New Collection\nDim collB As New Collection\nDim collC As New Collection\nDim collD As New Collection\n\n\nDim Rng_Col As Range\nSet Rng_Col = Sheets(\"Sheet1\").Range(\"A2:A22\")\n\nDim GroupByArr As Variant\nGroupByArr = Array(\"A\", \"B\", \"C\")\n\n\nCounter = 0\nFor i = 1 To 22\n        If Cells(i, 1).Value = \"A\" Then\n            Counter = Counter + 1\n            KeyMultiple = Letter &amp; \"-\" &amp; Counter\n            collA.Add Item:=Cells(i, 2), Key:=KeyMultiple\n        ElseIf Cells(i, 1).Value = \"B\" Then\n            Counter = Counter + 1\n            KeyMultiple = Letter &amp; \"-\" &amp; Counter\n            collB.Add Item:=Cells(i, 2), Key:=KeyMultiple\n        ElseIf Cells(i, 1).Value = \"C\" Then\n            Counter = Counter + 1\n            KeyMultiple = Letter &amp; \"-\" &amp; Counter\n            collC.Add Item:=Cells(i, 2), Key:=KeyMultiple\n        ElseIf Cells(i, 1).Value = \"D\" Then\n            Counter = Counter + 1\n            KeyMultiple = Letter &amp; \"-\" &amp; Counter\n            collD.Add Item:=Cells(i, 2), Key:=KeyMultiple\n        End If\nNext i\n\nFor i = 1 To 6\n    Debug.Print WorksheetFunction.Small(CollectionToArray(collA), i)\n    Debug.Print WorksheetFunction.Small(CollectionToArray(collB), i)\n    Debug.Print WorksheetFunction.Small(CollectionToArray(collC), i)\n    Debug.Print WorksheetFunction.Small(CollectionToArray(collD), i)\nNext i\n\n\n\nSet collA = New Collection\nSet collB = New Collection\nSet collC = New Collection\nSet collD = New Collection\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 1, "creation_date": 1536798717, "post_id": 52305086, "comment_id": 91557666, "body": "if you follow this method, you can actually do this manually in a minute and there is no need for VBA. Just do the same thing the code does manually, except you need to create a column that counts the Statios from top to bottom and then use the autofilter of the table where count&gt;6 and delete all those rows, pretty simpe!"}, {"owner": {"reputation": 136, "user_id": 10339521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e86d72af9f77e310c9e902d135cae3?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan L", "link": "https://stackoverflow.com/users/10339521/dylan-l"}, "edited": false, "score": 0, "creation_date": 1536798857, "post_id": 52305086, "comment_id": 91557695, "body": "I considered the sorting approach also, but went with arrays/functions instead. How does this approach hold up against larger datasheets?"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 136, "user_id": 10339521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e86d72af9f77e310c9e902d135cae3?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan L", "link": "https://stackoverflow.com/users/10339521/dylan-l"}, "edited": false, "score": 0, "creation_date": 1536813251, "post_id": 52305086, "comment_id": 91560594, "body": "it is even better if you do the sorting on arrays. I did not add it since I just wanted to keep it simple for you as a point to start. The routine to sort an array based on multiple columns would take time, at least excel autofilter is optimum enough for this."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 136, "user_id": 10339521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e86d72af9f77e310c9e902d135cae3?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan L", "link": "https://stackoverflow.com/users/10339521/dylan-l"}, "edited": false, "score": 1, "creation_date": 1536813514, "post_id": 52305086, "comment_id": 91560654, "body": "note that if you think the code should do this in a couple of seconds you may be wrong, even with a SQL statement this may take few seconds. If you have to run such a routine too many times then you should use SQL. You can use an Excel range or Excel sheet as a database table and with ADO you can run a SQL query and sort the data etc a lot easier and faster, but the code will be bigger, have look at this example: <a href=\"https://stackoverflow.com/questions/43554542/vba-sorting-2-dimensional-array-text-values-in-alphabetical-order-optimizati\" title=\"vba sorting 2 dimensional array text values in alphabetical order optimizati\">stackoverflow.com/questions/43554542/&hellip;</a>"}, {"owner": {"reputation": 136, "user_id": 10339521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e86d72af9f77e310c9e902d135cae3?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan L", "link": "https://stackoverflow.com/users/10339521/dylan-l"}, "edited": false, "score": 0, "creation_date": 1536837887, "post_id": 52305086, "comment_id": 91572286, "body": "Ah I forgot about ADO! That seems like it definitely would&#39;ve been the most efficient choice here (I think?)"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 136, "user_id": 10339521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e86d72af9f77e310c9e902d135cae3?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan L", "link": "https://stackoverflow.com/users/10339521/dylan-l"}, "edited": false, "score": 0, "creation_date": 1536851777, "post_id": 52305086, "comment_id": 91581009, "body": "@DylanL I still believe doing this manually is the least time consuming and most effective method. It would take a couple of minutes"}, {"owner": {"reputation": 136, "user_id": 10339521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e86d72af9f77e310c9e902d135cae3?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan L", "link": "https://stackoverflow.com/users/10339521/dylan-l"}, "edited": false, "score": 0, "creation_date": 1536853140, "post_id": 52305086, "comment_id": 91581763, "body": "I believe that statement is mostly true. Only case where I could see a user benefiting from a script approach here is if they are dealing with a few hundred thousand records where excel may start to freeze up on every sort and filter. However at that point it may make sense to move onto a different language..."}, {"owner": {"reputation": 31, "user_id": 10355576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19645465905bf88a2cbdcc3ed27d4635?s=128&d=identicon&r=PG&f=1", "display_name": "Luke P", "link": "https://stackoverflow.com/users/10355576/luke-p"}, "edited": false, "score": 0, "creation_date": 1536860837, "post_id": 52305086, "comment_id": 91585706, "body": "Hey, The reason I&#39;m not doing this manually is because its a part of a much larger macro. All the solutions suggested on this post worked with the sample data, however when I apply it to my actual data it errors out and fails. I&#39;m going to add additional images explaining the failure to the original post if someone can take a look and explain what&#39;s happening."}], "tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": false, "score": 0, "last_activity_date": 1536798592, "creation_date": 1536798592, "answer_id": 52305086, "question_id": 52304075, "link": "https://stackoverflow.com/questions/52304075/vba-how-to-find-a-specific-number-based-on-variable-then-priority/52305086#52305086", "title": "VBA How to find a Specific Number based on Variable then Priority", "body": "<p>You can have different approaches. In this method I copy the data to another sheet called <code>Result</code>, then insert a table, sort the columns and then collect the range where the rows are more than 6 and then delete the whole rows at once, it will be really fast:</p>\n\n<pre><code>Sub Main()\n    Dim i As Long\n    Dim rng As Range\n    Dim tbl As ListObject\n    Dim WS As Worksheet\n    Dim WS2 As Worksheet\n\n    Set WS = Worksheets(\"Sheet1\") 'this is where you have the data\n    Set WS2 = Worksheets.Add\n    WS2.Name = \"Result\"\n\n    WS.Range(\"A1\").CurrentRegion.Copy\n    WS2.Paste\n\n    'sort priority column first\n    WS2.ListObjects.Add(xlSrcRange, Range(WS2.UsedRange.Address), , xlYes).Name = \"Table1\"\n    Set tbl = WS2.ListObjects(\"Table1\")\n\n    tbl.Sort.SortFields.Add _\n        Key:=Range(\"Table1[[#All],[Priority]]\"), SortOn:=xlSortOnValues, Order:= _\n        xlAscending, DataOption:=xlSortNormal\n    With tbl.Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\n    'sort station column\n    tbl.Sort.SortFields.Clear\n    tbl.Sort.SortFields.Add _\n        Key:=Range(\"Table1[[#All],[Station]]\"), SortOn:=xlSortOnValues, Order:= _\n        xlAscending, DataOption:=xlSortNormal\n    With tbl.Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\n    'remove any row exceeding 6th occurrence\n    Dim cnt As Integer\n\n\n    For i = 1 To tbl.ListRows.Count - 1\n        If tbl.ListColumns(\"Station\").DataBodyRange(i, 1).Value = tbl.ListColumns(\"Station\").DataBodyRange(i + 1, 1).Value Then\n            cnt = cnt + 1\n            If cnt &gt;= 6 Then\n                If rng Is Nothing Then\n                    Set rng = tbl.ListColumns(\"Station\").DataBodyRange(i + 1, 1)\n                Else\n                    Set rng = Application.Union(rng, tbl.ListColumns(\"Station\").DataBodyRange(i + 1, 1))\n                End If\n            End If\n        Else\n            cnt = 0 'reset the counter\n        End If\n    Next i\n\n    'remove rows\n    If Not rng Is Nothing Then\n        tbl.Unlist\n        rng.EntireRow.Delete\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1536825066, "creation_date": 1536825066, "answer_id": 52309005, "question_id": 52304075, "link": "https://stackoverflow.com/questions/52304075/vba-how-to-find-a-specific-number-based-on-variable-then-priority/52309005#52309005", "title": "VBA How to find a Specific Number based on Variable then Priority", "body": "<p>here's a solution exploiting Array, Dictionary and SortedList object, that shuold be quite fast:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n\n    Dim wsData As Worksheet: Set wsData = ActiveWorkbook.Sheets(\"copy\")    'This is where your data is'\n    Dim wsDest As Worksheet: Set wsDest = ActiveWorkbook.Sheets(\"Sheet6\")    'This is where you want to output\n\n    Dim stations As Variant, station As Variant\n    Dim iStation As Long\n    Dim stationsList As Object: Set stationsList = CreateObject(\"Scripting.Dictionary\") ' use dictionary to collect unique station values\n\n    With wsData\n        stations = .Range(\"B2\", .Cells(.Rows.Count, 2).End(xlUp)).Resize(, 3).Value\n        For iStation = 1 To UBound(stations, 1)\n            stationsList(stations(iStation, 1)) = stationsList(stations(iStation, 1)) &amp; stations(iStation, 2) &amp; \"|\" &amp; stations(iStation, 3) &amp; \" \" ' update current station priorities list and orders\n        Next\n    End With\n\n\n    Dim prioritiesAndOrders As Variant, priorityAndOrder As Variant, priority As Variant, order As Variant\n    Dim iPriority As Long, nPriorities As Long\n    For Each station In stationsList.Keys ' loop through unique stations\n        prioritiesAndOrders = Split(Trim(stationsList(station)), \" \") ' get current station priorities and corresponding orders list\n\n        With CreateObject(\"System.Collections.SortedList\") ' cerate and reference a sortedList object (it stores keys in ascending order)\n            For Each priorityAndOrder In prioritiesAndOrders ' loop through current station priorities and corresponding orders list\n                priority = Split(priorityAndOrder, \"|\")(0) ' get current priority\n                order = Split(priorityAndOrder, \"|\")(1) 'get current priority corresponding order\n                .Add priority, order ' store current priority as \"key\" of SortedList object and its corresponding order as its value\n            Next\n\n            nPriorities = WorksheetFunction.Min(.Count - 1, 5) ' define the current station number of priorities to manage\n            ReDim results(1 To nPriorities + 1, 1 To 3) As Variant ' size results array accordingly\n            For iPriority = 0 To nPriorities ' loop through current station sorted priorities (and corresponding orders) and fill results array with current station in column 1, its priorities in column 2 and priority corresponding order in column 3\n                results(iPriority + 1, 1) = station\n                results(iPriority + 1, 2) = .GetKey(iPriority)\n                results(iPriority + 1, 3) = .GetValueList()(iPriority)\n            Next\n        End With\n        wsDest.Cells(wsDest.Rows.Count, 1).End(xlUp).Offset(1).Resize(nPriorities + 1, 3).Value = results ' write current station sorted priorities\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10355576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19645465905bf88a2cbdcc3ed27d4635?s=128&d=identicon&r=PG&f=1", "display_name": "Luke P", "link": "https://stackoverflow.com/users/10355576/luke-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 421, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1536861276, "creation_date": 1536789676, "last_edit_date": 1536861276, "question_id": 52304075, "link": "https://stackoverflow.com/questions/52304075/vba-how-to-find-a-specific-number-based-on-variable-then-priority", "title": "VBA How to find a Specific Number based on Variable then Priority", "body": "<p>I am trying to build a excel vba code that looks at data from three columns, takes the lowest 6 values of each variable (which there are four of) and also takes the adjacent column and pastes it in another sheet.</p>\n\n<p>This is the input:<br>\n<img src=\"https://i.stack.imgur.com/LjZme.png\" alt=\"INPUT\"></p>\n\n<p>This is what I would like the output to be:<br>\n<img src=\"https://i.stack.imgur.com/nKHZV.png\" alt=\"Desired Output\"> !</p>\n\n<p>This is what the output actually is:<br>\n<a href=\"https://i.stack.imgur.com/SJyWW.png\" rel=\"nofollow noreferrer\">Actual Output</a></p>\n\n<p>I stole a lot of this code from another post I saw, but it seems to be acting very randomly. <strong>I'm still not quite sure what the code is even doing</strong>, which is what makes it hard for me. </p>\n\n<p>Any advice will help tremendously.</p>\n\n<p>UPDATE: Using Ibo's fix on my sample data, it worked perfectly, however on my actual data it errored out. The reason I am doing this through a macro instead of manually is because it is a part of a much larger macro that is getting pieced together to predict production consumption of various raw materials and what needs to get staged.</p>\n\n<p>Here's what happened: </p>\n\n<p><a href=\"https://i.stack.imgur.com/4y89y.png\" rel=\"nofollow noreferrer\">Actual Input Data</a>  </p>\n\n<p><a href=\"https://i.stack.imgur.com/GQwXD.png\" rel=\"nofollow noreferrer\">Error 1004 Message and highlighted code</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/qdrNm.png\" rel=\"nofollow noreferrer\">Output after failure</a></p>\n\n<p>It looks like it got close, but didn't finish with the actual sort.</p>\n\n<pre><code>Sub TopPriorityPerPod()\n\n    Dim wsData As Worksheet\n    Dim wsDest As Worksheet\n    Dim rngData As Range\n    Dim rngFound As Range\n    Dim rngUnqGroups As Range\n    Dim GroupCell As Range\n    Dim lCalc As XlCalculation\n    Dim aResults() As Variant\n    Dim aOriginal As Variant\n    Dim lNumTopEntries As Long\n    Dim i As Long, j As Long, k As Long\n\n    'Change to grab the top X number of entries per category'\n    lNumTopEntries = 6\n\n    Set wsData = ActiveWorkbook.Sheets(\"copy\")    'This is where your data is'\n    Set wsDest = ActiveWorkbook.Sheets(\"Sheet6\")    'This is where you want to output it'\n\n    Set rngData = wsData.Range(\"A2\", wsData.Cells(Rows.Count, \"C\").End(xlUp))\n    aOriginal = rngData.Value   'Store original values so you can set them back later'\n\n    'Turn off calculation, events, and screenupdating'\n    'This allows code to run faster and prevents \"screen flickering\"'\n    With Application\n        lCalc = .Calculation\n        .Calculation = xlCalculationManual\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\n    'If there are any problems with the code, make sure the calculation, events, and screenupdating get turned back on'\n    'On Error GoTo CleanExit\n\n    With rngData\n        '.Sort .Resize(, 1).Offset(, 1), xlAscending, .Resize(, 1).Offset(, 2), , xlDescending, Header:=xlYes\n        .Sort .Resize(, 1).Offset(, 1), xlDescending, Header:=xlYes\n    End With\n\n    With rngData.Resize(, 1).Offset(, 1)\n        .AdvancedFilter xlFilterInPlace, , , True\n        Set rngUnqGroups = .Offset(1).Resize(.Rows.Count - 1).SpecialCells(xlCellTypeVisible)\n        .Parent.ShowAllData 'Remove the filter\n\n        ReDim aResults(1 To rngUnqGroups.Cells.Count * lNumTopEntries, 1 To 4)\n        i = 0\n\n        For Each GroupCell In rngUnqGroups\n            Set rngFound = .Find(GroupCell.Value, .Cells(.Cells.Count))\n            k = 0\n            If Not rngFound Is Nothing Then\n                For j = i + 1 To i + lNumTopEntries\n                    If rngFound.Offset(j - i - 1).Value = GroupCell.Value Then\n                        k = k + 1\n                        aResults(j, 1) = rngFound.Offset(j - i - 1, -1).Value\n                        aResults(j, 2) = rngFound.Offset(j - i - 1).Value\n                        aResults(j, 3) = rngFound.Offset(j - i - 1, 1).Value\n                        aResults(j, 4) = rngFound.Offset(j - i - 1, 2).Value\n                    End If\n                Next j\n                i = i + k\n            End If\n        Next GroupCell\n    End With\n\n    'Output results'\n    wsDest.Range(\"A2\").Resize(UBound(aResults, 1), UBound(aResults, 2)).Value = aResults\n\n    CleanExit:\n    'Turn calculation, events, and screenupdating back on'\n    With Application\n        .Calculation = lCalc\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\n\n    If Err.Number &lt;&gt; 0 Then\n        'There was an error, show the error'\n        MsgBox Err.Description, , \"Error: \" &amp; Err.Number\n        Err.Clear\n    End If\n\n    'Put data back the way it was\n    rngData.Value = aOriginal\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "pivot-table", "slicers"], "comments": [{"owner": {"reputation": 31, "user_id": 10344640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9038f09af36ae8b4c66a0b031ab23f19?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/10344640/chris"}, "edited": false, "score": 0, "creation_date": 1536795699, "post_id": 52303772, "comment_id": 91557110, "body": "I went back to the code that creates the Pivot Tables and noticed that it creates a PivotTableCache for each Pivot Table, could that have anything to do with it?"}, {"owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 0, "creation_date": 1536802850, "post_id": 52303772, "comment_id": 91558354, "body": "It could. I&#39;d suggest that you have a look at all of the different objects in your immediate window (i.e. debug window), and see which one isn&#39;t coming up as an object and so is throwing the error. For more on how to do that, see <a href=\"https://www.excelcampus.com/vba/vba-immediate-window-excel/\" rel=\"nofollow noreferrer\">this</a>. By the way, part of what I don&#39;t understand is that it appears that you&#39;re already adding the pivot tables by &quot;creating a slicer for each&quot; before you get into all this, just the other way around. What are you doing different here?"}, {"owner": {"reputation": 31, "user_id": 10344640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9038f09af36ae8b4c66a0b031ab23f19?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/10344640/chris"}, "reply_to_user": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 0, "creation_date": 1536804051, "post_id": 52303772, "comment_id": 91558596, "body": "You are correct, I am now re-thining this. Before I would get a list of PTs then create a PivotCache &amp; PT for each one. Then create a slicer for each PT. Then try and link each Slicer to every other PT. But now I am going to try and create One PivotCache and use it to create each PT. Then create One SlicerCache and use it for each Slicer. If all the PTs have the same PTCache and i use a PT to create a SlicerCache, and create every Slicer using that SC then I <i>HOPE</i> they will all connect. This is my first time programming with PT, Caches, and Slicers so i have no idea what I am doing."}, {"owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 0, "creation_date": 1536805210, "post_id": 52303772, "comment_id": 91558868, "body": "The doc&#39;s a bit flimsy on what matches up with what, too. I&#39;d say debug will be your friend there, so you can evaluate individual values in individual items and compare them."}, {"owner": {"reputation": 31, "user_id": 10344640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9038f09af36ae8b4c66a0b031ab23f19?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/10344640/chris"}, "reply_to_user": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 0, "creation_date": 1536806386, "post_id": 52303772, "comment_id": 91559113, "body": "I agree. Right now I am just throwing everything on the wall to see what sticks. I&#39;ll update once more to show where I am now."}, {"owner": {"reputation": 31, "user_id": 10344640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9038f09af36ae8b4c66a0b031ab23f19?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/10344640/chris"}, "reply_to_user": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 0, "creation_date": 1536807976, "post_id": 52303772, "comment_id": 91559437, "body": "@BobRodes BTW I appreciate your help on this today"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10344640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9038f09af36ae8b4c66a0b031ab23f19?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/10344640/chris"}, "edited": false, "score": 0, "creation_date": 1536790480, "post_id": 52304142, "comment_id": 91555920, "body": "If I understand you correctly then it should be: &gt; SlicerCaches(objSlicer.name) ?"}, {"owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "reply_to_user": {"reputation": 31, "user_id": 10344640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9038f09af36ae8b4c66a0b031ab23f19?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/10344640/chris"}, "edited": false, "score": 0, "creation_date": 1536790586, "post_id": 52304142, "comment_id": 91555946, "body": "@Chris I was just going to edit to suggest that. I&#39;m sorry, I&#39;ve never worked with the <code>SlicerCaches</code> and <code>Slicers</code> collections myself and I can&#39;t test it, but that&#39;s what I&#39;d try."}, {"owner": {"reputation": 31, "user_id": 10344640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9038f09af36ae8b4c66a0b031ab23f19?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/10344640/chris"}, "edited": false, "score": 0, "creation_date": 1536790797, "post_id": 52304142, "comment_id": 91556006, "body": "I replaced it with this:      wkbDash.SlicerCaches(objSlicer.name).PivotTables.AdPivotTabl&zwnj;&#8203;e (wksPivots.PivotTables(varPTNames(i,1))) but am still getting the Error #424 Object Required Error"}, {"owner": {"reputation": 31, "user_id": 10344640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9038f09af36ae8b4c66a0b031ab23f19?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/10344640/chris"}, "edited": false, "score": 0, "creation_date": 1536790860, "post_id": 52304142, "comment_id": 91556020, "body": "Thanks for the suggestion. I tried that but am still getting the same error"}, {"owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "reply_to_user": {"reputation": 31, "user_id": 10344640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9038f09af36ae8b4c66a0b031ab23f19?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/10344640/chris"}, "edited": false, "score": 0, "creation_date": 1536791817, "post_id": 52304142, "comment_id": 91556274, "body": "@Chris I had to read up on the object model. What I have up there now shouldn&#39;t get the error, but I&#39;m not sure it&#39;s what you want. If it doesn&#39;t do what you want, please explain."}, {"owner": {"reputation": 31, "user_id": 10344640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9038f09af36ae8b4c66a0b031ab23f19?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/10344640/chris"}, "edited": false, "score": 0, "creation_date": 1536792427, "post_id": 52304142, "comment_id": 91556420, "body": "I tried your alternative and received a Error #438 Object doesn&#39;t support this property or method on line:      objSlicerCache.Slicers(i).PivotTables.AddPivotTable (wksPivots.PivotTables(varPTNames(j, 1)))"}, {"owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "reply_to_user": {"reputation": 31, "user_id": 10344640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9038f09af36ae8b4c66a0b031ab23f19?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/10344640/chris"}, "edited": false, "score": 0, "creation_date": 1536792531, "post_id": 52304142, "comment_id": 91556457, "body": "@Chris Yeah, I did a little more reading and edited my answer, explaining why. <code>PivotTables</code> are associated wtih <code>SlicerCache</code>, not <code>Slicer</code>. So no, the <code>Slicer</code> object doesn&#39;t support the <code>PivotTables</code> property. Why do you want it to, exactly?"}, {"owner": {"reputation": 31, "user_id": 10344640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9038f09af36ae8b4c66a0b031ab23f19?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/10344640/chris"}, "edited": false, "score": 0, "creation_date": 1536793455, "post_id": 52304142, "comment_id": 91556641, "body": "Because I&#39;m ignorant. I just want the slicer to filter multiple Pivot Tables like when you hook them to multiple PTs via the connections. I will try and rewrite the loop to loop on the SlicerCaches."}, {"owner": {"reputation": 31, "user_id": 10344640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9038f09af36ae8b4c66a0b031ab23f19?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/10344640/chris"}, "edited": false, "score": 0, "creation_date": 1536793894, "post_id": 52304142, "comment_id": 91556718, "body": "I have updated my question with the proposed loop and error received"}], "tags": [], "owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "is_accepted": false, "score": 0, "last_activity_date": 1536792208, "last_edit_date": 1536792208, "creation_date": 1536790117, "answer_id": 52304142, "question_id": 52303772, "link": "https://stackoverflow.com/questions/52303772/cannot-connect-slicer-to-multiple-pivot-tables-error-424-object-required/52304142#52304142", "title": "Cannot Connect Slicer to Multiple Pivot Tables - Error #424 &quot;Object Required&quot;", "body": "<p>Looking at <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.slicercaches\" rel=\"nofollow noreferrer\">this doc</a> it's evident that you have a syntax problem. To get an individual <code>Slicer</code> object:</p>\n\n<pre><code>wkbDash.SlicerCaches(\"someString\")\n</code></pre>\n\n<p>This is consistent with general <code>Collection</code> syntax:</p>\n\n<pre><code>myCollection(\"aKeyValue\")\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>myCollection(anOffsetInteger)\n</code></pre>\n\n<p>You are putting an object reference as the key value, rather than a string or integer. </p>\n\n<p>Now, <code>PivotTables</code> is a collection associated with a single <code>SlicerCache</code> object. Your outer <code>For Each</code> is iterating through these, so if you're going to add a pivot table in each iteration, you need to do it to your iterated object, so:</p>\n\n<pre><code>For Each objSlicerCache In Workbooks(sDash).SlicerCaches\n    For i = LBound(varPTNames) To UBound(varPTNames)\n           objSlicerCache.PivotTables.AddPivotTable (wksPivots.PivotTables(varPTNames(i, 1)))\n    Next i\nNext objSlicerCache\n</code></pre>\n\n<p>You can't iterate the <code>Slicers</code> collection in each <code>SlicerCache</code> object inside the loop, and add the pivot table to the individual <code>Slicer</code> objects, because the object model isn't set up to associate a <code>Slicer</code> object directly with a <code>PivotTable</code> object. If you look in the doc, you'll see that the <code>SlicerCache</code> object has a <code>PivotTables</code> property, while the <code>Slicers</code> and <code>Slicer</code> objects do not.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 10344640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9038f09af36ae8b4c66a0b031ab23f19?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/10344640/chris"}, "is_accepted": false, "score": 0, "last_activity_date": 1536846894, "creation_date": 1536846894, "answer_id": 52315310, "question_id": 52303772, "link": "https://stackoverflow.com/questions/52303772/cannot-connect-slicer-to-multiple-pivot-tables-error-424-object-required/52315310#52315310", "title": "Cannot Connect Slicer to Multiple Pivot Tables - Error #424 &quot;Object Required&quot;", "body": "<p><strong>Problem Solved</strong><br>\nCode steps:<br>\n1. Create Pivot Tables from one Pivot Cache<br>\n2. For each Pivot Table, create a Slicer Cache<br>\n3. For each Slicer Cache, create a Slicer<br>\n4. For each Slicer Cache, loop through Pivot Tables and add them to the SC</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>' Procedure\n\n    For Each objSlicerCache In wkbDash.SlicerCaches\n        objSlicerCache.Delete\n    Next objSlicerCache\n\n    varSlicers = wksDefPivots.Range(\"A2:B\" &amp; CStr(FindLastRow(wksDefPivots))).Value2\n    For i = LBound(varSlicers, 1) To UBound(varSlicers, 1)\n        Set objPT = Worksheets(sPivots).PivotTables(CStr(varSlicers(i, 1)))\n        Set objPF = Worksheets(sPivots).PivotTables(CStr(varSlicers(i, 1))).PivotFields(CStr(varSlicers(i, 2)))\n        Set objSlicerCache = wkbDash.SlicerCaches.Add(objPT, objPF.Name) 'Create SlicerCache for each Pivot Table\n    Next i\n\n    For Each objSlicerCache In wkbDash.SlicerCaches\n        For Each objPT In objSlicerCache.PivotTables\n            objSlicerCache.Slicers.Add wksSlicers, , objPT.Name, objPT.Name, 1, 1, 50, 100 'Add Slicers for each Pivot Table\n        Next objPT\n    Next objSlicerCache\n\n    Set objSlicerCache = Nothing\n    Set objPT = Nothing\n\n    Call FormatSlicers(sSlicers) 'Format size &amp; location of slicers\n\n   For Each objSlicerCache In wkbDash.SlicerCaches\n        For Each objPT In wksPivots.PivotTables\n                objSlicerCache.PivotTables.AddPivotTable objPT 'Add every Pivot Table to every SlicerCache\n        Next objPT\n    Next objSlicerCache\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10344640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9038f09af36ae8b4c66a0b031ab23f19?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/10344640/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 790, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1536846894, "creation_date": 1536787963, "last_edit_date": 1536807142, "question_id": 52303772, "link": "https://stackoverflow.com/questions/52303772/cannot-connect-slicer-to-multiple-pivot-tables-error-424-object-required", "title": "Cannot Connect Slicer to Multiple Pivot Tables - Error #424 &quot;Object Required&quot;", "body": "<p>I am trying to connect a Slicer to multiple Pivot Tables using the method described here: <a href=\"http://dailydoseofexcel.com/archives/2014/08/05/slicers-and-slicercaches/\" rel=\"nofollow noreferrer\">http://dailydoseofexcel.com/archives/2014/08/05/slicers-and-slicercaches/</a></p>\n\n<p>First, I loop through my Pivot Tables and create a slicer for each:</p>\n\n<pre><code>wkbDash.SlicerCaches.Add(wksPivots.PivotTables(sPTName), sSlicerName). _\n    Slicers.Add wksSlicers, , sSlicerName, sSlicerName, 1, 1, 50, 100\n</code></pre>\n\n<p>Then I loop through my Slicers and try to hook them to each Pivot Table</p>\n\n<p>Problem: I am getting an Error #424 \"Object Required\" on this line:</p>\n\n<pre><code>wkbDash.SlicerCaches(objSlicer).PivotTables.AddPivotTable \n(wksPivots.PivotTables(varPTNames(i, 1)))\n</code></pre>\n\n<p>Code to hook Slicers to Pivot Tables:</p>\n\n<pre><code>' Declarations\nDim objSlicerCache  As SlicerCache\nDim objSlicer       As Slicer\nDim objPT           As PivotTable\nDim varPTNames      As Variant\nDim wksDefPivots    As Worksheet\nDim wkbDash         As Workbook\nDim i               As Integer\n\n' Initialize Variables\nSet wkbDash = Workbooks(sDash)\nSet wksDefPivots = Workbooks(sDash).Worksheets(sDefPivots)\nvarPTNames = wksDefPivots.Range(\"A2:A\" &amp; FindLastRow(wksDefPivots)).Value2\ni = 0\n\n' Procedure\n    For Each objSlicerCache In Workbooks(sDash).SlicerCaches\n        For Each objSlicer In objSlicerCache.Slicers\n            For i = LBound(varPTNames) To UBound(varPTNames)\n               wkbDash.SlicerCaches(objSlicer).PivotTables.AddPivotTable (wksPivots.PivotTables(varPTNames(i, 1)))\n            Next i\n        Next objSlicer\n    Next objSlicerCache\n</code></pre>\n\n<p>Based on Bob's comments I have modified the loop to try and hook the Pivot Tables to the SlicerCache object instead of the Slicer. I am still getting the Error #424 \"Object Required\"</p>\n\n<p>Revised Loop:</p>\n\n<pre><code>    For Each objSlicerCache In Workbooks(sDash).SlicerCaches\n        For j = LBound(varPTNames) To UBound(varPTNames)\n           objSlicerCache.PivotTables.AddPivotTable (wksPivots.PivotTables(varPTNames(j, 1)))\n        Next j\n    Next objSlicerCache\n</code></pre>\n\n<p><strong>Major Update:</strong>\nI Have revised the code and am very close. New code sequence:<br>\n   1. Create 1 PivotCache<br>\n   2. Use PivotCache to create many PivotTables<br>\n   3. Create 1 SlicerCache from first PivotTable<br>\n   4. Add additional PivotTables to SlicerCache<br>\n   5. Loop through each PivotTable in SlicerCache and create a slicer.  </p>\n\n<p>Good news: All this code works. It creates many slicers, and each slicer will filter all the Pivot Tables</p>\n\n<p><strong>The Problem:</strong> All the Slicers are only filtering One Field (See Image) rather than each slicer providingng a different field to filter.</p>\n\n<p>Code:</p>\n\n<pre><code>   For Each objSlicerCache In wkbDash.SlicerCaches\n        objSlicerCache.Delete\n    Next objSlicerCache\n\n    sRF = Worksheets(sDefPivots).Range(\"B2\").Value\n    sPT = Worksheets(sDefPivots).Range(\"A2\").Value\n\n    Set objPT = Worksheets(sPivots).PivotTables(sPT)\n    Set objPF = Worksheets(sPivots).PivotTables(sPT).PivotFields(sRF)\n\n    Set objSlicerCache = wkbDash.SlicerCaches.Add(objPT, objPF.Name)\n\n    Set objPT = Nothing\n    Set objPF = Nothing\n\n    For Each objPT In Worksheets(sPivots).PivotTables\n        objSlicerCache.PivotTables.AddPivotTable objPT\n    Next objPT\n\n    For Each objSlicerCache In wkbDash.SlicerCaches\n        For Each objPT In objSlicerCache.PivotTables\n            objSlicerCache.Slicers.Add wksSlicers, , objPT.Name, objPT.Name, 1, 1, 50, 100\n        Next objPT\n    Next objSlicerCache\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/enI4R.png\" rel=\"nofollow noreferrer\">Screenshot of Filters</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1536801493, "post_id": 52303756, "comment_id": 91558119, "body": "FWIW, your use of <code>Find</code> is problematic. Because you haven&#39;t specified anything other than the <code>What</code> parameter, you might not get the results you expect. The settings for <code>LookIn</code>, <code>LookAt</code>, <code>SearchOrder</code>, and <code>MatchByte</code> are saved each time you use this method (either the user in Excel or with VBA). If you do not specify values for these arguments the next time you call the method, the saved values are used.  Also, you are using implicit references to the <code>ActiveSheet</code>"}, {"owner": {"reputation": 39, "user_id": 9603305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd2946a28ea3815dfc18e060ce9e920a?s=128&d=identicon&r=PG&f=1", "display_name": "AJames", "link": "https://stackoverflow.com/users/9603305/ajames"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1536849540, "post_id": 52303756, "comment_id": 91579588, "body": "I will definitely look into the LookIn/LookAt - thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 9603305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd2946a28ea3815dfc18e060ce9e920a?s=128&d=identicon&r=PG&f=1", "display_name": "AJames", "link": "https://stackoverflow.com/users/9603305/ajames"}, "edited": false, "score": 0, "creation_date": 1536788472, "post_id": 52303800, "comment_id": 91555366, "body": "would that be true throughout the snippet?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 39, "user_id": 9603305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd2946a28ea3815dfc18e060ce9e920a?s=128&d=identicon&r=PG&f=1", "display_name": "AJames", "link": "https://stackoverflow.com/users/9603305/ajames"}, "edited": false, "score": 0, "creation_date": 1536788552, "post_id": 52303800, "comment_id": 91555394, "body": "If you want the last populated cell in each &#39;found&#39; column then yes, it would be true throughout. Perhaps the alternate I offered makes more sense."}, {"owner": {"reputation": 39, "user_id": 9603305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd2946a28ea3815dfc18e060ce9e920a?s=128&d=identicon&r=PG&f=1", "display_name": "AJames", "link": "https://stackoverflow.com/users/9603305/ajames"}, "edited": false, "score": 0, "creation_date": 1536788702, "post_id": 52303800, "comment_id": 91555446, "body": "yeah - i just added &quot;-1&quot; to all of them and it did work, but now the     FXval = FXrng.Offset(0, 1).Value throws off Object variable not set error.  Should this be a variant or string? the data is a number"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 39, "user_id": 9603305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd2946a28ea3815dfc18e060ce9e920a?s=128&d=identicon&r=PG&f=1", "display_name": "AJames", "link": "https://stackoverflow.com/users/9603305/ajames"}, "edited": false, "score": 0, "creation_date": 1536789160, "post_id": 52303800, "comment_id": 91555567, "body": "It would appear that cur cannot be found in Range(&quot;C:C&quot;)."}, {"owner": {"reputation": 39, "user_id": 9603305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd2946a28ea3815dfc18e060ce9e920a?s=128&d=identicon&r=PG&f=1", "display_name": "AJames", "link": "https://stackoverflow.com/users/9603305/ajames"}, "edited": false, "score": 1, "creation_date": 1536789226, "post_id": 52303800, "comment_id": 91555589, "body": "was looking at the wrong column - should have been B not C - I&#39;m all set"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1536788097, "creation_date": 1536788097, "answer_id": 52303800, "question_id": 52303756, "link": "https://stackoverflow.com/questions/52303756/using-a-row-variable-in-offset-results-in-empty/52303800#52303800", "title": "Using a row variable in offset results in &quot;Empty&quot;", "body": "<p>Your maths are wrong. You are starting at row 1 and offsetting the total number of rows so you end up 1 row beyond the populated values.</p>\n\n<pre><code>myRng.Offset(LastRow - 1, 0).Value\n'alternate\nws1.cells(LastRow, myRng.column).Value\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 9603305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd2946a28ea3815dfc18e060ce9e920a?s=128&d=identicon&r=PG&f=1", "display_name": "AJames", "link": "https://stackoverflow.com/users/9603305/ajames"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 52303800, "answer_count": 1, "score": 1, "last_activity_date": 1536849658, "creation_date": 1536787881, "last_edit_date": 1536849658, "question_id": 52303756, "link": "https://stackoverflow.com/questions/52303756/using-a-row-variable-in-offset-results-in-empty", "title": "Using a row variable in offset results in &quot;Empty&quot;", "body": "<p>I have the below code, but for some reason, the \"myRng.Offset(LastRow, 0).Value\" is \"Empty\" and therefore the calculations are not performed and I receive the Overflow error due to a divide by 0.</p>\n\n<pre><code>Dim ws1 As Worksheet, wb1 As Workbook, LastRow As Long, LastCol As Long, myCol As String\nDim RowTest As Long, myRng As Range, FXwb As Workbook, ws2 As Worksheet\nDim FXrng As Range, FXval As Variant, Cur As String\n\nLastRow = ws1.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nSet myRng = Range(\"1:1\").Find(\"LocalCurrency\")\nIf myRng.Offset(LastRow, 0).Value &lt;&gt; \"USD\" Then\n    Cur = myRng.Offset(LastRow, 0).Value\n    FXwb.Activate\n    Set FXrng = Range(\"C:C\").Find(Cur)\n    FXval = FXrng.Offset(0, 1).Value\n    wb1.Activate\n    Set myRng = Range(\"1:1\").Find(\"Commitment (USD)\")\n    myRng.Offset(LastRow, 0).Value = myRng.Offset(LastRow, -1).Value / FXval\n    Set myRng = Range(\"1:1\").Find(\"Funding (USD)\")\n    myRng.Offset(LastRow, 0).Value = myRng.Offset(LastRow, -1).Value / FXval\n    Set myRng = Range(\"1:1\").Find(\"Adjusted Valuation (USD)\")\n    myRng.Offset(LastRow, 0).Value = myRng.Offset(LastRow, -1).Value / FXval\n    Else\n    Set myRng = Range(\"1:1\").Find(\"Commitment (USD)\")\n    myRng.Offset(LastRow, 0).Value = myRng.Offset(LastRow, -1).Value\n    Set myRng = Range(\"1:1\").Find(\"Funding (USD)\")\n    myRng.Offset(LastRow, 0).Value = myRng.Offset(LastRow, -1).Value\n    Set myRng = Range(\"1:1\").Find(\"Adjusted Valuation (USD)\")\n    myRng.Offset(LastRow, 0).Value = myRng.Offset(LastRow, -1).Value\nEnd If\n</code></pre>\n\n<p>New edit - changed FXval from Long to Variant - code works perfectly now! thanks to Jeeped for the answer and Chris Neilson for the suggestions</p>\n"}, {"tags": ["object", "ms-access", "vba", "seek"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 2, "creation_date": 1536788276, "post_id": 52303535, "comment_id": 91555294, "body": "You can&#39;t use <code>Seek</code> on a recordset based on a query.  Sorry I didn&#39;t notice that in your previous question."}, {"owner": {"reputation": 55, "user_id": 9926966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQMCN.png?s=128&g=1", "display_name": "rgorowsky", "link": "https://stackoverflow.com/users/9926966/rgorowsky"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1536789418, "post_id": 52303535, "comment_id": 91555638, "body": "The query is only to get the filtered version of the id.  the ID in table 2 is a concatenation of different ID types within the database.  In this case the ID from table 1 would match to the last 10 digits of the ID in table 2.  Is it possible to just seek the table itself - but specify matching the last 10 digits?  Or If I did a separate query before this, so that Table 2 had a column of the ID that matched the style of table 1, could it be seek in that way?  I feel like seek is the best to use since the only matching value are those IDs, but they aren&#39;t Distinct in either table"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1536790697, "post_id": 52303535, "comment_id": 91555980, "body": "Why not just filter the query used in &quot;Set StrSQL1...&quot; to look for the key you need, then if no record returned, do &#39;something&#39;, else do &#39;something else&#39;?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1536791605, "post_id": 52303535, "comment_id": 91556223, "body": "@rgorowsky Wayne&#39;s suggestion sounds promising to me.  If that doesn&#39;t fit in as you wish, suggest you look into <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194787.aspx\" rel=\"nofollow noreferrer\">Recordset.FindFirst Method (DAO)</a>.  That one is not so restrictive as <code>Seek</code> --- it can be used with a recordset based on a query."}, {"owner": {"reputation": 55, "user_id": 9926966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQMCN.png?s=128&g=1", "display_name": "rgorowsky", "link": "https://stackoverflow.com/users/9926966/rgorowsky"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1536856369, "post_id": 52303535, "comment_id": 91583450, "body": "@HansUp Thanks Hans!  It&#39;s sooooo close.  The errors are gone and it appears to be parsing through - with one exception.  The line giving me issue is &#39;StrSQL1.FindFirst ([PrimaryKey] = qs.Fields(&quot;external_nmad_id&quot;))&#39;  As it loops through there is a value in the &quot;external_nmad_id&quot; object, but [PrimaryKey] whos up in the hover-over as &#39;[PrimaryKey] = &quot;&quot; &#39; Primary key is set in the query  dynaset.  When I loop through there are &#39;external_nmad_id&#39;s that match the query, and there are no errors, but the address is not parsed in..."}, {"owner": {"reputation": 55, "user_id": 9926966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQMCN.png?s=128&g=1", "display_name": "rgorowsky", "link": "https://stackoverflow.com/users/9926966/rgorowsky"}, "edited": false, "score": 0, "creation_date": 1536856409, "post_id": 52303535, "comment_id": 91583472, "body": "Set StrSQL1 = db.OpenRecordset(&quot;SELECT RIGHT(IRSfileFormatKey, 10) As PrimaryKey FROM 1042s_FinalOutput_7;&quot;, dbOpenDynaset) StrSQL1.FindFirst ([PrimaryKey] = qs.Fields(&quot;external_nmad_id&quot;))"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1536856765, "post_id": 52303535, "comment_id": 91583641, "body": "@rgorowsky Please revise the question to reflect the current state of the problem.  The update may attract additional helper eyes."}, {"owner": {"reputation": 55, "user_id": 9926966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQMCN.png?s=128&g=1", "display_name": "rgorowsky", "link": "https://stackoverflow.com/users/9926966/rgorowsky"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1536858269, "post_id": 52303535, "comment_id": 91584406, "body": "@HansUp I was not referencing the field that would be amending in StrSQL1 - but now it works!  Looks good now, now I just gotta see if it&#39;ll loop through 150,000 records without crashing"}], "answers": [{"tags": [], "owner": {"reputation": 55, "user_id": 9926966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQMCN.png?s=128&g=1", "display_name": "rgorowsky", "link": "https://stackoverflow.com/users/9926966/rgorowsky"}, "is_accepted": false, "score": 1, "last_activity_date": 1536858600, "creation_date": 1536858600, "answer_id": 52318627, "question_id": 52303535, "link": "https://stackoverflow.com/questions/52303535/access-vba-how-can-i-seek-a-value-in-a-recordset-error-code-3251-operation-i/52318627#52318627", "title": "Access VBA how can I .Seek a value in a recordset, error code &#39;3251&#39; operation is not supported for this type of object", "body": "<p>Thanks to @Hansup for providing guidance, the final \"working\" code looks like this:</p>\n\n<pre><code>Public Sub EditFinalOutput2()\n\n'set variables\nDim i As Long\nDim qs As DAO.Recordset\nDim ss As DAO.Recordset\nDim StrSQL1 As DAO.Recordset\nDim IRSfileFormatKey As String\nDim external_nmad_id As String\nDim nmad_address_1 As String\nDim nmad_address_2 As String\nDim nmad_address_3 As String\nDim mytestwrite As String\nDim PrimaryKey As String\nDim box13c_Address As String\n\n'open reference set\nSet db = CurrentDb\nSet qs = db.OpenRecordset(\"SunstarAccountsInWebir_SarahTest\")\n\n'turn popup messages off\nDoCmd.SetWarnings False\n\nWith qs.Fields\nintCount = qs.RecordCount - 1\nFor i = 0 To intCount\n\nIf (IsNull(!nmad_address_1) Or (!nmad_address_1 = !nmad_city) Or (!nmad_address_1 = !Webir_Country) And IsNull(!nmad_address_2) Or (!nmad_address_2 = !nmad_city) Or (!nmad_address_2 = !Webir_Country) And IsNull(!nmad_address_3) Or (!nmad_address_3 = !nmad_city) Or (!nmad_address_3 = !Webir_Country)) Then\nDoCmd.RunSQL \"INSERT INTO Addresses_ToBeReviewed SELECT SunstarAccountsInWebir_SarahTest.* FROM SunstarAccountsInWebir_SarahTest WHERE (((SunstarAccountsInWebir_SarahTest.external_nmad_id)='\" &amp; qs!external_nmad_id &amp; \"'));\"\n\nElse:\n    Set StrSQL1 = db.OpenRecordset(\"SELECT RIGHT([1042s_FinalOutput_7].IRSfileFormatKey,  10) As PrimaryKey, box13c_Address FROM 1042s_FinalOutput_7;\", dbOpenDynaset)\n    StrSQL1.FindFirst ([PrimaryKey] = qs.Fields(\"external_nmad_id\"))\n\n        If StrSQL1.NoMatch Then\n        DoCmd.RunSQL \"INSERT INTO Addresses_NotUsed SELECT SunstarAccountsInWebir_SarahTest.* FROM SunstarAccountsInWebir_SarahTest WHERE (((SunstarAccountsInWebir_SarahTest.external_nmad_id)='\" &amp; qs!external_nmad_id &amp; \"'));\"\n\n        Else:\n                StrSQL1.Edit\n                StrSQL1.Fields(\"box13c_Address\") = qs.Fields(\"nmad_address_1\") &amp; qs.Fields(\"nmad_address_2\") &amp; qs.Fields(\"nmad_address_3\")\n                StrSQL1.Update\n\n        End If\n\nEnd If\n\nqs.MoveNext\nNext i\n\nEnd With\n\n'turn popup messages back on\nDoCmd.SetWarnings True\n\n'close reference set\nqs.Close\nSet qs = Nothing\nss.Close\nSet ss = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 9926966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQMCN.png?s=128&g=1", "display_name": "rgorowsky", "link": "https://stackoverflow.com/users/9926966/rgorowsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 751, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594629201, "creation_date": 1536786666, "last_edit_date": 1594629201, "question_id": 52303535, "link": "https://stackoverflow.com/questions/52303535/access-vba-how-can-i-seek-a-value-in-a-recordset-error-code-3251-operation-i", "title": "Access VBA how can I .Seek a value in a recordset, error code &#39;3251&#39; operation is not supported for this type of object", "body": "<p>I'm having difficulty writing VBA to accomplish a couple goals:\n1. loop through address table (\"SunstarAccountsInWebir_SarahTest\") to separate out valid from invalid addresses.  if invalid - export to different table.\n2. If valid, match the address values to a 2nd table.  If it matches, then insert the address values into the 2nd table.<br>\n3. If it doesn't match, then export to another different table</p>\n\n<p>The issue I'm getting is the exporting works, but I'm not seeing any action on condition 2 \"valid address where it's ID is in the 2nd table\".  I'm trying to use seek method to see if the ID from the first table is in the 2nd table - and have it update as many times as it occurs (ID's are not unique in both tables).  And I can't use two nested loops because the tables are too large.  Below is the code as of now.  I'm returning an error where it says: StrSQL1.Index = \"blablavalue\"</p>\n\n<pre><code>Public Sub EditFinalOutput2()\n\n'set variables\nDim i As Long\nDim qs As DAO.Recordset\nDim ss As DAO.Recordset\nDim StrSQL1 As DAO.Recordset\nDim IRSfileFormatKey As String\nDim external_nmad_id As String\nDim nmad_address_1 As String\nDim nmad_address_2 As String\nDim nmad_address_3 As String\nDim mytestwrite As String\n\n'open reference set\nSet db = CurrentDb\nSet qs = db.OpenRecordset(\"SunstarAccountsInWebir_SarahTest\")\n\nWith qs.Fields\nintCount = qs.RecordCount - 1\nFor i = 0 To intCount\n\nIf (IsNull(!nmad_address_1) Or (!nmad_address_1 = !nmad_city) Or (!nmad_address_1 = !Webir_Country) And IsNull(!nmad_address_2) Or (!nmad_address_2 = !nmad_city) Or (!nmad_address_2 = !Webir_Country) And IsNull(!nmad_address_3) Or (!nmad_address_3 = !nmad_city) Or (!nmad_address_3 = !Webir_Country)) Then\nDoCmd.RunSQL \"INSERT INTO Addresses_ToBeReviewed SELECT SunstarAccountsInWebir_SarahTest.* FROM SunstarAccountsInWebir_SarahTest WHERE (((SunstarAccountsInWebir_SarahTest.external_nmad_id)='\" &amp; qs!external_nmad_id &amp; \"'));\"\n\nElse:\n    Set StrSQL1 = db.OpenRecordset(\"SELECT RIGHT(IRSfileFormatKey, 10) As blablavalue FROM 1042s_FinalOutput_7;\", dbOpenDynaset)\n    Set ss = db.OpenRecordset(\"1042s_FinalOutput_7\")\n    StrSQL1.Index = \"blablavalue\"\n    StrSQL1.Seek \"=\", !external_nmad_id\n\n        If ss.NoMatch Then\n        DoCmd.RunSQL \"INSERT INTO Addresses_NotUsed SELECT SunstarAccountsInWebir_SarahTest.* FROM SunstarAccountsInWebir_SarahTest WHERE (((SunstarAccountsInWebir_SarahTest.external_nmad_id)='\" &amp; qs!external_nmad_id &amp; \"'));\"\n\n        Else:   Set ss = db.OpenRecordset(\"1042s_FinalOutput_7\")\n                ss.Edit\n                ss.Fields(\"box13c_Address\") = qs.Fields(\"nmad_address_1\") &amp; qs.Fields(\"nmad_address_2\") &amp; qs.Fields(\"nmad_address_3\")\n                ss.Update\n\n        End If\nEnd If\n\nqs.MoveNext\nNext i\n\nEnd With\n\n'close reference set\nqs.Close\nSet qs = Nothing\nss.Close\nSet ss = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1536787718, "post_id": 52303426, "comment_id": 91555068, "body": "You mean &quot;...paste it in <code>E6:H6</code>&quot;, right?"}, {"owner": {"reputation": 5, "user_id": 10355404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88df7b6bf20004a6c345a02a6d1b6d0b?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Y", "link": "https://stackoverflow.com/users/10355404/mike-y"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1536788187, "post_id": 52303426, "comment_id": 91555258, "body": "Yes, sorry for the confusion!"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10355404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88df7b6bf20004a6c345a02a6d1b6d0b?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Y", "link": "https://stackoverflow.com/users/10355404/mike-y"}, "edited": false, "score": 0, "creation_date": 1536788446, "post_id": 52303781, "comment_id": 91555356, "body": "This worked flawlessly; thank you! I didn&#39;t think to look for a value in the D column. Thank you, thank you, thank you!"}], "tags": [], "owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "is_accepted": true, "score": 1, "last_activity_date": 1536788032, "creation_date": 1536788032, "answer_id": 52303781, "question_id": 52303426, "link": "https://stackoverflow.com/questions/52303426/cut-and-paste-looping-w-vba-help-needed/52303781#52303781", "title": "Cut and Paste looping w/ VBA help needed", "body": "<p>This is specific to your use case, but it should work. More effort could be applied to making the ranges fully qualified and dynamic.</p>\n\n<pre><code>Sub testLoop()\n\n    Dim rng As Range\n    Dim c As Range\n\n    Set rng = Intersect(ActiveSheet.UsedRange, Range(\"E:E\"))\n\n    For Each c In rng\n\n        If c.Value = \"\" And c.Offset(0, -1) &lt;&gt; \"\" Then\n            c.Offset(1, -3).Resize(1, 4).Cut c\n        End If\n\n    Next c\n\n    rng.SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n\nEnd Sub\n</code></pre>\n\n<p>It goes through column E looking for blank cells where there is a value in D. when it finds one, it cuts the offset range from the row below and pastes it in E. Then at the end it deletes the empty rows.</p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1536788076, "creation_date": 1536788076, "answer_id": 52303795, "question_id": 52303426, "link": "https://stackoverflow.com/questions/52303426/cut-and-paste-looping-w-vba-help-needed/52303795#52303795", "title": "Cut and Paste looping w/ VBA help needed", "body": "<p>Untested:</p>\n\n<pre><code>Dim C As Range\nFor each c in activesheet.range(\"a2:a17\").cells\n    if len(c.value) = 0 then c.offset(0, 1).resize(1, 4).cut _\n           c.offset(-1, 4)\nnext c\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10355404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88df7b6bf20004a6c345a02a6d1b6d0b?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Y", "link": "https://stackoverflow.com/users/10355404/mike-y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 52303781, "answer_count": 2, "score": 0, "last_activity_date": 1536788076, "creation_date": 1536786024, "last_edit_date": 1536787808, "question_id": 52303426, "link": "https://stackoverflow.com/questions/52303426/cut-and-paste-looping-w-vba-help-needed", "title": "Cut and Paste looping w/ VBA help needed", "body": "<p>I'm hoping you can assist me with creating a VBA macro. I have a spreadsheet that has some formatting errors that I'm attempting to fix. I want to look for an empty range of cells (in the provided example, E6:H6). If the range is empty, I want to cut part of the data from the row directly below it (B7:E7) and paste it in E6. </p>\n\n<p>Example Spreadsheet</p>\n\n<p><a href=\"https://i.stack.imgur.com/Zsoiw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Zsoiw.png\" alt=\"enter image description here\"></a></p>\n\n<p>I've got the code to do this, however I can't figure out how to loop the macro to continue looking for additional instances. Here's the VBA I have so far.</p>\n\n<pre><code>Sub Range_Cut()\n\nRange(\"B7:E7\").Cut Range(\"E6:H6\")\n\nEnd Sub\n</code></pre>\n\n<p>Any help would be greatly appreciated!!</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1536786353, "post_id": 52303365, "comment_id": 91554559, "body": "Your qtys are in ascending order. what&#39;s wrong with vlookup?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1536786909, "post_id": 52303365, "comment_id": 91554769, "body": "I would use a formula here, especially if it&#39;s such simple logic, as opposed to writing VBA adding complexity to the workbook where none is needed."}, {"owner": {"reputation": 93, "user_id": 5982308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/377b3335832d64b0239102d3b8f2429d?s=128&d=identicon&r=PG&f=1", "display_name": "Ultra GC", "link": "https://stackoverflow.com/users/5982308/ultra-gc"}, "edited": false, "score": 0, "creation_date": 1536786947, "post_id": 52303365, "comment_id": 91554785, "body": "@Jeeped - For certain reason, I don&#39;t want to use a vlookup formula in B13.  Instead, I rather use a VBA that does the lookup and set the value B13."}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 5982308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/377b3335832d64b0239102d3b8f2429d?s=128&d=identicon&r=PG&f=1", "display_name": "Ultra GC", "link": "https://stackoverflow.com/users/5982308/ultra-gc"}, "edited": false, "score": 0, "creation_date": 1536787665, "post_id": 52303549, "comment_id": 91555059, "body": "I get that.  What if I want the the result to be placed at a different cell... Example. C13?  Basically, setting the result at another location.  There is no function I know of in excel that allows me to do that.  That is why I am looking at VBA."}], "tags": [], "owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "is_accepted": false, "score": 0, "last_activity_date": 1536786736, "creation_date": 1536786736, "answer_id": 52303549, "question_id": 52303365, "link": "https://stackoverflow.com/questions/52303365/excel-vba-lookup/52303549#52303549", "title": "Excel VBA Lookup", "body": "<p>You could just use formula at Cell B13:  </p>\n\n<pre><code>=IF(B10&gt;A8,\"Error\",INDEX($A$2:$B$8, SUMPRODUCT(--(A2:A8&lt;=B10)),2))\n</code></pre>\n\n<p>That's for inclusive (i.e. Qty 1-9 belongs to level 1) based on the example you given.</p>\n"}, {"comments": [{"owner": {"reputation": 93, "user_id": 5982308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/377b3335832d64b0239102d3b8f2429d?s=128&d=identicon&r=PG&f=1", "display_name": "Ultra GC", "link": "https://stackoverflow.com/users/5982308/ultra-gc"}, "edited": false, "score": 0, "creation_date": 1536789112, "post_id": 52303743, "comment_id": 91555557, "body": "Thanks for the sample code and it works.  I will have to tweak a bit more but that essentially is the core.  Thanks"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1536787811, "creation_date": 1536787811, "answer_id": 52303743, "question_id": 52303365, "link": "https://stackoverflow.com/questions/52303365/excel-vba-lookup/52303743#52303743", "title": "Excel VBA Lookup", "body": "<p>Try this in the worksheet's private code sheet (right-click worksheet name tab, View Code.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Address(0, 0) = \"B12\" Then\n        On Error GoTo meh\n        Application.EnableEvents = False\n        Dim m As Variant\n        If IsNumeric(Target) Then\n            If Target &lt; 1 Or Target &gt; Application.Max(Range(\"A2:A8\")) Then\n                Target.Offset(1, 0) = \"out of range\"\n            Else\n                m = Application.Match(Target, Range(\"A1:A8\"))\n                Target.Offset(1, 0) = Cells(m, \"B\").Value\n            End If\n        End If\n    End If\n\nmeh:\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 5982308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/377b3335832d64b0239102d3b8f2429d?s=128&d=identicon&r=PG&f=1", "display_name": "Ultra GC", "link": "https://stackoverflow.com/users/5982308/ultra-gc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 52303743, "answer_count": 2, "score": 0, "last_activity_date": 1594055263, "creation_date": 1536785784, "last_edit_date": 1594055263, "question_id": 52303365, "link": "https://stackoverflow.com/questions/52303365/excel-vba-lookup", "title": "Excel VBA Lookup", "body": "<p>Trying to use VBA in Excel to perform some VLookup equivalent function.  I have this sample table:</p>\n\n<p><a href=\"https://i.stack.imgur.com/w9648.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w9648.png\" alt=\"enter image description here\"></a></p>\n\n<p>Basically, this is what I want to do:</p>\n\n<p>1) Based on the value in B12, lookup the value in table A1:A8.\n2) Set cell B13 with the lookup returned value\n3) If no match found (example, B12=100000), throw an error message.</p>\n\n<p>I am currently using a bunch of \"IF.. ElseIf\" statements and it is becoming too cumbersome to maintain.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "edited": false, "score": 0, "creation_date": 1536787951, "post_id": 52303464, "comment_id": 91555161, "body": "Thanks, Valon. I&#39;ve tried that, but that only formats the data cosmetically. In the formula bar, you can see that the data will still be in the <code>m&#47;d&#47;yyyy</code> format, which won&#39;t work unfortunately."}, {"owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "reply_to_user": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "edited": false, "score": 1, "creation_date": 1536789216, "post_id": 52303464, "comment_id": 91555585, "body": "I have updated my solution. I also realized that your second loop is redundant. you can skip it completely."}], "tags": [], "owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "is_accepted": true, "score": 2, "last_activity_date": 1536789165, "last_edit_date": 1536789165, "creation_date": 1536786217, "answer_id": 52303464, "question_id": 52303350, "link": "https://stackoverflow.com/questions/52303350/forcing-date-cells-to-retain-10-character-date-mm-dd-yyyy/52303464#52303464", "title": "Forcing Date Cells to Retain 10-character Date (&quot;mm/dd/yyyy&quot;)", "body": "<p>You are copying to column k then back to column B, jsut do it all in B in 1 step.</p>\n\n<pre><code>'Run this loop on the cell itself rather than column K.\nFor Each cell In Range(\"B2:B\" &amp; LastRow).Cells\n    cell.NumberFormat = \"@\"\n    cell.Value = Right(cell.Value, 10) 'Removed offset\nNext cell\n\n'Remove this loop and the subsequent delete\n'For Each cell In Range(\"K2:K\" &amp; LastRow).Cells\n'    cell.NumberFormat = \"@\"\n'    cell.Offset(0, -9).Value = cell.Value\n'Next cell\n\n'Columns(\"K:K\").EntireColumn.Delete\n</code></pre>\n"}], "owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 52303464, "answer_count": 1, "score": 0, "last_activity_date": 1537303053, "creation_date": 1536785720, "last_edit_date": 1537303053, "question_id": 52303350, "link": "https://stackoverflow.com/questions/52303350/forcing-date-cells-to-retain-10-character-date-mm-dd-yyyy", "title": "Forcing Date Cells to Retain 10-character Date (&quot;mm/dd/yyyy&quot;)", "body": "<p>I'm scraping some data off of a website where one column contains a day and date, formatted like <code>Thu 09/06/2018</code>. I just want to keep the <code>09/06/2018</code> part, but it seems like no matter what I do, Excel converts the date to <code>9/6/2018</code>. <strong>I need the full <code>09/06/2018</code> (not just formatted, visible in the formula bar)</strong> in order for the data to be accepted into a database - how can I force excel to retain this data as text?</p>\n\n<p>Below is my code, at the bottom is my attempt to <code>'Fix Dates</code></p>\n\n<pre><code>'Fix Dates\nApplication.CutCopyMode = False\nLastRow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n    For Each cell In Range(\"B2:B\" &amp; LastRow).Cells\n        cell.NumberFormat = \"@\"\n        cell.Offset(0, 9).Value = Right(cell.Value, 10)\n    Next cell\n\n    For Each cell In Range(\"K2:K\" &amp; LastRow).Cells\n        cell.NumberFormat = \"@\"\n        cell.Offset(0, -9).Value = cell.Value\n    Next cell\n\nColumns(\"K:K\").EntireColumn.Delete\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1536783733, "post_id": 52302876, "comment_id": 91553528, "body": "Try specifying the work book the sheet is in: <code>wb.Sheets(&quot;GoodDBData&quot;).Visible</code>"}, {"owner": {"reputation": 306, "user_id": 6272169, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/10156870110820287/picture?type=large", "display_name": "mickNeill", "link": "https://stackoverflow.com/users/6272169/mickneill"}, "edited": false, "score": 0, "creation_date": 1536783856, "post_id": 52302876, "comment_id": 91553588, "body": "What line is out of range? <code>wb.Activate</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "is_accepted": false, "score": 1, "last_activity_date": 1536784237, "creation_date": 1536784237, "answer_id": 52303016, "question_id": 52302876, "link": "https://stackoverflow.com/questions/52302876/subscript-our-of-range-two-excel-document-open/52303016#52303016", "title": "Subscript our of range - two excel document open", "body": "<p>Try:  </p>\n\n<pre><code> wb.worksheets(\"GoodDBData\").Visible = True\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1536784362, "creation_date": 1536784362, "answer_id": 52303044, "question_id": 52302876, "link": "https://stackoverflow.com/questions/52302876/subscript-our-of-range-two-excel-document-open/52303044#52303044", "title": "Subscript our of range - two excel document open", "body": "<p>Your code is in the ThisWorkbook private code sheet. In a private code sheet, any references that are not fully qualified revert parentage to that workbook/worksheet.</p>\n\n<pre><code>Sheets(\"GoodDBData\").Visible = True\n</code></pre>\n\n<p>This defaults to the workbook containing the code. If you are looking for the GoodDBData worksheet in Workbooks(\"Staffing Log - HQ - 2018 - 2019.xlsm\") then qualify the parent workbook.</p>\n\n<pre><code>wb.workSheets(\"GoodDBData\").Visible = True\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/36368220/is-the-in-range-necessary-when-defined-by-cells\">Recommended reading</a></p>\n\n<p>I'm a little unclear on why you plan to hide the application instance but want this worksheet visible.</p>\n"}], "owner": {"reputation": 99, "user_id": 7594277, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fa052c1884d88c2db4558b8bec0e8038?s=128&d=identicon&r=PG&f=1", "display_name": "Val S", "link": "https://stackoverflow.com/users/7594277/val-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1536784362, "creation_date": 1536783599, "question_id": 52302876, "link": "https://stackoverflow.com/questions/52302876/subscript-our-of-range-two-excel-document-open", "title": "Subscript our of range - two excel document open", "body": "<p>Here's my issue:</p>\n\n<pre><code>Private Sub Workbook_Open()\n'the name of the current user\nDim UserName As String\n'on opening, find out who this is (and convert to lower case)\n    Dim wb As Workbook\n    Set wb = Workbooks(\"Staffing Log - HQ - 2018 - 2019.xlsm\")\n    wb.Activate\n\n\nUserName = LCase(Environ(\"UserName\"))\nOn Error Resume Next\n\nApplication.Visible = False\n'ActiveWindow.Visible = False\n Sheets(\"GoodDBData\").Visible = True ERROR OCCURS HERE\nend sub\n</code></pre>\n\n<p>When I open this workbook while having another workbook already open, I keep getting the subscript out of range. It's as if even if I tell the program to ACTIVATE the proper workbook with the wb.Activate it does not recognize it. </p>\n\n<p>Any idea why?\nThank you</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1536782439, "post_id": 52302527, "comment_id": 91553016, "body": "Instead of storing the name, use a <code>Worksheet</code> object variable."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1536782740, "post_id": 52302527, "comment_id": 91553138, "body": "Base the new workbook/worksheet on a template worksheet that already contains the 5 rows."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 9067858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a90bd042faf617df76e243ef113df16a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan R", "link": "https://stackoverflow.com/users/9067858/ryan-r"}, "is_accepted": false, "score": 1, "last_activity_date": 1536783307, "creation_date": 1536783307, "answer_id": 52302803, "question_id": 52302527, "link": "https://stackoverflow.com/questions/52302527/vba-copying-cells-across-workbooks/52302803#52302803", "title": "VBA - Copying cells across Workbooks", "body": "<p>Not sure if this 100% answers your question but hope it helps, you can open and store both workbooks as objects using: </p>\n\n<pre><code>Dim wb as Workbook, wb2 as Workbook \nSet wb  = Workbooks.Open(\"C:\\User\\Sample_Workbook_File_Path_1.xlsx\")\nSet wb2  = Workbooks.Open(\"C:\\User\\Sample_Workbook_File_Path_2.xlsx\")\n</code></pre>\n\n<p>From there you can call values from either workbook using things like: </p>\n\n<pre><code>'to get the second workbooks excel file name into a worksheet: \"Sample_Workbook_2\"\nwb.Worksheets(\"Sample_Worksheet\").Range(\"A1\").Value = wb2.Name \n\n'to copy files \nwb2.Worksheets(\"Second_Workbooks_Worksheet\").Range(\"A2:A100\").Copy _\n   wb.Worksheets(\"Sample_Worksheet\").Range(\"A2\") \n\n'Alternatively you can store the entire workbooks path name instead of the file name using: \nwb.Worksheets(\"Sample_Worksheet\").Range(\"A1\").Value = wb2.Path   \n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 10223786, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yJ7fEKuHDng/AAAAAAAAAAI/AAAAAAAAAB0/7emQtSuXXJ0/photo.jpg?sz=128", "display_name": "lukas rajnoha", "link": "https://stackoverflow.com/users/10223786/lukas-rajnoha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1536783307, "creation_date": 1536782207, "question_id": 52302527, "link": "https://stackoverflow.com/questions/52302527/vba-copying-cells-across-workbooks", "title": "VBA - Copying cells across Workbooks", "body": "<p>I'm writing a VBA program that changes the visuals of an excel database. At the end, I need to add a \"header\" (5 rows of text) at the top. The problem is, I cannot insert the text with VBA, since it contains letters (for ex. \u00e1, \u00e9...) that aren't compatible with VBA, I need to insert that text from another excel file. \nThe macro I have is stored in a standalone excel workbook, that also contains the cells of the header I need to copy into my database. The problem is, the name of the excel files I am working with varies. Is there a way I could switch between those 2 files and copy cells across them. Can I store the name of the excel file I am working with and later use it in the VBA code to switch between the workbooks?</p>\n"}, {"tags": ["excel", "vba", "pdf", "ms-word"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 2, "creation_date": 1536783601, "post_id": 52302445, "comment_id": 91553463, "body": "When you save to a pdf, save it as a word document also. See this <a href=\"https://stackoverflow.com/questions/31032325/save-export-from-range-in-excel-to-word-and-save-as-name-in-cell-a1\">SO question</a>"}], "answers": [{"comments": [{"owner": {"reputation": 661, "user_id": 197089, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/49b9ab65bf50ff06ccbd0f4934f74a12?s=128&d=identicon&r=PG", "display_name": "Chasester", "link": "https://stackoverflow.com/users/197089/chasester"}, "edited": false, "score": 0, "creation_date": 1605192449, "post_id": 52358704, "comment_id": 114580353, "body": "this works really well.   One thing though, if the PDF has any type of Protected View - it <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_word-mso_winother-mso_2013_release/deactivate-protected-view-in-vba-code/f69cb0ea-e4c5-4a31-8403-92fb7edf2183\" rel=\"nofollow noreferrer\">will not convert</a> until that protection is removed (such as &quot;Enable All Features&quot;)"}, {"owner": {"reputation": 661, "user_id": 197089, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/49b9ab65bf50ff06ccbd0f4934f74a12?s=128&d=identicon&r=PG", "display_name": "Chasester", "link": "https://stackoverflow.com/users/197089/chasester"}, "edited": false, "score": 0, "creation_date": 1605216699, "post_id": 52358704, "comment_id": 114591105, "body": "The following error handling will prompt the user for what actions need to be done.  Right below Dim&#39;s put     <code>On Error Goto errhndl</code>  Just above &quot;End Sub&quot; put <code>done:          Exit Sub         errhndl:         If Err.Description Like &quot;*Security settings prevent*&quot; Then             MsgBox &quot;The PDF requires content to be enabled first.  Please open the PDF, Enable All Features, close and try again&quot;         Else             MsgBox &quot;The following error occurred: &quot; &amp; Err.Description         End If</code>    my apologies for the bad formatting -I can never get it to work right in comments"}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1537134628, "creation_date": 1537134628, "answer_id": 52358704, "question_id": 52302445, "link": "https://stackoverflow.com/questions/52302445/convert-pdf-to-word-doc-using-excel-vba-code/52358704#52358704", "title": "Convert PDF to Word Doc using excel VBA code", "body": "<p>This will do what you want, but you need Adobe Acrobat installed.  I don't know of any way to do this without having Acrobat installed.</p>\n\n<pre><code>Option Explicit\nOption Private Module\n\nSub ClearPaths()\n\n    '------------------------------------------\n    'Clears the contains of the sheet Paths.\n\n    'By Christos Samaras\n    'Date: 30/03/2013\n    'http://www.myengineeringworld.net\n    '------------------------------------------\n\n    Dim LastRow As Long\n\n    Application.ScreenUpdating = False\n\n    shPaths.Activate\n\n    'Find the last row.\n    With shPaths\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    End With\n\n    'Clear the contents of the cells.\n    If LastRow &gt; 1 Then\n        Range(Cells(2, 1), Cells(LastRow, 2)).Value = \"\"\n        Columns(\"A:B\").EntireColumn.AutoFit\n    End If\n\n    shPaths.Range(\"A2\").Select\n    Application.ScreenUpdating = True\n\nEnd Sub\n\n\nOption Explicit\nOption Private Module\n\nSub ExportAllPDFs()\n\n    '----------------------------------------------------------------\n    'Converts all the PDF files that their paths are in column A of\n    'the worksheet \"Convert PDF Files\" into a different file format,\n    'based on the value in column B (extension).\n\n    'By Christos Samaras\n    'Date: 18/07/2013\n    'http://www.myengineeringworld.net\n    '----------------------------------------------------------------\n\n    Dim LastRow As Long\n    Dim i As Integer\n\n    shPaths.Activate\n\n    'Find the last row.\n    With shPaths\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    End With\n\n    'Check that there are available file paths.\n    If LastRow &lt; 2 Then\n        shPaths.Range(\"A2\").Select\n        MsgBox \"There are no file paths to convert!\", vbInformation, \"File paths missing\"\n        Exit Sub\n    End If\n\n    'Checking for errors before conversion.\n    For i = 2 To LastRow\n\n        'Check if the file extensions are not empty.\n        If Cells(i, 2).Value = \"\" Then\n            shPaths.Cells(i, 2).Select\n            MsgBox \"Please select an output format from the dropdown list!\", vbCritical, \"File paths missing\"\n            Exit Sub\n        End If\n\n        'Check if the file exists.\n        If Dir(shPaths.Cells(i, 1).Value) = \"\" Then\n            shPaths.Cells(i, 1).Select\n            MsgBox \"The file path is not valid!\", vbCritical, \"File path error\"\n            Exit Sub\n        End If\n\n        'Check if the input file is a PDF file.\n        If LCase(Right(shPaths.Cells(i, 1).Value, 3)) &lt;&gt; \"pdf\" Then\n            shPaths.Cells(i, 1).Select\n            MsgBox \"The file is not a pdf file!\", vbCritical, \"No pdf file\"\n            Exit Sub\n        End If\n\n    Next i\n\n    'For each cell in the range \"A2:A\" &amp; last row convert the pdf file\n    'into different format according to the \"B2:B\" &amp; last row value.\n    For i = 2 To LastRow\n        SavePDFAs Cells(i, 1).Value, Cells(i, 2).Value\n    Next i\n\n    'Adjust the two columns.\n    Columns(\"A:B\").EntireColumn.AutoFit\n\n    'Inform the user that conversion finished.\n    MsgBox \"All files were converted successfully!\", vbInformation, \"Finished\"\n\nEnd Sub\n\nPrivate Sub SavePDFAs(PDFPath As String, FileExtension As String)\n\n    '---------------------------------------------------------------------------------------\n    'Saves a PDF file as other format using Adobe Professional.\n\n    'In order to use the macro you must enable the Acrobat library from VBA editor:\n    'Go to Tools -&gt; References -&gt; Adobe Acrobat xx.0 Type Library, where xx depends\n    'on your Acrobat Professional version (i.e. 9.0 or 10.0) you have installed to your PC.\n\n    'Alternatively you can find it Tools -&gt; References -&gt; Browse and check for the path\n    'C:\\Program Files\\Adobe\\Acrobat xx.0\\Acrobat\\acrobat.tlb\n    'where xx is your Acrobat version (i.e. 9.0 or 10.0 etc.).\n\n    'By Christos Samaras\n    'Date: 30/03/2013\n    'http://www.myengineeringworld.net\n    '---------------------------------------------------------------------------------------\n\n    Dim objAcroApp      As Acrobat.AcroApp\n    Dim objAcroAVDoc    As Acrobat.AcroAVDoc\n    Dim objAcroPDDoc    As Acrobat.AcroPDDoc\n    Dim objJSO          As Object\n    Dim boResult        As Boolean\n    Dim ExportFormat    As String\n    Dim NewFilePath     As String\n\n    'Initialize Acrobat by creating App object.\n    Set objAcroApp = CreateObject(\"AcroExch.App\")\n\n    'Set AVDoc object.\n    Set objAcroAVDoc = CreateObject(\"AcroExch.AVDoc\")\n\n    'Open the PDF file.\n    boResult = objAcroAVDoc.Open(PDFPath, \"\")\n\n    'Set the PDDoc object.\n    Set objAcroPDDoc = objAcroAVDoc.GetPDDoc\n\n    'Set the JS Object - Java Script Object.\n    Set objJSO = objAcroPDDoc.GetJSObject\n\n    'Check the type of conversion.\n    Select Case LCase(FileExtension)\n        Case \"eps\": ExportFormat = \"com.adobe.acrobat.eps\"\n        Case \"html\", \"htm\": ExportFormat = \"com.adobe.acrobat.html\"\n        Case \"jpeg\", \"jpg\", \"jpe\": ExportFormat = \"com.adobe.acrobat.jpeg\"\n        Case \"jpf\", \"jpx\", \"jp2\", \"j2k\", \"j2c\", \"jpc\": ExportFormat = \"com.adobe.acrobat.jp2k\"\n        Case \"docx\": ExportFormat = \"com.adobe.acrobat.docx\"\n        Case \"doc\": ExportFormat = \"com.adobe.acrobat.doc\"\n        Case \"png\": ExportFormat = \"com.adobe.acrobat.png\"\n        Case \"ps\": ExportFormat = \"com.adobe.acrobat.ps\"\n        Case \"rft\": ExportFormat = \"com.adobe.acrobat.rft\"\n        Case \"xlsx\": ExportFormat = \"com.adobe.acrobat.xlsx\"\n        Case \"xls\": ExportFormat = \"com.adobe.acrobat.spreadsheet\"\n        Case \"txt\": ExportFormat = \"com.adobe.acrobat.accesstext\"\n        Case \"tiff\", \"tif\": ExportFormat = \"com.adobe.acrobat.tiff\"\n        Case \"xml\": ExportFormat = \"com.adobe.acrobat.xml-1-00\"\n        Case Else: ExportFormat = \"Wrong Input\"\n    End Select\n\n    'Check if the format is correct and there are no errors.\n    If ExportFormat &lt;&gt; \"Wrong Input\" And Err.Number = 0 Then\n\n        'Format is correct and no errors.\n\n        'Set the path of the new file. Note that Adobe instead of xls uses xml files.\n        'That's why here the xls extension changes to xml.\n        If LCase(FileExtension) &lt;&gt; \"xls\" Then\n            NewFilePath = WorksheetFunction.Substitute(PDFPath, \".pdf\", \".\" &amp; LCase(FileExtension))\n        Else\n            NewFilePath = WorksheetFunction.Substitute(PDFPath, \".pdf\", \".xml\")\n        End If\n\n        'Save PDF file to the new format.\n        boResult = objJSO.SaveAs(NewFilePath, ExportFormat)\n\n        'Close the PDF file without saving the changes.\n        boResult = objAcroAVDoc.Close(True)\n\n        'Close the Acrobat application.\n        boResult = objAcroApp.Exit\n\n    Else\n\n        'Something went wrong, so close the PDF file and the application.\n\n        'Close the PDF file without saving the changes.\n        boResult = objAcroAVDoc.Close(True)\n\n        'Close the Acrobat application.\n        boResult = objAcroApp.Exit\n\n    End If\n\n    'Release the objects.\n    Set objAcroPDDoc = Nothing\n    Set objAcroAVDoc = Nothing\n    Set objAcroApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/9K5Wz.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9K5Wz.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 12798180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wEtRC.jpg?s=128&g=1", "display_name": "Loveb", "link": "https://stackoverflow.com/users/12798180/loveb"}, "is_accepted": false, "score": 0, "last_activity_date": 1593685154, "creation_date": 1593685154, "answer_id": 62694094, "question_id": 52302445, "link": "https://stackoverflow.com/questions/52302445/convert-pdf-to-word-doc-using-excel-vba-code/62694094#62694094", "title": "Convert PDF to Word Doc using excel VBA code", "body": "<p>I use same basic code, but I always get a Error message saying &quot;Error saving to source file. It can be in use.&quot;\nI have &quot;Adobe Acrobat PRO DC&quot;.\nI use reference &quot;Adobe Acrobat 10.0 Type Library&quot;</p>\n<pre><code>Option Explicit\n\nSub convert_pdf_doc()\n\nDim aApp As Acrobat.AcroApp\nDim av_doc As Acrobat.AcroAVDoc\nDim pdf_doc As Acrobat.AcroPDDoc\nDim jso_obj As Object\n\nDim sfile As String 'source file\nDim dfile As String 'destination file\nDim ext As String 'my choise of file\n\next = &quot;doc&quot;\n\nsfile = &quot;C:\\Temp\\Test.pdf&quot;\ndfile = Replace(sfile, &quot;.pdf&quot;, &quot;.&quot; &amp; ext, 1)\n\nSet aApp = CreateObject(&quot;AcroExch.App&quot;)\nSet av_doc = CreateObject(&quot;AcroExch.AVDoc&quot;)\n\nIf av_doc.Open(sfile, vbNull) = True Then\n\n    Set pdf_doc = av_doc.GetPDDoc\n    Set jso_obj = pdf_doc.GetJSObject\n    \n    jso_obj.SaveAs dfile, &quot;com.adobe.acrobat.&quot; &amp; ext\n\nEnd If\n\nav_doc.Close False\n\naApp.Exit\nSet aApp = Nothing\nSet av_doc = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8076413, "user_type": "registered", "profile_image": "https://graph.facebook.com/1618551598187397/picture?type=large", "display_name": "Shawn Martinez", "link": "https://stackoverflow.com/users/8076413/shawn-martinez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3617, "favorite_count": 1, "answer_count": 2, "score": -3, "last_activity_date": 1593685154, "creation_date": 1536781853, "last_edit_date": 1536832874, "question_id": 52302445, "link": "https://stackoverflow.com/questions/52302445/convert-pdf-to-word-doc-using-excel-vba-code", "title": "Convert PDF to Word Doc using excel VBA code", "body": "<p>everyone.\nIm need a VBA code to convert excel data to PDf to word doc, i wrote a macro that prints out excel as a pdf but now i would like to print it out as word from that pdf, so short version, Excel to PDF to Word. all this do to i wanna keep the format of the excel data</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 62335, "user_id": 9840637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QqY9S.png?s=128&g=1", "display_name": "anky", "link": "https://stackoverflow.com/users/9840637/anky"}, "edited": false, "score": 0, "creation_date": 1536782586, "post_id": 52302522, "comment_id": 91553076, "body": "Got it, my bad, i overlooked that in the previous solution. Would be really grateful if you can ping me the docs link to these. :)"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 62335, "user_id": 9840637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QqY9S.png?s=128&g=1", "display_name": "anky", "link": "https://stackoverflow.com/users/9840637/anky"}, "edited": false, "score": 1, "creation_date": 1536782744, "post_id": 52302522, "comment_id": 91553141, "body": "Edited with the link."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 2, "last_activity_date": 1536782730, "last_edit_date": 1536782730, "creation_date": 1536782186, "answer_id": 52302522, "question_id": 52302436, "link": "https://stackoverflow.com/questions/52302436/call-a-macro-from-a-button-in-sheet-1-and-write-some-data-in-sheet-2/52302522#52302522", "title": "Call a macro from a button in sheet 1 and write some data in sheet 2", "body": "<p>Add a period <code>.</code> in front of <code>Cells(.Rows.Count, \"B\")...</code> and <code>Cells(.Rows.Count, \"A\")...</code>.</p>\n\n<p>As is, <code>ActiveSheet</code> is implied - you're not actually using the <code>With...End With</code> block.</p>\n\n<p>See <a href=\"https://docs.microsoft.com/en-us/office/vba/language/concepts/getting-started/using-with-statements\" rel=\"nofollow noreferrer\">Using With Statements</a> for more detail.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 9067858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a90bd042faf617df76e243ef113df16a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan R", "link": "https://stackoverflow.com/users/9067858/ryan-r"}, "is_accepted": false, "score": 1, "last_activity_date": 1536782340, "creation_date": 1536782340, "answer_id": 52302556, "question_id": 52302436, "link": "https://stackoverflow.com/questions/52302436/call-a-macro-from-a-button-in-sheet-1-and-write-some-data-in-sheet-2/52302556#52302556", "title": "Call a macro from a button in sheet 1 and write some data in sheet 2", "body": "<p>I think you just need to do add a \".\" in front of Cells in the \"With\" statement: </p>\n\n<pre><code>With ThisWorkbook.Worksheets(\"Logs\")\n    .Cells(.Rows.Count, \"B\").End(xlUp).Offset(1).Value = output_file\n    .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1).Value = MyFile\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 62335, "user_id": 9840637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QqY9S.png?s=128&g=1", "display_name": "anky", "link": "https://stackoverflow.com/users/9840637/anky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 52302522, "answer_count": 2, "score": 0, "last_activity_date": 1536782730, "creation_date": 1536781805, "last_edit_date": 1536782106, "question_id": 52302436, "link": "https://stackoverflow.com/questions/52302436/call-a-macro-from-a-button-in-sheet-1-and-write-some-data-in-sheet-2", "title": "Call a macro from a button in sheet 1 and write some data in sheet 2", "body": "<p>I am trying to call the below code by using a button from sheet <code>Homepage</code> and expecting it to write data in sheet <code>Logs</code> . However when I do that, the data is getting written in the same sheet where the macro is called from.</p>\n\n<p>Below is my code:</p>\n\n<pre><code>Sub MyRenamePDF()\n\nDim MyFolder As String\nDim MyFile As String\nDim i As Long\nDim MyOldFile As String\nDim MyNewFile As String\nDim dt As String\nDim FSO As Object\nDim rng As Range\nDim input_file As String\nDim output_file As String\ndt = Format(Now(), \"YYYY_MM_DD_HH_MM\")\nSet FSO = CreateObject(\"Scripting.Filesystemobject\")\nMyFolder = \"D:\\test\\\"\nTargetFolder = \"D:\\output\\\"\nMyFile = Dir(MyFolder &amp; \"\\*.pdf\")\n\n Do While MyFile &lt;&gt; \"\"\n\n    MyOldFile = MyFolder &amp; \"\\\" &amp; MyFile\n    MyNewFile = MyFolder &amp; \"\\\" &amp; \"0001\" &amp; \"_\" &amp; dt &amp; \"_\" &amp; MyFile\n    Name MyOldFile As MyNewFile\n    output_file = FSO.GetFileName(MyNewFile)\n    With ThisWorkbook.Worksheets(\"Logs\")\n        Cells(.Rows.Count, \"B\").End(xlUp).Offset(1).Value = output_file\n        Cells(.Rows.Count, \"A\").End(xlUp).Offset(1).Value = MyFile\n    End With\n    FSO.MoveFile MyNewFile, TargetFolder\n    MyFile = Dir\n Loop\nEnd Sub\n</code></pre>\n\n<p>What is possibly going wrong here?</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1536781792, "post_id": 52302168, "comment_id": 91552775, "body": "The double quotes will cause an error in RunSQL. You have to either use single quotes or double-double quotes."}], "tags": [], "owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "is_accepted": false, "score": 1, "last_activity_date": 1536780700, "creation_date": 1536780700, "answer_id": 52302168, "question_id": 52302150, "link": "https://stackoverflow.com/questions/52302150/using-the-like-operator-along-with-wildcard-in-ms-access-vba/52302168#52302168", "title": "Using the Like Operator Along with Wildcard in MS Access VBA", "body": "<p>Is this what you intend?</p>\n\n<pre><code>WHERE [Carrier File Report].[Project Tasks Name] Like \"*Test*\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 1, "last_activity_date": 1536780841, "creation_date": 1536780841, "answer_id": 52302203, "question_id": 52302150, "link": "https://stackoverflow.com/questions/52302150/using-the-like-operator-along-with-wildcard-in-ms-access-vba/52302203#52302203", "title": "Using the Like Operator Along with Wildcard in MS Access VBA", "body": "<p>If you are really looking for anything matching Test then</p>\n\n<pre><code>\"...    Like '*Test*'\"\n</code></pre>\n\n<p>If <code>Test</code> is a string variable you are trying to use then</p>\n\n<pre><code> \"...   Like '*\" &amp; Test &amp; \"*'\"\n</code></pre>\n"}], "owner": {"reputation": 501, "user_id": 7129561, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8543be588e524cca7f2c217ac549771b?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck0185", "link": "https://stackoverflow.com/users/7129561/chuck0185"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1801, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1536784745, "creation_date": 1536780608, "question_id": 52302150, "link": "https://stackoverflow.com/questions/52302150/using-the-like-operator-along-with-wildcard-in-ms-access-vba", "title": "Using the Like Operator Along with Wildcard in MS Access VBA", "body": "<p>I am trying to duplicate this SQL Query in MS Access VBA.  I keep running into syntax errors.  I am not sure where to use single quotes or double quotes or what have you.  I'm driving myself up a wall.  Could someone please duplicate this SQL code for me in VBA. I am using the docmd.RunSQL(string) command.  Thank you!</p>\n\n<pre><code>Delete [Carrier File Report].[Project Tasks Name] FROM [Carrier File Report] WHERE ((([Carrier File Report].[Project Tasks Name]) Like \"'\" * Test * \"'\"));\n</code></pre>\n"}, {"tags": ["vba", "excel", "textbox", "radio-button"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 3, "creation_date": 1536779430, "post_id": 52301745, "comment_id": 91551735, "body": "<b>A)</b> Define &quot;doesn&#39;t work&quot;. <b>B)</b> Your <code>If</code> statement contains a combination of <code>and</code> and <code>or</code> and no parenthesis to control how VBA evaluates it - this virtually guarantees that it won&#39;t happen the way you think it will. You probably want <code>If A and (B or C)</code>, but it&#39;s probably executing as <code>If (A and B) or C</code>."}, {"owner": {"reputation": 101, "user_id": 10278069, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215575113627540/picture?type=large", "display_name": "April Parker", "link": "https://stackoverflow.com/users/10278069/april-parker"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1536784786, "post_id": 52301745, "comment_id": 91553950, "body": "Hi FreeMan, A) Doesn&#39;t work means that when OptionButton2 is True and then I click Optionbutton10, textbox6 doesn&#39;t update with E3 cell. Instead it stays on cell D3, which is the default value if optionbutton2 is false/unchecked. B) Let me try out the parenthesis to see if that helps."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1536785610, "post_id": 52301745, "comment_id": 91554310, "body": "Based on your text description, maybe you want to invert the order of checking your conditions. As this code is executing, the value of <code>OptionButton2</code> is totally irrelevant if <code>OptionButton10</code> is <code>true</code> and <code>ComboBox2</code> is &quot;Standard&quot; or &quot;Scale-In&quot;. It sounds like you <i>may</i> want to check <code>ComboBox2</code> first. Either that or I&#39;m still misunderstanding you."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 10278069, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215575113627540/picture?type=large", "display_name": "April Parker", "link": "https://stackoverflow.com/users/10278069/april-parker"}, "edited": false, "score": 0, "creation_date": 1536792406, "post_id": 52303448, "comment_id": 91556415, "body": "Hi FreeMan, Thanks. I actually figured it out with very simple solution, I will add it as my answer. Also I really appreciate your comments about the control names."}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 0, "last_activity_date": 1536786141, "creation_date": 1536786141, "answer_id": 52303448, "question_id": 52301745, "link": "https://stackoverflow.com/questions/52301745/vba-update-textbox-value-based-on-option-button-selection/52303448#52303448", "title": "VBA Update Textbox Value based on Option Button Selection", "body": "<p>It's hard to be sure, but based on your comments, you may want to try either this:</p>\n\n<pre><code>Private Sub OptionButton10_Click()\n  Dim D3 As Variant\n  Dim E3 As Variant\n  D3 = Sheets(\"Systems\").Range(\"D3\").Value\n  E3 = Sheets(\"Systems\").Range(\"E3\").Value\n\n  If (OptionButton10 And Not (OptionButton2)) And (ComboBox2 = \"Standard\" Or ComboBox2 = \"Scale-In\") Then\n    TextBox6.Value = D3                          'this works'\n  ElseIf OptionButton10 = True And OptionButton2 = True Then\n    TextBox6.Value = E3                          'this doesn't work'\n  End If\n  TextBox6.text = Format(TextBox6.Value, \"Percent\")\nEnd Sub\n</code></pre>\n\n<p>or, alternatively this:</p>\n\n<pre><code>Private Sub OptionButton10_Click()\n  Dim D3 As Variant\n  Dim E3 As Variant\n  D3 = Sheets(\"Systems\").Range(\"D3\").Value\n  E3 = Sheets(\"Systems\").Range(\"E3\").Value\n\n  If OptionButton10 And OptionButton2 Then\n    TextBox6.Value = E3                          'this doesn't work'\n  ElseIf OptionButton10 = True And (ComboBox2 = \"Standard\" Or ComboBox2 = \"Scale-In\") Then\n    TextBox6.Value = D3                          'this works'\n  End If\n  TextBox6.text = Format(TextBox6.Value, \"Percent\")\nEnd Sub\n</code></pre>\n\n<p>Additionally, I'd <strong>strongly</strong> recommend that you give your buttons and boxes (including text boxes) better names. Future you will greatly appreciate it when you can look at your code and read:</p>\n\n<pre><code>If (ProcessFoo and Not(ProcessBar)) and (Baz = \"Standard\" or Baz = \"Scale-In\")\n</code></pre>\n\n<p><sup>*with appropriate names for your options and combobox, if you name them <code>Foo</code> and <code>Bar</code> and <code>Baz</code>, future you may well be even more confused than if you leave them with the default names...</sup></p>\n\n<p>That will be much faster for you to understand than having to go back to the form to see what the text labels for <code>OptionButton10</code> and <code>OptionButton2</code> are...</p>\n"}, {"comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1536837386, "post_id": 52304477, "comment_id": 91571986, "body": "Glad <i>you</i> got it worked out! I&#39;m not sure I&#39;d have ever guessed this variation. :) If my answer helped, clicking the &quot;up arrow triangle&quot; is the normal way to say &quot;thanks&quot;. Also, since this is your solution, be sure you click the &quot;check mark&quot; next to the answer so that others know what worked for you."}], "tags": [], "owner": {"reputation": 101, "user_id": 10278069, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215575113627540/picture?type=large", "display_name": "April Parker", "link": "https://stackoverflow.com/users/10278069/april-parker"}, "is_accepted": true, "score": 0, "last_activity_date": 1536792642, "creation_date": 1536792642, "answer_id": 52304477, "question_id": 52301745, "link": "https://stackoverflow.com/questions/52301745/vba-update-textbox-value-based-on-option-button-selection/52304477#52304477", "title": "VBA Update Textbox Value based on Option Button Selection", "body": "<p>The solution that worked for me is below.</p>\n\n<p>I used a nested If statement and added the \"optionbutton2 = false\"</p>\n\n<pre><code>Private Sub OptionButton10_Click()\nDim D3 As Variant\nDim E3 As Variant\nD3 = Sheets(\"Systems\").Range(\"D3\").Value\nE3 = Sheets(\"Systems\").Range(\"E3\").Value\n\nIf ComboBox2 = \"Standard\" Or ComboBox2 = \"Scale-In\" Then\n  If OptionButton10 = True And OptionButton2 = False Then\n     TextBox6.Value = D3 \n  ElseIf OptionButton10 = True And OptionButton2 = True Then\n     TextBox6.Value = E3 \n End If\nEnd If\nTextBox6.Text = Format(TextBox6.Value, \"Percent\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 10278069, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215575113627540/picture?type=large", "display_name": "April Parker", "link": "https://stackoverflow.com/users/10278069/april-parker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2431, "favorite_count": 0, "accepted_answer_id": 52304477, "answer_count": 2, "score": 0, "last_activity_date": 1536792642, "creation_date": 1536778648, "question_id": 52301745, "link": "https://stackoverflow.com/questions/52301745/vba-update-textbox-value-based-on-option-button-selection", "title": "VBA Update Textbox Value based on Option Button Selection", "body": "<p>I am working on a vba excel userform and I am stuck at a point where a textbox named \"Textbox6\" won't update when certain conditions are in place - Like a option button selected or not. </p>\n\n<p>In other words. If Optionbuttton10 is true \"only\" then Textbox6 displays the value in Cell D3</p>\n\n<p>If \"OptionButton10\" is true AND \"Optionbutton2\" is True then I want Textbox6 to display the cell E3</p>\n\n<p>This is the code I have so far and it \"looks\" like it should work but I am missing something. </p>\n\n<pre><code>Private Sub OptionButton10_Click()\nDim D3 As Variant\nDim E3 As Variant\nD3 = Sheets(\"Systems\").Range(\"D3\").Value\nE3 = Sheets(\"Systems\").Range(\"E3\").Value\n\nIf OptionButton10 = True And ComboBox2 = \"Standard\" Or ComboBox2 = \"Scale-In\" Then\nTextBox6.Value = D3 'this works'\nElseIf OptionButton10 = True And OptionButton2 = True Then\nTextBox6.Value = E3 'this doesn't work'\nEnd If\n TextBox6.Text = Format(TextBox6.Value, \"Percent\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "vlookup"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1536779072, "post_id": 52301723, "comment_id": 91551559, "body": "You&#39;ve probably got the code executing unconditionally in a <code>worksheet_change</code> event handler, but it&#39;s really, really hard to tell without seeing your code. <a href=\"https://stackoverflow.com/posts/52301723/edit\">Edit</a> your post to include your code, then while you&#39;re waiting for a response, take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read the <a href=\"https://stackoverflow.com/help\">help center</a> to gain a better understanding of how to help <a href=\"https://stackoverflow.com\">Stack Overflow</a> help you."}, {"owner": {"reputation": 7, "user_id": 8036266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21aa14062b3506d5c75bf12159c8712?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav Sharma", "link": "https://stackoverflow.com/users/8036266/abhinav-sharma"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1536779202, "post_id": 52301723, "comment_id": 91551619, "body": "I am using a dynamic named range (made using offset) in the refRange section of the lookup. I noticed that if I replace this with a static range, this issue does not arise. Why is the macro getting triggered if I&#39;ve a dynamic range?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1536779329, "post_id": 52301723, "comment_id": 91551690, "body": "how are you using that dynamic range?  Things like OFFSET,INDIRECT are volatile and will recalc every time Excel recalcs."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1536779499, "post_id": 52301723, "comment_id": 91551766, "body": "<a href=\"https://stackoverflow.com/posts/52301723/edit\">Edit</a> your code into your original post. Otherwise people are just making guesses as to what your code is doing. You&#39;ll get a workable response much faster if you do that."}, {"owner": {"reputation": 7, "user_id": 8036266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21aa14062b3506d5c75bf12159c8712?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav Sharma", "link": "https://stackoverflow.com/users/8036266/abhinav-sharma"}, "edited": false, "score": 0, "creation_date": 1536779605, "post_id": 52301723, "comment_id": 91551818, "body": "If the reference range has empty rows, the macro does not work. So I&#39;ve used offset to make a dynamic range. There&#39;s a counta formula in the offset height category to count non empty cells. The issue is that this macro is getting executed if any cell is changed in the workbook. These cells have nothing to do with the dynamic range or cells being affected by the vbalookup macro"}, {"owner": {"reputation": 7, "user_id": 8036266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21aa14062b3506d5c75bf12159c8712?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav Sharma", "link": "https://stackoverflow.com/users/8036266/abhinav-sharma"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1536780234, "post_id": 52301723, "comment_id": 91552073, "body": "@FreeMan I have added the code"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1536780360, "post_id": 52301723, "comment_id": 91552125, "body": "That shouldn&#39;t execute on its own. Include the call site code - likely in a <code>worksheet_change</code> procedure."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1536780542, "post_id": 52301723, "comment_id": 91552203, "body": "@FreeMan it is the fact that the OP is using OFFSET to return a dynamic range to the UDF.  This is causing the UDF to become volatile.  OP: Please show how you are calling it so we can help give you a non-volatile approach if possible."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1536780849, "post_id": 52301723, "comment_id": 91552344, "body": "@ScottCraner - ah, gotcha. Volatile and, I&#39;d imagine, rather slow!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1536781243, "post_id": 52301723, "comment_id": 91552533, "body": "Basically it is not the code that is doing the recalc but the fact that you are using OFFSET.  OFFSET will recalc EVERY TIME Excel recalcs.  So currently we cannot help you as you have not provided the method by which you call the UDF."}, {"owner": {"reputation": 7, "user_id": 8036266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21aa14062b3506d5c75bf12159c8712?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav Sharma", "link": "https://stackoverflow.com/users/8036266/abhinav-sharma"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1536781257, "post_id": 52301723, "comment_id": 91552542, "body": "@ScottCraner  i am using vbalookup(lookuprange, Dynamic range, column) as an array formula. This dynamic range is made using offset(reference,,,counta(range),width). This dynamic range is causing the macro trigger everytime I change any cell. Works perfectly if I replace this with a fixed range."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1536781387, "post_id": 52301723, "comment_id": 91552606, "body": "Need more specifics on the named range part like actual references.  You can replace the OFFSET with and INDEX formula <code>=reference:INDEX(referencecolumn,COUNTA(range))</code>"}, {"owner": {"reputation": 7, "user_id": 8036266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21aa14062b3506d5c75bf12159c8712?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav Sharma", "link": "https://stackoverflow.com/users/8036266/abhinav-sharma"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1536781953, "post_id": 52301723, "comment_id": 91552842, "body": "@ScottCraner AdjRange :  =OFFSET(&#39;Country Data&#39;!$AE$2,,,COUNTA(&#39;Country Data&#39;!$A$2:$A$300),2)   VBA lookup formula: =vbalookup(&#39;Country Data&#39;!S2:S118735,AdjRangeTest,2)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1536782137, "post_id": 52301723, "comment_id": 91552903, "body": "<code>=&#39;Country Data&#39;!$AE$2:INDEX(&#39;Country Data&#39;!$AF:$AF,COUNTA(&#39;Country Data&#39;!$A$2:$A$300)) </code>"}, {"owner": {"reputation": 7, "user_id": 8036266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21aa14062b3506d5c75bf12159c8712?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav Sharma", "link": "https://stackoverflow.com/users/8036266/abhinav-sharma"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1536783439, "post_id": 52301723, "comment_id": 91553411, "body": "@ScottCraner same issue with the dynamic range made using index :("}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1536783565, "post_id": 52301723, "comment_id": 91553441, "body": "Then someone smarter than me, and that is not hard to find, will need to finish, as I have exhausted my meager knowledge.  Sorry I could not help."}, {"owner": {"reputation": 7, "user_id": 8036266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21aa14062b3506d5c75bf12159c8712?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav Sharma", "link": "https://stackoverflow.com/users/8036266/abhinav-sharma"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1536783953, "post_id": 52301723, "comment_id": 91553630, "body": "@ScottCraner Got it! I had other named dynamic ranges made using offset in the workbook. Removing them has solved the issue. Thanks!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1536784716, "post_id": 52301723, "comment_id": 91553926, "body": "There few, very few, times that I would use OFFSET over INDEX for this exact reason."}], "answers": [{"tags": [], "owner": {"reputation": 7, "user_id": 8036266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21aa14062b3506d5c75bf12159c8712?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav Sharma", "link": "https://stackoverflow.com/users/8036266/abhinav-sharma"}, "is_accepted": false, "score": 0, "last_activity_date": 1536785309, "creation_date": 1536785309, "answer_id": 52303267, "question_id": 52301723, "link": "https://stackoverflow.com/questions/52301723/regarding-vbalookup-macro-mentioned-in-an-answer/52303267#52303267", "title": "Regarding vbalookup macro mentioned in an answer", "body": "<p>I was using a dynamic range made using offset formula. Redefining the range using a non-volatile approach: using index, solved the issue. Other dynamic ranges present in the workbook (not being used in the vbalookup formula) were also triggering the macro. I had to remove them as well.</p>\n\n<p>Thanks to @ScottCraner for taking his time to solve this issue :)</p>\n"}], "owner": {"reputation": 7, "user_id": 8036266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21aa14062b3506d5c75bf12159c8712?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav Sharma", "link": "https://stackoverflow.com/users/8036266/abhinav-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1536785309, "creation_date": 1536778566, "last_edit_date": 1536780207, "question_id": 52301723, "link": "https://stackoverflow.com/questions/52301723/regarding-vbalookup-macro-mentioned-in-an-answer", "title": "Regarding vbalookup macro mentioned in an answer", "body": "<p>In this particular answer regarding faster way of vlookup - <a href=\"https://stackoverflow.com/a/18656809/8036266\">https://stackoverflow.com/a/18656809/8036266</a></p>\n\n<p>A faster way of vlookup is mentioned, defined as vbalookup. The code for this is working perfectly fine. However, it is executing everytime I change any cell in the workbook. Can somebody please tell me what the issue could be?</p>\n\n<pre><code>Function vbalookup(lookupRange As Range, refRange As Range, dataCol As Long) \nAs Variant\nDim dict As New Scripting.Dictionary\nDim myRow As Range\nDim I As Long, J As Long\nDim vResults() As Variant\n\n' 1. Build a dictionnary\nFor Each myRow In refRange.Columns(1).Cells\n' Append A : B to dictionnary\ndict.Add myRow.Value, myRow.Offset(0, dataCol - 1).Value\nNext myRow\n\n' 2. Use it over all lookup data\nReDim vResults(1 To lookupRange.Rows.Count, 1 To lookupRange.Columns.Count) \nAs Variant\nFor I = 1 To lookupRange.Rows.Count\nFor J = 1 To lookupRange.Columns.Count\n  If dict.Exists(lookupRange.Cells(I, J).Value) Then\n    vResults(I, J) = dict(lookupRange.Cells(I, J).Value)\n  End If\nNext J\nNext I\n\nvbalookup = vResults\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1536778940, "post_id": 52301706, "comment_id": 91551493, "body": "In addition to <a href=\"https://stackoverflow.com/a/52301742/2344413\">Jeeped&#39;s answer</a>, learn how to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid using .Select</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1536780907, "post_id": 52301742, "comment_id": 91552378, "body": "thank you! What was I doing wrong? I see I used <code>Range</code> without the <code>.</code> . Anything else?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1536781131, "post_id": 52301742, "comment_id": 91552483, "body": "You had added .Select on the end of the With statement."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1536780122, "last_edit_date": 1536780122, "creation_date": 1536778642, "answer_id": 52301742, "question_id": 52301706, "link": "https://stackoverflow.com/questions/52301706/vba-with-sheet-clearcontents-of-table/52301742#52301742", "title": "VBA, With Sheet, ClearContents of table", "body": "<p>Use the With ... End With block properly.</p>\n\n<pre><code>Sub ClearDatabase()\n    With ThisWorkbook.Worksheets(\"database\")\n        'adjust this if needing to clear more\n        .Range(\"A2:FR\" &amp; .Cells(.Rows.count, \"A\").End(xlUp).row).ClearContents  \n        'alternate\n        '.Range(.cells(2, \"A\"), .Cells(.Rows.count, \"A\").End(xlUp).offset(0, 173)).ClearContents\n    End With\nEnd Sub\n</code></pre>\n\n<p>The .CurrentRegion property will cover the area radiating out from A1 until it reaches a full blank row and fully blank column.</p>\n\n<pre><code>Sub ClearDatabase()\n    With ThisWorkbook.Worksheets(\"database\")\n        'offset preserves the column header labels in row 1\n        .Range(\"A1\").CurrentRegion.offset(1, 0).ClearContents  \n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 52301742, "answer_count": 1, "score": 1, "last_activity_date": 1536780122, "creation_date": 1536778483, "question_id": 52301706, "link": "https://stackoverflow.com/questions/52301706/vba-with-sheet-clearcontents-of-table", "title": "VBA, With Sheet, ClearContents of table", "body": "<p>I have a table I would like to clear, getting <code>object required</code> error on my range line. </p>\n\n<p>I also have tried other things but it tends to also clear the current page im on.</p>\n\n<pre><code>Sub ClearDatabase()\n    With ThisWorkbook.Worksheets(\"database\").Select\n        Range(\"A2:FR\" &amp; .Cells(.Rows.count, \"A\").End(xlUp).row).ClearContents  'adjust this if needing to clear more\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 10335726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af0caafa144bd6a955b33a7bcf1931e0?s=128&d=identicon&r=PG&f=1", "display_name": "stefvr", "link": "https://stackoverflow.com/users/10335726/stefvr"}, "edited": false, "score": 0, "creation_date": 1536822223, "post_id": 52302655, "comment_id": 91563637, "body": "Thanks for the quick reply. I hadn&#39;t yet created a subform. I did it now like you suggested (subform based on the subtable). I also adapted the code like you suggested. However, Set rstIsin = Forms!Transfert!subTFT_ISIN.RecordsetClone is not working. Set rstIsin = Forms!subTFT_ISIN.RecordsetClone does fine. However, when doing this, I still get in my array all the values of the subtable and not just those values which are in in subform for the current record."}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "reply_to_user": {"reputation": 77, "user_id": 10335726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af0caafa144bd6a955b33a7bcf1931e0?s=128&d=identicon&r=PG&f=1", "display_name": "stefvr", "link": "https://stackoverflow.com/users/10335726/stefvr"}, "edited": false, "score": 0, "creation_date": 1537231178, "post_id": 52302655, "comment_id": 91699356, "body": "Did you setup the Master and Child fields in the SubForm control on the parent form?"}], "tags": [], "owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "is_accepted": false, "score": 0, "last_activity_date": 1544512066, "last_edit_date": 1544512066, "creation_date": 1536782723, "answer_id": 52302655, "question_id": 52301616, "link": "https://stackoverflow.com/questions/52301616/access-vba-combine-getrows-with-bookmark/52302655#52302655", "title": "Access VBA: combine GetRows with bookmark", "body": "<p>If the subform <code>TFT_ISIN_DatasheetSub2</code> is in a subform control under the main form <code>Transfert</code>, link the Master and Child fields in the sub form control, and change:</p>\n\n<pre><code>Set rstIsin = Forms!TFT_ISIN_DatasheetSub2.RecordsetClone\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>Set rstIsin = Forms!Transfert!subTFT_ISIN.RecordsetClone\n</code></pre>\n\n<p>This assumes your subform control is named <code>subTFT_ISIN</code>.</p>\n"}], "owner": {"reputation": 77, "user_id": 10335726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af0caafa144bd6a955b33a7bcf1931e0?s=128&d=identicon&r=PG&f=1", "display_name": "stefvr", "link": "https://stackoverflow.com/users/10335726/stefvr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544516630, "creation_date": 1536778072, "last_edit_date": 1544516630, "question_id": 52301616, "link": "https://stackoverflow.com/questions/52301616/access-vba-combine-getrows-with-bookmark", "title": "Access VBA: combine GetRows with bookmark", "body": "<p>I have a small dataset with a maintable and one table being dependent on the maintable. One record in the main table can have multiple related records in the subtable.</p>\n\n<p>I also created a form (maintable) with a subform (subtable).</p>\n\n<p>Afterwards, I created two recordsetclones based on the form and the subform respectively.</p>\n\n<p>Adding the bookmark method also allows me to use data from the record that is actually active in the form. The problem is: the bookmark only applies to the mainform.</p>\n\n<p>I used GetRows to create an array variable to be filled with the records from the subform. The array is filled, but with all records from the subtable. I only want those records which are currently shown on the subform.</p>\n\n<p>I'm using a DAO recordset.</p>\n\n<p>How can I fix this?</p>\n\n<p>My code so far:</p>\n\n<pre><code>Sub FillMail()\n\n    Dim rstMail As DAO.Recordset\n    Dim rstIsin As DAO.Recordset\n\n    Dim db As Database\n    Dim isinarray As Variant\n\n    Set rstMail = Forms!Transfert.RecordsetClone\n    Set rstIsin = Forms!TFT_ISIN_DatasheetSub2.RecordsetClone\n    Set db = CurrentDb\n\n    rstMail.Bookmark = Forms!Transfert.Bookmark\n    rstIsin.Bookmark = Forms!TFT_ISIN_DatasheetSub2.Bookmark\n\n    isinarray = rstIsin.GetRows\n\n    MsgBox isinarray(2, 0)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2016"], "answers": [{"tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": true, "score": 1, "last_activity_date": 1536776592, "creation_date": 1536776592, "answer_id": 52301330, "question_id": 52301213, "link": "https://stackoverflow.com/questions/52301213/transfer-a-date-from-a-input-box-or-form-to-a-record-field/52301330#52301330", "title": "Transfer a date from a input box or form to a record field", "body": "<p>Yes there is but you will have to use some VBA.</p>\n\n<p>Personally I would not use a popup. I would use an unbound text box on the form's header, then script the OnCurrent event to copy that value to your C_Date field if C_Date is null. That way you don't have to worry about storing the value and you also allow your users to see/change it at will.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8727033"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19, "favorite_count": 0, "accepted_answer_id": 52301330, "answer_count": 1, "score": 0, "last_activity_date": 1536776592, "creation_date": 1536776051, "question_id": 52301213, "link": "https://stackoverflow.com/questions/52301213/transfer-a-date-from-a-input-box-or-form-to-a-record-field", "title": "Transfer a date from a input box or form to a record field", "body": "<p>Good Day all,</p>\n\n<p>I have a form setup for data entry; ID, C_Date, Amount....etc. Is it possible to have an input box popup before data entry, the user enters a Date and the date is passed onto C_Date so the user doesn't need to reenter the date every time just for that batch of records.</p>\n\n<p>Much Thanks  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1536775053, "post_id": 52300943, "comment_id": 91549653, "body": "Add <code>Exit For</code> after <code>cell.Value = MyNewFile</code> - though there are better ways to write to the first blank cell in a column."}, {"owner": {"reputation": 62335, "user_id": 9840637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QqY9S.png?s=128&g=1", "display_name": "anky", "link": "https://stackoverflow.com/users/9840637/anky"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1536775183, "post_id": 52300943, "comment_id": 91549713, "body": "That works thanks a lot. :) newbie to vba didnt know this syntax lol. Also how can i select  value a to be written in a cell in column a and value b in column b inside this loop.?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1536775427, "post_id": 52300943, "comment_id": 91549826, "body": "For a much cleaner way, replace everything inside the <code>With...End With</code> with <code>.Cells(.Rows.Count, &quot;B&quot;).End(xlUp).Offset(1).Value = MyNewFile</code>"}, {"owner": {"reputation": 62335, "user_id": 9840637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QqY9S.png?s=128&g=1", "display_name": "anky", "link": "https://stackoverflow.com/users/9840637/anky"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1536775606, "post_id": 52300943, "comment_id": 91549908, "body": "tried and it worked, thats way cleaner and short. :) Thanks, i got my answer to the above asked question too. :)"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1536776427, "post_id": 52300943, "comment_id": 91550300, "body": "@BigBen - write that all up as an answer. Answers in the comments tend to get lost."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1536776457, "post_id": 52300943, "comment_id": 91550322, "body": "@anky_91 - once he does that, be sure to click the check-mark so others know there is an answer to your question."}, {"owner": {"reputation": 62335, "user_id": 9840637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QqY9S.png?s=128&g=1", "display_name": "anky", "link": "https://stackoverflow.com/users/9840637/anky"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1536776620, "post_id": 52300943, "comment_id": 91550399, "body": "@BigBen : you meant me to post the answer? or i am glad if you want to. :)"}, {"owner": {"reputation": 62335, "user_id": 9840637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QqY9S.png?s=128&g=1", "display_name": "anky", "link": "https://stackoverflow.com/users/9840637/anky"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1536776631, "post_id": 52300943, "comment_id": 91550404, "body": "@FreeMan : Sure."}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 2, "last_activity_date": 1536776743, "creation_date": 1536776743, "answer_id": 52301365, "question_id": 52300943, "link": "https://stackoverflow.com/questions/52300943/writing-into-a-cell-writes-in-the-entire-range/52301365#52301365", "title": "Writing into a cell writes in the entire range", "body": "<p>Adding <code>Exit For</code> within the <code>If...End IF</code> will exit the <code>For</code> loop once <code>MyNewFile</code> has been written to the first blank cell in Column B.</p>\n\n<pre><code>If cell.Value = \"\" Then\n    cell.Value = MyNewFile\n    Exit For\nEnd If\n</code></pre>\n\n<p>But a much cleaner way to find the first blank cell in a column is with <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.end\" rel=\"nofollow noreferrer\"><code>Range.End</code></a> and <code>xlUp</code>, and <code>Offset</code>.</p>\n\n<pre><code>With ThisWorkbook.Sheets(\"Logs\")\n    .Cells(.Rows.Count, \"B\").End(xlUp).Offset(1).Value = MyNewFile\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 62335, "user_id": 9840637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QqY9S.png?s=128&g=1", "display_name": "anky", "link": "https://stackoverflow.com/users/9840637/anky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 52301365, "answer_count": 1, "score": 0, "last_activity_date": 1536780805, "creation_date": 1536774840, "last_edit_date": 1536780805, "question_id": 52300943, "link": "https://stackoverflow.com/questions/52300943/writing-into-a-cell-writes-in-the-entire-range", "title": "Writing into a cell writes in the entire range", "body": "<p>I am trying to rename a filename and move it to another directory. In the meanwhile I am trying to store the renamed file in a range as a log.</p>\n\n<p>Below is my code:</p>\n\n<pre><code>Sub MyRenamePDF()\n\n    Dim MyFolder As String\n    Dim MyFile As String\n    Dim i As Long\n    Dim MyOldFile As String\n    Dim MyNewFile As String\n    Dim dt As String\n    Dim FSO As Object\n    Dim rng As Range\n    Dim dat As Variant\n    dt = Format(Now(), \"YYYY_MM_DD_HH_MM\")\n    Set FSO = CreateObject(\"Scripting.Filesystemobject\")\n    MyFolder = \"D:\\test\\\"\n    TargetFolder = \"D:\\output\\\"\n    MyFile = Dir(MyFolder &amp; \"\\*.pdf\")\n\n    Do While MyFile &lt;&gt; \"\"\n\n        MyOldFile = MyFolder &amp; \"\\\" &amp; MyFile\n        MyNewFile = MyFolder &amp; \"\\\" &amp; \"0001\" &amp; \"_\" &amp; dt &amp; \"_\" &amp; MyFile\n        Name MyOldFile As MyNewFile\n\n        With ThisWorkbook.Worksheets(\"Logs\")\n            Set rng = Range(\"B2:B100\")\n            For Each cell In rng\n                If cell.Value = \"\" Then\n                    cell.Value = MyNewFile\n                End If\n            Next cell\n        End With\n        FSO.MoveFile MyNewFile, TargetFolder\n        MyFile = Dir\n    Loop\nEnd Sub\n</code></pre>\n\n<p>I am facing a problem in this snippet:</p>\n\n<pre><code>With ThisWorkbook.Worksheets(\"Logs\")\n    Set rng = Range(\"B2:B100\")\n    For Each cell In rng\n        If cell.Value = \"\" Then\n            cell.Value = MyNewFile\n        End If\n    Next cell\nEnd With\n</code></pre>\n\n<p>where the value <code>MyNewFile</code> gets written in the entire range instead of a specific cell i.e <code>B2</code> here.</p>\n\n<p>How to do that?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1536774546, "post_id": 52300860, "comment_id": 91549425, "body": "Are the values changed in the target cell by formula?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1536775100, "post_id": 52300860, "comment_id": 91549674, "body": "The worksheet_change event, will always kick in when you physically change a value on the sheet, but as mentioned earlier, it will not kick in, if the value of a cell is changed by a formula. You can use the worksheet_calculate event for that."}, {"owner": {"reputation": 61, "user_id": 6067477, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153506622013479/picture?type=large", "display_name": "Yaneth Gil", "link": "https://stackoverflow.com/users/6067477/yaneth-gil"}, "edited": false, "score": 0, "creation_date": 1536775739, "post_id": 52300860, "comment_id": 91549977, "body": "Effectively the value of the target cell changes with a formula"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1536776261, "post_id": 52300860, "comment_id": 91550222, "body": "Then use Worksheet_Calculate not Worksheet_Change."}, {"owner": {"reputation": 61, "user_id": 6067477, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153506622013479/picture?type=large", "display_name": "Yaneth Gil", "link": "https://stackoverflow.com/users/6067477/yaneth-gil"}, "edited": false, "score": 0, "creation_date": 1536777113, "post_id": 52300860, "comment_id": 91550628, "body": "It&#39;s not working. Try this code but it doesn&#39;t run.                             Private Sub Worksheet_Calculate()     sheets(&quot;Hoja1&quot;).Select Range(&quot;$b$156&quot;).Select     If Range(&quot;$b$156&quot;).Value = 1 Then Call oculta_4     If Range(&quot;$b$156&quot;).Value = 2 Then Call oculta_5     If Range(&quot;$b$156&quot;).Value = 3 Then Call oculta_6     If Range(&quot;$b$156&quot;).Value = 4 Then Call oculta_7     End Sub"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1536777545, "post_id": 52300860, "comment_id": 91550821, "body": "Do not select the sheet put the code in the sheet code of <code>Hoja1</code>"}, {"owner": {"reputation": 61, "user_id": 6067477, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153506622013479/picture?type=large", "display_name": "Yaneth Gil", "link": "https://stackoverflow.com/users/6067477/yaneth-gil"}, "edited": false, "score": 0, "creation_date": 1536777733, "post_id": 52300860, "comment_id": 91550893, "body": "Try that first but if I don&#39;t specify the macro runs on another sheet."}], "answers": [{"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 1, "last_activity_date": 1536789360, "creation_date": 1536789360, "answer_id": 52304025, "question_id": 52300860, "link": "https://stackoverflow.com/questions/52300860/activate-macro-automatically-without-having-to-click-on-target-cell/52304025#52304025", "title": "Activate macro automatically without having to click on target cell", "body": "<p>As others have said, to respond to a value changed by a Formula, you need to use <code>Worksheet_Calculate</code>.</p>\n\n<p>As <code>Worksheet_Calculate</code> does not have a <code>Target</code> property, you need to create your own detection of certain cells changing.  Use a <code>Static</code> variable to track last value.</p>\n\n<p>You should also declare all your other variables too.</p>\n\n<p>Repeatedly referencing the same cell is slow and makes code more difficult to update.  Put it in a variable once, and access that</p>\n\n<p><code>Select Case</code> avoids the need to use many <code>If</code>'s </p>\n\n<p>Don't use <code>Call</code>, it's unnecessary and obsolete.</p>\n\n<p>Adding <code>Application.ScreenUpdating = False</code> will make your code snappy, without flicker</p>\n\n<p>Writing the hidden state of a row takes a lot longer than reading it.  So only write it if you need to.</p>\n\n<p>Something like this (put all this code in the code-behind your sheet (that's <code>Hoja1</code>, right?)</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n    Static LastValue As Variant\n    Dim rng As Range\n\n    Set rng = Me.Range(\"B156\")\n\n    If rng.Value2 &lt;&gt; LastValue Then\n        LastValue = rng.Value2\n        Select Case LastValue \n            Case 1: oculta_4\n            Case 2: oculta_5\n            Case 3: oculta_6\n            Case 4: oculta_7\n        End Select\n    End If\nEnd Sub\n\n\nSub oculta_4()\n    Dim celda As Range\n    Application.ScreenUpdating = False\n    For Each celda In Me.Range(\"C158:C176\")\n        With celda.EntireRow\n            If celda.Value = 0 Then\n                If Not .Hidden Then .Hidden = True\n            Else\n                If .Hidden Then .Hidden = False\n            End If\n        End With\n    Next\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 6067477, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153506622013479/picture?type=large", "display_name": "Yaneth Gil", "link": "https://stackoverflow.com/users/6067477/yaneth-gil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 52304025, "answer_count": 1, "score": 0, "last_activity_date": 1593730633, "creation_date": 1536774464, "last_edit_date": 1593730633, "question_id": 52300860, "link": "https://stackoverflow.com/questions/52300860/activate-macro-automatically-without-having-to-click-on-target-cell", "title": "Activate macro automatically without having to click on target cell", "body": "<p>I have a macro that hides certain rows when the values in a cell change. However this macro is not running unless you enter the target cell and click on it. I have tried several alternatives but none work for me. </p>\n\n<p><i>Sheet</i></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Range(\"$b$156\").Value = 1 Then Call oculta_4\nIf Range(\"$b$156\").Value = 2 Then Call oculta_5\nIf Range(\"$b$156\").Value = 3 Then Call oculta_6\nIf Range(\"$b$156\").Value = 4 Then Call oculta_7\nEnd Sub\n</code></pre>\n\n<p><i>Macro</i></p>\n\n<pre><code>Sub oculta_4()\nRows(\"158:176\").EntireRow.Hidden = False\nRange(\"$c$158\").Select\nFor Each celda In Range(\"$c$158:$c$176\")\nIf celda.Value = 0 Then\nActiveCell.EntireRow.Hidden = True\nEnd If\nActiveCell.Offset(1).Select\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1536773769, "post_id": 52300614, "comment_id": 91549060, "body": "Are you looking for <i>any</i> blank rows, or the first row after the last row in the table? (it,s not quite the same thing. Perhaps <a href=\"https://stackoverflow.com/questions/38882321/excel-vba-better-way-to-find-last-row\">finding the last row</a> is what you need?"}, {"owner": {"reputation": 11, "user_id": 9421512, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "colonel179", "link": "https://stackoverflow.com/users/9421512/colonel179"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1536774126, "post_id": 52300614, "comment_id": 91549241, "body": "No. Always the first blank row after the last row that I need. let&#39;s say that the range goes from A4 to A10. The first blank row would be A11. However, the number of rows will always vary. It could be A10 or A6 or A20."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1536774281, "post_id": 52300614, "comment_id": 91549316, "body": "But would there ever be something after A11? (Say at A12 or A333)"}, {"owner": {"reputation": 11, "user_id": 9421512, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "colonel179", "link": "https://stackoverflow.com/users/9421512/colonel179"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1536774822, "post_id": 52300614, "comment_id": 91549535, "body": "No there will not be anything. It will always be blank since after the rows that are filled every other cells will be blank. Just think like a table that is just expanding, but there is nothing else in the sheet. Is there a way to attacha file here? I could attached a file with an example."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1536777185, "post_id": 52300614, "comment_id": 91550669, "body": "Then A10 is the last row and you can look for it easily enough (see the link provided in my first comment)"}, {"owner": {"reputation": 11, "user_id": 9421512, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "colonel179", "link": "https://stackoverflow.com/users/9421512/colonel179"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1536781683, "post_id": 52300614, "comment_id": 91552726, "body": "But then how would I change the values from the first one to the second one?  The code above only copies the first column, because it has fixed values (A4, B4, C4, etc). How do I tell excel to go to the second row and change it to A5, B5, C5, etc)?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9421512, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "colonel179", "link": "https://stackoverflow.com/users/9421512/colonel179"}, "edited": false, "score": 0, "creation_date": 1536795368, "post_id": 52303962, "comment_id": 91557037, "body": "THANK YOU!!! This works perfect and is everything I needed!! BUT (I hate to have this but), once I adapted it to my file there is an issue. The source table is filled with formulas because it is an INDEX, so the code takes them into consideration so it copies every single row that has a formula (I stopped at 300). Is it possible to make it ignore the formulas?  When doing it in a blank cell as norma, it works perfectly, though! Thank you very much!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 11, "user_id": 9421512, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "colonel179", "link": "https://stackoverflow.com/users/9421512/colonel179"}, "edited": false, "score": 0, "creation_date": 1536807526, "post_id": 52303962, "comment_id": 91559362, "body": "E.g. <code>Do While Len(rwSource.Cells(1)) &gt; 0</code> would keep going until it hit a row with nothing in ColA"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1536789575, "last_edit_date": 1536789575, "creation_date": 1536788940, "answer_id": 52303962, "question_id": 52300614, "link": "https://stackoverflow.com/questions/52300614/copy-dynamic-rows-into-a-table/52303962#52303962", "title": "Copy dynamic rows into a table", "body": "<p>Something like this (untested) should work:</p>\n\n<pre><code>Sub CopyValues()\n\n    Dim rwSource As Range, lo As ListObject\n\n    Set rwSource = Worksheets(\"source\").Rows(2) '&lt;&lt; first row to copy from\n\n    Set lo = ThisWorkbook.Worksheets(\"report\").Range(\"Table1\").ListObject\n\n    Do While Application.CountA(rwSource) &gt; 0\n\n        'Assign the values in one shot as an array....\n        lo.ListRows.Add(AlwaysInsert:=True).Range.Cells(1).Resize(1, 7).Value = _\n               Array(rwSource.Cells(1), rwSource.Cells(2), rwSource.Cells(4), _\n                     rwSource.Cells(3), rwSource.Cells(7), rwSource.Cells(6), _ \n                     rwSource.Cells(5))\n\n        Set rwSource = rwSource.Offset(1, 0) '&lt;&lt; next source row\n    Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9421512, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "colonel179", "link": "https://stackoverflow.com/users/9421512/colonel179"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536789575, "creation_date": 1536773431, "question_id": 52300614, "link": "https://stackoverflow.com/questions/52300614/copy-dynamic-rows-into-a-table", "title": "Copy dynamic rows into a table", "body": "<p>I would like to find a solution to this issue I am having.</p>\n\n<p>I have a button that runs this code:</p>\n\n<pre><code>Sub CopyValues()\n\nDim ws As Worksheet\n\nSet ws = Worksheets(\"report\")\n\nDim oNewRow As ListRow\n\nSet oNewRow = ThisWorkbook.Worksheets(\"report\").Range(\"Table1\").ListObject.ListRows.Add(AlwaysInsert:=True)\n\nWith ThisWorkbook.Sheets(1)\n\noNewRow.Range.Cells(1, 1).Value = ThisWorkbook.Worksheets(1).Range(\"A4\")\noNewRow.Range.Cells(1, 2).Value = ThisWorkbook.Worksheets(1).Range(\"B4\")\noNewRow.Range.Cells(1, 3).Value = ThisWorkbook.Worksheets(1).Range(\"D4\")\noNewRow.Range.Cells(1, 4).Value = ThisWorkbook.Worksheets(1).Range(\"C4\")\noNewRow.Range.Cells(1, 5).Value = ThisWorkbook.Worksheets(1).Range(\"G4\")\noNewRow.Range.Cells(1, 6).Value = ThisWorkbook.Worksheets(1).Range(\"F4\")\noNewRow.Range.Cells(1, 7).Value = ThisWorkbook.Worksheets(1).Range(\"E4\")\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>When I press the button, it copies the values from the first row of a range to a table. Every time I press the button, it copies the same row to a new row in the table.</p>\n\n<p>What I want is this:\nThe range (it's a range not a table)is in the sheet called \"source\". When I press the button, I would like it to copy each row into a corresponding row on the table in sheet \"report\".</p>\n\n<p>My guess is, the code above would have to be modified to include a loop in order to go to down each row until if finds a blank row, but then also the ranges would have to change from A4 to A5, and A6, and so on until blank. I don't know how to do that code in VBA.</p>\n\n<p>NOTE: If you notice, in the code, the order is ABDCGFE, that is because the table in which I need to copy the values to is in different order than the source table. I NEED IT THAT WAY, that's why I can't do a simple copy paste.</p>\n\n<p>NOTE 2: The rows from range in sheet \"source\" will eventually be dynamic!</p>\n\n<p>Thank you very much</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536772374, "post_id": 52300231, "comment_id": 91548429, "body": "What do you mean by <code>.HTMLBody doesn&#39;t work for invites</code> ?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1536775021, "post_id": 52300231, "comment_id": 91549639, "body": "Instead of posting a new question, maybe try following up on your previouis one?  <a href=\"https://stackoverflow.com/questions/52281033/how-to-enable-htmlbody-on-excel-vba\" title=\"how to enable htmlbody on excel vba\">stackoverflow.com/questions/52281033/&hellip;</a>   I was not proposing you use C# - that language did happen to be in the link I posted but this is do-able in VBA."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1536776081, "post_id": 52300231, "comment_id": 91550134, "body": "Post the code you&#39;ve written and state explicitly what goes wrong when you try to make your desired changes. Otherwise, you&#39;re asking a simple &quot;Yes/No&quot; question."}, {"owner": {"reputation": 21, "user_id": 10348844, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kqIrbU7pw68/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMebaDhp-k58cmxKLoQWJUGSY287A/mo/photo.jpg?sz=128", "display_name": "Pablo", "link": "https://stackoverflow.com/users/10348844/pablo"}, "edited": false, "score": 0, "creation_date": 1536779429, "post_id": 52300231, "comment_id": 91551734, "body": "Thank you for your answers: Marcucciboy2: AppointmentItems doesn&#39;t have the .HTMLBody property. TimWilliams could you show me a code example on how to do so? Sorry for posting a new question Tim, I am new to this forum, I checked the link you shared and tried a few things proposed in it, but  unfortunately I haven&#39;t been able to make it work. FreeMan I will edit my question and add the code then, thanks again for your contributions!"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10348844, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kqIrbU7pw68/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMebaDhp-k58cmxKLoQWJUGSY287A/mo/photo.jpg?sz=128", "display_name": "Pablo", "link": "https://stackoverflow.com/users/10348844/pablo"}, "edited": false, "score": 0, "creation_date": 1536792034, "post_id": 52303460, "comment_id": 91556327, "body": "It works perfectly!!!!! Thank you very much Tim!!! Is there any place where I could upload the excel file with the macro for others to download and use? I think many people could find it useful :)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 21, "user_id": 10348844, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kqIrbU7pw68/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMebaDhp-k58cmxKLoQWJUGSY287A/mo/photo.jpg?sz=128", "display_name": "Pablo", "link": "https://stackoverflow.com/users/10348844/pablo"}, "edited": false, "score": 0, "creation_date": 1536792726, "post_id": 52303460, "comment_id": 91556491, "body": "There&#39;s no place here for that.  You can put it somewhere like box/dropbox/etc and post a public URL in a comment, but people (including me) typically very wary about downloading macro-enabled files."}, {"owner": {"reputation": 21, "user_id": 10348844, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kqIrbU7pw68/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMebaDhp-k58cmxKLoQWJUGSY287A/mo/photo.jpg?sz=128", "display_name": "Pablo", "link": "https://stackoverflow.com/users/10348844/pablo"}, "edited": false, "score": 0, "creation_date": 1536794382, "post_id": 52303460, "comment_id": 91556812, "body": "Yeah, you have a point... and Tim, is there any way I could compensate you for your help?? You can&#39;t imagine how useful your help has been :D"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 21, "user_id": 10348844, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kqIrbU7pw68/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMebaDhp-k58cmxKLoQWJUGSY287A/mo/photo.jpg?sz=128", "display_name": "Pablo", "link": "https://stackoverflow.com/users/10348844/pablo"}, "edited": false, "score": 0, "creation_date": 1536795104, "post_id": 52303460, "comment_id": 91556987, "body": "Thanks for the offer, but no need for that - was an interesting challenge for me to figure out and now I have a solution stored here on SO if I ever need one ;-)"}, {"owner": {"reputation": 21, "user_id": 10348844, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kqIrbU7pw68/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMebaDhp-k58cmxKLoQWJUGSY287A/mo/photo.jpg?sz=128", "display_name": "Pablo", "link": "https://stackoverflow.com/users/10348844/pablo"}, "edited": false, "score": 0, "creation_date": 1536822423, "post_id": 52303460, "comment_id": 91563716, "body": "All right then :D thank you very much for your help, I will always be grateful for this :) best wishes and have a nice day!"}, {"owner": {"reputation": 221, "user_id": 645146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a804108f28e21e6eff0737554faffc?s=128&d=identicon&r=PG", "display_name": "n3vermind", "link": "https://stackoverflow.com/users/645146/n3vermind"}, "edited": false, "score": 0, "creation_date": 1588751640, "post_id": 52303460, "comment_id": 109015467, "body": "You probably would like to add <code>m.Delete</code> after <code>m.Close</code> if you don&#39;t want to leave email in <b>Drafts</b> folder."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1536792760, "last_edit_date": 1536792760, "creation_date": 1536786193, "answer_id": 52303460, "question_id": 52300231, "link": "https://stackoverflow.com/questions/52300231/how-to-include-formatted-text-in-the-body-of-an-outlook-invite-from-excel/52303460#52303460", "title": "How to include formatted text in the body of an Outlook invite from Excel", "body": "<p>Try this:</p>\n\n<pre><code>Sub SetApptWithHTMLContent()\n\n    Dim olapp As Outlook.Application, appt As Outlook.AppointmentItem\n    Dim m As Outlook.MailItem\n    Dim rtf() As Byte\n\n    Set olapp = New Outlook.Application\n    Set m = olapp.CreateItem(olMailItem)\n    Set appt = olapp.CreateItem(olAppointmentItem)\n\n    appt.Subject = \"Meeting request\"\n    '...set other appointment properties\n    appt.Display\n    'put the HTML into the mail item, then copy and paste to appt\n    m.BodyFormat = olFormatHTML\n    m.HTMLBody = Range(\"A1\").Value 'sample HTML stored in a cell\n    m.GetInspector().WordEditor.Range.FormattedText.Copy\n    appt.GetInspector().WordEditor.Range.FormattedText.Paste\n    m.Close False 'don't save...\n\nEnd Sub\n</code></pre>\n\n<p>Sample HTML:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>  &lt;h1&gt;Title Here&lt;/H1&gt;\r\n\t&lt;span style='background-color: #ffff00'&gt;Table of stuff:&lt;/span&gt;&lt;br&gt;\r\n\t&lt;table&gt;\r\n\t&lt;tr&gt;\r\n\t\t&lt;td style='background-color: #ff9900'&gt;One&lt;/td&gt;\r\n\t\t&lt;td&gt;Two&lt;/td&gt;\r\n\t&lt;/tr&gt;\r\n\t&lt;tr&gt;\r\n\t\t&lt;td&gt;Three&lt;/td&gt;\r\n\t\t&lt;td&gt;Four&lt;/td&gt;\r\n\t&lt;/tr&gt;\r\n\t&lt;/table&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Final appointment body:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZILVJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZILVJ.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 21, "user_id": 10348844, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kqIrbU7pw68/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMebaDhp-k58cmxKLoQWJUGSY287A/mo/photo.jpg?sz=128", "display_name": "Pablo", "link": "https://stackoverflow.com/users/10348844/pablo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2786, "favorite_count": 1, "accepted_answer_id": 52303460, "answer_count": 1, "score": 0, "last_activity_date": 1616592396, "creation_date": 1536771829, "last_edit_date": 1557675510, "question_id": 52300231, "link": "https://stackoverflow.com/questions/52300231/how-to-include-formatted-text-in-the-body-of-an-outlook-invite-from-excel", "title": "How to include formatted text in the body of an Outlook invite from Excel", "body": "<p>I would like to insert text with format (links, bold, highlighted...) in an Outlook invite using Excel VBA.</p>\n\n<p>I have a program that send invites from Excel. The body contains plain text. I am using .body but I am afraid I will have to use a different approach (.HTMLBody doesn't work for invites and RTFbody seems to be over complicated from what I have read). </p>\n\n<p>I have body templates in Word, in Outlook as quick parts, in the clipboard and some other places. </p>\n\n<p>Code:</p>\n\n<pre><code>Sub Invite_Merge(meeting_date As Date, meeting_time As Double,         \n    meeting_duration As Integer, client_email As String, meeting_subject As String,\n    meeting_location As String, client_name As String, meeting_body As String,\n    meeting_sender As String)\n\n\nDim O As Outlook.Application\nSet O = New Outlook.Application\n\nDim OAPT As Outlook.AppointmentItem\nSet OAPT = O.CreateItem(olAppointmentItem)\nOAPT.MeetingStatus = olMeeting\n\nDim meeting_start\nmeeting_start = DateValue(meeting_date) + meeting_time\n\nWith OAPT\n\n    .Recipients.Add (client_email)\n    .Subject = meeting_subject\n    .Start = meeting_start\n    .Duration = meeting_duration\n    .Location = meeting_location\n    '.body = here is where I have trouble, the property body only allows me to insert plaintext, .HTMLBody is not a AppointmentsItem property and I have not found an example code on how to use convert a formatted text (with links, bold, different fonts...) into a compatible .RTFBody byte array\n    .Display\n    '.Send\n\nEnd With\n\nEnd Sub\n\n\nSub Send_Invites()\n\nrow_number = 2\n\nDo\nDoEvents\n\nrow_number = row_number + 1\nIf IsEmpty(Sheet1.Range(\"D\" &amp; row_number)) = False Then\n\n    Call Invite_Merge(Sheet1.Range(\"A\" &amp; row_number), Sheet1.Range(\"B\" &amp; row_number), Sheet1.Range(\"C\" &amp; row_number), Sheet1.Range(\"D\" &amp; row_number), Sheet1.Range(\"E\" &amp; row_number), Sheet1.Range(\"F\" &amp; row_number), Sheet1.Range(\"G\" &amp; row_number), Sheet1.Range(\"H\" &amp; row_number), Sheet1.Range(\"A\" &amp; \"1\"))\n\nEnd If\nLoop Until row_number = 100\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba", "excel", "web-scraping"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 2, "creation_date": 1536772724, "post_id": 52299953, "comment_id": 91548584, "body": "That is not VB.NET code.  Consult the tags for the correct usage."}, {"owner": {"reputation": 925, "user_id": 9491208, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vGGz3NCqHUo/AAAAAAAAAAI/AAAAAAAABtU/QLcpa2IbJMw/photo.jpg?sz=128", "display_name": "Simo", "link": "https://stackoverflow.com/users/9491208/simo"}, "edited": false, "score": 0, "creation_date": 1536773145, "post_id": 52299953, "comment_id": 91548767, "body": "DO NOT use <code>DoEvents</code> in order to make your program responsive while waiting for something or while doing something. It could cause issues and unexpected bug"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536773691, "post_id": 52299953, "comment_id": 91549029, "body": "You are creating and destroying the internet explorer object each time you loop. Don&#39;t. Create once and use navigate to go to next URL i.e. create internet explorer object before loop and .Quit after."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1536820785, "last_edit_date": 1536820785, "creation_date": 1536775772, "answer_id": 52301153, "question_id": 52299953, "link": "https://stackoverflow.com/questions/52299953/vba-to-transfer-inner-text-from-html-page-to-excel/52301153#52301153", "title": "VBA to transfer inner text from html page to excel", "body": "<p><strong>Outline:</strong></p>\n\n<p>Two methods. One with no browser opening, issuing <a href=\"https://codingislove.com/http-requests-excel-vba/\" rel=\"nofollow noreferrer\">XMLHTTP request</a>, the other using Internet Explorer.</p>\n\n<p>If there is an API way to get this done I would definitely go with that. The following 2 methods <strong><em>currently</em></strong> work for all your shown URLs.</p>\n\n<p><strong>Note:</strong> </p>\n\n<p>These are based on end part of URL in sheet i.e. the person's name. See image at bottom.</p>\n\n<h2>XMLHTTP request:</h2>\n\n<p>This uses a custom class <code>clsHTTP</code> to hold the <code>XMLHTTP object</code>. It has 2 methods. One, <code>GetString</code>, to issue the request and parse out a section of the response. The other, <code>GetInfo</code>, to take the string returned by <code>GetString</code> and parse out the elements of interest and return them in an array.</p>\n\n<p><strong>TODO:</strong></p>\n\n<p>The class can be developed. It is bare bones. In particular, it could do with error handling added in, for example, to handle loss of server connection.</p>\n\n<p><strong>VBA:</strong></p>\n\n<p>Class <code>clsHTTP</code>:</p>\n\n<pre><code>Option Explicit\n\nPrivate http As Object\nPrivate Sub Class_Initialize()\n    Set http = CreateObject(\"MSXML2.XMLHTTP\")\nEnd Sub\n\nPublic Function GetString(ByVal URL As String) As String\n    Dim sResponse As String\n    With http\n        .Open \"GET\", URL, False\n        .send\n        sResponse = StrConv(.responseBody, vbUnicode)\n        GetString = Split(Split(sResponse, \"ProfilePage\"\":\")(1), \"comments_disabled\")(0)   \n    End With\nEnd Function\n\nPublic Function GetInfo(ByVal sResponse As String) As Variant\n    Dim results(0 To 4)\n    'Name, Followers,  Following,Posts,Biography\n    On Error Resume Next\n    results(0) = Split(sResponse, \"\"\"full_name\"\":\"\"\")(1)\n    results(1) = Split(Split(sResponse, \"\"\"count\"\":\")(1), \"}\")(0)\n    results(2) = Split(Split(sResponse, \"\"\"count\"\":\")(2), \"}\")(0)\n    results(3) = Split(Split(sResponse, \"\"\"count\"\":\")(4), \",\")(0)\n    results(4) = Split(Split(sResponse, \"\"\"biography\"\":\"\"\")(1), \"\"\",\")(0)\n    On Error GoTo 0\n    GetInfo = results\nEnd Function\n</code></pre>\n\n<p>Standard module <code>module 1</code>:</p>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim http As clsHTTP, sResponse As String, lastRow As Long, groupResults()\n    Set http = New clsHTTP\n    Const BASE_URL As String = \"https://www.instagram.com/\"\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        Select Case lastRow\n        Case 1\n            Exit Sub\n        Case 2\n            ReDim arr(1, 1): arr(1, 1) = .Range(\"A2\").Value\n        Case Else\n            arr = .Range(\"A2:A\" &amp; lastRow).Value\n        End Select\n\n        ReDim groupResults(0 To lastRow - 2)\n        Dim results(0 To 4), counter As Long, i As Long\n        With http\n            For i = LBound(arr, 1) To UBound(arr, 1)\n                If Len(BASE_URL &amp; arr(i, 1)) &gt; Len(BASE_URL) Then\n                     sResponse = .GetString(BASE_URL &amp; arr(i, 1))\n                    groupResults(counter) = .GetInfo(sResponse)\n                    sResponse = vbNullString\n                    counter = counter + 1\n                End If\n            Next\n        End With\n\n        For i = LBound(groupResults) To UBound(groupResults)\n            .Cells(2 + i, \"B\").Resize(1, UBound(results) + 1) = groupResults(i)\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<h2><strong>Internet Explorer:</strong></h2>\n\n<p>I will write something better a little later but the following places the loop inside of where you have create the Internet Explorer object so you don't keep creating and destroying. It introduces waits for elements to be present and also for page loading.</p>\n\n<hr>\n\n<p><strong>TODO:</strong></p>\n\n<p>Some initial changes I would make:</p>\n\n<ol>\n<li>Refactor the code to have separate functions/subs that handle the data extraction;</li>\n<li>Add in methods to manage failed connections/timeouts.</li>\n</ol>\n\n<hr>\n\n<p><strong>VBA:</strong></p>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim IE As New InternetExplorer, lastRow As Long, arr(), groupResults()\n\n    Const BASE_URL As String = \"https://www.instagram.com/\"\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        Select Case lastRow\n        Case 1\n            Exit Sub\n        Case 2\n            ReDim arr(1, 1): arr(1, 1) = .Range(\"A2\").Value\n        Case Else\n            arr = .Range(\"A2:A\" &amp; lastRow).Value\n        End Select\n\n        ReDim groupResults(0 To lastRow - 2)\n        Dim results(0 To 4), counter As Long, i As Long\n        With IE\n            .Visible = True\n\n            For i = LBound(arr, 1) To UBound(arr, 1)\n                If Len(BASE_URL &amp; arr(i, 1)) &gt; Len(BASE_URL) Then\n                    .navigate BASE_URL &amp; arr(i, 1)\n\n                    While .Busy Or .readyState &lt; 4: DoEvents: Wend\n                    'Name, Followers,  Following,Posts,Biography\n                    Dim aNodeList As Object, ele As Object, t As Date\n                    Const MAX_WAIT_SEC As Long = 5\n\n                    t = Timer\n\n                    Do\n                        DoEvents\n                        On Error Resume Next\n                        Set ele = .document.querySelector(\".rhpdm\")\n                        On Error GoTo 0\n                        If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n                    Loop While ele Is Nothing\n\n                    '   Application.Wait Now + TimeSerial(0, 0, 2)\n                    results(0) = ele.innerText\n                    Set aNodeList = .document.querySelectorAll(\".g47SY\")\n                    results(1) = aNodeList.item(0).innerText\n                    results(2) = aNodeList.item(1).innerText\n                    results(3) = aNodeList.item(2).innerText\n                    results(4) = .document.querySelector(\".rhpdm ~ span\").innerText\n                    Set aNodeList = Nothing : Set ele = Nothing\n                    groupResults(counter) = results\n                    counter = counter + 1\n                End If \n            Next        \n            .Quit '&lt;== Remember to quit application\n        End With\n\n        For i = LBound(groupResults) To UBound(groupResults)\n            .Cells(2 + i, \"B\").Resize(1, UBound(results) + 1) = groupResults(i)\n        Next\n\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Results:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/w78qK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w78qK.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 10354293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BqyY5.jpg?s=128&g=1", "display_name": "Kapriano", "link": "https://stackoverflow.com/users/10354293/kapriano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 824, "favorite_count": 1, "accepted_answer_id": 52301153, "answer_count": 1, "score": -1, "last_activity_date": 1536820785, "creation_date": 1536770546, "last_edit_date": 1536809847, "question_id": 52299953, "link": "https://stackoverflow.com/questions/52299953/vba-to-transfer-inner-text-from-html-page-to-excel", "title": "VBA to transfer inner text from html page to excel", "body": "<p><strong>This image shows what I use the following macro</strong><br>\n<a href=\"https://i.stack.imgur.com/n4YHi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n4YHi.png\" alt=\"enter image description here\"></a></p>\n\n<p>But this code stops after the opening of two or three URLs and we see the following error message,<br>\n1.  run-time err  91<br>\n2.  object variable or with block not set<br></p>\n\n<pre><code>Sub test()\n\nDim wb As Object\nDim doc As Object\nDim sURL As String\nDim lastrow As Long\nDim n As Integer\nDim i As Integer\nDim HtmlToText As String\nDim result\nlastrow = Sheet1.Cells(Rows.Count, \"A\").End(xlUp).Row\n\nFor i = 2 To lastrow  'Start the loop on the second row of column A. Until the last URL..\n\n    Set wb = CreateObject(\"internetExplorer.Application\")\n    sURL = Cells(i, 1)\n    wb.navigate sURL\n    wb.Visible = False\n    While wb.Busy\n      DoEvents\n    Wend\n    'HTML document\n    Set doc = wb.document\n    Dim Name As Variant\n    Dim Posts As Variant\n    Dim Followers As Variant\n    Dim Following As Variant\n    Dim DivValue As Variant\n    Dim DivValueSplit As Variant\n    Dim DivValueResult As Variant\n    Dim Biography As Variant\n\n    Name = doc.getElementsByClassName(\"AC5d8 notranslate\")(0).innerText\n    Posts = doc.getElementsByClassName(\"g47SY\")(0).innerText\n    Followers = doc.getElementsByClassName(\"g47SY\")(1).innerText\n    Following = doc.getElementsByClassName(\"g47SY\")(2).innerText\n    'dd = web.document.querySelector(\"div.-vDIg span\").innerText\n    DivValue = doc.getElementsByClassName(\"-vDIg\")(0).innerText\n\n    'DivValueSplit = Split(DivValue, \"&lt;br&gt;\")\n    'If UBound(DivValueSplit) = 2 Then\n    '   DivValueResult = DivValueSplit(1) &amp; DivValueSplit(2)\n     '  j = InStr(DivValueResult, \"&lt;/span&gt;\")\n      ' Biography = Mid(DivValueResult, 7, j - 7)\n    'ElseIf sURL = \"https://www.instagram.com/philipplein/\" Then\n     ' DivValueResult = DivValueSplit(0)\n      'j = InStr(DivValueResult, \"&lt;/h1&gt;\")\n      'Biography = Mid(DivValueResult, 19, j - 5)\n    'Else\n     '   DivValueResult = DivValueSplit(1)\n      '  j = InStr(DivValueResult, \"&lt;/span&gt;\")\n       ' Biography = Mid(DivValueResult, 7, j - 7)\n    'End If\n\n    Worksheets(\"sheet1\").Cells(i, 2) = Name\n    Worksheets(\"sheet1\").Cells(i, 3) = Followers\n    Worksheets(\"sheet1\").Cells(i, 4) = Following\n    Worksheets(\"sheet1\").Cells(i, 5) = Posts\n    Worksheets(\"sheet1\").Cells(i, 6) = DivValue\n    'Biography = Replace(re1, \"&lt;span&gt;\", \"\")\n\n    'Cells(i, 2) = HtmlToText\n    ' myarray = Split(Data, vbCrLf)\nerr_clear:\n\n\n\n      If Err &lt;&gt; 0 Then\n          Err.Clear\n          Resume Next\n        End If\n        wb.Quit\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536770495, "post_id": 52299642, "comment_id": 91547501, "body": "I&#39;m not understanding how the data afterwards is sorted. It looks like it&#39;s sorted based on table1&#39;s &quot;Number&quot; column, but why is there a gap in row 5?"}, {"owner": {"reputation": 1, "user_id": 10354283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fb449c6fbf9554124cab9f5461a26f8?s=128&d=identicon&r=PG&f=1", "display_name": "The Angelo", "link": "https://stackoverflow.com/users/10354283/the-angelo"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536770864, "post_id": 52299642, "comment_id": 91547696, "body": "Sorry about that. I didn&#39;t consider much about the sorting aspect when I created the sample image. Basically the &quot;After&quot; image is what we have been doing manually. The sorting didn&#39;t matter much. We just insert an extra line for rows that is not equal on the other table to show that this item does not exist in the new table."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536771269, "post_id": 52299642, "comment_id": 91547886, "body": "That&#39;s okay I was just thinking that matching these up is probably simpler when they&#39;re sorted which I didn&#39;t really convey"}], "answers": [{"tags": [], "owner": {"reputation": 582, "user_id": 6896061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf0230605ac24f5be23ea08c02dbbe5?s=128&d=identicon&r=PG", "display_name": "DavidP", "link": "https://stackoverflow.com/users/6896061/davidp"}, "is_accepted": false, "score": 1, "last_activity_date": 1536773944, "creation_date": 1536773944, "answer_id": 52300741, "question_id": 52299642, "link": "https://stackoverflow.com/questions/52299642/i-have-two-tables-in-the-same-sheet-how-do-i-align-rows-which-have-the-same-set/52300741#52300741", "title": "I have two tables in the same Sheet. How do I align rows which have the same set of data using Excel or VBA?", "body": "<p>Might not be the best way, but a relatively simple way might be to just automate what you're doing manually. Loop through the rows, check if the columns you want are the same, the use the <code>Range.Insert</code> method to perform the inserts instead of doing them manually.</p>\n\n<p>If this were a pair of tables in SQL, what you're looking for is the equivalent of a <code>FULL OUTER JOIN</code> of the two tables on the three columns of interest. There's some information about performing this type of operation in Excel over in <a href=\"https://superuser.com/questions/1023123/how-to-simulate-a-full-outer-join-in-excel\">this Super User question</a>.</p>\n\n<p>I threw the sample data into a SQL database and was able to reproduce the desired output using these queries:</p>\n\n<pre><code>SELECT t1.* \nFROM Table1 t1\n    FULL OUTER JOIN Table2 t2 ON t1.Number = t2.Number AND t1.[Name] = t2.[Name] AND t1.[Order] = t2.[Order]\nORDER BY CASE WHEN t1.Number IS NULL THEN t2.Number ELSE t1.Number END\n\nSELECT t2.* \nFROM Table1 t1\n    FULL OUTER JOIN Table2 t2 ON t1.Number = t2.Number AND t1.[Name] = t2.[Name] AND t1.[Order] = t2.[Order]\nORDER BY CASE WHEN t1.Number IS NULL THEN t2.Number ELSE t1.Number END\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10354283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fb449c6fbf9554124cab9f5461a26f8?s=128&d=identicon&r=PG&f=1", "display_name": "The Angelo", "link": "https://stackoverflow.com/users/10354283/the-angelo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1594055267, "creation_date": 1536769281, "last_edit_date": 1594055267, "question_id": 52299642, "link": "https://stackoverflow.com/questions/52299642/i-have-two-tables-in-the-same-sheet-how-do-i-align-rows-which-have-the-same-set", "title": "I have two tables in the same Sheet. How do I align rows which have the same set of data using Excel or VBA?", "body": "<p>I have two tables in the same Excel Sheet.</p>\n\n<p>I want to use an Excel VBA code in order to align a set of rows that are partly equal on the same line. Is it possible to do this?</p>\n\n<p>I've been thinking about this but I can't seem to figure out the code.</p>\n\n<p>For example, I want to align the rows with the same \n\"Number\", \"Name\", and \"Order\" inputted.</p>\n\n<p>Before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/rVaCG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rVaCG.png\" alt=\"enter image description here\"></a></p>\n\n<p>After:\n<a href=\"https://i.stack.imgur.com/9jurf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9jurf.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10354299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cac743bb7f4822159abdd9a937d1cad9?s=128&d=identicon&r=PG&f=1", "display_name": "user10354299", "link": "https://stackoverflow.com/users/10354299/user10354299"}, "edited": false, "score": 0, "creation_date": 1536769703, "post_id": 52299544, "comment_id": 91547132, "body": "Figured out a similar method myself. Didn&#39;t realize how .NumberFormat worked. Used Format()... worked like a charm. See my solution."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 43, "user_id": 10354299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cac743bb7f4822159abdd9a937d1cad9?s=128&d=identicon&r=PG&f=1", "display_name": "user10354299", "link": "https://stackoverflow.com/users/10354299/user10354299"}, "edited": false, "score": 0, "creation_date": 1536770753, "post_id": 52299544, "comment_id": 91547635, "body": "@user10354299 notice how this answer <i>explains what and why</i>, rather than simply handing out a code dump. An answer like this is much more useful to people googling solutions to a similar problem, which is ultimately what this site is all about; consider marking this answer as &quot;accepted&quot; by clicking the hollow checkmark."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1536772143, "post_id": 52299544, "comment_id": 91548325, "body": "@Marcucciboy2 I purposefully left <code>tdate</code> as a variant, because I try to change as few as possible to make it easy to track down what actually caused the error. If I were to rewrite this, I&#39;d probably leave out the variable altogether and just directly concatenate it. Same goes for why <code>TestFile</code> has no value."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536772204, "post_id": 52299544, "comment_id": 91548360, "body": "That&#39;s fair, different strokes"}, {"owner": {"reputation": 43, "user_id": 10354299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cac743bb7f4822159abdd9a937d1cad9?s=128&d=identicon&r=PG&f=1", "display_name": "user10354299", "link": "https://stackoverflow.com/users/10354299/user10354299"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1536773585, "post_id": 52299544, "comment_id": 91548981, "body": "@MathieuGuindon yes, I frequent the site for help. Explanation is much appreciated--i know how far it goes for people with similar issues. Just was proud of solving it myself...wanted to share."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 43, "user_id": 10354299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cac743bb7f4822159abdd9a937d1cad9?s=128&d=identicon&r=PG&f=1", "display_name": "user10354299", "link": "https://stackoverflow.com/users/10354299/user10354299"}, "edited": false, "score": 3, "creation_date": 1536773735, "post_id": 52299544, "comment_id": 91549047, "body": "@user10354299 no harm self-answering at all, it&#39;s even encouraged! if your answer <i>explained</i> what was going on, I&#39;d absolutely have given it an upvote =) keep up the good work!"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 2, "last_activity_date": 1536772027, "last_edit_date": 1536772027, "creation_date": 1536768923, "answer_id": 52299544, "question_id": 52299480, "link": "https://stackoverflow.com/questions/52299480/vba-remove-a-formatted-date-from-the-end-of-a-file-everyday-and-resave/52299544#52299544", "title": "VBA: Remove a formatted date from the end of a file everyday and resave", "body": "<p><code>.NumberFormat</code> is a cell property. <code>tdate</code> is not a cell, but a Variant, thus doesn't have that property.</p>\n\n<p>Use the <code>Format</code> function to format it instead:</p>\n\n<pre><code>Option Explicit\n\nSub changefilename()\n\n    Dim tdate As Variant\n    Dim ofile As Workbook\n    Dim TestFile As String\n\n    tdate = Format(Date, \"mm-dd-yy\")\n\n    Set ofile = Workbooks.Open(\"C:\\Users\\Research\\Documents\\Daily File \" &amp; tdate &amp; \".xlsx\")\n    ofile.SaveAs Filename:=TestFile\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 10354299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cac743bb7f4822159abdd9a937d1cad9?s=128&d=identicon&r=PG&f=1", "display_name": "user10354299", "link": "https://stackoverflow.com/users/10354299/user10354299"}, "is_accepted": false, "score": 3, "last_activity_date": 1536775276, "last_edit_date": 1536775276, "creation_date": 1536769599, "answer_id": 52299722, "question_id": 52299480, "link": "https://stackoverflow.com/questions/52299480/vba-remove-a-formatted-date-from-the-end-of-a-file-everyday-and-resave/52299722#52299722", "title": "VBA: Remove a formatted date from the end of a file everyday and resave", "body": "<pre><code> Option Explicit \n\n    Sub changefilename()\n\n Dim ofile As Workbook\n Dim TestFile As String \n\n\n    '##What we want the new save file to be called, with path:\nTestFile = \"C:\\Users\\Research\\Documents\\TEST.xlsx\"\n\n\n    '##Searches for a file that concats the file name with today's date.\n    '##Use format(Date,____) for how your date is formatted. No need to assign a variable to the Date.\nSet ofile = Workbooks.Open(\"C:\\Users\\Research\\Documents\\DailyFile\" &amp; Format(Date, \"mm-dd-yy\") &amp; \".xlsx\")\n\n       '##Saves the old file in the desired path!\nofile.SaveAs Filename:=TestFile\n\n\n    End Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1536770224, "post_id": 52299841, "comment_id": 91547356, "body": "I think you meant <code>ofile.SaveAs Filename:=ofile_Name</code>"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536771673, "post_id": 52299841, "comment_id": 91548073, "body": "Personally I think I would just do <code>ofile_Name = ofile.path &amp; &quot;\\Daily File.xlsx&quot;</code> instead of <code>Left(...)</code>"}], "tags": [], "owner": {"reputation": 31, "user_id": 9067858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a90bd042faf617df76e243ef113df16a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan R", "link": "https://stackoverflow.com/users/9067858/ryan-r"}, "is_accepted": false, "score": 1, "last_activity_date": 1536771547, "last_edit_date": 1536771547, "creation_date": 1536770096, "answer_id": 52299841, "question_id": 52299480, "link": "https://stackoverflow.com/questions/52299480/vba-remove-a-formatted-date-from-the-end-of-a-file-everyday-and-resave/52299841#52299841", "title": "VBA: Remove a formatted date from the end of a file everyday and resave", "body": "<pre><code>Sub changefilename()\n\n    Dim tdate As String\n    Dim ofile As Workbook\n    Dim ofile_Name As String\n\n    tdate = Format(Date, \"MM-DD-YY\")\n\n    Set ofile = Workbooks.Open(\"C:\\Users\\Research\\Documents\\Daily File \" &amp; tdate &amp; \".xlsx\")\n\n    'change the character 9 to whatever the length of the file name\n    ofile_Name = Left(ofile.Name, 9)\n\n    ofile.SaveAs Filename:=ofile_Name   \n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10354299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cac743bb7f4822159abdd9a937d1cad9?s=128&d=identicon&r=PG&f=1", "display_name": "user10354299", "link": "https://stackoverflow.com/users/10354299/user10354299"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 52299544, "answer_count": 3, "score": 1, "last_activity_date": 1536775276, "creation_date": 1536768684, "question_id": 52299480, "link": "https://stackoverflow.com/questions/52299480/vba-remove-a-formatted-date-from-the-end-of-a-file-everyday-and-resave", "title": "VBA: Remove a formatted date from the end of a file everyday and resave", "body": "<p>every day I receive an automated file saved in the format DailyFile 09-12-18.xlsx. </p>\n\n<p>I have written a VBA module to find a file called (in this case) DailyFile and update my necessary spreadsheets with the new daily data. </p>\n\n<p>However, I need a way to cut the date portion off of the daily file so that my module can identify it, but I also need to keep a copy of EVERY daily file (with the date in the file name) for my records. </p>\n\n<p>In other words, my master spreadsheet needs to pull the most up-to-date data from the daily file (which can be overwritten from yesterday), but I also want to save a copy of the original. </p>\n\n<p>Here's what I have so far... It isn't working:</p>\n\n<pre><code>Option Explicit\n\n\nSub changefilename()\n\nDim tdate As Variant\nDim ofile As Workbook\nDim TestFile As String\n\n\n\ntdate = Date\ntdate.NumberFormat = \"mm-dd-yy\"\n\nSet ofile = Workbooks.Open(\"C:\\Users\\Research\\Documents\\Daily File \" &amp; tdate &amp; \".xlsx\")\nofile.SaveAs Filename:=TestFile\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 1, "creation_date": 1536768210, "post_id": 52299260, "comment_id": 91546385, "body": "Welcome to Stackoverflow! You will get far better help if you post what you have tried and what errors you get."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1536768691, "post_id": 52299260, "comment_id": 91546666, "body": "You have one loop for <code>Lendsheet</code>, just add new ones for the other sheets after"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1536772005, "post_id": 52299260, "comment_id": 91548241, "body": "You don&#39;t need new loops - just add additional tests inside the existing loop."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1536772786, "creation_date": 1536772786, "answer_id": 52300462, "question_id": 52299260, "link": "https://stackoverflow.com/questions/52299260/copying-data-with-command-button-into-multiple-excel-sheets/52300462#52300462", "title": "Copying data with command button into multiple excel sheets", "body": "<p>The \"copy data to another sheet\" can be split out into a separate sub, and that cleans up your main code, making it easier to add new checks. </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim AllSheet As Worksheet\n    Dim LastRow As Long\n    Dim RowNum As Long\n\n    Set AllSheet = ActiveWorkbook.Sheets(\"All\")\n\n    With AllSheet\n        LastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n        For RowNum = 2 To LastRow\n\n            If UCase(.Cells(RowNum, 3).Value) = \"X\" Then\n                AppendRow .Rows(RowNum), \"Lending\"\n            End If\n\n            If UCase(.Cells(RowNum, 4).Value) = \"BLAH\" Then\n                AppendRow .Rows(RowNum), \"FX\"\n                AppendRow .Rows(RowNum), \"Account\" '&lt;&lt; can copy to &gt;1 sheet...\n            End If\n\n        Next\n\n    End With\n    '..... Remove Duplicates\nEnd Sub\n\n'append a range to a named sheet\nSub AppendRow(rwSrc As Range, shtName As String)\n    Dim rw As Range\n    Set c = ActiveWorkbook.Sheets(shtName).Cells(Rows.Count, 1).End(xlUp) _\n                                 .Offset(1, 0).Resize(1, rwSrc.Columns.Count)\n    'make sure we're really copying to a blank row...\n    Do While Application.CountA(rw) &gt; 0\n        Set rw = rw.Offset(1, 0)\n    Loop\n    rw.Value = rwSrc.Value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10352450, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-S8Q7q18l_oY/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMalGRWN8LE9dENNlJrgjY20z2TSQ/mo/photo.jpg?sz=128", "display_name": "Simon Kaldau", "link": "https://stackoverflow.com/users/10352450/simon-kaldau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536772786, "creation_date": 1536767855, "question_id": 52299260, "link": "https://stackoverflow.com/questions/52299260/copying-data-with-command-button-into-multiple-excel-sheets", "title": "Copying data with command button into multiple excel sheets", "body": "<p>I am trying to make a command button copy data from the main sheet \"all\" into 4 different sheets based on wether or not they meet the requirement. i have made it work with my \"Lending\" with the code bellow, but in the next 3 columns i have the data \"FX\" \"Account\" and \"Payments\" and i would like to have this one command button work with all of the sheets. Some of the dato points will go into multiple sheets, while some would only live up to 1 of them. Anyone who knows how i can expand the code to make it work?     </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim AllSheet As Worksheet\nDim LendSheet As Worksheet\nDim LastRow As Integer\nDim RowCnt As Integer\nDim DestRow As Integer\n\nSet AllSheet = ActiveWorkbook.Sheets(\"All\")\nSet LendSheet = ActiveWorkbook.Sheets(\"Lending\")\n\nWith AllSheet\n  LastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n  DestRow = LendSheet.Range(\"A\" &amp; LendSheet.Rows.Count).End(xlUp).Row + 1\n  For RowCnt = 2 To LastRow\n    If .Cells(RowCnt, 3).Value = \"X\" Or .Cells(RowCnt, 3).Value = \"x\" Then\n        LendSheet.Rows(DestRow).Value = .Rows(RowCnt).Value\n        DestRow = DestRow + 1\n    End If\n Next\nEnd With\n'..... Remove Duplicates\nDim LastCol As String\nWith LendSheet\n  LastCol = Split(.Range(\"A1\").End(xlToRight).Address, \"$\")(1)\n  .Range(\"A:\" &amp; LastCol).RemoveDuplicates Columns:=Array(1, 2, 3, 4, 5, 6, 7), \nHeader:=xlYes\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "edited": false, "score": 0, "creation_date": 1536767496, "post_id": 52298952, "comment_id": 91545970, "body": "Try determining the value of <code>vLink</code> by breaking the code before setting the hyperlink. The problem may be in what you&#39;re getting back from your Text Box."}, {"owner": {"reputation": 11, "user_id": 10274219, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hk5kUsH1xaA/AAAAAAAAAAI/AAAAAAAAANA/XXnHk33ceB0/photo.jpg?sz=128", "display_name": "greggb1967", "link": "https://stackoverflow.com/users/10274219/greggb1967"}, "reply_to_user": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "edited": false, "score": 0, "creation_date": 1536768268, "post_id": 52298952, "comment_id": 91546425, "body": "Yes, I did that with a msgbox and it returns just what I enter into the TextBox.  I found that if I leave the cell blank, a link is inserted &quot;c:\\path\\currentfile.xls&quot;  So for whatever reason, the current file is the default link."}, {"owner": {"reputation": 11, "user_id": 10274219, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hk5kUsH1xaA/AAAAAAAAAAI/AAAAAAAAANA/XXnHk33ceB0/photo.jpg?sz=128", "display_name": "greggb1967", "link": "https://stackoverflow.com/users/10274219/greggb1967"}, "reply_to_user": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "edited": false, "score": 0, "creation_date": 1536770784, "post_id": 52298952, "comment_id": 91547650, "body": "I found that entering the address &quot;<a href=\"http://test.com\" rel=\"nofollow noreferrer\">test.com</a>&quot; works.  Apparently without the http it assumes a file and defaults to the local drive."}, {"owner": {"reputation": 11, "user_id": 10274219, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hk5kUsH1xaA/AAAAAAAAAAI/AAAAAAAAANA/XXnHk33ceB0/photo.jpg?sz=128", "display_name": "greggb1967", "link": "https://stackoverflow.com/users/10274219/greggb1967"}, "reply_to_user": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "edited": false, "score": 0, "creation_date": 1536770892, "post_id": 52298952, "comment_id": 91547706, "body": "heh, this page assumed I wanted to put in a link.  I entered &quot;&quot;<a href=\"http://test.com\" rel=\"nofollow noreferrer\">test.com</a>&quot;&quot;"}, {"owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "edited": false, "score": 0, "creation_date": 1536777180, "post_id": 52298952, "comment_id": 91550666, "body": "Nice to know about the http assumption! Thanks. Didn&#39;t know that. In comments, you can use the reverse apostrophe to delimit code and keep the site from assuming links are clickable. As in: <code>http:&#47;&#47;test.com&#47;</code>"}], "owner": {"reputation": 11, "user_id": 10274219, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hk5kUsH1xaA/AAAAAAAAAAI/AAAAAAAAANA/XXnHk33ceB0/photo.jpg?sz=128", "display_name": "greggb1967", "link": "https://stackoverflow.com/users/10274219/greggb1967"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 307, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593730644, "creation_date": 1536766776, "last_edit_date": 1593730644, "question_id": 52298952, "link": "https://stackoverflow.com/questions/52298952/using-vba-to-insert-hyperlink-to-existing-string", "title": "Using VBA to insert hyperlink to existing string", "body": "<p>I'm having a problem with inserting a link into a text string in excel.  Everything works fine except that the current workbook file path is inserted before the link for some reason.  So when I enter (in a UserForm) \"www.test.com\", the resulting link is \"c:\\path\\www.test.com\"  Here is my code:</p>\n\n<pre><code>Dim vAnchor As String\nDim vLink As String\n\nvAnchor = Selection\nvLink = TextBox2\n\nActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:= _\nvLink, TextToDisplay:=vAnchor\n</code></pre>\n"}, {"tags": ["ms-access", "methods", "vba"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1536779586, "post_id": 52298546, "comment_id": 91551806, "body": "Add <code>Option Explicit</code> to the Declarations second of that code module.  Then compile your code by selecting Debug-&gt;Compile from the VBE editor&#39;s main menu.  Fix anything the compiler complains about and compile again.  Repeat until no more compile errors.  You would be wise to include <code>Option Explicit</code> in every module."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 9926966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQMCN.png?s=128&g=1", "display_name": "rgorowsky", "link": "https://stackoverflow.com/users/9926966/rgorowsky"}, "edited": false, "score": 0, "creation_date": 1536784810, "post_id": 52301079, "comment_id": 91553962, "body": "I&#39;m still having difficulty navigating errors. I&#39;ve tried a lot of googling and guess/check but I&#39;m confused on how to set up the index so that it states &#39;code&#39;StrSQL2.Seek &quot;=&quot;, 27...&#39;code&#39; the value &#39;27&#39; or &#39;external_nmad_id&#39; is the only column in the StrSQL2 recordset I&#39;ve made via the query. Here is what that section looks like as of now... &#39;&#39;StrSQL2.CreateIndex( &#39;Set StrSQL2.Fields(&quot;ID&quot;) =&#39; &#39;StrSQL2.Column(0).Value StrSQL2.Index = &quot;ID&quot; StrSQL2.Seek &quot;ID =&quot;,&#39; &#39;!external_nmad_id&#39;&#39;"}, {"owner": {"reputation": 55, "user_id": 9926966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQMCN.png?s=128&g=1", "display_name": "rgorowsky", "link": "https://stackoverflow.com/users/9926966/rgorowsky"}, "edited": false, "score": 0, "creation_date": 1536784950, "post_id": 52301079, "comment_id": 91554030, "body": "Sorry, I can&#39;t even format my code right in the comments - let alone get it to run"}, {"owner": {"reputation": 55, "user_id": 9926966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQMCN.png?s=128&g=1", "display_name": "rgorowsky", "link": "https://stackoverflow.com/users/9926966/rgorowsky"}, "edited": false, "score": 0, "creation_date": 1536785941, "post_id": 52301079, "comment_id": 91554422, "body": "yes, StrSQL2 is now a recordset.  I&#39;m now returning the Run-time error &#39;3251&#39; operation is not supported for this type of object."}, {"owner": {"reputation": 55, "user_id": 9926966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQMCN.png?s=128&g=1", "display_name": "rgorowsky", "link": "https://stackoverflow.com/users/9926966/rgorowsky"}, "edited": false, "score": 0, "creation_date": 1536786700, "post_id": 52301079, "comment_id": 91554682, "body": "I agree.  Thanks for your help @Hans, I think it&#39;s best to restart this thread:  I&#39;ve made a new question at this link <a href=\"https://stackoverflow.com/questions/52303535/access-vba-how-can-i-seek-a-value-in-a-recordset-error-code-3251-operation-i\">link</a>"}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1536775423, "creation_date": 1536775423, "answer_id": 52301079, "question_id": 52298546, "link": "https://stackoverflow.com/questions/52298546/access-vba-seek-method-get-run-time-error-438-or-method-or-data-member-not/52301079#52301079", "title": "Access VBA .seek method, get run-time error &#39;438&#39;, or Method or data member not found", "body": "<p>Consider a stripped down version of your code which still recreates the problem you're trying to solve.</p>\n\n\n\n<pre class=\"lang-vba prettyprint-override\"><code>Dim StrSQL2 As DAO.QueryDef\nSet StrSQL2 = CurrentDb.CreateQueryDef(\"\", \"SELECT RIGHT(IRSfileFormatKey, 10) As ID FROM 1042s_FinalOutput_7;\")\nSet StrSQL2.Index = \"ID\"\n</code></pre>\n\n<p>When you attempt to run that code, Access will complain <em>\"Object doesn't support this property or method\"</em>.  The reason that happens is because <code>StrSQL2</code> is a <code>DAO.QueryDef</code> and a <code>QueryDef</code> does not have an <code>Index</code> property.  See <a href=\"https://msdn.microsoft.com/en-us/library/office/ff192855.aspx\" rel=\"nofollow noreferrer\">QueryDef Members (DAO)</a></p>\n\n<p>So then you disable that problem line and try this ...</p>\n\n<pre class=\"lang-vba prettyprint-override\"><code>StrSQL2.Seek \"=\", 27 'I substituted an arbitrary number for !external_nmad_id just to keep this simple '\n</code></pre>\n\n<p>But Access responds with the same complaint again, which is because a <code>QueryDef</code> does not have a <code>Seek</code> method.</p>\n\n<p>Both <code>Index</code> and <code>Seek</code> are object members of a <code>DAO.Recordset</code>, so use them with a <code>Recordset</code> instead of a <code>QueryDef</code></p>\n\n<p>And if you go that route, designate the name of your controlling index like this ...</p>\n\n<pre class=\"lang-vba prettyprint-override\"><code>YourRecorsetVariable.Index = \"ID\"\n</code></pre>\n\n<p>Don't use <code>Set</code> there and make sure that <em>\"ID\"</em> is the name of the <em>index</em> ... which is not necessarily the name of the <em>column</em> which is indexed.  </p>\n"}], "owner": {"reputation": 55, "user_id": 9926966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQMCN.png?s=128&g=1", "display_name": "rgorowsky", "link": "https://stackoverflow.com/users/9926966/rgorowsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 52301079, "answer_count": 1, "score": 1, "last_activity_date": 1594629231, "creation_date": 1536765450, "last_edit_date": 1594629231, "question_id": 52298546, "link": "https://stackoverflow.com/questions/52298546/access-vba-seek-method-get-run-time-error-438-or-method-or-data-member-not", "title": "Access VBA .seek method, get run-time error &#39;438&#39;, or Method or data member not found", "body": "<p>I'm trying to use the seek method within a VBA code nested loop.  The goal is to use a query to search a table for ID values that match what was identified in the first loop.  I'm returning 'Method or data member not found' The error is occurring on the line 'Set StrSQL2.Index = \"ID\"'.  Since \"ID\" is the only column in that table created by the query I tried commenting it out, but it only shifts the error down to the next line 'StrSQL2.Seek \"=\", !external_nmad_id</p>\n\n<pre><code>Public Sub EditFinalOutput2()\n\n'set variables\nDim i As Long\nDim qs As DAO.Recordset\nDim ss As DAO.Recordset\nDim StrSQL2 As DAO.QueryDef\nDim IRSfileFormatKey As String\nDim external_nmad_id As String\nDim nmad_address_1 As String\nDim nmad_address_2 As String\nDim nmad_address_3 As String\nDim mytestwrite As String\n\n'open reference set\nSet db = CurrentDb\nSet qs = db.OpenRecordset(\"SunstarAccountsInWebir_SarahTest\")\n'Set ss = db.OpenRecordset(\"1042s_FinalOutput_7\")\n'Set StrSQL1 = db.OpenRecordset(\"SELECT RIGHT(IRSfileFormatKey, 10) As ID \nFROM 1042s_FinalOutput_7;\")\n\nWith qs.Fields\nintCount = qs.RecordCount - 1\nFor i = 0 To intCount\n\n    If (IsNull(!nmad_address_1) Or (!nmad_address_1 = !nmad_city) Or (!nmad_address_1 = !Webir_Country) And IsNull(!nmad_address_2) Or (!nmad_address_2 = !nmad_city) Or (!nmad_address_2 = !Webir_Country) And IsNull(!nmad_address_3) Or (!nmad_address_3 = !nmad_city) Or (!nmad_address_3 = !Webir_Country)) Then\n    DoCmd.RunSQL \"INSERT INTO Addresses_ToBeReviewed SELECT SunstarAccountsInWebir_SarahTest.* FROM SunstarAccountsInWebir_SarahTest WHERE (((SunstarAccountsInWebir_SarahTest.external_nmad_id)='\" &amp; qs!external_nmad_id &amp; \"'));\"\n\n    Else:\n        Set StrSQL2 = CurrentDb.CreateQueryDef(\"\", \"SELECT RIGHT(IRSfileFormatKey, 10) As ID FROM 1042s_FinalOutput_7;\")\n        Set ss = db.OpenRecordset(\"1042s_FinalOutput_7\")\n        Set StrSQL2.Index = \"ID\"\n        StrSQL2.Seek \"=\", !external_nmad_id\n\n            If ss.NoMatch Then\n            DoCmd.RunSQL \"INSERT INTO Addresses_NotUsed SELECT SunstarAccountsInWebir_SarahTest.* FROM SunstarAccountsInWebir_SarahTest WHERE (((SunstarAccountsInWebir_SarahTest.external_nmad_id)='\" &amp; qs!external_nmad_id &amp; \"'));\"\n\n            Else:   Set ss = db.OpenRecordset(\"1042s_FinalOutput_7\")\n                    ss.Edit\n                    ss.Fields(\"box13c_Address\") = qs.Fields(\"nmad_address_1\") &amp; qs.Fields(\"nmad_address_2\") &amp; qs.Fields(\"nmad_address_3\")\n                    ss.Update\n\n            End If\n    End If\n\nqs.MoveNext\nNext i\n\nEnd With\n\n'close reference set\nqs.Close\nSet qs = Nothing\nss.Close\nSet ss = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 301, "user_id": 3433053, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b08b686f8d28b970829bc41338824850?s=128&d=identicon&r=PG&f=1", "display_name": "Slab", "link": "https://stackoverflow.com/users/3433053/slab"}, "edited": false, "score": 0, "creation_date": 1536765082, "post_id": 52298348, "comment_id": 91544558, "body": "Oh thanks, I didn&#39;t realised you could use select case like that!"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 301, "user_id": 3433053, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b08b686f8d28b970829bc41338824850?s=128&d=identicon&r=PG&f=1", "display_name": "Slab", "link": "https://stackoverflow.com/users/3433053/slab"}, "edited": false, "score": 1, "creation_date": 1536765242, "post_id": 52298348, "comment_id": 91544661, "body": "@Slab - <code>Select Case</code> is pretty versatile - I use <code>Select Case True</code> and <code>Select Case False</code> a lot because of the short-circuiting behavior."}, {"owner": {"reputation": 301, "user_id": 3433053, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b08b686f8d28b970829bc41338824850?s=128&d=identicon&r=PG&f=1", "display_name": "Slab", "link": "https://stackoverflow.com/users/3433053/slab"}, "edited": false, "score": 0, "creation_date": 1536765837, "post_id": 52298348, "comment_id": 91544989, "body": "Oh OK, I&#39;m cancelling the marching band."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1536765855, "post_id": 52298348, "comment_id": 91545003, "body": "@Vityata &quot;assuming all the vars will equal zero&quot;."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536765954, "post_id": 52298348, "comment_id": 91545067, "body": "If you need to test multiple <i>different</i> values, it would be <a href=\"https://pastebin.com/WivPMmHq\" rel=\"nofollow noreferrer\">more like this</a>."}, {"owner": {"reputation": 301, "user_id": 3433053, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b08b686f8d28b970829bc41338824850?s=128&d=identicon&r=PG&f=1", "display_name": "Slab", "link": "https://stackoverflow.com/users/3433053/slab"}, "edited": false, "score": 0, "creation_date": 1536765977, "post_id": 52298348, "comment_id": 91545079, "body": "Ah so it wont work if I was checking if they were all equal to a non-zero number?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 301, "user_id": 3433053, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b08b686f8d28b970829bc41338824850?s=128&d=identicon&r=PG&f=1", "display_name": "Slab", "link": "https://stackoverflow.com/users/3433053/slab"}, "edited": false, "score": 0, "creation_date": 1536766109, "post_id": 52298348, "comment_id": 91545179, "body": "@Slab, It will work as long as you&#39;re testing if all the vars are the <i>same number</i>. If you need to test <i>different</i> conditions, then use either <code>Select Case True</code> or <code>Select Case False</code> as needed."}, {"owner": {"reputation": 301, "user_id": 3433053, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b08b686f8d28b970829bc41338824850?s=128&d=identicon&r=PG&f=1", "display_name": "Slab", "link": "https://stackoverflow.com/users/3433053/slab"}, "edited": false, "score": 0, "creation_date": 1536766229, "post_id": 52298348, "comment_id": 91545254, "body": "Ok, thats what I thought. Sorry I didn&#39;t write much in the OP, but that is exactly the question I was asking - a better way to test all the vars are equal to the same number. Thanks"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 301, "user_id": 3433053, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b08b686f8d28b970829bc41338824850?s=128&d=identicon&r=PG&f=1", "display_name": "Slab", "link": "https://stackoverflow.com/users/3433053/slab"}, "edited": false, "score": 0, "creation_date": 1536766295, "post_id": 52298348, "comment_id": 91545299, "body": "@Slab - welcome. In your question you needed to write <code>And</code> not <code>Or</code>."}, {"owner": {"reputation": 301, "user_id": 3433053, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b08b686f8d28b970829bc41338824850?s=128&d=identicon&r=PG&f=1", "display_name": "Slab", "link": "https://stackoverflow.com/users/3433053/slab"}, "edited": false, "score": 0, "creation_date": 1536766435, "post_id": 52298348, "comment_id": 91545372, "body": "Sorry I actually did mean <code>or</code>, I want to know if at least one of them is equal to zero."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 5, "last_activity_date": 1536764902, "creation_date": 1536764902, "answer_id": 52298348, "question_id": 52298238, "link": "https://stackoverflow.com/questions/52298238/alternative-to-if-statement-with-multiple-conditions-which-are-all-equal-to-same/52298348#52298348", "title": "Alternative to IF statement with multiple conditions which are all equal to same value", "body": "<p>You can do that with a <code>Select Case</code>. It will also short circuit the evaluation (unlike the <code>If</code> statement):</p>\n\n<pre><code>Select Case 0\n    Case var1, var2, var3, var4, var5, var6\n        'do something\nEnd Select\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1536766510, "post_id": 52298776, "comment_id": 91545416, "body": "Not needed, there was a change in the OP&#39;s needs (see the last comment)..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 2, "creation_date": 1536766552, "post_id": 52298776, "comment_id": 91545438, "body": "@Vityata meh, can&#39;t hurt to have these two anthagonistic functions anyway"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1536767156, "post_id": 52298776, "comment_id": 91545779, "body": "Note: for production use I&#39;d probably test if <code>values(LBound(values))</code> actually contains an array, so that you can make use it with an array reference <i>and</i> inline-enumerated values. Being <code>Variant</code> values, it should also work with dates, strings, and (barring floating-point rounding errors) single/double values. Remember to check for <code>IsError</code> too, if used with values from an Excel range."}, {"owner": {"reputation": 301, "user_id": 3433053, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b08b686f8d28b970829bc41338824850?s=128&d=identicon&r=PG&f=1", "display_name": "Slab", "link": "https://stackoverflow.com/users/3433053/slab"}, "edited": false, "score": 0, "creation_date": 1536837948, "post_id": 52298776, "comment_id": 91572326, "body": "This is a really nice solution, many thanks. I will remember this for the future."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 3, "last_activity_date": 1536767070, "last_edit_date": 1536767070, "creation_date": 1536766150, "answer_id": 52298776, "question_id": 52298238, "link": "https://stackoverflow.com/questions/52298238/alternative-to-if-statement-with-multiple-conditions-which-are-all-equal-to-same/52298776#52298776", "title": "Alternative to IF statement with multiple conditions which are all equal to same value", "body": "<p>You could write a short-circuiting function that bails out when it finds a value that matches the criteria:</p>\n\n<pre><code>Public Function MatchesAny(ByVal value, ParamArray values()) As Boolean\n    Dim i As Long\n    For i = LBound(values) To UBound(values)\n        If values(i) = value Then\n            MatchesAny = True\n            Exit Function\n        End If\n    Next\nEnd Function\n</code></pre>\n\n<p>And now you can do this:</p>\n\n<pre><code>If MatchesAny(0, var1, var2, var3, var4, var5, var6) Then\n</code></pre>\n\n<p>And if you need to bail out when any value <em>doesn't</em> match the criteria, then you can have a similar function with the inverse logic:</p>\n\n<pre><code>Public Function MatchesAll(ByVal value, ParamArray values()) As Boolean\n    MatchesAll = True\n    Dim i As Long\n    For i = LBound(values) To UBound(values)\n        If values(i) &lt;&gt; value Then\n            MatchesAll = False\n            Exit Function\n        End If\n    Next\nEnd Function\n</code></pre>\n\n<p>Used like this:</p>\n\n<pre><code>If MatchesAll(0, var1, var2, var3, var4, var5, var6) Then\n</code></pre>\n"}], "owner": {"reputation": 301, "user_id": 3433053, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b08b686f8d28b970829bc41338824850?s=128&d=identicon&r=PG&f=1", "display_name": "Slab", "link": "https://stackoverflow.com/users/3433053/slab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 52298348, "answer_count": 2, "score": 2, "last_activity_date": 1536767070, "creation_date": 1536764504, "question_id": 52298238, "link": "https://stackoverflow.com/questions/52298238/alternative-to-if-statement-with-multiple-conditions-which-are-all-equal-to-same", "title": "Alternative to IF statement with multiple conditions which are all equal to same value", "body": "<p>Is there a better way than this? (assuming all the vars will equal zero)</p>\n\n<pre><code>If var1 = 0 Or var2 = 0 Or var3 = 0 Or var4 = 0 Or var5 = 0 Or var6 = 0 Then\n    'do something\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 1, "creation_date": 1536768139, "post_id": 52298675, "comment_id": 91546341, "body": "Just some \u201cadd-ons\u201d: 1) \u201cCells(counter1, 1).EntireRow.Delete\u201d could be simplified to \u201cRows(counter1).Delete\u201d 2) \u201cCase 25, 26, 27\u201d could be simplified to \u201cCase 25 To 27\u201d"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1536773380, "post_id": 52298675, "comment_id": 91548889, "body": "Note: <code>Cells.Find(what:=&quot;*&quot;, ...)</code> will return <code>Nothing</code> and make the chained <code>.Rows</code> member call blow up (error 91) if used on an empty sheet. See <a href=\"https://stackoverflow.com/a/11169920/1188513\">this answer</a> for a bullet-proof solution. Also, iterating cells like this is <i>slow</i>, and inefficient regardless of whether <code>Application.EnableEvents</code> is enabled (although disabling application events can make it complete faster) - there are better ways."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1536773485, "post_id": 52298675, "comment_id": 91548938, "body": "Not just &quot;good&quot; to start at the bottom and work up, it&#39;s the only reliable way (if you&#39;re looping through the rows...)"}], "tags": [], "owner": {"reputation": 531, "user_id": 4244864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/erHT8.jpg?s=128&g=1", "display_name": "bilbo_strikes_back", "link": "https://stackoverflow.com/users/4244864/bilbo-strikes-back"}, "is_accepted": false, "score": 1, "last_activity_date": 1536765856, "creation_date": 1536765856, "answer_id": 52298675, "question_id": 52298230, "link": "https://stackoverflow.com/questions/52298230/cycle-shipping-over-cells-after-deletion/52298675#52298675", "title": "Cycle shipping over cells after deletion", "body": "<p>For deleting rows, it is good to start at the bottom and work up</p>\n\n<pre><code>Dim cell As Range\nDim lastrow As Long\nDim counter1 As Long\n\nlastrow = Cells.Find(what:=\"*\", searchorder:=xlByRows, \nsearchdirection:=xlPrevious).Row\n\nFor counter1 = lastrow To 1 Step -1\n    Select Case Left(CStr(Cells(counter1, 1).Value), 2)\n        Case 25, 26, 27\n            Cells(counter1, 1).EntireRow.Delete\n    End Select\nNext counter1\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 3614214, "user_type": "registered", "profile_image": "https://graph.facebook.com/1775906905/picture?type=large", "display_name": "user3614214", "link": "https://stackoverflow.com/users/3614214/user3614214"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "closed_date": 1536773470, "answer_count": 1, "score": 0, "last_activity_date": 1536765856, "creation_date": 1536764480, "question_id": 52298230, "link": "https://stackoverflow.com/questions/52298230/cycle-shipping-over-cells-after-deletion", "closed_reason": "Duplicate", "title": "Cycle shipping over cells after deletion", "body": "<p>I've been working on a project and i am at the last step, what i want the last piece of code to do is delete all rows that do not start with 25, 26 or 27</p>\n\n<pre><code>For Each cell In Worksheets(\"Sheet2\").Range(\"A:A\")\n        If Left(CStr(cell.Value), 2) &lt;&gt; 25 And Left(CStr(cell.Value), 2) &lt;&gt; 26 And Left(CStr(cell.Value), 2) &lt;&gt; 27  Then\n            matchRow = cell.Row\n            Rows(matchRow &amp; \":\" &amp; matchRow).Select\n            Selection.Delete Shift:=xlDown\n</code></pre>\n\n<p>The results are not as hoped: some cells still remain after running it.\nIi think that with this method, when I delete a cell it shifts the cycle and it skips the next cell over.</p>\n\n<p>How can i prevent this from happening?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9821828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8be8ae88dc283fa09132d0a3a9859fed?s=128&d=identicon&r=PG&f=1", "display_name": "Charlotte879", "link": "https://stackoverflow.com/users/9821828/charlotte879"}, "edited": false, "score": 1, "creation_date": 1536764768, "post_id": 52298095, "comment_id": 91544380, "body": "Thank you so much for the code, however I am running into problems with the following line as it says subscript out of range, any ideas why this might be? thanks                Worksheets(myCell).Visible = True"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 33, "user_id": 9821828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8be8ae88dc283fa09132d0a3a9859fed?s=128&d=identicon&r=PG&f=1", "display_name": "Charlotte879", "link": "https://stackoverflow.com/users/9821828/charlotte879"}, "edited": false, "score": 0, "creation_date": 1536765033, "post_id": 52298095, "comment_id": 91544527, "body": "@Charlotte879 - I guess I have not written <code>.Value</code>, thus it does not accept range argument. I have edited."}, {"owner": {"reputation": 33, "user_id": 9821828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8be8ae88dc283fa09132d0a3a9859fed?s=128&d=identicon&r=PG&f=1", "display_name": "Charlotte879", "link": "https://stackoverflow.com/users/9821828/charlotte879"}, "edited": false, "score": 0, "creation_date": 1536766618, "post_id": 52298095, "comment_id": 91545476, "body": "I have tried this again and again I know I am missing something really simple but still getting the same error that subscript is out of range. When I hover over the debug it just says myCell.value = empty  Guessing it can&#39;t find the my cell part of the code but not sure why!"}, {"owner": {"reputation": 33, "user_id": 9821828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8be8ae88dc283fa09132d0a3a9859fed?s=128&d=identicon&r=PG&f=1", "display_name": "Charlotte879", "link": "https://stackoverflow.com/users/9821828/charlotte879"}, "edited": false, "score": 0, "creation_date": 1536767029, "post_id": 52298095, "comment_id": 91545711, "body": "Can&#39;t express how much I appreciate your help! So grateful. I am recieving a different error now which makes me hopeful! it says WorksheetExists.. compile error, sub or function not defined. Have you seen that one before not sure how to correct currently trying to google!"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 33, "user_id": 9821828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8be8ae88dc283fa09132d0a3a9859fed?s=128&d=identicon&r=PG&f=1", "display_name": "Charlotte879", "link": "https://stackoverflow.com/users/9821828/charlotte879"}, "edited": false, "score": 0, "creation_date": 1536767222, "post_id": 52298095, "comment_id": 91545813, "body": "@Charlotte879 - I have deleted by mistake the <code>WorksheetExists</code> function on the last edit, I have added it."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1536767198, "last_edit_date": 1536767198, "creation_date": 1536763998, "answer_id": 52298095, "question_id": 52297879, "link": "https://stackoverflow.com/questions/52297879/excel-vba-unhide-sheets-based-on-list-of-sheet-names-if-it-meets-certain-criteri/52298095#52298095", "title": "Excel VBA unhide sheets based on list of sheet names if it meets certain criteria", "body": "<p>The code below unhides worksheets, based on the following criteria:</p>\n\n<ul>\n<li>the name of the worksheet is in Range(\"B4:B35\") of the <code>Cost Tracking</code> worksheet.</li>\n<li>two columns to the right the word <code>RESERVED</code> is not present.</li>\n</ul>\n\n<hr>\n\n<pre><code>Sub TestMe()\n\n    Dim ws As Worksheet\n    Dim myRange As Range\n    Dim myCell As Range\n\n    Set ws = ThisWorkbook.Worksheets(\"Cost Tracking\")\n    Set myRange = ws.Range(\"b4:b35\")\n\n    For Each myCell In myRange\n        If Not IsEmpty(myCell) _\n            And Not IsError(WorksheetExists(myCell.Value2)) _\n            And UCase(myCell.Offset(0, 2).Value &lt;&gt; \"RESERVED\") Then\n\n            Worksheets(myCell.Value).Visible = True\n\n        End If\n    Next\n\nEnd Sub\n\nFunction WorksheetExists(sheetName As String) As Boolean\n    WorksheetExists = Not WorksheetFunction.IsErr(Evaluate(\"'\" &amp; sheetName &amp; \"'!A1\"))\nEnd Function\n</code></pre>\n\n<p>Concerning the additional conditions, like hide and unhide, you may consider checks such as:</p>\n\n<pre><code>If Worksheets(myCell.Value).Visible = xlHidden Or _\nWorksheets(myCell.Value).Visible = xlVeryHidden Then\n    Worksheets(myCell.Value).Visible = xlVisible\nElse\n    'something else\nEnd If\n</code></pre>\n\n<p><em>(I have not tested the code, but it should be working...)</em></p>\n"}], "owner": {"reputation": 33, "user_id": 9821828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8be8ae88dc283fa09132d0a3a9859fed?s=128&d=identicon&r=PG&f=1", "display_name": "Charlotte879", "link": "https://stackoverflow.com/users/9821828/charlotte879"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 518, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1536767198, "creation_date": 1536763369, "last_edit_date": 1536764269, "question_id": 52297879, "link": "https://stackoverflow.com/questions/52297879/excel-vba-unhide-sheets-based-on-list-of-sheet-names-if-it-meets-certain-criteri", "title": "Excel VBA unhide sheets based on list of sheet names if it meets certain criteria", "body": "<p>I have a code below which unhides the sheets if they appear in a list between B4 and B35. </p>\n\n<p>I need to add a kind of if statement that if in the adjacent column it says \"reserved\" then don't unhide it, otherwise unhide it. I think the code I need is something like...  </p>\n\n<pre><code>If UCase$(Nm.Offset(0, 2).Value) &lt;&gt; \"RESERVED\" Then\n    If UCase$(Nm.Offset(0, 1).Value) &lt;&gt; \"2\" Then\n</code></pre>\n\n<p>however I am a bit confused how to include it within the code. Is there also a way to stop the second click of the button from re-hiding everything, presumably that's something I've accidentally set up within the code. Any help greatly appreciated. </p>\n\n<pre><code>Sub Button5_Click()\nDim sh As Worksheet, ws As Worksheet\nDim shList As Variant\n\nSet ws = ThisWorkbook.Sheets(\"Cost Tracking\")\nshList = Application.Transpose(ws.Range(\"b4:b35\"))\n\nFor Each sh In ThisWorkbook.Sheets\n    If Not IsError(Application.Match(sh.Name, shList, 0)) Then\n        sh.Visible = Not sh.Visible\n    End If\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "sorting", "filter"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1536764074, "post_id": 52297870, "comment_id": 91543966, "body": "Looks like a simple sort would do the job. What have you tried so far?"}, {"owner": {"reputation": 211, "user_id": 6595126, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GnFW1.jpg?s=128&g=1", "display_name": "Deluq", "link": "https://stackoverflow.com/users/6595126/deluq"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1536767449, "post_id": 52297870, "comment_id": 91545944, "body": "I tried with an index formula but is taking forever to count every item. I&#39;m thinking in applying an autofilter, .Range(&quot;A1:S1&quot;).AutoFilter         .AutoFilter.Sort.SortFields.Clear         .AutoFilter.Sort.SortFields.Add Key:=Range(&quot;H1&quot;), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal         With .AutoFilter.Sort             .Header = xlYes             .MatchCase = False             .Orientation = xlTopToBottom             .SortMethod = xlPinYin             .Apply         End With"}, {"owner": {"reputation": 211, "user_id": 6595126, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GnFW1.jpg?s=128&g=1", "display_name": "Deluq", "link": "https://stackoverflow.com/users/6595126/deluq"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1536767482, "post_id": 52297870, "comment_id": 91545964, "body": "but instead of order descending applying a formula to count in and filter based on a maximum value"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1536767635, "post_id": 52297870, "comment_id": 91546040, "body": "When you want to add information, please <a href=\"https://stackoverflow.com/posts/52297870/edit\">edit</a> your question rather than using comments. It&#39;s really hard to parse code in comments"}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 1, "creation_date": 1536768220, "post_id": 52297870, "comment_id": 91546390, "body": "Which comes first?  the FILTER or the SORT?  Is the Filter based on some kind of aggregation? Or some rule?  The Sort in the code seems to be based only on one column-- what is that column heading?  And why is the final output seem to be sorted on two columns?"}, {"owner": {"reputation": 211, "user_id": 6595126, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GnFW1.jpg?s=128&g=1", "display_name": "Deluq", "link": "https://stackoverflow.com/users/6595126/deluq"}, "edited": false, "score": 0, "creation_date": 1536771084, "post_id": 52297870, "comment_id": 91547794, "body": "Let me edit my question and add the idea."}], "answers": [{"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1536779160, "creation_date": 1536779160, "answer_id": 52301844, "question_id": 52297870, "link": "https://stackoverflow.com/questions/52297870/count-in-filter-per-item-vba-excel/52301844#52301844", "title": "Count in filter per item (VBA/Excel)", "body": "<p>This code modifies yours to get rid of <code>Select</code> and adds 2 sort keys, <code>Item</code> &amp; <code>Margin</code>. The <code>Auto filter</code> in <code>column 1</code>, allows you to filter the individual items. You can change your worksheet to meet your needs.</p>\n\n<pre><code>Dim lRow As Long\nlRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        .Columns(1).AutoFilter\n\n        With .Sort\n            .SortFields.Clear\n            .SortFields.Add Key:=Range(\"A2:A\" &amp; lRow), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n            .SortFields.Add Key:=Range(\"B2:B\" &amp; lRow), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n\n            .SetRange Range(\"A2:B\" &amp; lRow)\n            .Header = xlNo\n            .MatchCase = False\n            .Orientation = xlTopToBottom\n            .SortMethod = xlPinYin\n            .Apply\n        End With\n    End With\n</code></pre>\n"}], "owner": {"reputation": 211, "user_id": 6595126, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GnFW1.jpg?s=128&g=1", "display_name": "Deluq", "link": "https://stackoverflow.com/users/6595126/deluq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536779160, "creation_date": 1536763344, "last_edit_date": 1536771201, "question_id": 52297870, "link": "https://stackoverflow.com/questions/52297870/count-in-filter-per-item-vba-excel", "title": "Count in filter per item (VBA/Excel)", "body": "<p>I'm just working on a Macro that process a external report, this report contains 75,000 records. I need to find out a way to filter per item and sort the items based on the maximum of counts each of them has. This is an example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/otbl9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/otbl9.png\" alt=\"enter image description here\"></a></p>\n\n<p>Let me know if you need more details and thanks for your attention.</p>\n\n<p>A good idea should be apply a filter per item in order to sort and order based on the maximum count of a value.</p>\n\n<pre><code>With dataSheet\n    .Activate\n    .Range(\"A1:B1\").Select\n    .Range(\"A1:B1\").AutoFilter\n    .AutoFilter.Sort.SortFields.Clear\n    .AutoFilter.Sort.SortFields.Add Key:=Range(\"B1\"), SortOn:=xlSortOnValues, Order:=xlDescending (Instead of Descending add a count and filter based on the max count), DataOption:=xlSortNormal\n    With .AutoFilter.Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n    Selection.AutoFilter\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba", "delete-row"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1536763412, "post_id": 52297725, "comment_id": 91543547, "body": "If wb.sheets(&quot;test&quot;) is not the active sheet, you need to qualify <code>.Columns(&quot;A&quot;).Delete Shift:=xlShiftToLeft</code> with a period"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1536763832, "post_id": 52297725, "comment_id": 91543794, "body": "BTW wb is dimmed as a variant, now a workbook. It should be <code>Dim wb as workbook, myData As Workbook</code>"}], "answers": [{"comments": [{"owner": {"reputation": 784, "user_id": 6686925, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1b72cf30f0e2e490d2dcf157c6a7bcf?s=128&d=identicon&r=PG&f=1", "display_name": "SilverFish", "link": "https://stackoverflow.com/users/6686925/silverfish"}, "edited": false, "score": 0, "creation_date": 1536764369, "post_id": 52298002, "comment_id": 91544138, "body": "I made suggested changes but now while debugging code looks fine but does not delete row/col in either case - meaning regardless if the csv is open or closed. I think because -  Set wb = ThisWorkbook , while I am trying to delete in the csv. Any suggestions?"}, {"owner": {"reputation": 784, "user_id": 6686925, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1b72cf30f0e2e490d2dcf157c6a7bcf?s=128&d=identicon&r=PG&f=1", "display_name": "SilverFish", "link": "https://stackoverflow.com/users/6686925/silverfish"}, "edited": false, "score": 0, "creation_date": 1536764639, "post_id": 52298002, "comment_id": 91544304, "body": "redefined TR for csv"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 784, "user_id": 6686925, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1b72cf30f0e2e490d2dcf157c6a7bcf?s=128&d=identicon&r=PG&f=1", "display_name": "SilverFish", "link": "https://stackoverflow.com/users/6686925/silverfish"}, "edited": false, "score": 1, "creation_date": 1536766641, "post_id": 52298002, "comment_id": 91545491, "body": "The idea of the sample code was to show you that the ranges were not qualified to the desired sheet."}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 1, "last_activity_date": 1536763709, "creation_date": 1536763709, "answer_id": 52298002, "question_id": 52297725, "link": "https://stackoverflow.com/questions/52297725/excel-vba-issue-deleting-row-col-from-incorrect-workbook/52298002#52298002", "title": "Excel VBA - issue deleting row/col from incorrect workbook", "body": "<p>When using <code>with</code> anything in relation to that sheet need to be qualified with a period</p>\n\n<pre><code>With wb.Sheets(\"test\")\n    For LR = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row To 1 Step -1\n        If .Range(\"A\" &amp; LR).Value = \"Old\" Then\n            .Rows(LR).EntireRow.Delete\n        End If\n    Next LR\n    .Columns(\"A\").Delete Shift:=xlShiftToLeft\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3471, "user_id": 1016274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c01f1ff90599b2cbaba251c5f200d1d?s=128&d=identicon&r=PG", "display_name": "user1016274", "link": "https://stackoverflow.com/users/1016274/user1016274"}, "is_accepted": false, "score": 0, "last_activity_date": 1536769921, "creation_date": 1536769921, "answer_id": 52299804, "question_id": 52297725, "link": "https://stackoverflow.com/questions/52297725/excel-vba-issue-deleting-row-col-from-incorrect-workbook/52299804#52299804", "title": "Excel VBA - issue deleting row/col from incorrect workbook", "body": "<p>In addition to qualifying all ranges and other sheet-dependent objects like @Davesexcel already posted, you should <code>Set wb = ActiveWorkbook</code> instead of <code>Set wb = ThisWorkbook</code>. The latter refers to the workbook the macro is stored in whereas you probably intend to use the active workbook.  </p>\n\n<p>For debugging, start the VBA editor (ALT+F11) and set a breakpoint on the first line of the delete loop. Check the name of the workbook <code>wb</code> refers to (\"?wb.name\").  Make the comparison case-independent by using <code>If UCase(.Range(\"A\" &amp; LR).Value) = \"OLD\" Then</code>.<br>\nIf you single step one loop you will see why nothing is deleted.</p>\n"}], "owner": {"reputation": 784, "user_id": 6686925, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1b72cf30f0e2e490d2dcf157c6a7bcf?s=128&d=identicon&r=PG&f=1", "display_name": "SilverFish", "link": "https://stackoverflow.com/users/6686925/silverfish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593761068, "creation_date": 1536762949, "last_edit_date": 1593761068, "question_id": 52297725, "link": "https://stackoverflow.com/questions/52297725/excel-vba-issue-deleting-row-col-from-incorrect-workbook", "title": "Excel VBA - issue deleting row/col from incorrect workbook", "body": "<p>This code copies data from a worksheet and pastes data into a test.csv file. If the test.csv is closed then it opens it and pastes\ndata into it. If it is already open then just pastes data into it. Upto this step, process works fine. After the data is pasted \ninto test.csv, I need to delete rows with first column with value 'Old'. And then delete entire Col \"A\".</p>\n\n<p>Here is the challenge I am facing. If the test.csv is closed, the macro opens it, pastes the data and then does the rows and col delete, and works as expected\n, however, if the test.csv is already open, then it pastes the values as it is supposed to, but deleting row and col it does in\nthe main worksheet. I tried putting Delete code in <strong>With</strong> block but does not help. Please suggest!</p>\n\n<pre><code>Sub Macro()\n    Dim LR As Long, PR As Long, X As Long, MyCopyRange, MyPasteRange\n    Dim wb, myData As Workbook, shtPaste As Worksheet\n\n    Set wb = ThisWorkbook\n     'open target csv file if not already opened\n    If CheckFileIsOpen(\"test.csv\") = False Then\n        Set myData = Workbooks.Open(strFinalizedForBulkImport &amp; \"test.csv\")\n    Else\n        Set myData = Workbooks(\"test.csv\")\n    End If\n    Set shtPaste = myData.Sheets(\"test\")\n    shtPaste.UsedRange.Clear\n\n   With wb.Sheets(\"Report Grp\")\n\n        LR = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n        MyCopyRange = Array(\"A4:A\" &amp; LR, \"B4:B\" &amp; LR, \"C4:C\" &amp; LR, \"D4:D\" &amp; LR) 'Put ranges in an array\n        MyPasteRange = Array(\"A1\", \"B1\", \"C1\", \"D1\")\n\n\n\n        If LR &gt; 1 Then\n            j = 0\n            For X = LBound(MyCopyRange) To UBound(MyCopyRange) 'Loop the array copying and pasting based on element in the array\n                .Range(MyCopyRange(j)).Copy\n                 shtPaste.Range(MyPasteRange(j)).PasteSpecial xlPasteValuesAndNumberFormats\n                j = j + 1\n            Next\n\n        Else\n            Range(\"A1\") = \"No Data Found\"\n        End If\n\n    End With\n\n'Problem here, when trying to delete row with \"Old\" in Col \"A\" and finally Col \"A\" delete -\n        With wb.Sheets(\"test\")\n            For LR = Range(\"A\" &amp; Rows.Count).End(xlUp).Row To 1 Step -1\n                If Range(\"A\" &amp; LR).Value = \"Old\" Then\n                    Rows(LR).EntireRow.Delete\n                End If\n            Next LR\n            Columns(\"A\").Delete Shift:=xlShiftToLeft\n        End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "vb.net", "visual-studio", "excel-addins"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1536762926, "post_id": 52297587, "comment_id": 91543245, "body": "Can you alter the workbook code? Calling an private member is much, much more difficult than calling a public one."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9565275, "user_type": "registered", "profile_image": "https://graph.facebook.com/1740942845928914/picture?type=large", "display_name": "Ois&#237;n Gribben", "link": "https://stackoverflow.com/users/9565275/ois%c3%adn-gribben"}, "edited": false, "score": 0, "creation_date": 1536827233, "post_id": 52297871, "comment_id": 91566213, "body": "Perfect I&#39;ll give it a go, the CommandButton2_Offilne_Click() method might have thrown people off. It&#39;s acctually called from the event handler already so all I have to do is make that public."}, {"owner": {"reputation": 23, "user_id": 9565275, "user_type": "registered", "profile_image": "https://graph.facebook.com/1740942845928914/picture?type=large", "display_name": "Ois&#237;n Gribben", "link": "https://stackoverflow.com/users/9565275/ois%c3%adn-gribben"}, "edited": false, "score": 0, "creation_date": 1536839454, "post_id": 52297871, "comment_id": 91573210, "body": "I have been able to call the function from VB, I ran into an issue in regards to the add-in I&#39;m using. The add in is ATPVBAEN.XLAM! (Analysis ToolPak). It tells me that the add-in isn&#39;t there even though it works when called using excel."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1536763763, "last_edit_date": 1536763763, "creation_date": 1536763347, "answer_id": 52297871, "question_id": 52297587, "link": "https://stackoverflow.com/questions/52297587/call-a-vba-macro-in-an-exel-workbook-from-visual-studio/52297871#52297871", "title": "Call a VBA Macro in an exel Workbook from Visual Studio", "body": "<p>Wanting to invoke a <code>Click</code> event handler means one thing: you're looking at a macro that's implemented in the event handler itself.</p>\n\n<p>Move it out. Handlers are invoked by their event source; invoking them \"manually\" is terrible practice; you don't want to do that. Not to mention handlers can only exist in a class module, which means you need to get ahold of an <em>object instance</em> of that class in order to be able to locate its public members - its <em>private</em> members will be even more complicated to get to. If you're lucky the class is a worksheet module, so you get a workbook-scope instance of it for free.</p>\n\n<p>In any case, the last thing you want to do is \"just make the handler <code>Public</code>\" and invoke it directly. <em>Refactor</em> instead:</p>\n\n<pre><code>Private Sub CommandButton2_Offline_Click()\n    GoOffline\nEnd Sub\n</code></pre>\n\n<p></p>\n\n<p>Ideally you'd put the method in a standard module:</p>\n\n<pre><code>Public Sub GoOffline()\n    '...\n    ' all the code that's currently in CommandButton2_Offline_Click\n    '...\nEnd Sub\n</code></pre>\n\n<p>That way all you need to do is invoke <code>Application.Run</code> with <code>\"ModuleName.GoOffline\"</code> as an argument, from your .NET code. </p>\n\n<p>As for <em>making an instance of the workbook</em>, there's a factory method for that: <code>Workbooks.Open</code> - your .NET code will need to have an <code>Excel.Application</code> instance to work with.</p>\n"}], "owner": {"reputation": 23, "user_id": 9565275, "user_type": "registered", "profile_image": "https://graph.facebook.com/1740942845928914/picture?type=large", "display_name": "Ois&#237;n Gribben", "link": "https://stackoverflow.com/users/9565275/ois%c3%adn-gribben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 476, "favorite_count": 0, "accepted_answer_id": 52297871, "answer_count": 1, "score": 2, "last_activity_date": 1536763763, "creation_date": 1536762556, "question_id": 52297587, "link": "https://stackoverflow.com/questions/52297587/call-a-vba-macro-in-an-exel-workbook-from-visual-studio", "title": "Call a VBA Macro in an exel Workbook from Visual Studio", "body": "<p>I have an excel workbook that runs some VBA code when a button is clicked. The function i want to call is shown below. I want to call the function from Visual Studio using VB. Is there any way of making an instance of the workbook and calling the function? (Excel Add-ins are needed for the function which is why I need the workbook.) Thanks in advance guys.</p>\n\n<pre><code>Private Sub CommandButton2_Offline_Click()\n</code></pre>\n"}, {"tags": ["vba", "excel", "selenium", "screenshot"], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1537530754, "post_id": 52298844, "comment_id": 91829046, "body": "Any follow-up on this?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1536771690, "last_edit_date": 1536771690, "creation_date": 1536766429, "answer_id": 52298844, "question_id": 52297513, "link": "https://stackoverflow.com/questions/52297513/how-to-screenshot-specific-id-on-ie-website-with-vba-and-selenium/52298844#52298844", "title": "How to screenshot specific ID on IE website with VBA and Selenium", "body": "<p>Syntax is </p>\n\n<pre><code>bot.TakeScreenshot.SaveAs ActiveWorkbook.Path + \"/chicago.jpg\"\n</code></pre>\n\n<p>If you need to size to get only that part of the screen then you need to crop the screenshot image. Please see the answers <a href=\"https://stackoverflow.com/questions/13832322/how-to-capture-the-screenshot-of-a-specific-element-rather-than-entire-page-usin\">here</a> and VBA examples in search from <a href=\"https://www.google.co.uk/search?safe=strict&amp;ei=ZDOZW8j_DuXSgAa68KrYAw&amp;q=vba%20crop%20a%20screenshot&amp;oq=vba%20crop%20a%20screenshot&amp;gs_l=psy-ab.3...2528.2997.0.3134.4.4.0.0.0.0.188.429.0j3.3.0....0...1c.1.64.psy-ab..1.1.186...0i13k1j0i13i30k1j0i13i5i30k1.0.MveC4-PWju4\" rel=\"nofollow noreferrer\">here</a> for pointers.</p>\n\n<p>You can use Scroll functionality of selenium to centre your image on a particular element.</p>\n\n<hr>\n\n<p>Scrolling element to centre:</p>\n\n<pre><code>Option Explicit\nSub seleniumtutorial()\n\n    Dim bot As New WebDriver\n\n    bot.Start \"IE\", \"https://forecast.weather.gov/MapClick.php?lat=41.8843&amp;lon=-87.6324#.W5kg1ehKiUk\"\n\n    bot.get \"/\"\n\n    Dim element As Object\n    Set element = bot.FindElementById(\"seven-day-forecast-body\")\n\n    Dim scrollElementIntoMiddle As String\n    scrollElementIntoMiddle = \"var viewPortHeight = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);\" _\n                            + \"var elementTop = arguments[0].getBoundingClientRect().top;\" _\n                            + \"window.scrollBy(0, elementTop-(viewPortHeight/2));\"\n\n    bot.ExecuteScript scrollElementIntoMiddle, element\n\n    bot.TakeScreenshot.SaveAs ActiveWorkbook.Path + \"/chicago.jpg\"\n\n    bot.Quit\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Alternative is:</p>\n\n<pre><code>bot.ExecuteScript \"arguments[0].scrollIntoView();\", element\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7771880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb13ced7f97117790b25205885b18053?s=128&d=identicon&r=PG&f=1", "display_name": "pgottmann", "link": "https://stackoverflow.com/users/7771880/pgottmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536771690, "creation_date": 1536762337, "last_edit_date": 1536762442, "question_id": 52297513, "link": "https://stackoverflow.com/questions/52297513/how-to-screenshot-specific-id-on-ie-website-with-vba-and-selenium", "title": "How to screenshot specific ID on IE website with VBA and Selenium", "body": "<p>I'm trying to screenshot a specific ID which contains a table of weather forecasts for the week (<a href=\"https://forecast.weather.gov/MapClick.php?lat=41.8843&amp;lon=-87.6324#.W5kg1ehKiUk\" rel=\"nofollow noreferrer\">https://forecast.weather.gov/MapClick.php?lat=41.8843&amp;lon=-87.6324#.W5kg1ehKiUk</a>, and the ID is \"seven-day-forecast-body\")\nbut my code doesn't seem to work, and I've found few VBA-specific examples. Here's what I'm working with. Much appreciated, thank you.</p>\n\n<pre><code>Sub seleniumtutorial()\n\nDim bot As New WebDriver\n\nbot.Start \"IE\", \"https://forecast.weather.gov/MapClick.php?lat=41.8843&amp;lon=-87.6324#.W5kg1ehKiUk\"\n\nbot.Get \"/\"\n\nbot.FindElementById(\"seven-day-forecast-body\").SaveAs (ActiveWorkbook.Path + \"/chicago.jpg\")\n\nbot.Quit\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 3, "creation_date": 1536760180, "post_id": 52296746, "comment_id": 91541403, "body": "please paste the code here as text. it&#39;s very <a href=\"http://idownvotedbecau.se/imageofcode\" rel=\"nofollow noreferrer\">hard to debug via picture</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "is_accepted": false, "score": 1, "last_activity_date": 1536782293, "last_edit_date": 1536782293, "creation_date": 1536760625, "answer_id": 52296950, "question_id": 52296746, "link": "https://stackoverflow.com/questions/52296746/vba-code-for-creating-subfolders-and-folders-not-working/52296950#52296950", "title": "VBA: Code for creating subfolders and folders not working", "body": "<p>Mkdir can only create a single directory. You are trying to make two by supplying  \"9999 William Cox ltd\\BRAKEL\".</p>\n\n<p>Make \"9999 William Cox ltd\" first, then make its child directories.</p>\n\n<p>Here is some code that will generate all of the sub directories via a loop:</p>\n\n<p><strong>Add these functions to your code module:</strong></p>\n\n<pre><code>Private Function makeDir(parentDir As String, childDir As String) As String\n    'Checks if supplied directory name exists in current path, if not then create.\n    childDir = parentDir &amp; _\n        IIf(Left(childDir, 1) = \"\\\", \"\", \"\\\") &amp; _\n        childDir &amp; _\n        IIf(Right(childDir, 1) = \"\\\", \"\", \"\\\")\n\n    On Error Resume Next\n    MkDir childDir\n    On Error GoTo 0\n\n    makeDir = childDir\nEnd Function\n\nPublic Sub makePath(parentDir As String, childPath As String)\n    Dim i As Integer\n    Dim subDirs As Variant\n    Dim newdir As String\n    Dim fPath As String\n\n    fPath = parentDir\n    subDirs = Split(childPath, \"\\\")\n\n    For i = 0 To UBound(subDirs)\n\n        newdir = subDirs(i)\n        fPath = makeDir(fPath, newdir)\n\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p><strong>Then replace this:</strong></p>\n\n<pre><code>MkDir (\"T:\\Estimating\\William Cox Project Enquiries 2018\\\" &amp; fPath)\nIf Err.Number &lt;&gt; 0 Then\n    Err.Clear\nEnd If\n</code></pre>\n\n<p><strong>With this:</strong></p>\n\n<pre><code>makePath \"T:\\Estimating\\William Cox Project Enquiries 2018\\\", fpath\n</code></pre>\n\n<p>You should also remove <code>On Error Resume Next</code> so that you can catch any other errors - Another of which might be in your path (per the screenshot) which has \"T:\\Estimating\" twice at the beginning.</p>\n"}], "owner": {"reputation": 19, "user_id": 10353532, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PGj4LmX7D0o/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMeRUaruLMlT-o3JffqaeZ9oXyB5g/mo/photo.jpg?sz=128", "display_name": "Matthew Murphy", "link": "https://stackoverflow.com/users/10353532/matthew-murphy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1536782293, "creation_date": 1536760057, "question_id": 52296746, "link": "https://stackoverflow.com/questions/52296746/vba-code-for-creating-subfolders-and-folders-not-working", "title": "VBA: Code for creating subfolders and folders not working", "body": "<p>I got this code from an online source and cant figure out what I have to change, for it to work, the folders are not being created in the desired location and I am unaware of where they are be created if any where? </p>\n\n<p>Within the excel I have 3 command buttons, one to save the file to a specified location, one to email it to a collegue and lastly the command button which I am having issue with. Ill include images below. </p>\n\n<p>And is it possible to cause a chain reaction between the codes, that once one is completed then the other will begin, as I can get them to work as they are on there own atm. </p>\n\n<p><a href=\"https://i.stack.imgur.com/DMSSB.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["vba", "excel", "offset"], "answers": [{"tags": [], "owner": {"reputation": 582, "user_id": 6896061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf0230605ac24f5be23ea08c02dbbe5?s=128&d=identicon&r=PG", "display_name": "DavidP", "link": "https://stackoverflow.com/users/6896061/davidp"}, "is_accepted": false, "score": 1, "last_activity_date": 1536761264, "creation_date": 1536761264, "answer_id": 52297162, "question_id": 52296721, "link": "https://stackoverflow.com/questions/52296721/copy-data-from-another-sheet-with-4-rows-between-each-entry/52297162#52297162", "title": "Copy data from another sheet with 4 rows between each entry", "body": "<p>You can accomplish this using the <code>indirect</code> function:</p>\n\n<pre><code>=INDIRECT(\"Calculate!$A$\"&amp;(ROW()-1)*4+1)\n</code></pre>\n\n<p>With that formula in <code>A1:A4</code> of the results sheet, you should get the values you want from <code>A1</code>, <code>A5</code>, <code>A9</code>, <code>A13</code> on the Calculate sheet.</p>\n"}], "owner": {"reputation": 43, "user_id": 9911679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7038fdffb1b457b1377d005fa26afcb8?s=128&d=identicon&r=PG&f=1", "display_name": "bammerr", "link": "https://stackoverflow.com/users/9911679/bammerr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1536761264, "creation_date": 1536759978, "last_edit_date": 1536761217, "question_id": 52296721, "link": "https://stackoverflow.com/questions/52296721/copy-data-from-another-sheet-with-4-rows-between-each-entry", "title": "Copy data from another sheet with 4 rows between each entry", "body": "<p>I am working with three excel sheets within the same workbook, Data, Calculations, and Results. As you will see, the entries in column A are the focus. </p>\n\n<p>Using the formula <code>Data!A#</code> (row number), those entries from the A column of Data are copied onto column A of the Calculate page. Between each entry from Data, there are three rows of calculations. On the last page (Results), I am looking for a formula/VBA code that will allow me to grab column A from Calculate without the three rows in between them. </p>\n\n<p>Currently, I am experimenting with an offset function: <code>OFFSET(Calculate!$A$2,(ROW()-1)*2,0)</code>. When I copy the forumla down, zeroes appear in some rows in place of the actual values. (Note A1 of Results is <code>=Calculate!A2</code>.)</p>\n\n<p>How can I copy the entries from the Calculate sheet without a function returning zeroes as placeholders? </p>\n\n<hr>\n\n<p>Data Sheet</p>\n\n<p><img src=\"https://i.stack.imgur.com/YLmq9.png\" alt=\"Data Sheet\"></p>\n\n<p>Calculations Sheet</p>\n\n<p><img src=\"https://i.stack.imgur.com/v8gr2.png\" alt=\"Calculations Sheet\"></p>\n\n<p>Results Sheet </p>\n\n<p><img src=\"https://i.stack.imgur.com/xWoBn.png\" alt=\"Results Sheet\"></p>\n"}, {"tags": ["ms-access", "outlook", "vba"], "comments": [{"owner": {"reputation": 689, "user_id": 4731063, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RNPgT.png?s=128&g=1", "display_name": "Pants", "link": "https://stackoverflow.com/users/4731063/pants"}, "edited": false, "score": 0, "creation_date": 1536762955, "post_id": 52296632, "comment_id": 91543262, "body": "Googled around a bit. Another user fixed a similar issue by putting the code in a module. <a href=\"https://social.technet.microsoft.com/Forums/en-US/9e071151-c812-47d3-86b9-4e5f342517ee/vbscript-sends-excel-outmail-macro-message-twice-bug?forum=ITCG\" rel=\"nofollow noreferrer\">social.technet.microsoft.com/Forums/en-US/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 126, "user_id": 10286012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/667193e34d0c9a6dd7804e95e358a047?s=128&d=identicon&r=PG&f=1", "display_name": "HiPierr0t", "link": "https://stackoverflow.com/users/10286012/hipierr0t"}, "is_accepted": true, "score": 0, "last_activity_date": 1536774081, "creation_date": 1536774081, "answer_id": 52300770, "question_id": 52296632, "link": "https://stackoverflow.com/questions/52296632/access-2016-processing-duplicate-mail-to-outlook-via-vba/52300770#52300770", "title": "Access 2016 processing duplicate mail to Outlook via VBA", "body": "<p><code>On Error Resume Next</code> tends to create more problems than it solves. </p>\n\n<p>If no email exists, your code goes on. However your variable <em>myemail</em> is still filled with the previous email you sent an email to.</p>\n\n<p>1- Make sure to empty your variable after the email is sent with <code>myemail = \"\"</code> or <code>myemail = vbNullString</code>.<br/>\n 2- Before sending the email, check that <em>myemail</em> is not empty with an <code>If</code> statement.<br/>\n 3- You may want to place your code below outside of the loop. It won't make a big difference but there is no need to process this part of code every time.</p>\n\n<pre><code>If oOutlook Is Nothing Then\n    Set oOutlook = New Outlook.Application\nEnd If\n\n'Set the email template\nSet oEmailItem = oOutlook.CreateItemFromTemplate(\"C:\\MailTemplate\\Mail1.oft\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 828, "user_id": 10252988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047bac7a125b9725dc9a257f8f0e0266?s=128&d=identicon&r=PG&f=1", "display_name": "Alina Li", "link": "https://stackoverflow.com/users/10252988/alina-li"}, "is_accepted": false, "score": 0, "last_activity_date": 1536827779, "creation_date": 1536827779, "answer_id": 52309754, "question_id": 52296632, "link": "https://stackoverflow.com/questions/52296632/access-2016-processing-duplicate-mail-to-outlook-via-vba/52309754#52309754", "title": "Access 2016 processing duplicate mail to Outlook via VBA", "body": "<p>Please check if you\u2019ve emptied the myemail before sending e-mail.</p>\n\n<p>Also you need to add \u201crS.Close dbS.Close\u201d after the Loop.</p>\n\n<p>Here is complete code:</p>\n\n<pre><code>Private Sub SendEmail_Click()\n\nDim rS As DAO.Recordset\nDim dbS As DAO.Database\nDim Filepath As String\nDim Folderpath As String\nDim oOutlook As Outlook.Application\nDim oEmailItem As MailItem\nDim myemail As String\nDim Subjectline As String\n\nSubjectline$ = InputBox$(\"Please enter the subject line for this mailing.\", _\n\"We need a Subject Line!\")\n\nSet dbS = CurrentDb()\nSet rS = dbS.OpenRecordset(\"SELECT * FROM Students\")\n\nDo While Not rS.EOF\nOn Error Resume Next\nmyemail = \"\"\nmyemail = rS![E-mail Address]\n\nIf oOutlook Is Nothing Then\n    Set oOutlook = New Outlook.Application\nEnd If\n\n'Set the email template\nSet oEmailItem = oOutlook.CreateItemFromTemplate(\"C:\\MailTemplate\\Mail1.oft\")\n\nWith oEmailItem\n    .To = [myemail]\n    .Subject = Subjectline$\n    .Send\nEnd With\n'End of emailing\n\nrS.MoveNext\nLoop\n\nrS.Close\ndbS.Close\n\nSet oEmailItem = Nothing\nSet oOutlook = Nothing\nSet rS = Nothing\nSet dbS = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 2196893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bbc51965d965d2a958f2486a1381d54?s=128&d=identicon&r=PG", "display_name": "Ciar&#225;n Brogan", "link": "https://stackoverflow.com/users/2196893/ciar%c3%a1n-brogan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 52300770, "answer_count": 2, "score": 0, "last_activity_date": 1536833730, "creation_date": 1536759667, "last_edit_date": 1536833730, "question_id": 52296632, "link": "https://stackoverflow.com/questions/52296632/access-2016-processing-duplicate-mail-to-outlook-via-vba", "title": "Access 2016 processing duplicate mail to Outlook via VBA", "body": "<p>I have an Access 2016 database with tables that hold student data. I have managed to successfully send an email to each recipient using VBA-Outlook (the code works), however, it looks to have sent the the email to the same recipients multiple times (random duplicate of 1 to 4 emails per recipient). </p>\n\n<p>I can confirm that there are no duplicate <code>[E-mail Address]</code> whatsoever contained within the <code>Student</code> table.</p>\n\n<p>When I use <code>.Display</code> instead of <code>.Send</code> in my <code>oEmailItem</code>, there does not appear to be any duplicates. Perhaps I should include a <em>waiting period</em> of 1 second in the loop?</p>\n\n<p><code>On Error Resume Next</code> is used to bypass the null value returned by blank email fields; not everyone has an <code>[E-mail Address]</code> in this table</p>\n\n<p>Why is this code sending random duplicate email to recipients?</p>\n\n<pre><code>Private Sub SendEmail_Click()\n\nDim rS As DAO.Recordset\nDim dbS As DAO.Database\nDim Filepath As String\nDim Folderpath As String\nDim oOutlook As Outlook.Application\nDim oEmailItem As MailItem\nDim myemail As String\nDim Subjectline As String\n\nSubjectline$ = InputBox$(\"Please enter the subject line for this mailing.\", _\n\"We need a Subject Line!\")\n\nSet dbS = CurrentDb()\nSet rS = dbS.OpenRecordset(\"SELECT * FROM Students\")\n\nDo While Not rS.EOF\nOn Error Resume Next\nmyemail = rS![E-mail Address]\n\nIf oOutlook Is Nothing Then\n    Set oOutlook = New Outlook.Application\nEnd If\n\n'Set the email template\nSet oEmailItem = oOutlook.CreateItemFromTemplate(\"C:\\MailTemplate\\Mail1.oft\")\n\nWith oEmailItem\n    .To = [myemail]\n    .Subject = Subjectline$\n    .Send\nEnd With\n'End of emailing\n\nrS.MoveNext\nLoop\nSet oEmailItem = Nothing\nSet oOutlook = Nothing\nSet rS = Nothing\nSet dbS = Nothing\n\nEnd Sub\n</code></pre>\n\n<p><strong>Update:</strong>\nThanks HiPierr0t. Your answer showed me that I wasn't emptying the variable at the end of the loop; thus assigning the previously used <code>[E-mail Address]</code> when met with a null or blank email field.</p>\n\n<p>I did have to keep </p>\n\n<p><code>Set oEmailItem = oOutlook.CreateItemFromTemplate(\"C:\\MailTemplate\\Mail1.oft\")</code> </p>\n\n<p>inside the loop however (strange, must be a MS thing).</p>\n\n<p>I ended up removing <code>On Error Resume Next</code> as it does create more problems, and used </p>\n\n<blockquote>\n  <blockquote>\n    <p><code>myemail = Nz(rS![Email Address], vbNullString)</code></p>\n  </blockquote>\n</blockquote>\n\n<p>to change any null or blank fields into <code>\"\"</code>. That way, I don't need to empty to variable each time as the lookup changes it to <code>\"\"</code> if it's null anyway. The If..Else takes care of the rest.</p>\n\n<pre><code>Do While Not rS.EOF\n'On Error Resume Next\nmyemail = Nz(rS![Email Address], vbNullString)\n\nSet oEmailItem = oOutlook.CreateItemFromTemplate(\"C:\\MailTemplate\\Mail1.oft\")\n\nIf myemail = \"\" Then\n    rS.MoveNext\nElse\n    With oEmailItem\n    .To = [myemail]\n    .Subject = Subjectline$\n    .Display\n    End With\n    'End of my emailing report\n    rS.MoveNext\nEnd If\nLoop\n</code></pre>\n"}, {"tags": ["vba", "excel", "debugging"], "comments": [{"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 1, "creation_date": 1536760437, "post_id": 52296490, "comment_id": 91541575, "body": "hi. there are any error ? or whats  not functioning rigth ?"}, {"owner": {"reputation": 13, "user_id": 9834687, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maria Fakhry", "link": "https://stackoverflow.com/users/9834687/maria-fakhry"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1536760726, "post_id": 52296490, "comment_id": 91541765, "body": "Run time error 13 type mismatch but it is not highlighting anything"}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1536774392, "post_id": 52296490, "comment_id": 91549365, "body": "There are many syntax errors and you will get a &quot;type mismatch&quot; on every countifs line.  You can do a google search on how to find multiple criteria in a countifs.  You may want to look at your logic.  If you fix the aforementioned, each of your final cell values will either be a zero or one because you are looping through 2 to lastrow and only evaluating a range of 1 cell each time.  The result will be the countif of D &amp; lastrow."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9834687, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maria Fakhry", "link": "https://stackoverflow.com/users/9834687/maria-fakhry"}, "edited": false, "score": 0, "creation_date": 1536761102, "post_id": 52297023, "comment_id": 91542003, "body": "Also, it is not highlighting the error which is why i am not able to fix it"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536761262, "post_id": 52297023, "comment_id": 91542106, "body": "OP has a fundamental misunderstanding of datatype usage, so it might help to address when to use <code>Range</code>, <code>Long</code>, <code>String</code> and likewise a <code>Range</code> versus a <code>.Value</code>"}, {"owner": {"reputation": 1, "user_id": 9223468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce3064942bdcce978c8937a24cc6f0c?s=128&d=identicon&r=PG&f=1", "display_name": "E.Garcia", "link": "https://stackoverflow.com/users/9223468/e-garcia"}, "reply_to_user": {"reputation": 13, "user_id": 9834687, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maria Fakhry", "link": "https://stackoverflow.com/users/9834687/maria-fakhry"}, "edited": false, "score": 0, "creation_date": 1536762500, "post_id": 52297023, "comment_id": 91542991, "body": "@MariaFakhry When the error shows up, if you press Debugg you should be able to locate the line in which the error is taking place. You should also be naming your worksheets, and I&#39;m not sure WorksheetFunction works without &quot;Excel.&quot; preceding it."}], "tags": [], "owner": {"reputation": 1, "user_id": 9223468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce3064942bdcce978c8937a24cc6f0c?s=128&d=identicon&r=PG&f=1", "display_name": "E.Garcia", "link": "https://stackoverflow.com/users/9223468/e-garcia"}, "is_accepted": false, "score": 0, "last_activity_date": 1536760844, "creation_date": 1536760844, "answer_id": 52297023, "question_id": 52296490, "link": "https://stackoverflow.com/questions/52296490/excel-vba-countif-debug/52297023#52297023", "title": "Excel VBA countif debug", "body": "<p>I would make a few changes to your code and see if the error still shows up, however it's hard to give a solution if you don't specify the type of error or in which line it takes place.</p>\n\n<p>In your line:</p>\n\n<pre><code>counter = Workbooks(SourceWb).Range(\"D\" &amp; x).Value\n</code></pre>\n\n<p>I would remove the \".Value\" bit, since you are using a variable of Range type, this might be causing a problem.</p>\n\n<p>Then in each bit where you copy the information, I have never seen they way you are calling the cell where you want to copy the information, I would change this:</p>\n\n<pre><code>ThisWorkbook.ActiveSheet.Cell(B2) = bodyb\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>NamedWorksheet.Range(\"B2\").Value = bodyb\n</code></pre>\n\n<p>There might be some other problems though, please let me know in which line and what kind of error you are getting and I will be able to help you better.</p>\n"}, {"comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536761714, "post_id": 52297141, "comment_id": 91542387, "body": "These should end in <code>.Row</code> as well"}], "tags": [], "owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "is_accepted": false, "score": 0, "last_activity_date": 1536761210, "creation_date": 1536761210, "answer_id": 52297141, "question_id": 52296490, "link": "https://stackoverflow.com/questions/52296490/excel-vba-countif-debug/52297141#52297141", "title": "Excel VBA countif debug", "body": "<p>I think your not selecting the sheet.</p>\n\n<p>try to change</p>\n\n<pre><code>lastrow = Workbooks(SourceWb).Cells(Rows.Count, 1).End(xlUp)\n</code></pre>\n\n<p>To</p>\n\n<pre><code>lastrow = SourceWb.Sheets(\"NAME_OF_THE_SHEET\").Cells(Rows.Count, 1).End(xlUp)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9834687, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maria Fakhry", "link": "https://stackoverflow.com/users/9834687/maria-fakhry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1536761210, "creation_date": 1536759234, "last_edit_date": 1536760775, "question_id": 52296490, "link": "https://stackoverflow.com/questions/52296490/excel-vba-countif-debug", "title": "Excel VBA countif debug", "body": "<p>I am currently writing a code that basically has to go to a database file, check in column B if there's anything in it, if yes, it has to check on column C what are the first 3 numbers and then count it depending on those numbers, then go on the original file and print them, but the code is giving an error 13 'Type mismatch' and i can't figure out why</p>\n\n<p>Also, ideally I could update the file every week and add it in the count if function. I thought about a dictionary but I am not sure how to create it. </p>\n\n<pre><code>Sub KPI_Year()\n\n    Dim bodyb As Long\n    Dim windshield As Long\n    Dim frt_sus As Long\n    Dim wheels As Long\n    Dim pneumatic As Long\n    Dim engine As Long\n    Dim transmission As Long\n    Dim fuel As Long\n    Dim furnishing As Long\n    Dim destination_sign As Long\n    Dim hvac As Long\n    Dim painting As Long\n    Dim electrical As Long\n    Dim audio As Long\n    Dim external_acc As Long\n    Dim driver As Long\n    Dim spare As Long\n\n    Dim SourceWb As Workbook\n    Dim DCP_RC_Wb As Workbook\n    Dim Path As String\n    Dim Path2 As String\n    Path = \"........\"\n    Set SourceWb = Workbooks.Open(Filename:=Path, ReadOnly:=True)\n    SourceWb.Activate\n\n    Path2 = \"..............\"'Set DCP_RC_Wb = Workbooks.Open(Filename:=Path2, ReadOnly:=True)\n    ''DCP_RC_Wb.Activate\n\n\n    Dim x As Long\n    Dim lastrow As Long\n    lastrow = Workbooks(SourceWb).Cells(Rows.Count, 1).End(xlUp)\n\n\n    Dim DCP_presence As Range\n    Dim counter As Range\n\n    For x = 2 To lastrow\n        DCP_presence = Workbooks(SourceWb).Range(\"C\" &amp; x).Value\n        counter = Workbooks(SourceWb).Range(\"D\" &amp; x).Value\n\n\n        If DCP_presence &lt;&gt; \"\" Then\n\n            bodyb = WorksheetFunction.CountIf(counter, (\"101*\" Or \"401*\" Or \"501*\" Or \"601*\" Or \"A01*\" Or \"B01*\" Or \"C01*\" Or \"D01*\" Or \"E01*\" Or \"F01*\" Or \"G01*\" Or \"H01*\" Or \"V01*\" Or \"W01*\" Or \"102*\" Or \"402*\" Or \"502*\" Or \"602*\" Or \"A02*\" Or \"B02*\" Or \"C02*\" Or \"D02*\" Or \"E02*\" Or \"F02*\" Or \"G02*\" Or \"H02*\" Or \"V02*\" Or \"W02*\"))\n            ThisWorkbook.ActiveSheet.Cell(B2) = bodyb\n\n            windshield = WorksheetFunction.CountIf(counter, (\"103*\" Or \"403*\" Or \"503*\" Or \"603*\" Or \"A03*\" Or \"B03*\" Or \"C03*\" Or \"D03*\" Or \"E03*\" Or \"F03*\" Or \"G03*\" Or \"H03*\" Or \"V03*\" Or \"W03*\"))\n            ThisWorkbook.ActiveSheet.Cell(B3) = windshield\n\n            frt_sus = WorksheetFunction.CountIf(counter, (\"104*\" Or \"404*\" Or \"504*\" Or \"604*\" Or \"A04*\" Or \"B04*\" Or \"C04*\" Or \"D04*\" Or \"E04*\" Or \"F04*\" Or \"G04*\" Or \"H04*\" Or \"V04*\" Or \"W04*\" Or \"105*\" Or \"405*\" Or \"505*\" Or \"605*\" Or \"A05*\" Or \"B05*\" Or \"C05*\" Or \"D05*\" Or \"E05*\" Or \"F05*\" Or \"G05*\" Or \"H05*\" Or \"V05*\" Or \"W05*\"))\n            ThisWorkbook.ActiveSheet.Cell(B4) = frt_sus\n\n            wheels = WorksheetFunction.CountIf(counter, (\"106*\" Or \"406*\" Or \"506*\" Or \"606*\" Or \"A06*\" Or \"B06*\" Or \"C06*\" Or \"D06*\" Or \"E06*\" Or \"F06*\" Or \"G06*\" Or \"H06*\" Or \"V06*\" Or \"W06*\" Or \"107*\" Or \"407*\" Or \"507*\" Or \"607*\" Or \"A07*\" Or \"B07*\" Or \"C07*\" Or \"D07*\" Or \"E07*\" Or \"F07*\" Or \"G07*\" Or \"H07*\" Or \"V07*\" Or \"W07*\"))\n            ThisWorkbook.ActiveSheet.Cell(B5) = wheels\n\n            pneumatic = WorksheetFunction.CountIf(counter, (\"108*\" Or \"408*\" Or \"508*\" Or \"608*\" Or \"A08*\" Or \"B08*\" Or \"C08*\" Or \"D08*\" Or \"E08*\" Or \"F08*\" Or \"G08*\" Or \"H08*\" Or \"V08*\" Or \"W08*\"))\n            ThisWorkbook.ActiveSheet.Cell(B6) = pneumatic\n\n            engine = WorksheetFunction.CountIf(counter, (\"109*\" Or \"409*\" Or \"509*\" Or \"609*\" Or \"A09*\" Or \"B09*\" Or \"C09*\" Or \"D09*\" Or \"E09*\" Or \"F09*\" Or \"G09*\" Or \"H09*\" Or \"V09*\" Or \"W09*\"))\n            ThisWorkbook.ActiveSheet.Cell(B7) = engine\n\n            transmission = WorksheetFunction.CountIf(counter, (\"110*\" Or \"410*\" Or \"510*\" Or \"610*\" Or \"A10*\" Or \"B10*\" Or \"C10*\" Or \"D10*\" Or \"E10*\" Or \"F10*\" Or \"G10*\" Or \"H10*\" Or \"V10*\" Or \"W10*\"))\n            ThisWorkbook.ActiveSheet.Cell(B8) = transmission\n\n            fuel = WorksheetFunction.CountIf(counter, (\"111*\" Or \"411*\" Or \"511*\" Or \"611*\" Or \"A11*\" Or \"B11*\" Or \"C11*\" Or \"D11*\" Or \"E11*\" Or \"F11*\" Or \"G11*\" Or \"H11*\" Or \"V11*\" Or \"W11*\"))\n            ThisWorkbook.ActiveSheet.Cell(B9) = fuel\n\n            furnishing = WorksheetFunction.CountIf(counter, (\"112*\" Or \"412*\" Or \"512*\" Or \"612*\" Or \"A12*\" Or \"B12*\" Or \"C12*\" Or \"D12*\" Or \"E12*\" Or \"F12*\" Or \"G12*\" Or \"H12*\" Or \"V12*\" Or \"W12*\"))\n            ThisWorkbook.ActiveSheet.Cell(B10) = furnishing\n\n            destination_sign = WorksheetFunction.CountIf(counter, (\"113*\" Or \"413*\" Or \"513*\" Or \"613*\" Or \"A13*\" Or \"B13*\" Or \"C13*\" Or \"D13*\" Or \"E13*\" Or \"F13*\" Or \"G13*\" Or \"H13*\" Or \"V13*\" Or \"W13*\"))\n            ThisWorkbook.ActiveSheet.Cell(B11) = destination_sign\n\n            hvac = WorksheetFunction.CountIf(counter, (\"114*\" Or \"414*\" Or \"514*\" Or \"614*\" Or \"A14*\" Or \"B14*\" Or \"C14*\" Or \"D14*\" Or \"E14*\" Or \"F14*\" Or \"G14*\" Or \"H14*\" Or \"V14*\" Or \"W14*\"))\n            ThisWorkbook.ActiveSheet.Cell(B12) = hvac\n\n            painting = WorksheetFunction.CountIf(counter, (\"115*\" Or \"415*\" Or \"515*\" Or \"615*\" Or \"A15*\" Or \"B15*\" Or \"C15*\" Or \"D15*\" Or \"E15*\" Or \"F15*\" Or \"G15*\" Or \"H15*\" Or \"V15*\" Or \"W15*\"))\n            ThisWorkbook.ActiveSheet.Cell(B13) = painting\n\n            electrical = WorksheetFunction.CountIf(counter, (\"116*\" Or \"416*\" Or \"516*\" Or \"616*\" Or \"A16*\" Or \"B16*\" Or \"C16*\" Or \"D16*\" Or \"E16*\" Or \"F16*\" Or \"G16*\" Or \"H16*\" Or \"V16*\" Or \"W16*\"))\n            ThisWorkbook.ActiveSheet.Cell(B14) = electrical\n\n            audio = WorksheetFunction.CountIf(counter, (\"117*\" Or \"417*\" Or \"517*\" Or \"617*\" Or \"A17*\" Or \"B17*\" Or \"C17*\" Or \"D17*\" Or \"E17*\" Or \"F17*\" Or \"G17*\" Or \"H17*\" Or \"V17*\" Or \"W17*\"))\n            ThisWorkbook.ActiveSheet.Cell(B15) = audio\n\n            external_acc = WorksheetFunction.CountIf(counter, (\"118*\" Or \"418*\" Or \"518*\" Or \"618*\" Or \"A18*\" Or \"B18*\" Or \"C18*\" Or \"D18*\" Or \"E18*\" Or \"F18*\" Or \"G18*\" Or \"H18*\" Or \"V18*\" Or \"W18*\"))\n            ThisWorkbook.ActiveSheet.Cell(B16) = external_acc\n\n            driver = WorksheetFunction.CountIf(counter, (\"119*\" Or \"419*\" Or \"519*\" Or \"619*\" Or \"A19*\" Or \"B19*\" Or \"C19*\" Or \"D19*\" Or \"E19*\" Or \"F19*\" Or \"G19*\" Or \"H19*\" Or \"V19*\" Or \"W19*\"))\n            ThisWorkbook.ActiveSheet.Cell(B17) = driver\n\n            spare = WorksheetFunction.CountIf(counter, (\"120*\" Or \"420*\" Or \"520*\" Or \"620*\" Or \"A20*\" Or \"B20*\" Or \"C20*\" Or \"D20*\" Or \"E20*\" Or \"F20*\" Or \"G20*\" Or \"H20*\" Or \"V20*\" Or \"W20*\"))\n            ThisWorkbook.ActiveSheet.Cell(B18) = spare\n\n        End If\n    Next x\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "match", "wildcard", "rtf"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1536759385, "post_id": 52296434, "comment_id": 91540892, "body": "Have you looked into the <code>InStr()</code> Function? You can use it to check if a string contains a specific character or sequence of characters."}, {"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1536760257, "post_id": 52296434, "comment_id": 91541459, "body": "sounds like a good idea... I may have looked at it months ago when I wrote that portion of code but couldn&#39;t figure out how to get it to work... I am very much a novice and just stumbling my way around. I was just now able to get it to work by replacing &quot;.value&quot; in &quot;.match&quot; with &quot;Left(.Value, 3)&quot; and changing the value in my array to &quot;---&quot;. But some day I would like to know how to do it without using &quot;left&quot; and instead use the wild card like this &quot;---*&quot;"}, {"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1536761341, "post_id": 52296434, "comment_id": 91542146, "body": "So I think I just figured out a super simple way to do this... the data is actually color coded... Instead of using an array of all the stuff I want to delete... can I just simply say delete all blue text? How do I do this? How do I delete all blue text in column A"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536761570, "post_id": 52296434, "comment_id": 91542299, "body": "phew this question has a lot going on. it would really help if you could trim it to be more concise and address more clearly the problem you&#39;re having"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536761616, "post_id": 52296434, "comment_id": 91542326, "body": "also, <a href=\"https://stackoverflow.com/questions/12042161/delete-text-only-of-a-specific-color-from-an-excel-spreadsheet-with-text-in-diff\" title=\"delete text only of a specific color from an excel spreadsheet with text in diff\">stackoverflow.com/questions/12042161/&hellip;</a>"}, {"owner": {"reputation": 582, "user_id": 6896061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf0230605ac24f5be23ea08c02dbbe5?s=128&d=identicon&r=PG", "display_name": "DavidP", "link": "https://stackoverflow.com/users/6896061/davidp"}, "edited": false, "score": 0, "creation_date": 1536761813, "post_id": 52296434, "comment_id": 91542477, "body": "You can check the color of a cell with <code>Range().DisplayFormat.Font.Color</code>. Figure out which value your blue cells return, then use that as your condition to delete them."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1536789471, "post_id": 52296434, "comment_id": 91555648, "body": "@XCELLGUY I believe if you used <code>InStr(1, .Value, &quot;-&quot;) = 0</code>, the statement would be true if there the <code>InStr</code> function <b>couldn&#39;t</b> find a &quot;-&quot;. If the function finds the requested value, it returns the location of the first instance of the value within the search string."}, {"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1536927320, "post_id": 52296434, "comment_id": 91610292, "body": "I tried: Sub test2()     Range(&quot;A2&quot;).DisplayFormat.Font.Color End Sub --&gt; but it said invalid use of the property .color"}], "owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594055278, "creation_date": 1536759060, "last_edit_date": 1594055278, "question_id": 52296434, "link": "https://stackoverflow.com/questions/52296434/excel-vba-trying-to-match-array-with-wild-cards", "title": "Excel VBA trying to match array with wild cards", "body": "<p>I currently have a piece of code that I used in a past life...</p>\n\n<pre><code>Dim ArrNames\n\nArrNames = Array(\"X-Axis\", \"Y-Axis\", \"Z-Axis\", \"Flatness\", _\n  \"Length-X\", \"Length-Y\", \"Length-Z\", \"Length_X\", \"Length_Y\", _\n  \"Length_Z\", \"Length\", \"Angle\", \"Angle-XY\", \"Angle-XZ\", \"Angle-YX\", _\n  \"Angle-YZ\", \"Angle-ZX\", \"Angle-ZY\", \"Radius\", \"Diameter\", \"Flatness\", _\n  \"Straightness\", \"Parallelism\", \"Perpendicular\", \"Circularity\")\n\nSheets(2).Range(\"A:A\").Copy Destination:=Sheets(1).Range(\"A:A\", \"C:C\")\n\nWith ActiveSheet\n    Lastrow = .UsedRange.Rows(.UsedRange.Rows.Count).Row\n    For Lrow = Lastrow To 1 Step -1\n        With .Cells(Lrow, \"C\")\n            If IsError(Application.Match(.Value, ArrNames, 0)) Then .ClearContents\n        End With\n    Next Lrow\n    For Lrow = Lastrow To 1 Step -1\n        With .Cells(Lrow, \"A\")\n            If Not IsError(Application.Match(.Value, ArrNames, 0)) Then .ClearContents\n        End With\n    Next Lrow\nEnd With\n</code></pre>\n\n<p>So what this does is... it copies a column (column A) from sheet # 2 and pastes the contents into sheet # 1 in two places (column A and column C). The data contains several hundreds of lines of strings like this:</p>\n\n<pre><code>(Z): Item (126) / (X) : Item (132)\nCircle:P4_EJECTOR_SIDE_OP_10_Locate\nZ-axis\nX-axis\n\nPoint:P8_PAD_PNT\nY-axis\n\nPlane:P8_PAD\nFlatness\nParallelism\n\nCircle:P8_EJECTOR_SIDE_DEEP\nZ-axis\nX-axis\n</code></pre>\n\n<p>Then, I loop through line by line of sheet # 1 column C checking to see if the cell contents match any of the values in my array. If a match is not found, I clear the contents of the cell.</p>\n\n<p>Then, Similarly, I loop through line by line of sheet # 1 column A checking to see if the cell contents match any of the values in my array. However, in this case if a match is found, I clear the contents of the cell (so basically the opposite of what column C is doing).</p>\n\n<p>This is only a part of a much larger animal that automatically imports separate .csv files and compiles the data together for statistical analysis, and it works.</p>\n\n<p>Now I am trying to do a similar thing with .rtf files. The files look like this...</p>\n\n<pre><code>(Z): Item (126) / (X) : Item (132)\nCircle:P4_EJECTOR_SIDE_OP_10_Locate\nZ-axis       -46.435   -46.500    -0.150    +0.150     0.065 ---+*--\nX-axis      -116.836  -117.000    -0.150    +0.150     0.164 ---+--&gt;       0.014\n--------------------------------------------------------------------------------\nPoint:P8_PAD_PNT\nY-axis       -21.611   -21.500    -0.200    +0.200    -0.111 -*-+---\n--------------------------------------------------------------------------------\nPlane:P8_PAD\nFlatness       0.015     0.200                                  *---\nParallelism    0.078     0.200,FA(Part_Offset_Plane)            +*--\n--------------------------------------------------------------------------------\nCircle:P8_EJECTOR_SIDE_DEEP\nZ-axis         0.072     0.000    -0.150    +0.150     0.072 ---+*--\nX-axis        -0.010     0.000    -0.150    +0.150    -0.010 ---*---\n</code></pre>\n\n<p>So I tried to modify my ArrNames to include wild characters, like this:</p>\n\n<p>ArrNames = Array(\"---*\")</p>\n\n<p>But it isn't working...</p>\n\n<p>I am trying to delete all the \"---------------------\"</p>\n\n<p>Here is my exact code:</p>\n\n<p>Sub test()</p>\n\n<pre><code>Dim Word As New Word.Application\nDim WordDoc As New Word.Document\nDim FilesToOpen\nDim x As Integer\nDim Lrow As Long\nDim Lastrow As Long\nDim ArrNames\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\nArrNames = Array(\"---*\")\n\nFilesToOpen = Application.GetOpenFilename _\n  (FileFilter:=\"RTF Files (*.rtf), *.rtf\", _\n  MultiSelect:=True, Title:=\"Files to Open\")\n\nApplication.DisplayAlerts = False\n\nx = 1\n\nSet WordDoc = Word.Documents.Open(Filename:=FilesToOpen(x), ReadOnly:=True)\nWord.Selection.WholeStory\nWord.Selection.Copy\n\nRange(\"A1\").Select\nActiveSheet.Paste\n\nWordDoc.Close\nWord.Quit\n\nApplication.DisplayAlerts = True\n\nWith ActiveSheet\n    Lastrow = .UsedRange.Rows(.UsedRange.Rows.Count).Row\n    'For Lrow = Lastrow To 1 Step -1\n        'With .Cells(Lrow, \"A\")\n            'If IsError(Application.Match(.Value, ArrNames, 0)) Then .ClearContents\n        'End With\n    'Next Lrow\n    For Lrow = Lastrow To 1 Step -1\n        With .Cells(Lrow, \"A\")\n            If Not IsError(Application.Match(.Value, ArrNames, 0)) Then .ClearContents\n        End With\n    Next Lrow\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>As you can see I simply copied the loop portion of the code from my previous code and commented out the part I am not currently using.</p>\n"}, {"tags": ["excel", "vba", "match"], "comments": [{"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 1, "creation_date": 1536759693, "post_id": 52296411, "comment_id": 91541105, "body": "Have you considered using <code>TextBox1_BeforeUpdate</code> for your event handler?"}, {"owner": {"reputation": 15, "user_id": 6570120, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210215425092415/picture?type=large", "display_name": "Dariusz Jezewski", "link": "https://stackoverflow.com/users/6570120/dariusz-jezewski"}, "reply_to_user": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 0, "creation_date": 1536773379, "post_id": 52296411, "comment_id": 91548888, "body": "It is above my abilities... I would need more help. :("}, {"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 0, "creation_date": 1536777614, "post_id": 52296411, "comment_id": 91550846, "body": "With <code>TextBox1_BeforeUpdate</code>, the code only gets triggered when you 1) press the Tab or ENTER key to get to the next control, or 2) click another control.  Also, when there&#39;s no match, the code can be written so that the textbox maintains focus, and the entered text highlighted to make re-entering a new value into the same textbox easier.  Would this work for you?  If so, when there&#39;s an error, do you want the textbox to maintain focus, and the text highlighted?"}, {"owner": {"reputation": 15, "user_id": 6570120, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210215425092415/picture?type=large", "display_name": "Dariusz Jezewski", "link": "https://stackoverflow.com/users/6570120/dariusz-jezewski"}, "reply_to_user": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 0, "creation_date": 1536779182, "post_id": 52296411, "comment_id": 91551613, "body": "I guess after typing the letters and pressing the enter would be just fine...The main function of that box would be to find the first entry in the long alphabetical list of entries in excel, lets say instead of manually scrolling down the rows and finding first entry with text &quot;Green&quot; in column B , after entering in the text box first few letters in this case &quot;Gre&quot; it would automatically scroll down to the first entry starting with typed letters..."}, {"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 0, "creation_date": 1536782338, "post_id": 52296411, "comment_id": 91552984, "body": "Actually, it looks like you may only need to change your current code so that Match searches for an exact match and the lookup value includes a wildcard <code>Application.GoTo Range(&quot;A&quot; &amp; Application.WorksheetFunction.Match(TextBox1.Value &amp; &quot;*&quot;, Range(&quot;B2:B5000&quot;), 0) + 1), True</code>.  Does this help?"}, {"owner": {"reputation": 15, "user_id": 6570120, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210215425092415/picture?type=large", "display_name": "Dariusz Jezewski", "link": "https://stackoverflow.com/users/6570120/dariusz-jezewski"}, "reply_to_user": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 0, "creation_date": 1536803065, "post_id": 52296411, "comment_id": 91558401, "body": "Yes, this works very well. Thank you!"}], "owner": {"reputation": 15, "user_id": 6570120, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210215425092415/picture?type=large", "display_name": "Dariusz Jezewski", "link": "https://stackoverflow.com/users/6570120/dariusz-jezewski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536767517, "creation_date": 1536758988, "last_edit_date": 1536767517, "question_id": 52296411, "link": "https://stackoverflow.com/questions/52296411/vba-goto-application-how-to-put-delay", "title": "VBA GoTo application - how to put delay", "body": "<p>I have a search text box which helps me to find cell with the text matching the letter I type in the box, is there a way to put delay on this search event because I am basically able to type only one letter and sometimes I would like to be able to type few more letters in the string before the search kicks in...</p>\n\n<pre><code> Private Sub TextBox1_KeyUp(ByVal KeyCode As MSForms.ReturnInteger, ByVal \n Shift As Integer)\n\n     On Error Resume Next\n     Application.GoTo Range(\"A\" &amp; \n     Application.WorksheetFunction.Match(TextBox1.Value, Range(\"B2:B5000\"), \n     1) + 1), True\n     On Error GoTo 0\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "ado"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536757275, "post_id": 52295676, "comment_id": 91539355, "body": "What context are you using this in? Depending on the what the state of the Recordset is, attempting to close it could throw an error if <code>ObjectStateEnum</code> &gt; <code>adStateOpen</code>."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1536758246, "post_id": 52295676, "comment_id": 91540054, "body": "<b>May there be a case where Recordset exists but .State property returns something other than an ObjectStateEnum value?</b> Is this actually your question?"}, {"owner": {"reputation": 26, "user_id": 8904880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be92fae219d0158a070f5acc0fb0220?s=128&d=identicon&r=PG&f=1", "display_name": "Cip", "link": "https://stackoverflow.com/users/8904880/cip"}, "edited": false, "score": 0, "creation_date": 1536759473, "post_id": 52295676, "comment_id": 91540952, "body": "I usually use the condition <code>If rs.State &gt; 0 Then rs.Close</code> and I want to know if this can return other results than expected. For this I try to understand the problem...  If the two code is equivalent case is solved."}], "answers": [{"comments": [{"owner": {"reputation": 26, "user_id": 8904880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be92fae219d0158a070f5acc0fb0220?s=128&d=identicon&r=PG&f=1", "display_name": "Cip", "link": "https://stackoverflow.com/users/8904880/cip"}, "edited": false, "score": 0, "creation_date": 1536818844, "post_id": 52305183, "comment_id": 91562265, "body": "I&#39;m not sure that <code>x AND 1 = 1 only if x = 1</code>! In the example from <a href=\"https://stackoverflow.com/questions/17611545/check-if-adodb-connection-is-open?answertab=votes#tab-top\">this post</a> I find: <code>&#39;ex. If (0001 And 0001) = 0001 (only open flag) -&gt; true \u00a0&#39;ex. If (1001 And 0001) = 0001 (open and retrieve) -&gt; true \u00a0&#39;This second example means that it is open, but its value is not 1 and if rs.State = 1 -&gt; false, even though it is open</code>"}, {"owner": {"reputation": 26, "user_id": 8904880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be92fae219d0158a070f5acc0fb0220?s=128&d=identicon&r=PG&f=1", "display_name": "Cip", "link": "https://stackoverflow.com/users/8904880/cip"}, "edited": false, "score": 0, "creation_date": 1536818880, "post_id": 52305183, "comment_id": 91562279, "body": "@Raybarg says in that post that this is because it&#39;s bitwise <code>And</code> operation. On the other hand, the Recordset closure lines are usually in the errorhandling or exit area when you may want to close the object even though the Executing or Fetching."}, {"owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "reply_to_user": {"reputation": 26, "user_id": 8904880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be92fae219d0158a070f5acc0fb0220?s=128&d=identicon&r=PG&f=1", "display_name": "Cip", "link": "https://stackoverflow.com/users/8904880/cip"}, "edited": false, "score": 0, "creation_date": 1536840343, "post_id": 52305183, "comment_id": 91573717, "body": "@Cip It makes no sense whatsoever to be in this conversation and to say &quot;<b>I&#39;m not sure</b> that x AND 1 = 1 only if x = 1!&quot; It takes a couple of second to just test it. The flags are indeed designed to be binary: adStateOpen = 1 = 0b0001, adStateFetching = 8 = 0b1000; this way you can just raise or lower an appropriate bit to indicate the appropriate combination of states: adStateOpen +  adStateFetching = 0b1001... It&#39;s Electrical Engineering, Networks, generally speaking. BUT WHAT DOES THIS HAVE TO DO WITH YOUR QUESTION?!!!"}, {"owner": {"reputation": 26, "user_id": 8904880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be92fae219d0158a070f5acc0fb0220?s=128&d=identicon&r=PG&f=1", "display_name": "Cip", "link": "https://stackoverflow.com/users/8904880/cip"}, "edited": false, "score": 0, "creation_date": 1536848376, "post_id": 52305183, "comment_id": 91578769, "body": "<b>1</b> I tested: statement <code>x AND 1 = 1 only if x=1</code> is FALSE for all odd numbers.    <b>2</b> The reformulated question: under what conditions <code>rs.State &gt; 0</code> can have another value of truth than <code>(rs.State And 1) = 1</code>"}, {"owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "reply_to_user": {"reputation": 26, "user_id": 8904880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be92fae219d0158a070f5acc0fb0220?s=128&d=identicon&r=PG&f=1", "display_name": "Cip", "link": "https://stackoverflow.com/users/8904880/cip"}, "edited": false, "score": 0, "creation_date": 1536848963, "post_id": 52305183, "comment_id": 91579168, "body": "@Cip Oh, c&#39;mon! The first one is <code>True</code> if <code>rs</code> is not closed (whatever else might be happening) while the second one is <code>True</code> only if <code>rs</code> is open and nothing else is going on :)"}, {"owner": {"reputation": 26, "user_id": 8904880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be92fae219d0158a070f5acc0fb0220?s=128&d=identicon&r=PG&f=1", "display_name": "Cip", "link": "https://stackoverflow.com/users/8904880/cip"}, "edited": false, "score": 0, "creation_date": 1536908678, "post_id": 52305183, "comment_id": 91600070, "body": "<i>while the second one is True only if rs is open and nothing else is going on</i>   <b>it certainly is not so!</b>     Example: When data is fetched from the database, <code>rs.State</code> is 9 (<code>adStateOpen</code> + <code>adStateFetching</code>). Then the expression <code>(rs.State And 1) = 1</code> becomes <code>(9 And 1) = 1</code> ie <code>(1001 and 0001) = 0001</code>. The operation in brackets is bit to bit and the result is 0001. In conclusion <code>(rs.State And 1) = 1</code> is True even when fetching data!"}], "tags": [], "owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "is_accepted": false, "score": 0, "last_activity_date": 1536800000, "last_edit_date": 1536800000, "creation_date": 1536799651, "answer_id": 52305183, "question_id": 52295676, "link": "https://stackoverflow.com/questions/52295676/understand-testing-if-a-ado-recordset-is-open/52305183#52305183", "title": "Understand testing if a ADO recordset is open", "body": "<p>You have answered your own question, actually: the two are not equivalent since there are five different States, of which <code>adStateOpen</code> (= 1) is the only one the 1st syntax allows closing the Object. You might not want to close the object while Executing or Fetching, etc. (as in Open and Executing: adStateOpen + adStateExecuting = 1 + 4 = 5)</p>\n\n<p>The <code>x AND 1 = 1</code> only if x=1, otherwise <code>x AND 1 = 0</code> for any other x value. This said, in the 1st syntax example, it would have been enough to just test <code>If rs.State = 1 Then rs.Close</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "is_accepted": false, "score": 0, "last_activity_date": 1539880244, "creation_date": 1539880244, "answer_id": 52878634, "question_id": 52295676, "link": "https://stackoverflow.com/questions/52295676/understand-testing-if-a-ado-recordset-is-open/52878634#52878634", "title": "Understand testing if a ADO recordset is open", "body": "<p>Normally, each bit could be individually set and so checking the first way ensures that the open flag is set. Maybe you are thinking that there is no case where the state is not open because the other states are modifiers of an open state. Let's look at the MS API reference for a RecordSet.State. It holds something called ObjectStateEnum. We can see there is one state that is not open and not closed called \"Connecting\". Your second method would try to close a connection that is in Connecting state where the first method would not. That is the only functional difference I can see.</p>\n\n<h2>ObjectStateEnum</h2>\n\n<pre><code>Constant            Value   Description\n--------            -----   -----------\nadStateClosed       0       Indicates that the object is closed.\nadStateOpen         1       Indicates that the object is open.\nadStateConnecting   2       Indicates that the object is connecting.\nadStateExecuting    4       Indicates that the object is executing a command.\nadStateFetching     8       Indicates that the rows of the object are being retrieved.\n</code></pre>\n\n<p><strong>SOURCE:</strong>\n<a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/objectstateenum?view=sql-server-2017\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/objectstateenum?view=sql-server-2017</a></p>\n"}], "owner": {"reputation": 26, "user_id": 8904880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be92fae219d0158a070f5acc0fb0220?s=128&d=identicon&r=PG&f=1", "display_name": "Cip", "link": "https://stackoverflow.com/users/8904880/cip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 911, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1539880244, "creation_date": 1536756679, "question_id": 52295676, "link": "https://stackoverflow.com/questions/52295676/understand-testing-if-a-ado-recordset-is-open", "title": "Understand testing if a ADO recordset is open", "body": "<p>I've been looking for a way to know if a ADO recordset is open. I find <a href=\"https://stackoverflow.com/questions/17611545/check-if-adodb-connection-is-open?answertab=votes#tab-top\" title=\"this\">this</a>  where I met the syntax: </p>\n\n<pre><code>If Not (rs Is Nothing) Then\n  If (rs.State And 1) = 1 Then rs.Close\n  Set rs = Nothing\nEnd If\n</code></pre>\n\n<p>I read explanation posted by @Raybarg however I have the following question:\nSyntax:</p>\n\n<pre><code>If Not (rs Is Nothing) Then\n  If rs.State &gt; 0 Then rs.Close\n  Set rs = Nothing\nEnd If\n</code></pre>\n\n<p>is not equivalent? There may be a case where Recordset exists but <code>.State</code> property returns something other than an <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/objectstateenum?view=sql-server-2017%20ObjectStateEnum\" rel=\"nofollow noreferrer\">ObjectStateEnum</a> value?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2007"], "comments": [{"owner": {"reputation": 1002, "user_id": 1687356, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/vy1KO.jpg?s=128&g=1", "display_name": "bpy", "link": "https://stackoverflow.com/users/1687356/bpy"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536756921, "post_id": 52295590, "comment_id": 91539091, "body": "@Comintern Can you please provide an example?"}], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 3, "last_activity_date": 1536757473, "creation_date": 1536757473, "answer_id": 52295942, "question_id": 52295590, "link": "https://stackoverflow.com/questions/52295590/how-to-make-ms-access-2007-form-code-work-in-module/52295942#52295942", "title": "How to make MS Access 2007 form code work in module", "body": "<p>Pass an instance of the form as a parameter and use it to replace <code>Me</code>:</p>\n\n<pre><code>Public Sub CallSkypeHandler(instance As Object)\n    Dim strProgramName As String\n    Dim strArgument As String\n    strProgramName = \"C:\\Program Files (x86)\\Skype\\Phone\\skype.exe\"\n    strArgument = \"/callto:+01\" &amp; instance.Phone &amp; \"\"\n    Shell \"\"\"\" &amp; strProgramName &amp; \"\"\" \"\"\" &amp; strArgument &amp; \"\"\"\", vbNormalFocus\nEnd Sub\n</code></pre>\n\n<p>From the calling form:</p>\n\n<pre><code>Public Sub CallSkype_Click()\n    CallSkypeHandler Me\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1536757859, "creation_date": 1536757859, "answer_id": 52296052, "question_id": 52295590, "link": "https://stackoverflow.com/questions/52295590/how-to-make-ms-access-2007-form-code-work-in-module/52296052#52296052", "title": "How to make MS Access 2007 form code work in module", "body": "<p>ComIntern's answer is certainly valid. But you can also adjust the code to make use of the currently active form:</p>\n\n<pre><code>Public Sub CallSkype()\n    Dim strProgramName As String\n    Dim strArgument As String\n    strProgramName = \"C:\\Program Files (x86)\\Skype\\Phone\\skype.exe\"\n    strArgument = \"/callto:+01\" &amp; Screen.ActiveForm!Phone.Value &amp; \"\"\n    Call Shell(\"\"\"\" &amp; strProgramName &amp; \"\"\" \"\"\" &amp; strArgument &amp; \"\"\"\", \n    vbNormalFocus)\nEnd Sub\n</code></pre>\n\n<p>An advantage is that then you can set events to <code>=CallSkype()</code> instead of writing a separate event handler. A disadvantage is that it won't support reports, and might act strange with subforms.</p>\n"}, {"tags": [], "owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "is_accepted": false, "score": 3, "last_activity_date": 1536759838, "creation_date": 1536759838, "answer_id": 52296677, "question_id": 52295590, "link": "https://stackoverflow.com/questions/52295590/how-to-make-ms-access-2007-form-code-work-in-module/52296677#52296677", "title": "How to make MS Access 2007 form code work in module", "body": "<p>Yet another option is to pass the phone number as a variable to the function:</p>\n\n<pre><code>' sub in module\nPublic Sub MakeSkypeCall(PhoneNumber As String)\n    Dim strProgramName As String\n    Dim strArgument As String\n\n    strProgramName = \"C:\\Program Files (x86)\\Skype\\Phone\\skype.exe\"\n    strArgument = \"/callto:+01\" &amp; PhoneNumber\n    Call Shell(\"\"\"\" &amp; strProgramName &amp; \"\"\" \"\"\" &amp; strArgument &amp; \"\"\"\", _\n            vbNormalFocus)\nEnd Sub\n</code></pre>\n\n<p>Then, your forms would just call that sub, passing the phone number to call:</p>\n\n<pre><code>' calling sub from form\nPublic Sub CallSkype_Click()\n    MakeSkypeCall Me.Phone\nEnd Sub\n</code></pre>\n\n<p>With this approach, you can easily test the code without even using a form.</p>\n\n<p>You may also want to consider not hard-coding the program path for Skype in your code: If other users are using the database, there's no guarantee that Skype will be installed in this location.</p>\n"}], "owner": {"reputation": 1002, "user_id": 1687356, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/vy1KO.jpg?s=128&g=1", "display_name": "bpy", "link": "https://stackoverflow.com/users/1687356/bpy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1536759838, "creation_date": 1536756438, "question_id": 52295590, "link": "https://stackoverflow.com/questions/52295590/how-to-make-ms-access-2007-form-code-work-in-module", "title": "How to make MS Access 2007 form code work in module", "body": "<p>I don't know if this is possible, but...</p>\n\n<p>I have several forms containing the same code but they all have different data based on different query's.</p>\n\n<p>When I update the code in one form, I have to make the same changes on all other forms.</p>\n\n<p>To make the update process simple, I moved the forms code to a module but the forms stopped working.</p>\n\n<p>How can I call the events from a module?</p>\n\n<p>This is an example of a code in a form, that I would to use on all my forms:</p>\n\n<pre><code>Public Sub CallSkype_Click()\nDim strProgramName As String\nDim strArgument As String\nstrProgramName = \"C:\\Program Files (x86)\\Skype\\Phone\\skype.exe\"\nstrArgument = \"/callto:+01\" &amp; Me.Phone &amp; \"\"\nCall Shell(\"\"\"\" &amp; strProgramName &amp; \"\"\" \"\"\" &amp; strArgument &amp; \"\"\"\", \nvbNormalFocus)\nEnd Sub\n</code></pre>\n"}, {"tags": ["python-3.x", "excel", "vba", "xlwings"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 8631224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79e39308319ab796a98e675c0a957768?s=128&d=identicon&r=PG&f=1", "display_name": "NNM", "link": "https://stackoverflow.com/users/8631224/nnm"}, "is_accepted": false, "score": 1, "last_activity_date": 1537381882, "creation_date": 1537381882, "answer_id": 52412166, "question_id": 52295582, "link": "https://stackoverflow.com/questions/52295582/python-in-vba-function-xlwings/52412166#52412166", "title": "Python in VBA function : xlwings", "body": "<p>I managed to fix the problem. I was importing clr before xlwings, so by importing xlwings first solved the problem. </p>\n"}], "owner": {"reputation": 21, "user_id": 8631224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79e39308319ab796a98e675c0a957768?s=128&d=identicon&r=PG&f=1", "display_name": "NNM", "link": "https://stackoverflow.com/users/8631224/nnm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593679303, "creation_date": 1536756423, "last_edit_date": 1593679303, "question_id": 52295582, "link": "https://stackoverflow.com/questions/52295582/python-in-vba-function-xlwings", "title": "Python in VBA function : xlwings", "body": "<p>I am using the xlwings library to run python in VBA Sub. Inside the python module I  import the CLR library to call C# classes. When I run the code in Excel it returns the following:</p>\n\n<hr>\n\n<h2>Error</h2>\n\n<pre><code>Traceback (most recent call last):\n  File \"&lt;string&gt;\", line 1, in &lt;module&gt;\n  File \"t:\\development\\retailPythonModule.py\", line 11, in &lt;module&gt;\n    import xlwings as xw\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\xlwings\\__init__.py\", line 23, in &lt;module&gt;\n    from . import _xlwindows as xlplatform\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\xlwings\\_xlwindows.py\", line 25, in &lt;module&gt;\n    from comtypes import IUnknown\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\comtypes\\__init__.py\", line 165, in &lt;module&gt;\n    CoInitializeEx()\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\comtypes\\__init__.py\", line 156, in CoInitializeEx\n    _ole32.CoInitializeEx(None, flags)\n  File \"_ctypes/callproc.c\", line 918, in GetResult\nOSError: [WinError -2147417850] Cannot change thread mode after it is set\n\nPress Ctrl+C to copy this message to the clipboard.\n\nOK   \n</code></pre>\n\n<p>This code works fine in Jupiter notebook, it's only when I try to run it through excel.</p>\n\n<p>Please help, I am still very new in this.</p>\n"}, {"tags": ["vba", "visio"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1536755676, "post_id": 52294932, "comment_id": 91538144, "body": "You&#39;ve already got the <code>If...Then</code> logic to determine your cable class and tray class, simply add some code in each portion to set the cost in each area. You&#39;ve given us no indication of how you&#39;re storing the cost data, so it will be up to you to determine where to store it and how to change it (percentage change? lookup from a cost table? who know...)"}, {"owner": {"reputation": 23, "user_id": 5326348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e86378ebc8e52349c2a7b434013dae4?s=128&d=identicon&r=PG&f=1", "display_name": "Kamran64", "link": "https://stackoverflow.com/users/5326348/kamran64"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1536757898, "post_id": 52294932, "comment_id": 91539810, "body": "The if statement determines whether a primary or secondary class is chosen. From this the cable type shape data changes to a list box containing either primary or secondary cables. Another shape data parameter is cost. Once the user selects a specific cable, I want the cost parameter to change."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1536758020, "post_id": 52294932, "comment_id": 91539899, "body": "Then I would think you&#39;d want a line similar to this <code>shp3.Cells(&quot;Prop.Row_CableClass.Value&quot;).FormulaU = &quot;&quot;&quot;Primary&quot;&quot;&quot;</code> that would set the appropriate shape data parameter to the appropriate cost."}, {"owner": {"reputation": 23, "user_id": 5326348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e86378ebc8e52349c2a7b434013dae4?s=128&d=identicon&r=PG&f=1", "display_name": "Kamran64", "link": "https://stackoverflow.com/users/5326348/kamran64"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1536761429, "post_id": 52294932, "comment_id": 91542216, "body": "That&#39;s what I was thinking but I&#39;m not sure how to get this code to run as the result of the user changing the shape data."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536762080, "post_id": 52294932, "comment_id": 91542691, "body": "potentially <a href=\"https://www.excel-easy.com/vba/examples/dependent-combo-boxes.html\" rel=\"nofollow noreferrer\"><code>Private Sub ComboBox1_Change()</code></a>"}, {"owner": {"reputation": 23, "user_id": 5326348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e86378ebc8e52349c2a7b434013dae4?s=128&d=identicon&r=PG&f=1", "display_name": "Kamran64", "link": "https://stackoverflow.com/users/5326348/kamran64"}, "edited": false, "score": 0, "creation_date": 1536762892, "post_id": 52294932, "comment_id": 91543227, "body": "Ok so will that sub be called automatically when any list box is changed?"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1536763717, "post_id": 52294932, "comment_id": 91543729, "body": "@Kamran64 the <code>_change()</code> routine will be called when the specified <code>ComboBox</code> is changed. Write one routine that does the processing, pass it the ComboBox as a paramenter, then call that routine for each ComboBox that needs this processing. That way you have only one place to fix the code when it&#39;s broken or needs to be updated"}], "answers": [{"tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 1, "last_activity_date": 1536764339, "creation_date": 1536764339, "answer_id": 52298196, "question_id": 52294932, "link": "https://stackoverflow.com/questions/52294932/how-to-dynamically-change-one-piece-of-shape-data-based-on-a-drop-down-box/52298196#52298196", "title": "How to dynamically change one piece of shape data based on a drop down box", "body": "<p>Not a full answer, but much too long/complex for just a comment:</p>\n\n<p>In your user form code behind:</p>\n\n<pre><code>Private Sub CableClass_Change() \n  SetCableClassValues CableClass, shape\nEnd Sub\n\nPrivate Sub TrayClass_Change() \n  SetTrayClassValues TrayClass, shape\nEnd Sub\n</code></pre>\n\n<p>In a separate Standard Module:</p>\n\n<pre><code>Public Sub SetCableClassValues (ByVal cableClass as ComboBox, ByVal theShape as Visio.Shape)\n  theShape.Cells(\"Prop.Row_CableClass.Value\").FormulaU = \"\"\"Primary\"\"\"\n  theShape.... 'set the appropriate cost value here\nEnd Sub\n\nPublic Sub SetTrayClassValues (ByVal trayClass as ComboBox, ByVal theShape as Visio.Shape)\n  theShape.Cells(\"Prop.Row_CableClass.Value\").FormulaU = \"\"\"Primary\"\"\"\n  theShape.... 'set the appropriate cost value here\nEnd Sub\n</code></pre>\n\n<p>Note that is all \"air-coding\" so it won't work exactly as written. Once you're in the <code>SetCableClassValues</code> routine, though, you'll have access to everything in the <code>cableClass</code> combo box, just as if you were directly in the code-behind. You'll also have access to <code>theShape</code> - whichever one it is that you have as <code>shp3</code> in your existing code which you'll pass in as the <code>shape</code> parameter.</p>\n\n<p>If you need both bits of info to determine the costing, then you'll have 1 routine that will take both comboboxen and the shape as parameters, ensure both have valid values selected, then do all the updating.</p>\n\n<p>I'm not at all familiar with the Visio object model, so you'll have to figure out how to set the cost, but it looks like you've got enough understanding to handle that part.</p>\n"}, {"tags": [], "owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "is_accepted": false, "score": 0, "last_activity_date": 1536997596, "creation_date": 1536997596, "answer_id": 52342751, "question_id": 52294932, "link": "https://stackoverflow.com/questions/52294932/how-to-dynamically-change-one-piece-of-shape-data-based-on-a-drop-down-box/52342751#52342751", "title": "How to dynamically change one piece of shape data based on a drop down box", "body": "<p>You can also do some powerful things in the <code>ShapeSheet</code> without having to resort to VBA. You can force the question (input of data) on shape drop, and then use the properties (<code>Prop.x</code>, <code>User.x</code>) to set up your drop down lists.</p>\n\n<p>Looking at your provided code, you are following the same sort of actions as you would in the <code>ShapeSheet</code>, just using a different syntax/language/interface. The logic is similar, you set up a <code>User</code> property (or rather two, because you are looking at cables and trays) that returns true or false depending on whether you have \"Primary\" or \"Secondary\" selected. You then use that <code>Boolean</code> result to return the appropriate string of choices. </p>\n\n<p>I don't have Visio on this machine to provide a specific example - I have used this technique to change colours of shapes and even change the geometries. </p>\n"}], "owner": {"reputation": 23, "user_id": 5326348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e86378ebc8e52349c2a7b434013dae4?s=128&d=identicon&r=PG&f=1", "display_name": "Kamran64", "link": "https://stackoverflow.com/users/5326348/kamran64"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593524245, "creation_date": 1536754496, "last_edit_date": 1593524245, "question_id": 52294932, "link": "https://stackoverflow.com/questions/52294932/how-to-dynamically-change-one-piece-of-shape-data-based-on-a-drop-down-box", "title": "How to dynamically change one piece of shape data based on a drop down box", "body": "<p>I have a user form that runs when a cable shape is dropped onto the sheet: The form asks the user whether the cable classification is primary or secondary and whether the tray type is primary or secondary. If, for example a primary cable and tray is chosen, then the cable type+tray shape data will change to drop down lists only containing primary cables and trays. </p>\n\n<pre><code>Public shp3 As Shape\nPrivate Sub CommandButton1_Click()\n   Dim CableClass As String\n   Dim TrayClass As String\n   Dim pg2 As Page\n\n   CableClass = ComboBox1.Value\n   TrayClass = ComboBox2.Value\n   Set shp3 = ActivePage.Shapes.ItemFromID(cID)\n\n   If CableClass = \"Primary\" Then\n        shp3.Cells(\"Prop.Row_CableClass.Value\").FormulaU = \"\"\"Primary\"\"\"\n        shp3.Cells(\"Prop.Row_CableType.Format\").FormulaU = \"\"\"Cable 1;Cable \n        2;Cable 3;Cable 4\"\"\"\n   ElseIf CableClass = \"Secondary\" Then\n       shp3.Cells(\"Prop.Row_CableClass.Value\").FormulaU = \"\"\"Secondary\"\"\"\n       shp3.Cells(\"Prop.Row_CableType.Format\").FormulaU = \"\"\"Cable 1;Cable \n       2;Cable 3;Cable 4\"\"\"\n   End If\n\n   If TrayClass = \"Primary\" Then\n       shp3.Cells(\"Prop.Row_TrayClass.Value\").FormulaU = \"\"\"Primary\"\"\"\n       shp3.Cells(\"Prop.Row_TrayType.Format\").FormulaU = \"\"\"cable tray \n       1;cable tray 2;cable tray 3;cable tray 4\"\"\"\n   ElseIf TrayClass = \"Secondary\" Then\n       shp3.Cells(\"Prop.Row_TrayClass.Value\").FormulaU = \"\"\"Secondary\"\"\"\n       shp3.Cells(\"Prop.Row_TrayType.Format\").FormulaU = \"\"\"cable tray \n       1;cable tray 2;cable tray 3;cable tray 4\"\"\"\n   End If\n   Unload Me\nEnd Sub\n</code></pre>\n\n<p>Once a specific type of cable or tray is chosen from the shape data, I want the cost to automatically change based on what is selected. In other words, I want one piece of shape data (cost) to change dynamically based on the type of cable selected from a drop down box.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7676, "user_id": 7248342, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RWVBN.png?s=128&g=1", "display_name": "Thomas Fritsch", "link": "https://stackoverflow.com/users/7248342/thomas-fritsch"}, "edited": false, "score": 0, "creation_date": 1536762732, "post_id": 52294759, "comment_id": 91543137, "body": "I&#39;ve fixed the code-formatting and added [vba] tag"}], "answers": [{"tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": false, "score": 0, "last_activity_date": 1536758517, "creation_date": 1536758517, "answer_id": 52296266, "question_id": 52294759, "link": "https://stackoverflow.com/questions/52294759/vba-macro-upgraded-from-32-bit-to-64-bit/52296266#52296266", "title": "VBA / Macro upgraded from 32 bit to 64 bit", "body": "<p>Have a look at this page:\n<a href=\"https://jkp-ads.com/Articles/apideclarations.asp\" rel=\"nofollow noreferrer\">https://jkp-ads.com/Articles/apideclarations.asp</a></p>\n\n<p>NB: Please make sure all code in your message is marked as such so we can easily read the code.</p>\n"}], "owner": {"reputation": 1, "user_id": 10353056, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157635625593219/picture?type=large", "display_name": "neil777", "link": "https://stackoverflow.com/users/10353056/neil777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 680, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536762732, "creation_date": 1536753949, "last_edit_date": 1536762732, "question_id": 52294759, "link": "https://stackoverflow.com/questions/52294759/vba-macro-upgraded-from-32-bit-to-64-bit", "title": "VBA / Macro upgraded from 32 bit to 64 bit", "body": "<p>I have been upgraded from 32bit to 64 bit and my macro to merge and arrange files in a folder does not work any more, not a VBA user so am pretty much stuck and would appreciate help getting the marco to work ?</p>\n\n<pre><code>Option Explicit\n\n '32-bit API declarations\nDeclare Function SHGetPathFromIDList Lib \"shell32.dll\" _\nAlias \"SHGetPathFromIDListA\" (ByVal pidl As Long, ByVal _\npszpath As String) As Long\n\nDeclare Function SHBrowseForFolder Lib \"shell32.dll\" _\nAlias \"SHBrowseForFolderA\" (lpBrowseInfo As BrowseInfo) _\nAs Long\n\nPublic Type BrowseInfo\n    hOwner As Long\n    pIDLRoot As Long\n    pszDisplayName As String\n    lpszTitle As String\n    ulFlags As Long\n    lpfn As Long\n    lParam As Long\n    iImage As Long\nEnd Type\n\nFunction GetDirectory(Optional msg) As String\n    On Error Resume Next\n    Dim bInfo As BrowseInfo\n    Dim path As String\n    Dim r As Long, x As Long, pos As Integer\n\n     'Root folder = Desktop\n    bInfo.pIDLRoot = 0&amp;\n\n     'Title in the dialog\n    If IsMissing(msg) Then\n        bInfo.lpszTitle = \"Please select the folder of the excel files to copy.\"\n    Else\n        bInfo.lpszTitle = msg\n    End If\n\n     'Type of directory to return\n    bInfo.ulFlags = &amp;H1\n\n     'Display the dialog\n    x = SHBrowseForFolder(bInfo)\n\n     'Parse the result\n    path = Space$(512)\n    r = SHGetPathFromIDList(ByVal x, ByVal path)\n    If r Then\n        pos = InStr(path, Chr$(0))\n        GetDirectory = Left(path, pos - 1)\n    Else\n        GetDirectory = \"\"\n    End If\nEnd Function\n\nSub CombineFiles()\n    Dim path            As String\n    Dim FileName        As String\n    Dim LastCell        As Range\n    Dim Wkb             As Workbook\n    Dim ws              As Worksheet\n    Dim ThisWB          As String\n\n    Application.DisplayAlerts = False\n\n\n    ThisWB = ThisWorkbook.Name\n    Application.EnableEvents = False\n    Application.ScreenUpdating = False\n    path = GetDirectory\n    FileName = Dir(path &amp; \"\\*.xlsx\", vbNormal)\n    Do Until FileName = \"\"\n        If FileName &lt;&gt; ThisWB Then\n            Set Wkb = Workbooks.Open(FileName:=path &amp; \"\\\" &amp; FileName)\n            For Each ws In Wkb.Worksheets\n                If ws.Visible = xlSheetHidden Then\n                Else\n                    ws.Copy After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)\n                End If\n            Next ws\n            Wkb.Close False\n        End If\n        FileName = Dir()\n    Loop\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\n\n    Set Wkb = Nothing\n    Set LastCell = Nothing\n\n    Call Sort_Tabs\n\n    Call Hide_create_tab\n\n    Call Select_all_sheets\n\n    Application.Dialogs(xlDialogSaveAs).Show \"Enter MCR file name\"\n\n\n    Application.DisplayAlerts = True\n\nEnd Sub\n\n\nSub Sort_Tabs()\n     'declare our variables\n    Dim i, j As Integer\n    Dim iNumSheets As Integer\n     'find the number of sheets to work with\n    iNumSheets = ActiveWorkbook.Sheets.Count\n     'turn off screen updating to prevent screen flicker\n    Application.ScreenUpdating = False\n     'work through our number of sheets\n    For i = 1 To iNumSheets - 1\n        For j = i + 1 To iNumSheets\n             'check the name of the sheet regardless of case\n            If UCase(Sheets(i).Name) &gt; UCase(Sheets(j).Name) Then\n                 'set where to move the sheet to\n                Sheets(j).Move before:=Sheets(i)\n            End If\n             'do next sheet\n        Next j\n    Next i\n     'let the screen update\n    Application.ScreenUpdating = True\nEnd Sub\n\nSub Hide_create_tab()\n\nSheets(\"Create MCR\").Select\nActiveSheet.Visible = False\n\nEnd Sub\n\nSub Select_all_sheets()\n\nDim ws As Worksheet\nFor Each ws In Sheets\n    If ws.Visible Then ws.Select (False)\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1536755284, "post_id": 52294563, "comment_id": 91537879, "body": "Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read the <a href=\"https://stackoverflow.com/help\">help center</a> to get a better feel for how things work here at <a href=\"https://stackoverflow.com\">Stack Overflow</a>. That will help you a lot in getting better answers to <i>all</i> your questions."}], "answers": [{"comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1536754103, "post_id": 52294686, "comment_id": 91537187, "body": "To expand on this; while <code>;</code> and <code>,</code> can both be used as the argument separator in Excel, depending on your locale, in VBA <code>,</code> is always what will be used - even when typing in formulas which will be put into the worksheet."}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1536753693, "creation_date": 1536753693, "answer_id": 52294686, "question_id": 52294563, "link": "https://stackoverflow.com/questions/52294563/why-doesnt-it-fill-the-column-until-the-last-used-row-with-the-right-valuesook/52294686#52294686", "title": "Why doesn&#39;t it fill the column until the last used row with the right values(OOKUP function)?", "body": "<p>Replace ; with ,</p>\n\n<pre><code>ActiveSheet.Range(\"B2:B\" &amp; lastrow).Formula = \"=LOOKUP(C3, Calibr!B:B, Calibr!C:C)\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10316714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91fd738ca618793685fb13c35f376ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Elys", "link": "https://stackoverflow.com/users/10316714/elys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "closed_date": 1536754894, "answer_count": 1, "score": 0, "last_activity_date": 1536754685, "creation_date": 1536753306, "question_id": 52294563, "link": "https://stackoverflow.com/questions/52294563/why-doesnt-it-fill-the-column-until-the-last-used-row-with-the-right-valuesook", "closed_reason": "Duplicate", "title": "Why doesn&#39;t it fill the column until the last used row with the right values(OOKUP function)?", "body": "<p>i have the code below and i don't understand why i get the run-time error 1004: Application-defined or object-defined error.</p>\n\n<pre><code>Sub INCA_tabel()\n\n\nDim lastrow As Long\n\nSheets(\"Calibr\").Activate\n\nlastrow = Cells(Rows.count, 2).End(xlUp).Row\nRange(\"B2:B\" &amp; lastrow).Select\nSelection.copy\nSheets(\"INCA\").Select\nRange(\"C3:C\" &amp; lastrow).PasteSpecial Paste:=xlPasteValues\n\n\nSheets(\"INCA\").Activate\nlastrow = ActiveSheet.Cells(Rows.count, \"C\").End(xlUp).Row\nActiveSheet.Range(\"B2:B\" &amp; lastrow).Formula = \"=LOOKUP(C3; Calibr!B:B; Calibr!C:C)\" &lt;-- here is the issue\n\nActiveSheet.Cells(lastrow, \"A\").value = \"INCA_Read\"\n\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel", "file"], "comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 2, "creation_date": 1536754207, "post_id": 52294549, "comment_id": 91537245, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5651890/using-vba-to-get-extended-file-attributes\">Using VBA to get extended file attributes</a>"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1536758030, "post_id": 52294549, "comment_id": 91539909, "body": "@nicomp I don&#39;t believe there is anyway one could record a macro that would populate a cell with a file&#39;s last modified date and created by values."}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1536759483, "post_id": 52294549, "comment_id": 91540957, "body": "@JNevill You&#39;re right. I would have bet we could find that. But I did find this VBA after 30 seconds of searching online: Public Function ModDate() ModDate = Format(FileDateTime(ThisWorkbook.FullName), &quot;m/d/yy h:n ampm&quot;) End Function"}, {"owner": {"reputation": 49, "user_id": 9966484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c3f4d8a05e0e74d793146a3d52dbc9f?s=128&d=identicon&r=PG&f=1", "display_name": "DMO", "link": "https://stackoverflow.com/users/9966484/dmo"}, "edited": false, "score": 0, "creation_date": 1536762650, "post_id": 52294549, "comment_id": 91543087, "body": "Thanks all for your comments.@nicomp my VBA is not amazing so could you please share how and where i would add this into the code so it populates in the correct location?"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 9966484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c3f4d8a05e0e74d793146a3d52dbc9f?s=128&d=identicon&r=PG&f=1", "display_name": "DMO", "link": "https://stackoverflow.com/users/9966484/dmo"}, "edited": false, "score": 0, "creation_date": 1536764696, "post_id": 52297421, "comment_id": 91544341, "body": "just so i understand this correctly, download the Active X programme to get additional file information, then update and run the code above? if this is the case to help with updating could i ask you to add comments in your code to allow me to edit?"}, {"owner": {"reputation": 49, "user_id": 9966484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c3f4d8a05e0e74d793146a3d52dbc9f?s=128&d=identicon&r=PG&f=1", "display_name": "DMO", "link": "https://stackoverflow.com/users/9966484/dmo"}, "edited": false, "score": 0, "creation_date": 1536818724, "post_id": 52297421, "comment_id": 91562216, "body": "thanks, i have downloaded this but i am a little confused as to how i would add this into my current code, could you help with this?"}, {"owner": {"reputation": 49, "user_id": 9966484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c3f4d8a05e0e74d793146a3d52dbc9f?s=128&d=identicon&r=PG&f=1", "display_name": "DMO", "link": "https://stackoverflow.com/users/9966484/dmo"}, "edited": false, "score": 0, "creation_date": 1536845116, "post_id": 52297421, "comment_id": 91576613, "body": "i updated the information and on line 10 i get &quot;Subscript out of range&quot; my information populates in column I so i updated to I"}, {"owner": {"reputation": 49, "user_id": 9966484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c3f4d8a05e0e74d793146a3d52dbc9f?s=128&d=identicon&r=PG&f=1", "display_name": "DMO", "link": "https://stackoverflow.com/users/9966484/dmo"}, "edited": false, "score": 0, "creation_date": 1536845447, "post_id": 52297421, "comment_id": 91576811, "body": "my apologies i have realised my mistake, new error i get &quot;User-defined type not defined&quot; on this line in the second part of the script: Dim fOpenReadOnly As Boolean, DSO As DSOFile.OleDocumentProperties"}, {"owner": {"reputation": 49, "user_id": 9966484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c3f4d8a05e0e74d793146a3d52dbc9f?s=128&d=identicon&r=PG&f=1", "display_name": "DMO", "link": "https://stackoverflow.com/users/9966484/dmo"}, "edited": false, "score": 0, "creation_date": 1536847780, "post_id": 52297421, "comment_id": 91578359, "body": "i cannot thank you enough!! it works beautifully! i ran my code first, then ran yours (after a bit of back and forth) but its works! one more thing? if i wanted to add multiple document types on this line: If FileSys.GetExtensionName(FileName) = &quot;docx&quot; Then &#39;check if .docx do i just add them in like &quot;docx, PDF&quot; etc. of does this have to be done differently?"}, {"owner": {"reputation": 49, "user_id": 9966484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c3f4d8a05e0e74d793146a3d52dbc9f?s=128&d=identicon&r=PG&f=1", "display_name": "DMO", "link": "https://stackoverflow.com/users/9966484/dmo"}, "edited": false, "score": 0, "creation_date": 1536855829, "post_id": 52297421, "comment_id": 91583194, "body": "thanks - i tried the OR function this didn&#39;t work could you please provide more details around the array i&#39;m not sure i understand: array of extensions and use Match into that array and test with If Not IsError(Match(FileSys.GetExtensionName(FileName) , array,0))"}, {"owner": {"reputation": 49, "user_id": 9966484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c3f4d8a05e0e74d793146a3d52dbc9f?s=128&d=identicon&r=PG&f=1", "display_name": "DMO", "link": "https://stackoverflow.com/users/9966484/dmo"}, "edited": false, "score": 0, "creation_date": 1536904741, "post_id": 52297421, "comment_id": 91598361, "body": "thank you, works perfectly - can the code be adjust so if the value  has already been put on the spreadsheet is skips it and only adds the missing ones, currently its copying again. is that possible?"}, {"owner": {"reputation": 49, "user_id": 9966484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c3f4d8a05e0e74d793146a3d52dbc9f?s=128&d=identicon&r=PG&f=1", "display_name": "DMO", "link": "https://stackoverflow.com/users/9966484/dmo"}, "edited": false, "score": 0, "creation_date": 1536907749, "post_id": 52297421, "comment_id": 91599605, "body": "so i have added this in and i get an error &quot;Next without For&quot; the lines i have is:             If Not IsError(Application.Match(FileSys.GetExtensionName(FileName)&zwnj;&#8203;, Array(&quot;docx&quot;, &quot;pdf&quot;), 0)) Then &#39;check if .docx             If Not IsError(Application.Match(FileSys.GetExtensionName(FileName)&zwnj;&#8203;, &quot;O:Q&quot;, 0)) Then                 arr = GetExtendedProperties(FileName) sorry for all the questions my VBA is not amazing but learning so much!"}, {"owner": {"reputation": 49, "user_id": 9966484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c3f4d8a05e0e74d793146a3d52dbc9f?s=128&d=identicon&r=PG&f=1", "display_name": "DMO", "link": "https://stackoverflow.com/users/9966484/dmo"}, "edited": false, "score": 0, "creation_date": 1536907991, "post_id": 52297421, "comment_id": 91599715, "body": "attached - i also tried adding in reading of PDF files by adding oSummProps.Owner but it didnt work for some reason! <a href=\"https://pastebin.com/AVCNAZ0V\" rel=\"nofollow noreferrer\">pastebin.com/AVCNAZ0V</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 49, "user_id": 9966484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c3f4d8a05e0e74d793146a3d52dbc9f?s=128&d=identicon&r=PG&f=1", "display_name": "DMO", "link": "https://stackoverflow.com/users/9966484/dmo"}, "edited": false, "score": 0, "creation_date": 1536908024, "post_id": 52297421, "comment_id": 91599737, "body": "I am not sure you can use with pdf. You didn&#39;t close  your second If with an End If before the Next ObjFile.   i.e.      End If             End If         Next objFile"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 49, "user_id": 9966484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c3f4d8a05e0e74d793146a3d52dbc9f?s=128&d=identicon&r=PG&f=1", "display_name": "DMO", "link": "https://stackoverflow.com/users/9966484/dmo"}, "edited": false, "score": 0, "creation_date": 1536908358, "post_id": 52297421, "comment_id": 91599913, "body": "No I don&#39;t though I can have a quick look and see what is written. This is getting close to what would be better managed via command line."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 49, "user_id": 9966484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c3f4d8a05e0e74d793146a3d52dbc9f?s=128&d=identicon&r=PG&f=1", "display_name": "DMO", "link": "https://stackoverflow.com/users/9966484/dmo"}, "edited": false, "score": 0, "creation_date": 1536908466, "post_id": 52297421, "comment_id": 91599978, "body": "Ok... so it seems it works only for files and specifically deals with Microsoft products i.e. not pdf!  See here: <a href=\"https://support.microsoft.com/en-gb/help/224351/the-dsofile-dll-files-lets-you-edit-office-document-properties-when-yo\" rel=\"nofollow noreferrer\">support.microsoft.com/en-gb/help/224351/&hellip;</a>"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1536765824, "last_edit_date": 1536765824, "creation_date": 1536762083, "answer_id": 52297421, "question_id": 52294549, "link": "https://stackoverflow.com/questions/52294549/vba-to-populate-last-saved-user-and-last-saved-date-of-a-file/52297421#52297421", "title": "VBA to populate last saved user and last saved date of a file", "body": "<p>Here is an example accessing the extended document properties via  Dsofile.dll. 32 bit version is <a href=\"https://support.microsoft.com/en-gb/help/224351/the-dsofile-dll-files-lets-you-edit-office-document-properties-when-yo\" rel=\"nofollow noreferrer\">here</a>. I am using re-written 64 bit alternative by <a href=\"https://www.codeproject.com/tips/1118708/bit-application-can-not-use-dsofile\" rel=\"nofollow noreferrer\">robert8w8</a>. After installation, of 64 bit version in my case, you go Tools >References >Add a reference to <code>DSO OLE Document Properties Reader 2.1</code>. It enables to access extended properties of closed files. Obviously, if the info is not available, it cannot be returned.</p>\n\n<p>I have an optional filemask test in there which can be removed.   </p>\n\n<p>The DSO function is my re-write of a great sub that lists many more properties by xld <a href=\"http://www.vbaexpress.com/forum/showthread.php?6827-Fetching-Object-Properties&amp;highlight=DSOFile\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<pre><code>Option Explicit\nPublic Sub GetLastestDateFile()\n    Dim FileSys As Object, objFile As Object, myFolder As Object\n    Const myDir As String = \"C:\\Users\\User\\Desktop\\TestFolder\" '&lt; Pass in your folder path\n    Set FileSys = CreateObject(\"Scripting.FileSystemObject\")\n    Set myFolder = FileSys.GetFolder(myDir)\n\n    Dim fileName As String, lastRow As Long, arr(), counter As Long\n\n    With ThisWorkbook.Worksheets(\"Sheet1\") '&lt;== Change to your sheet where writing info to \n        lastRow = .Cells(.Rows.Count, \"P\").End(xlUp).Row 'find the last row with data in P\n\n        For Each objFile In myFolder.Files 'loop files in folder\n            fileName = objFile.Path\n            If FileSys.GetExtensionName(fileName) = \"xlsx\" Then 'check if .xlsx\n                arr = GetExtendedProperties(fileName)\n                 counter = counter + 1\n                .Cells(lastRow + counter, \"O\") = arr(0) 'Last updated\n                .Cells(lastRow + counter, \"P\") = arr(1) 'Last save date\n                .Hyperlinks.Add Anchor:=.Cells(lastRow + counter, \"Q\"), Address:=objFile.Path '&lt;== Add hyperlink                 \n            End If\n        Next objFile\n    End With\nEnd Sub\n\nPublic Function GetExtendedProperties(ByVal FileName As String) As Variant\n    Dim fOpenReadOnly As Boolean, DSO As DSOFile.OleDocumentProperties\n    Dim oSummProps As DSOFile.SummaryProperties, oCustProp As DSOFile.CustomProperty\n    Dim outputArr(0 To 1)\n    Set DSO = New DSOFile.OleDocumentProperties\n    DSO.Open FileName, fOpenReadOnly, dsoOptionOpenReadOnlyIfNoWriteAccess\n\n    Set oSummProps = DSO.SummaryProperties\n\n    outputArr(0) = oSummProps.LastSavedBy\n    outputArr(1) = oSummProps.DateLastSaved\n    GetExtendedProperties = outputArr\nEnd Function\n</code></pre>\n\n<hr>\n\n<p><strong>Other:</strong></p>\n\n<ol>\n<li><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.hyperlinks.add\" rel=\"nofollow noreferrer\">Hyperlinks.Add method</a></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 450, "user_id": 2981328, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/55b5a57989320394ee6a2acaf766c01f?s=128&d=identicon&r=PG&f=1", "display_name": "hymced", "link": "https://stackoverflow.com/users/2981328/hymced"}, "is_accepted": false, "score": 0, "last_activity_date": 1618236018, "last_edit_date": 1618236018, "creation_date": 1618235519, "answer_id": 67059653, "question_id": 52294549, "link": "https://stackoverflow.com/questions/52294549/vba-to-populate-last-saved-user-and-last-saved-date-of-a-file/67059653#67059653", "title": "VBA to populate last saved user and last saved date of a file", "body": "<p>In my case I could not use the DSO library from dsofile.dll (one needs to be admin to install it and register it...), so I came up with another solution to get some OLE properties of Office documents without opening them. It appears that (some of?) these Extended Properties are also accessible via the Shell:</p>\n<pre><code>Function GetDateLastSaved_Shell32(strFileFullPath$)\n\n    strFolderPath$ = Left(strFileFullPath, Len(strFileFullPath) - Len(Dir(strFileFullPath)))\n    strFileName$ = Dir(strFileFullPath)\n\n    'using late binding here\n    'to use early binding with Dim statements you need to reference the Microsoft Shell Controls And Automation library, usually available here:\n    'C:\\Windows\\SysWOW64\\shell32.dll\n    'Example: \n    'Dim shlShell As Shell32.Shell \n\n    Set shlShell = CreateObject(&quot;Shell.Application&quot;) 'Variant/Object/IShellDispatch6\n    'Set shlFolder = shlShell.Namespace(strFolderPath)                              'does not work when using late binding, weird...*\n    Set shlFolder = shlShell.Namespace(CStr(strFolderPath))                         'works...\n    'Set shlFolder = shlShell.Namespace(strFolderPath &amp; &quot;&quot;)                         'works...\n    'Set shlFolder = shlShell.Namespace(Left$(strFolderPath, Len(strFolderPath)))   'works...\n\n    '*also mentioned here without an explanation...\n    'https://stackoverflow.com/questions/35957930/word-vba-shell-object-late-binding\n   \n    Set shlShellFolderItem = shlFolder.ParseName(strFileName)\n    \n    'all of the following returns the same thing (you have the returned Data Type indicated on the right)\n    'but the first one is said by MSDN to be the more efficient way to get an extended property\n    GetDateLastSaved_Shell32 = shlShellFolderItem.ExtendedProperty(&quot;{F29F85E0-4FF9-1068-AB91-08002B27B3D9} 13&quot;)  'Date\n    'GetDateLastSaved_Shell32 = shlShellFolderItem.ExtendedProperty(&quot;System.Document.DateSaved&quot;)                 'Date\n    'GetDateLastSaved_Shell32 = shlShellFolderItem.ExtendedProperty(&quot;DocLastSavedTm&quot;)                            'Date      'legacy name   \n    'GetDateLastSaved_Shell32 = shlFolder.GetDetailsOf(shlShellFolderItem, 154)                                  '?String?\n\nEnd Function\n</code></pre>\n<p>To list all extended properties (Core, Documents, etc.), you can use this:</p>\n<pre><code>For i = 0 To 400\n    vPropName = shlFolder.GetDetailsOf(Null, i)\n    vprop = shlFolder.GetDetailsOf(shlShellFolderItem, i)\n    Debug.Print i, vPropName, vprop\n    If i Mod 10 = 0 Then Stop\nNext\n</code></pre>\n<p>You can find more info about the &quot;efficient way&quot; on MSDN: <a href=\"https://docs.microsoft.com/en-us/windows/win32/shell/shellfolderitem-extendedproperty\" rel=\"nofollow noreferrer\">ShellFolderItem.ExtendedProperty method</a></p>\n<p>You can also find the list of FMTIDs and PIDSIs in propkey.h from Windows SDK or somewhere in <code>C:\\Program Files (x86)\\Windows Kits\\10\\Include\\***VERSION***\\um\\</code> if you have Visual Studio installed.</p>\n"}], "owner": {"reputation": 49, "user_id": 9966484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c3f4d8a05e0e74d793146a3d52dbc9f?s=128&d=identicon&r=PG&f=1", "display_name": "DMO", "link": "https://stackoverflow.com/users/9966484/dmo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1217, "favorite_count": 1, "accepted_answer_id": 52297421, "answer_count": 2, "score": 0, "last_activity_date": 1618236018, "creation_date": 1536753280, "last_edit_date": 1536757782, "question_id": 52294549, "link": "https://stackoverflow.com/questions/52294549/vba-to-populate-last-saved-user-and-last-saved-date-of-a-file", "title": "VBA to populate last saved user and last saved date of a file", "body": "<p>I have been using the code below to get file names from folders which works perfectly but I need to make a minor adjustment. I need to add in to fetch the following and populate it on the spreadsheet:</p>\n\n<ul>\n<li>File last updated by (Column O)</li>\n<li>File last updated date (Column P)</li>\n<li>Hyperlink the file to the spreadsheet (Column Q)</li>\n</ul>\n\n<p>Can someone help me update this code to include these? </p>\n\n<p>Code: </p>\n\n<pre><code>Sub GetFileNames_Assessed_As_T2()\n    Dim sPath As String, sFile As String\n    Dim iRow As Long, iCol As Long\n    Dim ws As Worksheet: Set ws = Sheet9\n    'declare and set the worksheet you are working with, amend as required\n\n    sPath = \"Z:\\NAME\\T2\\\"\n    'specify directory to use - must end in \"\"\n\n    sFile = Dir(sPath)\n    Do While sFile &lt;&gt; \"\"\n        LastRow = ws.Cells(ws.Rows.Count, \"I\").End(xlUp).Row 'get last row on Column I\n        Filename = Left(sFile, InStrRev(sFile, \".\") - 1) 'remove extension from file\n        Set FoundFile = ws.Range(\"I1:I\" &amp; LastRow).Find(what:=Filename, lookat:=xlWhole) 'search for existing filename\n        If FoundFile Is Nothing Then ws.Cells(LastRow + 1, \"I\") = Filename 'if not found then add it\n        sFile = Dir  ' Get next filename\n    Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "function", "find", "position", "character"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1536752469, "post_id": 52294236, "comment_id": 91536179, "body": "Anything you tried so far? I guess a combination of FIND and other string function could do the trick."}, {"owner": {"reputation": 31, "user_id": 9715273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2ad4ffe53094f997f0e16d1d2c742ca?s=128&d=identicon&r=PG&f=1", "display_name": "Genoka", "link": "https://stackoverflow.com/users/9715273/genoka"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1536753954, "post_id": 52294236, "comment_id": 91537097, "body": "Did some research and someone already did something very similar, I just had to modify a few things, but in the end this worked:"}], "answers": [{"comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1536755366, "post_id": 52294784, "comment_id": 91537930, "body": "Good on you for finding your own answer to your question."}], "tags": [], "owner": {"reputation": 31, "user_id": 9715273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2ad4ffe53094f997f0e16d1d2c742ca?s=128&d=identicon&r=PG&f=1", "display_name": "Genoka", "link": "https://stackoverflow.com/users/9715273/genoka"}, "is_accepted": false, "score": 2, "last_activity_date": 1536754842, "last_edit_date": 1536754842, "creation_date": 1536754003, "answer_id": 52294784, "question_id": 52294236, "link": "https://stackoverflow.com/questions/52294236/function-that-searches-a-cell-for-a-specific-string-and-returns-it-in-excel-vba/52294784#52294784", "title": "Function that searches a cell for a specific string and returns it in excel vba", "body": "<p>After some research:</p>\n\n<pre><code>Function RetDigits(sIN As String) As String\n    Dim lookFor As String, v As String, ary\n    Dim i As Long, CH As String\n    lookFor = \"1-\"\n    RetDigits = \"\"\n    If InStr(sIN, lookFor) = 0 Then Exit Function\n    ary = Split(sIN, lookFor)\n    If Len(ary(1)) &lt; 2 Then Exit Function\n    For i = 1 To 10\n        CH = Mid(ary(1), i, 1)\n        If IsNumeric(CH) Then\n            RetDigits = RetDigits &amp; CH\n        End If\n    Next i\n    RetDigits = \"1-\" &amp; RetDigits\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9715273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2ad4ffe53094f997f0e16d1d2c742ca?s=128&d=identicon&r=PG&f=1", "display_name": "Genoka", "link": "https://stackoverflow.com/users/9715273/genoka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1536754842, "creation_date": 1536752273, "question_id": 52294236, "link": "https://stackoverflow.com/questions/52294236/function-that-searches-a-cell-for-a-specific-string-and-returns-it-in-excel-vba", "title": "Function that searches a cell for a specific string and returns it in excel vba", "body": "<p>I'm wondering if a function is possible that searches for this \"1-\" in a cell's value and if it can find it, it would copy out the \"1-\" plus the next 10 characters.</p>\n\n<p>Basicly if \"1-\" is in a cell, I'd like the function to get that plus the next 10 chars for me.</p>\n\n<p>Thanks a lot in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1536751894, "post_id": 52293977, "comment_id": 91535892, "body": "Hi! Welcome to <a href=\"https://stackoverflow.com\">Stack Overflow</a>. This isn&#39;t your standard forum, and it&#39;s certainly not a &quot;write my code for me&quot; service. Take a minute take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read the <a href=\"https://stackoverflow.com/help\">help center</a> to get familiar with the place. Once you&#39;ve done that, come back <a href=\"https://stackoverflow.com/posts/52293977/edit\">edit</a> your post to include your best shot at the code to do this and someone will be happy to help you fix issues with it. You&#39;re highly unlikely to find someone willing to do your work for you, though."}, {"owner": {"reputation": 523, "user_id": 8658994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/161136634bbb0e05c5186344415a8fbb?s=128&d=identicon&r=PG&f=1", "display_name": "FocusWiz", "link": "https://stackoverflow.com/users/8658994/focuswiz"}, "edited": false, "score": 1, "creation_date": 1536753375, "post_id": 52293977, "comment_id": 91536701, "body": "Without seeing how you defined these ranges, it is impossible to decipher specifically what you did wrong, but assuming the amount is in Column C, the start date is in Column A, and the end date is in column B, and they all run from  row 1 to row 2500, with the Query Date in E1 the formula should be more like =SUMIFS(C1:C2500,A1:A2500,&quot;&lt;=&quot;&amp;E1,B1:B2500,&quot;&gt;=&quot;&amp;E1)"}, {"owner": {"reputation": 11, "user_id": 10352836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c23c1da5344dab82cac31763ba7f9d3?s=128&d=identicon&r=PG&f=1", "display_name": "Sabbathi", "link": "https://stackoverflow.com/users/10352836/sabbathi"}, "edited": false, "score": 0, "creation_date": 1536756163, "post_id": 52293977, "comment_id": 91538490, "body": "Thank you. I was attempting to make sure the query date fits both startdate and enddate simultaneously, and couldn&#39;t get past the syntax errors.  Your approach/formula first checks startdate against querydate, and then checks enddate against querydate, yielding results I&#39;m after."}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 9396005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cba7b7960d8896f4cde7519c3484f783?s=128&d=identicon&r=PG&f=1", "display_name": "thomasuponor", "link": "https://stackoverflow.com/users/9396005/thomasuponor"}, "is_accepted": false, "score": 0, "last_activity_date": 1536756368, "creation_date": 1536756368, "answer_id": 52295566, "question_id": 52293977, "link": "https://stackoverflow.com/questions/52293977/sumif-for-a-range/52295566#52295566", "title": "Sumif for a range", "body": "<p>So you want to sum the values between two dates?</p>\n\n<pre><code>=sumifs(TYPE SUM RANGE HERE;\"&gt;=01-01-2015\";\"&lt;01-02-2015\")\n</code></pre>\n\n<p>The dates are just an example</p>\n"}], "owner": {"reputation": 11, "user_id": 10352836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c23c1da5344dab82cac31763ba7f9d3?s=128&d=identicon&r=PG&f=1", "display_name": "Sabbathi", "link": "https://stackoverflow.com/users/10352836/sabbathi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536756368, "creation_date": 1536751278, "last_edit_date": 1536752716, "question_id": 52293977, "link": "https://stackoverflow.com/questions/52293977/sumif-for-a-range", "title": "Sumif for a range", "body": "<p>I have 2500 rows, each of which looks like this: \"amount\" \"startdate\" \"enddate\"</p>\n\n<p>My output is supposed to look like this: \"querydate\" \"sum\"</p>\n\n<p>I want to write a formula that returns the sum of all amounts where the querydate is between the startdate and enddate.</p>\n\n<p>I've tried the following formula: =SUMIFS(amount,querydate,\">=\"&amp;startdate,querydate\"&lt;=\"&amp;enddate). However, it's outputs change every time either startdate or enddate column are sorted, which shouldn't happen.</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 3, "creation_date": 1536751436, "post_id": 52293945, "comment_id": 91535626, "body": "Is that an answer or your attempt to solve the question? If an answer some explanation would help. Assumptions such as 32 bit system etc."}], "tags": [], "owner": {"reputation": 5, "user_id": 10342044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dad456fe4d2df75f4a3a46d737748813?s=128&d=identicon&r=PG&f=1", "display_name": "Krupal Patel", "link": "https://stackoverflow.com/users/10342044/krupal-patel"}, "is_accepted": false, "score": 0, "last_activity_date": 1536751188, "creation_date": 1536751188, "answer_id": 52293945, "question_id": 52293921, "link": "https://stackoverflow.com/questions/52293921/how-to-find-servername-and-username-of-sql-using-vba/52293945#52293945", "title": "How to find servername and username of SQL using VBA?", "body": "<pre><code>Private Declare Function GetPrivateProfileStringA Lib _\n    \"Kernel32\" (ByVal strSection As String, _\n    ByVal strKey As String, ByVal strDefault As String, _\n    ByVal strReturnedString As String, _\n    ByVal lngSize As Long, ByVal strFileNameName As String) As Long\nPrivate Declare Function WritePrivateProfileStringA Lib _\n    \"Kernel32\" (ByVal strSection As String, _\n    ByVal strKey As String, ByVal strString As String, _\n    ByVal strFileNameName As String) As Long\n\n\nPrivate Function WritePrivateProfileString32(ByVal strFileName As String, _\n    ByVal strSection As String, ByVal strKey As String, _\n    ByVal strValue As String) As Boolean\nDim lngValid As Long\n    On Error Resume Next\n    lngValid = WritePrivateProfileStringA(strSection, strKey, _\n        strValue, strFileName)\n    If lngValid &gt; 0 Then WritePrivateProfileString32 = True\n    On Error GoTo 0\nEnd Function\n\n\nPrivate Function GetPrivateProfileString32(ByVal strFileName As String, _\n    ByVal strSection As String, ByVal strKey As String, _\n    Optional strDefault) As String\nDim strReturnString As String, lngSize As Long, lngValid As Long\n    On Error Resume Next\n    If IsMissing(strDefault) Then strDefault = \"\"\n    strReturnString = Space(1024)\n    lngSize = Len(strReturnString)\n    lngValid = GetPrivateProfileStringA(strSection, strKey, _\n        strDefault, strReturnString, lngSize, strFileName)\n    GetPrivateProfileString32 = Left(strReturnString, lngValid)\n    On Error GoTo 0\nEnd Function\n\n\n' the examples below assumes that the range B3:B5 in the active sheet contains\n' information about Lastname, Firstname and Birthdate\n\n\nSub WriteUserInfo()\n    sFile = \"D:\\abc.TXT\"\n' saves information in the file IniFileName\n    If Not WritePrivateProfileString32(sFile, \"PERSONAL\", _\n        \"Lastname\", Range(\"B3\").Value) Then\n        MsgBox \"Not able to save user info in \" &amp; IniFileName, _\n            vbExclamation, \"Folder does not exist!\"\n        Exit Sub\n    End If\n    WritePrivateProfileString32 sFile, \"PERSONAL\", _\n        \"Birthdate\", \"aaa\"\n\nEnd Sub\n\n\nPublic Function ReadUserInfo(sAttribute)\nDim sFile As String\n    sFile = ThisWorkbook.Path + \"\\Input.ini\"\n    ReadUserInfo = GetPrivateProfileString32(sFile, \"CONFIGURATION\", sAttribute)\nEnd Function\n\n\n' the example below assumes that the range D4 in the active sheet contains\n' information about the unique number\n\n\nSub GetNewUniqueNumber()\nDim UniqueNumber As Long\n    If Dir(IniFileName) = \"\" Then Exit Sub\n    UniqueNumber = 0\n    On Error Resume Next\n    UniqueNumber = CLng(GetPrivateProfileString32(IniFileName, _\n        \"PERSONAL\", \"UniqueNumber\"))\n    On Error GoTo 0\n    Range(\"D4\").Formula = UniqueNumber + 1\n    If Not WritePrivateProfileString32(IniFileName, \"PERSONAL\", _\n        \"UniqueNumber\", Range(\"D4\").Value) Then\n        MsgBox \"Not able to save user info in \" &amp; IniFileName, _\n            vbExclamation, \"Folder does not exist!\"\n        Exit Sub\n    End If\nEnd Sub\n\n\n\nPrivate Sub getInfo()\n    MsgBox ThisWorkbook.Path\n\nEnd Sub\n\nPublic Function ValidateInput(sSheetName As String, Optional bPortfolio As Boolean) As Boolean\n\n    Dim bValidate As Boolean\n    bValidate = True\n\n     If Worksheets(sSheetName).cmbYear.ListIndex &lt; 1 Then\n        MsgBox \"Please select Year\"\n        bValidate = False\n\n     ElseIf Worksheets(sSheetName).cmbMonth.ListIndex &lt; 1 Then\n        MsgBox \"Please select Month\"\n        bValidate = False\n\n    End If\n\n    ValidateInput = bValidate\n\nEnd Function\n\n\nPublic Function GetDateClause()\n\n   Dim sYear As String, sMonth As String, sRetDates As Variant\n   Dim dFromdate As Date, dToDate As Date\n   Dim interval As Integer\n\n   interval = -12\n   dToDate = CDate(CStr(Worksheets(\"UI\").cbYear.Value &amp; \"/\" &amp; (Worksheets(\"UI\").cbMonth.ListIndex)))\n   dFromdate = DateAdd(\"M\", interval, dToDate)\n\n   sRetDates = Year(dFromdate) &amp; Right(\"0\" &amp; Month(dFromdate), 2) &amp; \"::\" &amp; Year(dToDate) &amp; Right(\"0\" &amp; Month(dToDate), 2) &amp; \"::\" &amp; dFromdate\n\n   GetDateClause = sRetDates\nEnd Function\n\n\n\nPublic Sub DateFilter()\n\n'Set the Variables to be used\nDim pt As PivotTable\n\n'Amend here to filter your data\nSet pt = Worksheets(\"PivotTables\").PivotTables(\"PivotTable1\")\n    pt.PivotFields(\"Date\").ClearAllFilters 'This line is needed to clear existing filter before applying new one\n   pt.PivotFields(\"Date\").PivotFilters.Add Type:=xlDateBetween, _\n        Value1:=CLng((Range(\"SDate\").Value)), Value2:=CLng((Range(\"EDate\").Value))\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10342044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dad456fe4d2df75f4a3a46d737748813?s=128&d=identicon&r=PG&f=1", "display_name": "Krupal Patel", "link": "https://stackoverflow.com/users/10342044/krupal-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1536751188, "creation_date": 1536751126, "question_id": 52293921, "link": "https://stackoverflow.com/questions/52293921/how-to-find-servername-and-username-of-sql-using-vba", "title": "How to find servername and username of SQL using VBA?", "body": "<p>How to find servername and username of SQL using VBA?</p>\n"}, {"tags": ["excel", "vba", "ms-access", "connection"], "answers": [{"comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1536755962, "post_id": 52293963, "comment_id": 91538346, "body": "I think just worth mentioning is this only works because the OP said &quot;the database file and the Excel file will always be in the same relative location&quot;."}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1536756586, "post_id": 52293963, "comment_id": 91538806, "body": "@Storax Which is exactly why I think this is (conceptually) the better answer. OP mentions transporting workbook + database on a USB stick - this lets me assume it won&#39;t always be started from the desktop. In that regard, your method will fail."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1536756809, "post_id": 52293963, "comment_id": 91538993, "body": "Yes, right, from that perspective this is the better answer. It, of course, depends on the needs of the OP."}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1536756871, "post_id": 52293963, "comment_id": 91539048, "body": "@Storax Which (to me) wasn&#39;t entirely clear from the question when I first read it... ;)"}], "tags": [], "owner": {"reputation": 96, "user_id": 10351957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhPLN.jpg?s=128&g=1", "display_name": "Hamed", "link": "https://stackoverflow.com/users/10351957/hamed"}, "is_accepted": true, "score": 0, "last_activity_date": 1536772400, "last_edit_date": 1536772400, "creation_date": 1536751235, "answer_id": 52293963, "question_id": 52293788, "link": "https://stackoverflow.com/questions/52293788/creating-connections-to-access-database-from-excel-using-vba/52293963#52293963", "title": "Creating connections to Access database from Excel using VBA", "body": "<p>Use this:</p>\n\n<pre><code>Path = ActiveWorkbook.Path &amp; \"\\\"\n</code></pre>\n\n<p>If you want the path to the workbook the code is residing in, use:</p>\n\n<pre><code>Path = ThisWorkbook.Path &amp; \"\\\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 1, "last_activity_date": 1536757224, "last_edit_date": 1536757224, "creation_date": 1536755712, "answer_id": 52295332, "question_id": 52293788, "link": "https://stackoverflow.com/questions/52293788/creating-connections-to-access-database-from-excel-using-vba/52295332#52295332", "title": "Creating connections to Access database from Excel using VBA", "body": "<p>You can retrieve the path to the desktop like that</p>\n\n<pre><code>sPath = Environ(\"USERPROFILE\") &amp; \"\\Desktop\"\n</code></pre>\n\n<p>That means you can use the following in your connection string</p>\n\n<pre><code>sPath &amp; \"\\Datbase.accdb\"\n</code></pre>\n\n<p><strong>Update</strong> In order to make it more robust it would be a good idea to add a function if the database file exists. You could use a function similar to <a href=\"https://stackoverflow.com/questions/11573914/check-if-the-file-exists-using-vba/16822070#16822070\">this</a></p>\n\n<pre><code>Function fileExists(s_directory As String, s_fileName As String) As Boolean\n\n    Dim obj_fso As Object\n\n    Set obj_fso = CreateObject(\"Scripting.FileSystemObject\")\n    fileExists = obj_fso.fileExists(s_directory &amp; \"\\\" &amp; s_fileName)\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 6380771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d42582dbbc8b365482cd64962e690e?s=128&d=identicon&r=PG&f=1", "display_name": "steviemac2000", "link": "https://stackoverflow.com/users/6380771/steviemac2000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 643, "favorite_count": 0, "accepted_answer_id": 52293963, "answer_count": 2, "score": 2, "last_activity_date": 1536772400, "creation_date": 1536750721, "last_edit_date": 1536752030, "question_id": 52293788, "link": "https://stackoverflow.com/questions/52293788/creating-connections-to-access-database-from-excel-using-vba", "title": "Creating connections to Access database from Excel using VBA", "body": "<p>I have an Excel workbook with several connections to queries in an Access database. I want to be able to share this with colleagues on a USB key, but the connection string has a direct path to the database like so:</p>\n\n<p><code>DSN=MS Access Database;DBQ=C:\\USERS\\Me\\Desktop\\Database.accdb;DefaultDir=C:\\;DriverId=25;FIL=MS Access;MaxBufferSize=2048;PageTimeout=5;\n</code></p>\n\n<p>From what I can tell a relative path can't be used here.\nIs there a way to get the current path of the Excel file when opened and create the connections in VBA? (the database file and the Excel file will always be in the same relative location)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 419, "user_id": 2244687, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/7cba9c90b1eeebafb8d13bcc52620967?s=128&d=identicon&r=PG", "display_name": "err1", "link": "https://stackoverflow.com/users/2244687/err1"}, "edited": false, "score": 0, "creation_date": 1536749969, "post_id": 52293375, "comment_id": 91534837, "body": "Have you tried doing the process manually? ie pasting in values instead of links?  If you can then simply record a macro whilst doing exactly that.  Then simply edit the recorded macro to your heart&#39;s content."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 419, "user_id": 2244687, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/7cba9c90b1eeebafb8d13bcc52620967?s=128&d=identicon&r=PG", "display_name": "err1", "link": "https://stackoverflow.com/users/2244687/err1"}, "edited": false, "score": 0, "creation_date": 1536750581, "post_id": 52293375, "comment_id": 91535143, "body": "Along the lines of what @err1 said, after pasting from source to dest, you can force a recalculation, then copy/Paste Special to paste the values in from the fresh calculation, thus eliminating the links and formulas."}, {"owner": {"reputation": 101, "user_id": 10352485, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uERL9.jpg?s=128&g=1", "display_name": "AEhere supports Monica", "link": "https://stackoverflow.com/users/10352485/aehere-supports-monica"}, "edited": false, "score": 0, "creation_date": 1536750652, "post_id": 52293375, "comment_id": 91535187, "body": "Recording leads to a code using Range(&quot;Table1&quot;).Select. This is inefficient for large data sets and I am hoping to avoid it if possible."}, {"owner": {"reputation": 101, "user_id": 10352485, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uERL9.jpg?s=128&g=1", "display_name": "AEhere supports Monica", "link": "https://stackoverflow.com/users/10352485/aehere-supports-monica"}, "edited": false, "score": 0, "creation_date": 1536751683, "post_id": 52293375, "comment_id": 91535762, "body": "Ok, I found that my noobishness was showing, I can drop the Destination parameter and then PasteSpecial in the next line, but at this point I do not have a table anymore, just the values. I&#39;ll amend the question to be about conserving the table if possible"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1536751827, "post_id": 52293375, "comment_id": 91535848, "body": "Recording does produce inefficient code.. but it will give you an idea on what to do. You should than be able to use that in your code. Saying that, I would capture the range in an array.. manipulate the array and then copy it back to destination"}, {"owner": {"reputation": 582, "user_id": 6896061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf0230605ac24f5be23ea08c02dbbe5?s=128&d=identicon&r=PG", "display_name": "DavidP", "link": "https://stackoverflow.com/users/6896061/davidp"}, "edited": false, "score": 0, "creation_date": 1536762600, "post_id": 52293375, "comment_id": 91543055, "body": "@AEhere You could try using PasteSpecial to end up with values and then converting that new range to a new ListObject. <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.listobjects.add\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/excel.listobjects.ad&zwnj;&#8203;d</a>"}], "owner": {"reputation": 101, "user_id": 10352485, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uERL9.jpg?s=128&g=1", "display_name": "AEhere supports Monica", "link": "https://stackoverflow.com/users/10352485/aehere-supports-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 894, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536752715, "creation_date": 1536749394, "last_edit_date": 1536752715, "question_id": 52293375, "link": "https://stackoverflow.com/questions/52293375/vba-copy-excel-table-values-without-links", "title": "VBA - copy Excel table values without links", "body": "<p>I am working on a macro and one of its functions is to open source workbooks from a list and copy information contained in an Excel table (ListObject) in each of the to a single target workbook.</p>\n\n<p>The source tables have links and formulae in them which is problematic as they break when copied thus:</p>\n\n<pre><code>source.Sheets(\"Sheet1\").ListObjects(\"Table1\").Range.Copy _\n            Destination:=target.Sheets(\"Sheet1\").Range(\"A1\")\n</code></pre>\n\n<p>I could unlink the table before copying it then close, but I hope there is a cleaner solution to move this data than this:</p>\n\n<pre><code>Dim source As Workbook\nDim target As Workbook\n\n    source.Sheets(\"Sheet1\").ListObjects(\"Table1\").Unlink\n    source.Sheets(\"Sheet1\").ListObjects(\"Table1\").Range.Copy _\n            Destination:=target.Sheets(\"Sheet1\").Range(\"A1\")\n    source.Close savechanges:=False\n</code></pre>\n\n<p>Alternatively,</p>\n\n<pre><code>source.Sheets(\"Sheet1\").ListObjects(\"Table1\").Range.Copy\ntarget.Sheets(\"Sheet1\").Range(\"A1\").PasteSpecial xlPasteValues\n</code></pre>\n\n<p>Copies the values, but loses the table object.</p>\n\n<p>Is there a way of moving this data as a table, sans the links? If possible I'd like to avoid selecting or activating anything as this will be iterated over many source files. I am open to alternative methods (a comment mentioned arrays) as well.</p>\n"}, {"tags": ["excel", "vba", "selenium", "ms-access", "selenium-webdriver"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536748961, "post_id": 52293093, "comment_id": 91534286, "body": "Can you share the web url? Or at the very least the page HTML. There can be a number of reasons why you are getting that error."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536749512, "post_id": 52293093, "comment_id": 91534592, "body": "@QHarr OP is trying to test if an element with that class exists. I&#39;m not knowledgeable in Selenium but still believe that&#39;s the wrong method and will always throw that error if it doesn&#39;t exist, so it&#39;s MCVE enough for me. I could write up an answer based on error trapping but you&#39;ll likely be able to write up a better one"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1536749617, "post_id": 52293093, "comment_id": 91534639, "body": "@ErikvonAsmuth Hi -  The error says it is unable to locate. If may be unable  locate at this point in time. It may exist somewhere.  Without seeing the html I cannot rule out that it doesn&#39;t exist in the html. But I get your point and will remove the MCVE part and simply leave the suggestion we need to see the html to better assist,"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536749691, "post_id": 52293093, "comment_id": 91534670, "body": "@QHarr But it should be unable to locate it, because it shouldn&#39;t exist, as I understand it"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536749837, "post_id": 52293093, "comment_id": 91534759, "body": "It may exist but be nested inside a frame/iframe/form tag so not be visible at the current document level (common occurrences). With incorrect access path it would generate the above error even if the element in fact does exist on the page."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536752380, "post_id": 52293093, "comment_id": 91536138, "body": "Please include the html"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1536755424, "post_id": 52293093, "comment_id": 91537967, "body": "@ErikvonAsmuth Think light bulb moment may just have come on when I started to look at code properly. I now assume you were referencing the Name part being wrong in className for the access method. Oops."}, {"owner": {"reputation": 11, "user_id": 10179008, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_YncDqGEozw/AAAAAAAAAAI/AAAAAAAAAFs/fdZm0z-3wks/photo.jpg?sz=128", "display_name": "Massi", "link": "https://stackoverflow.com/users/10179008/massi"}, "edited": false, "score": 0, "creation_date": 1536756077, "post_id": 52293093, "comment_id": 91538430, "body": "first of all thank you all for the answers. I tried to modify the suggested string as well     Set notext = bot.findElementByClassName(&quot;_3WZoe&quot;, timeoutms:=500) but the error is always unfortunately.  The wait are respected correctly.  The same code works perfectly using the seleniumBasic. But I&#39;m trying to switch to the webdriver which is better for managing the chrome profile (it does not require login to the portal again).  The block occurs just when the key I search does not appear. If this appears the routine continues without problems. Am I wrong about this string of code maybe?"}, {"owner": {"reputation": 11, "user_id": 10179008, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_YncDqGEozw/AAAAAAAAAAI/AAAAAAAAAFs/fdZm0z-3wks/photo.jpg?sz=128", "display_name": "Massi", "link": "https://stackoverflow.com/users/10179008/massi"}, "edited": false, "score": 0, "creation_date": 1536772682, "post_id": 52293093, "comment_id": 91548561, "body": "help me please.... :("}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536750035, "post_id": 52293531, "comment_id": 91534865, "body": "yeah and that! +1 And isn&#39;t it just timeout:=  ? Those if it didn&#39;t complain then I guess it is an additional argument parameter."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1536750230, "post_id": 52293531, "comment_id": 91534959, "body": "@QHarr based on his error, I think he&#39;s got the parameter name correct, but I haven&#39;t opened my project to look at my Selenium code and just don&#39;t remember off the top of my head."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536750329, "post_id": 52293531, "comment_id": 91534999, "body": "Agreed. I would have expected a different error had that been the case. Just <i>pleasantly</i> surprised to see a different timeout. If that is milliseconds, for example, then consideration needs to go for that in terms of the value set."}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 1, "last_activity_date": 1536750402, "last_edit_date": 1536750402, "creation_date": 1536749874, "answer_id": 52293531, "question_id": 52293093, "link": "https://stackoverflow.com/questions/52293093/selenium-findelement-vba-blocks-the-routine/52293531#52293531", "title": "selenium findelement vba blocks the routine", "body": "<pre><code>Set notext = bot.findElementByClassName(\"_3WZoe\", timeoutms:=0)\n</code></pre>\n\n<p>Your are <em>explicitly</em> setting <code>timeoutms:=0</code>. You're giving it no time to try to find the element on the page. Take that parameter out of your call, give it time to find the element on the page. It's going to run on the default timeout value (don't recall what it is off the top of my head), but should return quickly in most cases. You've already waited 2 seconds from your previous <code>sendKeys</code> command, so it's <em>likely</em> (though not guaranteed) that the element will have loaded by then.</p>\n\n<hr>\n\n<p>Additionally, it's entirely possible that the element you're looking for resides in a frame somewhere on the page and that you'll have to switch to the proper frame before you ever have a chance of <code>findElementBy&lt;anyoftheoptions&gt;</code> ever working. </p>\n\n<p>That was one of the biggest issues I had was just the lack of understanding enough HTML to get through the web page source quickly and easily enough to make \"light work\" of the project. I did, with enough trial and error, eventually get there though.</p>\n\n<hr>\n\n<p>Also, I'd strongly recommend that you wrap the whole thing in some error handling to be able to catch and gracefully recover from errors. You're dealing with web servers and the internet and general traffic outside the realm of your LAN - there <em>will be</em> timeouts. It would be good for your code to not blow up for things that are well beyond your control.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 10179008, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_YncDqGEozw/AAAAAAAAAAI/AAAAAAAAAFs/fdZm0z-3wks/photo.jpg?sz=128", "display_name": "Massi", "link": "https://stackoverflow.com/users/10179008/massi"}, "edited": false, "score": 0, "creation_date": 1536753163, "post_id": 52294259, "comment_id": 91536574, "body": "With seleniumbasic I use just the string as you wrote         bot.findElementByClassName(&quot;_3WZoe&quot;, timeout:=0, Raise:=False)  it and it works.  The problem is with webdriver."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 10179008, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_YncDqGEozw/AAAAAAAAAAI/AAAAAAAAAFs/fdZm0z-3wks/photo.jpg?sz=128", "display_name": "Massi", "link": "https://stackoverflow.com/users/10179008/massi"}, "edited": false, "score": 0, "creation_date": 1536753219, "post_id": 52294259, "comment_id": 91536614, "body": "Which browser are you using?"}, {"owner": {"reputation": 11, "user_id": 10179008, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_YncDqGEozw/AAAAAAAAAAI/AAAAAAAAAFs/fdZm0z-3wks/photo.jpg?sz=128", "display_name": "Massi", "link": "https://stackoverflow.com/users/10179008/massi"}, "edited": false, "score": 0, "creation_date": 1536753298, "post_id": 52294259, "comment_id": 91536648, "body": "I&#39;m using chrome"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 2, "last_activity_date": 1536760254, "last_edit_date": 1536760254, "creation_date": 1536752358, "answer_id": 52294259, "question_id": 52293093, "link": "https://stackoverflow.com/questions/52293093/selenium-findelement-vba-blocks-the-routine/52294259#52294259", "title": "selenium findelement vba blocks the routine", "body": "<p>A number of the errors I can see make me think you have translated this across from another language, or are working with syntax not designed for current <a href=\"https://github.com/florentbr/SeleniumBasic\" rel=\"nofollow noreferrer\">selenium basic wrapper</a>.</p>\n\n<p>1) For selenium basic the following <code>timeoutms</code> is not a named argument. The correct named argument is <code>timeout</code> so something is odd with your reported error as you should have received a named argument error message.</p>\n\n<p>2) Simply declare as <code>Dim bot As New WebDriver</code> or <code>New ChromeDriver</code> if using Chrome.</p>\n\n<p>3) The correct method with selenium basic is <code>FindElementByClass</code></p>\n\n<hr>\n\n<p>Your <code>sendKeys</code> likely should be focused on a specific element e.g.</p>\n\n<pre><code>bot.findElementByClass(\"C28xL\").SendKeys Text\n</code></pre>\n\n<hr>\n\n<p>You can check whether an element is currently present with</p>\n\n<pre><code>bot.findElementByClass(\"_3WZoe\", timeout:=0, Raise:=False)\n</code></pre>\n\n<p>Again, bearing in mind the point around navigating parent <code>form/frame/iframe</code> tags and wait times.</p>\n\n<hr>\n\n<p>Ensure you are using the latest Chrome browser and <a href=\"https://chromedriver.storage.googleapis.com/index.html?path=2.24/\" rel=\"nofollow noreferrer\">ChromeDriver</a>. The ChromeDriver should be on the <a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/sharepoint-2010/ee537574(v%3Doffice.14)\" rel=\"nofollow noreferrer\">environmental path</a> i.e. in a folder which is on the enviromental path and that the path section (for the driver) should be up to, but not including, the .exe (i.e. to the containing folder level). You can alternatively specify the location to look in for the driver as a statement within the code.</p>\n"}], "owner": {"reputation": 11, "user_id": 10179008, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_YncDqGEozw/AAAAAAAAAAI/AAAAAAAAAFs/fdZm0z-3wks/photo.jpg?sz=128", "display_name": "Massi", "link": "https://stackoverflow.com/users/10179008/massi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 601, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594629262, "creation_date": 1536748353, "last_edit_date": 1594629262, "question_id": 52293093, "link": "https://stackoverflow.com/questions/52293093/selenium-findelement-vba-blocks-the-routine", "title": "selenium findelement vba blocks the routine", "body": "<p>this is my code to open a site and search for objects. It may happen that an object is not found and therefore I have to set up a search on its existence or not, so as to perform or not operations. I'm trying this way but if the object I'm looking for, the routine crashes ....</p>\n\n<pre><code>  Dim bot As New SeleniumWrapper.WebDriver\n  bot.SetProfile \"C:\\Users\\USER\\AppData\\Local\\Google\\Chrome\\User Data\\Default\"\n  bot.start \"chrome\", \"https://website.com/\"\n  bot.Open \"/\"\n  bot.wait 10000\n  bot.findElementByClassName(\"_20NlL\").Click\n  bot.Wait 1000\n  bot.findElementByClassName(\"C28xL\").Click\n  bot.Wait 1200\n  bot.SendKeys text\n  bot.Wait 2000\n  Dim notext As WebElement\n  Set notext = bot.findElementByClassName(\"_3WZoe\", timeoutms:=0)\n  If notext Is Nothing Then\n  ......[this is the error that is shown to me][1]\n</code></pre>\n\n<p>![1]: <a href=\"https://i.stack.imgur.com/wWKzW.jpg\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/wWKzW.jpg</a></p>\n\n<p>what am I wrong?</p>\n\n<p>if I declare bot as webdriver or chromedriver as indicated by QHarr I get this error unfortunately ....</p>\n\n<p>error run-time 33: session not created exception ecc. i'm using chrome 69.0</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10352558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/966b55a58d6aea457b60bdc3b8ea557c?s=128&d=identicon&r=PG&f=1", "display_name": "DLang", "link": "https://stackoverflow.com/users/10352558/dlang"}, "is_accepted": false, "score": 0, "last_activity_date": 1536753401, "creation_date": 1536753401, "answer_id": 52294599, "question_id": 52293077, "link": "https://stackoverflow.com/questions/52293077/vba-copy-data-from-one-workbook-against-reference-in-another/52294599#52294599", "title": "VBA Copy Data from one workbook against reference in another", "body": "<p>I managed it by adding a MATCH option as per the below:</p>\n\n<pre><code>Sub Import()\nDim WB2op As String, CurWB As Workbook, WB2 As Workbook, nextrow As Long\nDim Row As Long\nDim ws As Worksheet\nSet ws = Worksheets(\"Register\")\nSet CurWB = ThisWorkbook\nWB2op = Application.GetOpenFilename _\n(Title:=\"Please choose File\", _\nFileFilter:=\"Excel Files *.xlsx* (*.xlsx*),\")\nIf WB2op = \"False\" Then\n    MsgBox \"No file selected.\", vbExclamation\n    Exit Sub\nElse\nSet WB2 = Workbooks.Open(WB2op)\nWith Sheets(\"Data\")    'change name to suit\n    .Visible = xlSheetVisible\n    .Activate\n    .Range(\"A1\").Select\nEnd With\n\nIf WB2.Sheets(\"Data\").Range(\"A2\") &gt;= 0 Then\nOn Error Resume Next\nRow = Application.WorksheetFunction.Match(WB2.Sheets(\"Data\").Range(\"A2\"), ws.Range(\"A:A\"), 0)\nOn Error GoTo 0\n\nEnd If\n\nApplication.ScreenUpdating = False\nws.Range(\"N\" &amp; Row).Value = WB2.Sheets(\"Data\").Range(\"B2\")\nws.Range(\"O\" &amp; Row).Value = WB2.Sheets(\"Data\").Range(\"C2\")\nws.Range(\"P\" &amp; Row).Value = WB2.Sheets(\"Data\").Range(\"D2\")\nws.Range(\"Q\" &amp; Row).Value = WB2.Sheets(\"Data\").Range(\"E2\")\nws.Range(\"R\" &amp; Row).Value = WB2.Sheets(\"Data\").Range(\"F2\")\nws.Range(\"S\" &amp; Row).Value = WB2.Sheets(\"Data\").Range(\"G2\")\nws.Range(\"T\" &amp; Row).Value = WB2.Sheets(\"Data\").Range(\"H2\")\nws.Range(\"U\" &amp; Row).Value = WB2.Sheets(\"Data\").Range(\"I2\")\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\nEnd If\n</code></pre>\n\n<p>WB2.Close False\nEnd Sub</p>\n"}], "owner": {"reputation": 1, "user_id": 10352558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/966b55a58d6aea457b60bdc3b8ea557c?s=128&d=identicon&r=PG&f=1", "display_name": "DLang", "link": "https://stackoverflow.com/users/10352558/dlang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 15, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1593761105, "creation_date": 1536748303, "last_edit_date": 1593761105, "question_id": 52293077, "link": "https://stackoverflow.com/questions/52293077/vba-copy-data-from-one-workbook-against-reference-in-another", "title": "VBA Copy Data from one workbook against reference in another", "body": "<p>I have browsed the web for an answer but can't find one to help.  What I am trying to do is open a workbook and copy the data from the \"Data\" tab (B2 to I2) into my main workbook under the \"Register\" tab.  The catch is that I need the data to paste against the corresponding reference.  In the workbook I am opening the reference is in A2 and in the existing workbook the reference it needs to look for is in Column A. </p>\n\n<p>I have managed to write a code that pastes the data into the Row number of the reference but that's no good as it has to be the actual value in Column A that it looksup and pastes against.</p>\n\n<p>Any ideas would be greatly appreciated please!</p>\n\n<pre><code>Sub Import()\nDim WB2op As String, CurWB As Workbook, WB2 As Workbook, nextrow As Long\nDim Row As Long\nDim ws As Worksheet\nSet ws = Worksheets(\"Register\")\nSet CurWB = ThisWorkbook\nWB2op = Application.GetOpenFilename _\n(Title:=\"Please choose File\", _\nFileFilter:=\"Excel Files *.xlsx* (*.xlsx*),\")\nIf WB2op = \"False\" Then\n    MsgBox \"No file selected.\", vbExclamation\n    Exit Sub\nElse\nSet WB2 = Workbooks.Open(WB2op)\nWith Sheets(\"Data\")    'change name to suit\n    .Visible = xlSheetVisible\n    .Activate\n    .Range(\"A1\").Select\nEnd With\n\nIf WB2.Sheets(\"Data\").Range(\"A2\") &gt;= 0 Then\nRow = WB2.Sheets(\"Data\").Range(\"A2\") + 1\nEnd If\n\nApplication.ScreenUpdating = False\nws.Range(\"N\" &amp; Row).Value = WB2.Sheets(\"Data\").Range(\"B2\")\nws.Range(\"O\" &amp; Row).Value = WB2.Sheets(\"Data\").Range(\"C2\")\nws.Range(\"P\" &amp; Row).Value = WB2.Sheets(\"Data\").Range(\"D2\")\nws.Range(\"Q\" &amp; Row).Value = WB2.Sheets(\"Data\").Range(\"E2\")\nws.Range(\"R\" &amp; Row).Value = WB2.Sheets(\"Data\").Range(\"F2\")\nws.Range(\"S\" &amp; Row).Value = WB2.Sheets(\"Data\").Range(\"G2\")\nws.Range(\"T\" &amp; Row).Value = WB2.Sheets(\"Data\").Range(\"H2\")\nws.Range(\"U\" &amp; Row).Value = WB2.Sheets(\"Data\").Range(\"I2\")\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\nEnd If\n\nWB2.Close False\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 0, "last_activity_date": 1536751615, "creation_date": 1536751615, "answer_id": 52294053, "question_id": 52292812, "link": "https://stackoverflow.com/questions/52292812/vba-savecopy-function-lose-a-worksheet/52294053#52294053", "title": "VBA SaveCopy function + lose a worksheet", "body": "<p>If I understood you properly try something like this (\"air-coded\" so there may be typos):</p>\n\n<pre><code>Sub Save_copy()\n\n  Dim FileName As String\n\n  With ActiveWorkbook\n\n    [H3] = Format(Now, \"dd.mm.yy_hhmm\")\n    Range(\"H2\").Value = Range(\"H1\").Value\n\n    FileName = \"SERVICE \" &amp; _\n               Range(\"H1\").Value &amp; _\n               \" - \" &amp; Format(Now, \"dd.mm.yy\") &amp; _\n               \"_\" &amp; Format(Now, \"hhmm\") &amp; _\n               \".\" &amp; Right(.Name, Len(.Name) - InStrRev(.Name, \".\"))\n\n    .SaveCopyAs \"G:\\SERVICE\\\" &amp; FileName\n  End With\n\n  Dim newWorkbook As Excel.Workbook\n  Set newWorkbook = Workbooks.Open(\"G:\\service\\\" &amp; FileName)\n  newWorkbook.Worksheets(\"A\").Delete\n  newWorkbook.Close True\n\n  Reset\n\nEnd Sub\n</code></pre>\n\n<p>Additionally, a couple of coding tips:</p>\n\n<ul>\n<li>There's no need for <code>Call</code> - that function is deprecated and only exists to keep ancient code from blowing up</li>\n<li>There is an extra concatenation of the <code>\"\\\"</code> in your <code>.SaveCopyAs</code> line - simply put the trailing slash in with the rest of the path (as I did).</li>\n<li>The unqualified <code>Range(\"H2\")</code> refers to the <code>ActiveWorksheet</code> and could blow up on you if your user ever happens to click on a different worksheet while your code is running</li>\n</ul>\n"}], "owner": {"reputation": 121, "user_id": 7114770, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ed6bd8b2b439e3160072b374dafa2a79?s=128&d=identicon&r=PG&f=1", "display_name": "dotsent12", "link": "https://stackoverflow.com/users/7114770/dotsent12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1536751615, "creation_date": 1536747424, "question_id": 52292812, "link": "https://stackoverflow.com/questions/52292812/vba-savecopy-function-lose-a-worksheet", "title": "VBA SaveCopy function + lose a worksheet", "body": "<p>I created an Excel 2016-based template, which the user can fill and create a work form based on it. User inserts an unique ID and with basic <code>INDEX&amp;MATCH</code> formulas some ID-related parameters are being fetched from separate worksheet <code>a</code>. The work form is created with VBA-macro using <code>SaveCopyAs</code> method.</p>\n\n<p>After the parameters have been fetched and VBA is launched to create the work form the ID will not change anymore. Thus, I don't need the whole worksheet <code>a</code> anymore and would like to drop it to keep the work form more lightweight. I'm capable of retaining the fetched parameters, so this is not a problem.</p>\n\n<p>I would NOT want the user to have to re-open the form every single time a work form is created, so I don't want the VBA to remove worksheet <code>a</code> from the template itself, as even though the user can't save changes to the template, (s)he would have to re-open the template file every time a work form has to be created.</p>\n\n<p>Any idea if something could be done? Might it be possible to somehow run <code>SaveCopyAs</code> or similar method, but drop the worksheet <code>a</code> at the same time from the new target file? Having <code>INDEX&amp;MATCH</code> formula fetch the needed information from another workbook would theoretically work but to my knowledge requires the other workbook to be open at all times which will undoubtedly start to cause unnecessary issues.</p>\n\n<p>My current VBA for work form creating is something like this:</p>\n\n<pre><code>Sub Save_copy()\n\nDim FileName As String\n\nWith ActiveWorkbook \n\n[H3] = Format(Now, \"dd.mm.yy_hhmm\")\nRange(\"H2\").Value = Range(\"H1\").Value\n\n  FileName = \"SERVICE \" &amp; _\n        Range(\"H1\").Value &amp; _\n        \" - \" &amp; Format(Now, \"dd.mm.yy\") &amp; _\n        \"_\" &amp; Format(Now, \"hhmm\") &amp; _\n        \".\" &amp; Right(.Name, Len(.Name) - InStrRev(.Name, \".\"))\n\n  .SaveCopyAs \"G:\\SERVICE\" &amp; \"\\\" &amp; FileName\nEnd With\n\nCall Reset\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "file", "date"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1536748760, "post_id": 52292584, "comment_id": 91534133, "body": "Instead of giving a specific file name, try changing to a file type (i.e. set <code>MyPath</code> as : <b><code>MyPath = &quot;C:\\Users\\topal\\Desktop\\Spreaddeterminierung\\*.xls&quot;</code></b>). You can then check in your <code>Do</code> loop if the current file is the one you are looking for"}], "answers": [{"comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1536749759, "post_id": 52293229, "comment_id": 91534712, "body": "Good shout on <code>regex</code>!"}, {"owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "edited": false, "score": 0, "creation_date": 1536826822, "post_id": 52293229, "comment_id": 91566013, "body": "A good idea with the reaggranging. However, I noticed that Dates starting with a Zero as first figure such as 020718, the&quot;tempDate&quot; Shows it as &quot;20718&quot;. That, of Course leads to the end rearranged figure &quot;207118&quot;, which cannot be found. I have tried to Change the figure in the &quot;ReArrange&quot; section but didnt help much."}, {"owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "edited": false, "score": 0, "creation_date": 1536844165, "post_id": 52293229, "comment_id": 91576041, "body": "That solution works perfectly. My solution was to declare: dteFile As String (not as long), tempDate As String (not as long) and (ByVal fileName As String) As String (not as date). And it worked too. Great. Thank you for your part of the solution and for your effort."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536844484, "post_id": 52293229, "comment_id": 91576231, "body": "Thank you for putting me through my paces!"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1536843042, "last_edit_date": 1536843042, "creation_date": 1536748850, "answer_id": 52293229, "question_id": 52292584, "link": "https://stackoverflow.com/questions/52292584/vba-open-the-most-recent-file-in-a-folder/52293229#52293229", "title": "vba open the most recent file in a folder", "body": "<p>You could loop the folder and extract the date part of the string and store the greatest value for use to identify the file. The following also applied a file mask of <code>\"xlsx\"</code> which you can remove or change. It uses a regex to find qualifying filenames according to your stated pattern.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub GetLastestDateFile()\n    Dim FileSys As Object, objFile As Object, myFolder As Object, strFile As String, dteFile As Long\n    Const myDir As String = \"C:\\Users\\User\\Desktop\\TestFolder\"\n    Set FileSys = CreateObject(\"Scripting.FileSystemObject\")\n    Set myFolder = FileSys.GetFolder(myDir)\n\n    Dim fileName As String, tempDate As Long, fileMask As String\n\n    dteFile = 0: fileMask = \"xlsx\"\n    For Each objFile In myFolder.Files\n        If FileSys.GetExtensionName(objFile.Path) = fileMask And ValidateFile(Split(objFile.Name, \".xlsx\")(0)) Then\n            tempDate = GetDateFromFileName(objFile.Name)\n            Dim pseudoDate As String\n            pseudoDate = ReArrange(tempDate)\n            If pseudoDate &gt; dteFile Then dteFile = pseudoDate\n        End If\n    Next objFile\n    If Not tempDate = 0 Then Workbooks.Open (myDir &amp; \"\\\" &amp; \"Fundings \" &amp; Format$(ReArrange(dteFile), \"000000\") &amp; \".\" &amp; fileMask)\nEnd Sub\n\nPublic Function ReArrange(ByVal tempDate As String) As String\n    tempDate = Format$(tempDate, \"000000\")\n    ReArrange = Format$(Right$(tempDate, 2), \"00\") &amp; Format$(Mid$(tempDate, 3, 2), \"00\") &amp; Format$(Left$(tempDate, 2), \"00\")\nEnd Function\n\nPublic Function ValidateFile(ByVal fileName As String) As Boolean\n    With CreateObject(\"VBScript.RegExp\")\n        .Global = True\n        .MultiLine = True\n        .Pattern = \"Fundings\\s\\d{6}$\"\n        ValidateFile = .test(fileName)\n    End With\nEnd Function\n\nPublic Function GetDateFromFileName(ByVal fileName As String) As Date\n    On Error GoTo errhand\n    GetDateFromFileName = Split(Split(fileName, \"Fundings \")(1), \".\")(0)\n    Exit Function\nerrhand:\n    GetDateFromFileName = 0\nEnd Function\n</code></pre>\n\n<hr>\n\n<p><strong>Regex:</strong></p>\n\n<p>Try the regex <a href=\"https://regex101.com/r/NWzQbl/1\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Explanation:</p>\n\n<pre><code>Fundings\\s\\d{6}$\n/\ngm\n</code></pre>\n\n<p><code>Fundings</code> matches the characters <code>Fundings</code> literally (case sensitive)</p>\n\n<p><code>\\s</code> matches any whitespace character (equal to <code>[\\r\\n\\t\\f\\v ]</code>)</p>\n\n<p><code>\\d{6}</code> matches a digit (equal to <code>[0-9]</code>)</p>\n\n<p><code>{6}</code> Quantifier \u2014 Matches exactly 6 times</p>\n\n<p><code>$</code> asserts position at the end of a line</p>\n"}, {"tags": [], "owner": {"reputation": 30, "user_id": 10279172, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ra-I3s2eLag/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOBT2lfUriSm7tcFGA85DhgPnNqMw/mo/photo.jpg?sz=128", "display_name": "\u0141ukasz Ryka\u0142a", "link": "https://stackoverflow.com/users/10279172/%c5%81ukasz-ryka%c5%82a"}, "is_accepted": false, "score": 1, "last_activity_date": 1536748961, "creation_date": 1536748961, "answer_id": 52293257, "question_id": 52292584, "link": "https://stackoverflow.com/questions/52292584/vba-open-the-most-recent-file-in-a-folder/52293257#52293257", "title": "vba open the most recent file in a folder", "body": "<p>Your loop from:</p>\n\n<blockquote>\n  <p>'Loop through each Excel file in the folder  Do While Len(MyFile) > 0</p>\n\n<pre><code> 'Assign the date/time of the current file to a variable\n LMD = Date\n\n 'If the date/time of the current file is greater than the latest\n 'recorded date, assign its filename and date/time to variables\n If LMD &gt; LatestDate Then\n     LatestFile = MyFile\n     LatestDate = LMD\n End If\n\n 'Get the next Excel file from the folder\n MyFile = Dir\n</code></pre>\n</blockquote>\n\n<p>This one is doesn't do anything thats why you getting empty values or no action.</p>\n\n<p>I reccomend to totaly change you point of think and try to implement something like this:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/20885129/vba-search-through-a-folder-and-select-files-by-name\">vba search through a folder and select files by name</a></p>\n"}], "owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5934, "favorite_count": 0, "accepted_answer_id": 52293229, "answer_count": 2, "score": 1, "last_activity_date": 1536843042, "creation_date": 1536746684, "question_id": 52292584, "link": "https://stackoverflow.com/questions/52292584/vba-open-the-most-recent-file-in-a-folder", "title": "vba open the most recent file in a folder", "body": "<p>There are some exel files in a Folder. The aim is to search for the file with the highest date (in the Format: Fundings \" &amp; Format(LMD, \"DDMMYY\") &amp; \".xls) and open it. E.g. the file names are Fundings 270818, Fundings 110618 and the most recent would be the first one. The code below runs into the error that the \"MyFile = Dir(MyPath, vbNormal)\" is empty.</p>\n\n<pre><code> Dim MyPath  As String\n Dim MyFile  As String\n Dim LatestFile  As String\n Dim LatestDate  As Date\n Dim LMD  As Date\n\n LMD = Date\n\n 'Specify the path to the folder\n MyPath = \"C:\\Users\\topal\\Desktop\\Spreaddeterminierung\\Fundings \" &amp; Format(LMD, \"DDMMYY\") &amp; \".xls\"\n\n\n\n 'Get the first Excel file from the folder\n MyFile = Dir(MyPath, vbNormal)\n\n 'If no files were found, exit the sub\n If Len(MyFile) = 0 Then\n     MsgBox \"No Sir\", vbExclamation\n     Exit Sub\n End If\n\n 'Loop through each Excel file in the folder\n Do While Len(MyFile) &gt; 0\n\n     'Assign the date/time of the current file to a variable\n     LMD = Date\n\n     'If the date/time of the current file is greater than the latest\n     'recorded date, assign its filename and date/time to variables\n     If LMD &gt; LatestDate Then\n         LatestFile = MyFile\n         LatestDate = LMD\n     End If\n\n     'Get the next Excel file from the folder\n     MyFile = Dir\n\n Loop\n\n 'Open the latest file\n Workbooks.Open MyPath\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "merge"], "answers": [{"tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": false, "score": 0, "last_activity_date": 1536760891, "creation_date": 1536760891, "answer_id": 52297041, "question_id": 52292574, "link": "https://stackoverflow.com/questions/52292574/defining-a-range-for-2-private-subs-that-have-been-merged/52297041#52297041", "title": "Defining a range for 2 private subs that have been merged", "body": "<p>Your sorting command is fine though it is pretty complicated because it compresses a series of operations in one command. With this command you sort a range from column A to column K (=11) and from row 1 to last used row, with header. You could split this command with these simpler ones: </p>\n\n<pre><code>Dim lastrow As Long\nDim r As Range\n\nlastrow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row ' find row of last non-blank cell in column A\nSet r = Range(\"A1\").Resize(lastrow, 11)   ' set the exact data range\nr.Sort key1:=Range(\"I1\"), order1:=xlAscending, Header:=xlYes\n</code></pre>\n\n<p>but this will do the same as in your code 2. </p>\n\n<p>You might need to know that if you break the command into 2 lines you need to terminate the line with an <code>_</code> like this: </p>\n\n<pre><code>Range(\"A1\", Range(\"A\" &amp; Rows.Count).End(xlUp)).Resize(, 11).Sort _\n    key1:=Range(\"I1\"), order1:=xlAscending, Header:=xlYes\n</code></pre>\n\n<p>otherwise the compiler will treat them as separate commands and will drop a Syntax error message. </p>\n"}], "owner": {"reputation": 49, "user_id": 9966484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c3f4d8a05e0e74d793146a3d52dbc9f?s=128&d=identicon&r=PG&f=1", "display_name": "DMO", "link": "https://stackoverflow.com/users/9966484/dmo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536760891, "creation_date": 1536746655, "question_id": 52292574, "link": "https://stackoverflow.com/questions/52292574/defining-a-range-for-2-private-subs-that-have-been-merged", "title": "Defining a range for 2 private subs that have been merged", "body": "<p>I have 2 private subs that have been merged into the code below. the 2nd part of the code i need to define the logic for the range. The issue i am facing is my second code does not specify a range so i am unsure on how to define the range? and my VBA knowledge is not that great!  can someone help me enter this information? </p>\n\n<p>The Codes before merging are: </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim rng As Range, cel As Range\n    Set rng = Intersect(Target, Range([H2], Cells(Rows.Count, \n    \"H\").End(xlUp)))\n\n    If rng Is Nothing Then Exit Sub\n    Application.EnableEvents = False\n    rng.Offset(, 1).FormulaR1C1 = \"=IF(RC[-1]&lt;&gt;\"\"\"\",R1C[6] &amp; \"\"-\"\" &amp;\" &amp; \n    \"TEXT(COUNTA(R2C[-1]:RC[-1]),\"\"0000\"\") &amp; \"\"-\"\" &amp; R1C[7],\"\"\"\")\"\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Code 1 is using P1 and O1 to populate an automatic number in column I if information is provided in H Code 2:</p>\n\n<pre><code>Private Sub Move_blanks_To_Bottom(ByVal Target As Range)\n   If Target.CountLarge &gt; 1 Then Exit Sub\n   If Target.Column &lt;&gt; 9 Then Exit Sub\n   Range(\"A1\", Range(\"A\" &amp; Rows.Count).End(xlUp)).Resize(, 11).Sort \n   key1:=Range(\"I1\"), order1:=xlAscending, Header:=xlYes\nEnd Sub\n</code></pre>\n\n<p>Code 2 is using column I and sorting the values so if there is a value in I it moves the row to the next available line where column I is completed effectively if cell I is blank the row is moved to the bottom.</p>\n\n<p>The merged code is: </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n   Application.EnableEvents = False\n\n  'Do logic for this first range\n   Dim rng As Range, cel As Range\n   Set rng = Intersect(Target, Range([H2], Cells(Rows.Count, \n   \"H\").End(xlUp)))\n   If Not Intersect(rng, Target) Is Nothing Then\n      rng.Offset(, 1).FormulaR1C1 = \"=IF(RC[-1]&lt;&gt;\"\"\"\",R1C[6] &amp; \"\"-\"\" &amp;\" &amp; \n      \"TEXT(COUNTA(R2C[-1]:RC[-1]),\"\"0000\"\") &amp; \"\"-\"\" &amp; R1C[7],\"\"\"\")\"\n   End If\n\n  'now do logic for the second range (move_blanks_to_bottom)\n   '2nd LOGIC HERE\n   If Target.CountLarge = 1 And Target.Column = 9 Then\n        Range(\"A1\", Range(\"A\" &amp; Rows.Count).End(xlUp)).Resize(, 11).Sort \n        key1:=Range(\"I1\"), order1:=xlAscending, Header:=xlYes\n  End If\n\n  Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Thank you! </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1536749614, "post_id": 52292558, "comment_id": 91534637, "body": "Many ways.  <b>1:</b> Clear the target sheet and redo the whole table. <b>2:</b> Add <code>ID</code> column to original data; check last ID in target before starting the copy and start the testing after that ID.  <b>3:</b> Copy from beginning of table, but run <code>RemoveDuplicates</code> after the operation.  #2 will probably be the most efficient."}], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 10351957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhPLN.jpg?s=128&g=1", "display_name": "Hamed", "link": "https://stackoverflow.com/users/10351957/hamed"}, "is_accepted": false, "score": 0, "last_activity_date": 1536751954, "last_edit_date": 1536751954, "creation_date": 1536750780, "answer_id": 52293810, "question_id": 52292558, "link": "https://stackoverflow.com/questions/52292558/copying-data-with-command-button-without-duplicates-in-excel/52293810#52293810", "title": "Copying data with command button without duplicates in Excel", "body": "<p>You can use remove duplicate procedure. I do some edits you can see below:</p>\n\n<p>Sub MyCammand()</p>\n\n<pre><code>Dim AllSheet As Worksheet\nDim LendSheet As Worksheet\nDim LastRow As Integer\nDim RowCnt As Integer\nDim DestRow As Integer\n\nSet AllSheet = ActiveWorkbook.Sheets(\"All\")\nSet LendSheet = ActiveWorkbook.Sheets(\"Lending\")\n\nWith AllSheet\n    LastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n    DestRow = LendSheet.Range(\"A\" &amp; LendSheet.Rows.Count).End(xlUp).Row + 1\n    For RowCnt = 2 To LastRow\n        If .Cells(RowCnt, 3).Value = \"X\" Or .Cells(RowCnt, 3).Value = \"x\" Then\n            LendSheet.Rows(DestRow).Value = .Rows(RowCnt).Value\n            DestRow = DestRow + 1\n        End If\n    Next\nEnd With\n'..... Remove Duplicates\nDim LastCol As String\nWith LendSheet\n    LastCol = Split(.Range(\"A1\").End(xlToRight).Address, \"$\")(1)\n    .Range(\"A:\" &amp; LastCol).RemoveDuplicates Columns:=Array(1, 2, 3, 4, 5, 6, 7), Header:=xlYes\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 11, "user_id": 10352450, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-S8Q7q18l_oY/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMalGRWN8LE9dENNlJrgjY20z2TSQ/mo/photo.jpg?sz=128", "display_name": "Simon Kaldau", "link": "https://stackoverflow.com/users/10352450/simon-kaldau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1536756995, "creation_date": 1536746600, "last_edit_date": 1536756995, "question_id": 52292558, "link": "https://stackoverflow.com/questions/52292558/copying-data-with-command-button-without-duplicates-in-excel", "title": "Copying data with command button without duplicates in Excel", "body": "<p>I made a command button to tranfer data from one worksheet to another, if conditions are met. I would like to ask how I can prevent the button from making duplicates if I use it multiple times. For example: if I add additional data to the first sheet that I need copied. Down below is the code i used for the button. </p>\n\n<pre><code>Private Sub CommandButton1_Click()\nA = Worksheets(\"All\").Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = 2 To A\n\nIf Worksheets(\"All\").Cells(i, 3).Value = \"X\" Then\n\n    Worksheets(\"All\").Rows(i).Copy\n    Worksheets(\"Lending\").Activate\n    b = Worksheets(\"Lending\").Cells(Rows.Count, 1).End(xlUp).Row\n    Worksheets(\"Lending\").Cells(b + 1, 1).Select\n    ActiveSheet.Paste\n    Worksheets(\"All\").Activate\n\n    End If\n   Next\n\n Application.CutCopyMode = False\n\nThisWorkbook.Worksheets(\"All\").Cells(1, 1).Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1536750132, "post_id": 52292222, "comment_id": 91534918, "body": "hi, does your variable <b>lUserID</b> have a value ? and the variable its <b>lUserID</b> or just <b>UserID</b>. good luck"}], "owner": {"reputation": 51, "user_id": 9648517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T82bC.jpg?s=128&g=1", "display_name": "RAKY", "link": "https://stackoverflow.com/users/9648517/raky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 213, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1536746194, "creation_date": 1536745644, "last_edit_date": 1536746194, "question_id": 52292222, "link": "https://stackoverflow.com/questions/52292222/what-are-the-resons-for-the-run-time-error-5631-how-to-fix-this-problem", "title": "What are the resons for the run time error 5631? How to fix this problem?", "body": "<p>I'm trying to implement a routine that fills out a Word-template with data saved on a SQL-Server. I've got the error \"5631\" <em>[Word could not merge the main document with the data source because data records were empty or no data records matched your query options\"]</em> points at \".Execution pause:=false\" </p>\n\n<p>I really couldn't figure out the reason for this Problem. Thank you for any help.</p>\n\n<p>Here is the code snippet:</p>\n\n<pre><code>Set wrdApp = CreateObject(\"Word.Application\")\n        With wrdApp\n            Set wrdDoc = .Documents.Add(sTemplate, False)\n            With wrdDoc.MailMerge\n                .MainDocumentType = wdFormLetters\n                .OpenDataSource Name:=\"d:\\connect.odc\" _\n                    , ConfirmConversions:=False _\n                    , ReadOnly:=False _\n                    , LinkToSource:=False _\n                    , AddToRecentFiles:=False _\n                    , Revert:=False _\n                    , Format:=wdOpenFormatAuto _\n                    , Connection:=EPLconnectWord(bAcc) _\n                    , SQLStatement:=\"SELECT * FROM [\" &amp; sTable &amp; \"] WHERE [UserID] = \" &amp; lUserID _\n                    , SQLStatement1:=\"\" _\n                    , SubType:=wdMergeSubTypeOther\n\n                If .State = wdMainAndSourceAndHeader Or .State = wdMainAndDataSource Then\n                    .ViewMailMergeFieldCodes = False\n                End If\n                .Destination = wdSendToNewDocument\n                .SuppressBlankLines = True\n                With .DataSource\n                    .FirstRecord = wdDefaultFirstRecord\n                    .LastRecord = wdDefaultLastRecord\n                End With\n                .Execute Pause:=False\n                wrdDoc.ActiveWindow.View.ShowFieldCodes = False\n                wrdDoc.Close wdDoNotSaveChanges\n            End With ' wrdDoc.MailMerge\n</code></pre>\n"}, {"tags": ["sql", "security", "ms-access", "database-design", "vba"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1536746075, "post_id": 52292090, "comment_id": 91532504, "body": "Review <a href=\"https://stackoverflow.com/q/49946592/7296893\">ms access; how to move it into inaccessible state / DSN-less table without password</a>. Note that I consider the accepted answer there to be wrong on several notes, promoting obfuscation and pseudosecurity instead of true security and being vague about it."}, {"owner": {"reputation": 704, "user_id": 4999393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae8b5ed2ea0bdebd8989c9122f6c7c22?s=128&d=identicon&r=PG&f=1", "display_name": "Jericho Johnson", "link": "https://stackoverflow.com/users/4999393/jericho-johnson"}, "edited": false, "score": 0, "creation_date": 1536746948, "post_id": 52292090, "comment_id": 91533042, "body": "Please clarify - your backend is an Access database file, correct? How is it &quot;protected&quot; now? With an Access database password? If you did have a SQL Server backend, you could use <a href=\"https://stackoverflow.com/a/51792639/4999393\">Linked Tables without saving password</a>"}, {"owner": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "reply_to_user": {"reputation": 704, "user_id": 4999393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae8b5ed2ea0bdebd8989c9122f6c7c22?s=128&d=identicon&r=PG&f=1", "display_name": "Jericho Johnson", "link": "https://stackoverflow.com/users/4999393/jericho-johnson"}, "edited": false, "score": 0, "creation_date": 1536748460, "post_id": 52292090, "comment_id": 91533953, "body": "Thanks Erik - would your Design Lock work in an ACCDE file? Or would I need to re-convert back to ACCDB to make this work? To clarify @JerichoJohnson - it is an encrypted ACCDB Access file. The back end is encrypted with a password to open it. That&#39;s the plan, but until the political situation delivers SQL Server (which would probably also deliver Visual Studio) - our hands are tied sadly."}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1536749794, "post_id": 52292090, "comment_id": 91534730, "body": "You&#39;re using Access as a front-end and a dev tool. Security should be implemented at the server level. This problem is analogous to complaining that Visual Studio is insecure because someone can use it to write code to access a database: the database should be secured."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1536750664, "post_id": 52292090, "comment_id": 91535193, "body": "@RazorKillBen It indeed only works in an accdb. I haven&#39;t yet found a reliable workaround. However, your problem occurs even when closed, and you&#39;ll need a fundamentally different approach. Linked tables should be considered public information. While Albert&#39;s answer doesn&#39;t alleviate the true problem (that a password will have to be stored somewhere accessible to the database or the database has to be password-protected), it makes it considerably more difficult to exploit."}, {"owner": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1536751388, "post_id": 52292090, "comment_id": 91535598, "body": "Yes nicomp I understand that, but the back-end is secured and encrypted. I was shocked that a fresh new database import of the front-end, would carry over passwords and the like. @ErikvonAsmuth - it&#39;s a really good solution, just so unfortunate it doesn&#39;t work with ACCDE. I agree fully with your valuation of Albert&#39;s answer - it relies as far as I can see, on the user supplying details anyway which is counter-productive to the problem. I think you&#39;re right - the better way around this will be to have no linked tables and send queries to the database from the VBA."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1536751765, "post_id": 52292090, "comment_id": 91535815, "body": "@RazorKillBen Albert&#39;s answer does offer a way to create a connection without passwords based on a password stored in code. That should be about as secure as using queries from VBA: both require the password to be stored in code, which leaves your password vulnerable to someone that can decompile and reverse-engineer. That &quot;solution&quot; at the end of my code similarly shouldn&#39;t be used: it&#39;s pseudosecurity and unsafe too."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 2, "creation_date": 1536751837, "post_id": 52292090, "comment_id": 91535854, "body": "My point is: if you&#39;re giving someone an accde that connects to an external server using a password, you&#39;re giving them that password. You can do several things to make it difficult for them to figure that out, but they still have it."}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1536754264, "post_id": 52292090, "comment_id": 91537295, "body": "Sorry, I&#39;m not meaning to pick on you. Access is great for prototyping but it hasn&#39;t kept pace with the growth of technology and all us Access developers pay the price for that."}, {"owner": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "reply_to_user": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 1, "creation_date": 1536755388, "post_id": 52292090, "comment_id": 91537940, "body": "Not at all @nicomp - I fully understand. Unfortunately, it&#39;s the same here; SQL Server team are scared to let us put an Access FE over the server due to security (understandable) but the other teams don&#39;t want us to have Visual Studio because of... security, so we&#39;re left with the least secure solution. Unfortunately, I&#39;m stuck trying to stick a plaster over an axe-wound, and expected to come up with a cheap perfect solution, which I knew from the start wasn&#39;t going to happen. Still, perhaps the security flaw here may fuel the argument for leaving Access behind, so appreciate both of you."}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 2, "creation_date": 1536759559, "post_id": 52292090, "comment_id": 91541006, "body": "@RazorKillBen Getting meta for a moment: you are not being given the tools to do your job properly. I guess we all live that!"}], "owner": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 544, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1536745268, "creation_date": 1536745268, "question_id": 52292090, "link": "https://stackoverflow.com/questions/52292090/prevent-access-linked-tables-being-imported-into-new-database", "title": "Prevent Access linked tables being imported into new database", "body": "<p>I'm sure this particular problem has existed for quite some time, but unfortunately, no amount of searching anywhere on here or the internet, has lead me to a solution (scarily!).</p>\n\n<p>I have a setup of multiple front-ends to a back end database, that's working just fine. I'm attempting to get IT to hand over the SQL Server access we're so desperate for, but until then, we have to secure what we can within the Access database.</p>\n\n<p>The back-end is protected, and the front end is locked down with bypass keys disabled, etc, but isn't encrypted (so the user can open it).</p>\n\n<p>The front end contains linked tables to the back end, so that DLookups can work, but it turns out that by doing so exposes a huge security issue.</p>\n\n<p>If the user creates a new database, they can import all the linked tables and queries from the front end (the wizard prevents the forms and modules coming over from the executable file) and not only have access to the protected data, but they can actually manipulate the data too as it's linked.</p>\n\n<p>Surely, this isn't a gigantic flaw in MS Access and I'm missing something here?</p>\n\n<p>How can I secure the database from this type of security issue, without hopefully, having to go through and change every DLookup variable to a variable looking at a connection string SELECT query?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 1, "creation_date": 1536743961, "post_id": 52291586, "comment_id": 91531171, "body": "Is VBA a must? You have several options in plain Excel that will do this for you, like CountIf and Pivot tables."}, {"owner": {"reputation": 542, "user_id": 620321, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0c92f14b84ee7346608e3144994093c?s=128&d=identicon&r=PG", "display_name": "pomaaa", "link": "https://stackoverflow.com/users/620321/pomaaa"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1536744039, "post_id": 52291586, "comment_id": 91531221, "body": "Unfortunately it is a must, since it has to be a Button and when it&#39;s clicked, the SUM will be calculated."}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1536745218, "post_id": 52291586, "comment_id": 91531955, "body": "Having the results automatically calculated with an Excel formula and just showing/hiding them with the button is not an option?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1536750008, "post_id": 52291586, "comment_id": 91534850, "body": "You could still use a Pivot Table.  And have your button execute the <code>Refresh</code> option."}, {"owner": {"reputation": 542, "user_id": 620321, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0c92f14b84ee7346608e3144994093c?s=128&d=identicon&r=PG", "display_name": "pomaaa", "link": "https://stackoverflow.com/users/620321/pomaaa"}, "edited": false, "score": 0, "creation_date": 1536750250, "post_id": 52291586, "comment_id": 91534968, "body": "I do know all the other options, however it has to be a VBA, as it is for creating a dashboard with many other functions."}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536746654, "post_id": 52292162, "comment_id": 91532864, "body": "Why the downvote on a helpful answer and a more efficient code example? #Salty"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1536750154, "post_id": 52292162, "comment_id": 91534927, "body": "Good point to treat the zero and one item case, too +1). -  BTW, unexplained downvoting (of efficient code) isn&#39;t helpful for anybody"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1536750187, "post_id": 52292162, "comment_id": 91534939, "body": "@T.M. Thanks for that."}, {"owner": {"reputation": 542, "user_id": 620321, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0c92f14b84ee7346608e3144994093c?s=128&d=identicon&r=PG", "display_name": "pomaaa", "link": "https://stackoverflow.com/users/620321/pomaaa"}, "edited": false, "score": 1, "creation_date": 1536751558, "post_id": 52292162, "comment_id": 91535697, "body": "It&#39;s a nice and more efficient solution, I have added +1 :)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536918558, "post_id": 52292162, "comment_id": 91605436, "body": "Is this now answered?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1536750262, "last_edit_date": 1536750262, "creation_date": 1536745486, "answer_id": 52292162, "question_id": 52291586, "link": "https://stackoverflow.com/questions/52291586/how-to-sum-row-values-by-category/52292162#52292162", "title": "How to sum row values by category", "body": "<p>Using a dictionary is a common method. The below handles blanks in range, also if only 1 item present. It doesn't need an <code>.Exists</code> test as simply adds to any existing value by direct access. Also, writes arrays of keys, items out in one go.</p>\n\n<pre><code>Option Explicit\nPublic Sub GetTotals()\n    Dim dict As Object, arr(), i As Long, lastRow As Long\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n    With ThisWorkbook.Worksheets(\"Sheet1\")       '&lt;==source data\n        lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        Select Case lastRow\n        Case 1\n            ReDim arr(1, 1): arr(1, 1) = .Range(\"A1:B1\").Value\n        Case Else\n            arr = .Range(\"A1:B\" &amp; lastRow).Value\n        End Select\n    End With\n\n    For i = LBound(arr, 1) To UBound(arr, 1)\n        If Not IsEmpty(arr(i, 1)) Then\n            dict(arr(i, 1)) = dict(arr(i, 1)) + arr(i, 2)\n        End If\n    Next\n    With ThisWorkbook.Worksheets(\"Sheet2\")\n        .Range(\"A1\").Resize(dict.Count, 1) = Application.WorksheetFunction.Transpose(dict.keys)\n        .Range(\"B1\").Resize(dict.Count, 1) = Application.WorksheetFunction.Transpose(dict.Items)\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Results:</p>\n\n<p><a href=\"https://i.stack.imgur.com/RQUVH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RQUVH.png\" alt=\"data\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1536747893, "post_id": 52292167, "comment_id": 91533601, "body": "Scripting Dictionary should be in inverted commas  like this :-                  Set d = CreateObject(&quot;Scripting.Dictionary&quot;)"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1536749206, "post_id": 52292167, "comment_id": 91534412, "body": "Oh, yeah, I just quickly threw together something and didn&#39;t really test it after switching to late binding. Thanks for the correction! @anthony"}], "tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": false, "score": 1, "last_activity_date": 1536749217, "last_edit_date": 1536749217, "creation_date": 1536745497, "answer_id": 52292167, "question_id": 52291586, "link": "https://stackoverflow.com/questions/52291586/how-to-sum-row-values-by-category/52292167#52292167", "title": "How to sum row values by category", "body": "<p>If you don't know how many categories you'll have before trying to sum them, something like this could be a solution:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n    Dim d As Object\n    Set d = CreateObject(\"Scripting.Dictionary\")\n\n    Dim s As String, key_value As String\n    Dim v As Variant\n    Dim num As Long\n\n    Dim r As Range, c As Range\n    Set r = Sheet1.Range(Sheet1.Range(\"A2\"), Sheet1.Range(\"A\" &amp; Sheet1.Rows.Count).End(xlUp))\n\n    For Each c In r\n        key_value = CStr(c)\n        num = CLng(c.Offset(0, 1))\n\n        If d.Exists(key_value) Then\n            d(key_value) = d(key_value) + num\n        Else\n            d.Add Key:=key_value, Item:=num\n        End If\n    Next c\n\n    For Each v In d\n        s = s &amp; CStr(v) &amp; vbTab &amp; CStr(d(v)) &amp; vbLf\n    Next v\n\n    MsgBox prompt:=s, Title:=\"Summation\", Buttons:=vbInformation\nEnd Sub\n</code></pre>\n\n<p>If you know what categories you'll have in advance, just making some <code>sumif</code> formulas based on those would probably be simpler.</p>\n"}], "owner": {"reputation": 542, "user_id": 620321, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0c92f14b84ee7346608e3144994093c?s=128&d=identicon&r=PG", "display_name": "pomaaa", "link": "https://stackoverflow.com/users/620321/pomaaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 52292162, "answer_count": 2, "score": 1, "last_activity_date": 1536750262, "creation_date": 1536743626, "last_edit_date": 1536746132, "question_id": 52291586, "link": "https://stackoverflow.com/questions/52291586/how-to-sum-row-values-by-category", "title": "How to sum row values by category", "body": "<p>So I have got the following table in Excel for example (it actually has 100+ rows):</p>\n\n<pre><code>Alfa     10\nBeta     5\nAlfa     10\nBeta     5\nGama     15\n</code></pre>\n\n<p>What I would like to do is SUM values by the name (category) using VBA Macro, so I can display it somewhere in the Sheet like this:</p>\n\n<pre><code>AlfaTotal     20\nBetaTotal     10\nGamaTotal     15\n</code></pre>\n\n<p>I have tried using For Each function but am not able to get to the values. Any help would be much appreciated.</p>\n"}, {"tags": ["excel", "vba", "vb.net"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7978226"}, "edited": false, "score": 0, "creation_date": 1536744226, "post_id": 52291564, "comment_id": 91531340, "body": "See this link : <a href=\"https://www.e-iceblue.com/Knowledgebase/Spire.XLS/Program-Guide/How-to-Create-Pivot-Table-in-Excel-with-C-/VB.NET.html\" rel=\"nofollow noreferrer\">e-iceblue.com/Knowledgebase/Spire.XLS/Program-Guide/&hellip;</a>"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1536744257, "post_id": 52291564, "comment_id": 91531365, "body": "What do you have so far? The method is the exact same and in the interop you have the <code>xlTabularRow</code> constant. <a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.office.interop.excel.pivottable.rowaxislayout?view=excel-pia\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/api/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 315, "user_id": 6923139, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/c4f55643b357a8a86f6c54263ea56301?s=128&d=identicon&r=PG&f=1", "display_name": "programer Anel", "link": "https://stackoverflow.com/users/6923139/programer-anel"}, "is_accepted": true, "score": 0, "last_activity_date": 1537473310, "creation_date": 1537473310, "answer_id": 52432398, "question_id": 52291564, "link": "https://stackoverflow.com/questions/52291564/axis-layout-to-tabular-vba-to-vb-net/52432398#52432398", "title": "Axis layout to tabular - vba to vb.net", "body": "<p>Actually the solution was different approach.\nJust hiding the subtotals made me accomplish the task</p>\n"}], "owner": {"reputation": 315, "user_id": 6923139, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/c4f55643b357a8a86f6c54263ea56301?s=128&d=identicon&r=PG&f=1", "display_name": "programer Anel", "link": "https://stackoverflow.com/users/6923139/programer-anel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 52432398, "answer_count": 1, "score": 0, "last_activity_date": 1593676472, "creation_date": 1536743564, "last_edit_date": 1593676472, "question_id": 52291564, "link": "https://stackoverflow.com/questions/52291564/axis-layout-to-tabular-vba-to-vb-net", "title": "Axis layout to tabular - vba to vb.net", "body": "<p>How to write corresponding line in vb.net</p>\n\n<pre><code>ActiveSheet.PivotTables(\"PivotTable1\").RowAxisLayout xlTabularRow\n</code></pre>\n\n<p>I want to set the display of pivot table to Tabular </p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1536744475, "post_id": 52291372, "comment_id": 91531494, "body": "Please tell us a little bit more about your problem: Do you get an error? Does it work in unexpected ways? (We can&#39;t check your code, as long as you don&#39;t provide us with a <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> - as your snippet simply doesn&#39;t compile for me due to lacking declarations.)"}, {"owner": {"reputation": 21, "user_id": 10352144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/752d4b7cadee3a41158228763d217da3?s=128&d=identicon&r=PG&f=1", "display_name": "Laura", "link": "https://stackoverflow.com/users/10352144/laura"}, "reply_to_user": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1536747750, "post_id": 52291372, "comment_id": 91533511, "body": "After the Word Document opened I got Run time error 438. The yellow markings start at .ExportAsFixedFormat."}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1536756991, "post_id": 52291372, "comment_id": 91539149, "body": "Can you please edit that information into your question - I think it is crucial to solving your problem. Also, have a look at my answer and see if it helps you."}, {"owner": {"reputation": 21, "user_id": 10352144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/752d4b7cadee3a41158228763d217da3?s=128&d=identicon&r=PG&f=1", "display_name": "Laura", "link": "https://stackoverflow.com/users/10352144/laura"}, "reply_to_user": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1536847534, "post_id": 52291372, "comment_id": 91578200, "body": "Unfortunately I did not find a final solution with the help of your answers. Nevertheless I am still trying to fix.  A second way is that the Word includes an <code>AutoOpen</code> macro and can thereby save the file as an PDF. Therefore I need the Path of the excel calculation. Is there a possiblity to transfer the path (probably as a variable) from excel to word?"}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1536904606, "post_id": 52291372, "comment_id": 91598304, "body": "You won&#39;t succeed with <code>AutoOpen</code> either. You first need to fix the problem in your code. Your <code>.ExportAsFixedFormat</code> method refers to the wrong object. As mentioned in <a href=\"https://stackoverflow.com/a/52294591/7778672\">my answer</a> and in <a href=\"https://stackoverflow.com/a/52317628/7778672\">Cindy Meister&#39;s</a> answer as well."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1539793223, "post_id": 52291372, "comment_id": 92633549, "body": "You haven&#39;t marked any of the contributions as an Answer, nor upvoted any of them. Did any of the contributions help you or answer the question?"}], "answers": [{"comments": [{"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1536753464, "post_id": 52294000, "comment_id": 91536766, "body": "Did you try to compile/run your code? Your suggestion will exhibit the same behavior as OP&#39;s code snippet (I.e. Error 438). <code>.ExportAsFixedFormat</code> does not exist on the <code>WordApp</code> object."}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "reply_to_user": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1536754337, "post_id": 52294000, "comment_id": 91537333, "body": "yes, ive tryied and worked. in the wordapp doenst exist, but in the activedocument yes... and thats why u activate the document."}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1536755458, "post_id": 52294000, "comment_id": 91537982, "body": "I&#39;m referring to the line <code>ActiveDocument.ExportAsFixedFormat </code> (which should work), followed by <code>.ExportAsFixedFormat OutputFileName:= _</code> [...] which I&#39;m quite sure won&#39;t work. (As it&#39;s calling <code>ExportAsFixedFormat</code> on <code>Word.Application</code>)"}, {"owner": {"reputation": 21, "user_id": 10352144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/752d4b7cadee3a41158228763d217da3?s=128&d=identicon&r=PG&f=1", "display_name": "Laura", "link": "https://stackoverflow.com/users/10352144/laura"}, "edited": false, "score": 0, "creation_date": 1536755777, "post_id": 52294000, "comment_id": 91538218, "body": "Thank you for your reply. I changed <code>Wordapp</code> as a <code>Word.Application</code>instead of an object. Nevertheless, I get an compile error, because <code>.ExportAsFixedFormat</code> does not exist. Is there a possiblity to add it?  Generally my question is not only connected to <code>.ExportAsFixedFormat</code>. I want access to the word document with the macros in Excel."}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1536756020, "post_id": 52294000, "comment_id": 91538394, "body": "@LuisCurado Now I&#39;m getting what you&#39;re trying to achieve. The method <code>ExportAsFixedFormat</code> is available on every object of the type <code>Word.Document</code>. You don&#39;t need <code>ActiveDocument</code> for this. (And thus there is no need to first call <code>.Activate</code>). If you set a reference to the document you&#39;re opening like <code>Set doc = .Documents.Open(LocationTemplate)</code>, you can then use <code>doc.ExportAsFixedFormat</code>."}], "tags": [], "owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "is_accepted": false, "score": 0, "last_activity_date": 1536751385, "creation_date": 1536751385, "answer_id": 52294000, "question_id": 52291372, "link": "https://stackoverflow.com/questions/52291372/vba-execute-macros-for-word-document-in-excel/52294000#52294000", "title": "VBA Execute Macros for Word Document in Excel", "body": "<p>it seems that youre not selecting the open document</p>\n\n<p>try something like this</p>\n\n<pre><code>Set WordApp = CreateObject(\"Word.Application\")\nWith WordApp.Application\n  .Visible = True\n  .Documents.Open (LocationTemplate)\n\n  .Activate\n\n  ActiveDocument.ExportAsFixedFormat \n    .ExportAsFixedFormat OutputFileName:= _\n    OfferPath, _\n    ExportFormat:=wdExportFormatPDF, OpenAfterExport:=True, OptimizeFor:= _\n    wdExportOptimizeForPrint, Range:=wdExportAllDocument, From:=1, To:=1, _\n    Item:=wdExportDocumentContent, IncludeDocProps:=True, KeepIRM:=True, _\n    CreateBookmarks:=wdExportCreateNoBookmarks, DocStructureTags:=True, _\n    BitmapMissingFonts:=True, UseISO19005_1:=False\n    ChangeFileOpenDirectory _\n    DestinationPath\n  .Quit\n\nEnd With\n</code></pre>\n\n<p>Good Luck</p>\n"}, {"tags": [], "owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "is_accepted": false, "score": 0, "last_activity_date": 1536753386, "creation_date": 1536753386, "answer_id": 52294591, "question_id": 52291372, "link": "https://stackoverflow.com/questions/52291372/vba-execute-macros-for-word-document-in-excel/52294591#52294591", "title": "VBA Execute Macros for Word Document in Excel", "body": "<h2>Runtime Error 438: \"Object doesn't support this property or method\"</h2>\n\n<p>Your problem stems from the fact that in the <code>With</code> block you are referring to <code>WordApp.Application</code> (which in itself is redundant and could be reduced to <code>WordApp</code> as it already represents a <code>Word.Application</code> object) and thus with the line <code>.ExportAsFixedFormat [...]</code> you are essentially doing: </p>\n\n<p><code>Word.Application.ExportAsFixedFormat</code></p>\n\n<p>This method doesn't exist on the <code>Application</code> object. (Now read the error description again - notice anything?)</p>\n\n<p>If you instead of late-binding the <code>Word.Application</code> object via <code>CreateObject()</code> set a reference to the Word Object Model (Menu: Extras - References) you can do things like:</p>\n\n<pre><code>Dim wordApp As Word.Application\nSet wordApp = New Word.Application\nWith wordApp.Documents.Open LocationTemplate\n    .ExportAsFixedFormat [...]\nEnd With\n</code></pre>\n\n<p>Which provides you with the (much needed) intellisense, as well as compile-time errors instead of runtime errors when you try to call wrong methods.</p>\n"}, {"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1536854612, "creation_date": 1536854612, "answer_id": 52317628, "question_id": 52291372, "link": "https://stackoverflow.com/questions/52291372/vba-execute-macros-for-word-document-in-excel/52317628#52317628", "title": "VBA Execute Macros for Word Document in Excel", "body": "<p>The mistake is that you execute <code>.ExportAsFixedFormat</code> on the Word.Application object. This method is valid for a <em>Word document</em>. Your code should be more like what follows.</p>\n\n<p>Note that I've added the variable declarations for <code>WordApp</code> and <code>WordDoc</code> and also code to <em>release</em> these objects.</p>\n\n<pre><code>Dim WordApp as Object\nDim WordDoc as Object\nSet WordApp = CreateObject(\"Word.Application\")\nWith WordApp.Application\n   .Visible = True\n   Set WordDoc = .Documents.Open (LocationTemplate)\n   WordDoc.ExportAsFixedFormat OutputFileName:= _\n        OfferPath, _\n        ExportFormat:=wdExportFormatPDF, OpenAfterExport:=True, OptimizeFor:= _\n        wdExportOptimizeForPrint, Range:=wdExportAllDocument, From:=1, To:=1, _\n        Item:=wdExportDocumentContent, IncludeDocProps:=True, KeepIRM:=True, _\n        CreateBookmarks:=wdExportCreateNoBookmarks, DocStructureTags:=True, _\n        BitmapMissingFonts:=True, UseISO19005_1:=False\n    .Quit 0 'To not save changes to the document, just close it\n    Set WordDoc = Nothing\nEnd With\nSet WordApp = Nothing\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10352144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/752d4b7cadee3a41158228763d217da3?s=128&d=identicon&r=PG&f=1", "display_name": "Laura", "link": "https://stackoverflow.com/users/10352144/laura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 881, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1536854612, "creation_date": 1536742987, "last_edit_date": 1536853285, "question_id": 52291372, "link": "https://stackoverflow.com/questions/52291372/vba-execute-macros-for-word-document-in-excel", "title": "VBA Execute Macros for Word Document in Excel", "body": "<p>I have an excel calculation which contains information for a Word Document. What I want is to open the word document and save it as an pdf automatically - with a macro in Excel.</p>\n\n<p>I already tried the following:</p>\n\n<pre><code>Set WordApp = CreateObject(\"Word.Application\")\nWith WordApp.Application\n   .Visible = True\n   .Documents.Open (LocationTemplate)\n        .ExportAsFixedFormat OutputFileName:= _\n        OfferPath, _\n        ExportFormat:=wdExportFormatPDF, OpenAfterExport:=True, OptimizeFor:= _\n        wdExportOptimizeForPrint, Range:=wdExportAllDocument, From:=1, To:=1, _\n        Item:=wdExportDocumentContent, IncludeDocProps:=True, KeepIRM:=True, _\n        CreateBookmarks:=wdExportCreateNoBookmarks, DocStructureTags:=True, _\n        BitmapMissingFonts:=True, UseISO19005_1:=False\n        ChangeFileOpenDirectory _\n        DestinationPath\n    .Quit\n\nEnd With\n</code></pre>\n\n<p>What is the mistake? Looking forward to your support.</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1536743190, "post_id": 52291295, "comment_id": 91530678, "body": "<code>Dim numero As LONG Dim endcolumn As LONG</code>"}], "answers": [{"comments": [{"owner": {"reputation": 227, "user_id": 6573951, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2eadb862478c4a11831a27ed0fa573f0?s=128&d=identicon&r=PG&f=1", "display_name": "babou", "link": "https://stackoverflow.com/users/6573951/babou"}, "edited": false, "score": 0, "creation_date": 1536743995, "post_id": 52291531, "comment_id": 91531189, "body": "Thank you for your help, everything is working well. Now I will need to understand to learn more. Again thank you."}, {"owner": {"reputation": 227, "user_id": 6573951, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2eadb862478c4a11831a27ed0fa573f0?s=128&d=identicon&r=PG&f=1", "display_name": "babou", "link": "https://stackoverflow.com/users/6573951/babou"}, "edited": false, "score": 0, "creation_date": 1536756788, "post_id": 52291531, "comment_id": 91538975, "body": "And do you have the traduction for : Range(&quot;D3:D200&quot;).Clear for Mac ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 227, "user_id": 6573951, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2eadb862478c4a11831a27ed0fa573f0?s=128&d=identicon&r=PG&f=1", "display_name": "babou", "link": "https://stackoverflow.com/users/6573951/babou"}, "edited": false, "score": 1, "creation_date": 1536779219, "post_id": 52291531, "comment_id": 91551627, "body": "You seem to be under the impression that there are many differences in coding for VBA in MAC. In fact there are very few. Just use <code>Range(&quot;D3:D200&quot;).Clear</code> preferably with a valid parent worksheet reference."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 227, "user_id": 6573951, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2eadb862478c4a11831a27ed0fa573f0?s=128&d=identicon&r=PG&f=1", "display_name": "babou", "link": "https://stackoverflow.com/users/6573951/babou"}, "edited": false, "score": 0, "creation_date": 1536827688, "post_id": 52291531, "comment_id": 91566417, "body": "That&#39;s odd. Not having a mac in front of me, I checked the questions in <a href=\"https://stackoverflow.com/questions/tagged/excel-vba-mac\">excel-vba-mac</a> and others don&#39;t seem to have a problem."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1536743469, "creation_date": 1536743469, "answer_id": 52291531, "question_id": 52291295, "link": "https://stackoverflow.com/questions/52291295/copy-paste-condition-mac/52291531#52291531", "title": "Copy / Paste + condition MAC", "body": "<p>Declare you vars as long; they are numbers, not strings. I've also corrected your range definitions and given Range(\"C\", numero) a parent worksheet reference.</p>\n\n<pre><code>Sub Macro2()\n\n    Dim numero As long\n    Dim endrow As long\n\n    numero = 1\n    endrow = workSheets(\"Sheet2\").Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n\n    While numero &lt;= endrow \n        If workSheets(\"Sheet2\").cells(numero, \"C\") = \"LIVE\" Then\n            workSheets(\"Sheet1\").cells(rows.count, \"E\").end(xlup).offset(1, 0) = _\n                workSheets(\"Sheet2\").cells(numero, \"B\").value\n        End If\n\n        numero = numero + 1\n\n    Wend\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 227, "user_id": 6573951, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2eadb862478c4a11831a27ed0fa573f0?s=128&d=identicon&r=PG&f=1", "display_name": "babou", "link": "https://stackoverflow.com/users/6573951/babou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 52291531, "answer_count": 1, "score": 1, "last_activity_date": 1593592652, "creation_date": 1536742780, "last_edit_date": 1593592652, "question_id": 52291295, "link": "https://stackoverflow.com/questions/52291295/copy-paste-condition-mac", "title": "Copy / Paste + condition MAC", "body": "<p>I have some columns in sheet 2.</p>\n\n<p>I want that if in the Sheet2.Column C = \"LIVE\"\nThen copy the Sheet2.Column B value in the Sheet1.Column E (and delete the space between value).</p>\n\n<p>But I Don't know how to translate it in MAC VBA or why it doesn't work.</p>\n\n<p>this is my code :</p>\n\n<pre><code>Sub Macro2()\n\nDim numero As String\nDim endcolumn As String\n\nnumero = 1\nendcolumn = Range(\"C\" &amp; Rows.Count).End(xlUp).Row\nWhile numero &lt;= endcolumn\n    If Range(\"C\", numero) = \"LIVE\" Then\n    Sheets(\"Sheet1\").Range(E, numero) = Sheets(\"Sheet2\").Range(B, numero)\n    End If\n\n    numero = numero + 1\n\nWend\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "forms", "excel"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1536741358, "post_id": 52290793, "comment_id": 91529516, "body": "You need to provide more details if you want to get help. What kind of form did you implement? I do not know what you mean with &quot;Excel Form from the top bar&quot;. It seems you are not talking about a <a href=\"https://excelmacromastery.com/vba-user-forms-1/\" rel=\"nofollow noreferrer\">userform.</a>"}, {"owner": {"reputation": 133, "user_id": 9433566, "user_type": "registered", "profile_image": "https://graph.facebook.com/1858556497510549/picture?type=large", "display_name": "Anca Vulc", "link": "https://stackoverflow.com/users/9433566/anca-vulc"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1536741733, "post_id": 52290793, "comment_id": 91529760, "body": "@Storax it s not a VBA form, this is the form that I&#39;m talking about: <a href=\"https://www.myexcelonline.com/blog/create-data-entry-form-excel/\" rel=\"nofollow noreferrer\">myexcelonline.com/blog/create-data-entry-form-excel</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536742285, "post_id": 52290793, "comment_id": 91530088, "body": "Are you using Excel 2016 btw?"}, {"owner": {"reputation": 133, "user_id": 9433566, "user_type": "registered", "profile_image": "https://graph.facebook.com/1858556497510549/picture?type=large", "display_name": "Anca Vulc", "link": "https://stackoverflow.com/users/9433566/anca-vulc"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536742332, "post_id": 52290793, "comment_id": 91530110, "body": "@QHarr Excel 2007"}], "answers": [{"comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1536743800, "post_id": 52291182, "comment_id": 91531057, "body": "There is also a keyboard shortcut to start this form. If the cursor is located in the table I can start the form with Alt-N-M (german version!)"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1536745918, "post_id": 52291182, "comment_id": 91532387, "body": "It may be worth being a a bit more explicit that this code needs to go in the sheet&#39;s code, and not in a regular module."}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 3, "last_activity_date": 1536745173, "last_edit_date": 1536745173, "creation_date": 1536742386, "answer_id": 52291182, "question_id": 52290793, "link": "https://stackoverflow.com/questions/52290793/excel-form-pops-automatically-when-sheet-opens/52291182#52291182", "title": "Excel Form pops automatically when sheet opens", "body": "<p>\nTo show the DataForm associated with a Worksheet, you use the command <code>Worksheet.ShowDataForm</code> (<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.showdataform\" rel=\"nofollow noreferrer\">MSDN Article</a>)</p>\n\n<p>To show the DataForm for <code>Sheet1</code> whenever you go to <code>Sheet2</code>, you can use the <code>Worksheet_Activate</code> event in <code>Sheet2</code>, like so:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nPrivate Sub Worksheet_Activate()\n    Sheet1.ShowDataForm\nEnd Sub\n</code></pre>\n\n<p>A quick way to figure things like this out is use the \"Record Macro\" button, carry out the action you want, and then hit \"Stop Recording\" and look at the macro</p>\n"}], "owner": {"reputation": 133, "user_id": 9433566, "user_type": "registered", "profile_image": "https://graph.facebook.com/1858556497510549/picture?type=large", "display_name": "Anca Vulc", "link": "https://stackoverflow.com/users/9433566/anca-vulc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536745173, "creation_date": 1536741074, "question_id": 52290793, "link": "https://stackoverflow.com/questions/52290793/excel-form-pops-automatically-when-sheet-opens", "title": "Excel Form pops automatically when sheet opens", "body": "<p>I have a specific worksheet with 2 sheets(Sheet1 &amp; Sheet2). For Sheet2 I have implemented a form for the table (Using the basic Excel Form from the top bar).</p>\n\n<p>My problem is that I have to make the form appear automatically every time I open Sheet1 (even if the data from the form will be completed in Sheet2).</p>\n\n<p>Is this possible? Or how can I do it? (I can also use VBA)</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 0, "creation_date": 1536738988, "post_id": 52289317, "comment_id": 91528129, "body": "What is the error? At which line? Have you tried debugging your code (<a href=\"https://analystcave.com/how-to-debug-vba/\" rel=\"nofollow noreferrer\">analystcave.com/how-to-debug-vba</a>)?"}, {"owner": {"reputation": 395, "user_id": 9130364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16db2beef23da46ff99782ccb41ca988?s=128&d=identicon&r=PG&f=1", "display_name": "user71812", "link": "https://stackoverflow.com/users/9130364/user71812"}, "reply_to_user": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 0, "creation_date": 1536738991, "post_id": 52289317, "comment_id": 91528130, "body": "@M&#225;t&#233;Juh&#225;sz, thanks for the comment, I have revised my question above. I built the code and the reason I didn&#39;t post the lower half solution is because it doesn&#39;t work. I added the complete code I am currently struggling with in the message now"}], "answers": [{"comments": [{"owner": {"reputation": 395, "user_id": 9130364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16db2beef23da46ff99782ccb41ca988?s=128&d=identicon&r=PG&f=1", "display_name": "user71812", "link": "https://stackoverflow.com/users/9130364/user71812"}, "edited": false, "score": 0, "creation_date": 1536739766, "post_id": 52290181, "comment_id": 91528593, "body": "Thanks a lot!!! that works perfect for me, but would you mind explain a bit more about this line? Select Case lastRow                           Case 2         nextRow = 2     Case Else         nextRow = lastRow + 1     End Select"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 395, "user_id": 9130364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16db2beef23da46ff99782ccb41ca988?s=128&d=identicon&r=PG&f=1", "display_name": "user71812", "link": "https://stackoverflow.com/users/9130364/user71812"}, "edited": false, "score": 0, "creation_date": 1536739951, "post_id": 52290181, "comment_id": 91528699, "body": "It might be redundant to be honest. Let me check. Yeah, it is in this case. I will remove."}, {"owner": {"reputation": 395, "user_id": 9130364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16db2beef23da46ff99782ccb41ca988?s=128&d=identicon&r=PG&f=1", "display_name": "user71812", "link": "https://stackoverflow.com/users/9130364/user71812"}, "edited": false, "score": 1, "creation_date": 1536740869, "post_id": 52290181, "comment_id": 91529232, "body": "Haha okay, thanks a lot QHarr for your help. Really appreciate your help, thank you so much again! Have an awesome day!"}, {"owner": {"reputation": 395, "user_id": 9130364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16db2beef23da46ff99782ccb41ca988?s=128&d=identicon&r=PG&f=1", "display_name": "user71812", "link": "https://stackoverflow.com/users/9130364/user71812"}, "edited": false, "score": 0, "creation_date": 1537265355, "post_id": 52290181, "comment_id": 91712296, "body": "Hi QHarr, do you by any chance know how to modify the code to stop when it encounters a blank cell? Right now the code fills all the way down until the end of rowcount, even when the cells are blank. At the example above, let&#39;s say I have only 3 rows with data, but the code fills all 5 rows. Thanks!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 395, "user_id": 9130364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16db2beef23da46ff99782ccb41ca988?s=128&d=identicon&r=PG&f=1", "display_name": "user71812", "link": "https://stackoverflow.com/users/9130364/user71812"}, "edited": false, "score": 1, "creation_date": 1537266100, "post_id": 52290181, "comment_id": 91712680, "body": ".Cells(1, &quot;A&quot;).End(xDown).Row ? Danger is you could end up at bottom of sheet if column empty."}, {"owner": {"reputation": 395, "user_id": 9130364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16db2beef23da46ff99782ccb41ca988?s=128&d=identicon&r=PG&f=1", "display_name": "user71812", "link": "https://stackoverflow.com/users/9130364/user71812"}, "edited": false, "score": 0, "creation_date": 1537329789, "post_id": 52290181, "comment_id": 91739910, "body": "Thanks for the suggestion QHarr! I&#39;ll see what I can do with the code you provided. Thanks a lot and have a great day :)"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1536740034, "last_edit_date": 1536740034, "creation_date": 1536738939, "answer_id": 52290181, "question_id": 52289317, "link": "https://stackoverflow.com/questions/52289317/how-to-insert-data-from-multiple-arrays-from-an-excel-form-to-database/52290181#52290181", "title": "How to insert data from multiple arrays from an Excel form to database?", "body": "<p>You should use a userform/excel data entry form or Access Database.</p>\n\n<p>However, assuming your form always has the same number of rows and is ordered the same in top and bottom tables you can use something like:</p>\n\n<pre><code>Option Explicit\nPublic Sub TransferData()\n\n    Dim lastRow As Long, nextRow As Long, dateFilled As Range\n    Dim wsDest As Worksheet, wsSource As Worksheet\n    Dim formData1 As Range, formData2 As Range\n\n    Set wsDest = ThisWorkbook.Worksheets(\"VolunteerData\")\n    Set wsSource = ThisWorkbook.Worksheets(\"VolunteerForm\")\n    Set dateFilled = wsSource.Range(\"D4\")\n    Set formData1 = wsSource.Range(\"D7:I11\")\n    Set formData2 = wsSource.Range(\"E16:I20\")\n    Application.ScreenUpdating = False\n\n    With wsDest\n        lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    End With\n\n    nextRow = lastRow + 1\n\n    With formData1\n        wsDest.Range(\"A\" &amp; nextRow).Resize(.Rows.Count, 1).Value = dateFilled.Value\n        wsDest.Range(\"B\" &amp; nextRow).Resize(.Rows.Count, .Columns.Count).Value = formData1.Value\n        wsDest.Range(\"H\" &amp; nextRow).Resize(.Rows.Count, .Columns.Count - 1).Value = formData2.Value\n    End With\n\n    ''potential housekeeping tasks to clear form?\n    formData1.Clear\n    formData2.Clear\n    formData2.Offset(, -1).Clear\n    dateFilled.Clear\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 395, "user_id": 9130364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16db2beef23da46ff99782ccb41ca988?s=128&d=identicon&r=PG&f=1", "display_name": "user71812", "link": "https://stackoverflow.com/users/9130364/user71812"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 52290181, "answer_count": 1, "score": 0, "last_activity_date": 1594055292, "creation_date": 1536735930, "last_edit_date": 1594055292, "question_id": 52289317, "link": "https://stackoverflow.com/questions/52289317/how-to-insert-data-from-multiple-arrays-from-an-excel-form-to-database", "title": "How to insert data from multiple arrays from an Excel form to database?", "body": "<p>I have a manually built form that looks approximately like this in Excel sheet <code>VolunteerForm</code>:\n<a href=\"https://i.stack.imgur.com/bkvUn.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bkvUn.jpg\" alt=\"VolunteerForm\"></a></p>\n\n<p>and the database in sheet <code>VolunteerData</code> linked to the form:\n<a href=\"https://i.stack.imgur.com/AlNM1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AlNM1.jpg\" alt=\"VolunteerData\"></a></p>\n\n<p>I managed to link the first part of the information (Col A to F in the database) but not the lower half of the form. </p>\n\n<p>This is what I have done so far (note that I built the code but can't figure out how to modify them to give the result I want, since running the code gave me an error).</p>\n\n<p>Here's my code:</p>\n\n<pre><code>Sub Submit_VolunteerForm()\n\n   Dim lr As Long, ws As Worksheet\n   Dim arr As Variant, i As Long\n\n    With Worksheets(\"VolunteerForm\")\n       lr = .Cells(12, \"D\").End(xlUp).Row - 6\n       ReDim arr(1 To lr, 1 To 6)\n       For i = LBound(arr, 1) To UBound(arr, 1)\n        arr(i, 1) = .Cells(4, \"D\").Value         ' Fixed Col = Date Form sent\n        arr(i, 2) = .Cells(i + 6, \"E\").Value     ' Name\n        arr(i, 3) = .Cells(i + 6, \"F\").Value     ' Dob\n        arr(i, 4) = .Cells(i + 6, \"G\").Value     ' birthplace\n        arr(i, 5) = .Cells(i + 6, \"H\").Value     ' address\n        arr(i, 6) = .Cells(i + 6, \"I\").Value     ' phone #\n\n     Next i\n    End With\n\n    With Worksheets(\"VolunteerData\")\n       lr = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row + 1\n       .Cells(lr, \"A\").Resize(UBound(arr, 1), UBound(arr, 2)) = arr\n    End With    \n\n  With Worksheets(\"VolunteerData\")\n      lr = .Range(\"G\" &amp; .Rows.Count).End(xlUp).Row + 1\n      .Cells(lr, \"G\").Resize(UBound(arr, 1), UBound(arr, 2)) = arr\n   End With\n\n   With Worksheets(\"VolunteerForm\")\n      lr = .Cells(21, \"D\").End(xlUp).Row - 15\n      ReDim arr(1 To lr, 1 To 6)\n     For i = LBound(arr, 1) To UBound(arr, 1)\n        arr(i, 1) = .Cells(i + 15, \"J\").Value\n        arr(i, 2) = .Cells(i + 15, \"K\").Value\n        arr(i, 3) = .Cells(i + 15, \"L\").Value\n        arr(i, 4) = .Cells(i + 15, \"M\").Value\n        arr(i, 5) = .Cells(i + 15, \"N\").Value\n\n       Next i\n    End With\n\n  End Sub\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 3982, "user_id": 5695953, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b50e1603f447a4a31cded4a14edfeff9?s=128&d=identicon&r=PG&f=1", "display_name": "Md. Suman Kabir", "link": "https://stackoverflow.com/users/5695953/md-suman-kabir"}, "edited": false, "score": 1, "creation_date": 1536734264, "post_id": 52288167, "comment_id": 91525504, "body": "I don&#39;t see any problem in your code! I suspect you might have any constraint in your table.  Can try to see this <code>MsgBox (num1)</code> after the <code>For</code> loop?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10169361"}, "reply_to_user": {"reputation": 3982, "user_id": 5695953, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b50e1603f447a4a31cded4a14edfeff9?s=128&d=identicon&r=PG&f=1", "display_name": "Md. Suman Kabir", "link": "https://stackoverflow.com/users/5695953/md-suman-kabir"}, "edited": false, "score": 0, "creation_date": 1536734670, "post_id": 52288167, "comment_id": 91525700, "body": "I&#39;ve added the MsgBox (num1) and the message box continues after 2 and it can probably continue to 50000."}, {"owner": {"reputation": 3982, "user_id": 5695953, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b50e1603f447a4a31cded4a14edfeff9?s=128&d=identicon&r=PG&f=1", "display_name": "Md. Suman Kabir", "link": "https://stackoverflow.com/users/5695953/md-suman-kabir"}, "edited": false, "score": 1, "creation_date": 1536734732, "post_id": 52288167, "comment_id": 91525740, "body": "No, please put it after <code>Next</code> so that we can see the last value only."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10169361"}, "reply_to_user": {"reputation": 3982, "user_id": 5695953, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b50e1603f447a4a31cded4a14edfeff9?s=128&d=identicon&r=PG&f=1", "display_name": "Md. Suman Kabir", "link": "https://stackoverflow.com/users/5695953/md-suman-kabir"}, "edited": false, "score": 0, "creation_date": 1536734841, "post_id": 52288167, "comment_id": 91525807, "body": "Aah sorry, yeah it displays 50001."}, {"owner": {"reputation": 3982, "user_id": 5695953, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b50e1603f447a4a31cded4a14edfeff9?s=128&d=identicon&r=PG&f=1", "display_name": "Md. Suman Kabir", "link": "https://stackoverflow.com/users/5695953/md-suman-kabir"}, "edited": false, "score": 1, "creation_date": 1536734944, "post_id": 52288167, "comment_id": 91525854, "body": "Then i can say your code is correct! Did you check your table now?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10169361"}, "reply_to_user": {"reputation": 3982, "user_id": 5695953, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b50e1603f447a4a31cded4a14edfeff9?s=128&d=identicon&r=PG&f=1", "display_name": "Md. Suman Kabir", "link": "https://stackoverflow.com/users/5695953/md-suman-kabir"}, "edited": false, "score": 0, "creation_date": 1536734996, "post_id": 52288167, "comment_id": 91525891, "body": "Unfortunately it still only created 2 records."}, {"owner": {"reputation": 3982, "user_id": 5695953, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b50e1603f447a4a31cded4a14edfeff9?s=128&d=identicon&r=PG&f=1", "display_name": "Md. Suman Kabir", "link": "https://stackoverflow.com/users/5695953/md-suman-kabir"}, "edited": false, "score": 1, "creation_date": 1536735035, "post_id": 52288167, "comment_id": 91525913, "body": "Are you sure you are checking <b>SALARY</b> table?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10169361"}, "reply_to_user": {"reputation": 3982, "user_id": 5695953, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b50e1603f447a4a31cded4a14edfeff9?s=128&d=identicon&r=PG&f=1", "display_name": "Md. Suman Kabir", "link": "https://stackoverflow.com/users/5695953/md-suman-kabir"}, "edited": false, "score": 0, "creation_date": 1536735076, "post_id": 52288167, "comment_id": 91525939, "body": "Yes I&#39;m on the SALARY table. The data types for the columns are number for SalaryID, Short Text for NetSalary and number for EmployeeID"}, {"owner": {"reputation": 787, "user_id": 7501124, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mkYvcw9838M/AAAAAAAAAAI/AAAAAAAAA-c/9d-8oW5GE-4/photo.jpg?sz=128", "display_name": "FastJack", "link": "https://stackoverflow.com/users/7501124/fastjack"}, "edited": false, "score": 1, "creation_date": 1536735465, "post_id": 52288167, "comment_id": 91526149, "body": "whats the debug.print output for &quot;Debug.Print SalaryId; EmpSalary; EmpId;&quot; ? does it display all 50000 lines?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10169361"}, "is_accepted": false, "score": 0, "last_activity_date": 1536735744, "creation_date": 1536735744, "answer_id": 52289264, "question_id": 52288167, "link": "https://stackoverflow.com/questions/52288167/vba-access-having-trouble-inserting-multiple-records-into-a-table/52289264#52289264", "title": "VBA Access - Having trouble inserting multiple records into a table", "body": "<p>I have figured it out, sorry for wasting your time! It was because of the relationships I've created as salary table was linked to the employee table which only had 2 records therefore salary table was only able to create a maximum of 2 records. I am sorry again for not double checking everything before posting.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10169361"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1536735744, "creation_date": 1536730891, "last_edit_date": 1536733980, "question_id": 52288167, "link": "https://stackoverflow.com/questions/52288167/vba-access-having-trouble-inserting-multiple-records-into-a-table", "title": "VBA Access - Having trouble inserting multiple records into a table", "body": "<p>I am new to VBA, so I'm having trouble understanding what is going on. I am trying to fill a table with 50,000 records with the following code:</p>\n\n<pre><code>Sub arrayData()\nDim custnames() As Variant\nDim num As Long, dbs As Database, InsertRecord As String\nDim CusSalaryId As Long, num1 As Long, EmpId As Long\nDim EmpSalary As String\nSet dbs = CurrentDb()\nEmpId = 0\nCustSalaryId = 0\nFor num1 = 0 To 50000\nCustSalaryId = CustSalaryId + 1\nEmpId = EmpId + 1\ncustnames = Array(\"$1000\", \"$500\", \"$300\", \"$600\")\n\n\n\nnum = Int((UBound(custnames) - LBound(custnames) + 1) * Rnd + LBound(custnames))\nEmpSalary= custnames(num)\n\nInsertRecord = \"insert into SALARY (SalaryID, NetSalary, EmployeeID) \nvalues (\" &amp; \"'\" &amp; CustSalaryId &amp; \"'\" &amp; \",\" &amp; \"'\" &amp; EmpSalary &amp; \"'\" &amp; \",\" &amp; \"'\" &amp; EmpId &amp; \"'\" &amp; \")\"\n\ndbs.Execute InsertRecord\nDebug.Print SalaryId; EmpSalary; EmpId;\n\nNext\n\nEnd Sub\n</code></pre>\n\n<p>When I run it, I get only 2 records:\n<a href=\"https://i.stack.imgur.com/djWcZ.png\" rel=\"nofollow noreferrer\">Salary Table Output</a></p>\n"}, {"tags": ["vba", "excel", "excel-2016"], "comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1536732189, "post_id": 52288162, "comment_id": 91524456, "body": "<code>Range(Cells(iRow,17), Cells(iRow, Columns.Count).End(xlToLeft))</code>, where <code>iRow</code> is the current row index"}, {"owner": {"reputation": 446, "user_id": 10298597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b736307c6d36c946b5fda50ca7b030b?s=128&d=identicon&r=PG&f=1", "display_name": "nizarcan", "link": "https://stackoverflow.com/users/10298597/nizarcan"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1536732897, "post_id": 52288162, "comment_id": 91524783, "body": "Also this worked for me too. Depending on the performance of these code, I am going to use one of them. Thank you both."}], "answers": [{"comments": [{"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "reply_to_user": {"reputation": 446, "user_id": 10298597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b736307c6d36c946b5fda50ca7b030b?s=128&d=identicon&r=PG&f=1", "display_name": "nizarcan", "link": "https://stackoverflow.com/users/10298597/nizarcan"}, "edited": false, "score": 0, "creation_date": 1536732868, "post_id": 52288430, "comment_id": 91524764, "body": "@nizarcan Then you should accept the answer (green check mark on the elft) and optionally upvote."}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": true, "score": 2, "last_activity_date": 1536741918, "last_edit_date": 1536741918, "creation_date": 1536732214, "answer_id": 52288430, "question_id": 52288162, "link": "https://stackoverflow.com/questions/52288162/custom-selection-in-row-with-vba/52288430#52288430", "title": "Custom selection in row with vba", "body": "<p>Defining range in VBA: <code>Dim rng As Range</code>.</p>\n\n<p>Setting range (since it's <em>object</em>, you must use <code>Set</code> keyword): <code>Set rng = Range(\"A1:B2\")</code>\nor</p>\n\n<p><code>Set rng = Range(Cells(1, 1), Cells(2, 2))</code> - both are equivalent.</p>\n\n<p>So, if you want to specify custom range in ONE row starting from 17th column, you must also know where the rows ends, you can do that in two ways:</p>\n\n<pre><code>Dim lastCol As Long\nlastCol = Cells(rowNumber, 17).End(xlToRight).Column\n'alternative, but not equivalent\nlastCol = Cells(rowNumber, Columns.Count).End(xlToLeft).Column\n</code></pre>\n\n<p>Where <code>rowNumber</code> is partciular number of of a row.</p>\n\n<p>Now, having <code>lastCol</code> we can define the range:</p>\n\n<pre><code>Set rng = Range(Cells(rowNumber, 17), Cells(rowNumber, lastCol))\n</code></pre>\n\n<p>Again, <code>rowNumber</code> is partciular number of of a row.</p>\n"}], "owner": {"reputation": 446, "user_id": 10298597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b736307c6d36c946b5fda50ca7b030b?s=128&d=identicon&r=PG&f=1", "display_name": "nizarcan", "link": "https://stackoverflow.com/users/10298597/nizarcan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 52288430, "answer_count": 1, "score": 0, "last_activity_date": 1536741918, "creation_date": 1536730860, "last_edit_date": 1536732259, "question_id": 52288162, "link": "https://stackoverflow.com/questions/52288162/custom-selection-in-row-with-vba", "title": "Custom selection in row with vba", "body": "<p>My problem is pretty straight-forward: how do I define the range from a certain cell to the end of the row? </p>\n\n<p>If you would know what am I trying to achieve, you would understand the situation better: I want to sort rows individually but every row's datas start at 17. column, so I'm trying to make the sorting from 17. column to end of the column count.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536731390, "post_id": 52287990, "comment_id": 91524128, "body": "By punch do you mean check or select? Can you share the URL?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1536731455, "creation_date": 1536731455, "answer_id": 52288269, "question_id": 52287990, "link": "https://stackoverflow.com/questions/52287990/select-radio-button-input-value-in-open-box-on-website-using-vba/52288269#52288269", "title": "Select Radio Button / input value in Open box on website using vba", "body": "<p>To choose a radio button style input, make the checked property true.</p>\n\n<pre><code>IE.Document.getElementById(\"ctl00_body_01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1_6\").checked = true\n</code></pre>\n\n<p>An input textbox gets its value set.</p>\n\n<pre><code>IE.Document.getElementById(\"ctl00_body_01EE9560-B1F9-4BA3-A922-9D53A1120FC2_3\").value = format(VOCSentDate, \"d/m/yy\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1536732032, "last_edit_date": 1536732032, "creation_date": 1536731712, "answer_id": 52288322, "question_id": 52287990, "link": "https://stackoverflow.com/questions/52287990/select-radio-button-input-value-in-open-box-on-website-using-vba/52288322#52288322", "title": "Select Radio Button / input value in Open box on website using vba", "body": "<p><strong>tl;dr;</strong></p>\n\n<p>The following are based on the HTML as shown. If there are parent <code>form/frame/iframe</code> tags involved they will also need to be negotiated before making the selections below.</p>\n\n<hr>\n\n<p><strong>Radio buttons:</strong></p>\n\n<p>For the radio buttons you can use a CSS selector combination to target the page styling and return a nodeList of all of the radio button elements. You can then select by index the appropriate button</p>\n\n<pre><code>Dim aNodeList As Object\nSet aNodeList = ie.document.querySelectorAll(\".ResponseOption [type=radio]\")\naNodeList.item(0).Click '&lt;==Select first  option\n</code></pre>\n\n<p>I think click may be likely method here as I can't see a checked attribute, else the syntax would be  <code>aNodeList.item(0).checked = True</code></p>\n\n<p>The returned nodeList is as follows by index</p>\n\n<p><img src=\"https://i.stack.imgur.com/7HPC6.png\" width=\"350\"></p>\n\n<hr>\n\n<p><strong>Textbox:</strong></p>\n\n<p>There is an ID for the input box so you can use an ID selector, #, to target</p>\n\n<pre><code>ie.document.querySelector(\"#ctl00_body_01EE9560-B1F9-4BA3-A922-9D53A1120FC2_3\").Value = \"myText\"\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10351052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae4cc9a8261b9abf4698288c57ecd7f2?s=128&d=identicon&r=PG&f=1", "display_name": "Namita", "link": "https://stackoverflow.com/users/10351052/namita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1536732032, "creation_date": 1536729842, "last_edit_date": 1536731331, "question_id": 52287990, "link": "https://stackoverflow.com/questions/52287990/select-radio-button-input-value-in-open-box-on-website-using-vba", "title": "Select Radio Button / input value in Open box on website using vba", "body": "<p>I am trying to punch the radio button question and want to input the value in an open text box as well (using VBA). Below is the script I am using. </p>\n\n<p>I tried multiple things, looked at other websites as well but it is not working.</p>\n\n<p>It would be great if someone can guide me.</p>\n\n<pre><code>Dim IE As Object\nDim Region, VOCSentDate As String\n\nSheets(\"Sheet1\").Select\nRegion = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1\").Value\nVOCSentDate = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"B1\").Value\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\nIE.Visible = True\nIE.Navigate \"website link.....\"\nApplication.StatusBar = \"Submitting\"\nWhile IE.Busy\nDoEvents\nWend\n</code></pre>\n\n<p>I'm not sure how to punch the radio button question. I tried the 3 types for Open textbox below but none of them are not working, throwing object required error</p>\n\n<pre><code>IE.Document.getElementById(\"ctl00_body_7F22FA6E-5D77-426A-AA84-68D833FA05C1_3\").Value = VOCSentDate\n\nIE.Document.getElementById(\"ctl00_body_7F22FA6E-5D77-426A-AA84-68D833FA05C1_3\").innerText = VOCSentDate\n\nIE.Document.all(\"ctl00_body_7F22FA6E-5D77-426A-AA84-68D833FA05C1_3\").Value = VOCSentDate\n\nApplication.StatusBar = \"Form Submitted\"\nIE.Quit\nSet IE = Nothing\n</code></pre>\n\n<p>-------------- HTML of the Radio button --------------</p>\n\n<pre><code>&lt;div class=\"SurveyItem  RadioButtonList Item1\"&gt;\n  &lt;div class=\"ItemText\"&gt;\n    &lt;span class=\"NoItemNumber\"&gt;&lt;/span&gt;&lt;span class=\"QuestionText\"&gt;Please select your region:&lt;/span&gt;\n  &lt;/div&gt;\n  &lt;div class=\"Validators\"&gt;\n    &lt;span id=\"ctl00_body_ctl12\" style=\"color:Red;display:none;\"&gt;A response to this question is required&lt;/span&gt;\n  &lt;/div&gt;\n  &lt;div id=\"ctl00_body_01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1\" class=\"Response\"&gt;\n    &lt;div class=\"ResponseOption\"&gt;\n      &lt;input id=\"ctl00_body_01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1_1\" type=\"radio\" name=\"ctl00$body$ctl00_body_ctl00_01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1\" value=\"01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1_1\" /&gt;&lt;label for=\"ctl00_body_01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1_1\"&gt;Americas&lt;/label&gt;\n    &lt;/div&gt;\n    &lt;div class=\"ResponseOption AlternatingRow\"&gt;\n      &lt;input id=\"ctl00_body_01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1_2\" type=\"radio\" name=\"ctl00$body$ctl00_body_ctl00_01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1\" value=\"01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1_2\" /&gt;&lt;label for=\"ctl00_body_01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1_2\"&gt;ANZ&lt;/label&gt;\n    &lt;/div&gt;\n    &lt;div class=\"ResponseOption\"&gt;\n      &lt;input id=\"ctl00_body_01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1_3\" type=\"radio\" name=\"ctl00$body$ctl00_body_ctl00_01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1\" value=\"01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1_3\" /&gt;&lt;label for=\"ctl00_body_01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1_3\"&gt;APAC&lt;/label&gt;\n    &lt;/div&gt;\n    &lt;div class=\"ResponseOption AlternatingRow\"&gt;\n      &lt;input id=\"ctl00_body_01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1_4\" type=\"radio\" name=\"ctl00$body$ctl00_body_ctl00_01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1\" value=\"01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1_4\" /&gt;&lt;label for=\"ctl00_body_01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1_4\"&gt;APME&lt;/label&gt;\n    &lt;/div&gt;\n    &lt;div class=\"ResponseOption\"&gt;\n      &lt;input id=\"ctl00_body_01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1_5\" type=\"radio\" name=\"ctl00$body$ctl00_body_ctl00_01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1\" value=\"01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1_5\" /&gt;&lt;label for=\"ctl00_body_01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1_5\"&gt;Europe&lt;/label&gt;\n    &lt;/div&gt;\n    &lt;div class=\"ResponseOption AlternatingRow\"&gt;\n      &lt;input id=\"ctl00_body_01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1_6\" type=\"radio\" name=\"ctl00$body$ctl00_body_ctl00_01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1\" value=\"01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1_6\" /&gt;&lt;label for=\"ctl00_body_01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1_6\"&gt;India&lt;/label&gt;\n    &lt;/div&gt;\n    &lt;div class=\"ResponseOption\"&gt;\n      &lt;input id=\"ctl00_body_01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1_7\" type=\"radio\" name=\"ctl00$body$ctl00_body_ctl00_01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1\" value=\"01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1_7\" /&gt;&lt;label for=\"ctl00_body_01EE9560-B1F9-4BA3-A922-9D53A1120FC2_1_7\"&gt;North America&lt;/label&gt;\n    &lt;/div&gt;\n</code></pre>\n\n<p>------------------- HTML of Open End -------------------------</p>\n\n<pre><code>&lt;div class=\"SurveyItem  Item3\"&gt;\n  &lt;div class=\"ItemText\"&gt;\n    &lt;span class=\"NoItemNumber\"&gt;&lt;/span&gt;&lt;span class=\"QuestionText\"&gt;EOPR First Sent Date (dd/mm/yyyy)&lt;/span&gt;\n  &lt;/div&gt;\n  &lt;div class=\"Validators\"&gt;\n    &lt;span id=\"ctl00_body_ctl52\" style=\"color:Red;display:none;\"&gt;A response to this question is required&lt;/span&gt;&lt;span id=\"ctl00_body_ctl53\" style=\"color:Red;display:none;\"&gt;Incorrect Date Format&lt;/span&gt;\n  &lt;/div&gt;\n  &lt;div class=\"Response\"&gt;\n    &lt;input name=\"ctl00$body$01EE9560-B1F9-4BA3-A922-9D53A1120FC2_3\" type=\"text\" id=\"ctl00_body_01EE9560-B1F9-4BA3-A922-9D53A1120FC2_3\" class=\"TextBox\" /&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 1, "creation_date": 1536729427, "post_id": 52287605, "comment_id": 91523484, "body": "It seems 4 seconds is not that bad at all considering the fact that you are calling Word from Excel and it does some other stuff before even starting to open the word document if you said it takes 40 seconds that would have been a problem, but why 4 seconds is a problem for you?"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 8563384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd81d350ea016d45f4f129d4a1e9f8c6?s=128&d=identicon&r=PG&f=1", "display_name": "Carey", "link": "https://stackoverflow.com/users/8563384/carey"}, "edited": false, "score": 0, "creation_date": 1536731313, "post_id": 52287930, "comment_id": 91524091, "body": "Thanks for the feedback, much appreciated"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 83, "user_id": 8563384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd81d350ea016d45f4f129d4a1e9f8c6?s=128&d=identicon&r=PG&f=1", "display_name": "Carey", "link": "https://stackoverflow.com/users/8563384/carey"}, "edited": false, "score": 0, "creation_date": 1536742780, "post_id": 52287930, "comment_id": 91530401, "body": "You&#39;re welcome, @Carey :-) Since you&#39;re relatively new to Stack Overflow: The accepted way to thank for a contribution is to <i>upvote</i> using the arrow to the left. If you feel a contribution has answered your question, click the checkmark to the left of it."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 2, "last_activity_date": 1536729503, "creation_date": 1536729503, "answer_id": 52287930, "question_id": 52287605, "link": "https://stackoverflow.com/questions/52287605/vba-why-opening-word-from-excel-is-slow/52287930#52287930", "title": "VBA - Why opening Word from Excel is slow?", "body": "<p>Looking at your code, it's not just opening the document, it's also starting a new instance of the Word application*. So there are a number of factors that are taking time:</p>\n\n<ol>\n<li>Starting Word. Have you ever timed how long it takes Word to start when you click the icon? First, the application itself needs to load. Then, there may be any number of add-ins loading, which will take time.</li>\n<li>When an outside application \"automates\" another application there is a time \"hit\" for the \"cross-barrier\" communication. VBA within an Office application is usually quite fast; the same commands run from a different application will be (noticeably) slower.</li>\n</ol>\n\n<p>'* You should never declare and instantiate an application in the same line in VBA. You should change your code to:</p>\n\n<pre><code>Dim wordApp as Word.Application\nSet wordApp = New Word.Application\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 513, "user_id": 10059074, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d5f487d1ae5cbf54ac9f5641f10c5fb4?s=128&d=identicon&r=PG", "display_name": "CatCat", "link": "https://stackoverflow.com/users/10059074/catcat"}, "is_accepted": false, "score": 3, "last_activity_date": 1536753284, "last_edit_date": 1536753284, "creation_date": 1536747024, "answer_id": 52292694, "question_id": 52287605, "link": "https://stackoverflow.com/questions/52287605/vba-why-opening-word-from-excel-is-slow/52292694#52292694", "title": "VBA - Why opening Word from Excel is slow?", "body": "<p>There is nothing substantive wrong with your code. Word is slow.</p>\n\n<p>The difference could be inprocess vs outofprocess. Out of Process calls are made using the RPC networking remote call procedure. Hidden windows are created so messages can be received. It's all very complicated so out of process calls work under all circumstances. In Process Calls are just a machine code jump instruction. Several clock cycles vs tens of thousands or more.</p>\n\n<p>There are some minor issues.</p>\n\n<p>These lines are pointless. This is handled at the end of each line for implicit variables and every <code>end function</code> etc for explicit variables. See <a href=\"https://stackoverflow.com/questions/39215460/declaring-variables-memory-leaks\">Declaring Variables Memory Leaks</a></p>\n\n<pre><code>Set fso = Nothing\nSet folder = Nothing\nSet subfolder1 = Nothing\nSet CurrFile = Nothing\n</code></pre>\n\n<p>If you want to do this indirection then they need to be <code>const</code>. The compiler will put them into the line where used as literals. Use variables only where needed.</p>\n\n<pre><code>strTextFind1 = \"useful\"\nstrFileFound = \"test\"\nstrExtension = \".doc\"\n</code></pre>\n\n<p>So</p>\n\n<pre><code>const strTextFind1 = \"useful\"\nconst strFileFound = \"test\"\nconst strExtension = \".doc\"\n</code></pre>\n\n<p>You are late binding to FSO. Use early binding as you do for Word. See <a href=\"https://stackoverflow.com/questions/29596432/pointers-needed-for-speeding-up-nested-loop-macro-in-vba/29597193#29597193\">Pointers needed for speeding up nested loop macro in VBA</a>. Then instead of <code>Dim folder As Object</code> dim it as you do word.</p>\n"}], "owner": {"reputation": 83, "user_id": 8563384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd81d350ea016d45f4f129d4a1e9f8c6?s=128&d=identicon&r=PG&f=1", "display_name": "Carey", "link": "https://stackoverflow.com/users/8563384/carey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 936, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1536753284, "creation_date": 1536727322, "last_edit_date": 1536729139, "question_id": 52287605, "link": "https://stackoverflow.com/questions/52287605/vba-why-opening-word-from-excel-is-slow", "title": "VBA - Why opening Word from Excel is slow?", "body": "<p>I wondered if anyone can shed some light on why opening a Word document would take a few seconds from Excel?  The code below quickly finds/opens a specific subfolder using InStr i.e. debug.print of the subfolder name is immediate, however opening the specific Word doc takes about 4 seconds. I tried testing a similar procedure in Word itself it opened the document almost immediately.  I'm still learning VBA and I'm not sure what the reason would be other than its something to do with the last bit re strFile \nAny suggestions would be appreciated.</p>\n\n<pre><code>Sub LoopSubfolderAndFiles()\n\nDim fso As Object\nDim folder As Object\nDim subfolder1 As Object\nDim strTextFind1 As String\nDim strFileFound As String\nDim CurrFile As Object\nDim myFile As Object\nDim strFile As String\nDim strExtension As String\nDim wordApp As New Word.Application\n\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet folder = fso.GetFolder(\"Enter FILEPATH name..........\")\nSet subfolder1 = folder.subfolders\n\nstrTextFind1 = \"useful\"\nstrFileFound = \"test\"\nstrExtension = \".doc\"\n\nFor Each subfolder1 In subfolder1\nIf InStr(1, subfolder1.Name, strTextFind1, vbTextCompare) &gt; 0 Then\n        Set CurrFile = fso.GetFolder(subfolder1)\n        Debug.Print subfolder1.Name\nExit For\nEnd If\nNext\n\nFor Each CurrFile In CurrFile.Files\nIf InStr(1, CurrFile.Name, strFileFound, vbTextCompare) &gt; 0 Then\n    Set myFile = fso.GetFile(CurrFile)\n    strFile = myFile.Path\n   wordApp.Visible = True\n   wordApp.Documents.Open (strFile)\n   Debug.Print strFile\nEnd If\nNext\n\nSet fso = Nothing\nSet folder = Nothing\nSet subfolder1 = Nothing\nSet CurrFile = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1536733498, "post_id": 52287279, "comment_id": 91525091, "body": "Do <code>temporaryChart.Activate</code> before <code>With temporaryChart</code>. See <a href=\"https://stackoverflow.com/questions/42091390/vba-range-to-jpg-picture/42092375#42092375\" title=\"vba range to jpg picture\">stackoverflow.com/questions/42091390/vba-range-to-jpg-pictur&zwnj;&#8203;e/&hellip;</a>."}, {"owner": {"reputation": 1, "user_id": 10350838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9368b729ecb88ca54f3edf5b76134f33?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/10350838/thomas"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1536734833, "post_id": 52287279, "comment_id": 91525802, "body": "@AxelRichter Thanks a million, you&#39;ve solved my problem!"}], "owner": {"reputation": 1, "user_id": 10350838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9368b729ecb88ca54f3edf5b76134f33?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/10350838/thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536724608, "creation_date": 1536724608, "question_id": 52287279, "link": "https://stackoverflow.com/questions/52287279/excel-vba-custom-header-code-works-on-32-bit-but-not-64-bit", "title": "Excel VBA custom header code works on 32-bit but not 64-bit", "body": "<p>Context: I'm writing a list excel doc that has two sheets (Equipment List and List Inputs). I want the user to be able to input the general document info (name and date etc.) on the Inputs sheet, and this data to be captured as a snapshot and inserted into the left, centre and right header boxes. It has two different headers - one for the first page and one for every page after. </p>\n\n<p><strong>I wrote the code on excel 2013 32-bit (and it worked), only to realise that it doesn't work on any 64-bit machines. When I say it doesn't work I mean the images generated don't appear in the print preview in the header.</strong></p>\n\n<p>I'm a VBA novice and I really don't know where this code is failing, however I think it might be at the .Chart.Paste step.</p>\n\n<p>I have looked into other threads on 32 to 64 bit conversion but they all reference PtrSafe which I don't think is relevant to my code.</p>\n\n<p>How can I update my code to run on 64-bit?</p>\n\n<p>Any advice is much appreciated.\nThanks.</p>\n\n<p>Workbook:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\nCall Module1.AddHeaderToAll_FromCurrentSheet\nEnd Sub\n\nPrivate Sub Workbook_Open()\n\nEnd Sub\n</code></pre>\n\n<p>General (Module 1) Save_Object_As_Picture:</p>\n\n<pre><code>Sub AddHeaderToAll_FromCurrentSheet()\n\nDim ws As Worksheet\nDim tempFilePath As String\nDim tempPFilePath As String\nDim tempTBFilePath As String\n\nDim tempPic As Shape\nDim tempPrimeroPic As Shape\nDim tempTiBlkPic As Shape\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\nSet tempPic = ThisWorkbook.Sheets(\"List Inputs\").Shapes(\"RevBlkPic\")\nSet tempPrimeroPic = ThisWorkbook.Sheets(\"List Inputs\").Shapes(\"PrimeroPic\")\nSet tempTiBlkPic = ThisWorkbook.Sheets(\"List Inputs\").Shapes(\"TiBlkPic\")\n\n\ntempFilePath = Environ(\"temp\") &amp; \"\\image.jpg\"\nSave_Object_As_Picture tempPic, tempFilePath\n\ntempPFilePath = Environ(\"temp\") &amp; \"\\image2.jpg\"\nSave_Object_As_Picture tempPrimeroPic, tempPFilePath\n\ntempTBFilePath = Environ(\"temp\") &amp; \"\\image3.jpg\"\nSave_Object_As_Picture tempTiBlkPic, tempTBFilePath\n\n\nFor Each ws In ActiveWorkbook.Worksheets\n    'ws.PageSetup.FirstPage.CenterHeaderPicture\n'With ActiveSheet.PageSetup.DifferentFirstPageHeaderFooter = True\n\n'First Page Headers\n    ws.PageSetup.DifferentFirstPageHeaderFooter = True\n    ws.PageSetup.FirstPage.CenterHeader.Picture.Filename = tempFilePath\n    ws.PageSetup.FirstPage.CenterHeader.Text = \"&amp;G\"\n\n    ws.PageSetup.FirstPage.RightHeader.Picture.Filename = tempPFilePath\n    ws.PageSetup.FirstPage.RightHeader.Text = \"&amp;G\"\n\n    ws.PageSetup.FirstPage.LeftHeader.Picture.Filename = tempTBFilePath\n    ws.PageSetup.FirstPage.LeftHeader.Text = \"&amp;G\"\n\n\n'Different Page Headers\n    ws.PageSetup.RightHeaderPicture.Filename = tempPFilePath\n    ws.PageSetup.RightHeader = \"&amp;G\"\n\n    ws.PageSetup.LeftHeaderPicture.Filename = tempTBFilePath\n    ws.PageSetup.LeftHeader = \"&amp;G\"\n\n    ws.PageSetup.CenterHeaderPicture.Filename = tempFilePath\n    ws.PageSetup.CenterHeader = \"\"\n\n   ' ws.PageSetup.RightHeaderPicture.Filename = tempPFilePath\n   ' ws.PageSetup.RightHeader = \"&amp;G\"\n\n   ' ws.PageSetup.LeftHeaderPicture.Filename = tempTBFilePath\n   ' ws.PageSetup.LeftHeader = \"&amp;G\"\n\n\nNext ws\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n\n\nPrivate Sub Save_Object_As_Picture(saveObject As Object, imageFileName As String)\n\n'Save a picture of an object as a JPG/JPEG/GIF/PNG file\n\n'Arguments\n'saveObject     - any object in the CopyPicture method's 'Applies To' list, for example a Range or Shape\n'imageFileName  - the .gif, .jpg, or .png file name (including folder path if required) the picture will be saved as\n\nDim temporaryChart As ChartObject\n\nApplication.ScreenUpdating = False\n\nsaveObject.CopyPicture xlScreen, xlPicture\n\nSet temporaryChart = ActiveSheet.ChartObjects.Add(0, 0, saveObject.Width + 1, saveObject.Height + 1)\nWith temporaryChart\n    .Border.LineStyle = xlLineStyleNone      'No border\n     .Chart.Paste\n\n    .Chart.Export imageFileName\n    .Delete\nEnd With\n\nApplication.ScreenUpdating = True\n\nSet temporaryChart = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "edited": false, "score": 0, "creation_date": 1536724948, "post_id": 52287290, "comment_id": 91522385, "body": "fantastic! Thanks for the solution + explanation"}], "tags": [], "owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "is_accepted": true, "score": 4, "last_activity_date": 1536724904, "last_edit_date": 1536724904, "creation_date": 1536724696, "answer_id": 52287290, "question_id": 52287211, "link": "https://stackoverflow.com/questions/52287211/how-to-remove-spaces-in-vba-when-both-trim-function-and-replace-function-dont-w/52287290#52287290", "title": "How to remove spaces in VBA when both TRIM function and replace function don&#39;t work?", "body": "<p>Try this:</p>\n\n<pre><code>With Selection\n    .value = Application.WorksheetFunction.Trim(Application.WorksheetFunction.Clean(Replace(.value, Chr(160), \" \")))\nEnd With\n</code></pre>\n\n<p>The worksheet trim function gets leading and trailing as well as extra inner-string spaces (vba trim only gets leading/trailing). Clean takes out most non-printable characters. the replace on chr(160) removes a type of 'phantom' space.</p>\n"}], "owner": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1644, "favorite_count": 1, "closed_date": 1536744251, "accepted_answer_id": 52287290, "answer_count": 1, "score": 2, "last_activity_date": 1536746271, "creation_date": 1536724033, "last_edit_date": 1536746271, "question_id": 52287211, "link": "https://stackoverflow.com/questions/52287211/how-to-remove-spaces-in-vba-when-both-trim-function-and-replace-function-dont-w", "closed_reason": "Duplicate", "title": "How to remove spaces in VBA when both TRIM function and replace function don&#39;t work?", "body": "<p>Okay I know this is a fairly common question but I have done my research and I couldnt find the answer.</p>\n\n<p>I copied a table from the web and pasted in excel sheet.</p>\n\n<p>Then i proceeded to write a macro to process the sheet.</p>\n\n<p>One of the column of numbers didn't work. I found out that it contains spaces in front and back of the number, so <code>=sum</code> function couldn't work on it.</p>\n\n<p>So I wrote a simple macro to remove spaces.</p>\n\n<pre><code>Sub findandreplacespaces()\nDim i As Integer\nDim k As Integer\nDim j As Integer\n\nDim firstrow As Integer\nDim lastrow As Integer\nDim firstcol As Integer\n\n\nFor i = 1 To 8                             'I've got 8 sheets to process\nWorksheets(i).Activate\n\nlastrow = Cells(Rows.Count, 1).End(xlUp).Row     'define lastrow\n\n    Range(Cells(1, 1), Cells(lastrow, 1)).Select\nWith Selection\n    firstrow = .Find(what:=\"January\").Row         'define firstrow\nEnd With\n\nlastcol = Cells(1, Columns.Count).End(xlToLeft).Column    'define lastcolumn\n\nRange(Cells(firstrow, 2), Cells(lastrow, lastcol)).Select\nSelection.ClearFormats                                     'clear all the formating\n\nFor j = 2 To lastcol\nFor k = firstrow To lastrow\n\nCells(k, j).Select                                        'select the cell(1,1)\n\nWith Selection\n    .Replace what:=\" \", replacement:=\"\", lookat:=xlPart\nEnd With\n\n\nNext k\nNext j\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>I also tried using <code>worksheetfunction.TRIM</code> (selection), not working.</p>\n\n<p>I used <code>selection.numberformat=general /text/ number</code>, nope.</p>\n\n<p>One hint though, the numbers that aren't working are all aligned to the left of the cell.</p>\n\n<p>I suspected the cells are locked, so I unlocked them and still the macro didn't work.</p>\n\n<p>Any suggestion on how to deal with this?</p>\n\n<p>Thank you all.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1536729088, "post_id": 52287202, "comment_id": 91523396, "body": "You say <i>I want to just copy the value without the formula into another cell</i>  so you should <i>not</i> use <code>Paste:=xlPasteAllUsingSourceTheme</code>.  If you delete that line does it work?"}, {"owner": {"reputation": 13, "user_id": 6039962, "user_type": "registered", "profile_image": "https://graph.facebook.com/959236417464194/picture?type=large", "display_name": "Maurice Moh", "link": "https://stackoverflow.com/users/6039962/maurice-moh"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1536798622, "post_id": 52287202, "comment_id": 91557649, "body": "So i tried this given your recommendation unfortunately the problem still persists."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6039962, "user_type": "registered", "profile_image": "https://graph.facebook.com/959236417464194/picture?type=large", "display_name": "Maurice Moh", "link": "https://stackoverflow.com/users/6039962/maurice-moh"}, "edited": false, "score": 0, "creation_date": 1536728466, "post_id": 52287667, "comment_id": 91523241, "body": "yes the j is defined as an integer variable and it is used in a for loop to extract values in each 2nd cell of the column. I have edited the post to include the for loop. I was able to use the same code if the cell only had values that are integers or strings but with formats such as dates and formulas i was unable to clear contents of the cell and paste the contents of the cell after copying."}], "tags": [], "owner": {"reputation": 2944, "user_id": 10095272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Shi9.jpg?s=128&g=1", "display_name": "Strawberryshrub", "link": "https://stackoverflow.com/users/10095272/strawberryshrub"}, "is_accepted": false, "score": 0, "last_activity_date": 1536728200, "last_edit_date": 1536728200, "creation_date": 1536727774, "answer_id": 52287667, "question_id": 52287202, "link": "https://stackoverflow.com/questions/52287202/unable-to-paste-and-clear-contents-of-cell/52287667#52287667", "title": "Unable to paste and clear contents of cell", "body": "<p>This code worked for me:</p>\n\n<pre><code>If 1 = Cells(1, 1).Value Then 'Assuming in Cell(1, 1) is the value 1\n    Cells(1, 1).Copy\n    Range(\"B1\").PasteSpecial Paste:=xlPasteValues\n    Range(\"B1\").PasteSpecial Paste:=xlPasteFormats\n    Range(\"B1\").PasteSpecial Paste:=xlPasteAllUsingSourceTheme\n\n    Range(\"B1\").NumberFormat = \"MM/DD/YY\"\n    Cells(1, 1).Clear\nEnd If\n</code></pre>\n\n<p>Maybe the <code>Cells(j, 8).Value</code> is your problem. What value does <code>j</code> have? If <code>j</code> is a variable your code should be right, but if you mean <code>J</code> as column name the code should be <code>Range(\"J\" &amp; 8).Value</code> or <code>Cells(8, \"J\").Value</code> instead of <code>Cells(j, 8).Value</code></p>\n"}], "owner": {"reputation": 13, "user_id": 6039962, "user_type": "registered", "profile_image": "https://graph.facebook.com/959236417464194/picture?type=large", "display_name": "Maurice Moh", "link": "https://stackoverflow.com/users/6039962/maurice-moh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536728368, "creation_date": 1536723951, "last_edit_date": 1536728368, "question_id": 52287202, "link": "https://stackoverflow.com/questions/52287202/unable-to-paste-and-clear-contents-of-cell", "title": "Unable to paste and clear contents of cell", "body": "<p><strong>Here is my code:</strong></p>\n\n<pre><code>For j = 3 To 37 Step 2\nIf PaddleBDateInstalledTextBox.Value = Cells(j, 8).Value Then\n        Cells(j, 8).Copy\n        Range(\"D42\").PasteSpecial Paste:=xlPasteValues\n        Range(\"D42\").PasteSpecial Paste:=xlPasteFormats\n        Range(\"D42\").PasteSpecial Paste:=xlPasteAllUsingSourceTheme '&lt;-- \n        cells background, etc.\n        Range(\"D42\").NumberFormat = \"MM/DD/YY\"\n        Cells(j, 8).Clear\n End If\nNext\n</code></pre>\n\n<p>I have one cell where the format is a date and I am trying to copy it first and then paste it into another cell but my cell did not have the value pasted in it and the original cell; and the contents were not cleared.</p>\n\n<p>I have another cell that has the format <code>Today()</code> and I want to just copy the value without the formula into another cell but i have failed as well.</p>\n\n<p>The last cell that I want to copy has a formula of <code>=($I$2-H2)+(G2-F2)</code> and I have the same problem.</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 1205, "user_id": 8578580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a063b2c15a5847791ed1e0007d04b8c0?s=128&d=identicon&r=PG&f=1", "display_name": "TechnoDabbler", "link": "https://stackoverflow.com/users/8578580/technodabbler"}, "edited": false, "score": 1, "creation_date": 1536721117, "post_id": 52286683, "comment_id": 91521658, "body": "Exact is not a native VBA function. That&#39;s why your code gets the function not defined error."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 1, "creation_date": 1536721247, "post_id": 52286683, "comment_id": 91521681, "body": "funny I was just about to look up what EXACT function was since I had never stumbled across it before in excel formulas."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 1, "creation_date": 1536723299, "post_id": 52286683, "comment_id": 91522042, "body": "What a relief to see a post with a specific question and attempted code. Thanks Anu - good question."}], "answers": [{"comments": [{"owner": {"reputation": 849, "user_id": 9151274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49f96542b2315af0983a1e2aae197d2b?s=128&d=identicon&r=PG", "display_name": "Anu", "link": "https://stackoverflow.com/users/9151274/anu"}, "edited": false, "score": 0, "creation_date": 1536743667, "post_id": 52287020, "comment_id": 91530983, "body": "Thank you for the solution. I used the evaluate method and it works fine. Although I am curious why the formula is starting with <code>SumProduc</code>t!! <code>CountIf</code> makes more sense to understand what the formula doing"}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 849, "user_id": 9151274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49f96542b2315af0983a1e2aae197d2b?s=128&d=identicon&r=PG", "display_name": "Anu", "link": "https://stackoverflow.com/users/9151274/anu"}, "edited": false, "score": 1, "creation_date": 1536744734, "post_id": 52287020, "comment_id": 91531660, "body": "Quite right; <code>CountIf\u2026</code> would be better. If you use the evaluate method, just be watchful of your unqualified range. If you&#39;re not using the active sheet then you might need to specify the worksheet name as part of the range definition."}, {"owner": {"reputation": 849, "user_id": 9151274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49f96542b2315af0983a1e2aae197d2b?s=128&d=identicon&r=PG", "display_name": "Anu", "link": "https://stackoverflow.com/users/9151274/anu"}, "edited": false, "score": 0, "creation_date": 1536799293, "post_id": 52287020, "comment_id": 91557760, "body": "Thanks. My case, I am using a dynamic range specified by some other part of program. So I guess I am safe about it. So far my program works well and testing didn&#39;t show any error."}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": true, "score": 3, "last_activity_date": 1536722461, "creation_date": 1536722461, "answer_id": 52287020, "question_id": 52286683, "link": "https://stackoverflow.com/questions/52286683/why-sumproduct-cannot-use-in-excel-vba/52287020#52287020", "title": "Why SumProduct cannot use in Excel VBA", "body": "<p>The issue is with the <code>EXACT</code> function, which <code>WorksheetFunction</code> does not expose.</p>\n\n<p>For unexposed Excel functions, a common workaround is to convert the expression to a string and call the <code>Evaluate</code> function. A rudimentary routine would look like this:</p>\n\n<pre><code>Public Function SumProductExact(rng As Range, testItem As String) As Long\n    Dim evalExpr As String\n\n    On Error GoTo EH\n    evalExpr = \"=SUMPRODUCT(--(EXACT(\" &amp; rng.Address &amp; \", \"\"\" &amp; testItem &amp; \"\"\")))\"\n    SumProductExact = Evaluate(evalExpr)\n    Exit Function\n\nEH:\n    SumProductExact = -1\nEnd Function\n</code></pre>\n\n<p>and would be called like so:</p>\n\n<pre><code>Debug.Print SumProductExact(Sheet1.Range(\"A1:A10\"), \"Apple\")\n</code></pre>\n\n<p>But it hardly seems worth going to those lengths for a relatively trivial function, so you could just write your own <code>CountIf</code> function for an exact match. You might want to expand this to cater for other type comparisons, like dates, but fundamentally it would look like this:</p>\n\n<pre><code>Public Function CountIfExact(rng As Range, testItem As Variant) As Long\n    Dim v As Variant\n    Dim c As Long\n\n    On Error GoTo EH\n    For Each v In rng.Value2\n        If v = testItem Then c = c + 1\n    Next\n\n    CountIfExact = c\n    Exit Function\n\nEH:\n    CountIfExact = -1\nEnd Function\n</code></pre>\n\n<p>which would be called as follows:</p>\n\n<pre><code>Debug.Print CountIfExact(Sheet1.Range(\"A1:A10\"), \"Apple\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 849, "user_id": 9151274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49f96542b2315af0983a1e2aae197d2b?s=128&d=identicon&r=PG", "display_name": "Anu", "link": "https://stackoverflow.com/users/9151274/anu"}, "is_accepted": false, "score": 0, "last_activity_date": 1536743910, "creation_date": 1536743910, "answer_id": 52291675, "question_id": 52286683, "link": "https://stackoverflow.com/questions/52286683/why-sumproduct-cannot-use-in-excel-vba/52291675#52291675", "title": "Why SumProduct cannot use in Excel VBA", "body": "<p>I used one of the above solutions and it solved the problem. Entire code as below</p>\n\n<pre><code>Public c As Integer\n\nSub findVal()\nCall SumProductExact(Sheet1.Range(\"A1:A10\"), \"Apple\")\nMsgBox c ' You can use this c value for other calculations\n\nEnd Sub\n\nPublic Function SumProductExact(rng As Range, testItem As String) As Long\n    Dim evalExpr As String\n\n    On Error GoTo EH\n    evalExpr = \"=SUMPRODUCT(--(EXACT(\" &amp; rng.Address &amp; \", \"\"\" &amp; testItem &amp; \"\"\")))\"\n    SumProductExact = Evaluate(evalExpr)\n    c = SumProductExact\n    Exit Function\n\nEH:\n    SumProductExact = -1\nEnd Function\n</code></pre>\n\n<p>Take note that for the above code, it is using static range which is A1:A10 and a static name Apple. You may change it to a dynamic range and name according to your needs.</p>\n"}], "owner": {"reputation": 849, "user_id": 9151274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49f96542b2315af0983a1e2aae197d2b?s=128&d=identicon&r=PG", "display_name": "Anu", "link": "https://stackoverflow.com/users/9151274/anu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 52287020, "answer_count": 2, "score": 2, "last_activity_date": 1536743910, "creation_date": 1536719793, "question_id": 52286683, "link": "https://stackoverflow.com/questions/52286683/why-sumproduct-cannot-use-in-excel-vba", "title": "Why SumProduct cannot use in Excel VBA", "body": "<p><strong>Scenario</strong></p>\n\n<p>I am trying to use <code>COUNTIF</code> in my VBA code to count total how many similar string found in a range. But realised <code>COUNTIF</code> is not case sensitive. Eg: I want to count how many Apple in a range. But sometimes if in that range got apple, it is counting that also. Code as below. Consider <code>Range(poRange)</code> something like <code>C1:C100</code> and <code>Trim(mainpage.po.value)</code> as Apple</p>\n\n<pre><code>iVal = Application.WorksheetFunction.CountIf(Range(poRange), Trim(mainPage.po.Value))\n</code></pre>\n\n<p>Thus I decided to use another method which is </p>\n\n<pre><code>iVal = Application.WorksheetFunction.SumProduct(--(EXACT(Range(poRange), Trim(mainPage.po.Value))))\n</code></pre>\n\n<p>But this time I couldn't run my VBA due to Compile time error '<code>Sub or Function not defined</code>'</p>\n\n<p>Could someone help me please?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 429, "user_id": 1406609, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0c20387b206378db5b52532238478a34?s=128&d=identicon&r=PG", "display_name": "FancyDolphin", "link": "https://stackoverflow.com/users/1406609/fancydolphin"}, "edited": false, "score": 0, "creation_date": 1536719856, "post_id": 52286668, "comment_id": 91521399, "body": "I didn&#39;t think it needed it. I knew it was a stupid question I just couldn&#39;t find the awnser and was searching for 20min. Thank you"}, {"owner": {"reputation": 2516, "user_id": 845584, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a246580bf7e75e1530aa585b196d6f0f?s=128&d=identicon&r=PG", "display_name": "PeterX", "link": "https://stackoverflow.com/users/845584/peterx"}, "edited": false, "score": 1, "creation_date": 1554423918, "post_id": 52286668, "comment_id": 97757413, "body": "This didn&#39;t work for me - the data validation was not retained. I had to use: <code>.PasteSpecial xlPasteValidation</code>"}, {"owner": {"reputation": 1205, "user_id": 8578580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a063b2c15a5847791ed1e0007d04b8c0?s=128&d=identicon&r=PG&f=1", "display_name": "TechnoDabbler", "link": "https://stackoverflow.com/users/8578580/technodabbler"}, "reply_to_user": {"reputation": 2516, "user_id": 845584, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a246580bf7e75e1530aa585b196d6f0f?s=128&d=identicon&r=PG", "display_name": "PeterX", "link": "https://stackoverflow.com/users/845584/peterx"}, "edited": false, "score": 1, "creation_date": 1555391761, "post_id": 52286668, "comment_id": 98083359, "body": "@PeterX ... you&#39;re right. Can&#39;t see what I was thinking. Answer updated."}], "tags": [], "owner": {"reputation": 1205, "user_id": 8578580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a063b2c15a5847791ed1e0007d04b8c0?s=128&d=identicon&r=PG&f=1", "display_name": "TechnoDabbler", "link": "https://stackoverflow.com/users/8578580/technodabbler"}, "is_accepted": true, "score": 0, "last_activity_date": 1555391703, "last_edit_date": 1555391703, "creation_date": 1536719691, "answer_id": 52286668, "question_id": 52286481, "link": "https://stackoverflow.com/questions/52286481/how-to-copy-and-paste-and-retain-the-data-validation/52286668#52286668", "title": "How to copy and paste and retain the data validation?", "body": "<p>You don't give any context. I assume you're copying with VBA. If your code copies and then uses .PasteSpecial with a Paste type of xlPasteValues, formatting of the destination cell (including data validation) will be retained ... an example being ...</p>\n\n<pre><code>Public Sub test()\n    Worksheets(\"Sheet1\").Range(\"A1\").Copy\n    Worksheets(\"Sheet1\").Range(\"B1\").PasteSpecial (xlPasteValues)\n    Worksheets(\"Sheet1\").Range(\"B1\").PasteSpecial (xlPasteValidation)\nEnd Sub\n</code></pre>\n\n<p>Also refer to: <a href=\"https://stackoverflow.com/questions/36810625/paste-vs-pastespecial\">Paste vs PasteSpecial</a></p>\n"}, {"tags": [], "owner": {"reputation": 5315, "user_id": 910087, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a64c36afe6bdcbec49d624acef6c018f?s=128&d=identicon&r=PG&f=1", "display_name": "Gerhard Powell", "link": "https://stackoverflow.com/users/910087/gerhard-powell"}, "is_accepted": false, "score": 0, "last_activity_date": 1584747169, "creation_date": 1584747169, "answer_id": 60782931, "question_id": 52286481, "link": "https://stackoverflow.com/questions/52286481/how-to-copy-and-paste-and-retain-the-data-validation/60782931#60782931", "title": "How to copy and paste and retain the data validation?", "body": "<p>Here is a VBA example of how to add the validation back after any change:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    With Range(\"Table1[Column1]\").Validation\n        .Delete\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertWarning, Operator _\n        :=xlBetween, Formula1:=\"=INDIRECT(\"\"Table2\"\")\"\n        .IgnoreBlank = True\n        .InCellDropdown = True\n        .InputTitle = \"\"\n        .ErrorTitle = \"\"\n        .InputMessage = \"\"\n        .ErrorMessage = \"\"\n        .ShowInput = False\n        .ShowError = True\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 429, "user_id": 1406609, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0c20387b206378db5b52532238478a34?s=128&d=identicon&r=PG", "display_name": "FancyDolphin", "link": "https://stackoverflow.com/users/1406609/fancydolphin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3291, "favorite_count": 0, "accepted_answer_id": 52286668, "answer_count": 2, "score": 0, "last_activity_date": 1584747169, "creation_date": 1536717976, "last_edit_date": 1558007480, "question_id": 52286481, "link": "https://stackoverflow.com/questions/52286481/how-to-copy-and-paste-and-retain-the-data-validation", "title": "How to copy and paste and retain the data validation?", "body": "<p>The data is 100% right.</p>\n\n<p>I want to paste the data into the cell with data validation and keep the data validation.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1536715455, "post_id": 52285160, "comment_id": 91520543, "body": "remove the brackets and use text-to-columns"}], "answers": [{"comments": [{"owner": {"reputation": 1205, "user_id": 8578580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a063b2c15a5847791ed1e0007d04b8c0?s=128&d=identicon&r=PG&f=1", "display_name": "TechnoDabbler", "link": "https://stackoverflow.com/users/8578580/technodabbler"}, "edited": false, "score": 0, "creation_date": 1536722335, "post_id": 52285799, "comment_id": 91521899, "body": "elegant answer."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 4, "last_activity_date": 1536711897, "creation_date": 1536711897, "answer_id": 52285799, "question_id": 52285160, "link": "https://stackoverflow.com/questions/52285160/separate-each-entry-in-an-array-and-put-in-its-own-cell/52285799#52285799", "title": "Separate each entry in an array and put in its own cell", "body": "<p>Put the values into a variant array and put them on the worksheet.</p>\n\n<pre><code>dim arr as variant\n\narr = array(0,1,2,3,4,5,6,7,8,9)\n\nwith worksheets(\"sheet1\")\n    .range(\"C1\").resize(1, ubound(arr)+1) = arr\nend with\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9060078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db4d4cb9464e3bbd529c1f06dab090fc?s=128&d=identicon&r=PG&f=1", "display_name": "B. Harm", "link": "https://stackoverflow.com/users/9060078/b-harm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1558574505, "creation_date": 1536706229, "last_edit_date": 1558574505, "question_id": 52285160, "link": "https://stackoverflow.com/questions/52285160/separate-each-entry-in-an-array-and-put-in-its-own-cell", "title": "Separate each entry in an array and put in its own cell", "body": "<p>A cell consists of an array that looks similar to this:</p>\n\n<blockquote>\n  <p>[0,1,2,3,4,5,6,7,8,9].</p>\n</blockquote>\n\n<p>How do I put each individual one into its own cell?</p>\n\n<p>For example; 0 in C1, 1 in D1, 2 in E1 and so forth.</p>\n"}, {"tags": ["excel", "vba", "customization"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1536706396, "post_id": 52285089, "comment_id": 91518623, "body": "Which exact part is giving you a problem? Think about how you&#39;d do it manually, then recreate the logic in VBA - if there&#39;s a specific part of that you&#39;re not sure about, then it would help to explain it in your post.  &quot;how can I create a macro that will ...&quot; is a bit too broad. <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>"}, {"owner": {"reputation": 3, "user_id": 10349994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07cf25329c5afe97aed9cf6ce8d7c7a8?s=128&d=identicon&r=PG&f=1", "display_name": "ForcePushThinkr", "link": "https://stackoverflow.com/users/10349994/forcepushthinkr"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1536707870, "post_id": 52285089, "comment_id": 91518968, "body": "@TimWilliams, I thought it was clear from the post that the code is giving me the problem. I don&#39;t know how to program macros. I would need some help with the entire code, top to bottom, since I can&#39;t find anywhere to get that information without signing up for full advanced Excel class that would probably take me three months to get anywhere near the info I need and I was hoping to be able to have this figured out by the end of this week. There is no other way to do this than a macro, since the only other option is to hand write the table myself every time I need to change the set up."}, {"owner": {"reputation": 402, "user_id": 5373329, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153280169888425/picture?type=large", "display_name": "Bharat Anand", "link": "https://stackoverflow.com/users/5373329/bharat-anand"}, "edited": false, "score": 0, "creation_date": 1536712821, "post_id": 52285089, "comment_id": 91520043, "body": "@ForcePushThinkr, SO platform doesn&#39;t encourage such broad questions. Let&#39;s us say even if someone gave you the code, how will you go about implementing it in your excel. e.g. do you know how to create a macro, do you know how to create a button, do you know how to link a macro to a button. If you do, great, you have already done some groundwork, if not try to pick those up first, and then explain what you have completed and where are you headed to on your next step. I&#39;m trying to see if I can provide you a code sample to get you started on these lines"}], "answers": [{"tags": [], "owner": {"reputation": 402, "user_id": 5373329, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153280169888425/picture?type=large", "display_name": "Bharat Anand", "link": "https://stackoverflow.com/users/5373329/bharat-anand"}, "is_accepted": false, "score": 0, "last_activity_date": 1536718382, "creation_date": 1536718382, "answer_id": 52286518, "question_id": 52285089, "link": "https://stackoverflow.com/questions/52285089/how-do-i-use-a-list-on-one-tab-in-excel-to-create-new-columns-in-another-tab/52286518#52286518", "title": "How do I use a list on one tab in Excel to create new columns in another tab?", "body": "<p>Here is the macro code. </p>\n\n<p>Excel Setup:</p>\n\n<ol>\n<li>Your list of values should be present in \"Sheet2\", Columns A &amp; B</li>\n<li>There is a limit of 20 values, modify the code if you have more values in your list</li>\n<li>Values will be copied over to \"Sheet1\" Row1 start Column B onwards</li>\n</ol>\n\n<blockquote>\n<pre><code>Sub CreateTable()\n'\n' CreateTable Macro\n'\n\n'\nDim rng1 As Range, rng2 As Range, cell As Range\nDim i As Integer, destCol As Integer, limit As Integer\n\ndestCol = 2\nlimit = 20\n\n'Clear values from the Column headers that already exist from previous run\nFor i = 2 To limit + 2\n    Cells(1, i) = \"\"\nNext i\n\n'Write new column headers based upon the updated list\nFor i = 1 To limit\n    If Worksheets(\"Sheet2\").Range(\"B\" &amp; i) = \"x\" Then\n        Cells(1, destCol).Value = Worksheets(\"Sheet2\").Range(\"A\" &amp; i)\n        destCol = destCol + 1\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 3, "user_id": 10349994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07cf25329c5afe97aed9cf6ce8d7c7a8?s=128&d=identicon&r=PG&f=1", "display_name": "ForcePushThinkr", "link": "https://stackoverflow.com/users/10349994/forcepushthinkr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536735662, "creation_date": 1536705686, "last_edit_date": 1536735662, "question_id": 52285089, "link": "https://stackoverflow.com/questions/52285089/how-do-i-use-a-list-on-one-tab-in-excel-to-create-new-columns-in-another-tab", "title": "How do I use a list on one tab in Excel to create new columns in another tab?", "body": "<p>I would need some help with creating a customizable table in MS Excel. </p>\n\n<p>I am trying to put together a MS Excel spreadsheet for work to track certain metrics in our day to day operation. I would like the file to be rather flexible in the combination of metrics that it will allow to be tracked when finished.</p>\n\n<p>I have one tab in the spreadsheet that contains the various metrics that I would like to track information for, and I would like to be able to simply go into that tab, mark the relevant entries by entering an \"x\" in the cell next to them, and have a column added in the main tab of the file for every entry marked this way. Any values for these entries will entered manually in the main tab, in the rows for the appropriate sub sets, which are permanent cell values in the main tab. I would just like to be able to create a custom table in one tab, with appropriate columns based on the desired/marked data in the second tab. I know that this will require programming some macros, but I don't know how to create a macro that will allow me to click a button in the spreadsheet and then have the spreadsheet automatically add columns for each value selected in the secondary tab.</p>\n\n<p>How can I program a macro, that enables a button to be pressed in the spreadsheet, which will then look up any cells marked with an \"x\" next to them and create a new column in tab1 using the value of each cell in tab2 as the header in the table in tab1? I can't find any information online on what coding commands would perform that task and since there is no way in Excel to complete this other than looking up the header info and writing it into the relevant cells myself, I can't find any associations to help me figure this out myself either.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1536704361, "post_id": 52284908, "comment_id": 91518114, "body": "<a href=\"https://codereview.stackexchange.com/questions\">codereview.stackexchange.com/questions</a>"}, {"owner": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "edited": false, "score": 0, "creation_date": 1536704563, "post_id": 52284908, "comment_id": 91518184, "body": "Welcome, @RoakuSezoire! At just a glance, one thing you can do is for every line that has <code>Range(&quot;B2&quot;).Select</code> (or any other range that isn&#39;t <code>B2</code>), delete that line and replace the next <code>ActiveCell.FormulaR1C1</code> with <code>Range(&quot;B2&quot;).FormulaR1C1</code>. This is just an example. Basically, any place that has <code>.Select</code> can be removed and the <code>Range</code> reference can replace the immediately following <code>ActiveCell</code>. No need to select it first."}, {"owner": {"reputation": 29, "user_id": 10328624, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ix0Xp0iUgmM/AAAAAAAAAAI/AAAAAAAAAQk/vSXhsIEYzRs/photo.jpg?sz=128", "display_name": "Roaku Sezoire", "link": "https://stackoverflow.com/users/10328624/roaku-sezoire"}, "edited": false, "score": 0, "creation_date": 1536706713, "post_id": 52284908, "comment_id": 91518690, "body": "Thanks Totsie! Its looking much better with your suggestion. Is there a way to make the below account for a change in range?  <code>Selection.AutoFill Destination:=Range(&quot;A2:A520&quot;), Type:=xlFillDefaul</code>"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 10328624, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ix0Xp0iUgmM/AAAAAAAAAAI/AAAAAAAAAQk/vSXhsIEYzRs/photo.jpg?sz=128", "display_name": "Roaku Sezoire", "link": "https://stackoverflow.com/users/10328624/roaku-sezoire"}, "edited": false, "score": 0, "creation_date": 1536706282, "post_id": 52285061, "comment_id": 91518601, "body": "Hi Valon, thank you for your response! What if my range changes? How can I account for when I need the data to autofill to the correct range in the sheet based on the data of the other sheet? How do I use the .end(1xUp) code? I think that one would make it fill until the end of the active cells?"}, {"owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "reply_to_user": {"reputation": 29, "user_id": 10328624, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ix0Xp0iUgmM/AAAAAAAAAAI/AAAAAAAAAQk/vSXhsIEYzRs/photo.jpg?sz=128", "display_name": "Roaku Sezoire", "link": "https://stackoverflow.com/users/10328624/roaku-sezoire"}, "edited": false, "score": 0, "creation_date": 1536708139, "post_id": 52285061, "comment_id": 91519045, "body": "It looks like your data is in a table, so you could change the reference to a listcolumn, which is dynamic. I just don&#39;t have enough info from your post. For example, you could use <code>thisworkbook.sheets(&quot;[sheet name]&quot;).listobject(&quot;[Table Name]&quot;).listcolumns(&quot;[column name]&quot;).databodyrange.formula = &quot;[Formula]&quot;</code>"}, {"owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "reply_to_user": {"reputation": 29, "user_id": 10328624, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ix0Xp0iUgmM/AAAAAAAAAAI/AAAAAAAAAQk/vSXhsIEYzRs/photo.jpg?sz=128", "display_name": "Roaku Sezoire", "link": "https://stackoverflow.com/users/10328624/roaku-sezoire"}, "edited": false, "score": 0, "creation_date": 1536708465, "post_id": 52285061, "comment_id": 91519128, "body": "What is the name of the sheet, table, and columns that these formulas are in?"}, {"owner": {"reputation": 29, "user_id": 10328624, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ix0Xp0iUgmM/AAAAAAAAAAI/AAAAAAAAAQk/vSXhsIEYzRs/photo.jpg?sz=128", "display_name": "Roaku Sezoire", "link": "https://stackoverflow.com/users/10328624/roaku-sezoire"}, "edited": false, "score": 0, "creation_date": 1536716219, "post_id": 52285061, "comment_id": 91520692, "body": "Name of sheet with table &quot;Risk Partner Data&quot;, table name &quot;RPData&quot;, columns are named in my original code. The sheet where the data is to be calculated in is &quot;Calc Data&quot; and it has no table just A - J calculation results based on my formula which uses the data stored in the table &quot;RP data&quot;."}], "tags": [], "owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "is_accepted": false, "score": 0, "last_activity_date": 1536705449, "creation_date": 1536705449, "answer_id": 52285061, "question_id": 52284908, "link": "https://stackoverflow.com/questions/52284908/how-to-simplify-code-uses-activecell-formulas-autofit-columns/52285061#52285061", "title": "How to simplify code uses ActiveCell &amp; Formulas &amp; Autofit Columns?", "body": "<p>You haven't provided much context, but this might get you started.</p>\n\n<p>You can eliminate all of the selection switching and autofill stuff:</p>\n\n<pre><code>Range(\"A2:A520\").Formula = \"=CONCATENATE(RPdata[@[Parish Code]]&amp;\"\", \"\"&amp;RPdata[@Parish])\"\n\nRange(\"B2:B505\").Formula = \"=RPdata[@[Building ID 1]]\"\n\nColumns(\"A:A\").EntireColumn.AutoFit\n\nRange(\"F2:F505\").Formula = _\n\"=IF(RPdata[@[Basis of Cover]]=\"\"Demolition\"\",RPdata[@Demolition],IF(RPdata[@[Basis of Cover]]=\"\"Replacement\"\",SUM(RPdata[@[Replacement Value]:[Demolition]]), IF(RPdata[@[Basis of Cover]]=\"\"Indemnity\"\",SUM(RPdata[@[Indemnity Value]:[Indemnity Inflation Value]],RPdata[@[Agreed Value]]))))\"\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 10328624, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ix0Xp0iUgmM/AAAAAAAAAAI/AAAAAAAAAQk/vSXhsIEYzRs/photo.jpg?sz=128", "display_name": "Roaku Sezoire", "link": "https://stackoverflow.com/users/10328624/roaku-sezoire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1536705610, "creation_date": 1536704250, "question_id": 52284908, "link": "https://stackoverflow.com/questions/52284908/how-to-simplify-code-uses-activecell-formulas-autofit-columns", "title": "How to simplify code uses ActiveCell &amp; Formulas &amp; Autofit Columns?", "body": "<p>Have data in \"Risk Partner Data\" sheet and calculations to appear in \"Calc Data\" </p>\n\n<p>How would I simplify the below code?</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = _\n        \"=CONCATENATE(RPdata[@[Parish Code]]&amp;\"\", \"\"&amp;RPdata[@Parish])\"\n    Range(\"A2\").Select\n    Selection.AutoFill Destination:=Range(\"A2:A520\"), Type:=xlFillDefault\n    Range(\"A2:A520\").Select\n    Columns(\"A:A\").EntireColumn.AutoFit\nRange(\"B2\").Select\nActiveCell.FormulaR1C1 = \"=RPdata[@[Building ID 1]]\"\nRange(\"B2\").Select\nSelection.AutoFill Destination:=Range(\"B2:B505\")\nRange(\"B2:B505\").Select\nRange(\"F2\").Select\n    ActiveCell.FormulaR1C1 = _\n        \"=IF(RPdata[@[Basis of Cover]]=\"\"Demolition\"\",RPdata[@Demolition],IF(RPdata[@[Basis of Cover]]=\"\"Replacement\"\",SUM(RPdata[@[Replacement Value]:[Demolition]]), IF(RPdata[@[Basis of Cover]]=\"\"Indemnity\"\",SUM(RPdata[@[Indemnity Value]:[Indemnity Inflation Value]],RPdata[@[Agreed Value]]))))\"\n    Range(\"F3\").Select\n    Sheets(\"Calc Data\").Select\n    Range(\"F2\").Select\n    Selection.AutoFill Destination:=Range(\"F2:F505\")\n    Range(\"F2:F505\").Select\n</code></pre>\n\n<p>My Objective: Should data change in the \"Risk Partner Data\" it be automatically picked up in the \"Calc Data\" sheet. Fill for all active cells .End(1xUp)?</p>\n\n<p>Would appreciate assistance.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1536704179, "post_id": 52284859, "comment_id": 91518067, "body": "in vba the formula needs to be entered in as it would be in the united states, using <code>,</code> for <code>;</code> and <code>.</code> for the decimal separator.  Or you can use <code>.FormulaLocal</code> which then allows the use of the local style.  But is not portable to other styles."}, {"owner": {"reputation": 33, "user_id": 4455739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d300a5cf0e8464d1e16e37b3523c3177?s=128&d=identicon&r=PG&f=1", "display_name": "diadiaki", "link": "https://stackoverflow.com/users/4455739/diadiaki"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1536704440, "post_id": 52284859, "comment_id": 91518138, "body": "@ScottCraner I changed it to .FormulaLocal but I still get the same error. If I use , for ; is it posseble for the funcion to conflict with my excel&#39;s local style?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1536704773, "post_id": 52284859, "comment_id": 91518246, "body": "Save the formula to a text variable then view that variable, does the formula make sense?  can you paste it here?"}, {"owner": {"reputation": 33, "user_id": 4455739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d300a5cf0e8464d1e16e37b3523c3177?s=128&d=identicon&r=PG&f=1", "display_name": "diadiaki", "link": "https://stackoverflow.com/users/4455739/diadiaki"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1536706138, "post_id": 52284859, "comment_id": 91518565, "body": "@ScottCraner &quot;=if((-)&gt;0.59,(--0.4)*100*,(-)*100*)&quot; I guess that blank cells are the problem."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1536709002, "post_id": 52284859, "comment_id": 91519239, "body": "You can&#39;t use <code>Value</code> to build the formula - you need to use <code>Address</code> if you want it to be able to recalculate."}], "owner": {"reputation": 33, "user_id": 4455739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d300a5cf0e8464d1e16e37b3523c3177?s=128&d=identicon&r=PG&f=1", "display_name": "diadiaki", "link": "https://stackoverflow.com/users/4455739/diadiaki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536703964, "creation_date": 1536703964, "question_id": 52284859, "link": "https://stackoverflow.com/questions/52284859/vba-can-i-use-formulas-for-calculations-with-blank-cells", "title": "VBA - Can I use formulas for calculations with blank cells?", "body": "<p>I want to add to a cell a funcion which addresses to black cells which are going to be filled later.\nI have the following code:</p>\n\n<pre><code>Sheets(3).Cells(Kit.Row + 1, Kit.Column + 5).Formula = \"=if((\" &amp; Sheets(3).Cells(Kit.Row + 1, Kit.Column + 4).Value &amp; \"-\" &amp; Sheets(3).Cells(Kit.Row + 1, Kit.Column + 3).Value &amp; \")&gt;0,59;(\" &amp; Sheets(3).Cells(Kit.Row + 1, Kit.Column + 4).Value &amp; \"-\" &amp; Sheets(3).Cells(Kit.Row + 1, Kit.Column + 3).Value &amp; \"-0,4)*100*\" &amp; Sheets(3).Cells(Kit.Row + 1, Kit.Column + 2) &amp; \";(\" &amp; Sheets(3).Cells(Kit.Row + 1, Kit.Column + 4).Value &amp; \"-\" &amp; Sheets(3).Cells(Kit.Row + 1, Kit.Column + 3).Value &amp; \")*100*\" &amp; Sheets(3).Cells(Kit.Row + 1, Kit.Column + 2) &amp; \")\"\n</code></pre>\n\n<p>I get the error message:\"application defined or object defined error\".</p>\n"}, {"tags": ["arrays", "vba", "excel", "copy-paste"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1536704038, "post_id": 52284742, "comment_id": 91518010, "body": "Is the CSV data a contiguous block with no blank rows/columns? I would create a two-column table on a sheet in your xlsm, with one column for the file name and another for the destination sheet.  Then loop over that table row by row and open/copy/paste/close as you go."}, {"owner": {"reputation": 167, "user_id": 5725420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017faecd3978c1585fe0ca21a2b76f40?s=128&d=identicon&r=PG&f=1", "display_name": "C.A.R.", "link": "https://stackoverflow.com/users/5725420/c-a-r"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1536763823, "post_id": 52284742, "comment_id": 91543792, "body": "Love this idea Tim! I will run it by the team to make sure an extra tab won&#39;t mess up other processes."}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 5725420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017faecd3978c1585fe0ca21a2b76f40?s=128&d=identicon&r=PG&f=1", "display_name": "C.A.R.", "link": "https://stackoverflow.com/users/5725420/c-a-r"}, "edited": false, "score": 0, "creation_date": 1536763939, "post_id": 52284928, "comment_id": 91543874, "body": "Clarification: when you say that it relies on contiguous data, is that just contiguous in Column A or in all columns? In general, I don&#39;t think it&#39;s safe to assume that ALL columns are contiguous."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 167, "user_id": 5725420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017faecd3978c1585fe0ca21a2b76f40?s=128&d=identicon&r=PG&f=1", "display_name": "C.A.R.", "link": "https://stackoverflow.com/users/5725420/c-a-r"}, "edited": false, "score": 0, "creation_date": 1536764465, "post_id": 52284928, "comment_id": 91544199, "body": "If you select A1 on the sheet and press Ctrl+A (select all) does it select the full set of data?  Should be fine as long as the data doesn&#39;t contain blank rows or columns."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 167, "user_id": 5725420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017faecd3978c1585fe0ca21a2b76f40?s=128&d=identicon&r=PG&f=1", "display_name": "C.A.R.", "link": "https://stackoverflow.com/users/5725420/c-a-r"}, "edited": false, "score": 0, "creation_date": 1536769116, "post_id": 52284928, "comment_id": 91546861, "body": "If that&#39;s a problem then consider using <code>wb.Sheets(1).UsedRange</code> instead."}, {"owner": {"reputation": 167, "user_id": 5725420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017faecd3978c1585fe0ca21a2b76f40?s=128&d=identicon&r=PG&f=1", "display_name": "C.A.R.", "link": "https://stackoverflow.com/users/5725420/c-a-r"}, "edited": false, "score": 0, "creation_date": 1536780557, "post_id": 52284928, "comment_id": 91552210, "body": "Confirmed that we can do contiguous data. Your method is a good test. Also, tested it and there is ONE minor error:     Set wb = Workbook should be     Set wb = Workbooks. Found this by using Option Explicit for the module. Otherwise, it was throwing a 424 Object Required code and I couldn&#39;t figure out why."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 167, "user_id": 5725420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017faecd3978c1585fe0ca21a2b76f40?s=128&d=identicon&r=PG&f=1", "display_name": "C.A.R.", "link": "https://stackoverflow.com/users/5725420/c-a-r"}, "edited": false, "score": 0, "creation_date": 1536781193, "post_id": 52284928, "comment_id": 91552510, "body": "OK - glad to see you figured it out.  Fixed the typo in the code."}, {"owner": {"reputation": 167, "user_id": 5725420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017faecd3978c1585fe0ca21a2b76f40?s=128&d=identicon&r=PG&f=1", "display_name": "C.A.R.", "link": "https://stackoverflow.com/users/5725420/c-a-r"}, "edited": false, "score": 0, "creation_date": 1537277038, "post_id": 52284928, "comment_id": 91719788, "body": "Tim, I am running into a problem with Excel opening the CSVs and converting data wrong. I found this: <a href=\"https://stackoverflow.com/a/10735928/5725420\">stackoverflow.com/a/10735928/5725420</a>. What is the difference between your <code>Set wb = Workbooks.Open(ThisWorkbook.Path &amp; &quot;\\&quot; &amp; rw.Cells(1).Value)</code> and his <code>Open (ThisWorkbook.Path &amp; &quot;\\&quot; &amp; rw.Cells(1).Value) For Input As wb</code> ? I can&#39;t get the latter to actually do anything - it just ends the sub without any action."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 167, "user_id": 5725420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017faecd3978c1585fe0ca21a2b76f40?s=128&d=identicon&r=PG&f=1", "display_name": "C.A.R.", "link": "https://stackoverflow.com/users/5725420/c-a-r"}, "edited": false, "score": 0, "creation_date": 1537282493, "post_id": 52284928, "comment_id": 91723590, "body": "If you&#39;re having conversion errors then try using Data &gt;&gt; From Text and stepping through the options in that dialog: record a macro while doing that and it will give you a starting point."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1536781171, "last_edit_date": 1536781171, "creation_date": 1536704418, "answer_id": 52284928, "question_id": 52284742, "link": "https://stackoverflow.com/questions/52284742/vba-array-to-copy-multiple-csvs-to-one-template-workbook/52284928#52284928", "title": "VBA Array to copy multiple CSVs to one template workbook", "body": "<p>For example:</p>\n\n<pre><code>Sub CopyAll()\n    Dim rw As Range, wb As Workbook\n    'read over your file&lt;&gt;sheet table\n    For Each rw In ThisWorkbook.Sheets(\"Files\").Range(\"A2:B30\").Rows\n        Set wb = Workbooks.Open(ThisWorkbook.Path &amp; \"\\\" &amp; rw.Cells(1).Value) '&lt;&lt; csv file name \n        With wb.Sheets(1).Range(\"A1\").CurrentRegion\n            'skip headers (relies on contiguous data)\n            .Offset(1, 0).Resize(.Rows.Count - 1, .Columns.Count).Copy _\n                 ThisWorkbook.Sheets(rw.Cells(2).Value).Range(\"A7\") '&lt;&lt; sheet name to paste into\n        End With\n        wb.Close False\n    Next rw\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 5725420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017faecd3978c1585fe0ca21a2b76f40?s=128&d=identicon&r=PG&f=1", "display_name": "C.A.R.", "link": "https://stackoverflow.com/users/5725420/c-a-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 52284928, "answer_count": 1, "score": 1, "last_activity_date": 1536781171, "creation_date": 1536703103, "question_id": 52284742, "link": "https://stackoverflow.com/questions/52284742/vba-array-to-copy-multiple-csvs-to-one-template-workbook", "title": "VBA Array to copy multiple CSVs to one template workbook", "body": "<p>Disclaimer - I used to write macros a lot, but it's a perishable skill. 5 years takes it toll.</p>\n\n<p>The basic concept is this:</p>\n\n<ol>\n<li>I have a template workbook, with up to 30 tabs, that all have indeterminate rows and columns (i.e. It's not always A7:J30 - one tab might have 3 columns, the next 34 columns. Rows are also indeterminate.).</li>\n<li>Currently, someone is copy/pasting 30 separate CSVs into this one templated workbook.</li>\n<li>This templated workbook is read by another program to populate data. Row 6 of each template sheet is where the other program looks for headers (i.e. I might copy a CSV's data from A2:G1000, but it would need to paste in A7:G1005 of the template target workbook).</li>\n<li>All of the CSVs are stored in the same directory. We can copy/paste a Template workbook into that directory, run a macro, and be done.</li>\n</ol>\n\n<p>What I've done so far:</p>\n\n<pre><code>Sub V1BruteForceCopy()\n'\n'This code lives in ImportTemplate.XLSM, and is run from the same\n'\nWorkbooks.Open (ThisWorkbook.Path &amp; \"\\deposits.csv\") 'Open deposits.CSV in same directory\nRange(\"A2:G1000000\").Copy                            'Very inflexible copy job - ugly.\nWindows(\"ImportTemplate.xlsm\").Activate              'hate to Activate, but can't get it to work without it.\nSheets(\"depositbatches\").Range(\"A7\").Select          'must call each Sheet in the code, instead of declare variable\nActiveSheet.Paste                                    'don't like Activate, but Sheets(\"depositbatches\").Range(\"A7\").Paste throws an error.\nEnd Sub                                              'to add a new CSV and a new Sheet to copy to, I have to copy a whole new block of code and then overwrite Sheets(\"name\") and Workbooks.Open(ThisWorkook.Path &amp; \"\\name.csv\") every time.\n</code></pre>\n\n<hr>\n\n<p>Other things I've tried:</p>\n\n<pre><code>Sub rangecopy_001()\n\nDim ImpTemp As Workbook     'Reserved for ImportTemplate\nDim CSVdeposits As Workbook 'Reserved for deposits.CSV \nDim shDeposits As Worksheet 'Deposits worksheet inside ImportTemplate\nDim lRow As Long            'variable for last row\nDim lCol As Long            'variable for last column\nDim test As Range           'variable for copy/paste range\n\nSet ImpTemp = Workbooks.Open(ThisWorkbook.Path &amp; \"\\ImportTemplate_CSV.xlsm\") 'Open DWImportTemplate\nSet CSVdeposits = Workbooks.Open(ThisWorkbook.Path &amp; \"\\deposits.csv\") 'Open deposits.CSV\nSet shDeposits = ImpTemp.Sheets(\"depositbatches\") 'Declare that shDeposits is a ImportTemplate sheet\nWith CSVdeposits 'copy out of deposits.CSV and paste into ImportTemplate deposits sheet\n\n'find last row - makes this dynamic\nlRow = Cells.Find(What:=\"*\", _\n                After:=Range(\"A1\"), _\n                LookAt:=xlPart, _\n                LookIn:=xlFormulas, _\n                SearchOrder:=xlByRows, _\n                SearchDirection:=xlPrevious, _\n                MatchCase:=False).Row\n\n'find last column - makes this dynamic\nlCol = Cells(1, Columns.Count).End(xlToLeft).Column\n\ntest = CSVdeposits.Sheet(1).Range(\"A2:\" &amp; Cells(lRow, lCol))  'error code 438 - Object doesn't support method\nDW.shDeposits.Range(\"A7\") = test                              \n\n\nEnd With\n\n\nEnd Sub\n</code></pre>\n\n<p>This makes the copy range dynamic, but I'm still getting an object error when I try to select the range. I got this method from (<a href=\"https://stackoverflow.com/questions/19351832/copy-from-one-workbook-and-paste-into-another#19352099\">Copy from one workbook and paste into another</a>) but it's too simple. Plus, if I want to add another 20 tabs, I have to copy/paste this code block another 20 times and change the variables each time.</p>\n\n<hr>\n\n<p>I found this (<a href=\"https://stackoverflow.com/questions/15243576/copy-multiple-rows-from-multiple-workbooks-to-one-master-workbook\">Copy multiple rows from multiple workbooks to one master workbook</a>), but Ron DeBruin's thing won't work because we have to move everything down to Row 6, plus we can't count on the headers of the CSVs working properly.</p>\n\n<hr>\n\n<p>I like the last answer here (<a href=\"https://stackoverflow.com/questions/16198397/dynamic-range-of-data-to-paste-into-another-sheet\">Dynamic range of data to paste into another sheet?</a>) but I can't seem to make it work for a single workbook target from other workbooks.</p>\n\n<hr>\n\n<p>I want to use an array, or set of arrays to declare my worksheets, but I don't know how to iterate over two arrays at one time that are string-based. I'm thinking something like this, but I'm not done:</p>\n\n<pre><code>Sub ArrayCopyV1()\n'\n'This code lives in Template.XLSM and is run from the same. Copy this book to the directory you wish to copy from.\n'\n'\nDim ArraySheets As Variant   'an array with all Sheet names. Should have the same number of args as ArrayCSVs array.\nDim ArrayCSVs As Variant     'an array with all CSV names Should have the same number of args as ArraySheets array.\nDim template As Worksheet    'variable for template worksheet inside \nTemplate workbook\nDim CSV As Workbook          'variable for CSV workbook\nDim i As Integer             'variable i to be used in FOR loop counter\nDim lcol as Integer\nDim lrow as Integer\n\nArraySheets = Array(\"depositbatches\", \"otherSheet1\", \"OtherSheet2\")\nArrayCSVs = Array(\"\\deposits.csv\", \"other1.csv\", \"Other2.csv\")\n\nFor i = LBound(ArraySheets) To UBound(ArraySheets)\nSet CSV = Workbooks.Open(ThisWorkbook.Path &amp; ArrayCSVs(i))\nSet template = Workbooks.Open(ThisWorkbook.Path &amp; ArraySheets(i))\n\n    With CSV 'copy out of deposits.CSV and paste into DWImportTemplate deposits sheet\n\n    'find last row - makes this dynamic\n    lRow = Cells.Find(What:=\"*\", _\n                After:=Range(\"A1\"), _\n                LookAt:=xlPart, _\n                LookIn:=xlFormulas, _\n                SearchOrder:=xlByRows, _\n                SearchDirection:=xlPrevious, _\n                MatchCase:=False).Row\n\n    'find last column - makes this dynamic\n    lCol = Cells(1, Columns.Count).End(xlToLeft).Column\n\n    test = CSV.Sheet(1).Range(\"A2:\" &amp; Cells(lRow, lCol))\n    template.Range(\"A7\") = test\n\n\n    End With\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1536718113, "post_id": 52283710, "comment_id": 91521053, "body": "Although it might seem like a simple, straightforward question, this really is too broad since there are multiple ways of handling this.  You&#39;ve also not shared enough info to really know which technique might be preferred.  For instance, you could use sub-forms linked via a primary and foreign key.  But if you want records automatically added in multiple tables when a key record is created in a main table, you&#39;ll need to add Data Macros or VBA code to Form events. Rather than making it implicit, you might find adding a button useful in controlling when this behavior happens."}, {"owner": {"reputation": 15, "user_id": 9829316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67162fa2c2dc561446e6d4791508ab55?s=128&d=identicon&r=PG&f=1", "display_name": "Alessandro Gagliardi", "link": "https://stackoverflow.com/users/9829316/alessandro-gagliardi"}, "reply_to_user": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1536751527, "post_id": 52283710, "comment_id": 91535686, "body": "@CPerkins Thanks for the feedback. The truth is that I have no preference over what method to use. I was first trying to use subforms like you mentioned, but I was having trouble making it work. VBA code would also work, I just don&#39;t know how to do it. What would you personally do in this case?"}], "owner": {"reputation": 15, "user_id": 9829316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67162fa2c2dc561446e6d4791508ab55?s=128&d=identicon&r=PG&f=1", "display_name": "Alessandro Gagliardi", "link": "https://stackoverflow.com/users/9829316/alessandro-gagliardi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536697446, "creation_date": 1536697446, "question_id": 52283710, "link": "https://stackoverflow.com/questions/52283710/adding-editing-entries-under-a-field-from-different-tables-using-a-single-form-i", "title": "Adding/Editing Entries under a Field from Different Tables Using a Single Form in Access", "body": "<p>I want to create a form that allows you to add new or edit existing fields from multiple tables that are connected. For example, the attached image shows the relationships of the tables. I want to create a form where you can add a new entry under <code>MACHNAME</code>and have it displayed in all the tables that contain the field <code>MACHNAME</code> (<code>A_SETUP</code>, <code>A_MCHCONFG</code>, <code>A_CHCONFIG</code>, and <code>A_MCHMASTR</code>). How do I do it?</p>\n\n<p><a href=\"https://i.stack.imgur.com/LQkni.jpg\" rel=\"nofollow noreferrer\">Table Relationships</a>  </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1536694271, "post_id": 52282992, "comment_id": 91514100, "body": "<code>Dim simple as Worksheet</code> - <code>Set simple = worksheets(&quot;Master&quot;)</code>  you forgot the <code>Set</code>"}, {"owner": {"reputation": 11285, "user_id": 1744774, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/e3xZV.png?s=128&g=1", "display_name": "Gerold Broser", "link": "https://stackoverflow.com/users/1744774/gerold-broser"}, "edited": false, "score": 1, "creation_date": 1536694495, "post_id": 52282992, "comment_id": 91514203, "body": "Note: <a href=\"https://docs.microsoft.com/de-de/office/vba/api/Excel.Sheets\" rel=\"nofollow noreferrer\"><code>Sheets</code>is an object</a>, not a function."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11285, "user_id": 1744774, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/e3xZV.png?s=128&g=1", "display_name": "Gerold Broser", "link": "https://stackoverflow.com/users/1744774/gerold-broser"}, "edited": false, "score": 0, "creation_date": 1536696221, "post_id": 52282992, "comment_id": 91515037, "body": "@GeroldBroser note: <i>in this context</i>, <code>Sheets</code> is a <b>property</b> of the <code>Global</code> hidden module, which returns an object of type <code>Sheets</code> off <code>ActiveWorkbook</code>. So depending on how you look at it, &quot;Sheets&quot; is either a <i>class</i> or a <i>property</i>, but not an <i>object</i>."}, {"owner": {"reputation": 11285, "user_id": 1744774, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/e3xZV.png?s=128&g=1", "display_name": "Gerold Broser", "link": "https://stackoverflow.com/users/1744774/gerold-broser"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1536698007, "post_id": 52282992, "comment_id": 91515779, "body": "@MathieuGuindon Now I remember why I abandoned VB(A) from my CV a long time ago: a <i>property</i> that&#39;s not a container for some <i>value</i> but returns something and which is a <i>class</i> or a <i>property</i> though the doc from the OEM says it&#39;s an <i>object</i>. Thanks a lot for reminding me! ;)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11285, "user_id": 1744774, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/e3xZV.png?s=128&g=1", "display_name": "Gerold Broser", "link": "https://stackoverflow.com/users/1744774/gerold-broser"}, "edited": false, "score": 0, "creation_date": 1536698543, "post_id": 52282992, "comment_id": 91515979, "body": "@GeroldBroser meh, it&#39;s probably just me. I&#39;ve probably spent way too much time with <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">both hands in VBA&#39;s guts</a>. Basically the Excel OM is very keen on naming properties as per the class/type of the object they return (e.g. <code>Worksheet.Range</code> -&gt; returns an <code>Excel.Range</code>). Official documentation happily ignoring the hidden/undocumented modules and making things up is worryingly misleading though. &quot;it&#39;s a public property on a hidden undocumented module, so let&#39;s just pretend it&#39;s a global object, nobody will know&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 621, "user_id": 6935967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a490d0e6023edcfb16893165bc19ca8?s=128&d=identicon&r=PG&f=1", "display_name": "JesusMonroe", "link": "https://stackoverflow.com/users/6935967/jesusmonroe"}, "edited": false, "score": 0, "creation_date": 1536694771, "post_id": 52283043, "comment_id": 91514328, "body": "How do I tell which functions simple can call now? For example, I thought simple.Range(&quot;value&quot;).Value should&#39;ve worked."}, {"owner": {"reputation": 215, "user_id": 8418041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a78574af70e6572cf470116e593f1aa?s=128&d=identicon&r=PG&f=1", "display_name": "basic_one", "link": "https://stackoverflow.com/users/8418041/basic-one"}, "reply_to_user": {"reputation": 621, "user_id": 6935967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a490d0e6023edcfb16893165bc19ca8?s=128&d=identicon&r=PG&f=1", "display_name": "JesusMonroe", "link": "https://stackoverflow.com/users/6935967/jesusmonroe"}, "edited": false, "score": 0, "creation_date": 1536695036, "post_id": 52283043, "comment_id": 91514471, "body": "have you declared simple with a data type (e.g. Dim simple As WorkSheet)? If you do this, &quot;intellisense&quot; should tell you what methods and properties are available for use on simple when you type the dot after typing simple"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 621, "user_id": 6935967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a490d0e6023edcfb16893165bc19ca8?s=128&d=identicon&r=PG&f=1", "display_name": "JesusMonroe", "link": "https://stackoverflow.com/users/6935967/jesusmonroe"}, "edited": false, "score": 1, "creation_date": 1536696511, "post_id": 52283043, "comment_id": 91515160, "body": "@JesusMonroe <code>Sheets</code> is a collection of many things, <i>including</i> <code>Worksheet</code> objects. It can also include <code>Chart</code> and a half-dozen legacy sheet types. Use the <code>Worksheets</code> collection if you want to be 100% sure you&#39;re pulling a <code>Worksheet</code> object."}], "tags": [], "owner": {"reputation": 215, "user_id": 8418041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a78574af70e6572cf470116e593f1aa?s=128&d=identicon&r=PG&f=1", "display_name": "basic_one", "link": "https://stackoverflow.com/users/8418041/basic-one"}, "is_accepted": true, "score": 3, "last_activity_date": 1536694764, "last_edit_date": 1536694764, "creation_date": 1536694444, "answer_id": 52283043, "question_id": 52282992, "link": "https://stackoverflow.com/questions/52282992/vba-cant-use-sheets-object-without-error/52283043#52283043", "title": "VBA - Can&#39;t use Sheets object without error", "body": "<p>As mentioned in a comment by Scott Craner, you need to use the <code>Set</code> statement whenever assigning an <em>object</em> to a variable when using VBA. This little gotcha doesn't exist in VB.NET, and is easy to forget about these days.</p>\n\n<pre><code>Set simple = Sheets(\"Master\")\n</code></pre>\n"}], "owner": {"reputation": 621, "user_id": 6935967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a490d0e6023edcfb16893165bc19ca8?s=128&d=identicon&r=PG&f=1", "display_name": "JesusMonroe", "link": "https://stackoverflow.com/users/6935967/jesusmonroe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 52283043, "answer_count": 1, "score": 0, "last_activity_date": 1536694764, "creation_date": 1536694201, "last_edit_date": 1536694695, "question_id": 52282992, "link": "https://stackoverflow.com/questions/52282992/vba-cant-use-sheets-object-without-error", "title": "VBA - Can&#39;t use Sheets object without error", "body": "<p>I have an Excel file with one sheet called <code>Master</code>.</p>\n\n<p>I have a button to delete a value from the database. This is what I have written that's relevant:</p>\n\n<pre><code>Sub delete_this()\n    On Error GoTo ErrorCatch\n    simple = Sheets(\"Master\")\n    .........\nErrorCatch\n    MsgBox(Err.Description)\nEnd Sub\n</code></pre>\n\n<p>It fails immediately when I use <code>Sheets</code>, saying \"Application-defined or object-defined error.\" However I'm using other code that I know works as a reference and they called this no problem (though their file had multiple sheets).</p>\n\n<p>Also in general I'm new to VBA and find it pretty unintuitive with its error messages, and finding out variable values. So any advice there would also be appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1536694238, "post_id": 52282978, "comment_id": 91514082, "body": "What line are you getting the error on? Have you tried stepping through the code?"}, {"owner": {"reputation": 51, "user_id": 10223786, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yJ7fEKuHDng/AAAAAAAAAAI/AAAAAAAAAB0/7emQtSuXXJ0/photo.jpg?sz=128", "display_name": "lukas rajnoha", "link": "https://stackoverflow.com/users/10223786/lukas-rajnoha"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1536694352, "post_id": 52282978, "comment_id": 91514136, "body": "Sorry, somehow I forgot to mention the line I get the error on... Already edited that"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 7, "creation_date": 1536695586, "post_id": 52282978, "comment_id": 91514749, "body": "when <code>rowIndex = 1</code> then <code>rowIndex - 1 = 0</code> and there is no row 0."}, {"owner": {"reputation": 3471, "user_id": 1016274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c01f1ff90599b2cbaba251c5f200d1d?s=128&d=identicon&r=PG", "display_name": "user1016274", "link": "https://stackoverflow.com/users/1016274/user1016274"}, "edited": false, "score": 0, "creation_date": 1536771418, "post_id": 52282978, "comment_id": 91547950, "body": "Even worse: <code>rowIndex - 2</code> is used, so <code>rowIndex</code> needs to start at 3. Or rather, if <code>rowIndex</code> is 1 or 2, you need to handle the <code>if</code> clause differently. Split the conditions into statements like <code>flag1 = (Cells(...) = Cells()</code> and finally use the flags in one <code>If</code> statement."}, {"owner": {"reputation": 3471, "user_id": 1016274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c01f1ff90599b2cbaba251c5f200d1d?s=128&d=identicon&r=PG", "display_name": "user1016274", "link": "https://stackoverflow.com/users/1016274/user1016274"}, "edited": false, "score": 0, "creation_date": 1536771491, "post_id": 52282978, "comment_id": 91547990, "body": "Have you noticed that throughout the whole code you do not qualify the ranges and cells? Why then bother to use <code>With Activesheet</code>?"}], "owner": {"reputation": 51, "user_id": 10223786, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yJ7fEKuHDng/AAAAAAAAAAI/AAAAAAAAAB0/7emQtSuXXJ0/photo.jpg?sz=128", "display_name": "lukas rajnoha", "link": "https://stackoverflow.com/users/10223786/lukas-rajnoha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536694308, "creation_date": 1536694160, "last_edit_date": 1536694308, "question_id": 52282978, "link": "https://stackoverflow.com/questions/52282978/excel-vba-runtime-error-1004-on-if-statement", "title": "Excel VBA - Runtime error &#39;1004&#39; on If statement", "body": "<p>I'm making a VBA program that changes the visuals of the excel file. There are some tags (\"BN\", \"A\", \"C\" etc.) which say how the rows/cells should be changed. </p>\n\n<p>For example: the tag \"A\" means - set the cell font to \"Arial\", size 13... etc.</p>\n\n<p>The program was working until I made some changes a while ago. Since then it's giving me always an runtime error. Has anyone any clue as to why?</p>\n\n<p>The code:</p>\n\n<pre><code>Option Explicit\n\nSub macro1()\n\nDim rowIndex As Integer\nDim lastRowIndex As Integer\nDim offset As Integer\n\n\nlastRowIndex = 2700\n\nWith ActiveSheet\n    For rowIndex = 1 To 3\n        Rows(1).EntireRow.Delete\n    Next rowIndex\n\n    With Cells.Font\n        .Name = \"Arial\"\n        .Size = 8\n        .Strikethrough = False\n        .Superscript = False\n        .Subscript = False\n        .OutlineFont = False\n        .Shadow = False\n        .Bold = False\n        .Underline = xlUnderlineStyleNone\n        .ColorIndex = 1\n    End With\n    With Cells\n        .RowHeight = 11\n        .HorizontalAlignment = xlLeft\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n\n    Columns(1).ColumnWidth = 13.5\n    Columns(2).ColumnWidth = 60\n    With Columns(3)\n        .HorizontalAlignment = xlCenter\n        .ColumnWidth = 5.5\n    End With\n    With Columns(4)\n        .HorizontalAlignment = xlRight\n        .ColumnWidth = 6.5\n    End With\n    With Columns(5)\n        .HorizontalAlignment = xlRight\n        .ColumnWidth = 6.5\n    End With\n\n\n    Columns(4).HorizontalAlignment = xlRight\n    Columns(5).HorizontalAlignment = xlRight\n\n    rowIndex = 1\n    offset = 0\n\n    Do While (rowIndex - offset) &lt; lastRowIndex\n        If Cells(rowIndex, 5).Value = \"A\" Or Cells(rowIndex, 5).Value = \"NAZOV\" Or _\n            Cells(rowIndex, 5).Value = \"C\" Or Cells(rowIndex, 6).Value = \"BN\" Then\n\n            If Cells(rowIndex, 5).Value = \"A\" Then\n                Cells(rowIndex, 5).ClearContents\n                With Cells(rowIndex, 2).Font\n                    .Name = \"Arial Narrow\"\n                    .Size = 11\n                    .Bold = True\n                    .Color = RGB(204, 0, 0)\n                End With\n                With Cells(rowIndex, 2)\n                    .RowHeight = 16\n                    .HorizontalAlignment = xlCenter\n                End With\n            End If\n\n            If Cells(rowIndex, 5).Value = \"NAZOV\" Then\n                Cells(rowIndex, 5).ClearContents\n                With Cells(rowIndex, 2).Font\n                    .Name = \"Arial\"\n                    .Size = 9\n                    .Bold = True\n                    .Underline = xlUnderlineStyleSingle\n                    .Color = RGB(0, 0, 153)\n                End With\n                With Cells(rowIndex, 2)\n                    .RowHeight = 13\n                End With\n            End If\n\n            If Cells(rowIndex, 5).Value = \"C\" Then\n                Cells(rowIndex, 5).ClearContents\n                Cells(rowIndex, 6).ClearContents\n                Cells(rowIndex, 7).ClearContents\n\n                With Cells(rowIndex, 2).Font\n                    .Name = \"Arial Narrow\"\n                    .Size = 8\n                    .Italic = True\n                    .ColorIndex = 16\n                End With\n                With Cells(rowIndex, 2)\n                    .RowHeight = 12\n                End With\n            End If\n\n            If Cells(rowIndex, 6) = \"BN\" Then\n                Cells(rowIndex, 6).ClearContents\n                If (Cells(rowIndex + 1, 5) &lt;&gt; \"C\") Then\n                    Rows(rowIndex + 1).Insert\n                    With Rows(rowIndex + 1)\n                        .RowHeight = 3\n                        .Font.Size = 2\n                    End With\n                    offset = offset + 1\n                Else\n                    Rows(rowIndex + 2).Insert\n                    With Rows(rowIndex + 2)\n                        .RowHeight = 3\n                        .Font.Size = 2\n                    End With\n                    offset = offset + 2\n                End If\n            End If\n        Else\n            Cells(rowIndex, 2).WrapText = True\n            Rows(rowIndex).AutoFit\n        End If\n\n        If Cells(rowIndex, 6).Value = \"D\" Then\n            Cells(rowIndex, 6).ClearContents\n            With Selection.Font\n                .Underline = xlUnderlineStyleSingle\n                .Bold = True\n                .Italic = False\n            End With\n        End If\n\n        If Cells(rowIndex, 6).Value = \"E\" Then\n            With Selection.Font\n                .Underline = xlUnderlineStyleSingle\n                .Bold = False\n            End With\n        End If\n\n\n        If Cells(rowIndex, 5).Value = \"P\" Then\n            Cells(rowIndex, 5).ClearContens\n        End If\n\n        If ( _\n            ((Cells(rowIndex, 5) = Cells(rowIndex - 1, 5)) Or (Cells(rowIndex, 5) = Cells(rowIndex - 2, 5))) And _\n            ((Cells(rowIndex, 4) = \"\" And Cells(rowIndex - 1, 4) &lt;&gt; \"\") Or (InStr(Cells(rowIndex, 2).Text, \"&gt;\"))) And _\n            (Cells(rowIndex - 1, 2).Font.Size = 9) Or (Cells(rowIndex, 2).Font.Size = 9 And Cells(rowIndex - 1, 2).Font.Size = 9)) Then\n            With Cells(rowIndex, 2).Font\n                .Italic = True\n                .ColorIndex = 16\n                .Bold = False\n                .Size = 8\n                .Underline = False\n            End With\n            Cells(rowIndex, 2).WrapText = True\n            Rows(rowIndex).AutoFit\n        End If\n\n\n        rowIndex = rowIndex + 1\n    Loop\nEnd With\nEnd Sub\n</code></pre>\n\n<p>The runtime error appears on the last IF statement:</p>\n\n<pre><code>If ( _\n            ((Cells(rowIndex, 5) = Cells(rowIndex - 1, 5)) Or (Cells(rowIndex, 5) = Cells(rowIndex - 2, 5))) And _\n            ((Cells(rowIndex, 4) = \"\" And Cells(rowIndex - 1, 4) &lt;&gt; \"\") Or (InStr(Cells(rowIndex, 2).Text, \"&gt;\"))) And _\n            (Cells(rowIndex - 1, 2).Font.Size = 9) Or (Cells(rowIndex, 2).Font.Size = 9 And Cells(rowIndex - 1, 2).Font.Size = 9)) Then\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1536694200, "post_id": 52282892, "comment_id": 91514069, "body": "Very true. The quotes are meant to delimit the string only, not to indicate it&#39;s a variable. This allows for paths containing parentheses, for example. Compiler constants also can&#39;t fill this gap."}, {"owner": {"reputation": 143, "user_id": 4476123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dc8cb151b5edef5a305471da8c174f6?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Salas", "link": "https://stackoverflow.com/users/4476123/andres-salas"}, "edited": false, "score": 0, "creation_date": 1536694249, "post_id": 52282892, "comment_id": 91514089, "body": "Interesting, thanks for the prompt reply. If  only the user path didn&#39;t only work for spawned processes, it&#39;d be nice to declare with just &quot;nameOfDLL.dll&quot; and use the input to add the folder location to the search path."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 143, "user_id": 4476123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dc8cb151b5edef5a305471da8c174f6?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Salas", "link": "https://stackoverflow.com/users/4476123/andres-salas"}, "edited": false, "score": 1, "creation_date": 1536694606, "post_id": 52282892, "comment_id": 91514257, "body": "@AndresSalas barring VBA macro security settings, nothing forbids using the VBIDE API to <i>generate</i> code in a standard module at run-time, that includes the specific <code>Declare</code> statements you need to have; you could have procedure/function stubs at compile/design-time, and at run-time replace them with the appropriate <code>Declare</code> statements, and on teardown re-rewrite the module to remove the declares and put the stubs back in, in one go. If you go that route, make sure you save often - and be prepared to crash often before achieving a stable solution ...if something like it can work, anyway!"}, {"owner": {"reputation": 143, "user_id": 4476123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dc8cb151b5edef5a305471da8c174f6?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Salas", "link": "https://stackoverflow.com/users/4476123/andres-salas"}, "edited": false, "score": 0, "creation_date": 1536695028, "post_id": 52282892, "comment_id": 91514467, "body": "Mathieu, I had this idea and dismissed it as &quot;no way that would work&quot; haha. What&#39;s neat is that before I read your comment, someone from &#39;06 posted a similar solution: <a href=\"https://blogs.msdn.microsoft.com/pranavwagh/2006/08/30/how-to-load-win32-dlls-dynamically-in-vba/\" rel=\"nofollow noreferrer\">blogs.msdn.microsoft.com/pranavwagh/2006/08/30/&hellip;</a> ."}, {"owner": {"reputation": 143, "user_id": 4476123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dc8cb151b5edef5a305471da8c174f6?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Salas", "link": "https://stackoverflow.com/users/4476123/andres-salas"}, "edited": false, "score": 0, "creation_date": 1536695056, "post_id": 52282892, "comment_id": 91514477, "body": "I&#39;ll try this out. Thanks for the save often advice!"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1536695133, "post_id": 52282892, "comment_id": 91514515, "body": "I highly recommend against that. It requires a recompile and triggers a state loss, which is not something that should happen in finished applications. It can work, but proceed  with a lot of caution and a lot of backups"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1536695336, "post_id": 52282892, "comment_id": 91514619, "body": "@ErikvonAsmuth TBH anything that requires programmatic access to the VBIDE API shouldn&#39;t be production code in the first place. It&#39;s just the first &quot;this might work&quot; solution that crossed my mind. Interestingly that MSDN blog article is failing to address the fact that there&#39;s likely other code that needs to invoke that imported procedure/function, and that code will have to be compiled - and removing <code>Option Explicit</code> to make that happen is out of the question, at least as far as I&#39;m concerned! Not sure what the ideal solution would be."}, {"owner": {"reputation": 143, "user_id": 4476123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dc8cb151b5edef5a305471da8c174f6?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Salas", "link": "https://stackoverflow.com/users/4476123/andres-salas"}, "edited": false, "score": 0, "creation_date": 1536695902, "post_id": 52282892, "comment_id": 91514885, "body": "In addition to those reasons, this method also requires a checkbox to allow for programmatic access to VBA, which is about as inconvenient as adding the library location to the Path variable anyway. I&#39;m nixing this method. I think I&#39;ll look into loading the library in a child process, where I can set the user path variable."}, {"owner": {"reputation": 143, "user_id": 4476123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dc8cb151b5edef5a305471da8c174f6?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Salas", "link": "https://stackoverflow.com/users/4476123/andres-salas"}, "edited": false, "score": 0, "creation_date": 1536702603, "post_id": 52282892, "comment_id": 91517555, "body": "Calling ChDir(dllFolderPath) did the trick! Thanks for the guidance fellows."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1536693807, "creation_date": 1536693807, "answer_id": 52282892, "question_id": 52282833, "link": "https://stackoverflow.com/questions/52282833/how-can-we-use-a-string-variable-in-a-declare-statement/52282892#52282892", "title": "How can we use a string variable in a declare statement?", "body": "<p>You can't. Everything in the <em>(declarations)</em> section of a module can only ever be <em>declarative</em> statements, which aren't executable: a variable means nothing in a declarative context, it can't have a value. A <code>Const</code> could conceivably work though, but if you try it you get a compile error: VBA will only accept a string literal for it.</p>\n\n<p><img src=\"https://i.stack.imgur.com/e1Ybk.png\" alt=\"expected: string constant\"></p>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1536704705, "post_id": 52284349, "comment_id": 91518228, "body": "This should be the accepted answer, really. Nicely explained, +1!"}], "tags": [], "owner": {"reputation": 143, "user_id": 4476123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dc8cb151b5edef5a305471da8c174f6?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Salas", "link": "https://stackoverflow.com/users/4476123/andres-salas"}, "is_accepted": false, "score": 2, "last_activity_date": 1536701083, "last_edit_date": 1536701083, "creation_date": 1536700631, "answer_id": 52284349, "question_id": 52282833, "link": "https://stackoverflow.com/questions/52282833/how-can-we-use-a-string-variable-in-a-declare-statement/52284349#52284349", "title": "How can we use a string variable in a declare statement?", "body": "<p>I accepted Mathieu's answer since it gives a straightforward yes/no answer to my question. </p>\n\n<p>However, for any users wondering how to get around this problem of dynamic dll locations, I have the following solution:</p>\n\n<p>When a dll is called, the system first searches the current working directory and then searches the user and environment path variables. I found difficulty in modifying the path user variable for use in dll calls, so I exploited the first part by adding:</p>\n\n<pre><code>    ChDir (dllFolder)\n</code></pre>\n\n<p>Before the dll call. The declare statements can remain as they did before, with just the library name in quotes:</p>\n\n<pre><code>   Declare Sub subName Lib \"DLLName.dll\" _\n   Alias \"aliasName\" _\n   (...)\n</code></pre>\n\n<p>Feel free to keep track of the previous directory and change it back after the call if other parts of your program expect to be in a certain directory.</p>\n"}, {"tags": [], "owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "is_accepted": false, "score": 0, "last_activity_date": 1618506557, "creation_date": 1618506557, "answer_id": 67112967, "question_id": 52282833, "link": "https://stackoverflow.com/questions/52282833/how-can-we-use-a-string-variable-in-a-declare-statement/67112967#67112967", "title": "How can we use a string variable in a declare statement?", "body": "<p>Although you can't do declares in this way, you can at least load the library and function.</p>\n<pre><code>hDLL = LoadLibrary(myDLL)\nhProc = GetProcAddress(hDLL, &quot;myProcName&quot;)\n</code></pre>\n<p>So now we have a pointer to the function. To call the function is a bit of a mess but you can use <code>DispCallFunc</code> to do this.</p>\n<p>As said, this is a bit of a mess however <a href=\"https://www.vbforums.com/showthread.php?781595-VB6-Call-Functions-By-Pointer-(Universall-DLL-Calls)\" rel=\"nofollow noreferrer\">LaVolpe on the vbforums made a neat class for this kind of thing</a></p>\n<pre><code>Private cMyDLL as cUniversalDLLCalls\nset cMyDLL = new cUniversalDLLCalls\n'... later ...\ncMyDLL.CallFunction_DLL(myDllPath, &quot;myMethodName&quot;, hasStrinParams, returnType, CC_STDCALL, param1, param2, param3, ...)\n</code></pre>\n<p><strong>Caveat:</strong></p>\n<p>This class is only supported on Windows OS</p>\n"}], "owner": {"reputation": 143, "user_id": 4476123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dc8cb151b5edef5a305471da8c174f6?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Salas", "link": "https://stackoverflow.com/users/4476123/andres-salas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 406, "favorite_count": 0, "accepted_answer_id": 52282892, "answer_count": 3, "score": 1, "last_activity_date": 1618506557, "creation_date": 1536693565, "question_id": 52282833, "link": "https://stackoverflow.com/questions/52282833/how-can-we-use-a-string-variable-in-a-declare-statement", "title": "How can we use a string variable in a declare statement?", "body": "<p>A \"normal\" declare statement for a DLL function looks something like this:</p>\n\n<pre><code>   Declare Sub subName Lib \"path_to_lib\" _\n   Alias \"aliasName\" _\n   (...)\n</code></pre>\n\n<p>In my application, it would be nice to have the user select their library location, after which I write that location to a cell. I'd like to pass this value to the \"path_to_lib\" argument, but I'm having difficulty extracting the cell value. </p>\n\n<p>I tried assigning the cell value to a global variable, say pathVariable and writing:</p>\n\n<pre><code>Declare Sub subName Lib \" &amp; pathVariable &amp; \"  _\n   Alias \"aliasName\" _\n   (...)\n</code></pre>\n\n<p>But that returns the error: File Not Found: &amp; pathVariable &amp; </p>\n\n<p>I also tried double quotes, which returned the error: File Not Found \" &amp; pathVariable &amp; \"</p>\n\n<p>I then tried triple quotes, which VBA helpfully reduced to double quotes giving me the same error. </p>\n\n<p>Is there some special syntactical sauce here; or even an alternative method? Or should I abandon this (helpful) feature?</p>\n"}, {"tags": ["excel", "vba", "image", "web-scraping", "powerquery"], "comments": [{"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1536694002, "post_id": 52282693, "comment_id": 91513993, "body": "can you add more of your code?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536694146, "post_id": 52282693, "comment_id": 91514046, "body": "Is the CSV not sufficient?"}, {"owner": {"reputation": 3, "user_id": 10349330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/293cba22311858730c18e45b1cf1df8c?s=128&d=identicon&r=PG&f=1", "display_name": "oandic", "link": "https://stackoverflow.com/users/10349330/oandic"}, "reply_to_user": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1536696125, "post_id": 52282693, "comment_id": 91514996, "body": "@Kubie actually, this is the only code I&#39;ve put together via researching online and this only gives me the individual images. Excel automatically creates the code below for the table without the images: <code>let     Source = Web.Page(Web.Contents(&quot;https:&#47;&#47;royaleapi.com&#47;clan&#47;8P2V9VYL&#47;w&zwnj;&#8203;ar&#47;analytics&quot;)),     Data = Source{0}[Data] in     #&quot;Data&quot;</code>"}, {"owner": {"reputation": 3, "user_id": 10349330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/293cba22311858730c18e45b1cf1df8c?s=128&d=identicon&r=PG&f=1", "display_name": "oandic", "link": "https://stackoverflow.com/users/10349330/oandic"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1536696371, "post_id": 52282693, "comment_id": 91515105, "body": "@QHarr csv file might have worked if it wasn&#39;t needed to be downloaded every time I wanted to simply refresh the data. For your 2nd comment, I believe it is what I need as I understand the concept but can&#39;t code it :/"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10349330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/293cba22311858730c18e45b1cf1df8c?s=128&d=identicon&r=PG&f=1", "display_name": "oandic", "link": "https://stackoverflow.com/users/10349330/oandic"}, "edited": false, "score": 0, "creation_date": 1538064442, "post_id": 52283888, "comment_id": 92021968, "body": "Thank you very much and so sorry for the late response! This has worked miracles as it made me learn a lot of VBA with additional research, so thank you!! :) @Qharr my only question left is, sometimes there are two images in the original table, but the code only gets the link for one of the images and moves on to the next cell. Is it possible to get both links in the same cell if its two visuals in the original table? Thanks so much again and again!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 10349330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/293cba22311858730c18e45b1cf1df8c?s=128&d=identicon&r=PG&f=1", "display_name": "oandic", "link": "https://stackoverflow.com/users/10349330/oandic"}, "edited": false, "score": 0, "creation_date": 1538064613, "post_id": 52283888, "comment_id": 92022058, "body": "Like .:JOSHUA:. 9.23?"}, {"owner": {"reputation": 3, "user_id": 10349330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/293cba22311858730c18e45b1cf1df8c?s=128&d=identicon&r=PG&f=1", "display_name": "oandic", "link": "https://stackoverflow.com/users/10349330/oandic"}, "edited": false, "score": 0, "creation_date": 1538166177, "post_id": 52283888, "comment_id": 92062933, "body": "Exactly like JOSHUA in 9.27 and 9.23; two images/links in a single cell?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 10349330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/293cba22311858730c18e45b1cf1df8c?s=128&d=identicon&r=PG&f=1", "display_name": "oandic", "link": "https://stackoverflow.com/users/10349330/oandic"}, "edited": false, "score": 0, "creation_date": 1538166223, "post_id": 52283888, "comment_id": 92062953, "body": "I will have a look tomorrow if that is ok? It&#39;s gonna be a bit more complex to code."}, {"owner": {"reputation": 3, "user_id": 10349330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/293cba22311858730c18e45b1cf1df8c?s=128&d=identicon&r=PG&f=1", "display_name": "oandic", "link": "https://stackoverflow.com/users/10349330/oandic"}, "edited": false, "score": 0, "creation_date": 1538487883, "post_id": 52283888, "comment_id": 92153583, "body": "I wouldn&#39;t call it urgent in any way, so please take your time. I am learning through your codes so willing to wait for it :) And I can&#39;t thank you enough!"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1536734666, "last_edit_date": 1536734666, "creation_date": 1536698368, "answer_id": 52283888, "question_id": 52282693, "link": "https://stackoverflow.com/questions/52282693/excel-365-getting-data-table-w-images-from-web/52283888#52283888", "title": "Excel 365 - Getting Data Table w/ Images from Web", "body": "<p>This shows how you can gather the links for the images into a 2d array that can be overlaid onto your data range in the sheet as the dimensions (number of rows and number of columns) match. It means you can loop the rows and columns of the array and use them to index into your data range to have the right location to then add your image from the image URL to the cell.</p>\n\n<p>You can use <code>.Top</code> and <code>.Left</code> to position. Generic outline code given at bottom. You will need to size images appropriately and space rows and columns as well.</p>\n\n<pre><code>Option Explicit\nPublic Sub GetTable()\n    Dim sResponse As String, html As New HTMLDocument\n\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"https://royaleapi.com/clan/90R9VPP9/war/analytics\", False\n        .send\n        sResponse = StrConv(.responseBody, vbUnicode)\n    End With\n\n    With html\n        .body.innerHTML = sResponse\n        Dim hTable As HTMLTable\n        Set hTable = .getElementsByTagName(\"table\")(0)\n    End With\n    Dim numRows As Long, numColumns As Long, r As Long, c As Long, tr As Object, td As Object\n\n    numRows = hTable.getElementsByTagName(\"tr\").Length\n    numColumns = hTable.getElementsByTagName(\"tr\")(2).getElementsByTagName(\"td\").Length\n    Dim arr()\n    ReDim arr(1 To numRows, 1 To numColumns)\n\n    For Each tr In hTable.getElementsByTagName(\"tr\")\n        r = r + 1: c = 0\n        For Each td In tr.getElementsByTagName(\"td\")\n            c = c + 1\n            arr(r, c) = GetImgLink(td.outerHTML)\n        Next\n    Next\n    [A1].Resize(numRows, numColumns) = arr '&lt;== Just for example to see how would map to sheet\n    Stop\nEnd Sub\n\nPublic Function GetImgLink(ByVal outerHTML As String) As String\n    On Error GoTo Errhand\n    GetImgLink = \"https://royaleapi.com/\" &amp; Split(Split(outerHTML, \"IMG class=\"\"ui image\"\" src=\"\"about:\")(1), Chr$(34))(0)\n    Exit Function\nErrhand:\n    Err.Clear\n    GetImgLink = vbNullString\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>Adding images and positioning (assuming data starts in A1 otherwise add an adjustment to the row, column indices of the link array you are looping.)</p>\n\n<pre><code>With ActiveSheet.Pictures.Insert(imageURL)  ' &lt;== Change to your sheet\n    .Left = ActiveSheet.Cells(1,1).Left '&lt;== row and column argument to cells will come from loop position within array. Adjust if required.\n    .Top = ActiveSheet.Cells(1,1).Top\n    .Placement = 1\nEnd With\n</code></pre>\n\n<hr>\n\n<p><strong>Sample of how links map to sheet:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/AAWkh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AAWkh.png\" alt=\"data\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 10349330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/293cba22311858730c18e45b1cf1df8c?s=128&d=identicon&r=PG&f=1", "display_name": "oandic", "link": "https://stackoverflow.com/users/10349330/oandic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 52283888, "answer_count": 1, "score": 0, "last_activity_date": 1538064394, "creation_date": 1536692897, "last_edit_date": 1538064394, "question_id": 52282693, "link": "https://stackoverflow.com/questions/52282693/excel-365-getting-data-table-w-images-from-web", "title": "Excel 365 - Getting Data Table w/ Images from Web", "body": "<p>I am using Office 365 and I am trying to get a data table from the web and import it in an Excel sheet together with the images. Here is the table which I am trying to import:</p>\n\n<p><a href=\"https://royaleapi.com/clan/90R9VPP9/war/analytics\" rel=\"nofollow noreferrer\">https://royaleapi.com/clan/90R9VPP9/war/analytics</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/js4AW.jpg\" rel=\"nofollow noreferrer\">http://i63.tinypic.com/2s655kx.jpg</a></p>\n\n<p>As you can see from the table, there are images in cells representing certain statuses which contain meaningful data:</p>\n\n<ul>\n<li>Medal = win</li>\n<li>Cross = loss</li>\n<li>Empty medal slot = missing in action</li>\n<li>Empty cell = didn't participate</li>\n</ul>\n\n<p>I click on data and select From Web, where I paste the link. Excel brings up the following, where I select Table 0 for the info I need.</p>\n\n<p><a href=\"https://i.stack.imgur.com/0Cyw8.jpg\" rel=\"nofollow noreferrer\">http://i67.tinypic.com/2lmb4u0.jpg</a></p>\n\n<p>After I click load, the generated table is as below. As you can see, there are no images which denote the status of the person, this method only gets the texts etc. but the cells which should have contained the images are not pulled.</p>\n\n<p><a href=\"https://i.stack.imgur.com/eaPNJ.jpg\" rel=\"nofollow noreferrer\">http://i67.tinypic.com/n3kzz5.jpg</a></p>\n\n<p>After searching online, I've managed to put together a code to isolate the images in another query (Query1) which you can find below. This query gives the images but doesn't place them in cells, I've just managed to get to the images themselves :)</p>\n\n<pre><code>let\nSource = Table.FromColumns({Lines.FromBinary(Web.Contents(\"https://royaleapi.com/clan/8P2V9VYL/war/analytics\"), null, null, 65001)}),\n#\"Filtered Rows\" = Table.SelectRows(Source, each Text.Contains([Column1], \"src=\"\"/static/img/ui\")),\n#\"Split Column by Delimiter\" = Table.SplitColumn(#\"Filtered Rows\", \"Column1\", Splitter.SplitTextByEachDelimiter({\"src=\"\"/\"}, QuoteStyle.None, true), {\"Column1.1\", \"Column1.2\"}),\n#\"Changed Type\" = Table.TransformColumnTypes(#\"Split Column by Delimiter\",{{\"Column1.1\", type text}, {\"Column1.2\", type text}}),\n#\"Split Column by Delimiter1\" = Table.SplitColumn(#\"Changed Type\", \"Column1.2\", Splitter.SplitTextByEachDelimiter({\"\"\"\"}, QuoteStyle.None, false), {\"Column1.2.1\", \"Column1.2.2\"}),\n#\"Changed Type1\" = Table.TransformColumnTypes(#\"Split Column by Delimiter1\",{{\"Column1.2.1\", type text}, {\"Column1.2.2\", type text}}),\n#\"Removed Columns\" = Table.RemoveColumns(#\"Changed Type1\",{\"Column1.1\", \"Column1.2.2\"}),\n#\"Added Custom\" = Table.AddColumn(#\"Removed Columns\", \"https\", each \"https://royaleapi.com/\"),\n#\"Reordered Columns\" = Table.ReorderColumns(#\"Added Custom\",{\"https\", \"Column1.2.1\"}),\n#\"Merged Columns\" = Table.CombineColumns(#\"Reordered Columns\",{\"https\", \"Column1.2.1\"},Combiner.CombineTextByDelimiter(\"\", QuoteStyle.None),\"Merged\"),\n#\"Renamed Columns\" = Table.RenameColumns(#\"Merged Columns\",{{\"Merged\", \"Images\"}}),\n#\"Duplicated Column\" = Table.DuplicateColumn(#\"Renamed Columns\", \"Images\", \"Images - Copy\"),\n#\"Renamed Columns1\" = Table.RenameColumns(#\"Duplicated Column\",{{\"Images - Copy\", \"ImageURLs\"}})\nin\n#\"Renamed Columns1\"\n</code></pre>\n\n<p>So, is there any way to simply get the correct images in their correct cells whenever I refresh the table? Unfortunately, I have very limited coding knowledge so I am open to your suggestions and assistance :)</p>\n\n<p>Thanks in advance!\nOandic</p>\n"}, {"tags": ["excel", "vba", "for-loop", "do-while"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1536696090, "post_id": 52282518, "comment_id": 91514974, "body": "It seems like you&#39;re pasting on the <code>Research</code> sheet - so I&#39;m not sure why you have the 2nd <code>Sheets(&quot;Research&quot;).Select</code>, should that be a different sheet? That said, using <code>Select</code>, and <code>Selection</code> is discouraged. See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using select</a>. And always qualify which <code>Worksheet</code> a <code>Range</code> is on."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1536700491, "creation_date": 1536700491, "answer_id": 52284316, "question_id": 52282518, "link": "https://stackoverflow.com/questions/52282518/nested-do-while-loop-in-for-loop-for-keyword-search-in-columns-only-executing-on/52284316#52284316", "title": "Nested do while loop in for loop for keyword search in columns only executing once VBA", "body": "<p>Try this:</p>\n\n<pre><code>Dim rwSearch As Range\nDim rwCopy As Range\nDim keyword 'variant\nDim i As Long, k\n\nSet rwSearch = Sheets(\"Research\").Rows(2)\nSet rwCopy = Sheets(\"Results\").Rows(2)   '&lt;&lt; not \"Research\" ?\n\nkeyword = Array(\"financial crisis\", \"credit default swap\", _\n               \"market manipulation\", \"financial crisis\")\n\nDo While Len(rwSearch.Cells(1, \"K\")) &gt; 0\n    k = rwSearch.Cells(1, \"K\").Value\n    For i = LBound(keyword) To UBound(keyword)\n        If InStr(1, k, keyword(i)) &gt; 0 Then\n            rwSearch.Copy rwCopy\n            Set rwCopy = rwCopy.Offset(1, 0)\n            Exit For '&lt;&lt;&lt; already copied this row\n        End If\n    Next i\n    Set rwSearch = rwSearch.Offset(1, 0)\nLoop\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10349281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbebca2d987ffee6f6fa64da11444f85?s=128&d=identicon&r=PG&f=1", "display_name": "barrywd", "link": "https://stackoverflow.com/users/10349281/barrywd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593761127, "creation_date": 1536692094, "last_edit_date": 1593761127, "question_id": 52282518, "link": "https://stackoverflow.com/questions/52282518/nested-do-while-loop-in-for-loop-for-keyword-search-in-columns-only-executing-on", "title": "Nested do while loop in for loop for keyword search in columns only executing once VBA", "body": "<p>I am trying to make a keyword search loop that can scan abstracts of research papers that are imported into excel using a different program. The abstracts of these research papers are all in column K, and when I run the code I get only the keyword(0) copied into another sheet. I've rearranged the keywords and proven that the search does in fact work for the first rendition, but the for loop itself does not execute, or the while loop ends after the first execution. </p>\n\n<pre><code> Dim LSearchRow As Integer\n       Dim LCopyToRow As Integer\n        Dim keyword(3) As String\n        Dim i As Integer\n\n   On Error GoTo Err_Execute\n   LSearchRow = 2\n   LCopyToRow = 2\n\n    keyword(0) = \"financial crisis\"\n    keyword(1) = \"credit default swap\"\n    keyword(2) = \"market manipulation\"\n    keyword(3) = \"financial crisis\"\n    Sheets(\"Research\").Select\n\n   For i = LBound(keyword) To UBound(keyword)\n       While Len(Range(\"K\" &amp; CStr(LSearchRow)).Value) &gt; 0\n            If InStr(1, Range(\"K\" &amp; CStr(LSearchRow)).Value, keyword(i)) &gt; 0 Then\n\n             'Select row in Sheet to copy\n             Rows(CStr(LSearchRow) &amp; \":\" &amp; CStr(LSearchRow)).Select\n             Selection.Copy\n\n             'Paste row into Sheet in next row\n             Sheets(\"Research\").Select\n             Rows(CStr(LCopyToRow) &amp; \":\" &amp; CStr(LCopyToRow)).Select\n             ActiveSheet.Paste\n\n             'Move counter to next row\n             LCopyToRow = LCopyToRow + 1\n\n             'Go back to Sheet2 to  \n\n             Sheets(\"Research\").Select\n\n          End If\n          LSearchRow = LSearchRow + 1\n       Wend\n   Next i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536692186, "post_id": 52282451, "comment_id": 91513184, "body": "<code>objFolder.GetDetails</code>? Can you <a href=\"https://stackoverflow.com/posts/52282451/edit\">edit your question</a> to include your code?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1536692847, "post_id": 52282451, "comment_id": 91513503, "body": "<code>FileDateTime(pathHere)</code> includes the seconds portion of the timestamp: <a href=\"https://www.techonthenet.com/excel/formulas/filedatetime.php\" rel=\"nofollow noreferrer\">techonthenet.com/excel/formulas/filedatetime.php</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10349263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b1bb2ae3160a79798a1f9b7584c8994?s=128&d=identicon&r=PG&f=1", "display_name": "BigJack56", "link": "https://stackoverflow.com/users/10349263/bigjack56"}, "edited": false, "score": 0, "creation_date": 1536693960, "post_id": 52282653, "comment_id": 91513976, "body": "Thanks for the reply. This works for the file created, modified and accessed dates. How would I get the Extended File Property &quot;Date Taken&quot; to include seconds? This date/time does not seem to be available via the FileSystemObject."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 1, "user_id": 10349263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b1bb2ae3160a79798a1f9b7584c8994?s=128&d=identicon&r=PG&f=1", "display_name": "BigJack56", "link": "https://stackoverflow.com/users/10349263/bigjack56"}, "edited": false, "score": 0, "creation_date": 1536695306, "post_id": 52282653, "comment_id": 91514609, "body": "@BigJack56  I took what you had in your question which showed those three.  If you are trying to get the Date Taken information from a image then that is another beast altogether, IE another question specifically asking to obtain the Date Taken information from a image file via VBA. IE read image metadata"}, {"owner": {"reputation": 1, "user_id": 10349263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b1bb2ae3160a79798a1f9b7584c8994?s=128&d=identicon&r=PG&f=1", "display_name": "BigJack56", "link": "https://stackoverflow.com/users/10349263/bigjack56"}, "edited": false, "score": 0, "creation_date": 1536700683, "post_id": 52282653, "comment_id": 91516877, "body": "Sorceri...I understand your response. Maybe you can explain the following: Microsoft has provided access to file extended properties via the method objFolder.GetDetailsOf which provides access to all the date/time values of interest to me. The only issue is the lack of seconds in the time. The responses to date are pointing me to completely different methods depending on the date/time of interest. Why is this necessary?  Why are the extended file properties date/time limited in precision especially when the addition information (seconds) is available for the file."}], "tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": false, "score": 0, "last_activity_date": 1536692773, "creation_date": 1536692773, "answer_id": 52282653, "question_id": 52282451, "link": "https://stackoverflow.com/questions/52282451/how-to-get-windows-extended-file-properties-date-times-with-seconds-using-excel/52282653#52282653", "title": "How to get Windows Extended File Properties Date/Times with seconds using Excel VBA?", "body": "<p>You need to use the FileSystemObject and not Shell object, I am assuming you are using The Shell object from the GetDetails method being used.</p>\n\n<pre><code>Dim fso\nDim f\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet f = fso.GetFile(\"filePath\")\n\nDebug.Print f.DateCreated\nDebug.Print f.DateLastAccessed\nDebug.Print f.DateLastModified\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10349263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b1bb2ae3160a79798a1f9b7584c8994?s=128&d=identicon&r=PG&f=1", "display_name": "BigJack56", "link": "https://stackoverflow.com/users/10349263/bigjack56"}, "edited": false, "score": 0, "creation_date": 1536700761, "post_id": 52283234, "comment_id": 91516908, "body": "This code will not print date/time values with seconds only hours and minutes."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 10349263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b1bb2ae3160a79798a1f9b7584c8994?s=128&d=identicon&r=PG&f=1", "display_name": "BigJack56", "link": "https://stackoverflow.com/users/10349263/bigjack56"}, "edited": false, "score": 0, "creation_date": 1536703730, "post_id": 52283234, "comment_id": 91517914, "body": "Maybe try:  <a href=\"https://www.everythingaccess.com/tutorials.asp?ID=Accessing-detailed-file-information-provided-by-the-Operating-System\" rel=\"nofollow noreferrer\">everythingaccess.com/&hellip;</a>"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1536695324, "creation_date": 1536695324, "answer_id": 52283234, "question_id": 52282451, "link": "https://stackoverflow.com/questions/52282451/how-to-get-windows-extended-file-properties-date-times-with-seconds-using-excel/52283234#52283234", "title": "How to get Windows Extended File Properties Date/Times with seconds using Excel VBA?", "body": "<p>From:</p>\n\n<p><a href=\"https://gallery.technet.microsoft.com/scriptcenter/4a4cb944-2342-4f80-a2c6-44be76185825\" rel=\"nofollow noreferrer\">https://gallery.technet.microsoft.com/scriptcenter/4a4cb944-2342-4f80-a2c6-44be76185825</a></p>\n\n<pre><code>Sub Tester()\n\n    Dim arrHeaders(34)\n\n    Set objShell = CreateObject(\"Shell.Application\")\n    Set objFolder = objShell.Namespace(\"C:\\_Stuff\\test\")\n\n    For i = 0 To 33\n        arrHeaders(i) = objFolder.GetDetailsOf(objFolder.Items, i)\n    Next\n\n    For Each strFileName In objFolder.Items\n        For i = 0 To 33\n            Debug.Print i &amp; vbTab &amp; arrHeaders(i) _\n                &amp; \": \" &amp; objFolder.GetDetailsOf(strFileName, i)\n        Next\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>You should be able to adapt that to your needs.</p>\n"}], "owner": {"reputation": 1, "user_id": 10349263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b1bb2ae3160a79798a1f9b7584c8994?s=128&d=identicon&r=PG&f=1", "display_name": "BigJack56", "link": "https://stackoverflow.com/users/10349263/bigjack56"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 827, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1536695324, "creation_date": 1536691786, "question_id": 52282451, "link": "https://stackoverflow.com/questions/52282451/how-to-get-windows-extended-file-properties-date-times-with-seconds-using-excel", "title": "How to get Windows Extended File Properties Date/Times with seconds using Excel VBA?", "body": "<p>I am using the VBA objFolder.GetDetails method to read the Windows 7 Extended File Properties of several files. I have noticed that all the times are only given in hours and minutes:</p>\n\n<pre><code>3   Date modified: 8/16/2018 3:42 PM\n4   Date created: 9/11/2018 10:11 AM\n5   Date accessed: 9/11/2018 10:13 AM\n</code></pre>\n\n<p>How can I write out these dates with the time in hours:minutes:seconds? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1536691542, "post_id": 52282342, "comment_id": 91512847, "body": "You may need to make sure your destination range is the same shape/size as your origin."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1536692140, "post_id": 52282342, "comment_id": 91513155, "body": "After your subroutine completes <code>incCol</code> is tossed and has no value anymore. When you run this a second time, it&#39;s just going to be zero again. If you need to store this value somewhere, I&#39;d suggest in a hidden cell in your worksheet, or if you&#39;re trying to run this multiple times, just increment it within a <code>Loop</code>."}, {"owner": {"reputation": 11, "user_id": 10349193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac8cd7e19c8184bcc73453a4833fe372?s=128&d=identicon&r=PG&f=1", "display_name": "tdgclg", "link": "https://stackoverflow.com/users/10349193/tdgclg"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1536697135, "post_id": 52282342, "comment_id": 91515439, "body": "Thank you @dwirony.  The incCol in now incrementing with each button press."}, {"owner": {"reputation": 11, "user_id": 10349193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac8cd7e19c8184bcc73453a4833fe372?s=128&d=identicon&r=PG&f=1", "display_name": "tdgclg", "link": "https://stackoverflow.com/users/10349193/tdgclg"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1536698408, "post_id": 52282342, "comment_id": 91515933, "body": "Thank you for the feedback.  The initial range has cells I don&#39;t want to copy, and on the new sheet, I want the data together.  Is there a way to do that?  Sorry if this is a noob question.   @BruceWayne"}, {"owner": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "edited": false, "score": 0, "creation_date": 1536705500, "post_id": 52282342, "comment_id": 91518426, "body": "As a side comment, <code>And</code> only operates on <i>two</i> conditions. At the beginning, when you&#39;re comparing the dates, you&#39;re not getting a true comparison. I learned this the hard way..."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10349193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac8cd7e19c8184bcc73453a4833fe372?s=128&d=identicon&r=PG&f=1", "display_name": "tdgclg", "link": "https://stackoverflow.com/users/10349193/tdgclg"}, "edited": false, "score": 0, "creation_date": 1536697711, "post_id": 52282951, "comment_id": 91515669, "body": "Thank you @Trog.  For some reason, this is only copying the first range L3:L8."}, {"owner": {"reputation": 11, "user_id": 10349193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac8cd7e19c8184bcc73453a4833fe372?s=128&d=identicon&r=PG&f=1", "display_name": "tdgclg", "link": "https://stackoverflow.com/users/10349193/tdgclg"}, "edited": false, "score": 0, "creation_date": 1536698098, "post_id": 52282951, "comment_id": 91515813, "body": "I may have typed something wrong.  I tried the way you posted going to a designated cell, and this way (to increment the cell):                                             sh1.Cells(2, incCol).Resize(rng.Rows.Count, rng.Columns.Count).Cells.Value = rng.Cells.Value                                 Both only copied the first range."}, {"owner": {"reputation": 1, "user_id": 10193408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb25416674a53d9e50d76699adee5c2?s=128&d=identicon&r=PG&f=1", "display_name": "Trog", "link": "https://stackoverflow.com/users/10193408/trog"}, "reply_to_user": {"reputation": 11, "user_id": 10349193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac8cd7e19c8184bcc73453a4833fe372?s=128&d=identicon&r=PG&f=1", "display_name": "tdgclg", "link": "https://stackoverflow.com/users/10349193/tdgclg"}, "edited": false, "score": 0, "creation_date": 1536715266, "post_id": 52282951, "comment_id": 91520507, "body": "Okay we might have to break out each range."}], "tags": [], "owner": {"reputation": 1, "user_id": 10193408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb25416674a53d9e50d76699adee5c2?s=128&d=identicon&r=PG&f=1", "display_name": "Trog", "link": "https://stackoverflow.com/users/10193408/trog"}, "is_accepted": false, "score": 0, "last_activity_date": 1536716099, "last_edit_date": 1536716099, "creation_date": 1536694014, "answer_id": 52282951, "question_id": 52282342, "link": "https://stackoverflow.com/questions/52282342/pastespecial-method-of-range-class-failed-on-second-run-of-macro/52282951#52282951", "title": "PasteSpecial method of Range class Failed on second run of Macro", "body": "<p>Here try this, it will move the selected range into a new range. This code should select your range and move it to the Historical Data Sheet. Make sure to change the name on <code>set sh = wb.Sheets(\"NAME OF YOUR SHEET\")</code>  to the name of your sheet. I would probably create a test sheet for both to test them to make sure they are doing what you want them to do and you don't mess up your data. </p>\n\n<pre><code>Dim sh As worksheet\nDim sh1 As worksheet\nDim rng, rng1, rng2, rng3, rng4, rng5, rng6 As range\n\n\nset wb = ThisWorkbook\nset sh = wb.Sheets(\"NAME OF YOUR SHEET\")\nset sh1 = wb.Sheets(\"NAME OF SHEET YOU WANT TO COPY TO\")\nset rng = sh.Range(\"L3:L8\")\nset rng1 = sh.Range(\"L11:L15\")\nset rng2 = sh.Range(\"L18:L22\")\nset rng3 = sh.Range(\"L34:L38\")\nset rng4 = sh.Range(\"L41:L45\")\nset rng5 = sh.range(\"L57:L61\")\nset rng6 = sh.range(\"L64:L68\")\n\n\nsh1.Range(\"A1\").Resize(rng.Rows.Count, rng.Columns.Count).Cells.Value = rng.Cells.Value\n\nsh1.range(\"B1\").Resize(rng1.Rows.Count, rng1.Columns.Count).Cells.Value = rng1.Cells.Value\n\nsh1.range(\"C1\").Resize(rng2.Rows.Count, rng2.Columns.Count).Cells.Value = rng2.Cells.Value\n\nsh1.range(\"D1\").Resize(rng3.Rows.Count, rng3.Columns.Count).Cells.Value = rng3.Cells.Value\n\nsh1.range(\"E1\").Resize(rng4.Rows.Count, rng4.Columns.Count).Cells.Value = rng4.Cells.Value\n\nsh1.range(\"F1\").Resize(rng5.Rows.Count, rng5.Columns.Count).Cells.Value = rng5.Cells.Value\n\nsh1.range(\"G1\").Resize(rng6.Rows.Count, rng6.Columns.Count).Cells.Value = rng6.Cells.Value\n</code></pre>\n\n<p>Edit - I kind of spelled it out for you in hope if you need to make changes its easy to see what the code is doing, there is probably a better way to do this with less code but this way you are not using copy and paste it just transfers the data and is much faster. I set each range to the first row in each column. To change where you the data is placed just change the location after the <code>sh1.range(\"G1\")</code></p>\n"}], "owner": {"reputation": 11, "user_id": 10349193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac8cd7e19c8184bcc73453a4833fe372?s=128&d=identicon&r=PG&f=1", "display_name": "tdgclg", "link": "https://stackoverflow.com/users/10349193/tdgclg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1536716099, "creation_date": 1536691382, "question_id": 52282342, "link": "https://stackoverflow.com/questions/52282342/pastespecial-method-of-range-class-failed-on-second-run-of-macro", "title": "PasteSpecial method of Range class Failed on second run of Macro", "body": "<p>First off I am not a coder.  I am trying to get a section of this code to increment the column number each time the macro is run.  It works the first time then has the Range class error the next run.  Also my incrementing doesn't appear to be working either.  Here is the complete code with the section giving the error pointed out:</p>\n\n<pre><code>Sub Prep_Report_Rev_B()\n'\n' Prep_Report_Rev_B Macro\n'\n' Keyboard Shortcut: Ctrl+g\n'\n\n' Declare Variables\n\nDim xdate As Date\nDim incCol As Integer\n\n' Ensure button not pressed multiple times a day\n\n    xdate = Worksheets(\"Summary\").Range(\"F6\")\n\n    If Month(Date) = Month(xdate) And Year(Date) = Year(xdate) And Day(Date) = Day(xdate) Then\n        MsgBox \"Report can only be run once per day to prevent data loss\"\n        GoTo Line1\n    End If\n\n' Copy Data to Historical Tab\n'  ** Need to increment column number **\n\n    If incCol = 0 Then\n        incCol = 1\n    Else\n        incCol = incCol + 1 '&lt;--increases of 1 each click\n    End If\n\n    ActiveSheet.Unprotect \"0000\"\n    Range(\"L3:L8,L11:L15,L18:L22,L34:L38,L41:L45,L57:L61,L64:L68\").Select\n    Selection.Copy\n    Sheets(\"Historical Data\").Select\n    ActiveSheet.Unprotect \"0000\"\n\n' =========================================================================\n    Cells(2, incCol).Offset(0, 5).Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=True, Transpose:=False ' &lt;----\n' ==========================================================================\n\n    ActiveSheet.Protect \"0000\"\n\n' Enter current Date on \"Summary\" Page\n\n    Sheets(\"Summary\").Select\n    Range(\"F6\") = Format(Date, \"mm/dd/yyyy\")\n    ActiveSheet.Protect \"0000\"\n\n' Clear \"Previous Service Report Data\" tab\n\n    Sheets(\"Previous Service Report Data\").Select\n    ActiveSheet.Unprotect \"0000\"\n    Cells.Select\n    Selection.ClearContents\n\n' Copy data from \"Service Report\" to \"Previous Service Report\"\n\n    Sheets(\"Service Report Data\").Select\n    ActiveSheet.Unprotect \"0000\"\n    Columns(\"A:AK\").Select\n    Selection.Copy\n    Sheets(\"Previous Service Report Data\").Select\n    Range(\"A1\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    ActiveSheet.Protect \"0000\"\n\n' Clear \"Service Report Data\" to prepare for new data\n\n    Sheets(\"Service Report Data\").Select\n    Columns(\"A:AI\").Select\n    Selection.ClearContents\n    Range(\"A1\").Select\n    ActiveSheet.Protect \"0000\"\n\n' Pull Up webpage\n\n    ActiveWorkbook.FollowHyperlink _\n    Address:=\"google.com\"\n\nLine1:\n\nEnd Sub\n</code></pre>\n\n<p>Any help or suggestions would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1536690914, "post_id": 52282125, "comment_id": 91512497, "body": "three pieces of code.  One that call the form and a second on the form to call the third if yes.  The third does the work."}, {"owner": {"reputation": 791, "user_id": 6306448, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/035c760ea955c2fd227e16351e51cc1a?s=128&d=identicon&r=PG&f=1", "display_name": "Al_Iskander", "link": "https://stackoverflow.com/users/6306448/al-iskander"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1536692424, "post_id": 52282125, "comment_id": 91513299, "body": "isn&#39;t it possible that the main code (the one that calls the form) simply continues after the click in the form has been done?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1536692494, "post_id": 52282125, "comment_id": 91513336, "body": "See @Joe answer below."}], "answers": [{"comments": [{"owner": {"reputation": 791, "user_id": 6306448, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/035c760ea955c2fd227e16351e51cc1a?s=128&d=identicon&r=PG&f=1", "display_name": "Al_Iskander", "link": "https://stackoverflow.com/users/6306448/al-iskander"}, "edited": false, "score": 0, "creation_date": 1536736403, "post_id": 52282282, "comment_id": 91526684, "body": "thank you Joe. just one more thing, when I show the Form modally it does not show on top of all windows, if I do not set to vbModal then the YesClick does not work. Any solution for this (how to show always on top?)?"}, {"owner": {"reputation": 114165, "user_id": 13087, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/260e2731006271646d36705a95c4db48?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/13087/joe"}, "reply_to_user": {"reputation": 791, "user_id": 6306448, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/035c760ea955c2fd227e16351e51cc1a?s=128&d=identicon&r=PG&f=1", "display_name": "Al_Iskander", "link": "https://stackoverflow.com/users/6306448/al-iskander"}, "edited": false, "score": 0, "creation_date": 1536738563, "post_id": 52282282, "comment_id": 91527904, "body": "@Al_Iskander - not sure about that.  You might try posting a separate question about keeping it a UserForm on top.  Or google shows some techniques using the Windows API, e.g. : <a href=\"https://www.mrexcel.com/forum/excel-questions/386643-userform-always-top.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>"}], "tags": [], "owner": {"reputation": 114165, "user_id": 13087, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/260e2731006271646d36705a95c4db48?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/13087/joe"}, "is_accepted": true, "score": 1, "last_activity_date": 1536691592, "last_edit_date": 1536691592, "creation_date": 1536691153, "answer_id": 52282282, "question_id": 52282125, "link": "https://stackoverflow.com/questions/52282125/call-a-yes-no-form-from-module-in-vba/52282282#52282282", "title": "call a yes/no form from module in VBA", "body": "<p>You can add a property to your UserForm that indicates if Yes was clicked, e.g.:</p>\n\n<pre><code>Private bYesClicked As Boolean\n\nPublic Property Get YesClicked() As Boolean\n     YesClicked = bYesClicked\nEnd Property\n</code></pre>\n\n<p>Then set <code>bYesClicked</code> to True and hide the UserForm when the Yes button is clicked:</p>\n\n<pre><code>Private Sub YesButtonClick()\n   bYesClicked = True\n   Me.Hide\nEnd Sub\n</code></pre>\n\n<p>To use it, show your UserForm modally, then access the <code>YesClicked</code> property:</p>\n\n<pre><code>Dim u As MyUserForm\nSet u = New MyUserForm\nu.Show vbModal\nIf u.YesClicked Then ...\n</code></pre>\n"}], "owner": {"reputation": 791, "user_id": 6306448, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/035c760ea955c2fd227e16351e51cc1a?s=128&d=identicon&r=PG&f=1", "display_name": "Al_Iskander", "link": "https://stackoverflow.com/users/6306448/al-iskander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "accepted_answer_id": 52282282, "answer_count": 1, "score": 0, "last_activity_date": 1593761220, "creation_date": 1536690585, "last_edit_date": 1593761220, "question_id": 52282125, "link": "https://stackoverflow.com/questions/52282125/call-a-yes-no-form-from-module-in-vba", "title": "call a yes/no form from module in VBA", "body": "<p>I have module that sends several email automatically. I want to call a userform/msg that asks: \"Do you really want to send all the mails?\", depending if yes or no is chosen the macro continues or not.</p>\n\n<p>I know the simple solution with MsgBox(text, vbYesNo) but I want to solve this via a userform because I can solve different things with this as well. </p>\n\n<p>how can this be done that the macro only continues when the yes button in the userform has been clicked ? many thanks</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 784, "user_id": 6686925, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1b72cf30f0e2e490d2dcf157c6a7bcf?s=128&d=identicon&r=PG&f=1", "display_name": "SilverFish", "link": "https://stackoverflow.com/users/6686925/silverfish"}, "edited": false, "score": 0, "creation_date": 1536694062, "post_id": 52282403, "comment_id": 91514015, "body": "Thanks. Code works as expected, except that MyCopyRange will go after we get the value of LR"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 784, "user_id": 6686925, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1b72cf30f0e2e490d2dcf157c6a7bcf?s=128&d=identicon&r=PG&f=1", "display_name": "SilverFish", "link": "https://stackoverflow.com/users/6686925/silverfish"}, "edited": false, "score": 0, "creation_date": 1536694975, "post_id": 52282403, "comment_id": 91514432, "body": "Missed that - fixed"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1536694963, "last_edit_date": 1536694963, "creation_date": 1536691608, "answer_id": 52282403, "question_id": 52282093, "link": "https://stackoverflow.com/questions/52282093/excel-vba-if-file-closed-then-open-and-paste-else-just-paste-data/52282403#52282403", "title": "Excel VBA if file closed, then open and paste, else just paste data", "body": "<p>Slightly re-worked to add full workbook/sheet qualifiers and avoiding activate/select</p>\n\n<pre><code>Sub BU_Macro()\n\n    Dim LR As Long, X As Long, MyCopyRange, MyPasteRange, strFilePath\n    Dim wb, myData As Workbook, shtPaste As Worksheet\n\n    Set wb = ThisWorkbook\n\n     'Put ranges in an array\n    MyPasteRange = Array(\"A1\", \"B1\", \"C1\", \"D1\")\n\n    'open target csv file if not already opened\n    If CheckFileIsOpen(\"test.csv\") = False Then\n        Set myData = Workbooks.Open(strFilePath &amp; \"test.csv\")\n    Else\n        Set myData = Workbooks(\"test.csv\")\n    End If\n\n    Set shtPaste = myData.Sheets(\"test\")\n    shtPaste.UsedRange.Clear\n\n    With wb.Sheets(\"Report Group\")\n\n        LR = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n        If LR &gt; 1 Then\n            MyCopyRange = Array(\"A4:A\" &amp; LR, \"B4:B\" &amp; LR, \"C4:C\" &amp; LR, \"D4:D\" &amp; LR)\n            'Loop the array copying and pasting based on element in the array\n            For X = LBound(MyCopyRange) To UBound(MyCopyRange)\n                .Range(MyCopyRange(X)).Copy\n                shtPaste.Range(MyPasteRange(X)).PasteSpecial _\n                           xlPasteValuesAndNumberFormats 'xlPasteValues\n            Next\n        Else\n            shtPaste.Range(\"A1\") = \"No Data Found\"\n        End If\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 784, "user_id": 6686925, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1b72cf30f0e2e490d2dcf157c6a7bcf?s=128&d=identicon&r=PG&f=1", "display_name": "SilverFish", "link": "https://stackoverflow.com/users/6686925/silverfish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 491, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593761146, "creation_date": 1536690442, "last_edit_date": 1593761146, "question_id": 52282093, "link": "https://stackoverflow.com/questions/52282093/excel-vba-if-file-closed-then-open-and-paste-else-just-paste-data", "title": "Excel VBA if file closed, then open and paste, else just paste data", "body": "<p>I have VBA macros that copy data from various tabs within a workbook to a csv file after opening the csv file. This part is working fine. \nHowever, I want to check if the csv file is Not already open, then open it, and paste data. If it is already open, then just paste data.</p>\n\n<pre><code>Sub BU_Macro()\n\n\n\n    Dim LR As Long, X As Long\n    ThisWorkbook.Activate\n\n\n    With Sheets(\"Report Group\")\n\n        LR = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n        MyCopyRange = Array(\"A4:A\" &amp; LR, \"B4:B\" &amp; LR, \"C4:C\" &amp; LR, \"D4:D\" &amp; LR) 'Put ranges in an array\n        MyPasteRange = Array(\"A1\", \"B1\", \"C1\", \"D1\")\n\n        Dim myData As Workbook\n        'open target csv file if not already opened\n        If CheckFileIsOpen(\"test.csv\") = False Then\n            Set myData = Workbooks.Open(strFilePath &amp; \"test.csv\")\n\n        End If\n\n\n        Worksheets(\"test\").Select\n        Sheets(\"test\").UsedRange.Clear\n\n        If LR &gt; 1 Then\n            j = 0\n            For X = LBound(MyCopyRange) To UBound(MyCopyRange) 'Loop the array copying and pasting based on element in the array\n                .Range(MyCopyRange(j)).Copy\n                Sheets(\"test\").Range(MyPasteRange(j)).PasteSpecial xlPasteValuesAndNumberFormats 'xlPasteValues\n                j = j + 1\n            Next\n\n        Else\n            Range(\"A1\") = \"No Data Found\"\n        End If\n\n    End With\n\nEnd Sub\nFunction CheckFileIsOpen(chkfile As String) As Boolean\n\n    On Error Resume Next\n\n    CheckFileIsOpen = (Workbooks(chkfile).Name = chkfile)\n\n    On Error GoTo 0\n\nEnd Function\n</code></pre>\n\n<p>If file is closed, it opens it and pastes date, But if the file is already open, I get error:</p>\n\n<pre><code>Run-time error '9':\nSubscript out of range\non line-\nWorksheets(\"test\").Select\n</code></pre>\n\n<p>I guess, I am not being able to direct my code to focus on test.csv</p>\n"}, {"tags": ["sql", "ms-access", "vba", "dcount"], "answers": [{"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1536692100, "creation_date": 1536692100, "answer_id": 52282521, "question_id": 52282075, "link": "https://stackoverflow.com/questions/52282075/access-vba-run-time-error-3078-or-type-mismatch-on-dcount-function/52282521#52282521", "title": "Access VBA Run-time error 3078, or Type Mismatch on DCount function", "body": "<p>You cannot use a VBA recordset inside a domain aggregate like <code>DCount</code> as a string literal is required for table/query name argument. Simply save your query and then reference it by name in <code>DCount</code>.</p>\n\n<p><strong>SQL</strong> <em>(save as query)</em></p>\n\n<pre><code>SELECT RIGHT(IRSfileFormatKey, 10) As ID FROM 1042s_FinalOutput_7;\n</code></pre>\n\n<p><strong>VBA</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If !external_nmad_id = DCount(\"[ID]\", \"mySavedQuery\") Then\n   ...\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 9926966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQMCN.png?s=128&g=1", "display_name": "rgorowsky", "link": "https://stackoverflow.com/users/9926966/rgorowsky"}, "edited": false, "score": 0, "creation_date": 1536693092, "post_id": 52282541, "comment_id": 91513622, "body": "Thankyou, I didn&#39;t realize that DCount cannot operate directly against a recordset.  After knowing that I just had to change stratagy.  I was able to use DCount to do the same query so now I removed the StrSQL and instead it&#39;s &quot; = DCount(&quot;RIGHT([IRSfileFormatKey], 10)&quot;, &quot;1042s_FinalOutput_7&quot;)"}], "tags": [], "owner": {"reputation": 704, "user_id": 4999393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae8b5ed2ea0bdebd8989c9122f6c7c22?s=128&d=identicon&r=PG&f=1", "display_name": "Jericho Johnson", "link": "https://stackoverflow.com/users/4999393/jericho-johnson"}, "is_accepted": true, "score": 1, "last_activity_date": 1536692226, "creation_date": 1536692226, "answer_id": 52282541, "question_id": 52282075, "link": "https://stackoverflow.com/questions/52282075/access-vba-run-time-error-3078-or-type-mismatch-on-dcount-function/52282541#52282541", "title": "Access VBA Run-time error 3078, or Type Mismatch on DCount function", "body": "<p>The issue is that the DCount function cannot operate directly against a Recordset.</p>\n\n<p>You are declaring <code>StrSQL1</code> as a RecordSet object and setting it to a RecordSet based on your <code>Select</code> statement.</p>\n\n<pre><code>Set StrSQL1 = db.OpenRecordset(\"SELECT RIGHT(IRSfileFormatKey, 10) As ID FROM 1042s_FinalOutput_7;\")\n</code></pre>\n\n<p>You are then trying to pass this RecordSet to the <code>DCount</code> function which cannot accept a RecordSet object as the <code>Domain</code> parameter.  As you can see in MSDN the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/access.application.dcount\" rel=\"nofollow noreferrer\">DCount</a> function requires a String parameter in the second position to define the \"query\" that you wish to \"Count\".  Hence the 3078 error.  When you remove the quotes around <code>[ID]</code> in your DCount line, you get Type Mismatch as a compile error because <code>[ID]</code> is not a String or String variable.</p>\n\n<p>After you resolve that, you might want to reconsider your <code>If</code> statement.  You haven't provided a sample of what kind of value <code>!external_nmad_id</code> will contain, other than the fact that it is a String value.  The <code>DCount</code> function is going to return the number of rows found in the Domain (query) that you told it to count, so it appears you will be comparing a string (which may possibly contain alpha characters) to a number.  Access will implicitly convert the <code>DCount</code> numeric result to a String for the sake of the comparison, but if your <code>!external_nmad_id</code> String is truly 10 characters or contains alpha characters, they will never match.</p>\n"}], "owner": {"reputation": 55, "user_id": 9926966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQMCN.png?s=128&g=1", "display_name": "rgorowsky", "link": "https://stackoverflow.com/users/9926966/rgorowsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 52282541, "answer_count": 2, "score": 0, "last_activity_date": 1594629322, "creation_date": 1536690348, "last_edit_date": 1594629322, "question_id": 52282075, "link": "https://stackoverflow.com/questions/52282075/access-vba-run-time-error-3078-or-type-mismatch-on-dcount-function", "title": "Access VBA Run-time error 3078, or Type Mismatch on DCount function", "body": "<p>Objective:  I'm building VBA code to filter through an address table <em>SunstarAccountsInWebir_SarahTest</em>.  I want to loop through first and see if the address is \"valid\".  </p>\n\n<ul>\n<li>If it is not valid \u2013 export to different table.  </li>\n<li>If it is valid \u2013 it enters another nested if/then within \"valid\" address rows:\n\n<ul>\n<li>If their ID, <em>external_nmad_id</em> matches the ID of the second table <em>1042s_FinalOutput_7</em>, I want to update one of the columns in the second table <em>box13c_Address</em>.  </li>\n<li>If it doesn't match an ID of the second table \u2013 it will be exported to a different table.</li>\n</ul></li>\n</ul>\n\n<p>My problem is when I run my code it is returning </p>\n\n<blockquote>\n  <p>Run-Time error 3078: cannot find table or query</p>\n</blockquote>\n\n<p>(it's breaking at the line where I compare the value of the cell (as string) against the <code>DCount</code> of table 2). If I remove the quotes around it I get a different error:  </p>\n\n<blockquote>\n  <p>Type mismatch against the <code>DCount</code></p>\n</blockquote>\n\n<p>I feel like I'm missing something simple but can't tell what.  How can I get my code to match a string value called in <code>!external_nmad_id</code> against the rest of the table called in my string? <code>DCount(\"[ID]\", StrSQL1)</code></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub EditFinalOutput2()\n\n'set variables\nDim i As Long\nDim qs As DAO.Recordset\nDim ss As DAO.Recordset\nDim StrSQL1 As DAO.Recordset\nDim IRSfileFormatKey As String\nDim external_nmad_id As String\nDim nmad_address_1 As String\nDim nmad_address_2 As String\nDim nmad_address_3 As String\nDim mytestwrite As String\n\n'open reference set\nSet db = CurrentDb\nSet qs = db.OpenRecordset(\"SunstarAccountsInWebir_SarahTest\")\n'Set ss = db.OpenRecordset(\"1042s_FinalOutput_7\")\n'Set StrSQL1 = db.OpenRecordset(\"SELECT RIGHT(IRSfileFormatKey, 10) As ID \n'FROM 1042s_FinalOutput_7;\")\n\nWith qs.Fields\nintCount = qs.RecordCount - 1\nFor i = 0 To intCount\n\n    If (IsNull(!nmad_address_1) Or (!nmad_address_1 = !nmad_city) Or (!nmad_address_1 = !Webir_Country) And IsNull(!nmad_address_2) Or (!nmad_address_2 = !nmad_city) Or (!nmad_address_2 = !Webir_Country) And IsNull(!nmad_address_3) Or (!nmad_address_3 = !nmad_city) Or (!nmad_address_3 = !Webir_Country)) Then\n    DoCmd.RunSQL \"INSERT INTO Addresses_ToBeReviewed SELECT SunstarAccountsInWebir_SarahTest.* FROM SunstarAccountsInWebir_SarahTest WHERE (((SunstarAccountsInWebir_SarahTest.external_nmad_id)='\" &amp; qs!external_nmad_id &amp; \"'));\"\n\n    Else:\n        Set ss = db.OpenRecordset(\"1042s_FinalOutput_7\")\n        Set StrSQL1 = db.OpenRecordset(\"SELECT RIGHT(IRSfileFormatKey, 10) As ID FROM 1042s_FinalOutput_7;\")\n        If !external_nmad_id = DCount(\"[ID]\", StrSQL1) Then\n                ss.Edit\n                ss.Fields(\"box13c_Address\") = qs.Fields(\"nmad_address_1\") &amp; qs.Fields(\"nmad_address_2\") &amp; qs.Fields(\"nmad_address_3\")\n                ss.Update\n\n        Else:   DoCmd.SetWarnings False\n                DoCmd.RunSQL \"INSERT INTO Addresses_NotUsed SELECT SunstarAccountsInWebir_SarahTest.* FROM SunstarAccountsInWebir_SarahTest WHERE (((SunstarAccountsInWebir_SarahTest.external_nmad_id)='\" &amp; qs!external_nmad_id &amp; \"'));\"\n                DoCmd.SetWarnings True\n        End If\n\n    End If\n\nqs.MoveNext\nNext i\n\nEnd With\n\n'close reference set\nqs.Close\nSet qs = Nothing\nss.Close\nSet ss = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1536689209, "post_id": 52281753, "comment_id": 91511598, "body": "for starters, this won&#39;t ever evaluate properly if you always <code>vbLowerCase</code> the username but then compare against usernames starting with an uppercase letter, <code>Username1, ... </code> :p"}, {"owner": {"reputation": 47, "user_id": 3137443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f19d757ff1f11eace394ee29bc245a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/3137443/josephd"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536689456, "post_id": 52281753, "comment_id": 91511715, "body": "Thank you for catching that. I replaced the actual usernames when I pasted the code and used uppercases for the dummy usernames out of habit."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536689495, "post_id": 52281753, "comment_id": 91511738, "body": "Yeah I figured it was just a little oversight. This isn&#39;t a big deal to convert. I&#39;m working on it now but someone else may well beat me to it lol"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 6, "creation_date": 1536691238, "post_id": 52281753, "comment_id": 91512681, "body": "You have a small typo in your message box - &quot;spreadsheet&quot; is misspelled &quot;database&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 3137443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f19d757ff1f11eace394ee29bc245a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/3137443/josephd"}, "edited": false, "score": 0, "creation_date": 1536690301, "post_id": 52281905, "comment_id": 91512141, "body": "Thank you. I added the code to the <code>ThisWorkbook</code> module and changed the username to someone else. After saving, closing, and then re-opening the workbook, nothing happens. The code doesn&#39;t seem to be running. I have the code pasted almost verbatim from how it is above. Thoughts?"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 47, "user_id": 3137443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f19d757ff1f11eace394ee29bc245a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/3137443/josephd"}, "edited": false, "score": 0, "creation_date": 1536690659, "post_id": 52281905, "comment_id": 91512337, "body": "@JosephD it might have been that I left out the <code>&gt; 0</code> evaluation following <code>InStr()</code> ?"}, {"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 1, "creation_date": 1536690737, "post_id": 52281905, "comment_id": 91512394, "body": "This should be called by the Workbook_Open event.  Change &quot;Auto_Open&quot; to &quot;Workbook_Open&quot;."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1536690913, "post_id": 52281905, "comment_id": 91512496, "body": "Interesting, now that works. I see that auto_open only exists for compatiblity reasons but can you help me understand why it didnt work in this case, @FrankBall"}, {"owner": {"reputation": 47, "user_id": 3137443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f19d757ff1f11eace394ee29bc245a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/3137443/josephd"}, "edited": false, "score": 0, "creation_date": 1536691404, "post_id": 52281905, "comment_id": 91512776, "body": "The code runs, but I get a compile error in the <code>ThisWorkbook</code> module. The error indicates that there is incompatible code with the version, platform, or architecture of the application. I am using Excel 2010 to run the workbook if that helps."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536691649, "post_id": 52281905, "comment_id": 91512906, "body": "Ah hm I can&#39;t really replicate that on my machine - the only &quot;unusual&quot; code would be the <code>Environ(&quot;username&quot;)</code> bit... could you try manually running the sub with a bunch of <a href=\"https://www.wiseowl.co.uk/blog/s196/breakpoints.htm\" rel=\"nofollow noreferrer\">breakpoints</a> to see where it breaks?"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 47, "user_id": 3137443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f19d757ff1f11eace394ee29bc245a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/3137443/josephd"}, "edited": false, "score": 0, "creation_date": 1536691868, "post_id": 52281905, "comment_id": 91513009, "body": "@JosephD maybe it was the little <code>$</code> I used to designate that <code>LCase</code> was for a string? I&#39;m not sure"}, {"owner": {"reputation": 47, "user_id": 3137443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f19d757ff1f11eace394ee29bc245a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/3137443/josephd"}, "edited": false, "score": 0, "creation_date": 1536692656, "post_id": 52281905, "comment_id": 91513426, "body": "I updated the code with what you changed and now it&#39;s not doing anything. I am not getting any compile errors, but it&#39;s also not running on workbook open."}, {"owner": {"reputation": 47, "user_id": 3137443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f19d757ff1f11eace394ee29bc245a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/3137443/josephd"}, "edited": false, "score": 0, "creation_date": 1536693770, "post_id": 52281905, "comment_id": 91513888, "body": "Yeah, that&#39;s been my experience with coding in general. I appreciate you helping me with this though."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1536693921, "post_id": 52281905, "comment_id": 91513955, "body": "@FrankBall any ideas?"}, {"owner": {"reputation": 47, "user_id": 3137443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f19d757ff1f11eace394ee29bc245a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/3137443/josephd"}, "edited": false, "score": 0, "creation_date": 1536698348, "post_id": 52281905, "comment_id": 91515913, "body": "I added an update to the code. I think there&#39;s an issue with the username identification and comparison part. Thoughts?"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 47, "user_id": 3137443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f19d757ff1f11eace394ee29bc245a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/3137443/josephd"}, "edited": false, "score": 0, "creation_date": 1536699195, "post_id": 52281905, "comment_id": 91516297, "body": "@JosephD I\u2019be never used <code>Application.Workbook</code> before, so I\u2019m really not sure what it references"}, {"owner": {"reputation": 47, "user_id": 3137443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f19d757ff1f11eace394ee29bc245a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/3137443/josephd"}, "edited": false, "score": 1, "creation_date": 1536699714, "post_id": 52281905, "comment_id": 91516505, "body": "From what I have read, there isn&#39;t too much of a difference in the two references as long as you are only working with one workbook. I am not sure why the <code>ThisWorkbook</code> reference wasn&#39;t working for me, but I am not getting a compile error anymore and the code works as intended. Thanks again for your help. You got me 90% of the way there and I really appreciate it."}], "tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": false, "score": 1, "last_activity_date": 1536692987, "last_edit_date": 1536692987, "creation_date": 1536689637, "answer_id": 52281905, "question_id": 52281753, "link": "https://stackoverflow.com/questions/52281753/prevent-opening-excel-workbook-saved-in-specific-location/52281905#52281905", "title": "Prevent opening Excel workbook saved in specific location", "body": "<p>If you drop this into the <a href=\"https://support.office.com/en-us/article/automatically-run-a-macro-when-opening-a-workbook-1e55959b-e077-4c88-a696-c3017600db44\" rel=\"nofollow noreferrer\"><code>ThisWorkbook</code> module of the workbook</a> you want to limit access to, it should work.</p>\n\n<pre><code>Private Sub Workbook_Open()\n\n    If InStr(ThisWorkbook.path, \"G:\\\") &gt; 0 _\n    Or InStr(ThisWorkbook.path, \"\\\\NetWorkLocation\\\") &gt; 0 Then\n\n        Select Case LCase(Environ(\"username\"))\n        Case \"username1\", \"username2\", \"username3\"\n\n        Case Else\n            MsgBox \"Copy and paste this spreadsheet to your desktop.\" &amp; _\n                vbCrLf &amp; \"You may not open it from this location.\"\n\n            ThisWorkbook.Close savechanges:=False\n        End Select\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 47, "user_id": 3137443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f19d757ff1f11eace394ee29bc245a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/3137443/josephd"}, "is_accepted": true, "score": 0, "last_activity_date": 1536699354, "creation_date": 1536699354, "answer_id": 52284084, "question_id": 52281753, "link": "https://stackoverflow.com/questions/52281753/prevent-opening-excel-workbook-saved-in-specific-location/52284084#52284084", "title": "Prevent opening Excel workbook saved in specific location", "body": "<p>This is the completed code and I have confirmed that it works.</p>\n\n<pre><code>Sub Workbook_Open()\n\nIf VBA.InStr(1, Application.Workbook.Path, \"G:\\\") &gt; 0 _\nOr VBA.InStr(1, Application.Workbook.Path, \"\\\\NetWorkLocation\\\") &gt; 0 Then\n\n   Select Case VBA.StrConv(VBA.Environ(\"username\"), vbLowerCase)\n   Case \"username1\", \"username2\", \"username3\"\n\n   Case Else\n       VBA.MsgBox \"Copy and paste this workbook to your desktop.\" _\n            &amp; vbCrLf &amp; \"You may not open it from this location.\"\n   ActiveWorkbook.Close \n\n   End Select\n\nEnd If\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 3137443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f19d757ff1f11eace394ee29bc245a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/3137443/josephd"}, "edited": false, "score": 0, "creation_date": 1536704282, "post_id": 52284822, "comment_id": 91518092, "body": "Thanks Frank. The other code that I posted works with the <code>Application.Workbook. Path</code> code as intended. Did you go back to the <code>ThisWorkbook</code> reference?"}], "tags": [], "owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "is_accepted": false, "score": 0, "last_activity_date": 1536703703, "creation_date": 1536703703, "answer_id": 52284822, "question_id": 52281753, "link": "https://stackoverflow.com/questions/52281753/prevent-opening-excel-workbook-saved-in-specific-location/52284822#52284822", "title": "Prevent opening Excel workbook saved in specific location", "body": "<p>ThisWorkbook.Path returns \"G:\", not \"G:\\\" when the file is saved at the root of \"G:\".  Drop the \"\\\" and you'll be golden. </p>\n\n<p>FYI - I debugged this by putting the code into it's own function to make it easier to debug (didn't have to keep opening and closing the file to call the function), and then stepped through that function.  The first \"If\" statement failed and the check for the user never happened, So I added a Watch to ThisWorkbook.Path and saw that it was returning \"G:\" and not G:\\\".  Here's JosephD's function with the correction:</p>\n\n<pre><code>Sub Workbook_Open()\n\nIf VBA.InStr(1, Application.Workbook.Path, \"G:\") &gt; 0 _\nOr VBA.InStr(1, Application.Workbook.Path, \"\\\\NetWorkLocation\\\") &gt; 0 Then\n\n   Select Case VBA.StrConv(VBA.Environ(\"username\"), vbLowerCase)\n   Case \"username1\", \"username2\", \"username3\"\n\n   Case Else\n       VBA.MsgBox \"Copy and paste this workbook to your desktop.\" _\n            &amp; vbCrLf &amp; \"You may not open it from this location.\"\n   ActiveWorkbook.Close \n\n   End Select\n\nEnd If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 3137443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f19d757ff1f11eace394ee29bc245a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/3137443/josephd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "accepted_answer_id": 52284084, "answer_count": 3, "score": 2, "last_activity_date": 1593954218, "creation_date": 1536689014, "last_edit_date": 1593954218, "question_id": 52281753, "link": "https://stackoverflow.com/questions/52281753/prevent-opening-excel-workbook-saved-in-specific-location", "title": "Prevent opening Excel workbook saved in specific location", "body": "<p>I am trying to prevent users other than authorized users from opening a workbook if it's being opened from the location that the workbook is saved. What I want is for the user to copy the workbook to another location and then open it. I have used the code below for Access databases, but I am not sure how to adapt it for Excel. Can someone help?</p>\n\n<pre><code>Option Compare Database\nPrivate Function AutoExec()\n ' Use Macro to run code and use the AutoExec() name\n    If VBA.InStr(1, CurrentDb.Name, \"G:\\\") _\n    Or VBA.InStr(1, CurrentDb.Name, \"\\\\NetWorkLocation\\\") Then\n\n        Select Case VBA.StrConv(VBA.Environ(\"username\"), vbLowerCase)\n        Case \"username1\", \"username2\", \"username3\"\n\n        Case Else\n            VBA.MsgBox \"Copy and paste this database to your desktop.\" _\n                &amp; vbCrLf &amp; \"You may not open it from this location.\"\n         DoCmd.CloseDatabase\n        End Select\n\n    End If\n\n End Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536690485, "post_id": 52281725, "comment_id": 91512260, "body": "Not sure I understand why you&#39;re using 2 FileSystemObjects, but you can loop through the <code>.Files</code> collection with a <code>For Each</code> loop. Without seeing what you&#39;re doing with the copies, the <code>Kill</code> statement may belong outside the loop."}, {"owner": {"reputation": 103, "user_id": 10327178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d795576bc6af57a1b001634ff9750aff?s=128&d=identicon&r=PG&f=1", "display_name": "Piccinin", "link": "https://stackoverflow.com/users/10327178/piccinin"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536691980, "post_id": 52281725, "comment_id": 91513064, "body": "Noted. There&#39;re 2 filesystem objects because i looked at 2 different codes on internet to help me. THought it wouldn&#39;t make a different."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1536690466, "creation_date": 1536690466, "answer_id": 52282101, "question_id": 52281725, "link": "https://stackoverflow.com/questions/52281725/is-there-a-way-to-copy-files-one-by-one-after-doing-a-specific-action-on-these/52282101#52282101", "title": "Is there a way to copy files one by one after doing a specific action on these?", "body": "<p>You should be able to do something like this:</p>\n\n<pre><code>Dim f\n'...\n'...\nFor Each f in xFolder.Files\n\n    f.Copy sDFolder &amp; f.Name\n\n    MsgBox \"File '\" &amp; f.Name &amp; \"' Copied Successfully\", _\n            vbInformation, \"Done!\"\n\n    'DostuffHere on each file one by one before deleting\n\n     On Error Resume Next\n     Kill sDFolder &amp; \"*.*\"\n     On Error GoTo 0\n\nNext f\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 10327178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d795576bc6af57a1b001634ff9750aff?s=128&d=identicon&r=PG&f=1", "display_name": "Piccinin", "link": "https://stackoverflow.com/users/10327178/piccinin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 52282101, "answer_count": 1, "score": 0, "last_activity_date": 1536690466, "creation_date": 1536688910, "question_id": 52281725, "link": "https://stackoverflow.com/questions/52281725/is-there-a-way-to-copy-files-one-by-one-after-doing-a-specific-action-on-these", "title": "Is there a way to copy files one by one after doing a specific action on these?", "body": "<p>I am using the following code. Not being able to copy file one by one using the FSO function. I tried using f(for file) so it represents each file one by one but i don't think i am doing it right. Any way of doing this without the dir function? </p>\n\n<pre><code> Dim myFSO As FileSystemObject\n Dim xFolder As Scripting.Folder\n Dim FSO As Object\n Dim f As File\n Dim sDFolder As String\n\nsDFolder = \"W:\\Destination\\\"\n\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\n\nSet myFSO = New FileSystemObject\n\nSet xFolder = myFSO.GetFolder(\"C:\\Users\\amzubaid\\Desktop\\ISIN- \nCompiler Temp\")\n\nFor i = 1 To xFolder.Files.Count\n\nFSO.CopyFile (\"C:\\Users\\Tom\\TestFolder\\\" &amp; \nf), sDFolder, True\n\nMsgBox \"Specified File Copied Successfully\", vbInformation, \n\"Done!\"\n\nDostuffHere on each file one by one before deleting\n\nOn Error Resume Next\n\nKill \"W:\\Destination\\*.*\"\n\nOn Error GoTo 0\n\n Next i\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 1, "creation_date": 1536688288, "post_id": 52281546, "comment_id": 91511116, "body": "how do you want to use the function? what is rs?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1536688385, "post_id": 52281546, "comment_id": 91511155, "body": "Um, why not use GEOMEAN()?  I know it is available on Office 365 Excel, maybe not on older versions?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1536688446, "post_id": 52281546, "comment_id": 91511187, "body": "It is available since Excel 2007, <a href=\"https://support.office.com/en-us/article/geomean-function-db1ac48d-25a5-40a0-ab83-0b38980e40d5\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1536688485, "post_id": 52281546, "comment_id": 91511210, "body": "See my second comment, are you using older than 2007?"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1536688499, "post_id": 52281546, "comment_id": 91511215, "body": "@ScottCraner <code>&quot; I know there is a worksheet function already but I am trying to write this on my own&quot;</code> from the question"}, {"owner": {"reputation": 3153, "user_id": 7707677, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9af5b483632716d4cc95bfed423161f?s=128&d=identicon&r=PG&f=1", "display_name": "Lokesh Agrawal", "link": "https://stackoverflow.com/users/7707677/lokesh-agrawal"}, "edited": false, "score": 0, "creation_date": 1536688525, "post_id": 52281546, "comment_id": 91511231, "body": "Yes, and qn is more on whats wrong with the above fn."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1536688590, "post_id": 52281546, "comment_id": 91511269, "body": "Can you give an example of an incorrect input and output? Continually raising to a fractional power in a loop makes me suspect that you don&#39;t have enough precision in a <code>Single</code>."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1536688673, "post_id": 52281546, "comment_id": 91511309, "body": "@Marcucciboy2 who has time to read?  My bad.  Felt bad so answered."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 2, "last_activity_date": 1536688614, "creation_date": 1536688614, "answer_id": 52281653, "question_id": 52281546, "link": "https://stackoverflow.com/questions/52281546/writing-vba-code-for-finding-geometric-mean/52281653#52281653", "title": "Writing VBA code for finding geometric mean", "body": "<p>No loop needed just use <code>Application.Product</code></p>\n\n<pre><code>Function Geometric(rs As Range)\n    Dim Sum As Double\n    Dim n As Long\n    n = rs.Count\n\n    Sum = Application.Product(rs) ^ (1 / n)\n\n    Geometric = Sum\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1536688677, "post_id": 52281657, "comment_id": 91511312, "body": "you can use <code>application.product</code> too, but it depends how you want to use the range where there are you data"}], "tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": false, "score": 2, "last_activity_date": 1536688622, "creation_date": 1536688622, "answer_id": 52281657, "question_id": 52281546, "link": "https://stackoverflow.com/questions/52281546/writing-vba-code-for-finding-geometric-mean/52281657#52281657", "title": "Writing VBA code for finding geometric mean", "body": "<p>You formula was wrong, use this:</p>\n\n<pre><code>Option Explicit\nFunction Geometric(rs as range)\n    Dim dGM As Double\n    Dim i As Integer\n    Dim n As Integer\n    n = rs.Count\n    dGM = 1\n    For i = 1 To n\n        dGM = dGM * rs(i)\n    Next i\n\n    Geometric = dGM ^ (1 / n)\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 4, "last_activity_date": 1536698825, "last_edit_date": 1536698825, "creation_date": 1536689210, "answer_id": 52281796, "question_id": 52281546, "link": "https://stackoverflow.com/questions/52281546/writing-vba-code-for-finding-geometric-mean/52281796#52281796", "title": "Writing VBA code for finding geometric mean", "body": "<p>This will account for different types of inputs (I called the input <code>arg_vNumbers</code> instead of <code>rs</code>) and also only processes for inputs that are actually numbers, so it will ignore text, etc):</p>\n\n<pre><code>Public Function GEOMETRICMEAN(ByVal arg_vNumbers As Variant) As Variant\n\n    Dim rConstants As Range\n    Dim rFormulas As Range\n    Dim rAdjusted As Range\n    Dim vElement As Variant\n    Dim lTotalElements As Long\n    Dim dProductTotal As Double\n\n    Select Case TypeName(arg_vNumbers)\n        Case \"Range\"\n            If arg_vNumbers.Rows.Count = arg_vNumbers.Parent.Rows.Count Then\n                Set rAdjusted = Intersect(arg_vNumbers.Parent.UsedRange, arg_vNumbers)\n            Else\n                Set rAdjusted = arg_vNumbers\n            End If\n            On Error Resume Next\n            Set rConstants = rAdjusted.SpecialCells(xlCellTypeConstants, xlNumbers)\n            Set rFormulas = rAdjusted.SpecialCells(xlCellTypeFormulas, xlNumbers)\n            On Error GoTo 0\n            Select Case Abs((rConstants Is Nothing) + 2 * (rFormulas Is Nothing))\n                Case 0: Set rAdjusted = Union(rConstants, rFormulas)\n                Case 1: Set rAdjusted = rFormulas\n                Case 2: Set rAdjusted = rConstants\n                Case 3: GEOMETRICMEAN = CVErr(xlErrDiv0)\n                        Exit Function\n            End Select\n\n            For Each vElement In rAdjusted\n                If IsNumeric(vElement) And Len(vElement) &gt; 0 Then\n                    lTotalElements = lTotalElements + 1\n                    If lTotalElements = 1 Then\n                        dProductTotal = vElement\n                    Else\n                        dProductTotal = dProductTotal * vElement\n                    End If\n                End If\n            Next vElement\n            If lTotalElements &gt; 0 Then\n                GEOMETRICMEAN = dProductTotal ^ (1 / lTotalElements)\n            Else\n                GEOMETRICMEAN = CVErr(xlErrDiv0)\n            End If\n\n        Case \"Variant()\", \"Collection\", \"Dictionary\"\n            For Each vElement In arg_vNumbers\n                If IsNumeric(vElement) Then\n                    lTotalElements = lTotalElements + 1\n                    If lTotalElements = 1 Then\n                        dProductTotal = vElement\n                    Else\n                        dProductTotal = dProductTotal * vElement\n                    End If\n                End If\n            Next vElement\n            If lTotalElements &gt; 0 Then\n                GEOMETRICMEAN = dProductTotal ^ (1 / lTotalElements)\n            Else\n                GEOMETRICMEAN = CVErr(xlErrDiv0)\n            End If\n\n        Case Else\n            If IsNumeric(arg_vNumbers) Then\n                GEOMETRICMEAN = arg_vNumbers\n            Else\n                GEOMETRICMEAN = CVErr(xlErrDiv0)\n            End If\n\n    End Select\n\nEnd Function\n</code></pre>\n\n<p>The advantage to this is that it can also accept user defined arrays as part of a worksheet formula, for example: <code>=GEOMETRICMEAN({2,8})</code> in addition to accepting a range of numbers.  It can also accept VBA arrays, Collections and Dictionaries and will process only the numeric portions of those objects.  If no numbers are included anywhere in the input, it returns a <code>#DIV/0!</code> error.</p>\n\n<p>These allowances and error handling cause this UDF to behave pretty closely to how the built-in <code>GEOMEAN</code> function does.</p>\n"}], "owner": {"reputation": 3153, "user_id": 7707677, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9af5b483632716d4cc95bfed423161f?s=128&d=identicon&r=PG&f=1", "display_name": "Lokesh Agrawal", "link": "https://stackoverflow.com/users/7707677/lokesh-agrawal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 951, "favorite_count": 0, "accepted_answer_id": 52281796, "answer_count": 3, "score": 1, "last_activity_date": 1536698825, "creation_date": 1536688143, "question_id": 52281546, "link": "https://stackoverflow.com/questions/52281546/writing-vba-code-for-finding-geometric-mean", "title": "Writing VBA code for finding geometric mean", "body": "<p>I am trying to create a custom VBA function that calculates the geometric mean. I know there is a worksheet function already but I am trying to write this on my own. Geometric Mean = nth root of multiple of n numbers.</p>\n\n<p>For example: Assume you have the following 2 numbers in excel column: 2, 8</p>\n\n<p>Geometric Mean = (2*8)^(1/n); n = 2, since there are 2 numbers, 2 and 8. \nso, geometric mean = (2*8)^(1/2)=16^(1/2) = 4</p>\n\n<p>So I have to write a simple VBA-excel code/function to find the geometric mean of any set of numbers in an excel column. I wrote a code but it doesn't give me the correct answers, could you please help me to correct it?</p>\n\n<pre><code>Option Explicit\nFunction Geometric(rs)\nDim Sum as single\nDim i As Integer\nDim n As Integer\nn = rs.Count\nFor i = 1 To n\nsum = sum + (rs(i)) ^ (1 / n)\nNext i\nGeometric = sum\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "xpath"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 2, "creation_date": 1536687674, "post_id": 52281387, "comment_id": 91510832, "body": "The debugger will tell you for sure, but I&#39;m going to bet that <code>Set elem = getXPathElement</code> failed, which means trying to read <code>elem.innerText</code> is causing the error."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1536688473, "post_id": 52281387, "comment_id": 91511205, "body": "You&#39;re making a member call against an object reference that&#39;s <code>Nothing</code>. What line is throwing the error? What&#39;s <code>getXPathElement</code> doing exactly?"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1536691042, "last_edit_date": 1536691042, "creation_date": 1536689730, "answer_id": 52281922, "question_id": 52281387, "link": "https://stackoverflow.com/questions/52281387/getting-error-91-object-variable-or-with-block-variable-not-set/52281922#52281922", "title": "Getting error 91 &quot;Object variable or with block variable not set&quot;", "body": "<p>That element has an id you can use instead</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\nPublic Sub abc()\n    Dim objIE As InternetExplorer, elem As HTMLBaseElement\n    Set objIE = New InternetExplorer\n    objIE.Visible = True\n\n    objIE.navigate \"https://www.nseindia.com/live_market/dynaContent/live_watch/get_quote/GetQuote.jsp?symbol=COALINDIA\"\n    Do While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\n    Set elem = objIE.document.getElementById(\"lastPrice\")\n    Debug.Print elem.innerText\n    ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A5\").Value = elem.innerText\n    objIE.Quit\nEnd Sub\n</code></pre>\n\n<p>I am guessing <code>getXPathElement</code> is a custom function? There isn't a native XPath selector method. If so, include the function in your question if you must have a solution using that function.</p>\n"}], "owner": {"reputation": 11, "user_id": 10348975, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LmOy6QgtlFE/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPWZD0LLEss_JR-fnhfmpCewVb_5g/mo/photo.jpg?sz=128", "display_name": "rakesh", "link": "https://stackoverflow.com/users/10348975/rakesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536726998, "creation_date": 1536687445, "last_edit_date": 1536726998, "question_id": 52281387, "link": "https://stackoverflow.com/questions/52281387/getting-error-91-object-variable-or-with-block-variable-not-set", "title": "Getting error 91 &quot;Object variable or with block variable not set&quot;", "body": "<p>Running the below code throws error 91. What is wrong with it?</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub abc()\n    Dim objIE As InternetExplorer\n    Set objIE = New InternetExplorer\n    Dim elem As HTMLBaseElement\n    objIE.Visible = True\n\n    objIE.navigate \"https://www.nseindia.com/live_market/dynaContent/live_watch/get_quote/GetQuote.jsp?symbol=COALINDIA\"\n    Do While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\n    Set elem = getXPathElement(\"/html[1]/body[1]/div[2]/div[4]/div[2]/div[1]/div[4]/ul[1]/li[1]/span[1]\", objIE.document)\n    Range(\"A5\").Value = elem.innerText\n\nEnd Sub\n</code></pre>\n\n<p>Public Function getXPathElement(sXPath As String, objElement As HTMLBaseElement) As HTMLBaseElement\n    Dim sXPathArray() As String</p>\n\n<pre><code>Dim sNodeName As String\nDim sNodeNameIndex As String\nDim sRestOfXPath As String\nDim lNodeIndex As Long\nDim lCount As Long\n\n' Split the xpath statement\nsXPathArray = Split(sXPath, \"/\")\nsNodeNameIndex = sXPathArray(1)\nIf Not InStr(sNodeNameIndex, \"[\") &gt; 0 Then\n    sNodeName = sNodeNameIndex\n    lNodeIndex = 1\nElse\n    sXPathArray = Split(sNodeNameIndex, \"[\")\n    sNodeName = sXPathArray(0)\n    lNodeIndex = CLng(Left(sXPathArray(1), Len(sXPathArray(1)) - 1))\nEnd If\nsRestOfXPath = Right(sXPath, Len(sXPath) - (Len(sNodeNameIndex) + 1))\n\nSet getXPathElement = Nothing\nFor lCount = 0 To objElement.ChildNodes().Length - 1\n    If UCase(objElement.ChildNodes().Item(lCount).nodeName) = UCase(sNodeName) Then\n        If lNodeIndex = 1 Then\n            If sRestOfXPath = \"\" Then\n                Set getXPathElement = objElement.ChildNodes().Item(lCount)\n            Else\n                Set getXPathElement = getXPathElement(sRestOfXPath, objElement.ChildNodes().Item(lCount))\n            End If\n        End If\n        lNodeIndex = lNodeIndex - 1\n    End If\nNext lCount\n</code></pre>\n\n<p>End Function</p>\n"}]