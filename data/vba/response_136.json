[{"tags": ["vba", "macos", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1502927595, "post_id": 45724617, "comment_id": 78406966, "body": "Well, to start you should learn OS basics. :-) On *nix based operating systems, the forward slash is the path separator. The backslash is Windows."}, {"owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "edited": false, "score": 1, "creation_date": 1502934294, "post_id": 45724617, "comment_id": 78408374, "body": "the Mac version of Excel is not nearly as powerful as the Windows version, and the VBA is especially weak on the mac.  I use a Windows emulator (parallels or vmware) just so that I can have the Windows versions of Excel, Word, and PowerPoint. In my opinion, it&#39;s deceptive to even call the Mac versions by the same names. But if you really want to try to use mac versions for VBA, here is a link: <a href=\"https://stackoverflow.com/questions/10045474/dir-function-not-working-in-mac-excel-2011-vba\" title=\"dir function not working in mac excel 2011 vba\">stackoverflow.com/questions/10045474/&hellip;</a>"}, {"owner": {"reputation": 13, "user_id": 8475130, "user_type": "registered", "profile_image": "https://graph.facebook.com/1268584373267275/picture?type=large", "display_name": "Peter Kim", "link": "https://stackoverflow.com/users/8475130/peter-kim"}, "edited": false, "score": 0, "creation_date": 1504785502, "post_id": 45724617, "comment_id": 79153177, "body": "Right.. I didn&#39;t think about path separators. Now I&#39;m sure I should make it on web not in excel program. Thank you guys for your help."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1503011981, "creation_date": 1503011981, "answer_id": 45746271, "question_id": 45724617, "link": "https://stackoverflow.com/questions/45724617/excel-vba-on-mac-make-directory-hyperlink/45746271#45746271", "title": "Excel VBA on mac - Make Directory, Hyperlink", "body": "<p>This is interesting.  Definitely worth a read.</p>\n\n<p><a href=\"https://www.howtogeek.com/181774/why-windows-uses-backslashes-and-everything-else-uses-forward-slashes/\" rel=\"nofollow noreferrer\">https://www.howtogeek.com/181774/why-windows-uses-backslashes-and-everything-else-uses-forward-slashes/</a></p>\n"}], "owner": {"reputation": 13, "user_id": 8475130, "user_type": "registered", "profile_image": "https://graph.facebook.com/1268584373267275/picture?type=large", "display_name": "Peter Kim", "link": "https://stackoverflow.com/users/8475130/peter-kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 271, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503011981, "creation_date": 1502927470, "last_edit_date": 1502958394, "question_id": 45724617, "link": "https://stackoverflow.com/questions/45724617/excel-vba-on-mac-make-directory-hyperlink", "title": "Excel VBA on mac - Make Directory, Hyperlink", "body": "<p>I'm trying to make a schedule mapper with Excel.\nIt works great so far but only on windows.\nWill there be any solution for the below codes to work on Mac OS as well?</p>\n\n<pre><code>Sub MakeFolders()\n   ActiveSheet.Cells(4, 2).Select\n   Dim Rng As Range\n   Dim maxRows, maxCols, r, c As Integer\n   Set Rng = Selection\n   maxRows = Rng.Rows.Count\n   maxCols = Rng.Columns.Count\n\n   For c = 1 To maxCols\n      r = 1\n      Do While r &lt;= maxRows\n         If Len(Dir(ActiveWorkbook.Path &amp; \"\\\" &amp; Rng(r, c), vbDirectory)) = 0 Then\n            MkDir (ActiveWorkbook.Path &amp; \"\\\" &amp; Rng(r, c))\n            On Error Resume Next\n         End If\n         r = r + 1\n      Loop\n   Next c\nEnd Sub\n</code></pre>\n\n<p>Below is the hyperlink to a folder that doesn't work on Mac as well.</p>\n\n<p>*B16 = 14</p>\n\n<pre><code>HYPERLINK=(\"..\\test\\\"&amp;B16,\"GO\")\n</code></pre>\n\n<p>Thanks in advance for your help.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1502926448, "post_id": 45724441, "comment_id": 78406715, "body": "You cannot activate a sheet in a hidden workbook (and an xlam is hidden by default)  BUT - you should avoid activating sheets unless you really need to - a sheet doesn&#39;t have to be active for you to work with it.  See: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba?rq=1\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>.  By default <code>Worksheets(&quot;All Welders Data&quot;).Activate</code> will look at the ActiveWorkbook, which may expain the error you see - it would be best to qualify all your sheet references with a Workbook object."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1502928272, "post_id": 45724441, "comment_id": 78407113, "body": "@TimWilliams Actually it appears that you <b>can</b> activate a sheet in an <code>xlam</code> file.  I just tried it with the <code>xlam</code> file I always have loaded (which has a dummy &quot;Sheet1&quot; within it).  I changed my open workbook so that it didn&#39;t have any sheets called &quot;Sheet1&quot; and then executed <code>workbooks(&quot;myXLAMfile.xlam&quot;).Worksheets(&quot;Sheet1&quot;).activate:?&zwnj;&#8203;activesheet.name</code> in the Immediate window and it correctly returned &quot;Sheet1&quot;.  I was somewhat surprised that it actually worked.  (But, just because it <b>can</b> be done is not a reason for doing it - getting rid of <code>Activate</code> is still preferable!)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502928576, "post_id": 45724441, "comment_id": 78407168, "body": "@YowE3K - I stand corrected: you can <code>Activate</code> but not <code>Select</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1502928642, "post_id": 45724441, "comment_id": 78407185, "body": "@TimWilliams Which is another good reason not to activate it - because the next question would be &quot;why do my <code>Select</code> statements fail?&quot; :D"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6095724"}, "edited": false, "score": 0, "creation_date": 1502945075, "post_id": 45724441, "comment_id": 78410849, "body": "I have good reason to activate that does not include any selecting.  I activate to be dead certain that my other code is not doing something on the wrong sheet.  I have several sheets where things are happening almost simultaneously.  Im working with a lot of data and need to be sure that just running a test on on sub does not mess up the data."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6095724"}, "edited": false, "score": 0, "creation_date": 1502945746, "post_id": 45724441, "comment_id": 78411055, "body": "And by the way, my next question would not be &quot;Why do my select statements fail?&quot;  It&#39;s a bit arrogant of you to assume that I&#39;m totally naive based on the fact that I&#39;m activating a sheet.  People come here to get help not ridicule.  I appreciate you taking the time to provide commentary and input but it would better if you kept you assumptions to yourself."}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1502959025, "post_id": 45724441, "comment_id": 78418072, "body": "&quot;I activate to be dead certain that my other code is not doing something on the wrong sheet&quot; - that is <b>not</b> a &quot;good reason&quot; to activate a sheet! You should be <i>fully qualifying</i> all of your sheets/ranges anyway, then you should have no reason to activate a sheet, and code which interacts between workbooks will be more robust and easy to debug (helpful since you <i>are</i> using code between workbooks). You&#39;ll find that @YowE3K wasn&#39;t being arrogant or ridiculing you, just perpetuating the joke that <i>a lot</i> of VBA questions here can be answered by &quot;don&#39;t activate or select&quot;."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6095724"}, "edited": false, "score": 0, "creation_date": 1502974087, "post_id": 45724441, "comment_id": 78428723, "body": "@YoE3K,  I have updated my question with more detail and follow-on question."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502999971, "post_id": 45724441, "comment_id": 78445336, "body": "&quot;.. about halfway down that I do activate the sheet. Then on the next line I am activating a range. I need to activate the range because I am then sorting in the With block that follows.&quot; There is no need to activate the sheet, or a cell, just to do a sort.  Your <code>With</code> block should be <code>Application.ThisWorkbook.Worksheets(&quot;All Welders Data&quot;).Sort</code>, the unqualified <code>Range(&quot;B3&quot;)</code> used as the key should be <code>Application.ThisWorkbook.Worksheets(&quot;All Welders Data&quot;).Range(&quot;B3&quot;)</code>, and the SetRange could be <code>Application.ThisWorkbook.Worksheets(&quot;All Welders Data&quot;).Range(&quot;A1&quot;).CurrentRegion.Offset(1)</code>."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1503000085, "post_id": 45724441, "comment_id": 78445395, "body": "And, I agree that there are times when activating a sheet/cell is applicable.  One situation that immediately comes to mind is when using the Solver add-in.  It will <b>only</b> work on the <code>ActiveSheet</code>, so activating the sheet before using it is mandatory."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6095724"}, "edited": false, "score": 0, "creation_date": 1502945354, "post_id": 45726301, "comment_id": 78410933, "body": "So it means i need to be even more explicite in my already lengthy code.  Instead of worksheet(&quot;blah&quot;).... i have to go back and change a lot of code to include Thisworkbook.  Would have been nice to pick up on that info prior to writing about 50 pages of code!  Sheesh!  Anyway, I will test this out tomorrow and come back with my results.  Thanks for the answers and the comments."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6095724"}, "edited": false, "score": 0, "creation_date": 1502946259, "post_id": 45726301, "comment_id": 78411205, "body": "&quot;Avoid activate&quot; seems to be the theme of the day!  :). Point taken.  But I do feel it serves its purpose in my case.  Besides, why have it available at all if activating is so hideous?  Maybe activate and select should just be removed from VBA?  While we are at it lets just eliminate integers also.  I see no point in using an integer when a long will do just fine.  May as well get rid of longs and do everything with floats...just leave out the dicimal part.  Can anyone think of other pointless parts of VBA we can eliminate?  Tehehehe.  :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6569321"}, "edited": false, "score": 0, "creation_date": 1502947170, "post_id": 45726301, "comment_id": 78411538, "body": "@fatmonkey Integer variable types are used when you want integers, not rational numbers (e.g. 1.0078935). Activate and select are used when you specifically want to have the user interface focus on a particular sheet or cell, respectively. For example, you might want to focus on a &quot;Search Results&quot; sheet after running a search on &quot;Search Stuff&quot;. Activate and select are discouraged when you only want to calculate stuff or set values since there is no point. Your case only wants to set values. What is focussed on is irrelevant to the function of your macro. Not sure if sarcasm but there you go :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6095724"}, "edited": false, "score": 0, "creation_date": 1502948569, "post_id": 45726301, "comment_id": 78412051, "body": "@TheFizh. Actually, my remarks about integers etc were just goofing around a bit.  I know what an integer is.  But thanks for the reminder!  Also, my case is not simply setting values and running functions.  An addin can be much more than just automating some task in excell.  My add in is doing a lot of stuff beside simple calculations.  As I hinted at in another comment, activate is just how I make myself feel less paranoid about being sure that code is doing things on the sheet I intend it to do things on.  Maybe its not best practice, but it makes me feel good!"}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1502959463, "post_id": 45726301, "comment_id": 78418337, "body": "To avoid having to add <code>ThisWorkbook</code> to the start of every statement, consider using <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/with-statement\" rel=\"nofollow noreferrer\"><code>With...End</code> statements</a>. For example (<code>:</code> means new line), <code>With ThisWorkbook: .Sheets(1).Range(&quot;A1&quot;).Value = 0 : .Sheets(&quot;Sheet2&quot;).Range(&quot;A2&quot;).Value = 55 : End With</code>. Note you can only <i>nest</i> <code>With</code> statements if you&#39;re going further into the same object, not for example to do <code>With ThisWorkbook.Sheets(1) : With ThisWorkbook.Sheets(2) : &#39; Stuff : End With : End With</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6095724"}, "edited": false, "score": 0, "creation_date": 1502974171, "post_id": 45726301, "comment_id": 78428789, "body": "@Robin Mackenzie I appreciate you answer and I am testing it this morning.  Please see the added information I tacked on to my question and the follow-on question at the end.  I would like to hear you opinion."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6095724"}, "edited": false, "score": 0, "creation_date": 1502983149, "post_id": 45726301, "comment_id": 78435749, "body": "@Robin MacKenzie - Thanks for the revison.  I appreciate that a lot.  I will definitely put that in my arsenal going forward!  Live and learn!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6095724"}, "edited": false, "score": 0, "creation_date": 1502984690, "post_id": 45726301, "comment_id": 78436850, "body": "@Robin MacKenzie Throws Run-time error 1004: &quot;Unable to get the Sort property of the range class.&quot;  It&#39;s been I while since I ooriginally wrote my code but I think this the reason why I went with ActiveSheet.Sort instead of Range(&quot;B3&quot;).Sort.  Looking at <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-sort-method-excel\" rel=\"nofollow noreferrer\">THIS</a> from Microsoft, this error baffles me since it is supposed to be the Range.Sort method."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6095724"}, "edited": false, "score": 0, "creation_date": 1502986194, "post_id": 45726301, "comment_id": 78437822, "body": "@Robin MacKenzie -   I rewrote it with the with code just as you have it in your answer.  Now I get Run-time Error 1004: &quot;The sort Reference is not Valid...&quot;  I then noticed that it was trying to perform the sort on the wrong sheet.  No matter what sheet I select prior to running the code it will not do the sort.  It ONLY works correctly if the sheet referenced is the ACTIVE sheet to begin with.  I&#39;m going back to my code I had working...I&#39;m fine with committing the mortal sin of Activating a sheet.  It works."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1503000543, "post_id": 45726301, "comment_id": 78445617, "body": "@Wolfie You <b>can</b> nest unrelated <code>With</code> blocks, although there is usually no point (but sometimes there is!).  So <code>With ThisWorkbook.Sheets(1) : With ThisWorkbook.Sheets(2) : Debug.Print .Name : End With : Debug.Print .Name: End With</code> would be quite valid and will do what you would expect it to do."}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1503002892, "post_id": 45726301, "comment_id": 78446798, "body": "Fair point, but it&#39;s likely more confusing than helpful for someone new to <code>With</code> blocks! One slip up thinking you&#39;re inside the first when you&#39;re actually in both and it&#39;s all unclear again:)"}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 1, "last_activity_date": 1502980925, "last_edit_date": 1502980925, "creation_date": 1502941874, "answer_id": 45726301, "question_id": 45724441, "link": "https://stackoverflow.com/questions/45724441/excel-vba-xlam-addin-throwing-subscript-out-of-range-error-9-but-everything/45726301#45726301", "title": "Excel VBA - .xlam (AddIn) throwing Subscript Out of Range Error 9 but everything worked as xlsm?", "body": "<p>Further to this comment from MSDN on the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa215773(v=office.11).aspx\" rel=\"nofollow noreferrer\"><code>ThisWorkbook</code></a> property:</p>\n\n<blockquote>\n  <p>Use this property to refer to the workbook that contains your macro code. <strong>ThisWorkbook is the only way to refer to an add-in workbook from inside the add-in itself.</strong> The ActiveWorkbook property doesn't return the add-in workbook; it returns the workbook that's calling the add-in.The Workbooks property may fail, as the workbook name probably changed when you created the add-in.</p>\n</blockquote>\n\n<p>(my emphasis)</p>\n\n<p>You should do this instead (and avoid <code>Activate</code>):</p>\n\n<pre><code>Dim wsData As Worksheet\n\nSet wsData = ThisWorkbook.Worksheets(\"All Welders Data\") '&lt;-- use ThisWorkbook\n\n' no need to Activate - just use the data\nDim rngStuff As Range\n\nSet rngStuff = wsData.Range(\"A1:G5\") '&lt;-- change hardcoded range to whatever you need\n' now work with the range\n</code></pre>\n\n<h2>Edit</h2>\n\n<p>Regarding the updated question, I'd suggest code similar to below to populate the <code>ComboBox</code> on the <code>UserForm</code> without using <code>Activate</code>. It is tested apart from the section that deals with loading up the <code>ComboBox</code> which is mainly your working code anyway.</p>\n\n<pre><code>Option Explicit\n\nSub UserForm_Initialize()\n\n    Dim wsData As Worksheet\n    Dim rngToSortFirstCell As Range\n    Dim lngLastRow As Long\n    Dim rngNameCell As Range\n\n    ' set a reference to the sheet\n    Set wsData = ThisWorkbook.Worksheets(\"All Welders Data\")\n\n    ' clear existing sort fields\n    wsData.Sort.SortFields.Clear\n\n    ' set a reference to the header of range to sort\n    Set rngToSortFirstCell = wsData.Range(\"B3\")\n\n    ' sort it by CurrentRegion of first cell\n    rngToSortFirstCell.Sort Key1:=Range(\"B3\").CurrentRegion, _\n        Order1:=xlAscending, _\n        Header:=xlYes, _\n        MatchCase:=False, _\n        SortMethod:=xlPinYin\n\n    ' put welder names to combo box\n    With wsData\n        lngLastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        For Each rngNameCell In .Range(\"E3:E\" &amp; lngLastRow)\n            If rngNameCell.Value &lt;&gt; \"\" Then\n                With Me.chooseWelderNameComboBox\n                    .ColumnCount = 2\n                    .AddItem rngNameCell.Value\n                    .List(.ListCount - 1, 1) = rngNameCell.Offset(, -1).Value\n                    'ComboBox now shows the values in column \"E\" and the values\n                    'in coulmn \"D\" - in that order, as in  \"Name\" - \"ID Number\".\n                    '(the reverse order of the columns in the worksheet.)\n                End With\n            End If\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6095724"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 664, "favorite_count": 0, "accepted_answer_id": 45726301, "answer_count": 1, "score": 1, "last_activity_date": 1502980925, "creation_date": 1502926216, "last_edit_date": 1502980248, "question_id": 45724441, "link": "https://stackoverflow.com/questions/45724441/excel-vba-xlam-addin-throwing-subscript-out-of-range-error-9-but-everything", "title": "Excel VBA - .xlam (AddIn) throwing Subscript Out of Range Error 9 but everything worked as xlsm?", "body": "<p>Basically what the label on the tin says.  </p>\n\n<p>I have multiple userforms, multiple modules, class modules, etc.  I have worksheets where data is stored and used by the code.  I have added a tab and buttons to the ribbon.</p>\n\n<p>I ran and tested everything from \"Come Here\" to \"Sick 'Em\" as a .xlsm file.  Every field of every form, every botton, every line of code runs perfectly.</p>\n\n<p>I saved the file as an .xlam and the thing hangs on this line of code in the very first module:</p>\n\n<pre><code>Worksheets(\"All Welders Data\").Activate\n</code></pre>\n\n<p>As I said, I get Subscript Out of Range Error 9.</p>\n\n<p>This is my first time trying to take a VBA project and save it as an add-in.  I must be missing something.  I have read (John Walkenbach \"Excell 2013...\") that the .xlam file is still a workbook with worksheets and everything should work just like it was a .xlsm.</p>\n\n<p>Is it the reference to the sheet that is wrong?  Is it the activate?  Do i need to prefix <code>Something.Worksheets(\"blah\").Activate</code> ?</p>\n\n<p>I'm tired and I'm totally stumped.  I hope someone has some kind of input for me.  Thanks in advance!</p>\n\n<p><strong>Update</strong></p>\n\n<p>I want to tank everyone for their responses and comments.  I do believe that \"ThisWorkbook\" will probably solve the issue.  I am close now to being able to test it and i will update my question again with my results. </p>\n\n<p>However, since there is so much discussion on this post about my use of activate I want to pose a follow-up question that is related to all of this.</p>\n\n<p>Here is a sample from one of my modules.  </p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    Dim lastRow As Long\n    Dim nameCell As Range\n    Dim box As control\n\n    'Set Window size and position\n    With Application\n        .WindowState = xlMaximized\n        Me.Top = .Top * 0.5\n        Me.Left = .Left * 1.0015\n        Zoom = Int((.Width * 0.85) / (Width * 0.85) * 40)\n        Width = .Width * 0.995\n        Height = .Height * 0.992\n    End With\n\n    'Turn off everything except the radio Buttons and thier labels\n    Me.submitButton.Visible = False\n    Me.submitButton.Enabled = False\n    Me.chooseWelderLabel.Visible = False\n    Me.chooseWelderNameComboBox.Visible = False\n    Me.chooseWelderNameComboBox.Enabled = False\n    Me.welderNameLabel.Visible = False\n    Me.welderNameText.Visible = False\n    Me.welderNameText.Enabled = False\n    Me.checkNameButton.Visible = False\n    Me.checkNameButton.Enabled = False\n\n    Application.ScreenUpdating = False\n\n    'Activate the worksheet\n    Application.ThisWorkbook.Worksheets(\"All Welders Data\").Activate\n    Application.ThisWorkbook.Worksheets(\"All Welders Data\").Range(\"A1\").Activate\n\n    'sort the data in the active sheet by the welder's last name.\n\n    With Application.ThisWorkbook.ActiveSheet.Sort\n        .SortFields.Clear\n        .SortFields.Add Key:=Range(\"B3\"), Order:=xlAscending\n        .SetRange ActiveCell.CurrentRegion.Offset(1)\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\n    Application.ScreenUpdating = True\n\n    'populate the combox from the active sheet (welder name in the\n    'first column, welder ID number in the second column.\n    With Application.ThisWorkbook.ActiveSheet\n        lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        For Each nameCell In .Range(\"E3:E\" &amp; lastRow)\n            If nameCell.Value &lt;&gt; \"\" Then\n                With Me.chooseWelderNameComboBox\n                    .ColumnCount = 2\n                    .AddItem nameCell.Value\n                    .List(.ListCount - 1, 1) = nameCell.Offset(, -1).Value\n                    'ComboBox now shows the values in column \"E\" and the values\n                    'in coulmn \"D\" - in that order, as in  \"Name\" - \"ID Number\".\n                    '(the reverse order of the columns in the worksheet.)\n                End With\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<p>You will see about halfway down that I do activate the sheet.  Then on the next line I am activating a range.  I need to activate the range because I am then sorting in the With block that follows.  Sorting is done because the ComboBox needs to be in alphabetical order.</p>\n\n<p>If I want to activate the <code>Range (\"A1\")</code> I have to make sure the worksheet is activated.  If not, then the <code>Range(\"A1\").Activate</code> will fail with a 1004 error because you can't activate a cell unless the worksheet where the cell lives is the active sheet.  </p>\n\n<p>So if I am going to be hard core about never ever using activate what are the suggestions for refactoring this code so that I can use excel's built in sorting.  I am not interested in doing any sort of looping routine to sort.</p>\n\n<p><strong>Final Word</strong></p>\n\n<p>I just want to thank Robin MacKenzie for her answer.  She was on the right track and gave a good answer that solved the issue.</p>\n\n<p>Also, I just want to say that I still think there are times when using activate is not a sin!</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 4, "last_activity_date": 1502925654, "creation_date": 1502925654, "answer_id": 45724368, "question_id": 45724238, "link": "https://stackoverflow.com/questions/45724238/if-table-name-exists-change-table-name-vba/45724368#45724368", "title": "If Table Name Exists, Change Table Name (VBA)", "body": "<p>There is no need to name the table.  Use <code>With ActiveSheet.ListObjects.Add(...)</code> to work with the newly added table.</p>\n\n<p><a href=\"https://i.stack.imgur.com/UlFFS.gif\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/UlFFS.gif\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<pre><code>Sub CreateAndFormatTable()\n    Application.ScreenUpdating = False\n\n    With ActiveSheet.ListObjects.Add(xlSrcRange, ActiveCell.CurrentRegion, , xlYes)\n\n        .TableStyle = \"TableStyleLight9\"\n        With .Range\n            .HorizontalAlignment = xlCenter\n            .WrapText = False\n            .Orientation = 0\n            .AddIndent = False\n            .IndentLevel = 0\n            .ShrinkToFit = False\n            .ReadingOrder = xlContext\n            .MergeCells = False\n        End With\n        .ShowTableStyleColumnStripes = True\n        .Range.Columns.AutoFit\n        .Range.Rows.AutoFit\n    End With\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3031, "favorite_count": 1, "accepted_answer_id": 45724368, "answer_count": 1, "score": 0, "last_activity_date": 1502925654, "creation_date": 1502924725, "question_id": 45724238, "link": "https://stackoverflow.com/questions/45724238/if-table-name-exists-change-table-name-vba", "title": "If Table Name Exists, Change Table Name (VBA)", "body": "<p>I've created a macro that automatically takes a range of cells and formats them into a table. </p>\n\n<p>I've set the default table name as \"Table11\", but because Table11 can only exist in the workbook once, I will experience an error if I try to use run the macro more than once.</p>\n\n<p>Is there a way to modify my code to say something like \"If table11 exists, then change the name to table12\"?</p>\n\n<p>I don't really care what the new table name is called, but I would like the code to be used as often as needed so that if table11 is already being used, name it table12. if table12 is already being used, use table13, etc...</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub formatMacro()\nApplication.ScreenUpdating = False\n\nActiveCell.CurrentRegion.Select\nActiveSheet.ListObjects.Add(xlSrcRange, Selection, , xlYes).Name = \"Table11\"\nRange(\"Table11[#All]\").Select\nActiveSheet.ListObjects(\"Table11\").TableStyle = \"TableStyleLight9\"\n       With Selection\n        .HorizontalAlignment = xlCenter\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\nActiveSheet.ListObjects(\"Table11\").ShowTableStyleColumnStripes = True\n    Selection.Columns.AutoFit\n    Selection.Rows.AutoFit\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "loops"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1502927002, "post_id": 45724115, "comment_id": 78406833, "body": "If the reservation number is found on <code>Worksheets(&quot;Sheet1&quot;).Range(&quot;B2&quot;).Value</code> then <code>Worksheets(&quot;Sheet2&quot;).Range(&quot;P2&quot;).Value =   Worksheets(&quot;Sheet1&quot;).Range(&quot;E2&quot;).Value</code> .  It is strange that you are updating the same row on <code>Worksheets(&quot;Sheet2&quot;)</code> as the reservation number on <code>Worksheets(&quot;Sheet1&quot;)</code> I would think that you would have to find the  reservation number number on <code>Worksheets(&quot;Sheet2&quot;)</code> as well."}, {"owner": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "edited": false, "score": 0, "creation_date": 1502987120, "post_id": 45724115, "comment_id": 78438444, "body": "You&#39;re absolutely correct. I&#39;m gonna head back to the drawing board here in a bit. Thanks for catching this."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1502989350, "post_id": 45724115, "comment_id": 78439684, "body": "What is the purpose of <code>MyArray()</code>?  Are these a subset of account numbers that you want to limit the code to using?  Are there other account numbers that you don&#39;t want to use?"}, {"owner": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "edited": false, "score": 0, "creation_date": 1503067238, "post_id": 45724115, "comment_id": 78476354, "body": "I was storing the values in MyArray in hopes I could use it to identify the rows that need updating since I couldn&#39;t figure out how to do a VBA index/match and have it paste a these values in my table. I took some screen shots to hopefully make it easier to understand. I&#39;ll edit my post above."}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "edited": false, "score": 0, "creation_date": 1502987192, "post_id": 45724214, "comment_id": 78438488, "body": "Thank you for looking into this. I&#39;ll take Thomas&#39; suggestion and try to tie it into yours then supply my findings."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1502924538, "creation_date": 1502924538, "answer_id": 45724214, "question_id": 45724115, "link": "https://stackoverflow.com/questions/45724115/visual-basic-vba-array-loop/45724214#45724214", "title": "Visual Basic, VBA array loop", "body": "<p>Your loop should probably be like this:</p>\n\n<pre><code>For i = 1 To 5000\n    For j = 1 To 19\n        If Worksheets(\"Sheet1\").Cells(i, \"B\").Value = MyArray(j) Then\n            Worksheets(\"Sheet2\").Cells(i, \"P\").Value = Worksheets(\"Sheet1\").Cells(i, \"E\").Value\n            'Exit from the \"For j\" loop if we found a match\n            Exit For\n        End If\n    Next j\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "edited": false, "score": 0, "creation_date": 1503080009, "post_id": 45760245, "comment_id": 78483502, "body": "I changed it up a little after reading your response due to the entire row thing you mentioned and seeing that in the code. I was worried I&#39;d transfer the other table on the left which I don&#39;t need for this. So I took the right table with green headers, put it on its own sheet, changed the coding to match it accordingly, and voila! Thanks so much for your help. I&#39;ve never heard of collections and dictionaries for VBA so I&#39;ll look into them. I&#39;m still pretty new to VBA and taking a class soon so thanks for putting me ahead of the curve a bit, your time, and a solution!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1503070267, "creation_date": 1503070267, "answer_id": 45760245, "question_id": 45724115, "link": "https://stackoverflow.com/questions/45724115/visual-basic-vba-array-loop/45760245#45760245", "title": "Visual Basic, VBA array loop", "body": "<p>Dictionaries and Collections are ideal for matching unique values.  In this example I use a <code>Scripting.Dictionary</code> to store Unique ID's and references to the <code>EntireRow</code> that they are found.  </p>\n\n<p>Note:  <code>Range().Range()</code> will return a reference that is relative to the first range object (e.g. <code>Range(\"A10\").EntireRow.Range(\"ZZ1\").Address</code> returns <code>$ZZ$10</code>).</p>\n\n<p>It would have simpler to store just the needed value, I just wanted to demonstrate that you can store Objects references in a Dictionary.  It is important to note that you can store Objects as both keys and/or values in a Dictionary.  A common mistake people make is to try and store range references as keys <code>dictionary.Add Cells(1,1), Cells(1,2)</code> will store a reference to <code>Cells(1,1)</code> as a key and <code>Cells(1,2)</code> as it's value.  The problem with this is that Dictionaries don't know how to compare cells and you will not be able to look up your values based on there key relationships.  <code>dictionary.Add Cells(1,1).Value, Cells(1,2)</code> is the correct syntax.</p>\n\n<pre><code>Sub TransferData()\n    Dim r As Range, Source As Range\n    Dim d As Object\n    Set d = CreateObject(\"Scripting.Dictionary\")\n    With Worksheets(\"TMRtoSPIde\")\n        For Each r In .Range(\"B2\", .Range(\"B\" &amp; .Rows.Count).End(xlUp))\n            If Not d.Exists(r.Value) Then d.Add r.Value, r.EntireRow\n        Next\n    End With\n\n    With Worksheets(\"RawData\")\n        For Each r In .Range(\"B2\", .Range(\"B\" &amp; .Rows.Count).End(xlUp))\n            If d.Exists(r.Value) Then\n                r.EntireRow.Range(\"K1\").Value = d(r.Value).Range(\"P1\").Value\n            End If\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 8291370, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e8515c60dfd689c2316c8fe97f69d482?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/8291370/craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 0, "accepted_answer_id": 45760245, "answer_count": 2, "score": 0, "last_activity_date": 1503070267, "creation_date": 1502923877, "last_edit_date": 1503067679, "question_id": 45724115, "link": "https://stackoverflow.com/questions/45724115/visual-basic-vba-array-loop", "title": "Visual Basic, VBA array loop", "body": "<p>I used <a href=\"http://www.homeandlearn.org/arrays_and_loops.html\" rel=\"nofollow noreferrer\">http://www.homeandlearn.org/arrays_and_loops.html</a> to help me with this.</p>\n\n<p>I have data connections that filter to one table. Unfortunately one of the sources randomly places incorrect data (usually a date) in the wrong column (Client column) when the program exports the file to Excel. What I'd like to do is something similar to an index/match function. I'd like to check each reservation number in this master table (A) against another table (B) within the same workbook. If the reservation number from the other sheet (B) matches the reservation number in the master table (A), I would like to have the correct Client value entered into the master table (A). I'm still pretty new to VBA so any help is appreciated. I've tried to modify my code here and there but to no avail. Also, I was originally running this as a practice without the real data so I didn't mess up my original file. I tried to add the appropriate syntax to refer to other sheets and whatnot so I suppose that could be entered incorrectly as well. Here's the closest original code I came up with:</p>\n\n<pre><code>Sub TransferData()\nDim MyArray(1 To 19) As Single\n\nMyArray(1) = 81899\nMyArray(2) = 87172\nMyArray(3) = 87275\nMyArray(4) = 87394\nMyArray(5) = 87446\nMyArray(6) = 87496\nMyArray(7) = 87621\nMyArray(8) = 87631\nMyArray(9) = 87726\nMyArray(10) = 87822\nMyArray(11) = 87858\nMyArray(12) = 88041\nMyArray(13) = 88097\nMyArray(14) = 88127\nMyArray(15) = 88160\nMyArray(16) = 88191\nMyArray(17) = 88359\nMyArray(18) = 88487\nMyArray(19) = 88545\n\nFor i = 1 To 19\n    If Worksheets(\"Sheet1\").Range(\"B\" &amp; i).Value = MyArray(i) Then\n       Worksheets(\"Sheet2\").Range(\"P\" &amp; i).Value = _ \n       Worksheets(\"Sheet1\").Range(\"E\" &amp; i).Value\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>I don't recall the error because the code wasn't exactly as above but close to it. I believe the issue it was running into was that when the i variable went above 19, the system couldn't find arrays > 19. I need VBA to check 19 arrays in an ever changing number of rows that's currently at 3k+. I attempted to add another variable thinking if I kept the variables separate, I could have VBA check the 19 arrays against all the rows. Here's the code I came up with for that....</p>\n\n<pre><code>Sub TransferData()\nDim MyArray(1 To 19) As Single\n\nMyArray(1) = 81899\nMyArray(2) = 87172\nMyArray(3) = 87275\nMyArray(4) = 87394\nMyArray(5) = 87446\nMyArray(6) = 87496\nMyArray(7) = 87621\nMyArray(8) = 87631\nMyArray(9) = 87726\nMyArray(10) = 87822\nMyArray(11) = 87858\nMyArray(12) = 88041\nMyArray(13) = 88097\nMyArray(14) = 88127\nMyArray(15) = 88160\nMyArray(16) = 88191\nMyArray(17) = 88359\nMyArray(18) = 88487\nMyArray(19) = 88545\n\nFor i = 1 To 5000\nFor j = 1 To 19\nIf Worksheets(\"Sheet1\").Range(\"B\" &amp; i).Value = MyArray(j) Then\n    Worksheets(\"Sheet2\").Range(i, 16).Value = Worksheets(\"Sheet1\"). _ \n    Range(i,5).Value\n    Next j\nEnd If\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>With this code I get compile error: Next without For. In searching online I found it might be because I have 2 \"For\"s, an if statement, \"next\" statement within the if statement, then another \"next\" statement outside of the loop. I was thinking it had to be done this way so that each cell in the B column gets checked against all the array possibilities.</p>\n\n<p>See pictures below. I need the value of Column P (Actual Billing Name) from sheet: TMRtoSPIde to be entered into Column D (Billing Name) on sheet: RawData when the Reservation # in Column K from sheet: TMRtoSPIde matches the reservation in sheet: RawData. You'll notice the sheet: RawData has an erroneous 5 digit serial date in the Billing Name column. These are what I'm trying to replace.</p>\n\n<p><a href=\"https://i.stack.imgur.com/y2s51.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/y2s51.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/jIzUo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jIzUo.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 253, "user_id": 6697773, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NgzXV.jpg?s=128&g=1", "display_name": "TJYen", "link": "https://stackoverflow.com/users/6697773/tjyen"}, "edited": false, "score": 2, "creation_date": 1502920001, "post_id": 45723473, "comment_id": 78404837, "body": "Does it have to be VBA? Pivot Table can do what you are asking"}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 1, "creation_date": 1502924208, "post_id": 45723473, "comment_id": 78406174, "body": "The greatest advice one VBA person can give another: use the Excel macro recorder. You&#39;re welcome."}], "answers": [{"tags": [], "owner": {"reputation": 716, "user_id": 8468145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d93037f8271a7ae98fee7cad2debe0aa?s=128&d=identicon&r=PG&f=1", "display_name": "0liveradam8", "link": "https://stackoverflow.com/users/8468145/0liveradam8"}, "is_accepted": false, "score": 2, "last_activity_date": 1502921385, "creation_date": 1502921385, "answer_id": 45723769, "question_id": 45723473, "link": "https://stackoverflow.com/questions/45723473/sum-and-group-vba-sheet/45723769#45723769", "title": "sum and group vba sheet", "body": "<p>Try this:</p>\n\n<pre><code>Sub Subroutine()\nDim currentrow As Integer\ncurrentrow = 1\nFor i = 1 To 500\n    If Cells(currentrow, 8) = Cells(i, 2) Then\n        Cells(currentrow, 10) = Cells(currentrow, 10) + Cells(i, 4)\n        Cells(currentrow, 11) = Cells(currentrow, 11) + Cells(i, 5)\n    ElseIf IsNull(Cells(i, 2)) Or Cells(i, 2) = \"\" Then\n        Exit For\n    Else\n        currentrow = currentrow + 1\n        Cells(currentrow, 7) = Cells(i, 1)\n        Cells(currentrow, 8) = Cells(i, 2)\n        Cells(currentrow, 9) = Cells(i, 3)\n        Cells(currentrow, 10) = Cells(i, 4)\n        Cells(currentrow, 11) = Cells(i, 5)\n    End If\nNext i\nEnd Sub\n</code></pre>\n\n<p>You'll have to adjust cell coordinates to match the coordinates of your cells.</p>\n"}, {"tags": [], "owner": {"reputation": 701, "user_id": 2948242, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/681284219/picture?type=large", "display_name": "Pablo G&#251;ereca", "link": "https://stackoverflow.com/users/2948242/pablo-g%c3%bbereca"}, "is_accepted": false, "score": 2, "last_activity_date": 1539715051, "last_edit_date": 1539715051, "creation_date": 1502924053, "answer_id": 45724146, "question_id": 45723473, "link": "https://stackoverflow.com/questions/45723473/sum-and-group-vba-sheet/45724146#45724146", "title": "sum and group vba sheet", "body": "<pre><code>Sub consolidateData()\n\nDim lRow As Long\nDim ItemRow1, ItemRow2 As String\nDim lengthRow1, lengthRow2 As String\n\n    lRow = 3\n    Do While (Cells(lRow, 1) &lt;&gt; \"\")\n\n        ItemRow1 = Cells(lRow, \"A\")\n        ItemRow2 = Cells(lRow + 1, \"A\")\n\n        lengthRow1 = Cells(lRow, \"B\")\n        lengthRow2 = Cells(lRow + 1, \"B\")\n\n        If ((ItemRow1 = ItemRow2) And (lengthRow1 = lengthRow2)) Then\n            Cells(lRow, \"D\") = Cells(lRow, \"D\") + Cells(lRow + 1, \"D\")\n\n            Cells(lRow, \"E\") = Cells(lRow, \"E\") + Cells(lRow + 1, \"E\")\n            Rows(lRow + 1).Delete\n\n        Else\n            lRow = lRow + 1\n        End If\n\n    Loop\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 3, "last_activity_date": 1502925086, "creation_date": 1502925086, "answer_id": 45724296, "question_id": 45723473, "link": "https://stackoverflow.com/questions/45723473/sum-and-group-vba-sheet/45724296#45724296", "title": "sum and group vba sheet", "body": "<p>SQL is ideal for grouping and summing data.  In this example I use an ADODB connection to group and sum the data.</p>\n\n<p><a href=\"https://i.stack.imgur.com/kc0dE.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kc0dE.gif\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub CreateConsolidatedTable()\n    Const adOpenKeyset = 1\n    Const adLockOptimistic = 3\n    Const WORKSHEETNAME As String = \"Sheet1\"\n    Const TABLENAME As String = \"Table1\"\n\n    Dim conn As Object, rs As Object\n    Dim tbl As ListObject\n    Dim Destination As Range\n    Set Destination = Worksheets.Add.Range(\"A1\")\n\n    Set tbl = Worksheets(WORKSHEETNAME).ListObjects(TABLENAME)\n\n    Set conn = CreateObject(\"ADODB.Connection\")\n    conn.ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; ThisWorkbook.FullName &amp; \";Extended Properties=\"\"Excel 12.0;HDR=Yes;IMEX=1\"\";\"\n\n    conn.Open\n    '  On Error GoTo CloseConnection\n    Set rs = CreateObject(\"ADODB.Recordset\")\n    With rs\n        .ActiveConnection = conn\n        .CursorType = adOpenKeyset\n        .LockType = adLockOptimistic\n        .Source = getSQL(tbl)\n        .Open\n\n        With Destination\n            tbl.HeaderRowRange.Copy .Range(\"A1\")\n            .Range(\"A2\").CopyFromRecordset rs\n            .Parent.ListObjects.Add SourceType:=xlSrcRange, Source:=.Range(\"A1\").CurrentRegion, XlListObjectHasHeaders:=xlYes, TableStyleName:=tbl.TableStyle\n\n        End With\n    End With\nCloseRecordset:\n    rs.Close\n    Set rs = Nothing\nCloseConnection:\n    conn.Close\n    Set conn = Nothing\nEnd Sub\n\nFunction getSQL(tbl As ListObject) As String\n    Dim SQL As String, SheetName As String, RangeAddress As String\n    SQL = \"SELECT DISTINCTROW [LastName], [FirstName], [Agent ID], Sum([Case Docs]) AS [Sum Of Case Docs], Sum([Call Count]) AS [Sum Of Call Count]\" &amp; _\n          \" FROM [SheetName$RangeAddress]\" &amp; _\n          \" GROUP BY [LastName], [FirstName], [Agent ID];\"\n\n    SheetName = tbl.Parent.Name\n    RangeAddress = tbl.Range.Address(False, False)\n\n    SQL = Replace(SQL, \"SheetName\", SheetName)\n    SQL = Replace(SQL, \"RangeAddress\", RangeAddress)\n\n    getSQL = SQL\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 701, "user_id": 2948242, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/681284219/picture?type=large", "display_name": "Pablo G&#251;ereca", "link": "https://stackoverflow.com/users/2948242/pablo-g%c3%bbereca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4356, "favorite_count": 0, "accepted_answer_id": 45724296, "answer_count": 3, "score": 0, "last_activity_date": 1539715051, "creation_date": 1502919778, "last_edit_date": 1531164843, "question_id": 45723473, "link": "https://stackoverflow.com/questions/45723473/sum-and-group-vba-sheet", "title": "sum and group vba sheet", "body": "<p>I am finishing with a project and I have stocked with some templates that I need to group... the information looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/rU7T6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rU7T6.png\" alt=\"enter image description here\"></a></p>\n\n<p>and I need sum casedocs and call count columns to get something like this using VBA code:</p>\n\n<p><a href=\"https://i.stack.imgur.com/zT3rg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zT3rg.png\" alt=\"enter image description here\"></a></p>\n\n<p>I do not know how to make it possible...any suggestion?</p>\n"}, {"tags": ["excel", "vba", "copy", "trim", "removing-whitespace"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502919349, "post_id": 45723336, "comment_id": 78404560, "body": "If this is VBA, string variables are not objects, so cannot have a <code>.Copy</code> method."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1502919424, "post_id": 45723336, "comment_id": 78404599, "body": "You can use VBA to set text in the clipboard via a <code>DataObject</code> instance: <a href=\"http://www.cpearson.com/excel/clipboard.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/clipboard.aspx</a>"}, {"owner": {"reputation": 11, "user_id": 4044434, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003163435546/picture?type=large", "display_name": "Diego RF", "link": "https://stackoverflow.com/users/4044434/diego-rf"}, "edited": false, "score": 0, "creation_date": 1502919502, "post_id": 45723336, "comment_id": 78404621, "body": "Ok, so what method could i use to copy the text variable to clipboard?"}, {"owner": {"reputation": 11, "user_id": 4044434, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003163435546/picture?type=large", "display_name": "Diego RF", "link": "https://stackoverflow.com/users/4044434/diego-rf"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1502919586, "post_id": 45723336, "comment_id": 78404652, "body": "@TimWilliams thanks i will check it out"}, {"owner": {"reputation": 11, "user_id": 4044434, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003163435546/picture?type=large", "display_name": "Diego RF", "link": "https://stackoverflow.com/users/4044434/diego-rf"}, "edited": false, "score": 0, "creation_date": 1502919903, "post_id": 45723336, "comment_id": 78404785, "body": "VB is telling me that the Argument is not optional comes from the Range variable, i added this macro to my toolbar with the cutomize ribbon option, i don&#39;t know if this has to do with the error"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1502923160, "post_id": 45723336, "comment_id": 78405866, "body": "You can&#39;t call that macro without giving it a value for <code>Target</code>.  If you want it to pick up the active cell then remove the <code>ByVal Target As Range</code> and use <code>Selection</code> instead of <code>Target</code> in your Sub.  That still doesn&#39;t get the text onto the clipboard, but it explains the error you see when you call the macro."}, {"owner": {"reputation": 11, "user_id": 4044434, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003163435546/picture?type=large", "display_name": "Diego RF", "link": "https://stackoverflow.com/users/4044434/diego-rf"}, "edited": false, "score": 0, "creation_date": 1502943796, "post_id": 45723336, "comment_id": 78410514, "body": "Yes, it was that, working fine, thank you!"}], "owner": {"reputation": 11, "user_id": 4044434, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003163435546/picture?type=large", "display_name": "Diego RF", "link": "https://stackoverflow.com/users/4044434/diego-rf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 322, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531324156, "creation_date": 1502919154, "last_edit_date": 1531324156, "question_id": 45723336, "link": "https://stackoverflow.com/questions/45723336/how-to-trim-and-copy-the-content-of-a-single-excell-cell-to-the-clipboard-with-a", "title": "How to Trim and copy the content of a single excell cell to the clipboard with a VBA macros", "body": "<p>There's a worker in my office who needs to copy the content of single excel cells without any whitespace arround it to introduce into an ERP, he copies the old Ctrl + V way and excel adds whitespace arround it for some reason,that causes problems in the ERP system, i have this code and i get the following error:</p>\n\n<pre><code>Sub Copy(ByVal Target As Range)\n Dim text As String\n text = Trim(CStr(Target))\n text.Copy\nEnd Sub\n</code></pre>\n\n<p>And the Error pops up in a warning message box with the following message:</p>\n\n<p>El argumento no es opcional</p>\n\n<p>The argument is not optional (Translation).</p>\n\n<p>Any idea on why this appears or how to fix it?</p>\n\n<p>EDIT: I excecute this macro with a button i added with the customize ribbon option (<a href=\"http://www.officetooltips.com/excel/tips/create_a_toolbar_button_or_menu_item_to_run_a_macro.html\" rel=\"nofollow noreferrer\">basically this</a>)</p>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 1, "creation_date": 1502919048, "post_id": 45723189, "comment_id": 78404452, "body": "At the point that <code>With ActiveSheet.pivottables(&quot;MFTPiv1&quot;).PivotFields(&quot;Wholesaler&quot;)</code> is firing, is the sheet &quot;PivotTable&quot; active?"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1503006018, "post_id": 45723189, "comment_id": 78448172, "body": "Can you elaborate further about what you are trying to do? For instanec, can you comment on why you are using a SourceType of xlConsolidation (so that we know whether this is intentional, or accidental). Also, that first bit of code really should be broken down into separate bits for readability. First, set up a range variable for the destination range. Then create the PivotCache. Then create a PivotTable based on that cache in the destination range. Mashing everything together like you are doing impedes the ability to troubleshoot."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 6190035, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7e650ba6419da7439742cda21f9fea43?s=128&d=identicon&r=PG&f=1", "display_name": "Abagnale", "link": "https://stackoverflow.com/users/6190035/abagnale"}, "edited": false, "score": 0, "creation_date": 1502983476, "post_id": 45723346, "comment_id": 78435973, "body": "I do activate the sheet &quot;PivotTable&quot; just prior to the pivotcache creation lines.  I have added an additional line to activate the &quot;PivotTable&quot; sheet prior to customizing the pivot tables to no avail.  The PivotTables function does not seem to be recognized, as indicated by the fact that VBA does not allow the P in Pivot or T in tables to be capitalized.."}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "reply_to_user": {"reputation": 67, "user_id": 6190035, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7e650ba6419da7439742cda21f9fea43?s=128&d=identicon&r=PG&f=1", "display_name": "Abagnale", "link": "https://stackoverflow.com/users/6190035/abagnale"}, "edited": false, "score": 0, "creation_date": 1502987179, "post_id": 45723346, "comment_id": 78438478, "body": "What happens when you use F8 to step through the code?  Does it just skip over that portion or does it stop the code there?  Is &quot;Wholesaler&quot; field available in the pivot table?  There aren&#39;t any spaces in the names such as &quot;PivotTable &quot; or &quot;Wholesaler &quot;?"}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "reply_to_user": {"reputation": 67, "user_id": 6190035, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7e650ba6419da7439742cda21f9fea43?s=128&d=identicon&r=PG&f=1", "display_name": "Abagnale", "link": "https://stackoverflow.com/users/6190035/abagnale"}, "edited": false, "score": 0, "creation_date": 1502988424, "post_id": 45723346, "comment_id": 78439167, "body": "Updated my answer to try SourceType:=xlDatabase"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1503005742, "post_id": 45723346, "comment_id": 78448081, "body": "The lack of capitalisation is because Excel doesn&#39;t know until the code runs whether the activesheet is a normal sheet, or a chart sheet. So intellisense doesn&#39;t work, and the word pivottables doesn&#39;t get automatically capitalized. But that in itself has nothing to do with your problem."}], "tags": [], "owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "is_accepted": false, "score": 0, "last_activity_date": 1502988925, "last_edit_date": 1502988925, "creation_date": 1502919203, "answer_id": 45723346, "question_id": 45723189, "link": "https://stackoverflow.com/questions/45723189/pivottables-function-not-recognized-in-vba/45723346#45723346", "title": ".PivotTables function not recognized in VBA", "body": "<p>If your sheet isn't active it can't be found by \"ActiveSheet\".  Make your sheet \"PivotTable\" active:</p>\n\n<pre><code>Sheets(\"PivotTable\").Select\nWith ActiveSheet.pivottables(\"MFTPiv1\").PivotFields(\"Wholesaler\")\n  .Orientation = xlRowField\n  .Position = 1\nEnd With\n</code></pre>\n\n<p>Or not:</p>\n\n<pre><code>With Sheets(\"PivotTable\").pivottables(\"MFTPiv1\").PivotFields(\"Wholesaler\")\n  .Orientation = xlRowField\n  .Position = 1\nEnd With\n</code></pre>\n\n<p>Additionally, I've never used that \"xlConsolidation\" source type.  I tried it on a bit of data I have here and it created a pivot table that is not conducive to what you're trying to accomplish.  A \"standard\" pivot cache uses SourceType:=xlDatabase.  Maybe try that.</p>\n"}], "owner": {"reputation": 67, "user_id": 6190035, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7e650ba6419da7439742cda21f9fea43?s=128&d=identicon&r=PG&f=1", "display_name": "Abagnale", "link": "https://stackoverflow.com/users/6190035/abagnale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502988925, "creation_date": 1502918454, "question_id": 45723189, "link": "https://stackoverflow.com/questions/45723189/pivottables-function-not-recognized-in-vba", "title": ".PivotTables function not recognized in VBA", "body": "<p>VBA seems to ignore the .PivotTables function in the code below.  Does anybody have any possible explanation for this?  Could there be a necessary but inactive reference library? Thanks in advance.</p>\n\n<pre><code>ActiveWorkbook.PivotCaches.Create(SourceType:=xlConsolidation, SourceData:= \n_\"Raw!\" &amp; \nSheets(\"Raw\").Range(\"A1\").CurrentRegion.Address(ReferenceStyle:=xlR1C1),  \nVersion:=6).CreatePivotTable _\ntabledestination:=\"PivotTable!\" &amp; Sheets(\"PivotTable\").Range(\"A\" &amp; \nRange(\"A\" &amp; Rows.Count).End(xlUp).Row + 3).Address _\n(ReferenceStyle:=R1C1), TableName:=\"MFTPiv1\", defaultversion:=6\n\nWith ActiveSheet.pivottables(\"MFTPiv1\").PivotFields(\"Wholesaler\")\n.Orientation = xlRowField\n.Position = 1\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1502918191, "post_id": 45722875, "comment_id": 78404118, "body": "What have you done so far? Where is your problem?"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1502921205, "post_id": 45722875, "comment_id": 78405272, "body": "So, name the ranges dynamically. That&#39;s why the &quot;Refers to&quot; box takes formulas."}], "owner": {"reputation": 166, "user_id": 7758051, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f48c22e8be301c7245d6343b1d1ca12b?s=128&d=identicon&r=PG&f=1", "display_name": "user7758051", "link": "https://stackoverflow.com/users/7758051/user7758051"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502917032, "creation_date": 1502917032, "last_edit_date": 1531161705, "question_id": 45722875, "link": "https://stackoverflow.com/questions/45722875/data-validation-drop-down-list-dependent-on-adjacent-list-range-values", "title": "Data Validation - Drop Down List dependent on adjacent list range values", "body": "<p>Here is an example of my data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/T7k4w.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/T7k4w.png\" alt=\"enter image description here\"></a></p>\n\n<p>What I want to do is have three cells each with a data validation drop down list. If you select AA in the first one, the second drop down list would only show col2.1, col2.2, and col2.3 as options. If you then selected col2.1 from that list (while leaving AA selected), the third list would only show apple and grape.</p>\n\n<p>Ideally, this dependence wouldn't be one directional, so if I selected orange in the third dropdown list, AA and BB would be options in the first dropdown list, and col2.2 and col2.c in the second dropdown list.</p>\n\n<p><strong><em>Important</em></strong>\nI am working with large amounts of dynamic data, so a solution that requires naming ranges manually will not work.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 716, "user_id": 8468145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d93037f8271a7ae98fee7cad2debe0aa?s=128&d=identicon&r=PG&f=1", "display_name": "0liveradam8", "link": "https://stackoverflow.com/users/8468145/0liveradam8"}, "edited": false, "score": 0, "creation_date": 1502914918, "post_id": 45722295, "comment_id": 78402758, "body": "Please edit to include the entire method so we can see what your code is trying to achieve"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1502915701, "post_id": 45722295, "comment_id": 78403080, "body": "Provide code. Are you setting VBA string variables? Only variant type variable can hold Null. I don&#39;t allow empty strings in tables but if you want: <code>Nz(rst!FirstName, &quot;&quot;)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502916818, "post_id": 45722595, "comment_id": 78403564, "body": "Don&#39;t know enough Access-VBA, but (a) wouldn&#39;t NULL evaluate to <code>False</code> in an <code>If</code>/<code>IIf</code> (because it isn&#39;t equal to <code>True</code>)? (b) would the OP be able to use <code>...SET myField =&quot; &amp; IIf(IsNull(rst.Fields(&quot;recField&quot;).Value), &quot;NULL&quot;, &quot;&#39;&quot; &amp; rst.Fields(&quot;FirstName&quot;).Value) &amp; &quot;&#39;&quot;) &amp; &quot; where ...</code> if they actually wanted to set the <code>myField</code> field to a NULL if the <code>recField</code> field was NULL?  (just in case they want to promulgate the NULLs rather than changing it to an empty string or a zero)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502917741, "post_id": 45722595, "comment_id": 78403942, "body": "<a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/application-nz-method-access\" rel=\"nofollow noreferrer\">Application.Nz Method (Access)</a> uses <code>IIf(IsNull(varFreight), 0, varFreight) </code> as it&#39;s example but you are correct that Null will evaluate as false.   So I guess the <code>IsNull()</code> function isn&#39;t needed."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502917932, "post_id": 45722595, "comment_id": 78404016, "body": "Don&#39;t you mean the <code>IsNull()</code> function <b>is</b> needed?  <code>IIf(varFreight, 0, varFreight)</code> would return <code>0</code> if <code>varFreight</code> evaluated to <code>True</code> and would return <code>varFreight</code> if <code>varFreight</code> evaluated to <code>False</code> (which it will do if it is <code>Null</code>).  Argh - too early in the morning to be thinking of logical variables!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502917996, "post_id": 45722595, "comment_id": 78404034, "body": "You would use <code>Null</code> without the  quotation marks (e.g. <code>UPDATE Table1 SET Table1.T1 = Null;</code>)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502918079, "post_id": 45722595, "comment_id": 78404069, "body": "I think that is what my suggestion in (b) creates as the SQL, so I guess I got that bit right :) :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502918227, "post_id": 45722595, "comment_id": 78404129, "body": "<code>IIf(varFreight, varFreight, 0)</code> would be comparable to  <code>IIf(IsNull(varFreight), 0, varFreight)</code>.  I would still use the <code>IsNull</code> to clarify the statement."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502918347, "post_id": 45722595, "comment_id": 78404184, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/152100/discussion-between-yowe3k-and-thomas-inzina\">continue this discussion in chat</a>."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1502915859, "creation_date": 1502915859, "answer_id": 45722595, "question_id": 45722295, "link": "https://stackoverflow.com/questions/45722295/ms-access-vba-update-field-with-null-or-empty-string/45722595#45722595", "title": "MS Access VBA Update Field with Null or Empty String", "body": "<p><code>NZ</code> is MS Access's Built-In function to handle nulls</p>\n\n<blockquote>\n  <p>Nz ( variant, [ value_if_null ] )</p>\n</blockquote>\n\n<ul>\n<li><ul>\n<li><code>Nz (rst.Fields(\"FirstName\").Value, 0)</code></li>\n</ul></li>\n</ul>\n\n<p>Alternatively you could use the VBA <code>IIF</code> statement.</p>\n\n<blockquote>\n  <p>IIf( Expression, TruePart, FalsePart )</p>\n</blockquote>\n\n<p>To return an Empty string use:</p>\n\n<p><code>Nz (rst.Fields(\"FirstName\").Value, \"\")</code> or <code>IIf(rst.Fields(\"FirstName\").Value, \"\", rst.Fields(\"FirstName\").Value)</code> </p>\n\n<p>If the field that you are updating is numeric then you'll need to return a Zero value if null:</p>\n\n<p><code>Nz (rst.Fields(\"FirstName\").Value, 0)</code> or <code>IIf(rst.Fields(\"FirstName\").Value, 0, rst.Fields(\"FirstName\").Value)</code> </p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1502953443, "creation_date": 1502953443, "answer_id": 45728573, "question_id": 45722295, "link": "https://stackoverflow.com/questions/45722295/ms-access-vba-update-field-with-null-or-empty-string/45728573#45728573", "title": "MS Access VBA Update Field with Null or Empty String", "body": "<p>You can use my <em>CSql</em> function <a href=\"https://stackoverflow.com/questions/43589800/syntax-error-in-insert-into-statement-whats-the-error/43591778#43591778\">here</a> like:</p>\n\n<pre><code>strSQL = \"Update myTable Set myField = \" &amp; CSql(rs.Fields(\"recField\").Value) &amp; \" Where id = 25\"\n</code></pre>\n\n<p>That will for a value return:</p>\n\n<pre><code>\"Update myTable Set myField = 'ValueOfField' Where id = 25\"\n</code></pre>\n\n<p>and for a value of Null:</p>\n\n<pre><code>\"Update myTable Set myField = Null Where id = 25\"\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 8474607, "user_type": "registered", "profile_image": "https://graph.facebook.com/1923734334505707/picture?type=large", "display_name": "Sasha Egania", "link": "https://stackoverflow.com/users/8474607/sasha-egania"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 6483, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1502953443, "creation_date": 1502914669, "last_edit_date": 1502915893, "question_id": 45722295, "link": "https://stackoverflow.com/questions/45722295/ms-access-vba-update-field-with-null-or-empty-string", "title": "MS Access VBA Update Field with Null or Empty String", "body": "<p>I am trying to update a MS Access table via VBA from a DAO Recordset.  The problem is that if one of the field values is null.  The code errors out.  Is there something like <code>IsNull(rst.Fields(\"FirstName\").value,\"\")</code> that I can use?  I tried using this but it throws the error \"Invalid Use of Null\".  Please help.</p>\n\n<pre><code>strSQL = Update myTable SET myField ='\" &amp; rs.Fields(\"recField\").Value &amp; \"' where id = 25\ndb.Execute strSQL\n</code></pre>\n\n<p>in this instance, <code>rs.Fields(\"recField\").Value</code> is Null</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 1, "creation_date": 1502915498, "post_id": 45722189, "comment_id": 78403000, "body": "I would split the task out into 1) copy/ paste, 2) grouping. Once you know it is working the way you want, go back and optimize it. You are reliant on row indexing in the loop and with all the pasting and grouping it would be useful to eliminate that the indices are not reliable during the loop."}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 1, "creation_date": 1502960218, "post_id": 45722189, "comment_id": 78418823, "body": "As you&#39;re just pasting the values, it would be much quicker (and maybe clearer) to use <code>_.Value = _.Value</code> instead of copy/paste values. Since you don&#39;t know the size of the copy range, you may want to leverage the <code>resize</code> function, as shown in the <code>Test2</code> sub in <a href=\"https://stackoverflow.com/a/17241661/3978545\">this answer</a>"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1502973666, "post_id": 45722189, "comment_id": 78428393, "body": "@Wolfie I went back and amended to show with output.value=input.value.  Yes, this is cleaner, though I&#39;m still running into the issue that the values aren&#39;t showing up during the loop.  Will amend the code in the post momentarily."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1502974067, "post_id": 45722189, "comment_id": 78428706, "body": "@RobinMackenzie Thanks for that input.  I will give that a shot in a little bit.  I will need to use another loop, but I believe I can get that to work.  Will get back to you once I get that far."}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1502974656, "post_id": 45722189, "comment_id": 78429163, "body": "Check the values actually are what you expect when you&#39;re copying them. It&#39;s very <i>unlikely</i> that VBA is magically not showing results for some loops. There is no delay or asynchronicity in VBA, one action is not done (in this example) before all previous actions have completed."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1502974945, "post_id": 45722189, "comment_id": 78429403, "body": "@Wolfie The values are what I expect them to be, once they display; I wholly agree that a delay would be unlikely from VBA.  I am unsure why there is the delay in display.  I have decoupled the milestone grouping from the loop and it appears to work quite nicely.  I have added the following to a separate subroutine, which works:     For i = 5 To LR...   If Sheets(&quot;Finance&quot;).Cells(i, 1).Value = Sheets(&quot;Finance&quot;).Cells(i - 1, 1).Value Then...             Sheets(&quot;Finance&quot;).Rows(i).EntireRow.Group... Else... End If.  Thanks for the help with a workaround!"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1502976463, "post_id": 45722189, "comment_id": 78430611, "body": "@Wolfie Thought I was good, but this apparently caused a different issue, where the grouping button doesn&#39;t show up for certain milestones, though using the 1, 2, 3 buttons up top will group appropriately.  I will post another question for this, if some research doesn&#39;t bode an answer."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1502977630, "post_id": 45722189, "comment_id": 78431476, "body": "...fixed that issue, too.  Pulled the larger groupings out and moved them to the end, so there was no confusion about what all was to be grouped.  Everything shows up as expected."}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1502979030, "post_id": 45722189, "comment_id": 78432536, "body": "Great, please consider a couple of points of action: <b>1.</b> If you think this post will be of value to others, try and add your own answer to how you fixed it which will benefit them, perhaps phrasing your question around what the specific issue was (but not answering <i>in</i> the question). <b>2.</b> If you think this is a pretty unique issue to you, consider removing the question so it doesn&#39;t remain open forever! <b>--</b> Glad you resolved your issue, happy coding."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 1, "creation_date": 1502980970, "post_id": 45722189, "comment_id": 78434105, "body": "@Wolfie Was working out a last issue before posting an answer to close the item.  Will accept tomorrow when the timer runs up."}], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 0, "last_activity_date": 1502980920, "creation_date": 1502980920, "answer_id": 45738208, "question_id": 45722189, "link": "https://stackoverflow.com/questions/45722189/grouping-cells-during-a-loop-not-responding-as-expected/45738208#45738208", "title": "Grouping cells during a loop not responding as expected", "body": "<p>Two things happened to work-around the issue:</p>\n\n<p>1)  I had to add another line so the Milestone groupings did not end on the same line as the Section grouping (in this case, after the loop in the subroutine posted in the question).</p>\n\n<pre><code>Dim LR as Long\n\nLR = Sheets(\"Finance\").Cells(Sheets(\"Finance\").Rows.Count, 7).End(xlUp).Row\nSheets(\"Finance\").Cells(LR + 1, 7).Value = \"-\"\nSheets(\"Finance\").Rows(LR + 1).Font.Bold = True\n</code></pre>\n\n<p>2)  I pulled all of the grouping out to the end, after the loops.</p>\n\n<p>The code for grouping ends up looking like:</p>\n\n<pre><code>Dim a as Integer\n\nLR = Sheets(\"Finance\").Cells(Sheets(\"Finance\").Rows.Count, 7).End(xlUp).Row\nFor i = 5 To LR\n    If Sheets(\"Finance\").Cells(i, 1).Font.Bold = False Then\n        Sheets(\"Finance\").Rows(i).EntireRow.Group\n    Else\n    End If\nNext i\n'Group between sheets\na = Sheets(\"Finance\").Columns(1).Find(What:=\"Not Raw Materials\", LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=False).Row\nSheets(\"Finance\").Range(Sheets(\"Finance\").Rows(4), Sheets(\"Finance\").Rows(a - 1)).EntireRow.Group\n</code></pre>\n\n<p>In the end, I had to make sure the grouping was from the smallest increments to the largest increments to ensure that I did not lose functionality of the mass-grouping (subtotal) toggles.  I would often lose the last milestone's subtotal toggle.</p>\n"}], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 45738208, "answer_count": 1, "score": 0, "last_activity_date": 1502980920, "creation_date": 1502914196, "last_edit_date": 1531164843, "question_id": 45722189, "link": "https://stackoverflow.com/questions/45722189/grouping-cells-during-a-loop-not-responding-as-expected", "title": "Grouping cells during a loop not responding as expected", "body": "<p><strong>Background:</strong></p>\n\n<p>I have a sheet named <em>RM</em> that I am pulling milestone data from to a sheet named <em>Finance</em> via a loop (loop is per sheets(\"RM\")).  Once the data is pulled forward, the sheet is supposed to group items in two subtotals:</p>\n\n<p>1)  Group the milestone activities</p>\n\n<p>2)  Group the everything that was pulled over during the loop</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Dim i As Integer\nDim LR As Long, FR As Long\n    FR = Sheets(\"Finance\").Cells(Sheets(\"Finance\").Rows.Count, 1).End(xlUp).Row\n    Sheets(\"Finance\").Cells(FR + 1, 1).Value = \"Raw Materials\"\n    Sheets(\"Finance\").Cells(FR + 1, 7).Value = Sheets(\"RM\").Cells(12, 2).Value\n    For i = 16 To 358 Step 18\n        LR = Sheets(\"Finance\").Cells(Sheets(\"Finance\").Rows.Count, 1).End(xlUp).Row\n        If Sheets(\"RM\").Cells(i, 4) &gt; 0 And Sheets(\"RM\").Cells(i, 2) = \"Fixed\" Then\n            'Milestone row\n            Sheets(\"Finance\").Cells(LR + 1, 1).Value = Sheets(\"RM\").Cells(i, 1).Value\n            Sheets(\"Finance\").Cells(LR + 1, 7).Value = Sheets(\"RM\").Cells(i, 4).Value\n            Sheets(\"Finance\").Rows(LR + 1).Font.Bold = True\n            'Number\n            Sheets(\"Finance\").Range(Sheets(\"Finance\").Cells(LR + 2, 1), Sheets(\"Finance\").Cells(LR + 9, 1)).Value = Sheets(\"RM\").Cells(i, 1).Value\n\n            'Removed middle section, which pulls over data from different columns\n\n            'Group Milestone subactivities\n            If Sheets(\"Finance\").Cells(LR, 1).Value = Sheets(\"Finance\").Cells(LR - 2, 1).Value Then\n                Sheets(\"Finance\").Range(Sheets(\"Finance\").Cells(LR + 2, 1), Sheets(\"Finance\").Cells(LR + 9, 1)).EntireRow.Group\n            Else\n            End If\n        Else\n        End If\n    Next i\n    Sheets(\"Finance\").Rows(FR + 1).Font.Bold = True\n    If LR - FR &gt; 1 Then\n        Sheets(\"Finance\").Range(Sheets(\"Finance\").Rows(FR + 2), Sheets(\"Finance\").Rows(LR)).EntireRow.Group\n    Else\n    End If\n</code></pre>\n\n<hr>\n\n<p><strong>Issue:</strong></p>\n\n<p>The grouping for the milestone events is not coming over appropriately.  When the code runs, only some of the milestones get their grouping, though the overarching grouping occurs.</p>\n\n<p>In a list of 10 milestones, 1 and 10 do not have milestone grouping, but 2-9 do group.</p>\n\n<p>I thought I had an issue with the if-statement itself, that If LR-FR>2 then, but in stepping-through, I found something weird.</p>\n\n<p>As I step-through with F8, I realized that the data that I .copy/.pastespecial does not show up until after one or two loops have occurred.  The grouping then shows up for the last visually-added data that was pasted.  Then subsequent data shows up until the last bit.</p>\n\n<hr>\n\n<p><strong>Question:</strong></p>\n\n<p>Is there a way to force the paste to display data?  Is there anything else that would cause this activity from Excel/VBA?</p>\n\n<p>Any help in resolution would be appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1502914076, "post_id": 45722122, "comment_id": 78402327, "body": "Is that all of your code? You&#39;re missing a <code>Next srcrow</code> and an <code>End If</code>...  Also, when you do <code>srcrow.Range.Cells(1,20)</code> (if that <code>.Range.Cells()</code> works), you&#39;re referring to the <i>relative</i> <code>Cells(1,20)</code> within <code>srcRow</code>.  Is that what you mean? Are you not getting any error??"}, {"owner": {"reputation": 61, "user_id": 8345911, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-_zTy1skUGLU/AAAAAAAAAAI/AAAAAAAAADk/7Onf3lmEFIQ/photo.jpg?sz=128", "display_name": "Nadine Ruttimann", "link": "https://stackoverflow.com/users/8345911/nadine-ruttimann"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1502914387, "post_id": 45722122, "comment_id": 78402487, "body": "Yes Excel VBA Run-time error &#39;424&#39;: Object Required at EntireRow.Delete."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1502914637, "post_id": 45722122, "comment_id": 78402624, "body": "This might be as easy as <code>srcrow.EntireRow.Delete</code>."}, {"owner": {"reputation": 61, "user_id": 8345911, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-_zTy1skUGLU/AAAAAAAAAAI/AAAAAAAAADk/7Onf3lmEFIQ/photo.jpg?sz=128", "display_name": "Nadine Ruttimann", "link": "https://stackoverflow.com/users/8345911/nadine-ruttimann"}, "edited": false, "score": 0, "creation_date": 1502914935, "post_id": 45722122, "comment_id": 78402763, "body": "The same Run-time error appears..."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1502921341, "creation_date": 1502921341, "answer_id": 45723764, "question_id": 45722122, "link": "https://stackoverflow.com/questions/45722122/vba-excel-delete-rows-with-specific-value/45723764#45723764", "title": "VBA Excel delete rows with specific value", "body": "<p>Try it without the ListRows; use DataBodyRange instead. Work from the bottom to the top or you risk skipping rows when you delete.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub DeleteOrderRows()\n\n    Dim strNoOrder As String\n    Dim strNoFunction As String, noOrder As String\n    Dim noCommande As Integer\n    Dim i As Long, tbxOrder As Range\n    Dim tblPagination As ListObject\n\n    Set tblPagination = Worksheets(\"Pagination\").ListObjects.Item(\"tblPagination\")\n\n    'here I had to set tbvOrder and assign noOrder\n    Set tbxOrder = Worksheets(\"Pagination\").Cells(1, \"A\")\n    noOrder = tbxOrder.Value\n\n    With tblPagination.DataBodyRange.Columns(20).Cells\n        For i = .Count To 1 Step -1\n            Debug.Print .Cells(i).Address(0, 0)\n            strNoOrder = .Cells(i).Value2\n\n            If strNoOrder = noOrder Then\n                .Cells(i).EntireRow.Delete\n            End If\n\n        Next i\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 8345911, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-_zTy1skUGLU/AAAAAAAAAAI/AAAAAAAAADk/7Onf3lmEFIQ/photo.jpg?sz=128", "display_name": "Nadine Ruttimann", "link": "https://stackoverflow.com/users/8345911/nadine-ruttimann"}, "is_accepted": false, "score": 0, "last_activity_date": 1504193424, "creation_date": 1504193424, "answer_id": 45985179, "question_id": 45722122, "link": "https://stackoverflow.com/questions/45722122/vba-excel-delete-rows-with-specific-value/45985179#45985179", "title": "VBA Excel delete rows with specific value", "body": "<p>An other option :</p>\n\n<pre><code>Public Sub DeleteOrderRows()\nDim rngToDelete As Range\nSet rngToDelete = Nothing\n\nDim tblPagination As ListObject\nSet tblPagination = Worksheets(\"Pagination\").ListObjects.Item(\"tblPagination\")\n\nDim strNopage As String\nDim strNoOrder As String\n\nFor Each currentRow In tblPagination.ListRows\n    strNoOrder = currentRow.Range.Cells(1, 5).Value\n    strNopage = tbxPage.Value\n    If strNoCommande = strNopage Then\n        If rngToDelete Is Nothing Then\n            Set rngToDelete = currentRow.Range\n        Else\n            Set rngToDelete = Union(rngToDelete, currentRow.Range)\n        End If\n    End If\nNext\n\nIf Not rngToDelete Is Nothing Then\n    rngToDelete.Delete Shift:=xlUp\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 8345911, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-_zTy1skUGLU/AAAAAAAAAAI/AAAAAAAAADk/7Onf3lmEFIQ/photo.jpg?sz=128", "display_name": "Nadine Ruttimann", "link": "https://stackoverflow.com/users/8345911/nadine-ruttimann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "accepted_answer_id": 45723764, "answer_count": 2, "score": 0, "last_activity_date": 1504193424, "creation_date": 1502913916, "last_edit_date": 1502974702, "question_id": 45722122, "link": "https://stackoverflow.com/questions/45722122/vba-excel-delete-rows-with-specific-value", "title": "VBA Excel delete rows with specific value", "body": "<p>I need to delete specific rows in a table with a order number. When I put this code in Excel it delete the entire table. What I want is to delete only specific rows. The tbxOrder is a text box. I want that when the text box equals x command number the code will select all the rows with the same number in the \"Pagination\" table (column 20) and then delete them. Thank you :)</p>\n\n<pre><code>Public Sub DeleteOrderRows()\n\nDim strNoOrder As String\nDim strNoFunction As String\nDim noCommande As Integer\n\nDim tblPagination As ListObject\nSet tblPagination = Worksheets(\"Pagination\").ListObjects.Item(\"tblPagination\")\n\nFor Each srcrow In tblPagination.ListRows\n\nstrNoOrder = srcrow.Range.Cells(1, 20)\nnoOrder = tbxOrder.Value\n\nIf strNoOrder = noOrder Then\n\nEntireRow.Delete\n\nEnd If\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1502914014, "post_id": 45722093, "comment_id": 78402290, "body": "FYI you&#39;re using just <code>LastFundRow</code> instead of <code>ALastFundRow</code> in the <code>Set rngSheet</code>.  Also, what&#39;s the difference in <code>wksSource</code> and <code>ws</code>? Finally, you could just use column C as the column in <code>ALastFundRow</code>, no? Or will it not always be C with the most data?"}, {"owner": {"reputation": 17, "user_id": 8462899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78f1c2cafbf19ce1c8e3f2fa1c6a9f29?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Duran", "link": "https://stackoverflow.com/users/8462899/christian-duran"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1502914775, "post_id": 45722093, "comment_id": 78402697, "body": "Oh whoops. Didn&#39;t mess with the function so I didn&#39;t notice. I&#39;m very new to this so thanks for the tips and I tried but it didn&#39;t do anything :("}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1502918952, "post_id": 45722093, "comment_id": 78404413, "body": "Are there gaps in column C? Try <code>ALastFundRow = wksSource.Range(&quot;C&quot; &amp; Rows.Count).End(xlUp).Row</code>"}], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 0, "last_activity_date": 1502935175, "creation_date": 1502935175, "answer_id": 45725493, "question_id": 45722093, "link": "https://stackoverflow.com/questions/45722093/how-can-i-find-the-last-row-with-a-cell-containing-data-vba-to-set-print-area/45725493#45725493", "title": "How can I find the last row with a cell containing data vba to set print area?", "body": "<p>The function <strong>GetLastCell()</strong> will find the last row and column containing data</p>\n\n<pre><code>Option Explicit\n\nPublic Sub SetPrintArea()\n\n    Dim ws As Worksheet\n\n    Set ws = ThisWorkbook.Sheets(\"WIRE SCHEDULE\")\n\n    ws.PageSetup.PrintArea = ws.Range(\"A1:\" &amp; GetLastCell(ws).Address).Address\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Public Function GetLastCell(Optional ByVal ws As Worksheet = Nothing) As Range\n    Dim uRng As Range, uArr As Variant, r As Long, c As Long\n    Dim ubR As Long, ubC As Long, lRow As Long\n\n    If ws Is Nothing Then Set ws = Application.ThisWorkbook.ActiveSheet\n    Set uRng = ws.UsedRange:    uArr = uRng\n    If IsEmpty(uArr) Then\n        Set GetLastCell = ws.Cells(1, 1):   Exit Function\n    End If\n    If Not IsArray(uArr) Then\n        Set GetLastCell = ws.Cells(uRng.Row, uRng.Column):  Exit Function\n    End If\n    ubR = UBound(uArr, 1):      ubC = UBound(uArr, 2)\n    For r = ubR To 1 Step -1    '----------------------------------------------- last row\n        For c = ubC To 1 Step -1\n            If Not IsError(uArr(r, c)) Then\n                If Len(Trim$(uArr(r, c))) &gt; 0 Then\n                    lRow = r:   Exit For\n                End If\n            End If\n        Next\n        If lRow &gt; 0 Then Exit For\n    Next\n    If lRow = 0 Then lRow = ubR\n    For c = ubC To 1 Step -1    '----------------------------------------------- last col\n        For r = lRow To 1 Step -1\n            If Not IsError(uArr(r, c)) Then\n                If Len(Trim$(uArr(r, c))) &gt; 0 Then\n                    Set GetLastCell = ws.Cells(lRow + uRng.Row - 1, c + uRng.Column - 1)\n                    Exit Function\n                End If\n            End If\n        Next\n    Next\nEnd Function\n</code></pre>\n\n<hr>\n\n<p><a href=\"https://i.stack.imgur.com/ASd8F.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ASd8F.png\" alt=\"UR\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1502935349, "creation_date": 1502935349, "answer_id": 45725513, "question_id": 45722093, "link": "https://stackoverflow.com/questions/45722093/how-can-i-find-the-last-row-with-a-cell-containing-data-vba-to-set-print-area/45725513#45725513", "title": "How can I find the last row with a cell containing data vba to set print area?", "body": "<pre><code> With ActiveSheet 'or whatever worksheet  \n LastRow = .Cells.Find(what:=\"*\", after:=.Cells(1, 1), _\n                    LookIn:=xlValues, searchorder:=xlByRows, _\n                    searchdirection:=xlPrevious).Row\nEnd With\n</code></pre>\n\n<p>You can use a similar algorithm for the last column.</p>\n\n<pre><code>LastCol = .Cells.Find(what:=\"*\", after:=.Cells(1, 1), _\n                LookIn:=xlValues, searchorder:=xlByColumns, _\n                searchdirection:=xlPrevious).Column\n</code></pre>\n\n<p>Note that we are looking for <code>xlValues</code> so cells with formulas that return a null string will not be included.</p>\n\n<p>If the worksheet is empty, the code will produce an error; so if that might be a possibility, you should test for that.</p>\n"}, {"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1502936756, "creation_date": 1502936756, "answer_id": 45725676, "question_id": 45722093, "link": "https://stackoverflow.com/questions/45722093/how-can-i-find-the-last-row-with-a-cell-containing-data-vba-to-set-print-area/45725676#45725676", "title": "How can I find the last row with a cell containing data vba to set print area?", "body": "<p>Try this code.</p>\n\n<p><strong>.Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row</strong></p>\n\n<pre><code>Sub SetPrintArea()\n\nDim ALastFundRow As Integer\nDim AFirstBlankRow As Integer\nDim wksSource As Worksheet\nDim ws As Worksheet\n\nDim rngSheet As Range\n\nSet wksSource = ActiveWorkbook.Sheets(\"WIRE SCHEDULE\")\nSet ws = ThisWorkbook.Sheets(\"WIRE SCHEDULE\")\n\n'Finds last row of content\n'ALastFundRow = wksSource.Range(\"A8\").End(xlDown).Row\nALastFundRow = wksSource.Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n 'Finds first row without content\nAFirstBlankRow = ALastFundRow + 1\n\nSet rngSheet = ws.Range(\"A1:Q\" &amp; LastFundRow)\n\n'Sets PrintArea to the last Column with a value and the last row with a value\nws.PageSetup.PrintArea = rngSheet.Address\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 8462899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78f1c2cafbf19ce1c8e3f2fa1c6a9f29?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Duran", "link": "https://stackoverflow.com/users/8462899/christian-duran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 636, "favorite_count": 0, "accepted_answer_id": 45725493, "answer_count": 3, "score": 1, "last_activity_date": 1502936756, "creation_date": 1502913826, "last_edit_date": 1502913886, "question_id": 45722093, "link": "https://stackoverflow.com/questions/45722093/how-can-i-find-the-last-row-with-a-cell-containing-data-vba-to-set-print-area", "title": "How can I find the last row with a cell containing data vba to set print area?", "body": "<p>I know this question may seem nearly identical to past ones, but there's a nuance in my sheet in that one of my columns is completely empty aside from the first 7 rows. The problem being that my code finds the last row in which <strong>ALL</strong> cells contain data rather than the last row with at least one data item. I.e. A1:Q7 contain data and since all of the rows contain data my code sets the print area to A1:Q7 although there is data in C14. I want my print area to be A1:Q14. How would I go about doing this. Code below.</p>\n\n<pre><code>Sub SetPrintArea()\n\nDim ALastFundRow As Integer\nDim AFirstBlankRow As Integer\nDim wksSource As Worksheet\nDim ws As Worksheet\n\nDim rngSheet As Range\n\nSet wksSource = ActiveWorkbook.Sheets(\"WIRE SCHEDULE\")\nSet ws = ThisWorkbook.Sheets(\"WIRE SCHEDULE\")\n\n'Finds last row of content\nALastFundRow = wksSource.Range(\"A8\").End(xlDown).Row\n 'Finds first row without content\nAFirstBlankRow = ALastFundRow + 1\n\nSet rngSheet = ws.Range(\"A1:Q\" &amp; LastFundRow + 7)\n\n'Sets PrintArea to the last Column with a value and the last row with a value\nws.PageSetup.PrintArea = rngSheet.Address\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Anything would help. Thanks!</p>\n"}, {"tags": ["vba", "excel", "import", "import-from-excel"], "answers": [{"tags": [], "owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "is_accepted": false, "score": 0, "last_activity_date": 1502967099, "last_edit_date": 1502967099, "creation_date": 1502916572, "answer_id": 45722766, "question_id": 45721976, "link": "https://stackoverflow.com/questions/45721976/excel-vba-importing-specific-sheets-into-a-workbook-from-an-external-workbook/45722766#45722766", "title": "Excel VBA- Importing specific sheets into a workbook from an external workbook", "body": "<p><strong>Edited</strong> Try the following.</p>\n\n<pre><code>Sub ImportSheet()\n    Dim sImportFile As String, sFile As String\n    Dim wbThisWB As Workbook\n    Dim wbTheOtherWB As Workbook\n    Dim vfilename As Variant\n    Dim WSName As String\n    Dim LastRow As Long\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n    Set wbThisWB = ThisWorkbook\n    LastRow = wbThisWB.Worksheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Row 'get the last row whith sheets names\n\n    sImportFile = Application.GetOpenFilename( _\n    FileFilter:=\"Microsoft Excel Workbooks, *.xls; *.xlsx\", Title:=\"Open Workbook\")\n\n    If sImportFile = \"False\" Then\n        MsgBox \"No File Selected!\"\n        Exit Sub\n\n    Else\n        vfilename = Split(sImportFile, \"\\\")\n        sFile = vfilename(UBound(vfilename))\n        Application.Workbooks.Open Filename:=sImportFile\n\n        Set wbTheOtherWB = Workbooks(sFile)\n\n        With wbTheOtherWB\n            For i = 1 To LastRow 'rows in current workbook with worksheets names\n                WSName = wbThisWB.Worksheets(\"Sheet1\").Cells(i, 1) 'where you place sheets names (here column A, from row 1 down)\n                If sheetExists(WSName, wbTheOtherWB) Then\n                    Set wsSht = .Sheets(WSName)\n                    wsSht.Copy before:=wbThisWB.Sheets(\"Sheet1\")\n                Else\n                    MsgBox \"There is no sheet with name : \" &amp; WSName &amp; \" in:\" &amp; vbCr &amp; .Name\n                End If\n            Next\n            wbTheOtherWB.Close SaveChanges:=False\n        End With\n    End If\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\nEnd Sub\n\nFunction sheetExists(sheetToFind As String, wbTheOtherWB As Workbook) As Boolean\n    sheetExists = False\n    For Each Sheet In wbTheOtherWB.Worksheets\n        If sheetToFind = Sheet.Name Then\n            sheetExists = True\n            Exit Function\n        End If\n    Next Sheet\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8474509, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wPAkTNzDvWY/AAAAAAAAAAI/AAAAAAAAAAA/GuCH_w_LrcU/photo.jpg?sz=128", "display_name": "Alexander Lass", "link": "https://stackoverflow.com/users/8474509/alexander-lass"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 700, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502967099, "creation_date": 1502913404, "question_id": 45721976, "link": "https://stackoverflow.com/questions/45721976/excel-vba-importing-specific-sheets-into-a-workbook-from-an-external-workbook", "title": "Excel VBA- Importing specific sheets into a workbook from an external workbook", "body": "<p>I was able to leverage someone else code to import a worksheet from an outside workbook, however the code requires me to manually change the worksheet name. </p>\n\n<p>I currently have a column in workbook A that has the name of each (about 20) worksheet I am trying to pull from workbook B (which has hundreds of worksheets). Is there a way to loop this code and reference the column in workbook A to change the sheet name in my macro to be pulled from workbook B?\n Code below (assuming WORKSHEET1 is the name of the worksheet I am pulling from workbook B)</p>\n\n<pre><code>Sub ImportSheet() \nDim sImportFile As String, sFile As String \nDim sThisBk As Workbook \nDim vfilename As Variant \nApplication.ScreenUpdating = False \nApplication.DisplayAlerts = False \nSet sThisBk = ActiveWorkbook \nsImportFile = Application.GetOpenFilename( _ \nFileFilter:=\"Microsoft Excel Workbooks, *.xls; *.xlsx\", Title:=\"Open Workbook\") \nIf sImportFile = \"False\" Then \n    MsgBox \"No File Selected!\" \n    Exit Sub \n\nElse \n    vfilename = Split(sImportFile, \"\\\") \n    sFile = vfilename(UBound(vfilename)) \n    Application.Workbooks.Open Filename:=sImportFile \n\n    Set wbBk = Workbooks(sFile) \n    With wbBk \n        If SheetExists(\"WORKSHEET1\") Then \n            Set wsSht = .Sheets(\"WORKSHEET1\") \n            wsSht.Copy before:=sThisBk.Sheets(\"Sheet1\") \n        Else \n            MsgBox \"There is no sheet with name :WORKSHEET1 in:\" &amp; vbCr &amp; .Name \n        End If \n        wbBk.Close SaveChanges:=False \n    End With \nEnd If \nApplication.ScreenUpdating = True \nApplication.DisplayAlerts = True \nEnd Sub \nPrivate Function SheetExists(sWSName As String) As Boolean \nDim ws As Worksheet \nOn Error Resume Next \nSet ws = Worksheets(sWSName) \nIf Not ws Is Nothing Then SheetExists = True \n</code></pre>\n\n<p>End Function </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 1, "creation_date": 1502913522, "post_id": 45721965, "comment_id": 78402053, "body": "<code>&quot;&quot;&quot; &amp; varDC &amp; &quot;&quot;&quot;</code> is a single string. It sould be <code>&quot;&quot;&quot;&quot; &amp; varDC &amp; &quot;&quot;&quot;&quot;</code> (just like in your <code>vbDoubleQuote</code> constant)"}, {"owner": {"reputation": 59, "user_id": 4346787, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100001881520042/picture?type=large", "display_name": "Konsume", "link": "https://stackoverflow.com/users/4346787/konsume"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1502913846, "post_id": 45721965, "comment_id": 78402198, "body": "But it&#39;s not working if I do that, it says error number 9.  varNBLIGNES = Sheets(vbDoubleQuote &amp; varDC &amp; vbDoubleQuote).Range(COLNUM &amp; &quot;:&quot; &amp; COLNUM).Cells.SpecialCells(xlCellTypeConstants).Count  it says The index does not belong to the selection"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1502914038, "post_id": 45721965, "comment_id": 78402308, "body": "Error 9 is an <a href=\"https://msdn.microsoft.com/en-us/library/aa264519(v=vs.60).aspx\" rel=\"nofollow noreferrer\">out of range error</a>. Maybe name you are passing to <code>Sheets</code> is wrong. Are you sure the sheet name actually contains double quotes?"}, {"owner": {"reputation": 59, "user_id": 4346787, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100001881520042/picture?type=large", "display_name": "Konsume", "link": "https://stackoverflow.com/users/4346787/konsume"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1502914089, "post_id": 45721965, "comment_id": 78402338, "body": "The sheet name is just 9"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1502914129, "post_id": 45721965, "comment_id": 78402366, "body": "So why are you adding double quotes?"}, {"owner": {"reputation": 59, "user_id": 4346787, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100001881520042/picture?type=large", "display_name": "Konsume", "link": "https://stackoverflow.com/users/4346787/konsume"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1502914219, "post_id": 45721965, "comment_id": 78402420, "body": "<a href=\"https://ibb.co/dfOmCF\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 2, "creation_date": 1502914271, "post_id": 45721965, "comment_id": 78402440, "body": "If thats your sheet names, you don&#39;t need the double quotes at all! However, if you pass a number to <code>Sheets</code> it will try to get the sheet at index 9 and not the sheet named 9. So you have to cast it to a string or declare <code>varDC</code> as String"}, {"owner": {"reputation": 59, "user_id": 4346787, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100001881520042/picture?type=large", "display_name": "Konsume", "link": "https://stackoverflow.com/users/4346787/konsume"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1502914275, "post_id": 45721965, "comment_id": 78402442, "body": "lets say in this case that varDC holds 9.... than if I write down Sheets(varDC) it will say Sheets(9).  But Sheet(9) isn&#39;t the name it&#39;s the reference that vba gave to the project sheet. So let&#39;s say that my sheet named number 9 is actually Sheet 14 (9),,, and Sheet 9 (1).... thats my problem"}, {"owner": {"reputation": 59, "user_id": 4346787, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100001881520042/picture?type=large", "display_name": "Konsume", "link": "https://stackoverflow.com/users/4346787/konsume"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1502914469, "post_id": 45721965, "comment_id": 78402529, "body": "so something like Sheet(CStr(varDC)) ? I&#39;m trying it right now"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1502914534, "post_id": 45721965, "comment_id": 78402569, "body": "Yup, should work in theory"}, {"owner": {"reputation": 59, "user_id": 4346787, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100001881520042/picture?type=large", "display_name": "Konsume", "link": "https://stackoverflow.com/users/4346787/konsume"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1502914639, "post_id": 45721965, "comment_id": 78402626, "body": "You are awesome! Thanks a bunch!!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502915415, "post_id": 45721965, "comment_id": 78402965, "body": "Wah, way to ask about X when you need a solution for Y..."}], "answers": [{"comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 1, "creation_date": 1502913601, "post_id": 45722028, "comment_id": 78402086, "body": "He want&#39;s double quote, not singles"}], "tags": [], "owner": {"reputation": 716, "user_id": 8468145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d93037f8271a7ae98fee7cad2debe0aa?s=128&d=identicon&r=PG&f=1", "display_name": "0liveradam8", "link": "https://stackoverflow.com/users/8468145/0liveradam8"}, "is_accepted": false, "score": -1, "last_activity_date": 1502913589, "creation_date": 1502913589, "answer_id": 45722028, "question_id": 45721965, "link": "https://stackoverflow.com/questions/45721965/how-to-input-a-single-double-quote-in-my-vba-excel-code/45722028#45722028", "title": "How to input a single double quote in my vba Excel code", "body": "<p>To add quotation marks in a string use a different type of quotation mark, e.g.</p>\n\n<pre><code>\"'\" &amp; varDC &amp; \"'\"\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 4346787, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100001881520042/picture?type=large", "display_name": "Konsume", "link": "https://stackoverflow.com/users/4346787/konsume"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 688, "favorite_count": 0, "closed_date": 1502913628, "answer_count": 1, "score": 0, "last_activity_date": 1502913661, "creation_date": 1502913365, "last_edit_date": 1502913661, "question_id": 45721965, "link": "https://stackoverflow.com/questions/45721965/how-to-input-a-single-double-quote-in-my-vba-excel-code", "closed_reason": "Duplicate", "title": "How to input a single double quote in my vba Excel code", "body": "<p>I have several sheets in a worksheet called 1, 2, 3, 4, 5, 6, 7....</p>\n\n<p>and I need to Copy all the files in 1 single Sheet.</p>\n\n<p>I can't find the way to right now only one \" to give the name to the sheet.</p>\n\n<p>The problem happens here:</p>\n\n<blockquote>\n<pre><code>varNBLIGNES = Sheets(\"\"\" &amp; varDC &amp; \"\"\").Range(COLNUM &amp; \":\" &amp; COLNUM).Cells.SpecialCells(xlCellTypeConstants).Count\n</code></pre>\n</blockquote>\n\n<pre><code>'CONSTANTS\nConst COLNUM As String = \"B\" 'PART NUMBERS WILL ALWAYS BE IN THE B COLUM FOR EVERY EXCEL FILES\nConst COLPRC As String = \"C\" 'NEW LIST PRICE WILL ALWAYS BE IN THE C COLUM FOR EVERY EXCEL FILES\nConst COLDSC As String = \"Q\" 'NEW DESCRIPTION WILL ALWAYS BE IN THE Q COLUM FOR EVERY EXCEL FILES\nConst COLUOM As String = \"S\" 'NEW UNIT OF MESURE WILL ALWAYS BE IN THE S COLUM FOR EVERY EXCEL FILES\nConst COLUIP As String = \"T\" 'NEW UNIT IN PACKAGE WILL ALWAYS BE IN THE T COLUM FOR EVERY EXCEL FILES\nConst vbDoubleQuote As String = \"\"\"\"\n\n'VARIABLES\nDim varNBLIGNES As Integer\nDim varDC As Integer\nDim varDCS As String\nDim i As Integer\nDim quote As String\n\n\n'INITIALIZATION\nvarNBLIGNES = 0\nvarDC = Sheets(2).Range(\"P5\").Value\nvarDCS = \"\"\ni = 1\nquote = Chr(34)\n\n\n'SUB CODE TO COMPILE FILES INTO ONE\n'While varDC &gt;= i\n\n    varNBLIGNES = Sheets(\"\"\" &amp; varDC &amp; \"\"\").Range(COLNUM &amp; \":\" &amp; COLNUM).Cells.SpecialCells(xlCellTypeConstants).Count\n    varNBLIGNES = varNBLIGNES + 1\n\n    Sheets(varDC).Range(\"B3:\" &amp; COLNUM &amp; varNBLIGNES).Copy\n    Sheets(4).Select\n    Range(\"B4\").Select\n    ActiveSheet.Paste\n\n\n    'Sheets(\"PROD FOUR\").Select\n    'Range(\"B4\").Select\n    'ActiveSheet.Paste\n\n\n    'varDC = varDC - 1\n\n'Wend\n</code></pre>\n\n<p>As you can see I tried to declare it in a CONST, I also tried to create the \"CHR(34)\" and everything seams to fail.</p>\n\n<p>What am I doing wrong? Thanks you in advance</p>\n"}, {"tags": ["vba", "excel", "runtime-error", "filenames"], "comments": [{"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 3, "creation_date": 1502913387, "post_id": 45721922, "comment_id": 78401993, "body": "most likely your workbook file name or path changed ."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502913805, "post_id": 45721922, "comment_id": 78402181, "body": "Unrelated, but if <code>book1</code> is <code>ThisWorkbook</code>, your code would be much easier to follow if you dropped <code>book1</code> and used the already-existing <code>ThisWorkbook</code> object reference. Also, see <a href=\"https://stackoverflow.com/q/10714251/1188513\">how to avoid Select and Activate</a>. ...and then, you already had a reference to <code>sheet1</code> in that <code>With</code> block..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502913902, "post_id": 45721922, "comment_id": 78402227, "body": "Puzzles me why you access the very same worksheet from 2 different collections (<code>Worksheets</code>, and then <code>Sheets</code> on the very next line) - move the <code>.Buttons(&quot;Button 6&quot;).Text</code> assignment into that <code>With</code> block."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502914516, "post_id": 45721922, "comment_id": 78402553, "body": "Also an event handler being <code>Public</code> raises a flag. And the indentation is sub-par, too. I&#39;d suggest taking a look at how <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> can help you improve your code."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8474469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d566a637d49aba1c42dd20d48e2fa4?s=128&d=identicon&r=PG&f=1", "display_name": "Shelly Pig", "link": "https://stackoverflow.com/users/8474469/shelly-pig"}, "edited": false, "score": 0, "creation_date": 1502917261, "post_id": 45722155, "comment_id": 78403754, "body": "I&#39;m pretty new to this, first code I&#39;ve ever actually wrote. But this makes sense thank you. When I&#39;m pasting should I use &quot;path&quot; as well instead of files name"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 13, "user_id": 8474469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d566a637d49aba1c42dd20d48e2fa4?s=128&d=identicon&r=PG&f=1", "display_name": "Shelly Pig", "link": "https://stackoverflow.com/users/8474469/shelly-pig"}, "edited": false, "score": 0, "creation_date": 1502917312, "post_id": 45722155, "comment_id": 78403775, "body": "@ShellyPig awesome. See <a href=\"https://stackoverflow.com/help/accepted-answer\">this Help Center page</a> if you&#39;re not sure what to do next."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 13, "user_id": 8474469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d566a637d49aba1c42dd20d48e2fa4?s=128&d=identicon&r=PG&f=1", "display_name": "Shelly Pig", "link": "https://stackoverflow.com/users/8474469/shelly-pig"}, "edited": false, "score": 0, "creation_date": 1502918235, "post_id": 45722155, "comment_id": 78404133, "body": "Hadn&#39;t, but if you&#39;re not sure what&#39;s going on you need to read up about using variables and constants in VBA."}, {"owner": {"reputation": 13, "user_id": 8474469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d566a637d49aba1c42dd20d48e2fa4?s=128&d=identicon&r=PG&f=1", "display_name": "Shelly Pig", "link": "https://stackoverflow.com/users/8474469/shelly-pig"}, "edited": false, "score": 0, "creation_date": 1502926239, "post_id": 45722155, "comment_id": 78406679, "body": "Thanks it worked, not sure why event handler was public. It&#39;s not even on my original code. But thanks again for the help."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1502914348, "last_edit_date": 1502914348, "creation_date": 1502914048, "answer_id": 45722155, "question_id": 45721922, "link": "https://stackoverflow.com/questions/45721922/excel-vba-runtime-error-1004-opening-a-workbook/45722155#45722155", "title": "Excel VBA- Runtime Error 1004 opening a workbook", "body": "<blockquote>\n  <p><em>the destination file name did not change or move</em></p>\n</blockquote>\n\n<p>You're not specifying a path. Specify a path.</p>\n\n<blockquote>\n<pre><code>Set book2 = Workbooks.Open(\"Fiscal '17 Reported Straddle Fuel Usage.xlsm\")\n</code></pre>\n</blockquote>\n\n<pre><code>Const path As String = \"C:\\Foo\\Bar\\Fiscal '17 Reported Straddle Fuel Usage.xlsm\"\nSet book2 = Workbooks.Open(path)\n</code></pre>\n\n<p><code>Workbooks.Open</code> works off whatever the <code>CurDir</code> path is, and the value of <code>CurDir</code> changes whenever the user is presented with an \"open file\" dialog and they start browsing around: a file name without a full path is unreliable.</p>\n\n<p>As with many, MANY things in VBA, it's better to be explicit about it. Give it a full path.</p>\n"}], "owner": {"reputation": 13, "user_id": 8474469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d566a637d49aba1c42dd20d48e2fa4?s=128&d=identicon&r=PG&f=1", "display_name": "Shelly Pig", "link": "https://stackoverflow.com/users/8474469/shelly-pig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2225, "favorite_count": 0, "accepted_answer_id": 45722155, "answer_count": 1, "score": 1, "last_activity_date": 1502914377, "creation_date": 1502913187, "last_edit_date": 1502914377, "question_id": 45721922, "link": "https://stackoverflow.com/questions/45721922/excel-vba-runtime-error-1004-opening-a-workbook", "title": "Excel VBA- Runtime Error 1004 opening a workbook", "body": "<p>Pretty new to vba, but I wrote a code that unmerges rows within a column, copies thus cells then pastes within a different macro workbook. The code ran well when I first ran it. However I attempted to use it today and I was shocked I had an error. This error stated that it could not find the destination file name. which was weird because the destination file name did not change or move. here is a sample of the code. </p>\n\n<p>The error shows at line: </p>\n\n<blockquote>\n  <p>Set book2 = Workbooks.Open(\"Fiscal '17 Reported Straddle Fuel\n  Usage.xlsm\")</p>\n</blockquote>\n\n<p>The code is as below:</p>\n\n<pre><code>Public Sub Button6_Click()\n       'Change name of button\n\n       Worksheets(\"7500\").Buttons(\"Button 6\").Text = \"Send\"\n       With Sheets(\"7500\")\n\n       'Unmerge cells\n       .Range(\"AI3:AI92\").Select\n       With Selection\n        For Each rCell In Selection\n         With rCell\n         If .MergeCells Then\n          .MergeArea.UnMerge\n         End If\n        End With\n       Next rCell\n       End With\n      End With\n\n      'open destination workbook\n\n       Dim book1 As Workbook\n       Dim sheet1 As Worksheet\n       Dim book2 As Workbook\n       Dim sheet2 As Worksheet\n       Application.ScreenUpdating = False\n       Set book1 = ThisWorkbook\n       Set book2 = Workbooks.Open(\"Fiscal '17 Reported Straddle Fuel Usage.xlsm\")\n       Set sheet1 = book1.Sheets(\"7500\")\n       Set sheet2 = book2.Sheets(\"Nov \u201817\")\n</code></pre>\n"}, {"tags": ["sql", "sql-server", "excel", "vba"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 1, "creation_date": 1502917019, "post_id": 45721762, "comment_id": 78403657, "body": "Post the SQL in your question"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1502978835, "creation_date": 1502978835, "answer_id": 45737395, "question_id": 45721762, "link": "https://stackoverflow.com/questions/45721762/parameters-in-excel-external-data-union-query/45737395#45737395", "title": "Parameters in Excel External Data Union Query", "body": "<p>Thanks everyone.  I ended up doing it in VBA.</p>\n\n<pre><code>Sub ImportFromDB()\n\n' Create a connection object.\nDim cnPubs As ADODB.Connection\nSet cnPubs = New ADODB.Connection\n\n' Provide the connection string.\nDim strConn As String\n\n'Use the SQL Server OLE DB Provider.\nstrConn = \"PROVIDER=SQLOLEDB;\"\n\n'Connect to the Pubs database on the local server.\nstrConn = strConn &amp; \"DATA SOURCE=SERVER_NAME;INITIAL CATALOG=Data_Base;\"\n\n'Use an integrated login.\nstrConn = strConn &amp; \"Trusted_Connection=Yes;\"\n\n'Now open the connection.\ncnPubs.Open strConn\n\n' Create a recordset object.\nDim rsPubs As ADODB.Recordset\nSet rsPubs = New ADODB.Recordset\nSet sht = Worksheets(\"Impact Analysis\")\n\n    With sht\n        .Range(\"N:U\").ClearContents\n        .Range(\"N1\").Resize(1, 8).Value = Array(\"CONTACT_ID\", \"CATEGORY\", \"COMPANY_CODE\", \"CUSTOMER_NO\", \"SECTOR\", \"DES\", \"ASOFDATE\", \"BALANCE\")\n        Set rw = .Rows(2)\n    End With\n\n    With rsPubs\n        ' Assign the Connection object.\n        .ActiveConnection = cnPubs\n        ' Extract the required records.\n        .Open \"SELECT * FROM MY_TABLE\"\n\n        ' Copy the records into cell A1 on Sheet1.\n        Worksheets(\"Impact Analysis\").Range(\"N2\").CopyFromRecordset rsPubs\n\n        ' Tidy up\n        .Close\n    End With\n\ncnPubs.Close\nSet rsPubs = Nothing\nSet cnPubs = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 343, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502978835, "creation_date": 1502912584, "last_edit_date": 1531164843, "question_id": 45721762, "link": "https://stackoverflow.com/questions/45721762/parameters-in-excel-external-data-union-query", "title": "Parameters in Excel External Data Union Query", "body": "<p>I have two queries that pull data from SQL Server into Excel.  Both work perfectly fine.  I tried to Union them together and pass in a parameter as a date, and now nothing works.  Here's a link to an article that describes how to use Microsoft Query, and pass in a parameter.</p>\n\n<p><a href=\"http://dailydoseofexcel.com/archives/2004/12/13/parameters-in-excel-external-data-queries/\" rel=\"nofollow noreferrer\">http://dailydoseofexcel.com/archives/2004/12/13/parameters-in-excel-external-data-queries/</a></p>\n\n<p>All I want to do is get this working with a Union Query.  Is that possible?  Or, do I need a VBA solution to achieve this.  I'm sure it's do-able, I just don't know exactly how to do it.  I'd appreciate any suggestions.</p>\n\n<p>Thanks! </p>\n"}, {"tags": ["excel", "vba", "sap-gui"], "comments": [{"owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "edited": false, "score": 0, "creation_date": 1503488621, "post_id": 45721733, "comment_id": 78634625, "body": "First I would find the correct column name. For example, use the script recorder to record a script by simply highlighting the relevant column and terminating the recording at that point. The column name you are looking for is in the recorded script."}, {"owner": {"reputation": 11, "user_id": 8474400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25f56e50104c12b9a90b27463ba5c61e?s=128&d=identicon&r=PG&f=1", "display_name": "josh cunningham", "link": "https://stackoverflow.com/users/8474400/josh-cunningham"}, "reply_to_user": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "edited": false, "score": 0, "creation_date": 1503521115, "post_id": 45721733, "comment_id": 78656143, "body": "Right.  Let me paraphrase.  I need code that scrolls through SAP table column Session.FindById(&quot;wnd[0]/usr/tblSAPMM06ETC_1117/txtEKET-ETEN&zwnj;&#8203;R) to look for a particular number (from Excel spreadsheet).  Once it locates the particular number, I need it to update the data in column   Session.FindById(&quot;wnd[0]/usr/tblSAPMM06ETC_1117/txtEKET-MENG&zwnj;&#8203;E) to a different number on the same Excel spreadsheet."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8474400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25f56e50104c12b9a90b27463ba5c61e?s=128&d=identicon&r=PG&f=1", "display_name": "josh cunningham", "link": "https://stackoverflow.com/users/8474400/josh-cunningham"}, "edited": false, "score": 0, "creation_date": 1504046027, "post_id": 45861305, "comment_id": 78857177, "body": "Scriptman, Thank you so much for providing this information.  While it didn&#39;t directly solve my problem, it helped me learn and deduce a resolution to my problem.  Very much appreciate the assistance and my new found knowledge.  Sincerely, Josh"}, {"owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "reply_to_user": {"reputation": 11, "user_id": 8474400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25f56e50104c12b9a90b27463ba5c61e?s=128&d=identicon&r=PG&f=1", "display_name": "josh cunningham", "link": "https://stackoverflow.com/users/8474400/josh-cunningham"}, "edited": false, "score": 0, "creation_date": 1504073752, "post_id": 45861305, "comment_id": 78864209, "body": "Josh, I am very glad it helped. Sometimes it is better to find a solution by itself. ;-)"}], "tags": [], "owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "is_accepted": false, "score": 0, "last_activity_date": 1503576706, "creation_date": 1503576706, "answer_id": 45861305, "question_id": 45721733, "link": "https://stackoverflow.com/questions/45721733/scroll-guigridview-to-find-the-row-with-a-specific-value-in-a-given-column/45861305#45861305", "title": "Scroll GuiGridView to find the row with a specific value in a given column", "body": "<p>I will give you an example of how to deal with a table in SAP. In your case you use the commands for a GRID and this is not correct.</p>\n\n<p>for example:</p>\n\n<pre><code>myFile = \"z:\\tmp\\test.xlsx\"\nmySheet = \"Test\"\n\nSet xclApp = CreateObject(\"Excel.Application\")\nSet xclwbk = xclapp.Workbooks.Open(myFile)\nset xclsht = xclwbk.Sheets(mySheet)\n\nxclApp.Visible = True\nxclapp.DisplayAlerts = false\n\nk = 1\n\ndo\n\nset myTable = session.findById(\"wnd[0]/usr/ssubITEMS:SAPLFSKB:0100/tblSAPLFSKBTABLE\")\n\n if k = 1 then\n 'rows = myTable.RowCount\n  cols = myTable.Columns.Count\n  vRows = myTable.VisibleRowCount\n  for j = 0 to cols - 1\n   xclsht.Cells(k,j + 1).Value = myTable.columns.elementAt(j).title\n  next\n  k = k + 1\n end if\n\nfor i = 0 to vRows - 1\nl = 1\n for j = 0 to Cols - 1\n  on error resume next\n  myVariable = trim(myTable.GetCell(i,j).Text) \n  if err.number &lt;&gt; 0 then  exit for      \n  on error goto 0\n  if left(right(myVariable,3),1) = \",\" then \n   myVariable = replace(myVariable, \".\" , \"\")\n   myVariable = replace(myVariable, \",\" , \"\")\n   xclsht.Cells(k,l).Value = myVariable/100\n  else \n   xclsht.Cells(k,l).Value = myVariable \n  end if\n  l = l + 1\n next\n if err.number &lt;&gt; 0 then  exit for       \n k = k + 1\nnext\nif err.number &lt;&gt; 0 then  exit do       \nmyTable.VerticalScrollbar.Position = myTable.VerticalScrollbar.Position + vRows\n\nLoop \nxclapp.ActiveWorkbook.Save\n\nSet xclwbk = Nothing\nSet xclsheet = Nothing\nset xclapp = Nothing\n</code></pre>\n\n<p>Regards,\nScriptMan</p>\n"}], "owner": {"reputation": 11, "user_id": 8474400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25f56e50104c12b9a90b27463ba5c61e?s=128&d=identicon&r=PG&f=1", "display_name": "josh cunningham", "link": "https://stackoverflow.com/users/8474400/josh-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 8484, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1612836045, "creation_date": 1502912470, "last_edit_date": 1610185824, "question_id": 45721733, "link": "https://stackoverflow.com/questions/45721733/scroll-guigridview-to-find-the-row-with-a-specific-value-in-a-given-column", "title": "Scroll GuiGridView to find the row with a specific value in a given column", "body": "<p>I have created an Excel spreadsheet that extracts live data from a query in SAP GUI and paste that info back into Excel\n<img src=\"https://i.stack.imgur.com/CJtGv.jpg\" alt=\"Extraction Pic\" />.</p>\n<p>From there, I'm opening transaction ME38 to update schedule lines based off the extracted data.  I need to go to the &quot;scheduled..&quot; column (which I know to be &quot;txtEKET-MENGE&quot;) and change the number shown to the &quot;Qty Delivered&quot; (which is a part of the extraction); however, I need to only do this on certain cells in the &quot;Schedule...&quot; column (&quot;txtEKET-ETENR&quot;) [data listed on extraction as well].<br />\n<img src=\"https://i.stack.imgur.com/NAiao.jpg\" alt=\"SAP Table Pic\" /></p>\n<p>When it gets to &quot;Set grid...&quot; it ends the function and does nothing else.</p>\n<p>Any insight would be greatly appreciated.</p>\n<p>Here is what I've done so far.</p>\n<pre><code>Set xclapp = CreateObject(&quot;Excel.Application&quot;)\nSet xclwbk = ThisWorkbook\nSet xclsht = xclwbk.Sheets(&quot;Sheet1&quot;)\nFor k = 2 To ActiveCell.SpecialCells(11).Row\nFor j = 1 To ActiveCell.SpecialCells(11).Column\nIf j = 14 Then Purch = xclsht.Cells(k, j).Value\nIf j = 15 Then Item = xclsht.Cells(k, j).Value\nIf j = 16 Then SLine = xclsht.Cells(k, j).Value\nIf j = 8 Then PGI = xclsht.Cells(k, j).Value\nNext\nmyTransaction = &quot;ME38&quot;\n\nSession.FindById(&quot;wnd[0]/tbar[0]/okcd&quot;).Text = &quot;/n&quot; &amp; myTransaction\n\nSession.FindById(&quot;wnd[0]&quot;).sendVKey 0\n\nOn Error Resume Next\nSession.FindById(&quot;wnd[0]/usr/ctxtRM06E-EVRTN&quot;).Text = Purch\nSession.FindById(&quot;wnd[0]/usr/ctxtRM06E-EVRTN&quot;).caretPosition = 10\nSession.FindById(&quot;wnd[0]&quot;).sendVKey 0\nSession.FindById(&quot;wnd[0]/usr/txtRM06E-EBELP&quot;).Text = Item\nSession.FindById(&quot;wnd[0]/usr/txtRM06E-EBELP&quot;).caretPosition = 3\nSession.FindById(&quot;wnd[0]&quot;).sendVKey 0\nSession.FindById(&quot;wnd[0]/tbar[1]/btn[30]&quot;).press\nSession.FindById(&quot;wnd[0]/tbar[1]/btn[2]&quot;).press\nCall SelectRowOnGrid\nSession.FindById(&quot;wnd[0]/mbar/menu[0]/menu[0]&quot;).Select\nSession.FindById(&quot;wnd[0]&quot;).Close\n  On Error Resume Next\n\n  Session.FindById(&quot;wnd[1]/usr/btnSPOP-OPTION1&quot;).press\nNext\nEnd If\nIf Err.Number &lt;&gt; 0 Then\n\n'The Excel worksheet has e.g. 3 columns of data and an error column.\n\nxclsht.Cells(j, 21).Value = &quot;Here is an error.&quot;\n\nElse\n\nxclsht.Cells(j, 21).Value = &quot;O.K.&quot;\n\nEnd If\n\nOn Error GoTo 0\n</code></pre>\n<p>The following is the Function SelectRowOnGrid.</p>\n<pre><code>Function SelectRowOnGrid()\nDim grid As SAPFEWSELib.GuiTableControl\nDim columnname As SAPFEWSELib.GuiTableColumn\nDim texttofind As String\nSet grid = Session.FindById(&quot;wnd[0]/usr/tblSAPMM06ETC_1117/&quot;)\nSet columnname = Session.FindById(&quot;wnd[0]/usr/tblSAPMM06ETC_1117/txtEKET-  ETENR&quot;)\ntexttofind = xclsht.Cells(k, 16).Value\n\n    For k = 0 To grid.RowCount - 1\n\nIf grid.GetCellValue(k, columnname) = texttofind Then\ngrid.SetCurrentCell\ngrid.DoubleClickCurrentCell\nEnd If\n\n    Next k\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1502911880, "post_id": 45721568, "comment_id": 78401282, "body": "I would have thought that the most cursory research would have alerted you to a problem with <code>Ofsett</code> ."}, {"owner": {"reputation": 435, "user_id": 2209327, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/af16da6bcf691ad3d2a86dc87fb301b1?s=128&d=identicon&r=PG", "display_name": "ChrisBull", "link": "https://stackoverflow.com/users/2209327/chrisbull"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1502912562, "post_id": 45721568, "comment_id": 78401608, "body": "You are correct"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1502912960, "post_id": 45721568, "comment_id": 78401770, "body": "Problem sorted then?"}, {"owner": {"reputation": 435, "user_id": 2209327, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/af16da6bcf691ad3d2a86dc87fb301b1?s=128&d=identicon&r=PG", "display_name": "ChrisBull", "link": "https://stackoverflow.com/users/2209327/chrisbull"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1503047450, "post_id": 45721568, "comment_id": 78462660, "body": "Not quite, Now both cells have <code>#VALUE!</code> and I haven&#39;t had time to look into it yet. If it helps with debugging the reason. The process is started when the person clicks a hyperlink inside a cell."}], "owner": {"reputation": 435, "user_id": 2209327, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/af16da6bcf691ad3d2a86dc87fb301b1?s=128&d=identicon&r=PG", "display_name": "ChrisBull", "link": "https://stackoverflow.com/users/2209327/chrisbull"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502911795, "creation_date": 1502911795, "last_edit_date": 1531164843, "question_id": 45721568, "link": "https://stackoverflow.com/questions/45721568/insert-if-function-to-a-cell-with-vba", "title": "Insert IF function to a cell with VBA", "body": "<p>I need to use vba to place an IF function into a cell which is 8 columns to the right of the active cell. The IF function compares the value of the cell 2 columns to the left of the active cell.</p>\n\n<p>So far i have tried various variations of the below but can't seem to get it to work, any ideas?</p>\n\n<pre><code>targetRange.Ofsett(0, 8).Formula = \"=IF(\" &amp; targetRange.Ofsett(0, -2).Address &amp; \" =\"\"FAIL\"\",\"\"Enter Required Data\"\",\"\"\"\")\"\ntargetRange.Ofsett(0, 8).FormulaR1C1 = \"=IF(R[0]C[-10]=\"\"FAIL\"\",\"\"Enter Required Data\"\",\"\"\"\")\"\n</code></pre>\n"}, {"tags": ["excel", "vba", "dll", "delete-file"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1502913763, "post_id": 45721448, "comment_id": 78402158, "body": "FreeLib merely decrements the reference count.  Check for the FreeLib return value. If its not zero then you haven&#39;t actually unloaded it."}, {"owner": {"reputation": 2027, "user_id": 1582588, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3J7yh.png?s=128&g=1", "display_name": "Shrout1", "link": "https://stackoverflow.com/users/1582588/shrout1"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1502914659, "post_id": 45721448, "comment_id": 78402635, "body": "@cyboashu Thanks! I had already tested that and I updated my code to address this. Even when FreeLib returns 0 I still encounter the error."}, {"owner": {"reputation": 323, "user_id": 9034269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a314b3c9b9b7d834f280ecbc043847e?s=128&d=identicon&r=PG&f=1", "display_name": "ingwarus", "link": "https://stackoverflow.com/users/9034269/ingwarus"}, "edited": false, "score": 0, "creation_date": 1522757388, "post_id": 45721448, "comment_id": 86266186, "body": "I don&#39;t recommend loops with <code>FreeLibrary</code>. I&#39;ve tried do it with and without <code>GetModuleHandle</code> and it is kind of unstable. More details <a href=\"https://stackoverflow.com/questions/47575675/excel-vba-with-c-dll-sometimes-crashes\">here</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "is_accepted": false, "score": 0, "last_activity_date": 1525594497, "last_edit_date": 1525594497, "creation_date": 1503387589, "answer_id": 45811643, "question_id": 45721448, "link": "https://stackoverflow.com/questions/45721448/vba-freelibrary-doesnt-unload-dll/45811643#45811643", "title": "VBA FreeLibrary doesn&#39;t unload DLL", "body": "<h1>I've just rediscovered this answer and with the benefit of some more experience suggest it NOT be used.</h1>\n\n<p>See: <a href=\"https://stackoverflow.com/a/28745693/3451115\">https://stackoverflow.com/a/28745693/3451115</a> </p>\n\n<p>One of the issues that I faced with this approach is that, although the library was freed, trying to reload it crashed the host (MS Word for me).</p>\n\n<p>Evil as it is, it may meet a need so be advised and use with caution.</p>\n\n<hr>\n\n<p>Depending on what the root cause of your problem is this may or may not help, but I think it is a step in the right direction.  </p>\n\n<p>The return value of 0 from FreeLib indicates that there has been an error and NOT that the library has been freed, see here: <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms683152%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/windows/desktop/ms683152%28v=vs.85%29.aspx</a></p>\n\n<p>From what I understand FreeLib should only be called as many times as LoadLibrary was used... so, rather than looping until an error appears (FreeLib = 0) you could instead have a loop that frees the library and then checks if the library is still loaded, try something like this:</p>\n\n<pre><code>    Do Until lb = 0\n        FreeLibrary lb\n        If CBool(Err.LastDllError) Then\n            debug.print \"dll error\" &amp; \" \" &amp; Err.LastDllError\n            Err.Clear\n            Exit Do\n        End If\n\n        lb = 0 ' Reset lb needed for test on next line\n\n        ' Check if the dll really has been released...\n        lb = GetModuleHandle(\"C:\\Users\\Administrator\\Documents\\MathLibrary.dll\")\n    Loop\n</code></pre>\n\n<p>You'll need to declare this function to use GetModuleHandle (<code>VBA7</code> version): <code>Private Declare PtrSafe Function GetModuleHandle Lib \"kernel32\" Alias \"GetModuleHandleA\" (ByVal GetModuleHandle As String) As LongPtr</code>. </p>\n\n<p>Also, I'm declaring LoadLib and FreeLib with <code>LongPtr</code> for <code>VBA7</code> like this:</p>\n\n<pre><code>Private Declare PtrSafe Function LoadLibrary Lib \"kernel32\" Alias \"LoadLibraryA\" (ByVal lpLibFileName As String) As LongPtr\nPrivate Declare PtrSafe Function FreeLibrary Lib \"kernel32\" (ByVal hLibModule As LongPtr) As Long\n</code></pre>\n\n<p>Hope it helps :)</p>\n"}], "owner": {"reputation": 2027, "user_id": 1582588, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3J7yh.png?s=128&g=1", "display_name": "Shrout1", "link": "https://stackoverflow.com/users/1582588/shrout1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1049, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1525594497, "creation_date": 1502911402, "last_edit_date": 1502914631, "question_id": 45721448, "link": "https://stackoverflow.com/questions/45721448/vba-freelibrary-doesnt-unload-dll", "title": "VBA FreeLibrary doesn&#39;t unload DLL", "body": "<p>I need to delete a DLL file when I am done using it (cleanup after code is completed). </p>\n\n<p>I try using \"LoadLibrary\" and \"FreeLibrary\" in Excel VBA but no matter what I do Excel.exe clings to the DLL file.</p>\n\n<pre><code> Public Declare PtrSafe Function FreeLibrary Lib \"kernel32\" (ByVal hLibModule As Long) As Long\n Public Declare PtrSafe Function LoadLibrary Lib \"kernel32\" Alias \"LoadLibraryA\" (ByVal lpLibFileName As String) As Long\n\n Private Sub Load_Unload_DLL()\n\n     Dim lb As Long, pa As Long\n     lb = LoadLibrary(\"C:\\Users\\Administrator\\Documents\\MathLibrary.dll\")\n\n     'MsgBox \"Library address: \" &amp; lb\n\n     Dim FreeResult As Long\n     FreeResult = 1\n\n     Do Until FreeResult = 0\n         FreeResult = FreeLibrary(lb)\n     Loop\n\n     Name \"C:\\Users\\Administrator\\Documents\\MathLibrary.dll\" As \"C:\\Users\\Administrator\\Documents\\MathLibrary2.dll\"\n\n     Kill (\"C:\\Users\\Administrator\\Documents\\MathLibrary2.dll\")\n\n End Sub\n</code></pre>\n\n<p>Despite \"FreeResult\" equaling \"0\" I receive the following error when executing the \"Kill\" command:</p>\n\n<p><a href=\"https://i.stack.imgur.com/z8ptI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/z8ptI.png\" alt=\"Path Access Error\"></a></p>\n\n<p>And Process Explorer showing that the DLL file is indeed still loaded by Excel:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2J8py.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2J8py.png\" alt=\"Process Explorer\"></a></p>\n\n<p>The file can be renamed, but not deleted (as indicated by the code).</p>\n\n<p>Am I missing something?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 7458692, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1087081831402773/picture?type=large", "display_name": "Craig Key", "link": "https://stackoverflow.com/users/7458692/craig-key"}, "edited": false, "score": 0, "creation_date": 1502912544, "post_id": 45721722, "comment_id": 78401598, "body": "Sorry, I should have mentioned that I have tried using that but so far can&#39;t come up with a way to keep it from ending up in an endless loop."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 143, "user_id": 7458692, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1087081831402773/picture?type=large", "display_name": "Craig Key", "link": "https://stackoverflow.com/users/7458692/craig-key"}, "edited": false, "score": 2, "creation_date": 1502912669, "post_id": 45721722, "comment_id": 78401651, "body": "@CraigKey You would need to set <code>Application.EnableEvents = False</code> at the start of your code (and reset it to <code>True</code> at the end).  That will stop any events firing  while your code is running (i.e. a calculation due to changes made by your code won&#39;t re-fire the <code>Worksheet_Calculate</code> event.)"}], "tags": [], "owner": {"reputation": 572, "user_id": 7386264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WJWxZ.jpg?s=128&g=1", "display_name": "brunohdaniel", "link": "https://stackoverflow.com/users/7386264/brunohdaniel"}, "is_accepted": true, "score": 1, "last_activity_date": 1502912419, "creation_date": 1502912419, "answer_id": 45721722, "question_id": 45721381, "link": "https://stackoverflow.com/questions/45721381/run-vba-macro-in-excel-when-a-particular-formula-recalculates/45721722#45721722", "title": "Run VBA Macro in Excel when a particular formula recalculates", "body": "<p>Try to use the <code>Private Sub Worksheet_Calculate()</code>.</p>\n\n<p>You may need to create some to trigger or not your macro inside the function.</p>\n"}], "owner": {"reputation": 143, "user_id": 7458692, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1087081831402773/picture?type=large", "display_name": "Craig Key", "link": "https://stackoverflow.com/users/7458692/craig-key"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 45721722, "answer_count": 1, "score": 0, "last_activity_date": 1502912419, "creation_date": 1502911099, "last_edit_date": 1502911525, "question_id": 45721381, "link": "https://stackoverflow.com/questions/45721381/run-vba-macro-in-excel-when-a-particular-formula-recalculates", "title": "Run VBA Macro in Excel when a particular formula recalculates", "body": "<p>I am far from great at macros in Excel and could really use some guidance. Need to run a simple macro that looks like this: </p>\n\n<pre><code>Public Sub CopyReplaceValue(rng1 As String)\n\nDim str1 As String\nDim str2 As String\nDim str3 As String\nDim rng2 As Integer\n\nOn Error GoTo LetsContinue\n\nstr1 = \"N\" ''this is your FRZ column\nstr2 = Range(rng1).Row ''Row number of updated cell\nstr3 = str1 &amp; str2 ''FRZ cell to be changed\n\nrng2 = Range(str3).Value \nIf Sgn(Range(rng1)) &lt;&gt; Sgn(rng2) Then    \nRange(str3).Value = 0    \nElseIf Abs(Range(rng1).Value) &lt;= Abs(rng2) Then    \nRange(str3).Value = Range(rng1).Value\n\nEnd If    \nLetsContinue:    \nExit Sub  \nEnd Sub\n</code></pre>\n\n<p>Now the tricky part is how to call this macro when I need it to be. I want <code>rng1</code> to be a cell from a range set by me, I then need an event to trigger the call.</p>\n\n<p>The problem is that using <code>Private Sub Worksheet_Change(ByVal Target As Range)</code> does not seem to work since the finished sheet will only change when RTD links and formulas update. That event only seems to update when I manually change a value in the range, which isn't something that I will ever do when the sheet is complete.</p>\n\n<p>Is there a way to call this macro when a cell within this range re-calculates and/or changes via formula, without a person touching the sheet.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1502910522, "post_id": 45721161, "comment_id": 78400626, "body": "Advanced Filter requires a heading. It assumes the first A in A1 is a header and will automatically copy it across."}], "answers": [{"tags": [], "owner": {"reputation": 716, "user_id": 8468145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d93037f8271a7ae98fee7cad2debe0aa?s=128&d=identicon&r=PG&f=1", "display_name": "0liveradam8", "link": "https://stackoverflow.com/users/8468145/0liveradam8"}, "is_accepted": false, "score": 1, "last_activity_date": 1502910678, "creation_date": 1502910678, "answer_id": 45721268, "question_id": 45721161, "link": "https://stackoverflow.com/questions/45721161/excel-vba-to-copy-unique-values-duplicate-1st-value/45721268#45721268", "title": "Excel VBA to copy unique values duplicate 1st value", "body": "<p>Insert another cell above cell A1. Write \"Header\" or any other text in this box. Change the range to A1:A11. This should solve your problem.</p>\n"}, {"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 2, "last_activity_date": 1502911401, "last_edit_date": 1502911401, "creation_date": 1502911060, "answer_id": 45721365, "question_id": 45721161, "link": "https://stackoverflow.com/questions/45721161/excel-vba-to-copy-unique-values-duplicate-1st-value/45721365#45721365", "title": "Excel VBA to copy unique values duplicate 1st value", "body": "<p>An alternative approach, which doesn't require a header.</p>\n\n<pre><code>Sub Module()\n\nApplication.ScreenUpdating = False\n\nWith Range(\"A1:A10\")\n    .Copy .Offset(, 3)\n    .Offset(, 3).RemoveDuplicates Columns:=1, Header:=xlNo\nEnd With\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2608, "user_id": 3258462, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/fspw2.png?s=128&g=1", "display_name": "Vincent Tang", "link": "https://stackoverflow.com/users/3258462/vincent-tang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1886, "favorite_count": 1, "answer_count": 2, "score": -1, "last_activity_date": 1502911401, "creation_date": 1502910272, "question_id": 45721161, "link": "https://stackoverflow.com/questions/45721161/excel-vba-to-copy-unique-values-duplicate-1st-value", "title": "Excel VBA to copy unique values duplicate 1st value", "body": "<p>I have this excel VBA code</p>\n\n<pre><code>Sub Module()\n\nRange(\"A1:A10\").AdvancedFilter Action:=xlFilterCopy, CopyToRange:=Range(\"D1\"), Unique:=True\n\nEnd Sub\n</code></pre>\n\n<p>I expect it to grab all unique values from column A and dump them in column D</p>\n\n<p>However, the value in D1 is a duplicate.</p>\n\n<p><a href=\"https://i.stack.imgur.com/7u246.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7u246.png\" alt=\"enter image description here\"></a></p>\n\n<p>Why is this and how do I fix?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1502910188, "post_id": 45721087, "comment_id": 78400473, "body": "set form property &quot;ShowModal&quot; to False"}, {"owner": {"reputation": 61, "user_id": 8309064, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b149cf2fdca4662e306853b17b260c98?s=128&d=identicon&r=PG&f=1", "display_name": "Sherlock", "link": "https://stackoverflow.com/users/8309064/sherlock"}, "reply_to_user": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1502910324, "post_id": 45721087, "comment_id": 78400542, "body": "Thank you. That worked. I wasn&#39;t familiar with the term modal."}], "answers": [{"tags": [], "owner": {"reputation": 716, "user_id": 8468145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d93037f8271a7ae98fee7cad2debe0aa?s=128&d=identicon&r=PG&f=1", "display_name": "0liveradam8", "link": "https://stackoverflow.com/users/8468145/0liveradam8"}, "is_accepted": false, "score": 1, "last_activity_date": 1502910352, "creation_date": 1502910352, "answer_id": 45721182, "question_id": 45721087, "link": "https://stackoverflow.com/questions/45721087/minimizable-message-box-in-vb/45721182#45721182", "title": "Minimizable message box in VB", "body": "<p>Message boxes always pause the execution of the program. You'll need to find an alternative, for example by using the status bar instead, which is probably the easiest option. You can use the status bar in excel like this:</p>\n\n<pre><code>Application.StatusBar = \"Hello world\"\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Application.StatusBar = variableName &amp; \" pounds.\"\n</code></pre>\n\n<p>and clear it using:</p>\n\n<pre><code>Application.StatusBar = False\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 8309064, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b149cf2fdca4662e306853b17b260c98?s=128&d=identicon&r=PG&f=1", "display_name": "Sherlock", "link": "https://stackoverflow.com/users/8309064/sherlock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502910352, "creation_date": 1502909992, "question_id": 45721087, "link": "https://stackoverflow.com/questions/45721087/minimizable-message-box-in-vb", "title": "Minimizable message box in VB", "body": "<p>I need a Visual Basic form that will allow the user to scroll through an Excel sheet while the form is running so that they can locate the information they need to enter into the form. Currently, the user must look up all the information before running the macro, which is obviously not very user friendly.</p>\n\n<p>In other words, as the program is now, if the user tries to scroll through the Excel sheet (or do anything at all outside of the form), they are not allowed to without first canceling the form.</p>\n\n<p>Is there a way to do this? Seems like this should be a simple thing to resolve, but I'm having trouble finding good VB documentation online.</p>\n"}, {"tags": ["excel", "pivot-table", "excel-2013", "pivotitem", "vba"], "answers": [{"tags": [], "owner": {"reputation": 15, "user_id": 7416098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5988d950eccba31073d77af3c78fa2?s=128&d=identicon&r=PG&f=1", "display_name": "marionffavp", "link": "https://stackoverflow.com/users/7416098/marionffavp"}, "is_accepted": true, "score": 0, "last_activity_date": 1504709897, "last_edit_date": 1504709897, "creation_date": 1503070858, "answer_id": 45760395, "question_id": 45721069, "link": "https://stackoverflow.com/questions/45721069/excel-2013-vba-pivot-table-select-only-top-5-items-with-ties/45760395#45760395", "title": "Excel 2013 VBA Pivot Table Select Only Top 5 Items With Ties", "body": "<p>I finally figured this one out. The best way to do it just in case anyone else is wondering, is to record a macro while you:</p>\n\n<ol>\n<li>Select the cell in which you want to start seeing data. In my case it was \"B10\". This will be different for everyone else depending on where your pivot table data is.</li>\n<li>Press the SHIFT + END + DOWN ARROW Keys to go down to the bottom of the used range.</li>\n<li>Select all the rows to hide.</li>\n<li>Right Click on the values to hide.</li>\n<li>Select \"Filter\" from the list.</li>\n<li>Click on \"Hide selected items\". </li>\n</ol>\n\n<p>Below is the code that I will refer to in the future.</p>\n\n<pre><code>Application.Goto reference:=Workbooks(\"File\").Sheets(\"Sheet1\").Range(\"B10\")\nIf IsEmpty(Range(\"B11\").value) = False Then\nRange(\"B10\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Delete\nElse\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7416098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5988d950eccba31073d77af3c78fa2?s=128&d=identicon&r=PG&f=1", "display_name": "marionffavp", "link": "https://stackoverflow.com/users/7416098/marionffavp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1144, "favorite_count": 1, "accepted_answer_id": 45760395, "answer_count": 1, "score": 0, "last_activity_date": 1504710101, "creation_date": 1502909928, "last_edit_date": 1531161705, "question_id": 45721069, "link": "https://stackoverflow.com/questions/45721069/excel-2013-vba-pivot-table-select-only-top-5-items-with-ties", "title": "Excel 2013 VBA Pivot Table Select Only Top 5 Items With Ties", "body": "<p>I am trying to find a way to use Excel 2013 VBA to only select the Top 5 items in a pivot table. I have tried the following lines of code in an attempt to show only the Top 5 items:</p>\n\n<pre><code>Dim c\ndim i as long\n\nWorksheets(\"sheet1\").PivotTables(1).PivotFields (\"field1\")\nActiveSheet.PivotTables(1).PivotFields(\"field1\").CurrentPage = \"(All)\"\nWith ActiveSheet.PivotTables(1).PivotFields(\"field1\")\nc = 5\nFor i = .PivotItems.Count To 1 Step -1\nIf (c &gt; 0) Then\n.PivotItems(i).Visible = True\nElse\n.PivotItems(i).Visible = False\nEnd If\nc = c - 1\nNext\nEnd With\n</code></pre>\n\n<p>This is the code that the macro recorder gives me and does not work:</p>\n\n<pre><code>ActiveSheet.PivotTables(\"PivotTable5\").PivotFilters. _\n.PivotFields(\"field1\") Add2 Type:=xlTopCount, _        DataField:=ActiveSheet.PivotTables(\"PivotTable5\"). _\n    PivotFields(\"fied1\"), Value1:=5\n</code></pre>\n\n<p>The code below works fine if there are no value ties for any of the values that are not in the Top 5 list. With our data set we are always going to ties in our Top 5 list.</p>\n\n<pre><code>With Workbooks(cFileName).Worksheets(\"sheet1\")\n.PivotTables(1).PivotFields(\"Field1\").PivotFilters.Add2     \nxlTopCount, .PivotTables(1).PivotFields(\"Field1\"), 5\nEnd With\n</code></pre>\n\n<p>EDIT:\nThe pivot table list will show some items as being checked, but no data is associated with those values. The charts which are based on these pivot tables are blank and the following code selects only the bottom 5 values in the field as it was intended to do in it's original post.</p>\n\n<pre><code>With workbook.Worksheets(\"sheet1\").PivotTables(\"PivotTable2\").PivotFields\n(\"Count of Description\")\n\nFor Each WS In ActiveWorkbook.Worksheets\nFor Each pvt In WS.PivotTables\n\nc = 5\n\nFor i = .PivotItems.Count To 1 Step -1\nIf (c &gt; 0) Then\n.PivotItems(i).Visible = True\nElse\n.PivotItems(i).Visible = False\nEnd If\nc = c - 1\nNext\nNext\nNext\n\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1822, "user_id": 624292, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4fd8cadbf9c2cf573b13c7f53fc5fd43?s=128&d=identicon&r=PG", "display_name": "M_Idrees", "link": "https://stackoverflow.com/users/624292/m-idrees"}, "edited": false, "score": 2, "creation_date": 1502909906, "post_id": 45721003, "comment_id": 78400356, "body": "Better to post some sample data, and desired output. e.g. a collection of string you want to place in cells?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502910225, "post_id": 45721003, "comment_id": 78400489, "body": "Please read <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and see if you can <a href=\"https://stackoverflow.com/posts/45721003/edit\">edit</a> your question to include one."}, {"owner": {"reputation": 1822, "user_id": 624292, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4fd8cadbf9c2cf573b13c7f53fc5fd43?s=128&d=identicon&r=PG", "display_name": "M_Idrees", "link": "https://stackoverflow.com/users/624292/m-idrees"}, "edited": false, "score": 1, "creation_date": 1502910247, "post_id": 45721003, "comment_id": 78400499, "body": "What code you have tried. In what form you have this collection e.g. array?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502910313, "post_id": 45721003, "comment_id": 78400539, "body": "<code>Dim values() As Variant</code> / <code>values = Sheet1.Range(&quot;A1:Z32767&quot;)</code>"}, {"owner": {"reputation": 49, "user_id": 3520302, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04739e687249e6e8b5548fd7ad29f9fb?s=128&d=identicon&r=PG&f=1", "display_name": "PedroCunha_67677", "link": "https://stackoverflow.com/users/3520302/pedrocunha-67677"}, "reply_to_user": {"reputation": 1822, "user_id": 624292, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4fd8cadbf9c2cf573b13c7f53fc5fd43?s=128&d=identicon&r=PG", "display_name": "M_Idrees", "link": "https://stackoverflow.com/users/624292/m-idrees"}, "edited": false, "score": 0, "creation_date": 1502911087, "post_id": 45721003, "comment_id": 78400909, "body": "Tried code is in question @MIdrees"}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1502912253, "post_id": 45721003, "comment_id": 78401467, "body": "What does your code do that it shouldn&#39;t do and/or not do that it should do?"}, {"owner": {"reputation": 49, "user_id": 3520302, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04739e687249e6e8b5548fd7ad29f9fb?s=128&d=identicon&r=PG&f=1", "display_name": "PedroCunha_67677", "link": "https://stackoverflow.com/users/3520302/pedrocunha-67677"}, "edited": false, "score": 0, "creation_date": 1502912615, "post_id": 45721003, "comment_id": 78401626, "body": "It should put each collection value in a cell starting on the active cell. However throws an error/recommendation about circular cell referencing."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1502912628, "post_id": 45721003, "comment_id": 78401632, "body": "So your collection contains strings that are &quot;0&quot; correct and you do not want those strings to print to the excel sheet?.. or does 0 mean null/nothing"}, {"owner": {"reputation": 49, "user_id": 3520302, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04739e687249e6e8b5548fd7ad29f9fb?s=128&d=identicon&r=PG&f=1", "display_name": "PedroCunha_67677", "link": "https://stackoverflow.com/users/3520302/pedrocunha-67677"}, "edited": false, "score": 0, "creation_date": 1502912741, "post_id": 45721003, "comment_id": 78401683, "body": "Yes. I am assured that the collection has exactly what I need, I used the debugger, and it has the 3 items I need"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1502913113, "post_id": 45721003, "comment_id": 78401850, "body": "are the other elements in the collection empty? And what is the error message?"}, {"owner": {"reputation": 49, "user_id": 3520302, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04739e687249e6e8b5548fd7ad29f9fb?s=128&d=identicon&r=PG&f=1", "display_name": "PedroCunha_67677", "link": "https://stackoverflow.com/users/3520302/pedrocunha-67677"}, "edited": false, "score": 0, "creation_date": 1502913673, "post_id": 45721003, "comment_id": 78402123, "body": "No, the collection only has 3 elements, as these are the three strings I want to output. The message states &quot;There is one or more circular references&quot; After toggling on Iterative Computation it provides a Value Error"}, {"owner": {"reputation": 1822, "user_id": 624292, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4fd8cadbf9c2cf573b13c7f53fc5fd43?s=128&d=identicon&r=PG", "display_name": "M_Idrees", "link": "https://stackoverflow.com/users/624292/m-idrees"}, "edited": false, "score": 0, "creation_date": 1502940293, "post_id": 45721003, "comment_id": 78409692, "body": "@PedroCunha_67677, this is only a function, not complete code. Its hard to predict its behavior. Can you post complete code you are using ?"}, {"owner": {"reputation": 49, "user_id": 3520302, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04739e687249e6e8b5548fd7ad29f9fb?s=128&d=identicon&r=PG&f=1", "display_name": "PedroCunha_67677", "link": "https://stackoverflow.com/users/3520302/pedrocunha-67677"}, "edited": false, "score": 0, "creation_date": 1502959145, "post_id": 45721003, "comment_id": 78418143, "body": "I understood my error. Switching from a function to a Sub that is called when a certain cell is changed worked."}], "owner": {"reputation": 49, "user_id": 3520302, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04739e687249e6e8b5548fd7ad29f9fb?s=128&d=identicon&r=PG&f=1", "display_name": "PedroCunha_67677", "link": "https://stackoverflow.com/users/3520302/pedrocunha-67677"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502966020, "creation_date": 1502909667, "last_edit_date": 1502966020, "question_id": 45721003, "link": "https://stackoverflow.com/questions/45721003/excel-put-collection-values-in-worksheet", "title": "Excel Put Collection Values in Worksheet", "body": "<p>Currently I have a Collection that contains a set of distinct string values.\nWith this Collection I have to put it on the worksheet. \nWhat are the existing functional approaches for putting on each row, starting on the row the function was called a value from the collection?\nDoes it imply getting the cell the function is being called, and then iteratively, printing according to a row offset?.\nCan anyone provide any pointers for this case?</p>\n\n<p>The complete process would imply the following input:</p>\n\n<pre><code>0\n0\n0\nTestString1.c\nTestString2.h\nTestString1.c, TestString2.h\n0\n0\nxmlString\n0\n</code></pre>\n\n<p>From this the collection with the distinct tokens, different from 0 is created.</p>\n\n<p>(Problem starts here)\nThe desired output would be to print </p>\n\n<pre><code>TestString1.c\nTestString2.h\nxmlString\n</code></pre>\n\n<p>One on each row starting on the cell the function is called.</p>\n\n<p>Current developed code:</p>\n\n<pre><code>Public Function BuildData(originRange As range)\nDim uniques As Collection\nDim source As range\nSet source = originRange\nSet uniques = GetUniqueValues(source.Value)\n\nDim currentRow As Integer\nDim currentColumn As Integer\ncurrentRow = ActiveCell.Row\ncurrentColumn = ActiveCell.Column\n\nDim pivot As Integer\nFor pivot = 0 To uniques.Count\n    Cells(currentRow + pivot, currentColumn).Value = uniques.Item(pivot + 1)\nNext pivot\nEnd Function\n</code></pre>\n\n<p>SOLUTION:</p>\n\n<p>The solution was to switch from function to sub.</p>\n"}, {"tags": ["vba", "excel", "variables", "vbe"], "comments": [{"owner": {"reputation": 77, "user_id": 7776500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f0039f052e5446b8e1701090777a3af?s=128&d=identicon&r=PG&f=1", "display_name": "mattbierwirth", "link": "https://stackoverflow.com/users/7776500/mattbierwirth"}, "edited": false, "score": 0, "creation_date": 1502909844, "post_id": 45720935, "comment_id": 78400328, "body": "After more research, I have found that if I do not include the st_line and en_line variables in the method, then they retain their values."}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 7776500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f0039f052e5446b8e1701090777a3af?s=128&d=identicon&r=PG&f=1", "display_name": "mattbierwirth", "link": "https://stackoverflow.com/users/7776500/mattbierwirth"}, "edited": false, "score": 1, "creation_date": 1502910222, "post_id": 45721043, "comment_id": 78400485, "body": "Ugh, how did I miss that? Thank you for actually interpreting the documentation!"}], "tags": [], "owner": {"reputation": 716, "user_id": 8468145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d93037f8271a7ae98fee7cad2debe0aa?s=128&d=identicon&r=PG&f=1", "display_name": "0liveradam8", "link": "https://stackoverflow.com/users/8468145/0liveradam8"}, "is_accepted": true, "score": 2, "last_activity_date": 1502918774, "last_edit_date": 1502918774, "creation_date": 1502909855, "answer_id": 45721043, "question_id": 45720935, "link": "https://stackoverflow.com/questions/45720935/codemodule-find-method-changes-value-of-variables-find-method-vba-add-in-object/45721043#45721043", "title": "CodeModule.Find Method changes value of variables (Find Method VBA Add-In Object Model)", "body": "<p>From the documentation for this topic:</p>\n\n<blockquote>\n  <p>startline Required. A Long specifying the line at which you want to start the search; will be set to the line of the match if one is found. The first line is number 1.</p>\n</blockquote>\n\n<p>It looks like VBC.CodeModule.Find is changing the startline. It affects the endline similarly:</p>\n\n<blockquote>\n  <p>endline Required. A Long specifying the last line of the match if one is found. The last line may be specified as 1.</p>\n</blockquote>\n\n<p>You'll have to use another pair of variables set to the same values, so change:</p>\n\n<pre><code>st_line = 5\nen_line = 100\nSet VBC = ThisWorkbook.VBProject.VBComponents(\"ThisWorkbook\")\n\n***If VBC.CodeModule.Find(search_String, st_line, 1, en_line, 500) = True Then\n    MsgBox \"Found our target.\"\nEnd If\n</code></pre>\n\n<p>to</p>\n\n<pre><code>st_line = 5\nen_line = 100\n' temporary variables\ntemp_st_line = st_line\ntemp_en_line = en_line\nSet VBC = ThisWorkbook.VBProject.VBComponents(\"ThisWorkbook\")\n\n***If VBC.CodeModule.Find(search_String, temp_st_line, 1, temp_en_line, 500) = True Then\n    MsgBox \"Found our target.\"\nEnd If\n</code></pre>\n\n<p>Source: <a href=\"https://msdn.microsoft.com/en-us/library/aa443952(v=vs.60).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/aa443952(v=vs.60).aspx</a></p>\n"}], "owner": {"reputation": 77, "user_id": 7776500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f0039f052e5446b8e1701090777a3af?s=128&d=identicon&r=PG&f=1", "display_name": "mattbierwirth", "link": "https://stackoverflow.com/users/7776500/mattbierwirth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1514, "favorite_count": 0, "accepted_answer_id": 45721043, "answer_count": 1, "score": 0, "last_activity_date": 1502918774, "creation_date": 1502909440, "last_edit_date": 1531164843, "question_id": 45720935, "link": "https://stackoverflow.com/questions/45720935/codemodule-find-method-changes-value-of-variables-find-method-vba-add-in-object", "title": "CodeModule.Find Method changes value of variables (Find Method VBA Add-In Object Model)", "body": "<p>I am trying to search the current <code>VBProject</code> for instances of procedure names. To do this, I am using the <code>CodeModule.Find</code> method (details <a href=\"https://msdn.microsoft.com/en-us/library/aa443952(v=vs.60).aspx\" rel=\"nofollow noreferrer\">here</a>), which asks for:  </p>\n\n<ul>\n<li>A search term (I am supplying a <code>string</code> variable)</li>\n<li>the start line (I am supplying a <code>long</code> variable)</li>\n<li>the start column (I use column 1)</li>\n<li>the end line (I am supplying a <code>long</code> variable), and</li>\n<li>the end column (I use column 500).</li>\n</ul>\n\n<p>For some reason, every time I call this method, it changes the value of both the <code>st_line</code> and <code>en_line</code> variables to different numbers. In the simple example I am providing, it doesn't seem like I need to use these numbers more than once, but in my application I do, and the method keeps changing them!</p>\n\n<p>Code:</p>\n\n<pre><code>Sub Find_Method_Changes_Var_Values()\n\n    Dim st_line As Long, en_line As Long\n    Dim search_String As String\n    Dim VBC As VBIDE.VBComponent\n\n    search_String = \"Sub\"\n    st_line = 5\n    en_line = 100\n    Set VBC = ThisWorkbook.VBProject.VBComponents(\"ThisWorkbook\")\n\n    ***If VBC.CodeModule.Find(search_String, st_line, 1, en_line, 500) = True Then\n        MsgBox \"Found our target.\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Once the line with three asterisks in front of it is run (whether or not it actually finds the string we're searching for), the values of <code>st_line</code> and <code>en_line</code> are both changed to <code>20</code>.</p>\n\n<p>What it seems like the method is doing is changing the <code>st_line</code> and <code>en_line</code> variables to the line where the method finds the first instance of the search term.</p>\n\n<p>How can I both use this method and preserve my variable values?</p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2013"], "answers": [{"tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": false, "score": 0, "last_activity_date": 1502909863, "creation_date": 1502909863, "answer_id": 45721050, "question_id": 45720924, "link": "https://stackoverflow.com/questions/45720924/vba-in-access-prompt-for-input-to-select-report-to-print/45721050#45721050", "title": "VBA in Access: Prompt for input to select report to print", "body": "<p>You can use an input box to ask the user to select a number to reference a report.  Example of how to accomplish this is below.</p>\n\n<pre><code>Dim iAnswer\n\niAnswer = InputBox(\"Enter in the number of the report you want to run\" &amp; vbCrLf &amp; vbCrLf &amp; \"1) ReportName1\" &amp; vbCrLf &amp; \"2) ReportName2\")\n    If iAnswer = 1 Then\n        'run macro to produce report 1\n    Else\n        If iAnswer = 2 Then\n            'run macro to produce report 2\n        Else\n            MsgBox \"Not a valid report selection\"\n        End If\n    End If\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6484512, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/107748a107abb72936ca5419bec96b4f?s=128&d=identicon&r=PG&f=1", "display_name": "AmandaNicole", "link": "https://stackoverflow.com/users/6484512/amandanicole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 444, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502909863, "creation_date": 1502909392, "question_id": 45720924, "link": "https://stackoverflow.com/questions/45720924/vba-in-access-prompt-for-input-to-select-report-to-print", "title": "VBA in Access: Prompt for input to select report to print", "body": "<p>I am working with an Access database and have VBA I've written for a user to update a database and then print the resulting report to PDF.  I now want to allow an option to print one of two reports, depending on which one the user selects to run.</p>\n\n<p>I know I will have to prompt for user input, ideally via drop-down list (which I haven't figured out how to do, but Google seems to indicate it's do-able).  My question is how to get the code to execute the open report based on what the input is.</p>\n\n<p>I have two thoughts about this - I can either write it all in VBA where the printed report depends on what is selected, or the prompt can be tied to run one of two macros that will then execute the report.  Any advice on how to write the code to allow for user input would be appreciated - or if I'm thinking about this totally backwards, I'd appreciate any alternate suggestions.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6833, "user_id": 240564, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/U17en.png?s=128&g=1", "display_name": "Alexan", "link": "https://stackoverflow.com/users/240564/alexan"}, "edited": false, "score": 0, "creation_date": 1502909139, "post_id": 45720798, "comment_id": 78400020, "body": "what did you try?"}, {"owner": {"reputation": 29, "user_id": 8474194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f76bbdfef5674c2d7bdab4cb83f6e5a?s=128&d=identicon&r=PG&f=1", "display_name": "U.Ch", "link": "https://stackoverflow.com/users/8474194/u-ch"}, "reply_to_user": {"reputation": 6833, "user_id": 240564, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/U17en.png?s=128&g=1", "display_name": "Alexan", "link": "https://stackoverflow.com/users/240564/alexan"}, "edited": false, "score": 0, "creation_date": 1503000693, "post_id": 45720798, "comment_id": 78445690, "body": "I am trying nested for loops to start at a row, go through columns, identify which is the first non-blank empty column, copy the contents of that column and paste them to the first column for that row. Then do the same for next row. I have figured out how to loop, but the bigger issue are the &quot;fake&quot; empty cells (copying data from a webpage), which can&#39;t be cleared using .ContentClear. Doing research to figure that out now. Any suggestions?"}, {"owner": {"reputation": 6833, "user_id": 240564, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/U17en.png?s=128&g=1", "display_name": "Alexan", "link": "https://stackoverflow.com/users/240564/alexan"}, "edited": false, "score": 0, "creation_date": 1503001520, "post_id": 45720798, "comment_id": 78446082, "body": "if you post your code, it can be helpful"}], "owner": {"reputation": 29, "user_id": 8474194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f76bbdfef5674c2d7bdab4cb83f6e5a?s=128&d=identicon&r=PG&f=1", "display_name": "U.Ch", "link": "https://stackoverflow.com/users/8474194/u-ch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502908779, "creation_date": 1502908779, "last_edit_date": 1531164843, "question_id": 45720798, "link": "https://stackoverflow.com/questions/45720798/moving-data-from-all-columns-to-column-a", "title": "Moving data from all columns to column A", "body": "<p><a href=\"https://i.stack.imgur.com/jfbsE.png\" rel=\"nofollow noreferrer\">Sample data</a></p>\n\n<p>I have data in the format as shown in the linked image. How can I go through each row and move the data to Column A? In the end, all data will appear only in Column A in the same order. </p>\n\n<p>Thanks in advance. </p>\n"}, {"tags": ["vba", "methods", "visio", "shapes"], "comments": [{"owner": {"reputation": 31, "user_id": 8441769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4017b5c885999712ee858be47da4e665?s=128&d=identicon&r=PG&f=1", "display_name": "wwla", "link": "https://stackoverflow.com/users/8441769/wwla"}, "edited": false, "score": 0, "creation_date": 1502909629, "post_id": 45720690, "comment_id": 78400233, "body": "i think my problem is not the code but rather my stencils. in fact, i changed the name of my shapes for example filage1 to filage1001 and im using the new names in my code.I think however visio call the shapes with their old name. Is it possible so visio calls the shapes with their new names?"}, {"owner": {"reputation": 687, "user_id": 7990528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gWVHp.png?s=128&g=1", "display_name": "Surrogate", "link": "https://stackoverflow.com/users/7990528/surrogate"}, "edited": false, "score": 0, "creation_date": 1502911987, "post_id": 45720690, "comment_id": 78401344, "body": "Read more about difference <a href=\"https://blogs.msdn.microsoft.com/visio/2006/07/27/name-and-nameu/\" rel=\"nofollow noreferrer\">Name and NameU</a>"}, {"owner": {"reputation": 31, "user_id": 8441769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4017b5c885999712ee858be47da4e665?s=128&d=identicon&r=PG&f=1", "display_name": "wwla", "link": "https://stackoverflow.com/users/8441769/wwla"}, "reply_to_user": {"reputation": 687, "user_id": 7990528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gWVHp.png?s=128&g=1", "display_name": "Surrogate", "link": "https://stackoverflow.com/users/7990528/surrogate"}, "edited": false, "score": 0, "creation_date": 1502971598, "post_id": 45720690, "comment_id": 78426957, "body": "@Surrogate Thanks a lot it worked!!!"}], "owner": {"reputation": 31, "user_id": 8441769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4017b5c885999712ee858be47da4e665?s=128&d=identicon&r=PG&f=1", "display_name": "wwla", "link": "https://stackoverflow.com/users/8441769/wwla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 220, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502908373, "creation_date": 1502908373, "question_id": 45720690, "link": "https://stackoverflow.com/questions/45720690/drop-method-not-working-vba-visio", "title": "Drop method not working (VBA,Visio)", "body": "<p>I need to drop a shape that i get from a masters. It was working really wwell, but wheni changed some names in my library it is not working anymore\nthis is what i did:</p>\n\n<pre><code>    ...\n    Case \"4\", \"5\", \"10\", \"1006\", \"1007\", \"1001\"\n    Set Filage =Application.ActiveDocument.Pages.Item(la_page).Drop(Application.Documents.Item(\"Controleur-e++.vssx\").Masters.ItemU(\"filage#\" &amp; CInt(final(5, 0, i))), x0, y0_i)\n</code></pre>\n\n<p>...\nwhere  la_page is a string that represents the page name</p>\n\n<p>final(5,0,i) is a string for example \"1001\"\nxo and y0_i are two numbers that set the position where i wanna drop the shape</p>\n\n<p>N.B: my shape name is filage#1001</p>\n\n<p>Thanks for your answers</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1502931169, "post_id": 45720565, "comment_id": 78407706, "body": "<a href=\"https://stackoverflow.com/questions/20541905/convert-matrix-to-3-column-table-reverse-pivot-unpivot-flatten-normal\" title=\"convert matrix to 3 column table reverse pivot unpivot flatten normal\">stackoverflow.com/questions/20541905/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 7226739, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-KJ8pzVlrOD8/AAAAAAAAAAI/AAAAAAAAGJ8/jxOROT-M2Qk/photo.jpg?sz=128", "display_name": "Jen sabbyATL", "link": "https://stackoverflow.com/users/7226739/jen-sabbyatl"}, "edited": false, "score": 0, "creation_date": 1502979565, "post_id": 45724837, "comment_id": 78432990, "body": "Hi!  Thanks for responding.  Sex and Age are actually calculated from other data, so they&#39;re formula not values.  I was worried about Vlookup because the number of rows in Sheet2 will change frequently.  Right now I have a button on Sheet2 that imports a CSV file that&#39;s output from Stata.  Then I essentially want to &quot;merge&quot; the age and sex aggregated data for Amount to this CSV file.  I could easily do this in Stata but I am trying to make an Excel &quot;calculator&quot; for folks I work with zero coding skills (even in something like Stata).  I&#39;ll see if I can make you suggestion work.  Thanks!"}, {"owner": {"reputation": 225, "user_id": 4025169, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nVb00.jpg?s=128&g=1", "display_name": "Jem Eripol", "link": "https://stackoverflow.com/users/4025169/jem-eripol"}, "reply_to_user": {"reputation": 89, "user_id": 7226739, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-KJ8pzVlrOD8/AAAAAAAAAAI/AAAAAAAAGJ8/jxOROT-M2Qk/photo.jpg?sz=128", "display_name": "Jen sabbyATL", "link": "https://stackoverflow.com/users/7226739/jen-sabbyatl"}, "edited": false, "score": 0, "creation_date": 1503013982, "post_id": 45724837, "comment_id": 78450497, "body": "If I get your problem here, your range in vlookup is &quot;not fixed&quot;, right? If the number of columns is fixed and the number of row is not, you can specify the number of rows by making the program look for the bottom row such that  <code>Dim iRow As Long</code>     <code>Dim ws As Worksheet</code>     <code>Set ws = Worksheets(&quot;1&quot;)</code>     <code>Dim wbSource As Workbook</code>     <code>iRow = ws.Cells.Find(What:=&quot;*&quot;, SearchOrder:=xlRows, _</code>     <code>SearchDirection:=xlPrevious, LookIn:=xlValues).row + 1</code>"}, {"owner": {"reputation": 344, "user_id": 1134623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49cbe1fd6ccd8927321e1cca48987ab?s=128&d=identicon&r=PG", "display_name": "Erin Halbmaier", "link": "https://stackoverflow.com/users/1134623/erin-halbmaier"}, "edited": false, "score": 1, "creation_date": 1503015343, "post_id": 45724837, "comment_id": 78450835, "body": "You can also find the last row by <code>lastrow = ws.UsedRange.Rows (ws.UsedRange.Rows.Count).Row</code> instead of using Find.  Or better yet, after importing the data, turn it into a table and use structured references so you don&#39;t have to worry about the last row and could even just have formulas on the aggregate sheet instead of filling it with VBA. :-)"}, {"owner": {"reputation": 225, "user_id": 4025169, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nVb00.jpg?s=128&g=1", "display_name": "Jem Eripol", "link": "https://stackoverflow.com/users/4025169/jem-eripol"}, "edited": false, "score": 0, "creation_date": 1503015509, "post_id": 45724837, "comment_id": 78450871, "body": "Oh, this one last comment is better, i guess! :) thank you for suggesting."}], "tags": [], "owner": {"reputation": 225, "user_id": 4025169, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nVb00.jpg?s=128&g=1", "display_name": "Jem Eripol", "link": "https://stackoverflow.com/users/4025169/jem-eripol"}, "is_accepted": false, "score": 0, "last_activity_date": 1503013840, "last_edit_date": 1503013840, "creation_date": 1502929422, "answer_id": 45724837, "question_id": 45720565, "link": "https://stackoverflow.com/questions/45720565/vba-how-to-paste-values-from-2-d-table-in-one-sheet-into-column-of-another-she/45724837#45724837", "title": "VBA - How to paste values from 2-D table in one sheet into column of another sheet based on matching values", "body": "<p>One question is: Is \"Sex\" and \"Age\" manual inputs in the Sheet2?</p>\n\n<p>You might want to use the function:</p>\n\n<pre><code>Application.Worksheetfunction.Vlookup(...)\n</code></pre>\n\n<p>But of course, you need to set some type of identification for each Sheets such as :</p>\n\n<pre><code>Dim wSheet1 as Worksheet\nDim wSheet2 as Worksheet\nSet wSheet1 = Worksheets(\"Sheet1\")\nSet wSheet2 = Worksheets(\"Sheet2\")\n</code></pre>\n\n<p>Just like how you would use it in normal workbook.</p>\n\n<p>Example:</p>\n\n<pre><code>wSheet2.cells(\"A7\").value = \"1\" 'Note: You can improve this by looking at an empty row automatically with a code\nwSheet2.cells(\"B7\").value = application.worksheetfunction.vlookup(\"18-29\",wSheet1.Range(\"D4:F9\"),3,0)\n</code></pre>\n\n<p>You can improve the program to your liking by editing the search criteria \"18-29\"</p>\n\n<p>Cheers</p>\n"}], "owner": {"reputation": 89, "user_id": 7226739, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-KJ8pzVlrOD8/AAAAAAAAAAI/AAAAAAAAGJ8/jxOROT-M2Qk/photo.jpg?sz=128", "display_name": "Jen sabbyATL", "link": "https://stackoverflow.com/users/7226739/jen-sabbyatl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503013840, "creation_date": 1502907817, "question_id": 45720565, "link": "https://stackoverflow.com/questions/45720565/vba-how-to-paste-values-from-2-d-table-in-one-sheet-into-column-of-another-she", "title": "VBA - How to paste values from 2-D table in one sheet into column of another sheet based on matching values", "body": "<p>I am super inexperienced with VBA.  What I've accomplished with VBA I've picked up by Googling.  So, there's no depth, at all, to what I know.</p>\n\n<p>OK, here's what I have:</p>\n\n<p>In a workbook I have two sheets.  Lets call them Sheet1 and Sheet2.</p>\n\n<p>In Sheet1 I have this 2-D table, where the ###s are some value corresponding to the matching row and column labels:</p>\n\n<p>Age&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Males&nbsp;&nbsp;&nbsp;&nbsp;Females<br>\n18-29&nbsp;&nbsp;&nbsp;#####&nbsp;&nbsp;&nbsp;&nbsp;###### <br>\n30-44&nbsp;&nbsp;&nbsp;#####&nbsp;&nbsp;&nbsp;&nbsp;###### <br>\n45+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#####&nbsp;&nbsp;&nbsp;###### <br></p>\n\n<p>The cells for all of the above are D2:F5</p>\n\n<p>Now, in Sheet2 I have 3 columns: ID Age Sex which start at A7.  So, the headers are in A7, B7, C7</p>\n\n<p>You can probably see where I'm going with this.</p>\n\n<p>I have thousands of rows.</p>\n\n<p>I need to place the appropriate ### in column D7, with the header Amount based on matching values in Sex (B) and Age (C).</p>\n\n<p>So, if the cross-tab in Sheet1 had these values:</p>\n\n<p>Age&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Males&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Females<br>\n18-29&nbsp;&nbsp;&nbsp;123  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;456 <br>\n30-44&nbsp;&nbsp;&nbsp;789  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;101112 <br>\n45+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;131415&nbsp;&nbsp;&nbsp;161718 <br></p>\n\n<p>Then in Sheet2 I'd like to see:</p>\n\n<p>ID&nbsp;&nbsp;&nbsp;Sex&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Age&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Amount<br>\n1&nbsp;&nbsp;&nbsp;&nbsp;Female&nbsp;&nbsp;&nbsp;&nbsp;30-44&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;101112<br>\n2&nbsp;&nbsp;&nbsp;&nbsp;Male&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;18-29&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;123</p>\n\n<p>etc on down the column.</p>\n\n<p>And I don't have the slightest clue how to go about this.  My biggest VBA accomplishment so far is importing a CSV file into an active worksheet, so...</p>\n"}, {"tags": ["sql", "sql-server", "vba", "excel"], "comments": [{"owner": {"reputation": 521, "user_id": 3393660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f58173878ccf559da0e8f8116eff8055?s=128&d=identicon&r=PG&f=1", "display_name": "vintastic", "link": "https://stackoverflow.com/users/3393660/vintastic"}, "edited": false, "score": 1, "creation_date": 1502909405, "post_id": 45720340, "comment_id": 78400143, "body": "I don&#39;t believe you can create a query that goes against both a database and Excel at the same time.  You could however retrieve the data from each query into separate DataTables and merge the results."}, {"owner": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 3, "creation_date": 1502909569, "post_id": 45720340, "comment_id": 78400203, "body": "Might be better to insert your excel data into a table in SQL and then do a join there, rather than trying to join in the application."}, {"owner": {"reputation": 1, "user_id": 8472853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/289f462a2873c1cc1e9b19b6fc54440a?s=128&d=identicon&r=PG&f=1", "display_name": "TWeinrich", "link": "https://stackoverflow.com/users/8472853/tweinrich"}, "edited": false, "score": 0, "creation_date": 1502910280, "post_id": 45720340, "comment_id": 78400520, "body": "I don&#39;t know anything about actually inserting data into SQL. The data I am pulling is from my companies MRP system."}, {"owner": {"reputation": 1, "user_id": 8472853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/289f462a2873c1cc1e9b19b6fc54440a?s=128&d=identicon&r=PG&f=1", "display_name": "TWeinrich", "link": "https://stackoverflow.com/users/8472853/tweinrich"}, "edited": false, "score": 0, "creation_date": 1502910657, "post_id": 45720340, "comment_id": 78400710, "body": "Maybe I am going at this from the wrong angle. All I really need is to specify that the query pulls information based upon the contents of a column in the excel spreadsheet. I have a list of part numbers in the spreadsheet, and I want the query to only pull information on those part numbers. I have tried passing a string variable into a &quot;WHERE item_id IN(StringFromExcel), but I get a Type mismatch error as soon as the characters in the string reach 165 or greater."}, {"owner": {"reputation": 20094, "user_id": 1832636, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/03182c8b98caa6f9af95e4f4afd7c018?s=128&d=identicon&r=PG", "display_name": "Dan Bracuk", "link": "https://stackoverflow.com/users/1832636/dan-bracuk"}, "edited": false, "score": 0, "creation_date": 1502911293, "post_id": 45720340, "comment_id": 78400983, "body": "What is the datatype of the item_id field in the db?"}, {"owner": {"reputation": 593, "user_id": 3421419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar7RS.jpg?s=128&g=1", "display_name": "abraxascarab", "link": "https://stackoverflow.com/users/3421419/abraxascarab"}, "edited": false, "score": 0, "creation_date": 1502911302, "post_id": 45720340, "comment_id": 78400988, "body": "@TWeinrich: Test your <code>StringFromExcel</code> for length of 165.  If greater, create a <code>StringFromExcel2</code> and then add a <code>OR item_id IN(StringFromExcel2)</code> to your WHERE code.  It&#39;s sloppy, but it&#39;ll work.  Only you know the real size of your data."}, {"owner": {"reputation": 593, "user_id": 3421419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar7RS.jpg?s=128&g=1", "display_name": "abraxascarab", "link": "https://stackoverflow.com/users/3421419/abraxascarab"}, "edited": false, "score": 0, "creation_date": 1502911488, "post_id": 45720340, "comment_id": 78401070, "body": "@TWeinrich:  Also... I agree with those saying this should be done from the main SQL database.  But if your company doesn&#39;t give you access to writing your own procs there, you might want to see if they&#39;ll let you use Access and link your tables in there.  (Of course, you&#39;d then have to get your data back to Excel, but if the size of your tables are big enough and parameters of your project allow, it may be worth the trouble.)"}, {"owner": {"reputation": 1, "user_id": 8472853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/289f462a2873c1cc1e9b19b6fc54440a?s=128&d=identicon&r=PG&f=1", "display_name": "TWeinrich", "link": "https://stackoverflow.com/users/8472853/tweinrich"}, "edited": false, "score": 0, "creation_date": 1502911900, "post_id": 45720340, "comment_id": 78401296, "body": "The datatype for item_id is varchar"}, {"owner": {"reputation": 1, "user_id": 8472853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/289f462a2873c1cc1e9b19b6fc54440a?s=128&d=identicon&r=PG&f=1", "display_name": "TWeinrich", "link": "https://stackoverflow.com/users/8472853/tweinrich"}, "edited": false, "score": 0, "creation_date": 1502912005, "post_id": 45720340, "comment_id": 78401351, "body": "abraxascarab, I don&#39;t fully understand what you mean by that. How would that look as code?"}, {"owner": {"reputation": 1, "user_id": 8472853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/289f462a2873c1cc1e9b19b6fc54440a?s=128&d=identicon&r=PG&f=1", "display_name": "TWeinrich", "link": "https://stackoverflow.com/users/8472853/tweinrich"}, "reply_to_user": {"reputation": 593, "user_id": 3421419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar7RS.jpg?s=128&g=1", "display_name": "abraxascarab", "link": "https://stackoverflow.com/users/3421419/abraxascarab"}, "edited": false, "score": 0, "creation_date": 1502913549, "post_id": 45720340, "comment_id": 78402063, "body": "@abraxascarab: The odds are very slim that they would give me that kind of access. Could you please explain what you meant by the StringFromExcel2 segment you posted? What would the content of that string be?"}, {"owner": {"reputation": 593, "user_id": 3421419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar7RS.jpg?s=128&g=1", "display_name": "abraxascarab", "link": "https://stackoverflow.com/users/3421419/abraxascarab"}, "edited": false, "score": 0, "creation_date": 1502914900, "post_id": 45720340, "comment_id": 78402751, "body": "@TWeinrich:  If you are making a comma delimited string for <code>StringFromExcel</code>, you need to end it before it&#39;s bigger than 165.  You can then continue a new string with the remaining part numbers in <code>StringFromExcel2</code>.  (And theoretically, you may need a 3rd, 4th or 5th)  Then you can add the appropriate <code>OR</code> statements to include the remaining part numbers.  Does that make sense?  Also, I don&#39;t see your code with the IN function, this would be easy for me or others to explain with the code. :)"}, {"owner": {"reputation": 1, "user_id": 8472853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/289f462a2873c1cc1e9b19b6fc54440a?s=128&d=identicon&r=PG&f=1", "display_name": "TWeinrich", "link": "https://stackoverflow.com/users/8472853/tweinrich"}, "reply_to_user": {"reputation": 593, "user_id": 3421419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar7RS.jpg?s=128&g=1", "display_name": "abraxascarab", "link": "https://stackoverflow.com/users/3421419/abraxascarab"}, "edited": false, "score": 0, "creation_date": 1502916036, "post_id": 45720340, "comment_id": 78403211, "body": "@abraxascarab I attached the code above, and thank you for the help."}], "answers": [{"tags": [], "owner": {"reputation": 865, "user_id": 4382823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1964d838044b41cd1e72e4708159086?s=128&d=identicon&r=PG&f=1", "display_name": "Whirl Mind", "link": "https://stackoverflow.com/users/4382823/whirl-mind"}, "is_accepted": false, "score": 0, "last_activity_date": 1502918271, "creation_date": 1502918271, "answer_id": 45723149, "question_id": 45720340, "link": "https://stackoverflow.com/questions/45720340/vba-query-that-pulls-data-from-both-excel-table-and-sql-database/45723149#45723149", "title": "VBA Query that pulls data from both excel table and SQL database", "body": "<p>Run your Excel query. </p>\n\n<p>Loop through the result set and build a list of OR conditions, such as item_id = 'ABC' Or item_id = 'PQR' and so on. </p>\n\n<p>Instead of using an IN condition, use the (huge) list of OR conditions in a single large string. </p>\n\n<p>Concatenate this list of OR conditions with rest of your query as Criterion for your database query. </p>\n\n<p>While the length of an IN phrase may have a restriction, the length of the complete SQL statement may be <a href=\"https://stackoverflow.com/questions/1869753/maximum-size-for-a-sql-server-query-in-clause-is-there-a-better-approach\">higher</a>. </p>\n\n<p>Of course, if the no. of customers going to appear in your query is too large, this will have unexpected issues depending on how large it is. </p>\n"}, {"tags": [], "owner": {"reputation": 593, "user_id": 3421419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar7RS.jpg?s=128&g=1", "display_name": "abraxascarab", "link": "https://stackoverflow.com/users/3421419/abraxascarab"}, "is_accepted": false, "score": 1, "last_activity_date": 1502983177, "last_edit_date": 1502983177, "creation_date": 1502982038, "answer_id": 45738636, "question_id": 45720340, "link": "https://stackoverflow.com/questions/45720340/vba-query-that-pulls-data-from-both-excel-table-and-sql-database/45738636#45738636", "title": "VBA Query that pulls data from both excel table and SQL database", "body": "<p>Yikes... some of that code is... let's call it unique.  But I won't ask questions, lets just deal with the problem you are asking about for now.</p>\n\n<p>The goal is to check your long Items string so you only need one Sql command to grab your data.  But the string needs to be in chunks less than 165 characters.</p>\n\n<p>As I mentioned before, this is a sloppy way to do it, but if they have you locked out of your SQL database for development purposes, this approach will work:</p>\n\n<p>You can split your Item string into multiple strings each less than 165 characters.  Then you can use <code>OR</code> statements in your SQL to use the <code>IN</code> function with each Item string that has data.</p>\n\n<p>First, in your VBA, you need to:</p>\n\n<pre><code>'Delcare your Variables\n\nDim SQLText As String\nDim Items2 As String\nDim Items3 As String\nDim boolItemFlag2 As Boolean\nDim boolItemFlag3 As Boolean\nDim i As Integer\n\n' Initialize Variables\n\nboolItemFlag2 = False\nboolItemFlag3 = False\n</code></pre>\n\n<p>Then you can do your processing to build your 'Items' string.  I'm assuming it's comma delimited something like this:</p>\n\n<pre><code>Items = \"'123456','234567'\"\n</code></pre>\n\n<p>After it's built you can:</p>\n\n<pre><code>' Get your Items list and check for length over 164\n\nIf Not IsNull(Len(Items)) Then\n   If Len(Items) &gt; 164 Then\n      boolItemFlag2 = True\n      i = 0\n\n      ' Find last comma delimiter before the cut off of 164\n\n      While (Mid(Items, 164 - i, 1) &lt;&gt; \",\")\n         i = i + 1\n      Wend\n\n      ' Set Items2 to everything after the last comma (before pos 164).  Then Left Trim away possible spaces.\n\n      Items2 = LTrim(Mid(Items, 164 - i + 1, Len(Items) - 164 + i))\n\n      ' Reset Items to everything up to that comma we found but not including it.\n\n      Items = Left(Items, 164 - i - 1)\n\n      ' Your Item list is now split into 2 different string variables\n\n   End If\nEnd If\n\nIf Not IsNull(Len(Items2)) Then\n   If Len(Items2) &gt; 164 Then\n      boolItemFlag3 = True\n      ' Use the same logic above to split Items2 into the Items3 variable.\n      ' You may need to duplicate again for Items4 etc if your Item List is huge.\n      ' If you'd need beyond Items5, I'd probably go back to the two query approach.\n      ' But it's your choice.\n   End If\nEnd If\n</code></pre>\n\n<p>Then, after you have your Item lists split into variables that are each small enough, you can build a unique SQL string (called SQLText) and insert <code>OR</code> statements to include items strings that have data:</p>\n\n<pre><code>' Build your SQL String Here (after you have determined how many item strings you have)\n\nSQLText = \"SELECT DISTINCT p21_view_item_uom.item_id, p21_view_item_uom.unit_of_measure, p21_view_item_uom.purchasing_unit\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n     \"FROM OEM.dbo.p21_view_item_uom p21_view_item_uom\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n     \"WHERE (p21_view_item_uom.item_id In (\" _\n     &amp; _                  ' &lt;-- I changed your comma into an &amp; because I have no clue...\n     \"\" &amp; Items &amp; \")\"\n\nIf boolItemFlag2 Then   ' Add this OR statement if Items2 has data\n     SQLText = SQLText &amp; \" OR p21_view_item_uom.item_id In (\" &amp; Items2 &amp; \")\"\nEnd If\n\nIf boolItemFlag3 Then   ' Add this OR statement if Items3 has data\n     SQLText = SQLText &amp; \" OR p21_view_item_uom.item_id In (\" &amp; Items3 &amp; \")\"\nEnd If\n\n' Add more OR statements if you have Item lists beyond 3.\n\n' Now tack on your remaining SQL code:\n\nSQLText = SQLText &amp; \") AND (p21_view_item_uom.delete_flag='N')\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n     \"ORDER BY p21_view_item_uom.purchasing_unit DESC\"\n</code></pre>\n\n<p>Now the String SQLText will have your complete SQL code that you want to send to the server.  You can execute this message box if you want to verify the string is correct:</p>\n\n<pre><code>MsgBox SQLText\n</code></pre>\n\n<p>You need to make one more modification.  When you call the database, you need to put the variable SQLText into the commandtext array (in place of your old code):</p>\n\n<pre><code>' Now you can put your SQLText variable into your ODBC call:\n\nWith Selection.ListObject.QueryTable\n    .Connection = _\n\"ODBC;DSN=OEM;Description=OEM;UID=trevor.weinrich;Trusted_Connection=Yes;APP=Microsoft Office 2016;WSID=DFP-OEM-0913-A;DATABASE=OEM\"\n    .CommandText = Array(SQLText)\n    .Refresh BackgroundQuery:=False\nEnd With\n</code></pre>\n\n<p>Hope that helps :)</p>\n"}], "owner": {"reputation": 1, "user_id": 8472853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/289f462a2873c1cc1e9b19b6fc54440a?s=128&d=identicon&r=PG&f=1", "display_name": "TWeinrich", "link": "https://stackoverflow.com/users/8472853/tweinrich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 627, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1502983177, "creation_date": 1502906898, "last_edit_date": 1531164843, "question_id": 45720340, "link": "https://stackoverflow.com/questions/45720340/vba-query-that-pulls-data-from-both-excel-table-and-sql-database", "title": "VBA Query that pulls data from both excel table and SQL database", "body": "<p>I have been working on this for quite a while and I can't seem to figure it out. I am trying to create a query in excel that combines information from an excel table and database. I can do each of them separately no problem. </p>\n\n<p>Here is the VBA code for the excel query:</p>\n\n<pre><code>    Sub ExcelQuery()\n'\n    Range(\"Table_Query_from_Excel_Files5[[#Headers],[Customer:]]\").Select\n    With Selection.ListObject.QueryTable\n        .Connection = Array(Array(\"ODBC;DSN=Excel Files;DBQ=Z:\\OEM Office\\Trevor Weinrich\\Projects\\BOM Template 2.0\\BOM template 2017-08-16 1.xlsm;DefaultDir=Z:\\OEM Office\\Trevor Weinrich\\Projects\\BOM Template 2.0;DriverId=1046;MaxBufferSize=2048;PageTimeout=5;\"))\n        .CommandText = Array( _\n        \"SELECT `BOM$`.`Customer:`\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"FROM `BOM$` `BOM$`\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"WHERE (`BOM$`.`Customer:` Is Not Null)\" _\n        )\n        .Refresh BackgroundQuery:=False\n    End With\n'\nEnd Sub\n</code></pre>\n\n<p>And here is the VBA code for the database query:</p>\n\n<pre><code>Sub DatabaseQuery()\n'\n    With Selection.ListObject.QueryTable\n        .Connection = _\n        \"ODBC;DSN=OEM;Description=OEM;UID=trevor.weinrich;Trusted_Connection=Yes;APP=Microsoft Office 2016;WSID=DFP-OEM-0913-A;DATABASE=OEM\"\n        .CommandText = Array( _\n        \"SELECT DISTINCT p21_view_item_uom.item_id, p21_view_item_uom.unit_of_measure, p21_view_item_uom.purchasing_unit\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"FROM OEM.dbo.p21_view_item_uom p21_view_item_uom\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"WHERE (p21_view_item_uom.delete_flag=\" _\n        , \"'N')\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"ORDER BY p21_view_item_uom.item_id\")\n        .Refresh BackgroundQuery:=False\n    End With\n'\nEnd Sub\n</code></pre>\n\n<p>I want to join these together because there are about 140,000 line items in the database query, and I only care about the the instances where the \"item_id\" field from the database matches up with the \"Customer:\" field.\nI just can't figure out how to join the two of them. I would greatly appreciate the help.</p>\n\n<p>Here is the code where I am just trying to pull in a variable that gives me the error after 165 characters:</p>\n\n<pre><code>Sub Update_Item_Tables()\n'\n' UOM_Update Macro\n'\nDim Items As String\nItems = Sheets(\"UOM\").Range(\"K1\").Value\n\n    Sheets(\"UOM\").Visible = True\n    Sheets(\"UOM\").Select\n    Range(\"Table_Query_from_OEM[[#Headers],[item_id]]\").Select\n    With Selection.ListObject.QueryTable\n        .Connection = _\n        \"ODBC;DSN=OEM;Description=OEM;UID=trevor.weinrich;Trusted_Connection=Yes;APP=Microsoft Office 2016;WSID=DFP-OEM-0913-A;DATABASE=OEM\"\n        .CommandText = Array( _\n        \"SELECT DISTINCT p21_view_item_uom.item_id, p21_view_item_uom.unit_of_measure, p21_view_item_uom.purchasing_unit\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n        \"FROM OEM.dbo.p21_view_item_uom p21_view_item_uom\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n        \"WHERE (p21_view_item_uom.item_id In (\" _\n        , _\n        \"\" &amp; Items &amp; \")) AND (p21_view_item_uom.delete_flag='N')\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; _\n        \"ORDER BY p21_view_item_uom.purchasing_unit DESC\" _\n        )\n        .Refresh BackgroundQuery:=False\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "excel", "integration"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1502903950, "post_id": 45719413, "comment_id": 78397314, "body": "Whilst it is feasible it is not sensible. Also, SO isn&#39;t a code writing service. Do some research if you want help"}, {"owner": {"reputation": 165, "user_id": 3921013, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/100007193341974/picture?type=large", "display_name": "Joel Sinofsky", "link": "https://stackoverflow.com/users/3921013/joel-sinofsky"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1502904159, "post_id": 45719413, "comment_id": 78397445, "body": "Why isnt it sensible, also this isnt the code I need to write. I&#39;m trying to make the link from excel to SQL."}, {"owner": {"reputation": 875, "user_id": 6698273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/29c77a7034e4def459c75c7fa1ee5e7d?s=128&d=identicon&r=PG&f=1", "display_name": "BlooB", "link": "https://stackoverflow.com/users/6698273/bloob"}, "edited": false, "score": 0, "creation_date": 1502905063, "post_id": 45719413, "comment_id": 78397958, "body": "why not add, and save in a cell with VBA than quary the result?"}, {"owner": {"reputation": 165, "user_id": 3921013, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/100007193341974/picture?type=large", "display_name": "Joel Sinofsky", "link": "https://stackoverflow.com/users/3921013/joel-sinofsky"}, "reply_to_user": {"reputation": 875, "user_id": 6698273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/29c77a7034e4def459c75c7fa1ee5e7d?s=128&d=identicon&r=PG&f=1", "display_name": "BlooB", "link": "https://stackoverflow.com/users/6698273/bloob"}, "edited": false, "score": 0, "creation_date": 1502905216, "post_id": 45719413, "comment_id": 78398043, "body": "@dirty_feri this is an example of something I wish to do, if I add it in SQL I can generalize the concept"}, {"owner": {"reputation": 20094, "user_id": 1832636, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/03182c8b98caa6f9af95e4f4afd7c018?s=128&d=identicon&r=PG", "display_name": "Dan Bracuk", "link": "https://stackoverflow.com/users/1832636/dan-bracuk"}, "edited": false, "score": 3, "creation_date": 1502905257, "post_id": 45719413, "comment_id": 78398061, "body": "The correct tool for what you are looking to accomplish is VBA.  If you are not very proficient at it, improve."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 2, "creation_date": 1502905750, "post_id": 45719413, "comment_id": 78398316, "body": "Because you can do all of this in Excel. Why complicate it?"}, {"owner": {"reputation": 875, "user_id": 6698273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/29c77a7034e4def459c75c7fa1ee5e7d?s=128&d=identicon&r=PG&f=1", "display_name": "BlooB", "link": "https://stackoverflow.com/users/6698273/bloob"}, "edited": false, "score": 0, "creation_date": 1502905906, "post_id": 45719413, "comment_id": 78398391, "body": "look here <a href=\"http://tomaslind.net/2013/12/26/export-data-excel-to-sql-server/\" rel=\"nofollow noreferrer\">tomaslind.net/2013/12/26/export-data-excel-to-sql-server</a>"}, {"owner": {"reputation": 165, "user_id": 3921013, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/100007193341974/picture?type=large", "display_name": "Joel Sinofsky", "link": "https://stackoverflow.com/users/3921013/joel-sinofsky"}, "edited": false, "score": 0, "creation_date": 1502906151, "post_id": 45719413, "comment_id": 78398520, "body": "because excel IS complicated, sql is much easier"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1502906306, "post_id": 45719413, "comment_id": 78398633, "body": "Excel isn&#39;t complicated. Learn to use it. Whoever maintainer inherits whatever code you&#39;ve built to solve this problem will curse you. I would. What you need is <code>=SUM($A$1:$A$3)</code> in cell <code>A4</code>, and you&#39;re done. You <i>are</i> taking something incredibly simple, and turning it into something incredibly complicated, for no reason whatsoever."}, {"owner": {"reputation": 1208, "user_id": 6020288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8ec0447a851c1655fac718ecfbbf7b3?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/6020288/brian"}, "edited": false, "score": 0, "creation_date": 1502909927, "post_id": 45719413, "comment_id": 78400367, "body": "This smells an awful lot like a school assignment to me..."}, {"owner": {"reputation": 165, "user_id": 3921013, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/100007193341974/picture?type=large", "display_name": "Joel Sinofsky", "link": "https://stackoverflow.com/users/3921013/joel-sinofsky"}, "edited": false, "score": 0, "creation_date": 1502910713, "post_id": 45719413, "comment_id": 78400735, "body": "Its not a school assignment...geez so much hate. Short answer - im a former DBA who just became a quant and these guys still have legacy VBA systems. They dont like them but arent taking the time to rewrite everything."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1502910912, "post_id": 45719413, "comment_id": 78400836, "body": "There&#39;s no hate here, just people trying to guide you away from creating an overly complex monstrosity and toward using the tools that are built into the software you&#39;re using. As a former DBA, figuring out a few Excel formulas and a smidgen of VBA should be pretty easy for you to handle."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1502911138, "post_id": 45719413, "comment_id": 78400933, "body": "<a href=\"https://technet.microsoft.com/en-us/library/ee692882.aspx\" rel=\"nofollow noreferrer\">technet.microsoft.com/en-us/library/ee692882.aspx</a> - what @FreeMan said. Use the right tools for the right job. SQL is a formidable hammer, but not everything is a nail, <i>especially</i> when you&#39;re sitting in front of a powerful tool such as Excel. I&#39;ve un-deleted my answer if you need it, hopefully for something MUCH more complicated than computing the sum of 3 cells, to justify the added complexity and inherent inefficiency of the solution."}, {"owner": {"reputation": 165, "user_id": 3921013, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/100007193341974/picture?type=large", "display_name": "Joel Sinofsky", "link": "https://stackoverflow.com/users/3921013/joel-sinofsky"}, "edited": false, "score": 0, "creation_date": 1502912035, "post_id": 45719413, "comment_id": 78401362, "body": "&quot;In order to do so, I am facing a couple of challenges and have simplified my problem to one easier to solve&quot;    Did nobody read my original statement? I&#39;m doing risk decomposition, but want to do it in sql. Obviously I am going to use it for more than summing three cells..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502912289, "post_id": 45719413, "comment_id": 78401484, "body": "I don&#39;t know what you&#39;re up to. But the point is whatever you&#39;re trying to do, if there&#39;s an Excel-native way to do it, it&#39;s going to be more efficient that way. If the Excel file is on a network share, consider scheduling an SSIS package to import the data into an actual SQL Server database, and then you don&#39;t have to worry about Excel anymore. I manage 4 SQL Server instances and do SSIS and SSRS on the daily, and I <i>think</i> I <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">know VBA pretty much inside out</a> (there&#39;s always surprises haha), and used Excel for 15 years... and I wouldn&#39;t do that."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 1, "creation_date": 1502926214, "post_id": 45719413, "comment_id": 78406669, "body": "You can get better charts outside of Excel. Python has better math libraries. SQL is better for big data and sets. C offers better performance. Latex can format text with more precision. None of them are built-in to Excel. Sometimes the best tool is the <i>available</i> tool. For better or worse, the world (particularly fin services/quant) runs on Excel, CSV files and VBA. It&#39;s not clear what algorithm you want to apply to your inputs, but unless the SQL is offloading computation to a server, SQL is unlikely the best approach to do it."}], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 3921013, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/100007193341974/picture?type=large", "display_name": "Joel Sinofsky", "link": "https://stackoverflow.com/users/3921013/joel-sinofsky"}, "edited": false, "score": 0, "creation_date": 1502912272, "post_id": 45720915, "comment_id": 78401478, "body": "Thank you for such a detailed answer. To be clear, like i stated in my original question &quot;I am facing a couple of challenges and have simplified my problem to one easier to solve&quot; so I was looking for a trivial computation to solve in this post."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1502963728, "post_id": 45720915, "comment_id": 78421430, "body": "You&#39;ve also just given your database a really easy point of sql injection"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 5, "last_activity_date": 1502911442, "last_edit_date": 1502911442, "creation_date": 1502909345, "answer_id": 45720915, "question_id": 45719413, "link": "https://stackoverflow.com/questions/45719413/manipulating-data-within-excel-using-sql/45720915#45720915", "title": "Manipulating data WITHIN excel using SQL", "body": "<p>Yes, it can be done. No, it <em>shouldn't</em> be done. If you need the sum of 3 cells, <em>compute the sum of 3 cells</em> - Excel has built-in functions <strong>specifically made for this</strong>.</p>\n\n<pre><code>=SUM(A1:A3)\n</code></pre>\n\n<p>Type that in <code>[A4]</code> and you'll get your sum <strong>without writing any code</strong>, in the <strong>most efficient way possible</strong>, and without surprising the Hell out of anyone looking at what you've done.</p>\n\n<hr>\n\n<p>Still not convinced? Okay. Have a seat, grab some pop-corn, and enjoy the ride.</p>\n\n<blockquote>\n  <p><em>read cells A1->A3 into a table object (call this x) using VBA</em></p>\n</blockquote>\n\n<p>Excel isn't a database, it doesn't have <em>tables</em> - not in the way you mean the word \"table\". But that's no showstopper.</p>\n\n<p>Say your workbook has 3 sheets, code-named <code>Sheet1</code>, <code>Sheet2</code> and <code>Sheet3</code> (that's the default anyway). So you have <code>Sheet1!A1:A3</code> populated with some numbers that you want to <code>SUM</code> up using <a href=\"/questions/tagged/sql\" class=\"post-tag\" title=\"show questions tagged &#39;sql&#39;\" rel=\"tag\">sql</a>, because... doesn't matter why, just <em>because</em>.</p>\n\n<p>Since we want the sum to be written into <code>Sheet1!A4</code>, we won't be using <code>Sheet1</code> as our \"table\" - rather we'll treat it as our output.</p>\n\n<p>So we'll copy <code>Sheet1!A1:A3</code> to <code>Sheet2</code>:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sheet2.Range(\"A1\").Value = \"Values\" 'our column header\nSheet1.Range(\"A1:A3\").Copy Sheet2.Range(\"A2\") 'our values\n</code></pre>\n\n<p>Next, we need something that can treat <code>Sheet2</code> as a \"table\", and execute SQL queries against it. So we'll set up an ADODB/OLEDB connection to <code>Sheet2</code>, execute the SQL query, get a <code>Recordset</code> object with the results, and then dump the value into <code>Sheet1!A4</code>.</p>\n\n<p>Sloppy late-bound code doing this would look like this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub OverkillSum()\n\n    Dim connection As Object\n    Set connection = CreateObject(\"ADODB.Connection\")\n    connection.Open \"Provider=Microsoft.Jet.OLEDB.4.0;\" &amp; _\n                    \"Data Source=\" &amp; ThisWorkbook.FullName &amp; \";\" &amp; _\n                    \"Extended Properties=\"\"Excel 8.0;HDR=Yes;\"\";\"\n\n    Dim recordset As Object\n    Set recordset = connection.Execute(\"SELECT SUM(Values) As Total FROM [Sheet2$]\")\n\n    Sheet1.Range(\"A4\").Value = recordset.Fields(\"Total\").Value\n    recordset.Close\n    connection.Close\n\nEnd Sub\n</code></pre>\n\n<p>Note that the connection string requires <code>ThisWorkbook.FullName</code>, so that won't work in a throw-away workbook that you haven't saved yet.</p>\n\n<p>Between what's above, and <code>=SUM(A1:A3)</code> in cell <code>A4</code>, the design decision <em>should</em> be a no-brainer.</p>\n\n<ul>\n<li>Late-bound calls get resolved at run-time. This is overhead that can be avoided by referencing the ADODB type library and using <code>ADODB.Connection</code> and <code>ADODB.Recordset</code> types instead of working with <code>Object</code> interfaces.</li>\n<li>Connection to the workbook is also extraneous run-time overhead.</li>\n<li>Querying the worksheet through OLEDB is absolutely not justified for computing the sum of 3 values.</li>\n<li>You need to remember to clean up your connections and recordsets!</li>\n<li>Don't do that.</li>\n<li>Just don't.</li>\n<li><code>Sheet1.Range(\"A4\").Value = Application.WorksheetFunction.Sum(Sheet1.Range(\"A1:A3\"))</code> is the one-liner equivalent of the native Excel worksheet function solution - that's still overkill, but at least it remains in the realm of Excel and doesn't involve flying to the Moon and back.</li>\n<li>Did I say <em>don't do that</em>?</li>\n</ul>\n\n<p>This type of solution <em>is</em> useful <strong>for other purposes</strong>, e.g. when you have a workbook laid out as a table, that contains information that should live in a database but somehow lives in an Excel worksheet, with so much data that opening it through <code>Workbooks.Open</code> and computing a complex aggregate (perhaps involving <code>WHERE</code> and <code>GROUP BY</code> clauses) would be inefficient with <code>SUMIFS</code> or other non-SQL means.</p>\n"}], "owner": {"reputation": 165, "user_id": 3921013, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/100007193341974/picture?type=large", "display_name": "Joel Sinofsky", "link": "https://stackoverflow.com/users/3921013/joel-sinofsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 556, "favorite_count": 0, "accepted_answer_id": 45720915, "answer_count": 1, "score": -2, "last_activity_date": 1502911442, "creation_date": 1502903464, "last_edit_date": 1531164843, "question_id": 45719413, "link": "https://stackoverflow.com/questions/45719413/manipulating-data-within-excel-using-sql", "title": "Manipulating data WITHIN excel using SQL", "body": "<p>I have an excel report I am working on which uses VBA to manipulate data. </p>\n\n<p>Although there isn't a reason I can't use VBA for my purposes, I would rather do it in SQL as I am much more proficient in that language. In order to do so, I am facing a couple of challenges and have simplified my problem to one easier to solve.</p>\n\n<p>Say I have a Excel spreadsheet with the number 1 in cell A1, 2 in cell A2, and 3 in cell A3. In cell A4 I am trying to sum these, resulting in the number 6.</p>\n\n<p>The SUM() function would get me the answer I would like, but not the way I want to go about it. </p>\n\n<p>Instead here is what I am trying to do...</p>\n\n<pre><code>1) read cells A1-&gt;A3 into a table object (call this x) using VBA\n2) declare a string variable and set it to 'SELECT SUM(column1) FROM x'\n3) execute that sql string\n4) store the results in cell A4\n</code></pre>\n\n<p>Is this a feasible way of going about things? If so, could an example be posted?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1502904172, "post_id": 45719305, "comment_id": 78397452, "body": "FYI - It&#39;s best to <a href=\"https://stackoverflow.com/questions/10714251/\">avoid using <code>.Select</code>/`.Activate</a>, it&#39;ll help cut down on your code and be more specific with your ranges.  Also, can you give some examples of the data you&#39;re copying in your post, instead of linking to an external worksheet?"}, {"owner": {"reputation": 537, "user_id": 6701520, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208341099860053/picture?type=large", "display_name": "Kevin S&#252;dmersen", "link": "https://stackoverflow.com/users/6701520/kevin-s%c3%bcdmersen"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1502961356, "post_id": 45719305, "comment_id": 78419671, "body": "Thank you very much for taking your time to help me out. I found the solution now (see answer below)."}], "answers": [{"comments": [{"owner": {"reputation": 537, "user_id": 6701520, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208341099860053/picture?type=large", "display_name": "Kevin S&#252;dmersen", "link": "https://stackoverflow.com/users/6701520/kevin-s%c3%bcdmersen"}, "edited": false, "score": 0, "creation_date": 1502961426, "post_id": 45724920, "comment_id": 78419723, "body": "Thank you very much for taking the time to help me out. There was a small problem with the lines of code that you provided, but your answer still helped me to answer my question! See the below code which is now working."}, {"owner": {"reputation": 225, "user_id": 4025169, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nVb00.jpg?s=128&g=1", "display_name": "Jem Eripol", "link": "https://stackoverflow.com/users/4025169/jem-eripol"}, "reply_to_user": {"reputation": 537, "user_id": 6701520, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208341099860053/picture?type=large", "display_name": "Kevin S&#252;dmersen", "link": "https://stackoverflow.com/users/6701520/kevin-s%c3%bcdmersen"}, "edited": false, "score": 0, "creation_date": 1503013476, "post_id": 45724920, "comment_id": 78450378, "body": "Yay. :) Good to hear. You are welcome. Please mark your question as answered if you feel it is already answered."}], "tags": [], "owner": {"reputation": 225, "user_id": 4025169, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nVb00.jpg?s=128&g=1", "display_name": "Jem Eripol", "link": "https://stackoverflow.com/users/4025169/jem-eripol"}, "is_accepted": false, "score": 0, "last_activity_date": 1502930104, "creation_date": 1502930104, "answer_id": 45724920, "question_id": 45719305, "link": "https://stackoverflow.com/questions/45719305/copying-values-applying-a-formula-and-pasting-the-results-as-values-all-operat/45724920#45724920", "title": "Copying values, applying a formula and pasting the results as values. All operations in different Sheets - VBA Macro Excel", "body": "<p>I cannot comment so i have to put it as answer.</p>\n\n<p>The problem i guess, is that your code is not specific to where <code>range</code> is selected. To improve your code, you might want to try:</p>\n\n<pre><code>dim wSheet1 as Workbook\ndim wSheet2 as Workbook\ndim wSheet3 as workbook\n\nset wSheet1 = Workbooks(\"Sheet1\")\nset wSheet2 = Workbooks(\"Sheet2\")\nset wSheet3 = Workbooks(\"Sheet3\")\n</code></pre>\n\n<p>then use:</p>\n\n<pre><code>wSheet1.Range(....)\n</code></pre>\n\n<p>to specify which sheet you are referring to rather than <code>.select</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 537, "user_id": 6701520, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208341099860053/picture?type=large", "display_name": "Kevin S&#252;dmersen", "link": "https://stackoverflow.com/users/6701520/kevin-s%c3%bcdmersen"}, "is_accepted": true, "score": 0, "last_activity_date": 1502961487, "creation_date": 1502961487, "answer_id": 45731140, "question_id": 45719305, "link": "https://stackoverflow.com/questions/45719305/copying-values-applying-a-formula-and-pasting-the-results-as-values-all-operat/45731140#45731140", "title": "Copying values, applying a formula and pasting the results as values. All operations in different Sheets - VBA Macro Excel", "body": "<p>Below code is now working: </p>\n\n<pre><code>Sub Macro1()\n\nDim i As Integer\nDim m As Integer\n\nDim wSheet1 As Worksheet\nDim wSheet2 As Worksheet\nDim wSheet3 As Worksheet\n\nSet wSheet1 = Sheets(\"Sheet1\")\nSet wSheet2 = Sheets(\"Sheet2\")\nSet wSheet3 = Sheets(\"Sheet3\")\n\nFor i = 1 To 52\n    'selecting the first, middle and last name (columns I to F)\n    m = i + 1\n    wSheet1.Range(\"F\" &amp; m &amp; \":I\" &amp; m).Copy\n    wSheet2.Range(\"B2\").PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n        False, Transpose:=True\n    ' Maybe give excel some time to calculate the email addresses first?\n    Application.Calculate\n    wSheet2.Range(\"G2:G47\").Copy\n    'Find the first empty cell in column A and paste as values\n    wSheet3.Range(\"A1\").End(xlDown).Offset(1, 0).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    'end of iteration\nNext i\n\n    ' code from the macro runner\n    'Range(\"F2:I2\").Select ' question is how to select the same range next time, only one row lower?\n    'Selection.Copy\n    'Sheets(\"Sheet2\").Select\n    ' pasting the name (as transpose)\n    'Range(\"B2\").Select\n    'Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n        False, Transpose:=True\n    ' selecting all the possible email addresses\n    'Range(\"G2\").Select ' shouldn't it be Range(\"G2:G47).Select ?\n    'Range(Selection, Selection.End(xlDown)).Select\n    'Application.CutCopyMode = False\n    'Selection.Copy\n    ' paste all possible email addresses as values into Sheet3\n    'Sheets(\"Sheet3\").Select\n    'Range(\"A1\").Select ' Question is how to select the first empty row in column A of that Sheet\n    'Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 537, "user_id": 6701520, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208341099860053/picture?type=large", "display_name": "Kevin S&#252;dmersen", "link": "https://stackoverflow.com/users/6701520/kevin-s%c3%bcdmersen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "accepted_answer_id": 45731140, "answer_count": 2, "score": 0, "last_activity_date": 1502961487, "creation_date": 1502903122, "question_id": 45719305, "link": "https://stackoverflow.com/questions/45719305/copying-values-applying-a-formula-and-pasting-the-results-as-values-all-operat", "title": "Copying values, applying a formula and pasting the results as values. All operations in different Sheets - VBA Macro Excel", "body": "<p>I am trying to create a Macro in Excel with VBA, that builds a bunch of different email addresses with a person's first, middle and last name and the company's email domain. I then want to verify these different email addresses with an email bulk tester which is another application. </p>\n\n<p>In Sheet1 I have the input data for the email addresses in the following columns: </p>\n\n<p>First names: F</p>\n\n<p>Middle names: G</p>\n\n<p>Last names: H</p>\n\n<p>Email domains: I</p>\n\n<p>Since there are 52 different persons whose email addresses I want to find, all the data is thus in cells F2:I53. </p>\n\n<p>On Sheet2 I would need to fill in the first, middle and last name as well as the email domain of each person separately in cells B2:B5. On the same Sheet, 46 different possible email addresses will be generated for each person in cells G2:G47. </p>\n\n<p>On Sheet3, I want to copy paste all 46 different email addresses as values. For the first person, I want to copy paste these 46 email addresses into cell A3. For the second person I want to copy paste them into cell A49, for the third person into cell A95, etc. Since I wanna do this for 52 persons, the last populated cell should be A2394.</p>\n\n<p>Here you can take a look at this table which I would normally have in excel:</p>\n\n<p><a href=\"https://docs.google.com/spreadsheets/d/1kWPfscdnz_TCS7K1H3to1rBgRzJ9XSBH8L7rjKhlTnc/edit?usp=sharing\" rel=\"nofollow noreferrer\">https://docs.google.com/spreadsheets/d/1kWPfscdnz_TCS7K1H3to1rBgRzJ9XSBH8L7rjKhlTnc/edit?usp=sharing</a></p>\n\n<p>Thus the macro is supposed to do the following in the first iteration: </p>\n\n<ol>\n<li><p>Select and copy cells F2:I2 on Sheet1</p></li>\n<li><p>Go to Sheet2 and special paste them (transpose) in cells B2:B5</p></li>\n<li><p>Select and copy cells G2:G47</p></li>\n<li><p>Go to Sheet3 and past them as values into cell A3</p></li>\n</ol>\n\n<p>In the second iteration, the macro is supposed to do the following: </p>\n\n<ol>\n<li><p>Select and copy cells F<strong>3</strong>:I<strong>3</strong> on Sheet1</p></li>\n<li><p>Go to Sheet2 and special paste them (transpose) in cells B2:B5</p></li>\n<li><p>Select and copy cells G2:G47</p></li>\n<li><p>Go to Sheet3 and past them as values into cell A<strong>49</strong></p></li>\n</ol>\n\n<p>As you can see in 1) and 2), the row number increments after every iteration. This whole process is thus to be repeated 52 times. Below, you can see the macro I have created</p>\n\n<pre><code>Sub Macro1()\nDim i As Integer\nDim m As Integer\nFor i = 1 To 52\n    'selecting the first, middle and last name (columns I to F)\n    m = i + 1\n    Range(\"F\" &amp; m &amp; \":I\" &amp; m).Select ' maybe I need to use the Indirect function here?\n    Selection.Copy\n    Sheets(\"Sheet2\").Select\n    Range(\"B2\").Select\n    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n        False, Transpose:=True\n    ' Maybe give excel some time to calculate the email addresses first?\n    Application.Calculate\n    Range(\"G2:G47\").Select\n    Selection.Copy\n    Sheets(\"Sheet3\").Select\n    'Find the first empty cell in column A\n    Range(\"A1\").End(xlDown).Offset(1, 0).Select\n    'pasting the email addresses as values\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    'end of iteration\nNext i\nEnd Sub\n</code></pre>\n\n<p>However, when I run the macro, the cells A3:A2394 on Sheet3 only contain the @ sign (see google sheet). Unfortunately, I have no idea where exactly the error occurs. My suspicion was that I need to give excel some time to calculate the 46 different email addresses in G2:G47 in Sheet2, so I added the \"Application.Calcuate\" command, but it also didn't work. </p>\n\n<p>Would be awesome if someone of you could help. </p>\n\n<p>Thanks in advance,\nKevin</p>\n"}, {"tags": ["excel", "paste", "vba"], "answers": [{"comments": [{"owner": {"reputation": 309, "user_id": 3981355, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/641886902/picture?type=large", "display_name": "Carlos Arronte Bello", "link": "https://stackoverflow.com/users/3981355/carlos-arronte-bello"}, "edited": false, "score": 0, "creation_date": 1502906159, "post_id": 45719552, "comment_id": 78398529, "body": "Thanks, but i have the same result. Like in the first image."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1502903948, "creation_date": 1502903948, "answer_id": 45719552, "question_id": 45719271, "link": "https://stackoverflow.com/questions/45719271/special-paste-in-excel-with-vba/45719552#45719552", "title": "Special paste in Excel with VBA", "body": "<p>The format of the <code>Range()</code> is incorrect.  </p>\n\n<p>Try:</p>\n\n<pre><code>Sheets(\"Extract\").Range(\"AI\" &amp; sourceRow).Copy Sheets(\"Print\").Range(\"H\" &amp; destRow + 7)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "is_accepted": true, "score": 2, "last_activity_date": 1502906888, "creation_date": 1502906888, "answer_id": 45720337, "question_id": 45719271, "link": "https://stackoverflow.com/questions/45719271/special-paste-in-excel-with-vba/45720337#45720337", "title": "Special paste in Excel with VBA", "body": "<p>Can you wrap the text in that cell? Something like this?</p>\n\n<pre><code>Sheets(\"Extract\").Range(\"AI\" &amp; sourceRow).Copy Sheets(\"Print\").Range(\"H\" &amp; destRow + 7).WrapText = True\n</code></pre>\n"}], "owner": {"reputation": 309, "user_id": 3981355, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/641886902/picture?type=large", "display_name": "Carlos Arronte Bello", "link": "https://stackoverflow.com/users/3981355/carlos-arronte-bello"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 45720337, "answer_count": 2, "score": 0, "last_activity_date": 1502906888, "creation_date": 1502903002, "last_edit_date": 1531161705, "question_id": 45719271, "link": "https://stackoverflow.com/questions/45719271/special-paste-in-excel-with-vba", "title": "Special paste in Excel with VBA", "body": "<p>I'm working on Excel with VBA. I need to copy and paste some information from one row to and specific destination. I'm using this code:</p>\n\n<pre><code>''CUSTOM MESSAGE \nSheets(\"Extract\").Range(\"AI\" &amp; sourceRow &amp; \"\").Copy Destination := \nSheets(\"Print\").Range(\"H\" &amp; destRow + 7 &amp; \"\")\n</code></pre>\n\n<p>The result of this code is: </p>\n\n<p><a href=\"https://i.stack.imgur.com/mGd8A.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mGd8A.jpg\" alt=\"Actual\"></a></p>\n\n<p>But I need something like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1jrEF.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1jrEF.jpg\" alt=\"Needed\"></a></p>\n\n<p>As you can see, I need to change to the next row, before going out of the table. \nAny idea?</p>\n"}, {"tags": ["vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 357, "user_id": 8053975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c700e5609f9cbe458f009d9e00092549?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Juneau", "link": "https://stackoverflow.com/users/8053975/robert-juneau"}, "edited": false, "score": 1, "creation_date": 1502905275, "post_id": 45719230, "comment_id": 78398072, "body": "can you show your table structure?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8472758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3b74eb957b651c9924be7177509d334?s=128&d=identicon&r=PG&f=1", "display_name": "jmonk", "link": "https://stackoverflow.com/users/8472758/jmonk"}, "edited": false, "score": 0, "creation_date": 1502903424, "post_id": 45719293, "comment_id": 78396994, "body": "HI TJ, thank you for the quick response. I copied and pasted that line of code and it still gives me the same error. Is there anything else I could try."}, {"owner": {"reputation": 640, "user_id": 3111723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78f6cc5dfdc3fff2278517e8ae2eb40f?s=128&d=identicon&r=PG&f=1", "display_name": "TJ Bandrowsky", "link": "https://stackoverflow.com/users/3111723/tj-bandrowsky"}, "reply_to_user": {"reputation": 3, "user_id": 8472758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3b74eb957b651c9924be7177509d334?s=128&d=identicon&r=PG&f=1", "display_name": "jmonk", "link": "https://stackoverflow.com/users/8472758/jmonk"}, "edited": false, "score": 1, "creation_date": 1502905541, "post_id": 45719293, "comment_id": 78398203, "body": "Quotes is your problem.   Try this:  <a href=\"http://access.mvps.org/access/general/gen0018.htm\" rel=\"nofollow noreferrer\">access.mvps.org/access/general/gen0018.htm</a>  And this one might be key:  <a href=\"http://www.utteraccess.com/forum/Dlookup-string-variable-t1148626.html\" rel=\"nofollow noreferrer\">utteraccess.com/forum/Dlookup-string-variable-t1148626.html</a>"}], "tags": [], "owner": {"reputation": 640, "user_id": 3111723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78f6cc5dfdc3fff2278517e8ae2eb40f?s=128&d=identicon&r=PG&f=1", "display_name": "TJ Bandrowsky", "link": "https://stackoverflow.com/users/3111723/tj-bandrowsky"}, "is_accepted": true, "score": 1, "last_activity_date": 1502962129, "last_edit_date": 1502962129, "creation_date": 1502903077, "answer_id": 45719293, "question_id": 45719230, "link": "https://stackoverflow.com/questions/45719230/dlookup-when-trying-use-form-field-as-criteria/45719293#45719293", "title": "DLookup When Trying Use Form Field as Criteria", "body": "<p>You need to have some quotes in there:</p>\n\n<pre><code>hypa = DLookup(\"[TestReport]\", \"TransformerPics\", \"TxID =  '\" &amp; [Reports]![TransformerInfoSheet]!TXID &amp; \"'\")\n</code></pre>\n\n<p>Please also see:</p>\n\n<ul>\n<li><a href=\"http://access.mvps.org/access/general/gen0018.htm\" rel=\"nofollow noreferrer\">DLookup Usage Samples</a></li>\n<li><a href=\"http://utteraccess.com/forum/Dlookup-string-variable-t1148626.html\" rel=\"nofollow noreferrer\">Dlookup using a string variable as criteria parameter</a></li>\n</ul>\n"}], "owner": {"reputation": 3, "user_id": 8472758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3b74eb957b651c9924be7177509d334?s=128&d=identicon&r=PG&f=1", "display_name": "jmonk", "link": "https://stackoverflow.com/users/8472758/jmonk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "accepted_answer_id": 45719293, "answer_count": 1, "score": 0, "last_activity_date": 1502962129, "creation_date": 1502902842, "last_edit_date": 1502906667, "question_id": 45719230, "link": "https://stackoverflow.com/questions/45719230/dlookup-when-trying-use-form-field-as-criteria", "title": "DLookup When Trying Use Form Field as Criteria", "body": "<p>I am new to Access and also to VB. I have a report that displays information on transformers, the report displays data from a query that queries data from two different tables. I would like to use a button to open a PDF document saved in one of the tables.</p>\n\n<p>The code I have so far is this:</p>\n\n<pre><code>Private Sub Command70_Click()\n\n    Dim hypa As String\n\n    hypa = DLookup(\"[TestReport]\", \"TransformerPics\", \"TxID =  \" &amp; [Reports]![TransformerInfoSheet]!TXID)\n\n    Application.FollowHyperlink [hypa]\n\nEnd Sub\n</code></pre>\n\n<p>The error i get is <code>Run-time error '2471' The expression you have entered as a parameter produced this error: 'TP00686'</code></p>\n\n<p>TP00686 is the transformer number that is displayed on the report.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502902932, "post_id": 45719152, "comment_id": 78396688, "body": "you do not need an array of monthnames. there is a built-in function you can use <code>monthname(10)</code>"}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1502906035, "post_id": 45719152, "comment_id": 78398452, "body": "Word&#39;s <code>Find</code> and <code>Selection</code> interact in complex ways, see e.g. <a href=\"http://gregmaxey.com/word_tip_pages/words_fickle_vba_find_property.html\" rel=\"nofollow noreferrer\">here</a>. It might help to move the selection back to the top of the document with <code>Selection.HomeKey Unit:=wdStory</code> at the start of the For loop."}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1502906293, "post_id": 45719152, "comment_id": 78398628, "body": "I don&#39;t think this is related to your problem, but you&#39;re using <code>Format</code> on text, when it should be used on a numeric value. I&#39;d recommend something like <code>myDate = CDate(.Text) + 7</code>, then <code>.Text = Format(myDate, &quot;mmmm d, yyyy&quot;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 6432960, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0100ea07f35861a9187917ec16a1a021?s=128&d=identicon&r=PG&f=1", "display_name": "my_work__account", "link": "https://stackoverflow.com/users/6432960/my-work-account"}, "edited": false, "score": 0, "creation_date": 1502984439, "post_id": 45724881, "comment_id": 78436671, "body": "This was able to select all the dates. The DateAdd function did not work for me though. It looks like I will have to change to &quot;mm/dd/yy&quot; format to mark a date as changed, then do a new search to reformat the dates. Thanks for your help!"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 7, "user_id": 6432960, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0100ea07f35861a9187917ec16a1a021?s=128&d=identicon&r=PG&f=1", "display_name": "my_work__account", "link": "https://stackoverflow.com/users/6432960/my-work-account"}, "edited": false, "score": 0, "creation_date": 1502985569, "post_id": 45724881, "comment_id": 78437432, "body": "what you want to do makes no sense. why do search twice? what version of ms word do you have?"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 7, "user_id": 6432960, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0100ea07f35861a9187917ec16a1a021?s=128&d=identicon&r=PG&f=1", "display_name": "my_work__account", "link": "https://stackoverflow.com/users/6432960/my-work-account"}, "edited": false, "score": 0, "creation_date": 1502985760, "post_id": 45724881, "comment_id": 78437555, "body": "saying <i>The DateAdd function did not work for me though.</i> does not give any information. what happened?"}, {"owner": {"reputation": 7, "user_id": 6432960, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0100ea07f35861a9187917ec16a1a021?s=128&d=identicon&r=PG&f=1", "display_name": "my_work__account", "link": "https://stackoverflow.com/users/6432960/my-work-account"}, "edited": false, "score": 0, "creation_date": 1503406284, "post_id": 45724881, "comment_id": 78593704, "body": "My understanding is that if you do not change the date to a different format, this code would continue to change the dates forever in a loop. The DateAdd function did not add 7 days - it did nothing."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 7, "user_id": 6432960, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0100ea07f35861a9187917ec16a1a021?s=128&d=identicon&r=PG&f=1", "display_name": "my_work__account", "link": "https://stackoverflow.com/users/6432960/my-work-account"}, "edited": false, "score": 0, "creation_date": 1503418247, "post_id": 45724881, "comment_id": 78602956, "body": "your dates are still in the long date format?  <i>August 16, 2017</i>"}, {"owner": {"reputation": 7, "user_id": 6432960, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0100ea07f35861a9187917ec16a1a021?s=128&d=identicon&r=PG&f=1", "display_name": "my_work__account", "link": "https://stackoverflow.com/users/6432960/my-work-account"}, "edited": false, "score": 0, "creation_date": 1503434477, "post_id": 45724881, "comment_id": 78611262, "body": "Your code changed all the dates to mm/dd/yy format, without adding 7 days to them."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 7, "user_id": 6432960, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0100ea07f35861a9187917ec16a1a021?s=128&d=identicon&r=PG&f=1", "display_name": "my_work__account", "link": "https://stackoverflow.com/users/6432960/my-work-account"}, "edited": false, "score": 0, "creation_date": 1503451135, "post_id": 45724881, "comment_id": 78616078, "body": "look at the line at bottom ` aaa.Parent.Text = ...`  does it have DateAdd ?  i think that i originally posted without a date add. the addition was done in  the debug.print line. i thought that you would spend some time examining the code, and you would put the dateAdd in yourself. i have since updated the code"}], "tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": true, "score": 0, "last_activity_date": 1502991783, "last_edit_date": 1502991783, "creation_date": 1502929759, "answer_id": 45724881, "question_id": 45719152, "link": "https://stackoverflow.com/questions/45719152/find-and-replace-dates-in-a-word-document-with-vba/45724881#45724881", "title": "Find and Replace Dates in a Word Document with VBA", "body": "<p>try this code</p>\n\n<pre><code>Sub findMe()\n\n    Dim aaa As Find\n    Dim i As Integer\n\n    For i = 1 To 12\n        Debug.Print MonthName(i)\n\n        Set aaa = ActiveDocument.Range(Start:=1, End:=1).Find    ' start at beginning of document\n\n        aaa.ClearFormatting\n        aaa.Replacement.ClearFormatting\n\n        aaa.Forward = True\n        aaa.Wrap = wdFindStop\n        aaa.Format = False\n        aaa.MatchCase = False\n        aaa.MatchWholeWord = False\n        aaa.MatchAllWordForms = False\n        aaa.MatchSoundsLike = False\n        aaa.MatchWildcards = True\n        aaa.Replacement.Text = \"\"\n\n        ' search text starts with any character so that upper case and lower case words are found .... july July\n        aaa.Text = \"?\" &amp; Mid(MonthName(i), 2, 20) &amp; \"[ ^t]{1,5}([0-9]{1,2}),[ ^t]{1,5}([0-9]{4})\"\n\n        Do While True\n            DoEvents\n            If Not aaa.Execute Then Exit Do                    ' find next\n\n            Debug.Print aaa.Parent.Text                        ' found text \n            Debug.Print Format(aaa.Parent.Text, \"mm/dd/yy\")    ' reformat date\n            Debug.Print DateAdd(\"d\", 7, aaa.Parent.Text)       ' add 7 days\n            Debug.Print Format(DateAdd(\"d\", 7, aaa.Parent.Text), \"mmmm dd, yyyy\")\n\n            ' aaa.Parent is the range object of the found text\n            ' so you can do this ...\n            aaa.Parent.Text = Format(DateAdd(\"d\", 7, aaa.Parent.Text), \"mm/dd/yy\")\n            aaa.Parent.Collapse Direction:=wdCollapseEnd           ' point to \"just after replaced text\"\n\n        Loop\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 6432960, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0100ea07f35861a9187917ec16a1a021?s=128&d=identicon&r=PG&f=1", "display_name": "my_work__account", "link": "https://stackoverflow.com/users/6432960/my-work-account"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1389, "favorite_count": 1, "accepted_answer_id": 45724881, "answer_count": 1, "score": 0, "last_activity_date": 1502991783, "creation_date": 1502902567, "question_id": 45719152, "link": "https://stackoverflow.com/questions/45719152/find-and-replace-dates-in-a-word-document-with-vba", "title": "Find and Replace Dates in a Word Document with VBA", "body": "<p>I am having an issue finding any date in the format \"August 16, 2017\" in the text of a Word document. Using ActiveDocument.Content.Find, I am only able to find results on the first page. Even within the first page, the results are inconsistent. Here is my code below.</p>\n\n<pre><code>Dim myMonth(1 To 12) As String\nmyMonth(1) = \"January\"\nmyMonth(2) = \"February\"\nmyMonth(3) = \"March\"\nmyMonth(4) = \"April\"\nmyMonth(5) = \"May\"\nmyMonth(6) = \"June\"\nmyMonth(7) = \"July\"\nmyMonth(8) = \"August\"\nmyMonth(9) = \"September\"\nmyMonth(10) = \"October\"\nmyMonth(11) = \"November\"\nmyMonth(12) = \"December\"\n\n'Find and replace dates in MMMM dd, yyyy format\nFor i = 12 To 1 Step -1\n    With ActiveDocument.Content\n    With .Find\n        .Text = \"(\" &amp; myMonth(i) &amp; \")\" &amp; \" ([0-9]{1,2}), ([0-9]{4})\"\n        .Replacement.Text = \"\"\n        .Forward = True\n        .Wrap = wdFindStop\n        .MatchWildcards = True\n    End With\n\n    While .Find.Execute\n        .Text = CDate(.Text) + 7\n        .Text = Format(.Text, \"mmmm d, yyyy\")\n\n    Wend\n        .Find.MatchWildcards = False\n    End With\n\n    Next i\n</code></pre>\n\n<p>This code adds 7 days to any date in said format. I have tried looping through all stories, and the result was the same. I have been able to perform this task for dates in the format \"08/16/2017\", so the problem seems to lie in the extra For loop for each month. Any help would be appreciated.</p>\n"}, {"tags": ["vba", "excel", "pdf"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 2, "creation_date": 1502900327, "post_id": 45718515, "comment_id": 78395227, "body": "So where do you get the error? :)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502915078, "post_id": 45718515, "comment_id": 78402828, "body": "^^ and what is the last thing printed by <code>Debug.Print myFile</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1502915941, "post_id": 45718784, "comment_id": 78403172, "body": "@YowE3K - it looks like I got 1 out of 3 correct :D"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1502901433, "last_edit_date": 1502901433, "creation_date": 1502901125, "answer_id": 45718784, "question_id": 45718515, "link": "https://stackoverflow.com/questions/45718515/excel-vba-run-time-error-5-invalid-procedure-call-or-argument/45718784#45718784", "title": "Excel VBA: Run Time Error 5 - Invalid Procedure Call or Argument", "body": "<p>Probably the error is here:\n<code>If myFile &lt;&gt; \"False\" Then</code></p>\n\n<p>I guess that it should be simply like this -> <code>If myFile Then</code> or <code>If len(myFile) &gt;8 Then</code></p>\n\n<hr>\n\n<p>However, the code looks working. Just try to rebuild it with Select Case, it looks way better and slightly faster:</p>\n\n<pre><code>Select Case strName\n    Case \"Macro\"\n        MsgBox \"That's all\"\n        Exit Sub\n    Case \"TOUCHPOINTS\"\n        strName = \"Touchpoints by markets\"\n    Case Else\n        Debug.Print \"I don't know -&gt; \"; strName\nEnd Select\n</code></pre>\n\n<p>Probably you will find the error then.</p>\n"}], "owner": {"reputation": 9777, "user_id": 2342399, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/da7b3bf63455228a889008a1cd76109a?s=128&d=identicon&r=PG", "display_name": "Boosted_d16", "link": "https://stackoverflow.com/users/2342399/boosted-d16"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2288, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1502915334, "creation_date": 1502900149, "last_edit_date": 1502915334, "question_id": 45718515, "link": "https://stackoverflow.com/questions/45718515/excel-vba-run-time-error-5-invalid-procedure-call-or-argument", "title": "Excel VBA: Run Time Error 5 - Invalid Procedure Call or Argument", "body": "<p>I have a macro in excel which loops over the tabs and saves the tabs as PDFs in a given folder.</p>\n\n<p>The macro partially works, it creates a few PDFs but then stops and throws this error:</p>\n\n<pre><code>Run Time Error 5 - Invalid Procedure Call or Argument\n</code></pre>\n\n<p>Here is my code:</p>\n\n<pre><code>Option Explicit\n\nSub WorksheetLoop()\n\nDim wsA As Worksheet\nDim wbA As Workbook\nDim strTime As String\nDim strName As String\nDim strPath As String\nDim strFile As String\nDim strPathFile As String\nDim myFile As Variant\nDim rng As Range\n\n' Prevents screen refreshing.\nApplication.ScreenUpdating = False\n\nSet wbA = ActiveWorkbook\n\nstrPath = wbA.Path\nstrTime = Format(Now(), \"yyyymmdd\")\n\n'get active workbook folder, if saved\nstrPath = wbA.Path\nIf strPath = \"\" Then\n  strPath = Application.DefaultFilePath\nEnd If\nstrPath = strPath &amp; \"\\\"\n\n' Begin the loop.\nFor Each wsA In ActiveWorkbook.Worksheets\n\n    'replace spaces and periods in sheet name\n    strName = Replace(wsA.Name, \" \", \"\")\n    strName = Replace(strName, \".\", \"_\")\n\n    If strName = \"Macro\" Then\n        MsgBox \"That's all folks! :)\"\n        Exit Sub\n    End If\n\n    If strName = \"TOUCHPOINTS\" Then\n        strName = \"Touchpoints by markets\"\n    End If\n\n    If strName = \"VIDEOHOURS\" Then\n        strName = \"Viewing Hours by markets\"\n    End If\n\n    If strName = \"TARGETS\" Then\n        strName = \"Shares by markets\"\n    End If\n\n    If strName = \"SHARESCHANNELS\" Then\n        strName = \"IGNORE ME\"\n    End If\n\n    If strName = \"TOP10PREMIERES\" Then\n        strName = \"Top 10 Premieres by markets\"\n    End If\n\n    If strName = \"SHARETREND\" Then\n        strName = \"Share trends last 13 months\"\n    End If\n\n    If strName = \"COMPETITION\" Then\n        strName = \"Share overview international media companies\"\n    End If\n\n    If strName = \"COMPETITIONSHARETREND\" Then\n        strName = \"Share trends factual competitors last 13 months\"\n    End If\n\n    If strName = \"PUT\" Then\n        strName = \"PUT level\"\n    End If\n\n    If strName = \"CHANNELRANKER\" Then\n        strName = \"Top 20 Channels by Market\"\n    End If\n\n    'create default name for savng file\n    strFile = strName &amp; \"_\" &amp; strTime &amp; \".pdf\"\n    myFile = strPath &amp; strFile\n\n    Debug.Print myFile\n\n    'export to PDF if a folder was selected\n    If myFile &lt;&gt; \"False\" Then\n        wsA.ExportAsFixedFormat _\n                Type:=xlTypePDF, _\n                Filename:=myFile, _\n                Quality:=xlQualityStandard, _\n                IncludeDocProperties:=True, _\n                IgnorePrintAreas:=False, _\n                OpenAfterPublish:=False\n    End If\n\nNext wsA\n\n ' Enables screen refreshing.\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba", "internet-explorer-11"], "comments": [{"owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 1, "creation_date": 1502986704, "post_id": 45718480, "comment_id": 78438161, "body": "does the HTML actually indicate there is an OnChange event?"}, {"owner": {"reputation": 45, "user_id": 6603648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c990f713f7ae13be9d3adb75fd12d15b?s=128&d=identicon&r=PG&f=1", "display_name": "Rajivdmo", "link": "https://stackoverflow.com/users/6603648/rajivdmo"}, "reply_to_user": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1502996945, "post_id": 45718480, "comment_id": 78443766, "body": "I got what you said, I guess. Doesn&#39;t have anyone among the html. I imagined that it works in a different way.  &quot;oSelect.FireEvent (&quot;onchange&quot;)&quot;  is making nothing. So what do you suggest?"}], "owner": {"reputation": 45, "user_id": 6603648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c990f713f7ae13be9d3adb75fd12d15b?s=128&d=identicon&r=PG&f=1", "display_name": "Rajivdmo", "link": "https://stackoverflow.com/users/6603648/rajivdmo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1502900036, "creation_date": 1502900036, "question_id": 45718480, "link": "https://stackoverflow.com/questions/45718480/set-dropdown-with-inputbox-using-internet-controls", "title": "set dropdown with inputbox using internet controls", "body": "<p>I already tried too many topics before, so I decided to post it.\nI'm trying to select a field in a list box with the follow html code:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>                        &lt;div class=\"col-md-6\"&gt;\r\n                            &lt;div class=\"form-group\"&gt;\r\n                                &lt;label class=\"control-label col-md-3\" for=\"Filter_Grupo1\"&gt;Reporte por&lt;/label&gt;\r\n                                &lt;div class=\"col-md-9\"&gt;\r\n                                    &lt;select class=\"form-control input-sm chosen\" data-val=\"true\" data-val-number=\"The field Reporte por must be a number.\" data-val-required=\"El campo Reporte por es obligatorio.\" id=\"Filter_Grupo1\" name=\"Filter.Grupo1\"&gt;&lt;option selected=\"selected\" value=\"1\"&gt;Marca&lt;/option&gt;\r\n&lt;option value=\"2\"&gt;Modelo&lt;/option&gt;\r\n&lt;option value=\"3\"&gt;SubModelo&lt;/option&gt;\r\n&lt;option value=\"4\"&gt;Versi&amp;#243;n&lt;/option&gt;\r\n&lt;option value=\"5\"&gt;Combustible&lt;/option&gt;\r\n&lt;option value=\"6\"&gt;Motor&lt;/option&gt;\r\n&lt;option value=\"7\"&gt;Transmision&lt;/option&gt;\r\n&lt;option value=\"8\"&gt;Segmento&lt;/option&gt;\r\n&lt;option value=\"9\"&gt;SubSegmento&lt;/option&gt;\r\n&lt;option value=\"10\"&gt;Tipo&lt;/option&gt;\r\n&lt;option value=\"11\"&gt;Origen&lt;/option&gt;\r\n&lt;option value=\"12\"&gt;Tipo Comprador&lt;/option&gt;\r\n&lt;option value=\"13\"&gt;Provincia&lt;/option&gt;\r\n&lt;option value=\"14\"&gt;Region&lt;/option&gt;\r\n&lt;option value=\"15\"&gt;Pa&amp;#237;s Origen&lt;/option&gt;\r\n&lt;option value=\"16\"&gt;Localidad&lt;/option&gt;\r\n&lt;/select&gt;\r\n                                &lt;/div&gt;\r\n                            &lt;/div&gt;\r\n                        &lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>To make this selection, I tried:</p>\n\n<pre><code>    Set oSelect = oHTMLDoc.getElementById(\"Filter_Grupo1\")\n    oSelect.Focus\n    oSelect.SelectedIndex = 6\n    oSelect.FireEvent (\"onchange\")\n</code></pre>\n\n<p>As result the option will be highlighted<a href=\"https://i.stack.imgur.com/YMERz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YMERz.png\" alt=\"enter image description here\"></a></p>\n\n<p>But when this dropdown is closed it still remains in the same way:<a href=\"https://i.stack.imgur.com/rHdEw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rHdEw.png\" alt=\"enter image description here\"></a></p>\n\n<p>I already tried to use the Twebst library, the result was the same.\nGlad for any help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1502901026, "post_id": 45718426, "comment_id": 78395652, "body": "Are you trying to do this with any window, or the text/notepad specifically?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502902983, "post_id": 45718426, "comment_id": 78396720, "body": "You&#39;re getting that error because the <code>Application.Windows</code> collection contains no element keyed with <code>test.txt</code>. Wouldn&#39;t you rather want to work with the <code>Workbooks</code> collection though? How are you opening that file?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1502906031, "post_id": 45718426, "comment_id": 78398450, "body": "If the window is already open and you are merely trying to get it&#39;s handle so you can close it using code, you would want to use an <code>API</code> call named <code>FindWindow</code> - <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms633499(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1502906908, "post_id": 45718426, "comment_id": 78398940, "body": "@braX I think OP is merely trying to close a file they&#39;ve opened in Excel. Seeing how they opened the file (i.e. whether they have an object reference pointing to the corresponding workbook object) would shed some light about how it could be closed (e.g. <code>book.Close SaveChanges:=False</code>). I don&#39;t think there&#39;s a need to dive into Win32 stuff here."}, {"owner": {"reputation": 1, "user_id": 8473586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b401468301be31476ffa8e0fea9914?s=128&d=identicon&r=PG&f=1", "display_name": "mavmoses07", "link": "https://stackoverflow.com/users/8473586/mavmoses07"}, "edited": false, "score": 0, "creation_date": 1502914565, "post_id": 45718426, "comment_id": 78402587, "body": "Thanks for the responses. The &quot;test.txt&quot; was just a simplified example, but guess I should elaborate a bit further. I have a macro that that opens a different program called STAAD.pro. The macro instructions STAAD.pro to run an analysis and save the results. Once in a while, this STAAD.pro produces an error message. This error message stalls up STAAD.pro and the macro. I&#39;d like to simply close the error message box that appears but cannot find a way to do so."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1503206640, "post_id": 45718426, "comment_id": 78515053, "body": "The &quot;test.txt&quot; was a misleading example."}], "owner": {"reputation": 1, "user_id": 8473586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b401468301be31476ffa8e0fea9914?s=128&d=identicon&r=PG&f=1", "display_name": "mavmoses07", "link": "https://stackoverflow.com/users/8473586/mavmoses07"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1311, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502905690, "creation_date": 1502899828, "last_edit_date": 1502905690, "question_id": 45718426, "link": "https://stackoverflow.com/questions/45718426/vba-windows-activate-non-excel-file-window", "title": "VBA Windows().Activate Non-Excel File Window", "body": "<p>This might sound like a relatively simple question, but I cannot figure it out. </p>\n\n<p>Using VBA how can I activate a specific window and then close it? For example, if I have a text file open called <em>test.txt</em> how can I activate it and then close it? I've tried:</p>\n\n<pre><code>Windows(\"test.txt\").Activate       \nActiveWindow.Close\n</code></pre>\n\n<p>and receive below error message when VBA attempts to process the first line:</p>\n\n<blockquote>\n  <p>Rune-time error '9': Subscript our of range</p>\n</blockquote>\n"}, {"tags": ["xml", "vba", "dom"], "answers": [{"tags": [], "owner": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "is_accepted": true, "score": 1, "last_activity_date": 1502922569, "last_edit_date": 1502922569, "creation_date": 1502900437, "answer_id": 45718600, "question_id": 45718281, "link": "https://stackoverflow.com/questions/45718281/vba-html-tag-text-query-without-inner-tag/45718600#45718600", "title": "VBA html tag text query without inner tag", "body": "<pre><code>HTMLDoc.getElementsByTagName(\"h1\")(0).childNodes(0).nodeValue\n'                                         /|\\\n'        All nodes, including #text -------|\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 310843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70fcf62db248447d0044f13ab2d3c2ac?s=128&d=identicon&r=PG", "display_name": "emilll", "link": "https://stackoverflow.com/users/310843/emilll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 45718600, "answer_count": 1, "score": 0, "last_activity_date": 1502922569, "creation_date": 1502899369, "question_id": 45718281, "link": "https://stackoverflow.com/questions/45718281/vba-html-tag-text-query-without-inner-tag", "title": "VBA html tag text query without inner tag", "body": "<p>There's such html:</p>\n\n<pre><code>&lt;h1 class=\"title\"&gt;NOW ZINC PICOLINATE 50MG 60caps CYNK PIKOLINIAN\n  &lt;small&gt;(6826446676)&lt;/small&gt;\n&lt;/h1&gt;\n</code></pre>\n\n<p>I want to get only this: <em>\"NOW ZINC PICOLINATE 50MG 60caps CYNK PIKOLINIAN\"</em></p>\n\n<p>When I use:</p>\n\n<pre><code>HTMLDoc.getElementsByTagName(\"h1\")(0).innerText\n</code></pre>\n\n<p>I get: <em>\"NOW ZINC PICOLINATE 50MG 60caps CYNK PIKOLINIAN (6826446676)\"</em></p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 529, "user_id": 4557167, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b400a8743eabd4b771d18f412c663877?s=128&d=identicon&r=PG&f=1", "display_name": "Jaitnium", "link": "https://stackoverflow.com/users/4557167/jaitnium"}, "edited": false, "score": 0, "creation_date": 1502901008, "post_id": 45718616, "comment_id": 78395640, "body": "I&#39;m looking for a way to backup my tables and their information. Since your solutions does that, I&#39;m very interested."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 529, "user_id": 4557167, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b400a8743eabd4b771d18f412c663877?s=128&d=identicon&r=PG&f=1", "display_name": "Jaitnium", "link": "https://stackoverflow.com/users/4557167/jaitnium"}, "edited": false, "score": 0, "creation_date": 1502902286, "post_id": 45718616, "comment_id": 78396344, "body": "See the current edit. Never had problems with it, but haven&#39;t done extensive testing"}, {"owner": {"reputation": 529, "user_id": 4557167, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b400a8743eabd4b771d18f412c663877?s=128&d=identicon&r=PG&f=1", "display_name": "Jaitnium", "link": "https://stackoverflow.com/users/4557167/jaitnium"}, "edited": false, "score": 0, "creation_date": 1502904571, "post_id": 45718616, "comment_id": 78397671, "body": "I have several linked tables that I&#39;d like to avoid copying because they require Quickbooks to be open. Should I just check iterator.Name for the tables&#39; names to skip over those tables?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 529, "user_id": 4557167, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b400a8743eabd4b771d18f412c663877?s=128&d=identicon&r=PG&f=1", "display_name": "Jaitnium", "link": "https://stackoverflow.com/users/4557167/jaitnium"}, "edited": false, "score": 0, "creation_date": 1502904699, "post_id": 45718616, "comment_id": 78397745, "body": "You don&#39;t need to check their names, a simple <code>If iterator.Connect &lt;&gt; &quot;&quot; Then</code> will exclude them. There also  is an option to store the data from the linked table in an unlinked table in the backup."}, {"owner": {"reputation": 529, "user_id": 4557167, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b400a8743eabd4b771d18f412c663877?s=128&d=identicon&r=PG&f=1", "display_name": "Jaitnium", "link": "https://stackoverflow.com/users/4557167/jaitnium"}, "edited": false, "score": 0, "creation_date": 1502905261, "post_id": 45718616, "comment_id": 78398063, "body": "I made this modification to the first conditional:         <code>If Not iterator.Name Like &quot;MSys*&quot; And iterator.Connect &lt;&gt; &quot;&quot; Then</code>           but I&#39;m getting error 3709: &quot;The search key was not found in any record.&quot;"}, {"owner": {"reputation": 529, "user_id": 4557167, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b400a8743eabd4b771d18f412c663877?s=128&d=identicon&r=PG&f=1", "display_name": "Jaitnium", "link": "https://stackoverflow.com/users/4557167/jaitnium"}, "edited": false, "score": 0, "creation_date": 1502905759, "post_id": 45718616, "comment_id": 78398319, "body": "I get an error on the &quot;DoCmd.TransferDatabase&quot; line right after it:      <code>DoCmd.TransferDatabase acExport, &quot;Microsoft Access&quot;, newLocation, acQuery, iterator.Name, iterator.Name</code>"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 529, "user_id": 4557167, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b400a8743eabd4b771d18f412c663877?s=128&d=identicon&r=PG&f=1", "display_name": "Jaitnium", "link": "https://stackoverflow.com/users/4557167/jaitnium"}, "edited": false, "score": 0, "creation_date": 1502905922, "post_id": 45718616, "comment_id": 78398397, "body": "Looks like an error with a specific table. You can <code>Debug.Print iterator.Name</code> to find out which one."}, {"owner": {"reputation": 529, "user_id": 4557167, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b400a8743eabd4b771d18f412c663877?s=128&d=identicon&r=PG&f=1", "display_name": "Jaitnium", "link": "https://stackoverflow.com/users/4557167/jaitnium"}, "edited": false, "score": 0, "creation_date": 1502906163, "post_id": 45718616, "comment_id": 78398531, "body": "Figured it out. It was still accessing the linked tables because <code>iterator.Connect &lt;&gt; &quot;&quot;</code> should be <code>iterator.Connect = &quot;&quot;</code>. Thank you for your help."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 3, "last_activity_date": 1502908017, "last_edit_date": 1502908017, "creation_date": 1502900498, "answer_id": 45718616, "question_id": 45718163, "link": "https://stackoverflow.com/questions/45718163/can-an-ms-access-database-create-a-backup-of-itself-while-its-open-using-vba/45718616#45718616", "title": "Can an Ms Access database create a backup of itself while it&#39;s open using vba?", "body": "<p>The users \"save as\" does a different thing than just copying a file, it actually creates a new database, and exports everything to it.  You can do the same if you wish (if there are no locked records), but it does require some coding. </p>\n\n<p>The \"backup database\" is unavailable from the save as menu if the file is opened by other users (and closes all open objects when used).</p>\n\n<p>You can, of course, create a new file, and then iterate through all tables, queries, forms, reports, macros and modules to copy them, and then iterate through all relationships to add them to the copy. Then you can copy all database properties to the new database. But that requires some work.</p>\n\n<p>See the following code to create a backup that ignores relationships and database properties</p>\n\n<pre><code>Public Sub BackupDatabase(newLocation As String)\n    'Make sure there isn't already a file with the name of the new database\n    If Dir(newLocation) &lt;&gt; \"\" Then Kill newLocation\n    'Create a new database using the default workspace\n    'dbVersion30 = Jet 3, dbVersion40 = Jet4, dbVersion120 = 2007 accdb, dbVersion150 = 2013 accdb\n    DBEngine.Workspaces(0).CreateDatabase newLocation, dbLangGeneral, Option:=dbVersion150\n\n    'Iterate through common object collections, put the files in\n    Dim iterator As Variant\n    For Each iterator In CurrentDb.TableDefs\n        If Not iterator.Name Like \"MSys*\" Then\n            DoCmd.TransferDatabase acExport, \"Microsoft Access\", newLocation, acTable, iterator.Name, iterator.Name\n        End If\n    Next iterator\n    For Each iterator In CurrentDb.QueryDefs\n        If Not iterator.Name Like \"~sq_*\" Then\n            DoCmd.TransferDatabase acExport, \"Microsoft Access\", newLocation, acQuery, iterator.Name, iterator.Name\n        End If\n    Next iterator\n    For Each iterator In CurrentProject.AllForms\n         DoCmd.TransferDatabase acExport, \"Microsoft Access\", newLocation, acForm, iterator.Name, iterator.Name\n    Next iterator\n    For Each iterator In CurrentProject.AllReports\n        DoCmd.TransferDatabase acExport, \"Microsoft Access\", newLocation, acReport, iterator.Name, iterator.Name\n    Next iterator\n    For Each iterator In CurrentProject.AllMacros\n        DoCmd.TransferDatabase acExport, \"Microsoft Access\", newLocation, acMacro, iterator.Name, iterator.Name\n    Next iterator\n    For Each iterator In CurrentProject.AllModules\n        DoCmd.TransferDatabase acExport, \"Microsoft Access\", newLocation, acModule, iterator.Name, iterator.Name\n    Next iterator\nEnd Sub\n</code></pre>\n\n<p>Note that, depending on your security settings, you might get a lot of security popups.</p>\n"}, {"comments": [{"owner": {"reputation": 469, "user_id": 3862163, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3c044036e475ca103a3e5c233b1550ce?s=128&d=identicon&r=PG&f=1", "display_name": "DRC", "link": "https://stackoverflow.com/users/3862163/drc"}, "edited": false, "score": 0, "creation_date": 1519922932, "post_id": 46228382, "comment_id": 85113979, "body": "this looked promising.  I tried to use it to backup the current backend to a new location using this line of code:  DBEngine.CompactDatabase BackendPath(&quot;tbl&quot;), BackendPath(&quot;tbl&quot;) &amp; &quot;_backup&quot;   However, when that code runs, I get a Run-time error &#39;3704&#39;: You attempted to open a database that is already opened by user &#39;Admin&#39; on machine {Computer Name}.  Try again when the databse is available.  I really wish this worked for me, though."}, {"owner": {"reputation": 244, "user_id": 7936123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf162f9353483edfa62c3443929f733?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/7936123/chris"}, "reply_to_user": {"reputation": 469, "user_id": 3862163, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3c044036e475ca103a3e5c233b1550ce?s=128&d=identicon&r=PG&f=1", "display_name": "DRC", "link": "https://stackoverflow.com/users/3862163/drc"}, "edited": false, "score": 0, "creation_date": 1520008465, "post_id": 46228382, "comment_id": 85152507, "body": "BAH! my mistake, I have edited my second code to fix the issue. The problem is when the rst opened a recordset to the strSQL query. it created a connection to the database. Since there is a current connection, the database was unable to compact and repair to the destination location."}], "tags": [], "owner": {"reputation": 244, "user_id": 7936123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf162f9353483edfa62c3443929f733?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/7936123/chris"}, "is_accepted": false, "score": 1, "last_activity_date": 1520008553, "last_edit_date": 1520008553, "creation_date": 1505423924, "answer_id": 46228382, "question_id": 45718163, "link": "https://stackoverflow.com/questions/45718163/can-an-ms-access-database-create-a-backup-of-itself-while-its-open-using-vba/46228382#46228382", "title": "Can an Ms Access database create a backup of itself while it&#39;s open using vba?", "body": "<p>You can use the following line of code, This is assuming you have a split database:</p>\n\n<pre><code>Public Sub CompactDB()\ndim strFrom as string\ndim strTo as string\n\nstrFrom = \"C:\\Your Database Location Including File Name and Extension\"\nstrTo = \"C:\\Your new Database backup location File Name and Extension\"\n\nDBEngine.CompactDatabase strFrom, strTo\n\nEnd Sub\n</code></pre>\n\n<p><em>NOTE</em> This will not compact your current backend (strFrom), This makes a copy of back end located at strFrom to the new location (strTo).</p>\n\n<p>Just have a button click or event from another from call this sub.</p>\n\n<p>But, the way I handle this is make a table that stores 2 fields. Field 1 is named \"DestinationFrom\", Field 2 is named \"DestinationTo\". Then I store records like below:</p>\n\n<p>DestinationFrom = C:\\Destination of current back end</p>\n\n<p>DestinationTo = C:\\Back Up destination</p>\n\n<p>Then use the following code:</p>\n\n<pre><code>Public sub CompactDB()\ndim rst as dao.recordset\ndim strSQL as string\ndim strLocation as string\nDim strDestination as string\n\nstrsql = \"SELECT * \" &amp; _\n         \"FROM DestinationTable;\"\nset rst = currentdb.openrecordset(strsql)\nstrlocation = rst![DestinationFrom]\nstrdestination = rst![DestinationTo]\nrst.close\nset rst = nothing\n\nDBEngine.CompactDatabase rst![DestinationFrom] , rst![DestinationTo]\n\nif not rst is nothing then\nrst.close\nset rst = nothing\nend if\nEnd Sub\n</code></pre>\n\n<p>This way, if my code ever fails cause a folder was deleted or moved, I can change the string location in the field on the table without needing to change anything that was hard coded and needing to release a new copy. Very useful when allowing multiple users in a split database</p>\n"}, {"tags": [], "owner": {"reputation": 56, "user_id": 1621021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e542a3e714870a60eaa828cda7c6a00?s=128&d=identicon&r=PG", "display_name": "landrew", "link": "https://stackoverflow.com/users/1621021/landrew"}, "is_accepted": false, "score": 0, "last_activity_date": 1532707463, "creation_date": 1532707463, "answer_id": 51561674, "question_id": 45718163, "link": "https://stackoverflow.com/questions/45718163/can-an-ms-access-database-create-a-backup-of-itself-while-its-open-using-vba/51561674#51561674", "title": "Can an Ms Access database create a backup of itself while it&#39;s open using vba?", "body": "<p>You can try using FileSystemObject like this:</p>\n\n<pre><code>    'strFrom = Application.CurrentProject.FullName\n    'strTo = \"C:\\FolderName\\NewFileName.accdb\"\n\nPublic Sub copyFile(strFrom As String, strTo As String)\n    Dim fso As FileSystemObject\n    Set fso = New FileSystemObject\n\n    fso.copyFile strFrom, strTo\n\n    Set fso = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 529, "user_id": 4557167, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b400a8743eabd4b771d18f412c663877?s=128&d=identicon&r=PG&f=1", "display_name": "Jaitnium", "link": "https://stackoverflow.com/users/4557167/jaitnium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8713, "favorite_count": 0, "accepted_answer_id": 45718616, "answer_count": 3, "score": 2, "last_activity_date": 1532707463, "creation_date": 1502899001, "question_id": 45718163, "link": "https://stackoverflow.com/questions/45718163/can-an-ms-access-database-create-a-backup-of-itself-while-its-open-using-vba", "title": "Can an Ms Access database create a backup of itself while it&#39;s open using vba?", "body": "<p><strong>Background:</strong> I have a process that links Quickbooks to Ms Access. If a button is pressed, some information will be queried from Quickbooks and then updates Ms Access. If the power goes out, or if the user forces Ms Access to close during the sync process, it can cause some of the information to be corrupted.</p>\n\n<p><strong>Goal:</strong> I want to have a button on a form that users can press and it'll save the current database to a predefined location with the date and time attached to the filename.</p>\n\n<p>I keep reading how it's possible to backup other <em>closed</em> databases (using FileCopy), but you need a hacky-workaround solution to do it on an open database, which can lead to data corruption. I'm not entirely convinced since the user can use \"Save As\" at any time.</p>\n\n<p>Is there a way to backup a currently open Ms Access database, or something that will fulfill my needs?</p>\n"}, {"tags": ["regex", "vba"], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 4959141, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b05c815623bc26de18ee83d3dd35936c?s=128&d=identicon&r=PG&f=1", "display_name": "B.Cap", "link": "https://stackoverflow.com/users/4959141/b-cap"}, "edited": false, "score": 0, "creation_date": 1502899982, "post_id": 45718200, "comment_id": 78395030, "body": "I get the same result  &quot;h92345W&quot;"}], "tags": [], "owner": {"reputation": 215, "user_id": 1365284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/402593b48bb6b9373eb4e0ed2fccd204?s=128&d=identicon&r=PG", "display_name": "Malexandre", "link": "https://stackoverflow.com/users/1365284/malexandre"}, "is_accepted": false, "score": 2, "last_activity_date": 1502899108, "creation_date": 1502899108, "answer_id": 45718200, "question_id": 45718154, "link": "https://stackoverflow.com/questions/45718154/regex-return-exact-number-of-consecutive-digits/45718200#45718200", "title": "Regex - Return Exact Number of Consecutive Digits", "body": "<p>You need to use a group:</p>\n\n<pre><code>\"[^\\d](\\d{5})[^\\d]\"\n</code></pre>\n\n<p>And then the number will be in the first group. Not sure about the VBA syntax for grouping.</p>\n"}, {"comments": [{"owner": {"reputation": 139, "user_id": 4959141, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b05c815623bc26de18ee83d3dd35936c?s=128&d=identicon&r=PG&f=1", "display_name": "B.Cap", "link": "https://stackoverflow.com/users/4959141/b-cap"}, "edited": false, "score": 0, "creation_date": 1502900053, "post_id": 45718236, "comment_id": 78395054, "body": "I get the same result &quot;h92345W&quot;"}, {"owner": {"reputation": 9543, "user_id": 4989284, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/g03Hx.png?s=128&g=1", "display_name": "marvel308", "link": "https://stackoverflow.com/users/4989284/marvel308"}, "reply_to_user": {"reputation": 139, "user_id": 4959141, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b05c815623bc26de18ee83d3dd35936c?s=128&d=identicon&r=PG&f=1", "display_name": "B.Cap", "link": "https://stackoverflow.com/users/4959141/b-cap"}, "edited": false, "score": 0, "creation_date": 1502900106, "post_id": 45718236, "comment_id": 78395085, "body": "Are you selecting the 2nd group?"}, {"owner": {"reputation": 9543, "user_id": 4989284, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/g03Hx.png?s=128&g=1", "display_name": "marvel308", "link": "https://stackoverflow.com/users/4989284/marvel308"}, "reply_to_user": {"reputation": 139, "user_id": 4959141, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b05c815623bc26de18ee83d3dd35936c?s=128&d=identicon&r=PG&f=1", "display_name": "B.Cap", "link": "https://stackoverflow.com/users/4959141/b-cap"}, "edited": false, "score": 0, "creation_date": 1502900387, "post_id": 45718236, "comment_id": 78395263, "body": "try to add matches(0).SubMatches(2) or matches(0).SubMatches(1), I&#39;m not sure of the syntax"}, {"owner": {"reputation": 139, "user_id": 4959141, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b05c815623bc26de18ee83d3dd35936c?s=128&d=identicon&r=PG&f=1", "display_name": "B.Cap", "link": "https://stackoverflow.com/users/4959141/b-cap"}, "edited": false, "score": 0, "creation_date": 1502900847, "post_id": 45718236, "comment_id": 78395549, "body": "<code>RegxFunc = matches(0).SubMatches(1) &#39;.Value</code>"}, {"owner": {"reputation": 215, "user_id": 1365284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/402593b48bb6b9373eb4e0ed2fccd204?s=128&d=identicon&r=PG", "display_name": "Malexandre", "link": "https://stackoverflow.com/users/1365284/malexandre"}, "edited": false, "score": 0, "creation_date": 1502980866, "post_id": 45718236, "comment_id": 78434031, "body": "Why do you use 3 groups?"}], "tags": [], "owner": {"reputation": 9543, "user_id": 4989284, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/g03Hx.png?s=128&g=1", "display_name": "marvel308", "link": "https://stackoverflow.com/users/4989284/marvel308"}, "is_accepted": true, "score": 2, "last_activity_date": 1502899213, "creation_date": 1502899213, "answer_id": 45718236, "question_id": 45718154, "link": "https://stackoverflow.com/questions/45718154/regex-return-exact-number-of-consecutive-digits/45718236#45718236", "title": "Regex - Return Exact Number of Consecutive Digits", "body": "<pre><code>([^\\d])(\\d{5})([^\\d])\n</code></pre>\n\n<p>You can use this regex, the matched terms should be in the 2nd group</p>\n"}], "owner": {"reputation": 139, "user_id": 4959141, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b05c815623bc26de18ee83d3dd35936c?s=128&d=identicon&r=PG&f=1", "display_name": "B.Cap", "link": "https://stackoverflow.com/users/4959141/b-cap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "accepted_answer_id": 45718236, "answer_count": 2, "score": 0, "last_activity_date": 1502899213, "creation_date": 1502898933, "question_id": 45718154, "link": "https://stackoverflow.com/questions/45718154/regex-return-exact-number-of-consecutive-digits", "title": "Regex - Return Exact Number of Consecutive Digits", "body": "<p>I want to return 5 consecutive digits from a string (working in VBA). </p>\n\n<p>Based on this post <a href=\"https://stackoverflow.com/questions/10294626/regex-to-check-for-4-consecutive-numbers\">Regex</a> I'm using the pattern <code>[^\\d]\\d{5}[^\\d]</code>, but this picks up the single letters immediately before and after the targeted 5 digits and returns <code>h92345W</code>(from \"....South92345West\").</p>\n\n<p>How can I modify to return only the 5 consecutive digits: <code>92345</code></p>\n\n<pre><code>Sub RegexTest()\n\n    Dim strInput As String\n    Dim strPattern As String\n\n    strInput = \"9129 Nor22 999123456 South92345West\"\n\n    'strPattern = \"^\\d{5}$\"  'No match\n\n    strPattern = \"[^\\d]\\d{5}[^\\d]\" 'Returns additional letter before and after digits\n                                     'In this case returns:  \"h12345W\"\n\n    MsgBox RegxFunc(strInput, strPattern)\n\nEnd Sub\n\n\nFunction RegxFunc(strInput As String, regexPattern As String) As String\n\n    Dim regEx As New RegExp\n    With regEx\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = False\n        .Pattern = regexPattern\n    End With\n\n\n    If regEx.test(strInput) Then\n        Set matches = regEx.Execute(strInput)\n        RegxFunc = matches(0).Value\n    Else\n        RegxFunc = \"not matched\"\n    End If\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 1188965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc00b54c38e1d109898c700df135df5?s=128&d=identicon&r=PG", "display_name": "Xon", "link": "https://stackoverflow.com/users/1188965/xon"}, "edited": false, "score": 0, "creation_date": 1503241154, "post_id": 45723380, "comment_id": 78524319, "body": "I tried to modify the code as below, however I hit the error &quot;subscript out of range&quot;. Can advise? Thanks  <code>Public Sub SplitByPercentage()     Dim inputNum As Long     inputNum = InputBox(&quot;Please enter % from 1 to 99: &quot;)      Dim startingWorksheet As Worksheet     Set startingWorksheet = Worksheets(&quot;Sheet1&quot;)      Dim firstColumn As Long     firstColumn = startingWorksheet.UsedRange.Column      Dim headerRow As Long     Dim cutoffRow As Long     Dim lastRow As Long     headerRow = 1</code>"}, {"owner": {"reputation": 1571, "user_id": 7686897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56TYI.png?s=128&g=1", "display_name": "Joe Gravelyn", "link": "https://stackoverflow.com/users/7686897/joe-gravelyn"}, "reply_to_user": {"reputation": 13, "user_id": 1188965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc00b54c38e1d109898c700df135df5?s=128&d=identicon&r=PG", "display_name": "Xon", "link": "https://stackoverflow.com/users/1188965/xon"}, "edited": false, "score": 0, "creation_date": 1503257017, "post_id": 45723380, "comment_id": 78529567, "body": "It looks like you comment got cut off. What line of code is being highlighted when you get the &quot;subscript out of range&quot; error?"}, {"owner": {"reputation": 13, "user_id": 1188965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc00b54c38e1d109898c700df135df5?s=128&d=identicon&r=PG", "display_name": "Xon", "link": "https://stackoverflow.com/users/1188965/xon"}, "edited": false, "score": 0, "creation_date": 1503392957, "post_id": 45723380, "comment_id": 78584289, "body": "Thanks for your time, I am new to Excel VBA. The &quot;subscript out of range&quot; appears at line <code>Set startingWorksheet = Worksheets(&quot;Sheet1&quot;)</code> Could it be the reference?"}, {"owner": {"reputation": 1571, "user_id": 7686897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56TYI.png?s=128&g=1", "display_name": "Joe Gravelyn", "link": "https://stackoverflow.com/users/7686897/joe-gravelyn"}, "reply_to_user": {"reputation": 13, "user_id": 1188965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc00b54c38e1d109898c700df135df5?s=128&d=identicon&r=PG", "display_name": "Xon", "link": "https://stackoverflow.com/users/1188965/xon"}, "edited": false, "score": 0, "creation_date": 1503417106, "post_id": 45723380, "comment_id": 78602194, "body": "Most likely it is caused by your workbook not having a sheet called &quot;Sheet1&quot;. Just change the text inside the quotes to the name of the sheet where your data is and you should be fine."}, {"owner": {"reputation": 13, "user_id": 1188965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc00b54c38e1d109898c700df135df5?s=128&d=identicon&r=PG", "display_name": "Xon", "link": "https://stackoverflow.com/users/1188965/xon"}, "edited": false, "score": 0, "creation_date": 1503484004, "post_id": 45723380, "comment_id": 78631286, "body": "Hi Joe, I try to edit the codes as above, can help to check please as I would like it to make a new workbook without editing the original workbook. Thanks!"}, {"owner": {"reputation": 13, "user_id": 1188965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc00b54c38e1d109898c700df135df5?s=128&d=identicon&r=PG", "display_name": "Xon", "link": "https://stackoverflow.com/users/1188965/xon"}, "edited": false, "score": 0, "creation_date": 1503510970, "post_id": 45723380, "comment_id": 78650930, "body": "Hi Joe, I get Error 1004 &quot;Application-defined or Object-defined error&quot; on line <code>wsOutput1.Rows(x).EntireRow.Value = ThisSheet.Rows(x).EntireRow.Value</code>. Any idea why?"}, {"owner": {"reputation": 1571, "user_id": 7686897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56TYI.png?s=128&g=1", "display_name": "Joe Gravelyn", "link": "https://stackoverflow.com/users/7686897/joe-gravelyn"}, "reply_to_user": {"reputation": 13, "user_id": 1188965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc00b54c38e1d109898c700df135df5?s=128&d=identicon&r=PG", "display_name": "Xon", "link": "https://stackoverflow.com/users/1188965/xon"}, "edited": false, "score": 0, "creation_date": 1503511311, "post_id": 45723380, "comment_id": 78651138, "body": "Without having your actual workbook, it is almost impossible for me to say (as Excel/VBA errors are way too generic). If you want to give me a copy (through Dropbox/OneDrive/etc), I can take a look. Otherwise, take a look at <a href=\"https://stackoverflow.com/questions/17980854/vba-runtime-error-1004-application-defined-or-object-defined-error-when-select\">this SO question</a> and see if any of the suggested answers can solve the issue."}, {"owner": {"reputation": 1571, "user_id": 7686897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56TYI.png?s=128&g=1", "display_name": "Joe Gravelyn", "link": "https://stackoverflow.com/users/7686897/joe-gravelyn"}, "reply_to_user": {"reputation": 13, "user_id": 1188965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc00b54c38e1d109898c700df135df5?s=128&d=identicon&r=PG", "display_name": "Xon", "link": "https://stackoverflow.com/users/1188965/xon"}, "edited": false, "score": 0, "creation_date": 1503611722, "post_id": 45723380, "comment_id": 78701831, "body": "@Xon - I just updated the code. It probably was having issues iterating through all of the rows in your massive file. I ran the updated code against your file and it worked perfectly fine."}], "tags": [], "owner": {"reputation": 1571, "user_id": 7686897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56TYI.png?s=128&g=1", "display_name": "Joe Gravelyn", "link": "https://stackoverflow.com/users/7686897/joe-gravelyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1503611671, "last_edit_date": 1503611671, "creation_date": 1502919394, "answer_id": 45723380, "question_id": 45718105, "link": "https://stackoverflow.com/questions/45718105/how-to-split-excel-rows-into-two-sheets-after-inputting-percentage/45723380#45723380", "title": "How To Split Excel Rows into Two Sheets After Inputting Percentage", "body": "<p>Since you tagged the question with <a href=\"https://stackoverflow.com/questions/tagged/excel-vba\"><code>excel-vba</code></a>, I'm going to assume you are at least familiar with macros, so I came up with a macro that does what you want.</p>\n\n<p><strong>Edit</strong> - Updating code based on additional requirements. New code to pop up an input box and then split the data into two new workbooks, leaving the original alone.</p>\n\n<p><strong>Edit 2</strong> - Updating code based off of provided sample file. New code copies over the entire worksheet and then deletes rows out (versus desired rows over) to help with memory usage within Excel.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub SplitWbByPercentage()\n    Dim wbOrig As Workbook\n    Dim ThisSheet As Worksheet\n    Dim wbOutput1 As Workbook\n    Dim wsOutput1 As Worksheet\n    Dim wbOutput2 As Workbook\n    Dim wsOutput2 As Worksheet\n    Dim inputNum As Long\n    Dim firstColumn As Long\n    Dim headerRow As Long\n    Dim lastRow As Long\n    Dim rowCount As Long\n    Dim cutoffRow As Long\n    Dim x As Long\n\n    Application.ScreenUpdating = False\n    inputNum = InputBox(\"Please enter First File Percentage: \")\n\n    Set wbOrig = ActiveWorkbook\n    Set ThisSheet = wbOrig.ActiveSheet\n\n    firstColumn = ThisSheet.UsedRange.Column\n    headerRow = ThisSheet.UsedRange.Row\n    lastRow = ThisSheet.UsedRange.Rows.Count + headerRow\n\n    rowCount = lastRow - headerRow 'for the headers\n    cutoffRow = Round(rowCount * (inputNum / 100), 0) + headerRow\n\n    ' Output Workbook 1\n    ThisSheet.Copy\n    Set wbOutput1 = ActiveWorkbook\n    Set wsOutput1 = wbOutput1.Worksheets(1)\n    wsOutput1.Range(wsOutput1.Rows(cutoffRow + 1), wsOutput1.Rows(lastRow)).Delete\n    wbOutput1.SaveAs wbOrig.Path &amp; \"\\Data 1\"\n    wbOutput1.Close\n\n    ' Output Workbook 2\n    ThisSheet.Copy\n    Set wbOutput2 = ActiveWorkbook\n    Set wsOutput2 = wbOutput2.Worksheets(1)\n    wsOutput2.Range(wsOutput2.Rows(headerRow + 1), wsOutput2.Rows(cutoffRow)).Delete\n    wbOutput2.SaveAs wbOrig.Path &amp; \"\\Data 2\"\n    wbOutput2.Close\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 1188965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc00b54c38e1d109898c700df135df5?s=128&d=identicon&r=PG", "display_name": "Xon", "link": "https://stackoverflow.com/users/1188965/xon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 45723380, "answer_count": 1, "score": -2, "last_activity_date": 1503611671, "creation_date": 1502898783, "last_edit_date": 1503477764, "question_id": 45718105, "link": "https://stackoverflow.com/questions/45718105/how-to-split-excel-rows-into-two-sheets-after-inputting-percentage", "title": "How To Split Excel Rows into Two Sheets After Inputting Percentage", "body": "<p>I have a data set of 100 (or 999 / any random numbers) and I wish to extract X% (x can range between 1-99) of rows after I put it on a pop out dialog box. </p>\n\n<pre><code>#   Header  Header 2\n1     A       Z\n2     2       Y\n3     C       X\n4     D       3\n5     E \n6     F       d\n7       \n8     H       1\n9     I       8\n10    J       9\n</code></pre>\n\n<p>Ideally, I wish to have an output of 2 new worksheets as below after I key in 20 in the pop out box. </p>\n\n<p><a href=\"https://i.stack.imgur.com/PfO9q.png\" rel=\"nofollow noreferrer\">Output Workbook 1</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/oX0lg.png\" rel=\"nofollow noreferrer\">Output Workbook 2</a></p>\n\n<p>Conditions to be considered:</p>\n\n<ol>\n<li><p>The total number of rows &amp; columns can be even or odd</p></li>\n<li><p>The sheet name may vary for different workbook. </p></li>\n<li><p>It should be able to save in master macro-enabled excel and use across.  </p></li>\n</ol>\n\n<p>I modified the codes from Joe's (Thanks!) but my workbook appears to crash on the bold line. </p>\n\n<pre><code>    Public Sub SplitWbByPercentage()\n    Dim inputNum As Long\n    Dim firstColumn As Long\n    Dim headerRow As Long\n    Dim cutoffRow As Long\n    Dim lastRow As Long\n    Dim startingRows As Long\n    Dim beforeWorksheet As Worksheet\n    Dim afterWorksheet As Worksheet\n    Dim x As Long\n\n    Application.ScreenUpdating = False\n    inputNum = InputBox(\"Please enter First File Percentage: \")\n\n    Set wbOrig = ActiveWorkbook\n    Set ThisSheet = wbOrig.ActiveSheet\n\n    firstColumn = ThisSheet.UsedRange.Column\n    headerRow = 1\n    lastRow = ThisSheet.UsedRange.Rows.Count + headerRow\n    startingRows = lastRow - headerRow 'for the headers\n    cutoffRow = Round(startingRows * (inputNum / 100), 0) + headerRow\n\n    Set beforeWorksheet = Worksheets.Add()\n    Set afterWorksheet = Worksheets.Add()\n\n    beforeWorksheet.Rows(headerRow).EntireRow.Value = ThisSheet.Rows(headerRow).EntireRow.Value\n    afterWorksheet.Rows(headerRow).EntireRow.Value = ThisSheet.Rows(headerRow).EntireRow.Value\n\n\n    For x = headerRow + 1 To cutoffRow\n        Set wb = Workbooks.Add\n        **beforeWorksheet.Rows(x).EntireRow.Value = ThisSheet.Rows(x).EntireRow.Value**\n\n        wb.SaveAs wbOrig.Path &amp; \"\\Data 1\" &amp; WorkbookCounter\n        wb.Close\n    Next\n\n    For x = cutoffRow + 1 To lastRow\n        Set wb = Workbooks.Add\n        afterWorksheet.Rows(headerRow + x - cutoffRow).EntireRow.Value = ThisSheet.Rows(x).EntireRow.Value\n        wb.SaveAs wbOrig.Path &amp; \"\\Data 2\" &amp; WorkbookCounter\n        wb.Close\n    Next\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "pivot-table", "vba"], "comments": [{"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1502942629, "post_id": 45718045, "comment_id": 78410272, "body": "Your current approach uses the .CurrentPage property, which is only relevant if a) your pivotfield is a PageField (i.e. appears in the FILTERS pane of the PivotTable fields list) and b) if the &quot;Select Multiple Items&quot; option in the field&#39;s dropdown is unchecked.  The PageField property is used to set a PivotTable to display just one PivotItem. You can&#39;t use it to display more than one item."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1502942756, "post_id": 45718045, "comment_id": 78410303, "body": "Can you confirm where abouts in the PivotTable the PivotFIeld is? i.e. is it in the Filters area, or the Rows or Columns area?"}], "answers": [{"comments": [{"owner": {"reputation": 169, "user_id": 7047292, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/872b322a9eba05fc4db00c5481442f41?s=128&d=identicon&r=PG&f=1", "display_name": "Ollie", "link": "https://stackoverflow.com/users/7047292/ollie"}, "edited": false, "score": 0, "creation_date": 1502967836, "post_id": 45726720, "comment_id": 78424389, "body": "Thanks very much for this, i cant quite get this to work, the code doesnt have any errors and it looks good to me but the outcome is such that all the countries in the list are still selected (apart from the 1st one, which i see is planned in the code)"}, {"owner": {"reputation": 169, "user_id": 7047292, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/872b322a9eba05fc4db00c5481442f41?s=128&d=identicon&r=PG&f=1", "display_name": "Ollie", "link": "https://stackoverflow.com/users/7047292/ollie"}, "edited": false, "score": 0, "creation_date": 1502974756, "post_id": 45726720, "comment_id": 78429256, "body": ".PivotItems(i).Visible = False"}, {"owner": {"reputation": 169, "user_id": 7047292, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/872b322a9eba05fc4db00c5481442f41?s=128&d=identicon&r=PG&f=1", "display_name": "Ollie", "link": "https://stackoverflow.com/users/7047292/ollie"}, "edited": false, "score": 0, "creation_date": 1502974794, "post_id": 45726720, "comment_id": 78429283, "body": "i know you say it takes longer but works anyway, thanks very much, you are  helping me out a great deal recently"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 169, "user_id": 7047292, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/872b322a9eba05fc4db00c5481442f41?s=128&d=identicon&r=PG&f=1", "display_name": "Ollie", "link": "https://stackoverflow.com/users/7047292/ollie"}, "edited": false, "score": 0, "creation_date": 1502998394, "post_id": 45726720, "comment_id": 78444496, "body": "No problem. Can you elaborate on what you mean by &quot;.PivotItems(i).Visible = False&quot; ? And can you also elaborate on where abouts in the PivotTable the PivotFIeld is? i.e. is it in the Filters area, or the Rows or Columns area?"}], "tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": true, "score": 1, "last_activity_date": 1506035079, "last_edit_date": 1506035079, "creation_date": 1502944993, "answer_id": 45726720, "question_id": 45718045, "link": "https://stackoverflow.com/questions/45718045/pivotfields-multiple-filter/45726720#45726720", "title": "Pivotfields multiple filter", "body": "<p>This code should do what you need. To learn more about filtering PivotTables quickly, check out my <a href=\"http://dailydoseofexcel.com/archives/2013/11/14/filtering-pivots-based-on-external-ranges/\" rel=\"nofollow noreferrer\">blogpost on the subject</a>. </p>\n\n<pre><code>Option Explicit\n\nSub FilterPivot()\nDim pt As PivotTable\nDim pf As PivotField\nDim pi As PivotItem\nDim i As Long\nDim vItem As Variant\nDim vCountries As Variant\n\nSet pt = ActiveSheet.PivotTables(\"PivotTable1\")\nSet pf = pt.PivotFields(\"CountryName\")\n\nvCountries = Array(\"FRANCE\", \"BELGIUM\", \"LUXEMBOURG\")\n\npt.ManualUpdate = True 'Stops PivotTable from refreshing after each PivotItem is changed\n\nWith pf\n\n    'At least one item must remain visible in the PivotTable at all times, so make the first\n    'item visible, and at the end of the routine, check if it actually  *should* be visible        \n    .PivotItems(1).Visible = True\n\n    'Hide any other items that aren't already hidden.\n    'Note that it is far quicker to check the status than to change it.\n    ' So only hide each item if it isn't already hidden\n    For i = 2 To .PivotItems.Count\n        If .PivotItems(i).Visible Then .PivotItems(i).Visible = False\n    Next i\n\n    'Make the PivotItems of interest visible\n    On Error Resume Next 'In case one of the items isn't found\n    For Each vItem In vCountries\n        .PivotItems(vItem).Visible = True\n    Next vItem\n    On Error GoTo 0\n\n    'Hide the first PivotItem, unless it is one of the countries of interest\n    On Error Resume Next\n    If InStr(UCase(Join(vCountries, \"|\")), UCase(.PivotItems(1))) = 0 Then .PivotItems(1).Visible = False\n    If Err.Number &lt;&gt; 0 Then\n        .ClearAllFilters\n        MsgBox Title:=\"No Items Found\", Prompt:=\"None of the desired items was found in the Pivot, so I have cleared the filter\"\n    End If\n    On Error GoTo 0\n\nEnd With\n\npt.ManualUpdate = False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 169, "user_id": 7047292, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/872b322a9eba05fc4db00c5481442f41?s=128&d=identicon&r=PG&f=1", "display_name": "Ollie", "link": "https://stackoverflow.com/users/7047292/ollie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7010, "favorite_count": 0, "accepted_answer_id": 45726720, "answer_count": 1, "score": 1, "last_activity_date": 1506035079, "creation_date": 1502898615, "last_edit_date": 1531164843, "question_id": 45718045, "link": "https://stackoverflow.com/questions/45718045/pivotfields-multiple-filter", "title": "Pivotfields multiple filter", "body": "<p>I have the code below and i'm trying to have my pivotfields part of the pivot table show 3 countries (France, Belgium and Luxembourg). The list of countries expands and contracts each time the table is updated (but France, Belgium and Luxembourg remain). </p>\n\n<pre><code>'delete all filters for country\n  With ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"countryName\")\n  .ClearAllFilters\n  .CurrentPage = \"FRANCE\"\n  .PivotItems(\"BELGIUM\").Visible = True\n  .PivotItems(\"LUXEMBOURG\").Visible = True\n\n  End With\n</code></pre>\n\n<p>This doesn't work, there are now issue with the code (errors) that arise but Belgium and Luxembourg don't appear on the filtered list</p>\n\n<p>Can anyone help with this?</p>\n"}, {"tags": ["excel", "powershell", "excel-addins", "vba"], "owner": {"reputation": 45, "user_id": 1769597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b4b0a65c6e40a117d3f00b451c0e499?s=128&d=identicon&r=PG", "display_name": "user1769597", "link": "https://stackoverflow.com/users/1769597/user1769597"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 435, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1522144306, "creation_date": 1502898536, "last_edit_date": 1531164843, "question_id": 45718018, "link": "https://stackoverflow.com/questions/45718018/powershell-excel-add-in-xlam-not-loaded-when-file-opened-from-script", "title": "Powershell - Excel add-in (XLAM) not loaded when file opened from script", "body": "<p>I have an add-in file \"add-in.xlam\" enabled in Excel so that a set of custom add-in functions are available to all Excel files.  I made a new file 'Export VBA.xlsm' with a macro in Module1 called 'exportModule'.  When I open the new excel file manually and run exportModule, all works as expected.  I've created a PowerShell script to automate the process and if I step through the code, I noticed that the add-in.xlam is not loaded when 'Export VBA.xlsm' is opened.</p>\n\n<p>Here's my PowerShell script:</p>\n\n<pre><code>$excel = New-Object -comobject Excel.Application\n$workbook = $excel.Workbooks.Open(\"C:\\FilePath\\Export VBA.xlsm\")\n$excel.Visible = $true\n$excel.Run(\"'Export VBA.xlsm'!Module1.exportModule\")\n$workbook.close()\n$excel.quit()\n[System.Runtime.Interopservices.Marshal]::ReleaseComObject($excel)\n</code></pre>\n\n<p>Here's my VBA macro:</p>\n\n<pre><code>Sub exportModule()\n\n    Dim codeMod As VBIDE.VBComponent\n    Dim vbProj As VBProject\n    Dim vbComp As VBComponent\n    Dim destDir As String\n    Dim outputFileBase As String\n    Dim vbProjectName As String\n    Dim index As Integer\n    Dim subIndex As Integer\n    Dim outputFileName As String\n    Dim moduleName As String\n\n    vbProjectName = \"add-in.xlam\"\n    destDir = \"C:\\Git\\dev\"\n    outputFileBase = \"add-in-|.txt\"\n    index = 1\n    subIndex = 1\n\n    For Each vbProj In Excel.AddIns.Application.VBE.VBProjects\n        If InStr(1, Excel.AddIns.Application.VBE.VBProjects(index).FileName, vbProjectName) &gt; 0 Then\n            For Each vbComp In Excel.AddIns.Application.VBE.VBProjects(index).VBComponents\n                If Excel.AddIns.Application.VBE.VBProjects(index).VBComponents(subIndex).Type = 1 Then\n                    Set codeMod = Excel.AddIns.Application.VBE.VBProjects(index).VBComponents(subIndex)\n                    moduleName = Excel.AddIns.Application.VBE.VBProjects(index).VBComponents(subIndex).Name\n                    outputFileName = Replace(outputFileBase, \"|\", moduleName)\n                    Call ExportVBComponent(codeMod, destDir, outputFileName)\n                End If\n                subIndex = subIndex + 1\n            Next vbComp\n        End If\n        index = index + 1\n    Next vbProj\n\nEnd Sub\n</code></pre>\n\n<p>Any ideas?\nThanks,</p>\n\n<p>Brian</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 720, "user_id": 7107097, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4a2ab24dc07ff2eaddeff5f7243779c5?s=128&d=identicon&r=PG&f=1", "display_name": "WSC", "link": "https://stackoverflow.com/users/7107097/wsc"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1502898793, "post_id": 45717943, "comment_id": 78394262, "body": "That could work, although I don&#39;t know for certain that they would be in numerical order. I suppose I could order them first then loop from the bottom up?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5595698, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156438987010107/picture?type=large", "display_name": "lolzwalls", "link": "https://stackoverflow.com/users/5595698/lolzwalls"}, "is_accepted": false, "score": 0, "last_activity_date": 1502920189, "creation_date": 1502920189, "answer_id": 45723553, "question_id": 45717943, "link": "https://stackoverflow.com/questions/45717943/delete-rows-based-on-semi-unique-id-string/45723553#45723553", "title": "Delete rows based on semi-unique ID string", "body": "<p>If this is a one-time job it would be safer and easier to do it without VBA. If you must do it using VBA, you could do the below:</p>\n\n<pre><code>Sub RowDelete()\n  Dim Rng     As Range\n\n  Set Rng = Range(\"C2\") 'Change this to the column and cell where your data begins (below the header).\n  Rng.Sort key1:=Rng, order1:=xlAscending 'Sorts your data in ascending order.\n\n  'The For Loop below is a little ugly, but it tests the number to the left of the delimiter and finds\n  'the largest value to the right of the delimiter. It fills a temp column 50 columns over with the value \"DELETE\".\n  For i = 1 To Range(\"C2\", Rng.End(xlDown)).Rows.Count\n    If Left(Rng.Offset(i, 0).Value, 8) = Left(Rng.Offset(i - 1, 0).Value, 8) _\n    And Right(Rng.Offset(i, 0).Value, 2) &gt; Right(Rng.Offset(i - 1, 0).Value, 2) Then Rng.Offset(i - 1, 50).Value = \"DELETE\"\n  Next i\n\n  'Loops through the temp column and deletes the row if its value is \"DELETE\"\n  For i = Range(\"C2\", Rng.End(xlDown)).Rows.Count To 1 Step -1\n    If Rng.Offset(i - 1, 50).Value = \"DELETE\" Then Rng.Offset(i - 1, 50).EntireRow.Delete\n  Next i\nEnd Sub\n</code></pre>\n\n<p>Please keep in mind that I don't know the size or importance of your project. I quickly threw this together in hopes that it might give you insight on ways to solve this problem.</p>\n"}], "owner": {"reputation": 720, "user_id": 7107097, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4a2ab24dc07ff2eaddeff5f7243779c5?s=128&d=identicon&r=PG&f=1", "display_name": "WSC", "link": "https://stackoverflow.com/users/7107097/wsc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503712245, "creation_date": 1502898302, "last_edit_date": 1503712245, "question_id": 45717943, "link": "https://stackoverflow.com/questions/45717943/delete-rows-based-on-semi-unique-id-string", "title": "Delete rows based on semi-unique ID string", "body": "<p>I have a series of semi-unique IDs, similar to the below:</p>\n\n<pre><code>XX123456/01\nXX123456/02\nXX123456/03\nXX122222/01\nXX122222/02\nXX122222/03\nXX155555/01\nXX155555/05\n</code></pre>\n\n<p>The lengths are always the same, and always split by a delimiter with a secondary unique ID following.</p>\n\n<p>I want to run down a column and delete rows, leaving only the row with the largest secondary unique ID, e.g.:</p>\n\n<pre><code>XX123456/03\nXX122222/03\nXX155555/05\n</code></pre>\n\n<p>What sort of logic do I need to apply for this?</p>\n\n<p>I know how to deal with standard duplicates by looping down the column and adding each ID into an array, and deleting a row if the ID is already in the array, but I am not sure how to deal with the secondary unique ID.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1502914393, "post_id": 45717824, "comment_id": 78402490, "body": "Save it with Date &amp; Time"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12920511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd07d646bb32d5b108328c19fdb3659a?s=128&d=identicon&r=PG&f=1", "display_name": "Chiranth H B", "link": "https://stackoverflow.com/users/12920511/chiranth-h-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1592898937, "creation_date": 1592898937, "answer_id": 62529975, "question_id": 45717824, "link": "https://stackoverflow.com/questions/45717824/how-to-save-file-attachments-by-date/62529975#62529975", "title": "How to Save File Attachments By Date", "body": "<p>If you are using Python import os and write code to save file as current date and time which you can get by importing datetime module</p>\n"}], "owner": {"reputation": 19, "user_id": 8473430, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nXvJLgjc67w/AAAAAAAAAAI/AAAAAAAAAIY/zQJalDqhVdE/photo.jpg?sz=128", "display_name": "Kayla Q", "link": "https://stackoverflow.com/users/8473430/kayla-q"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 610, "favorite_count": 0, "closed_date": 1602475922, "answer_count": 1, "score": 1, "last_activity_date": 1592898937, "creation_date": 1502898003, "last_edit_date": 1592898395, "question_id": 45717824, "link": "https://stackoverflow.com/questions/45717824/how-to-save-file-attachments-by-date", "closed_reason": "Needs more focus", "title": "How to Save File Attachments By Date", "body": "<p>We get Outlook emails daily containing Excel files to analyze. The name always contains <strong>\"WPS\"</strong>. </p>\n\n<p>I would like to run a script daily that saves the attachments, and organizes the attachments by the date on which they were sent. </p>\n\n<p>The two ways I see the attachments being organized by date are:  </p>\n\n<ul>\n<li>the Excel attachments are renamed with the date at the beginning of the file name</li>\n<li>they are put into dated folders.</li>\n</ul>\n\n<p>I have an Outlook rule that grabs emails with <strong><code>\"WPS\"</code></strong> in the subject headline and contains an attachment.</p>\n\n<p>Then the following script runs:</p>\n\n<pre><code>Public Sub SaveAttachmentsToDisk(MItem As Outlook.MailItem)\nDim oAttachment As Outlook.Attachment\nDim sSaveFolder As String\nsSaveFolder = \"C:\\Users\\anon\\Downloads\\Attachments\\\"\nFor Each oAttachment In MItem.Attachments\noAttachment.SaveAsFile sSaveFolder &amp; oAttachment.DisplayName\nNext\nEnd Sub\n</code></pre>\n\n<p>So now, I only have a folder with all the attachments from the beginning of time.</p>\n\n<p>I am also concerned about duplicates, sometimes we are sent the same file if the sender makes the slightest change to it. Is there any way the most recent Excel attachment can be pulled if a duplicate is found?</p>\n"}, {"tags": ["vba", "excel", "outlook-2013"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502897339, "post_id": 45717401, "comment_id": 78393211, "body": "That said you (or <i>future you</i>) might enjoy knowing that my open-source project <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> includes a port of the excellent <i>Smart Indenter</i> add-in that works in 64-bit hosts."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502898409, "post_id": 45717401, "comment_id": 78393994, "body": "Is <code>Option Explicit</code> specified? Seems your code wouldn&#39;t even compile with that option, seeing many variables used but not declared anywhere. Is there any reason to late-bind the Outlook type library instead of adding a reference to it in your project and having compile-time type safety, IntelliSense and auto-complete? Having IntelliSense would probably help you with what the available members are, and how they&#39;re called. FWIW you&#39;re creating two <code>olMail</code> objects - one outside the loop, that gets ignored, and one inside the loop."}, {"owner": {"reputation": 1, "user_id": 8473332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/496002e98625eaea2b5d32649c34ea35?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Shrivastava", "link": "https://stackoverflow.com/users/8473332/ankit-shrivastava"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502901305, "post_id": 45717401, "comment_id": 78395800, "body": "I only require olmail objects inside the loop i can remove olmail object outside the loop. But i am having problem while executing &quot;Set Doc = olMail.GetInspector.WordEditor&quot; do i need to define any object or variable for this."}, {"owner": {"reputation": 1, "user_id": 8473332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/496002e98625eaea2b5d32649c34ea35?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Shrivastava", "link": "https://stackoverflow.com/users/8473332/ankit-shrivastava"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502901688, "post_id": 45717401, "comment_id": 78396009, "body": "Yes ,I have defined all the variables in excel"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8473332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/496002e98625eaea2b5d32649c34ea35?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Shrivastava", "link": "https://stackoverflow.com/users/8473332/ankit-shrivastava"}, "edited": false, "score": 0, "creation_date": 1503588311, "post_id": 45719223, "comment_id": 78689414, "body": "Flephal, Thanks for the help , however i am getting same kind of errors in this code as well. My previous code was executing well if i use Office 2007 (Excel and Outlook) , however same code is throwing errors in Office 2013. I have mentioned types of errors and the codes in which i am getting it , request you to please look into that and let me know can i do to resolve them. Thanks"}], "tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": false, "score": 0, "last_activity_date": 1502902814, "creation_date": 1502902814, "answer_id": 45719223, "question_id": 45717401, "link": "https://stackoverflow.com/questions/45717401/runtime-error-424-object-not-defined-while-sending-email-using-outlook-2013/45719223#45719223", "title": "Runtime Error 424: Object not Defined&quot;- While Sending Email Using Outlook 2013", "body": "<p>OK - so there appear to be quite a lot of issues with the current code; you have duplication of code and non-dimensioned variables. I have tried to condense the code down, added direct references and this will hopefully make it more readable and (should maybe) work, but it's untested... I don't have the ranges set out in relevant sheets and no data to test it</p>\n\n<pre><code>Sub msMail()\n\n    Dim olApp As Object: Set olApp = CreateObject(\"Outlook.Application\")\n    Dim olMail As Object\n\n    Dim Total_Site As Range, Doc As Variant, WrdRng As Range\n    Dim StrPath As String, StrFile As String, Site_Count As Long\n\n    Dim wbMain As Workbook: Set wbMain = ThisWorkbook\n    Dim wsMail As Worksheet: Set wsMail = wbMain.Worksheets(\"Mail\")\n    Dim wsSumm As Worksheet: Set wsSumm = wbMain.Worksheets(\"Summary\")\n\n    With wsMail\n        .Calculate ' Not sure why this is included...\n        Set Total_Site = Range(\"Total_Site\")\n        For Site_Count = 1 To Total_Site.Count\n            ''Application.StatusBar = False\n            Range(\"Site_Count\") = Site_Count\n            If Range(\"Send_Email\") = \"Y\" Then\n                Set olMail = olApp.CreateItem(olMailItem)\n                Set Doc = olMail.GetInspector.WordEditor\n                If Not Doc Is Nothing Then\n                    With olMail\n                        .To = wsMail.Range(\"To_List\")\n                        .CC = IIf(wsMail.Range(\"Cc_List\") &lt;&gt; 0, wsMail.Range(\"Cc_List\"), \"\")\n                        .Subject = wsMail.Range(\"Subject_Line\")\n                        wsSumm.Range(\"Mail_Body\").Copy\n                        Set WrdRng = Doc.Range\n                        .Display\n                        WrdRng.Paste\n                        StrPath = wsMail.Range(\"StrPath\")\n                        StrFile = wsMail.Range(\"StrFile\")\n                        .Attachments.Add StrPath &amp; \"\\\" &amp; StrFile\n                        ' .Send\n                    End With\n                End If\n            End If\n        Next Site_Count\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8473332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/496002e98625eaea2b5d32649c34ea35?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Shrivastava", "link": "https://stackoverflow.com/users/8473332/ankit-shrivastava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 425, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1502902814, "creation_date": 1502896802, "last_edit_date": 1531164843, "question_id": 45717401, "link": "https://stackoverflow.com/questions/45717401/runtime-error-424-object-not-defined-while-sending-email-using-outlook-2013", "title": "Runtime Error 424: Object not Defined&quot;- While Sending Email Using Outlook 2013", "body": "<p>I am using below code to send multiple emails through outlook, this code is working fine when I use Excel 2007 and Outlook 2007 however when I tried to run same code in Excel 2013 and Outlook 2013 it is throwing an error \"Runtime Error 424: Object not Defined\" in the below code:</p>\n\n<blockquote>\n<pre><code>Set Doc = olMail.GetInspector.WordEditor\n</code></pre>\n</blockquote>\n\n<p>Can somebody please check below coding and let me know what do I need to change if I want to use same macro in 2013 version?</p>\n\n<pre><code>Sub Msmail()\n\nDim otlApp As Object  \nDim olMail As Object\n\n\nSet otlApp = CreateObject(\"Outlook.Application\")   \nSet olMail = otlApp.CreateItem(olMailItem)\n\n Set mainWB = ActiveWorkbook\n\n    Worksheets(\"Mail\").Select\n    ActiveSheet.Calculate\n\n    Total_Site = Range(\"Total_Site\")\n    For Site_Count = 1 To Total_Site\n\n    Application.StatusBar = False\n    ActiveSheet.Calculate\n    Range(\"Site_Count\") = Site_Count\n    ActiveSheet.Calculate\n\n    If Range(\"Send_Email\") = \"Y\" Then\n\n    Set mainWB = ActiveWorkbook\n    Set olMail = otlApp.CreateItem(olMailItem)\n    Set Doc = olMail.GetInspector.WordEditor   '&lt;~ ERROR 424 HERE\n\n    SendID = mainWB.Sheets(\"Mail\").Range(\"To_List\").Value\n    CCID = mainWB.Sheets(\"Mail\").Range(\"Cc_List\").Value\n    Subject = mainWB.Sheets(\"Mail\").Range(\"Subject_Line\").Value\n    Body = mainWB.Sheets(\"Summary\").Range(\"Mail_Body\").Value\n    AttachFile = mainWB.Sheets(\"Mail\").Range(\"StrPath\").Value\n    StrPath = ActiveSheet.Range(\"StrPath\").Value\n\n    With olMail\n\n        .To = SendID\n        If CCID &lt;&gt; 0 Then\n          .CC = CCID\n        End If\n        .Subject = Subject\n\n        mainWB.Sheets(\"Summary\").Range(\"Mail_Body\").Copy\n\n        Set WrdRng = Doc.Range\n       .Display\n       WrdRng.Paste\n\n           'StrPath = Range(\"StrPath\").Value\n\n           StrFile = Range(\"StrFile\").Value &amp; \"*.*\"\n\n            StrFile = Range(\"StrFile\").Value\n           .Attachments.Add StrPath &amp; \"\\\" &amp; StrFile\n\n            .Send\n\n    End With\n    End If\n    Next Site_Count\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "merge"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1502895965, "post_id": 45717116, "comment_id": 78392245, "body": "What have you tried? Post some code which shows you have made some effort and you will get help."}, {"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1502896066, "post_id": 45717116, "comment_id": 78392298, "body": "This would be much easier with Power Query than with VBA"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1502965893, "post_id": 45717116, "comment_id": 78422975, "body": "Please share some samples of source files content, and expected output for them."}], "owner": {"reputation": 393, "user_id": 7632936, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0ab2fda5924a0b1c4d87bda930ef2156?s=128&d=identicon&r=PG&f=1", "display_name": "kkl", "link": "https://stackoverflow.com/users/7632936/kkl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502895826, "creation_date": 1502895826, "last_edit_date": 1531164843, "question_id": 45717116, "link": "https://stackoverflow.com/questions/45717116/merge-multiple-txt-file", "title": "merge multiple .txt file", "body": "<p>I have .txt 37 files in a folder. I want to combine them all together using vba code. I also want to add name of the file as file_name column in the beginning. Can anyone help me to resolve this issue? Thanks .</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 0, "last_activity_date": 1502926961, "creation_date": 1502926961, "answer_id": 45724549, "question_id": 45716980, "link": "https://stackoverflow.com/questions/45716980/identify-item-that-triggered-run-a-script-code-in-a-rule/45724549#45724549", "title": "Identify item that triggered run a script code in a rule", "body": "<p>The item that triggers run a script code is passed to the code. There is no need to find it again.</p>\n\n<pre><code>Sub RunAScript_code(item As Outlook.MailItem)\n\n    MsgBox \"The item that triggered this code is: \" &amp; item.subject\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7666179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1da9e2e3d3494b24afa7966ca5c7c71c?s=128&d=identicon&r=PG&f=1", "display_name": "bob fredderson", "link": "https://stackoverflow.com/users/7666179/bob-fredderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 45724549, "answer_count": 1, "score": 0, "last_activity_date": 1502926961, "creation_date": 1502895483, "last_edit_date": 1502926957, "question_id": 45716980, "link": "https://stackoverflow.com/questions/45716980/identify-item-that-triggered-run-a-script-code-in-a-rule", "title": "Identify item that triggered run a script code in a rule", "body": "<p>I want to export the contents of any email that is received to a text file automatically. If there is text already in that text file, then the new text should overwrite it.</p>\n\n<p>A rule can be made to run this script when an email is received.</p>\n\n<p>For example:<br>\nI receive an email that says \"Happy Birthday\". </p>\n\n<p>The text \"Happy Birthday\" should be saved to \"incomingEmail.txt\"</p>\n\n<pre><code>Sub extractDataAsString(item As Outlook.MailItem)\n    Dim olItem As Outlook.MailItem\n    Dim sText As String\n\n    Set olItem = ActiveExplorer.Selection.item(1)\n    sText = olItem.Body\n\n    Dim fso As Object\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n\n    Dim Fileout As Object\n    Set Fileout = fso.CreateTextFile(\"K:\\Project\\Python\\incomingEmail.txt\", True, True)\n    Fileout.Write sText\n    Fileout.Close\n\nEnd Sub\n</code></pre>\n\n<p>The code above exports the currently selected e-mail's body to the text file. I want to export the body of the new e-mail to the text file.</p>\n\n<p>I think this is because of the line:</p>\n\n<pre><code>Set olItem = ActiveExplorer.Selection.item(1)\n</code></pre>\n\n<p>However, I can't find how to select the latest e-mail.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1502895375, "post_id": 45716874, "comment_id": 78391852, "body": "is your question regarding the <code>this breaks if not found</code> comment? If not, what is your question because I don&#39;t see a real question in the post as written."}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1502895528, "creation_date": 1502895528, "answer_id": 45717005, "question_id": 45716874, "link": "https://stackoverflow.com/questions/45716874/vba-find-breaks-if-not-found-in-external-file/45717005#45717005", "title": "vba - Find breaks if not found in external file", "body": "<p>You should really look up Find as there is plenty of documentation available. You should also get in the habit of declaring your variables and using Option Explicit. You need to check if anything is found first</p>\n\n<pre><code>Sub x()\n\nDim cellVal As Range, findPlaceHolder As Range\n\nSet src = Workbooks.Open(CStr(FilePath &amp; Filename), True, True)\nSet wb = Application.ThisWorkbook.ActiveSheet\nFor Each roww In Range(\"A3:A14\").Rows\n        With src.Worksheets(srcSheet)\n            cellSearch = \"*\" &amp; wb.Range(\"A\" &amp; roww.Row) &amp; \"*)\"\n            cellSearch = Replace(cellSearch, \" -C-\", \"\")\n\n            Set cellVal = .Range(\"A:A\").Find(What:=cellSearch, After:=.Range(\"A1\"))\n            If Not cellVal Is Nothing Then\n                Set findPlaceHolder = .Range(\"A:A\").Find(What:=cellVal &amp; \", UK\", After:=.Range(\"A1\"))\n                If findPlaceHolder Is Nothing Then\n                    wb.Range(\"E\" &amp; rowHelp) = 0\n                Else\n                    wb.Range(\"E\" &amp; rowHelp) = findPlaceHolder\n                End If\n            End If\n        End With\nNext roww\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3493, "user_id": 6591278, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/AwoCq.jpg?s=128&g=1", "display_name": "dv3", "link": "https://stackoverflow.com/users/6591278/dv3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 45717005, "answer_count": 1, "score": 0, "last_activity_date": 1502895528, "creation_date": 1502895202, "last_edit_date": 1531164843, "question_id": 45716874, "link": "https://stackoverflow.com/questions/45716874/vba-find-breaks-if-not-found-in-external-file", "title": "vba - Find breaks if not found in external file", "body": "<p>A little bit simplified but essentially what I want is to find multiple fields in an external file (without opening it) and have a Default value if not found.</p>\n\n<p>I first have to search for a string prefix, which works, but then I have to adopt to existing or non-existing endings</p>\n\n<p>Something like this:</p>\n\n<pre><code>Set src = Workbooks.Open(CStr(FilePath &amp; Filename), True, True)\nSet wb = Application.ThisWorkbook.ActiveSheet\nFor Each Roww In Range(\"A3:A14\").Rows\n        With src.Worksheets(srcSheet)\n            cellSearch = \"*\" &amp; wb.Range(\"A\" &amp; Roww.Row) &amp; \"*)\"\n            cellSearch = Replace(cellSearch , \" -C-\", \"\")\n\n            'this works\n            cellVal = .Range(\"A:A\").Find(What:=cellSearch , After:=.Range(\"A1\"))\n\n            'this breaks if not found\n            findPlaceHolder = .Range(\"A:A\").Find(What:=cellVal &amp; \", UK\", After:=.Range(\"A1\"))\n\n            If findPlaceHolder = \"\" Then\n                wb.Range(\"E\" &amp; rowHelp) = 0\n            Else\n                wb.Range(\"E\" &amp; rowHelp) = findPlaceHolder\n            End If\n</code></pre>\n\n<p>Of course, it could very well be the case, that the first find only works because it is always successful and finds all fields.</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1502894702, "post_id": 45716616, "comment_id": 78391335, "body": "Do you mean you want to only count the rows that match a certain criteria?"}, {"owner": {"reputation": 311, "user_id": 8071922, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/A59zS.jpg?s=128&g=1", "display_name": "Max Bridge", "link": "https://stackoverflow.com/users/8071922/max-bridge"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1502895633, "post_id": 45716616, "comment_id": 78392018, "body": "Yes the criteria is contain RS in the field. I want to get the count of records that contains th value <i>RS</i> whatever what string is before or after"}], "answers": [{"comments": [{"owner": {"reputation": 311, "user_id": 8071922, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/A59zS.jpg?s=128&g=1", "display_name": "Max Bridge", "link": "https://stackoverflow.com/users/8071922/max-bridge"}, "edited": false, "score": 0, "creation_date": 1502896220, "post_id": 45717145, "comment_id": 78392404, "body": "Thanks it&#39;s working. Sorry if I wasn&#39;t clear it&#39;s not my first language!"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 311, "user_id": 8071922, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/A59zS.jpg?s=128&g=1", "display_name": "Max Bridge", "link": "https://stackoverflow.com/users/8071922/max-bridge"}, "edited": false, "score": 0, "creation_date": 1502896690, "post_id": 45717145, "comment_id": 78392746, "body": "No problem. It was a SQL question really but we got there anyway. Best of luck."}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 1, "last_activity_date": 1502895907, "creation_date": 1502895907, "answer_id": 45717145, "question_id": 45716616, "link": "https://stackoverflow.com/questions/45716616/i-want-get-the-numbers-of-records-with-a-criteria-from-a-bd-access/45717145#45717145", "title": "I want get the numbers of records with a criteria from a bd access", "body": "<p>I'm still not entirely sure I understand the question <em>(as you mention field containing RS but you also have an object called RS)</em> but based on your response and the original question, the following query for <code>strSQL</code> would count only the rows where the field contains '<code>RS</code>':</p>\n\n<pre><code>strSql = \"SELECT Count(*) FROM AQ_SEG WHERE SEG_OPE_REMARQ LIKE '%RS%';\"\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 8071922, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/A59zS.jpg?s=128&g=1", "display_name": "Max Bridge", "link": "https://stackoverflow.com/users/8071922/max-bridge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13, "favorite_count": 0, "accepted_answer_id": 45717145, "answer_count": 1, "score": 0, "last_activity_date": 1502895907, "creation_date": 1502894527, "last_edit_date": 1531164843, "question_id": 45716616, "link": "https://stackoverflow.com/questions/45716616/i-want-get-the-numbers-of-records-with-a-criteria-from-a-bd-access", "title": "I want get the numbers of records with a criteria from a bd access", "body": "<p>Hi I just need to include the criteria = <em>RS</em> somewhere in the field SEG_OPE_REMARQ from the AQ_SEG table in ACCESS</p>\n\n<p>I just need to get the RS part</p>\n\n<p>Everything in the rest of the code work fine</p>\n\n<pre><code>Sub GetNumbersSigeqR()\n\n        'Get Retrait SIGEQ de AQ_SEG_EPEL_XX.mdb.mdb\n\n\n    Dim mrc As String\n    Dim retrait As String\n\n    mrc = Val(Range(\"D2\").Value)\n\n    If Len(mrc) &lt; 2 Then\n\n        mrc = \"0\" + mrc\n\n    End If\n\n\n    retrait = \"AQ_SEG_EPEL_\" + mrc + \".mdb\"\n\n    Dim folderPath As String\n    folderPath = Application.ActiveWorkbook.Path\n\n    Dim cn As Object\n    Dim rs As Object\n    Dim strSql As String\n    Dim strConnection As String\n    Set cn = CreateObject(\"ADODB.Connection\")\n\n\n    strConnection = \"Provider=Microsoft.Jet.OLEDB.4.0;\" &amp; \"Data Source=\" &amp; folderPath &amp; \"\\\" &amp; retrait\n    strSql = \"SELECT Count(*) FROM AQ_SEG ;\"\n    cn.Open strConnection\n    Set rs = cn.Execute(strSql)\n    Sheets(\"T9Cp1\").Range(\"G97\").Value = rs.Fields(0)\n    rs.Close\n    Set rs = Nothing\n    cn.Close\n    Set cn = Nothing\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1502894064, "post_id": 45716346, "comment_id": 78390848, "body": "Do all your source sheets have the same hidden columns? If not, a column that you hide after copying from one sheet will be unhidden when you copy from the next sheet and so on..."}, {"owner": {"reputation": 127, "user_id": 8318946, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bcac8e3fc0233eca8cef0ea4ffd9fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/8318946/adrian"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1502916221, "post_id": 45716346, "comment_id": 78403307, "body": "yes all worksheets have the same hidden columns that&#39;s why I&#39;d like to keep the same &quot;template&quot; in Dest Range too"}], "answers": [{"tags": [], "owner": {"reputation": 127, "user_id": 8318946, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bcac8e3fc0233eca8cef0ea4ffd9fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/8318946/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1502965103, "last_edit_date": 1502965103, "creation_date": 1502964358, "answer_id": 45732182, "question_id": 45716346, "link": "https://stackoverflow.com/questions/45716346/keep-hidden-columns-hidden-when-pasting/45732182#45732182", "title": "Keep hidden columns hidden when pasting", "body": "<p>I have managed to find the answer to my questions. I added <code>.PasteSpecial Paste:=8</code> and it worked. I also changed the name of the worksheet to number and it also worked. </p>\n\n<p>Here is my code: </p>\n\n<pre><code>Sub macro_final()\nDim SummarySheet As Worksheet\nDim FolderPath As String\nDim SelectedFiles() As Variant\nDim NRow As Long\nDim FileName As String\nDim NFile As Long\nDim WorkBk As Workbook\nDim SourceRange As Range\nDim DestRange As Range\n\nSet SummarySheet = ThisWorkbook.Worksheets(1)\n\nFolderPath = \"c:\\Users\\abcdefg\\Desktop\\input\\\"\nChDrive FolderPath\nChDir FolderPath\n\nSelectedFiles = Application.GetOpenFilename( _\n    filefilter:=\"Excel Files (*.xl*), *.xl*\", MultiSelect:=True)\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\nNRow = 1\n\nFor NFile = LBound(SelectedFiles) To UBound(SelectedFiles)\n    FileName = SelectedFiles(NFile)\n    Set WorkBk = WorkBooks.Open(FileName)\n\n    Set SourceRange = WorkBk.Worksheets(1).Range(\"A2:DZ2\")\n    Set DestRange = SummarySheet.Range(\"A\" &amp; NRow)\n\n    SourceRange.Copy\n    With DestRange\n    .PasteSpecial xlPasteValuesAndNumberFormats\n    .PasteSpecial Paste:=8\n    .PasteSpecial xlPasteFormats\n    End With\n\n    Application.CutCopyMode = False\n\n    NRow = NRow + DestRange.rows.Count\n    WorkBk.Close savechanges:=False\n\nNext NFile\nSummarySheet.rows.AutoFit\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 8318946, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bcac8e3fc0233eca8cef0ea4ffd9fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/8318946/adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 939, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508631773, "creation_date": 1502893796, "last_edit_date": 1531164843, "question_id": 45716346, "link": "https://stackoverflow.com/questions/45716346/keep-hidden-columns-hidden-when-pasting", "title": "Keep hidden columns hidden when pasting", "body": "<p>I found and edited a macro that copies the range of cells from multiple workbooks into one workbook, Summary Sheet.</p>\n\n<p>I would like hidden columns to remain hidden when pasted into DestRange.</p>\n\n<p>For instance, if columns B, G, AO, GO are hidden in the source file, I would like to hide them in the destination file too. My macro copies and pastes but unhides all columns.</p>\n\n<p>I tried to use <code>xlCellTypeVisible</code> but it doesn't copy hidden columns.</p>\n\n<p>I also tried to put these lines into my code:</p>\n\n<pre><code>Dim i As Long\nFor i = 1 To 256\nSourceRange.Sheets(\"Copy Transposed\").Columns(i).Hidden =\nDestRange.Sheets(\"Sheet1\").Columns(i).Hidden\nNext i\n</code></pre>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub MergeSelectedWorkbooks()\nDim SummarySheet As Worksheet\nDim FolderPath As String\nDim SelectedFiles() As Variant\nDim NRow As Long\nDim FileName As String\nDim NFile As Long\nDim WorkBk As Workbook\nDim SourceRange As Range\nDim DestRange As Range\nDim i As Long\n\nSet SummarySheet = ThisWorkbook.Worksheets(1)\n\nFolderPath = \"c:\\Users\\abcdefg\\Desktop\\input\\\"\n\nChDrive FolderPath\nChDir FolderPath\n\nSelectedFiles = Application.GetOpenFilename( _\n    filefilter:=\"Excel Files (*.xl*), *.xl*\", MultiSelect:=True)\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\nNRow = 1\n\nFor NFile = LBound(SelectedFiles) To UBound(SelectedFiles)\n    FileName = SelectedFiles(NFile)\n    Set WorkBk = WorkBooks.Open(FileName)\n\n    Set SourceRange = WorkBk.Worksheets(\"Copy Transposed\").Range(\"A2:DP2\")\n    Set DestRange = SummarySheet.Range(\"A\" &amp; NRow)\n    Set DestRange = DestRange.Resize(SourceRange.Rows.Count, _\n       SourceRange.Columns.Count)\n\n    SourceRange.Copy\n    DestRange.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n    Application.CutCopyMode = False\n    For i = 1 To 256\n    SourceRange.Sheets(\"Copy Transposed\").Columns(i).Hidden = DestRange.Sheets(\"Sheet1\").Columns(i).Hidden\n    Next i\n    NRow = NRow + DestRange.Rows.Count\n    WorkBk.Close savechanges:=False\nNext NFile\nSummarySheet.Columns.AutoFit\nEnd Sub\n</code></pre>\n\n<p>Moreover I would like to copy only visible worksheet from the source file.</p>\n\n<p>I put \"Copy Transposed\" because my current worksheet is named like that but the name will be always different.</p>\n\n<p>I put <code>WorkBk.Worksheets(\"1\")</code> instead of <code>WorkBk.Worksheets(\"Copy Transposed\")</code> but it copied only 1st column.</p>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502899003, "post_id": 45716290, "comment_id": 78394421, "body": "Kudos for the almost-flawless <b><i>consistency</i></b> of your explicit <code>Call</code> statements. You might be interested to know that the <code>Call</code> keyword is obsolete, completely useless, and can be omitted everywhere you have it though. ;-)"}, {"owner": {"reputation": 1, "user_id": 8402010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b399ec5c7923975c0814027c994027e4?s=128&d=identicon&r=PG&f=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/8402010/ana"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502902675, "post_id": 45716290, "comment_id": 78396549, "body": "Thank you Mat&#39;s Mug for the guidance :)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502902882, "post_id": 45716290, "comment_id": 78396657, "body": "You&#39;ll want to read <a href=\"https://stackoverflow.com/q/10714251/1188513\">this</a> as well, and my <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> add-in can help you properly indent your code, too (and will find other issues in your code, as well)."}, {"owner": {"reputation": 1, "user_id": 8402010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b399ec5c7923975c0814027c994027e4?s=128&d=identicon&r=PG&f=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/8402010/ana"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502903207, "post_id": 45716290, "comment_id": 78396841, "body": "Ohhh, I&#39;ll see you now, thank you very much :)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8402010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b399ec5c7923975c0814027c994027e4?s=128&d=identicon&r=PG&f=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/8402010/ana"}, "edited": false, "score": 0, "creation_date": 1502902608, "post_id": 45716933, "comment_id": 78396512, "body": "I tried to use an exit for after the entire application runs, but it did not work :("}], "tags": [], "owner": {"reputation": 73, "user_id": 1952850, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5fda688cba4274345e7eb4291ace35a1?s=128&d=identicon&r=PG", "display_name": "mode_x", "link": "https://stackoverflow.com/users/1952850/mode-x"}, "is_accepted": false, "score": 0, "last_activity_date": 1502895332, "creation_date": 1502895332, "answer_id": 45716933, "question_id": 45716290, "link": "https://stackoverflow.com/questions/45716290/vba-code-with-loop-sending-multiple-emails/45716933#45716933", "title": "VBA code with loop sending multiple emails", "body": "<p>Seems your Do...While loop within the For...Next loop is  not properly structured. The For loop passes a variable to Do loop which is repeated for all variables. You have to find a way to decrement variables as they are used so that they are not reused.</p>\n"}], "owner": {"reputation": 1, "user_id": 8402010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b399ec5c7923975c0814027c994027e4?s=128&d=identicon&r=PG&f=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/8402010/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502898881, "creation_date": 1502893637, "last_edit_date": 1502898881, "question_id": 45716290, "link": "https://stackoverflow.com/questions/45716290/vba-code-with-loop-sending-multiple-emails", "title": "VBA code with loop sending multiple emails", "body": "<p>I need a little help in coding, I made it to send emails automatically, but he extracts the information from a spreadsheet and when sending the email he is duplicating the email according to the amounts of lines in the spreadsheet. Ex In column A: A1 Name; A: A2 Jos\u00e9; A: A3 Maria. The code is sending two emails to Jose and two to Maria.</p>\n\n<pre><code>Sub Ferias\u00c0Vencer()\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\n\n\n\n  Dim r1  As Range, r2 As Range, N As Long\n  Dim r3  As Range, r4 As Range, N1 As Long\n  Dim r5  As Range, r6 As Range, N2 As Long\n  Dim r7  As Range, r8 As Range, N3 As Long\n  Dim r9  As Range, r10 As Range, N4 As Long\n  Dim r11 As Range, r12 As Range, N5 As Long\n  Dim r13 As Range, r14 As Range, N6 As Long\n  Dim r15 As Range, r16 As Range, N7 As Long\n  Dim r17 As Range, r18 As Range, N8 As Long\n  Dim ws As Worksheet\n  Dim wB As Workbook\n\n  Worksheets.Add(After:=Worksheets(1)).Name = \"Sheet1\"\n\n\n    Set wB = ActiveWorkbook\n    Set ws = Sheets(\"Sheet1\")\n\n\n\n  Workbooks.Open \"X:\\TESTE1.xls\"\n   N = Sheets(\"Sheet2\").Cells(Rows.count, \"B\").End(xlUp).Row\n  N1 = Sheets(\"Sheet2\").Cells(Rows.count, \"C\").End(xlUp).Row\n  N2 = Sheets(\"Sheet2\").Cells(Rows.count, \"D\").End(xlUp).Row\n  N3 = Sheets(\"Sheet2\").Cells(Rows.count, \"G\").End(xlUp).Row\n  N4 = Sheets(\"Sheet2\").Cells(Rows.count, \"H\").End(xlUp).Row\n  N6 = Sheets(\"Sheet2\").Cells(Rows.count, \"M\").End(xlUp).Row\n  N5 = Sheets(\"Sheet2\").Cells(Rows.count, \"O\").End(xlUp).Row\n  N7 = Sheets(\"Sheet2\").Cells(Rows.count, \"P\").End(xlUp).Row\n  N8 = Sheets(\"Sheet2\").Cells(Rows.count, \"Q\").End(xlUp).Row\n\n\n\n  Set r1 = Sheets(\"Sheet2\").Range(\"B3:B\" &amp; N)\n  Set r3 = Sheets(\"Sheet2\").Range(\"C3:C\" &amp; N1)\n  Set r5 = Sheets(\"Sheet2\").Range(\"D3:D\" &amp; N2)\n  Set r7 = Sheets(\"Sheet2\").Range(\"G3:G\" &amp; N3)\n  Set r9 = Sheets(\"Sheet2\").Range(\"H3:H\" &amp; N4)\n  Set r11 = Sheets(\"Sheet2\").Range(\"M3:M\" &amp; N5)\n  Set r13 = Sheets(\"Sheet2\").Range(\"O3:O\" &amp; N6)\n  Set r15 = Sheets(\"Sheet2\").Range(\"P3:P\" &amp; N7)\n  Set r17 = Sheets(\"Sheet2\").Range(\"Q3:Q\" &amp; N8)\n\n\n\n  wB.Activate\n  ws.Select\n\n  Set r2 = Sheets(\"Sheet1\").Range(\"A1\")\n  Set r4 = Sheets(\"Sheet1\").Range(\"B1\")\n  Set r6 = Sheets(\"Sheet1\").Range(\"C1\")\n  Set r8 = Sheets(\"Sheet1\").Range(\"D1\")\n  Set r10 = Sheets(\"Sheet1\").Range(\"E1\")\n  Set r12 = Sheets(\"Sheet1\").Range(\"F1\")\n  Set r14 = Sheets(\"Sheet1\").Range(\"G1\")\n  Set r16 = Sheets(\"Sheet1\").Range(\"H1\")\n  Set r18 = Sheets(\"Sheet1\").Range(\"I1\")\n\n\n  r1.Copy r2\n  r3.Copy r4\n  r5.Copy r6\n  r7.Copy r8\n  r9.Copy r10\n  r11.Copy r12\n  r13.Copy r14\n  r15.Copy r16\n  r17.Copy r18\n\n\n  Columns(\"A:I\").Select\n  Columns(\"A:I\").EntireColumn.AutoFit\n  Range(\"A1\").Select\n  Columns(\"D:F\").Select\n  Selection.Font.Bold = False\n  Selection.Font.Bold = True\n  Range(\"A1\").Select\n\n\n\n  Workbooks(\"TEST1.xls\").Close False\n\n\n\n  For vx = 2 To 9999\n\n\n  Dim k As Integer\n    k = 2\n    Sheets(\"Sheet1\").Select\n    Cells(k, 4).Select\n    Do While ActiveCell.Value &lt;&gt; \"\"\n        If (ActiveCell.Value - Now()) &lt; 30 Then\n\n\n    Dim mailDb As Object\n    Dim MailDoc As Object\n    Dim Body As Object\n    Dim Session As Object\n    Dim notesField As Object\n    Dim notesEmbeddedObject As Object\n    Dim AttachME As Object\n    Dim EmbedObj As Object\n    Dim UserName As String\n    Dim pass As String\n\n\n\n\n    Set Session = CreateObject(\"Lotus.NotesSession\")\n\n\n\n    Call Session.Initialize(pass)\n\n\n\n    Set mailDb = Session.GETDATABASE(\"\", \"names.nsf\") \n\n\n\n    If Not mailDb.IsOpen = True Then\n        Call mailDb.Open\n    End If\n\n    UserName = Session.UserName\n\n\n\n    Set MailDoc = mailDb.CREATEDOCUMENT\n    Call MailDoc.ReplaceItemValue(\"Form\", \"Memo\")\n\n\n    vcod = Cells(vx, 1)\n    vname = Cells(vx, 2)\n    vlogin = Cells(vx, 3)\n    IA = Cells(vx, 4)\n    FA = Cells(vx, 5)\n    LF = Cells(vx, 6)\n    vglogin = Cells(vx, 9)\n\n\n    If vlogin &amp; vglogin = \"\" Then\n    Exit For\n    End If\n\n\n\n\n    Call MailDoc.ReplaceItemValue(\"SendTo\", vlogin)\n    Call MailDoc.ReplaceItemValue(\"CopyTo\", vglogin)        \n    Call MailDoc.AppendItemValue(\"blindcopyTo\", \"w\")\n\n\n\n\n    Call MailDoc.ReplaceItemValue(\"Subject\", \"Help -  \" &amp; vname)\n\n\n\n    Set Body = MailDoc.CREATERICHTEXTITEM(\"Body\")\n    Call Body.APPENDTEXT(\"Prezado Sr.(a) \" &amp; vname &amp; \" - Codigo: \" &amp; vcod)\n    Call Body.ADDNEWLINE(3)\n    Call Body.APPENDTEXT(\" Informamos ###########################################.\")\n    Call Body.ADDNEWLINE(2)\n    LimiteFerias = LimiteFerias - 30\n    Call Body.APPENDTEXT(\" Portanto ###############################################.\")\n    Call Body.ADDNEWLINE(1)\n    Call Body.ADDNEWLINE(2)\n    Call Body.APPENDTEXT(\" D\u00favidas ###################################################\")\n    Call Body.ADDNEWLINE(3)\n    Call Body.APPENDTEXT(\" ######################################## \")\n\n\n\n    MailDoc.SAVEMESSAGEONSEND = True\n\n\n\n    Call MailDoc.ReplaceItemValue(\"PostedDate\", Now())\n    Call MailDoc.SEND(False)\n\n\n    Set mailDb = Nothing\n    Set MailDoc = Nothing\n    Set Body = Nothing\n    Set Session = Nothing\n\n        End If\n        k = k + 1\n        Cells(k, 4).Select\n    Loop\n\n\nNext\n\nApplication.DisplayAlerts = False\nSheets(\"Sheet1\").Select\nActiveWindow.SelectedSheets.Delete\n\nSheets(\"Sheet2\").Select\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "database", "vba", "ms-access"], "comments": [{"owner": {"reputation": 1471, "user_id": 3245918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36eea3a00567be023e199b3ca9245ad?s=128&d=identicon&r=PG", "display_name": "Peter Abolins", "link": "https://stackoverflow.com/users/3245918/peter-abolins"}, "edited": false, "score": 2, "creation_date": 1502893073, "post_id": 45715988, "comment_id": 78390071, "body": "You could select all the text-fields into a concatenated field in a temporary result, and then do a <code>LIKE</code> on the temporary result-set."}, {"owner": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1502893120, "post_id": 45715988, "comment_id": 78390110, "body": "concatenate the values (identifier &amp; title &amp; regions &amp;projectDate...) like &#39;<i>search</i>&#39; but this could be slower;"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 4, "creation_date": 1502893279, "post_id": 45715988, "comment_id": 78390247, "body": "<code>[ABC]+[XYZ]</code>  would match <code>*CX*</code> which does not exist as a discreet value, you would need to stuff in delimiters to fix that which is pretty horrible compared to a nice optimisable OR series."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1502893561, "post_id": 45715988, "comment_id": 78390485, "body": "You could add a lookup field, and look at using data macros to do add the concatenated values to this field, on update/delete etc as this might make querying a little quicker as you could add an index to the field.  I favour the separate OR method tbh."}], "answers": [{"tags": [], "owner": {"reputation": 1471, "user_id": 3245918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36eea3a00567be023e199b3ca9245ad?s=128&d=identicon&r=PG", "display_name": "Peter Abolins", "link": "https://stackoverflow.com/users/3245918/peter-abolins"}, "is_accepted": false, "score": 2, "last_activity_date": 1502893788, "creation_date": 1502893788, "answer_id": 45716343, "question_id": 45715988, "link": "https://stackoverflow.com/questions/45715988/ms-access-sql-how-to-search-multiple-fields-with-one-like-operator/45716343#45716343", "title": "MS Access SQL - How to search multiple fields with one LIKE operator", "body": "<p>Something like this could work, but I personally don't see why you can't have the existing disjunctive logic... it makes a lot more sense. </p>\n\n<pre><code>SELECT Identifier\nFROM tblProjects\nWHERE (Identifier + '|' + Title + '|' + Regions + '|' + ...) \n    LIKE '*search_text*'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 1, "last_activity_date": 1502894672, "last_edit_date": 1502894672, "creation_date": 1502894262, "answer_id": 45716524, "question_id": 45715988, "link": "https://stackoverflow.com/questions/45715988/ms-access-sql-how-to-search-multiple-fields-with-one-like-operator/45716524#45716524", "title": "MS Access SQL - How to search multiple fields with one LIKE operator", "body": "<p>Something like this, may work, but I'm in favour of the OR's, but is horizontal.</p>\n\n<pre><code>select q1.id,t2.id from\n(select t1.id,t1.value1 from table1 as t1 where t1.[Title]='a') as q1\nleft join table1 as t2 on t2.[Regions]=q1.[Title]\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 2127977, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/73ade5f9927607fa413408cef559d327?s=128&d=identicon&r=PG", "display_name": "Niiks", "link": "https://stackoverflow.com/users/2127977/niiks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 932, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1502894672, "creation_date": 1502892911, "question_id": 45715988, "link": "https://stackoverflow.com/questions/45715988/ms-access-sql-how-to-search-multiple-fields-with-one-like-operator", "title": "MS Access SQL - How to search multiple fields with one LIKE operator", "body": "<p>I have a query in MS Access VBA</p>\n\n<pre><code>Dim search As String\n\n\"SELECT Identifier\nFROM tblProjects\nWHERE Identifier \nLIKE '*\" &amp; search &amp; \"*' \" &amp; _\n\"OR Title LIKE '*\" &amp; search &amp; \"*' \" &amp; _\n\"OR Regions LIKE '*\" &amp; search &amp; \"*' \" &amp; _\n\"OR ProjectDate LIKE '*\" &amp; search &amp; \"*' \" &amp; _\n(etc)\n</code></pre>\n\n<p>Is there a way to shorten this query so that it uses one LIKE operator? Pretty much I want to search each column if they contain the search value. Keep in mind this is using the MS Access database.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1502893229, "post_id": 45715814, "comment_id": 78390212, "body": "Are you asking for VBA to write the date to a call in that format? Or for a formula to do it?"}, {"owner": {"reputation": 7125, "user_id": 3975309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r5v7W.jpg?s=128&g=1", "display_name": "Mikkel", "link": "https://stackoverflow.com/users/3975309/mikkel"}, "edited": false, "score": 0, "creation_date": 1502896721, "post_id": 45715814, "comment_id": 78392773, "body": "Your formula is wrong, it should be <code>=&quot;#Date&quot;&amp;date(yyyy,MMM,D, hh:mm)</code> (note the use of &amp; to joing 2 strings"}], "answers": [{"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 1, "last_activity_date": 1502893245, "creation_date": 1502893245, "answer_id": 45716124, "question_id": 45715814, "link": "https://stackoverflow.com/questions/45715814/excel-date-functions/45716124#45716124", "title": "Excel date functions", "body": "<p>If you're after VBA:</p>\n\n<pre><code>=\"#Date:\" &amp; Format(now(),\"yyyy/MMM/D hh:mm:ss\")\n</code></pre>\n\n<p>If you're after a cell formula:</p>\n\n<pre><code>=\"#Date:\" &amp; TEXT(NOW(),\"yyyy/MMM/D hh:mm:ss\")\n</code></pre>\n\n<p>Note: Consider <code>DD</code> instead of <code>D</code> if you want day 1 to read <code>01</code> instead of <code>1</code></p>\n"}, {"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1502900318, "post_id": 45716159, "comment_id": 78395223, "body": "You didn&#39;t add the <code>&quot;#Date:&quot;</code>.  For OP:  You can still reference the date as a real date with this method."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1502953649, "post_id": 45716159, "comment_id": 78414817, "body": "@DarrenBartrup-Cook Thanks - I&#39;ve added that in."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 1, "last_activity_date": 1502953630, "last_edit_date": 1502953630, "creation_date": 1502893324, "answer_id": 45716159, "question_id": 45715814, "link": "https://stackoverflow.com/questions/45715814/excel-date-functions/45716159#45716159", "title": "Excel date functions", "body": "<p>Just enter:</p>\n\n<pre><code>=NOW()\n</code></pre>\n\n<p>in a cell and custom format as \"#Date:\"yyyy/mmm/dd hh:mm</p>\n"}], "owner": {"reputation": 259, "user_id": 1253664, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/01d7023005f6c02dff4b74ae64f2e336?s=128&d=identicon&r=PG", "display_name": "Justin Petty", "link": "https://stackoverflow.com/users/1253664/justin-petty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 45716124, "answer_count": 2, "score": -1, "last_activity_date": 1502953630, "creation_date": 1502892474, "last_edit_date": 1531164843, "question_id": 45715814, "link": "https://stackoverflow.com/questions/45715814/excel-date-functions", "title": "Excel date functions", "body": "<p>I'm trying to get the current year/month/day military time in a cell. This is exactly what I need in the cell #Date:2017/AUG/14 14:55:08 I know this is super easy to do but I'm just not getting the result that I want.  This is what I tried.</p>\n\n<pre><code>=\"#Date\"=date(yyyy,MMM,D, hh:mm)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502894067, "post_id": 45715670, "comment_id": 78390850, "body": "What version are you running? Can&#39;t repro on Excel 2010."}, {"owner": {"reputation": 3, "user_id": 7685468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae2b1f7221ac59e2aa8eb78f0c32bd3f?s=128&d=identicon&r=PG&f=1", "display_name": "ntuni", "link": "https://stackoverflow.com/users/7685468/ntuni"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502894558, "post_id": 45715670, "comment_id": 78391231, "body": "I&#39;m using Excel 2013"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502894820, "post_id": 45715670, "comment_id": 78391426, "body": "Does a new workbook with nothing but this code reproduce the problem? See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 3, "user_id": 7685468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae2b1f7221ac59e2aa8eb78f0c32bd3f?s=128&d=identicon&r=PG&f=1", "display_name": "ntuni", "link": "https://stackoverflow.com/users/7685468/ntuni"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502895067, "post_id": 45715670, "comment_id": 78391612, "body": "yes. a new file with nothing but either auto_open or workbook_open results in the same problem."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502895139, "post_id": 45715670, "comment_id": 78391658, "body": "BTW the post got deleted while I was commenting - <code>Sub DoSomething()</code> and <code>Public Sub DoSomething()</code> are <a href=\"http://rubberduckvba.com/Inspections/Details/ImplicitPublicMemberInspection\" rel=\"nofollow noreferrer\">exactly the same identical thing</a>. It&#39;s typically better form to be explicit about access modifiers, especially since VBA&#39;s behavior about these, is the exact opposite of what other languages do (C#, Java, etc. ...for back-compatibility reasons <a href=\"https://stackoverflow.com/q/14724374/1188513\">VB.NET continued this insanity</a>)"}, {"owner": {"reputation": 3, "user_id": 7685468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae2b1f7221ac59e2aa8eb78f0c32bd3f?s=128&d=identicon&r=PG&f=1", "display_name": "ntuni", "link": "https://stackoverflow.com/users/7685468/ntuni"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1502908683, "post_id": 45715670, "comment_id": 78399796, "body": "I tried my code on a separate computer (also Excel 2013) and had the same results. I removed the message box from auto_open as it wasn&#39;t crucial, just preferred. Thank you for your help, though"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1502894583, "creation_date": 1502894583, "answer_id": 45716646, "question_id": 45715670, "link": "https://stackoverflow.com/questions/45715670/messagebox-on-file-open-does-not-get-focus/45716646#45716646", "title": "Messagebox on file open does not get focus", "body": "<p>The legacy <code>Auto_Open</code> auto-macro is going to run regardless of the state of <code>Application.EnableEvents</code>, which may be a problem if another macro-enabled workbook needs to open that workbook.</p>\n\n<p>I can't reproduce the issue on Excel 2010, with this code in <code>Module1</code>:</p>\n\n<pre><code>Sub Auto_Open()\n    MsgBox \"Auto_Open()\"\nEnd Sub\n</code></pre>\n\n<p>And this code in <code>ThisWorkbook</code>:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    MsgBox \"Workbook_Open()\"\nEnd Sub\n</code></pre>\n\n<p>I get two successive message boxes, first from <code>Workbook_Open</code>, then from <code>Auto_Open</code>, both show up right where I'd expect them - right in the middle of an empty worksheet:</p>\n\n<p><img src=\"https://i.stack.imgur.com/0wDwh.png\" alt=\"Workbook_Open() message box right in the middle of an empty worksheet\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/FUcQa.png\" alt=\"Auto_Open() message box, also right in the middle of an empty worksheet\"></p>\n\n<p>Try putting the message box in the <code>Open</code> event handler of <code>ThisWorkbook</code>, see if it helps.</p>\n"}], "owner": {"reputation": 3, "user_id": 7685468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae2b1f7221ac59e2aa8eb78f0c32bd3f?s=128&d=identicon&r=PG&f=1", "display_name": "ntuni", "link": "https://stackoverflow.com/users/7685468/ntuni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502894583, "creation_date": 1502892056, "question_id": 45715670, "link": "https://stackoverflow.com/questions/45715670/messagebox-on-file-open-does-not-get-focus", "title": "Messagebox on file open does not get focus", "body": "<p>I have an excel file that opens a messagebox when the file is opened . However, when I open the file, because of the messagebox, the file and its messagebox do not come to the front of my windows gain focus (they appear on my taskbar and I have to click on it from there). After the messagebox is completed, the file gains focus as normal. </p>\n\n<p>In its simplest form, this code seems to trigger this</p>\n\n<pre><code>Sub Auto_Open()\nMsgBox \"\"\nEnd Sub\n</code></pre>\n\n<p>I have tried adding code in to give the window focus before executing the messagebox, but to no success. I don't mind this issue but other people will be using this document. Is there a solution to this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1502892181, "post_id": 45715547, "comment_id": 78389363, "body": "A) Yes. B) No you can use the same cells"}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1502892362, "post_id": 45715547, "comment_id": 78389491, "body": "To add to what @CLR said, declare B5:F50 a range, Loop through each cell in the range and, in each iteration, set the cell value = Left([Cell value],Len(trim([Cell Value]))-1)"}], "answers": [{"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 1, "last_activity_date": 1502892688, "creation_date": 1502892688, "answer_id": 45715895, "question_id": 45715547, "link": "https://stackoverflow.com/questions/45715547/how-to-delete-last-character-in-a-string-with-vba/45715895#45715895", "title": "How to delete last character in a string with VBA?", "body": "<p>The code would be like this</p>\n\n<pre><code>Sub test()\n    Dim rngDB As Range, vDB\n    Dim s As String, i As Integer, j As Integer\n\n    Set rngDB = Range(\"b5:f50\")\n    vDB = rngDB\n    r = UBound(vDB, 1)\n    c = UBound(vDB, 2)\n    For i = 1 To r\n        For j = 1 To c\n            s = vDB(i, j)\n            s = Left(s, Len(s) - 1)\n            vDB(i, j) = s\n        Next j\n    Next i\n    rngDB = vDB\n\nEnd Sub\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>Sub test2()\n    Dim rngDB As Range        \n    Set rngDB = Range(\"b5:f50\")\n    rngDB.Replace \"B\", \"\", lookat:=xlPart\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 0, "last_activity_date": 1502892828, "creation_date": 1502892828, "answer_id": 45715957, "question_id": 45715547, "link": "https://stackoverflow.com/questions/45715547/how-to-delete-last-character-in-a-string-with-vba/45715957#45715957", "title": "How to delete last character in a string with VBA?", "body": "<p>The easiest (shortest) way I can see to do this is with a Search/Replace, <em>but this would be on the assumption that all cells end in B and a B doesn't legitimately occur elsewhere in the cells.</em></p>\n\n<pre><code>Sheets(\"YourSheetNameHere\").Range(\"B5:F50\").Replace What:=\"B\", Replacement:=\"\", LookAt:=xlPart\n</code></pre>\n\n<p>Alternatively, you could loop through each cell and <code>RIGHT</code>/<code>LEN</code> etc. but why bother?</p>\n"}], "owner": {"reputation": 13, "user_id": 8461420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/654adbb68c2ebf19e7d487dcba52ab1f?s=128&d=identicon&r=PG&f=1", "display_name": "Vasileios Georgakopoulos", "link": "https://stackoverflow.com/users/8461420/vasileios-georgakopoulos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7230, "favorite_count": 0, "accepted_answer_id": 45715957, "answer_count": 2, "score": 1, "last_activity_date": 1502892828, "creation_date": 1502891777, "last_edit_date": 1531161705, "question_id": 45715547, "link": "https://stackoverflow.com/questions/45715547/how-to-delete-last-character-in-a-string-with-vba", "title": "How to delete last character in a string with VBA?", "body": "<p>in this example below I want to remove the \"B\" using VBA. Thus, I download these values which spam from B5:F50 and all in the end have \"B\". My question is twofold. A) Is there a way to delete the \"B\" using VBA and replace these values in the same cells? B) Or have to be in new cells?</p>\n\n<p><code>77.65B 86.73B  92.97B  84.7B   89.4B</code></p>\n"}, {"tags": ["vba", "excel", "loops", "copy-paste"], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1502892750, "creation_date": 1502892750, "answer_id": 45715922, "question_id": 45715474, "link": "https://stackoverflow.com/questions/45715474/removing-blank-cells-and-structuring-data-while-copying-vba/45715922#45715922", "title": "Removing blank cells and structuring data while copying VBA", "body": "<p>In you first code, after this statement:</p>\n\n<blockquote>\n<pre><code>Set rngDestination = rngDestination.Offset(0, 1)\n</code></pre>\n</blockquote>\n\n<p>Try adding the following statement:</p>\n\n<pre><code> If rngDestination.Column &gt; 19 Then _\n   Set rngDestination = rngDestination.EntireRow.Offset(1).Cells(1)\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 8462092, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d93071bb706e1aa4ba4465597de5a8d?s=128&d=identicon&r=PG&f=1", "display_name": "ShieldData", "link": "https://stackoverflow.com/users/8462092/shielddata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 45715922, "answer_count": 1, "score": 2, "last_activity_date": 1502892750, "creation_date": 1502891533, "last_edit_date": 1502892701, "question_id": 45715474, "link": "https://stackoverflow.com/questions/45715474/removing-blank-cells-and-structuring-data-while-copying-vba", "title": "Removing blank cells and structuring data while copying VBA", "body": "<p>I am currently working on a project where I need to copy a targeted range in one workbook and paste it into another workbook omitting all the blank cells (which there are a lot of). </p>\n\n<p>So far I have managed to either paste them all in a row next to each other, but I haven't managed to structure it appropriately.</p>\n\n<pre><code>        For Each c In rngSourceRange.SpecialCells(xlCellTypeVisible)\n            If Len(c) &lt;&gt; 0 Then\n                rngDestination = c.Value\n                Set rngDestination = rngDestination.Offset(0, 1)\n            End If\n        Next c\n\n        Application.CutCopyMode = False\n</code></pre>\n\n<p>The format should be as such. The first 19 cells should go in a row next to each other and then it should move down a row go back to the first column and list the next 19 entries, and so on until I am all out of cells to copy. Now I have tried to include another for-loop but it produced a very useless result.</p>\n\n<pre><code>        For Each c In rngSourceRange.SpecialCells(xlCellTypeVisible)\n            If Len(c) &lt;&gt; 0 Then\n            For lcol = 1 To 19\n                wkbCrntWorkBook.Sheets(\"Tabelle1\").Cells(lrow, lcol).Value = c.Value\n                lrow = lrow + 1\n            Next lcol\n            End If\n        Next c\n\n        Application.CutCopyMode = False\n</code></pre>\n\n<p>Please help me properly structure this dataset. I can show the rest of my code if that would be of any help. </p>\n"}, {"tags": ["vba", "excel", "csv", "range"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 8400561, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--sQcD9IMY-s/AAAAAAAAAAI/AAAAAAAAA_o/lRtoYmuwMwg/photo.jpg?sz=128", "display_name": "Skrelly Joe", "link": "https://stackoverflow.com/users/8400561/skrelly-joe"}, "edited": false, "score": 0, "creation_date": 1502893234, "post_id": 45715879, "comment_id": 78390215, "body": "Ok. Thank you FunThomas. This is a good step in the right direction. So you are saying that my code below used to format a range will not be able to work in the current way I want it to?  Worksheets(2).Range(&quot;A3:D10003&quot;).Select Selection.HorizontalAlignment = xlLeft"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 25, "user_id": 8400561, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--sQcD9IMY-s/AAAAAAAAAAI/AAAAAAAAA_o/lRtoYmuwMwg/photo.jpg?sz=128", "display_name": "Skrelly Joe", "link": "https://stackoverflow.com/users/8400561/skrelly-joe"}, "edited": false, "score": 0, "creation_date": 1502893673, "post_id": 45715879, "comment_id": 78390575, "body": "Simply change to <code>Worksheets(2).Range(&quot;A3:D10003&quot;).HorizontalAlignment = xlLeft</code>"}, {"owner": {"reputation": 25, "user_id": 8400561, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--sQcD9IMY-s/AAAAAAAAAAI/AAAAAAAAA_o/lRtoYmuwMwg/photo.jpg?sz=128", "display_name": "Skrelly Joe", "link": "https://stackoverflow.com/users/8400561/skrelly-joe"}, "edited": false, "score": 0, "creation_date": 1502894683, "post_id": 45715879, "comment_id": 78391322, "body": "Wow, that&#39;s intuitive. I appreciate you being patient. Clearly I am new to object based programming."}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": true, "score": 1, "last_activity_date": 1502892649, "creation_date": 1502892649, "answer_id": 45715879, "question_id": 45715465, "link": "https://stackoverflow.com/questions/45715465/range-class-selection-syntax-error-between-multiple-sheets/45715879#45715879", "title": "Range Class Selection Syntax Error Between Multiple Sheets", "body": "<p>Two answers:</p>\n\n<p>The bad news: You cannot <code>select</code> a cell or range from a worksheet that is not active.</p>\n\n<p>The good news: No need to select a cell to assign a value (or do anything else with it). In fact you should avoid to <code>select</code> anything within VBA, there is nearly no reason to do so. Instead, simply do something like</p>\n\n<pre><code>with Worksheets(2)\n    .range(\"A2\").value = \"Build:\"\n    ' or: .cells(1,1).value = \"Build:\"\n    ...\nend with\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 8400561, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--sQcD9IMY-s/AAAAAAAAAAI/AAAAAAAAA_o/lRtoYmuwMwg/photo.jpg?sz=128", "display_name": "Skrelly Joe", "link": "https://stackoverflow.com/users/8400561/skrelly-joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 45715879, "answer_count": 1, "score": 0, "last_activity_date": 1502892649, "creation_date": 1502891503, "last_edit_date": 1502891963, "question_id": 45715465, "link": "https://stackoverflow.com/questions/45715465/range-class-selection-syntax-error-between-multiple-sheets", "title": "Range Class Selection Syntax Error Between Multiple Sheets", "body": "<p>I have been designing a macro that imports text files into Excel. The program was designed to initially import all data into sheet 1, but after getting feedback I was told to have it bring all data into sheet 2 instead. This macro had no trouble working when using commands such as <code>Activesheet</code> at the beginning of code lines, because sheet1 was always the active sheet. *Note both all sheets have their default names. </p>\n\n<p>I have gone in and tried to change all my range fns to regard sheet 2 instead by typing <code>Worksheets(\"Sheet2\").Range(\"A1\")...</code> ,but this has given me the </p>\n\n<blockquote>\n  <p>\"Select method of Range class\" </p>\n</blockquote>\n\n<p>error. This error occurs after my initial fn to import the file using a Query table.</p>\n\n<pre><code>Option Explicit\nSub importtxt()\n\nDim txtloc As Variant\n\nDim build As String\n\nDim bit As String\n\nDim rng As Range\n\n'Asks user for the build number that has been imported, then assigns that \nstring to cell B1\nbuild = InputBox(\"What build of SoundCheck is this?\")\n\n'Prompt Bitness\nbit = InputBox(\"Please provide the bitness of this SoundCheck\")\n\n'Asks user for location of the Time_Memlog.txt file to be imported\ntxtloc = Application.GetOpenFilename _\n     (FileFilter:=\"Text Filer (*.txt),*.txt\", _\n     title:=\"Open File(s)\", MultiSelect:=False)\n\n'Imports .txt file designated in the txtloc string\nWith Sheets(\"Sheet2\").QueryTables.Add(Connection:=\"TEXT;\" &amp; txtloc, \ndestination:=Worksheets(2).Range(\"$A$1\"))\n\n    .Name = \"Sample\"\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .TextFilePromptOnRefresh = False\n    .TextFilePlatform = 437\n    .TextFileStartRow = 1\n    .TextFileParseType = xlDelimited\n    .TextFileTextQualifier = xlTextQualifierDoubleQuote\n    .TextFileConsecutiveDelimiter = False\n    .TextFileTabDelimiter = True\n    .TextFileSemicolonDelimiter = False\n    .TextFileCommaDelimiter = True\n    .TextFileSpaceDelimiter = False\n    .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1)\n    .TextFileTrailingMinusNumbers = True\n    .Refresh BackgroundQuery:=False\nEnd With\n\n'Clears the garbage in cell A1\nWorksheets(\"Sheet2\").Range(\"$A$1\").Select\nActiveCell.Clear\n\n\n\n'Places the string build in cell A1\nWorksheets(2).Range(\"A1\").Select\nActiveCell.Value = \"Build:\"\n\n\n\nWorksheets(2).Range(\"B1\").Select\nActiveCell.Value = build\n\nWorksheets(2).Range(\"C1\").Select\nActiveCell.Value = bit\n\n'Selects all columns of the Time_Memlog and adjusts the column width to fit \nheading\nWorksheets(2).Range(\"A1:S10003\").Select\nSelection.Columns.AutoFit\n\n'Makes column headers bold text\nSheets(\"Sheet2\").Range(\"A2:D2\").Font.Bold = True\n\n'Create borders around cell range A2:D2\nSet rng = Worksheets(2).Range(\"A2:D2\")\n\nWith rng.Borders\n    .LineStyle = xlContinuous\n    .Weight = xlThin\nEnd With\n\n'Give background color to cells A2:D2\nWith rng.Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent6\n    .TintAndShade = 0.599993896298105\n    .PatternTintAndShade = 0\nEnd With\n\n'Aligns all cells below Column headers to the left\nWorksheets(2).Range(\"A3:D10003\").Select\nSelection.HorizontalAlignment = xlLeft\n\n'Give background color to cells A1:C1\nWorksheets(2).Range(\"A1:C1\").Select\nWith Selection.Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorDark1\n    .TintAndShade = -0.149998474074526\n    .PatternTintAndShade = 0\nEnd With\nSelection.HorizontalAlignment = xlLeft\n\nWorksheets(2).Range(\"D1\").Select\nSelection.Clear\n\n\n\nEnd Sub\n</code></pre>\n\n<p>This seems like a very simple problem, yet I don't know how to get around these errors. </p>\n"}, {"tags": ["vba", "excel", "integer", "range", "cells"], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 8411407, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e8356bb0c37630319561968a3668499f?s=128&d=identicon&r=PG&f=1", "display_name": "MyName", "link": "https://stackoverflow.com/users/8411407/myname"}, "edited": false, "score": 0, "creation_date": 1502962584, "post_id": 45715505, "comment_id": 78420563, "body": "What do you mean with LngLenC? Is that the total row count? k, clear"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 137, "user_id": 8411407, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e8356bb0c37630319561968a3668499f?s=128&d=identicon&r=PG&f=1", "display_name": "MyName", "link": "https://stackoverflow.com/users/8411407/myname"}, "edited": false, "score": 0, "creation_date": 1502962625, "post_id": 45715505, "comment_id": 78420601, "body": "@MyName - total Columns in the range. It should be the same for both ranges."}, {"owner": {"reputation": 137, "user_id": 8411407, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e8356bb0c37630319561968a3668499f?s=128&d=identicon&r=PG&f=1", "display_name": "MyName", "link": "https://stackoverflow.com/users/8411407/myname"}, "edited": false, "score": 0, "creation_date": 1502962994, "post_id": 45715505, "comment_id": 78420878, "body": "Thanks. Only thing is it selects the whole column. I need to offset it with 1 from the 1st cell (so from cell 2) to end(xlDown). I tried toying around to little succes. Can you specify where this command needs to go?  <code>WsStam.Range(Columns(iKolomnrCorpID), Columns(iKolomnrCorpID)).Copy</code>"}, {"owner": {"reputation": 137, "user_id": 8411407, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e8356bb0c37630319561968a3668499f?s=128&d=identicon&r=PG&f=1", "display_name": "MyName", "link": "https://stackoverflow.com/users/8411407/myname"}, "edited": false, "score": 0, "creation_date": 1502963998, "post_id": 45715505, "comment_id": 78421611, "body": "That&#39;s unfortunately not what I&#39;m looking for. The range is dynamic which is why I need to use <code>.End(xlDown)</code>. I need to be able to use the integer I&#39;ve assigned to the columns (So that users can add whatever columns they want. The ones used for calculations keep the set number) to copy and paste (if at all possible).  FYI: &#39;ve written the macro to copy and paste the stuff I want. Even with different row counts. However it messes up when users have added columns."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 137, "user_id": 8411407, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e8356bb0c37630319561968a3668499f?s=128&d=identicon&r=PG&f=1", "display_name": "MyName", "link": "https://stackoverflow.com/users/8411407/myname"}, "edited": false, "score": 0, "creation_date": 1502964074, "post_id": 45715505, "comment_id": 78421678, "body": "@MyName - declare a variable for <code>.End(xlDown)</code> and put it instead of <code>100</code>."}, {"owner": {"reputation": 137, "user_id": 8411407, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e8356bb0c37630319561968a3668499f?s=128&d=identicon&r=PG&f=1", "display_name": "MyName", "link": "https://stackoverflow.com/users/8411407/myname"}, "edited": false, "score": 0, "creation_date": 1502968069, "post_id": 45715505, "comment_id": 78424575, "body": "That&#39;s not doable (throws all kinds of errors). I&#39;m gonna update my in initial post to clarify it better."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 137, "user_id": 8411407, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e8356bb0c37630319561968a3668499f?s=128&d=identicon&r=PG&f=1", "display_name": "MyName", "link": "https://stackoverflow.com/users/8411407/myname"}, "edited": false, "score": 0, "creation_date": 1502968335, "post_id": 45715505, "comment_id": 78424754, "body": "@MyName - when I say declare a variable for <code>.End (xlDown)</code> I mean something like this <code>dim k as long : k = Range(&quot;A1&quot;).end(xlDown).row</code>. Then exchange <code>k</code> with <code>100</code>."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1502963451, "last_edit_date": 1502963451, "creation_date": 1502891652, "answer_id": 45715505, "question_id": 45715381, "link": "https://stackoverflow.com/questions/45715381/copying-range-using-column-and-row-numbers-integer-vba/45715505#45715505", "title": "copying range using column and row numbers (integer) vba", "body": "<p><strong><em>Edit:</em></strong>\nThis is a general solution of the question \"How do I copy ranges\". The answer is - declare a source and target and copy the source to the target:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    Dim rngSource   As Range\n    Dim rngTarget   As Range\n\n    With Worksheets(1)\n        Set rngSource = .Range(.Cells(2, \"A\"), .Cells(100, \"B\"))\n        Set rngTarget = .Range(.Cells(2, \"C\"), .Cells(100, \"D\"))\n\n        rngSource.Copy\n        rngTarget.PasteSpecial xlPasteAll\n        Application.CutCopyMode = False\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>If you only want to copy the whole column, try something like this:</p>\n\n<pre><code>Sub TestMe()\n\n    Range(Columns(5), Columns(6)).Copy\n    Range(Columns(7), Columns(8)).PasteSpecial xlPasteAll\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n\n<p>It will copy columns 5 to 6 to columns 7 to 8. Of course, instead of numbers you can put variables.</p>\n\n<hr>\n\n<p>And this is a bit more sophisticated, with variables:</p>\n\n<pre><code>Sub TestMe()\n\n Dim lngCopyColumn   As Long: lngCopyColumn = 2\n Dim lngPasteColumn  As Long: lngPasteColumn = 10\n Dim lngLenC         As Long: lngLenC = 3\n\n Range(Columns(lngCopyColumn), Columns(lngCopyColumn + lngLenC)).Copy\n Range(Columns(lngPasteColumn), Columns(lngPasteColumn + lngLenC)).PasteSpecial xlPasteAll\n Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 8411407, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e8356bb0c37630319561968a3668499f?s=128&d=identicon&r=PG&f=1", "display_name": "MyName", "link": "https://stackoverflow.com/users/8411407/myname"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7382, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1518801179, "creation_date": 1502891254, "last_edit_date": 1518801179, "question_id": 45715381, "link": "https://stackoverflow.com/questions/45715381/copying-range-using-column-and-row-numbers-integer-vba", "title": "copying range using column and row numbers (integer) vba", "body": "<p>I've got a standard template. to counteract the fact that users add their own columns I've indexed all the columns. I made a variable for the title header and assigned a integer to this variable.\nSo column A is always called the string variable <code>ColumnA</code> with integer variable  <code>IColumnA</code>. I've also got a set number of rows and the variable <code>LRow</code> for last row.</p>\n\n<p>My question is:</p>\n\n<p>How can I select a column range with the integer variable?</p>\n\n<p>For instance <code>range(IcolumnA, lastrow .end (xlUp)).Copy</code> (or a variant hereof)</p>\n\n<p>This doesn't work because the integers don't work with the range method (I reckon).</p>\n\n<p>Who can help me along?</p>\n"}, {"tags": ["vba", "excel", "pivot"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502899031, "post_id": 45715358, "comment_id": 78394441, "body": "what is your question?"}, {"owner": {"reputation": 1705, "user_id": 1626443, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/4b512545341f40e0ea191d735034ded9?s=128&d=identicon&r=PG", "display_name": "Spurious", "link": "https://stackoverflow.com/users/1626443/spurious"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502900329, "post_id": 45715358, "comment_id": 78395228, "body": "Added it, basically I don&#39;t want to go and select the field first and then set it but rather directly go for it. In large macros this can make a lot of difference."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502960709, "post_id": 45715358, "comment_id": 78419191, "body": "<code>Set rng = pt.PivotFields(&quot;Price&quot;).PivotItems(1).DataRange</code> or <code>Set rng = pt.PivotFields(1).PivotItems(1).DataRange</code>"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502966920, "post_id": 45715358, "comment_id": 78423719, "body": "you can get a lot of information by examining <code>pt.PivotFields(&quot;Alternative&quot;)</code> in the <i>Watch window</i>.  look for any <i>range</i> objects"}], "answers": [{"comments": [{"owner": {"reputation": 1705, "user_id": 1626443, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/4b512545341f40e0ea191d735034ded9?s=128&d=identicon&r=PG", "display_name": "Spurious", "link": "https://stackoverflow.com/users/1626443/spurious"}, "edited": false, "score": 0, "creation_date": 1502965226, "post_id": 45731821, "comment_id": 78422516, "body": "I will have a look at this but you transformed the <code>pivot table</code>. This isn&#39;t what I was looking for. I have two column headers and it needs to stay that way."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 1705, "user_id": 1626443, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/4b512545341f40e0ea191d735034ded9?s=128&d=identicon&r=PG", "display_name": "Spurious", "link": "https://stackoverflow.com/users/1626443/spurious"}, "edited": false, "score": 0, "creation_date": 1502966552, "post_id": 45731821, "comment_id": 78423453, "body": "this is only an exploration of different ranges available in a pivot table and how rows, columns and cells can be referenced as ranges"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 1705, "user_id": 1626443, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/4b512545341f40e0ea191d735034ded9?s=128&d=identicon&r=PG", "display_name": "Spurious", "link": "https://stackoverflow.com/users/1626443/spurious"}, "edited": false, "score": 0, "creation_date": 1502966800, "post_id": 45731821, "comment_id": 78423627, "body": "i tried to duplicate your pivot table, but i had no luck. now that you mentioned the two column headers, i see what i missed. not sure what the original data would look like. i think that your diagram needs another horizontal line right above the word &quot;Price&quot;"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 1705, "user_id": 1626443, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/4b512545341f40e0ea191d735034ded9?s=128&d=identicon&r=PG", "display_name": "Spurious", "link": "https://stackoverflow.com/users/1626443/spurious"}, "edited": false, "score": 0, "creation_date": 1503036347, "post_id": 45731821, "comment_id": 78456270, "body": "i think that i was able to duplicate your pivot table and i replaced the posted code.  data table is 4 columns ... alternative/price/length/cost ... pivot fields are:  <i>alternative</i> - filters .... <i>length</i> and <i>cost</i> - values (named <i>ft</i> and <i>costs</i>)   .... <i>price</i> - rows .... Values - columns. i hope it works for you"}, {"owner": {"reputation": 1705, "user_id": 1626443, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/4b512545341f40e0ea191d735034ded9?s=128&d=identicon&r=PG", "display_name": "Spurious", "link": "https://stackoverflow.com/users/1626443/spurious"}, "edited": false, "score": 0, "creation_date": 1503053098, "post_id": 45731821, "comment_id": 78466538, "body": "Let me check next week, will let you know."}], "tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1503035916, "last_edit_date": 1503035916, "creation_date": 1502963369, "answer_id": 45731821, "question_id": 45715358, "link": "https://stackoverflow.com/questions/45715358/use-range-instead-of-pivotselect-set-rng-selection/45731821#45731821", "title": "Use Range instead of PivotSelect --&gt; Set rng = Selection", "body": "<p>here is a bunch of test code that i used to identify ranges in a pivot table</p>\n\n<p>it just does .Select on each range so that the range is visible on the worksheet</p>\n\n<p>some of the ranges are single cells, so .Select can be replaced by .Value</p>\n\n<p>just step code with F8 key and watch the different ranges in the pivot table show up.</p>\n\n<pre><code>Sub pivot()\n\n    Dim piv As pivotTable\n    Set piv = ActiveSheet.PivotTables(\"PivotTable3\")\n\n    piv.TableRange1.Select\n    piv.TableRange2.Select\n    piv.DataBodyRange.Select\n    piv.RowRange.Select\n    piv.ColumnRange.Select\n    piv.PageRange.Select\n    piv.PageRangeCells.Select\n\n\n    Dim aaa As Variant\n    aaa = piv.DataBodyRange.Value   ' array\n    aaa = piv.DataBodyRange.Value2  ' array\n    aaa = piv.DataBodyRange.Formula ' array\n\n    piv.DataBodyRange.PivotField.LabelRange.Select\n    piv.DataBodyRange.PivotField.DataRange.Select\n\n    piv.DataBodyRange.Next.PivotField.LabelRange.Select\n    piv.DataBodyRange.Next.PivotField.DataRange.Select\n\n    piv.DataBodyRange.PivotItem.LabelRange.Select\n    piv.DataBodyRange.PivotItem.DataRange.Select\n\n    piv.PivotFields(\"Price\").LabelRange.Select\n    piv.PivotFields(\"Price\").DataRange.Select\n\n    piv.PivotFields(\"ft\").LabelRange.Select\n    piv.PivotFields(\"ft\").DataRange.Select\n\n    piv.PivotFields(\"Costs\").LabelRange.Select\n    piv.PivotFields(\"Costs\").DataRange.Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1705, "user_id": 1626443, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/4b512545341f40e0ea191d735034ded9?s=128&d=identicon&r=PG", "display_name": "Spurious", "link": "https://stackoverflow.com/users/1626443/spurious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1359, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503035916, "creation_date": 1502891193, "last_edit_date": 1531164843, "question_id": 45715358, "link": "https://stackoverflow.com/questions/45715358/use-range-instead-of-pivotselect-set-rng-selection", "title": "Use Range instead of PivotSelect --&gt; Set rng = Selection", "body": "<p>I know I can select a specific column in a <code>pivot table</code> in <code>VBA</code> using this:</p>\n\n<pre><code>pt.PivotSelect \"Costs Alternative['1']\", xlDataOnly, True\nSet rng = Selection\n</code></pre>\n\n<p>Now, this is a bit annoying and not quite as fast and resilient as just going straight for:</p>\n\n<pre><code>Set rng = pt.PivotFields(\"Alternative\").PivotFields(\"1\").PivotItems(\"Costs\").DataRange\n</code></pre>\n\n<p>My pivot table looks roughly like this:</p>\n\n<pre><code>+-------+-------------+--------+\n|       | Alternative | Values |\n|       | 1           |        |\n| Price | ft          | Costs  |\n+-------+-------------+--------+\n| 6.58  | 6.00        | 39.48  |\n| 2.00  | 2.00        | 4.00   |\n| 0.30  | 6.00        | 1.80   |\n| Total | 14.00       | 45.28  |\n+-------+-------------+--------+\n</code></pre>\n\n<p>Keep in mind that only one <code>Alternative</code> is listed in the data but in my actual pivot there are a lot more alternatives.</p>\n\n<p>Is there a way to reference the pivot result value cell similar to the above?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1502891750, "post_id": 45715300, "comment_id": 78389073, "body": "You want to find each cell in column E that contains a value equal to whatever is in range B8 and then copy all the matching rows, or...? It&#39;s not completely clear to me."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1502892057, "post_id": 45715300, "comment_id": 78389286, "body": "Change <code>If cell.Value = &quot;B8&quot; Then</code> to <code>If cell.Value = range(&quot;B8&quot;).Value Then</code> for starters.."}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 6640500, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/89fc6fb423362fc6ed64691c58975695?s=128&d=identicon&r=PG&f=1", "display_name": "Lampoa", "link": "https://stackoverflow.com/users/6640500/lampoa"}, "edited": false, "score": 0, "creation_date": 1502896367, "post_id": 45715742, "comment_id": 78392506, "body": "I just tried this, and it gave me a runtime error, &quot;Script out of range&quot;"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 129, "user_id": 6640500, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/89fc6fb423362fc6ed64691c58975695?s=128&d=identicon&r=PG&f=1", "display_name": "Lampoa", "link": "https://stackoverflow.com/users/6640500/lampoa"}, "edited": false, "score": 0, "creation_date": 1502898912, "post_id": 45715742, "comment_id": 78394359, "body": "@Lampoa There was missing double-quotes around <code>RawDataLoader</code>. Try again the edited code. btw this would&#39;ve been easier to catch had you used <code>Option Explicit</code>, which is always recommended."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1502898820, "last_edit_date": 1502898820, "creation_date": 1502892281, "answer_id": 45715742, "question_id": 45715300, "link": "https://stackoverflow.com/questions/45715300/copying-a-row-from-a-table-using-a-cell-that-contains-a-vlookup-equation/45715742#45715742", "title": "Copying a Row from a Table using a cell that contains a VLOOKUP equation", "body": "<p>You just need to use <code>Sheets(\"Dashboard\").Range(\"B8\").value</code> instead of <code>\"B8\"</code>. You can also simplify your code; avoid using <code>Select</code> and loop only on the used range instead of the full column.</p>\n\n<pre><code>Sub Test()\n  Dim cell as Range\n  For Each cell In Intersect(Sheets(\"RawDataLoader\").UsedRange, Sheets(\"RawDataLoader\").Range(\"E:E\"))\n    If cell.Value = Sheets(\"Dashboard\").Range(\"B8\").value Then\n      cell.EntireRow.copy Sheets(\"Dashboard\").Rows(cell.Row)\n    End If\n  Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 6640500, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/89fc6fb423362fc6ed64691c58975695?s=128&d=identicon&r=PG&f=1", "display_name": "Lampoa", "link": "https://stackoverflow.com/users/6640500/lampoa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1502898820, "creation_date": 1502891051, "question_id": 45715300, "link": "https://stackoverflow.com/questions/45715300/copying-a-row-from-a-table-using-a-cell-that-contains-a-vlookup-equation", "title": "Copying a Row from a Table using a cell that contains a VLOOKUP equation", "body": "<p>I am pretty unfamiliar with VBA, and I am stuck with this portion of my code. I have a cell with a vlookup equation in it I'd like to use as a parameter to find a value in a table on a different sheet and copy the entire row over to a different sheet. I've used <a href=\"https://stackoverflow.com/questions/20269725/copy-a-row-from-one-sheet-to-another-sheet-if-the-row-contains-a-certain-value\">this code</a> in the past to copy data over based on a single parameter, but I think the problem I'm running into is that the cell I'm trying to reference contains a vlookup equation in it. </p>\n\n<pre><code>Sub Test()\nFor Each cell In Sheets(RawDataLoader).Range(\"E:E\")\nIf cell.Value = \"B8\" Then\n    matchRow = cell.Row\n    Rows(matchRow &amp; \":\" &amp; matchRow).Select\n    Selection.Copy\n\n    Sheets(\"Dashboard\").Select\n    ActiveSheet.Rows(matchRow).Select\n    ActiveSheet.Paste\n    Sheets(\"RawDataLoader\").Select\nEnd If\nNext\nEnd Sub\n</code></pre>\n\n<p>RawDataLoader is the sheet with my table</p>\n\n<p>Dashboard is the sheet where I want the cells to go</p>\n\n<p>B8 is the cell on the sheet Dashboard I want to use as the value the table looks up.</p>\n\n<p>The range with the values I want it to search through is E:E and on the RawDataLoader sheet.</p>\n\n<p>I know that the cell.value portion of my code is incorrect, I just do not know how to reference a cell value, so I put the cell I wanted to reference.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 0, "creation_date": 1502890403, "post_id": 45714842, "comment_id": 78388097, "body": "In which line the execution fails?"}, {"owner": {"reputation": 13, "user_id": 8441789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jf3vC.png?s=128&g=1", "display_name": "JDH", "link": "https://stackoverflow.com/users/8441789/jdh"}, "reply_to_user": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 0, "creation_date": 1502890650, "post_id": 45714842, "comment_id": 78388269, "body": "If InStr(1, Cells(i, &quot;C&quot;).Value, myVariable) &gt; 0 Then"}, {"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 1, "creation_date": 1502893625, "post_id": 45714842, "comment_id": 78390539, "body": "Frankly I don&#39;t know why it works at all. Looks like this code was copied from Excel. In Access direct calls like Cell should not work. Use variables like <code>xl.Sheets(&quot;Sheet1&quot;).Cells(i, &quot;C&quot;)</code>"}, {"owner": {"reputation": 13, "user_id": 8441789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jf3vC.png?s=128&g=1", "display_name": "JDH", "link": "https://stackoverflow.com/users/8441789/jdh"}, "reply_to_user": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 0, "creation_date": 1502898269, "post_id": 45714842, "comment_id": 78393891, "body": "Thanks Sergey.  I will try your suggestion and post the results when my meetings are over."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1502903705, "post_id": 45714842, "comment_id": 78397169, "body": "Don&#39;t forget the second <code>Cells</code> in the row below that, and don&#39;t forget to save the file using the <code>.Save</code> method on the <code>Workbook</code> object."}, {"owner": {"reputation": 13, "user_id": 8441789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jf3vC.png?s=128&g=1", "display_name": "JDH", "link": "https://stackoverflow.com/users/8441789/jdh"}, "edited": false, "score": 0, "creation_date": 1502911737, "post_id": 45714842, "comment_id": 78401204, "body": "That worked perfectly Sergey.  Thanks for the tip. Another question about the commented out section in the code snippit I originally provided, I can&#39;t get the row count to return anything but a 1 and for the life of me all the googling I do isn&#39;t helpful.  Can ylou suggesxt a method for that please?  Erik - Thanks for looking out! :)"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8441789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jf3vC.png?s=128&g=1", "display_name": "JDH", "link": "https://stackoverflow.com/users/8441789/jdh"}, "edited": false, "score": 0, "creation_date": 1502980514, "post_id": 45726748, "comment_id": 78433773, "body": "Thanks again Sergey!!  This works perfectly with only one minor change.  I had to put () around the variable in Set wb = xl.Workbooks.Open (strInputFile).  No big deal but wanted to mention it for potential future viewers of this post.  I also clicked the up arrow of this answer but since I am brand new to this site apparently my votes don&#39;t count yet.  :-)"}, {"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "reply_to_user": {"reputation": 13, "user_id": 8441789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jf3vC.png?s=128&g=1", "display_name": "JDH", "link": "https://stackoverflow.com/users/8441789/jdh"}, "edited": false, "score": 0, "creation_date": 1503026091, "post_id": 45726748, "comment_id": 78453083, "body": "Yes, of course () needed here, I edited the answer. If answer worked for you, accept it, a green check mark will appear below the vote counter"}], "tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": true, "score": 2, "last_activity_date": 1503025928, "last_edit_date": 1503025928, "creation_date": 1502945136, "answer_id": 45726748, "question_id": 45714842, "link": "https://stackoverflow.com/questions/45714842/access-vba-to-open-edit-and-save-excel-doc/45726748#45726748", "title": "Access VBA to open, edit and save Excel doc", "body": "<p>The Excel VBA code for using in Access should be modified. You cannot use direct calls of Excel library methods like <code>Cell</code>. Declare variables for Excel.Application, Workbook and Worksheet and use them for referencing worksheet cells. Avoid using Activate methods. So, in your case the code will be like this:</p>\n\n<pre><code>Dim xl As Excel.Application\nDim wb As Excel.Workbook\nDim ws As Excel.Worksheet\nDim lRowCount As Long\n\nDim myRange As Excel.Range\n\nSet xl = CreateObject(\"Excel.Application\")\nstrInputFile = varItem\nSet wb = xl.Workbooks.Open(strInputFile)\nSet ws = wb.Sheets(\"Sheet1\")\n\nlRowCount = ws.UsedRange.Rows.Count\n'Make the changes\nj = 0\nIf Left(strFile, 4) = \"xxxx\" Then\n    myPath = \"\\\\a\\path\\for\\xxxx\"\n    If InStr(1, strFile, \"IQ\") Then\n        For i = 1 To lRowCount\n            If InStr(1, ws.Cells(i, \"C\").Value, myVariable) &gt; 0 Then\n                ws.Cells(i, \"B\") = \"New Value\"\n                j = j + 1\n            End If\n        Next\n    End If\nEnd If\n\nwb.Save\n'Clean up\nxl.Quit\nSet xl = Nothing\n</code></pre>\n\n<p>Don't forget to add a reference to Microsoft Excel library</p>\n"}], "owner": {"reputation": 13, "user_id": 8441789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jf3vC.png?s=128&g=1", "display_name": "JDH", "link": "https://stackoverflow.com/users/8441789/jdh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13007, "favorite_count": 0, "accepted_answer_id": 45726748, "answer_count": 1, "score": 1, "last_activity_date": 1503025928, "creation_date": 1502889850, "question_id": 45714842, "link": "https://stackoverflow.com/questions/45714842/access-vba-to-open-edit-and-save-excel-doc", "title": "Access VBA to open, edit and save Excel doc", "body": "<p>I have an Access DB to open, edit and save an Excel doc that works fine the first time run but if I try to alter more than one file (or the same file twice) it fails with \"Run-time error '1004': Method 'Cells' of object '_Global' failed\"</p>\n\n<p>If I close the DB then re-open it, it again works fine for the first file altered.</p>\n\n<p>Although I am not new to VBA I would say that I am a novice.  Here is a snippit of the code I am using:</p>\n\n<pre><code>    Code:\n        'Open spreadsheet and make it visible\n        Set xl = CreateObject(\"Excel.Application\")\n        strInputFile = varItem\n        xl.Workbooks.Open strInputFile\n        xl.Visible = True\n\n        'Trying to get row count here but not working yet\n        'Set myRange = xl.Sheets(\"Sheet1\").Range(\"C:C\")\n        'lRowCount = Excel.Application.WorksheetFunction.CountA(\"Sheet1\").Range(\"C:C\")\n        'lRowCount = xl.WorksheetFunction.CountA(Worksheets(\"Sheet1\").Cells(C, C))\n        'Debug.Print lRowCount\n        'strMyRange = \"C:C\"\n        'lRowCount = xl.WorksheetFunction.CountA(strMyRange)\n        'Debug.Print lRowCount\n        'lRowCount = Excel.Application.WorksheetFunction.CountA(Workbooks(strInputFile).Sheets(\"Sheet1\").Range(\"C:C\"))\n        'Debug.Print lRowCount\n\n        'Make the changes\n        j = 0\n        If Left(strFile, 4) = \"xxxx\" Then \n            myPath = \"\\\\a\\path\\for\\xxxx\"\n            If InStr(1, strFile, \"IQ\") Then\n                For i = 1 To 500 'Row count not working yet\n                    If InStr(1, Cells(i, \"C\").Value, myVariable) &gt; 0 Then\n                        Cells(i, \"B\") = \"New Value\"\n                        j = j + 1\n                    End If\n                Next\n            End If\n        End If\n\n'Clean up\nxl.Quit\nSet xl = Nothing\nSet objInputFile = Nothing\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8472551, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v1qui.jpg?s=128&g=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/8472551/ben"}, "edited": false, "score": 0, "creation_date": 1502890105, "post_id": 45714635, "comment_id": 78387887, "body": "Thank you Olly for your reply. This code seems to have no effect. Is there something I missed?"}, {"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "reply_to_user": {"reputation": 11, "user_id": 8472551, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v1qui.jpg?s=128&g=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/8472551/ben"}, "edited": false, "score": 0, "creation_date": 1502890607, "post_id": 45714635, "comment_id": 78388237, "body": "I have no idea what you might have missed. Have you tried stepping through it (pressing F8) ?"}, {"owner": {"reputation": 11, "user_id": 8472551, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v1qui.jpg?s=128&g=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/8472551/ben"}, "edited": false, "score": 0, "creation_date": 1502891271, "post_id": 45714635, "comment_id": 78388736, "body": "Stepping through the code, it works but is still pasting beyond the blank cell in column U all the way to Z700. Essentially what picture 1 depicts above."}, {"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "reply_to_user": {"reputation": 11, "user_id": 8472551, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v1qui.jpg?s=128&g=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/8472551/ben"}, "edited": false, "score": 0, "creation_date": 1502891573, "post_id": 45714635, "comment_id": 78388946, "body": "Did you pick up on the edit I made, about a minute after posting?"}, {"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "reply_to_user": {"reputation": 11, "user_id": 8472551, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v1qui.jpg?s=128&g=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/8472551/ben"}, "edited": false, "score": 0, "creation_date": 1502892415, "post_id": 45714635, "comment_id": 78389540, "body": "I&#39;ve added another version, in case your blank cells below your data range in Column U are actually formulas returning blank values."}, {"owner": {"reputation": 11, "user_id": 8472551, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v1qui.jpg?s=128&g=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/8472551/ben"}, "edited": false, "score": 0, "creation_date": 1502896038, "post_id": 45714635, "comment_id": 78392282, "body": "I&#39;m not sure about the edit, but Sub foo2() works perfectly. Thank you so much for your help!"}], "tags": [], "owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "is_accepted": false, "score": 1, "last_activity_date": 1502892381, "last_edit_date": 1502892381, "creation_date": 1502889304, "answer_id": 45714635, "question_id": 45714464, "link": "https://stackoverflow.com/questions/45714464/subtract-single-cell-value-from-column-until-empty-cell/45714635#45714635", "title": "Subtract Single Cell Value from Column Until Empty Cell", "body": "<p>Try this:</p>\n\n<pre><code>Sub foo()\n    Dim lRow As Long\n    With ActiveSheet\n        lRow = .Cells(Rows.Count, \"U\").End(xlUp).Row\n        .Range(\"U9:U\" &amp; lRow).Copy .Range(\"Z9\")\n        With .Range(\"U8\")\n            .Formula = \"=MIN(U9:U\" &amp; lRow &amp; \")\"\n            .Copy\n        End With\n        .Range(\"Z9:Z\" &amp; lRow).PasteSpecial Paste:=xlPasteValues, Operation:=xlSubtract\n        Application.CutCopyMode = False\n    End With\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>If you have formulas in Column U, below your list of numbers, which are returning blank values, then this revision might work better for you:</p>\n\n<pre><code>Sub foo2()\n    Dim lRows As Long\n    With ActiveSheet\n        lRows = WorksheetFunction.Count(.Range(\"U9:U700\"))\n        .Range(\"U8\").Formula = \"=MIN(\" &amp; .Range(\"U9\").Resize(lRows, 1).Address(0, 0) &amp; \")\"\n        .Range(\"U9\").Resize(lRows, 1).Copy\n        .Range(\"Z9\").PasteSpecial Paste:=xlPasteValues\n        .Range(\"U8\").Copy\n        .Range(\"Z9\").Resize(lRows, 1).PasteSpecial Paste:=xlPasteValues, Operation:=xlSubtract\n    End With\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8472551, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v1qui.jpg?s=128&g=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/8472551/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1502892381, "creation_date": 1502888921, "last_edit_date": 1531164843, "question_id": 45714464, "link": "https://stackoverflow.com/questions/45714464/subtract-single-cell-value-from-column-until-empty-cell", "title": "Subtract Single Cell Value from Column Until Empty Cell", "body": "<p>I'm looking to 'normalize' a column of data by setting the minimum value to 0 and shifting the entire column's data by the difference of the min value and 0.</p>\n\n<p>The code should be simple, but I can't find the appropriate range selection to stop the code when it reaches a blank cell. </p>\n\n<p>Below is the core that I've unsuccessfully been working off of trying to recognize the first empty cell in column U after U9 up to U700 and correspondingly stop subtracting in column Z. Example screenshots are attached. Thank you!</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n[Z9:Z700] = [U9:U700-U8]\n\nEnd Sub\n</code></pre>\n\n<p>This is what I get:</p>\n\n<p><img src=\"https://i.stack.imgur.com/WgJDr.jpg\" alt=\"This is what I get\"></p>\n\n<p>This is what I would like to get:</p>\n\n<p><img src=\"https://i.stack.imgur.com/e6Uon.jpg\" alt=\"This is what I would like to get\"></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 1, "creation_date": 1502887663, "post_id": 45713917, "comment_id": 78385978, "body": "Use the <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/on-error-statement\" rel=\"nofollow noreferrer\"><code>On Error</code></a>-Statement."}], "answers": [{"comments": [{"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1502891980, "post_id": 45713996, "comment_id": 78389237, "body": "Thanks, do I understand correctly that <code>ExcelApp.Quit</code> quits all the workbooks opened inside a given application instance, so that I don&#39;t need to <code>dataWorkbook.Close</code> specifically?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1502892056, "post_id": 45713996, "comment_id": 78389285, "body": "@ans Yes <code>ExcelApp.Quit</code> quits exactly the instance you opened with <code>Set ExcelApp = CreateObject(&quot;Excel.Application&quot;)</code> nothing more! All workbooks inside that instance obviously get closed too then."}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1502892687, "post_id": 45713996, "comment_id": 78389749, "body": "I encountered a bit of a problem now. I added <code>CLOSE_FILE_ON_ERROR: Application.StatusBar = &quot;Error occured&quot; ExcelApp.Quit</code> at the end of the sub and the <code>On Error GoTo CLOSE_FILE_ON_ERROR</code> at the beginning. The problem is, now even if the code runs without errors, when it reaches the <code>CLOSE_FILE_ON_ERROR</code> it executes the code and changes the status bar.."}, {"owner": {"reputation": 593, "user_id": 3421419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar7RS.jpg?s=128&g=1", "display_name": "abraxascarab", "link": "https://stackoverflow.com/users/3421419/abraxascarab"}, "reply_to_user": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 1, "creation_date": 1502893505, "post_id": 45713996, "comment_id": 78390442, "body": "@Ans: Peh forgot to show you that you need an <code>Exit Sub</code> on the line before the label <code>CLOSE_FILE_ON_ERROR:</code>.  Using that command will keep the good code from running the error code at the end.  Just don&#39;t forget to &#39;quit&#39; you app in the good code as well."}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "reply_to_user": {"reputation": 593, "user_id": 3421419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar7RS.jpg?s=128&g=1", "display_name": "abraxascarab", "link": "https://stackoverflow.com/users/3421419/abraxascarab"}, "edited": false, "score": 0, "creation_date": 1502895056, "post_id": 45713996, "comment_id": 78391601, "body": "@abraxascarab Thank you, sir."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 593, "user_id": 3421419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar7RS.jpg?s=128&g=1", "display_name": "abraxascarab", "link": "https://stackoverflow.com/users/3421419/abraxascarab"}, "edited": false, "score": 0, "creation_date": 1502896326, "post_id": 45713996, "comment_id": 78392478, "body": "@abraxascarab No Peh did not forgot to show that. Everything changed because @ans inserted <code>Application.StatusBar = &quot;Error occured&quot;</code>. Because if you have an <code>Exit Sub</code> before <code>CLOSE_FILE_ON_ERROR:</code> then the <code>ExcelApp</code> will remain open forever if there is no error. If you do that then you will also need another <code>ExcelApp.Quit</code> before the <code>Exit Sub</code> to quit it if there is no error. (see my edit)."}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1502897154, "post_id": 45713996, "comment_id": 78393067, "body": "@Peh I have two <code>ExcelApp.Quit</code>: one before the <code>CLOSE_FILE_ON_ERROR:</code> and one after. Given that, I suppose it&#39;s ok to have <code>Exit Sub</code> right before <code>CLOSE_FILE_ON_ERROR:</code>?"}, {"owner": {"reputation": 593, "user_id": 3421419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar7RS.jpg?s=128&g=1", "display_name": "abraxascarab", "link": "https://stackoverflow.com/users/3421419/abraxascarab"}, "reply_to_user": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 1, "creation_date": 1502909312, "post_id": 45713996, "comment_id": 78400104, "body": "@Ans:  You are correct.  @ Peh: Sorry... I didn&#39;t mean to step on toes.  Your answer is completely the correct way to handle the situation."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 5, "last_activity_date": 1502896509, "last_edit_date": 1592644375, "creation_date": 1502887758, "answer_id": 45713996, "question_id": 45713917, "link": "https://stackoverflow.com/questions/45713917/excel-vba-kill-an-invisible-application-after-an-error/45713996#45713996", "title": "Excel vba kill an invisible application after an error", "body": "<p>At the top of your procedure use an error handler like</p>\n<pre><code>Set ExcelApp = CreateObject(&quot;Excel.Application&quot;)\nOn Error Goto CLOSE_FILE_ON_ERROR\n  'With that line you tell VBA to jump to the closing part if an error happens\n</code></pre>\n<p>and use this goto marker before you close the file.</p>\n<pre><code>CLOSE_FILE_ON_ERROR:\n    ExcelApp.Quit\nEnd Sub\n</code></pre>\n<p>Note: You don't need to <code>Set ExcelApp = Nothing</code>  because Excel does this automatically on <code>End Sub</code>.</p>\n<hr />\n<h3>Edit due to comments</h3>\n<p>If you need to show error messages or something then your code has to be extended like this:</p>\n<pre><code>    ExcelApp.Quit 'This is needed to regularly quit if there is no error\n    Exit Sub 'Don't run into error handling if there was no exeption\n\nCLOSE_FILE_ON_ERROR:\n    Application.StatusBar = &quot;Error occured&quot;\n    ExcelApp.Quit 'This is needed to quit after an exeption if there is an error\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1502887848, "post_id": 45714009, "comment_id": 78386102, "body": "I think using a correct error handling would be the better idea."}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1502888003, "post_id": 45714009, "comment_id": 78386243, "body": "@Peh : I have edited the my comment and it can be merged with the error handler as your answer suggested."}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1502888007, "post_id": 45714009, "comment_id": 78386244, "body": "@Vityata : No, This code does not belongs to me :P, i got part of it from Stackoverflow. This code is very strong as it actually kills all the application mentioned in the code. This is just a vba version Task Manager Kill"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1502888127, "post_id": 45714009, "comment_id": 78386340, "body": "@nishitdey - well, I saw the part with <code>EXCEL.EXE&#39;,&#39;Chrome.exe&#39;,&#39;iexplore.exe</code> and actually thought that this looks like an overkill."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1502888230, "post_id": 45714009, "comment_id": 78386424, "body": "I still think that <code>ExcelApp.Quit</code> is a way better to end an Excel instance regularly than killing a process the hard way."}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1502888317, "post_id": 45714009, "comment_id": 78386513, "body": "@Vityata : I am too lazy to shutdown the application"}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1502891701, "post_id": 45714009, "comment_id": 78389036, "body": "I&#39;ll try it out, but why do you kill Chrome.exe as well? I need the internet, after all. And the problem is, wouldn&#39;t you method kill the visible excel applications as well? I currently do the same manually - open the task manager and kill EXCEL.EXE, but to do so I need to get rid of visible needed application, which upsets me."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1502891976, "post_id": 45714009, "comment_id": 78389232, "body": "@ans Have a look at my answer then to specifically close the invisible Excel application only and to leave all other Excel applications open."}], "tags": [], "owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "is_accepted": false, "score": 4, "last_activity_date": 1502890564, "last_edit_date": 1502890564, "creation_date": 1502887791, "answer_id": 45714009, "question_id": 45713917, "link": "https://stackoverflow.com/questions/45713917/excel-vba-kill-an-invisible-application-after-an-error/45714009#45714009", "title": "Excel vba kill an invisible application after an error", "body": "<p>You can try the below code where I kill the application like Excel, Chrome and Internet Explorer. You can use the below code with the <code>On Error Goto</code> error handler.</p>\n\n<pre><code>Public Function fnkilltask()\n    Dim objWMIService\n    Dim colProcessList\n    Dim objProcess\n    Dim strComputer\n\n    strComputer = \".\" \n    Set objWMIService = GetObject(\"winmgmts://./root/cimv2\")  ' Task mgr\n    Set colProcessList = objWMIService.ExecQuery (\"Select * from Win32_Process Where Name in ('EXCEL.EXE','Chrome.exe','iexplore.exe') \") \n\n    For Each objProcess in colProcessList \n        objProcess.Terminate() \n    Next\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1038, "favorite_count": 0, "accepted_answer_id": 45713996, "answer_count": 2, "score": 3, "last_activity_date": 1502896509, "creation_date": 1502887513, "last_edit_date": 1531164843, "question_id": 45713917, "link": "https://stackoverflow.com/questions/45713917/excel-vba-kill-an-invisible-application-after-an-error", "title": "Excel vba kill an invisible application after an error", "body": "<p>I have an application that first creates an invisible application:</p>\n\n<pre><code>        Dim ExcelApp As Object\n        Set ExcelApp = CreateObject(\"Excel.Application\")\n        ExcelApp.Visible = False\n        ExcelApp.ScreenUpdating = False\n        ExcelApp.DisplayAlerts = False\n        ExcelApp.EnableEvents = False\n</code></pre>\n\n<p>And then proceeds to use it to open files invisibly:</p>\n\n<pre><code>      Do While fileTitle &lt;&gt; \"\"\n          Dim dataWorkbook As Workbook\n          Set dataWorkbook = ExcelApp.Application.Workbooks.Open(folderPath &amp; fileTitle)\n</code></pre>\n\n<p>At the end of the operations with the file macros closes the file:</p>\n\n<pre><code>          dataWorkbook.Close\n          fileTitle = Dir()\n         Loop\n</code></pre>\n\n<p>At the end of the sub macros closes the application:</p>\n\n<pre><code>      ExcelApp.Quit\n      Set ExcelApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>However, if an error occurs before the file is closed, the invisible file and the application would never be closed and would continue to linger in operation systems not only eating away the memory and resources, but also preventing from doing any operations with the opened filed - renaming, opening or editting it.</p>\n\n<p>I wonder if there is a way to close both the file and the application if an error occurs - in the current macros or to create a separate macros that detects invisible applications no variable points to and closes it.</p>\n"}, {"tags": ["html", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8472440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4607f7b4a44a655612eae0ed8271f73c?s=128&d=identicon&r=PG&f=1", "display_name": "blimbert", "link": "https://stackoverflow.com/users/8472440/blimbert"}, "edited": false, "score": 0, "creation_date": 1502889541, "post_id": 45714416, "comment_id": 78387489, "body": "Thank you for the suggestion - I could use your recommendation if I wanted to set it to Calibri size 11.  However, I do not wish to hard code the font - I prefer to simply let it default to the users settings for their outlook messages.  Do you have an alternative recommendation?"}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "reply_to_user": {"reputation": 21, "user_id": 8472440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4607f7b4a44a655612eae0ed8271f73c?s=128&d=identicon&r=PG&f=1", "display_name": "blimbert", "link": "https://stackoverflow.com/users/8472440/blimbert"}, "edited": false, "score": 0, "creation_date": 1502890749, "post_id": 45714416, "comment_id": 78388356, "body": "You can use the default font which you want, as the HTML have only 3 fonts and will select whichever is present."}], "tags": [], "owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "is_accepted": false, "score": 0, "last_activity_date": 1502888804, "creation_date": 1502888804, "answer_id": 45714416, "question_id": 45713880, "link": "https://stackoverflow.com/questions/45713880/outlook-determine-users-default-mail-font-style-and-size/45714416#45714416", "title": "Outlook Determine Users default mail font style and size", "body": "<p>Can you use the below:</p>\n\n<pre><code>objOutlookMsg= \"&lt;BODY style=font-size:11pt;font-family:Calibri&gt;This is the body of the email, which contains a link to Google.  \" &amp; _\n                                    \"&lt;a href='http://www.google.com'&gt;www.google.com&lt;a/&gt;. \" &amp; _\n                                    \"Can you please help me figure out the font for the whole message?  \" &amp; _\n                                    \"Why does it default to Times New Roman point 12 instead of the users' default mail font?\"&lt;/BODY&gt;\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5184834, "user_type": "registered", "profile_image": "https://graph.facebook.com/950611854985041/picture?type=large", "display_name": "Pratik Gupta", "link": "https://stackoverflow.com/users/5184834/pratik-gupta"}, "is_accepted": false, "score": 0, "last_activity_date": 1503830408, "last_edit_date": 1503830408, "creation_date": 1502890128, "answer_id": 45714946, "question_id": 45713880, "link": "https://stackoverflow.com/questions/45713880/outlook-determine-users-default-mail-font-style-and-size/45714946#45714946", "title": "Outlook Determine Users default mail font style and size", "body": "<p>Hi There I check your problem. Outlook does not support the external font. So Times New Roman is the default font for outlook. You can use system default font like. arial. Plus you should define your font inline. That is the best way to deal with it. </p>\n"}, {"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1502902135, "creation_date": 1502902135, "answer_id": 45719061, "question_id": 45713880, "link": "https://stackoverflow.com/questions/45713880/outlook-determine-users-default-mail-font-style-and-size/45719061#45719061", "title": "Outlook Determine Users default mail font style and size", "body": "<p>The settings are stored in \n<code>HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\16.0\\Common\\MailSettings</code> (where \"<code>16.0</code>\" is the Outlook version). the name of the font is embedded is in the <code>ComposeFontSimple</code> binary value; <code>ComposeFontComplex</code> seems to contain the HTML template used for new messages.</p>\n"}], "owner": {"reputation": 21, "user_id": 8472440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4607f7b4a44a655612eae0ed8271f73c?s=128&d=identicon&r=PG&f=1", "display_name": "blimbert", "link": "https://stackoverflow.com/users/8472440/blimbert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 191, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1593072086, "creation_date": 1502887425, "last_edit_date": 1593072086, "question_id": 45713880, "link": "https://stackoverflow.com/questions/45713880/outlook-determine-users-default-mail-font-style-and-size", "title": "Outlook Determine Users default mail font style and size", "body": "<p>Good morning - I am trying to draft an email programmatically from Access to Outlook.  </p>\n\n<p>I believe I have properly figured how to create the email, but cannot understand how to use the users default mail message font as the font type.  All messages are coming up Times New Roman, pt 12.  </p>\n\n<p>I've found plenty of articles on how to set the font to a certain style, but I want to use the users' default Outlook font settings.</p>\n\n<pre><code>Sub testHTML()\nDim objOutlook As Outlook.Application\nDim objOutlookMsg As Outlook.MailItem\nDim objOutlookRecip As Outlook.Recipient\n\n          ' Create the Outlook session.\n          Set objOutlook = CreateObject(\"Outlook.Application\")\n\n          ' Create the message.\n          Set objOutlookMsg = objOutlook.CreateItem(olMailItem)\n\n          With objOutlookMsg\n              ' Add the To recipient(s) to the message.\n'              Set objOutlookRecip = .Recipients.Add(\"Whatever Email\")\n'              objOutlookRecip.Type = olTo\n\n             .Subject = \"Testing\"\n             .Display\n\n             'Create HTML body, which will contain a hyperlink\n                objOutlookMsg.HTMLBody = \"This is the body of the email, which contains a link to Google.  \" &amp; _\n                                        \"&lt;a href='http://www.google.com'&gt;www.google.com&lt;a/&gt;. \" &amp; _\n                                        \"Can you please help me figure out the font for the whole message?  \" &amp; _\n                                        \"Why does it default to Times New Roman point 12 instead of the users' default mail font?\"\n        End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["oracle", "vba", "plsql"], "comments": [{"owner": {"reputation": 108986, "user_id": 511529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YNRmY.jpg?s=128&g=1", "display_name": "GolezTrol", "link": "https://stackoverflow.com/users/511529/goleztrol"}, "edited": false, "score": 0, "creation_date": 1502887404, "post_id": 45713832, "comment_id": 78385785, "body": "What do you mean by &#39;pass to&#39;? You can declare user defined types <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/data-types/user-defined-data-type\" rel=\"nofollow noreferrer\">like this</a>, but I don&#39;t think you can actually use the type from Oracle. In addition, I doubt if there is a way to automatically map Oracle data to your user defined type, so you may have to fetch data as separate numbers and combine them again into the VBA type."}, {"owner": {"reputation": 535, "user_id": 3668759, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f071fe3e57f795555dfa339ca70ed7d?s=128&d=identicon&r=PG&f=1", "display_name": "Gadziu", "link": "https://stackoverflow.com/users/3668759/gadziu"}, "reply_to_user": {"reputation": 108986, "user_id": 511529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YNRmY.jpg?s=128&g=1", "display_name": "GolezTrol", "link": "https://stackoverflow.com/users/511529/goleztrol"}, "edited": false, "score": 0, "creation_date": 1502887465, "post_id": 45713832, "comment_id": 78385824, "body": "I mean use this Oracle type as selfdefine VBA type"}], "owner": {"reputation": 535, "user_id": 3668759, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f071fe3e57f795555dfa339ca70ed7d?s=128&d=identicon&r=PG&f=1", "display_name": "Gadziu", "link": "https://stackoverflow.com/users/3668759/gadziu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502887286, "creation_date": 1502887286, "question_id": 45713832, "link": "https://stackoverflow.com/questions/45713832/get-selfdefine-data-type-from-oracle", "title": "Get selfdefine data type from oracle", "body": "<p>I have package in Oracle. In it I have selfdefine data type. f.e.:</p>\n\n<pre><code>TYPE t_test IS RECORD(\n     v_one NUMBER\n   , v_two NUMBER\n);\n</code></pre>\n\n<p>How can I pass this datatype to Excel VBA? f.e:</p>\n\n<pre><code>Dim tTest AS t_test\n</code></pre>\n"}, {"tags": ["excel", "vlookup", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1502887524, "post_id": 45713751, "comment_id": 78385861, "body": "What error are you getting?  My first guess is <i>expected end</i> and you need to fix your quotations.  Related to your example, you can put the space in with invoice, e.g., &quot;invoice &quot; instead of needing the other &amp;."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1502889406, "post_id": 45713751, "comment_id": 78387373, "body": "You&#39;re passing a range of cells (potentially many) as the first parameter of a <code>VLOOKUP</code>, when it would be expecting a value/string - <code>ws_zfi.Range(&quot;H3:H&quot; &amp; lastrow_d)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 1, "last_activity_date": 1502889686, "creation_date": 1502889686, "answer_id": 45714769, "question_id": 45713751, "link": "https://stackoverflow.com/questions/45713751/excel-vlookup-vba/45714769#45714769", "title": "Excel Vlookup VBA", "body": "<p>It's difficult to answer without seeing the source tables but I <em>think</em> you want the following:</p>\n\n<pre><code>For i = 3 To lastrow_d\n    ws_zfi.Range(\"AY\" &amp; i) = \"invoice\" &amp; Application.WorksheetFunction.VLookup(ws_zfi.Range(\"H\" &amp; i), ws_fbl5n.Range(\"D1:G\" &amp; lastrow_d), 4, 0)\nNext i\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5126393, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-vu1ZKviASfA/AAAAAAAAAAI/AAAAAAAAC7s/Mo2uO98i4x0/photo.jpg?sz=128", "display_name": "nikhil nik", "link": "https://stackoverflow.com/users/5126393/nikhil-nik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1502889686, "creation_date": 1502887051, "last_edit_date": 1531161705, "question_id": 45713751, "link": "https://stackoverflow.com/questions/45713751/excel-vlookup-vba", "title": "Excel Vlookup VBA", "body": "<p>I need to add Invoice as a Test and then V lookup formula should run</p>\n\n<p>For example :=\"invoice\"&amp;\" \"&amp;VLOOKUP(H3,FBL5N!D:G,4,0)\nthis formula i need to covert to Macro's</p>\n\n<p>Let me know how to fix i tried my VBA formula as: </p>\n\n<pre><code>On Error Resume Next\nFor i = 3 To lastrow_d\n     ws_zfi.Range(\"AY3:AY\" &amp; lastrow_d) = \"invoice\" &amp; Application.WorksheetFunction.VLookup(ws_zfi.Range(\"H3:H\" &amp; lastrow_d), ws_fbl5n.Range(\"D1:G\" &amp; lastrow_d), 4, 0)\n Next i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 368279, "user_id": 1288, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fc763c6ff6c160ddad05741e87e517b6?s=128&d=identicon&r=PG", "display_name": "Bill the Lizard", "link": "https://stackoverflow.com/users/1288/bill-the-lizard"}, "edited": false, "score": 0, "creation_date": 1502886875, "post_id": 45713492, "comment_id": 78385359, "body": "Do you need to check that events are enabled? If they aren&#39;t, would this code even be running?"}], "answers": [{"tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": true, "score": 2, "last_activity_date": 1502886568, "creation_date": 1502886568, "answer_id": 45713589, "question_id": 45713492, "link": "https://stackoverflow.com/questions/45713492/how-can-one-solve-the-infinite-loop-of-change-events/45713589#45713589", "title": "How can one solve the infinite loop of change events?", "body": "<p>IMO this is the most reliable solution, provided you change your code to:</p>\n\n<pre><code>Public EventsDisabled as boolean\n\nSub Change_Event()\nIf EventsDisabled Then Exit Sub\nEventsDisabled=True\n   enter code which cannot triggers Change_Event here\nEventsDisabled=False\nEnd Sub\n</code></pre>\n\n<p>These changes ensure your event works when the VBA project is reset.</p>\n"}, {"tags": [], "owner": {"reputation": 344, "user_id": 1134623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49cbe1fd6ccd8927321e1cca48987ab?s=128&d=identicon&r=PG", "display_name": "Erin Halbmaier", "link": "https://stackoverflow.com/users/1134623/erin-halbmaier"}, "is_accepted": false, "score": 0, "last_activity_date": 1502887606, "creation_date": 1502887606, "answer_id": 45713945, "question_id": 45713492, "link": "https://stackoverflow.com/questions/45713492/how-can-one-solve-the-infinite-loop-of-change-events/45713945#45713945", "title": "How can one solve the infinite loop of change events?", "body": "<p>Put <code>Application.EnableEvents = False</code> inside your <code>Worksheet_Change</code> sub before running your code.  When your code is finished, turn events back on with <code>Application.EnableEvents = True</code>.</p>\n\n<p>This prevents Excel from firing events (like Worksheet_Change) while your code is running.</p>\n"}], "owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 438, "favorite_count": 1, "accepted_answer_id": 45713589, "answer_count": 2, "score": 1, "last_activity_date": 1502887606, "creation_date": 1502886356, "question_id": 45713492, "link": "https://stackoverflow.com/questions/45713492/how-can-one-solve-the-infinite-loop-of-change-events", "title": "How can one solve the infinite loop of change events?", "body": "<p>I am having an issue with the Change event in general:</p>\n\n<p>I have designed a Userform and Worksheet which is updated if the user changes something like a filter or cells ect. </p>\n\n<p>The problem is now the following: </p>\n\n<p>If something is changed, the change event is triggered and changes some things (cells, lists, filter ect.) and this triggers the same event. Like this you will get an infinite loop of change events. My current solution is the follwing:</p>\n\n<pre><code>Public EventsEnabled as boolean\n\nSub Change_Event()\nIf EnableEvents Then\nEnableEvents=False\n   enter code which cannot triggers Change_Event here\nEnd If\nEnableEvents=True\nEnd Sub\n</code></pre>\n\n<p>So basically I am bypassing this issue by enableing and disabling the change events I use by myself. </p>\n\n<p>Now the question: Is this the best solution or is there something easier, faster or more elegant then this?</p>\n"}, {"tags": ["excel", "vba", "interpolation"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502899723, "post_id": 45713353, "comment_id": 78394881, "body": "how do you identify a redundant row?  what are you interpolating?"}, {"owner": {"reputation": 2784, "user_id": 7256873, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/97aae59e027906195415adc6797340f2?s=128&d=identicon&r=PG&f=1", "display_name": "AK88", "link": "https://stackoverflow.com/users/7256873/ak88"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502901501, "post_id": 45713353, "comment_id": 78395902, "body": "In this particular case the first 2 and the last 4 rows are redundant and I&#39;m interpolating <code>Yield</code>"}], "owner": {"reputation": 2784, "user_id": 7256873, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/97aae59e027906195415adc6797340f2?s=128&d=identicon&r=PG&f=1", "display_name": "AK88", "link": "https://stackoverflow.com/users/7256873/ak88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502885872, "creation_date": 1502885872, "question_id": 45713353, "link": "https://stackoverflow.com/questions/45713353/interpolate-between-two-dynamic-dates-vba", "title": "Interpolate between two dynamic dates VBA", "body": "<p>We have a file that is updated every week and its structure is as follows:</p>\n\n<pre><code>      ID            Code    Days  Yield\nKZW1KM093436    NTK273_1343 4   \u00a02.1781\nKZW1KD913708    NTK091_1370 11  \u00a02.1683\nKZK1KY011222    MKM012_0122 17  \u00a02.1602\nKZW1KM063603    NTK182_1360 32  \u00a02.1419\nKZW1KM093477    NTK273_1347 32  \u00a02.1419\nKZW1KD913740    NTK091_1374 39  \u00a02.1342\nKZW1KM063629    NTK182_1362 46  \u00a02.1269\nKZW1KM093501    NTK273_1350 53  \u00a02.1202\n</code></pre>\n\n<p>I have the following static data points (Days):</p>\n\n<pre><code>28\n91\n182\n273\n364\n730\n1825\n2555\n3640\n</code></pre>\n\n<p>I'd like to get interpolated values for these static days as the file gets updates (basically, every week). When the file gets updated, the structure of the data also changes (sorted by <code>Days</code>). If the value in <code>Days</code> column in the data is equal to any of the values in my <code>Static</code> data, then I'd like to take the corresponding value from <code>Yield</code>. Otherwise, I'd like to take the closest upper and lower values from <code>Days</code> and get interpolated <code>Yield</code>.</p>\n\n<p>So far I was able to add another column with my <code>Static</code> values next to <code>Yield</code> column:</p>\n\n<pre><code>Sub io()\n\n    Dim r As Integer\n    Dim maxval As Integer\n    Dim c As Integer\n\n    c = 5\n\n    Cells(4, c) = 28\n    Cells(5, c) = 91\n    Cells(6, c) = 182\n    Cells(7, c) = 273\n    Cells(8, c) = 364\n    Cells(9, c) = 730\n    Cells(10, c) = 1825\n    Cells(11, c) = 2555\n    Cells(12, c) = 3640\n\n    maxval = Cells(Cells(Rows.Count, 3).End(xlUp).Row, 3).Value\n    Range(\"B1\") = maxval\n\n    r = 4\n\n    Do Until Cells(r, 3) = \"\" Or Cells(r, 5) = \"\"\n        If Cells(r, 3) &gt; Cells(r, 5) Then\n        Range(Cells(r, 1), Cells(r, 4)).Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n        Else\n        If Cells(r, 5) &gt; Cells(r, 3) Then Cells(r, 5).Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n        End If\n        r = r + 1\n    Loop\n</code></pre>\n\n<p>And the structure of the data became:</p>\n\n<pre><code>      ID            Code    Days  Yield Static\nKZW1KM093436    NTK273_1343 4    2.1781\nKZW1KD913708    NTK091_1370 11   2.1683\nKZK1KY011222    MKM012_0122 17   2.1602\n                                         28\nKZW1KM063603    NTK182_1360 32   2.1419\nKZW1KM093477    NTK273_1347 32   2.1419\nKZW1KD913740    NTK091_1374 39   2.1342\nKZW1KM063629    NTK182_1362 46   2.1269\nKZW1KM093501    NTK273_1350 53   2.1202\n</code></pre>\n\n<p>Now I want to delete all the redundant rows and add another column that uses interpolation, but can't proceed. Any help would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1502886434, "post_id": 45713286, "comment_id": 78384975, "body": "@pnuts I have had a look at those answers but I am still struggling."}, {"owner": {"reputation": 244, "user_id": 8219745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/461a5f5a7698d5fdb33a067c662a5c50?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok", "link": "https://stackoverflow.com/users/8219745/ashok"}, "edited": false, "score": 0, "creation_date": 1502887002, "post_id": 45713286, "comment_id": 78385468, "body": "@Anthony please check the <code>code</code> (lookup value) returning or not in vlookup and  storing the value in <code>seg</code> - try to store the lookup value in cell"}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 0, "creation_date": 1502887087, "post_id": 45713286, "comment_id": 78385546, "body": "What are you using <code>With</code> block for? You don&#39;t make use of it anywhere..."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1502887239, "post_id": 45713286, "comment_id": 78385651, "body": "I can see a couple of issues with the code. But the one I think you have a problem with is <code>Rate_Code = Sheet1.Range(&quot;F3:F&quot; &amp; endRow)</code>. You have a qualified object for <code>Sheet1</code>. Try using that: i.e. <b><code>Rate_Code = .Range(&quot;F3:F&quot; &amp; endRow)</code></b> as its already within a <code>With</code> clause. I would do the same where you are getting <code>endRow</code>. Then check the <code>Code</code> value when you get to <code>VLookUp</code> statement"}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1502887425, "post_id": 45713286, "comment_id": 78385800, "body": "Change this Seg = Cells(I + 2, 8).Value to  Cells(I + 2, 8).Value = Seg"}], "answers": [{"tags": [], "owner": {"reputation": 244, "user_id": 8219745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/461a5f5a7698d5fdb33a067c662a5c50?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok", "link": "https://stackoverflow.com/users/8219745/ashok"}, "is_accepted": false, "score": 0, "last_activity_date": 1502888674, "creation_date": 1502888674, "answer_id": 45714356, "question_id": 45713286, "link": "https://stackoverflow.com/questions/45713286/why-is-my-vlookup-not-working/45714356#45714356", "title": "Why is my VLookup not working?", "body": "<p>try this concept may be helpful to u</p>\n\n<pre><code>Sub RateCode()\nDim I, y As Long\n\n    Dim endRow As Long\n    Dim Rate_Code() As Variant\n    Dim ws As Worksheet\n    Dim ws2 As Worksheet\n    Dim rng As Range\n    Dim Seg As String\n    Set ws2 = Worksheets(\"Segment\")\n    Set ws = Worksheets(\"Sheet1\")\n    Set rng = ws2.Range(\"A1:B1300\")\n    With ws\n\n            lr = ws.Range(\"F\" &amp; Rows.Count).End(xlUp).Row\n\n         For I = 3 To lr\n            Code = Rate_Code(I, 1)\n            If Len(Code) = 5 Then\n            Code = \"'\" &amp; Mid(Code, 3, 2)\n            Cells(I + 2, 7).Value = Code\n            Else\n            Code = \"'\" &amp; Left(Code, 2)\n            Cells(I + 2, 7).Value = Code\n            End If\n            y = 8\n            Cells(I, y) = Application.WorksheetFunction.VLookup(Code, rng, 6, 0)\n        Next I\n      End With\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502889911, "creation_date": 1502885663, "last_edit_date": 1502889911, "question_id": 45713286, "link": "https://stackoverflow.com/questions/45713286/why-is-my-vlookup-not-working", "title": "Why is my VLookup not working?", "body": "<p>Why do I receive the error \"Unable to get the VLookup property of the WorksheetFunction class\"? Error occurs here: <code>Seg = Application.WorksheetFunction.VLookup(Code, rng, 2, False)</code></p>\n\n<pre><code>Sub RateCode()\nDim I As Long\nDim endRow As Long\nDim Rate_Code() As Variant\nDim ws As Worksheet\nDim ws2 As Worksheet\nDim rng As Range\nDim Seg As String\nSet ws2 = Worksheets(\"Segment\")\nSet ws = Worksheets(\"Sheet1\")\nSet rng = ws2.Range(\"A1:B1300\")\n        With ws\n        endRow = Sheet1.Range(\"A999999\").End(xlUp).Row\n        endRow = endRow\n        Rate_Code = Sheet1.Range(\"F3:F\" &amp; endRow)\n        For I = LBound(Rate_Code) To UBound(Rate_Code)\n            Code = Rate_Code(I, 1)\n\n            If Len(Code) = 5 Then\n                Code = \"'\" &amp; Mid(Code, 3, 2)\n                Cells(I + 2, 7).Value = Code\n            Else\n                Code = \"'\" &amp; Left(Code, 2)\n                Cells(I + 2, 7).Value = Code\n            End If\n            Seg = Application.WorksheetFunction.VLookup(Code, rng, 2, False)\n            Seg = Cells(I + 2, 8).Value\n        Next I\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 736436, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e5417265646ea5baebde4762b8864b8?s=128&d=identicon&r=PG", "display_name": "Bruce", "link": "https://stackoverflow.com/users/736436/bruce"}, "edited": false, "score": 0, "creation_date": 1502886971, "post_id": 45713406, "comment_id": 78385441, "body": "Thanks. I ran this code: <code>Sub UpdateWD()     ChDir (Application.Documents(Application.Documents.Count).Path) End Sub</code> But when I went to save the new document, I was presented with the same list of shared drives, folders, etc. So the code didn&#39;t seem to do anything. Do I need more steps in the macro?"}, {"owner": {"reputation": 689, "user_id": 3601475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63eb2cefd40f4ce33c7733d7eb74ef53?s=128&d=identicon&r=PG&f=1", "display_name": "Prebsus", "link": "https://stackoverflow.com/users/3601475/prebsus"}, "reply_to_user": {"reputation": 123, "user_id": 736436, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e5417265646ea5baebde4762b8864b8?s=128&d=identicon&r=PG", "display_name": "Bruce", "link": "https://stackoverflow.com/users/736436/bruce"}, "edited": false, "score": 0, "creation_date": 1503319626, "post_id": 45713406, "comment_id": 78552594, "body": "If you want to save the most recent opened document to the same folder as the document you opened first, see my updated answer for a solution. Does that help?"}], "tags": [], "owner": {"reputation": 689, "user_id": 3601475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63eb2cefd40f4ce33c7733d7eb74ef53?s=128&d=identicon&r=PG&f=1", "display_name": "Prebsus", "link": "https://stackoverflow.com/users/3601475/prebsus"}, "is_accepted": false, "score": 0, "last_activity_date": 1503319848, "last_edit_date": 1503319848, "creation_date": 1502886079, "answer_id": 45713406, "question_id": 45713260, "link": "https://stackoverflow.com/questions/45713260/vba-code-if-needed-to-save-new-word-document-in-same-directory-as-other-word-d/45713406#45713406", "title": "VBA code (if needed) to save new Word document in same directory as other Word doc", "body": "<p>This will the working directory to the directory of the first file you were working on:</p>\n\n<pre><code>ChDir(Application.Documents(Application.Documents.Count).Path)\n</code></pre>\n\n<p>If you want to save the most recent opened document to the same location as the first file you were working on, then try the following</p>\n\n<pre><code>Sub SaveWithFirstFile()\nNewFileName = \"filename1.docx\nApplication.Documents(1).SaveAs2 FileName:=Application.Documents(Application.Documents.Count).Path &amp; \"\\\\\" &amp; NewFileName\nEnd Sub\n</code></pre>\n\n<p>Change \"filename1.docx\" to what you want it to</p>\n"}], "owner": {"reputation": 123, "user_id": 736436, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e5417265646ea5baebde4762b8864b8?s=128&d=identicon&r=PG", "display_name": "Bruce", "link": "https://stackoverflow.com/users/736436/bruce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1104, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593902857, "creation_date": 1502885564, "last_edit_date": 1593902857, "question_id": 45713260, "link": "https://stackoverflow.com/questions/45713260/vba-code-if-needed-to-save-new-word-document-in-same-directory-as-other-word-d", "title": "VBA code (if needed) to save new Word document in same directory as other Word doc", "body": "<p>Many users, myself included, begin editing a Word document, create a new Word doc, and wish to save the second doc in the same directory as the first doc. This is the default behavior in an editor such as emacs. Word 2013, alas, makes me pick the directory (\"Folder\") where I wish to save the new file, forcing me to select among various network folders and then select multiple subdirectories before I reach the one containing my first document. I used to have a simple VBA script that would find the directory of the first file and then save the new file in that directory, or at least it would set the directory of the first file as the default directory for saving files. Does anyone have code to do what I'm looking for? Thanks!</p>\n"}, {"tags": ["vba", "algorithm", "logic"], "comments": [{"owner": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "edited": false, "score": 1, "creation_date": 1502885367, "post_id": 45713059, "comment_id": 78384193, "body": "&quot;Most efficient&quot; is very subjective. What do you pretend? Compact code, fast code, ..."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1502885376, "post_id": 45713059, "comment_id": 78384199, "body": "Can you use the above and find the combination in that and shift off to the left?  Also look at grouping the logic, &quot;so if 1,2,3 are equal, it is the value, 3 or 2 lows is medium, no lows I always high&quot;"}, {"owner": {"reputation": 45, "user_id": 4700564, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1bf43b12e448ef51e3d841aa636c8acb?s=128&d=identicon&r=PG&f=1", "display_name": "Krapton", "link": "https://stackoverflow.com/users/4700564/krapton"}, "reply_to_user": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "edited": false, "score": 0, "creation_date": 1502885495, "post_id": 45713059, "comment_id": 78384279, "body": "@LS_\u1d05\u1d07\u1d20 Compact is indeed the most desired"}, {"owner": {"reputation": 45, "user_id": 4700564, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1bf43b12e448ef51e3d841aa636c8acb?s=128&d=identicon&r=PG&f=1", "display_name": "Krapton", "link": "https://stackoverflow.com/users/4700564/krapton"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1502885602, "post_id": 45713059, "comment_id": 78384358, "body": "@Nathan_Sav Correct, find the matching combination and to the left/right is the converted value"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1502885673, "post_id": 45713059, "comment_id": 78384415, "body": "I was suggesting that as a solution.  Edit to my next comment &quot;so if 1,2,3 are equal, it is the value, 3 or 2 lows is low, no lows is always high&quot;"}, {"owner": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "edited": false, "score": 0, "creation_date": 1502885686, "post_id": 45713059, "comment_id": 78384425, "body": "@krapton Lol!!! &quot;most desired&quot; is also subjective!!!"}, {"owner": {"reputation": 45, "user_id": 4700564, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1bf43b12e448ef51e3d841aa636c8acb?s=128&d=identicon&r=PG&f=1", "display_name": "Krapton", "link": "https://stackoverflow.com/users/4700564/krapton"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1502885926, "post_id": 45713059, "comment_id": 78384607, "body": "@Nathan_Sav This table is just an image, the question is, what is the shortest way of making this into an algorithm. I thought your comment was about how the table is used"}, {"owner": {"reputation": 45, "user_id": 4700564, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1bf43b12e448ef51e3d841aa636c8acb?s=128&d=identicon&r=PG&f=1", "display_name": "Krapton", "link": "https://stackoverflow.com/users/4700564/krapton"}, "reply_to_user": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "edited": false, "score": 0, "creation_date": 1502886155, "post_id": 45713059, "comment_id": 78384760, "body": "@LS_\u1d05\u1d07\u1d20 it&#39;s still an answer to your question. You asked in what way to interpret &quot;efiicient&quot;."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1502886174, "post_id": 45713059, "comment_id": 78384778, "body": "add the table to excel or wherever and use it&#39;s native lookups."}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 1, "last_activity_date": 1502886469, "creation_date": 1502886469, "answer_id": 45713538, "question_id": 45713059, "link": "https://stackoverflow.com/questions/45713059/whats-the-most-efficient-way-of-programming-a-conversion-table-algorithm/45713538#45713538", "title": "What&#39;s the most efficient way of programming a conversion table algorithm", "body": "<pre><code>Sub heres_an_idea()\n\nDim dicLow As New Scripting.Dictionary\nDim dicMed As New Scripting.Dictionary\nDim dicHigh As New Scripting.Dictionary\n\ndicLow.Add \"LLL\", \"\"\ndicLow.Add \"LLM\", \"\"\ndicLow.Add \"LLH\", \"\"\n\ndicMed.Add \"MMM\", \"\"\n\ndicHigh.Add \"HHH\", \"\"\n\nIf dicLow.Exists(\"MMM\") Then\n    'low\n    Debug.Print \"low\"\nElseIf dicMed.Exists(\"MMM\") Then\n    'med\n    Debug.Print \"med\"\nElseIf dicHigh.Exists(\"MMM\") Then\n    'high\n    Debug.Print \"high\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 4700564, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1bf43b12e448ef51e3d841aa636c8acb?s=128&d=identicon&r=PG&f=1", "display_name": "Krapton", "link": "https://stackoverflow.com/users/4700564/krapton"}, "edited": false, "score": 0, "creation_date": 1502887126, "post_id": 45713661, "comment_id": 78385574, "body": "Thanks! I got this as an assignment, and this was part of an PowerPoint presentation. I didn&#39;t yet put this in an excel table because i wasn&#39;t sure that was the best way to handle this, but you answer is interesting!"}], "tags": [], "owner": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "is_accepted": false, "score": 1, "last_activity_date": 1502889087, "last_edit_date": 1502889087, "creation_date": 1502886772, "answer_id": 45713661, "question_id": 45713059, "link": "https://stackoverflow.com/questions/45713059/whats-the-most-efficient-way-of-programming-a-conversion-table-algorithm/45713661#45713661", "title": "What&#39;s the most efficient way of programming a conversion table algorithm", "body": "<p>\"Most efficient\" is very subjective. I would put all values into an array (are not that many) and access it with index based in your values.</p>\n\n<ol>\n<li><p>Consider <code>index = FirstValue + SecondValue*3 + ThirdValue*9</code></p>\n\n<p>FirstValue: 0=L1, 1=L2, 2=L3</p>\n\n<p>SecondValue, ThirdValue: 0=L1, 1=L2, 2=L3, 3=Unused</p>\n\n<p>(This set is not optimal as you may combine Unused second with used third, but you can truncate these values!)</p>\n\n<p>This will result in 3*(3*4+1)=39 combination, a small string!</p></li>\n<li><p>Put all your result in a table and compose a string:</p>\n\n<p><code>myData = \"000001011001012122011122122001012122012\"</code> where 0=Low, 1=Meddium, 2=High</p></li>\n<li><p>Define your function (and type if you wish):</p></li>\n</ol>\n\n<p>VBA code:</p>\n\n<pre><code>Enum myType\n     L1 = 0\n     L2 = 1\n     L3 = 2\nEnd Enum\n\nFunction getValue(ByVal V1 As myType, Optional ByVal V2 As myType = 3, Optional ByVal V3 As myType = 3)\n        getValue = Array(\"Low\", \"Meddium\", \"High\")(Mid(\"000001011001012122011122122001012122012\", V1 + V2 * 3 + V3 * 9 + 1, 1))\nEnd Function\n</code></pre>\n\n<p>This will be fast and short. Just need to work your data a little before use!</p>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 4700564, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1bf43b12e448ef51e3d841aa636c8acb?s=128&d=identicon&r=PG&f=1", "display_name": "Krapton", "link": "https://stackoverflow.com/users/4700564/krapton"}, "edited": false, "score": 0, "creation_date": 1502956268, "post_id": 45715477, "comment_id": 78416399, "body": "Beautiful! I didn&#39;t think about the possibility of not using the table. Thanks!"}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "reply_to_user": {"reputation": 45, "user_id": 4700564, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1bf43b12e448ef51e3d841aa636c8acb?s=128&d=identicon&r=PG&f=1", "display_name": "Krapton", "link": "https://stackoverflow.com/users/4700564/krapton"}, "edited": false, "score": 0, "creation_date": 1502959929, "post_id": 45715477, "comment_id": 78418623, "body": "@Krapton: also note that my observation about the sum 7 was wrong, so that the problem is even easier."}], "tags": [], "owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "is_accepted": true, "score": 2, "last_activity_date": 1502960730, "last_edit_date": 1502960730, "creation_date": 1502891551, "answer_id": 45715477, "question_id": 45713059, "link": "https://stackoverflow.com/questions/45713059/whats-the-most-efficient-way-of-programming-a-conversion-table-algorithm/45715477#45715477", "title": "What&#39;s the most efficient way of programming a conversion table algorithm", "body": "<p>Is there a need for a table ?</p>\n\n<p>If you take the sum of the three values, you get the following correspondence:</p>\n\n<pre><code>Low: 3, 4 or 5\nMedium: 6\nHigh: 7, 8, or 9.\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>        P = V1 + V2 + V3\n        If P &lt; 6 Then\n            R = 1\n        ElseIf P &lt; 7 Then\n            R = 2\n        Else\n            R = 3\n        End If\n</code></pre>\n\n<p>You can also directly tabulate the sum, or use the formula</p>\n\n<pre><code>Sgn(V1 + V2 + V3 - 6) + 2\n</code></pre>\n\n<p>(will be hard to do more compact, as the three variables must somehow appear).</p>\n\n<hr>\n\n<p>Actually, as the scores are symmetric, the initial table could already have been been compressed as</p>\n\n<pre><code>111 =&gt; 1\n112 =&gt; 1\n113 =&gt; 1\n122 =&gt; 1\n123 =&gt; 2\n222 =&gt; 2\n223 =&gt; 3\n233 =&gt; 3\n333 =&gt; 3\n</code></pre>\n\n<hr>\n\n<p><strong>Final note</strong>: </p>\n\n<p>If the scores are represented on a <code>(-1, 0, +1)</code> scale, the formula simplifies to</p>\n\n<pre><code>Sgn(V1 + V2 + V3)\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 4700564, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1bf43b12e448ef51e3d841aa636c8acb?s=128&d=identicon&r=PG&f=1", "display_name": "Krapton", "link": "https://stackoverflow.com/users/4700564/krapton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 45715477, "answer_count": 3, "score": 0, "last_activity_date": 1502960730, "creation_date": 1502884996, "question_id": 45713059, "link": "https://stackoverflow.com/questions/45713059/whats-the-most-efficient-way-of-programming-a-conversion-table-algorithm", "title": "What&#39;s the most efficient way of programming a conversion table algorithm", "body": "<p>I'm wondering what your opinion is of the following:</p>\n\n<p>I need to convert 1 to 3 values and make it into a single value while using a conversion table:</p>\n\n<p><a href=\"https://i.stack.imgur.com/shROg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/shROg.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is an example:</p>\n\n<p>Low + High + High = Medium</p>\n\n<p>Medium + Medium + High = High</p>\n\n<p>What do you guys think is the most efficient way of programming this algorithm? The language I'll be using is VBA (Excel)</p>\n\n<p>I already thought about making a lot of nested <code>If</code> statements, but my programming sense tells me there's an easier way.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["json", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8472243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c848686278aa148b755d1ef8456a79a?s=128&d=identicon&r=PG&f=1", "display_name": "user8472243", "link": "https://stackoverflow.com/users/8472243/user8472243"}, "edited": false, "score": 0, "creation_date": 1503445466, "post_id": 45712794, "comment_id": 78614933, "body": "Thanks for your reply.  Sheet5.Cells(i, 1).value = item  - this statement is working but I want to get the subitem values. I tried item(0), item.Name and item(Name) but nothing is working. Can you please help me"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 8472243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c848686278aa148b755d1ef8456a79a?s=128&d=identicon&r=PG&f=1", "display_name": "user8472243", "link": "https://stackoverflow.com/users/8472243/user8472243"}, "edited": false, "score": 0, "creation_date": 1503474398, "post_id": 45712794, "comment_id": 78624405, "body": "@user8472243 - have you tried Shift + F9? What happened?"}, {"owner": {"reputation": 1, "user_id": 8472243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c848686278aa148b755d1ef8456a79a?s=128&d=identicon&r=PG&f=1", "display_name": "user8472243", "link": "https://stackoverflow.com/users/8472243/user8472243"}, "edited": false, "score": 0, "creation_date": 1504241032, "post_id": 45712794, "comment_id": 78946661, "body": "Sorry for late response. In &quot;Item&quot;, I am getting correct value now but when I am going to get the next level value like item.name or item(name). Its showing error - 424 (Run time Error) says &quot;Object Required&quot; on this statement - Sheet5.Cells(i, 2).Value = Item.Name"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 8472243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c848686278aa148b755d1ef8456a79a?s=128&d=identicon&r=PG&f=1", "display_name": "user8472243", "link": "https://stackoverflow.com/users/8472243/user8472243"}, "edited": false, "score": 0, "creation_date": 1504253682, "post_id": 45712794, "comment_id": 78951602, "body": "@user8472243 - how about <code>item(&quot;name&quot;)</code> or <code>item(&quot;Name&quot;)</code>?"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1502884549, "last_edit_date": 1502884549, "creation_date": 1502884247, "answer_id": 45712794, "question_id": 45712541, "link": "https://stackoverflow.com/questions/45712541/type-mismatch-error-13-in-excel-using-excel-json-parser-vba/45712794#45712794", "title": "Type Mismatch (Error 13) in Excel using Excel Json Parser VBA", "body": "<p>Without having any experience with ParseJson, try one of these:</p>\n\n<p><code>Sheet5.Cells(i, 1).value = item</code> </p>\n\n<p><code>Sheet5.Cells(i, 1).value = item(0)</code></p>\n\n<p><code>Sheet5.Cells(i, 1).value = item.Name</code></p>\n\n<p>If still none of these works, try like this:</p>\n\n<pre><code>For Each item In Json\n    Stop\n     Sheet5.Cells(i, 1).value = item(\"name\")\n    'Sheet5.Cells(i, 2).Value = Item(\"results\")(\"name\")\n    'Sheet5.Cells(i, 3).Value = Item(\"results\")(\"responsecode\")\n    i = i + 1\nNext\n</code></pre>\n\n<p>On the stop, select <code>item</code>, press <kbd>Shift</kbd>+<kbd>F9</kbd> and see what do you have in <code>item</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 8472243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c848686278aa148b755d1ef8456a79a?s=128&d=identicon&r=PG&f=1", "display_name": "user8472243", "link": "https://stackoverflow.com/users/8472243/user8472243"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 441, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527013714, "creation_date": 1502883415, "last_edit_date": 1531164843, "question_id": 45712541, "link": "https://stackoverflow.com/questions/45712541/type-mismatch-error-13-in-excel-using-excel-json-parser-vba", "title": "Type Mismatch (Error 13) in Excel using Excel Json Parser VBA", "body": "<p>Getting Type Mismatch (Error 13)  while using Json PArser in Excel MAcro</p>\n\n<p>Below are the code :</p>\n\n<pre><code>Sub getJsonValue()\n    Dim FSO As New FileSystemObject\n    Dim JsonTS As TextStream\n    Set JsonTS = FSO.OpenTextFile(\"C:\\Users\\Card_Link.json\", ForReading)\n    JsonText = JsonTS.ReadAll\n    JsonTS.Close\n    Set Json = ParseJson(JsonText)\n    Set JsonRows = Json(\"rows\")\n    i = 2\n    For Each Item In Json\n         Sheet5.Cells(i, 1).Value = Item(\"name\")\n        'Sheet5.Cells(i, 2).Value = Item(\"results\")(\"name\")\n        'Sheet5.Cells(i, 3).Value = Item(\"results\")(\"responsecode\")\n        i = i + 1\n    Next\n    MsgBox (\"complete\")\nEnd Sub\n</code></pre>\n\n<p>Getting error on this statement \n<code>Sheet5.Cells(i, 1).Value = Item(\"name\")</code></p>\n\n<p>Can someone please help me to resolve this.</p>\n\n<p>Thanks\nRJ</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 343, "user_id": 7324127, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a54b8306994f0ab4fdfe7df4c4ace510?s=128&d=identicon&r=PG&f=1", "display_name": "Karthick Anbazhagan", "link": "https://stackoverflow.com/users/7324127/karthick-anbazhagan"}, "edited": false, "score": 0, "creation_date": 1502882484, "post_id": 45711947, "comment_id": 78382286, "body": "Try with &quot;yourworksheet.Cells(ActiveSheet.Rows.Count, 1).End(xlUp).Row&quot; instead of WorksheetFunction.CountA(Range(&quot;A:A&quot;)) + 1"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8338576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d91c9f68907511f8594a54ace06a12b?s=128&d=identicon&r=PG&f=1", "display_name": "genaro", "link": "https://stackoverflow.com/users/8338576/genaro"}, "edited": false, "score": 0, "creation_date": 1502967689, "post_id": 45712160, "comment_id": 78424269, "body": "i try that and now the data is being place in the last row row all the time and not on the empty row that is on the bottom."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1502882379, "creation_date": 1502882379, "answer_id": 45712160, "question_id": 45711947, "link": "https://stackoverflow.com/questions/45711947/why-the-data-of-userform-always-goes-to-the-same-row/45712160#45712160", "title": "why the data of userform always goes to the same row?", "body": "<p>You will want to get the next empty row like this instead:</p>\n\n<pre><code>emptyRow = ActiveSheet.Cells(ActiveSheet.Rows.Count, 1).End(xlUp).Row\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8338576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d91c9f68907511f8594a54ace06a12b?s=128&d=identicon&r=PG&f=1", "display_name": "genaro", "link": "https://stackoverflow.com/users/8338576/genaro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502883540, "creation_date": 1502881791, "last_edit_date": 1531164843, "question_id": 45711947, "link": "https://stackoverflow.com/questions/45711947/why-the-data-of-userform-always-goes-to-the-same-row", "title": "why the data of userform always goes to the same row?", "body": "<p>I don't know what I'm doing wrong, when I input the data in the userform all the information appears but it is always in the same row it doesn't go to the next empty row. I'm trying to input the data into my excel file and keep adding the information to the next empty row. </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim emptyRow As Long\n\n    'Make Sheet1 active\n    Sheet1.Activate\n\n    'Determine emptyRow\n    emptyRow = WorksheetFunction.CountA(Range(\"A:A\")) + 1\n\n    'values need to be enter in order to move on\n    If ComboBox1.Value = \"\" Then\n        Cancel = 1\n        MsgBox \"Please enter the part line \"\n        ComboBox1.SetFocus\n        Exit Sub\n    End If\n\n    If ComboBox4.Value = \"\" Then\n        Cancel = 1\n        MsgBox \"Please enter a part description\"\n        ComboBox4.SetFocus\n        Exit Sub\n    End If\n\n    If TextBox3.Value = \"\" Then\n        Cancel = 1\n        MsgBox \"Please enter a part quantity\"\n        TextBox3.SetFocus\n        Exit Sub\n    End If\n\n    If ComboBox2.Value = \"\" Then\n        Cancel = 1\n        MsgBox \"Please enter a part finish\"\n        ComboBox2.SetFocus\n        Exit Sub\n    End If\n\n    'Transfer information\n\n    Cells(emptyRow, 1).Value = ComboBox1.Value\n    Cells(emptyRow, 2).Value = TextBox1.Value\n    Cells(emptyRow, 3).Value = ComboBox4.Value\n    Cells(emptyRow, 4).Value = TextBox3.Value\n    Cells(emptyRow, 5).Value = ComboBox2.Value\n    Cells(emptyRow, 6).Value = DTPicker1.Value\n\n\n    ComboBox1.Value = Null\n    ComboBox4.Value = Null\n    TextBox3.Value = Null\n    ComboBox2.Value = Null\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1502881088, "post_id": 45711625, "comment_id": 78381367, "body": "Do you always want to find the first blank in Column A? Or do you want to find the last used cell in Column A? Or are you trying to find the last used row in all columns?"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 3, "creation_date": 1502881137, "post_id": 45711625, "comment_id": 78381411, "body": "Try <code>getLastRow = endrow</code> instead of <code>getLastRow = LRow</code>."}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "reply_to_user": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1502881338, "post_id": 45711625, "comment_id": 78381567, "body": "@Olly yep. but could might as well be <code>...End(xlUp)</code> but did it this way since theres never a empty cell below row 11"}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "reply_to_user": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1502881472, "post_id": 45711625, "comment_id": 78381652, "body": "@Mrig thanks. been editing this a few times that i forgot all about the <code>Dim LRow</code>. that solves it"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1502881489, "post_id": 45711625, "comment_id": 78381661, "body": "@krib you should also pass the <code>Worksheet</code> object, or the <code>Worksheet.Name</code> as a String to find the last row in the correct worksheet"}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1502881546, "post_id": 45711625, "comment_id": 78381706, "body": "@ShaiRado yes, but this is constant and will always be this sheet for the end user."}], "answers": [{"comments": [{"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1502882474, "post_id": 45711903, "comment_id": 78382279, "body": "this does the trick, a bit better than my first try and didn&#39;t mess up my hidden filterboxes. thx"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1502882676, "post_id": 45711903, "comment_id": 78382422, "body": "I&#39;ve added another option, as I didn&#39;t like the <code>ActiveSheet</code> needing to be entered."}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1502882735, "post_id": 45711903, "comment_id": 78382463, "body": "sweet. that&#39;s great."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1502884453, "post_id": 45711903, "comment_id": 78383573, "body": "<code>Rows.Count</code> should be fully qualified <code>sht.Rows.Count</code>  and please indent.  Other than that excellent job +1."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1502888717, "post_id": 45711903, "comment_id": 78386821, "body": "@ThomasInzina - thanks, edited as per suggestion. Not sure I&#39;ve ever qualified a <code>Rows.Count</code> when used in this way. Is there negative impact in not doing so?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 1, "creation_date": 1502889699, "post_id": 45711903, "comment_id": 78387616, "body": "It&#39;s a precaution in case an end user is working with the old .xls format and a new format.  In this case, Rows.Count could cause either an Object defined error or possibly row 65,536 which is the max row for a xls file.  The best Coders on SO will either fully qualify or not qualify at all."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1502889912, "post_id": 45711903, "comment_id": 78387758, "body": "Thanks, I&#39;ll keep it in mind going forward."}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 1, "last_activity_date": 1502888927, "last_edit_date": 1502888927, "creation_date": 1502881654, "answer_id": 45711903, "question_id": 45711625, "link": "https://stackoverflow.com/questions/45711625/lastrow-as-function-for-several-subs-in-module/45711903#45711903", "title": "LastRow as function for several subs in module", "body": "<p>This would work:</p>\n\n<pre><code>Function getlastrow(sht As Worksheet, Optional columnindex As Long = 1) As Long\n   getlastrow = sht.Cells(sht.Rows.Count, columnindex).End(xlUp).Row\nEnd Function\n</code></pre>\n\n<p>You can specify a sheet name or use <code>ActiveSheet</code>. You can also select a column but if one is not given it will preselect 1, i.e column A.</p>\n\n<p>You'd use it like so:</p>\n\n<pre><code>ActiveSheet.Range(\"$A$11:$AH$\" &amp; getLastRow(ActiveSheet)).AutoFilter.....\n</code></pre>\n\n<p>Even better, this one assumes <code>ActiveSheet</code> if not preselected:</p>\n\n<pre><code>Function getlastrow(Optional sht As Worksheet = Nothing, Optional columnindex As Long = 1) As Long\n   If sht Is Nothing Then Set sht = ActiveSheet\n   getlastrow = sht.Cells(sht.Rows.Count, columnindex).End(xlUp).Row\nEnd Function\n</code></pre>\n\n<p>You'd use this as per your original code like so:</p>\n\n<pre><code>ActiveSheet.Range(\"$A$11:$AH$\" &amp; getLastRow()).AutoFilter.....\n</code></pre>\n"}], "owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "closed_date": 1502889020, "accepted_answer_id": 45711903, "answer_count": 1, "score": 0, "last_activity_date": 1502888927, "creation_date": 1502880781, "question_id": 45711625, "link": "https://stackoverflow.com/questions/45711625/lastrow-as-function-for-several-subs-in-module", "closed_reason": "Duplicate", "title": "LastRow as function for several subs in module", "body": "<p>Been trying to get <strong>LastRow</strong> in a matter that I can use it in several codes in the same module.</p>\n\n<p>At the moment this is what I got:</p>\n\n<pre><code>Function getLastRow() As Long\n\nDim LRow As Long\nendrow = 11\nDo Until Cells(endrow + 1, 1).Value = \"\"\n    endrow = endrow + 1\nLoop\n\ngetLastRow = LRow\nEnd Function\n</code></pre>\n\n<p>The function is working but i get <code>error 1004</code> on the line where i try to use it.</p>\n\n<pre><code>Sub PPP()\n\nApplication.ScreenUpdating = False\nCall Unprotect\n    ActiveSheet.Range(\"$A$11:$AH$\" &amp; getLastRow).AutoFilter Field:=4, Criteria1:=\"PPP\" '&lt;--error occurs here\nCall Protect\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Appreciate any help with this, or even better solutions. </p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1502880771, "post_id": 45711345, "comment_id": 78381115, "body": "Show us what you have so far (code) so that we can improve it."}, {"owner": {"reputation": 3, "user_id": 8130714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1a3444a93c44ba835bb727f441fd216?s=128&d=identicon&r=PG&f=1", "display_name": "JaeJay", "link": "https://stackoverflow.com/users/8130714/jaejay"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1502891918, "post_id": 45711345, "comment_id": 78389191, "body": "<code>Private Sub Worksheet_Change(ByVal Target As Range) If Target.Count &gt; 1 Then Set Target = Target.Cells(1, 1) If Not Intersect(Target, Columns(&quot;B:B&quot;)) Is Nothing Then     If Not IsEmpty(Target) Then         Target.Offset(0, 1).Value = Now     Else         Target.Offset(0, 1).ClearContents     End If End If End Sub</code>"}], "answers": [{"comments": [{"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1502881725, "post_id": 45711766, "comment_id": 78381807, "body": "This line is faulty: `    If Target.Column % 2 = 0 Then` Did you mean: `    If Target.Column Mod 2 = 0 Then`"}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "reply_to_user": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1502882425, "post_id": 45711766, "comment_id": 78382244, "body": "@Olly I didn&#39;t know that % doesn&#39;t work. Thanks for clarification."}], "tags": [], "owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "is_accepted": true, "score": 1, "last_activity_date": 1502882379, "last_edit_date": 1502882379, "creation_date": 1502881275, "answer_id": 45711766, "question_id": 45711345, "link": "https://stackoverflow.com/questions/45711345/excel-vba-add-a-date-stamp-to-every-other-column-or-row/45711766#45711766", "title": "Excel VBA - Add a date stamp to every other Column or Row", "body": "<p>Check this event-based macro:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Column Mod 2 = 0 Then\n        Application.EnableEvents = False\n        Target.Offset(0,1) = Date\n        Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": false, "score": 0, "last_activity_date": 1502881279, "creation_date": 1502881279, "answer_id": 45711770, "question_id": 45711345, "link": "https://stackoverflow.com/questions/45711345/excel-vba-add-a-date-stamp-to-every-other-column-or-row/45711770#45711770", "title": "Excel VBA - Add a date stamp to every other Column or Row", "body": "<p>Use the <a href=\"https://msdn.microsoft.com/VBA/Excel-VBA/articles/worksheet-change-event-excel\" rel=\"nofollow noreferrer\"><code>Worksheet_Change</code></a>-Event (another good example for specific cells <a href=\"https://support.microsoft.com/en-us/help/213612/how-to-run-a-macro-when-certain-cells-change-in-excel\" rel=\"nofollow noreferrer\">here</a>).</p>\n\n<p>Depending on your needs you do something like this: </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n  Application.EnableEvents = False\n  Cells(1, Target.Column + 1).Value = Format(Now(), \"dd.mm.yyyy\")\n  Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Its important to set <code>.EnableEvents = False</code> before inserting any values, otherwise it will fire the event again. </p>\n"}], "owner": {"reputation": 3, "user_id": 8130714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1a3444a93c44ba835bb727f441fd216?s=128&d=identicon&r=PG&f=1", "display_name": "JaeJay", "link": "https://stackoverflow.com/users/8130714/jaejay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 0, "accepted_answer_id": 45711766, "answer_count": 2, "score": 0, "last_activity_date": 1502882379, "creation_date": 1502880026, "last_edit_date": 1531161705, "question_id": 45711345, "link": "https://stackoverflow.com/questions/45711345/excel-vba-add-a-date-stamp-to-every-other-column-or-row", "title": "Excel VBA - Add a date stamp to every other Column or Row", "body": "<p>Basically its quite a simple thing (I think) but I can't seem to get it!</p>\n\n<p>Essentially I am building a tracker and I need a date stamp put in whenever a cell is modified. I can put in the code so when anything in column b is modified to put a date in column C, but then I can't make it repeat for data put in column D to input a date in Column E. </p>\n\n<p>Basically I would want a date stamp in every other Column. If it is easier to be every other row that would be fine as well I'll just change the titles around.</p>\n\n<p>If its rows it would have to start from data in put in row 2 (headers), if its column data put in from column B (headers again).</p>\n\n<p>Can anyone help? I've had a look online but can't seem to find the answer...</p>\n"}, {"tags": ["vba", "replace", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1503209466, "last_edit_date": 1503209466, "creation_date": 1503209138, "answer_id": 45778988, "question_id": 45711250, "link": "https://stackoverflow.com/questions/45711250/ms-word-removing-character-style-if-text-has-specific-paragraph-style-applied/45778988#45778988", "title": "(MS Word) Removing character style IF text has specific paragraph style applied", "body": "<p>here is some code to get you started</p>\n\n<p>press F5 to run code, it will stop at Stop command</p>\n\n<p>examine the Immediate window to determine the header style</p>\n\n<p>each paragraph gets selected, so that you can tell which one you are examining</p>\n\n<p>you can then modify the code with if/then statement to make specific paragraphs italic</p>\n\n<pre><code>Sub aaaa()\n\n    Dim ppp As Paragraph\n    Dim ccc As Range\n\n    For Each ppp In ActiveDocument.Content.Paragraphs\n\n        ppp.Range.Select           ' visual aid only. not used by any other part of the program\n\n        Debug.Print \"style :\", ppp.Style\n        Debug.Print ppp.Style.Description\n\nStop\n\n        For Each ccc In ppp.Range.Characters       ' you can probably comment out these 3 lines\n            Debug.Print ccc.FormattedText.Italic   ' True prints as -1\n        Next ccc\n\n        Debug.Print \"italic :\", ppp.Range.Italic   ' prints -1 if all are italic. 9999999 if some. 0 if none\n        ppp.Range.Italic = False                   ' this removes italic from whole paragraph\n\n    Next ppp\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 726, "user_id": 1302127, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7bc359fb1047a6eb6ca7508ef70cad56?s=128&d=identicon&r=PG", "display_name": "Janus Bahs Jacquet", "link": "https://stackoverflow.com/users/1302127/janus-bahs-jacquet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503209466, "creation_date": 1502879700, "question_id": 45711250, "link": "https://stackoverflow.com/questions/45711250/ms-word-removing-character-style-if-text-has-specific-paragraph-style-applied", "title": "(MS Word) Removing character style IF text has specific paragraph style applied", "body": "<p>My Google-fu must be very weak today, \u2019cause this seems like an obvious thing to need to do sometimes, yet I cannot find a single case of anyone ever asking about it anywhere\u2026</p>\n\n<p>I have a document that I am preparing for proper typesetting in InDesign, which includes among other things getting rid of local overrides to paragraph and character styles. I did an find-and-replace to replace all instances of italic text with a character style called <em>Italic</em>, but stupidly forgot to limit this to text with the <em>Normal</em> style applied.</p>\n\n<p>There are hundreds of headers strewn throughout the document which are supposed to be italic; that\u2019s part of their paragraph style definitions. Since I forgot to limit the find-and-replace, the <em>Italic</em> style was applied to all these many headers. Annoyingly, since \u2018italic\u2019 is something like a boolean switch in Word, this means that all these headers are now not italic in the document.</p>\n\n<p>I didn\u2019t notice this for a while, so I can\u2019t simply undo it now\u2014the file has been saved and worked on since the find-and-replace. The author (who is a cantankerous, octogenarian technophobe) also needs to see the file again before it\u2019s set, so while ultimately it doesn\u2019t matter whether or not the font is italic in the Word document, it will matter to him.</p>\n\n<p>So what I would very much like to do is to search for all text which has <strong>both</strong> the paragraph style <em>Header</em> <strong>and</strong> the character style <em>Italic</em> applied, and remove the character style.</p>\n\n<p>This is an easy task in InDesign where paragraph and character styles are separate entities, but not in Word where they\u2019re all lumped together in one big, messy pile. It doesn\u2019t seem like it can be done through the UI, so I\u2019m guessing I\u2019ll have to resort to a VBA macro\u2026 which I\u2019m utterly incompetent at.</p>\n\n<h3>Is there a way to find text with a particular paragraph style and a particular character style, and then remove the character style from that text?</h3>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "edited": false, "score": 0, "creation_date": 1502881099, "post_id": 45711690, "comment_id": 78381384, "body": "16 Sec late ^^. But your answer is better, because you have all the endings from excel in it. so 1+"}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 2, "last_activity_date": 1502881022, "creation_date": 1502881022, "answer_id": 45711690, "question_id": 45711249, "link": "https://stackoverflow.com/questions/45711249/how-to-open-all-files-in-the-folder-xls-and-csv-format-files-vba/45711690#45711690", "title": "How to open all files in the folder (xls and csv format files) - VBA", "body": "<p>Just like this:</p>\n\n<pre><code>fNAME = Dir(fPATH &amp; \"*\")        'get the first filename in fpath\nDo While Len(fNAME) &gt; 0\n    dim ext as string, p as integer\n    p = inStrRev(fName, \".\")\n    ext = ucase(mid(fName, p+1))\n    if ext = \"CSV\" or ext = \"XLS\" or ext = \"XLSX\" or ext = \"XLST\" then\n        Set wb1 = Workbooks.Open(fPATH &amp; fNAME)   'open the file\n        ...\n    end if\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "is_accepted": true, "score": 1, "last_activity_date": 1502881038, "creation_date": 1502881038, "answer_id": 45711699, "question_id": 45711249, "link": "https://stackoverflow.com/questions/45711249/how-to-open-all-files-in-the-folder-xls-and-csv-format-files-vba/45711699#45711699", "title": "How to open all files in the folder (xls and csv format files) - VBA", "body": "<p>You can get all Files in the Folder and check then if the file is an CSV or xlsx File. And then Open it like you did.</p>\n\n<pre><code>    Option Explicit\n\n    Sub ImportGroups()\n    Dim fPATH As String, fNAME As String\n    Dim LR As Long, LastRow As Long\n    Dim wb2, wb1 As Workbook, ofs As Worksheet\n\n    Set ofs = ThisWorkbook.Sheets(\"Sheet3\")\n\n\n    fPATH = \"C:\\Users\\ashokkumar.d\\Desktop\\MFI\\\"       \n\n    fNAME = Dir(fPATH &amp; \"*.*\")        'get the first filename in fpath\n\n    Do While Len(fNAME) &gt; 0\nIf Right(fNAME, 4) = \"xlsx\" Or Right(fNAME, 4) = \".csv\" Then\n        Set wb1 = Workbooks.Open(fPATH &amp; fNAME)   'open the file\n\n        LastRow = ofs.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n        ofs.Range(\"B\" &amp; LastRow).Offset(1, -1).Value = fNAME\n\n        Sheets(\"Input\").Range(\"C8:J12\").Copy\n        ofs.Range(\"B\" &amp; LastRow).Offset(1, 0).PasteSpecial xlPasteValues\n\n\n\n        wb1.Close False   'close data workbook\n            fNAME = Dir         'get the next filename\nend if\n    Loop\n\n\n     LR = ofs.Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n     ofs.Range(\"E2:I\" &amp; LR).Select\n     Selection.NumberFormat = \"0.00%\"\n     Application.ScreenUpdating = True\n     ofs.Range(\"A1:Z\" &amp; LR).Select\n     With Selection\n        WrapText = True\n        End With\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 244, "user_id": 8219745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/461a5f5a7698d5fdb33a067c662a5c50?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok", "link": "https://stackoverflow.com/users/8219745/ashok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2986, "favorite_count": 0, "accepted_answer_id": 45711699, "answer_count": 2, "score": 1, "last_activity_date": 1502881038, "creation_date": 1502879695, "question_id": 45711249, "link": "https://stackoverflow.com/questions/45711249/how-to-open-all-files-in-the-folder-xls-and-csv-format-files-vba", "title": "How to open all files in the folder (xls and csv format files) - VBA", "body": "<p>I have written code for consolidate the data from multiple workbook to one workbook and the code only opening the xls format files but some files have csv format in the folder. how to open csv and xls files in the folder? Any suggestion it would appreciated</p>\n\n<pre><code>Option Explicit\n\nSub ImportGroups()\nDim fPATH As String, fNAME As String\nDim LR As Long, LastRow As Long\nDim wb2, wb1 As Workbook, ofs As Worksheet\n\nSet ofs = ThisWorkbook.Sheets(\"Sheet3\")\n\n\nfPATH = \"C:\\Users\\ashokkumar.d\\Desktop\\MFI\\\"       \n\nfNAME = Dir(fPATH &amp; \"*.xls\")        'get the first filename in fpath\n\nDo While Len(fNAME) &gt; 0\n    Set wb1 = Workbooks.Open(fPATH &amp; fNAME)   'open the file\n\n    LastRow = ofs.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n    ofs.Range(\"B\" &amp; LastRow).Offset(1, -1).Value = fNAME\n\n    Sheets(\"Input\").Range(\"C8:J12\").Copy\n    ofs.Range(\"B\" &amp; LastRow).Offset(1, 0).PasteSpecial xlPasteValues\n\n\n\n    wb1.Close False   'close data workbook\n        fNAME = Dir         'get the next filename\nLoop\n\n\n LR = ofs.Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n ofs.Range(\"E2:I\" &amp; LR).Select\n Selection.NumberFormat = \"0.00%\"\n Application.ScreenUpdating = True\n ofs.Range(\"A1:Z\" &amp; LR).Select\n With Selection\n    WrapText = True\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1502879663, "post_id": 45710992, "comment_id": 78380357, "body": "Is your number entered into both the search range and the search value cell directly?  Or are they the result of a formula?  If the latter, you probably have a rounding issue."}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1502880067, "post_id": 45710992, "comment_id": 78380621, "body": "<code>.Find</code> normally does not have type problems with numbers but you could try <code>.Find(CLng(value))</code>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1502880586, "post_id": 45710992, "comment_id": 78380982, "body": "Why have you deleted your old question and re-posted it? It&#39;s not much incentive to help."}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1502887908, "post_id": 45710992, "comment_id": 78386156, "body": "@Jordan Try using the example on <a href=\"https://msdn.microsoft.com/pt-br/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\">Range.Find Method Page</a>? That uses <code>Loop While Not c Is Nothing And c.Address &lt;&gt; firstAddress</code>"}], "owner": {"reputation": 457, "user_id": 7924493, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/227be45ef8a37f0eba642e8cce1b4624?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/7924493/jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 577, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1502879597, "creation_date": 1502878924, "last_edit_date": 1502879597, "question_id": 45710992, "link": "https://stackoverflow.com/questions/45710992/range-find-function-not-finding-numerical-values-vba-excel", "title": "Range.Find() function not finding numerical values - VBA excel", "body": "<p>The problem I'm having is that if Range().Find finds nothing I'm adding the value to the \"Total\" sheet but when the loop starts from the beginning the rgFound = Range.Find() is stilling nothing, resulting in a endless loop. \nThe problem seems to be that </p>\n\n<pre><code>Worksheets(\"Total\").Range(\"A1:A20000\").Find(Worksheets(\"July\").Cells(Index, \"C\").Value, LookIn:=xlValues, Lookat:=xlWhole)\n</code></pre>\n\n<p>Is find values with the following format: 423423_fsd but not numerical values, ex: 42341. Any Ideas?</p>\n\n<pre><code> Sub find()\n Dim rgFound As Range\n\n Dim Index As Long: Index = 6\n\n\n Do While Worksheets(\"July\").Cells(Index, \"C\").Value &gt; 0\n\n    Set rgFound = Worksheets(\"Total\").Range(\"A1:A20000\").Find(Worksheets(\"July\").Cells(Index, \"C\").Value, LookIn:=xlValues, Lookat:=xlWhole)\n\n\n    If Not rgFound Is Nothing Then\n\n        Row = rgFound.Row + 5\n\n\n        Worksheets(\"Total\").Range(\"E\" &amp; Row).Value = Worksheets(\"July\").Range(\"Z\" &amp; Index).Value\n        Worksheets(\"Total\").Range(\"F\" &amp; Row).Value = Worksheets(\"July\").Range(\"AA\" &amp; Index).Value\n        Worksheets(\"Total\").Range(\"G\" &amp; Row).Value = Worksheets(\"July\").Range(\"AB\" &amp; Index).Value\n        Worksheets(\"Total\").Range(\"H\" &amp; Row).Value = Worksheets(\"July\").Range(\"M\" &amp; Index).Value\n        Worksheets(\"Total\").Range(\"J\" &amp; Row).Value = Worksheets(\"July\").Range(\"AF\" &amp; Index).Value\n        Worksheets(\"Total\").Range(\"I\" &amp; Row).Value = Worksheets(\"July\").Range(\"AC\" &amp; Index).Value\n        Worksheets(\"Total\").Range(\"K\" &amp; Row).Value = Worksheets(\"July\").Range(\"J\" &amp; Index).Value\n        Index = Index + 1\n    Else\n\n            Dim lastRow As Long\n            Dim rng As Range\n            Set rng = Sheets(\"Total\").Cells\n\n            lastRow = Last(1, rng)\n\n            Dim Counter As Long: Counter = 1\n\n            Do While Counter &lt; 13\n\n                 lastRow = lastRow + 1\n                 Worksheets(\"Total\").Range(\"A\" &amp; lastRow).Value = Worksheets(\"July\").Cells(Index, \"C\").Value\n                 Worksheets(\"Total\").Range(\"B\" &amp; lastRow).Value = Worksheets(\"July\").Cells(Index, \"B\").Value\n\n                 Counter = Counter + 1\n\n            Loop\n\n            Counter = 1\n\n\n\n    End If\n\n\n        Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1502881309, "post_id": 45710852, "comment_id": 78381540, "body": "Please add further code in the question for designation of the variables path and filename in your prior code which could be leading to the error"}, {"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1502885312, "post_id": 45710852, "comment_id": 78384150, "body": "You are confident you have the permissions associated with accessing that file...? Can you open it through other means?"}, {"owner": {"reputation": 3, "user_id": 8358602, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6YCVqc8HRAo/AAAAAAAAAAI/AAAAAAAABNs/ZHnIO1sMdW8/photo.jpg?sz=128", "display_name": "Jan Kocon", "link": "https://stackoverflow.com/users/8358602/jan-kocon"}, "reply_to_user": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1502885812, "post_id": 45710852, "comment_id": 78384513, "body": "@Cody G. I&#39;m owner of the sharepoint so I have the highest permissions for that site, I&#39;ve provided lower access permisions (Contribute level) and colleague is able to use macro without problem (on Excel 2007)."}, {"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1502886148, "post_id": 45710852, "comment_id": 78384755, "body": "Is it really a &#39;mapped drive&#39; ? It seems more like a URL to me. I would try using http GET to get the file. Alternatively if you want to try a different &quot;open&quot; I would suggest using FSO (file scripting object), but I suspect it won&#39;t change a whole lot. (Sorry I&#39;ve never used sharepoint)"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8358602, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6YCVqc8HRAo/AAAAAAAAAAI/AAAAAAAABNs/ZHnIO1sMdW8/photo.jpg?sz=128", "display_name": "Jan Kocon", "link": "https://stackoverflow.com/users/8358602/jan-kocon"}, "edited": false, "score": 0, "creation_date": 1502878949, "post_id": 45710896, "comment_id": 78379854, "body": "Still I&#39;m receiving that error, it&#39;s just going through debug.print. Macro is working fine on other computer with different software version"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 3, "user_id": 8358602, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6YCVqc8HRAo/AAAAAAAAAAI/AAAAAAAABNs/ZHnIO1sMdW8/photo.jpg?sz=128", "display_name": "Jan Kocon", "link": "https://stackoverflow.com/users/8358602/jan-kocon"}, "edited": false, "score": 1, "creation_date": 1502879001, "post_id": 45710896, "comment_id": 78379898, "body": "@JanKocon - of course! :) But see what is in the immediate window. Or write <code>msgbox path &amp; &quot;\\xml_js\\&quot; &amp; fileName</code> and see the result."}, {"owner": {"reputation": 3, "user_id": 8358602, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6YCVqc8HRAo/AAAAAAAAAAI/AAAAAAAABNs/ZHnIO1sMdW8/photo.jpg?sz=128", "display_name": "Jan Kocon", "link": "https://stackoverflow.com/users/8358602/jan-kocon"}, "edited": false, "score": 0, "creation_date": 1502879670, "post_id": 45710896, "comment_id": 78380360, "body": "It&#39;s just showing me the exactly path <a href=\"https://troom-x.Companyname.com/sites/Sitename/dashboard/filename_status.xml\" rel=\"nofollow noreferrer\">troom-x.Companyname.com/sites/Sitename/dashboard/&hellip;</a> which is true in that case"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 3, "user_id": 8358602, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6YCVqc8HRAo/AAAAAAAAAAI/AAAAAAAABNs/ZHnIO1sMdW8/photo.jpg?sz=128", "display_name": "Jan Kocon", "link": "https://stackoverflow.com/users/8358602/jan-kocon"}, "edited": false, "score": 0, "creation_date": 1502879769, "post_id": 45710896, "comment_id": 78380415, "body": "@JanKocon - now run it from your colleague&#39;s computer and see the difference between the paths."}, {"owner": {"reputation": 3, "user_id": 8358602, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6YCVqc8HRAo/AAAAAAAAAAI/AAAAAAAABNs/ZHnIO1sMdW8/photo.jpg?sz=128", "display_name": "Jan Kocon", "link": "https://stackoverflow.com/users/8358602/jan-kocon"}, "edited": false, "score": 0, "creation_date": 1502881241, "post_id": 45710896, "comment_id": 78381494, "body": "I can see same path."}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1502881432, "post_id": 45710896, "comment_id": 78381631, "body": "It could be an issue with forward slashes vs backslashes in the path name. You can&#39;t mix the two together."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 3, "user_id": 8358602, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6YCVqc8HRAo/AAAAAAAAAAI/AAAAAAAABNs/ZHnIO1sMdW8/photo.jpg?sz=128", "display_name": "Jan Kocon", "link": "https://stackoverflow.com/users/8358602/jan-kocon"}, "edited": false, "score": 0, "creation_date": 1502883349, "post_id": 45710896, "comment_id": 78382830, "body": "@JanKocon - something in the path is not correct -  it if is this one (copied from your comment) - <code>troom-x.Companyname.com&#47;sites&#47;Sitename&#47;dashboard&#47;</code> then where is this part - <code>&quot;\\xml_js\\&quot;</code> ?"}, {"owner": {"reputation": 3, "user_id": 8358602, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6YCVqc8HRAo/AAAAAAAAAAI/AAAAAAAABNs/ZHnIO1sMdW8/photo.jpg?sz=128", "display_name": "Jan Kocon", "link": "https://stackoverflow.com/users/8358602/jan-kocon"}, "edited": false, "score": 0, "creation_date": 1502884112, "post_id": 45710896, "comment_id": 78383328, "body": "Actually I was aware of that and I&#39;ve changed to &quot;/xml_js/&quot; before running macro"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1502878665, "creation_date": 1502878665, "answer_id": 45710896, "question_id": 45710852, "link": "https://stackoverflow.com/questions/45710852/excel-cant-find-path-in-macro/45710896#45710896", "title": "Excel can&#39;t find path in macro", "body": "<p>Write this before the error:</p>\n\n<pre><code>debug.print  path &amp; \"\\xml_js\\\" &amp; fileName\n</code></pre>\n\n<p>You would see what you are trying to open. Probably your <code>path</code> is false or you are missing <code>\\\\</code> or something else.</p>\n"}], "owner": {"reputation": 3, "user_id": 8358602, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6YCVqc8HRAo/AAAAAAAAAAI/AAAAAAAABNs/ZHnIO1sMdW8/photo.jpg?sz=128", "display_name": "Jan Kocon", "link": "https://stackoverflow.com/users/8358602/jan-kocon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 969, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502886077, "creation_date": 1502878519, "last_edit_date": 1502886077, "question_id": 45710852, "link": "https://stackoverflow.com/questions/45710852/excel-cant-find-path-in-macro", "title": "Excel can&#39;t find path in macro", "body": "<p>I'm having problem with macro which I've created to extract *.xml - excel table to chart on website.\nIt was working all the time but after a while I'm not able to run it.</p>\n\n<p>Problem is with line below:</p>\n\n<pre><code> Open path &amp; \"\\xml_js\\\" &amp; fileName For Output As 1\n</code></pre>\n\n<p>Macro is working perfectly fine when file is stored localy for example on my desktop but problem is when I'm trying to open it from mapped drive (sharepoint 2010).\nIt is working when I'm using my colleague computer (W7 + O2007) but not on mine (W7 + O2013).</p>\n\n<p>I'm getting error below:</p>\n\n<blockquote>\n  <p>Run-time error '52':<br>\n     Bad file name or number</p>\n</blockquote>\n\n<p>52 is exactly <code>Open path &amp; (...) As 1</code> line</p>\n\n<p>The rest of the code:</p>\n\n<pre><code>Sub generateRegionsFile()\n\n  Dim fileName As String: fileName = \"XXXXXX_Regions.xml\"\n  Dim path As String: path = ThisWorkbook.path\n\n  ThisWorkbook.Sheets(1).Select\n  Dim rowNum As Long: rowNum = 2\n  Dim jsIndex As Long: jsIndex = 0\n\n  Open path &amp; \"\\xml_js\\\" &amp; fileName For Output As 1\n\n  Cells(15, 16).Select\n\n  Do Until ActiveCell.Value = \"\"\n    NoOfStatuses = NoOfStatuses + 1\n    ActiveCell.Offset(1, 0).Select\n  Loop\n'Chart header\n  Print #1, \"&lt;chart caption='No. of Items' subcaption='per Region' xaxisname='Region' yaxisname='Number of Region' showsum='0' numberprefix='' palette='3' rotatenames='0' animation='1'  basefont='Arial' basefontsize='12' useroundedges='' legendborderalpha='0' canvasbgalpha='0' bgcolor='#fffefe' bgalpha='50' plotgradientcolor='' showplotborder='0' showborder='0' showlegend='0'&gt;\"\n  Print #1, \"\"\n  Print #1, \"   &lt;categories&gt;\"\n\n  Cells(15, 16).Select\n\n    For x = 1 To NoOfStatuses\n    Print #1, \"       &lt;category label='\" &amp; ActiveCell.Value &amp; \"' /&gt;\"\n    ActiveCell.Offset(1, 0).Select\n\n    Next\n\n  Print #1, \"   &lt;/categories&gt;\"\n  Print #1, \"   &lt;dataset seriesname='Number of items'&gt;\"\n  Cells(15, 17).Select\n  For x = 1 To NoOfStatuses\n  Print #1, \"       &lt;set value='\" &amp; ActiveCell.Value &amp; \"' /&gt;\"\n        ActiveCell.Offset(1, 0).Select\n        Next\n\n  Print #1, \"   &lt;/dataset&gt;\"\n\n  Print #1, \"&lt;/chart&gt;\"\n\n  Close #1\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 771, "user_id": 3182178, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/bcb5836e4eca83bba5629299ee1ede12?s=128&d=identicon&r=PG", "display_name": "ebelair", "link": "https://stackoverflow.com/users/3182178/ebelair"}, "edited": false, "score": 1, "creation_date": 1502877073, "post_id": 45710157, "comment_id": 78378664, "body": "I think you can&#39;t, see this post bellow: <a href=\"https://superuser.com/questions/797053/use-an-user-defined-function-for-data-validation\" title=\"use an user defined function for data validation\">superuser.com/questions/797053/&hellip;</a>"}, {"owner": {"reputation": 771, "user_id": 3182178, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/bcb5836e4eca83bba5629299ee1ede12?s=128&d=identicon&r=PG", "display_name": "ebelair", "link": "https://stackoverflow.com/users/3182178/ebelair"}, "edited": false, "score": 0, "creation_date": 1502877430, "post_id": 45710157, "comment_id": 78378890, "body": "I don&#39;t know, maybe the guy who down-vote think you did not make enough researches ..."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1502877737, "post_id": 45710157, "comment_id": 78379090, "body": "Upvoted as the question is both reasonable and clear to me. :)"}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1502877751, "post_id": 45710157, "comment_id": 78379098, "body": "Above answer not cover my question. That answer is: <b>The user-defined function must return a Range not an array of value.</b> and in above, my user defined function returns not an array of value."}], "answers": [{"comments": [{"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1502879272, "post_id": 45710541, "comment_id": 78380070, "body": "Problem. I want apply the validation for the column of a Table. But when using above, <code>IsValid</code> &quot;Refer to&quot; code, not extend from B1 to B2 and ... for each column cell of respective Table. This way works only for single cell, that defined in <code>S2M(B2)&lt;&gt;&quot;Error&quot;</code>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1502879884, "post_id": 45710541, "comment_id": 78380487, "body": "No, if you entered it as specified, it will adjust for each row."}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1502880573, "post_id": 45710541, "comment_id": 78380970, "body": "Greatly thanks. That would be awesome. May I remove above comment, or its better to stay?"}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1502880759, "post_id": 45710541, "comment_id": 78381101, "body": "Why <code>Ignore blank</code> should be uncheck? That is an important point. Whats the reason of unchecking that, related to this?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1502880761, "post_id": 45710541, "comment_id": 78381103, "body": "I don&#39;t mind either way. If you don&#39;t uncheck it, it won&#39;t work. I think it&#39;s a bug."}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1502880976, "post_id": 45710541, "comment_id": 78381275, "body": "Where did you know and get this point? How you found unchecking <code>Ignore blank</code> is related?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1502881041, "post_id": 45710541, "comment_id": 78381325, "body": "I&#39;ve been doing this for quite a long time."}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1502881155, "post_id": 45710541, "comment_id": 78381425, "body": "Please teach Us how did you get this point? I ask this, because reaching your logic of problem solving. (point of should unchecking <code>Ignore blank</code>) I think about why this related to this issue? Or why you said this is a bug and How you think this is a bug, Of course before these, how you get that: should unchecking <code>ignore blank</code> for working this."}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1502882182, "post_id": 45710541, "comment_id": 78382099, "body": "Question: I want this <code>Refer to</code> field of <code>Name</code>, get change and extend automatically when <code>Work Sheet</code> changes. I have several <code>Work Sheets</code> and need use above validation in each columns <code>Table</code> that contains date. In may above name extend and change automatically in each <code>Work Sheet</code> of I should defining several <code>Names</code> for each worksheet?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1502882363, "post_id": 45710541, "comment_id": 78382204, "body": "My point is that I came across that so long ago, that I don&#39;t recall how. It&#39;s a bug because the two should not be related. Re your follow up, I don&#39;t understand the question. You can define an identical name locally to each sheet if that&#39;s what you mean."}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1502882596, "post_id": 45710541, "comment_id": 78382353, "body": "The <code>Refer to</code> field of above <code>Name</code>, automatically change to this: <code>=S2M(Sheet1!B2)&lt;&gt;&quot;Error&quot;</code> and only works in appropriated Worksheet. This Name extend and works truly in each cells of the sheet, that Name was defined first time. but Name formula change as above and in another sheets, been sheet name <code>sheet1!</code> is constant, and cell address, extending."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1502882737, "post_id": 45710541, "comment_id": 78382465, "body": "I know but you can define a name for each worksheet with the appropriate reference."}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1502883066, "post_id": 45710541, "comment_id": 78382669, "body": "Is it possible that name reference automatically changes in another sheets? because I want my Names count been limited, and I have many sheets. May I adding only one name, for all sheets?"}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1502883337, "post_id": 45710541, "comment_id": 78382820, "body": "I have about 7 sheets. I should Add and define 7 Names, with same appropriate reference? This case, is confuser that using 1 name."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1502883657, "post_id": 45710541, "comment_id": 78383037, "body": "You could just use one name and define it as: <code>=S2M(INDIRECT(&quot;RC&quot;,0))&lt;&gt;&quot;Error&quot;</code>"}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1502885090, "post_id": 45710541, "comment_id": 78383989, "body": "Fantastic! Awesome. Thank you with great regard. I Ask this issue (A name for all sheets). Please answer in my new related question. This answer was awesome. Thanks."}, {"owner": {"reputation": 19181, "user_id": 1231, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xfiLz.jpg?s=128&g=1", "display_name": "Donny V.", "link": "https://stackoverflow.com/users/1231/donny-v"}, "edited": false, "score": 0, "creation_date": 1598015127, "post_id": 45710541, "comment_id": 112328126, "body": "A combination of this answer and this one helped me with this. <a href=\"https://stackoverflow.com/questions/36470396/vba-data-validation-with-user-defined-function\" title=\"vba data validation with user defined function\">stackoverflow.com/questions/36470396/&hellip;</a>"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1502877645, "creation_date": 1502877645, "answer_id": 45710541, "question_id": 45710157, "link": "https://stackoverflow.com/questions/45710157/how-can-using-user-defined-function-in-custom-data-validation/45710541#45710541", "title": "How can using user defined function in custom data validation?", "body": "<p>You can do that. Select B2, or whichever cell in row 2 you want the validation to apply to. Now define a name called, say, IsValid, using:</p>\n\n<pre><code>=S2M(B2)&lt;&gt;\"Error\"\n</code></pre>\n\n<p>Now in the data validation box, all you need to enter is:</p>\n\n<pre><code>=IsValid\n</code></pre>\n\n<p>in the source box and make sure to uncheck the Ignore Blank option.</p>\n"}], "owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 734, "favorite_count": 0, "accepted_answer_id": 45710541, "answer_count": 1, "score": 3, "last_activity_date": 1502877645, "creation_date": 1502876488, "last_edit_date": 1502877123, "question_id": 45710157, "link": "https://stackoverflow.com/questions/45710157/how-can-using-user-defined-function-in-custom-data-validation", "title": "How can using user defined function in custom data validation?", "body": "<p>In my <code>Worksheet</code> I have a <code>Table</code> and want to define <code>Data validation</code> for a column that contained the date, as bellow:</p>\n\n<pre><code>=S2M(B2)&lt;&gt;\"Error\"\n</code></pre>\n\n<p>In above, <code>S2M()</code> is a user defined function for converting date from <code>Persian date</code> to <code>Gregorian date</code>, because checking input date is right.</p>\n\n<p>But excel is not letting me use user defined functions in Custom <code>Data validation</code>.</p>\n\n<p>This error shows: A named range you specified cannot be found.</p>\n\n<p>Please note that I was using bellow code in <code>Custom Data validation</code> and that works, right.</p>\n\n<pre><code>=AND(LEN(B2)=10;ISNUMBER(IFERROR(VALUE(MATCH(VALUE(MID(B2;1;4));INDIRECT(\"intTable[Year]\");0)&amp;MATCH(MID(B2;6;2);INDIRECT(\"intTable[Mounth]\");0)&amp;MATCH(MID(B2;9;2);INDIRECT(\"intTable[Day]\");0));FALSE)))\n</code></pre>\n\n<p>Explain is a Persian date example: 1396/05/25</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel", "bloomberg"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 1, "creation_date": 1502875793, "post_id": 45709803, "comment_id": 78377718, "body": "For benefit of non-Bloomberg users, BDH() is a Bloomberg add-in function, short for Bloomberg Data History"}, {"owner": {"reputation": 43, "user_id": 8469518, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/45316b81801fd41eae3631c3ce80c9ce?s=128&d=identicon&r=PG&f=1", "display_name": "Micha Brugger", "link": "https://stackoverflow.com/users/8469518/micha-brugger"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1502875926, "post_id": 45709803, "comment_id": 78377822, "body": "Someone told me that if I added this timer after every runthrough it would help excel not to slow down. Is that a myth then?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1502875963, "post_id": 45709803, "comment_id": 78377849, "body": "@Yarza - it&#39;s a lie."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1502875995, "post_id": 45709803, "comment_id": 78377870, "body": "@Yarza: seems very curious that such an obvious slowdown has been added, I wonder if Bloomberg don&#39;t like their servers being hit so intensely.  So I wonder if it might very well be deliberate."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1502877668, "post_id": 45709803, "comment_id": 78379043, "body": "it looks like you are filling your worksheets with a huge amount of formulas.  If this is historic data then it doesn&#39;t change, i.e. it is static.  So why have formulas to recalculate.  Why not hard code the results?"}, {"owner": {"reputation": 43, "user_id": 8469518, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/45316b81801fd41eae3631c3ce80c9ce?s=128&d=identicon&r=PG&f=1", "display_name": "Micha Brugger", "link": "https://stackoverflow.com/users/8469518/micha-brugger"}, "edited": false, "score": 0, "creation_date": 1502878368, "post_id": 45709803, "comment_id": 78379487, "body": "@S Meaden: The way I understand it I need the formula so it downloads the data I need over the bloomberg add-in. How could I hard code that?"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1502879893, "post_id": 45709803, "comment_id": 78380498, "body": "@Yarza: I added some code to an answer that will hard-coded results to the worksheet."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 4, "last_activity_date": 1502878770, "last_edit_date": 1502878770, "creation_date": 1502875778, "answer_id": 45709899, "question_id": 45709803, "link": "https://stackoverflow.com/questions/45709803/vba-macro-efficiency-with-bloomberg-data-history/45709899#45709899", "title": "VBA-Macro efficiency with Bloomberg Data History", "body": "<p>Remove <code>Application.Wait (Now + TimeValue(\"0:00:03\"))</code>. Or put <code>Next i</code> above it like this:</p>\n\n<pre><code>Next i\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n</code></pre>\n\n<p>You would gain about 43 minutes.</p>\n\n<p>If you still like the idea of waiting, do it a bit more sophisticated, like this:</p>\n\n<pre><code>If i Mod 50 = 0 Then Application.Wait (Now + TimeValue(\"0:00:02\"))\nNext i\n</code></pre>\n\n<p>Thus, it would wait on every 50th iteration.</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 8469518, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/45316b81801fd41eae3631c3ce80c9ce?s=128&d=identicon&r=PG&f=1", "display_name": "Micha Brugger", "link": "https://stackoverflow.com/users/8469518/micha-brugger"}, "edited": false, "score": 0, "creation_date": 1502877419, "post_id": 45710039, "comment_id": 78378885, "body": "to be honest, I dont fully understand what you mean. would be really nice if you could explain that to me."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 43, "user_id": 8469518, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/45316b81801fd41eae3631c3ce80c9ce?s=128&d=identicon&r=PG&f=1", "display_name": "Micha Brugger", "link": "https://stackoverflow.com/users/8469518/micha-brugger"}, "edited": false, "score": 0, "creation_date": 1502878970, "post_id": 45710039, "comment_id": 78379875, "body": "What you are doing constructing the formula, is just replacing row numbers and addresses, so you can use the formula <code>row()</code> and the formula <code>address</code> instead, add 1 row, fill down, then continue the loop of <code>i</code> Let excel&#39;s fill down do your loop <code>For k = 2 To 876</code>  Run one loop of I and look at the result, the formula can be done by cell references being filled down."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1502876148, "creation_date": 1502876148, "answer_id": 45710039, "question_id": 45709803, "link": "https://stackoverflow.com/questions/45709803/vba-macro-efficiency-with-bloomberg-data-history/45710039#45710039", "title": "VBA-Macro efficiency with Bloomberg Data History", "body": "<p>does it not all translate to being along the lines of A2 being <code>=offset(Input!B1,row(),0)</code> and B2 being <code>=BDH(ADDRESS(ROW(),1,4),\"\"TURNOVER.....</code> as formula just being filled down?</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 8469518, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/45316b81801fd41eae3631c3ce80c9ce?s=128&d=identicon&r=PG&f=1", "display_name": "Micha Brugger", "link": "https://stackoverflow.com/users/8469518/micha-brugger"}, "edited": false, "score": 0, "creation_date": 1502880426, "post_id": 45711309, "comment_id": 78380868, "body": "Thank you very much! Can I just add those codelines to my code? Or what should I do with them? Please forgive me if it is a stupid question."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 43, "user_id": 8469518, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/45316b81801fd41eae3631c3ce80c9ce?s=128&d=identicon&r=PG&f=1", "display_name": "Micha Brugger", "link": "https://stackoverflow.com/users/8469518/micha-brugger"}, "edited": false, "score": 0, "creation_date": 1502882006, "post_id": 45711309, "comment_id": 78381980, "body": "@Yarza: I can&#39;t rewrite your code as I do not have Bloomberg, if you have Bloomberg I presume you an IT department, they ought to be able to help if you give them the above sample code."}, {"owner": {"reputation": 43, "user_id": 8469518, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/45316b81801fd41eae3631c3ce80c9ce?s=128&d=identicon&r=PG&f=1", "display_name": "Micha Brugger", "link": "https://stackoverflow.com/users/8469518/micha-brugger"}, "edited": false, "score": 0, "creation_date": 1502888767, "post_id": 45711309, "comment_id": 78386866, "body": "@S Meaden: Actually I&#39;m just a university kid that did some macros before and tries to help a friend with her PhD thesis. So sadly, there is no IT departement to back me up here."}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 0, "last_activity_date": 1502879868, "creation_date": 1502879868, "answer_id": 45711309, "question_id": 45709803, "link": "https://stackoverflow.com/questions/45709803/vba-macro-efficiency-with-bloomberg-data-history/45711309#45711309", "title": "VBA-Macro efficiency with Bloomberg Data History", "body": "<p>Further to my comments about hard-coding.  Here is some code to help not call static data functions repeatedly</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\n    Dim rng As Excel.Range\n    Set rng = Worksheets(1).Cells(1, 1)\n\n    rng.Formula = \"=SIN(PI()/4)\"  '* a formula is in fact constant\n\n    '* in some instances Evaluate will suffice\n    Dim vHardcodedFormulaResult As Variant\n    vHardcodedFormulaResult = Application.Evaluate(\"SIN(PI()/4)\")\n\n    rng.Offset(1, 0).Value2 = vHardcodedFormulaResult\n\n    '* in other cases Application.Run will be needed and also multi-cell return results\n\n    Dim vHardcodedFormulaResult2 As Variant\n    vHardcodedFormulaResult2 = Application.Run(\"FakeBDH\", \"Citi\", \"FakeParam\")\n\n    Dim lIndex As Long\n    lIndex = 0\n    Dim vLoop As Variant\n    For Each vLoop In vHardcodedFormulaResult2\n\n        rng.Offset(2, lIndex) = vLoop\n        lIndex = lIndex + 1\n    Next vLoop\n\n\nEnd Sub\n\n\nFunction FakeBDH(ByVal sKey As String, ByVal vParam1) As Variant\n    FakeBDH = Array(2015, 45000)\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1503021354, "creation_date": 1503021354, "answer_id": 45747352, "question_id": 45709803, "link": "https://stackoverflow.com/questions/45709803/vba-macro-efficiency-with-bloomberg-data-history/45747352#45747352", "title": "VBA-Macro efficiency with Bloomberg Data History", "body": "<p>Sorry, but what are you trying to do, exactly?  Do you want time series data for equities?  Is so, try the link below.</p>\n\n<p><a href=\"http://investexcel.net/multiple-stock-quote-downloader-for-excel/\" rel=\"nofollow noreferrer\">http://investexcel.net/multiple-stock-quote-downloader-for-excel/</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/2DI0c.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2DI0c.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 43, "user_id": 8469518, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/45316b81801fd41eae3631c3ce80c9ce?s=128&d=identicon&r=PG&f=1", "display_name": "Micha Brugger", "link": "https://stackoverflow.com/users/8469518/micha-brugger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 771, "favorite_count": 1, "answer_count": 4, "score": 1, "last_activity_date": 1503021354, "creation_date": 1502875514, "last_edit_date": 1502882345, "question_id": 45709803, "link": "https://stackoverflow.com/questions/45709803/vba-macro-efficiency-with-bloomberg-data-history", "title": "VBA-Macro efficiency with Bloomberg Data History", "body": "<p>I'm very new to VBA. I wrote this code and it works, but it takes ages to run through and I get the feeling that its getting slower and slower the longer it has been running.</p>\n\n<p>Is there a way I can make things like this more efficient? Would be awesome if anyone out there had some advise for me here.</p>\n\n<pre><code>Sub Sheets()\nApplication.ScreenUpdating = False\nActiveWindow.WindowState = xlMinimized\n\nDim Data As String\nDim i As Long\nDim k As Long\nDim x As Long\nDim y As String\n\n\nFor i = 2 To 255\n\nSheetname = Worksheets(\"Input\").Cells(i, 1).Value\nWorksheets.Add.Name = Sheetname\nActiveSheet.Move After:=Worksheets(ActiveWorkbook.Sheets.Count)\n\nx = 1\n\nFor k = 2 To 876\nData = Worksheets(\"Input\").Cells(i, k).Value\ny = Cells(1, x).Address(RowAbsolute:=False, ColumnAbsolute:=False)\nBloomB = \"=BDH(\" &amp; y &amp; \",\"\"TURNOVER\"\",\"\"8/1/2011\"\",\"\"4/30/2016\"\",\"\"Dir=V\"\",\"\"Dts=S\"\",\"\"Sort=A\"\",\"\"Quote=C\"\",\"\"QtTyp=Y\"\",\"\"Days=T\"\",\"\"Per=cd\"\",\"\"DtFmt=D\"\",\"\"UseDPDF=Y\"\")\"\nWorksheets(Sheetname).Cells(1, x) = Data\nWorksheets(Sheetname).Cells(2, x) = BloomB\nx = x + 2\nNext k\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\nNext i\n\nActiveWindow.WindowState = xlMaximized\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "find", "symbols"], "comments": [{"owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1502872941, "post_id": 45708809, "comment_id": 78375774, "body": "so you want to find an <code>integer&#47;integer</code> ... try googling on those lines. May push you in the right direction"}, {"owner": {"reputation": 573, "user_id": 6309794, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6a09f4eeb29133577efb06179a6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "KiW", "link": "https://stackoverflow.com/users/6309794/kiw"}, "reply_to_user": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1502873722, "post_id": 45708809, "comment_id": 78376271, "body": "Thanks for the hint. The only idea I get from that is finding all &quot;/&quot; entries and then loop and check if the value before and after isnumeric, or is there a smarter way that I am not seeing? (Not sure this will work, but I&#39;ll try)"}, {"owner": {"reputation": 82895, "user_id": 372239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/2twLb.jpg?s=128&g=1", "display_name": "Toto", "link": "https://stackoverflow.com/users/372239/toto"}, "edited": false, "score": 0, "creation_date": 1502874257, "post_id": 45708809, "comment_id": 78376609, "body": "I am not a vba expert but I think you have to create a regex object <code>Set regex = CreateObject(&quot;VBScript.RegExp&quot;)</code> then define <code>regex.pattern =&quot;\\d+&#47;\\d+&quot;</code> then execute <code>matches = regex.execute(Sheets(&quot;Tabelle1&quot;).Range(&quot;A1:K100&quot;)</code> or something like that."}], "answers": [{"comments": [{"owner": {"reputation": 573, "user_id": 6309794, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6a09f4eeb29133577efb06179a6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "KiW", "link": "https://stackoverflow.com/users/6309794/kiw"}, "edited": false, "score": 0, "creation_date": 1502874848, "post_id": 45709477, "comment_id": 78377029, "body": "I will try it in a second, will it have an effect if some entries do not contain a &quot;/&quot;?  Thanks a lot anyway already:)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 573, "user_id": 6309794, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6a09f4eeb29133577efb06179a6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "KiW", "link": "https://stackoverflow.com/users/6309794/kiw"}, "edited": false, "score": 0, "creation_date": 1502874920, "post_id": 45709477, "comment_id": 78377078, "body": "@KiW - there is a boolean function <code>blnCheck2Integers</code>, which is the reason why it works."}, {"owner": {"reputation": 573, "user_id": 6309794, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6a09f4eeb29133577efb06179a6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "KiW", "link": "https://stackoverflow.com/users/6309794/kiw"}, "edited": false, "score": 1, "creation_date": 1502876264, "post_id": 45709477, "comment_id": 78378062, "body": "Awesome it works! Really grateful, I was hanging there for a while."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 573, "user_id": 6309794, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6a09f4eeb29133577efb06179a6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "KiW", "link": "https://stackoverflow.com/users/6309794/kiw"}, "edited": false, "score": 0, "creation_date": 1502876306, "post_id": 45709477, "comment_id": 78378101, "body": "@KiW - thumbs up! :)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1502874617, "creation_date": 1502874617, "answer_id": 45709477, "question_id": 45708809, "link": "https://stackoverflow.com/questions/45708809/find-variable-value-symbol-combination/45709477#45709477", "title": "Find Variable Value + Symbol Combination", "body": "<p>Here you go, check it out:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    Dim arrInput    As Variant\n    Dim varVar      As Variant\n    Dim lngCounter  As Long\n\n    arrInput = [{\"100 mt/h\",\"m3/t\",\"S/C\",\"0/700\",\"0/25\",\"5/31\",\"43/47\",\"700/1000\"}]\n\n    For Each varVar In arrInput\n        Debug.Print varVar\n        Debug.Print blnCheck2Integers(varVar)\n        Debug.Print \"------------------------------\"\n    Next varVar\n\nEnd Sub\n\nPublic Function blnCheck2Integers(ByVal strInput As String, _\n                                            Optional strDelim = \"/\") As Boolean\n\n    Dim arrTemp As Variant\n\n    arrTemp = Split(strInput, strDelim)\n    If UBound(arrTemp) &lt;&gt; 1 Then Exit Function\n    blnCheck2Integers = IsNumeric(arrTemp(0)) And IsNumeric(arrTemp(1))\n\nEnd Function\n</code></pre>\n\n<p>You split by \"/\" and then check whether the two values are numeric or not. If the values are not 2, you return false. This is the result in the console:</p>\n\n<pre><code>100 mt/h\nFalse\n------------------------------\nm3/t\nFalse\n------------------------------\nS/C\nFalse\n------------------------------\n0/700\nTrue\n------------------------------\n0/25\nTrue\n------------------------------\n5/31\nTrue\n------------------------------\n43/47\nTrue\n------------------------------\n700/1000\nTrue\n------------------------------\n</code></pre>\n"}], "owner": {"reputation": 573, "user_id": 6309794, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6a09f4eeb29133577efb06179a6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "KiW", "link": "https://stackoverflow.com/users/6309794/kiw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 45709477, "answer_count": 1, "score": 1, "last_activity_date": 1518796294, "creation_date": 1502872608, "last_edit_date": 1531164843, "question_id": 45708809, "link": "https://stackoverflow.com/questions/45708809/find-variable-value-symbol-combination", "title": "Find Variable Value + Symbol Combination", "body": "<p>I have the following problem. I am reading unsorted text from a pdf into excel, filling my worksheet with rather random entries. </p>\n\n<p>No I am searching for elements which works quite well for most parts, I am just running into major problems finding a variable value &amp; symbol &amp; variable value combination.\nThe combinations like e.g. <code>0/700</code> occur in different parts and show no order in which to find them. </p>\n\n<p>Example Table:</p>\n\n<pre><code>100 mt/h \nm\u00b3/t\nS/C\n0/700\n0/25\n5/31\n43/47\n700/1000\n</code></pre>\n\n<p>I need to find everything that is a \"number\"/\"number\" combination e.g. <code>0/700</code>. Problem is the only constant in that is the \"/\" (slash), which occurs also in other cells. So I am wondering if there is a chance to search for number / number.</p>\n\n<p>I tried the following:</p>\n\n<pre><code>Set prdct = Sheets(\"Tabelle1\").Range(\"A1:K100\").Find(\"/\")\n</code></pre>\n\n<p>Giving me all entries that have a slash occuring which unfortunately doesnt help. \nSo I went a bit further by trying:</p>\n\n<pre><code>Set prdct = Sheets(\"Tabelle1\").Range(\"A1:K100\").Find(\"\\d*/\\d*\")\nSet prdct = Sheets(\"Tabelle1\").Range(\"A1:K100\").Find(\"\\d*\"&amp;\"/\"&amp;\"\\d*\")\nSet prdct = Sheets(\"Tabelle1\").Range(\"A1:K100\").Find(\"\\d+/\\d+\")\nSet prdct = Sheets(\"Tabelle1\").Range(\"A1:K100\").Find(\"\\d+\"&amp;\"/\"&amp;\"\\d+\")\n</code></pre>\n\n<p>All the last ones return <code>Nothing</code>, so obviously something isn't working out. \nIf it helps the maximum value on the left side of the slash can be max <code>999</code>, on the right side of the slash maximum <code>9999</code>. But it can be <code>0/1</code> as well. \nI would really appreciate any help, hints different appraoches and the like. Cheers. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 1, "creation_date": 1502871978, "post_id": 45708563, "comment_id": 78375133, "body": "Sounds like you&#39;re trying to divide by zero. Check the values of Label9 and Label27 are not zero."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1502872802, "post_id": 45708563, "comment_id": 78375686, "body": "No, division by zero raises runtime error 11"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502873262, "post_id": 45708563, "comment_id": 78375965, "body": "Which line do you get the error on?  What are the values of your <code>Label27</code>, etc, variables when it crashes?"}, {"owner": {"reputation": 3, "user_id": 8471028, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mncbqfTDuLI/AAAAAAAAAAI/AAAAAAAABQY/f-u8JRf5WNY/photo.jpg?sz=128", "display_name": "Sasan Fadakar", "link": "https://stackoverflow.com/users/8471028/sasan-fadakar"}, "edited": false, "score": 0, "creation_date": 1502873821, "post_id": 45708563, "comment_id": 78376345, "body": "when i run combobox in userform,the label 27 have not value yet,i think it be equal zero as default."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502873961, "post_id": 45708563, "comment_id": 78376431, "body": "When it crashes, hover your mouse over each <code>Label27</code> type variable in the code - it should show what the actual value is.  That&#39;s what we need to know, not just what you <b>think</b> it will be.  (If our programs always used the values we <b>thought</b> they should be using, they would never crash on us!  :D )"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 3, "creation_date": 1502874094, "post_id": 45708563, "comment_id": 78376520, "body": "Ahh - <code>0 &#47; 0</code> gives an overflow, so @Olly was probably spot on.  So if <code>Label9</code> and <code>Label27</code> are both zero, or blank, your first <code>Label35 =</code> line will be executed and will overflow."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502874232, "post_id": 45708563, "comment_id": 78376595, "body": "@YowE3K; You nailed it. Another quirk of VBA... You should post this as answer so that we can upvote and make this the solution."}, {"owner": {"reputation": 3, "user_id": 8471028, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mncbqfTDuLI/AAAAAAAAAAI/AAAAAAAABQY/f-u8JRf5WNY/photo.jpg?sz=128", "display_name": "Sasan Fadakar", "link": "https://stackoverflow.com/users/8471028/sasan-fadakar"}, "reply_to_user": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1502874408, "post_id": 45708563, "comment_id": 78376698, "body": "label27 and label 9 is zero.thanks @Olly"}, {"owner": {"reputation": 3, "user_id": 8471028, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mncbqfTDuLI/AAAAAAAAAAI/AAAAAAAABQY/f-u8JRf5WNY/photo.jpg?sz=128", "display_name": "Sasan Fadakar", "link": "https://stackoverflow.com/users/8471028/sasan-fadakar"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502874517, "post_id": 45708563, "comment_id": 78376773, "body": "thanks for guidance @yowe3k"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1502875286, "post_id": 45708563, "comment_id": 78377360, "body": "@FunThomas - welcome to the club - <a href=\"https://stackoverflow.com/questions/45485285/why-is-0-divided-by-0-throwing-an-overflow-error-in-vba\" title=\"why is 0 divided by 0 throwing an overflow error in vba\">stackoverflow.com/questions/45485285/&hellip;</a>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1502897484, "post_id": 45708563, "comment_id": 78393314, "body": "@FunThomas Please check out Olly&#39;s answer and upvote if you feel it is appropriate."}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502873175, "post_id": 45708857, "comment_id": 78375913, "body": "Sounds good, but the OP&#39;s code is using <code>Val</code> which means all the calcs should be being done as <code>Double</code>.  (At least a <code>TypeName(Val(&quot;1&quot;))</code>, and even <code>TypeName(Val(CInt(1)))</code>, returns <code>Double</code>, so I can&#39;t see anything that would be dropping it back to an <code>Integer</code>.)"}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1502874045, "last_edit_date": 1502874045, "creation_date": 1502872737, "answer_id": 45708857, "question_id": 45708563, "link": "https://stackoverflow.com/questions/45708563/runtime-error-6-overflow-vba/45708857#45708857", "title": "runtime error &#39;6&#39; overflow-vba", "body": "<p>An overflow may happen if VBA is using <code>int</code> as datatype and an intermediate result exceeds the size of an <code>int</code> - even if the final result is small enough to fit into an <code>int</code></p>\n\n<pre><code>Dim i As Integer\ni = 1000 * 1000 / 2000    ' Will raise overflow\n</code></pre>\n\n<p>You should force VBA to use datatype <code>long</code>.\nSo instead of using function <code>val</code>, use function <code>CLng</code>.</p>\n\n<pre><code>Dim i As Integer\ni = CLng(1000) * 1000 / 2000    ' Okay\ni = CLng(\"1000\") * CLng(\"1000\") / cLng(\"2000\")    ' Okay\n</code></pre>\n\n<p>As YowEwK statet, this maybe doesn't solve your issue. If not, define a variable for every value you are dealing with (as <code>long</code> or <code>double</code>), assign the value f the label to it and check the values of them in the debugger if the runtime error still happens:</p>\n\n<pre><code>Dim val27 As doubble\nDim val19 As doubble\nval27 = Val(Label27)\nval9 = Val(Label9)\n...\n</code></pre>\n\n<p>BTW: You should consider to name all your fields and variables with something meaningful. And do not forget to add <code>Option explicit</code></p>\n"}, {"tags": [], "owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "is_accepted": false, "score": 1, "last_activity_date": 1502897364, "last_edit_date": 1502897364, "creation_date": 1502877188, "answer_id": 45710396, "question_id": 45708563, "link": "https://stackoverflow.com/questions/45708563/runtime-error-6-overflow-vba/45710396#45710396", "title": "runtime error &#39;6&#39; overflow-vba", "body": "<p>Sounds like you're trying to divide zero by zero. Check the values of <code>Label9</code> and <code>Label27</code> are not zero.</p>\n\n<p>Normally a division by zero will generate a</p>\n\n<blockquote>\n  <p>Run-time error '11': Division by zero</p>\n</blockquote>\n\n<p>error, but if <code>Label9</code> is zero (or blank) <strong>and</strong> <code>(val(Label13) - val(Label14) + 1) * val(Label27)</code> evaluates to zero (probably because <code>Label27</code> is zero) you will be calculating <code>0 / 0</code> which causes VBA to generate a</p>\n\n<blockquote>\n  <p>Run-time error '6': Overflow</p>\n</blockquote>\n\n<p>error.</p>\n"}], "owner": {"reputation": 3, "user_id": 8471028, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mncbqfTDuLI/AAAAAAAAAAI/AAAAAAAABQY/f-u8JRf5WNY/photo.jpg?sz=128", "display_name": "Sasan Fadakar", "link": "https://stackoverflow.com/users/8471028/sasan-fadakar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1089, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1502897364, "creation_date": 1502871759, "last_edit_date": 1531164843, "question_id": 45708563, "link": "https://stackoverflow.com/questions/45708563/runtime-error-6-overflow-vba", "title": "runtime error &#39;6&#39; overflow-vba", "body": "<p>i have runtime error '6' overflow when i execute following code.</p>\n\n<pre><code>Private Sub ComboBox1_CLICK()\n\nIf val(Label27) &gt;= 0 And val(Label27) &lt;= val(Label9) Then    \n    Label35 = (val(Label13) - val(Label14) + 1) * val(Label27)/val(Label9)    \nElseIf val(Label27) &gt;= val(Label9) And val(Label27) &lt;= val(Label6) Then    \n    Label35 = val(Label13) + 1    \nElse     \n    Label35 = (val(Label13) + 1) * val(Label6) / val(Label27)            \nEnd If\n\nend sub\n</code></pre>\n"}, {"tags": ["vba", "python-2.7", "win32com"], "comments": [{"owner": {"reputation": 8680, "user_id": 4013571, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh4.googleusercontent.com/-G_CrKyh2orQ/AAAAAAAAAAI/AAAAAAAAADA/d4aRKztH0r4/photo.jpg?sz=128", "display_name": "Alexander McFarlane", "link": "https://stackoverflow.com/users/4013571/alexander-mcfarlane"}, "edited": false, "score": 2, "creation_date": 1502871961, "post_id": 45708492, "comment_id": 78375120, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/14732340/how-to-call-excel-vba-functions-and-subs-using-python-win32com\">How to call Excel VBA functions and subs using Python win32com?</a>"}, {"owner": {"reputation": 881, "user_id": 4086171, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/scYVK.jpg?s=128&g=1", "display_name": "Bosen", "link": "https://stackoverflow.com/users/4086171/bosen"}, "reply_to_user": {"reputation": 8680, "user_id": 4013571, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh4.googleusercontent.com/-G_CrKyh2orQ/AAAAAAAAAAI/AAAAAAAAADA/d4aRKztH0r4/photo.jpg?sz=128", "display_name": "Alexander McFarlane", "link": "https://stackoverflow.com/users/4013571/alexander-mcfarlane"}, "edited": false, "score": 0, "creation_date": 1502872037, "post_id": 45708492, "comment_id": 78375176, "body": "@AlexanderMcFarlane I do not think this is a duplication. I am able to call VBA functions. I just want to find out is there a way to get some form of result from them."}, {"owner": {"reputation": 881, "user_id": 4086171, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/scYVK.jpg?s=128&g=1", "display_name": "Bosen", "link": "https://stackoverflow.com/users/4086171/bosen"}, "reply_to_user": {"reputation": 8680, "user_id": 4013571, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh4.googleusercontent.com/-G_CrKyh2orQ/AAAAAAAAAAI/AAAAAAAAADA/d4aRKztH0r4/photo.jpg?sz=128", "display_name": "Alexander McFarlane", "link": "https://stackoverflow.com/users/4013571/alexander-mcfarlane"}, "edited": false, "score": 0, "creation_date": 1502872378, "post_id": 45708492, "comment_id": 78375400, "body": "@AlexanderMcFarlane Ah I see! Thanks!"}], "owner": {"reputation": 881, "user_id": 4086171, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/scYVK.jpg?s=128&g=1", "display_name": "Bosen", "link": "https://stackoverflow.com/users/4086171/bosen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 286, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502872618, "creation_date": 1502871489, "last_edit_date": 1502872618, "question_id": 45708492, "link": "https://stackoverflow.com/questions/45708492/receive-result-from-vba-script-via-python", "title": "Receive Result from VBA script via Python", "body": "<p>TLDR: I want to <strong>receive the result</strong>(to python) from a vba function that I triggered via python. I am <strong>able</strong> to trigger the vba function.</p>\n\n<p>I am able to <strong>trigger</strong> a vba function via python. Now, I want to receive the <strong>result</strong> of that vba function back in that <strong>same</strong> python program (the one that called the vba function). How do I do it?</p>\n\n<p>Is it even possible?</p>\n\n<p>Currently I am triggering my vba via this function:</p>\n\n<pre><code>xl = win32com.client.Dispatch(\"Excel.Application\")\nresult = xl.Application.Run(\"my_vba_function_name\", param1)\n</code></pre>\n\n<p>The reason why I want to <strong>trigger a vba function</strong> rather that <strong>modifying the excel file directly via python</strong> is that I want to be able to open and view/edit the file via <strong>microsoft excel</strong> at the <strong>same time</strong>.</p>\n\n<p>Thanks</p>\n\n<p>EDIT: I got the result from the other post.</p>\n"}, {"tags": ["vba", "clipboard", "paste"], "comments": [{"owner": {"reputation": 442, "user_id": 1832175, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6559a21eddd2c8d44c816c0601d78d6e?s=128&d=identicon&r=PG", "display_name": "Marius Katinas", "link": "https://stackoverflow.com/users/1832175/marius-katinas"}, "edited": false, "score": 0, "creation_date": 1502871249, "post_id": 45708238, "comment_id": 78374687, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/36619386/vba-excel-2010-paste-directly-from-clipboard\">VBA Excel 2010 - Paste directly from clipboard</a>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502871561, "post_id": 45708238, "comment_id": 78374881, "body": "Can the object you are copying from the clipboard be interpreted as a <code>Range</code> object so that its <code>Value</code> property can be accessed?  (Note that the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-pastespecial-method-excel\" rel=\"nofollow noreferrer\">Range.PasteSpecial Method (Excel)</a> documentation says that it &quot;Pastes a <b>Range</b> that has been copied into the specified range.&quot;"}, {"owner": {"reputation": 1, "user_id": 8471184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d23620f0da8b2f434dc5a5f4310c03f6?s=128&d=identicon&r=PG&f=1", "display_name": "Niels", "link": "https://stackoverflow.com/users/8471184/niels"}, "reply_to_user": {"reputation": 442, "user_id": 1832175, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6559a21eddd2c8d44c816c0601d78d6e?s=128&d=identicon&r=PG", "display_name": "Marius Katinas", "link": "https://stackoverflow.com/users/1832175/marius-katinas"}, "edited": false, "score": 0, "creation_date": 1502871572, "post_id": 45708238, "comment_id": 78374888, "body": "@marius I have tried this post, but unfortanetly it didn&#39;t work for me."}, {"owner": {"reputation": 1, "user_id": 8471184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d23620f0da8b2f434dc5a5f4310c03f6?s=128&d=identicon&r=PG&f=1", "display_name": "Niels", "link": "https://stackoverflow.com/users/8471184/niels"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502871722, "post_id": 45708238, "comment_id": 78374975, "body": "@YowE3K, i am not sure. The data is Always from colomn A:J, but the rows differ daily from 3 till 80"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502871835, "post_id": 45708238, "comment_id": 78375043, "body": "&quot;The data is Always from colomn A:J&quot; - So you are copying from Excel.  Why not just do a standard copy/paste?  How are you getting the data into the clipboard?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502872020, "post_id": 45708238, "comment_id": 78375163, "body": "Actually, looking at your code, isn&#39;t <code>str1 = clipboard.GetText</code> something that gets text data from the clipboard and puts it into the string <code>str1</code>.  I&#39;ve never used that before, but perhaps it clears the clipboard as it does it.  What are you doing with <code>str1</code> after you have got it?  (You aren&#39;t using it in your posted code, but perhaps you use it later?)"}, {"owner": {"reputation": 210, "user_id": 8205970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa718bc0e864734c74c657e23b8f555a?s=128&d=identicon&r=PG&f=1", "display_name": "B Slater", "link": "https://stackoverflow.com/users/8205970/b-slater"}, "edited": false, "score": 0, "creation_date": 1502872021, "post_id": 45708238, "comment_id": 78375165, "body": "Pulling data straight from the clipboard is really awkward and requires some API calls, YowE3K is right that you should just copy straight from the range. If it differs daily then change your code to copy different ranges, don&#39;t try to paste differently"}, {"owner": {"reputation": 1, "user_id": 8471184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d23620f0da8b2f434dc5a5f4310c03f6?s=128&d=identicon&r=PG&f=1", "display_name": "Niels", "link": "https://stackoverflow.com/users/8471184/niels"}, "edited": false, "score": 0, "creation_date": 1502872089, "post_id": 45708238, "comment_id": 78375208, "body": "No i copy the data from Simcorp but it has Always the same columns and headers."}, {"owner": {"reputation": 1, "user_id": 8471184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d23620f0da8b2f434dc5a5f4310c03f6?s=128&d=identicon&r=PG&f=1", "display_name": "Niels", "link": "https://stackoverflow.com/users/8471184/niels"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502872231, "post_id": 45708238, "comment_id": 78375288, "body": "@YowE3K, I used str1 instead of selection in the last row of the code but it didn&#39;t work either. Maybe my code is completely wrong, does any one have a suggestion?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502872780, "post_id": 45708238, "comment_id": 78375674, "body": "Without knowing what you have on the clipboard, and why you are doing a <code>clipboard.GetText</code>, it&#39;s hard to tell what you should do.  It may be as simple as just doing a <code>Range(&quot;A1&quot;).Select: ActiveSheet.Paste</code> without mucking about with any of the <code>clipboard</code> stuff.  (Have you tried doing the paste manually?  Does it work when you do it?  If so, the <code>Range(&quot;A1&quot;).Select: ActiveSheet.Paste</code> method should work.)"}, {"owner": {"reputation": 1, "user_id": 8471184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d23620f0da8b2f434dc5a5f4310c03f6?s=128&d=identicon&r=PG&f=1", "display_name": "Niels", "link": "https://stackoverflow.com/users/8471184/niels"}, "edited": false, "score": 0, "creation_date": 1502873040, "post_id": 45708238, "comment_id": 78375834, "body": "Yes, thank you very much. It works perfectly now :)"}], "owner": {"reputation": 1, "user_id": 8471184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d23620f0da8b2f434dc5a5f4310c03f6?s=128&d=identicon&r=PG&f=1", "display_name": "Niels", "link": "https://stackoverflow.com/users/8471184/niels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2717, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502870675, "creation_date": 1502870675, "question_id": 45708238, "link": "https://stackoverflow.com/questions/45708238/paste-data-from-clipboard", "title": "Paste data from clipboard", "body": "<p>I am trying to clean Sheet1 and paste directly from the clipboard (not from Excel) into Sheet1 cell A1 with paste special values. The reason it needs to be done this way is because the number of lines differs daily. At the moment i have below but i get Run-time error '1004': PasteSpecial method of Range class failed.</p>\n\n<pre><code>Dim clipboard As MSForms.DataObject\nDim str1 As String\n\nSet clipboard = New MSForms.DataObject\n\nRange(\"A1:K80\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.ClearContents\n\nclipboard.GetFromClipboard\n\nstr1 = clipboard.GetText\n\nRange(\"A1\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502871200, "post_id": 45708048, "comment_id": 78374650, "body": "The first two proposed approaches do not change the outcome. When it comes to debug.print, function3 = function1 returns True, which is obviously wrong"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502871949, "post_id": 45708048, "comment_id": 78375113, "body": "@L.Dutch - so did you find a solution?"}, {"owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1502873340, "post_id": 45708048, "comment_id": 78376008, "body": "Found it. I was using the wrong index in addressing the cell (m instead of n)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1502870082, "creation_date": 1502870082, "answer_id": 45708048, "question_id": 45707965, "link": "https://stackoverflow.com/questions/45707965/write-a-string-when-content-of-two-other-cells-matches-a-reference/45708048#45708048", "title": "Write a string when content of two other cells matches a reference", "body": "<p><code>sampleFunction</code> and <code>sampleFailure</code> should be in inverted commas like this:</p>\n\n<pre><code>If Sheets(\"AAA\").Range(\"B\" &amp; m).Value = \"sampleFunction\"\n</code></pre>\n\n<p>Otherwise Excel thinks that they are variables. If they are variables, then try to put parenthesis around your code, it may work better. Like this:</p>\n\n<p><code>If (condition) And (condition) And (condition) then</code></p>\n\n<p>Last case, <code>debug.print</code> each condition before checking it. Like this:\n<code>debug.print Sheets(\"AAA\").Range(\"B\" &amp; m).Value = sampleFunction</code></p>\n"}], "owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 45708048, "answer_count": 1, "score": 0, "last_activity_date": 1518801128, "creation_date": 1502869840, "last_edit_date": 1518801128, "question_id": 45707965, "link": "https://stackoverflow.com/questions/45707965/write-a-string-when-content-of-two-other-cells-matches-a-reference", "title": "Write a string when content of two other cells matches a reference", "body": "<p>I want my macro to check if the content of two cells matches a reference, and when it happens write a certain text into a third cell.</p>\n\n<p>This is the code I wrote</p>\n\n<pre><code>lastRow = Sheets(\"AAA\").Range(\"B1000\").End(xlUp).Row\nIf Sheets(\"AAA\").Range(\"E5\") = \"\" Then\n    id = 1 'identifier\n    For i = 5 To lastRow\n        sampleFunction = Sheets(\"AAA\").Range(\"B\" &amp; i).Value\n        For j = 5 To lastRow\n            sampleFailure = Sheets(\"AAA\").Range(\"C\" &amp; j).Value\n            For m = 5 To lastRow\n                counter = 0\n                For n = 5 To lastRow\n                    If Sheets(\"AAA\").Range(\"B\" &amp; m).Value = sampleFunction And Sheets(\"AAA\").Range(\"C\" &amp; n).Value = sampleFailure And Sheets(\"AAA\").Range(\"J\" &amp; n) = \"\" Then\n                        Sheets(\"AAA\").Range(\"J\" &amp; n) = (\"DDF\" &amp; id)\n                        counter = counter + 1\n                    End If\n                Next n\n                If counter &gt; 0 Then\n                    id = id + 1\n                End If\n            Next m\n        Next j\n    Next i\nEnd If\n</code></pre>\n\n<p>The weird thing is that in some cases I get a correspondence where it is not present, like in the example below for line 5 and 10\n<a href=\"https://i.stack.imgur.com/AbfS5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AbfS5.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have the impression the problem is in</p>\n\n<pre><code>If Sheets(\"AAA\").Range(\"B\" &amp; m).Value = sampleFunction And Sheets(\"AAA\").Range(\"C\" &amp; n).Value = sampleFailure And Sheets(\"AAA\").Range(\"J\" &amp; n) = \"\" Then\n</code></pre>\n\n<p>But I am not able to spot it.</p>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502870922, "post_id": 45707837, "comment_id": 78374475, "body": "how does rnge.Value attain the value of zero?"}, {"owner": {"reputation": 33, "user_id": 8089701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ccf3b069d562a24751728e3f4a89379?s=128&d=identicon&r=PG&f=1", "display_name": "Sky", "link": "https://stackoverflow.com/users/8089701/sky"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502938785, "post_id": 45707837, "comment_id": 78409349, "body": "I&#39;m just guessing here, I&#39;ve tried &quot;&quot;, that doesn&#39;t work either. Basically the code deletes all the data, but then doesn&#39;t end because cell the &#39;ActiveSheet.AutoFilter.Range.Offset(1).SpecialCells(xlCellT&zwnj;&#8203;ypeVisible).Cells(1, 9).Select&#39; selects has no data in it."}, {"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1566425282, "post_id": 45707837, "comment_id": 101656648, "body": "first off you declare<code>rng</code> and then you <code>set rnge</code>  those are different variables and should throw a compile error. Set the <code>Option Explicit</code> statement at the top of your code to avoid misspelling variable, this will save you tons of time."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8089701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ccf3b069d562a24751728e3f4a89379?s=128&d=identicon&r=PG&f=1", "display_name": "Sky", "link": "https://stackoverflow.com/users/8089701/sky"}, "edited": false, "score": 0, "creation_date": 1502938921, "post_id": 45709250, "comment_id": 78409383, "body": "Thanks Shai, however I recieve an run-time error 13, at &#39; If C.Value = 0 Then Exit Sub &#39; if value is 0 exit sub&#39;. I&#39;m still fairly new to vba, therefore not sure how to resolve it."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1502873995, "creation_date": 1502873995, "answer_id": 45709250, "question_id": 45707837, "link": "https://stackoverflow.com/questions/45707837/loop-until-error-424/45709250#45709250", "title": "Loop until error 424", "body": "<p>I think you are after something like the code below, explanations inside the code as comments:</p>\n\n<pre><code>Option Explicit\n\nSub jjjjj()\n\nDim FiltRng As Range\nDim Rng As Range, C As Range\n\n' set the filtered range\nSet FiltRng = ActiveSheet.AutoFilter.Range.Offset(1).SpecialCells(xlCellTypeVisible)\n\n' loop through areas of Filtered range\nFor Each Rng In FiltRng.Areas\n    ' loop through cells in column \"I\" of current area\n    For Each C In Rng.Columns(\"I\")\n        If C.Value = 0 Then Exit Sub ' if value is 0 exit sub\n        C.EntireRow.Delete\n    Next C\nNext Rng\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8089701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ccf3b069d562a24751728e3f4a89379?s=128&d=identicon&r=PG&f=1", "display_name": "Sky", "link": "https://stackoverflow.com/users/8089701/sky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502873995, "creation_date": 1502869462, "last_edit_date": 1531164843, "question_id": 45707837, "link": "https://stackoverflow.com/questions/45707837/loop-until-error-424", "title": "Loop until error 424", "body": "<p>I've been working on this for a couple of hours now, but not able to make it work so far.</p>\n\n<p>I've got some filtered data and I'd like to store the first data cell as a variable to use in loop. However once my loop has deleted all the data and it should end itself I receive an 424 error, object required.</p>\n\n<p><strong><em>Code</em></strong></p>\n\n<pre><code>Sub jjjjj()\n\nDim rng As Range\n\nActiveSheet.AutoFilter.Range.Offset(1).SpecialCells(xlCellTypeVisible).Cells(1, 9).Select\n\nSet rnge = Selection\n\nDo Until (rnge.value = 0)        \n    Range(\"i1\").Activate\n    Selection.End(xlDown).Select\n    Selection.EntireRow.Delete                \nLoop\n\nEnd Sub\n</code></pre>\n\n<p>Error line is <code>Do Until (rnge = 0)</code></p>\n\n<p>I've tried <code>Do until (rnge.value = \"\")</code></p>\n\n<p>As well as taking out <code>value</code>. </p>\n\n<p>Any help would be much appreciated.</p>\n"}, {"tags": ["string", "excel", "vba"], "comments": [{"owner": {"reputation": 292, "user_id": 6668031, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7d4f22650f00d42eb1daf29badd64729?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/6668031/joseph"}, "edited": false, "score": 0, "creation_date": 1502869512, "post_id": 45707704, "comment_id": 78373598, "body": "I dont mind getting duplicate table names in my output"}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "edited": false, "score": 1, "creation_date": 1502872194, "post_id": 45707704, "comment_id": 78375269, "body": "Could you post what you already have to get the <code>Prop</code> part of each occurence, so others complement that?"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1502883415, "post_id": 45707704, "comment_id": 78382873, "body": "what is the database?  edit question with the name of database vendor, you might find that a clever database expert could point to a database function that can list the tables upon which the stored proc is dependent."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "edited": false, "score": 0, "creation_date": 1508993134, "post_id": 45707704, "comment_id": 80839170, "body": "Joseph, did you find any contribution useful? Please remember giving feedback."}, {"owner": {"reputation": 292, "user_id": 6668031, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7d4f22650f00d42eb1daf29badd64729?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/6668031/joseph"}, "edited": false, "score": 0, "creation_date": 1509371162, "post_id": 45707704, "comment_id": 80979931, "body": "No I didnt actually. There were other complications in my source code, like for example few table names were referred without schema names, so it was difficult to figure them out. I didn&#39;t had the liberty to use any database in build stored procs."}], "answers": [{"tags": [], "owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "is_accepted": false, "score": 0, "last_activity_date": 1502874252, "last_edit_date": 1525816189, "creation_date": 1502873128, "answer_id": 45708960, "question_id": 45707704, "link": "https://stackoverflow.com/questions/45707704/get-all-occurrences-of-a-complex-substring-in-excel-vba/45708960#45708960", "title": "Get all occurrences of a &quot;complex&quot; substring in Excel VBA", "body": "<p>You want to deal with all possible \"environments\" where your target string <code>Prop.TableX</code> may show up, and you provided three sample cases (followed by newline, space, and dot).\nSo you want to:</p>\n\n<ol>\n<li>Split your text into words using multiple delimiters.\nThis is probably the hardest part.\nThere are many options around, each with its pitfall.\nBullet-proof code for this is <a href=\"http://www.cpearson.com/excel/splitondelimiters.aspx\" rel=\"nofollow noreferrer\">provided by the great Chip Pearson</a>.</li>\n<li>Find all occurrences <code>stri</code> of <code>Prop</code>.\nThis has been asked many times. As per your OP, I asume you have this.\nJust in case, you could adapt <a href=\"https://stackoverflow.com/a/35244353/2707864\">this answer</a>.\nSee below</li>\n<li>Keep <code>stri</code> plus the following word <code>strj</code> of each <code>Prop</code>.\nThis is easy.</li>\n<li>Concatenate <code>stri</code> (=<code>Prop</code>), <code>\".\"</code> and <code>strj</code> (=<code>TableX</code>).\nThis is easy.</li>\n</ol>\n\n<p>You could invert the order of items 1 and 2, with minor variations. E.g., splitting each time the remainder of the source string to find the second part of the substring.</p>\n\n<hr>\n\n<p>Code for \u00edtem 2, assuming <code>s</code> contains your source string where to look for <code>Prop</code>.</p>\n\n<pre><code>Dim srch As String\nsrch = \"Prop\"\n\nDim start As Integer, pos As Integer\nstart = 1\nDo\n  pos = InStr(start, s, srch, vbTextCompare)\n  If pos &gt; 0 Then\n    start = pos + 1  'alternatively: start = pos + Len(srch)\n    Debug.Print pos\n    Debug.Print Mid(s, pos, Len(srch))\n  End If\nLoop While pos &gt; 0\n</code></pre>\n"}], "owner": {"reputation": 292, "user_id": 6668031, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7d4f22650f00d42eb1daf29badd64729?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/6668031/joseph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 336, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502874355, "creation_date": 1502869111, "last_edit_date": 1531161705, "question_id": 45707704, "link": "https://stackoverflow.com/questions/45707704/get-all-occurrences-of-a-complex-substring-in-excel-vba", "title": "Get all occurrences of a &quot;complex&quot; substring in Excel VBA", "body": "<p>I have sql stored procedure code in a string variable in Excel VBA, I am trying to get list of all table names used in this stored procedure. So each table starts with a schema name Prop.Table1 , Prop.Table2. \nI am doing a instr and trying to get the occurrence of Prop but how do I get the full name like Prop.Table1 , I cannot just use a mid because the table name would not always be followed by a space (it can be a line feed or space)</p>\n\n<p>Input: </p>\n\n<pre><code>create proc test \nas \nbegin\nselect * from Prop.Table1\njoin Prop.Table2 p\non Prop.Table1.col1=p.col1\nend \n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Prop.Table1\nProp.Table2\n</code></pre>\n\n<p>I don't mind getting duplicate table names in my output.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 765, "user_id": 5135716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEEN9.jpg?s=128&g=1", "display_name": "RealCheeseLord", "link": "https://stackoverflow.com/users/5135716/realcheeselord"}, "edited": false, "score": 2, "creation_date": 1502871030, "post_id": 45707566, "comment_id": 78374547, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/26512995/combine-sheets-in-excel\">Combine sheets in excel</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8471038, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qQS2MN8KXkY/AAAAAAAAAAI/AAAAAAAAARk/wmvK4Jg1drs/photo.jpg?sz=128", "display_name": "wahwah", "link": "https://stackoverflow.com/users/8471038/wahwah"}, "edited": false, "score": 0, "creation_date": 1503042798, "post_id": 45707976, "comment_id": 78459854, "body": "Thanks for ur response, but i am totally fresh to excel vba and this is really hard for me to catch up what u trying to explain. Can u explain it more detail so that i can follow step by step ? thank you so much."}, {"owner": {"reputation": 1, "user_id": 8471038, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qQS2MN8KXkY/AAAAAAAAAAI/AAAAAAAAARk/wmvK4Jg1drs/photo.jpg?sz=128", "display_name": "wahwah", "link": "https://stackoverflow.com/users/8471038/wahwah"}, "edited": false, "score": 0, "creation_date": 1503043462, "post_id": 45707976, "comment_id": 78460203, "body": "It is possible to using python scripts to get the same output?"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 1, "user_id": 8471038, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qQS2MN8KXkY/AAAAAAAAAAI/AAAAAAAAARk/wmvK4Jg1drs/photo.jpg?sz=128", "display_name": "wahwah", "link": "https://stackoverflow.com/users/8471038/wahwah"}, "edited": false, "score": 0, "creation_date": 1503295803, "post_id": 45707976, "comment_id": 78538223, "body": "You can possibly do it with every higher language. I&#39;ve added an example that work the way ive descriped it."}, {"owner": {"reputation": 1, "user_id": 8471038, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qQS2MN8KXkY/AAAAAAAAAAI/AAAAAAAAARk/wmvK4Jg1drs/photo.jpg?sz=128", "display_name": "wahwah", "link": "https://stackoverflow.com/users/8471038/wahwah"}, "edited": false, "score": 0, "creation_date": 1503297161, "post_id": 45707976, "comment_id": 78538812, "body": "It work! thank you so much for this. but some worksheets is duplicated is there any ways to arrange the sheets following the sequences 0000a, 0000b, 0000c and more?"}, {"owner": {"reputation": 1, "user_id": 8471038, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qQS2MN8KXkY/AAAAAAAAAAI/AAAAAAAAARk/wmvK4Jg1drs/photo.jpg?sz=128", "display_name": "wahwah", "link": "https://stackoverflow.com/users/8471038/wahwah"}, "edited": false, "score": 0, "creation_date": 1503297281, "post_id": 45707976, "comment_id": 78538873, "body": "and after copying the data from the worksheet, i would like to  delete the previous sheet where the data is from. Really thank you so much for help!"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 1, "user_id": 8471038, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qQS2MN8KXkY/AAAAAAAAAAI/AAAAAAAAARk/wmvK4Jg1drs/photo.jpg?sz=128", "display_name": "wahwah", "link": "https://stackoverflow.com/users/8471038/wahwah"}, "edited": false, "score": 0, "creation_date": 1503299131, "post_id": 45707976, "comment_id": 78539805, "body": "it will delete the old ones now. It only gets duplicated if you run it more than once, when the old ws still exist, that should be fixed now. You can arrange the content when you modify the copy paste statement. atm it will paste the contents below each other."}, {"owner": {"reputation": 1, "user_id": 8471038, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qQS2MN8KXkY/AAAAAAAAAAI/AAAAAAAAARk/wmvK4Jg1drs/photo.jpg?sz=128", "display_name": "wahwah", "link": "https://stackoverflow.com/users/8471038/wahwah"}, "edited": false, "score": 0, "creation_date": 1503303543, "post_id": 45707976, "comment_id": 78542233, "body": "i face an error which is For control variable already in use. When i execute this"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 1, "user_id": 8471038, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qQS2MN8KXkY/AAAAAAAAAAI/AAAAAAAAARk/wmvK4Jg1drs/photo.jpg?sz=128", "display_name": "wahwah", "link": "https://stackoverflow.com/users/8471038/wahwah"}, "edited": false, "score": 0, "creation_date": 1503304425, "post_id": 45707976, "comment_id": 78542732, "body": "Then it interferes with another sub in your code. rename the variable thats already used."}, {"owner": {"reputation": 1, "user_id": 8471038, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qQS2MN8KXkY/AAAAAAAAAAI/AAAAAAAAARk/wmvK4Jg1drs/photo.jpg?sz=128", "display_name": "wahwah", "link": "https://stackoverflow.com/users/8471038/wahwah"}, "edited": false, "score": 0, "creation_date": 1503307412, "post_id": 45707976, "comment_id": 78544631, "body": "It did combine the data but it also delete the ws created with combined data. I think i did not explain my question well."}, {"owner": {"reputation": 1, "user_id": 8471038, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qQS2MN8KXkY/AAAAAAAAAAI/AAAAAAAAARk/wmvK4Jg1drs/photo.jpg?sz=128", "display_name": "wahwah", "link": "https://stackoverflow.com/users/8471038/wahwah"}, "edited": false, "score": 0, "creation_date": 1503307537, "post_id": 45707976, "comment_id": 78544712, "body": "For example, what i have now is in this format <a href=\"https://docs.google.com/spreadsheets/u/1/d/1h5_FO7MEwqMY8P5qVlTvKbtEiPk6mAUTJYtFVJ4g2jc/pubhtml\" rel=\"nofollow noreferrer\">docs.google.com/spreadsheets/u/1/d/&hellip;</a>        and i want it to become  <a href=\"https://docs.google.com/spreadsheets/u/1/d/1ZxkA9oQiHc-axoEzYIvVHwbQ5hlhjcHy5qrWoRiNVWc/pubhtml#\" rel=\"nofollow noreferrer\">docs.google.com/spreadsheets/u/1/d/&hellip;</a>  this"}], "tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": false, "score": 1, "last_activity_date": 1503304229, "last_edit_date": 1503304229, "creation_date": 1502869863, "answer_id": 45707976, "question_id": 45707566, "link": "https://stackoverflow.com/questions/45707566/combine-spreadsheets-in-excel-according-to-name/45707976#45707976", "title": "Combine spreadsheets in excel according to name", "body": "<p>Get name with <a href=\"https://msdn.microsoft.com/de-de/library/office/ff196974.aspx\" rel=\"nofollow noreferrer\"><code>Worksheet.Name</code></a>, i.e:</p>\n\n<pre><code>Dim ws as Worksheet\nFor Each ws in Worksheets\n MsgBox Left(ws.Name, 4)\nNext ws\n</code></pre>\n\n<p>With <a href=\"https://msdn.microsoft.com/en-ie/library/y050k1wb(v=vs.90).aspx\" rel=\"nofollow noreferrer\"><code>Left</code></a> you can extract the first 4 letters. If you store them in an <code>array</code> you can use <a href=\"https://msdn.microsoft.com/VBA/Excel-VBA/articles/worksheetfunction-match-method-excel\" rel=\"nofollow noreferrer\"><code>Application.Match</code></a>-Function to match the values in the <code>array</code>. With the index you get back you can refer to the <code>Worksheets(index)</code>.</p>\n\n<p>EDIT: </p>\n\n<pre><code>Sub ad()\nDim ws As Worksheet\nDim lc As Range, lc1 As Range\nDim arr() As String, index As Long, Count As Long\n\nCount = Worksheets.Count\nReDim arr(1 To Count) 'Array to store worksheetsnames\n\nFor i = 1 To Count\n arr(i) = Left(Worksheets(i).Name, 4) 'cut 4 letters and store in array\nNext\n\nOn Error Resume Next\n\nFor i = Count To 2 Step -1\n sval = arr(i) 'search value\n ReDim Preserve arr(1 To i - 1) 'downsize array\n index = Application.Match(sval, arr(), 0) 'find matching name in array\n\n    With Worksheets(index) 'lrow on ws to paste\n        Set lc = .Cells.Find(what:=Chr(42), after:=.Cells(1), searchdirection:=xlPrevious, _\n                         lookat:=xlPart, searchorder:=xlByRows, LookIn:=xlFormulas)\n    End With\n    With Worksheets(i) 'lrow on ws to copy\n        Set lc1 = .Cells.Find(what:=Chr(42), after:=.Cells(1), searchdirection:=xlPrevious, _\n                         lookat:=xlPart, searchorder:=xlByRows, LookIn:=xlFormulas)\n    End With\n\n    Worksheets(i).Range(\"A1:\" &amp; lc1.Address).Copy Worksheets(index).Range(\"A\" &amp; lc.Row + 1) 'copy paste\n    Worksheets(index).Name = sval 'rename to first 4 letters\n    Application.DisplayAlerts = False\n    Worksheets(i).Delete\n    Application.DisplayAlerts = True\nNext i\nEnd Sub \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8471038, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qQS2MN8KXkY/AAAAAAAAAAI/AAAAAAAAARk/wmvK4Jg1drs/photo.jpg?sz=128", "display_name": "wahwah", "link": "https://stackoverflow.com/users/8471038/wahwah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1503304229, "creation_date": 1502868690, "last_edit_date": 1531161705, "question_id": 45707566, "link": "https://stackoverflow.com/questions/45707566/combine-spreadsheets-in-excel-according-to-name", "title": "Combine spreadsheets in excel according to name", "body": "<p>i need a script to automate combine the multiple excel spreadsheets from same workbook into one spreadsheet according to the name of the spreadsheets. However, the name of the spreadsheets is in different names. for example: 0000a ,0000b,0000c.... How do i compare the first four numbers of the names and if similar, combine them into one spreadsheet with the name 0000? thanks in advance for help</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 82, "user_id": 8470984, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bdaf6144b39d501104f1ccb5bbdccb8f?s=128&d=identicon&r=PG&f=1", "display_name": "Fong", "link": "https://stackoverflow.com/users/8470984/fong"}, "edited": false, "score": 0, "creation_date": 1502929178, "post_id": 45708024, "comment_id": 78407287, "body": "Thank you very much @Craig Foster for the answer.. I&#39;m still a beginner in vba as I&#39;ve never learned how to code or program, but was asked to come up with one.."}, {"owner": {"reputation": 82, "user_id": 8470984, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bdaf6144b39d501104f1ccb5bbdccb8f?s=128&d=identicon&r=PG&f=1", "display_name": "Fong", "link": "https://stackoverflow.com/users/8470984/fong"}, "edited": false, "score": 0, "creation_date": 1502936103, "post_id": 45708024, "comment_id": 78408776, "body": "is it possible that someone explain to me what does this line means? /// Worksheets(1).Cells(1, c + ((i - 1) * 5)) = Worksheets(i).Name /// i understand that Worksheets(1) means the first worksheet but i cant quite grasp the concept for the cells part"}], "tags": [], "owner": {"reputation": 109, "user_id": 5999637, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4uRJ1IECN6A/AAAAAAAAAAI/AAAAAAAAAXQ/2wqZBqQIckg/photo.jpg?sz=128", "display_name": "Craig Foster", "link": "https://stackoverflow.com/users/5999637/craig-foster"}, "is_accepted": false, "score": 1, "last_activity_date": 1502870020, "creation_date": 1502870020, "answer_id": 45708024, "question_id": 45707484, "link": "https://stackoverflow.com/questions/45707484/how-can-i-insert-different-worksheet-names-into-different-cells-horizontally-wit/45708024#45708024", "title": "How can i insert different worksheet names into different cells horizontally with excel vba", "body": "<p>Modified an example found elsewhere. its a bit crude but should do what your asking.</p>\n\n<pre><code>Sub Worksheets()\n     Dim i As Integer\n\n    For i = 1 To Worksheets.Count\n    For c = 1 To 5\n        Worksheets(1).Cells(1, c + ((i - 1) * 5)) = Worksheets(i).Name\n    Next c\n    Next i    End Sub\n</code></pre>\n"}], "owner": {"reputation": 82, "user_id": 8470984, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bdaf6144b39d501104f1ccb5bbdccb8f?s=128&d=identicon&r=PG&f=1", "display_name": "Fong", "link": "https://stackoverflow.com/users/8470984/fong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1502910041, "creation_date": 1502868467, "last_edit_date": 1502910041, "question_id": 45707484, "link": "https://stackoverflow.com/questions/45707484/how-can-i-insert-different-worksheet-names-into-different-cells-horizontally-wit", "title": "How can i insert different worksheet names into different cells horizontally with excel vba", "body": "<p>I've searched many times but it can't seem to find one that actually solves my question. So I have a lot of data in multiple worksheets, and they're named differently ( usually date ). I need to make all the worksheet names copied into a horizontal table but there's a catch to it. For each worksheet name I will have at least copy 5 times (in columns) before moving on to the next worksheet name. For example:</p>\n\n<p><em>a a a a a b b b b b c c c c c d d d d d</em></p>\n\n<p><em>a,b,c,d</em> are examples of the worksheet names</p>\n"}, {"tags": ["vba", "range", "excel-2013"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8470729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63db42eb80c12ea7f4d3738ad369a5d1?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/8470729/dylan"}, "edited": false, "score": 0, "creation_date": 1502971126, "post_id": 45706995, "comment_id": 78426618, "body": "My c variable is a global variable, I have it working a similar purpose in another class. However I see that I had included LastRow not knowing that it wasn&#39;t a function of VBA. Also, as I understand it, &quot;J3:J&quot; refers to entire column of J with no restrictions on length right? Anyways, adding &quot;ThisWorkbook.&quot; and removing &quot;LastRow&quot; still gives me the error. Thanks again for the time you&#39;re giving to this"}, {"owner": {"reputation": 1, "user_id": 8470729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63db42eb80c12ea7f4d3738ad369a5d1?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/8470729/dylan"}, "edited": false, "score": 0, "creation_date": 1503410749, "post_id": 45706995, "comment_id": 78597300, "body": "I found my problem, VBA doesn&#39;t work with unlimited length, I needed to included a limit. Thanks for the help, i got it working."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1502867411, "last_edit_date": 1502867411, "creation_date": 1502866725, "answer_id": 45706995, "question_id": 45706761, "link": "https://stackoverflow.com/questions/45706761/why-does-my-range-function-return-a-1004-runtime-error/45706995#45706995", "title": "Why does my .Range function return a 1004 runtime error", "body": "<ul>\n<li>You don't qualify the context of <code>Worksheets(\"Sheet1\")</code>. It has to be \"somewhere\", i.e. in the context of a workbook, for example <code>ThisWorkbook.Worksheets(\"Sheet1\")</code>.</li>\n<li>You never initiate the variable <code>c</code>. Bad practice.</li>\n<li>You also never initialize the variable <code>LastRow</code>. Again, bad practice.</li>\n</ul>\n\n<p>When the macro starts, what value do you THINK these two variables should have? How should Excel <strong>know</strong> what you THINK if you don't tell it?</p>\n\n<p>Dim the variable and assign it an initial value.</p>\n\n<p>Always <code>Dim</code> your variables. Also, in order to avoid stuff-ups like this, use <code>Option Explicit</code> as the first line in any module. That will sanity-check code and point out errors before it compiles. It will enforce the good habit to declare all variables before they are being used and will pick up a lot of other stuff</p>\n\n<p><a href=\"https://i.stack.imgur.com/kHLMA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kHLMA.png\" alt=\"enter image description here\"></a></p>\n\n<p>Compare to </p>\n\n<pre><code>Option Explicit\n\nSub stuff()\nDim c As Long, LastRow As Long\nc = 1\nLastRow = 20 ' or use code to work out the last row\n\nThisWorkbook.Worksheets(\"Sheet1\").Range(\"J3:J\" &amp; LastRow).Formula = \"=J2+G2\"\nThisWorkbook.Worksheets(\"Sheet1\").Range(\"K3:K\" &amp; LastRow).Formula = \"=K2+H2\"\n\nDo While Worksheets(\"Sheet1\").Range(\"J\" &amp; c).Value &lt;&gt; \"\"\n    c = c + 1\nLoop\n\nMsgBox c\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8470729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63db42eb80c12ea7f4d3738ad369a5d1?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/8470729/dylan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502867411, "creation_date": 1502866045, "question_id": 45706761, "link": "https://stackoverflow.com/questions/45706761/why-does-my-range-function-return-a-1004-runtime-error", "title": "Why does my .Range function return a 1004 runtime error", "body": "<p>I'm writing a code as basically a proof of concept so that I can accurately use in my code after I finish seeing how it operates. However, though try as I might, despite all my online searches, I can't seem to identify why my code returns a 1004 error nor do I know how to fix it. Any help would be appreciated.</p>\n\n<pre><code>Worksheets(\"Sheet1\").Range(\"J3:J\" &amp; LastRow).Formula = \"=J2+G2\"\nWorksheets(\"Sheet1\").Range(\"K3:K\" &amp; LastRow).Formula = \"=K2+H2\"\n\nDo While Worksheets(\"Sheet1\").Range(\"J\" &amp; c).Value &lt;&gt; \"\"\n    c = c + 1\nLoop\n\nMsgBox c\n</code></pre>\n\n<p>The problem seems to be at the call of the Range function itself, as everything works fine when I remove said problem.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1502861487, "post_id": 45705684, "comment_id": 78369476, "body": "Your worksheet is named <code>&quot;1&quot;</code>? Or you are trying to refer to the first one <code>1</code>?"}, {"owner": {"reputation": 225, "user_id": 4025169, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nVb00.jpg?s=128&g=1", "display_name": "Jem Eripol", "link": "https://stackoverflow.com/users/4025169/jem-eripol"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1502861572, "post_id": 45705684, "comment_id": 78369512, "body": "@PatricK, i am referring to my Worksheet Name which is &quot;1&quot;."}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1502865560, "post_id": 45705684, "comment_id": 78371192, "body": "To mark question as answered, just click that &quot;tick&quot; on the left side of the answer that was helpful to you. <a href=\"https://stackoverflow.com/help/accepted-answer\">Help file.</a>"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502869405, "post_id": 45705684, "comment_id": 78373524, "body": "what is the error that you are getting?"}], "answers": [{"comments": [{"owner": {"reputation": 225, "user_id": 4025169, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nVb00.jpg?s=128&g=1", "display_name": "Jem Eripol", "link": "https://stackoverflow.com/users/4025169/jem-eripol"}, "edited": false, "score": 0, "creation_date": 1502863276, "post_id": 45705942, "comment_id": 78370172, "body": "thank you for this. I checked my conditions and i dont have problem regarding items 1 to 3. I only have one worksheet in source file and it is named &quot;1&quot;. I don&#39;t understand item 4 though, sorry. Can you please elaborate this?  I will try your suggestion of having <code>sh = ws.worksheets(&quot;1)</code> and I will give you feedback."}, {"owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "reply_to_user": {"reputation": 225, "user_id": 4025169, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nVb00.jpg?s=128&g=1", "display_name": "Jem Eripol", "link": "https://stackoverflow.com/users/4025169/jem-eripol"}, "edited": false, "score": 0, "creation_date": 1502863461, "post_id": 45705942, "comment_id": 78370246, "body": "Item 4 is based upon your line of code which begins: iRow = ws.Cells.Find(What:=&quot;*&quot;,... if a * is not found then iRow will be undefined"}, {"owner": {"reputation": 225, "user_id": 4025169, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nVb00.jpg?s=128&g=1", "display_name": "Jem Eripol", "link": "https://stackoverflow.com/users/4025169/jem-eripol"}, "edited": false, "score": 0, "creation_date": 1502864217, "post_id": 45705942, "comment_id": 78370558, "body": "I see my error now Sir @Tony M. my iRow will be undefined because I am copying my data on column 4 (column D) instead of Column 1 (column D), therefore, it returns error sometimes. There goes my error. I tried putting any input in first column, and the error is not repeating. I hope I can upvote but I cannot do much but say thank you. ;)"}, {"owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "reply_to_user": {"reputation": 225, "user_id": 4025169, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nVb00.jpg?s=128&g=1", "display_name": "Jem Eripol", "link": "https://stackoverflow.com/users/4025169/jem-eripol"}, "edited": false, "score": 0, "creation_date": 1502864403, "post_id": 45705942, "comment_id": 78370640, "body": "It&#39;s helpful if you can mark your question as answered, if you feel it has been answered"}, {"owner": {"reputation": 225, "user_id": 4025169, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nVb00.jpg?s=128&g=1", "display_name": "Jem Eripol", "link": "https://stackoverflow.com/users/4025169/jem-eripol"}, "edited": false, "score": 0, "creation_date": 1502864651, "post_id": 45705942, "comment_id": 78370735, "body": "Noted sir, Thank you."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502870728, "post_id": 45705942, "comment_id": 78374351, "body": "@TonyM, the <b>&quot;*&quot;</b> is a search wildcard . the search fails on an empty worksheet.  it makes no sense that it fails on line 15. it should be failing at the search line. the only way line 15 will fail, is if the search finds something on the last line of the worksheet, then iRow would be last worksheet line +1, which is a fail"}], "tags": [], "owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1502862632, "creation_date": 1502862632, "answer_id": 45705942, "question_id": 45705684, "link": "https://stackoverflow.com/questions/45705684/vba-code-returns-error-sometimes-and-sometimes-not/45705942#45705942", "title": "VBA Code returns error sometimes, and sometimes not", "body": "<p>There are many conditions required to avoid the error at the line you mention:</p>\n\n<pre><code>1) there must be a file with the name specified for `wbSource`\n2) that file must open with an activeSheet named `1`\n3) the program workbook (`ws`) must also have a worksheet named `1`\n4) there must be a `*` on the activeSheet of the `ws` workbook\n</code></pre>\n\n<p>Notice that there are 2 cases depending on an activeSheet.  To avoid this, I suggest making a variable for each of the sheets you reference (e.g., <code>set sh = ws.worksheets(\"1\")</code>) so that you don't depend on that sheet being active or not.  In my experience, that is often the problem, but the other mentioned conditions above could also be the problem.</p>\n"}], "owner": {"reputation": 225, "user_id": 4025169, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nVb00.jpg?s=128&g=1", "display_name": "Jem Eripol", "link": "https://stackoverflow.com/users/4025169/jem-eripol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "accepted_answer_id": 45705942, "answer_count": 1, "score": 0, "last_activity_date": 1502866728, "creation_date": 1502861201, "last_edit_date": 1502866728, "question_id": 45705684, "link": "https://stackoverflow.com/questions/45705684/vba-code-returns-error-sometimes-and-sometimes-not", "title": "VBA Code returns error sometimes, and sometimes not", "body": "<p>I have written the code below but I cannot seem to detect what is wrong with it. The program is set to transfer data from workbook:</p>\n\n<blockquote>\n  <p>SRJem.xlsx</p>\n</blockquote>\n\n<p>to the active workbook where the code below is written. Now, I have both workbooks open at the same time (and i don't want to close them while doing the operation). The thing is, the code is successful at some time, while it returns a bug error in line 15 in some times. I tried saving both before operation but it still happens.</p>\n\n<p>Line 15:</p>\n\n<blockquote>\n  <p>ws.Cells(iRow, 4).Value = wbSource.Sheets(\"1\").Cells(14, 1).Value</p>\n</blockquote>\n\n<p>I need some light explanation regarding the error I have. Thank you so much.</p>\n\n<pre><code>Sub transfer_to_masterfile()\n\n'find first empty row in database\nDim iRow As Long\nDim ws As Worksheet\nSet ws = Worksheets(\"1\")\nDim wbSource As Workbook\n\niRow = ws.Cells.Find(What:=\"*\", SearchOrder:=xlRows, _\nSearchDirection:=xlPrevious, LookIn:=xlValues).row + 1\n\nSet wbSource = Workbooks.Open(\"C:\\Users\\fed.staff01\\Desktop\\J.G.E - QS\\6. EXCEL PROGRAMS\\SRJem.xlsx\") ' &lt;&lt;&lt; path to source workbook\n\n'Now, transfer values from wbSource to wbTarget:\nws.Cells(iRow, 4).Value = wbSource.Sheets(\"1\").Cells(14, 1).Value\nws.Cells(iRow, 5).Value = wbSource.Sheets(\"1\").Cells(6, 4).Value\n\nDim mats As String\nDim row As Integer\n\nrow = 23\n\nDo\n    mats = mats &amp; \"  \" &amp; wbSource.Sheets(\"1\").Cells(row, 1).Value &amp; \"  \" &amp; wbSource.Sheets(\"1\").Cells(row, 3).Value &amp; _\n    \"             \" &amp; wbSource.Sheets(\"1\").Cells(row, 5).Value\n\n    If wbSource.Sheets(\"1\").Cells(row + 1, 1).Value &gt; 0 Then\n        mats = mats &amp; vbNewLine\n    End If\n\n    If wbSource.Sheets(\"1\").Cells(row + 1, 1).Value = \"\" Then\n        Exit Do\n    End If\n\n    row = row + 1\n\nLoop Until row = 42\n\nws.Cells(iRow, 7).Value = mats\n'ws.Cells(iRow, 5).Value = wbSource.Sheets(\"1\").Cells(6, 4).Value\n\n'wbSource.Close\n'wbTarget.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "range", "vba"], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 6526319, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-zsGRSRaPwtc/AAAAAAAAAAI/AAAAAAAAABQ/dz39zga2eIc/photo.jpg?sz=128", "display_name": "Luu nguyen", "link": "https://stackoverflow.com/users/6526319/luu-nguyen"}, "edited": false, "score": 0, "creation_date": 1502858021, "post_id": 45705100, "comment_id": 78368405, "body": "@M Idrees @YowE3K You said that multiple selection Copy will not work but why this code run <code>sh.Range(&quot;A3:AG1000, AL3:EJ1000&quot;).Select</code> <code>Selection.Copy</code>. I believe that we can find the way to select all"}, {"owner": {"reputation": 1822, "user_id": 624292, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4fd8cadbf9c2cf573b13c7f53fc5fd43?s=128&d=identicon&r=PG", "display_name": "M_Idrees", "link": "https://stackoverflow.com/users/624292/m-idrees"}, "reply_to_user": {"reputation": 115, "user_id": 6526319, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-zsGRSRaPwtc/AAAAAAAAAAI/AAAAAAAAABQ/dz39zga2eIc/photo.jpg?sz=128", "display_name": "Luu nguyen", "link": "https://stackoverflow.com/users/6526319/luu-nguyen"}, "edited": false, "score": 0, "creation_date": 1502858402, "post_id": 45705100, "comment_id": 78368537, "body": "It can work on limited cases, like if you have consecutive rows selection used. If there are two different ranges on different locations on the sheet. It will give you error <i>That command cannot be used on multiple selections.</i>"}, {"owner": {"reputation": 115, "user_id": 6526319, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-zsGRSRaPwtc/AAAAAAAAAAI/AAAAAAAAABQ/dz39zga2eIc/photo.jpg?sz=128", "display_name": "Luu nguyen", "link": "https://stackoverflow.com/users/6526319/luu-nguyen"}, "edited": false, "score": 0, "creation_date": 1502858780, "post_id": 45705100, "comment_id": 78368664, "body": "No. <code>iLastrow</code> will be the limited cases"}], "tags": [], "owner": {"reputation": 1822, "user_id": 624292, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4fd8cadbf9c2cf573b13c7f53fc5fd43?s=128&d=identicon&r=PG", "display_name": "M_Idrees", "link": "https://stackoverflow.com/users/624292/m-idrees"}, "is_accepted": false, "score": 1, "last_activity_date": 1502857799, "last_edit_date": 1502857799, "creation_date": 1502857463, "answer_id": 45705100, "question_id": 45705044, "link": "https://stackoverflow.com/questions/45705044/select-and-copy-multiple-ranges-with-vba/45705100#45705100", "title": "Select and Copy multiple ranges with VBA", "body": "<p>Change Range params from this:</p>\n\n<pre><code>iLastRow = Sh.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nsh.Range(\"A3:AG1000, AL3:EJ1000\").Select\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>iLastRow = Sh.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nsh.Range(\"A3:AG\" &amp; iLastrow &amp;\", AL3:EJ\" &amp; iLastRow).Select\n</code></pre>\n\n<p>Since with multiple selection <code>Copy</code> will not work. You may need to call it twice in your case. (as per suggestion by @YowE3K)</p>\n\n<pre><code>sh.Range(\"A3:AG\" &amp; iLastrow).Select\nSelection.Copy\n\nsh.Range(\"AL3:EJ\" &amp; iLastrow).Select\nSelection.Copy\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 118, "user_id": 8409510, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Zi1fnb3f03s/AAAAAAAAAAI/AAAAAAAABNM/G8cGaSte3Fc/photo.jpg?sz=128", "display_name": "Duc Anh Nguyen", "link": "https://stackoverflow.com/users/8409510/duc-anh-nguyen"}, "edited": false, "score": 0, "creation_date": 1502863059, "post_id": 45705534, "comment_id": 78370101, "body": "The answer with method &quot;Union&quot; should be the right solution for this problem."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 118, "user_id": 8409510, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Zi1fnb3f03s/AAAAAAAAAAI/AAAAAAAABNM/G8cGaSte3Fc/photo.jpg?sz=128", "display_name": "Duc Anh Nguyen", "link": "https://stackoverflow.com/users/8409510/duc-anh-nguyen"}, "edited": false, "score": 0, "creation_date": 1502863409, "post_id": 45705534, "comment_id": 78370220, "body": "@DucAnhNguyen  in your post you mention range in he same sheet. It doesn&#39;t work on multiple ranges from different sheets."}, {"owner": {"reputation": 115, "user_id": 6526319, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-zsGRSRaPwtc/AAAAAAAAAAI/AAAAAAAAABQ/dz39zga2eIc/photo.jpg?sz=128", "display_name": "Luu nguyen", "link": "https://stackoverflow.com/users/6526319/luu-nguyen"}, "edited": false, "score": 0, "creation_date": 1502863572, "post_id": 45705534, "comment_id": 78370288, "body": "@Shai Rado Your code &#39;s not run.  I have to import from multiple excel file to one file with the existed field. May be I can copy in twice, but I want to try this way"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 115, "user_id": 6526319, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-zsGRSRaPwtc/AAAAAAAAAAI/AAAAAAAAABQ/dz39zga2eIc/photo.jpg?sz=128", "display_name": "Luu nguyen", "link": "https://stackoverflow.com/users/6526319/luu-nguyen"}, "edited": false, "score": 0, "creation_date": 1502863751, "post_id": 45705534, "comment_id": 78370363, "body": "@Luunguyen  read your post, you asked for 2 ranges in the same Worksheet, now you changed the scope entirely. It&#39;s hard to guess your needs if you post something , right ?"}, {"owner": {"reputation": 115, "user_id": 6526319, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-zsGRSRaPwtc/AAAAAAAAAAI/AAAAAAAAABQ/dz39zga2eIc/photo.jpg?sz=128", "display_name": "Luu nguyen", "link": "https://stackoverflow.com/users/6526319/luu-nguyen"}, "edited": false, "score": 0, "creation_date": 1502863970, "post_id": 45705534, "comment_id": 78370449, "body": "No. Still 2 ranges in the same worksheet. You can see my main code below"}, {"owner": {"reputation": 118, "user_id": 8409510, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Zi1fnb3f03s/AAAAAAAAAAI/AAAAAAAABNM/G8cGaSte3Fc/photo.jpg?sz=128", "display_name": "Duc Anh Nguyen", "link": "https://stackoverflow.com/users/8409510/duc-anh-nguyen"}, "edited": false, "score": 1, "creation_date": 1502864891, "post_id": 45705534, "comment_id": 78370846, "body": "try move &quot;End with&quot; of &quot;with sh&quot; right after copy method ( before &quot;with master&quot;) . Also normally, the dimension of copy and paste should be the same. I don&#39;t see any effort to select the same target dimension here. I think that what @ShaiRado mention &quot;Another question is how you want to paste the merged reanges that have a gap in the middle.&quot;"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 7, "last_activity_date": 1502860412, "creation_date": 1502860412, "answer_id": 45705534, "question_id": 45705044, "link": "https://stackoverflow.com/questions/45705044/select-and-copy-multiple-ranges-with-vba/45705534#45705534", "title": "Select and Copy multiple ranges with VBA", "body": "<p>Try the code below, explanation inside the code as comments:</p>\n\n<pre><code>Option Explicit\n\nSub CopyMultipleRanges()\n\nDim iLastRow As Long\nDim sh As Worksheet\nDim MultiRng As Range\n\nSet sh = ThisWorkbook.Worksheets(\"Sheet1\") ' &lt;-- change to your sheet's name\nWith sh\n    iLastRow = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n\n    ' use the union to set a range combined from multiple ranges\n    Set MultiRng = Union(.Range(\"A3:A\" &amp; iLastRow), .Range(\"AL3:EJ\" &amp; iLastRow))\nEnd With\n\n' copy the range, there's no need to select it first\nMultiRng.Copy\n\nEnd Sub\n</code></pre>\n\n<p>Another question is how you want to paste the merged reanges that have a gap in the middle.</p>\n"}, {"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1502864772, "post_id": 45706279, "comment_id": 78370796, "body": "You have not copied my code to yours, you have made some modifications which lead to this error. See how I found the <code>iLastRow</code>."}, {"owner": {"reputation": 118, "user_id": 8409510, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Zi1fnb3f03s/AAAAAAAAAAI/AAAAAAAABNM/G8cGaSte3Fc/photo.jpg?sz=128", "display_name": "Duc Anh Nguyen", "link": "https://stackoverflow.com/users/8409510/duc-anh-nguyen"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1502864952, "post_id": 45706279, "comment_id": 78370876, "body": "try move &quot;End with&quot; of &quot;with sh&quot; right after copy method ( before &quot;with master&quot;) in YOUR code. Also normally, the dimension of copy and paste should be the same. I don&#39;t see any effort to select the same target dimension here. I think that what @ShaiRado mention &quot;Another question is how you want to paste the merged reanges that have a gap in the middle.&quot;"}, {"owner": {"reputation": 115, "user_id": 6526319, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-zsGRSRaPwtc/AAAAAAAAAAI/AAAAAAAAABQ/dz39zga2eIc/photo.jpg?sz=128", "display_name": "Luu nguyen", "link": "https://stackoverflow.com/users/6526319/luu-nguyen"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1502865010, "post_id": 45706279, "comment_id": 78370903, "body": "@Shai Rado I copy your code, but my code use <code>iLastRowReport</code>, so I change <code>iLastRow</code> to <code>iLastRowReport</code>. It can&#39;t be lead to this error"}, {"owner": {"reputation": 115, "user_id": 6526319, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-zsGRSRaPwtc/AAAAAAAAAAI/AAAAAAAAABQ/dz39zga2eIc/photo.jpg?sz=128", "display_name": "Luu nguyen", "link": "https://stackoverflow.com/users/6526319/luu-nguyen"}, "edited": false, "score": 0, "creation_date": 1502865481, "post_id": 45706279, "comment_id": 78371155, "body": "It&#39;s useless you know. Because of error in <code>Set MultiRng = Union(.Range(&quot;A3:EF&quot; &amp; iLastRowReport), .Range(&quot;AL:EJ&quot; &amp; iLastRowReport))</code>"}, {"owner": {"reputation": 118, "user_id": 8409510, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Zi1fnb3f03s/AAAAAAAAAAI/AAAAAAAABNM/G8cGaSte3Fc/photo.jpg?sz=128", "display_name": "Duc Anh Nguyen", "link": "https://stackoverflow.com/users/8409510/duc-anh-nguyen"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1502866065, "post_id": 45706279, "comment_id": 78371484, "body": "As mention in my post, you should have the same row for both range. In short, copy exactly @ShaiRado code which is &quot;Set MultiRng = Union(.Range(&quot;A3:A&quot; &amp; iLastRow), .Range(&quot;AL3:EJ&quot; &amp; iLastRow))&quot;"}, {"owner": {"reputation": 115, "user_id": 6526319, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-zsGRSRaPwtc/AAAAAAAAAAI/AAAAAAAAABQ/dz39zga2eIc/photo.jpg?sz=128", "display_name": "Luu nguyen", "link": "https://stackoverflow.com/users/6526319/luu-nguyen"}, "edited": false, "score": 0, "creation_date": 1502866385, "post_id": 45706279, "comment_id": 78371667, "body": "@ Duc Anh Nguyen, of course it&#39;s the same row for both range. Did you understand the problem?"}, {"owner": {"reputation": 118, "user_id": 8409510, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Zi1fnb3f03s/AAAAAAAAAAI/AAAAAAAABNM/G8cGaSte3Fc/photo.jpg?sz=128", "display_name": "Duc Anh Nguyen", "link": "https://stackoverflow.com/users/8409510/duc-anh-nguyen"}, "edited": false, "score": 1, "creation_date": 1502866507, "post_id": 45706279, "comment_id": 78371748, "body": "A3:EF : from row 3 to last cell (1048576) ;  AL:EJ : from row 1 to last cell (1048576) so there is a different."}, {"owner": {"reputation": 118, "user_id": 8409510, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Zi1fnb3f03s/AAAAAAAAAAI/AAAAAAAABNM/G8cGaSte3Fc/photo.jpg?sz=128", "display_name": "Duc Anh Nguyen", "link": "https://stackoverflow.com/users/8409510/duc-anh-nguyen"}, "edited": false, "score": 0, "creation_date": 1502867343, "post_id": 45706279, "comment_id": 78372219, "body": "@Luunguyen. pls check that iLastRowReport gave an number &gt;=3. smt like this &quot; if iLastRowReport &gt;3 then ..... else Debug.print &quot;wrong&quot; &amp; iLastRowReport end if"}, {"owner": {"reputation": 115, "user_id": 6526319, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-zsGRSRaPwtc/AAAAAAAAAAI/AAAAAAAAABQ/dz39zga2eIc/photo.jpg?sz=128", "display_name": "Luu nguyen", "link": "https://stackoverflow.com/users/6526319/luu-nguyen"}, "reply_to_user": {"reputation": 118, "user_id": 8409510, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Zi1fnb3f03s/AAAAAAAAAAI/AAAAAAAABNM/G8cGaSte3Fc/photo.jpg?sz=128", "display_name": "Duc Anh Nguyen", "link": "https://stackoverflow.com/users/8409510/duc-anh-nguyen"}, "edited": false, "score": 0, "creation_date": 1502867379, "post_id": 45706279, "comment_id": 78372245, "body": "@Duc Anh Nguyen It&#39;s always error in <code>MultiRng = Union(.Range(&quot;A3:AG&quot; &amp; iLastRowReport), .Range(&quot;AL3:EJ&quot; &amp; iLastRowReport))</code>"}, {"owner": {"reputation": 115, "user_id": 6526319, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-zsGRSRaPwtc/AAAAAAAAAAI/AAAAAAAAABQ/dz39zga2eIc/photo.jpg?sz=128", "display_name": "Luu nguyen", "link": "https://stackoverflow.com/users/6526319/luu-nguyen"}, "reply_to_user": {"reputation": 118, "user_id": 8409510, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Zi1fnb3f03s/AAAAAAAAAAI/AAAAAAAABNM/G8cGaSte3Fc/photo.jpg?sz=128", "display_name": "Duc Anh Nguyen", "link": "https://stackoverflow.com/users/8409510/duc-anh-nguyen"}, "edited": false, "score": 0, "creation_date": 1502868337, "post_id": 45706279, "comment_id": 78372862, "body": "@Duc Anh Nguyen Thank you so much. My code have run."}], "tags": [], "owner": {"reputation": 115, "user_id": 6526319, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-zsGRSRaPwtc/AAAAAAAAAAI/AAAAAAAAABQ/dz39zga2eIc/photo.jpg?sz=128", "display_name": "Luu nguyen", "link": "https://stackoverflow.com/users/6526319/luu-nguyen"}, "is_accepted": false, "score": 0, "last_activity_date": 1502866788, "last_edit_date": 1502866788, "creation_date": 1502864096, "answer_id": 45706279, "question_id": 45705044, "link": "https://stackoverflow.com/questions/45705044/select-and-copy-multiple-ranges-with-vba/45706279#45706279", "title": "Select and Copy multiple ranges with VBA", "body": "<pre><code> Option Explicit\n\n    Sub import_APVP()\n\n        Dim master As Worksheet, sh As Worksheet\n        Dim wk As Workbook\n        Dim strFolderPath As String\n        Dim selectedFiles As Variant\n        Dim iFileNum As Integer, iLastRowReport As Integer, iNumberOfRowsToPaste As Integer\n        Dim strFileName As String\n        Dim iCurrentLastRow As Integer, iRowStartToPaste As Integer\n        Dim MultiRng As Range\n        Dim startTime As Double\n\n        getSpeed (True)\n        Set master = ActiveWorkbook.ActiveSheet\n\n        strFolderPath = ActiveWorkbook.Path\n\n        ChDrive strFolderPath\n        ChDir strFolderPath\n        Application.ScreenUpdating = False\n        'On Error GoTo NoFileSelected\n        selectedFiles = Application.GetOpenFilename( _\n                        filefilter:=\"Excel Files (*.xls*),*.xlsx*\", MultiSelect:=True)\n        For iFileNum = LBound(selectedFiles) To UBound(selectedFiles)\n            strFileName = selectedFiles(iFileNum)\n\n            Set wk = Workbooks.Open(strFileName)\n\n            For Each sh In wk.Sheets\n                If sh.Name Like \"DATA*\" Then\n                    With sh\n                        iLastRowReport = .Range(\"D\" &amp; .Rows.Count).End(xlUp).Row\n                        iNumberOfRowsToPaste = iLastRowReport + 2 - 1\n\n                       '.Range(\"A3:AG\" &amp; iLastRowReport &amp; \" , AL3:EJ &amp; iLastRowReport\").Select\n                       ' Selection.Copy\n                        Set MultiRng = Union(.Range(\"A3:AG\" &amp; iLastRowReport), .Range(\"AL3:EJ\" &amp; iLastRowReport))\n'you delete the 3 in range (\"AL:EJ....) that make your code not work.\n                        MultiRng.Copy\n                        With master\n                            iCurrentLastRow = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\n                            iRowStartToPaste = iCurrentLastRow + 1\n\n                            '.Activate ' &lt;-- not needed\n                              .Range(\"A\" &amp; iRowStartToPaste).PasteSpecial xlPasteAll\n                             'ActiveSheet.Paste &lt;-- not needed\n\n                        End With\n\n                    End With\n                End If\n            Next sh\n            wk.Close\n        Next\n        getSpeed (False)\n\n        Application.ScreenUpdating = True\n\n    NoFileSelected:\n\n    End Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 115, "user_id": 6526319, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-zsGRSRaPwtc/AAAAAAAAAAI/AAAAAAAAABQ/dz39zga2eIc/photo.jpg?sz=128", "display_name": "Luu nguyen", "link": "https://stackoverflow.com/users/6526319/luu-nguyen"}, "edited": false, "score": 0, "creation_date": 1502866025, "post_id": 45706685, "comment_id": 78371457, "body": "The problem is you replace the number of row <code>4</code> by <code>iLastRow</code>. If with specific number row, my code <code>sh.Range(&quot;A3:AG1000, AL3:EJ1000&quot;).Select</code> run, too"}], "tags": [], "owner": {"reputation": 118, "user_id": 8409510, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Zi1fnb3f03s/AAAAAAAAAAI/AAAAAAAABNM/G8cGaSte3Fc/photo.jpg?sz=128", "display_name": "Duc Anh Nguyen", "link": "https://stackoverflow.com/users/8409510/duc-anh-nguyen"}, "is_accepted": false, "score": 2, "last_activity_date": 1502866352, "last_edit_date": 1502866352, "creation_date": 1502865763, "answer_id": 45706685, "question_id": 45705044, "link": "https://stackoverflow.com/questions/45705044/select-and-copy-multiple-ranges-with-vba/45706685#45706685", "title": "Select and Copy multiple ranges with VBA", "body": "<p>The Union method is a solution to this problem. but it also has its cons\n<a href=\"https://i.stack.imgur.com/6Y8wu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6Y8wu.png\" alt=\"copy multirange test\"></a></p>\n\n<p>The union range should be the same first row and last row.\nOn the other hand, you can just select the first cell to paste.\nyou can alway do like this. the main point here is the row number should be the same. here I synchronize both range with the same variable. in your case, change to last cell.</p>\n\n<pre><code>j=1\ni = 4\nSet MultiRng = Union(Range(\"A\" &amp; j &amp; \":B\" &amp; i), Range(\"D\" &amp; j &amp; \":E\" &amp; i))\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 6526319, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-zsGRSRaPwtc/AAAAAAAAAAI/AAAAAAAAABQ/dz39zga2eIc/photo.jpg?sz=128", "display_name": "Luu nguyen", "link": "https://stackoverflow.com/users/6526319/luu-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19258, "favorite_count": 0, "accepted_answer_id": 45705534, "answer_count": 4, "score": 2, "last_activity_date": 1502866788, "creation_date": 1502857085, "last_edit_date": 1531164843, "question_id": 45705044, "link": "https://stackoverflow.com/questions/45705044/select-and-copy-multiple-ranges-with-vba", "title": "Select and Copy multiple ranges with VBA", "body": "<p>I want to copy multiple range to another workbook. I have the code below. How can I replace the number 1000 by iLastRow </p>\n\n<pre><code>iLastRow = Sh.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nsh.Range(\"A3:AG1000, AL3:EJ1000\").Select\nSelection.Copy\n</code></pre>\n"}, {"tags": ["vba", "excel", "if-statement"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502857063, "post_id": 45704996, "comment_id": 78368144, "body": "Change <code>And (if</code> to <code>And (</code>  (I&#39;m not having much luck with this comment - that&#39;s about the 10th edit I have made!)"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502857855, "post_id": 45704996, "comment_id": 78368360, "body": "what is exp_gas ???"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502858348, "post_id": 45704996, "comment_id": 78368518, "body": "drop the second <code>if</code>, it is causing the syntax error. the logic of the If statement may be wrong though.  each part, of the If clause, has to reduce to true/false"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1502858555, "post_id": 45704996, "comment_id": 78368590, "body": "Can you clarify what you&#39;re trying to do? If you don&#39;t want to cook, and if the gas or woorburn is greater than zero while the or margarine is greater than zero, display that message box? ...Wouldn&#39;t you just need to know <code>not cook = True</code> to know <code>He doesn&#39;t cook</code>, :P"}, {"owner": {"reputation": 71, "user_id": 8421072, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/053b5d344511ac29bec902a014592852?s=128&d=identicon&r=PG&f=1", "display_name": "arifulromadhon", "link": "https://stackoverflow.com/users/8421072/arifulromadhon"}, "edited": false, "score": 0, "creation_date": 1502858667, "post_id": 45704996, "comment_id": 78368628, "body": "it works.. thank you Sir,"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502858875, "post_id": 45704996, "comment_id": 78368702, "body": "i think that you want this.  ... start with <code>if cook and fuel and fat then</code> ... then reverse logic  <code>if not (cook and fuel and fat) then</code> ... then expand fuel and fat (brackets around each)... <code>If Not (cook And ((exp_gas &gt; 0) Or (exp_woodburn &gt; 0)) And ((exp_oil &gt; 0) Or (margarine &gt; 0))) Then</code>"}, {"owner": {"reputation": 71, "user_id": 8421072, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/053b5d344511ac29bec902a014592852?s=128&d=identicon&r=PG&f=1", "display_name": "arifulromadhon", "link": "https://stackoverflow.com/users/8421072/arifulromadhon"}, "edited": false, "score": 0, "creation_date": 1502859030, "post_id": 45704996, "comment_id": 78368742, "body": "Yes, Sir. i&#39;ve been making a editing coding program with VBA for household questionnaire of expenditure. but, i still a new learning about macro hehe"}], "answers": [{"tags": [], "owner": {"reputation": 354, "user_id": 6909299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sx1jb.jpg?s=128&g=1", "display_name": "Dinesh Kumar", "link": "https://stackoverflow.com/users/6909299/dinesh-kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1502860023, "creation_date": 1502860023, "answer_id": 45705471, "question_id": 45704996, "link": "https://stackoverflow.com/questions/45704996/if-condition-with-and-combine-multiple-or-in-vba-excel/45705471#45705471", "title": "if condition with &quot;and&quot; combine &quot;multiple or&quot; in Vba Excel", "body": "<p>the compiler cannot understand these conditions.\nwe need to split the conditions and display the required.\nplease use multiple if statements for this </p>\n\n<p>If (not cook = True) And (if (exp_gas > 0)  Then</p>\n\n<p>MsgBox \"He doesn't cook\", vb Information </p>\n\n<p>End If</p>\n\n<p>If((exp_woodburn > 0) or _(exp_oil > 0)) then</p>\n\n<p>MsgBox \"He doesn't cook\", vbInformation </p>\n\n<p>End if</p>\n"}, {"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": true, "score": 2, "last_activity_date": 1502862797, "creation_date": 1502862797, "answer_id": 45705980, "question_id": 45704996, "link": "https://stackoverflow.com/questions/45704996/if-condition-with-and-combine-multiple-or-in-vba-excel/45705980#45705980", "title": "if condition with &quot;and&quot; combine &quot;multiple or&quot; in Vba Excel", "body": "<p>You can't use <code>If</code> statement in condition in another <code>If</code> statement. One solution is to use nested <code>If</code>'s, for more info look <a href=\"https://www.tutorialspoint.com/vba/vba_nested_if_statements.htm\" rel=\"nofollow noreferrer\">here</a>. Another solution is to get rid of <code>If</code> inside condition, so your code would look like this (i think this is exactly what you need):</p>\n\n<pre><code>If (not cook = True) And ((exp_gas &gt; 0) or (exp_woodburn &gt; 0) or _\n    (exp_oil &gt; 0) or (margarine &gt; 0)) Then\n    MsgBox \"He doesn't cook\", vbInformation \n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 8421072, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/053b5d344511ac29bec902a014592852?s=128&d=identicon&r=PG&f=1", "display_name": "arifulromadhon", "link": "https://stackoverflow.com/users/8421072/arifulromadhon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11245, "favorite_count": 1, "accepted_answer_id": 45705980, "answer_count": 2, "score": 1, "last_activity_date": 1502862797, "creation_date": 1502856643, "last_edit_date": 1502857230, "question_id": 45704996, "link": "https://stackoverflow.com/questions/45704996/if-condition-with-and-combine-multiple-or-in-vba-excel", "title": "if condition with &quot;and&quot; combine &quot;multiple or&quot; in Vba Excel", "body": "<p>I have been making validation in macro vba...</p>\n\n<p>How to make if condition with \"and\" combined with \"multiple or\" in vba?</p>\n\n<p>Here is my code:</p>\n\n<pre><code>If (not cook = True) And (if (exp_gas &gt; 0) or (exp_woodburn &gt; 0) or _\n    (exp_oil &gt; 0) or (margarine &gt; 0)) Then\n    MsgBox \"He doesn't cook\", vbInformation \n\nEnd If\n</code></pre>\n\n<p>It gives me syntax error.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8239586"}, "edited": false, "score": 0, "creation_date": 1502859604, "post_id": 45704881, "comment_id": 78368888, "body": "I am able to rotate the data around but it seems appending is pretty ingrained into this.  Lots of errors popup when I want to change whats causing this.."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8239586"}, "edited": false, "score": 0, "creation_date": 1502859655, "post_id": 45704881, "comment_id": 78368904, "body": "I&#39;ll keep on trying.  It&#39;s not the end of the world if this doesn&#39;t work, though the other method requires another 8 steps.. and launching and reopening excels (not good for cpu but unavoidable if unable to get this going)"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502860579, "post_id": 45704881, "comment_id": 78369165, "body": "just to clarify, the data range in picture (top left corner at AP173) should be  at AA1 ( or some column offset from A1) ???"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8239586"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502860757, "post_id": 45704881, "comment_id": 78369219, "body": "@jsotola Correct.  The data at Ap173 in the original workbook is at AA1 but the macro keeps appending it after the other workbooks data"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502860966, "post_id": 45704881, "comment_id": 78369282, "body": "i skimmed your code. you are calculating the bottom right corner of previous data. then you append new data at that point. just calculate last column, and make row = 1 for new data"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502861081, "post_id": 45704881, "comment_id": 78369325, "body": "was previous data filling columns up to <b>AO</b> ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8239586"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502861099, "post_id": 45704881, "comment_id": 78369332, "body": "@jsotola Well both workbooks start at at Cell 1 but different columns and wanting to merge.  Though this keeps appending it which defeats the purpose of it I guess.  I have been using standard copy and paste but its not ideal when you have limited CPU.   Hmm could you specify where abouts specifically or give an example to change?  I can&#39;t seem to be able to get that to work unfortunately and not for lack of trying"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502861156, "post_id": 45704881, "comment_id": 78369360, "body": "you did not write this code then"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8239586"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502861257, "post_id": 45704881, "comment_id": 78369397, "body": "@jsotola It&#39;s above my knowledge yes.  I concede that if I am unable to get it to work, then I will stick with what I know certainly."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502861813, "post_id": 45704881, "comment_id": 78369607, "body": "please describe in detail what you want the program to do. (not how you want to fix this one, but how it should behave when it works correctly). include all details about reading files, if any... columns and rows used .... and so on  .... please add the description into your question."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502862260, "post_id": 45704881, "comment_id": 78369785, "body": "please replace the picture in your question if you can. show column A,  and make column <b>L</b> to <b>AO</b> very narrow so we can still see column <b>AU</b>. ...  maybe post another picture that shows top  rows ( is there anything in columns <b>L</b> to <b>AO</b>  ?)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8239586"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502862443, "post_id": 45704881, "comment_id": 78369845, "body": "@jsotola I&#39;ll post the working code as my answer.  I fiddled around with it a bit more and slowly debugged it deleting stuff that did not appear to fix it.  Not sure if this new code is advisable or will break in the future but it worked for me"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502863101, "post_id": 45704881, "comment_id": 78370120, "body": "glad you figured it out. i had a closer look at the original. i think it did this: ... get a list of files in C:\\Users\\Guide\\Projects\\ ... open each of those files and append the content to a master worksheet, starting at next free row and starting in column A  ... also append a column on right side of the just pasted data and fill it with the Source Filename"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8239586"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502863330, "post_id": 45704881, "comment_id": 78370196, "body": "@jsotola Yeah it does exactly as you described.  My solution works provided that you keep the wksDst.Cells(1, 20) y value above a certain point otherwise it tends to automatically append.  Not really a true fix, but provided you keep both data separate by a large degree shouldn&#39;t be an issue.  Guess time will tell."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502863387, "post_id": 45704881, "comment_id": 78370215, "body": "in your picture. the data from file <i>data.xlsm</i> is pasted in range A173:AT212.  the filename is appended in range AU173:AU212"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502863638, "post_id": 45704881, "comment_id": 78370315, "body": "the problem with the original program is that the data should have been imported starting at column B, and the source filename should be in column A, because the data in the different workbooks does not have same number of columns ( example: pokemon.xlsm uses columns <b>A</b> to <b>I</b> and data.xlsm uses columns <b>A</b> to <b>AT</b>  )"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8239586"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502863790, "post_id": 45704881, "comment_id": 78370372, "body": "@jsotola In which case I just got both workbooks, and put all the column data starting at Cell A.  Then I can change that y value for whatever column I want it in.  This tends to work better.  There should be no fear of overlapping because unless you want to overwrite the data that would be pointless so I believe this solution works well :D"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8239586"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502863855, "post_id": 45704881, "comment_id": 78370404, "body": "@jsotola Probably not a true fix but I mean its working now I guess so I can&#39;t complain xD"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502864039, "post_id": 45704881, "comment_id": 78370478, "body": "how many files are you appending?  i still would be interested in what columns A to J look like if you don&#39;t mind (replace any private info with garbage data)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8239586"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502864568, "post_id": 45704881, "comment_id": 78370704, "body": "@jsotola Generally this is working fine for 2 files.  However I added a new file and it seems to automatically make sure that it does not override other data. Thats quite interesting.  I think if you wanted to specific whereabouts you&#39;d have to modify existing code to create a y value for this third input I guess."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8239586"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502863962, "post_id": 45705956, "comment_id": 78370445, "body": "@jsotola It only lets me accept answers after two days apparently"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502864510, "post_id": 45705956, "comment_id": 78370671, "body": "your code will work correctly only if you have 1 or 2 workbooks in the directory. it copies the first one into range starting at <b>A1</b>, and copies the second one and all others into range starting at <b>T1</b>.  so a third workbook will corrupt the data at range <b>T1</b>"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502864634, "post_id": 45705956, "comment_id": 78370728, "body": "i have a suspicion that the original program may be working correctly, but the workbooks in the C:\\Users\\Guide\\ are corrupted, or not in correct format"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8239586"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502865046, "post_id": 45705956, "comment_id": 78370921, "body": "@jsotola Perhaps.  I&#39;ve re-tested it with two workbooks and it tends to work fine.  I am unsure how you would do this with 3 though.    Where it says                                    &lt;~ this is the copy / paste.  Above that I believe you&#39;d have to  add a third line or something to include that.  The first line appears to refer to y value in pokemon book and the second line is the next workbook you are referring to.  I wonder if that is always constant or if they change at random."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8239586"}, "is_accepted": false, "score": 0, "last_activity_date": 1502862689, "creation_date": 1502862689, "answer_id": 45705956, "question_id": 45704881, "link": "https://stackoverflow.com/questions/45704881/how-to-combine-workbooks-from-their-actual-start-values-no-appending/45705956#45705956", "title": "How to combine workbooks from their actual start values (no appending)", "body": "<p>Sorry to answer my own question but I figured it out after a bit of debugging. The following code below does not append and creates the excels exactly as you need them.  Change the values as you see fit or use original code if you need to append.  </p>\n\n<pre><code>Option Explicit\n    Public Sub CombineManyWorkbooksIntoOneWorksheet()\n\n        Dim strDirContainingFiles As String, strFile As String, _\n            strFilePath As String\n        Dim wbkDst As Workbook, wbkSrc As Workbook\n        Dim wksDst As Worksheet, wksSrc As Worksheet\n        Dim lngIdx As Long, lngSrcLastRow As Long, _\n            lngSrcLastCol As Long, lngDstLastRow As Long, _\n            lngDstLastCol As Long, lngDstFirstFileRow As Long\n        Dim rngSrc As Range, rngDst As Range, rngFile As Range\n        Dim colFileNames As Collection\n        Set colFileNames = New Collection\n\n        'Set references up-front\n        strDirContainingFiles = \"C:\\Users\\Guide\\\" '&lt;~ your folder\n        Set wbkDst = Workbooks.Add '&lt;~ Dst is short for destination\n        Set wksDst = wbkDst.ActiveSheet\n\n        'Store all of the file names in a collection\n        strFile = Dir(strDirContainingFiles &amp; \"\\*.xlsm\")\n        Do While Len(strFile) &gt; 0\n            colFileNames.Add Item:=strFile\n            strFile = Dir\n        Loop\n\n        ''CHECKPOINT: make sure colFileNames has the file names\n        'Dim varDebug As Variant\n        'For Each varDebug In colFileNames\n        '    Debug.Print varDebug\n        'Next varDebug\n\n        'Now we can start looping through the \"source\" files\n        'and copy their data to our destination sheet\n        For lngIdx = 1 To colFileNames.Count\n\n            'Assign the file path\n            strFilePath = strDirContainingFiles &amp; \"\\\" &amp; colFileNames(lngIdx)\n\n            'Open the workbook and store a reference to the data sheet\n            Set wbkSrc = Workbooks.Open(strFilePath)\n            Set wksSrc = wbkSrc.Worksheets(\"Sheet1\")\n\n            'Identify the last row and last column, then\n            'use that info to identify the full data range\n            lngSrcLastRow = LastOccupiedRowNum(wksSrc)\n            lngSrcLastCol = LastOccupiedColNum(wksSrc)\n            With wksSrc\n            Set rngSrc = .Range(.Cells(1, 1), .Cells(lngSrcLastRow, _\n                                                         lngSrcLastCol))\n            End With\n\n            ''CHECKPOINT: make sure we have the full source data range\n            'wksSrc.Range(\"A1\").Select\n            'rngSrc.Select\n\n            'If this is the first (1st) loop, we want to keep\n            'the header row from the source data, but if not then\n            'we want to remove it\n\n\n            ''CHECKPOINT: make sure that we remove the header row\n            ''from the source range on every loop that is not\n            ''the first one\n            'wksSrc.Range(\"A1\").Select\n            'rngSrc.Select\n\n            'Copy the source data to the destination sheet, aiming\n            'for cell A1 on the first loop then one past the\n            'last-occupied row in column A on each following loop\n            If lngIdx = 1 Then\n                lngDstLastRow = 1\n                Set rngDst = wksDst.Cells(1, 1)\n            Else\n                lngDstLastRow = 1\n                Set rngDst = wksDst.Cells(1, 20)\n            End If\n            rngSrc.Copy Destination:=rngDst '&lt;~ this is the copy / paste\n\n\n\n\n            'Close the source workbook and repeat\n            wbkSrc.Close SaveChanges:=False\n\n        Next lngIdx\n\n        'Let the user know that the combination is done!\n        ''MsgBox \"Data combined!\"\n\n    End Sub\n\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    'INPUT       : Sheet, the worksheet we'll search to find the last row\n    'OUTPUT      : Long, the last occupied row\n    'SPECIAL CASE: if Sheet is empty, return 1\n    Public Function LastOccupiedRowNum(Sheet As Worksheet) As Long\n        Dim lng As Long\n        If Application.WorksheetFunction.CountA(Sheet.Cells) &lt;&gt; 0 Then\n            With Sheet\n                lng = .Cells.Find(What:=\"*\", _\n                                  After:=.Range(\"A1\"), _\n                                  Lookat:=xlPart, _\n                                  LookIn:=xlFormulas, _\n                                  SearchOrder:=xlByRows, _\n                                  SearchDirection:=xlPrevious, _\n                                  MatchCase:=False).Row\n            End With\n        Else\n            lng = 1\n        End If\n        LastOccupiedRowNum = lng\n    End Function\n\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    'INPUT       : Sheet, the worksheet we'll search to find the last column\n    'OUTPUT      : Long, the last occupied column\n    'SPECIAL CASE: if Sheet is empty, return 1\n    Public Function LastOccupiedColNum(Sheet As Worksheet) As Long\n        Dim lng As Long\n        If Application.WorksheetFunction.CountA(Sheet.Cells) &lt;&gt; 0 Then\n            With Sheet\n                lng = .Cells.Find(What:=\"*\", _\n                                  After:=.Range(\"A1\"), _\n                                  Lookat:=xlPart, _\n                                  LookIn:=xlFormulas, _\n                                  SearchOrder:=xlByColumns, _\n                                  SearchDirection:=xlPrevious, _\n                                  MatchCase:=False).Column\n            End With\n        Else\n            lng = 1\n        End If\n        LastOccupiedColNum = lng\n    End Function\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8239586"}, "edited": false, "score": 0, "creation_date": 1502871173, "post_id": 45707411, "comment_id": 78374632, "body": "Thanks looks good.  Is there a way to specificity where each workbook goes in the new workbook.  Say you had 3 workbooks and you want to merge them at cells 1, 50 and 100.  The code I was able to manipulate allowed this for only 2 workbooks.  I suppose you could just merge them as they were originally...  I&#39;ll try that though selecting where all 3 workbooks would go would be pretty handy"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1502872183, "post_id": 45707411, "comment_id": 78375262, "body": "The way it works now every time you call <code>InsertData(SourceWBName, TargetWS)</code> it will copy the data from the Source workbook to the first cell of next available column.  You can do this for as many workbooks as you want (until you run out of columns)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1502872414, "post_id": 45707411, "comment_id": 78375431, "body": "If you want to change the destination of the data then you&#39;ll have to modify <code>get1stCellInNextColumn</code>.  The advantage of setting it up this way is that you can test the functionality separately from the main program.  For example, you could modify <code>get1stCellInNextColumn</code> and then test it by typing <code>?get1stCellInNextColumn(ActiveWorksheet.UsedRange).Address</code> into the   Immediate Window and pressing enter.   This will give you the destination address of the new data."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8239586"}, "edited": false, "score": 0, "creation_date": 1502884805, "post_id": 45707411, "comment_id": 78383791, "body": "I&#39;d say this pretty well does the job.  My only critique is that if I have three worksheets and say I wanted to insert worksheet data 1 under worksheet data 2 it does not appear to let me do this.  Other than that though if I keep everything separate it works fine."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1502868161, "creation_date": 1502868161, "answer_id": 45707411, "question_id": 45704881, "link": "https://stackoverflow.com/questions/45704881/how-to-combine-workbooks-from-their-actual-start-values-no-appending/45707411#45707411", "title": "How to combine workbooks from their actual start values (no appending)", "body": "<p>You should identify the individual tasks that you program will have to perform and create methods and functions to handle these smaller tasks.  Doing this will allow you to easily debug your code.</p>\n\n<ul>\n<li>get1stCellInNextColumn - Defines the Target range </li>\n<li>getFileCollection - Collect all the file paths</li>\n<li>getLastUsedCell - Gets the last used cell in a range.  Used to define both Source and Target ranges</li>\n<li>getSourceRange - Gets the Source Range</li>\n<li>InsertData - Opens a Source file and copies its data to a Target Workbook</li>\n<li>Main_CombineManyWorkbooksIntoOneWorksheet - Process all the files</li>\n</ul>\n\n<hr>\n\n<pre><code>Option Explicit\n\n'This is the Main function that combines all the other Subs and Functions together to process the data\n\nPublic Sub Main_CombineManyWorkbooksIntoOneWorksheet()\n    Application.ScreenUpdating = False\n    Const FOLDERNAME As String = \"C:\\Users\\best buy\\Downloads\\_Temp\\\" ' \"C:\\Users\\Guide\\\"\n    Const EXTENSION As String = \"\\*.xlsx\" '\"\\*.xlsm\"\n    Dim cFiles As Collection\n    Dim x As Long\n\n    Set cFiles = getFileCollection(FOLDERNAME, EXTENSION)\n\n    With Workbooks.Add\n\n        For x = 1 To cFiles.Count\n            InsertData cFiles.Item(x), .Worksheets(1)\n        Next\n\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n\n'Opens Source Workbook, Copies Data to Target Worksheet and then closes the Source Workbook\nPublic Sub InsertData(SourceWBName As String, TargetWS As Worksheet)\n    Dim rSource As Range\n\n    With Workbooks.Open(SourceWBName)\n        Set rSource = getSourceRange(.Worksheets(\"Sheet1\"))\n        If rSource Is Nothing Then\n            Debug.Print .FullName, \"No Data Found\"\n        Else\n            rSource.Copy get1stCellInNextColumn(TargetWS.UsedRange)\n        End If\n\n        .Close SaveChanges:=False\n    End With\nEnd Sub\n\n'Collects the full file paths for the Source workbooks\nFunction getFileCollection(FOLDERNAME As String, FileExtension As String) As Collection\n    Dim FileName As String\n    Dim col As Collection\n    Set col = New Collection\n    'Store all of the file names in a collection\n    FileName = Dir(FOLDERNAME &amp; FileExtension)\n    Do While Len(FileName) &gt; 0\n        col.Add Item:=FOLDERNAME &amp; FileName\n        FileName = Dir\n    Loop\n    Set getFileCollection = col\nEnd Function\n\n'Gets the Source range from a Worksheet\nFunction getSourceRange(xlWS As Worksheet) As Range\n    Dim rLastCell As Range\n    With xlWS\n        Set rLastCell = getLastUsedCell(.UsedRange, True, True)\n\n        If Not rLastCell Is Nothing Then Set getSourceRange = .Range(.Cells(1, 1), rLastCell)\n\n    End With\nEnd Function\n\n'Gets the first cell in the next unused Column of the Target range\nFunction get1stCellInNextColumn(Target As Range) As Range\n    Dim r As Range\n    'Get last used cell in last used column of the Target range\n    Set r = getLastUsedCell(Target, False, True)\n\n    If r Is Nothing Then\n        Set r = Target.EntireColumn.Cells(1, 1)\n    Else\n        'Get the first cell in the next column adjacent to the Target range\n        Set r = Target.Columns(Target.Columns.Count).Next\n    End If\n\n    Set get1stCellInNextColumn = r\nEnd Function\n\n'Gets the last used cell the last used row\n'Or the last used cell the last used column\n'Or the last used cells in the Target range\n\nFunction getLastUsedCell(Target As Range, InRow As Boolean, InColumn As Boolean) As Range\n    Dim rRow As Range, rColumn As Range\n    If Target Is Nothing Then Exit Function\n\n    With Target\n\n        Set rRow = .Find(What:=\"*\", After:=.Range(\"A1\"), LookAt:=xlPart, LookIn:=xlFormulas, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, MatchCase:=False)\n\n        If rRow Is Nothing Then Exit Function\n\n        Set rColumn = .Find(What:=\"*\", After:=.Range(\"A1\"), LookAt:=xlPart, LookIn:=xlFormulas, SearchOrder:=xlByColumns, SearchDirection:=xlPrevious, MatchCase:=False)\n\n        If InRow And InColumn Then                    'Get last used cell in last used column\n            Set getLastUsedCell = Intersect(rRow.EntireRow, rColumn.EntireColumn)\n        ElseIf InRow Then                             'Get last used cell in last used row\n            Set getLastUsedCell = rRow\n        ElseIf InColumn Then                          'Get last used cell in last used column\n            Set getLastUsedCell = rColumn\n        End If\n\n    End With\n\nEnd Function\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8239586"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 45707411, "answer_count": 2, "score": 0, "last_activity_date": 1502868161, "creation_date": 1502855794, "last_edit_date": 1502856173, "question_id": 45704881, "link": "https://stackoverflow.com/questions/45704881/how-to-combine-workbooks-from-their-actual-start-values-no-appending", "title": "How to combine workbooks from their actual start values (no appending)", "body": "<p>I\u2019m really sorry if this is a silly question but the macro I\u2019m currently using keeps appending the new workbooks data when I\u2019m combining them.  </p>\n\n<p>Ideally, I want the new workbook to be beside it at cells AA1 instead of directly appending like it is in the picture.  I\u2019m sorry I can\u2019t be much more help.  I\u2019ve been going through it trying to get it to start for the other workbooks to not append but write where it actually is from the other workbooks.  No luck so far.   </p>\n\n<p>I\u2019m sure I\u2019ll get there in a few hours or so, but thanks again if you\u2019re willing to assist.\n<a href=\"https://i.stack.imgur.com/Bxsag.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Bxsag.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Option Explicit\nPublic Sub CombineManyWorkbooksIntoOneWorksheet()\n\n    Dim strDirContainingFiles As String, strFile As String, _\n        strFilePath As String\n    Dim wbkDst As Workbook, wbkSrc As Workbook\n    Dim wksDst As Worksheet, wksSrc As Worksheet\n    Dim lngIdx As Long, lngSrcLastRow As Long, _\n        lngSrcLastCol As Long, lngDstLastRow As Long, _\n        lngDstLastCol As Long, lngDstFirstFileRow As Long\n    Dim rngSrc As Range, rngDst As Range, rngFile As Range\n    Dim colFileNames As Collection\n    Set colFileNames = New Collection\n\n    'Set references up-front\n    strDirContainingFiles = \"C:\\Users\\Guide\\Projects\\\" '&lt;~ your folder\n    Set wbkDst = Workbooks.Add '&lt;~ Dst is short for destination\n    Set wksDst = wbkDst.ActiveSheet\n\n    'Store all of the file names in a collection\n    strFile = Dir(strDirContainingFiles &amp; \"\\*.xlsm\")\n    Do While Len(strFile) &gt; 0\n        colFileNames.Add Item:=strFile\n        strFile = Dir\n    Loop\n\n    ''CHECKPOINT: make sure colFileNames has the file names\n    'Dim varDebug As Variant\n    'For Each varDebug In colFileNames\n    '    Debug.Print varDebug\n    'Next varDebug\n\n    'Now we can start looping through the \"source\" files\n    'and copy their data to our destination sheet\n    For lngIdx = 1 To colFileNames.Count\n\n        'Assign the file path\n        strFilePath = strDirContainingFiles &amp; \"\\\" &amp; colFileNames(lngIdx)\n\n        'Open the workbook and store a reference to the data sheet\n        Set wbkSrc = Workbooks.Open(strFilePath)\n        Set wksSrc = wbkSrc.Worksheets(\"Sheet1\")\n\n        'Identify the last row and last column, then\n        'use that info to identify the full data range\n        lngSrcLastRow = LastOccupiedRowNum(wksSrc)\n        lngSrcLastCol = LastOccupiedColNum(wksSrc)\n        With wksSrc\n            Set rngSrc = .Range(.Cells(1, 1), .Cells(lngSrcLastRow, _\n                                                     lngSrcLastCol))\n        End With\n\n        ''CHECKPOINT: make sure we have the full source data range\n        'wksSrc.Range(\"A1\").Select\n        'rngSrc.Select\n\n        'If this is the first (1st) loop, we want to keep\n        'the header row from the source data, but if not then\n        'we want to remove it\n        If lngIdx &lt;&gt; 1 Then\n            Set rngSrc = rngSrc.Offset(1, 0).Resize(rngSrc.Rows.Count - 1)\n        End If\n\n        ''CHECKPOINT: make sure that we remove the header row\n        ''from the source range on every loop that is not\n        ''the first one\n        'wksSrc.Range(\"A1\").Select\n        'rngSrc.Select\n\n        'Copy the source data to the destination sheet, aiming\n        'for cell A1 on the first loop then one past the\n        'last-occupied row in column A on each following loop\n        If lngIdx = 1 Then\n            lngDstLastRow = 1\n            Set rngDst = wksDst.Cells(1, 1)\n        Else\n            lngDstLastRow = LastOccupiedRowNum(wksDst)\n            Set rngDst = wksDst.Cells(lngDstLastRow + 1, 1)\n        End If\n        rngSrc.Copy Destination:=rngDst '&lt;~ this is the copy / paste\n\n        'Almost done! We want to add the source file info\n        'for each of the data blocks to our destination\n\n        'On the first loop, we need to add a \"Source Filename\" column\n        If lngIdx = 1 Then\n            lngDstLastCol = LastOccupiedColNum(wksDst)\n            wksDst.Cells(1, lngDstLastCol + 1) = \"Source Filename\"\n        End If\n\n        'Identify the range that we need to write the source file\n        'info to, then write the info\n        With wksDst\n\n            'The first row we need to write the file info to\n            'is the same row where we did our initial paste to\n            'the destination file\n            lngDstFirstFileRow = lngDstLastRow + 1\n\n            'Then, we need to find the NEW last row on the destination\n            'sheet, which will be further down (since we pasted more\n            'data in)\n            lngDstLastRow = LastOccupiedRowNum(wksDst)\n            lngDstLastCol = LastOccupiedColNum(wksDst)\n\n            'With the info from above, we can create the range\n            Set rngFile = .Range(.Cells(lngDstFirstFileRow, lngDstLastCol), _\n                                 .Cells(lngDstLastRow, lngDstLastCol))\n\n            ''CHECKPOINT: make sure we have correctly identified\n            ''the range where our file names will go\n            'wksDst.Range(\"A1\").Select\n            'rngFile.Select\n\n            'Now that we have that range identified,\n            'we write the file name\n            rngFile.Value = wbkSrc.Name\n\n        End With\n\n        'Close the source workbook and repeat\n        wbkSrc.Close SaveChanges:=False\n\n    Next lngIdx\n\n    'Let the user know that the combination is done!\n    ''MsgBox \"Data combined!\"\n\nEnd Sub\n\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'INPUT       : Sheet, the worksheet we'll search to find the last row\n'OUTPUT      : Long, the last occupied row\n'SPECIAL CASE: if Sheet is empty, return 1\nPublic Function LastOccupiedRowNum(Sheet As Worksheet) As Long\n    Dim lng As Long\n    If Application.WorksheetFunction.CountA(Sheet.Cells) &lt;&gt; 0 Then\n        With Sheet\n            lng = .Cells.Find(What:=\"*\", _\n                              After:=.Range(\"A1\"), _\n                              Lookat:=xlPart, _\n                              LookIn:=xlFormulas, _\n                              SearchOrder:=xlByRows, _\n                              SearchDirection:=xlPrevious, _\n                              MatchCase:=False).Row\n        End With\n    Else\n        lng = 1\n    End If\n    LastOccupiedRowNum = lng\nEnd Function\n\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'INPUT       : Sheet, the worksheet we'll search to find the last column\n'OUTPUT      : Long, the last occupied column\n'SPECIAL CASE: if Sheet is empty, return 1\nPublic Function LastOccupiedColNum(Sheet As Worksheet) As Long\n    Dim lng As Long\n    If Application.WorksheetFunction.CountA(Sheet.Cells) &lt;&gt; 0 Then\n        With Sheet\n            lng = .Cells.Find(What:=\"*\", _\n                              After:=.Range(\"A1\"), _\n                              Lookat:=xlPart, _\n                              LookIn:=xlFormulas, _\n                              SearchOrder:=xlByColumns, _\n                              SearchDirection:=xlPrevious, _\n                              MatchCase:=False).Column\n        End With\n    Else\n        lng = 1\n    End If\n    LastOccupiedColNum = lng\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "listbox", "listboxitem"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502855906, "post_id": 45704872, "comment_id": 78367822, "body": "Can you show the code where you are setting <code>i</code> prior to adding the new item?  (But, if your first block of code immediately follows your second block of code, then <code>i</code> has a value of <code>-1</code> so that would explain the error.)"}, {"owner": {"reputation": 21, "user_id": 8398357, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pA7pUeeBCEk/AAAAAAAAAAI/AAAAAAAAB6g/qUQelZ7jDxU/photo.jpg?sz=128", "display_name": "Mark Vincent Manansala", "link": "https://stackoverflow.com/users/8398357/mark-vincent-manansala"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502857950, "post_id": 45704872, "comment_id": 78368383, "body": "@YowE3k you&#39;re exactly right, is there a way to work around this, like reset (i) or something to avoid the error? I&#39;m new to coding and this is actually my first attempt at it. I could post the entire code, I&#39;m just not sure if it&#39;s ok to do so... If it&#39;s ok I&#39;d gladly post the whole code. Thank you for your help."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1502858994, "post_id": 45704872, "comment_id": 78368731, "body": "You need to post enough that we can see how <code>i</code> is being set to an invalid value (probably -1) when it gets to the <code>.List(i, 0) = txt1</code> line.  I am scared about how much code is &quot;the whole code&quot; - if it is only a couple of hundred lines, post it and we can edit it down to the relevant parts afterwards.  If it is more than that, you will need to do some editing yourself to get rid of stuff that is definitely not related to how <code>i</code> is getting its value."}, {"owner": {"reputation": 21, "user_id": 8398357, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pA7pUeeBCEk/AAAAAAAAAAI/AAAAAAAAB6g/qUQelZ7jDxU/photo.jpg?sz=128", "display_name": "Mark Vincent Manansala", "link": "https://stackoverflow.com/users/8398357/mark-vincent-manansala"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1502861200, "post_id": 45704872, "comment_id": 78369374, "body": "@YowE3K got rid of most of the stuff that didn&#39;t affect (i) which was really called iListCount. The first chunk adds the items to the list box and also adds the data to the worksheet. Will basically manipulate the list box items while they&#39;re stored in memory and on the next transaction it doesn&#39;t have to be in the listbox so I kept a copy on the worksheet. I gave (me) the user the tool to delete items (though one at a time), then when I click on add new item the error occurs. Thank you for taking the time to help me with this one. Cheers!"}, {"owner": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "edited": false, "score": 1, "creation_date": 1502861535, "post_id": 45704872, "comment_id": 78369494, "body": "@MarkVincentManansala Is <code>iListCount</code> a global? If so, it looks like it&#39;s going to be set to the (last + 1) index of the list after you delete. After <code>Next iListCount</code> you should reset it to zero."}, {"owner": {"reputation": 21, "user_id": 8398357, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pA7pUeeBCEk/AAAAAAAAAAI/AAAAAAAAB6g/qUQelZ7jDxU/photo.jpg?sz=128", "display_name": "Mark Vincent Manansala", "link": "https://stackoverflow.com/users/8398357/mark-vincent-manansala"}, "reply_to_user": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "edited": false, "score": 0, "creation_date": 1502861751, "post_id": 45704872, "comment_id": 78369585, "body": "@Rob WOW! thank you Rob, I will try that :)"}, {"owner": {"reputation": 21, "user_id": 8398357, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pA7pUeeBCEk/AAAAAAAAAAI/AAAAAAAAB6g/qUQelZ7jDxU/photo.jpg?sz=128", "display_name": "Mark Vincent Manansala", "link": "https://stackoverflow.com/users/8398357/mark-vincent-manansala"}, "reply_to_user": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "edited": false, "score": 0, "creation_date": 1502862590, "post_id": 45704872, "comment_id": 78369909, "body": "@Rob That worked in the sense that an error no longer occurs. However, the ListBox wouldn&#39;t show the next item I add. The values calculated change accordingly but the newly added item would only show the TickBox to select the new item. Any Ideas?"}, {"owner": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "edited": false, "score": 1, "creation_date": 1502864285, "post_id": 45704872, "comment_id": 78370587, "body": "It&#39;s a bit difficult to see how it&#39;s working, but perhaps it might be <code>iListCount = lstFCHRGS.ListCount - 1</code> instead of zero as I suggested before. In any case; this is a good demonstration of why it&#39;s usually a bad idea to use global variables like this. <code>iListCount</code> should really be a local variable"}, {"owner": {"reputation": 21, "user_id": 8398357, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pA7pUeeBCEk/AAAAAAAAAAI/AAAAAAAAB6g/qUQelZ7jDxU/photo.jpg?sz=128", "display_name": "Mark Vincent Manansala", "link": "https://stackoverflow.com/users/8398357/mark-vincent-manansala"}, "reply_to_user": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "edited": false, "score": 0, "creation_date": 1502867896, "post_id": 45704872, "comment_id": 78372601, "body": "@Rob thank you for the idea. You&#39;ve helped me solve the issue and it now works perfectly. So I added a bunch of MsgBox to show how iListCount is changing and edited a few lines to make it work. :) changed for i with |For iListCount = LBound(lstFCHRGS.List) To UBound(lstFCHRGS.List|&lt;-- this caused the value to become 0 then as I stepped through it went back to it&#39;s original number then added 1 so I added iListCount = iListCount -1 after delete to restore the value of iListCount after deleting an entry. It now works perfectly. Thank you Rob and YowE3k for your help. Cheers!"}, {"owner": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "edited": false, "score": 0, "creation_date": 1502868006, "post_id": 45704872, "comment_id": 78372674, "body": "@MarkVincentManansala Glad you got it working! Would you be able to write your solution up as an answer here and mark it as accepted?"}, {"owner": {"reputation": 21, "user_id": 8398357, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pA7pUeeBCEk/AAAAAAAAAAI/AAAAAAAAB6g/qUQelZ7jDxU/photo.jpg?sz=128", "display_name": "Mark Vincent Manansala", "link": "https://stackoverflow.com/users/8398357/mark-vincent-manansala"}, "reply_to_user": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "edited": false, "score": 0, "creation_date": 1502868349, "post_id": 45704872, "comment_id": 78372868, "body": "@Rob will do, just saw the answer question button :) Thank you Rob, I really appreciate your help."}, {"owner": {"reputation": 21, "user_id": 8398357, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pA7pUeeBCEk/AAAAAAAAAAI/AAAAAAAAB6g/qUQelZ7jDxU/photo.jpg?sz=128", "display_name": "Mark Vincent Manansala", "link": "https://stackoverflow.com/users/8398357/mark-vincent-manansala"}, "reply_to_user": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "edited": false, "score": 1, "creation_date": 1502869849, "post_id": 45704872, "comment_id": 78373795, "body": "@Rob, tried my best to make the answer coherent. lol hope that works! Cheers!"}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1502913311, "post_id": 45707911, "comment_id": 78401952, "body": "In a <code>For iListCount = 0 To 4</code> loop, the <code>Next iListCount</code> increments the value of <code>iListCount</code> so, when it was 3 it increments to 4 and decides &quot;OK, I can still go through the loop again&quot; but when it is 4 it increments to 5 and says &quot;Hmmm, 5 is greater than the end value of 4, I don&#39;t need to process any more&quot;.  So then code continues after the <code>Next</code> <b>but <code>iListCount</code> is 5</b>.  You really should only use loop counters <b>within the loop</b> - never use them again outside.  (Some future version of VBA might change the current behaviour and cause you untold misery fixing your code up.)"}], "tags": [], "owner": {"reputation": 21, "user_id": 8398357, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pA7pUeeBCEk/AAAAAAAAAAI/AAAAAAAAB6g/qUQelZ7jDxU/photo.jpg?sz=128", "display_name": "Mark Vincent Manansala", "link": "https://stackoverflow.com/users/8398357/mark-vincent-manansala"}, "is_accepted": false, "score": 1, "last_activity_date": 1502870757, "last_edit_date": 1502870757, "creation_date": 1502869692, "answer_id": 45707911, "question_id": 45704872, "link": "https://stackoverflow.com/questions/45704872/run-time-error-381-occurs-when-i-add-an-item-into-a-listbox-after-removing-an/45707911#45707911", "title": "run-time error &#39;381&#39;: occurs when I add an item into a listbox after removing an item", "body": "<blockquote>\n  <p>After adding 5 items to the list iListCount would be equal to 4. due\n  to this line iListCount = iListCount + 1 it would now be equal to 5.</p>\n</blockquote>\n\n<p>Private Sub cmdDelChrgs_Click()\n    Dim x As Integer\n    Dim y As Integer\n    Dim t As Integer</p>\n\n<pre><code>Dim rngTarget As Range\nSet rngTarget = wksFraud.Range(\"A1\").End(xlDown)\nSet wksFraud = Application.ThisWorkbook.Worksheets(\"Fraud\")\n\n'For iListCount = lstFCHRGS.ListCount - 1 To 0 Step -1|&lt;-- changed this with \nFor iListCount = LBound(lstFCHRGS.List) To UBound(lstFCHRGS.List)     \n</code></pre>\n\n<blockquote>\n  <p>iListCount=0 at this point\n  as it loops iListCount would have the value of 5</p>\n</blockquote>\n\n<pre><code>    If lstFCHRGS.Selected(iListCount) Then\n        x = lstFCHRGS.ListCount\n        y = iListCount\n        t = (x - y) - 1\n\n        With rngTarget\n            Set rngTarget = rngTarget.Offset(-t, 0)\n            rngTarget.EntireRow.Delete\n        End With\n\n        lstFCHRGS.RemoveItem (iListCount)\nEnd If\nNext iListCount\n</code></pre>\n\n<blockquote>\n  <p>After deleting the item iListCount is still 5 and was probably the cause of the error</p>\n</blockquote>\n\n<pre><code>iListCount = iListCount - 1|&lt;-- Add  after next to restores the value of iListCount \n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8398357, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pA7pUeeBCEk/AAAAAAAAAAI/AAAAAAAAB6g/qUQelZ7jDxU/photo.jpg?sz=128", "display_name": "Mark Vincent Manansala", "link": "https://stackoverflow.com/users/8398357/mark-vincent-manansala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 730, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1502870757, "creation_date": 1502855733, "last_edit_date": 1531164843, "question_id": 45704872, "link": "https://stackoverflow.com/questions/45704872/run-time-error-381-occurs-when-i-add-an-item-into-a-listbox-after-removing-an", "title": "run-time error &#39;381&#39;: occurs when I add an item into a listbox after removing an item", "body": "<p>This is the code that populated the listbox, taking most of the data from TextBoxes.</p>\n\n<p>iListCount is Declared as global. For reasons unknown to me the list box only populates the first line and wouldn't take subsequent ones unless done that way.</p>\n\n<pre><code> Private Sub cmdAddFraudCharges_Click()\n    With Me.lstFCHRGS '&lt;- ListBox        \n        .ColumnCount = 6\n        .ColumnWidths = \"60;65;50;26;35;70\"\n        .AddItem\n        .List(iListCount, 0) = dtpAddDt |&lt;--DateTimePicker|error occurs here\n        .List(iListCount, 1) = txtAddAmt |&lt;--Continues till last column\n        iListCount = iListCount + 1\n    End With        \nEnd Sub    \n</code></pre>\n\n<p>Here's the code I used to simultaneously delete the listbox item and the worksheet entry.</p>\n\n<pre><code>Private Sub cmdDelChrgs_Click()\n    Dim x As Integer\n    Dim y As Integer\n    Dim t As Integer\n\n    Dim rngTarget As Range\n    Set rngTarget = wksFraud.Range(\"A1\").End(xlDown)\n    Set wksFraud = Application.ThisWorkbook.Worksheets(\"Fraud\")\n\n    For iListCount = lstFCHRGS.ListCount - 1 To 0 Step -1\n        x = lstFCHRGS.ListCount\n        If lstFCHRGS.Selected(iListCount) Then\n            y = iListCount\n            t = (x - y) - 1\n\n            With rngTarget\n                Set rngTarget = rngTarget.Offset(-t, 0)\n                rngTarget.EntireRow.Delete\n            End With\n\n            lstFCHRGS.RemoveItem (iListCount)\n        End If\n    Next iListCount\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "automation", "filenames", "worksheet"], "comments": [{"owner": {"reputation": 2953, "user_id": 5133088, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d0efad94ced5dcd194c0a482cafd4f7b?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen Heier", "link": "https://stackoverflow.com/users/5133088/jeroen-heier"}, "edited": false, "score": 0, "creation_date": 1502855863, "post_id": 45704815, "comment_id": 78367810, "body": "Maybe <a href=\"https://stackoverflow.com/questions/16901316/how-to-import-data-from-different-excel-files-and-sheets-into-one-main-excel-fil\">this</a> SO question gives you some code inspiration."}, {"owner": {"reputation": 11, "user_id": 8356403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2fa74685655fd11ae1f87690f5c2317?s=128&d=identicon&r=PG&f=1", "display_name": "MichaelMC", "link": "https://stackoverflow.com/users/8356403/michaelmc"}, "reply_to_user": {"reputation": 2953, "user_id": 5133088, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d0efad94ced5dcd194c0a482cafd4f7b?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen Heier", "link": "https://stackoverflow.com/users/5133088/jeroen-heier"}, "edited": false, "score": 0, "creation_date": 1502857370, "post_id": 45704815, "comment_id": 78368223, "body": "Jeroen - main objective is to get all the file names and their sheet names. for example there are 4 files in a folder, their files should be copied and placed per column to the master file, and their respective sheet names per row  A1 = file name 1 A2 = Sheet1 A3 = Sheet2 A4 = Sheet3  Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1502865295, "creation_date": 1502865295, "answer_id": 45706555, "question_id": 45704815, "link": "https://stackoverflow.com/questions/45704815/compile-sheets-and-file-names-into-workbook/45706555#45706555", "title": "Compile sheets and file names into workbook", "body": "<p>You can try this code. It will save everything in first sheet of your master workbook:</p>\n\n<pre><code>Sub SheetNames()\n\nDim objFSO As Object\nDim objFolder As Object\nDim objFile As Object\nDim currentWorkbook, wb As Workbook\nDim i, j As Integer\n\nSet currentWorkbook = ActiveWorkbook\n\n'Create an instance of the FileSystemObject\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\n'Get the current folder object\nSet objFolder = objFSO.GetFolder(currentWorkbook.Path)\ni = 1\nj = 2\n'loops through each file in the directory and prints their names and path\nFor Each objFile In objFolder.Files\n'we filter filenames, so we get only excel files\n'note that second condition is to prevent from using cached workbook associated with opened workbook\n'it starts with ~$\nIf objFile.Name Like \"*.xlsx\" And Not objFile.Name Like \"~$*.xlsx\" _\nAnd Not objFile.Name = currentWorkbook.Name Then\n    'get the name of a workbook in the first row\n        currentWorkbook.Worksheets(1).Cells(1, i).Value = objFile.Name\n        'open workbook\n        Set wb = Workbooks.Open(currentWorkbook.Path &amp; \"/\" &amp; objFile.Name)\n        'loop through sheets and get their names into cells\n        For j = 2 To wb.Worksheets.Count + 1\n            currentWorkbook.Worksheets(1).Cells(j, i).Value = wb.Worksheets(j - 1).Name\n        Next\n        'close workbook without saving changes\n        wb.Close (False)\n        i = i + 1\n\n    End If\n\nNext objFile\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8356403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2fa74685655fd11ae1f87690f5c2317?s=128&d=identicon&r=PG&f=1", "display_name": "MichaelMC", "link": "https://stackoverflow.com/users/8356403/michaelmc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502865295, "creation_date": 1502855335, "last_edit_date": 1502859587, "question_id": 45704815, "link": "https://stackoverflow.com/questions/45704815/compile-sheets-and-file-names-into-workbook", "title": "Compile sheets and file names into workbook", "body": "<p>I have a master Excel file which will be used as a reference to get the data from different sheet names from different Excel files in a folder, </p>\n\n<p>I've searched the net and could not get a solution. Is there a way to get all the sheet names and paste it per row starting from A2 and A1 and which will reflect its file name without the extension?</p>\n\n<p>Here is what I have so far:  </p>\n\n<pre><code>Sub SheetNames()\n\n    Columns(1).Insert\n    For I = 1 To Sheets.Count\n        Cells(I, 1) = Sheets(I).Name\n    Next I\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "listbox", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1502852956, "post_id": 45703894, "comment_id": 78367185, "body": "Users can be trained. You could have a label with bright red text on form that informs users."}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1502862248, "post_id": 45703894, "comment_id": 78369778, "body": "It&#39;s clear that the default behavior is sufficient, but you probably won&#39;t find a direct call to make the pop-up window show.  It is possible however to define your own pop-up (and optionally modal) form and set it as the ListItemsEditForm.  Then you have complete control including the ability to show the form with the click of a button or other action."}], "answers": [{"tags": [], "owner": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "is_accepted": true, "score": 0, "last_activity_date": 1503872604, "creation_date": 1503872604, "answer_id": 45909865, "question_id": 45703894, "link": "https://stackoverflow.com/questions/45703894/open-the-edit-list-items-window-with-a-button-in-access-for-listbox-object/45909865#45909865", "title": "Open the Edit List Items Window with a button in Access for ListBox Object", "body": "<p>You can simulate the click on edit</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub btnValueListEdit_Click()\n    Me.myListBox.SetFocus\n    DoCmd.RunCommand acCmdEditListItems\nEnd Sub\n</code></pre>\n\n<p>But this is not recomended!</p>\n\n<p>Have a look at <a href=\"http://allenbrowne.com/ser-27.html\" rel=\"nofollow noreferrer\">Add items to a Value List</a> from Allen Browne.</p>\n\n<blockquote>\n  <ul>\n  <li>You can remove items that are actually being used in other records.</li>\n  <li>You can correct a misspelled item, but the records that already have the misspelled item are not corrected.</li>\n  <li>You can add items to your form, but in a split database, other users don't get these items. Consequently, other users add items with other names to their forms, even where they should be the same item.</li>\n  <li>If you answer No after using one of the new items, you now have items in the data that don't match the list.</li>\n  <li>If you answer Yes in an unsplit database, you introduce strange errors as multiple users attempt to modify objects that could be in use by other people.</li>\n  <li>If you answer Yes in an split database, the list of items in one front end no longer matches the lists in the others.</li>\n  <li>Your changes don't last anyway: they are lost when the front end is updated.</li>\n  </ul>\n</blockquote>\n\n<h2>Conclusion</h2>\n\n<blockquote>\n  <ul>\n  <li>Use tables, not value lists, to manage lookup data. Create relationships with Relational Integrity.</li>\n  <li>Use these lookup tables (or queries based on them), as the RowSource for your combos. Do not use Value Lists for anything more than the simplest of choices that the user never needs to edit.</li>\n  <li>Use the Not In List event to add data to simple, single-field lookups such as types or categories.</li>\n  <li>If you only use Access 2007 or later, the List Items Edit Form property is a quick and easy way to nominate the form to use for managing the list items.</li>\n  <li>To edit the list in any version of Access, or to control how the editing works, use another event such as the combo's DblClick.</li>\n  </ul>\n</blockquote>\n"}], "owner": {"reputation": 1024, "user_id": 6040823, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/DDCAB.jpg?s=128&g=1", "display_name": "Jason Brady", "link": "https://stackoverflow.com/users/6040823/jason-brady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1540, "favorite_count": 0, "accepted_answer_id": 45909865, "answer_count": 1, "score": 2, "last_activity_date": 1503872604, "creation_date": 1502847901, "last_edit_date": 1502852524, "question_id": 45703894, "link": "https://stackoverflow.com/questions/45703894/open-the-edit-list-items-window-with-a-button-in-access-for-listbox-object", "title": "Open the Edit List Items Window with a button in Access for ListBox Object", "body": "<p>I have a List Box in my form.</p>\n\n<p><a href=\"https://i.stack.imgur.com/rgec5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rgec5.png\" alt=\"Listbox\"></a></p>\n\n<p>I'm allowing the user to edit the contents which is a feature I'd like to have and the default feature works great for my needs. I know if you right click the list you get the Edit List Items Window too. </p>\n\n<p><a href=\"https://i.stack.imgur.com/2C0XV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2C0XV.png\" alt=\"Edit List Items\"></a></p>\n\n<p>But my issue is most of my users are not Access savvy, so they may not know to right click to open the window. I'd like to make it so the blue edit button will open that window with VBA, but I can't figure out how to call opening that window with VBA.</p>\n\n<p>Is this even possible, if so I'd love to know the call.</p>\n"}]