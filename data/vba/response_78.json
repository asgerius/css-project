[{"tags": ["arrays", "excel", "vba", "udf"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1467852885, "post_id": 38235621, "comment_id": 63893648, "body": "Does your data start in Column A?"}, {"owner": {"reputation": 1, "user_id": 6307109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab39aba87b894b05616c78757d5edca7?s=128&d=identicon&r=PG&f=1", "display_name": "colonel_mu5t4rd", "link": "https://stackoverflow.com/users/6307109/colonel-mu5t4rd"}, "edited": false, "score": 0, "creation_date": 1467855951, "post_id": 38235621, "comment_id": 63894320, "body": "Yes. All Data starts in A1"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1467857962, "post_id": 38235621, "comment_id": 63894745, "body": "As long as the data starts in A1, It works fine for me."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1467873897, "post_id": 38235621, "comment_id": 63898968, "body": "I see neither an array not a loop in the function you provided but I suppose <code>Range.Find</code> is like looping through cells so where is the function that doesn&#39;t work?"}], "owner": {"reputation": 1, "user_id": 6307109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab39aba87b894b05616c78757d5edca7?s=128&d=identicon&r=PG&f=1", "display_name": "colonel_mu5t4rd", "link": "https://stackoverflow.com/users/6307109/colonel-mu5t4rd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467849483, "creation_date": 1467849053, "last_edit_date": 1467849483, "question_id": 38235621, "link": "https://stackoverflow.com/questions/38235621/excel-vba-udf-in-array-loop", "title": "excel vba UDF in array loop", "body": "<p>I have a UDF that just does a sumif. It works when I use it in a cell or in a \"For each cell in Range XYZ\" loop but not when I loop thru an array.</p>\n\n<p>I have a sheet with an list of accounts and item ID numbers in columns A and B, and then I'm adding about 20 columns of data from multiple sources and formulas. I'm doing something like this:</p>\n\n<pre><code>Dim array() as variant, ACCT as string, ID as string, lr as long\nlr = Range(\"A1048576\").end(xlup)\narray=Range(\"A1:Z\" &amp; lr)\n\nFor i=1 to ubound(array)\nACCT=array(i,1):ID=array(i,2)\narray(i,3)=DataSource1(ACCT,ID)\narray(i,4)=DataSource2(ACCT,ID)\n</code></pre>\n\n<p>etc...</p>\n\n<p>My DataSource1 Function gives me no issues, but DataSource2 Function returns 0. Both Functions are almost identical except that DataSource2 uses find to build dynamic ranges since the columns are not always in the same order. And like I said, it works if I loop thru each cell in the range instead of using an array.</p>\n\n<pre><code>Function DataSource2_Qty(ACCT As String, ID As String)\n\nDim rng As Range, lr As Long, ACCTS As Range, DATA As Range, _\n        IDs As Range, Qty As Range, DATASht as Worksheet\n\nSet DATASht = Sheets(\"DataSource2_SECURITY_DATA\")\nSet DATA = DATASht.UsedRange\n\nlr = DATA.Rows.Count\n\nSet rng = DATA.Cells.Find(\"Account\", searchorder:=xlByColumns, Lookat:=xlWhole)\n    Set ACCTS = DATASht.Range(DATA.Cells(1, rng.Column), DATA.Cells(lr, rng.Column))\n\nSet rng = DATA.Cells.Find(\"Security Id\", searchorder:=xlByColumns, Lookat:=xlWhole)\n    Set IDs = DATASht.Range(DATA.Cells(1, rng.Column), DATA.Cells(lr, rng.Column))\n\nSet rng = DATA.Cells.Find(\"Quantity\", searchorder:=xlByColumns, Lookat:=xlWhole)\n    Set Qty = DATASht.Range(DATA.Cells(1, rng.Column), DATA.Cells(lr, rng.Column))\n\nDataSource2_Qty = Application.SumIfs(Qty, IDs, ID, ACCTS, ACCT)\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1467849053, "post_id": 38235534, "comment_id": 63892722, "body": "SaveCopyAs doesn&#39;t have a FileFormat parameter, I believe. You can only save to the same format."}, {"owner": {"reputation": 47, "user_id": 4736081, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4590e852d78fe647666cf1ec8d19dc07?s=128&d=identicon&r=PG&f=1", "display_name": "Swathi", "link": "https://stackoverflow.com/users/4736081/swathi"}, "reply_to_user": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1467850007, "post_id": 38235534, "comment_id": 63892994, "body": "I modified my question since I made changes on code based on suggestions. Now I get different error"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 4736081, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4590e852d78fe647666cf1ec8d19dc07?s=128&d=identicon&r=PG&f=1", "display_name": "Swathi", "link": "https://stackoverflow.com/users/4736081/swathi"}, "edited": false, "score": 0, "creation_date": 1467849541, "post_id": 38235609, "comment_id": 63892855, "body": "In my case, I have a requirement to use SaveCopyAs . I removed the Fileformat and CreateBackup . I get the run time error 1004 saying the filename already exists. I need to overwrite the existing file without showing any alerts."}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "reply_to_user": {"reputation": 47, "user_id": 4736081, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4590e852d78fe647666cf1ec8d19dc07?s=128&d=identicon&r=PG&f=1", "display_name": "Swathi", "link": "https://stackoverflow.com/users/4736081/swathi"}, "edited": false, "score": 0, "creation_date": 1467932891, "post_id": 38235609, "comment_id": 63934224, "body": "If you need to use <code>SaveCopyAs</code> then I think your only option is to use the filesystem to rename or delete the existing file before saving the new copy. There&#39;s no way to have the <code>SaveCopyAs</code> method automatically overwrite an existing file"}], "tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": false, "score": 2, "last_activity_date": 1467848972, "creation_date": 1467848972, "answer_id": 38235609, "question_id": 38235534, "link": "https://stackoverflow.com/questions/38235534/runtime-error-1004-savecopyas-not-letting-to-overwrite-existing-files/38235609#38235609", "title": "Runtime Error 1004: SaveCopyAs not letting to overwrite existing files", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff835014.aspx\" rel=\"nofollow\">SaveCopyAs method</a> only takes one parameter - <code>Filename</code></p>\n\n<p>Leave out the <code>FileFormat</code> and <code>CreateBackup</code> arguments and everything should work OK. If you do want to change the file format then use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff841185.aspx\" rel=\"nofollow\">SaveAs method</a> instead</p>\n"}], "owner": {"reputation": 47, "user_id": 4736081, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4590e852d78fe647666cf1ec8d19dc07?s=128&d=identicon&r=PG&f=1", "display_name": "Swathi", "link": "https://stackoverflow.com/users/4736081/swathi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 717, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467849970, "creation_date": 1467848495, "last_edit_date": 1467849970, "question_id": 38235534, "link": "https://stackoverflow.com/questions/38235534/runtime-error-1004-savecopyas-not-letting-to-overwrite-existing-files", "title": "Runtime Error 1004: SaveCopyAs not letting to overwrite existing files", "body": "<p>I am trying to do SaveCopyAs to a different destination through a button click. When I execute the code it gives me the error in the following code. Any ideas or suggestions on how to get rid of this ?</p>\n\n<pre><code>   Application.DisplayAlerts= False       \n   ThisWorkbook.SaveCopyAs FileName:=\"W:\\..\\..\\..\\\" &amp; FileName1 &amp; \"-\" &amp; \"Audit checklist\" &amp; \".xlsm\"\n   Application.DisplayAlerts= True \n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1467847400, "post_id": 38235266, "comment_id": 63892271, "body": "This code seems obscure. What are you trying to do?"}, {"owner": {"reputation": 39, "user_id": 6558344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e267f638ccfa627092b8b30c88a4b0?s=128&d=identicon&r=PG&f=1", "display_name": "TylerC", "link": "https://stackoverflow.com/users/6558344/tylerc"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1467847650, "post_id": 38235266, "comment_id": 63892340, "body": "Well, I&#39;m not an experienced coder. The Do Loop is supposed to add up the digits of a number."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1467847736, "post_id": 38235266, "comment_id": 63892368, "body": "What do you mean by &quot;add up the digits of a number&quot;? 123 =&gt; 1 + 2 + 3 = 6? If so, there are vastly easier ways to do that."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1467848839, "post_id": 38235266, "comment_id": 63892655, "body": "You are going to have problems summing the digits in <code>i^3</code>when <code>i= 999999</code>. (since it will round to 9.99997000003E+17). The only way to get the precision that you want is to use the decimal subtype of variants, and use repeated multiplication rather than exponentiation."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 6558344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e267f638ccfa627092b8b30c88a4b0?s=128&d=identicon&r=PG&f=1", "display_name": "TylerC", "link": "https://stackoverflow.com/users/6558344/tylerc"}, "edited": false, "score": 0, "creation_date": 1467848504, "post_id": 38235411, "comment_id": 63892573, "body": "That&#39;s probably it. Thank you for your help!"}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 3, "last_activity_date": 1467850895, "last_edit_date": 1495535332, "creation_date": 1467847653, "answer_id": 38235411, "question_id": 38235266, "link": "https://stackoverflow.com/questions/38235266/overflow-error-vba/38235411#38235411", "title": "Overflow error VBA", "body": "<p>The problem is that the VBA <code>mod</code> operator coerces its arguments to be integers (if they are not already so). It is this implicit coercion which is causing the overflow. See this question: <a href=\"https://stackoverflow.com/q/23549947/4996248\">Mod with Doubles</a></p>\n\n<p><strong>On Edit:</strong>\nBased on your comments, you want to be able to add together the digits in a largish integer. The following function might help:</p>\n\n<pre><code>Function DigitSum(num As Variant) As Long\n    'Takes a variant which represents an integer type\n    'such as Integer, Long or Decimal\n    'and returns the sum of its digits\n\n    Dim sum As Long, i As Long, s As String\n\n    s = CStr(num)\n\n    For i = 1 To Len(s)\n        sum = sum + Val(Mid(s, i, 1))\n    Next i\n    DigitSum = sum\n\nEnd Function\n</code></pre>\n\n<p>The following test sub shows how it <em>can</em> be used to correctly get the sum of the digits in 999999^3:</p>\n\n<pre><code>Sub test()\n    Dim x As Variant, y As Variant\n    Debug.Print \"Naive approach: \" &amp; DigitSum(999999 ^ 3)\n\n    y = CDec(999999)\n    x = y * y * y\n    Debug.Print \"CDec approach: \" &amp; DigitSum(x)\nEnd Sub\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Naive approach: 63\nCDec approach: 108\n</code></pre>\n\n<p>Since 999999^3 = 999997000002999999, only the second result is accurate. The first result is only the sum of the digits in the string representation of the double 999999^3 = 9.99997000003E+17</p>\n"}], "owner": {"reputation": 39, "user_id": 6558344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e267f638ccfa627092b8b30c88a4b0?s=128&d=identicon&r=PG&f=1", "display_name": "TylerC", "link": "https://stackoverflow.com/users/6558344/tylerc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1467850895, "creation_date": 1467846625, "question_id": 38235266, "link": "https://stackoverflow.com/questions/38235266/overflow-error-vba", "title": "Overflow error VBA", "body": "<p>I have this code below, and I'm getting an overflow error at the line: \ns = s + (x Mod 10) [first line in the Do Loop]\nWhy? I declared x and s to be of type Double. Adding two doubles, why is this not working?\nThanks for your help.</p>\n\n<pre><code>Public Sub bidon1()\n    Dim i As Double, x As Double, s As Double, k As Byte, h As Byte\n    Dim y(1 To 6) As Double\n\n    For i = 1 To 1000000\n\n        x = i ^ 3\n        Do\n            s = s + (x Mod 10)\n            x = x \\ 10\n        Loop Until x = 0\n\n        If s = x Then\n            k = k + 1\n            y(k) = x\n\n            If y(6) &gt; 0 Then\n\n                For h = 1 To 6\n                    Debug.Print y(h)\n                Next\n                Exit Sub\n            End If\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1658, "user_id": 4350421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/p2Iig.png?s=128&g=1", "display_name": "silentsurfer", "link": "https://stackoverflow.com/users/4350421/silentsurfer"}, "edited": false, "score": 1, "creation_date": 1467848495, "post_id": 38235245, "comment_id": 63892568, "body": "Try calling <code>DoEvents</code>at some point during your [hard stuff here] execution part and see if it makes the GIF move at all."}, {"owner": {"reputation": 73, "user_id": 5562588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62724a09924f2b1fd1374914a9247bd0?s=128&d=identicon&r=PG&f=1", "display_name": "Marcin L", "link": "https://stackoverflow.com/users/5562588/marcin-l"}, "reply_to_user": {"reputation": 1658, "user_id": 4350421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/p2Iig.png?s=128&g=1", "display_name": "silentsurfer", "link": "https://stackoverflow.com/users/4350421/silentsurfer"}, "edited": false, "score": 0, "creation_date": 1468157060, "post_id": 38235245, "comment_id": 64001856, "body": "@silentsurfer that doesn&#39;t work. Calling <code>DoEvents</code> will sometimes make the gif visible, sometimes it won&#39;t, and in either case it will not be animated"}], "owner": {"reputation": 73, "user_id": 5562588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62724a09924f2b1fd1374914a9247bd0?s=128&d=identicon&r=PG&f=1", "display_name": "Marcin L", "link": "https://stackoverflow.com/users/5562588/marcin-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 423, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1467846542, "creation_date": 1467846542, "question_id": 38235245, "link": "https://stackoverflow.com/questions/38235245/displaying-loading-gif-on-a-form-during-vba-sub-execution", "title": "displaying loading gif on a form during vba sub execution", "body": "<p>I am trying to put an animated loading gif on a form during a long subroutine execution (specifically, sub being fired on a form's button click event), and it turns out to be surprisingly difficult in MS Access.</p>\n\n<p>I already have my gif animation put on the form, linked to ActiveX Web Browser control (call it <code>loadingGif</code> in example below). It turns out, that doing simply:</p>\n\n<pre><code>Private Sub someButton_Click()\n    loadingGif.Visible = True\n    '... hard stuff here ...\n    loadingGif.Visible = False\nEnd Sub\n</code></pre>\n\n<p>fails because screen doesn't get refreshed during subroutine execution, and so the user never sees the <code>loadingGif</code> control. Is there any way to make it visible during single subroutine execution?</p>\n\n<p>Also:</p>\n\n<ol>\n<li><p>I know it is possible to create an animated modal pop-up form instead, but that's not the idea</p></li>\n<li><p>I already also use Hourglass, but icon on a form seems much more appealing</p></li>\n</ol>\n"}, {"tags": ["vba", "excel-2010"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1467849843, "post_id": 38235168, "comment_id": 63892938, "body": "Have you tried the ADO method? Not sure if that works with named range... <a href=\"http://stackoverflow.com/questions/16859255/reading-a-workbooks-without-opening-it-with-ado\" title=\"reading a workbooks without opening it with ado\">stackoverflow.com/questions/16859255/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": -1, "last_activity_date": 1467848743, "creation_date": 1467848743, "answer_id": 38235574, "question_id": 38235168, "link": "https://stackoverflow.com/questions/38235168/vba-return-cell-value-from-a-named-cell-in-a-closed-workbook/38235574#38235574", "title": "VBA Return Cell Value from a Named Cell in a Closed Workbook", "body": "<p>The format is something like <code>'C:\\Book1.xlsx'!Total</code></p>\n\n<p><a href=\"https://www.ablebits.com/office-addins-blog/2015/12/08/excel-reference-another-sheet-workbook/#reference-to-defined-name-another-workbook\" rel=\"nofollow\">https://www.ablebits.com/office-addins-blog/2015/12/08/excel-reference-another-sheet-workbook/#reference-to-defined-name-another-workbook</a></p>\n\n<pre><code>[Model!C18].Formula = \"='\" &amp; Path &amp; File &amp; \"'!Total\"\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 4480738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05c184fae89449a0959706191a3a6c7c?s=128&d=identicon&r=PG&f=1", "display_name": "nam24", "link": "https://stackoverflow.com/users/4480738/nam24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 235, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1467848743, "creation_date": 1467846074, "question_id": 38235168, "link": "https://stackoverflow.com/questions/38235168/vba-return-cell-value-from-a-named-cell-in-a-closed-workbook", "title": "VBA Return Cell Value from a Named Cell in a Closed Workbook", "body": "<p>I am trying to retrieve a cell value from another workbook without opening the source file. The below will return the value from \"SourceRange\" when I use the actual cell address. However, I want to modify the below code to reference the cell name instead of the cell address because lines may be added. So if the cell name in the source workbook is named \"Total\", is there a way for me to retrieve the value?</p>\n\n<pre><code>Sub OpenFiles()\n\nDim Folder_YR As String\nDim Folder_MO As String\nDim Path As String\nDim File As String\nDim SourceSheet As String\nDim SourceRange As String\n\nFolder_YR = Sheets(\"Inputs\").Range(\"B5\").Value\nFolder_MO = Sheets(\"Inputs\").Range(\"B9\").Value\nFN = Sheets(\"Inputs\").Range(\"B10\").Value\n\n\nPath = \"G:\\PMT ACTIVITY\\\" &amp; Folder_YR &amp; \"\\\" &amp; Folder_MO &amp; \"\\\"\nFile = FN\n\nSourceSheet = \"Summary\"\nSourceRange = Range(\"C1\").Address(1, 1, xlR1C1)\n\nRef = \"'\" &amp; Path &amp; \"[\" &amp; File &amp; \"]\" &amp; SourceSheet &amp; \"'!\" &amp; SourceRange\n\nSheets(\"Model\").Range(\"C18\").Formula = ExecuteExcel4Macro(Ref)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1467844244, "post_id": 38234807, "comment_id": 63891296, "body": "What is your database running in ?"}, {"owner": {"reputation": 13, "user_id": 6558179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b822fab1fa1fdcad4e318962054cf8a4?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6558179/robert"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1467924548, "post_id": 38234807, "comment_id": 63931129, "body": "Honestly, I&#39;m not sure. I am accessing it through an ADODB call from VBA within Excel 2010. The &quot;provider&quot; is &quot;SQLOLEDB&quot;. I&#39;m pretty sure it is a Microsoft SQL Server."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6558179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b822fab1fa1fdcad4e318962054cf8a4?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6558179/robert"}, "edited": false, "score": 0, "creation_date": 1467906233, "post_id": 38234857, "comment_id": 63920824, "body": "Yeah! This worked like a charm. I was missing the GROUP BY for sure and although I had tried aliasing the tables, I&#39;m not sure I was doing that right. Thanks much!!!"}], "tags": [], "owner": {"reputation": 60275, "user_id": 1073631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12b7f78513c544111980c6308b25a4ed?s=128&d=identicon&r=PG", "display_name": "sgeddes", "link": "https://stackoverflow.com/users/1073631/sgeddes"}, "is_accepted": true, "score": 0, "last_activity_date": 1467844227, "creation_date": 1467844227, "answer_id": 38234857, "question_id": 38234807, "link": "https://stackoverflow.com/questions/38234807/sql-query-matching-data-across-tables-while-combining-rows/38234857#38234857", "title": "SQL - query matching data across tables while combining rows", "body": "<p>This is called table pivoting.  Some databases support the <code>pivot</code> clause.  You are using <code>conditional aggregation</code>.  </p>\n\n<p>Here's what you're probably after:</p>\n\n<pre><code>select t1.recordid, t1.recorddescription, \n       max(case when t2.fieldid = 10 then t2.fieldvalue end) as field10value,\n       max(case when t2.fieldid = 20 then t2.fieldvalue end) as field20value,\n       max(case when t2.fieldid = 30 then t2.fieldvalue end) as field30value\nfrom table1 t1 \n       join table2 t2 on t1.recordid = t2.recordid\ngroup by t1.recordid, t1.recorddescription\n</code></pre>\n\n<p>If you don't know the maximum number of <code>fieldid</code> values, you will probably need to look into using <code>dynamic sql</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 6558179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b822fab1fa1fdcad4e318962054cf8a4?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6558179/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 38234857, "answer_count": 1, "score": 1, "last_activity_date": 1467850324, "creation_date": 1467843998, "last_edit_date": 1467850324, "question_id": 38234807, "link": "https://stackoverflow.com/questions/38234807/sql-query-matching-data-across-tables-while-combining-rows", "title": "SQL - query matching data across tables while combining rows", "body": "<p>I have two tables; ie</p>\n\n<p>Table1:</p>\n\n<pre><code>RecordId    RecordDescription\n1           Red\n2           Green\n3           Blue\n</code></pre>\n\n<p>Table2:</p>\n\n<pre><code>RecordID    FieldID   FieldValue\n1           10        3.1\n1           20        2.8\n1           30        4.2\n2           20        3.8\n3           10        6.6\n3           30        5.5\n</code></pre>\n\n<p>I would like to generate a combined table that looks something like:\nTable3:</p>\n\n<pre><code>RecordID   Field10Value   Field20Value   Field30Value\n1               3.1            2.8          4.2\n2                              3.8 \n3               6.6                         5.5\n</code></pre>\n\n<p>This seems like it should be pretty straight forward, but I keep driving myself in circles.</p>\n\n<p>It feels like I should be able to use:</p>\n\n<pre><code>SELECT * FROM (\n  SELECT RecordID, Field10Value, Field20Value, Field30Value FROM (\n  SELECT MAX(CASE WHEN FieldID=10 THEN FieldValue ELSE NULL END) as Field10Value,\n  SELECT MAX(CASE WHEN FieldID=20 THEN FieldValue ELSE NULL END) as Field20Value,\n  SELECT MAX(CASE WHEN FieldID=30 THEN FieldValue ELSE NULL END) as Field30Value \n  FROM Table2)) JOIN Table1 on RecordID\n</code></pre>\n\n<p>But I can't seem to get my syntax right and it seems like there may be a much more elegant way (I actually have quite a few FieldID values...)</p>\n\n<p>Any help would be greatly appreciated.\nI'm actually trying to do this from a VBA call in excel, so a single query call would be ideal.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1467842732, "post_id": 38234524, "comment_id": 63890772, "body": "If C is changed then should A or B be updated?  Both?"}, {"owner": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "edited": false, "score": 0, "creation_date": 1467843008, "post_id": 38234524, "comment_id": 63890886, "body": "Is this just a textbox or is it in a userform?"}, {"owner": {"reputation": 189, "user_id": 5281456, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1690f4f5941090f0e60f71164b277337?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay billa", "link": "https://stackoverflow.com/users/5281456/vinay-billa"}, "edited": false, "score": 0, "creation_date": 1467843208, "post_id": 38234524, "comment_id": 63890948, "body": "Tim - No if C changes only A must change and also D must change"}, {"owner": {"reputation": 189, "user_id": 5281456, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1690f4f5941090f0e60f71164b277337?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay billa", "link": "https://stackoverflow.com/users/5281456/vinay-billa"}, "edited": false, "score": 0, "creation_date": 1467843220, "post_id": 38234524, "comment_id": 63890953, "body": "Wyatt - This is a userform"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1467843282, "post_id": 38234524, "comment_id": 63890971, "body": "&quot;if C changes only A must change and also D must change&quot; I&#39;m sorry, that&#39;s not anywhere near anything reasonably clear. &quot;only A must change&quot; and &quot;and also D must change&quot; sound like mutually exclusive possibilities to me. Please <a href=\"https://stackoverflow.com/posts/38234524/edit\">edit</a> your question to clatify, as it stands it&#39;s not clear what the problem is, what you&#39;ve tried, and where you&#39;re stuck."}, {"owner": {"reputation": 189, "user_id": 5281456, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1690f4f5941090f0e60f71164b277337?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay billa", "link": "https://stackoverflow.com/users/5281456/vinay-billa"}, "edited": false, "score": 0, "creation_date": 1467843877, "post_id": 38234524, "comment_id": 63891186, "body": "Mat&#39;s Mug - Since C and D are percentages and they add upto 100%, I would like D to change when C is changed manually and since C is associated to A, I also want A to change when C is changed. Let me know if this is clear enough"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1467844087, "post_id": 38234524, "comment_id": 63891257, "body": "If D is changed should B (and C) be updated?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1467844153, "post_id": 38234524, "comment_id": 63891270, "body": "Hint - try transforming <code>C = A&#47;(A + B)</code> to move A to the left of the equals sign."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1467846674, "last_edit_date": 1467846674, "creation_date": 1467844273, "answer_id": 38234866, "question_id": 38234524, "link": "https://stackoverflow.com/questions/38234524/how-to-implement-recalculate-function-in-vba/38234866#38234866", "title": "How to implement recalculate function in VBA ?", "body": "<h2>Updated</h2>\n\n<p>I would create a single method o handle the logic.  You'll have to set a flag to prevent re-triggering your calculations.</p>\n\n<pre><code>Public StopCalculations As Boolean\n\nPrivate Sub a_Change()\n    If Not StopCalculations Then UpdateValues a\nEnd Sub\n\nPrivate Sub b_Change()\n    If Not StopCalculations Then UpdateValues b\nEnd Sub\n\nPrivate Sub c_Change()\n    If Not StopCalculations Then UpdateValues c\nEnd Sub\n\nPrivate Sub d_Change()\n    If Not StopCalculations Then UpdateValues d\nEnd Sub\n\nSub UpdateValues(txt As MSForms.TextBox)\n    StopCalculations = True\n\n    Select Case txt\n        Case a\n           b.value = a.value\n        Case b\n            b.value = c.value\n        Case c\n\n        Case d\n    End Select\n\n    StopCalculations = False\nEnd Sub\n</code></pre>\n\n<p>You can store and retrieve hidden values in the workbooks names collection like this:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    a.value = getNameValue(a.Name)\n    b.value = getNameValue(b.Name)\n    c.value = getNameValue(c.Name)\n    d.value = getNameValue(d.Name)\n    Application.EnableEvents = False\nEnd Sub\n\nPrivate Sub UserForm_Terminate()\n    ThisWorkbook.Names.Add a.Name, a.Text, False\n    ThisWorkbook.Names.Add b.Name, b.Text, False\n    ThisWorkbook.Names.Add c.Name, c.Text, False\n    ThisWorkbook.Names.Add d.Name, d.Text, False\nEnd Sub\n\nFunction getNameValue(value As String)\n    Dim s As String\n    On Error Resume Next\n    s = ThisWorkbook.Names(value).value\n    getNameValue = Right(s, Len(s) - 1)\n    On Error GoTo 0\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 5281456, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1690f4f5941090f0e60f71164b277337?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay billa", "link": "https://stackoverflow.com/users/5281456/vinay-billa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467846674, "creation_date": 1467842542, "last_edit_date": 1531164843, "question_id": 38234524, "link": "https://stackoverflow.com/questions/38234524/how-to-implement-recalculate-function-in-vba", "title": "How to implement recalculate function in VBA ?", "body": "<p>I have two sets of text boxes A,B and C,D. I have to manually enter the values in A and B while the code in the backend calculates C = A/(A + B) and D = B/(A + B). </p>\n\n<p>If I change the values in A and B, the values in C and D get updated. </p>\n\n<p>Is there any way the reverse could happen. </p>\n\n<p>My apologies if this is not a recalculate function related question. </p>\n\n<p>Thanks again! </p>\n"}, {"tags": ["html", "vba", "excel", "internet-explorer"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467842651, "post_id": 38234483, "comment_id": 63890735, "body": "11 is just more columns over. tough to say from your example data, but maybe 1 or 2 or more. you can do a loop with a <code>debug.print</code> to figure it out the first time than adjust the code accordingly. So, it would be <code>tr.Cells(2).innertext</code> if it was 2nd column."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 36, "user_id": 6557791, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/acd118a102a4850d786f3fb345fa7ac9?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Capnu", "link": "https://stackoverflow.com/users/6557791/eric-capnu"}, "edited": false, "score": 0, "creation_date": 1467864819, "post_id": 38235059, "comment_id": 63896033, "body": "Happy to assist. Sir!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1467845437, "creation_date": 1467845437, "answer_id": 38235059, "question_id": 38234483, "link": "https://stackoverflow.com/questions/38234483/inserting-a-html-table-cell-into-a-excel-sheet-cell-with-no-id/38235059#38235059", "title": "inserting a HTML table cell into a excel sheet cell with no id", "body": "<p>Scott is right there is no reason to loop through all the tds.</p>\n\n<pre><code> For Each tr In colTR\n\n    If tr.Cells(0).innerText = \"expenses\" Then\n        TheValueIWant = tr.Cells(1).innerText\n        MsgBox TheValueIWant\n    End If\n\n Next \n</code></pre>\n"}], "owner": {"reputation": 36, "user_id": 6557791, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/acd118a102a4850d786f3fb345fa7ac9?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Capnu", "link": "https://stackoverflow.com/users/6557791/eric-capnu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467845437, "creation_date": 1467842362, "question_id": 38234483, "link": "https://stackoverflow.com/questions/38234483/inserting-a-html-table-cell-into-a-excel-sheet-cell-with-no-id", "title": "inserting a HTML table cell into a excel sheet cell with no id", "body": "<p>i was trying to extract a cell from a HTML table into a excel cell by using a function. the table is like this:</p>\n\n<pre><code>                   |   1Q    |   2Q    |   3Q    |\n         income    |   23    |   34    |   22    |\n         expenses  |   11    |   19    |   10    |\n                                  .\n                                  .\n                                  .\n</code></pre>\n\n<p>i cannot get the elements by id, so i created two loops to look for element by element. the code can find the elements (in my case, the word \"expenses\" col1 row2) but i don't know how to get the cell value to the right (11 in this case)    </p>\n\n<pre><code>Dim IE As Object\nDim doc As Object\nDim colTR As Object\nDim colTD As Object\nDim tr As Object\nDim td As Object\nSet IE = CreateObject(\"InternetExplorer.Application\")\n\nIE.Visible = True\nIE.Navigate \"www.mywebpage.com\"\n\nDo Until IE.ReadyState = 4\n    DoEvents\nLoop\n\nSet doc = IE.Document\n\nSet colTR = doc.GetElementsByTagName(\"TR\")\nFor Each tr In colTR\n    Set colTD = tr.GetElementsByTagName(\"TD\")\n    For Each td In colTD\n        If td.innertext = \"expenses\" Then\n        TheValueIWant = tr.item(1).innertext\n        End If\n    Next td\nNext tr\n\nIE.Quit\n\nSet IE = Nothing\nSet doc = Nothing\nSet colTR = Nothing\nSet colTD = Nothing\nSet td = Nothing\nSet tr = Nothing\n</code></pre>\n\n<p>thanks in advance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1467842477, "post_id": 38234378, "comment_id": 63890644, "body": "What is <code>myAttachments</code> here ?  Do you mean <code>.Attachments.Add PdfFile</code>  ?"}, {"owner": {"reputation": 3, "user_id": 6558170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e38b301535830c6da6a1b57f8cb8a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Nils", "link": "https://stackoverflow.com/users/6558170/nils"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1467842890, "post_id": 38234378, "comment_id": 63890832, "body": "i thought myattachments is the command to attach a file and the filename of the pdf is in this case the pdffile"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1467853184, "post_id": 38234378, "comment_id": 63893718, "body": "Why does PDF name contains full workbook name? You might have meant <code>ActiveWorkbook.Path</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6558170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e38b301535830c6da6a1b57f8cb8a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Nils", "link": "https://stackoverflow.com/users/6558170/nils"}, "edited": false, "score": 0, "creation_date": 1467896755, "post_id": 38235153, "comment_id": 63913580, "body": "this was  the mistake now its working. Thank you alot"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1467845995, "creation_date": 1467845995, "answer_id": 38235153, "question_id": 38234378, "link": "https://stackoverflow.com/questions/38234378/object-required-error-for-attaching-a-file-to-an-e-mail/38235153#38235153", "title": "Object Required Error for attaching a file to an e-mail", "body": "<p><code>myAttachments</code> is not a collection in Outlook - looks like that may have come from some other code.</p>\n\n<p>Try:</p>\n\n<pre><code> .Attachments.Add PdfFile\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6558170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e38b301535830c6da6a1b57f8cb8a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Nils", "link": "https://stackoverflow.com/users/6558170/nils"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 555, "favorite_count": 0, "accepted_answer_id": 38235153, "answer_count": 1, "score": 0, "last_activity_date": 1467845995, "creation_date": 1467841819, "last_edit_date": 1467842145, "question_id": 38234378, "link": "https://stackoverflow.com/questions/38234378/object-required-error-for-attaching-a-file-to-an-e-mail", "title": "Object Required Error for attaching a file to an e-mail", "body": "<p>I am currently trying to develop an macro in excel vba to send a selected range attached to an e-mail. As my knowledge of vba is zero I have been browsing the internet and have been able to put this script together. Currently I get error of object required when i am trying to attach the file.</p>\n\n<p>Appreciate every help and feedback you guys can give me.</p>\n\n<pre><code>Sub AttachActiveSheetPDF()\nDim IsCreated As Boolean\nDim i As Long\nDim PdfFile As String, Title As String\nDim OutlApp As Object\n\nPdfFile = ActiveWorkbook.FullName\ni = InStrRev(PdfFile, \".\")\nIf i &gt; 1 Then PdfFile = Left(PdfFile, i - 1)\nPdfFile = PdfFile &amp; \"_\" &amp; ActiveSheet.Name &amp; \".pdf\"\n\nWith ActiveSheet.PageSetup\n.Orientation = xlPortrait\n.PrintArea = \"$A$1:$P$84\"\n.Zoom = False\n.FitToPagesTall = False\n.FitToPagesWide = 1\nEnd With\nWith ActiveSheet\n.ExportAsFixedFormat Type:=xlTypePDF, Filename:=PdfFile,       Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False,     OpenAfterPublish:=False\nEnd With\n\nOn Error Resume Next\nSet OutlApp = GetObject(, \"Outlook.Application\")\nIf Err Then\nSet OutlApp = CreateObject(\"Outlook.Application\")\nIsCreated = True\nEnd If\nOutlApp.Visible = True\nOn Error GoTo 0\n\nDim Ebody As String\nEbody = \"&lt;p&gt;Buenas Dias,&lt;/p&gt; &lt;p&gt;Adjunto es el documento.&lt;/p&gt;\"\n\nWith OutlApp.CreateItem(0)\n\n.Subject = Quotation_de_Aerolinea\n.To = \"...\"\n.CC = \"...\"\n.HTMLBody = Ebody\nmyAttachments.Add (PdfFile)\n\nOn Error Resume Next\n.Display\nApplication.Visible = True\nIf Err Then\n  MsgBox \"E-mail was not sent\", vbExclamation\nElse\n  MsgBox \"E-mail successfully sent\", vbInformation\nEnd If\nOn Error GoTo 0\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["excel", "vba", "sorting", "matching"], "answers": [{"tags": [], "owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "is_accepted": false, "score": 0, "last_activity_date": 1467846271, "creation_date": 1467846271, "answer_id": 38235195, "question_id": 38234330, "link": "https://stackoverflow.com/questions/38234330/sort-one-data-set-to-get-the-best-fit-with-another-data-set/38235195#38235195", "title": "Sort one data set to get the best fit with another data set", "body": "<p>I think there's a lot of thinking behind the answer to your question. Writing the code for this is a bit of a project, in my opinion.</p>\n\n<p>You could make your life a little easier by sorting columns A-C ascending by column C and sorting columns D-F ascending by column D.  If you're not working with a lot of employees, your answers will kind of fall out of that.  (In your sample data set, it becomes immediately clear that Name4 is paired with Name5 and Name1 or Name3 is paired with Name6.)</p>\n\n<p>It's not a complete answer, but maybe it's a start.</p>\n"}], "owner": {"reputation": 1, "user_id": 6558107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6683454e7f78b41831a9eaa96ff2a9f4?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/6558107/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467846271, "creation_date": 1467841617, "question_id": 38234330, "link": "https://stackoverflow.com/questions/38234330/sort-one-data-set-to-get-the-best-fit-with-another-data-set", "title": "Sort one data set to get the best fit with another data set", "body": "<p>I'm currently working on an Excel program to manage employees at the checkout counters at a larger supermarket. It will load the employees' work schedules from an online database and then place the employees at the different counters.</p>\n\n<p>Currently I'm at a point where I have loaded the schedules and divided the employees into the day shift and the evening shift in a sheet looking like this (only with much more people in reality):</p>\n\n<pre><code>   A     B    C      D     E    F\n1  Name1 0745 1615   Name5 1515 2130\n2  Name2 0830 1600   Name6 1600 2230\n3  Name3 0915 1615   Name7 1630 2230\n4  Name4 1000 1530\n</code></pre>\n\n<p>where <code>0745</code> is 7:45 and <code>1615</code> is 16:15 (4:15 PM)</p>\n\n<p>Now, I would like to match a person from the day shift with a person from the evening shift so that ideally there will be a 15 minute overlap between all of them. As in the example above it is not necessarily given that there are equally as many people in the day and the evening shift, neither it will not necessarily be given that there can be an overlap of exactly 15 minutes between all teams of two. In this case, an overlap of 30 minutes is better than an overlap of 0 minutes for instance.</p>\n\n<p>My own idea is to try all possible combinations of matches between the two data sets and then assign different error values to the different kinds of overlaps so for instance an overlap of 15 minutes yields a value of 0, 30 minutes yields 1, and 0 minutes yields 2, and then the best match is the one with the smallest total error.</p>\n\n<p>However, I have no idea how to program this in VBA or if this is even the best approach.</p>\n\n<p>I have tried searching the forum, but I didn't find anything helpful unfortunately. I hope one of you can help me or have an idea where I can search.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1467840729, "post_id": 38234063, "comment_id": 63889873, "body": "Instead of a global variable, look up <a href=\"https://msdn.microsoft.com/en-us/library/aa263527(v=vs.60).aspx\" rel=\"nofollow noreferrer\">passing an argument</a>, which will save some space and is good practice I believe, over Global Variables."}, {"owner": {"reputation": 496, "user_id": 3470887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ya1pz.jpg?s=128&g=1", "display_name": "Schwagmister", "link": "https://stackoverflow.com/users/3470887/schwagmister"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1467841000, "post_id": 38234063, "comment_id": 63889975, "body": "@BruceWayne where would the value be stored so I can access it at another time such as if another even occurs at some other point in time?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1467841112, "post_id": 38234063, "comment_id": 63890030, "body": "@Schwagmister - store it in a reference worksheet or on any worksheet will you will not have any other data."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 1, "creation_date": 1467841642, "post_id": 38234063, "comment_id": 63890275, "body": "If a method doesn&#39;t return a value than you should be a <code>Sub</code> instead of <code>Function</code>.  Target is always a valid range reference and will never be nothing in a worksheet event."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1467841917, "last_edit_date": 1467841917, "creation_date": 1467841395, "answer_id": 38234276, "question_id": 38234063, "link": "https://stackoverflow.com/questions/38234063/update-cell-with-location-of-last-edited-cell-excel-vb-error-28-out-of-stack/38234276#38234276", "title": "Update Cell With Location of Last Edited Cell - Excel VB Error 28 &quot;Out of stack space&quot;", "body": "<p>You are getting the out of stack space error because you are re-triggering the <code>Worksheet_Change</code> event when you change the value of Range(\"A23\") cuasing an indefinite loop. You need to toggle <code>EnableEvents</code> to break the chain. <br></p>\n\n<p>This should replace all your code.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Application.EnableEvents = False\n\n    Range(\"A23\").Value = Target.address(False, False)\n\n    Application.EnableEvents = True\nEnd Sub \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 496, "user_id": 3470887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ya1pz.jpg?s=128&g=1", "display_name": "Schwagmister", "link": "https://stackoverflow.com/users/3470887/schwagmister"}, "is_accepted": false, "score": 0, "last_activity_date": 1467842124, "creation_date": 1467842124, "answer_id": 38234434, "question_id": 38234063, "link": "https://stackoverflow.com/questions/38234063/update-cell-with-location-of-last-edited-cell-excel-vb-error-28-out-of-stack/38234434#38234434", "title": "Update Cell With Location of Last Edited Cell - Excel VB Error 28 &quot;Out of stack space&quot;", "body": "<p>Thank you Thomas, your code does exactly what I wanted the outcome to be. I just need to look into Scott's recommendation about storing variables in a reference sheet which I can access later.</p>\n\n<p>I guess a parting question is, is there a way to do this without someone actually seeing the reference sheet show up?</p>\n\n<p>Thanks for everyone's input I appreciate it!</p>\n\n<p>To answer the original question, I used Thomas's code exactly.</p>\n"}], "owner": {"reputation": 496, "user_id": 3470887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ya1pz.jpg?s=128&g=1", "display_name": "Schwagmister", "link": "https://stackoverflow.com/users/3470887/schwagmister"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 805, "favorite_count": 0, "accepted_answer_id": 38234276, "answer_count": 2, "score": 0, "last_activity_date": 1467842124, "creation_date": 1467840466, "last_edit_date": 1467840527, "question_id": 38234063, "link": "https://stackoverflow.com/questions/38234063/update-cell-with-location-of-last-edited-cell-excel-vb-error-28-out-of-stack", "title": "Update Cell With Location of Last Edited Cell - Excel VB Error 28 &quot;Out of stack space&quot;", "body": "<p>I am trying to essentially get one specific cell to update with the address of the most recently edited cell. I am running into the out of stack space error and I am not sure why. I'm guessing maybe a call isnt finishing and so it just fills the stack with each call?</p>\n\n<p>I have the following code:</p>\n\n<p>Worksheet Code</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Call Module1.last_changed(Target)\n\nEnd Sub\n</code></pre>\n\n<p>Module Code</p>\n\n<pre><code>Public LASTCHANGED As Range\n\nPublic Function last_changed(changedCell As Range)\n\n    If LASTCHANGED Is Nothing Then\n        Set LASTCHANGED = changedCell\n    Else\n        LASTCHANGED = changedCell\n    End If\n\n    Call last_changed_address\n\nEnd Function\n\n\nPublic Function last_changed_address()\n\n    Dim address As Variant\n    address = Split(LASTCHANGED.address, \"$\")\n    Sheet1.Range(\"A23\").Value = address(1) + address(2)\n\nEnd Function\n</code></pre>\n\n<p>I also have a global variable which will hold the location of the last edited cell. If there is a better way of doing this than a global variable I am open to discussion. Thanks!</p>\n"}, {"tags": ["sql-server", "ms-access", "recursion", "vba"], "comments": [{"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 1, "creation_date": 1467839095, "post_id": 38233704, "comment_id": 63889128, "body": "Does your data still reside in sql server? If so, you could easily create a procedure which containst the recursive cte and receives any parameters needed for filtering and such. If the data actually resides in Access well...recursive ctes are not going to work."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "reply_to_user": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1467840192, "post_id": 38233704, "comment_id": 63889653, "body": "like @SeanLange says, you can either create a view in SQL Server and link to that in Access, use a pass-through query in Access (which will save the query in Access but execute the T-SQL in SQL server) or use a stored procedure and call that via ADO to get your data into a recordset."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1467874347, "post_id": 38233704, "comment_id": 63899177, "body": "Steve, it sounds like you will have no access til SQL Server. Thus, you will have to use VBA. This can run quite fast, in fact if you can copy data to a local table, extremely fast."}, {"owner": {"reputation": 273, "user_id": 6490191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/892b65d788a19cd018c74394494fc302?s=128&d=identicon&r=PG&f=1", "display_name": "Steve W", "link": "https://stackoverflow.com/users/6490191/steve-w"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1467909085, "post_id": 38233704, "comment_id": 63922506, "body": "I guess some additional details would have been helpful.  Access is my front end application with SQL Server 2014 as my back end.  All my tables are linked via a DNS-Less connection, which seems to be the root of my problem in this scenario.  Thank you @Brad for the pass-thru recommendation.  I incorporated a pass-thru query into the application and it&#39;s working well so far."}], "owner": {"reputation": 273, "user_id": 6490191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/892b65d788a19cd018c74394494fc302?s=128&d=identicon&r=PG&f=1", "display_name": "Steve W", "link": "https://stackoverflow.com/users/6490191/steve-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 969, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1594641804, "creation_date": 1467838870, "last_edit_date": 1594641804, "question_id": 38233704, "link": "https://stackoverflow.com/questions/38233704/getting-a-recursive-query-to-work-in-access-2013", "title": "Getting a Recursive Query to work in Access 2013", "body": "<p>After a day's worth of research, I thought I was just at the finish line with my problem.  I got myself all schooled up on recursive queries and managed to get it to execute beautifully in SQL Server Management Studio 2014.  However, I was immediately shot down when translating the query I wrote in SQL Server 2014 into my Access 2013 application.  Reading other articles, I now understand that Access does not support recursive queries.  With that, I need help finding a resource-efficient way to pull these records and put them into an array variable.  My past efforts in emulating this in VBA were horrific; resulting in 30-60 seconds to process.  Any advise on how to lean this process out would be greatly appreciated.</p>\n\n<p>The recursive query I would like to emulate is:</p>\n\n<pre><code>WITH MyCTE(BusinessUnitID, Active)\nAS(\n\nSELECT a.BusinessUnitID, a.Active\nFROM t_EMS_BM_BusinessUnits AS a\nWHERE BusinessUnitID = 7\n\nUNION ALL\n\nSELECT d.BusinessUnitID, d.Active\nFROM MyCTE AS c\nINNER JOIN t_EMS_BM_BusinessUnits AS d\nON c.BusinessUnitID = d.ParentUnit)\n\nSELECT *\nFROM MyCTE\nWHERE Active = 1\n</code></pre>\n\n<p>My atrocious VBA script is:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub LoadArray(intBU As Integer)\n    'set rollup data for business unit by adding all child units to intBUs array\n    Dim sql As String\n    Dim rs As Recordset\n    Dim intCount As Integer\n\n    sql = \"SELECT BusinessUnitID, ParentUnit FROM t_EMS_BM_BusinessUnits WHERE Active = true ORDER BY BusinessUnitID\"\n    Set rs = currentdb.OpenRecordset(sql, dbOpenDynaset, dbSeeChanges)\n\n    'look for child units\n    With rs\n\n        intCount = 0\n        ReDim intBUs(1 To 1) As Integer\n\n        If Not .EOF And Not .BOF Then\n            .MoveLast\n            .MoveFirst\n\n            Do While Not .EOF\n\n                If IsChild(intBU, !BusinessUnitID) = True Then\n                    'add to array\n                    intCount = intCount + 1\n\n                    If intCount &gt; 1 Then\n                        ReDim Preserve intBUs(1 To UBound(intBUs) + 1) As Integer\n                        intBUs(UBound(intBUs)) = !BusinessUnitID\n                    ElseIf intCount = 1 Then\n                        intBUs(UBound(intBUs)) = !BusinessUnitID\n                    End If\n\n                End If\n\n                .MoveNext\n            Loop\n        End If\n        .Close\n    End With\n\n    Set rs = Nothing\n\nPrivate Function IsChild(TargetBU, CurrentBU As Integer) As Boolean\n    'check if unit is lowest level child\n    'is TargetBU a child of CurrentBU?\n\n    Dim intX As Integer\n    Dim intCount As Integer\n\n    intX = 0\n\n    If TargetBU = CurrentBU Then\n        'return a value of true\n        IsChild = True\n    Else\n\n        Do Until intX = -1\n            'find bottom level of heiarchy\n\n            intCount = DCount(\"BusinessUnitID\", \"t_EMS_BM_BusinessUnits\", \"ParentUnit=\" &amp; CurrentBU)\n            If intCount = 0 Then\n                intX = -1\n            Else\n                CurrentBU = DLookup(\"BusinessUnitID\", \"t_EMS_BM_BusinessUnits\", \"ParentUnit=\" &amp; CurrentBU)\n                intX = 0\n            End If\n        Loop\n\n        'reset sentinal value\n        intX = 0\n\n        Do Until intX = -1\n            'tree up until the record matches the TargetBU or reaches the top \"0\"\n            If CurrentBU = TargetBU Or CurrentBU = 0 Then\n                IsChild = True\n                intX = -1\n            Else\n                'move up to the next level\n                CurrentBU = Nz(DLookup(\"ParentUnit\", \"t_EMS_BM_BusinessUnits\", \"BusinessUnitID = \" &amp; CurrentBU), 0)\n                IsChild = False\n                intX = 0\n            End If\n        Loop\n\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "recordset", "subform"], "comments": [{"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 2, "creation_date": 1467840026, "post_id": 38233684, "comment_id": 63889577, "body": "look at the <code>AfterUpdate</code> event on your subform. It will fire after a user makes a change to a record. You can then use that record reference to do whatever."}], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 6341393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28daedb34b89b1d081e84d57b7583fa1?s=128&d=identicon&r=PG&f=1", "display_name": "webdev", "link": "https://stackoverflow.com/users/6341393/webdev"}, "is_accepted": false, "score": 0, "last_activity_date": 1467901426, "creation_date": 1467901426, "answer_id": 38247982, "question_id": 38233684, "link": "https://stackoverflow.com/questions/38233684/easiest-way-to-check-if-continuous-subform-recordset-was-changed-by-the-user/38247982#38247982", "title": "Easiest way to check if continuous subform recordset was changed by the user?", "body": "<p>You can use Form.Dirty to checkif something was changed....</p>\n\n<p>I have a similiar situation  and i solved this way... </p>\n\n<p>1 - When i open a form with a subform...</p>\n\n<p>2 - Create a clone recordset of original records of subforms  </p>\n\n<p>3- And then check if user change or not something in the form or in subform using [dirty].</p>\n\n<p>4 - If something was changed and dirty was true in the form or subform you can disabled buttons (next, new...) from main form and only permit save and undo changes actions</p>\n\n<p>5 - if user saves, we just update records in main table and recreate the clone recordset with new values</p>\n\n<p>6 - if user click UNDO button, then we make compare and copy the records from clone recordset/table to original table</p>\n\n<h2>I think you can find a working sample using DAO here: <a href=\"https://support.microsoft.com/en-us/kb/131535\" rel=\"nofollow\">https://support.microsoft.com/en-us/kb/131535</a></h2>\n\n<p>heres a simple function code you can use to copy all records from subform to another temporary table/recorset (eg:TDetPedTemp) and then reverting the process copy back to original if necessary;</p>\n\n<pre><code>// copy actual subforms records to a temporary new table/recordset\nDim cnn As New ADODB.Connection\nDim rs As ADODB.Recordset\nDim rs2 As ADODB.Recordset\n\nSet cnn = CurrentProject.Connection\nSet rs = New ADODB.Recordset\nSet rs2 = New ADODB.Recordset\n\n'open main recordset (TDetPed)\nrs.Open \"SELECT TDetPed.* FROM TDetPed WHERE CodPed = \" &amp; CodPed &amp; \"\", cnn, adOpenKeyset, adLockOptimistic\n\n\n'open clone table recordset (TDetPedTemp)\nrs2.Open \"TDetPedTemp\", cnn, adOpenKeyset, adLockOptimistic\n\n'move to first record of main table\nrs.MoveFirst\n\n'add record by record in clone table(rs2) from maintable(rs)\nDo Until rs.EOF\nrs2.AddNew\nrs2(\"CodPed\") = rs(\"CodPed\")\nrs2(\"CodDetPed\") = rs(\"CodDetPed\")\nrs2(\"CodInterno\") = rs(\"CodInterno\")\nrs2(\"DescrDetPed\") = rs(\"DescrDetPed\")\nrs2(\"DescontoDetPed\") = rs(\"DescontoDetPed\")\nrs2(\"CodProd\") = rs(\"CodProd\")\nrs2(\"Pre\u00e7oDetPed\") = rs(\"Pre\u00e7oDetPed\")\nrs2(\"QtdeDetPed\") = rs(\"QtdeDetPed\")\n\n'update current added record in clone table\nrs2.Update\n\n'move to next record in main table\nrs.MoveNext\n'Move para o proximo registro do detalhe do pedido\nLoop\n\n'close everthing\nrs.Close\nrs2.Close\ncnn.Close\n'clean everthing\nSet rs = Nothing\nSet rs2 = Nothing\nSet cnn = Nothing\n</code></pre>\n\n<p>And to undo the changes the code was the same, just the sources order is diferent. WE just need to first delete the original records from table (eg:TDetPed) and then copy temporary new records (eg: TDetPedTemp) to original recorset </p>\n\n<pre><code>'del original files\ncnn.Execute \"Delete * FROM TDetPed WHERE CodPed = \" &amp; CodPed &amp; \"\"\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2363207"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 817, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467901426, "creation_date": 1467838760, "question_id": 38233684, "link": "https://stackoverflow.com/questions/38233684/easiest-way-to-check-if-continuous-subform-recordset-was-changed-by-the-user", "title": "Easiest way to check if continuous subform recordset was changed by the user?", "body": "<p>I am creating a Microsoft Access 2010 application that records errors made in a separate workflow system. The user enters a workflow number, clicks search, and a continuous subform appears below with as many rows as there are people who have touched that workflow in the other system. The continuous subform is also populated with rows for errors that were previously logged. </p>\n\n<p>The user then checkmarks a box on each of those rows to indicate that those particular people made an error. The user then enters a description of the error, etc. </p>\n\n<p>If the user interacts with a previously logged error row, I want to know it so that I can go back and update/delete that previous error. </p>\n\n<p>I'm able to use VBA to retrieve the RecordSet of the continuous subform. However, I don't see a property/method on that subform recordset that would allow me to check to see if the user actually touched one of the fields on that row of the continuous subform. </p>\n\n<p>Other than comparing the row in the subform recordset with the row in the database field by field to see if something changed, is there a way in VBA to just check to see if a row on a subform recordset was changed after being presented to the user?</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1467838635, "post_id": 38233310, "comment_id": 63888879, "body": "So the code to close the workbooks is in the first workbook? In your  Sub CloseAll() code the first workbook is the one that&#39;s closed first!! Therefore none of the code beyond wb1.Close will run."}, {"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 4, "creation_date": 1467838937, "post_id": 38233310, "comment_id": 63889036, "body": "I would strongly recommend not doing it in this &quot;chain reaction&quot; method. Put all the code in a single workbook (whether Book 1 or even a separate master code workbook), and then open &amp; close your other workbooks from the master."}, {"owner": {"reputation": 1, "user_id": 5910548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90c3b6ae0705b5ffe65233090819c01a?s=128&d=identicon&r=PG&f=1", "display_name": "Mateusz", "link": "https://stackoverflow.com/users/5910548/mateusz"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1467841378, "post_id": 38233310, "comment_id": 63890155, "body": "@Absinthe, no it&#39;s not in the wb1, there are 6 files in total. The CloseAll() is located in the &quot;refresh_tool.xlsm&quot;, which is, lets say, file wb0."}, {"owner": {"reputation": 1, "user_id": 5910548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90c3b6ae0705b5ffe65233090819c01a?s=128&d=identicon&r=PG&f=1", "display_name": "Mateusz", "link": "https://stackoverflow.com/users/5910548/mateusz"}, "reply_to_user": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1467841381, "post_id": 38233310, "comment_id": 63890157, "body": "@ChrisMelville wb2 updates based on wb1. I did try to consolidate the code under one master file, but it wouldn&#39;t work properly. Anyways, I will be possibly working on that in future, but now it&#39;s just fine. What I am after is the CloseAll() working as it should.  Morever, the CloseAll() is indeed located in the master. But CloseAll has to run when job in wb5 is done, so it&#39;s initiaded from wb5&#39;s code (as presented)."}], "answers": [{"tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": false, "score": 1, "last_activity_date": 1468259475, "last_edit_date": 1468259475, "creation_date": 1467843306, "answer_id": 38234688, "question_id": 38233310, "link": "https://stackoverflow.com/questions/38233310/excel-vba-macro-accross-workbooks-not-fully-executed/38234688#38234688", "title": "Excel VBA macro accross workbooks not fully executed", "body": "<p>This isn't going to work.  You need to do as the other users have suggested.  </p>\n\n<p>What is happening is this (condensed to only 3 workbooks):</p>\n\n<p>i) Run Macro from refresh_tool to open wb1</p>\n\n<p>ii) wb1 Opens (in thread for refresh_tool macro)</p>\n\n<p>iii) Run Macro from wb1 (in thread for refresh_tool macro)</p>\n\n<p>iv) Macro from wb1 is running (in thread for wb1 which is in thread for refresh_tool)</p>\n\n<p>v) wb2 Opens (in thread for wb1 which is in thread for refresh_tool)</p>\n\n<p>vi) Run Macro from wb2 (in thread for wb1 macro which is in thread for refresh_tool)</p>\n\n<p>vii) Macro from wb2 calls Close macro in refresh_tool (in thread for wb2 which is in thread for wb1 which is in thread for refresh_tool)</p>\n\n<p>viii) Close macro from refresh_tool starts running (in thread for wb2 which is in thread for wb1 which is in original thread for refresh_tool)</p>\n\n<p>ix) Close macro from refresh_tool closes wb1 </p>\n\n<p>THIS IS THE PROBLEM!!!!!!  This closes the thread for wb1, which ends the running of the close macro in the refresh tool.  So, it never gets past the first close.  Even if you reordered how the workbooks were closed, the close macro would be running in the threads for ALL of the workbooks at this point.  Whichever one you close ends the thread for that workbook, which ends the Close macro.  </p>\n\n<p>You need to do what was suggested in the comments and run all the code from one master.  Alternatively (and I would recommend the other way), close each workbook at the end of each macro within the workbook if you feel you really must chain these:</p>\n\n<p>In wb1:</p>\n\n<pre><code>Public Sub openFileandRun()\n\nDim wb As Workbook\n\nSet wb = Workbooks.Open(\"filepath\\wb2.xlsm\")\nApplication.Run (wb.Name &amp; \"!openModule.openFileandRun\")\nThisworkbook.Close SaveChanges:=False\n\nEnd Sub\n</code></pre>\n\n<p>In wb2:</p>\n\n<pre><code>Public Sub openFileandRun()\n\nDim wb As Workbook\n\nSet wb = Workbooks.Open(\"filepath\\wb3.xlsm\")\nApplication.Run (wb.Name &amp; \"!openModule.openFileandRun\")\nThisworkbook.Close SaveChanges:=False\n\nEnd Sub\n</code></pre>\n\n<p>Etc.</p>\n\n<p>Obviously, fix the names of the modules and subroutines to match yours.</p>\n\n<p><strong><em>EDIT</em></strong></p>\n\n<p>Alternatively, you could just call \"Close_All\" from the original master file.  Just do the call after the first opening of the code:</p>\n\n<pre><code>Public Sub masterRun()\n\nDim wb As Workbook\n\nSet wb = Workbooks.Open(\"filepath\\wb1.xlsm\")\n'Do whatever you are doing to wb1.\n\nCall CloseAll\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5910548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90c3b6ae0705b5ffe65233090819c01a?s=128&d=identicon&r=PG&f=1", "display_name": "Mateusz", "link": "https://stackoverflow.com/users/5910548/mateusz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1468259475, "creation_date": 1467837321, "last_edit_date": 1467842396, "question_id": 38233310, "link": "https://stackoverflow.com/questions/38233310/excel-vba-macro-accross-workbooks-not-fully-executed", "title": "Excel VBA macro accross workbooks not fully executed", "body": "<p>I have 6 files that execute macros each after another. The 1st file with VBA code (master file) opens remaining 5 files and initiates VBA chain reaction. The 2nd file does the macro job and initiates job of the 3rd file and it goes until 6th file. </p>\n\n<p>The 6th file then refers to the 1st file's macro (master), which is supposed to close all 5 workbooks (apart from this 1stone). The code of 6th workbook looks like this:</p>\n\n<pre><code>Application.DisplayAlerts = False\n\nThisWorkbook.RefreshAll\nWorkbooks(\"6th_file.xlsm\").SaveAs Filename:= _\n\"[URL]6th_file_htm.htm\" \n\nApplication.Run (\"refresh_tool.xlsm!CloseAll.CloseAll\")\n</code></pre>\n\n<p>Then it goes to:</p>\n\n<pre><code>Option Explicit\n\nSub CloseAll()\n\nDim wb1 As Workbook\nDim wb2 As Workbook\nDim wb3 As Workbook\nDim wb4 As Workbook\nDim wb5 As Workbook\n\nSet wb1 = Workbooks(\"wb1.xlsm\")\nSet wb2 = Workbooks(\"wb2.xlsm\")\nSet wb3 = Workbooks(\"wb3.xlsm\")\nSet wb4 = Workbooks(\"wb4.xlsm\")\nSet wb5 = Workbooks(\"wb5.xlsm\")\n\nwb1.Close\nwb2.Close\nwb3.Close\nwb4.Close\nwb5.Close\n</code></pre>\n\n<p>The result is that when run in that chain only the first workbook is closed (refresh_tool, wb2, wb3, wb4 and wb5 remain open).</p>\n\n<p>However, when the CloseAll() is run alone - it works properly and closes all 5 files (only refresh_tool remains open).</p>\n\n<p>I tried make it simple at first with Workbooks(\"...\").Close, but tried several things already, ending up with the code above.</p>\n\n<p>Can anyone help please?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 189, "user_id": 5281456, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1690f4f5941090f0e60f71164b277337?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay billa", "link": "https://stackoverflow.com/users/5281456/vinay-billa"}, "edited": false, "score": 0, "creation_date": 1467836915, "post_id": 38233171, "comment_id": 63888020, "body": "Also is there any way I can make integer appear with one decimal point . For example, 50 should be 50.0"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1467837304, "post_id": 38233171, "comment_id": 63888229, "body": "For the first question look at the textbox&#39;s <code>Change</code> event and look at the various properties of the control.  For the second, look at the <code>Format</code> command..."}, {"owner": {"reputation": 189, "user_id": 5281456, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1690f4f5941090f0e60f71164b277337?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay billa", "link": "https://stackoverflow.com/users/5281456/vinay-billa"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1467844002, "post_id": 38233171, "comment_id": 63891226, "body": "Dave- I used format command but it gives out 2 decimal points"}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 5281456, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1690f4f5941090f0e60f71164b277337?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay billa", "link": "https://stackoverflow.com/users/5281456/vinay-billa"}, "edited": false, "score": 0, "creation_date": 1467842779, "post_id": 38233378, "comment_id": 63890796, "body": "Hi Jim , If I do what you said the color initially is red and it doesnt change"}, {"owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "reply_to_user": {"reputation": 189, "user_id": 5281456, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1690f4f5941090f0e60f71164b277337?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay billa", "link": "https://stackoverflow.com/users/5281456/vinay-billa"}, "edited": false, "score": 0, "creation_date": 1467847531, "post_id": 38233378, "comment_id": 63892305, "body": "Right, you would have to change it back using the same mechanism. If you tell me how you want the color to toggle I can walk you through it."}, {"owner": {"reputation": 189, "user_id": 5281456, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1690f4f5941090f0e60f71164b277337?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay billa", "link": "https://stackoverflow.com/users/5281456/vinay-billa"}, "edited": false, "score": 0, "creation_date": 1467849557, "post_id": 38233378, "comment_id": 63892859, "body": "OK.. the initial color must be white when the default value is present (say 5 ) and when a user manually changes the value ( to 6 or 4 or 5.6 etc), then the color must change to red"}, {"owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "reply_to_user": {"reputation": 189, "user_id": 5281456, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1690f4f5941090f0e60f71164b277337?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay billa", "link": "https://stackoverflow.com/users/5281456/vinay-billa"}, "edited": false, "score": 0, "creation_date": 1467850442, "post_id": 38233378, "comment_id": 63893090, "body": "Okay, give the supplements to my answer a look over and see if that helps. I&#39;ll keep checking in, so feel free to post followups."}, {"owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "reply_to_user": {"reputation": 189, "user_id": 5281456, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1690f4f5941090f0e60f71164b277337?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay billa", "link": "https://stackoverflow.com/users/5281456/vinay-billa"}, "edited": false, "score": 0, "creation_date": 1467899453, "post_id": 38233378, "comment_id": 63915663, "body": "@Vinay billa, Glad to here it! If this or any answer has solved your question please consider <a href=\"http://meta.stackexchange.com/q/5234/179419\">accepting it</a> by clicking the check-mark. This indicates to the wider community that you&#39;ve found a solution and gives some reputation to both the answerer and yourself. There is no obligation to do this."}], "tags": [], "owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "is_accepted": true, "score": 1, "last_activity_date": 1467850340, "last_edit_date": 1467850340, "creation_date": 1467837539, "answer_id": 38233378, "question_id": 38233171, "link": "https://stackoverflow.com/questions/38233171/how-do-i-change-the-background-color-of-a-text-box-based-on-the-value-in-it-in-v/38233378#38233378", "title": "How do I change the background color of a text box based on the value in it in vba?", "body": "<p>Vinay, You would do that like this:</p>\n\n<pre><code>Private Sub TextBox1_Change()\n   TextBox1.BackColor = RGB(255, 0, 0)\nEnd Sub\n</code></pre>\n\n<p>You'll want to put that in the <code>TextBox1</code> object (double clicking it will get you there). The color change will be triggered when the value of the text box is changed. If I've understudy your question correctly, this should solve your problem. If not, please let me know.</p>\n\n<p><strong>SUPPLEMENT : A breakdown of the code</strong></p>\n\n<p><code>Private Sub TextBox1_Change()</code> is an event handler. The code inside will run whenever a particular event occurs. In this case, whenever the text inside the TextBox1 changes.\n<code>TextBox1.BackColor = RGB(255, 0, 0)</code> </p>\n\n<p><code>TextBox1</code> is an object, in this case it is your first texbox which is by default named \"TextBox1\", but we could use any other object in your form, \"TextBox2\", \"Button1\" etc...</p>\n\n<p><code>.BackColor</code> is a property of <code>TextBox1</code> (its Back Color). We could set the <code>BackColor</code> property to any valid color, but here I went with red.</p>\n\n<p><code>RGB</code> stands for Red Green Blue. In this case we set the back of the <code>TextBox</code> to a color equil to 255 (All Red), 0 (with no Green), and 0 (No Blue).</p>\n\n<p><strong>SUPPLEMENT 2</strong>\nSo, based on your last comment, you would be looking to do something like this:</p>\n\n<pre><code>Private Sub TextBox1_Change()\n    If TextBox1.Text = \"5\" Then\n        TextBox1.BackColor = RGB(255, 255, 255)\n    ElseIf TextBox1.Text = \"6\" Or TextBox1.Text = \"4\" Or TextBox1.Text = \"5.6\" Then\n        TextBox1.BackColor = RGB(255, 0, 0)\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 447, "user_id": 6476653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q4kG8.jpg?s=128&g=1", "display_name": "Benno Grimm", "link": "https://stackoverflow.com/users/6476653/benno-grimm"}, "is_accepted": false, "score": 2, "last_activity_date": 1467864784, "last_edit_date": 1467864784, "creation_date": 1467837814, "answer_id": 38233452, "question_id": 38233171, "link": "https://stackoverflow.com/questions/38233171/how-do-i-change-the-background-color-of-a-text-box-based-on-the-value-in-it-in-v/38233452#38233452", "title": "How do I change the background color of a text box based on the value in it in vba?", "body": "<p>When you click on the CommandButton:</p>\n\n<pre><code>TextBox1.Backcolor = 'something (example: &amp;H000000FF&amp;)\n</code></pre>\n\n<p>If the content of the TextBox is changed, use:</p>\n\n<pre><code>Private Sub TextBox1_Change()\n   'Change the color\n   'Just an example:\n\n   If TextBox1.Text = \"Hello\" then\n      TextBox1.Backcolor = &amp;H0000C000&amp;\n   Else \n      TextBox1.Backcolor = &amp;H000000FF&amp;\n   End If\n\nEnd Sub\n</code></pre>\n\n<p>The .0 thing:</p>\n\n<pre><code>Label1.Caption = Ineteger &amp; \".0\"\n</code></pre>\n\n<p>You really don't need to round or anything, because you have Integers.</p>\n"}], "owner": {"reputation": 189, "user_id": 5281456, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1690f4f5941090f0e60f71164b277337?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay billa", "link": "https://stackoverflow.com/users/5281456/vinay-billa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24270, "favorite_count": 1, "accepted_answer_id": 38233378, "answer_count": 2, "score": 0, "last_activity_date": 1467864784, "creation_date": 1467836845, "last_edit_date": 1531164843, "question_id": 38233171, "link": "https://stackoverflow.com/questions/38233171/how-do-i-change-the-background-color-of-a-text-box-based-on-the-value-in-it-in-v", "title": "How do I change the background color of a text box based on the value in it in vba?", "body": "<p>So I have 2 textboxes A and B which by a commandbutton click gets populated automatically. </p>\n\n<p>How do I change the background color of the textboxes when the values in them change ( If a user changes the values in them manually) ? </p>\n\n<p>Thanks a lot! </p>\n"}, {"tags": ["vba", "concatenation", "formula"], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 31, "user_id": 6471090, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a35ed29ae469ea6d5176f2578dc3e04?s=128&d=identicon&r=PG&f=1", "display_name": "mdmlll", "link": "https://stackoverflow.com/users/6471090/mdmlll"}, "edited": false, "score": 0, "creation_date": 1467837383, "post_id": 38233255, "comment_id": 63888269, "body": "@Audrey please come back in a few minutes and mark correct."}, {"owner": {"reputation": 31, "user_id": 6471090, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a35ed29ae469ea6d5176f2578dc3e04?s=128&d=identicon&r=PG&f=1", "display_name": "mdmlll", "link": "https://stackoverflow.com/users/6471090/mdmlll"}, "edited": false, "score": 0, "creation_date": 1467838004, "post_id": 38233255, "comment_id": 63888570, "body": "how about this?       Range(&quot;C2:&quot; &amp; &quot;C&quot; &amp; lastRow).FormulaR1C1 = &quot;=COUNTIF(A:A,RC[-2])&quot;    apparently A:A is wrong"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1467837112, "creation_date": 1467837112, "answer_id": 38233255, "question_id": 38233165, "link": "https://stackoverflow.com/questions/38233165/vba-formular1c1-concatenate-from-different-columns-with-function/38233255#38233255", "title": "vba formulaR1C1 concatenate from different columns with function", "body": "<p>Your <code>\"\"</code> need to be <code>\"\"\"\"</code></p>\n\n<pre><code>Range(\"A2:\" &amp; \"A\" &amp; 3).FormulaR1C1 = \"=CONCATENATE(RC[6],RC[7],RC[9],RC[10],RC[11],ROUND(RC[12],0),IF(RC[13]=\"\"\"\",0,RC[13]),ROUND(RC[14],2),YEAR(RC[15]),MONTH(RC[15]),DAY(RC[15]))\"\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6471090, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a35ed29ae469ea6d5176f2578dc3e04?s=128&d=identicon&r=PG&f=1", "display_name": "mdmlll", "link": "https://stackoverflow.com/users/6471090/mdmlll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 489, "favorite_count": 0, "accepted_answer_id": 38233255, "answer_count": 1, "score": 0, "last_activity_date": 1467837112, "creation_date": 1467836827, "last_edit_date": 1467836864, "question_id": 38233165, "link": "https://stackoverflow.com/questions/38233165/vba-formular1c1-concatenate-from-different-columns-with-function", "title": "vba formulaR1C1 concatenate from different columns with function", "body": "<p>I'm getting error for the following code: Application-defined or object-defined error.</p>\n\n<p>How do I fix this?</p>\n\n<p>p.s. lastRow is a number </p>\n\n<pre><code>Range(\"A2:\" &amp; \"A\" &amp; lastRow).FormulaR1C1 = \"=CONCATENATE(RC[6],RC[7],RC[9],RC[10],RC[11],ROUND(RC[12],0),IF(RC[13]=\"\",0,RC[13]),ROUND(RC[14],2),YEAR(RC[15]),MONTH(RC[15]),DAY(RC[15]))\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1467836633, "post_id": 38233105, "comment_id": 63887854, "body": "Try <code>Call Module1.Check(i)</code>"}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1467836811, "post_id": 38233105, "comment_id": 63887957, "body": "When you call Call Check(i) in Sub UserForm_Initialize() where does i come from? Is there more code than you&#39;ve posted?"}, {"owner": {"reputation": 3, "user_id": 6557919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e076f0c6d11cef4f065a02a8cffb6c7?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/6557919/john"}, "edited": false, "score": 0, "creation_date": 1467836825, "post_id": 38233105, "comment_id": 63887967, "body": "I have tried that previously then there is another error &quot;Method or data member not found&quot;"}, {"owner": {"reputation": 3, "user_id": 6557919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e076f0c6d11cef4f065a02a8cffb6c7?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/6557919/john"}, "edited": false, "score": 0, "creation_date": 1467836902, "post_id": 38233105, "comment_id": 63888013, "body": "yeah i is just a public variable which set to equal to 24"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1467837434, "post_id": 38233105, "comment_id": 63888293, "body": "Drop the <code>Call</code> and just have <code>Module1.Check i</code> - you won&#39;t need the parenthesis anyway"}, {"owner": {"reputation": 3, "user_id": 6557919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e076f0c6d11cef4f065a02a8cffb6c7?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/6557919/john"}, "edited": false, "score": 0, "creation_date": 1467839485, "post_id": 38233105, "comment_id": 63889329, "body": "now I got this &quot;Run time error 424 Object Required&quot; error"}], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1467867882, "post_id": 38233557, "comment_id": 63896746, "body": "Short, nice and clean"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1467838193, "creation_date": 1467838193, "answer_id": 38233557, "question_id": 38233105, "link": "https://stackoverflow.com/questions/38233105/calling-public-subroutine-in-userform-excel-vba/38233557#38233557", "title": "Calling Public Subroutine in userform Excel VBA", "body": "<p>Not intended as an answer to your current problem. Just a suggestion:</p>\n\n<pre><code>Public Sub Check(j As Integer)   \n    Dim v\n    v = Worksheets(\"VBA\").Cells(j, 19).Value\n\n    imgA.Visible = (v = \"Y\")\n    imgB.Visible = (v = \"N\")\n    imgC.Visible = (v = \"X\")\n    imgD.Visible = (v = \"F\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6557919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e076f0c6d11cef4f065a02a8cffb6c7?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/6557919/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4415, "favorite_count": 0, "accepted_answer_id": 38233557, "answer_count": 1, "score": 0, "last_activity_date": 1467838193, "creation_date": 1467836597, "question_id": 38233105, "link": "https://stackoverflow.com/questions/38233105/calling-public-subroutine-in-userform-excel-vba", "title": "Calling Public Subroutine in userform Excel VBA", "body": "<p>I recently started to learn excel vba and at the moment I am stuck calling Public Subroutine from a userform Excel VBA. I have been trying to put the subroutine into a module and few other places but still it gives me an error.(Sub or Function not defined!)</p>\n\n<p>Can you please guide in the right direction.</p>\n\n<p>The function itself in module1</p>\n\n<pre><code>Public Sub Check(j As Integer)   \nIf Worksheets(\"VBA\").Cells(j, 19).Value = \"Y\" Then\n    imgA.Visible = True\n    imgB.Visible = False\n    imgC.Visible = False\n    imgD.Visible = False\nElseIf Worksheets(\"VBA\").Cells(j, 19).Value = \"N\" Then\n    imgA.Visible = False\n    imgB.Visible = True\n    imgC.Visible = False\n    imgD.Visible = False\nElseIf Worksheets(\"VBA\").Cells(j, 19).Value = \"X\" Then\n    imgA.Visible = False\n    imgB.Visible = False\n    imgC.Visible = True\n    imgD.Visible = False\nElseIf Worksheets(\"VBA\").Cells(j, 19).Value = \"F\" Then\n    imgA.Visible = False\n    imgB.Visible = False\n    imgC.Visible = False\n    imgD.Visible = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Here I am calling it in a userform</p>\n\n<pre><code>    Private Sub UserForm_Initialize()\n        Call Check(i)\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "answers": [{"comments": [{"owner": {"reputation": 447, "user_id": 6476653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q4kG8.jpg?s=128&g=1", "display_name": "Benno Grimm", "link": "https://stackoverflow.com/users/6476653/benno-grimm"}, "reply_to_user": {"reputation": 27, "user_id": 6557913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7893de46a74f2bb656e0da0f6f83c336?s=128&d=identicon&r=PG&f=1", "display_name": "Alonso4077", "link": "https://stackoverflow.com/users/6557913/alonso4077"}, "edited": false, "score": 0, "creation_date": 1467838878, "post_id": 38233070, "comment_id": 63888997, "body": "How are the Sheets in your Workbook called? It doesnt work if they are not called Sheet1, Sheet2..."}, {"owner": {"reputation": 27, "user_id": 6557913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7893de46a74f2bb656e0da0f6f83c336?s=128&d=identicon&r=PG&f=1", "display_name": "Alonso4077", "link": "https://stackoverflow.com/users/6557913/alonso4077"}, "edited": false, "score": 0, "creation_date": 1467839427, "post_id": 38233070, "comment_id": 63889297, "body": "they are labeled with names. For example, Smith. John"}, {"owner": {"reputation": 447, "user_id": 6476653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q4kG8.jpg?s=128&g=1", "display_name": "Benno Grimm", "link": "https://stackoverflow.com/users/6476653/benno-grimm"}, "reply_to_user": {"reputation": 27, "user_id": 6557913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7893de46a74f2bb656e0da0f6f83c336?s=128&d=identicon&r=PG&f=1", "display_name": "Alonso4077", "link": "https://stackoverflow.com/users/6557913/alonso4077"}, "edited": false, "score": 0, "creation_date": 1467839942, "post_id": 38233070, "comment_id": 63889541, "body": "OK, that changes everything :P Look at the code i&#39;ve added. It should help you"}, {"owner": {"reputation": 27, "user_id": 6557913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7893de46a74f2bb656e0da0f6f83c336?s=128&d=identicon&r=PG&f=1", "display_name": "Alonso4077", "link": "https://stackoverflow.com/users/6557913/alonso4077"}, "edited": false, "score": 0, "creation_date": 1467841490, "post_id": 38233070, "comment_id": 63890209, "body": "It didn&#39;t come back with an error, but it didn&#39;t give any result"}, {"owner": {"reputation": 447, "user_id": 6476653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q4kG8.jpg?s=128&g=1", "display_name": "Benno Grimm", "link": "https://stackoverflow.com/users/6476653/benno-grimm"}, "reply_to_user": {"reputation": 27, "user_id": 6557913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7893de46a74f2bb656e0da0f6f83c336?s=128&d=identicon&r=PG&f=1", "display_name": "Alonso4077", "link": "https://stackoverflow.com/users/6557913/alonso4077"}, "edited": false, "score": 0, "creation_date": 1467841647, "post_id": 38233070, "comment_id": 63890280, "body": "Atm it shows the result in cell B8 on the Worksheet the &quot;no&quot; was found, if you want your result elsewhere, then just change <code>ws.Range(&quot;B8&quot;) = ws.name</code>   to something else. Example:  <code>MsgBox(&quot;Found on: &quot; &amp; ws.Name)</code>"}], "tags": [], "owner": {"reputation": 447, "user_id": 6476653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q4kG8.jpg?s=128&g=1", "display_name": "Benno Grimm", "link": "https://stackoverflow.com/users/6476653/benno-grimm"}, "is_accepted": false, "score": 0, "last_activity_date": 1467839996, "last_edit_date": 1467839996, "creation_date": 1467836476, "answer_id": 38233070, "question_id": 38232886, "link": "https://stackoverflow.com/questions/38232886/creating-a-macro-that-will-search-workbook-and-perform-an-if-then-else/38233070#38233070", "title": "Creating a macro that will search workbook and perform an if then else", "body": "<p>Maybe</p>\n\n<pre><code>Dim wsNumber as String\nDim i as Integer\n\n   For i = 1 to 10 'change 10 to the Number of Sheets you want to check\n      wsNumber = \"Sheet\" &amp; i\n      If Worksheets(wsNumber).Range(\"C8\") = \"no\" then\n         Worksheets(\"Sheet1\").Range(\"B8\") = wsNumber\n      End If\n   Next i\n</code></pre>\n\n<p>This returns the Name of the Worksheet \"no\" has been found in. To keep it simple I just returned it in cell B8 of Sheet1, if you want to return the name on the Sheet where \"no\" has been found use: <code>Worksheets(wsnumber).range(\"B8\") = wsNumber</code> instead of <code>Worksheets(\"Sheet1\").Range(\"B8\") = wsNumber</code>.</p>\n\n<p><strong>ADDED</strong></p>\n\n<pre><code>For Each ws In ActiveWorkbook.Worksheets\n    If ws.Range(\"C8\") = \"no\" Then\n        ws.Range(\"B8\") = ws.Name\n    End If\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "is_accepted": false, "score": 0, "last_activity_date": 1467836660, "creation_date": 1467836660, "answer_id": 38233121, "question_id": 38232886, "link": "https://stackoverflow.com/questions/38232886/creating-a-macro-that-will-search-workbook-and-perform-an-if-then-else/38233121#38233121", "title": "Creating a macro that will search workbook and perform an if then else", "body": "<p>You're close, just missing some code. Give this a try:</p>\n\n<pre><code>For Each ws In ActiveWorkbook.Worksheets\n    If ws.Visible = xlSheetVisible And Range(\"C8\") = \"No\" Then\n        ws.Cells(8, 2).Value = ws.Name\n   End If\nNext ws\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 6557913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7893de46a74f2bb656e0da0f6f83c336?s=128&d=identicon&r=PG&f=1", "display_name": "Alonso4077", "link": "https://stackoverflow.com/users/6557913/alonso4077"}, "edited": false, "score": 0, "creation_date": 1467838389, "post_id": 38233257, "comment_id": 63888755, "body": "hmm its not accepting the code wsaddpatient.cells(8,2)"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 27, "user_id": 6557913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7893de46a74f2bb656e0da0f6f83c336?s=128&d=identicon&r=PG&f=1", "display_name": "Alonso4077", "link": "https://stackoverflow.com/users/6557913/alonso4077"}, "edited": false, "score": 0, "creation_date": 1467838813, "post_id": 38233257, "comment_id": 63888960, "body": "Because you have it in the original question in a <code>With</code> statement, I&#39;m presuming you have a statement somewhere reading <code>Set wsAddPatient = ThisWorkbook.Worksheets(&quot;whateversheetyoumeant&quot;)</code> ?  If you do have this set, what error are you getting?"}, {"owner": {"reputation": 27, "user_id": 6557913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7893de46a74f2bb656e0da0f6f83c336?s=128&d=identicon&r=PG&f=1", "display_name": "Alonso4077", "link": "https://stackoverflow.com/users/6557913/alonso4077"}, "edited": false, "score": 0, "creation_date": 1467839194, "post_id": 38233257, "comment_id": 63889183, "body": "So this is all the code I have right now:  Sub NeedVolunteer() Set wsAddPatient = ThisWorkbook.Worksheets(&quot;Add Patient&quot;) With wsAddPatient     For Each ws In ActiveWorkbook.Worksheets         If ws.Visible = xlSheetVisible And wsAddPatient.Cells(8, 2) = &quot;No&quot; Then             .Cells(8, 2).Value = .Cells(8, 2).Value &amp; ws.Name &amp; &quot;;&quot;        End If     Next End With  End Sub  It went through without error now, but it doesn&#39;t perform the tast"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 27, "user_id": 6557913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7893de46a74f2bb656e0da0f6f83c336?s=128&d=identicon&r=PG&f=1", "display_name": "Alonso4077", "link": "https://stackoverflow.com/users/6557913/alonso4077"}, "edited": false, "score": 0, "creation_date": 1467840689, "post_id": 38233257, "comment_id": 63889856, "body": "Have you tried stepping through the process itself using the <code>F8</code> key?  The code looks ok to me, but it&#39;d help if you posted it as an edit to the main question rather than as a comment :)"}, {"owner": {"reputation": 27, "user_id": 6557913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7893de46a74f2bb656e0da0f6f83c336?s=128&d=identicon&r=PG&f=1", "display_name": "Alonso4077", "link": "https://stackoverflow.com/users/6557913/alonso4077"}, "edited": false, "score": 0, "creation_date": 1467841451, "post_id": 38233257, "comment_id": 63890189, "body": "I posted it in the main comment! Thanks for working through this"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 27, "user_id": 6557913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7893de46a74f2bb656e0da0f6f83c336?s=128&d=identicon&r=PG&f=1", "display_name": "Alonso4077", "link": "https://stackoverflow.com/users/6557913/alonso4077"}, "edited": false, "score": 0, "creation_date": 1467841959, "post_id": 38233257, "comment_id": 63890406, "body": "When you stepped through it, I presume that the <code>If</code> step didn&#39;t prove <code>True</code>?  If it had, then the <code>.Cells(8,2) ...</code> code would have fired.  Which means that either no sheet has a &quot;No&quot; value in C8 or the sheet isn&#39;t visible."}, {"owner": {"reputation": 27, "user_id": 6557913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7893de46a74f2bb656e0da0f6f83c336?s=128&d=identicon&r=PG&f=1", "display_name": "Alonso4077", "link": "https://stackoverflow.com/users/6557913/alonso4077"}, "edited": false, "score": 0, "creation_date": 1467842546, "post_id": 38233257, "comment_id": 63890677, "body": "I got it to work! I changed line 5 to the above. So how would I get it to fill the rows down instead of being all in one row?"}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": true, "score": 0, "last_activity_date": 1467837118, "creation_date": 1467837118, "answer_id": 38233257, "question_id": 38232886, "link": "https://stackoverflow.com/questions/38232886/creating-a-macro-that-will-search-workbook-and-perform-an-if-then-else/38233257#38233257", "title": "Creating a macro that will search workbook and perform an if then else", "body": "<pre><code>With wsAddPatient\n    For Each ws In ActiveWorkbook.Worksheets\n        If ws.Visible = xlSheetVisible And ws.Range(\"C8\") = \"No\" Then\n            .Cells(8, 2).Value = ws.Name\n       End If\n    Next\nEnd With\n</code></pre>\n\n<p>If you don't specify the <code>range(\"C8\")</code> as belonging to the worksheet, then the <code>activesheet</code> will be used - since you don't appear to be changing the worksheet this means you're always checking the same place. This should sort the problem for you and put the name of any worksheet with \"No\" in C8 into <code>wsAddPatient.Cells(8,2)</code></p>\n\n<p>Bear in mind that if there are multiple sheets with this value, you will overwrite any previous result.  Consider changing</p>\n\n<pre><code>.Cells(8,2).Value = ws.Name\n</code></pre>\n\n<p>to</p>\n\n<pre><code>.Cells(8,2).Value = .Cells(8,2).Value &amp; ws.Name &amp; \";\"\n</code></pre>\n\n<p>This will leave you with a trailing semi colon in the cell but a full list of the worksheet names that matched your criteria in the workbook.</p>\n"}], "owner": {"reputation": 27, "user_id": 6557913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7893de46a74f2bb656e0da0f6f83c336?s=128&d=identicon&r=PG&f=1", "display_name": "Alonso4077", "link": "https://stackoverflow.com/users/6557913/alonso4077"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 38233257, "answer_count": 3, "score": 1, "last_activity_date": 1467843035, "creation_date": 1467835795, "last_edit_date": 1467843035, "question_id": 38232886, "link": "https://stackoverflow.com/questions/38232886/creating-a-macro-that-will-search-workbook-and-perform-an-if-then-else", "title": "Creating a macro that will search workbook and perform an if then else", "body": "<p>I've been trying to work on a macro that I just can't get. </p>\n\n<p>I want the macro to search all the sheets in the workbook while using an if then code.</p>\n\n<p>I want the if then to search the range C8 for a value \"no\" and if true, I want it to return the name of the worksheet. </p>\n\n<p>This is what I have right now, but its not working. </p>\n\n<hr>\n\n<pre><code>With wsAddPatient\n\nFor Each ws In Active.Workbook.Worksheets\n\n        If ws.Visible = xlSheetVisible And Range(\"C8\") = \"No\" Then\n            .Cells(8, 2).Value = ws.Name\n\n       End If\n</code></pre>\n\n<p>Update using Dave's code:</p>\n\n<pre><code>Sub NeedVolunteer() \n    Set wsAddPatient = ThisWorkbook.Worksheets(\"Add Patient\")      \n    With wsAddPatient \n        For Each ws In ActiveWorkbook.Worksheets \n            If ws.range(\"C8\").Value = \"No\" Then\n                .Cells(8, 2).Value = .Cells(8, 2).Value &amp; ws.Name &amp; \";\" \n            End If \n        Next \n    End With \nEnd Sub\n</code></pre>\n\n<p>This works!</p>\n\n<p>Final:</p>\n\n<pre><code>Sub NeedVolunteer()\n    Set wsAddPatient = ThisWorkbook.Worksheets(\"Add Patient\")\n    Dim ws As Worksheet\n    Dim lRow As Long\n    iRow = 8\n    With wsAddPatient\n        For Each ws In ActiveWorkbook.Worksheets\n            If ws.Range(\"C8\").Value = \"No\" Then\n                .Cells(iRow, 2).Value = ws.Name\n                iRow = iRow + 1\n        End If\n     Next\n End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "select"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1467835510, "post_id": 38232793, "comment_id": 63887284, "body": "<code>.Range(&quot;B&quot; &amp; Rows.Count).End(xlUp).Row</code> will count cells with formulas."}, {"owner": {"reputation": 331, "user_id": 4646183, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2533f4ceaa4201b23ff00c6534d65a58?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/4646183/megan"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1467835634, "post_id": 38232793, "comment_id": 63887336, "body": "Yes, I realize. Which is why it is followed with an if statement that does not add it to the range if it is empty"}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1467836218, "post_id": 38232793, "comment_id": 63887635, "body": "Have you tried using cell.Text &lt;&gt; &quot;&quot; insead of cell.Value &lt;&gt; &quot;&quot;?"}, {"owner": {"reputation": 331, "user_id": 4646183, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2533f4ceaa4201b23ff00c6534d65a58?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/4646183/megan"}, "edited": false, "score": 0, "creation_date": 1467836629, "post_id": 38232793, "comment_id": 63887853, "body": "Thanks for your help, but cell.Text is returning the same as cell.Value"}], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 4646183, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2533f4ceaa4201b23ff00c6534d65a58?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/4646183/megan"}, "edited": false, "score": 0, "creation_date": 1467837499, "post_id": 38233271, "comment_id": 63888327, "body": "This worked perfectly! I am so happy I could kiss you- I have been struggling over this for far too long"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 4, "last_activity_date": 1467837168, "creation_date": 1467837168, "answer_id": 38233271, "question_id": 38232793, "link": "https://stackoverflow.com/questions/38232793/selecting-all-non-blank-cells-in-variable-range-in-excel-vba/38233271#38233271", "title": "Selecting all non-blank cells in variable range in Excel VBA", "body": "<pre><code>Dim lastVal As Range, sht As Worksheet\n\nSet sht = Sheets(\"Sortable(2)\")\n\nSet lastVal = sht.Columns(2).Find(\"*\", sht.Cells(1, 2), xlValues, _\n                                xlPart, xlByColumns, xlPrevious)\n\nDebug.Print lastVal.Address\n\nsht.Range(\"B2\", lastVal).Resize(, 32).Select 'select B:AG\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 4646183, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2533f4ceaa4201b23ff00c6534d65a58?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/4646183/megan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9199, "favorite_count": 1, "accepted_answer_id": 38233271, "answer_count": 1, "score": 0, "last_activity_date": 1467837168, "creation_date": 1467835405, "last_edit_date": 1467836821, "question_id": 38232793, "link": "https://stackoverflow.com/questions/38232793/selecting-all-non-blank-cells-in-variable-range-in-excel-vba", "title": "Selecting all non-blank cells in variable range in Excel VBA", "body": "<p>I have I data set on Excel. Starting at column B, it has continuous data from B3 to a variable number that periodically get larger (today it is B114, but tomorrow the data may extend to B116, for example). The data in cell B in continuous and is never deleted. For every row of continuous data in column B, I want to select column B-AG's rows as well. However, the rows after B do NOT have continuous data. </p>\n\n<p>For example: There is continuous data from B3 to B120. I want to select the range B3:AG120. </p>\n\n<p>The code I have written to do this in VBA is not working. It correctly stops at B120 (in this example), however, once it reaches the non-continuous data in columns C-AG, it freaks out and selects rows past 120. I am not positive why this code is not working, any help is much appreciated!</p>\n\n<p>For the record, there are formulas in nearly every cell in the sheet. Only some formula populate the cell with data, however. I want to select every cell regardless of if it is populated with data IF IT IS IN MY RANGE. Otherwise, I do not want to select it. For example, past B120 there are empty cells with formulas in them. I do not want to include those in my range. But if there is an empty cell in D40 (in between B3 and AG120) I do want to include that in the selection. </p>\n\n<pre><code>Dim LR As Long, cell As Range, rng As Range\nWith Sheets(\"Sortable(2)\")\n    LR = .Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n    For Each cell In .Range(\"B3:B\" &amp; LR)\n        If cell.Value &lt;&gt; \"\" Then\n            If rng Is Nothing Then\n               Set rng = cell\n            Else\n               Set rng = Union(rng, cell)\n            End If\n         End If\n    Next cell\n    rng.Select\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467834204, "post_id": 38232366, "comment_id": 63886560, "body": "Loop through all objects in each sheet and test for type <code>checkbox</code>, then test for name (or just test for name). once you find what you need, activate it."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5854374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eff95f23c6fd40707fdaa8f6e5962e25?s=128&d=identicon&r=PG&f=1", "display_name": "bobo", "link": "https://stackoverflow.com/users/5854374/bobo"}, "edited": false, "score": 0, "creation_date": 1467918557, "post_id": 38234668, "comment_id": 63928054, "body": "Thank you, this helped me get to the worksheet and then  .TopLeftCell.Address to the exact location."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 33, "user_id": 5854374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eff95f23c6fd40707fdaa8f6e5962e25?s=128&d=identicon&r=PG&f=1", "display_name": "bobo", "link": "https://stackoverflow.com/users/5854374/bobo"}, "edited": false, "score": 0, "creation_date": 1467918631, "post_id": 38234668, "comment_id": 63928108, "body": "Awesome! Glad to have been able to help you."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1467843219, "creation_date": 1467843219, "answer_id": 38234668, "question_id": 38232366, "link": "https://stackoverflow.com/questions/38232366/how-to-find-and-select-checkbox-in-excel-using-vba/38234668#38234668", "title": "How to find and select Checkbox in Excel using VBA", "body": "<p>You can not just call a control on a worksheet directly from outside of the worksheets module.  Is <code>FlashCopy_chkbox</code> declared somewhere in your script?  <code>Set FlashCopy_chkbox = Worksheet(\"Sheet1\").FlashCopy_chkbox</code>. <br></p>\n\n<p>In any case this will find it.  </p>\n\n<pre><code>Sub LookForFlash()\n    Dim ws As Worksheet\n    Dim ck As OLEObject\n\n    For Each ws In ThisWorkbook.Worksheets\n        On Error Resume Next\n        Set ck = ws.OLEObjects(\"FlashCopy_chkbox\")\n        If Err = 0 Then\n            MsgBox ws.Name\n        End If\n        On Error GoTo 0\n    Next ws\nEnd Sub\n</code></pre>\n\n<p>I understand you were looking for a built in method but In the future please post some code.  Stack Overflow is here to help improve existing code.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 5854374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eff95f23c6fd40707fdaa8f6e5962e25?s=128&d=identicon&r=PG&f=1", "display_name": "bobo", "link": "https://stackoverflow.com/users/5854374/bobo"}, "edited": false, "score": 0, "creation_date": 1467918515, "post_id": 38234977, "comment_id": 63928030, "body": "Thanks - .TopLeftCell.Address was what I was looking for!"}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 2, "last_activity_date": 1467845000, "creation_date": 1467845000, "answer_id": 38234977, "question_id": 38232366, "link": "https://stackoverflow.com/questions/38232366/how-to-find-and-select-checkbox-in-excel-using-vba/38234977#38234977", "title": "How to find and select Checkbox in Excel using VBA", "body": "<p>The following code will list all ActiveX controls on all sheets in a workbook in the <code>Immediate</code> window of the VBE. Furthermore, the code will list all form control <code>OptionButtons</code>, <code>CheckBoxes</code>, and <code>Buttons</code> on all sheets:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub FindThemAll()\n\nDim ws As Worksheet\nDim obj As OLEObject\nDim opt As OptionButton\nDim chk As CheckBox\nDim cmd As Button\n\nFor Each ws In ThisWorkbook.Worksheets\n    'Handling all ActiveX controls\n    For Each obj In ws.OLEObjects\n        Debug.Print \"---------------------------------------------\"\n        Debug.Print \"ActiveX component on sheet: \" &amp; ws.Name\n        Debug.Print \"Location on sheet: \" &amp; obj.TopLeftCell.Address\n        Debug.Print \"Name of the component: \" &amp; obj.Name\n        Debug.Print \"Object type: \" &amp; TypeName(obj.Object)\n    Next obj\n    'Handling Form Controls\n    For Each opt In ws.OptionButtons\n        Debug.Print \"---------------------------------------------\"\n        Debug.Print \"Form control on sheet: \" &amp; ws.Name\n        Debug.Print \"Location on sheet: \" &amp; opt.TopLeftCell.Address\n        Debug.Print \"Name of the component: \" &amp; opt.Name\n        Debug.Print \"Object type: OptionButton\"\n    Next opt\n    For Each chk In ws.CheckBoxes\n        Debug.Print \"---------------------------------------------\"\n        Debug.Print \"Form control on sheet: \" &amp; ws.Name\n        Debug.Print \"Location on sheet: \" &amp; chk.TopLeftCell.Address\n        Debug.Print \"Name of the component: \" &amp; chk.Name\n        Debug.Print \"Object type: CheckBox\"\n    Next chk\n    For Each cmd In ws.Buttons\n        Debug.Print \"---------------------------------------------\"\n        Debug.Print \"Form control on sheet: \" &amp; ws.Name\n        Debug.Print \"Location on sheet: \" &amp; cmd.TopLeftCell.Address\n        Debug.Print \"Name of the component: \" &amp; cmd.Name\n        Debug.Print \"Object type: Button\"\n    Next cmd\nNext ws\n\nEnd Sub\n</code></pre>\n\n<p>Let me know if you have any questions.</p>\n"}], "owner": {"reputation": 33, "user_id": 5854374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eff95f23c6fd40707fdaa8f6e5962e25?s=128&d=identicon&r=PG&f=1", "display_name": "bobo", "link": "https://stackoverflow.com/users/5854374/bobo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1174, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1467845000, "creation_date": 1467833802, "last_edit_date": 1531164843, "question_id": 38232366, "link": "https://stackoverflow.com/questions/38232366/how-to-find-and-select-checkbox-in-excel-using-vba", "title": "How to find and select Checkbox in Excel using VBA", "body": "<p>I have a workbook with many worksheets and hundreds of checkboxes, toggles, etc.</p>\n\n<p>Somewhere in the code I have inherited </p>\n\n<p>\"FlashCopy_chkbox.Enabled = False\" </p>\n\n<p>doesn't work. I need to find WHERE that checkbox/toggle is in a previous version of the same file.</p>\n\n<p>Simply put, how to I use vba to select whatever that is referencing and center it on my screen?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 4, "creation_date": 1467831857, "post_id": 38231823, "comment_id": 63885319, "body": "did you search SO? There&#39;s a bagazillion examples of how to do this on here. Also, what have you <i>actually tried</i> to copy the row to another sheet?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1467831865, "post_id": 38231823, "comment_id": 63885326, "body": "Quick note, also make sure to add the <code>.</code> before <code>Rows.Count</code> when you <code>Set a</code>.  For the next part, you&#39;ll just want to find the next row in your Sheet2 (use a variable), then you can cut/paste.  There are myriad examples of what you&#39;re asking for here, so just use the Search box.  I&#39;d suggest using the macro recorder, cut/paste, and see what that code looks like, and tweak from there."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1467831887, "post_id": 38231823, "comment_id": 63885343, "body": "lol I like how you use <code>with</code> then proceed to use <code>select</code> XD"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 3, "creation_date": 1467831891, "post_id": 38231823, "comment_id": 63885346, "body": "@ScottHoltzman how many is a <code>bagazillion</code>?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1467831952, "post_id": 38231823, "comment_id": 63885382, "body": "@ScottCraner - it&#39;s the square-root of googleplex to the 181st power over 91."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1467832168, "post_id": 38231823, "comment_id": 63885490, "body": "@ScottCraner just use type <code>double</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "is_accepted": false, "score": 0, "last_activity_date": 1467837703, "creation_date": 1467837703, "answer_id": 38233426, "question_id": 38231823, "link": "https://stackoverflow.com/questions/38231823/move-the-row-to-another-sheet/38233426#38233426", "title": "Move the row to another sheet", "body": "<p>There are many ways to do this, the simplest is to keep a row counter, which tracks how many rows you've used on on the other sheet. Increment this counter by one each time. Lets assume you have column headers on sheet1, so the first available row is row 2:</p>\n\n<pre><code>Sub DeleteMatches2()\n\n    Dim a As Range, b As Range\n    Dim c As String\n    Dim rowCounter As Long\n\n    rowCounter = 2 ' start at row 2\n\n   'The column that has the value is V2\n    With Sheets(\"Controle Estoque Fixo\")\n        Set a = .Range(.Cells(2, \"V\"), .Cells(Rows.Count, \"V\").End(xlUp))\n    End With\n\n    For Each b In a\n        If b.Value = \"False\" Then\n            'Sheets(\"Sheet1\").Select ' you don't need to select an object to access it, so remove this\n            'here's the bit you need\n            Sheets(\"Controle Estoque Fixo\").Rows(b.row).Cut Sheets(\"Sheet1\").Rows(rowCounter) ' this cuts and pastes all in one line\n            ' you use the row counter to specify the destination\n\n            rowCounter = rowCounter + 1 ' the next time you'll paste on the next row\n\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>As people have commented there are many many many ways to do this so have a good look on Stack Overflow, something else might appeal to you.</p>\n"}], "owner": {"reputation": 1, "user_id": 6513335, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0a85d5beb673d253709d30285a02acd3?s=128&d=identicon&r=PG&f=1", "display_name": "TerrorJapones", "link": "https://stackoverflow.com/users/6513335/terrorjapones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1467837703, "creation_date": 1467831662, "question_id": 38231823, "link": "https://stackoverflow.com/questions/38231823/move-the-row-to-another-sheet", "title": "Move the row to another sheet", "body": "<p>I have a worksheet, that I need to move the row, if the value on the last column is equal to false.\nI don't know how to move to sheet 2 and make go through entire sheet.\nThank for the help.</p>\n\n<pre><code>Sub DeleteMatches2()\n    Dim a As Range, b As Range\n    Dim c As String\n   'The column that has the value is V2\n    With Sheets(\"Controle Estoque Fixo\")\n        Set a = .Range(.Cells(2, \"V\"), .Cells(Rows.Count, \"V\").End(xlUp))\n    End With\n\n    For Each b In a\n        If b.Value = \"False\" Then\n            Sheets(\"Sheet1\").Select\n            'know I am lost\n\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "class", "csv"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1467831720, "post_id": 38231742, "comment_id": 63885237, "body": "You say you&#39;ve created a Class, but your code shows a Type ?"}], "answers": [{"tags": [], "owner": {"reputation": 165, "user_id": 6499901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a089fe0017c8d9a16f386996646ef3ff?s=128&d=identicon&r=PG&f=1", "display_name": "nick", "link": "https://stackoverflow.com/users/6499901/nick"}, "is_accepted": true, "score": 0, "last_activity_date": 1467831870, "creation_date": 1467831870, "answer_id": 38231881, "question_id": 38231742, "link": "https://stackoverflow.com/questions/38231742/class-module-vba-importing-data-from-the-excel-sheet/38231881#38231881", "title": "class module - VBA - importing data from the excel sheet", "body": "<p>Im assuming this is an excel macro. You can refer to the cell by using range objects. Look them up.</p>\n\n<p>For example try making this method. you can use a for loop to do this over large ranges of data</p>\n\n<pre><code>public sub test()\n     name = sheets(\"Sheet1\").range(\"A1\").value\n     'test what that did with a msgbox \n     msgbox name\nend sub\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 6096077, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50e35954f90332fd8a6d54dd38ca9c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Zapata", "link": "https://stackoverflow.com/users/6096077/zapata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 559, "favorite_count": 0, "accepted_answer_id": 38231881, "answer_count": 1, "score": 0, "last_activity_date": 1467833372, "creation_date": 1467831378, "last_edit_date": 1531164843, "question_id": 38231742, "link": "https://stackoverflow.com/questions/38231742/class-module-vba-importing-data-from-the-excel-sheet", "title": "class module - VBA - importing data from the excel sheet", "body": "<p>Hi I am new to VBA so please bear with me. \nI have created a class of employee which is supposed to use the data from the excel sheet. I did a quick search but I have not find how to import my data from the same excel sheet into my class modules. Here is my employee class module:</p>\n\n<pre><code>Dim C As Class1\nSet C = New Class1\n\nType Employee\n    Name As String\n    Address As String\n    Salary As Double\nEnd Type\n</code></pre>\n\n<p>Now I have so many data for Name, Address and Salary in my excel sheet which I don't want to import them manually. Could someone please help me with that?</p>\n\n<p>I know that there is a code in Ruby on Rails that can do so:</p>\n\n<pre><code>content = File.read(\"data.csv\")\n</code></pre>\n\n<p>Is there such a thing in VBA?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 5281456, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1690f4f5941090f0e60f71164b277337?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay billa", "link": "https://stackoverflow.com/users/5281456/vinay-billa"}, "edited": false, "score": 0, "creation_date": 1467832230, "post_id": 38231695, "comment_id": 63885523, "body": "Thanks a  lot mate"}], "tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 3, "last_activity_date": 1467831245, "creation_date": 1467831245, "answer_id": 38231695, "question_id": 38231638, "link": "https://stackoverflow.com/questions/38231638/how-to-solve-runtime-error-6-in-vba/38231695#38231695", "title": "How to Solve runtime error 6 in vba?", "body": "<p>Something like this should work for situation where you have a divide by zero issue:</p>\n\n<pre><code>If CDbl(Worksheets(\"calculation\").Range(\"O4\").Value) = 0 Then\n   TextBox50.Value = (0 - 1) * 100, 1) &amp; \"%\"\nElse\n    TextBox50.Value = Round((CDbl(TextBox3.Value) / (CDbl(Worksheets(\"calculation\").Range(\"O4\").Value)) - 1) * 100, 1) &amp; \"%\"\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 189, "user_id": 5281456, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1690f4f5941090f0e60f71164b277337?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay billa", "link": "https://stackoverflow.com/users/5281456/vinay-billa"}, "edited": false, "score": 0, "creation_date": 1467894872, "post_id": 38231716, "comment_id": 63912289, "body": "Is there anyway where I can show the output as &quot;NA&quot; or &quot;-&quot; or &quot;NULL&quot;"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 3, "last_activity_date": 1467831300, "creation_date": 1467831300, "answer_id": 38231716, "question_id": 38231638, "link": "https://stackoverflow.com/questions/38231638/how-to-solve-runtime-error-6-in-vba/38231716#38231716", "title": "How to Solve runtime error 6 in vba?", "body": "<p>You can use IIF():</p>\n\n<pre><code>TextBox50.Value = Round((CDbl(TextBox3.Value) / IIF(CDbl(Worksheets(\"calculation\").Range(\"O4\")=0,1,CDbl(Worksheets(\"calculation\").Range(\"O4\")))\n</code></pre>\n\n<p>Which will return the value in TextBox3 if the other is 0.</p>\n"}], "owner": {"reputation": 189, "user_id": 5281456, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1690f4f5941090f0e60f71164b277337?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay billa", "link": "https://stackoverflow.com/users/5281456/vinay-billa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 0, "accepted_answer_id": 38231716, "answer_count": 2, "score": 1, "last_activity_date": 1536211292, "creation_date": 1467831027, "last_edit_date": 1467831112, "question_id": 38231638, "link": "https://stackoverflow.com/questions/38231638/how-to-solve-runtime-error-6-in-vba", "title": "How to Solve runtime error 6 in vba?", "body": "<p>I have the following code </p>\n\n<pre><code>TextBox50.Value = Round((CDbl(TextBox3.Value) / (CDbl(Worksheets(\"calculation\").Range(\"O4\").Value)) - 1) * 100, 1) &amp; \"%\"\n</code></pre>\n\n<p>The value of <code>TextBox3 = Value</code> present in <code>Worksheets(\"calculation\").Range(\"O4\")</code>. </p>\n\n<p>The issue is if the value of Range(O4) is zero, then it essentially means 0/0 which is why I am getting runtime 6, overflow error. </p>\n\n<p>Is there anyway I can replace 0/0 with 0. </p>\n\n<p>Any help is much appreciated. Thank you </p>\n"}, {"tags": ["vba", "concatenation", "select-case"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1467829894, "post_id": 38231193, "comment_id": 63884115, "body": "Is this the <code>For Each List2</code> loop? What seems to be the problem with the output?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1467830074, "post_id": 38231193, "comment_id": 63884230, "body": "I notice also that you haven&#39;t assigned any value to <code>AgeRange</code>. And, this may be pedantic, but naming variables like <code>...Range</code> when the data type is <code>String</code> is potentially confusing from a code-maintenance/troubleshooting perspective."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1467830711, "post_id": 38231193, "comment_id": 63884616, "body": "You may simply need to change: <code>List2.Value = AgeRange</code> to <code>AgeRange = List2.Value</code>. Or, you can omit <code>AgeRange</code> altogether; delete that line, and then do simply: <code>List.Offset(0, 20).Value = PeopleRange &amp; &quot;&#47;&quot; &amp; GiftRange &amp; &quot;&#47;&quot; &amp; List2.Value</code>"}], "owner": {"reputation": 31, "user_id": 4852575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2caa2599b0a65ac1297d0ed0022c205?s=128&d=identicon&r=PG&f=1", "display_name": "ThePangloss", "link": "https://stackoverflow.com/users/4852575/thepangloss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 618, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467831399, "creation_date": 1467829642, "last_edit_date": 1467829983, "question_id": 38231193, "link": "https://stackoverflow.com/questions/38231193/vba-concatenate-a-dynamic-range", "title": "VBA concatenate a dynamic range", "body": "<p>I have a dynamic range and I'd like to fix up one range of data using select case, paste it 20 columns right, then concatenate two columns, the fixed up range column and another column in the dynamic range set, which will be pasted 20 columns right, or where the fixed range was pasted.</p>\n\n<p>I'm having trouble actually concatenating them. I have the select case part working, but I'm not sure how to actually concatenate them. </p>\n\n<p>Right now I have</p>\n\n<pre><code>Private Sub PGA(colNum As Long, LastRow As Long, foundPass As Range, List As Range)\n    Dim People As Integer\n    Dim Gift As Integer\n    Dim PeopleRange As String\n    Dim GiftRange As String\n    Dim List2 As Range\n    Dim AgeRange As String\n\n\n    For Each List In Range(Cells(3, colNum + 14), Cells(LastRow, colNum + 14))\n        People = Mid(List.Value, 1, 1)\n        Select Case People\n            Case 1\n                PeopleRange = \"1 Person\"\n            Case 2\n                PeopleRange = \"2 People\"\n            Case 3\n                PeopleRange = \"3 People\"\n            Case 4\n                PeopleRange = \"4 People\"\n            Case 5\n                PeopleRange = \"5 People\"\n            Case Is &gt;= 6\n                PeopleRange = \"6+ People\"\n\n        End Select\n        Gift = Mid(List.Value, 5, 1)\n        Select Case Gift\n           Case 1\n                GiftRange = \"1 Gift\"\n            Case 2\n                GiftRange = \"2 Gifts\"\n            Case 3\n                GiftRange = \"3 Gifts\"\n            Case 4\n                GiftRange = \"4 Gifts\"\n            Case 5\n                GiftRange = \"5 Gifts\"\n            Case Is &gt;= 6\n                GiftRange = \"6+ Gifts\"\n        End Select\n        For Each List2 In Range(Cells(3, colNum + 15), Cells(LastRow, colNum + 15))\n            List2.Value = AgeRange\n            List.Offset(0, 20).Value = PeopleRange &amp; \"/\" &amp; GiftRange &amp; \"/\" &amp; AgeRange\n        Next List2\n    Next List\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "db2", "vba"], "comments": [{"owner": {"reputation": 202712, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1467827840, "post_id": 38230629, "comment_id": 63882978, "body": "If this is a question with VBA language why do you tag it with VB.NET? Please use appropriate tags"}, {"owner": {"reputation": 15, "user_id": 4074298, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d20bda4e3b7b52e11a766518a7971bfa?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit Lal", "link": "https://stackoverflow.com/users/4074298/rohit-lal"}, "reply_to_user": {"reputation": 202712, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1467828629, "post_id": 38230629, "comment_id": 63883404, "body": "It is related with Vb script connection with DB2"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 4074298, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d20bda4e3b7b52e11a766518a7971bfa?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit Lal", "link": "https://stackoverflow.com/users/4074298/rohit-lal"}, "edited": false, "score": 0, "creation_date": 1467877720, "post_id": 38230993, "comment_id": 63901169, "body": "Thanks for your input, I have tried the same but getting the below error:Microsoft VBScript runtime error &#39;800a01a8&#39;  Object required: &#39;con&#39;"}, {"owner": {"reputation": 15, "user_id": 4074298, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d20bda4e3b7b52e11a766518a7971bfa?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit Lal", "link": "https://stackoverflow.com/users/4074298/rohit-lal"}, "edited": false, "score": 0, "creation_date": 1467877855, "post_id": 38230993, "comment_id": 63901260, "body": "I have used below connection string                                                     Set objmyconn = CreateObject(&quot;ADODB.Connection&quot;) Set objmycmd = CreateObject(&quot;ADODB.Command&quot;) Set objMyRecordset = CreateObject(&quot;ADODB.Recordset&quot;)        xDb_Conn_Str=&quot;Data Source=XXXXX;User ID=XXXXXX;password=XXXXXX;Provider=IBMDADB2.DB2COPY1;Persist Security Info=True;Location=;Extended Properties=;&quot; \t \tcon.Open xDb_Conn_Str \tcon.CommandTimeOut=1000"}, {"owner": {"reputation": 15, "user_id": 4074298, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d20bda4e3b7b52e11a766518a7971bfa?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit Lal", "link": "https://stackoverflow.com/users/4074298/rohit-lal"}, "edited": false, "score": 0, "creation_date": 1468044242, "post_id": 38230993, "comment_id": 63976509, "body": "Set objmyconn = Server.CreateObject(&quot;ADODB.Connection&quot;)    objmyconn.ConnectionString = &quot;Data Source=XXXXXX;User ID=XXXXXXX;password=XXXXXXX;Provider=IBMDADB2.DB2COPY1;Persi&zwnj;&#8203;st Security Info=True;Location=;Extended Properties=;&quot;    objmyconn.Open  \tobjmyconn.CommandTimeOut=1000  Response.Buffer=true"}, {"owner": {"reputation": 15, "user_id": 4074298, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d20bda4e3b7b52e11a766518a7971bfa?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit Lal", "link": "https://stackoverflow.com/users/4074298/rohit-lal"}, "edited": false, "score": 0, "creation_date": 1468044336, "post_id": 38230993, "comment_id": 63976525, "body": "I am using above connection, initially its working fine but now its showing below errror ---ADODB.Connection error &#39;800a0e7a&#39;  Provider cannot be found. It may not be properly installed."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 15, "user_id": 4074298, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d20bda4e3b7b52e11a766518a7971bfa?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit Lal", "link": "https://stackoverflow.com/users/4074298/rohit-lal"}, "edited": false, "score": 0, "creation_date": 1468044869, "post_id": 38230993, "comment_id": 63976613, "body": "If you rebooted already you want to try a different connection string at ConnectionStrings.com <a href=\"http://www.connectionstrings.com/ibm-db2/\" rel=\"nofollow noreferrer\">IBM DB2 connection strings</a>.  If you can&#39;t get that to work you may have to re-register IBMDADB2."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1467828957, "creation_date": 1467828957, "answer_id": 38230993, "question_id": 38230629, "link": "https://stackoverflow.com/questions/38230629/vb-script-connection-with-db2-10-5/38230993#38230993", "title": "vb script connection with db2 10.5", "body": "<p>In the VBA you have references set to the ActiveX Object Library and you declare your variables as datatype.  VBScript doesn't use data type declarations.  You need to use <strong>CreateObject</strong> to Set your object variables.</p>\n\n<pre><code>Set objmyconn = CreateObject(\"ADODB.Connection\")\nSet objmycmd = CreateObject(\"ADODB.Command\")\nSet objMyRecordset = CreateObject(\"ADODB.Recordset\")\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 4074298, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d20bda4e3b7b52e11a766518a7971bfa?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit Lal", "link": "https://stackoverflow.com/users/4074298/rohit-lal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 633, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467828957, "creation_date": 1467827736, "last_edit_date": 1531164843, "question_id": 38230629, "link": "https://stackoverflow.com/questions/38230629/vb-script-connection-with-db2-10-5", "title": "vb script connection with db2 10.5", "body": "<p>I need connection on vb script with Db2 v10.5 to extract data from db2. DB2 database is on another machine. Though I am using one connection string in VBA excel which is working fine for me however same is not working in VB script.</p>\n\n<p>Connection string in VBA (Excel)</p>\n\n<p>=============================================================</p>\n\n<ul>\n<li><p>Set objmyconn = New ADODB.Connection\n       Set objmycmd = New ADODB.Command\n       Set objMyRecordset = New ADODB.Recordset</p>\n\n<p>objmyconn.ConnectionString = \"Data Source=XXXXXXX;User\nID=XXXXX;password=XXXX;Provider=IBMDADB2.DB2COPY1;Persist Security\nInfo=True;Location=;Extended Properties=;\"    objmyconn.Open</p></li>\n</ul>\n\n<p>=========================================================================Earlier I am using Microsoft OLEDB provider for db2 in VB script but now I am using IBM db2 Oledb provider. A DB2 client already installed in my machine</p>\n"}, {"tags": ["vba", "excel", "internet-explorer"], "answers": [{"comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1467828787, "post_id": 38230623, "comment_id": 63883486, "body": "Your answer was good but I&#39;d still like to say that it doesn&#39;t work well at all in a loop. It throws intermittent errors and has mixed results that vary from execution to execution. The creator of the macro (linked) had warned that the method was prone to runtime errors..."}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "reply_to_user": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1467829293, "post_id": 38230623, "comment_id": 63883772, "body": "Well, I&#39;ve tried with some dummy data and it worked well. Also my answer is purely related to your question. If you can add some test data, I can take a look."}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1467830397, "post_id": 38230623, "comment_id": 63884423, "body": "I managed to make it work properly, but it takes around 1/3 of a second per cell that needs to be converted. So your answer is great, it&#39;s just the execution speed that is bad."}], "tags": [], "owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "is_accepted": true, "score": 2, "last_activity_date": 1467827708, "creation_date": 1467827708, "answer_id": 38230623, "question_id": 38230273, "link": "https://stackoverflow.com/questions/38230273/navigate-to-blank-page-in-ie-with-excel/38230623#38230623", "title": "Navigate to blank page in IE with Excel", "body": "<p>You are quitting <strong><code>Ie</code></strong> object in first loop and trying to access same in second loop, hence getting error.  </p>\n\n<p>Just remove <strong><code>.quit</code></strong> from loop and place below lines in the last line just before <strong><code>End Sub</code></strong>:  </p>\n\n<pre><code>Ie.quit\nSet Ie = Nothing\n</code></pre>\n"}], "owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1303, "favorite_count": 0, "accepted_answer_id": 38230623, "answer_count": 1, "score": 0, "last_activity_date": 1467827708, "creation_date": 1467826595, "last_edit_date": 1495542780, "question_id": 38230273, "link": "https://stackoverflow.com/questions/38230273/navigate-to-blank-page-in-ie-with-excel", "title": "Navigate to blank page in IE with Excel", "body": "<p>I have a piece of VBA code in Excel that takes cells where there is plain HTML text written, takes that HTML to IE, and pastes it back as formatted text without HTML tags in the cell. I picked the code here: <a href=\"https://stackoverflow.com/questions/9999713/html-text-with-tags-to-formatted-text-in-an-excel-cell\">HTML Text with tags to formatted text in an Excel cell</a></p>\n\n<p>Contrary to that question I linked, I have to do this for a LOT of cells, so I want to speed up a little bit. Since <code>CreateObject(\"InternetExplorer.Application\")</code> takes a long time to process I am trying to use the same object several times, but it fails on the line <code>.Navigate \"about:blank\"</code> the second time it comes to it.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub ConvertHTMLrecu()\n    Dim Ie As Object\n    Dim rng As Range, rng2 As Range\n    Dim i As Integer\n    Dim iChr As Integer\n\n    i = 1\n    Set Ie = CreateObject(\"InternetExplorer.Application\")\n\n    For i = 1 To 40\n        Set rng = Feuil3.Range(\"A\" &amp; i)\n        Set rng2 = Feuil3.Range(\"C\" &amp; i)\n\n        With Ie\n            .Visible = False\n\n            .Navigate \"about:blank\"\n\n            .Document.body.InnerHTML = rng.Value\n\n            .ExecWB 17, 0\n            .ExecWB 12, 2\n\n            ActiveSheet.Paste Destination:=rng2\n\n            .Quit\n        End With\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p><strong>What I need</strong></p>\n\n<p>I would like one of two things. Either find a way to navigate to a blank page again so I can run the macro a second time without having to reset the object OR find a better way to format HTML text in Excel (since this is all this macro is doing).</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1467826595, "post_id": 38230113, "comment_id": 63882270, "body": "You are mixing R1C1 and A1 styles in the formula.  so change <code>ActiveCell.Address</code> to <code>ActiveCell.Address(1,1,xlR1C1)</code>  See: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837625.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff837625.aspx</a>"}, {"owner": {"reputation": 1, "user_id": 6557256, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154207290259336/picture?type=large", "display_name": "Steve S", "link": "https://stackoverflow.com/users/6557256/steve-s"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1473908168, "post_id": 38230113, "comment_id": 66322250, "body": "Thanks so much Scott, just got back to this and your suggestion worked perfectly as Im sure you knew.  Thanks again!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6557256, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154207290259336/picture?type=large", "display_name": "Steve S", "link": "https://stackoverflow.com/users/6557256/steve-s"}, "edited": false, "score": 0, "creation_date": 1473908226, "post_id": 38230287, "comment_id": 66322266, "body": "Thanks Brad for the detailed answer.  I just got back to this project and your suggestions worked brilliantly.  Much appreciated!"}], "tags": [], "owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "is_accepted": false, "score": 0, "last_activity_date": 1467826660, "creation_date": 1467826660, "answer_id": 38230287, "question_id": 38230113, "link": "https://stackoverflow.com/questions/38230113/how-can-i-use-a-variable-in-a-formula-vba-excel-run-time-error-1004/38230287#38230287", "title": "How can I use a variable in a formula vba excel run time error 1004", "body": "<p>When you are debugging look at the value of <code>ActiveCell.Address</code>. It is a string. You are setting this to a variable declared as <code>Dim ColumnLocationCFYearIDC As Integer</code>. This will not work. You need to declare your variable which will hold your address as either <code>variant</code> or <code>string</code>.</p>\n\n<p>However, in your formula you use <code>CellLocationCFYearDC</code> and <code>CellLocationCFYearTotal</code> which are not declared (maybe you didn't paste everything?). </p>\n\n<p>Be aware that you cannot use R1C1 style cell references and A1 style references. You'll need to use <code>.Address(ReferenceStyle:=xlR1C1)</code> when establishing your addressed.</p>\n"}], "owner": {"reputation": 1, "user_id": 6557256, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154207290259336/picture?type=large", "display_name": "Steve S", "link": "https://stackoverflow.com/users/6557256/steve-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467826660, "creation_date": 1467826080, "last_edit_date": 1531164843, "question_id": 38230113, "link": "https://stackoverflow.com/questions/38230113/how-can-i-use-a-variable-in-a-formula-vba-excel-run-time-error-1004", "title": "How can I use a variable in a formula vba excel run time error 1004", "body": "<p>Im trying to call upon a variable which contains a cell address in a formula in VBA, but keep getting run time error 1004.  Is the something wrong with my syntax?</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=(RC[-1]/\" &amp; CellLocationCFYearTotal &amp; \")* \" &amp; CellLocationCFYearDC &amp; \"\"\n</code></pre>\n\n<p>Or have I not declared the variable correctly?</p>\n\n<pre><code>Dim RowLocationCFYearIDC As Long 'can hold over 32000 if over this many rows\nDim ColumnLocationCFYearIDC As Integer 'columns won't exceed 256 in sheet\nDim CellLocationCFYearIDC As String\n\nCellLocationCFYearIDC = ActiveCell.Address\nRowLocationCFYearIDC = ActiveCell.Row\nColumnLocationCFYearIDC = ActiveCell.Column\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 6557019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1a6cf9e0b2409888e3a2b433eb68069?s=128&d=identicon&r=PG&f=1", "display_name": "Victoria", "link": "https://stackoverflow.com/users/6557019/victoria"}, "edited": false, "score": 0, "creation_date": 1467830661, "post_id": 38230965, "comment_id": 63884587, "body": "Thank you! This works perfect! How do I get it to also do the same thing for shipped stuff (but to the shipped worksheet)?  I tried to right another if statement after the first one, but it just seems to skip the shipped stuff. It doesn&#39;t break anything but only the cancelled works"}, {"owner": {"reputation": 25, "user_id": 6557019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1a6cf9e0b2409888e3a2b433eb68069?s=128&d=identicon&r=PG&f=1", "display_name": "Victoria", "link": "https://stackoverflow.com/users/6557019/victoria"}, "edited": false, "score": 0, "creation_date": 1467831519, "post_id": 38230965, "comment_id": 63885124, "body": "Thank you! The shipped part was in my original question :)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 25, "user_id": 6557019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1a6cf9e0b2409888e3a2b433eb68069?s=128&d=identicon&r=PG&f=1", "display_name": "Victoria", "link": "https://stackoverflow.com/users/6557019/victoria"}, "edited": false, "score": 0, "creation_date": 1467831734, "post_id": 38230965, "comment_id": 63885248, "body": "@Victoria - gotcha. I re-read. Glad this worked for you. Please mark as answered so others going forward can benefit."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1467830958, "last_edit_date": 1467830958, "creation_date": 1467828837, "answer_id": 38230965, "question_id": 38230065, "link": "https://stackoverflow.com/questions/38230065/copy-entire-row-to-another-excel-worksheet-then-delete-only-part-of-the-row/38230965#38230965", "title": "Copy entire row to another excel worksheet, then delete only part of the row", "body": "<p>Give this a shot. Note how I declare and assigned all my objects (except for <code>Rows.Count</code> because it's not important in this case).</p>\n\n<pre><code>Private Sub AutoMove_Click()\n\n    Dim wsCurr As Worksheet, wsPaste As Worksheet\n\n    Set wsCurr = Worksheets(\"Current LVA\")\n\n    Dim r As Range, Rng As Range\n    Set Rng = wsCurr.Range(\"V6:V201\")\n\n    For Each r In Rng\n\n        Select Case r.Value\n\n            Case Is = \"Cancelled\", \"Shipped\"\n\n                r.EntireRow.Copy\n                Set wsPaste = Worksheets(r.Value)\n                wsPaste.Cells(Rows.Count, 1).End(xlUp).Offset(1).PasteSpecial xlPasteValues\n                'this line will clear contents of B:R for the row in the Current sheet\n                wsCurr.Range(ws.Cells(r.Row, 2), ws.Cells(r.Row, 18)).ClearContents\n\n        End Select\n\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6557019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1a6cf9e0b2409888e3a2b433eb68069?s=128&d=identicon&r=PG&f=1", "display_name": "Victoria", "link": "https://stackoverflow.com/users/6557019/victoria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1918, "favorite_count": 0, "accepted_answer_id": 38230965, "answer_count": 1, "score": 1, "last_activity_date": 1467830958, "creation_date": 1467825925, "last_edit_date": 1467826761, "question_id": 38230065, "link": "https://stackoverflow.com/questions/38230065/copy-entire-row-to-another-excel-worksheet-then-delete-only-part-of-the-row", "title": "Copy entire row to another excel worksheet, then delete only part of the row", "body": "<p>So my main worksheet has a bunch of columns and the last column contains a formula that displays a status of either \"In Process\", \"on hold\", \"order placed\", \"at company\", \"shipped\", or \"cancelled\" depending on certain conditions. I'm trying to find a way to add a button that copies the cancelled to a sheet called cancelled and a shipped to a sheet called shipped orders. </p>\n\n<p>My problem is that I need to copy the row from A through V, paste only the values in the next blank row in my cancelled work sheet, and then go back to the main sheet and clear the contents in cells B through R because the other cells in that row have formulas that have to stay put and once B through R is cleared out the status changes. </p>\n\n<p>Can anyone help me out with this? This is all I have so far, it copies the cancelled rows but I don't know what to do after that to get it to delete the right parts.</p>\n\n<pre><code>Private Sub AutoMove_Click()\nSet Rng = Range(\"V6:V201\")\nagain:\nFor Each r In Rng\nIf r.Value = \"Cancelled\" Then\n    r.EntireRow.Copy\n    Worksheets(\"Cancelled\").Activate\n    erow = Worksheets(\"Cancelled\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n    ActiveSheet.Cells(erow, 1).Activate\n    Selection.PasteSpecial xlPasteValues\n    Worksheets(\"Current LVA\").Activate\n    End If\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-access-2003"], "answers": [{"comments": [{"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1467828554, "post_id": 38230737, "comment_id": 63883361, "body": "@Gustav well I&#39;m not editing this because your answer does basically what I&#39;d do except I&#39;d table drive."}, {"owner": {"reputation": 2761, "user_id": 1554692, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/daa49a34500c8d060160bea94fab3b9d?s=128&d=identicon&r=PG", "display_name": "GeneralMike", "link": "https://stackoverflow.com/users/1554692/generalmike"}, "edited": false, "score": 0, "creation_date": 1467829434, "post_id": 38230737, "comment_id": 63883848, "body": "Thanks for the response, but yeah, this is similar to one of the things I tried, and as Gustav pointed out, it still doesn&#39;t allow you to edit values."}], "tags": [], "owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "is_accepted": false, "score": 0, "last_activity_date": 1467828064, "creation_date": 1467828064, "answer_id": 38230737, "question_id": 38229944, "link": "https://stackoverflow.com/questions/38229944/adding-a-unit-toggle-to-ms-access-form/38230737#38230737", "title": "Adding a unit toggle to MS Access Form", "body": "<p>Just change what is displayed in the textbox. Set up the text box to have a control source of</p>\n\n<pre><code>=Length*txtConversionFactor\n</code></pre>\n\n<p>Where <code>txtConversionFactor</code> is a hidden textbox which either has <code>1</code> in it if your units are to be displayed in feet or 0.3048 if they are to be displayed in meters. It could even be a combobox bound to a table like this</p>\n\n<pre><code>MultiplyFeetByToGetOutputUnits    OutputUnits\n1                                 ft\n0.3048                            m\n12                                in\n0.000189394                       mile\n</code></pre>\n\n<p>Then you can convert to whatever you want without changing your form.</p>\n"}, {"comments": [{"owner": {"reputation": 2761, "user_id": 1554692, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/daa49a34500c8d060160bea94fab3b9d?s=128&d=identicon&r=PG", "display_name": "GeneralMike", "link": "https://stackoverflow.com/users/1554692/generalmike"}, "edited": false, "score": 0, "creation_date": 1467829321, "post_id": 38230742, "comment_id": 63883779, "body": "Thanks for the reply! I had tried something like this (with 1 query and a hidden textbox), but instead of putting the conversion in the code, I tried to just do it in the control source for txtLen, and I got the same results as I had with the 2 queries.  I tried it your way and moved it into the code, and it looks like it&#39;s working perfectly.  Thanks!"}, {"owner": {"reputation": 2761, "user_id": 1554692, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/daa49a34500c8d060160bea94fab3b9d?s=128&d=identicon&r=PG", "display_name": "GeneralMike", "link": "https://stackoverflow.com/users/1554692/generalmike"}, "edited": false, "score": 0, "creation_date": 1467830215, "post_id": 38230742, "comment_id": 63884311, "body": "One thing to note: looks like I need to have a <code>Me.Requery</code> in the <code>AfterUpdate</code> event for my radial button as well so that the screen is refreshed right after the user swaps between units."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 2761, "user_id": 1554692, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/daa49a34500c8d060160bea94fab3b9d?s=128&d=identicon&r=PG", "display_name": "GeneralMike", "link": "https://stackoverflow.com/users/1554692/generalmike"}, "edited": false, "score": 1, "creation_date": 1467831264, "post_id": 38230742, "comment_id": 63884947, "body": "Yes, forgot that, sorry. You could also just call <code>Form_Current</code> - that should be a lot faster."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 2, "last_activity_date": 1467828076, "creation_date": 1467828076, "answer_id": 38230742, "question_id": 38229944, "link": "https://stackoverflow.com/questions/38229944/adding-a-unit-toggle-to-ms-access-form/38230742#38230742", "title": "Adding a unit toggle to MS Access Form", "body": "<p>Use this query only:</p>\n\n<pre><code>SELECT A,B,C AS LEN,D,E\nFROM TABLE1\n</code></pre>\n\n<p>On your form, hide the textbox bound to LEN.</p>\n\n<p>Create a new unbound textbox, say, txtLEN.</p>\n\n<p>Now use code like this where SelectMetric is the checkbox to mark when using metric values:</p>\n\n<pre><code>Private Sub Form_Current()\n\n    Dim Factor As Currency\n\n    If Me!SelectMetric.Value = True Then\n        Factor = 0.3048\n    Else\n        Factor = 1\n    End If        \n    Me!txtLen.Value = Factor * Me!LEN.Value\n\nEnd Sub\n\nPrivate Sub txtLen_AfterUpdate()\n\n    Dim Factor As Currency\n\n    If Me!SelectMetric.Value = True Then\n        Factor = 0.3048\n    Else\n        Factor = 1\n    End If        \n    Me!Len.Value = Me!txtLEN.Value / Factor\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2761, "user_id": 1554692, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/daa49a34500c8d060160bea94fab3b9d?s=128&d=identicon&r=PG", "display_name": "GeneralMike", "link": "https://stackoverflow.com/users/1554692/generalmike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 38230742, "answer_count": 2, "score": 0, "last_activity_date": 1467828076, "creation_date": 1467825521, "last_edit_date": 1467826694, "question_id": 38229944, "link": "https://stackoverflow.com/questions/38229944/adding-a-unit-toggle-to-ms-access-form", "title": "Adding a unit toggle to MS Access Form", "body": "<p><strong>TL;DR</strong></p>\n\n<p>I'm trying to perform some calculations on the values entered to a data entry form before saving them into a table.</p>\n\n<hr>\n\n<p><strong>Background</strong></p>\n\n<p>I have a form in MS Access that serves as a front end for entering data into our database.  It is mostly distance data between a datum and various objects.  The database and the applications that use that data have all been set up expecting all the measurements in feet, but a lot of our sources for the data are in meters.  In the past, the user had to convert the data on their own before inputting it into the form.  This extra step slows down productivity, and increases the chance of user error.</p>\n\n<p>What I want to do is add a radial button to my form that lets the user swap between meters and feet.  When it is swapped to meters, all the values for that record are converted to their meter equivalent before being displayed on the screen.  If the user changes a record or creates a new one, the form will need to convert the values back into feet before updating the table.  It's very important that the values in the table always remain in feet.</p>\n\n<p>I was able to find <a href=\"http://answers.microsoft.com/en-us/office/forum/office_2003-access/conditional-record-source-for-a-form/752c0164-8035-48fa-82a4-844ce5ac4b3d?auth=1\" rel=\"nofollow\">this article</a> that describes how to swap between record sources for a form.  I think I can just set up 2 queries - one that pulls the data directly from the table, and one that performs the conversion - and swap between the queries as my record source when the user toggles the radial button.</p>\n\n<hr>\n\n<p><strong>The Problem</strong></p>\n\n<p>The issue with this set up is that since I have to use aliases in my queries to perform the conversion, the user cannot enter data while the radial is toggled to meters.  If I try to update one of those fields, I just get a bing noise and the input is ignored.  <strong>Is there any way to allow inputs when the radial is toggled to meters?</strong>  As I said above, it is important that the data in the table is always in feet, so if the user has the 'meters' option selected and inputs a value like <code>500</code>, the value entered into the table should be <code>1640</code>, which is the result from the conversion to feet.</p>\n\n<hr>\n\n<p><strong>Sample</strong></p>\n\n<p>Here's simplified example of what my queries look like</p>\n\n<p>FEET query</p>\n\n<pre><code>SELECT A,B,C AS LEN,D,E\nFROM TABLE1\n</code></pre>\n\n<p>METERS query</p>\n\n<pre><code>SELECT A,B,C/0.3048 AS LEN,D,E\nFROM TABLE1\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1467825226, "post_id": 38229799, "comment_id": 63881460, "body": "Use the <a href=\"https://msdn.microsoft.com/en-us/library/aa263365(v=vs.60).aspx\" rel=\"nofollow noreferrer\">Split function</a> and loop from <a href=\"https://msdn.microsoft.com/en-us/library/t9a7w1ac(v=vs.90).aspx\" rel=\"nofollow noreferrer\">LBound</a> to <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278658.aspx\" rel=\"nofollow noreferrer\">UBound</a>."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1467825460, "post_id": 38229799, "comment_id": 63881610, "body": "What is your question?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1467825462, "post_id": 38229799, "comment_id": 63881612, "body": "Your description is ambiguous -- is your function supposed to accept an <i>array</i> (which is what you actually describe the input as) or a <i>string</i> (which is what your example input is). Also -- what would the return value for input <code>9005110-4400</code> be? True -- it just contains two number, or Fasle -- it contains the nonnumeric character <code>-</code>?"}, {"owner": {"reputation": 1, "user_id": 6557275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a1f3f2b58388d759f67a645e765457?s=128&d=identicon&r=PG&f=1", "display_name": "Cody Lakin", "link": "https://stackoverflow.com/users/6557275/cody-lakin"}, "edited": false, "score": 0, "creation_date": 1467826340, "post_id": 38229799, "comment_id": 63882128, "body": "I&#39;m sorry, I should be more clear. The error was that excel kept saying &quot;#VALUE.&quot; And the goal is to be able to put in something like &quot;K03778&quot; and have it return false. It should return true for &quot;1111&quot; because it contains all numbers."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1467826803, "post_id": 38229799, "comment_id": 63882375, "body": "The error that you got was due to trying to pass a string as an array. In VBA strings are not arrays and you can&#39;t loop through them with a for-each loop like that."}], "answers": [{"tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": false, "score": 1, "last_activity_date": 1467825967, "creation_date": 1467825967, "answer_id": 38230079, "question_id": 38229799, "link": "https://stackoverflow.com/questions/38229799/check-an-array-for-non-numeric-characters/38230079#38230079", "title": "Check an array for non-numeric characters", "body": "<p>I assume you want a function that takes an array of strings and checks them for nun-numeric values. Then your question would be, why your function always returns <code>False</code>.</p>\n\n<p>The default value of a <code>Boolean</code> is false so you need to set <code>ContainsAllNumbers = True</code> at the beginning of the function.</p>\n\n<p>I also recommend using <code>Option Explicit</code> so you don't forget to <code>Dim</code> your variables.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6557275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a1f3f2b58388d759f67a645e765457?s=128&d=identicon&r=PG&f=1", "display_name": "Cody Lakin", "link": "https://stackoverflow.com/users/6557275/cody-lakin"}, "edited": false, "score": 0, "creation_date": 1467893829, "post_id": 38230173, "comment_id": 63911585, "body": "Thanks for your help! Apologies for the confusion. I was intent upon figuring it out myself, but I had never used VBA. I really appreciate your help, as well as everyone else&#39;s."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 1, "last_activity_date": 1467826868, "last_edit_date": 1467826868, "creation_date": 1467826284, "answer_id": 38230173, "question_id": 38229799, "link": "https://stackoverflow.com/questions/38229799/check-an-array-for-non-numeric-characters/38230173#38230173", "title": "Check an array for non-numeric characters", "body": "<p>Here is a (debugged) function which takes a string input and returns <code>True</code> if and only if all of the characters in the string are digits. This is (perhaps) what you are trying to do:</p>\n\n<pre><code>Function AllDigits(s As String) As Boolean\n    Dim i As Long\n    For i = 1 To Len(s)\n        If Not IsNumeric(Mid(s, i, 1)) Then\n            AllDigits = False\n            Exit Function\n        End If\n    Next i\n    AllDigits = True\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 165, "user_id": 6499901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a089fe0017c8d9a16f386996646ef3ff?s=128&d=identicon&r=PG&f=1", "display_name": "nick", "link": "https://stackoverflow.com/users/6499901/nick"}, "is_accepted": false, "score": 0, "last_activity_date": 1467829941, "creation_date": 1467829941, "answer_id": 38231290, "question_id": 38229799, "link": "https://stackoverflow.com/questions/38229799/check-an-array-for-non-numeric-characters/38231290#38231290", "title": "Check an array for non-numeric characters", "body": "<p>Convert the characters to their ascii code and check each of them. You can Look up an ascii table to find out the specific values for certain characters.</p>\n\n<p>As an example I just copied this from one of my macros. It checks for non-alphanumeric values in the input string str:</p>\n\n<pre><code>invalidCharacter = false\nFor pos = 1 To Len(str) \nSelect Case Asc(Mid(str, pos, 1)) 'ascii value of character at str(pos)\n        Case 48 To 57, 65 To 90, 97 To 122 '0-9,a-z,A-Z\n            'nothing\n        Case Else\n            invalidCharacter = True\n    End Select\nNext pos\nIf invalidCharacter Then\n    MsgBox \"only numbers or letters may be used\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6557275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a1f3f2b58388d759f67a645e765457?s=128&d=identicon&r=PG&f=1", "display_name": "Cody Lakin", "link": "https://stackoverflow.com/users/6557275/cody-lakin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1241, "favorite_count": 0, "accepted_answer_id": 38230173, "answer_count": 3, "score": 0, "last_activity_date": 1499497339, "creation_date": 1467825051, "last_edit_date": 1499497339, "question_id": 38229799, "link": "https://stackoverflow.com/questions/38229799/check-an-array-for-non-numeric-characters", "title": "Check an array for non-numeric characters", "body": "<p>I am trying to create a function that will check an array for non-numeric characters. I'm sure there is a way with existing functions, but I was hoping to make a clean function.</p>\n\n<p>This is what I have:</p>\n\n<pre><code>Public Function ContainsAllNumbers(Text() As Variant) As Boolean\n\n    For Each element In Text\n\n        If Not IsNumeric(element) Then\n\n            ContainsAllNumbers = False\n\n        End If\n\n    Next\n\nEnd Function\n</code></pre>\n\n<p>The arguments I want it to take would be something like 11013688 or K03778 or 9005110-4400. I need to know if these strings contain something that is not a number.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1467826186, "post_id": 38229767, "comment_id": 63882041, "body": "Do you have a list of users you want to notify, or do you need to collect those from users who access the Workbook?"}], "answers": [{"tags": [], "owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "is_accepted": false, "score": 0, "last_activity_date": 1467839497, "creation_date": 1467839497, "answer_id": 38233834, "question_id": 38229767, "link": "https://stackoverflow.com/questions/38229767/vba-excel-display-message-box-for-all-users-of-a-shared-workbook/38233834#38233834", "title": "VBA Excel display message box for all users of a shared workbook", "body": "<p>I'm sure you already know this, but shared workbooks do not maintain a \"connection\" to the shared file per se. What happens is that each user opens a copy of the file into their own computer's memory, and then only when they save will Excel check their local copy against the file. It is only at that point that any changes are known.</p>\n\n<p>When the user saves the workbook, then if other people's changes have been made in the meantime, Excel's native functionality already pops up a message saying that the workbook has been updated by other users.</p>\n\n<p>If, on the other hand, you're looking for a function which would automatically pop up a message immediately when other users save the file, then it can't be done (because, as I said above, there is no live connection present). The closest thing to that would be to ensure that the workbook was saved regularly via an Application.Ontime recurring event.</p>\n"}], "owner": {"reputation": 1, "user_id": 6557289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e970c0dc567e43a4cf8721d8a2b60b2?s=128&d=identicon&r=PG", "display_name": "user6557289", "link": "https://stackoverflow.com/users/6557289/user6557289"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 909, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467839497, "creation_date": 1467824940, "last_edit_date": 1531164843, "question_id": 38229767, "link": "https://stackoverflow.com/questions/38229767/vba-excel-display-message-box-for-all-users-of-a-shared-workbook", "title": "VBA Excel display message box for all users of a shared workbook", "body": "<p>I have a shared workbook that is updated with new data throughout the day. I'd like to be able to run a macro that will accept some text. for example: \" Workbook has been updated\" and display this in a message box for each user of the shared workbook. Is this possible? </p>\n\n<p>I do not have an option to in share the workbook in case that matters.</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1467825088, "post_id": 38229654, "comment_id": 63881371, "body": "@ScottCraner - that is vb.net code, which may throw the OP given the differences in syntax"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467825222, "post_id": 38229654, "comment_id": 63881457, "body": "@ScottHoltzman So it was.  My bad."}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 3, "last_activity_date": 1467825126, "creation_date": 1467825126, "answer_id": 38229826, "question_id": 38229654, "link": "https://stackoverflow.com/questions/38229654/prompting-user-to-select-an-option-in-vba/38229826#38229826", "title": "Prompting user to select an option in VBA?", "body": "<p>Use a standard <code>MsgBox</code> prompt, and only call on your procedure if the response is \"Yes\". </p>\n\n<p>Here is an example, basically you will \"run\" the procedure that does the validation (Yes/No), and if the response is yes, then this procedure runs <em>your</em> other macro.</p>\n\n<pre><code>Sub DoXYZ()\nDim mb as Long\n\nmb = MsgBox(\"Are you sure that XYZ?\", vbYesNo)\n\nIf mb = vbYes Then\n    Call \"YourOtherMacro\" '## MODIFY WITH YOUR PROCEDURE'S NAME\nEnd If\n\n'Note: a response of vbNo will do nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1381, "user_id": 5072010, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8f044c7b7dee6227de800f0ade7a82c3?s=128&d=identicon&r=PG&f=1", "display_name": "Runeaway3", "link": "https://stackoverflow.com/users/5072010/runeaway3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 728, "favorite_count": 0, "accepted_answer_id": 38229826, "answer_count": 1, "score": 0, "last_activity_date": 1467825126, "creation_date": 1467824588, "question_id": 38229654, "link": "https://stackoverflow.com/questions/38229654/prompting-user-to-select-an-option-in-vba", "title": "Prompting user to select an option in VBA?", "body": "<p>I want to run a macro, but I would like the macro to, when it is run, prompt the user with something like \"Are you sure that XYZ?\" and have the prompt have two buttons, \"Yes\" which when clicked on proceeds to run the rest of the macro's actual function and \"No\" which kills the macro and allows user to first check XYZ before initiating the macro. I know I can prompt the user to input a value, but how do I get them to have only two buttons to select in the prompt?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1467826763, "post_id": 38229599, "comment_id": 63882357, "body": "It&#39;s hard to tell without seeing the &quot;~bunch of code~&quot;, but you should probably extract the loop from <code>Sub AlertFinder</code> into its own <code>Sub</code> instead of using recursion."}, {"owner": {"reputation": 71, "user_id": 6466375, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/52ee600c33fb5df0d038e42d91bf8a26?s=128&d=identicon&r=PG&f=1", "display_name": "A.Cod", "link": "https://stackoverflow.com/users/6466375/a-cod"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1467827386, "post_id": 38229599, "comment_id": 63882748, "body": "thank you! do you mind elaborating?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1467830126, "post_id": 38229599, "comment_id": 63884255, "body": "The loop is keeping the script alive.  There is no reason to call <code>AlertFinder (strTemp)</code> again.  What is happening is that every 5 minutes you creating another copy of AlertFinder.  In 5 mins you have 2 copies of AlertFinder running, in 10 minutes there are 4 copies, in 15 minutes there are 16 copies....etc."}, {"owner": {"reputation": 71, "user_id": 6466375, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/52ee600c33fb5df0d038e42d91bf8a26?s=128&d=identicon&r=PG&f=1", "display_name": "A.Cod", "link": "https://stackoverflow.com/users/6466375/a-cod"}, "edited": false, "score": 0, "creation_date": 1467831528, "post_id": 38229599, "comment_id": 63885129, "body": "@ThomasInzina, i&#39;m sorry but thats not true. The code isn&#39;t even running because I&#39;m getting an error when calling AlertFinder(strTemp) in the loop. I ran the code the same way but with strTemp declared as an array in the AlertFinder sub, and the code works fine without multiplying itself."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1467831925, "post_id": 38229599, "comment_id": 63885364, "body": "The error is because you are calling a sub using parenthesis .  <code>AlertFinder strTemp</code> will fix the error."}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 6466375, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/52ee600c33fb5df0d038e42d91bf8a26?s=128&d=identicon&r=PG&f=1", "display_name": "A.Cod", "link": "https://stackoverflow.com/users/6466375/a-cod"}, "is_accepted": false, "score": 0, "last_activity_date": 1467832845, "creation_date": 1467832845, "answer_id": 38232131, "question_id": 38229599, "link": "https://stackoverflow.com/questions/38229599/vba-passing-variable-to-recurring-sub/38232131#38232131", "title": "VBA Passing Variable to Recurring Sub", "body": "<p>Thanks to those who commented. What I ended up doing was declaring strTemp as a Public variable so it could be given a value in GetKeyword, and passed onto AlertFinder, while AlertFinder could also call itself (then removed all instances of strTemp() being declared in the GetKeyword sub). Worked just fine.</p>\n\n<p>Public strTemp() as Variant</p>\n\n<p>before all the subprocedures did the trick. Hope this helps anyone else with the same problem. </p>\n"}], "owner": {"reputation": 71, "user_id": 6466375, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/52ee600c33fb5df0d038e42d91bf8a26?s=128&d=identicon&r=PG&f=1", "display_name": "A.Cod", "link": "https://stackoverflow.com/users/6466375/a-cod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1467832845, "creation_date": 1467824394, "last_edit_date": 1531164843, "question_id": 38229599, "link": "https://stackoverflow.com/questions/38229599/vba-passing-variable-to-recurring-sub", "title": "VBA Passing Variable to Recurring Sub", "body": "<p>I have two subs. The first sub (GetKeyWord) asks the user for keywords and stores them in a string array. The next sub (AlertFinder) takes in the particular string array and searches for it in a webpage. However, I want AlertFinder to run every x amount of minutes, but I don't want the user to be asked what keywords he/she is looking for everytime AlertFinder runs (only want to ask the user once at the beginning and have the string array stay constant after that). This is why I made GetKeyWord a separate sub, but now I am having trouble making AlertFinder run since it requres the string array from GetKeyWord to run. </p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub GetKeyWords()\n\n\nDim numKey As Integer\nDim strTemp() As Variant\n\n'Input Keywords\n\nnumKey = InputBox(\"How many keywords would you like to search for? (Integer)\", \"Integer Value Please\")\n\n\n\n\nFor k = 1 To numKey\n    ReDim Preserve strTemp(numKey - 1)\n    strTemp(k - 1) = InputBox(\"Please enter keyword\" &amp; k)\n\n\nNext\n\n\n'Execute Alert Finder\nCall AlertFinder(strTemp)\nEnd Sub\n\n\nSub AlertFinder(strTemp() As Variant)\n\n\n'Set Variables\nDim boolFound As Boolean\nDim txt As String\nDim strOutput As String\nDim tbl As HTMLTable, tables As IHTMLElementCollection\nDim tr As HTMLTableRow, r As Integer, i As Integer\nDim tRows As IHTMLElementCollection\nDim ie As InternetExplorer\nDim strCurrent As Variant\n\n~bunch of code~\n\n     Set ieDoc = ie.Document\n\n    'Loop to refresh webpage every 25 minutes\n    Do While True\n\n        'Pause the script for x minutes\n        Application.Wait (Now + TimeValue(\"00:05:00\"))\n\n        'AFter time is up, reload page and run Alert Finder Again\n        ieDoc.Location.Reload (True)\n        AlertFinder (strTemp)\n\n        If Err &lt;&gt; 0 Then\n\n            Wscript.Quit\n        End If\n    Loop\n\n    Set ie = Nothing\n  End Sub\n</code></pre>\n\n<p>The trouble arises where I try to call AlertFinder(strTemp) within AlertFinder itself, but strTemp comes from GetKeyWord which I want to remain constant and not have to run GetKeyWord every 5 minutes. Any help would be appreciated!</p>\n"}, {"tags": ["vba", "excel", "if-statement", "excel-formula"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467822384, "post_id": 38228979, "comment_id": 63879754, "body": "Would it be better to use dynamic validation to achieve this?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1467822411, "post_id": 38228979, "comment_id": 63879775, "body": "You can&#39;t hide individual cells. Do you want to hide the entire row?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 3, "creation_date": 1467822777, "post_id": 38228979, "comment_id": 63880012, "body": "Maybe no need for any <code>IF</code>. Assuming you want entire rows hidden: <code>Range(&quot;B19:B53&quot;).EntireRow.Hidden = Range(&quot;B17&quot;).Value = &quot;Yes&quot; </code> and  <code>Range(&quot;B19:B34&quot;).EntireRow.Hidden = Not(Range(&quot;B17&quot;).Value = &quot;No&quot;)</code>"}, {"owner": {"reputation": 13, "user_id": 6557070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e19120d77afe5cbd8e3c2dedc61f372?s=128&d=identicon&r=PG&f=1", "display_name": "Adam McClelland", "link": "https://stackoverflow.com/users/6557070/adam-mcclelland"}, "edited": false, "score": 0, "creation_date": 1467823363, "post_id": 38228979, "comment_id": 63880347, "body": "New to this forum.  How do I post my current code? Its over character by 338!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1467823394, "post_id": 38228979, "comment_id": 63880369, "body": "Put it in the original post using edit."}, {"owner": {"reputation": 13, "user_id": 6557070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e19120d77afe5cbd8e3c2dedc61f372?s=128&d=identicon&r=PG&f=1", "display_name": "Adam McClelland", "link": "https://stackoverflow.com/users/6557070/adam-mcclelland"}, "edited": false, "score": 0, "creation_date": 1467823683, "post_id": 38228979, "comment_id": 63880549, "body": "apologies this is probably really basic stuff!"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467823736, "post_id": 38228979, "comment_id": 63880575, "body": "Is <code>B17</code> a drop-down choice after the user would select the option in <code>B14</code>?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1467823796, "post_id": 38228979, "comment_id": 63880622, "body": "No problem, we all started somewhere not too far from there - see the <b><a href=\"https://stackoverflow.com/posts/38228979/edit\">edit</a></b> link under the tags? (or, well, right here in this comment). Also make sure you read the <a href=\"http://stackoverflow.com/editing-help\"><b>editing help</b></a>, as code blocks need 4 leading spaces to be recognized as such."}, {"owner": {"reputation": 13, "user_id": 6557070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e19120d77afe5cbd8e3c2dedc61f372?s=128&d=identicon&r=PG&f=1", "display_name": "Adam McClelland", "link": "https://stackoverflow.com/users/6557070/adam-mcclelland"}, "edited": false, "score": 0, "creation_date": 1467824502, "post_id": 38228979, "comment_id": 63881014, "body": "B14 &amp; B17 are both drop down menus. B17 only needs to appear if Option one is selected in B14. It doesn&#39;t appear for option 2/3 at the minute which is right. So the idea is cells B16:B35 only appear if the user selects NO to the second drop down which appears."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6557070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e19120d77afe5cbd8e3c2dedc61f372?s=128&d=identicon&r=PG&f=1", "display_name": "Adam McClelland", "link": "https://stackoverflow.com/users/6557070/adam-mcclelland"}, "edited": false, "score": 0, "creation_date": 1467826783, "post_id": 38229677, "comment_id": 63882365, "body": "Fantastic Scott thank you.  Only issue is when I open the document the options which appear if second dropdown is a &#39;NO&#39; have appeared already and if I select Option 1 in the first drop down it already loads with the &#39;YES&#39; option to the second and the following questions?"}, {"owner": {"reputation": 13, "user_id": 6557070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e19120d77afe5cbd8e3c2dedc61f372?s=128&d=identicon&r=PG&f=1", "display_name": "Adam McClelland", "link": "https://stackoverflow.com/users/6557070/adam-mcclelland"}, "edited": false, "score": 0, "creation_date": 1467827094, "post_id": 38229677, "comment_id": 63882562, "body": "Basically I would like it so when I open the document all the extra questions are hidden and it only shows til Row 14 (with everything else hidden).  If Option 2 or 3 are selected then these work ok.  If option 1 is selected it then only shows cells B16 &amp; B17 extra and only unhides the following questions if NO is selected in B17?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 13, "user_id": 6557070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e19120d77afe5cbd8e3c2dedc61f372?s=128&d=identicon&r=PG&f=1", "display_name": "Adam McClelland", "link": "https://stackoverflow.com/users/6557070/adam-mcclelland"}, "edited": false, "score": 0, "creation_date": 1467827485, "post_id": 38229677, "comment_id": 63882799, "body": "@AdamMcClelland - Are you stating how you would <i>like</i> it to behave in the last sentence (about Option 1) in your last comment?"}, {"owner": {"reputation": 13, "user_id": 6557070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e19120d77afe5cbd8e3c2dedc61f372?s=128&d=identicon&r=PG&f=1", "display_name": "Adam McClelland", "link": "https://stackoverflow.com/users/6557070/adam-mcclelland"}, "edited": false, "score": 0, "creation_date": 1467827589, "post_id": 38229677, "comment_id": 63882855, "body": "Yes.  So when opened only cells B4:B14 appear. If Option 1 is selected only cells B16&amp;B17 (second drop down) appear and then cells B19:B35 will appear if NO is selected from second drop down.  If option 2 is selected only B4:B15 and B36 appear.  If option 3 is selected B4:B14 and B37:B53 will appear."}, {"owner": {"reputation": 13, "user_id": 6557070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e19120d77afe5cbd8e3c2dedc61f372?s=128&d=identicon&r=PG&f=1", "display_name": "Adam McClelland", "link": "https://stackoverflow.com/users/6557070/adam-mcclelland"}, "edited": false, "score": 0, "creation_date": 1467827971, "post_id": 38229677, "comment_id": 63883058, "body": "When all drop downs are blank (using empty cell in validation) cells B35:B53 still appear? Also as the dropdown is blank for B17 (again using blank cell in validation) it shows cells B19:B53. If I select No from B17 it shows B37:B53 which shouldn&#39;t show?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 13, "user_id": 6557070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e19120d77afe5cbd8e3c2dedc61f372?s=128&d=identicon&r=PG&f=1", "display_name": "Adam McClelland", "link": "https://stackoverflow.com/users/6557070/adam-mcclelland"}, "edited": false, "score": 0, "creation_date": 1467828313, "post_id": 38229677, "comment_id": 63883248, "body": "@AdamMcClelland - i made another edit. if you need all these test cases that you are giving you should state such up front. I have given you a very solid shell. You can easily debug and edit for any more test cases that come up. If not, please post another question and we are happy to serve in that way."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 3, "last_activity_date": 1467828256, "last_edit_date": 1467828256, "creation_date": 1467824655, "answer_id": 38229677, "question_id": 38228979, "link": "https://stackoverflow.com/questions/38228979/vba-excel-double-if/38229677#38229677", "title": "VBA Excel Double If", "body": "<p>I tested the below code and it appears to be behaving as you desire. I did make some seemingly significant changes to the structure, but I did so in hopes of making it both easier to read and maintain going forward. I think my edits are self-explanatory.</p>\n\n<p>I also took the liberty to assume this is a <code>Worksheet_Change</code> event even though you did not explicity state as such.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nSelect Case Target.Address\n\n    Case Is = \"$B$14\"\n\n        Select Case Right(Left(Target.Value, 8), 1)\n\n            Case Is = 1 'Option 1\n\n                Me.Rows(\"16:17\").EntireRow.Hidden = False\n\n            Case Is = 2 'Option 2\n\n                Me.Rows(\"15\").EntireRow.Hidden = False\n                Me.Rows(\"16:17\").EntireRow.Hidden = True\n                Me.Rows(\"19:35\").EntireRow.Hidden = True\n                Me.Rows(\"36\").EntireRow.Hidden = False\n                Me.Rows(\"37:55\").EntireRow.Hidden = True\n\n            Case Is = 3 'Option 3\n\n                Me.Rows(\"15:36\").EntireRow.Hidden = True\n                Me.Rows(\"39:55\").EntireRow.Hidden = False\n\n            Case Else \n\n                Me.Rows(\"15:55\").EntireRow.Hidden = True\n\n        End Select\n\n\n    Case Is = \"$B$17\"\n\n        Me.Range(\"B19:B35\").EntireRow.Hidden = Not (Target.Value = \"No\")\n\nEnd Select\n\nEnd Sub\n</code></pre>\n\n<p>Here's the code to make sure all rows are hidden when the workbook is opened.</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nWith Me.Worksheets(\"SheetName\") ' change as needed\n    .Rows(\"1:3\").EntireRow.Hidden = True\n    .Rows(\"15:55\").EntireRow.Hidden = True\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6557070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e19120d77afe5cbd8e3c2dedc61f372?s=128&d=identicon&r=PG&f=1", "display_name": "Adam McClelland", "link": "https://stackoverflow.com/users/6557070/adam-mcclelland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 38229677, "answer_count": 1, "score": 1, "last_activity_date": 1467828256, "creation_date": 1467822255, "last_edit_date": 1531164843, "question_id": 38228979, "link": "https://stackoverflow.com/questions/38228979/vba-excel-double-if", "title": "VBA Excel Double If", "body": "<p>I have various dropdown menus in the document and need to create a double conditional statement.</p>\n\n<p>So I am trying to do the following:</p>\n\n<pre><code>If Cell B14 = Option 1 Then unhide Cells B16:B17\nIf Cells B17 = Yes Then hide Cells B19:B53\nIf Cells B17 = No Then show Cells B19:B34\n</code></pre>\n\n<p>So if someone picks <code>Option 1</code> from the dropdown menu then there is another drop down menu that appear and if they select <code>Yes</code> from the second on it hide the required cells and if they pick <code>No</code> it unhides the required cells.  </p>\n\n<p>Options 2 &amp; 3 in the first dropdown menu do not need to show the second drop down box.</p>\n\n<p>I have it all working apart from the double if.</p>\n\n<p>Current code is:</p>\n\n<pre><code>If Target.Address = \"$B$14\" Then\n\n    If Range(\"B14\") = \"Option 1: Travel Home\" Then\n        ActiveSheet.Rows(\"16:35\").EntireRow.Hidden = False\n        ActiveSheet.Rows(\"36:55\").EntireRow.Hidden = True\n    ElseIf Range(\"B14\") = \"Option 2: Travel to next city\" Then\n        ActiveSheet.Rows(\"15\").EntireRow.Hidden = False\n        ActiveSheet.Rows(\"16:17\").EntireRow.Hidden = True\n        ActiveSheet.Rows(\"19:35\").EntireRow.Hidden = True\n        ActiveSheet.Rows(\"36\").EntireRow.Hidden = False\n        ActiveSheet.Rows(\"37:55\").EntireRow.Hidden = True\n    ElseIf Range(\"B14\") = \"Option 3: Make own arrangements\" Then\n        ActiveSheet.Rows(\"15:36\").EntireRow.Hidden = True\n        ActiveSheet.Rows(\"39:55\").EntireRow.Hidden = False\n    End If\n\nEnd If\n</code></pre>\n\n<p>Option 2 and 3 are working OK just option 1 isn't working to unhide/hide whats necessary and also then need to do the second dropdown option which the alters what is shown.</p>\n"}, {"tags": ["sql", "sql-server", "excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 4, "creation_date": 1467821541, "post_id": 38228636, "comment_id": 63879273, "body": "This is pretty scary to me. The b_insert_into_table method is wide open to sql injection. Why not use a stored procedure with parameters. Do you really change the table definition so frequently that you can&#39;t use an explicit list of columns?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1467821964, "post_id": 38228636, "comment_id": 63879491, "body": "@SeanLange, it is opened to SQL injection, indeed. I would pay attention to this later, this is really internal application, made for small amount of trusted users. So far I don&#39;t know how many times I would need to change columns, but the idea is to be as flexible as possible. And exactly because of reasons like this, I am looking for some library or something else."}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 2, "creation_date": 1467822213, "post_id": 38228636, "comment_id": 63879653, "body": "Don&#39;t get stuck in the trap of &quot;there aren&#39;t many users and they all work here&quot; to allow sql injection. It is incredibly difficult to fix injection later, it is easy to fix now. Parameterizing queries is more than just injection proof, it is far easier to maintain and debug."}, {"owner": {"reputation": 166, "user_id": 1866330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90418acdf67758235c6277d0c3ca5852?s=128&d=identicon&r=PG", "display_name": "Kevin Nowaczyk", "link": "https://stackoverflow.com/users/1866330/kevin-nowaczyk"}, "edited": false, "score": 1, "creation_date": 1542661768, "post_id": 38228636, "comment_id": 93641217, "body": "I&#39;m the lead developer for a flexible VBA/SQL library that would be perfect for this (<a href=\"https://github.com/Beakerboy/VBA-SQL-Library\" rel=\"nofollow noreferrer\">github.com/Beakerboy/VBA-SQL-Library</a>)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 166, "user_id": 1866330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90418acdf67758235c6277d0c3ca5852?s=128&d=identicon&r=PG", "display_name": "Kevin Nowaczyk", "link": "https://stackoverflow.com/users/1866330/kevin-nowaczyk"}, "edited": false, "score": 0, "creation_date": 1542663038, "post_id": 38228636, "comment_id": 93641744, "body": "@KevinNowaczyk - thanks for sharing even on a closed question. In general, I am always happy to see anything developed in VBA. Even, when I go to some companies for other reasons, I am always happy to see their VBA code. Anyway, now the not so fancy stuff - the library is the dream of a 12 year old hacker, who has just heard about SQL injection. (Unfortunately Sean Lange really has a point in both his comments). Looked this part, <code>ReturnString = &quot;INSERT INTO &quot; &amp; sTable &amp; ImplodeFields</code> the <code>sTable</code> is where the injection can come easily. Still, keep up your interest, thumbs up! :)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1542663077, "post_id": 38228636, "comment_id": 93641763, "body": "This is a good article on my blog exactly for this - <a href=\"https://www.vitoshacademy.com/automagic-secure-adodb/\" rel=\"nofollow noreferrer\">vitoshacademy.com/automagic-secure-adodb</a> (I would have written a disclaimer here, but noone reads the comments of a closed question...)"}, {"owner": {"reputation": 166, "user_id": 1866330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90418acdf67758235c6277d0c3ca5852?s=128&d=identicon&r=PG", "display_name": "Kevin Nowaczyk", "link": "https://stackoverflow.com/users/1866330/kevin-nowaczyk"}, "edited": false, "score": 0, "creation_date": 1542723268, "post_id": 38228636, "comment_id": 93665189, "body": "@Vityata - Thanks for reviewing the repository. In the README I comment that this should be used with defined data objects. I have a library to interact with Drupal Entities which does this. These DrupalEntity objects define each table schema and use the SQL Library only to build the SQL. It also checks the type of the user-provided data, escapes single quotes, and takes substrings of user-provided strings to ensure that data is not longer than the database field will accept. I agree,the SQL-library I linked to should be one piece of a larger project."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 166, "user_id": 1866330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90418acdf67758235c6277d0c3ca5852?s=128&d=identicon&r=PG", "display_name": "Kevin Nowaczyk", "link": "https://stackoverflow.com/users/1866330/kevin-nowaczyk"}, "edited": false, "score": 0, "creation_date": 1542726408, "post_id": 38228636, "comment_id": 93667078, "body": "@KevinNowaczyk - welcome. I just took a quick look. Anyway, make sure to put this info in the README, that it is not injectable with big letters, because of that reason... Some people like me, who read diagonally (and mainly the code) would appreciate it."}], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1467824780, "post_id": 38228935, "comment_id": 63881185, "body": "Thanks. I will probably use the ADO."}], "tags": [], "owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "is_accepted": false, "score": 2, "last_activity_date": 1467822119, "creation_date": 1467822119, "answer_id": 38228935, "question_id": 38228636, "link": "https://stackoverflow.com/questions/38228636/vba-is-there-a-library-for-vba-interaction-with-sql-server/38228935#38228935", "title": "VBA - Is there a library for VBA interaction with SQL Server", "body": "<p>If you're using ADO that's the way to go. </p>\n\n<p>However, you can use it more wisely. You can still make dynamic inserts but you should parameterize them. The SQL Injection stuff is not just about malicious users doing bad things with your data base (unlikely if you are making an Excel Add-in) but more to protect against bad data. They way it is written right now, if you have nay entry in <code>arr_values</code> with a <code>\"</code> your query will be broken. If you have any column in <code>arr_column_names</code> with a space, the query will break. </p>\n"}, {"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1467824732, "post_id": 38229022, "comment_id": 63881158, "body": "Thanks, I will definitely handle the inputs. Pretty much 95% all of them are going to be numbers, thus it should not be an issue."}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": false, "score": 2, "last_activity_date": 1467822429, "creation_date": 1467822429, "answer_id": 38229022, "question_id": 38228636, "link": "https://stackoverflow.com/questions/38228636/vba-is-there-a-library-for-vba-interaction-with-sql-server/38229022#38229022", "title": "VBA - Is there a library for VBA interaction with SQL Server", "body": "<p>To answer the question directly, no there is no specific library you can reference to perform SQL queries. You would have to roll your own effectively using ADO commands and as noted it could be subject to SQLi problems.  You would need to ensure that you validate and handle the inputs carefully.</p>\n"}, {"comments": [{"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 2, "creation_date": 1467824067, "post_id": 38229131, "comment_id": 63880763, "body": "wow I&#39;m putting this in my default add-in. Very nice work!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1467824416, "post_id": 38229131, "comment_id": 63880973, "body": "@Brad thanks! There are a number of dependencies though; I&#39;m using a <code>List</code> class which uses a <code>StringFormat</code> function which uses some regex. Have fun! (and feel free to create issues on the GitHub repo if you notice anything weird)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1467824667, "post_id": 38229131, "comment_id": 63881104, "body": "Really seems quite what I was expecting. The Python library (which name I do not remember), was using something similar with the &quot;?&quot;. Will check it tomorrow. Thanks."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 6, "last_activity_date": 1467823133, "last_edit_date": 1492087236, "creation_date": 1467822751, "answer_id": 38229131, "question_id": 38228636, "link": "https://stackoverflow.com/questions/38228636/vba-is-there-a-library-for-vba-interaction-with-sql-server/38229131#38229131", "title": "VBA - Is there a library for VBA interaction with SQL Server", "body": "<p>See <a href=\"https://codereview.stackexchange.com/q/46506/23788\"><em>Materializing any ADODB Query</em></a>, <a href=\"https://codereview.stackexchange.com/q/46312/23788\"><em>Creating ADODB Parameters on the fly</em></a>, and if you want to push it then see <a href=\"https://codereview.stackexchange.com/q/57889/23788\"><em>YARPI: Yet Another Repository Pattern Implementation</em></a> and <a href=\"https://codereview.stackexchange.com/q/60820/23788\"><em>UnitOfWork, an excuse for multiple repositories</em></a>, all on Code Review Stack Exchange - I've used that <code>SqlCommand</code> class for three years since I wrote it, and it has yet to fail me.</p>\n\n<p><a href=\"https://github.com/retailcoder/VBTools/blob/master/SqlCommand.cls\" rel=\"nofollow noreferrer\"><strong>I put it on GitHub, too</strong></a></p>\n\n<p>Oh, and it was written in <a href=\"/questions/tagged/vb6\" class=\"post-tag\" title=\"show questions tagged &#39;vb6&#39;\" rel=\"tag\">vb6</a> for interacting with <a href=\"/questions/tagged/sql-server\" class=\"post-tag\" title=\"show questions tagged &#39;sql-server&#39;\" rel=\"tag\">sql-server</a>, but it works in <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged &#39;vba&#39;\" rel=\"tag\">vba</a> for interacting with <a href=\"/questions/tagged/mysql\" class=\"post-tag\" title=\"show questions tagged &#39;mysql&#39;\" rel=\"tag\">mysql</a> just as well - just give it a provider/connection string and if ADODB can handle it, it should \"just work\".</p>\n\n<h3>Usage</h3>\n\n<p>Selecting a single value with a one-shot connection:</p>\n\n<pre><code>Dim result As Variant\nSqlCommand.ConnectionString = \"connection string\"\nresult = SqlCommand.SelectSingleValue(\"SELECT SomeField FROM SomeTable WHERE SomeValue = ?\", 123)\n</code></pre>\n\n<p>Selecting a result set with a live connection (to support transactions):</p>\n\n<pre><code>Dim cmd As New SqlCommand\nDim result As ADODB.Recordset\nDim conn As New ADODB.Connection\nconn.ConnectionString = \"connection string\"\nconn.Open\nSet result = cmd.Execute(conn, \"SELECT * FROM SomeTable WHERE SomeField = ?\", 123)\n'use result\nresult.Close\nconn.Close\n</code></pre>\n\n<p>Executing parameterized SQL and passing a connection (to support transactions):</p>\n\n<pre><code>Dim cmd As New SqlCommand\nDim conn As New ADODB.Connection\nDim result As Boolean\nconn.ConnectionString = \"connection string\"\nconn.Open\nresult = cmd.ExecuteNonQuery(conn, \"UPDATE SomeTable SET SomeField = ? WHERE SomeValue = ?\", 123, \"abc\")\nconn.Close\n</code></pre>\n\n<p>The <code>SqlCommand</code> class determines what ADODB parameters to generate, generates them, along with an actual parameterized ADODB command.</p>\n"}], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1192, "favorite_count": 2, "closed_date": 1467861919, "accepted_answer_id": 38229131, "answer_count": 3, "score": 0, "last_activity_date": 1594641808, "creation_date": 1467821174, "last_edit_date": 1594641808, "question_id": 38228636, "link": "https://stackoverflow.com/questions/38228636/vba-is-there-a-library-for-vba-interaction-with-sql-server", "closed_reason": "Not suitable for this site", "title": "VBA - Is there a library for VBA interaction with SQL Server", "body": "<p>Hello happy friendly people! \nMy question is a bit general, whether something like this exist. \nI am writing an Excel application, which interacts with SQL Server. This is what I have written until now, just to mimic the command INSERT - <code>str_generate_order</code> I have to write similar stuff for each command. </p>\n\n<hr>\n\n<p><strong>My question is</strong> - is there a library, which is already proven and tested that makes this easier? I really do not want to reinvent the hot water and to test it. I am speaking about the function <code>str_generate_order</code> from my code. The code works quite well, just you should specify your own <code>str_connection_string</code>, which connects you to a DB. Prety much, I need something like one Python library (which name I do not remember), where you simply give the names of the columns and the command and it does the rest for you... Or should I build it on my own?</p>\n\n<pre><code>Option Explicit\n\nPublic Sub GenerateDataIntoTable()\n\n    Dim str_table_name      As String: str_table_name = \"Main\"\n    Dim arr_column_names    As Variant\n    Dim arr_values          As Variant\n\n    ReDim arr_column_names(6)\n    ReDim arr_values(6)\n\n    arr_column_names(0) = \"UserName\"\n    arr_column_names(1) = \"CurrentDate\"\n    arr_column_names(2) = \"CurrentTime\"\n    arr_column_names(3) = \"CurrentLocation\"\n    arr_column_names(4) = \"Status1\"\n    arr_column_names(5) = \"Status2\"\n    arr_column_names(6) = \"Status3\"\n\n    arr_values(0) = Environ(\"username\")\n    arr_values(1) = Date\n    arr_values(2) = Time\n    arr_values(3) = Application.ActiveWorkbook.FullName\n    arr_values(4) = make_random(2, 6)\n    arr_values(5) = arr_values(4) + make_random(2, 6)\n    arr_values(6) = arr_values(5) - make_random(2, 6)\n\n    Debug.Print b_insert_into_table(str_table_name, arr_column_names, arr_values)\n\nEnd Sub\n\nFunction b_insert_into_table(str_table_name As String, arr_column_names As Variant, arr_values As Variant) As Boolean\n\n    Dim conn            As Object\n    Dim str_order       As String\n\n    Set conn = CreateObject(\"ADODB.Connection\")\n    conn.Open str_connection_string\n\n    str_order = \"insert into dbo.\" &amp; str_table_name\n    str_order = str_order &amp; str_generate_order(arr_column_names, arr_values)\n    conn.Execute str_order\n    conn.Close\n    Set conn = Nothing\n\n    b_insert_into_table = True\n\nEnd Function\n\nPublic Function str_generate_order(arr_column_names As Variant, arr_values As Variant) As String\n\n    Dim l_counter       As Long\n    Dim str_result      As String\n\n    Dim str_left        As String: str_left = \"('\"\n    Dim str_midd        As String: str_midd = \"','\"\n    Dim str_right       As String: str_right = \"')\"\n\n    str_result = \"(\"\n    For l_counter = LBound(arr_column_names) To UBound(arr_column_names)\n        str_result = str_result &amp; arr_column_names(l_counter) &amp; \",\"\n    Next l_counter\n\n    str_result = Left(str_result, Len(str_result) - 1)\n    str_result = str_result &amp; \")\"\n    str_result = str_result &amp; \"values\"\n\n    str_result = str_result &amp; str_left\n    For l_counter = LBound(arr_values) To UBound(arr_values)\n        str_result = str_result &amp; arr_values(l_counter)\n\n        If l_counter &lt; UBound(arr_values) Then\n            str_result = str_result &amp; str_midd\n        Else\n            str_result = str_result &amp; str_right\n        End If\n\n    Next l_counter\n\n    str_generate_order = str_result\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1467820981, "post_id": 38228495, "comment_id": 63878953, "body": "Try googling <code>for loop step</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6556964, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wFi88ywUsqA/AAAAAAAAAAI/AAAAAAAAAF0/yksxDK6eUMY/photo.jpg?sz=128", "display_name": "chrisro12", "link": "https://stackoverflow.com/users/6556964/chrisro12"}, "edited": false, "score": 0, "creation_date": 1467842479, "post_id": 38229978, "comment_id": 63890646, "body": "Thank you very much for the help. The way you that structured it is what I was needing to complete this macro. However, when I try to run it the result is 0, and it should deliver a number 0&lt; given the input data.  Do you know why would this be?  Shoul I use a !Dim as Integer&quot; line?"}, {"owner": {"reputation": 866, "user_id": 4429501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bJd5A.jpg?s=128&g=1", "display_name": "CRUTER", "link": "https://stackoverflow.com/users/4429501/cruter"}, "reply_to_user": {"reputation": 3, "user_id": 6556964, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wFi88ywUsqA/AAAAAAAAAAI/AAAAAAAAAF0/yksxDK6eUMY/photo.jpg?sz=128", "display_name": "chrisro12", "link": "https://stackoverflow.com/users/6556964/chrisro12"}, "edited": false, "score": 0, "creation_date": 1467848717, "post_id": 38229978, "comment_id": 63892622, "body": "For your code to be more complete you could include <code>Dim x as integer</code> and do the same for <code>i</code>, but it&#39;s not necessary - and it&#39;s not the issue.  What you need to do is check the formula that gets written in the cell on the actual worksheet.  The Macro is right, you need to fix the formula... and only you can do that :).  good luck!"}, {"owner": {"reputation": 3, "user_id": 6556964, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wFi88ywUsqA/AAAAAAAAAAI/AAAAAAAAAF0/yksxDK6eUMY/photo.jpg?sz=128", "display_name": "chrisro12", "link": "https://stackoverflow.com/users/6556964/chrisro12"}, "edited": false, "score": 0, "creation_date": 1467908784, "post_id": 38229978, "comment_id": 63922346, "body": "Yeah, I found out what the problem was. Somewhere in the running of the macro a &quot;Circular Reference&quot; error occured, where the macro ran not only in the cell selected but in another cell that was included in the formula. Already fixed it. Thank you for the help, was really helpful."}], "tags": [], "owner": {"reputation": 866, "user_id": 4429501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bJd5A.jpg?s=128&g=1", "display_name": "CRUTER", "link": "https://stackoverflow.com/users/4429501/cruter"}, "is_accepted": true, "score": 0, "last_activity_date": 1467825627, "creation_date": 1467825627, "answer_id": 38229978, "question_id": 38228495, "link": "https://stackoverflow.com/questions/38228495/creating-a-loop-with-data-from-other-sheets/38229978#38229978", "title": "Creating a loop with data from other sheets", "body": "<p>Give the following a try...  It's hard to read R1C1, so I changed it up a bit and you'll need to replace all my \"A1\" references to the first month's cell reference.  Also, the <code>for loop</code> will only loop 12 times - 12 months in a year.  You can manually change this if you'd like.  Lastly, the formula will be written in the <code>activecell</code> then the following formulas will be written in the next cell/column to the right.</p>\n\n<pre><code>''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'instead of using R1C1, use ranges with offsets - it's much easier to read :) ''\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n'I used \"A1\" as a placeholder.  Replace this with the actual cell reference for the first month\n'The first loop will use the \"A1\" range.  Then, the 2nd and following loops will move over 1 or 7 columns\n'i = move over 1 column\n'x = move over 7 columns\n\nFor i = 0 To 11 'this will loop through 12 times 0-11\n    ActiveCell.Offset(0, i).Formula = _\n        \"=Extractos!\" &amp; Range(\"A1\").Offset(0, x).Address _\n        &amp; \"-('Home Expenses'!\" &amp; Range(\"A1\").Offset(0, i).Address _\n        &amp; \"+'Home Expenses'!\" &amp; Range(\"A1\").Offset(0, i).Address _\n        &amp; \"+'Home Expenses'!\" &amp; Range(\"A1\").Offset(0, i).Address _\n        &amp; \"+Health!\" &amp; Range(\"A1\").Offset(0, i).Address _\n        &amp; \"+Health!\" &amp; Range(\"A1\").Offset(0, i).Address _\n        &amp; \"+Health!\" &amp; Range(\"A1\").Offset(0, i).Address _\n        &amp; \"+Gifts!\" &amp; Range(\"A1\").Offset(0, i).Address _\n        &amp; \"+'Daily Living'!\" &amp; Range(\"A1\").Offset(0, i).Address _\n        &amp; \"+'Daily Living'!\" &amp; Range(\"A1\").Offset(0, i).Address _\n        &amp; \"+'Daily Living'!\" &amp; Range(\"A1\").Offset(0, i).Address _\n        &amp; \"+'Daily Living'!\" &amp; Range(\"A1\").Offset(0, i).Address _\n        &amp; \"+'Daily Living'!\" &amp; Range(\"A1\").Offset(0, i).Address _\n        &amp; \"+Entertainment!\" &amp; Range(\"A1\").Offset(0, i).Address _\n        &amp; \"+Entertainment!\" &amp; Range(\"A1\").Offset(0, i).Address _\n        &amp; \"+Entertainment!\" &amp; Range(\"A1\").Offset(0, i).Address _\n        &amp; \"+Entertainment!\" &amp; Range(\"A1\").Offset(0, i).Address _\n        &amp; \"+Transportation!\" &amp; Range(\"A1\").Offset(0, i).Address &amp; \")\"\n\n    'add 7 to x variable\n    x = x + 7\n\n'loop and add 1 to i\nNext i\n\n'macro done, select H129\nRange(\"H129\").Select\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6556964, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wFi88ywUsqA/AAAAAAAAAAI/AAAAAAAAAF0/yksxDK6eUMY/photo.jpg?sz=128", "display_name": "chrisro12", "link": "https://stackoverflow.com/users/6556964/chrisro12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 38229978, "answer_count": 1, "score": 0, "last_activity_date": 1467825627, "creation_date": 1467820809, "question_id": 38228495, "link": "https://stackoverflow.com/questions/38228495/creating-a-loop-with-data-from-other-sheets", "title": "Creating a loop with data from other sheets", "body": "<p>I'm trying to create a macro for a Personal Budget worksheet, where there is a cell with tedious work. </p>\n\n<p>Using the \"Record Macro\" button I traced the coding behind the operation I made in the cell, which is the following: </p>\n\n<pre><code>Sub calculo_otherex()\n' calculo_otherex Macro\n' C\u00e1lculo de otros gastos con tarjeta.\n'\n    ActiveCell.FormulaR1C1 = _\n        \"=Extractos!R[-89]C[-2]-('Home Expenses'!R[-105]C+'Home Expenses'!R[-60]C+'Home Expenses'!R[-16]C+Health!R[-105]C+Health!R[-67]C+Health!R[-29]C+Gifts!R[-99]C+'Daily Living'!R[-87]C+'Daily Living'!R[-29]C+'Daily Living'!R[20]C+'Daily Living'!R[59]C+'Daily Living'!R[102]C+Entertainment!R[-105]C+Entertainment!R[-67]C+Entertainment!R[-29]C+Entertainment!R[9]C+Transportation!R[-105]C)\"\n    Range(\"H129\").Select\n\nEnd Sub \n</code></pre>\n\n<p>As you can see, in the formula I refer to other sheets, and to specific cells which reflect a result of a certain month (in this case July) and a specific subset (charges to a credit card). </p>\n\n<p>What I want to do is insert a loop so this procedure repeats for all the months, but the problem is that the data in the sheet \"Extractos\" appears every 7th cell to the right from \"Extractos!R[-89]C[-2]\", as the other data in the formula appears in the next column. </p>\n\n<p>How could I solve this??\nThank you very much. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 2, "creation_date": 1467820885, "post_id": 38228463, "comment_id": 63878889, "body": "What you need to look up is called a Regular Expression.  Google will give you many examples of this, as will <a href=\"https://stackoverflow.com\">Stack Overflow</a> now you know what it&#39;s called. Once you&#39;ve had a look, if you&#39;re still having problems, post back with what you have tried and we&#39;ll get you sorted out. :)"}, {"owner": {"reputation": 49, "user_id": 6216934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-3xVPgPUqE-0/AAAAAAAAAAI/AAAAAAAAAUk/LvlhM2vZPPA/photo.jpg?sz=128", "display_name": "Mickey B", "link": "https://stackoverflow.com/users/6216934/mickey-b"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 1, "creation_date": 1467821418, "post_id": 38228463, "comment_id": 63879197, "body": "@Dave, I have edited the original post to have my new code, I believe the pattern is a little messed up, help would be appreciated."}], "answers": [{"comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 49, "user_id": 6216934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-3xVPgPUqE-0/AAAAAAAAAAI/AAAAAAAAAUk/LvlhM2vZPPA/photo.jpg?sz=128", "display_name": "Mickey B", "link": "https://stackoverflow.com/users/6216934/mickey-b"}, "edited": false, "score": 0, "creation_date": 1467822482, "post_id": 38228931, "comment_id": 63879807, "body": "No worries - Glad it helped."}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": false, "score": 2, "last_activity_date": 1467822101, "creation_date": 1467822101, "answer_id": 38228931, "question_id": 38228463, "link": "https://stackoverflow.com/questions/38228463/vba-excel-need-a-function-that-finds-data-in-a-pattern-within-a-string/38228931#38228931", "title": "VBA Excel - Need a function that finds data in a pattern within a string", "body": "<p>Give this a try.</p>\n\n<p>I've modified the pattern a little.  The first grouping requires a single alpha character, followed by numerics that may be one or two digits, followed by a dash (escaped with a \\ since otherwise it has a special meaning in a regexp), followed by a single character numeric.  Let me know if you don't see what I've done here and I'll try to explain it a little better...</p>\n\n<pre><code>Sub RegEx_Tester()\nSet objRegExp_1 = CreateObject(\"vbscript.regexp\")\nobjRegExp_1.Global = True\nobjRegExp_1.IgnoreCase = True\nobjRegExp_1.Pattern = \"[A-Z]{1}[0-9]{1,2}\\-[0-9]{1}\"\nstrToSearch = \"L5-1\"\n\nSet regExp_Matches = objRegExp_1.Execute(strToSearch)\nWScript.Echo regExp_Matches.Count\nIf regExp_Matches.Count = 1 Then\n    MsgBox (\"Yes\")\nElse\n    MsgBox (\"No\")\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 6216934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-3xVPgPUqE-0/AAAAAAAAAAI/AAAAAAAAAUk/LvlhM2vZPPA/photo.jpg?sz=128", "display_name": "Mickey B", "link": "https://stackoverflow.com/users/6216934/mickey-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1467822101, "creation_date": 1467820749, "last_edit_date": 1467821561, "question_id": 38228463, "link": "https://stackoverflow.com/questions/38228463/vba-excel-need-a-function-that-finds-data-in-a-pattern-within-a-string", "title": "VBA Excel - Need a function that finds data in a pattern within a string", "body": "<p>I was wondering if there's a function that will pull out a string that matches a certain pattern. I'm currently trying to pull out this:  \"C3-4\" Which is located in a string, and is found in multiple different sections. The String also changes, for example it could be L2-3, so I need this function, if it exists, to be able to recognize a pattern, like AX-X (A being a letter, X being a number, and the - being a -) Any help would be much appreciated. Sorry if the question is vague, I don't have any program written yet to help give an example because I need this to give me a baseline to begin programming.</p>\n\n<p>===EDIT===</p>\n\n<p>I Have been able to come up with this, however I think my pattern is incorrect, it evaluates to \"no\" when it should evaluate to \"yes\": </p>\n\n<pre><code>Sub RegEx_Tester()\nSet objRegExp_1 = CreateObject(\"vbscript.regexp\")\nobjRegExp_1.Global = True\nobjRegExp_1.IgnoreCase = True\nobjRegExp_1.Pattern = \"[TSCL][1-13]*-[1-13]\"\nstrToSearch = \"L5-1\"\nSet regExp_Matches = objRegExp_1.Execute(strToSearch)\nIf regExp_Matches.Count = 1 Then\n    MsgBox (\"Yes\")\nElse\n    MsgBox (\"No\")\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "if-statement", "nothing"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 1, "creation_date": 1467820521, "post_id": 38228269, "comment_id": 63878649, "body": "Because <code>Value</code> is a <code>Variant</code> and only an <code>Object</code> can be set to <code>Nothing</code>."}, {"owner": {"reputation": 233, "user_id": 1950725, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rE1xn.jpg?s=128&g=1", "display_name": "Torsten Knodt", "link": "https://stackoverflow.com/users/1950725/torsten-knodt"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 1, "creation_date": 1467820845, "post_id": 38228269, "comment_id": 63878857, "body": "Thanks @Dave. Could you provide this as an answer please, so I can mark it as accepted/ correct?"}], "answers": [{"comments": [{"owner": {"reputation": 7059, "user_id": 1137334, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9b2a13764b560b46cc04e2e0e29940a4?s=128&d=identicon&r=PG", "display_name": "m93a", "link": "https://stackoverflow.com/users/1137334/m93a"}, "edited": false, "score": 0, "creation_date": 1503578715, "post_id": 38228546, "comment_id": 78682116, "body": "I don&#39;t think this is true. <code>Variant</code> can be set to anything, including objects and nothings, but the <code>is</code> operator throws a type error, when it&#39;s not either an object or <code>Nothing</code>."}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": true, "score": 3, "last_activity_date": 1467820962, "creation_date": 1467820962, "answer_id": 38228546, "question_id": 38228269, "link": "https://stackoverflow.com/questions/38228269/why-does-if-value-is-nothing-throw-object-required-error-424/38228546#38228546", "title": "Why does &quot;If Value is Nothing&quot; throw &quot;Object Required (Error 424)&quot;", "body": "<p>Because <code>Value</code> in your function definition is set to type <code>Variant</code> and only an <code>Object</code> can be <code>Set</code> to <code>Nothing</code></p>\n"}], "owner": {"reputation": 233, "user_id": 1950725, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rE1xn.jpg?s=128&g=1", "display_name": "Torsten Knodt", "link": "https://stackoverflow.com/users/1950725/torsten-knodt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1746, "favorite_count": 2, "accepted_answer_id": 38228546, "answer_count": 1, "score": 5, "last_activity_date": 1467820962, "creation_date": 1467820173, "question_id": 38228269, "link": "https://stackoverflow.com/questions/38228269/why-does-if-value-is-nothing-throw-object-required-error-424", "title": "Why does &quot;If Value is Nothing&quot; throw &quot;Object Required (Error 424)&quot;", "body": "<p>The following code throws <code>Object Required (Error 424)</code> at the if statement comparing with <code>Nothing</code> independent of the value given. Why?</p>\n\n<pre><code>Public Function SqlizeCellValue(ByVal Value As Variant) As Variant\n    If Value Is Nothing Then\n        SqlizeCellValue = Nothing\n    ElseIf Value = Null Then\n        SqlizeCellValue = Null\n    ElseIf Value = \"\" Then\n        SqlizeCellValue = Null\n    ElseIf Value = \"0\" Then\n        SqlizeCellValue = Null\n    ElseIf Value = \"---\" Then\n        SqlizeCellValue = Null\n    ElseIf LCase(Value) = \"n.c.\" Then\n        SqlizeCellValue = Null\n    Else\n        SqlizeCellValue = Value\n    End If\nEnd Function\nPublic Sub TestSqlizeCellValue()\n    Debug.Assert SqlizeCellValue(\"\") Is Null\n    Debug.Assert SqlizeCellValue(\"0\") Is Null\n    Debug.Assert SqlizeCellValue(\"---\") Is Null\n    Debug.Assert SqlizeCellValue(Nothing) Is Nothing\n    Debug.Assert SqlizeCellValue(Null) Is Null\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 3, "creation_date": 1467819016, "post_id": 38227809, "comment_id": 63877610, "body": "Maybe <code>Sheets(counter).Select</code>."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 3, "creation_date": 1467819207, "post_id": 38227809, "comment_id": 63877739, "body": "does &quot;select&quot; mean get the sheet variable (i.e. the Excel.Worksheet object) or doe sit mean set focus to that sheet so it&#39;s what the user sees?"}, {"owner": {"reputation": 1381, "user_id": 5072010, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8f044c7b7dee6227de800f0ade7a82c3?s=128&d=identicon&r=PG&f=1", "display_name": "Runeaway3", "link": "https://stackoverflow.com/users/5072010/runeaway3"}, "edited": false, "score": 1, "creation_date": 1467819443, "post_id": 38227809, "comment_id": 63877898, "body": "It to focus the sheet so that the user sees it"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1467820717, "post_id": 38227809, "comment_id": 63878777, "body": "This is an X-Y problem. You <b><i>think</i></b> you need to <code>.Select</code> a sheet, <a href=\"http://stackoverflow.com/a/10717999/1188513\"><b>but you don&#39;t</b></a>."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1467821281, "post_id": 38227809, "comment_id": 63879118, "body": "@Mat&#39;sMug but if this is a UI requirement (i.e., activating the sheet so that it has focus for the user), then OP <i>does</i> need to select/activate the sheet, as mentioned in comment above :)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1467821458, "post_id": 38227809, "comment_id": 63879224, "body": "@DavidZemens sure, fine. But if that&#39;s done in a loop, then no, it&#39;s not needed, unless screen flickering is a business/UI/UX requirement."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1467821547, "post_id": 38227809, "comment_id": 63879277, "body": "@Mat&#39;sMug I like my screen to flicker when I loop so I can get dizzy and leave work early claiming sickness =P"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1467821958, "post_id": 38227809, "comment_id": 63879485, "body": "But OP has given no concrete information that suggests he&#39;s doing a loop. Sure, using a counter might imply there&#39;s a loop, but the requirement is that OP wants the user to <i>see the sheet</i>, which, if there is a loop, implies that maybe it requires user input eg thru a Input Box or other prompt. Your advice is correct in the general case, but might not be in specific case."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1467822568, "post_id": 38227809, "comment_id": 63879867, "body": "OP, check out <a href=\"http://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">&quot;What is the XY Problem&quot;</a>, as @Mat&#39;sMug mentioned this is probably one of those."}, {"owner": {"reputation": 1381, "user_id": 5072010, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8f044c7b7dee6227de800f0ade7a82c3?s=128&d=identicon&r=PG&f=1", "display_name": "Runeaway3", "link": "https://stackoverflow.com/users/5072010/runeaway3"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1467824425, "post_id": 38227809, "comment_id": 63880976, "body": "@Mat&#39;s Mug Many users have pointed out that I should not be using select, and have linked me to that page. But the issue is that the macro generates new pages and cells, and these each need to be referred to and edited in a similar way each time a new set is generated, and the amount of them generated varies on the user&#39;s discretion each time it is run... the page you linked sets rng = a specific range... I can&#39;t set a specific range ever... so I have been using select and activecell to get around this. Is there a way to still avoid select for somting this complicated?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1467824541, "post_id": 38227809, "comment_id": 63881034, "body": "You&#39;re probably using an unqualified <code>Range</code> function, which implicitly refers to the <code>ActiveSheet</code>. Not sure what &quot;I can&#39;t set a specific range ever&quot; means, but you definitely don&#39;t need to <code>Select</code> or <code>Activate</code> anything to do what you&#39;re doing."}, {"owner": {"reputation": 1381, "user_id": 5072010, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8f044c7b7dee6227de800f0ade7a82c3?s=128&d=identicon&r=PG&f=1", "display_name": "Runeaway3", "link": "https://stackoverflow.com/users/5072010/runeaway3"}, "edited": false, "score": 0, "creation_date": 1467824740, "post_id": 38227809, "comment_id": 63881161, "body": "I just meant that I can&#39;t ever set a variable like rng = Range(&quot;A1:B60&quot;) because the range needed to be modified is never the same on each iteration or loop of the macro. The macro is extremely long and complicated (some ~200 lines of code), and I have just set the Application.ScreenUpdating = false to get around the slowness issue of select, but I will take a look into it."}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 5, "last_activity_date": 1467822663, "last_edit_date": 1495542151, "creation_date": 1467819270, "answer_id": 38227951, "question_id": 38227809, "link": "https://stackoverflow.com/questions/38227809/how-to-select-a-sheet-via-a-counter-variable-in-vba/38227951#38227951", "title": "How to select a sheet via a counter variable in vba?", "body": "<p>You can loop through worksheets in a workbook like this:</p>\n\n<pre><code>Sub PrintAllSheetNames()\n    Dim index As Long\n    For index = 1 To ActiveWorkbook.Worksheets.Count\n\n        ActiveWorkbook.Worksheets(index).Select\n\n        ' Prints the worksheet's name in the Immediate Window (CTRL+G in the VBEditor)\n        Debug.Print ActiveWorkbook.Worksheets(index).Name\n\n    Next\nEnd Sub\n</code></pre>\n\n<p>But, what are you really trying to do? It's best to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">avoid <code>.Select</code></a> wherever you can.</p>\n\n<p>If you just want the user to see the sheet, then use <code>.Activate</code>.  But still, don't do that. Use this knowledge of how to loop through sheets, and then work directly with the data.</p>\n"}], "owner": {"reputation": 1381, "user_id": 5072010, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8f044c7b7dee6227de800f0ade7a82c3?s=128&d=identicon&r=PG&f=1", "display_name": "Runeaway3", "link": "https://stackoverflow.com/users/5072010/runeaway3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1010, "favorite_count": 0, "accepted_answer_id": 38227951, "answer_count": 1, "score": 1, "last_activity_date": 1467822663, "creation_date": 1467818821, "question_id": 38227809, "link": "https://stackoverflow.com/questions/38227809/how-to-select-a-sheet-via-a-counter-variable-in-vba", "title": "How to select a sheet via a counter variable in vba?", "body": "<p>I want to select sheets in an excel document. They are all named, but I know that you can select a sheet using its intrinsic number (ie. even though the second sheet created is named \"risk ranking\", I can still select it via Sheet2.select). Is there anyway to set this up using a counter variable? Here is a simplified and isolated code line from the macro:</p>\n\n<pre><code>counter = 0\n\nSheet &amp; counter &amp; .Select\n\ncounter = counter + 1\n</code></pre>\n\n<p>Anyone have any ideas?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1467818416, "post_id": 38227620, "comment_id": 63877202, "body": "can you store the add-in on common shared drive? that is what I did at one point. I kept a local dev version and then stored the prod version on a common shared drive for all others to access"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1467818618, "post_id": 38227620, "comment_id": 63877341, "body": "How are you referencing the add-in? I&#39;d not expect it to use the full file path."}, {"owner": {"reputation": 1, "user_id": 6556784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87f9f687eaa694d159e49a64fc48b098?s=128&d=identicon&r=PG&f=1", "display_name": "J_Gascoigne", "link": "https://stackoverflow.com/users/6556784/j-gascoigne"}, "edited": false, "score": 0, "creation_date": 1467819063, "post_id": 38227620, "comment_id": 63877637, "body": "There&#39;s no reference being used. The public function works fine for difference users in their own workbooks, but if user B opens a workbook user A created, the public functions A has entered in the workbooks produce an error for user B. Is there away around this? To Scott&#39;s point I want the addin stored locally so it can function without network access."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1467821128, "post_id": 38227620, "comment_id": 63879037, "body": "If all else fails, most people usually have access to `C:\\temp` :)"}], "owner": {"reputation": 1, "user_id": 6556784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87f9f687eaa694d159e49a64fc48b098?s=128&d=identicon&r=PG&f=1", "display_name": "J_Gascoigne", "link": "https://stackoverflow.com/users/6556784/j-gascoigne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467818289, "creation_date": 1467818289, "question_id": 38227620, "link": "https://stackoverflow.com/questions/38227620/username-directory-conflicts-with-public-function-in-excel-addins", "title": "Username/Directory conflicts with Public Function in Excel Addins", "body": "<p>Windows 7, Excel 2013, Visual Basic for Applications 7.1</p>\n\n<p>I distribute and add-in at work for multiple team members. To get around company IT admin policies, this is stored in the My Documents folder as other C: drive areas present read/write access complications.</p>\n\n<p>The problem with this is that when one user applies one of the public functions to an excel workbook, it doesn't work when another user opens the excel file, since the path the add-in and function are stored in, C:\\Users\\\"username\"\\Documents\\addin\\, the \"username\" has now changed.</p>\n\n<p>Is there anyway to ensure when another user opens a workbook it correctly finds the add-in and public function?</p>\n\n<p>For calling subroutines =Environ(\"username\") works fine to build a path of course, but I'm not sure if this can even be done for a public function being referenced in an excel book? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467818606, "post_id": 38227581, "comment_id": 63877332, "body": "Probably need to run a routine like <a href=\"http://stackoverflow.com/questions/11644566/excel-vba-set-bold-specific-text-of-string-into-the-cell\">this one</a> on the cell after doing the replace. May need to use <code>Instr</code> to get the position of <code>Chr(10)</code> to know which characters to make bold or not."}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467818861, "post_id": 38227581, "comment_id": 63877523, "body": "I think pre-processing the string to make [enterkey] the same format as the text after it might be more efficient than post-processing it, because then the wanted format would be lost. Maybe something like copying the format of the first char after [enterkey] and making it the same. That way after replacing, the format wouldn&#39;t change. How could I go about that?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467819194, "post_id": 38227581, "comment_id": 63877733, "body": "Will it always <b>bold</b> first line and <i>italic</i> second line?"}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467819364, "post_id": 38227581, "comment_id": 63877850, "body": "No; there may be 1 line, there may be 10 lines. There will be bold, italics, font, font colors. Any format you can think of putting in an Excel cell, really. What it really is, is a HTML string where I replaced &lt;br&gt; with [enterkey], and then change the HTML to a rich text format. I had to change the &lt;br&gt; because when changing format it would cause a cell change, not a line change. It works fine, and results in something like the input cell (but much longer usually)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467819444, "post_id": 38227581, "comment_id": 63877902, "body": "okay. That&#39;s an <i>entirely</i> different set of issues then the example you posted ... let me test some more from the idea I am building"}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467819533, "post_id": 38227581, "comment_id": 63877958, "body": "I&#39;ll give a more complete picture under the question."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467819604, "post_id": 38227581, "comment_id": 63878004, "body": "the other interesting thing is that when I run <code>rng2.Value = Replace(rng2.Value, &quot;[enterkey]&quot;, Chr(10))</code> against my cell it does not keep any formatting. It leaves it all as plain text."}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467820124, "post_id": 38227581, "comment_id": 63878357, "body": "Really? That&#39;s strange. All formatting disappears for you? See my edit btw."}], "answers": [{"comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1467820930, "post_id": 38228422, "comment_id": 63878924, "body": "Excellent. That&#39;s exactly what was needed. In retrospect, you see that I didn&#39;t need to share all that additional information ;)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 1, "creation_date": 1467821039, "post_id": 38228422, "comment_id": 63878993, "body": "@DavidG. Hindsight is always 20/20. Your 2nd comment got me to this place. I had a much simpler solution in mind based on your original example, which did turn out to be incomplete."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1467820616, "creation_date": 1467820616, "answer_id": 38228422, "question_id": 38227581, "link": "https://stackoverflow.com/questions/38227581/prevent-reformatting-of-characters-when-changing-line-in-cell/38228422#38228422", "title": "Prevent reformatting of characters when changing line in cell", "body": "<p>After some research, I got something that works. </p>\n\n<p>This code:</p>\n\n<pre><code>Sub ReplaceEnterKey()\n\nDim rng2 As Range\nSet rng2 = Range(\"O15\")\n\nDim iChr As Integer\niChr = InStr(1, rng2.Value, \"[e\") 'find beginning of first occurence of \"[enterkey]\"\n\nDo Until iChr = 0 'loop until no more occurences found\n\n    rng2.Characters(iChr, 10).Delete 'remove found occurrence of \"[enterkey]\" - 10 characters\n    rng2.Characters(iChr, 0).Insert Chr(10) 'insert carriage return where \"[enterkey]\" used to be\n\n    iChr = InStr(1, rng2.Value, \"[e\") 'look for next occurence\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>Created this result. <code>N15</code> was original <code>O15</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/cpl82.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cpl82.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 38228422, "answer_count": 1, "score": 2, "last_activity_date": 1467820616, "creation_date": 1467818174, "last_edit_date": 1531164843, "question_id": 38227581, "link": "https://stackoverflow.com/questions/38227581/prevent-reformatting-of-characters-when-changing-line-in-cell", "title": "Prevent reformatting of characters when changing line in cell", "body": "<p>I have a cell with formatted text containing a certain substring that I want to replace with a line change. The substring is [enterkey] with the square brackets. It is a variant of this question <a href=\"https://stackoverflow.com/questions/17874391/replace-html-tag-br-with-altenter-in-excel\">Replace HTML tag(&lt;/br&gt;) with Alt+Enter in Excel</a> but I want to keep formatting after changing the line.</p>\n\n<p><a href=\"https://i.stack.imgur.com/WV0lg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WV0lg.png\" alt=\"enter image description here\"></a></p>\n\n<p>The code I am using is a simple replace where rng2 is the input and output cell:</p>\n\n<pre><code>rng2.Value = Replace(rng2.Value, \"[enterkey]\", Chr(10))\n</code></pre>\n\n<p><strong>My Question</strong></p>\n\n<p>How can I prevent that code from copying the format of the line above when inserting a line feed? I want it to conserve the format AS IT IS and simply insert a line feed, like shown in the picture.</p>\n\n<hr>\n\n<p>More info</p>\n\n<p>I'm actually converting to HTML and back. I didn't want to add unnecessary details but if people really want to know, it's because I'm storing the values in an Access database and I want to keep cell formatting. When retrieving info from Access, I want to have the proper formatting again. This question only concerns the conversion back. See below picture for full details.</p>\n\n<p><a href=\"https://i.stack.imgur.com/m2tn3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/m2tn3.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1467818322, "post_id": 38227564, "comment_id": 63877124, "body": "did you step through line-by-line and observe the variable values to see why it&#39;s not working. It&#39;s impossible for us to test without a full sample data set."}, {"owner": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467873153, "post_id": 38227564, "comment_id": 63898642, "body": "Sorry for this delay, and I&#39;ve just tested the program with the &#39;stupid&#39; method. If I change <code>If InStr(DepositZone.Value, TargetZone.Value + &quot;:&quot;) &lt;&gt; 0</code> into <code>If InStr(Sheets(&quot;Brouillon&quot;).Cells(j, 2).Text, Sheets(&quot;Data&quot;).Cells(i, 18).Text) &lt;&gt; 0</code>, just don&#39;t use the <code>Set</code>, and it works. I don&#39;t know where is the problem."}, {"owner": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467875676, "post_id": 38227564, "comment_id": 63899969, "body": "I&#39;ve left it be and continue to work on the other parts, and when I came back to this bug, it just works... It&#39;s really weird. But thank you anyway!"}], "owner": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1467873316, "creation_date": 1467818126, "last_edit_date": 1531164843, "question_id": 38227564, "link": "https://stackoverflow.com/questions/38227564/using-instr-to-compare-two-string-but-failed", "title": "Using InStr to compare two String but failed", "body": "<p>My object is to fill a quality control table. In this table I have already all the test points, and my work is to look at the point and search in another sheet for the correct answer, and fill the blank cell. For example:</p>\n\n<pre><code>TV1 | Coulor\nTV1 | Size\nTV2 | Coulor\nTV2 | Size\nTV3 | Coulor\nTV3 | Size\n</code></pre>\n\n<p>And in the other sheet, I've already the result of a new report : </p>\n\n<pre><code>TV1 | Coulor : red   | Size : 1\nTV2 | Coulor :blue   | Size : 1\nTV3 | Coulor : green | Size : yellow\n</code></pre>\n\n<p>Well the example is simplified, in the real report I still have more details, but generally, it's the same. Here's my Sub:</p>\n\n<pre><code>Private Sub FillTarget(ByVal TargetSheet As String, ByVal DepositSheet As String, _\n    ByVal DataRow As Integer, ByVal DataColumn As Integer, _\n    ByVal DepositRow As Integer, ByVal DepositColumn As Integer)\n\nDim i As Integer, j As Integer, k As Integer\nDim OpenedFile As String, myObject As String\n\nDim MarkRow As Integer\nMarkRow = 1\nDim myData As String\nDim EndSearch As Boolean\n\nDim TargetCell As Range\nDim TargetTag As Range\nDim TargetType As Range\nDim TargetZone As Range\nDim TargetTest As Range\n\nDim DepositTag As Range\nDim DepositZone As Range\nDim DepositResult As Range\n\n'for every line in the report    \nFor i = 8 To DataRow\nWith Worksheets(TargetSheet)\n    Set TargetCell = .Cells(i, DataColumn)\n    Set TargetTag = .Cells(i, 15)\n    Set TargetType = .Cells(i, 17)\n    Set TargetZone = .Cells(i, 18)\n    Set TargetTest = .Cells(i, 20)\nEnd With\nmyObject = TargetTag.Text + \"_\" + TargetType.Text\n\n'search every line in result sheet\nFor j = MarkRow To DepositRow\n    With Worksheets(DepositSheet)\n        Set DepositTag = .Cells(j, 1)\n        Set DepositZone = .Cells(j, 2)\n    End With\n    'if the product is right\n    If InStr(DepositTag.Value, myObject) &lt;&gt; 0 Then\n        OpenedFile = OpenedFile &amp; DepositTag.Text &amp; \"|\"\n        'if the zone is right\n        If InStr(DepositZone.Value, TargetZone.Value + \":\") &lt;&gt; 0 _  '&lt;===Here's the problem\n            Or InStr(TargetZone.Text, \"/\") &lt;&gt; 0 Then\n            'for each cell in this line\n            For k = 2 To DepositColumn\n                With Worksheets(DepositSheet)\n                    Set DepositResult = .Cells(j, k)\n                End With\n                'find the correct test (colour, siez etc)\n                If InStr(DepositResult.Value, TargetTest.Value) &lt;&gt; 0 Then\n                    MarkRow = j\n                    myData = DepositResult.Text\n                    TargetCell.Value = myData\n                    EndSearch = True\n                    Exit For\n                End If\n\n            Next k\n\n        End If\n\n    End If\n\n    If EndSearch Then Exit For\nNext j\n\nEndSearch = False\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>I've used F8 to run, and found that the first compare of InStr <code>If InStr(DepositTag.Value, myObject) &lt;&gt; 0</code> works, but the second time <code>If InStr(DepositZone.Value, TargetZone.Value + \":\") &lt;&gt; 0</code> it's stopped, even if there is already a string inside, but it seems that it can not figure out wether there are the same part in these two strings.</p>\n\n<p>And I've tried to use the 'stupid' way, just don't use set and <code>If InStr(Sheets(\"Brouillon\").Cells(j, 2).Text, Sheets(\"Data\").Cells(i, 18).Text) &lt;&gt; 0</code> works. I didn't figure out where's the problem.</p>\n\n<p>So if you've got some idea, please leave a note. Thank you!</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 879, "user_id": 6340326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QaG3S.png?s=128&g=1", "display_name": "Carrosive", "link": "https://stackoverflow.com/users/6340326/carrosive"}, "edited": false, "score": 0, "creation_date": 1468424440, "post_id": 38228015, "comment_id": 64124554, "body": "This works great, I&#39;m hoping you might be able to give some further advice on a new issue. I&#39;m trying to put the reusable functions into an Add-In, and adding this Add-In as a reference (Tools &gt; References) in other add-ins that will use these functions. The issue here is that by implementing your suggestions the private modules are inaccessible to the new Add-In&#39;s. Could you add anything further to improve this? Should I create a new question?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 879, "user_id": 6340326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QaG3S.png?s=128&g=1", "display_name": "Carrosive", "link": "https://stackoverflow.com/users/6340326/carrosive"}, "edited": false, "score": 0, "creation_date": 1468424645, "post_id": 38228015, "comment_id": 64124683, "body": "I was going to reply in a comment, but it wouldn&#39;t fit - yeah it would probably be better off as a separate question."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 5, "last_activity_date": 1467821810, "last_edit_date": 1467821810, "creation_date": 1467819459, "answer_id": 38228015, "question_id": 38227475, "link": "https://stackoverflow.com/questions/38227475/how-can-i-prevent-the-suggestion-of-custom-vba-functions-when-writing-formulas-i/38228015#38228015", "title": "How Can I Prevent The Suggestion of Custom VBA Functions When Writing Formulas in Excel?", "body": "<p>Parameterless <code>Public</code> members of a <em>standard module</em> are one of two things:</p>\n\n<ul>\n<li><code>Sub</code> procedures and they're exposed as <em>macros</em>.</li>\n<li><code>Function</code> procedures and they're exposed as UDF's.</li>\n</ul>\n\n<p>Note that members are implicitly <code>Public</code> if no access modifier is specified.</p>\n\n<p>A <code>Sub</code> that has parameters can't be executed as a <em>macro</em>, so it won't show up as an available macro.</p>\n\n<p>A <code>Function</code> that has <em>side-effects</em> (e.g. mutates some module/global state, or changes other cells' value) is bad code, and a UDF can't change another cell's value anyway.</p>\n\n<hr>\n\n<blockquote>\n  <p><em>Making the functions private will prevent this, but what it will also do is remove the handy hints showing the parameters for the functions when called from a module other than where the function is stored.</em></p>\n</blockquote>\n\n<p>Making it <code>Private</code> not only \"removes the handy hints\", it makes the function inaccessible to other modules, and your code won't compile.</p>\n\n<p>If your code has UDF's, put them all in the same standard module, e.g. <code>UserFunctions</code>, and make them explicitly <code>Public</code> for readability's sake.</p>\n\n<p>If your code has macros, put them all in the same standard module, e.g. <code>Macros</code>, and make them explicitly <code>Public</code> for readability's sake.</p>\n\n<p>If your code has functions and procedures that need to be <code>Public</code> (e.g. they're accessed from UDF's and/or macros), make them explicitly <code>Public</code> for readability's sake, and put them in standard modules named appropriately (i.e. avoid <code>Helper</code> and <code>Manager</code> modules, they inevitably become a dumping bag of whatever doesn't quite fit anywhere, and grow to a mess).</p>\n\n<p>Then put this at the top:</p>\n\n<pre><code>Option Explicit\nOption Private Module\n</code></pre>\n\n<p>That option (<code>Private Module</code>) prevents all public/exposed members from being picked up as macros and UDF's. <code>Option Explicit</code> should just be there anyway.</p>\n\n<hr>\n\n<p>Another way is to implement logic in class modules; members of a class module can't be accessed without an instance of that class (i.e. an object), and therefore won't be exposed as macros/UDF's.</p>\n"}], "owner": {"reputation": 879, "user_id": 6340326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QaG3S.png?s=128&g=1", "display_name": "Carrosive", "link": "https://stackoverflow.com/users/6340326/carrosive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 750, "favorite_count": 0, "accepted_answer_id": 38228015, "answer_count": 1, "score": 3, "last_activity_date": 1467821810, "creation_date": 1467817811, "question_id": 38227475, "link": "https://stackoverflow.com/questions/38227475/how-can-i-prevent-the-suggestion-of-custom-vba-functions-when-writing-formulas-i", "title": "How Can I Prevent The Suggestion of Custom VBA Functions When Writing Formulas in Excel?", "body": "<p>I am writing a range of VBA functions / subs that can be reused in a number of projects. The issue I have is that these functions are listed in the suggested formula functions when using sheets.</p>\n\n<p><a href=\"https://i.stack.imgur.com/tGoYI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tGoYI.png\" alt=\"enter image description here\"></a></p>\n\n<p>Making the functions private will prevent this, but what it will also do is remove the handy hints showing the parameters for the functions when called from a module other than where the function is stored. </p>\n\n<p><a href=\"https://i.stack.imgur.com/zWfqu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zWfqu.png\" alt=\"enter image description here\"></a></p>\n\n<p>Does anyone know of a way to prevent the suggestion of custom functions without making them private?</p>\n"}, {"tags": ["excel", "ms-access", "import", "vba"], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 2, "last_activity_date": 1467819746, "creation_date": 1467819746, "answer_id": 38228118, "question_id": 38227454, "link": "https://stackoverflow.com/questions/38227454/adding-a-unique-id-field-to-identify-spreadsheets-imported-from-different-excel/38228118#38228118", "title": "Adding a unique ID field to identify spreadsheets imported from different Excel files with VBA", "body": "<p>The usual workflow, solving both your questions, uses a temporary table that has the same structure as the Excel files:</p>\n\n<p>For each file</p>\n\n<ol>\n<li>clear temp table</li>\n<li>import Excel file into temp table</li>\n<li>Use an append query to copy selected fields plus additional information (like a date, or the file name) into the actual production table.</li>\n</ol>\n\n<p>Alternative for steps 1+2: Link the Excel file instead of importing it<br>\n(<code>DoCmd.TransferSpreadsheet acLink</code>). </p>\n\n<p>Then the Append query selects from the linked table.</p>\n\n<hr>\n\n<p>Unrelated:</p>\n\n<pre><code>If Left(Directory, 1) &lt;&gt; \"\\\" Then\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>If Right(Directory, 1) &lt;&gt; \"\\\" Then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 5269225, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-06eg22BdD9o/AAAAAAAAAAI/AAAAAAAABh4/CLwH3vfWWg4/photo.jpg?sz=128", "display_name": "thatguy", "link": "https://stackoverflow.com/users/5269225/thatguy"}, "edited": false, "score": 0, "creation_date": 1467890351, "post_id": 38229776, "comment_id": 63909111, "body": "Many thanks Hans! After a very small modification to your code, I managed to get it to work perfectly for me. It is now placing the date from the Excel file name into the &#39;file_date&#39; field within the &#39;FD_Worksheet_master&#39; table for every row in the original spreadsheet. From here, do you know how I would import the columns &#39;K&#39;, &#39;N&#39;, &#39;AO&#39;, and &#39;AP&#39; from Sheet1 of the worksheet? I&#39;m very new to MS Access VBA, so please forgive my lack of ability!"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 57, "user_id": 5269225, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-06eg22BdD9o/AAAAAAAAAAI/AAAAAAAABh4/CLwH3vfWWg4/photo.jpg?sz=128", "display_name": "thatguy", "link": "https://stackoverflow.com/users/5269225/thatguy"}, "edited": false, "score": 0, "creation_date": 1467901204, "post_id": 38229776, "comment_id": 63917128, "body": "I used <code>HDR=YES</code> in the query&#39;s connection to the workbook because you had True for the <i>HasFieldNames</i> parameter with <code>TransferSpreadsheet</code>.  So that means the field/column names/headers should be present in the first row of the worksheet.  Look up the names for those columns and substitute those where I had <code>xl.Annual, xl.Monthly, xl.Hourly</code> in my query."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 57, "user_id": 5269225, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-06eg22BdD9o/AAAAAAAAAAI/AAAAAAAABh4/CLwH3vfWWg4/photo.jpg?sz=128", "display_name": "thatguy", "link": "https://stackoverflow.com/users/5269225/thatguy"}, "edited": false, "score": 0, "creation_date": 1467901455, "post_id": 38229776, "comment_id": 63917307, "body": "If I misunderstood your situation, and you don&#39;t have names/headers in the first spreadsheet row, make another query which is just <code>SELECT *</code> with your working <code>FROM</code> clause and <code>HDR=NO</code>.  When you run that query, Access will assign names ... such as <code>F1</code>, <code>F2</code>, etc. ... to the columns.  Find out which names correspond to the columns you want, and use those names in the main query."}, {"owner": {"reputation": 57, "user_id": 5269225, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-06eg22BdD9o/AAAAAAAAAAI/AAAAAAAABh4/CLwH3vfWWg4/photo.jpg?sz=128", "display_name": "thatguy", "link": "https://stackoverflow.com/users/5269225/thatguy"}, "edited": false, "score": 0, "creation_date": 1467966035, "post_id": 38229776, "comment_id": 63943831, "body": "Again Hans, your solution worked perfectly. I added my column names to the code and it brought everything in as I wanted.I will post my final code below. Thank you!"}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": false, "score": 1, "last_activity_date": 1467825590, "last_edit_date": 1467825590, "creation_date": 1467824965, "answer_id": 38229776, "question_id": 38227454, "link": "https://stackoverflow.com/questions/38227454/adding-a-unique-id-field-to-identify-spreadsheets-imported-from-different-excel/38229776#38229776", "title": "Adding a unique ID field to identify spreadsheets imported from different Excel files with VBA", "body": "<p>You can use an Access \"append query\" with your worksheet as its data source.  That way you can import only the columns you need, and you can also extract the date from the workbook file name and use it for a query parameter.  </p>\n\n<p>In this example, I import only one XLSX file.  My Access destination table, \"FD_Worksheet_master\", includes a Date/Time field named \"file_date\".  And the Excel data I want to import is in a worksheet named \"Sheet1\".</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim db As DAO.Database\nDim qdf As DAO.QueryDef\nDim astrPieces() As String\nDim dteFileDate As Date\nDim strDir As String\nDim strFile As String\nDim strInsert As String\n\nstrDir = \"C:\\Users\\hans\\Documents\\\"\nstrFile = \"FD Worksheet 01 06 2016.xlsx\"\n\nIf Not strDir Like \"*\\\" Then\n    strDir = strDir &amp; \"\\\"\nEnd If\nstrInsert = \"INSERT INTO FD_Worksheet_master (file_date, Annual, Monthly, Hourly)\" &amp; vbCrLf &amp; _\n    \"SELECT [which_date] as file_date, xl.Annual, xl.Monthly, xl.Hourly\" &amp; vbCrLf &amp; _\n    \"FROM [Excel 12.0 Xml;HDR=YES;IMEX=2;DATABASE=\" &amp; strDir &amp; strFile &amp; \"].[Sheet1$] AS xl;\"\nDebug.Print strInsert\nastrPieces = Split(strFile, \" \")\n' Note: I assumed \"01 06 2016\" is \"mm dd yyyy\" format.\n' If actually \"dd mm yyyy\", swap the order of astrPieces(2) and astrPieces(3)\ndteFileDate = DateSerial(Val(astrPieces(4)), astrPieces(2), astrPieces(3))\nDebug.Print dteFileDate\nSet db = CurrentDb\nSet qdf = db.CreateQueryDef(vbNullString, strInsert)\nqdf.Parameters(\"which_date\").Value = dteFileDate\nqdf.Execute dbFailOnError\n</code></pre>\n\n<p>You may need to change the <code>IMEX</code> value; if 2 doesn't work, try 1.</p>\n"}, {"tags": [], "owner": {"reputation": 57, "user_id": 5269225, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-06eg22BdD9o/AAAAAAAAAAI/AAAAAAAABh4/CLwH3vfWWg4/photo.jpg?sz=128", "display_name": "thatguy", "link": "https://stackoverflow.com/users/5269225/thatguy"}, "is_accepted": true, "score": 1, "last_activity_date": 1467966276, "creation_date": 1467966276, "answer_id": 38262110, "question_id": 38227454, "link": "https://stackoverflow.com/questions/38227454/adding-a-unique-id-field-to-identify-spreadsheets-imported-from-different-excel/38262110#38262110", "title": "Adding a unique ID field to identify spreadsheets imported from different Excel files with VBA", "body": "<p>Final working code is below, solution was found using HansUp's help:</p>\n\n<pre><code>Option Compare Database\n\nPublic Function importExcelSheets1()\n\nDim db As DAO.Database\nDim qdf As DAO.QueryDef\nDim astrPieces() As String\nDim dteFileDate As Date\nDim strDir As String\nDim strFile As String\nDim strInsert As String\n\nDim Directory As String\nDim TableName As String\n\nDirectory = \"F:\\FD Worksheets\\JUN 2016\"\nTableName = \"FD_Worksheet_Master\"\n\nDim strTable As String\nDim I As Long\nI = 0\n\nIf Right(Directory, 1) &lt;&gt; \"\\\" Then\n   strDir = Directory &amp; \"\\\"\nElse\n   strDir = Directory\nEnd If\nstrFile = Dir(strDir &amp; \"*.XLSX\")\nWhile strFile &lt;&gt; \"\"\n    I = I + 1\n    Debug.Print \"importing \" &amp; strFile\n\nIf Not strDir Like \"*\\\" Then\n    strDir = strDir &amp; \"\\\"\nEnd If\nstrInsert = \"INSERT INTO FD_Worksheet_master (file_date, Prod, Average_Cost, WSP, RRP)\" &amp; vbCrLf &amp; _\n\"SELECT [which_date] as file_date, xl.Prod, xl.Average_Cost, xl.WSP, xl.RRP\" &amp; vbCrLf &amp; _\n\"FROM [Excel 12.0 Xml;HDR=YES;IMEX=2;DATABASE=\" &amp; strDir &amp; strFile &amp; \"].[Sheet1$] AS xl;\"\nDebug.Print strInsert\nastrPieces = Split(Left(strFile, Len(strFile) - 5), \" \")\ndteFileDate = DateSerial(Val(astrPieces(4)), astrPieces(3), astrPieces(2))\nDebug.Print dteFileDate\nSet db = CurrentDb\nSet qdf = db.CreateQueryDef(vbNullString, strInsert)\nqdf.Parameters(\"which_date\").Value = dteFileDate\nqdf.Execute dbFailOnError\n\n     strFile = Dir()\nWend\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 5269225, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-06eg22BdD9o/AAAAAAAAAAI/AAAAAAAABh4/CLwH3vfWWg4/photo.jpg?sz=128", "display_name": "thatguy", "link": "https://stackoverflow.com/users/5269225/thatguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 842, "favorite_count": 0, "accepted_answer_id": 38262110, "answer_count": 3, "score": 2, "last_activity_date": 1467966276, "creation_date": 1467817755, "last_edit_date": 1467825033, "question_id": 38227454, "link": "https://stackoverflow.com/questions/38227454/adding-a-unique-id-field-to-identify-spreadsheets-imported-from-different-excel", "title": "Adding a unique ID field to identify spreadsheets imported from different Excel files with VBA", "body": "<p>I have 2 questions relating to the title, one more essential than the other. I am using the following code to import all excel files within a folder to my MS Access database:</p>\n\n<pre><code>Option Compare Database\n\nPublic Function importExcelSheets(Directory As String, TableName As String) As Long\nOn Error Resume Next\nDim strDir As String\nDim strFile As String\nDim strTable As String\nDim I As Long\nI = 0\n\nIf Left(Directory, 1) &lt;&gt; \"\\\" Then\n   strDir = Directory &amp; \"\\\"\nElse\n   strDir = Directory\nEnd If\nstrFile = Dir(strDir &amp; \"*.XLSX\")\nWhile strFile &lt;&gt; \"\"\n    I = I + 1\n    strFile = strDir &amp; strFile\n    Debug.Print \"importing \" &amp; strFile\n    DoCmd.TransferSpreadsheet acImport, , TableName, strFile, True, Range:=\"Sheet1!K:AP\"\n    strFile = Dir()\n\nWend\nimportExcelSheets = I\nEnd Function\n</code></pre>\n\n<p><strong>1)</strong> My first and more crucial problem, is that I have no way of identifying which file is which in the table that has received all the imports from Excel, as the files do not include a date field. The spreadsheets I am importing will be produced on a daily basis, so I want to create an additional column in the MS Access table with a section taken from the name of the Excel file, which contains the date it was produced on. The Excel files to be imported will be formatted as \"FD Worksheet 01 06 2016\", with the date section of the name relating to the date it was created.</p>\n\n<p>Could someone show me how I would go about modifying my code for this? Ideally I would like to save the new date field with a \"/\" between the date/month/year so as it's formatted correctly.</p>\n\n<p><strong>2)</strong> My second and less important question; is it possible to only import specific fields? My code above is only able to import fields between two columns, and not specific ones. I would only need columns 'K', 'N', 'AO', and 'AP'(Col numbers 11, 14, 41, 42), as this would vastly reduce the size of the imports.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467817210, "post_id": 38227211, "comment_id": 63876415, "body": "I just tested both of them on a valid date string. Both returned the same results. You could try <code>Format(&#39;date_string&#39;,&quot;mm-dd-yyyy&quot;)</code> for example."}, {"owner": {"reputation": 407, "user_id": 3613953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/635657346a5d78bcd7714fe1785011f5?s=128&d=identicon&r=PG&f=1", "display_name": "sirius_pain", "link": "https://stackoverflow.com/users/3613953/sirius-pain"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1467817718, "post_id": 38227211, "comment_id": 63876739, "body": "@ScottHoltzman - I failed to clarify; by serialization I mean something along the lines of how the date <code>1&#47;19&#47;2016</code> would become <code>42388</code>."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1467817855, "post_id": 38227211, "comment_id": 63876829, "body": "Just change the NumberFormat of the target cell to <code>&quot;General&quot;</code>"}, {"owner": {"reputation": 407, "user_id": 3613953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/635657346a5d78bcd7714fe1785011f5?s=128&d=identicon&r=PG&f=1", "display_name": "sirius_pain", "link": "https://stackoverflow.com/users/3613953/sirius-pain"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1467818015, "post_id": 38227211, "comment_id": 63876949, "body": "@ScottCraner - I need a means of doing a conversion from within the macro editor; cells cannot be altered."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1467818384, "post_id": 38227211, "comment_id": 63877175, "body": "In vba: <code>Range(&quot;A1&quot;) = &quot;1&#47;1&#47;2016&quot;</code> then <code>Range(&quot;A1&quot;).NumberValue = &quot;General&quot;</code>"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1467818498, "post_id": 38227211, "comment_id": 63877254, "body": "@ScottCraner I think the point is that the value needs to be used in VBA and not directly in a cell. While this can get the result it means editing cells when they don&#39;t really need to be edited."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1467818617, "post_id": 38227211, "comment_id": 63877340, "body": "@Brad then no conversion is needed, excel will use the value of the date behind the scenes not the text of the date. <b>edit</b> if the date is a true date and not text that looks like a date."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1467818730, "post_id": 38227211, "comment_id": 63877421, "body": "@ScottCraner it&#39;s not clear what the end game is here but I assume they&#39;re using that date-as-a-number value for something else and have not elaborated fully here. Seems like a possible XY problem if that&#39;s the case"}], "answers": [{"comments": [{"owner": {"reputation": 407, "user_id": 3613953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/635657346a5d78bcd7714fe1785011f5?s=128&d=identicon&r=PG&f=1", "display_name": "sirius_pain", "link": "https://stackoverflow.com/users/3613953/sirius-pain"}, "edited": false, "score": 0, "creation_date": 1467818744, "post_id": 38227512, "comment_id": 63877427, "body": "Fantastic. Thanks!"}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 4, "last_activity_date": 1467817953, "creation_date": 1467817953, "answer_id": 38227512, "question_id": 38227211, "link": "https://stackoverflow.com/questions/38227211/vba-equivalent-of-datevalue/38227512#38227512", "title": "VBA equivalent of DATEVALUE?", "body": "<p>Use <code>CLng</code> e.g.</p>\n\n<pre><code>=DATEVALUE(\"7/7/16\")\n</code></pre>\n\n<p>Returns</p>\n\n<pre><code>42558\n</code></pre>\n\n<p>In VBA:</p>\n\n<pre><code>? CLng(DateValue(\"7/7/16\"))\n 42558 \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "is_accepted": false, "score": 2, "last_activity_date": 1467818950, "last_edit_date": 1467818950, "creation_date": 1467818348, "answer_id": 38227641, "question_id": 38227211, "link": "https://stackoverflow.com/questions/38227211/vba-equivalent-of-datevalue/38227641#38227641", "title": "VBA equivalent of DATEVALUE?", "body": "<p>Several ways to do this. @Robin has a good one. I'll add one more</p>\n\n<pre><code>?DateDiff(\"d\",0, \"7/7/16\")\n42558\n</code></pre>\n\n<p>The <a href=\"http://www.techonthenet.com/excel/formulas/datediff.php\" rel=\"nofollow\"><code>DateDiff</code></a> function calculates the difference between the two dates (2nd and 3rd parameters) in the units of the first parameter. So if you changed <code>\"d\"</code> to <code>\"h\"</code> you would get the number of hours between 0 (the first possible date in Excel/VBA) and <code>7/7/2016</code></p>\n"}], "owner": {"reputation": 407, "user_id": 3613953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/635657346a5d78bcd7714fe1785011f5?s=128&d=identicon&r=PG&f=1", "display_name": "sirius_pain", "link": "https://stackoverflow.com/users/3613953/sirius-pain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1913, "favorite_count": 0, "accepted_answer_id": 38227512, "answer_count": 2, "score": 1, "last_activity_date": 1467818950, "creation_date": 1467817034, "last_edit_date": 1531161705, "question_id": 38227211, "link": "https://stackoverflow.com/questions/38227211/vba-equivalent-of-datevalue", "title": "VBA equivalent of DATEVALUE?", "body": "<p>The formula function of =DATEVALUE and VBA's DateValue() provide exclusive results. How can I format a date in VBA to obtain the same serialization as I would by using =DATEVALUE?</p>\n\n<p><strong>Example:</strong> <code>1/19/2016</code>, formatted \"m/d/yyyy\", will return <code>42388</code> through <code>=DATEVALUE()</code></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1467816797, "post_id": 38227054, "comment_id": 63876112, "body": "Check out the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840057.aspx\" rel=\"nofollow noreferrer\"><code>Workbook_BeforeSave</code> Event</a>"}], "answers": [{"comments": [{"owner": {"reputation": 634, "user_id": 1369499, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/d8273c0ebae94eea9e71e782f05c8b5c?s=128&d=identicon&r=PG", "display_name": "PeterS", "link": "https://stackoverflow.com/users/1369499/peters"}, "edited": false, "score": 0, "creation_date": 1467817228, "post_id": 38227137, "comment_id": 63876430, "body": "I know that im going to use that one, my problem is that, how can I read thru the entire sheet and get the cell address with missing value"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 634, "user_id": 1369499, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/d8273c0ebae94eea9e71e782f05c8b5c?s=128&d=identicon&r=PG", "display_name": "PeterS", "link": "https://stackoverflow.com/users/1369499/peters"}, "edited": false, "score": 0, "creation_date": 1467817378, "post_id": 38227137, "comment_id": 63876527, "body": "@PeterS you don&#39;t need to read through the entire sheet if you know what cells to read. <code>If Sheet1.Range(&quot;D1&quot;).Value = vbNullString Or Sheet1.Range(&quot;G2&quot;).Value = vbNullString Then MsgBox &quot;No you don&#39;t!&quot;</code>"}, {"owner": {"reputation": 634, "user_id": 1369499, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/d8273c0ebae94eea9e71e782f05c8b5c?s=128&d=identicon&r=PG", "display_name": "PeterS", "link": "https://stackoverflow.com/users/1369499/peters"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1467818238, "post_id": 38227137, "comment_id": 63877066, "body": "@Mat&#39;sMug I have updated my question with my code. Can you help me figure out the problem on this?"}, {"owner": {"reputation": 634, "user_id": 1369499, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/d8273c0ebae94eea9e71e782f05c8b5c?s=128&d=identicon&r=PG", "display_name": "PeterS", "link": "https://stackoverflow.com/users/1369499/peters"}, "edited": false, "score": 0, "creation_date": 1467880886, "post_id": 38227137, "comment_id": 63903024, "body": "@RGA we cant use this target range inside the BeforeSave method? What should I change on my code above to handle this?"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 634, "user_id": 1369499, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/d8273c0ebae94eea9e71e782f05c8b5c?s=128&d=identicon&r=PG", "display_name": "PeterS", "link": "https://stackoverflow.com/users/1369499/peters"}, "edited": false, "score": 0, "creation_date": 1467881447, "post_id": 38227137, "comment_id": 63903369, "body": "@PeterS As stated above, loop through all the values in the workbook when you save and check your conditions."}], "tags": [], "owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "is_accepted": false, "score": 2, "last_activity_date": 1467875322, "last_edit_date": 1467875322, "creation_date": 1467816799, "answer_id": 38227137, "question_id": 38227054, "link": "https://stackoverflow.com/questions/38227054/how-to-throw-an-error-when-the-user-hit-save-in-vba/38227137#38227137", "title": "How to Throw an Error when the User Hit Save in VBA", "body": "<p>Use the workbook beforeSave event and handle accordingly:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, _ \n        Cancel as Boolean) \n   'your code here\nEnd Sub\n</code></pre>\n\n<p>Edit for OP's new code:</p>\n\n<p>You never defined what Target is in your code, so the intersect method will always return nothing (if it even works at all).   I think you are confusing the Worksheet_change method (which includes a \"Target\" range), with that of Save.  You'll have to define what the Target is when the BeforeSave method runs.  I'd recommend running a loop through the specific range of values and checking that all the desired conditions are met.  If some aren't as desired, then you can display a message for the user pointing them to the missing data and prevent the save.</p>\n"}, {"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1467817484, "post_id": 38227161, "comment_id": 63876593, "body": "Why is the minus? What is not complete in the answer?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1467817758, "post_id": 38227161, "comment_id": 63876767, "body": "Not my downvote (I actually +1&#39;d for making the distinction between <i>messaging the user</i> and <i>throwing an error</i>), but your answer doesn&#39;t spoonfeed the user with code they can copy &amp; paste without understanding what they&#39;re doing."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1467818101, "post_id": 38227161, "comment_id": 63876992, "body": "To be fair, it doesn&#39;t <i>actually</i> answer the OP&#39;s question, but IMO OP&#39;s question is &quot;gimmeh-teh-codez&quot; and doesn&#39;t display much research effort."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1467818341, "post_id": 38227161, "comment_id": 63877143, "body": "Well, I took into account the first comment, thus I wanted to add to it w/o repeating it."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1467816872, "creation_date": 1467816872, "answer_id": 38227161, "question_id": 38227054, "link": "https://stackoverflow.com/questions/38227054/how-to-throw-an-error-when-the-user-hit-save-in-vba/38227161#38227161", "title": "How to Throw an Error when the User Hit Save in VBA", "body": "<p>Try with one of these two lines. It is not a good idea to throw errors like this, but if you want so much...\nThis is a message box:</p>\n\n<pre><code>msgbox \"Enter a value of the following cells. D1 G2\"\n</code></pre>\n\n<p>This is an error:</p>\n\n<pre><code>err.Raise 1, description:= \"Enter a value of the following cells. D1 G2\"\n</code></pre>\n"}], "owner": {"reputation": 634, "user_id": 1369499, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/d8273c0ebae94eea9e71e782f05c8b5c?s=128&d=identicon&r=PG", "display_name": "PeterS", "link": "https://stackoverflow.com/users/1369499/peters"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1467875322, "creation_date": 1467816599, "last_edit_date": 1467819594, "question_id": 38227054, "link": "https://stackoverflow.com/questions/38227054/how-to-throw-an-error-when-the-user-hit-save-in-vba", "title": "How to Throw an Error when the User Hit Save in VBA", "body": "<p>In my Column A, I have a selection that lets the user to select \"Yes\" or \"No\". There's a required cell for both selection.</p>\n\n<pre><code>Example:\nIf User selects \"YES\"\n Mandatory cells will be in Colum A, D and E\nIf User selects \"No\"\n Mandatory cells will be in Colum B, C and G\n</code></pre>\n\n<p>Lets say the in Row 1, the User selects \"Yes\" and entered a value on A1 and E1 but he forgot to add value in cell D1. \nIn Row 2, The user selects \"No\" and entered a value on B2 and C2 and forgot to enter a value on cell G2.</p>\n\n<p>When he hit save, I want to throw an error saying the \"<strong>Enter a value of the following cells. D1, G2</strong>.</p>\n\n<p>I have this code below:</p>\n\n<pre><code>   Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\n    Dim Target As Range\n    If Not Intersect(Target, Range(\"A:A\")) Is Nothing Then\n\n                If Target = \"YES\" Then\n\n                     For i = 1 To 15\n                        If Target.Offset(0, i).Value = \"\" Then\n                         MsgBox \"Enter values on the mandatory cells (green)\", vbCritical, \"\"\n                        End If\n                     Next i\n                        Cancel = True\n\n                ElseIf Target = \"NO\" Then\n                    For i = 16 To 30\n                         If Target.Offset(0, i).Value = \"\" Then\n                          MsgBox \"Enter values on the mandatory cells (green)\", vbCritical, \"\"\n                        End If\n                    Next i\n                    Cancel = True\n                End If\n         End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["forms", "ms-access", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1467819213, "post_id": 38226628, "comment_id": 63877744, "body": "I simply close the already-opened form in these cases, and then re-open it with my filter. &lt;shrug&gt; -- To avoid flicker, you can do <code>Application.Echo False</code> while doing this."}, {"owner": {"reputation": 11, "user_id": 5044373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c83146e412a073109525128708d3282a?s=128&d=identicon&r=PG&f=1", "display_name": "tonyuk1977", "link": "https://stackoverflow.com/users/5044373/tonyuk1977"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1467820098, "post_id": 38226628, "comment_id": 63878344, "body": "I have consider this approach but my users resize the forms and arrange them to their liking, so I would have to record the position and size of the form to then reopen it in the same location and size. I also considered catching the error to trigger the close and reopen. I was hoping that there would be a form property I could check, but I have had no luck finding it."}, {"owner": {"reputation": 11, "user_id": 5044373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c83146e412a073109525128708d3282a?s=128&d=identicon&r=PG&f=1", "display_name": "tonyuk1977", "link": "https://stackoverflow.com/users/5044373/tonyuk1977"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1467879995, "post_id": 38226628, "comment_id": 63902522, "body": "I found this which give me more information but no solution to the problem, i does how ever make the question more specific <a href=\"https://msdn.microsoft.com/en-us/library/office/ff191892.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff191892.aspx</a>. How do I test for these filer augments  acFilterByForm, acFilterAdvanced?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5044373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c83146e412a073109525128708d3282a?s=128&d=identicon&r=PG&f=1", "display_name": "tonyuk1977", "link": "https://stackoverflow.com/users/5044373/tonyuk1977"}, "edited": false, "score": 0, "creation_date": 1467891816, "post_id": 38242342, "comment_id": 63910122, "body": "Now I just need to figure out how to cancel the filterbyform rather then close and reopen the form."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1467884817, "creation_date": 1467884817, "answer_id": 38242342, "question_id": 38226628, "link": "https://stackoverflow.com/questions/38226628/how-to-check-if-form-view-is-filterbyform/38242342#38242342", "title": "How to check if form view is filterbyform", "body": "<p>Ah, good find with the <code>Filter</code> event!</p>\n\n<p>I would use a public variable in the module of <code>MyForm</code> that saves the FilterByForm state and can be accessed from the outside:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPublic bFilterByForm As Boolean\n</code></pre>\n\n<p>It is set and cleared in the <code>Filter</code> and <code>ApplyFilter</code> events:</p>\n\n<pre><code>Private Sub Form_ApplyFilter(Cancel As Integer, ApplyType As Integer)\n\n    ' acShowAllRecords = 0\n    ' acApplyFilter = 1\n    ' acCloseFilterWindow = 2\n    Debug.Print \"Form_ApplyFilter: \" &amp; ApplyType\n\n    ' I don't think checking for ApplyType is necessary - \n    ' in each case the filter windows is closed.\n\n    ' FilterByForm is finished!\n    bFilterByForm = False\n\nEnd Sub\n\nPrivate Sub Form_Filter(Cancel As Integer, FilterType As Integer)\n\n    ' acFilterByForm = 0\n    ' acFilterAdvanced = 1\n    Debug.Print \"Form_Filter: \" &amp; FilterType\n\n    If FilterType = acFilterByForm Then\n        ' FilterByForm is active!\n        bFilterByForm = True\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>and using this variable your calling sub can check the FilterByForm state:</p>\n\n<pre><code>If Form_MyForm.bFilterByForm Then\n    ' FilterByForm is active: close the form!\n    DoCmd.Close acForm, \"MyForm\"\n    DoCmd.OpenForm \"MyForm\", , mysql\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 5044373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c83146e412a073109525128708d3282a?s=128&d=identicon&r=PG&f=1", "display_name": "tonyuk1977", "link": "https://stackoverflow.com/users/5044373/tonyuk1977"}, "edited": false, "score": 0, "creation_date": 1467905974, "post_id": 38246362, "comment_id": 63920657, "body": "I replaced the acCmdApplyFilterSort with acCmdCloseWindow and it closes the filter window without applying a filter which I prefer greatly but once the window closes I get a &quot;no record&quot; error. any ideas?"}], "tags": [], "owner": {"reputation": 11, "user_id": 5044373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c83146e412a073109525128708d3282a?s=128&d=identicon&r=PG&f=1", "display_name": "tonyuk1977", "link": "https://stackoverflow.com/users/5044373/tonyuk1977"}, "is_accepted": false, "score": 0, "last_activity_date": 1467896939, "creation_date": 1467896939, "answer_id": 38246362, "question_id": 38226628, "link": "https://stackoverflow.com/questions/38226628/how-to-check-if-form-view-is-filterbyform/38246362#38246362", "title": "How to check if form view is filterbyform", "body": "<p>Massive thank you to Andre for all his help, my final solution is mostly his work with a slight edit to allow the form to stay open. I added this function to details form AKA MyForm</p>\n\n<pre><code>Public Sub RunApplyFilter()\nForms(\"MyForm\").SetFocus\nDoCmd.RunCommand acCmdApplyFilterSort\nEnd Sub\n</code></pre>\n\n<p>And the final checks use Andre method to identify if MyForm is in FilterByForm view.</p>\n\n<pre><code>If CurrentProject.AllForms(\"MyForm\").IsLoaded = False Then\n  DoCmd.OpenForm \"MyForm\", , mysql\nElse \n  If [Form_MyForm].bFilterByForm = True Then Forms(\"MyForm\").RunApplyFilter\n  If Forms(\"MyForm\").FilterOn = True Then Forms(\"MyForm\").FilterOn = False\n  Forms(\"MyForm\").Filter = myfil\n  Forms(\"MyForm\").FilterOn = True\nEnd If\n</code></pre>\n\n<p>Thanks again to Andre.</p>\n"}], "owner": {"reputation": 11, "user_id": 5044373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c83146e412a073109525128708d3282a?s=128&d=identicon&r=PG&f=1", "display_name": "tonyuk1977", "link": "https://stackoverflow.com/users/5044373/tonyuk1977"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 278, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1467896939, "creation_date": 1467815452, "question_id": 38226628, "link": "https://stackoverflow.com/questions/38226628/how-to-check-if-form-view-is-filterbyform", "title": "How to check if form view is filterbyform", "body": "<p>I am using two forms. The form this code is from shows a weekly summary of booked appointments: it contains text boxes that display a count of appointments for each team on each day, and daily and weekly totals. I have replaced the double click events for all the text boxes with a function. When a text box is double clicked another form is used to display records that are counted in that text box. It all works great unless the user already has the details form open and has selected the filter by form option but has not yet applied the filter.</p>\n\n<p>I check to see if the details form is open, if not then I open it with an SQL sting to show the records for the counted appointments. If the details form is already open then I check to see if a filter is applied, remove it, then filter to show the records for the counted appointments.</p>\n\n<pre><code>If CurrentProject.AllForms(\"MyForm\").IsLoaded = False Then \n  DoCmd.OpenForm \"MyForm\", , mysql\nElse\n  If Forms(\"MyForm\").FilterOn = True Then Forms(\"MyForm\").FilterOn = False\n  Forms(\"MyForm\").Filter = myfil\n  Forms(\"MyForm\").FilterOn = True\nEnd If\n</code></pre>\n\n<p>How can I check if the details form is in the filter by form view/state? and if it is, close it. So I can apply the filter to show the records of the counted appointments.</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1467815165, "post_id": 38226328, "comment_id": 63874882, "body": "What do you mean by &quot;not working&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1467814995, "post_id": 38226415, "comment_id": 63874744, "body": "Why don&#39;t you update your answer to advise to use <code>CDbl</code> instead - it will make it a better answer ;-)"}, {"owner": {"reputation": 731, "user_id": 3279257, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1322a2208bf846dd7881f9cc2c95a260?s=128&d=identicon&r=PG&f=1", "display_name": "Grace", "link": "https://stackoverflow.com/users/3279257/grace"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1467815177, "post_id": 38226415, "comment_id": 63874890, "body": "Re: <code>Robin</code> yup, just revised. Thanks"}, {"owner": {"reputation": 731, "user_id": 3279257, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1322a2208bf846dd7881f9cc2c95a260?s=128&d=identicon&r=PG&f=1", "display_name": "Grace", "link": "https://stackoverflow.com/users/3279257/grace"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1467815516, "post_id": 38226415, "comment_id": 63875161, "body": "Re: <code>Norby</code> if you find the answer helpful, may you please mark it as acceptable answer, thanks so much : )"}, {"owner": {"reputation": 149, "user_id": 6370309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7105d99cd54c0e47803d8434775f6cfa?s=128&d=identicon&r=PG&f=1", "display_name": "Norby", "link": "https://stackoverflow.com/users/6370309/norby"}, "edited": false, "score": 0, "creation_date": 1467815651, "post_id": 38226415, "comment_id": 63875257, "body": "Thanks so much, it&#39;s working! Answer has been marked"}, {"owner": {"reputation": 731, "user_id": 3279257, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1322a2208bf846dd7881f9cc2c95a260?s=128&d=identicon&r=PG&f=1", "display_name": "Grace", "link": "https://stackoverflow.com/users/3279257/grace"}, "edited": false, "score": 0, "creation_date": 1467815678, "post_id": 38226415, "comment_id": 63875281, "body": "happy to be helpful : )"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 1, "creation_date": 1467816220, "post_id": 38226415, "comment_id": 63875679, "body": "@Grace FYI, use &quot;@&quot; and the username of the user you are trying to notify to notify them of your comment"}], "tags": [], "owner": {"reputation": 731, "user_id": 3279257, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1322a2208bf846dd7881f9cc2c95a260?s=128&d=identicon&r=PG&f=1", "display_name": "Grace", "link": "https://stackoverflow.com/users/3279257/grace"}, "is_accepted": true, "score": 2, "last_activity_date": 1467816698, "last_edit_date": 1467816698, "creation_date": 1467814905, "answer_id": 38226415, "question_id": 38226328, "link": "https://stackoverflow.com/questions/38226328/data-type-for-changing-size-of-shapes/38226415#38226415", "title": "Data type for changing size of shapes", "body": "<p>It's because you use <code>CInt</code> in </p>\n\n<pre><code>objHeigh = CInt(InputBox$(\"Assign a new size of Height\", \"Heigh\"))\n</code></pre>\n\n<p>casting the result as an <code>integer</code>.<br>\nSo, <strong>the answer should be as below:</strong></p>\n\n<pre><code>objHeigh = CDbl(InputBox$(\"Assign a new size of Height\", \"Heigh\"))\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 6370309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7105d99cd54c0e47803d8434775f6cfa?s=128&d=identicon&r=PG&f=1", "display_name": "Norby", "link": "https://stackoverflow.com/users/6370309/norby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 1, "accepted_answer_id": 38226415, "answer_count": 1, "score": 1, "last_activity_date": 1467816698, "creation_date": 1467814673, "question_id": 38226328, "link": "https://stackoverflow.com/questions/38226328/data-type-for-changing-size-of-shapes", "title": "Data type for changing size of shapes", "body": "<p>My VBA code works very well. I can change multple size of shapes, but is working only for rounded numbers. If I wand to change size of shape to be 2.5 or 5.5 is not working, but data type of variable is double. Any ideas?</p>\n\n<p>Thank you</p>\n\n<pre><code>Function ConvertPointToCm(ByVal pnt As Double) As Double\nConvertPointToCm = pnt * 0.03527778\nEnd Function\n\nFunction ConvertCmToPoint(ByVal cm As Double) As Double\nConvertCmToPoint = cm * 28.34646\nEnd Function\n\n\nSub test()\n\nDim objHeigh As Double\nDim objWidth As Double\nDim oSh As Shape\n\nOn Error GoTo CheckErrors\n\nWith ActiveWindow.Selection.ShapeRange\nIf .Count = 0 Then\n    MsgBox \"You need to select a shape first\"\n    Exit Sub\nEnd If\nEnd With\n\n objHeigh = CInt(InputBox$(\"Assign a new size of Height\", \"Heigh\"))\n' give the user a way out\nIf objHeigh = 0 Then\nExit Sub\nEnd If\nobjHeigh = ConvertCmToPoint(objHeigh)\n\nobjWidth = CInt(InputBox$(\"Assign a new size of Width\", \"Width\"))\n' give the user a way out\nIf objWidth = 0 Then\nExit Sub\nEnd If\nobjWidth = ConvertCmToPoint(objWidth)\n\nFor Each oSh In ActiveWindow.Selection.ShapeRange\nIf objName &lt;&gt; \"\" Then\n    oSh.Name = objName\nEnd If\n\noSh.Height = CInt(objHeigh)\n  oSh.Width = CInt(objWidth)\nNext\nExit Sub\n\nCheckErrors: MsgBox Err.Description\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "colors", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "edited": false, "score": 0, "creation_date": 1467884344, "post_id": 38226518, "comment_id": 63905229, "body": "Thank you for ypur answer! i still have one mistake in the line: TextFrame.TextRange.Font.Color.RGB = RGB(0, 0, 0). It always comes Object required! what should i do? Thanks"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "edited": false, "score": 0, "creation_date": 1467884472, "post_id": 38226518, "comment_id": 63905320, "body": "@Zigouma Add a period before TextFrame"}], "tags": [], "owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "is_accepted": false, "score": 1, "last_activity_date": 1467816309, "last_edit_date": 1467816309, "creation_date": 1467815154, "answer_id": 38226518, "question_id": 38226234, "link": "https://stackoverflow.com/questions/38226234/code-to-change-the-text-table-color-in-all-the-slides/38226518#38226518", "title": "Code to change the text table Color in all the Slides", "body": "<p>Not every shape has a Table associated with it.  Just add the statement <code>If oSh.HasTable Then...</code> And it should work</p>\n\n<p>This <code>If</code> statement should be placed to encapsulate all of the Table calls, so place it directly before the <code>Set oTbl = oSh.Table</code> line</p>\n"}], "owner": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1200, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1479395204, "creation_date": 1467814433, "last_edit_date": 1479395204, "question_id": 38226234, "link": "https://stackoverflow.com/questions/38226234/code-to-change-the-text-table-color-in-all-the-slides", "title": "Code to change the text table Color in all the Slides", "body": "<p>I want a macro that loops through all the slides and change the text in a table to black. When I try the code below, I get the error message: <code>Method 'Table' of 'Shape' failed</code>.</p>\n\n<p>This is my code:</p>\n\n<pre><code>Sub TableAllBlack()\n\nDim lRaw As Integer\nDim lCol As Integer\nDim oTbl As Table\nDim osld As Slide\nDim oShp As Shape\n\nWith ActivePresentation\n    For Each oSl In .Slides\n        For Each oSh In oSl.Shapes\n            Set oTbl = oSh.Table\n                With oTbl\n                    For lRow = 1 To .Rows.Count\n                            For lCol = 1 To .Columns.Count\n                                With .Cell(lRow, lCol).Shape\n                                    If .HasTextFrame Then\n                                        If .TextFrame.HasText Then\n                                            TextFrame.TextRange.Font.Color.RGB = RGB(0, 0, 0)\n                                        End If\n                                    End If\n                                End With\n                            Next\n                    Next\n                End With\n            Next\n        Next\nEnd With\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "owner": {"reputation": 25, "user_id": 6501124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8990e4be208924b61bd722fb5e8bf295?s=128&d=identicon&r=PG&f=1", "display_name": "salm", "link": "https://stackoverflow.com/users/6501124/salm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1467814053, "creation_date": 1467814002, "last_edit_date": 1531164843, "question_id": 38226072, "link": "https://stackoverflow.com/questions/38226072/vba-index-match-or-something-else", "title": "VBA index match or something else", "body": "<p>I need to reference a unique text string on 2 different worksheets (Master and WI pull) and when a match is found, I need to populate a different column on the 'Master' sheet with data from another column on the WI pull. </p>\n\n<p>I will only need it to do this when the Master sheet destination cell is blank, otherwise it should move to the right 1 cell and again populate if it's blank. It does this for 3 columns only. If all 3 cells in the 3 columns of the same row are none blank, it should do nothing. Once it has done this, it needs to move down 1 cell to repeat.</p>\n\n<p>For example:\nMatch cells in column 'H' from the WI pull with cells in column 'A' from the Master sheet.</p>\n\n<p>Once a match is made, copy 'C' from the same row reference in WI pull into 'W' on the Master sheet providing it's blank otherwise copy it into 'X' if that is blank otherwise copy it into 'Y' if that is blank otherwise do not copy and move down one cell in 'H' on WI pull and repeat the process. </p>\n\n<p>I have this code which does not look for blanks ( I was going to modify the code once I'd got it to work ), however it returns zero's in the destination cell all the way down.</p>\n\n<pre><code> Sub test()\n Dim masterWorkbook As Workbook\n Set masterWorkbook = Application.ActiveWorkbook\n\n Dim masterSheet As Worksheet\n Dim importedSheet As Worksheet\n Set masterSheet = masterWorkbook.Worksheets(\"Master\")\n Set importedSheet = masterWorkbook.Worksheets(\"WI pull\")\n\n masterSheet.Range(\"W7:W1068\").Formula = _\n \"=INDIRECT(\"\"importedSheet!C\"\" &amp; INDEX(MATCH(A1,importedSheet!H:H,0),0,0))\"\n\n masterSheet.Range(\"W7:W1068\").Value = masterSheet.Range(\"W7:W1068\").Value\n End Sub\n</code></pre>\n\n<p>Help appreciated</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467814266, "post_id": 38225952, "comment_id": 63874124, "body": "on a side note, I would just find the 1st row instance using match on cell, then index or offset to get the rest, no point looking up the value 4 times."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1467814033, "post_id": 38226015, "comment_id": 63873957, "body": "<code>rng3.Address(1,1,,True)</code> will put the parent in automatically."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1467813861, "creation_date": 1467813861, "answer_id": 38226015, "question_id": 38225952, "link": "https://stackoverflow.com/questions/38225952/vlookup-in-a-loop-to-copy-information/38226015#38226015", "title": "Vlookup in a loop to copy information", "body": "<p>The syntax is just a bit off. The variable ranges where buried in the quotes inside the VBA syntax. Since you want to return the variable elements you need to concatenate them together in such a way that the code will read the addresses for you.</p>\n\n<p>This is one way to do it.</p>\n\n<pre><code>cell.Offset(0, 1).Formula = \"=vlookup(\" &amp; cell.address &amp; \",\" &amp; rang3.Parent &amp; \"!\" &amp; rang3.address &amp; \",2,0)\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 6555636, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dabe451b8d365b3b48717613b162744a?s=128&d=identicon&r=PG&f=1", "display_name": "Ygor", "link": "https://stackoverflow.com/users/6555636/ygor"}, "edited": false, "score": 0, "creation_date": 1467815061, "post_id": 38226040, "comment_id": 63874794, "body": "I&#39;m trying to do what you said, but my formula is not recognizing the lookup value. Can you help me?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 7, "user_id": 6555636, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dabe451b8d365b3b48717613b162744a?s=128&d=identicon&r=PG&f=1", "display_name": "Ygor", "link": "https://stackoverflow.com/users/6555636/ygor"}, "edited": false, "score": 0, "creation_date": 1467815114, "post_id": 38226040, "comment_id": 63874840, "body": "What is happening, without seeing the data, it&#39;s difficult to assist with a lookup :)  I&#39;ll do my best tho :)"}, {"owner": {"reputation": 7, "user_id": 6555636, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dabe451b8d365b3b48717613b162744a?s=128&d=identicon&r=PG&f=1", "display_name": "Ygor", "link": "https://stackoverflow.com/users/6555636/ygor"}, "edited": false, "score": 0, "creation_date": 1467829164, "post_id": 38226040, "comment_id": 63883706, "body": "Excel is giving me #NAME? and the cell is like this: =PROCV(AERO DINAMICA EQUIPAMENTOS INDUSTRIAIS LTDA;$G$1:$K$1000;2;0)  My excel is in portuguese, so procv = vlookup and AERO DINAMICA EQUIPAMENTOS INDUSTRIAIS LTDA is the name that i&#39;m looking for whit vlookup.  The error tells me that the formula could not recognize the text.  I hope you can help me with this information. Thank You!"}, {"owner": {"reputation": 7, "user_id": 6555636, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dabe451b8d365b3b48717613b162744a?s=128&d=identicon&r=PG&f=1", "display_name": "Ygor", "link": "https://stackoverflow.com/users/6555636/ygor"}, "edited": false, "score": 0, "creation_date": 1467830534, "post_id": 38226040, "comment_id": 63884512, "body": "Instead of &quot;=vlookup(&quot; &amp; cell.value &amp; &quot;,&quot; &amp; rang3.address &amp; &quot;,2,0)&quot; i changed to &quot;=vlookup(&quot; &amp; cell.Address &amp; &quot;,&quot; &amp; rang3.address &amp; &quot;,2,0)&quot;  and worked."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 1, "last_activity_date": 1467813937, "creation_date": 1467813937, "answer_id": 38226040, "question_id": 38225952, "link": "https://stackoverflow.com/questions/38225952/vlookup-in-a-loop-to-copy-information/38226040#38226040", "title": "Vlookup in a loop to copy information", "body": "<p>As you're putting the formula in, you cant use your variables, you need to write like <code>\"=vlookup(\" &amp; cell.value &amp; \",\" &amp; rang3.address &amp; \",2,0)\"</code></p>\n\n<p>Also the forumula look up the same value, should you be incrementing the 2?</p>\n"}], "owner": {"reputation": 7, "user_id": 6555636, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dabe451b8d365b3b48717613b162744a?s=128&d=identicon&r=PG&f=1", "display_name": "Ygor", "link": "https://stackoverflow.com/users/6555636/ygor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 38226040, "answer_count": 2, "score": 0, "last_activity_date": 1467813937, "creation_date": 1467813690, "question_id": 38225952, "link": "https://stackoverflow.com/questions/38225952/vlookup-in-a-loop-to-copy-information", "title": "Vlookup in a loop to copy information", "body": "<p>I'm trying to do a vlookup loop to search values in a list and return them in 4 specifics cells, but my formula its not working, its just returns the names of my variables in the cells.</p>\n\n<pre><code>    Private Sub copydata() 'copy fornecedor data if match\n\nDim rng As Range\nDim rang As Integer\nDim rang2 As Integer\nDim cell As Variant\nDim rang3 As Range\n\n\nrang = Worksheets(\"Plan1\").Range(\"A2\").End(xlDown).Row\nSet rng = ActiveSheet.Range(\"A2:A\" &amp; rang)\nSet rang3 = Range(\"Plan1!$G1:$K1000\")\n\nrang2 = 1\n\n\nFor Each cell In rng\nrang2 = rang2 + 1\n    If cell.Interior.Color = 65535 Then\n\n   cell.Offset(0, 1).Formula = \"=vlookup(cell,rang3,2,0)\"\n   cell.Offset(0, 2).Formula = \"=vlookup(cell,rang3,2,0)\"\n   cell.Offset(0, 3).Formula = \"=vlookup(cell,rang3,2,0)\"\n   cell.Offset(0, 4).Formula = \"=vlookup(cell,rang3,2,0)\"\n\n    End If\n\nNext cell\n   End Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1467815288, "post_id": 38225918, "comment_id": 63874984, "body": "<a href=\"https://msdn.microsoft.com/EN-US/library/office/ff837934.aspx\" rel=\"nofollow noreferrer\">Returns the name of the user who made the specified tracked change. <b>Read-only String</b>.</a> - seems rewriting history isn&#39;t allowed."}, {"owner": {"reputation": 1, "user_id": 7649391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/240105525ce991449292312c71c55e90?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Meier", "link": "https://stackoverflow.com/users/7649391/peter-meier"}, "edited": false, "score": 0, "creation_date": 1580448106, "post_id": 38225918, "comment_id": 106108584, "body": "I have had problems with the first approach suggested in the accepted solutions (Editing the XML): Using four different zip/unzip tools, I have followed the approach of the accepted solution, however, after re-zipping the edited xml file, Word would always complain about a corrupted file. Using the slightly different approach suggested by user1912526 (save as Word xml file rather than docx) not only saves the unzipping/rezipping steps, but it also worked flawlessly on my system."}], "answers": [{"comments": [{"owner": {"reputation": 263, "user_id": 3123518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40c8049fbb7c2227c3a4b5ca29d4428?s=128&d=identicon&r=PG&f=1", "display_name": "garbo999", "link": "https://stackoverflow.com/users/3123518/garbo999"}, "edited": false, "score": 0, "creation_date": 1521899179, "post_id": 38241050, "comment_id": 85933548, "body": "&quot;Edit Open XML&quot; worked for me on a big, complex document."}], "tags": [], "owner": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "is_accepted": true, "score": 2, "last_activity_date": 1467880966, "creation_date": 1467880966, "answer_id": 38241050, "question_id": 38225918, "link": "https://stackoverflow.com/questions/38225918/change-name-of-author-on-tracked-changes/38241050#38241050", "title": "Change name of author on tracked changes", "body": "<p>There is no direct way to change the author of a revision afterwards using VBA. You might be able to change the author beforehand, or you could use one of the following ways:</p>\n\n<h3>Edit Open XML</h3>\n\n<ol>\n<li>Save your document as a .docx file. </li>\n<li>Then open the file using a zip tool such as 7-zip. </li>\n<li>Navigate to <code>word\\document.xml</code> (or whatever part of the document the revision is in, e.g. header, footer, footnote, endnote, ...), right-click and choose <em>Edit</em></li>\n<li>Search and replace the author name and save the changed file to the zip package</li>\n</ol>\n\n<h3>Using Word Compare</h3>\n\n<p>The following method uses Word compare to set the author of all revisions to a specific author (however, be aware that this method generates completely new revisions that might (slightly) differ from your original revisions):</p>\n\n<ol>\n<li><p>Save a copy of the original document, name it V1, and reject all changes in it.</p></li>\n<li><p>Save another copy of the original document, name it V2, and accept all changes in it.</p></li>\n<li><p>Open V1 in Word > Review tab > Compare > Compare.</p></li>\n<li><p>In the \"Compare Documents\" dialog, navigate to and select V1 as the original document, and then V2 as the revised document; type the desired author name after \u201cLabel changes with\u201d; after \u201cShow changes in,\u201d select \u201cNew document,\u201d then click OK.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 179, "user_id": 9013218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1weSs.png?s=128&g=1", "display_name": "V. V. Kozlov", "link": "https://stackoverflow.com/users/9013218/v-v-kozlov"}, "is_accepted": false, "score": 0, "last_activity_date": 1519029931, "creation_date": 1519029931, "answer_id": 48862281, "question_id": 38225918, "link": "https://stackoverflow.com/questions/38225918/change-name-of-author-on-tracked-changes/48862281#48862281", "title": "Change name of author on tracked changes", "body": "<p>The <strong>Edit Open XML</strong> procedure described in @DirkVollmar's post can be reliably automated in VBA.  It's <strong>a lot of work</strong> compared to just changing the name of the author who made the revision using the Word object model, which naturally does not work at all.  In the end you will have certainly achieved coder status once you get this to work.</p>\n\n<ul>\n<li><p>As suggested by @DirkVollmar, 7-Zip is my preferred compression tool to be used with VBA.  It is free, easy to automate, the .dotx file does not need to be renamed, and you can selectively extract the various XML files without unzipping the whole thing.  See <a href=\"https://www.rondebruin.nl/win/s7/win004.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s7/win004.htm</a> for more info on automating 7-Zip.  Be sure to unzip the files in the standard Microsoft location.</p></li>\n<li><p>The XML files are in <strong>UTF-8</strong>.  UTF-8 is not directly supported by VBA, however works fine when read with ADO.  This will become clear once you have an accented character, Cyrillic name, or Kanji as an author.  See <a href=\"https://www.mrexcel.com/forum/excel-questions/863606-import-text-file-utf-8-a.html\" rel=\"nofollow noreferrer\">https://www.mrexcel.com/forum/excel-questions/863606-import-text-file-utf-8-a.html</a> for more info on reading UTF-8 strings.</p></li>\n<li><p>Once read in, the XML strings can be manipulated with the stock VBA string functions like InStr(), Replace(), Mid(), and so on.  Note that the VBA IDE does not support the <em>display</em> of extended strings, but that does not mean they are not there.  Just don't expect to see Kanji in the immediate window.</p></li>\n<li><p>In the XML strings, look for author= and replace the quoted string immediately after, i.e. something like author=\"Autor\" becomes author=\"Fritz\".</p></li>\n<li><p>To finish up, write the files back to the temporary directory, also using ADO, then place them back into the original .dotx file using 7-Zip automation.  Be sure to delete (the <code>Kill</code> function) temporary files once they have been replaced inside the .dotx file.</p></li>\n</ul>\n\n<p>Be sure to back up your .dotx files during development as you will most assuredly create files which Word will not be able to read and will claim are \"damaged\".  Having said that, once I got this working, I never managed to mangle a .dotx such that Word could not read it.</p>\n"}, {"comments": [{"owner": {"reputation": 77, "user_id": 6869271, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/529ecb6c15cc4d041d8b583227942ffe?s=128&d=identicon&r=PG&f=1", "display_name": "patmin", "link": "https://stackoverflow.com/users/6869271/patmin"}, "edited": false, "score": 0, "creation_date": 1583623056, "post_id": 51283164, "comment_id": 107180765, "body": "IMHO the only sensible answer to the original question. Works well in our environment. Check possible types of <code>Revision.Type</code> for your requirements"}], "tags": [], "owner": {"reputation": 31, "user_id": 10064228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e8595b8e00841ef21547ba15d4c93b8?s=128&d=identicon&r=PG&f=1", "display_name": "AB9000", "link": "https://stackoverflow.com/users/10064228/ab9000"}, "is_accepted": false, "score": 3, "last_activity_date": 1531304937, "creation_date": 1531304937, "answer_id": 51283164, "question_id": 38225918, "link": "https://stackoverflow.com/questions/38225918/change-name-of-author-on-tracked-changes/51283164#51283164", "title": "Change name of author on tracked changes", "body": "<p>NOTE: This is a very old question but this seems to come up A LOT from googling and no-one has provided a solution here or anywhere else, so I am adding mine.</p>\n\n<p>I am a near-complete novice at coding of any sort but a pretty quick/intuitive study and I've been hacking away at this problem as one of my first projects. </p>\n\n<p>I think I have a solution, which conceptually works by taking all revisions with a specific author, storing them in collections, rejecting them in the body of the selection, changing username, then re-implementing the changes as new amendments to the document (thus creating new revisions with the new author).   Here's my code, which I unfortunately can't test as my work PC has authors locked as a security policy.  Please let me know if you see this and it works.</p>\n\n<pre><code>Sub ChangeRevisionAuthor()\n\nDim sCurrentAuthor As String\nDim sOldAuthor As String\nDim sNewAuthor As String\nDim sRevision As String\n\nDim TCStatus As Boolean\n\nDim myRange As Range\nDim revRange As Range\n\nDim myRev As Revision\n\nDim cIns As New Collection\nDim cDel As New Collection\n\nIf Selection.Range.Revisions.Count = 0 Then\n    MsgBox \"No track-changes in your selection!\", _\n      vbCritical + vbOKOnly, \"Cannot perform action\"\n    Exit Sub\nEnd If\n\nsOldAuthor = InputBox(\"Old author name?\", _\n  \"Comments Old Author Name\")\nIf sOldAuthor = \"\" Then End\n\nsNewAuthor = InputBox(\"New author name?\", _\n  \"Comments New Author Name\")\nIf sNewAuthor = \"\" Then End\n\n\nBCStatus = ActiveDocument.TrackRevisions\nsCurrentAuthor = Application.UserName\n\nActiveDocument.TrackRevisions = True\n\nSet myRange = Selection.Range\n\n\nFor Each myRev In myRange.Revisions\n\n    If myRev.Author = sOldAuthor Then\n        If myRev.Type = wdRevisionInsert Then\n        cIns.Add myRev\n        End If\n        If myRev.Type = wdRevisionDelete Then\n        cDel.Add myRev\n        End If\n    End If\n\nNext\n\nApplication.UserName = sNewAuthor\n\nFor Each myRev In cIns\n    Set revRange = myRev.Range\n    myText = revRange.Text\n    myRev.Reject\n    revRange.InsertAfter myText\nNext\n\nFor Each myRev In cDel\n    Set revRange = myRev.Range\n    myRev.Reject\n    revRange.Delete\nNext\n\nApplication.UserName = sCurrentAuthor\nActiveDocument.TrackRevisions = BCStatus\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 290, "user_id": 6387947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68bd3078f0f802c7e8769ecfd63878d8?s=128&d=identicon&r=PG&f=1", "display_name": "scenography", "link": "https://stackoverflow.com/users/6387947/scenography"}, "is_accepted": false, "score": 0, "last_activity_date": 1540483049, "last_edit_date": 1540483049, "creation_date": 1540426046, "answer_id": 52979560, "question_id": 38225918, "link": "https://stackoverflow.com/questions/38225918/change-name-of-author-on-tracked-changes/52979560#52979560", "title": "Change name of author on tracked changes", "body": "<p>Here is a macro to change an author name on tracked changes and comments in a Word document (docx, docm, dotx, or dotm). The macro works for <em>most</em> tracked changes. It doesn't change the author name on updated fields, such as a table of contents.</p>\n\n<p>The macro searches the entire document, not a selection, so it doesn't perfectly answer the question from @h2whoa.</p>\n\n<p>Acknowledgments: @dirk-vollmar suggested editing the xml files that form the Word document. @v-v-kozlov suggested editing with a <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/stream-object-ado\" rel=\"nofollow noreferrer\">Stream object</a> in a macro. <a href=\"http://youpresent.co.uk/remove-customui-from-a-microsoft-powerpoint-excel-or-word-file-using-vba/\" rel=\"nofollow noreferrer\">Jamie Garroch</a> suggested moving files in and out of a zip archive with <a href=\"https://docs.microsoft.com/en-us/windows/desktop/shell/objects\" rel=\"nofollow noreferrer\">Windows Shell</a>.</p>\n\n<pre><code>Sub ChangeTheAuthorOfTrackedChanges()\n'Changes an author name on comments and tracked changes in a Word document.\n'Requires a reference to the Microsoft ActiveX Data Objects 6.1 Library.\n\n    Dim objFile As Object, objShell As Object, objStream As Object\n    Dim strFullName, strTempPath, strFile, strDefault\n    Dim strNames, strOldAuthor, strOldInitials, strNewAuthor, strNewInitials\n    Dim strOldContent, strNewContent, strFind, strReplace, varTime\n    On Error Resume Next\n\n''=&gt; To enter the file name and author name in the code, instead of input boxes,\n''=&gt; uncomment and edit these lines. Comment out the Ask1 and Ask2 sections.\n'    strFullName = _\n'        \"C:\\Users\\Example\\Desktop\\Example - Copy.docx\"\n'    strOldAuthor = \"John X. Doe\"\n'    strOldInitials = \"JXD\"\n'    strNewAuthor = \"Roe, Jane\"\n'    strNewInitials = \"JR\"\n\n    'Asks for a file name.\n    strDefault = \"C:\\Users\\Example\\Desktop\\Example - Copy.docx\"\nAsk1:\n    strFullName = InputBox(Prompt:=\"1. (Recommended) Save a copy of the \" &amp; _\n        \"document before running this macro.\" &amp; vbCrLf &amp; vbCrLf &amp; _\n        \"2. Close the document before running this macro.\" &amp; vbCrLf &amp; vbCrLf &amp; _\n        \"3. Type the file path and name of the document.\", _\n        Title:=\"Word document to change\", _\n        Default:=strDefault)\n    'Warns and quits when a file name wasn't entered.\n    If strFullName = strDefault Or strFullName = \"\" Then\n        MsgBox Prompt:=vbCrLf &amp; \"A file name wasn't entered. The macro quit.\", _\n            Buttons:=vbExclamation\n        Exit Sub\n    End If\n    'Warns and quits when a file is open.\n    Set objFile = Nothing\n    Set objFile = Documents(strFullName)\n    If Not objFile Is Nothing Then\n        MsgBox Prompt:=vbCrLf &amp; \"The document is open.\" &amp; vbCrLf &amp; vbCrLf &amp; _\n            \"Close the document before running the macro.\", _\n            Buttons:=vbExclamation\n        Set objFile = Nothing\n        Exit Sub\n    End If\n    'Warns when a file isn't a Word file.\n    If Right(strFullName, 5) &lt;&gt; \".docx\" And _\n        Right(strFullName, 5) &lt;&gt; \".docm\" And _\n        Right(strFullName, 5) &lt;&gt; \".dotx\" And _\n        Right(strFullName, 5) &lt;&gt; \".dotm\" Then\n        MsgBox Prompt:=\"The file name doesn't have a Word file extension\" &amp; _\n            vbCrLf &amp; \"(docx, docm, dotx, or dotm).\" &amp; vbCrLf &amp; vbCrLf &amp; _\n            \"Check the file path and name.\", _\n            Buttons:=vbExclamation\n            strDefault = strFullName\n        GoTo Ask1:\n    End If\n    'Warns when a file doesn't exist.\n    If Dir(strFullName, vbDirectory) = vbNullString Then\n        MsgBox Prompt:=vbCrLf &amp; \"The document wasn't found.\" &amp; vbCrLf &amp; vbCrLf _\n            &amp; \"Check the file path and name.\", _\n            Buttons:=vbExclamation\n            strDefault = strFullName\n        GoTo Ask1:\n    End If\n\n    'Asks for an author name to change.\n    strDefault = \"old name\\old initials\\new name\\new initials\"\nAsk2:\n    strNames = InputBox(Prompt:=\"Type the name and initials to change,\" &amp; _\n        vbCrLf &amp; \"separated by backslashes.\" &amp; vbCrLf &amp; vbCrLf &amp; _\n        \"For example,\" &amp; vbCrLf &amp; \"John X. Doe\\JXD\\Roe, Jane\\JR\", _\n        Title:=\"Name and initials to change\", _\n        Default:=strDefault)\n    'Warns and quits when an author name wasn't entered.\n    If strNames = strDefault Or strNames = \"\" Then\n        MsgBox Prompt:=vbCrLf &amp; \"Names weren't entered. The macro quit.\", _\n            Buttons:=vbExclamation\n        Exit Sub\n    End If\n    'Divides the entered text.\n    strDefault = strNames\n    strOldAuthor = Left(strNames, InStr(strNames, \"\\\") - 1)\n        strNames = Mid(strNames, InStr(strNames, \"\\\") + 1)\n    strOldInitials = Left(strNames, InStr(strNames, \"\\\") - 1)\n        strNames = Mid(strNames, InStr(strNames, \"\\\") + 1)\n    strNewAuthor = Left(strNames, InStr(strNames, \"\\\") - 1)\n    strNewInitials = Mid(strNames, InStr(strNames, \"\\\") + 1)\n    'Warns when information is missing or too many backslashes are entered.\n    If strOldAuthor = \"\" Or strOldInitials = \"\" Or strNewAuthor = \"\" Or _\n        strNewInitials = \"\" Or InStr(strNewInitials, \"\\\") &lt;&gt; 0 Then\n        MsgBox Prompt:=vbCrLf &amp; \"Author names and initials weren't readable.\" _\n            &amp; vbCrLf &amp; vbCrLf &amp; \"Check the author names, initials, and \" &amp; _\n            \"separator (\\).\", _\n            Buttons:=vbExclamation\n        GoTo Ask2:\n        Exit Sub\n    End If\n\n    'Defines a temporary folder and expands some strings.\n    strTempPath = Left(strFullName, InStrRev(strFullName, \"\\\")) &amp; Left(Rnd(), 5)\n    strOldAuthor = \"author=\"\"\" &amp; strOldAuthor &amp; \"\"\"\"\n    strOldInitials = \"initials=\"\"\" &amp; strOldInitials &amp; \"\"\"\"\n    strNewAuthor = \"author=\"\"\" &amp; strNewAuthor &amp; \"\"\"\"\n    strNewInitials = \"initials=\"\"\" &amp; strNewInitials &amp; \"\"\"\"\n\n    'Opens the shell and stream objects. Sets some properties.\n    Set objShell = CreateObject(\"Shell.Application\")\n    Set objStream = New ADODB.Stream\n    objStream.Charset = \"utf-8\"\n    objStream.Type = adTypeText\n\n    'Renames the Word document as a zip file and moves the folder \"\\word\".\n    Name strFullName As (strFullName &amp; \".zip\")\n    MkDir strTempPath\n    objShell.NameSpace(strTempPath).MoveHere (strFullName &amp; \".zip\\word\")\n\n    strFile = \"First time\"\n    Do\n        'Gets the next file name in the folder \"\\word\" using the Dir function.\n        If strFile = \"First time\" Then\n            strFile = Dir(strTempPath &amp; \"\\word\\\")\n        Else\n            strFile = Dir\n        End If\n\n        If strFile &lt;&gt; \"\" Then\n            'Opens a file and copies its content.\n            With objStream\n                .Open\n                .LoadFromFile (strTempPath &amp; \"\\word\\\" &amp; strFile)\n                strOldContent = .ReadText\n            End With\n                strNewContent = strOldContent\n\n            'Replaces author and initials.\n            strFind = strOldAuthor\n            strReplace = strNewAuthor\n            strNewContent = Replace(strNewContent, strFind, strReplace)\n            strFind = strOldInitials\n            strReplace = strNewInitials\n            strNewContent = Replace(strNewContent, strFind, strReplace)\n\n            'Saves the new content, if the content changed.\n            If strNewContent &lt;&gt; strOldContent Then\n                With objStream\n                    .Position = 0\n                    .WriteText strNewContent\n                    .SetEOS\n                    .SaveToFile (strTempPath &amp; \"\\word\\\" &amp; strFile), _\n                        adSaveCreateOverWrite\n                    .Close\n                End With\n            Else\n                objStream.Close\n            End If\n        End If\n\n    'Stops looping when the Dir function doesn't return a file name.\n    Loop While strFile &lt;&gt; \"\"\n\n    'Moves the folder \"\\word\" into the zip file.\n    objShell.NameSpace(strFullName &amp; \".zip\").MoveHere (strTempPath &amp; \"\\word\")\n\n    'Delays for a few seconds, then renames the zip file as a Word file.\n    varTime = Time + 0.0001\n    Do\n        DoEvents\n    Loop Until Time &gt;= varTime\n    Name (strFullName &amp; \".zip\") As strFullName\n    RmDir strTempPath\n\n    MsgBox Prompt:=\"The macro searched and replaced.\", Buttons:=vbInformation\n    Set objShell = Nothing\n    Set objStream = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11388581, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hYVDCQWf4x0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re-4SlvNlTIxvTGnE4uA7igAMopdg/mo/photo.jpg?sz=128", "display_name": "CPE", "link": "https://stackoverflow.com/users/11388581/cpe"}, "is_accepted": false, "score": 0, "last_activity_date": 1566588747, "creation_date": 1566588747, "answer_id": 57632050, "question_id": 38225918, "link": "https://stackoverflow.com/questions/38225918/change-name-of-author-on-tracked-changes/57632050#57632050", "title": "Change name of author on tracked changes", "body": "<p>Find the replace reviewer initial only macro!!!</p>\n\n<p>Sub ChangeCommentAuthor()</p>\n\n<pre><code>Dim J As Integer\n\nDim rNameFind As String\nDim rNameRePlace As String\n\n\nrNameFind = InputBox(\"Enter the Reviwer Name to Find\", vbOK)\nrNameRePlace = InputBox(\"Enter the Reviwer name  to Replace\", vbOK)\n\nIf (rNameFind = \"\") Then\nMsgBox \"Input Reviwer Name to find is empty\"\nExit Sub\nEnd If\n\nIf (rNameRePlace = \"\") Then\nMsgBox \"Input Reviwer Name to replace is empty\"\nExit Sub\nEnd If\n\nFor J = 1 To 3\n\nFor i = 1 To ActiveDocument.Comments.Count\n\nDim objComment As Comment: Dim oInitial As String\nIf InStr(1, ActiveDocument.Comments(i).Initial, \"\") &gt; 0 Then\noInitial = Replace(ActiveDocument.Comments(i).Initial, rNameFind, rNameRePlace)\nSet objComment = ActiveDocument.Comments(i)\n    objComment.Initial = oInitial\n\nEnd If\n\nNext i\n\nNext J\n</code></pre>\n\n<p>End Sub</p>\n"}, {"comments": [{"owner": {"reputation": 2071, "user_id": 7478530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cGr5i.png?s=128&g=1", "display_name": "Dragonthoughts", "link": "https://stackoverflow.com/users/7478530/dragonthoughts"}, "edited": false, "score": 0, "creation_date": 1569246009, "post_id": 58063395, "comment_id": 102523849, "body": "That looks like part of the accepted answer from July 2016. Does this add anything to that answer?"}], "tags": [], "owner": {"reputation": 1, "user_id": 1912526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20c1c5af19d0e5af0d6c68e4ac905bd6?s=128&d=identicon&r=PG", "display_name": "user1912526", "link": "https://stackoverflow.com/users/1912526/user1912526"}, "is_accepted": false, "score": 0, "last_activity_date": 1569244730, "creation_date": 1569244730, "answer_id": 58063395, "question_id": 38225918, "link": "https://stackoverflow.com/questions/38225918/change-name-of-author-on-tracked-changes/58063395#58063395", "title": "Change name of author on tracked changes", "body": "<p>Simplest method</p>\n\n<ol>\n<li>Save your document as xml</li>\n<li>Open with Notepad++</li>\n<li>Replace old text (Author Name) with New.</li>\n<li>Save xml</li>\n<li>Open xml with Word and Save in whichever format you prefer (.docx)</li>\n</ol>\n"}], "owner": {"reputation": 13, "user_id": 6556459, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qsHZYKkqEgg/AAAAAAAAAAI/AAAAAAAAADA/50I4qrfd3Y0/photo.jpg?sz=128", "display_name": "h2whoa", "link": "https://stackoverflow.com/users/6556459/h2whoa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11106, "favorite_count": 3, "accepted_answer_id": 38241050, "answer_count": 6, "score": 0, "last_activity_date": 1593756481, "creation_date": 1467813620, "last_edit_date": 1593756481, "question_id": 38225918, "link": "https://stackoverflow.com/questions/38225918/change-name-of-author-on-tracked-changes", "title": "Change name of author on tracked changes", "body": "<p>I'm trying to change the author name on tracked changes in a selection in MS Word.</p>\n\n<p>Here's the code I have so far:</p>\n\n<pre><code>Sub ChangeTracksBySingleAuthor()\n\n    Dim J As Integer\n    Dim sAuthorname As String\n    Dim sOrigAuthorname As String\n\n    If Selection.Range.Revisions.Count = 0 Then\n        MsgBox \"No changes in your selection!\", vbCritical + vbOKOnly, \"Cannot perform action\"\n        Exit Sub\n    End If\n\n    sOrigAuthorname = InputBox(\"Author name to change\", \"Changes Author Name\")        \n    If sOrigAuthorname = \"\" Then End\n\n    sAuthorname = InputBox(\"New author name\", \"Changes Author Name\")        \n    If sAuthorname = \"\" Then End\n\n    With ActiveDocument\n        For J = 1 To .Revisions.Count\n            If .Revisions(J).Author = sOrigAuthorname Then                \n                .Revisions(J).Author = sAuthorname\n            End If\n        Next J\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["string", "excel", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1467813204, "post_id": 38225760, "comment_id": 63873354, "body": "What have you tried?  Are the strings in one cell or in two cells? (Date in its own cell?)"}, {"owner": {"reputation": 43, "user_id": 6093164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0684ed75459229f6a42eecb8894d6209?s=128&d=identicon&r=PG&f=1", "display_name": "Fab Pass", "link": "https://stackoverflow.com/users/6093164/fab-pass"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1467815766, "post_id": 38225760, "comment_id": 63875341, "body": "Hi Ron, here you can see the excel example <a href=\"http://i.stack.imgur.com/y3ePE.jpg\" rel=\"nofollow noreferrer\">i.stack.imgur.com/y3ePE.jpg</a>  you can see in the column A the problem and in the column B the desired result.  I need always the date of the last &quot;On Leave&quot;."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1467816155, "post_id": 38225760, "comment_id": 63875622, "body": "I would suggest a VBA solution, given the complexity of your data. This is not a free code-writing service, but we can help you with code you are trying to develop. Please read the HELP topics for <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I Ask a Good Question</a>, and also <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>"}], "answers": [{"tags": [], "owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "is_accepted": false, "score": 0, "last_activity_date": 1467813553, "creation_date": 1467813553, "answer_id": 38225885, "question_id": 38225760, "link": "https://stackoverflow.com/questions/38225760/strip-parts-of-string-in-excel/38225885#38225885", "title": "Strip parts of string in excel", "body": "<p>If you're allowed to have another column could you not just do something like this if I assume your text string is in column A:</p>\n\n<pre><code>=IF(LEFT(A1,8)=\"On Leave\",DATEVALUE(MID(A1,11,10)),1)\n</code></pre>\n\n<p>Then just find the max of that.</p>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1467813630, "creation_date": 1467813630, "answer_id": 38225924, "question_id": 38225760, "link": "https://stackoverflow.com/questions/38225760/strip-parts-of-string-in-excel/38225924#38225924", "title": "Strip parts of string in excel", "body": "<p>just using data in a1:a9 I used the following array formula to give the last row number</p>\n\n<pre><code>=MAX(IF(NOT(ISERROR(SEARCH(\"on leave\",$A$1:$A$9))),ROW($A$1:$A$9)))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "is_accepted": false, "score": 0, "last_activity_date": 1467814291, "creation_date": 1467814291, "answer_id": 38226183, "question_id": 38225760, "link": "https://stackoverflow.com/questions/38225760/strip-parts-of-string-in-excel/38226183#38226183", "title": "Strip parts of string in excel", "body": "<p>Here's another one (assuming the pattern doesn't vary)</p>\n\n<pre><code>=MAX(IF(LEFT($A$2:$A$10,8)=\"on leave\",DATEVALUE(RIGHT($A$2:$A$10,10))))\n</code></pre>\n\n<p>entered as an array formula.</p>\n"}, {"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": false, "score": 0, "last_activity_date": 1467823179, "last_edit_date": 1467823179, "creation_date": 1467822875, "answer_id": 38229165, "question_id": 38225760, "link": "https://stackoverflow.com/questions/38225760/strip-parts-of-string-in-excel/38229165#38229165", "title": "Strip parts of string in excel", "body": "<p>Try this:</p>\n\n<pre><code>=MID(A1,FIND(\"@\",SUBSTITUTE(A1,\"On Leave\",\"@\",(LEN(A1)-LEN(SUBSTITUTE(A1,\"On Leave\",\"\")))/LEN(\"On Leave\")))+LEN(\"On Leave : \"),10)\n</code></pre>\n\n<p>If you want to first check for the string \"On Leave\" in cell use:</p>\n\n<pre><code>=IF(LEFT(A1,8)=\"On Leave\",MID(A1,FIND(\"@\",SUBSTITUTE(A1,\"On Leave\",\"@\",(LEN(A1)-LEN(SUBSTITUTE(A1,\"On Leave\",\"\")))/LEN(\"On Leave\")))+LEN(\"On Leave : \"),10),\"\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/AXWlp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AXWlp.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 43, "user_id": 6093164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0684ed75459229f6a42eecb8894d6209?s=128&d=identicon&r=PG&f=1", "display_name": "Fab Pass", "link": "https://stackoverflow.com/users/6093164/fab-pass"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1467823179, "creation_date": 1467813107, "question_id": 38225760, "link": "https://stackoverflow.com/questions/38225760/strip-parts-of-string-in-excel", "title": "Strip parts of string in excel", "body": "<p>I have a a column in excel with the follow example bellow in each cell:</p>\n\n<p>\"On Leave: 14-08-2011</p>\n\n<p>On Leave: 16-03-2012</p>\n\n<p>Return From Leave: 01-01-2013</p>\n\n<p>Return From Leave: 09-03-2012\"</p>\n\n<p>Sometimes I have more or less information. I just need to find one way (formula or vba) to find the last \"On Leave:\" string and copy date to another column.</p>\n\n<p>In this case the result would be \"16-03-2012\"</p>\n\n<p>The goal here is to find the greatest date on leave.</p>\n\n<p>Can someone please help me?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1467813080, "post_id": 38225603, "comment_id": 63873264, "body": "Of the three possible solutions in the other question, which one(s) did you actually try to implement? Or you could try set up an event handler for incoming mail to process &quot;out of office&quot; replies. In either case, you&#39;re going to need to use some sort of RegEx to identify the additional FWD recipients..."}, {"owner": {"reputation": 77, "user_id": 6198644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3855af64bfb099d294f8795dbda9b73d?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/6198644/alex"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1467813365, "post_id": 38225603, "comment_id": 63873482, "body": "I started with the first one. After some Google-Fu I came across this: <a href=\"http://www.dimastr.com/redemption/RDOOutOfOfficeAssistant.htm\" rel=\"nofollow noreferrer\">dimastr.com/redemption/RDOOutOfOfficeAssistant.htm</a>  It was more along the lines of setting one. I couldn&#39;t find any information about which reference I should be using."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1467813762, "post_id": 38225603, "comment_id": 63873769, "body": "Doesn&#39;t look like you&#39;re actually using the Redemption in the approach above, but if you do, then perhaps <a href=\"http://stackoverflow.com/users/332059/dmitry-streblechenko\">Dmitry</a> can assist. I&#39;m not familiar with that, but it looks like you should be able to do this per his comments on the previous question."}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 6198644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3855af64bfb099d294f8795dbda9b73d?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/6198644/alex"}, "edited": false, "score": 0, "creation_date": 1467837713, "post_id": 38232321, "comment_id": 63888439, "body": "I&#39;m able to get the information from an existing email, I&#39;m just trying to get it to pull this information when it&#39;s available in a draft then have it pop up in an InputBox to prompt me for the management assistant&#39;s email address. I have it set up to go through the inbox and find any automatic replies then pull the name of the management assistant, I&#39;d just like to avoid all the work after the fact if I&#39;m able to get it when the email is being composed.   <a href=\"http://i.imgur.com/w5qqkUl.png\" rel=\"nofollow noreferrer\">i.imgur.com/w5qqkUl.png</a>"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 77, "user_id": 6198644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3855af64bfb099d294f8795dbda9b73d?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/6198644/alex"}, "edited": false, "score": 0, "creation_date": 1467842436, "post_id": 38232321, "comment_id": 63890625, "body": "I am an Outlook user but have no access to Exchange Server so I cannot experiment with it.  Your referenced answer implies this information is not available from VBA so you will have to try one of the alternatives listed."}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 1, "last_activity_date": 1467833615, "creation_date": 1467833615, "answer_id": 38232321, "question_id": 38225603, "link": "https://stackoverflow.com/questions/38225603/can-i-check-if-a-recipient-has-an-automatic-reply-before-i-send-an-email/38232321#38232321", "title": "Can I check if a recipient has an automatic reply before I send an email?", "body": "<p>This is not a proper answer but an attempt to get you started.</p>\n\n<p>Your code suggests your knowledge of Outlook VBA is limited. If this is true, I doubt that any of the approaches in \u201ca similar question\u201d will be appropriate. Are you familiar with Visual Studio, C++, Delphi or Redemption?  Even if you managed to access PR_OOF_STATE, you would not have the alternative email address.</p>\n\n<p>I would start by attempting to extract the email address from the out-of-office reply.  Looking for \u201c@\u201d and extracting the text back to and forward to the next space <strong>might</strong> be enough.</p>\n\n<p>Copy the code below to an Outlook VBA module.  Select one of the out-of-office replies and run macro DemoExplorer.  The objective of this macro is to show you what the text and Html bodies of the email look like.  Try this macro on other replies.  Are the bodies consistent?  Can you see how to extract the alternative email address?</p>\n\n<pre><code>Public Sub DemoExplorer()\n\n  Dim Exp As Outlook.Explorer\n  Dim ItemCrnt As MailItem\n  Dim NumSelected As Long\n\n  Set Exp = Outlook.Application.ActiveExplorer\n\n  NumSelected = Exp.Selection.Count\n\n  If NumSelected = 0 Then\n    Debug.Print \"No emails selected\"\n  Else\n    For Each ItemCrnt In Exp.Selection\n      With ItemCrnt\n        Debug.Print \"From \" &amp; .SenderName &amp; \" Subject \" &amp; .Subject\n        Debug.Print \"Text \" &amp; Replace(Replace(Replace(.Body, vbLf, \"{lf}\"), vbCr, \"{cr}\"), vbTab, \"{tb}\")\n        Debug.Print \"Html \" &amp; Replace(Replace(Replace(.HTMLBody, vbLf, \"{lf}\"), vbCr, \"{cr}\"), vbTab, \"{tb}\")\n      End With\n    Next\n  End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1467835953, "last_edit_date": 1495541232, "creation_date": 1467835953, "answer_id": 38232922, "question_id": 38225603, "link": "https://stackoverflow.com/questions/38225603/can-i-check-if-a-recipient-has-an-automatic-reply-before-i-send-an-email/38232922#38232922", "title": "Can I check if a recipient has an automatic reply before I send an email?", "body": "<p>The answer to the similar question you found (<a href=\"https://stackoverflow.com/questions/24678447/remove-recipients-from-outlook-email-if-automatic-reply-is-activated\">Remove recipients from Outlook email if automatic reply is activated</a>) still stands. What were you having problem with?</p>\n\n<p>The only additional possibility (and this is what Outlook uses when it displays an OOF banner for a recipient you are about to send to) is to use EWS and the GetMailTips operation (see <a href=\"https://msdn.microsoft.com/en-us/library/office/dd877060(v=exchg.150).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/dd877060(v=exchg.150).aspx</a>).</p>\n"}], "owner": {"reputation": 77, "user_id": 6198644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3855af64bfb099d294f8795dbda9b73d?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/6198644/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5954, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1592897231, "creation_date": 1467812696, "last_edit_date": 1592897231, "question_id": 38225603, "link": "https://stackoverflow.com/questions/38225603/can-i-check-if-a-recipient-has-an-automatic-reply-before-i-send-an-email", "title": "Can I check if a recipient has an automatic reply before I send an email?", "body": "<p>I have a macro set up that will automatically send out emails to dozens of managers. Sometimes they're away and I have to check the away message and manually forward it to the person covering for them. </p>\n\n<p>I try to find a solution before I seek help so have mercy on me! I found <a href=\"https://stackoverflow.com/questions/24678447/remove-recipients-from-outlook-email-if-automatic-reply-is-activated\">a similar question</a> but it wasn't a lot of help, I couldn't find a lot of info on extracting an auto response from a recipient in a draft. </p>\n\n<p>So far this is what I've got: </p>\n\n<pre><code>Sub CheckAutoReply()\n\nDim OL As Outlook.Application\nDim EM As Outlook.MailItem\nDim R As Outlook.Recipient\n\nSet OL = New Outlook.Application\nSet EM = CreateItem(olMailItem)\n\nWith EM\n    .display\n    .To = \"John.Doe@Stackoverflow.com\" 'This is a recipient I know has an autoresponse. Fictitious of course.\nEnd With\n\nSet R = EM.Recipients(1) 'on hover it pops up with \"EM.Recipients(1) = \"John.Doe@Stackoverflow.com\"\"\n\nDebug.Print R.Name 'this returns \"John.Doe@Stackoverflow.com\"\nDebug.Print R.AutoResponse 'this returns nothing\n\nSet OL = Nothing\nSet EM = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 2, "last_activity_date": 1467814622, "last_edit_date": 1467814622, "creation_date": 1467813988, "answer_id": 38226067, "question_id": 38225595, "link": "https://stackoverflow.com/questions/38225595/a-way-to-verify-specific-filter-contents/38226067#38226067", "title": "A way to verify specific filter contents", "body": "<p>The sample code below will check for the criteria selections given the first cell of the range containing the filter, and the index of the column to check.</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n    'first argument is first cell of headers being filtered\n    'second argument is column to check for filter criteria\n    Debug.Print GetCriteria(Sheet1.Range(\"A1\"), 3)\nEnd Sub\n\nFunction GetCriteria(rng As Range, lngFilterIndex As Long) As String\n\n    Dim strCriteria As String\n    Dim objFilter As AutoFilter\n    Dim lngCriteriaCount As Long\n    Dim lngCounter As Long\n\n    Set objFilter = rng.Parent.AutoFilter\n\n    ' no autofilter\n    If objFilter Is Nothing Then\n        GetCriteria = \"\"\n        Exit Function\n    End If\n\n    ' autofilter but no selection\n    If Not objFilter.Filters(lngFilterIndex).On Then\n        GetCriteria = \"\"\n        Exit Function\n    End If\n\n    ' iterate criteria\n    strCriteria = \"\"\n    lngCriteriaCount = objFilter.Filters(lngFilterIndex).Count\n    If lngCriteriaCount = 1 Then\n        strCriteria = objFilter.Filters(lngFilterIndex).Criteria1\n    Else\n        For lngCounter = 1 To objFilter.Filters(lngFilterIndex).Count\n            strCriteria = strCriteria &amp; objFilter.Filters(lngFilterIndex).Criteria1(lngCounter)\n        Next lngCounter\n    End If\n\n    GetCriteria = strCriteria\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 627, "user_id": 3075813, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6939855d9ee7a37afc7f8517d5db2a02?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Erickson", "link": "https://stackoverflow.com/users/3075813/joseph-erickson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 38226067, "answer_count": 1, "score": 1, "last_activity_date": 1467814622, "creation_date": 1467812671, "last_edit_date": 1531164843, "question_id": 38225595, "link": "https://stackoverflow.com/questions/38225595/a-way-to-verify-specific-filter-contents", "title": "A way to verify specific filter contents", "body": "<p>I have a spreadsheet that uses a filter on a few columns of data. One of these columns has 10 different possible values. I want to verify that there is a specific filter in place--that is, not just that <code>autofiltermode = true</code>--but to actually check what the value of that filter is. Is there a way to do this in vba?</p>\n\n<p>For example, if I might want to make sure that the user is only looking at <code>customers</code>, 1 of the 10 values in my field. So I'm hoping I can say something like <code>if filtervalue = \"customers\" then</code>. </p>\n\n<p>Additionally, I don't want to verify cell data, I'm asking if there's a way to verify a filter. </p>\n"}, {"tags": ["arrays", "oracle", "vba", "excel"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1467812995, "post_id": 38225456, "comment_id": 63873208, "body": "You can&#39;t pass a variant array as an argument for a query. You would need it to be a string with the ids separated by commas."}, {"owner": {"reputation": 3, "user_id": 2409444, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/scd1K.jpg?s=128&g=1", "display_name": "mhammonde", "link": "https://stackoverflow.com/users/2409444/mhammonde"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1467882190, "post_id": 38225456, "comment_id": 63903814, "body": "Thank you Kyle, your response along with Thomas&#39; below has helped me resolve my issue. Until you explained I didn&#39;t realise that variant arrays don&#39;t include comma delimiters."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 2409444, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/scd1K.jpg?s=128&g=1", "display_name": "mhammonde", "link": "https://stackoverflow.com/users/2409444/mhammonde"}, "edited": false, "score": 0, "creation_date": 1467882103, "post_id": 38225675, "comment_id": 63903753, "body": "This worked a treat, thank you Thomas. I did wonder if I was attempting to create an array incorrectly as it crossed my mind there might not be a delimiter between each ID, but my lack of VBA knowledge hindered me somewhat."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 3, "user_id": 2409444, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/scd1K.jpg?s=128&g=1", "display_name": "mhammonde", "link": "https://stackoverflow.com/users/2409444/mhammonde"}, "edited": false, "score": 0, "creation_date": 1467882277, "post_id": 38225675, "comment_id": 63903869, "body": "I often get so caught up in trying to do things the right way that I end up missing the obvious simple approach."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1467812885, "creation_date": 1467812885, "answer_id": 38225675, "question_id": 38225456, "link": "https://stackoverflow.com/questions/38225456/excel-vba-run-sql-query-using-workfsheet-cell-range/38225675#38225675", "title": "Excel VBA - Run SQL Query using Workfsheet Cell Range", "body": "<p>The ID's need to be comma delimited</p>\n\n<blockquote>\n  <p>InputIDs = getIDs( Sheets(\"Input\").Range(\"A2:A10\") )</p>\n</blockquote>\n\n<pre><code>Function getIDs(rng As Range)\n    Dim c As Range\n    Dim s As String\n    For Each c In rng\n        s = s &amp; c.Value &amp; \",\"\n    Next\n    getIDs = Left(s, Len(s) - 1)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 2409444, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/scd1K.jpg?s=128&g=1", "display_name": "mhammonde", "link": "https://stackoverflow.com/users/2409444/mhammonde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1689, "favorite_count": 0, "accepted_answer_id": 38225675, "answer_count": 1, "score": 0, "last_activity_date": 1467812885, "creation_date": 1467812333, "question_id": 38225456, "link": "https://stackoverflow.com/questions/38225456/excel-vba-run-sql-query-using-workfsheet-cell-range", "title": "Excel VBA - Run SQL Query using Workfsheet Cell Range", "body": "<p>I am creating a simple spreadsheet which takes an array of IDs from worksheet \"input\", queries an Oracle database asking for only the records which match the IDs in the array and outputs the results to worksheet \"output\".</p>\n\n<p>So far, my VBA will work if my array only contains a single ID (by specifying a single cell range), and everything completes with the desired output from the Oracle database appearing in worksheet \"output\". Good times.</p>\n\n<p>The problem I am having now is that I want to specify a range of IDs (anything up to around 5000) in worksheet \"input\" to include in my array and pass that array to the Oracle database to return data for each ID it finds (I am not expecting all IDs to exist). Whenever I try this I seem to get \"Error 13 Type Mismatch\" errors... Bad times.</p>\n\n<p>My VBA code is:</p>\n\n<pre><code>Dim OracleConnection As ADODB.Connection\nDim MosaicRecordSet As ADODB.RecordSet\nDim SQLQuery As String\nDim DBConnect As String\nDim count As String\nDim strbody As String\nDim Exclude As String\nDim i As Integer\nDim Rec As RecordSet\nDim InputIDs As Variant\n\nSet OracleConnection = New ADODB.Connection\nDBConnect = \"Provider=msdaora;Data Source=MOSREP;User ID=***;Password=***;\"\nOracleConnection.Open DBConnect\n\n' Clear Output Sheet Down\nSheets(\"Output\").Select\nRange(\"A2:F10000\").Clear\n\n' Set Input Range\nSheets(\"Input\").Columns(\"A:A\").NumberFormat = \"0\"\nInputIDs = Sheets(\"Input\").Range(\"A2:A10\").Value\n\n' SQL Query\nSQLQuery = \"select DMP.PERSON_ID, DMP.FULL_NAME, DMP.DATE_OF_BIRTH, DMA.ADDRESS, DMA.ADDRESS_TYPE, DMA.IS_DISPLAY_ADDRESS \" &amp; _\n\"from DM_PERSONS DMP \" &amp; _\n\"join DM_ADDRESSES DMA \" &amp; _\n\"on DMA.PERSON_ID=DMP.PERSON_ID \" &amp; _\n\"where DMP.PERSON_ID in (\" &amp; InputIDs &amp; \")\"\n\nSet MosaicRecordSet = OracleConnection.Execute(SQLQuery)\n\nSheets(\"Output\").Range(\"A2\").CopyFromRecordset MosaicRecordSet\n\n' Change DOB Format\nSheets(\"Output\").Columns(\"C:C\").NumberFormat = \"dd/mm/yyyy\"\n' Set Left Alignment\nSheets(\"Output\").Columns(\"A:Z\").HorizontalAlignment = xlHAlignLeft\n\nRange(\"A1\").Select\n\nOracleConnection.Close\nSet MosaicRecordSet = Nothing\nSet OracleConnection = Nothing\n\nActiveWorkbook.Save\n</code></pre>\n\n<p>Can anyone shed light on what I am missing? I have attempted to resolve the Type Mismatch issue by setting the 'numberformat' on the column in worksheet \"input\" to \"0\" but that didn't help. I also thought that I might have to have a loop to iterate through each record, but I haven't got to that stage yet because of this Type Mismatch thing...</p>\n\n<p>Thank you everyone for your help in advance!</p>\n\n<p>Regards\nMatt</p>\n"}, {"tags": ["excel", "vba", "spreadsheet"], "comments": [{"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1467812137, "post_id": 38225145, "comment_id": 63872582, "body": "Maybe my reading skills aren&#39;t good enough, but I still dont get what <code>Aa</code> and <code>Bb</code> etc. is. Can you give a simple example?"}, {"owner": {"reputation": 2169, "user_id": 4564505, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/qRYlQ.jpg?s=128&g=1", "display_name": "pavlos163", "link": "https://stackoverflow.com/users/4564505/pavlos163"}, "reply_to_user": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1467812362, "post_id": 38225145, "comment_id": 63872743, "body": "Sorry Tom, this is surely my fault. Aa is the sum of everything which is the row a and under the type A. So in this example it would be something like 1+2+3 = 6"}, {"owner": {"reputation": 2169, "user_id": 4564505, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/qRYlQ.jpg?s=128&g=1", "display_name": "pavlos163", "link": "https://stackoverflow.com/users/4564505/pavlos163"}, "reply_to_user": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1467812420, "post_id": 38225145, "comment_id": 63872791, "body": "Consequently Ab would be 5 etc."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1467831420, "post_id": 38225145, "comment_id": 63885059, "body": "Suggest to use <code>VBA Event</code> combined with <code>Defined Names</code> and <code>PivotTable</code> this will produce a solid and dynamic solution."}], "answers": [{"comments": [{"owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "edited": false, "score": 0, "creation_date": 1467812427, "post_id": 38225469, "comment_id": 63872796, "body": "Then just do Debug.Print countletter(&quot;A&quot;) to get it for A (i.e. repeat same for other letters)."}], "tags": [], "owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "is_accepted": false, "score": 0, "last_activity_date": 1467812352, "creation_date": 1467812352, "answer_id": 38225469, "question_id": 38225145, "link": "https://stackoverflow.com/questions/38225145/excel-for-loop-to-get-value-from-another-row/38225469#38225469", "title": "Excel for loop to get value from another row", "body": "<p>Are you looking for something like:</p>\n\n<pre><code>Function countletter(strLetter As String) As Double\nDim x As Double, y As Double, xMax As Double, yMax As Double\nxMax = Range(\"A1\").CurrentRegion.Columns.Count\nyMax = Range(\"A1\").CurrentRegion.Rows.Count\n    For x = 1 To xMax\n        For y = 1 To yMax\n            If Cells(y, x).Value = strLetter Then\n                countletter = countletter + 1\n            End If\n        Next\n    Next\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2169, "user_id": 4564505, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/qRYlQ.jpg?s=128&g=1", "display_name": "pavlos163", "link": "https://stackoverflow.com/users/4564505/pavlos163"}, "edited": false, "score": 0, "creation_date": 1467815431, "post_id": 38225864, "comment_id": 63875106, "body": "Thanks Scott. What was not clear from my explanation was that the types in the example I showed may be A, B, C, but I potentially it could be anything starting with the type letter. So I want to check if the type begins with A and not actually is A. Is that possible? Thanks."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2169, "user_id": 4564505, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/qRYlQ.jpg?s=128&g=1", "display_name": "pavlos163", "link": "https://stackoverflow.com/users/4564505/pavlos163"}, "edited": false, "score": 0, "creation_date": 1467815951, "post_id": 38225864, "comment_id": 63875469, "body": "@pk1914 see edit, you may have to refresh the screen"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1467815926, "last_edit_date": 1467815926, "creation_date": 1467813486, "answer_id": 38225864, "question_id": 38225145, "link": "https://stackoverflow.com/questions/38225145/excel-for-loop-to-get-value-from-another-row/38225864#38225864", "title": "Excel for loop to get value from another row", "body": "<p>Just an FYI, this can be done using the SUMPRODUCT formula:</p>\n\n<pre><code>=SUMPRODUCT(($B$1:$J$1=D$9)*($A$2:$A$4=$C10)*$B$2:$J$4)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/zsEb4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zsEb4.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><strong>EDIT</strong></p>\n\n<p>To compare the first letter then use this formula:</p>\n\n<pre><code>=SUMPRODUCT((LEFT($B$1:$J$1,1)=D$9)*($A$2:$A$4=$C10)*$B$2:$J$4)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/0fFh9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0fFh9.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 2169, "user_id": 4564505, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/qRYlQ.jpg?s=128&g=1", "display_name": "pavlos163", "link": "https://stackoverflow.com/users/4564505/pavlos163"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 1, "accepted_answer_id": 38225864, "answer_count": 2, "score": 0, "last_activity_date": 1467815926, "creation_date": 1467811325, "last_edit_date": 1467812505, "question_id": 38225145, "link": "https://stackoverflow.com/questions/38225145/excel-for-loop-to-get-value-from-another-row", "title": "Excel for loop to get value from another row", "body": "<p>I have an spreadsheet that contains various data. It looks like this:</p>\n\n<pre><code>   A A A B B C C C C\n\na  1 2 3 2 1 4 2 3 2\n\nb  0 2 3 3 0 1 2 3 0\n\nc  6 6 3 0 2 1 0 4 0\n</code></pre>\n\n<p>etc.</p>\n\n<p>What I want is to add all the Aa's and come up with a Aa total, all the Bb's and come up with a Bb total, all the Ab's etc.</p>\n\n<p>What I want to do is, for every column, check if it is A, B or C. I want to do that because the data may change I might end up with four columns for A, two for B, etc. I know however that a, b and c will stay where they are.</p>\n\n<p>I also don't know the order of A, B and C. There could be two A's followed by two C's and then one B.</p>\n\n<p>My final result will be a table containing all the totals:</p>\n\n<p>Aa Ab Ac</p>\n\n<p>Ba Bb Bc</p>\n\n<p>Ca Cb Cc</p>\n\n<p>Where in the previous example would mean that Aa = 1 + 2 + 3 = 6, Ab = 5, etc.</p>\n\n<p>Something like that.</p>\n\n<p>I think the way to go is for 1-1 (the total of Aa's) is to go through every column in the first row. Check if it is an A. If it is, then get the value of the same column but second row. Add it to the total. When gone through all the columns, show up the total in 1-1.</p>\n\n<p>What I have so far (for A):</p>\n\n<pre><code>    Sub getA()\n    Dim x As Integer\n    Dim total As Integer\n    'cols = Find number of columns with data in them\n    For x = 1 To cols\n        'cell = cell in Ax\n        If InStr(1, cellvalue, \"a\") = 1 Then\n            'val = value from row 5 in same column\n            total = total + Val\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>But I don't really know how to proceed with the commented lines.</p>\n\n<p>Finally, another thing I would like to know is how will these values be presented in their respective cells without any extra event being carried (button for example). They should just appear in their cells from the moment someone opens the spreadsheet.</p>\n\n<p>Any help is greatly appreciated.\nThanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 1, "creation_date": 1467811580, "post_id": 38224975, "comment_id": 63872273, "body": "Have you tried recording a macro covering a couple of iterations?"}], "answers": [{"comments": [{"owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "edited": false, "score": 0, "creation_date": 1467819838, "post_id": 38225158, "comment_id": 63878164, "body": "I&#39;ll have to comment on this as I don&#39;t have enough reputation to comment on your answer but in terms of what you have there, you could change the string after <code>Filename:=</code> to be dynamic, i.e. &quot;C:\\Users\\username\\Folder\\Folder\\Documents\\Folder\\Folder\\Fil&zwnj;&#8203;ename&quot; &amp; i &amp; &quot;.pdf&quot; and increase i for each file."}], "tags": [], "owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "is_accepted": false, "score": 1, "last_activity_date": 1467811360, "last_edit_date": 1495539854, "creation_date": 1467811360, "answer_id": 38225158, "question_id": 38224975, "link": "https://stackoverflow.com/questions/38224975/vba-change-pivot-filter-and-export-pdf-file/38225158#38225158", "title": "VBA Change Pivot filter and export pdf file", "body": "<p>Perhaps look into the two topics separately then combine.</p>\n\n<p>1: Changing filters you could do via recording a macro then editing the results if you can't make sense of something like <a href=\"https://stackoverflow.com/questions/7348319/set-filter-in-excel-with-vba\">this</a>.</p>\n\n<p>2: Saving as pdf is a little trickier, as you could use many things to do it, depends if you have adobe on your machine etc or if you're using things like pdfcreator etc, <a href=\"https://stackoverflow.com/questions/27219784/vba-print-to-pdf-and-save-with-automatic-file-name\">this</a> is an example where someone is doing something similar.</p>\n\n<p>Give it a go and post your code back and people will be much more willing to try and help you.</p>\n"}, {"tags": [], "owner": {"reputation": 443, "user_id": 4102431, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/634783857/picture?type=large", "display_name": "Mads Hjorth", "link": "https://stackoverflow.com/users/4102431/mads-hjorth"}, "is_accepted": false, "score": 0, "last_activity_date": 1467816150, "creation_date": 1467816150, "answer_id": 38226883, "question_id": 38224975, "link": "https://stackoverflow.com/questions/38224975/vba-change-pivot-filter-and-export-pdf-file/38226883#38226883", "title": "VBA Change Pivot filter and export pdf file", "body": "<p>Okay so i found that i can Record a macro to:</p>\n\n<ol>\n<li>Change filter</li>\n<li>Save as PDF</li>\n</ol>\n\n<p>which works perfectly, however i need the saved filename to be dynamic since i need 30 PDF files, and not 1.</p>\n\n<p>The recorded code looks like this</p>\n\n<pre><code>ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n    \"C:\\Users\\username\\Folder\\Folder\\Documents\\Folder\\Folder\\Filename.pdf\" _\n    , Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _\n    :=False, OpenAfterPublish:=False\n</code></pre>\n\n<p>Do you know how i then change the saved file name based on a cells name?</p>\n"}], "owner": {"reputation": 443, "user_id": 4102431, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/634783857/picture?type=large", "display_name": "Mads Hjorth", "link": "https://stackoverflow.com/users/4102431/mads-hjorth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1428, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1467816150, "creation_date": 1467810796, "question_id": 38224975, "link": "https://stackoverflow.com/questions/38224975/vba-change-pivot-filter-and-export-pdf-file", "title": "VBA Change Pivot filter and export pdf file", "body": "<p>I am trying to automize a lot of my current excel work.\nAtm i have about 30 filters in my pivottable that i need to change one at the time and then export as a pdf file. I was thinking it might be possible to create some VBA code that automatically changes the filter and exports a pdf (to a local folder) and then automatically moves on and changing next filter and create a pdf from that, and so on, 30 times.</p>\n\n<p>I have tried to find some guide for it, but it has not been possible for me. Do you have any idea on how i can get started?</p>\n"}, {"tags": ["c#", ".net", "vba", "excel"], "comments": [{"owner": {"reputation": 11736, "user_id": 1987838, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2tIuS.jpg?s=128&g=1", "display_name": "Hackerman", "link": "https://stackoverflow.com/users/1987838/hackerman"}, "edited": false, "score": 0, "creation_date": 1467815105, "post_id": 38224700, "comment_id": 63874829, "body": "So basically the control works on x32 OS, but fails on x64?"}, {"owner": {"reputation": 606, "user_id": 5810883, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f23ad2702868e59cb84c842714957377?s=128&d=identicon&r=PG", "display_name": "Peroxy", "link": "https://stackoverflow.com/users/5810883/peroxy"}, "reply_to_user": {"reputation": 11736, "user_id": 1987838, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2tIuS.jpg?s=128&g=1", "display_name": "Hackerman", "link": "https://stackoverflow.com/users/1987838/hackerman"}, "edited": false, "score": 0, "creation_date": 1467828078, "post_id": 38224700, "comment_id": 63883134, "body": "You did not read the entire thing. It shows up in the VBA toolbox under additional controls on x32, but it still does not work, I can only pull it on the UserForm, but when running, it won&#39;t run, as it throws exception. On x64 it does not even show up under additional controls."}, {"owner": {"reputation": 11736, "user_id": 1987838, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2tIuS.jpg?s=128&g=1", "display_name": "Hackerman", "link": "https://stackoverflow.com/users/1987838/hackerman"}, "edited": false, "score": 0, "creation_date": 1467829699, "post_id": 38224700, "comment_id": 63883994, "body": "Which version of Visual Studio are you using?"}, {"owner": {"reputation": 606, "user_id": 5810883, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f23ad2702868e59cb84c842714957377?s=128&d=identicon&r=PG", "display_name": "Peroxy", "link": "https://stackoverflow.com/users/5810883/peroxy"}, "reply_to_user": {"reputation": 11736, "user_id": 1987838, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2tIuS.jpg?s=128&g=1", "display_name": "Hackerman", "link": "https://stackoverflow.com/users/1987838/hackerman"}, "edited": false, "score": 0, "creation_date": 1467835319, "post_id": 38224700, "comment_id": 63887193, "body": "I&#39;m using VS 2013 Professional."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11214140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7554987e0b2e863748d9babf275e5aa6?s=128&d=identicon&r=PG&f=1", "display_name": "steve", "link": "https://stackoverflow.com/users/11214140/steve"}, "is_accepted": false, "score": 0, "last_activity_date": 1553004022, "creation_date": 1553004022, "answer_id": 55242793, "question_id": 38224700, "link": "https://stackoverflow.com/questions/38224700/vba-run-time-error-459-external-exception-when-running-userform-with-custom-a/55242793#55242793", "title": "VBA Run-time error: &#39;459&#39; External exception when running userform with custom ActiveX control", "body": "<p>I am looking at this example <a href=\"https://www.codeguru.com/csharp/.net/net_general/comcom/article.php/c16257/Create-an-ActiveX-using-a-Csharp-Usercontrol.htm\" rel=\"nofollow noreferrer\">create an activeX using cSharp</a></p>\n\n<p>he had comRegister wrong. i have used the following code to register the COM and it worked.</p>\n\n<pre><code>        [ComRegisterFunction()]\n    public static void RegisterFunction(Type _type)\n    {\n        if (_type != null)\n        {\n            string sCLSID = \"CLSID\\\\\" + _type.GUID.ToString(\"B\");\n            try\n            {\n                RegistryKey _key = Registry.ClassesRoot.OpenSubKey(sCLSID, true);\n                try\n                {\n                    Guid _libID = Marshal.GetTypeLibGuidForAssembly(_type.Assembly);\n                    int _major, _minor;\n                    Marshal.GetTypeLibVersionForAssembly(_type.Assembly, out _major, out _minor);\n                    using (RegistryKey _sub = _key.CreateSubKey(\"Control\")) { }\n                    using (RegistryKey _sub = _key.CreateSubKey(\"MiscStatus\")) { _sub.SetValue(\"\", \"0\", RegistryValueKind.String); }\n                    using (RegistryKey _sub = _key.CreateSubKey(\"TypeLib\")) { _sub.SetValue(\"\", _libID.ToString(\"B\"), RegistryValueKind.String); }\n                    using (RegistryKey _sub = _key.CreateSubKey(\"Version\")) { _sub.SetValue(\"\", String.Format(\"{0}.{1}\", _major, _minor), RegistryValueKind.String); }\n                    using (RegistryKey _sub = _key.CreateSubKey(\"Control\")) { }\n                    using (RegistryKey _sub = _key.CreateSubKey(\"InprocServer32\")) { _sub.SetValue(\"\", Environment.SystemDirectory + \"\\\\\" + _sub.GetValue(\"\", \"mscoree.dll\"), RegistryValueKind.String); }\n                }\n                finally\n                {\n                }\n            }\n            catch\n            {\n            }\n        }\n    }\n\n    [ComUnregisterFunction()]\n    public static void UnregisterClass(Type t) //(string key)\n    {\n        string keyName = @\"CLSID\\\" + t.GUID.ToString(\"B\");\n        Registry.ClassesRoot.DeleteSubKeyTree(keyName);\n        //StringBuilder skey = new StringBuilder(key);\n        //skey.Replace(@\"HKEY_CLASSES_ROOT\\\", \"\");\n        //RegistryKey regKey = Registry.ClassesRoot.OpenSubKey(skey.ToString(), true);\n        //regKey.DeleteSubKey(\"Control\", false);\n        //RegistryKey inprocServer32 = regKey.OpenSubKey(\"InprocServer32\", true);\n        //regKey.DeleteSubKey(\"CodeBase\", false);\n        //regKey.Close();\n    }\n</code></pre>\n"}], "owner": {"reputation": 606, "user_id": 5810883, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f23ad2702868e59cb84c842714957377?s=128&d=identicon&r=PG", "display_name": "Peroxy", "link": "https://stackoverflow.com/users/5810883/peroxy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 433, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553004022, "creation_date": 1467810109, "last_edit_date": 1467811527, "question_id": 38224700, "link": "https://stackoverflow.com/questions/38224700/vba-run-time-error-459-external-exception-when-running-userform-with-custom-a", "title": "VBA Run-time error: &#39;459&#39; External exception when running userform with custom ActiveX control", "body": "<p>I have created a custom ActiveX control in C# by creating a simple COM-Visible class. I am able to build my C# solution and I can see the control in Excel 2010 (32-bit) and I can add my custom control to the VBA userform and see it properly. I am running Windows 7 64-bit Enterprise. However, when I try to run the UserForm, VBA throws <code>Run-time error '459': External exception</code>.</p>\n\n<p>You can see from the picture below, that I have successfully added my custom control to the UserForm (just a simple button):</p>\n\n<p><a href=\"https://i.stack.imgur.com/9s5Vf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9s5Vf.png\" alt=\"enter image description here\"></a></p>\n\n<p>I can actually click on the button inside my ActiveX control and it will fire a OnButtonClick event that shows up a messagebox:</p>\n\n<p><a href=\"https://i.stack.imgur.com/SUmTh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SUmTh.png\" alt=\"enter image description here\"></a></p>\n\n<p>The control is also available under additional controls, which allows me to see it in the VBA toolbox:</p>\n\n<p><a href=\"https://i.stack.imgur.com/gYYzk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gYYzk.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have tried numeruous solutions, but nothing has worked so far, I am simply unable to use my custom control in the VBA UserForm. Here is what I have tried so far:</p>\n\n<ul>\n<li>using RegAsm.exe \"Control DLL Path\" /codebase for both 64 and 32-bit</li>\n<li>tried RegAsm.exe without /codebase</li>\n<li>using RegAsm.exe first for 32-bit, then 64-bit, using it only with 32-bit, and only with 64-bit</li>\n<li>added reference under Tools/References in VBA editor to my custom user control class, this now allows me to see the exposed COM interface with methods etc., this now throws     <code>'459' Object or class does not support the set of events</code></li>\n<li>my project has COM-Visible ticked under properties/build and also under assembly information/make assembly COM-Visible</li>\n</ul>\n\n<p>I have also tried using my code on a Windows 10 64-bit machine with Excel 2016 64-bit. I can build the solution, but the control is not visible under additional controls in VBA. I have performed all the RegAsm commands for registering the DLL file, but it will simply not show up there. This is super strange behavior. I am trying to create an ActiveX control that will work on both 32 and 64-bit Excel, since the 32-bit existing VBA controls (we need ListView, DateTimePicker) are not supported in the 64-bit version of Office. We have a large codebase that we cannot switch from VBA to a different platform and we are migrating from 32 to 64-bit systems. I am unable to find a more elegant solution than my current one, it would be ideal, but it behaves in such weird way and refuses to work.</p>\n\n<p>Here is my C# code (it is garbage, just made a quick testing solution), followed a sample that I have found, this is the only solution that actually allows me to add the control to the userform:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.IO;\nusing System.Linq;\nusing System.Reflection;\nusing System.Runtime.InteropServices;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Windows.Forms;\nusing Microsoft.Win32;\n\nnamespace ActiveXTest2\n{\n    [ProgId(\"ActiveXTest2.CustomUserControl\")]\n    [ClassInterface(ClassInterfaceType.AutoDual), ComSourceInterfaces(typeof(IUserControlEvents))]\n    public partial class CustomUserControl : UserControl\n    {\n        private ListView listView1;\n\n        public CustomUserControl()\n        {\n            InitializeComponent();\n        }\n\n        // register COM ActiveX object\n        [ComRegisterFunction]\n        public static void RegisterClass(string key)\n        {\n            StringBuilder skey = new StringBuilder(key);\n            skey.Replace(@\"HKEY_CLASSES_ROOT\\\", \"\");\n\n            Type myType1 = Type.GetTypeFromProgID(\"ActiveXTest2.CustomUserControl\");\n            Console.WriteLine(\"ProgID=ActiveXTest2.CustomUserControl GUID={0}.\", myType1.GUID);\n\n            TextWriter tw = File.CreateText(\"guid.txt\");\n            tw.WriteLine(skey.ToString());\n            tw.WriteLine(myType1.GUID.ToString());\n            tw.Close();\n\n            RegistryKey regKey = Registry.ClassesRoot.OpenSubKey(skey.ToString(), true);\n            RegistryKey ctrl = regKey.CreateSubKey(\"Control\");\n            ctrl.Close();\n            RegistryKey inprocServer32 = regKey.OpenSubKey(\"InprocServer32\", true);\n            inprocServer32.SetValue(\"CodeBase\", Assembly.GetExecutingAssembly().CodeBase);\n            inprocServer32.Close();\n            regKey.Close();\n        }\n\n        // Unregister COM ActiveX object\n        [ComUnregisterFunction]\n        public static void UnregisterClass(string key)\n        {\n            StringBuilder skey = new StringBuilder(key);\n            skey.Replace(@\"HKEY_CLASSES_ROOT\\\", \"\");\n            RegistryKey regKey = Registry.ClassesRoot.OpenSubKey(skey.ToString(), true);\n            regKey.DeleteSubKey(\"Control\", false);\n            RegistryKey inprocServer32 = regKey.OpenSubKey(\"InprocServer32\", true);\n            regKey.DeleteSubKey(\"CodeBase\", false);\n            regKey.Close();\n        }\n\n        public delegate void ControlEventHandler();\n\n        [Guid(\"0A415E38-372F-45fb-813B-D9558C787EB0\")]\n        [InterfaceType(ComInterfaceType.InterfaceIsIDispatch)]\n        public interface IUserControlEvents\n        {\n            [DispId(0x60020001)]\n            void OnButtonClick();\n        }\n\n        public interface ICOMCallable\n        {\n            int TestValue();\n        }\n\n        public int TestValue()\n        {\n            return 0;\n        }\n\n        public event ControlEventHandler OnButtonClick;\n\n        protected virtual void OnOnButtonClick()\n        {\n            MessageBox.Show(\"TEST\", \"\", MessageBoxButtons.OK, MessageBoxIcon.Error);\n        }\n\n        private void InitializeComponent()\n        {\n            this.listView1 = new System.Windows.Forms.ListView();\n            this.SuspendLayout();\n            // \n            // listView1\n            // \n            this.listView1.Location = new System.Drawing.Point(4, 4);\n            this.listView1.Name = \"listView1\";\n            this.listView1.Size = new System.Drawing.Size(228, 210);\n            this.listView1.TabIndex = 0;\n            this.listView1.UseCompatibleStateImageBehavior = false;\n            // \n            // CustomUserControl\n            // \n            this.Controls.Add(this.listView1);\n            this.Name = \"CustomUserControl\";\n            this.Size = new System.Drawing.Size(235, 217);\n            this.ResumeLayout(false);\n\n        }\n\n        private void button1_Click(object sender, EventArgs e)\n        {\n            OnOnButtonClick();\n        }\n    }\n\n\n}\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "edited": false, "score": 0, "creation_date": 1467809923, "post_id": 38224578, "comment_id": 63871100, "body": "What is not working? You are not getting the correct output or you are getting an error?"}, {"owner": {"reputation": 25, "user_id": 6534075, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1268038273259270/picture?type=large", "display_name": "VBA_Beginner", "link": "https://stackoverflow.com/users/6534075/vba-beginner"}, "reply_to_user": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "edited": false, "score": 0, "creation_date": 1467809991, "post_id": 38224578, "comment_id": 63871146, "body": "Thanks for your help, I am not getting the correct output."}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1467810874, "post_id": 38224578, "comment_id": 63871754, "body": "What is the output you are getting and what is the output you are expecting?  Unfortunately, the SO crystal ball has been out of order so we need your input to know where the problem is"}, {"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "edited": false, "score": 1, "creation_date": 1467810963, "post_id": 38224578, "comment_id": 63871824, "body": "Rnd will only produce integers so only the values 0 and 1 will show in your sheet"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 3, "creation_date": 1467811070, "post_id": 38224578, "comment_id": 63871913, "body": "<code>For j = 2 To -1</code> should be <code>For j = 2 To M-1</code>"}, {"owner": {"reputation": 25, "user_id": 6534075, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1268038273259270/picture?type=large", "display_name": "VBA_Beginner", "link": "https://stackoverflow.com/users/6534075/vba-beginner"}, "reply_to_user": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "edited": false, "score": 0, "creation_date": 1467811099, "post_id": 38224578, "comment_id": 63871933, "body": "@phil652, well, I thought in VBA, Rnd will generate a infinite number between 0-1 instead of 0,or 1. .......Do you have any clues on that?"}, {"owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "edited": false, "score": 0, "creation_date": 1467811419, "post_id": 38224578, "comment_id": 63872157, "body": "Rnd doesn&#39;t do integers. Rnd &quot;The Rnd function returns a value less than 1 but greater than or equal to zero.&quot; per the help file. Your array is populated with the expected values between 0 and 1."}, {"owner": {"reputation": 25, "user_id": 6534075, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1268038273259270/picture?type=large", "display_name": "VBA_Beginner", "link": "https://stackoverflow.com/users/6534075/vba-beginner"}, "reply_to_user": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "edited": false, "score": 0, "creation_date": 1467811961, "post_id": 38224578, "comment_id": 63872479, "body": "@Rodger, agreed, I have tried to run it separately, and it does generate random values. Thanks."}, {"owner": {"reputation": 25, "user_id": 6534075, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1268038273259270/picture?type=large", "display_name": "VBA_Beginner", "link": "https://stackoverflow.com/users/6534075/vba-beginner"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1467812002, "post_id": 38224578, "comment_id": 63872510, "body": "@arcadeprecinct, Thanks, Yes, that was a typing mistake!!"}], "answers": [{"comments": [{"owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "edited": false, "score": 1, "creation_date": 1467811781, "post_id": 38225117, "comment_id": 63872356, "body": "Minor recommendation - If (arr(i) &lt;= breaks(1)) Then freq(1) = freq(1) + 1     If (arr(i) &gt;= breaks(M - 1)) Then freq(M) = freq(M) + 1 .... shouldn&#39;t both have an equal. You could get a value that triggers then both. One should be &lt;= and the other &gt; or &lt; and &gt;="}, {"owner": {"reputation": 25, "user_id": 6534075, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1268038273259270/picture?type=large", "display_name": "VBA_Beginner", "link": "https://stackoverflow.com/users/6534075/vba-beginner"}, "edited": false, "score": 0, "creation_date": 1467812088, "post_id": 38225117, "comment_id": 63872553, "body": "I think VBA will do the logic step by step, once the value meet the first criteria, then, It wont execute the second step."}, {"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "edited": false, "score": 1, "creation_date": 1467812155, "post_id": 38225117, "comment_id": 63872596, "body": "It will execute both unless you change the second one to an ELSEIF <a href=\"https://msdn.microsoft.com/en-us/library/752y8abs.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/752y8abs.aspx</a>"}, {"owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "edited": false, "score": 1, "creation_date": 1467812940, "post_id": 38225117, "comment_id": 63873160, "body": "That works too. You will also need an &quot;end if&quot; on the following line. At the end of the day though, since you are dealing with 15 digits it probably won&#39;t ever come up... until that day it does and then you can&#39;t reproduce it and you are pulling out your hair trying to figure out what happened that time around compared to the 500 times it ran correctly. :-)"}], "tags": [], "owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "is_accepted": true, "score": 1, "last_activity_date": 1467813062, "last_edit_date": 1467813062, "creation_date": 1467811232, "answer_id": 38225117, "question_id": 38224578, "link": "https://stackoverflow.com/questions/38224578/vba-array-issues/38225117#38225117", "title": "VBA Array issues", "body": "<p>This should work. Just like arcadeprecinct said you had a typo. You also have to put <code>Call Hist1(Iteration, 20, 0, 1, AI1)</code> inside your loop. </p>\n\n<p>Hope you can learn from this.</p>\n\n<p>EDIT following Rodger's comment bellow</p>\n\n<pre><code>Option Explicit\nOption Base 1\n\nSub MNA()\n\n    Dim Iteration As Long, i As Long\n\n    Iteration = 5000\n\n    ReDim AI1(Iteration) As Double\n\nFor i = 1 To Iteration:    Cells(4, 3) = i\n\n    AI1(i) = RandomNumber\n    Call Hist1(Iteration, 20, 0, 1, AI1)\n\n Next i\n\n\n\nEnd Sub\n\nFunction RandomNumber()\n\nRandomize\n\nRandomNumber = Rnd\n\n\nEnd Function\nSub Hist1(n As Variant, M As Long, Start As Double, Right As Double, arr() As Double)\n\n   Dim i As Long, j As Long, Find As Long\n   Dim Length As Double\n   ReDim breaks(M) As Single\n   ReDim freq(M) As Single\n\n\nFor i = 1 To M\n    freq(i) = 0\nNext i\n    Length = (Right - Start) / M\n\nFor i = 1 To M\n    breaks(i) = Start + Length * (i)\nNext i\n\nFor i = 1 To n\n\n    If (arr(i) &lt;= breaks(1)) Then freq(1) = freq(1) + 1\n    If (arr(i) &gt; breaks(M - 1)) Then freq(M) = freq(M) + 1\n\n    For j = 2 To M - 1\n\n        If (arr(i) &gt; breaks(j - 1) And arr(i) &lt;= breaks(j)) Then freq(j) = freq(j) + 1\n\n    Next j\nNext i\n\nFor i = 1 To M\n    Cells(3, i + 13) = breaks(i)\n    Cells(4, i + 13) = freq(i)\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6534075, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1268038273259270/picture?type=large", "display_name": "VBA_Beginner", "link": "https://stackoverflow.com/users/6534075/vba-beginner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 38225117, "answer_count": 1, "score": 0, "last_activity_date": 1467813062, "creation_date": 1467809755, "last_edit_date": 1531164843, "question_id": 38224578, "link": "https://stackoverflow.com/questions/38224578/vba-array-issues", "title": "VBA Array issues", "body": "<p>I am trying to generate a random variable from 0-1 for 5000 times. And then, put them into ranges e.g. 0-0.05, 0.05-0.1.... so that I could count the frequency of each range. </p>\n\n<p>However, it seems the code doesnt work. Anyone could help on it? Much appreciated!!!!</p>\n\n<pre><code>Option Explicit\nOption Base 1\n\nSub MNA()\n\n    Dim Iteration As Long, i As Long\n\n    Iteration = 5000\n\n    ReDim AI1(Iteration) As Double\n\nFor i = 1 To Iteration:    Cells(4, 3) = i\n\n    AI1(i) = RandomNumber\n\n Next i\n\nCall Hist1(Iteration, 20, 0, 1, AI1)\n\nEnd Sub\n\nFunction RandomNumber()\n\nRandomize\n\nRandomNumber = Rnd()\n\nEnd Function\nSub Hist1(n As Variant, M As Long, Start As Double, Right As Double, arr() As Double)\n\n   Dim i As Long, j As Long, Find As Long\n   Dim Length As Double\n   ReDim breaks(M) As Single\n   ReDim freq(M) As Single\n\n\nFor i = 1 To M\n    freq(i) = 0\nNext i\n    Length = (Right - Start) / M\n\nFor i = 1 To M\n    breaks(i) = Start + Length * (i)\nNext i\n\nFor i = 1 To n\n\n    If (arr(i) &lt;= breaks(1)) Then freq(1) = freq(1) + 1\n    If (arr(i) &gt;= breaks(M - 1)) Then freq(M) = freq(M) + 1\n\n    For j = 2 To -1\n\n        If (arr(i) &gt; breaks(j - 1) And arr(i) &lt;= breaks(j)) Then freq(j) = freq(j) + 1\n\n    Next j\nNext i\n\nFor i = 1 To M\n    Cells(3, i + 13) = breaks(i)\n    Cells(4, i + 13) = freq(i)\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467809285, "post_id": 38224357, "comment_id": 63870686, "body": "Have you done anything yet?"}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 1, "creation_date": 1467809537, "post_id": 38224357, "comment_id": 63870854, "body": "Please show us your code. If all you want to know is, if it&#39;s possible to check for the word &quot;process&quot;: yes, it is. :)"}], "answers": [{"comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1467836594, "post_id": 38224624, "comment_id": 63887833, "body": "Workbooks.Open takes a file name, not an instance of the Outlook.Attachment object. Save the attachment to a file (Attachment.SaveAsFile), then pass the file name to Workbooks.Open"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1467882037, "post_id": 38224624, "comment_id": 63903719, "body": "referencing it like that returns the file name of the attachment, although it is technically the attachment object, the return is Filename.xlsx"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 2, "creation_date": 1467910377, "post_id": 38224624, "comment_id": 63923277, "body": "FileName happens to be the default property, so it gets returned when a string is necessary to pass to a string parameter. But the important thing is that the file with that name does not exist anywhere on the file system, and Open will raise an exception."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1467968221, "post_id": 38224624, "comment_id": 63945055, "body": "Yes, with the opening, unless the attachment is on a share :)"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1467970009, "post_id": 38224624, "comment_id": 63946106, "body": "@Dmitry Streblechenko, I&#39;ve altered now :)"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1467991410, "post_id": 38224624, "comment_id": 63959936, "body": "Your code still needs to call Attachment.SaveAsFile."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 1, "creation_date": 1467991650, "post_id": 38224624, "comment_id": 63960101, "body": "Also, the line <code>If InStr(1, o.Attachments(1), &quot;.xls&quot;) &gt; 0 Then</code> needs to be changed to <code>If InStr(1, o.Attachments(1).FileName, &quot;.xls&quot;) &gt; 0 Then</code>. You also need to loop through all attachments, your code expects the messages to have a single Excel file attachment."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 1, "last_activity_date": 1467969983, "last_edit_date": 1467969983, "creation_date": 1467809888, "answer_id": 38224624, "question_id": 38224357, "link": "https://stackoverflow.com/questions/38224357/how-can-i-open-with-vba-a-attachment-of-excel-file-and-verify-inside-the-file-be/38224624#38224624", "title": "How can I open with VBA a attachment of excel file and verify inside the file before seva the message in a determined folder in outlook?", "body": "<p>Called from a rule.    </p>\n\n<pre><code>Sub TEST1(o As Outlook.MailItem)\n\n    Dim xl As Excel.Application\n\n    If InStr(1, o.Attachments(1), \".xls\") &gt; 0 Then\n\n        Set xl = New Excel.Application\n        xl.Visible = 1\n        '    Save the attachment here as strAttachmentName\n        xl.Workbooks.Open strAttachmentName\n        If xl.ActiveWorkbook.Worksheets(1).Range(\"a1\").Value = \"Processing\" Then\n            o.Move Application.GetNamespace(\"MAPI\").GetDefaultFolder(olFolderInbox)\n        End If\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 185, "user_id": 3773028, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/100000327049499/picture?type=large", "display_name": "caezar", "link": "https://stackoverflow.com/users/3773028/caezar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2223, "favorite_count": 0, "accepted_answer_id": 38224624, "answer_count": 1, "score": 0, "last_activity_date": 1593519164, "creation_date": 1467809080, "last_edit_date": 1593519164, "question_id": 38224357, "link": "https://stackoverflow.com/questions/38224357/how-can-i-open-with-vba-a-attachment-of-excel-file-and-verify-inside-the-file-be", "title": "How can I open with VBA a attachment of excel file and verify inside the file before seva the message in a determined folder in outlook?", "body": "<p>I receive determined e-mails with an attached excel file and I need to know if this email is part of a process before moving it to a determined folder.</p>\n\n<ol>\n<li>The macro starts when an email arrives.</li>\n<li>The macro verifies if the email has an excel attachment.</li>\n<li>If it's an Excel file, the macro verifies if inside the file the first cell contains the word \"process\".</li>\n<li>If that is true, the macro moves the email to a determined folder in Outlook.</li>\n</ol>\n\n<p>I can do the first and second step, but I don't know if it's possble to open a excel file attachment and verify the first cell.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "edited": false, "score": 0, "creation_date": 1467809180, "post_id": 38224345, "comment_id": 63870619, "body": "What is the error you are getting?"}, {"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "edited": false, "score": 1, "creation_date": 1467809287, "post_id": 38224345, "comment_id": 63870687, "body": "Make sure your checkboxes are called CheckBox9, CheckBox10..."}, {"owner": {"reputation": 17, "user_id": 6449089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V9oC4.jpg?s=128&g=1", "display_name": "dzmkr", "link": "https://stackoverflow.com/users/6449089/dzmkr"}, "edited": false, "score": 0, "creation_date": 1467809381, "post_id": 38224345, "comment_id": 63870753, "body": "Checkboxes are named properly. The error I am getting is &quot;The item with specified name wasn&#39;t found&quot;."}, {"owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "edited": false, "score": 1, "creation_date": 1467809404, "post_id": 38224345, "comment_id": 63870768, "body": "Agreed - When I add a new checkbox, the name comes through with spaces, eg. <code>Check Box 1</code>, so you calling out <code>&quot;Checkbox&quot; &amp; CStr(i)</code> won&#39;t find anything, unless you manually changed the names of each checkbox."}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 1, "creation_date": 1467809412, "post_id": 38224345, "comment_id": 63870771, "body": "Maybe one of them doesn&#39;t exist. Check the value of i when that error happens, and then go check that checkbox exists."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1467809686, "post_id": 38224345, "comment_id": 63870947, "body": "Code looks fine in my opinion. I bet it&#39;s something with the checkboxes names"}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 0, "creation_date": 1467809734, "post_id": 38224345, "comment_id": 63870982, "body": "please check with the check box name as suggested by @theguythatdoesntknowmuch. Try leaving space before and after box"}, {"owner": {"reputation": 17, "user_id": 6449089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V9oC4.jpg?s=128&g=1", "display_name": "dzmkr", "link": "https://stackoverflow.com/users/6449089/dzmkr"}, "edited": false, "score": 0, "creation_date": 1467809850, "post_id": 38224345, "comment_id": 63871051, "body": "Thanks a lot guys! Indeed, I didn&#39;t change a name of one of the checkboxes... Case solved."}], "answers": [{"tags": [], "owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1467986189, "last_edit_date": 1495535334, "creation_date": 1467810995, "answer_id": 38225043, "question_id": 38224345, "link": "https://stackoverflow.com/questions/38224345/loop-counter-in-checkbox-name/38225043#38225043", "title": "Loop counter in checkbox name", "body": "<p>I think this would be a more elegant solution.</p>\n\n<p>This loops through all shapes on <code>ActiveSheet</code> and checks if they are a <code>msoOLEControlObject</code> (see <a href=\"https://stackoverflow.com/questions/23547323/go-through-all-the-objects-except-the-table-of-a-worksheet-and-print-its-type\">here</a> for more information on that matter). </p>\n\n<pre><code>Sub checkboxes()\n\nDim curCellValue as Variant\nDim i As Long\n    For i = 1 To ActiveSheet.Shapes.Count\n        If ActiveSheet.Shapes(i).Type = msoOLEControlObject Then\n            curCellValue = ActiveSheet.Cells(i, 3).Value\n            If curCellValue &lt;&gt; \"\" Then\n                ActiveSheet.Shapes(i).Visible = True\n            Else\n                ActiveSheet.Shapes(i).Visible = False\n            End If\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>So why is this \"better\"?</p>\n\n<ol>\n<li>You don't have to \"guess\" how many values there will be.</li>\n<li>If you ever change a name of a CheckBox this script will still be working.</li>\n<li>This checks for <em>empty</em> cells.</li>\n</ol>\n\n<p>Also note that I replaced <code>Set CurCell = ActiveSheet.Cells(i, 3)</code> with <code>curCellValue = ActiveSheet.Cells(i, 3).Value</code>. You don't need to <code>Set</code> an object in every iteration. Filling the variable suffices.</p>\n\n<p>But: this will check for all <code>msoOLEControlObject</code>s which includes checkboxes, textboxes and the like.</p>\n\n<p>HTH.</p>\n"}], "owner": {"reputation": 17, "user_id": 6449089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V9oC4.jpg?s=128&g=1", "display_name": "dzmkr", "link": "https://stackoverflow.com/users/6449089/dzmkr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "accepted_answer_id": 38225043, "answer_count": 1, "score": 1, "last_activity_date": 1467986189, "creation_date": 1467809057, "last_edit_date": 1467809575, "question_id": 38224345, "link": "https://stackoverflow.com/questions/38224345/loop-counter-in-checkbox-name", "title": "Loop counter in checkbox name", "body": "<p>I am trying to create a sheet which will have a checkbox in each non-empty line. To automatically adjust the number of checkboxes I created this macro:</p>\n\n<pre><code>Sub checkboxes()\n\nDim i As Integer\n\nFor i = 9 To 200\nSet CurCell = ActiveSheet.Cells(i, 3)\n    If CurCell.Value &gt; 1 Then\n        ActiveSheet.Shapes(\"CheckBox\" &amp; CStr(i)).Visible = True\n    Else\n        ActiveSheet.Shapes(\"CheckBox\" &amp; CStr(i)).Visible = False\n    End If\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>I expect number of potential rows with data not greater than 200. Macro checks if value in column C for each line is >1, if true checkbox is visible, else it's hidden.</p>\n\n<p>My problem is that I don't know how to put the loop counter \"i\" into Shape name - I got an error using code above. Can someone help?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6956, "user_id": 206491, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/0cBBl.jpg?s=128&g=1", "display_name": "Sivasubramaniam Arunachalam", "link": "https://stackoverflow.com/users/206491/sivasubramaniam-arunachalam"}, "edited": false, "score": 1, "creation_date": 1467808254, "post_id": 38224044, "comment_id": 63870044, "body": "What do you have tried?"}, {"owner": {"reputation": 597, "user_id": 3088158, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/bwEFC.png?s=128&g=1", "display_name": "JBithell", "link": "https://stackoverflow.com/users/3088158/jbithell"}, "edited": false, "score": 0, "creation_date": 1467808338, "post_id": 38224044, "comment_id": 63870088, "body": "Creating a list of sub folders and their contents is possible with the operating system, which python could call directly - see <a href=\"http://superuser.com/a/319009\">superuser.com/a/319009</a>"}, {"owner": {"reputation": 10158, "user_id": 1209921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxrGg.gif?s=128&g=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/1209921/matthias"}, "edited": false, "score": 0, "creation_date": 1467808597, "post_id": 38224044, "comment_id": 63870261, "body": "You might want to use <a href=\"https://docs.python.org/3/library/os.html#os.walk\" rel=\"nofollow noreferrer\"><code>os.walk</code></a>."}], "answers": [{"tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": false, "score": 0, "last_activity_date": 1467817847, "creation_date": 1467817847, "answer_id": 38227483, "question_id": 38224044, "link": "https://stackoverflow.com/questions/38224044/copying-the-location-of-file-names-with-specific-extensions/38227483#38227483", "title": "Copying the location of file names with specific extensions", "body": "<p>You can use <a href=\"https://msdn.microsoft.com/en-us/library/x0fxha2a(v=vs.84).aspx\" rel=\"nofollow\">GetExtensionName Method</a> like this:</p>\n\n<pre><code>Sub ListFilesInFolder(ByVal SourceFolderName As String, ByVal IncludeSubfolders As Boolean)\n\nDim FSO As Object\nDim SourceFolder As Object\nDim SubFolder As Object\nDim FileItem As Object\nDim r As Long\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nSet SourceFolder = FSO.GetFolder(SourceFolderName)\nr = Range(\"A65536\").End(xlUp).Row + 1\n\nFor Each FileItem In SourceFolder.Files\n  If FSO.GetExtensionName(FileItem) = \"txt\" Then 'change txt as you want\n    Cells(r, 1).Formula = FileItem.Name\n    Cells(r, 2).Formula = FileItem.Path\n    r = r + 1 ' next row number\n  End If\n  X = SourceFolder.Path\nNext FileItem\n\nIf IncludeSubfolders Then\nFor Each SubFolder In SourceFolder.SubFolders\nListFilesInFolder SubFolder.Path, True\nNext SubFolder\nEnd If\n\nSet FileItem = Nothing\nSet SourceFolder = Nothing\nSet FSO = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 6504708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5536494d3e42dd99094a2e0a00687ebc?s=128&d=identicon&r=PG&f=1", "display_name": "Santz", "link": "https://stackoverflow.com/users/6504708/santz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1563496377, "creation_date": 1467808205, "last_edit_date": 1563496377, "question_id": 38224044, "link": "https://stackoverflow.com/questions/38224044/copying-the-location-of-file-names-with-specific-extensions", "title": "Copying the location of file names with specific extensions", "body": "<p>I have this code for listing all files in a folder and sub folder with path.</p>\n\n<p>I want to list files which have specific extensions (for example: .txt files alone).</p>\n\n<p>How can I do this?</p>\n\n<p>My code so far:</p>\n\n<pre><code>Sub Test()\n\nCall ListFilesInFolder(\"D:\\Downloads\", True)\n\nEnd Sub\n\n\nSub ListFilesInFolder(ByVal SourceFolderName As String, ByVal IncludeSubfolders As Boolean)\n\nDim FSO As Object\nDim SourceFolder As Object\nDim SubFolder As Object\nDim FileItem As Object\nDim r As Long\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nSet SourceFolder = FSO.GetFolder(SourceFolderName)\nr = Range(\"A65536\").End(xlUp).Row + 1\n\nFor Each FileItem In SourceFolder.Files\n    Cells(r, 1).Formula = FileItem.Name\n    Cells(r, 2).Formula = FileItem.Path\n    r = r + 1 ' next row number\n    X = SourceFolder.Path\nNext FileItem\n\nIf IncludeSubfolders Then\n    For Each SubFolder In SourceFolder.SubFolders\n        ListFilesInFolder SubFolder.Path, True\n    Next SubFolder\nEnd If\n\nSet FileItem = Nothing\nSet SourceFolder = Nothing\nSet FSO = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1467806596, "post_id": 38223414, "comment_id": 63868995, "body": "Wouldn&#39;t that just be <code>Target.Clear</code>?"}, {"owner": {"reputation": 27, "user_id": 6555986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989aec4d2cc3a6f411dc25c04b07d44?s=128&d=identicon&r=PG&f=1", "display_name": "CTH", "link": "https://stackoverflow.com/users/6555986/cth"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1467806710, "post_id": 38223414, "comment_id": 63869051, "body": "It would indeed! I knew it&#39;d be something simple. Thanks a lot!"}], "answers": [{"tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": true, "score": 0, "last_activity_date": 1467807995, "creation_date": 1467807995, "answer_id": 38223970, "question_id": 38223414, "link": "https://stackoverflow.com/questions/38223414/excel-vba-delete-recent-entry-after-msgbox/38223970#38223970", "title": "Excel VBA - delete recent entry after MsgBox", "body": "<p>Try with below code</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Column = 2 Then\n        Application.EnableEvents = False\n        Dim Ret_type As Integer\n        Dim strMsg As String\n        Dim strTitle As String\n        strMsg = \"Do you approve?\" &amp; vbCrLf &amp; \"Warning: This action will lock the current row.\"\n        strTitle = \"Approval\"\n        Ret_type = MsgBox(strMsg, vbYesNo + vbQuestion, strTitle)\n        Select Case Ret_type\n            Case 7\n                MsgBox \"Your input will be deleted.\"\n                Target.Clear\n                Application.EnableEvents = True\n                Exit Sub\n            Case 6\n                ActiveSheet.Unprotect Password:=\"password\"\n                Target.Rows.Locked = False\n                Cells(Target.Row, 3).Value = Date + Time\n                'Application.EnableEvents = True\n                Target.EntireRow.Locked = True\n                ActiveSheet.Protect Password:=\"password\"\n                Application.EnableEvents = True\n        End Select\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6555986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989aec4d2cc3a6f411dc25c04b07d44?s=128&d=identicon&r=PG&f=1", "display_name": "CTH", "link": "https://stackoverflow.com/users/6555986/cth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 446, "favorite_count": 0, "accepted_answer_id": 38223970, "answer_count": 1, "score": -1, "last_activity_date": 1467808136, "creation_date": 1467806182, "last_edit_date": 1467808136, "question_id": 38223414, "link": "https://stackoverflow.com/questions/38223414/excel-vba-delete-recent-entry-after-msgbox", "title": "Excel VBA - delete recent entry after MsgBox", "body": "<p>I'm struggling to get my Excel-VBA-code to work. I want a button to pop up after text is entered into a cell. Here, Yes leads to the row being locked and another cell being time-stamped, but I want Cancel to lead to the cell that I was entering text into being cleared of content.</p>\n\n<p>I can't figure out a way to delete the recent entry. I can delete the ActiveCell, but this is not the most recent cell (say you write text in A1 and press enter, the active cell will be A2 - or if you write text and then press somewhere with the cursor, then the Active Cell will be god knows what).</p>\n\n<p>I hope someone can help me with this.</p>\n\n<p>Best regards</p>\n\n<h2>Christian</h2>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Target.Column = 2 Then\nApplication.EnableEvents = False\n\nDim Ret_type As Integer\nDim strMsg As String\nDim strTitle As String\n\nstrMsg = \"Do you approve?\" &amp; vbCrLf &amp; \"Warning: This action will lock the current row.\"\nstrTitle = \"Approval\"\n\n    Ret_type = MsgBox(strMsg, vbYesNo + vbQuestion, strTitle)\n\nSelect Case Ret_type\n\nCase 7\n    MsgBox \"Your input will be deleted.\"\n    Exit Sub\n\nCase 6\n    Cells(Target.Row, 3).Value = Date + Time\n    Application.EnableEvents = True\n    ActiveSheet.Unprotect Password:=\"password\"\n    Target.EntireRow.Locked = True\n    ActiveSheet.Protect Password:=\"password\"\n    Application.EnableEvents = True\n\nEnd Select\n\nEnd If\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1467807335, "post_id": 38223294, "comment_id": 63869451, "body": "You&#39;ll need to do two separate searches. The find method can be quite slow if not optimize.  You should post your actual code."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1469022056, "post_id": 38223294, "comment_id": 64368078, "body": "Create disconnected recordset, populate it with values from the range, apply filter, and get resulting records from recordset. Here is the <a href=\"http://stackoverflow.com/a/36189658/2165759\">example</a>."}], "owner": {"reputation": 49, "user_id": 5671028, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4d6c9b40fea831acc35117c9573fc0b1?s=128&d=identicon&r=PG&f=1", "display_name": "Zaid Shaikh", "link": "https://stackoverflow.com/users/5671028/zaid-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467816539, "creation_date": 1467805777, "last_edit_date": 1531164843, "question_id": 38223294, "link": "https://stackoverflow.com/questions/38223294/find-function-with-two-criteria-in-vba", "title": "find function with two criteria in vba", "body": "<p>I want to search the data with two conditions. Eg: column \"A\" should match with str (string) and column \"J\" should contain \"Completed\"\nWith the below coding, I am able to put only one condition.  Please advise me as to what changes are required to add a second condition.</p>\n\n<pre><code> Set Rng = .Find(What:=str,After:=.Cells(.Cells.Count),LookIn:=xlValues, _\n                           LookAt:=xlWhole, SearchOrder:=xlByRows, _\n                          SearchDirection:=xlPrevious, _\n                            MatchCase:=False)\n</code></pre>\n"}, {"tags": ["excel", "vba", "internet-explorer", "web-scraping", "automation"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1467806265, "post_id": 38223246, "comment_id": 63868822, "body": "You can you getElementbyID. Browser.Document.getElementbyID(&quot;BUTTON_TOOLBAR_STANDARD_btn&zwnj;&#8203;7_acButton&quot;).click"}, {"owner": {"reputation": 291, "user_id": 947769, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/34ca059c1dee6f7b2831c473a57567d9?s=128&d=identicon&r=PG", "display_name": "Erik Rasmussen", "link": "https://stackoverflow.com/users/947769/erik-rasmussen"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1467823740, "post_id": 38223246, "comment_id": 63880580, "body": "thank you, I&#39;ve tried this but I&#39;m running in to an error with the document method not being recognized. I&#39;ve updated to include my sample code, do you know how to solve this?"}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1467824742, "post_id": 38223246, "comment_id": 63881162, "body": "<b>(1)</b> add the &quot;Microsoft Internet Controls&quot; reference per <a href=\"https://msdn.microsoft.com/en-us/library/ms970672.aspx\" rel=\"nofollow noreferrer\">this</a> and <code>Dim ie as SHDocVw.InternetExplorer: set ie = new SHDocVw.InternetExplorer</code> rather than using generic <code>Object</code>.  <b>(2)</b> Use a <code>NavigateError</code> event to see if <code>Navigate</code> actually succeeds.  <b>(3)</b> In the VB editor, set a breakpoint on the <code>getElementById</code> line and use the Watch window to see if <code>ie.Document</code> is actually a valid Object when you try to call <code>getElementById</code>."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1468019132, "post_id": 38223246, "comment_id": 63972373, "body": "Is it possible to post he URL?"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1468911622, "post_id": 38223246, "comment_id": 64307757, "body": "Add delay after <code>.Navigate</code> untill IE is not busy, docunent is ready and target element is not null."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1468496846, "creation_date": 1468496846, "answer_id": 38373382, "question_id": 38223246, "link": "https://stackoverflow.com/questions/38223246/vba-web-automation/38373382#38373382", "title": "VBA Web Automation", "body": "<p>You are right, it should be something like this . . . </p>\n\n<pre><code>For Each oHTML_Element In HTMLDoc.getElementsByTagName(\"input\")\nIf oHTML_Element.Type = \"submit\" Then oHTML_Element.Click: Exit For\nNext\n</code></pre>\n\n<p>Read more at <a href=\"http://vbadud.blogspot.com/2009/08/how-to-login-to-website-using-vba.html#gurMeXG3KmWvFUMx.99\" rel=\"nofollow\">http://vbadud.blogspot.com/2009/08/how-to-login-to-website-using-vba.html#gurMeXG3KmWvFUMx.99</a></p>\n\n<p>The best way to see the ID name of the button is to hit F12 when you are on the site.  If you use Firefox and F12 does nothing, download Firebug.  </p>\n\n<p><a href=\"https://addons.mozilla.org/en-US/firefox/addon/firebug/\" rel=\"nofollow\">https://addons.mozilla.org/en-US/firefox/addon/firebug/</a></p>\n\n<p>If you use IE and nothing happens when you hit F12, download and install the IE Developer Tool. </p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/bg182326(v=vs.85).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/bg182326(v=vs.85).aspx</a></p>\n\n<p>These tools will allow you to easily see the code behind the page and everything is highly interactive too, so these things are really easy to use.  </p>\n\n<p>Good luck!!</p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1528461798, "creation_date": 1528461798, "answer_id": 50760930, "question_id": 38223246, "link": "https://stackoverflow.com/questions/38223246/vba-web-automation/50760930#50760930", "title": "VBA Web Automation", "body": "<p>Depending on how many similar elements there are on the page you could try a CSS selector </p>\n\n<p>The following would select your bit of HTML </p>\n\n<pre><code>a[onclick*='ur_Button_click(event)']\n</code></pre>\n\n<hr>\n\n<p>CSS query</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZJfjy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZJfjy.png\" alt=\"CSS query\"></a></p>\n\n<hr>\n\n<p>VBA:</p>\n\n<pre><code>ie.document.querySelector(\"a[onclick*='ur_Button_click(event)']\").Click\n</code></pre>\n\n<p>If there is more than one matching item you would use: </p>\n\n<pre><code>ie.document.querySelectorAll(\"a[onclick*='ur_Button_click(event)']\") \n</code></pre>\n\n<p>to return a nodeList of matching items and then click the appropriate item by accessing through index.</p>\n\n<hr>\n\n<p>Info on <a href=\"https://CSS-tricks.com/how-css-selectors-work/\" rel=\"nofollow noreferrer\">CSS selectors</a></p>\n"}], "owner": {"reputation": 291, "user_id": 947769, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/34ca059c1dee6f7b2831c473a57567d9?s=128&d=identicon&r=PG", "display_name": "Erik Rasmussen", "link": "https://stackoverflow.com/users/947769/erik-rasmussen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1228, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1561878005, "creation_date": 1467805644, "last_edit_date": 1561878005, "question_id": 38223246, "link": "https://stackoverflow.com/questions/38223246/vba-web-automation", "title": "VBA Web Automation", "body": "<p>I'm trying to write a macro to access data from a web portal, where I need to launch the website and click an 'open in excel' button.</p>\n\n<p>I've launched the webpage fine, but I can't not click the link. My understanding is I should be able to do something similar to this:</p>\n\n<pre><code>BrowswerObject.Document.ElementID.Click\n</code></pre>\n\n<p>but I'm not sure what the correct element and coding would be. One the webpage when I inspect the element it has this code:</p>\n\n<pre><code>&lt;A onclick=ur_Button_click(event); tabIndex=0 id=BUTTON_TOOLBAR_STANDARD_btn7_acButton title=\"Open in Excel\" class=urBtnStd onkeydown=ur_Button_keypress(event); style=\"OVERFLOW: visible; TEXT-ALIGN: center\" href=\"javascript:void(0);\" ct=\"B\" ti=\"0\" st=\"\" ocl=\"sapbi_page.sendCommandArray([['GUID','11',0],['NOUILOCK','X',0],['BI_COMMAND_TYPE','ABSTRACT',0]],event);\"&gt;Open in Excel&lt;/A&gt;\n</code></pre>\n\n<p>Could anyone pinpoint what from that I should focus on for this?</p>\n\n<p>Edit:\nI've tried the getElementByID but I'm running in to this error:\nMethod \u2018Document\u2019 of object \u2018IWebBrowser2\u2019 failed</p>\n\n<p>by sample code is:</p>\n\n<pre><code>Dim ie As Object\n    Set ie = CreateObject(\"Internetexplorer.Application\")\n    ie.Visible = True\n    ie.Navigate *Link*\n\n    ie.document.getElementById(\"BUTTON_TOOLBAR_STANDARD_btn7_acButton \").Click\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1467804578, "post_id": 38222798, "comment_id": 63867882, "body": "Could you explain what the input string is like and what you want out?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1467804624, "post_id": 38222798, "comment_id": 63867911, "body": "formula wise, you can use SUBSTITUTE and FIND/SEARCH to assist"}, {"owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467804707, "post_id": 38222798, "comment_id": 63867952, "body": "Input string is a bibliographic reference (hypothetical example used here) and the desired output is the title &quot;Increased levels of nudity across Westeros contributes to its sporadic seasonal climate.&quot; in this case"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1467805056, "post_id": 38222798, "comment_id": 63868151, "body": "You need to explain what the strings look like in more detail. The problem with splitting on &quot;.&quot; is that there are (in general) a variable number of periods before the title and a variable number of periods after the title. A robust solution would probably require a list of permissible journal abbreviations."}], "answers": [{"comments": [{"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 2, "creation_date": 1467805249, "post_id": 38223013, "comment_id": 63868263, "body": "Beat me to it! To OP: it should be noted that Split should be used with some caution.  It is important that you are certain that the data being &quot;split&quot; is properly delimited by the chosen character and that that delimiter is not used elsewhere in the text.  If the title, for example, featured a &quot;.&quot; for a shortening, it would be split along that period.  Clever workarounds include splitting with a period and a comma, or setting up your data to use an irregular set of characters as delimeters initially (to be certain it won&#39;t show up organically in the data)"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1467805315, "post_id": 38223013, "comment_id": 63868300, "body": "That is a reasonable heuristic, though short article names are not unheard of. It is definitely possible to have the title of an article be shorter than the name of one of the contributors. A more serious problem is that titles themselves often contain embedded periods. Still a good idea, so +1"}, {"owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "edited": false, "score": 1, "creation_date": 1467806010, "post_id": 38223013, "comment_id": 63868660, "body": "Thanks everyone. Yes, this does work perfectly. Short titles and those with &quot;.&quot; in the middle of it will fall through, so these will need to be checked manually. This is definitely a great starting point. Thanks a million!"}, {"owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "edited": false, "score": 0, "creation_date": 1467808962, "post_id": 38223013, "comment_id": 63870487, "body": "Can you elaborate a little on the logic behind the line <code>If Len(arr(l_counter)) &gt; Len(ExtractText) Then</code>? How can the length of the <code>Split</code> output ever be longer than the ExtractText?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "edited": false, "score": 1, "creation_date": 1467809164, "post_id": 38223013, "comment_id": 63870601, "body": "@user1996971 write &gt;Debug.Print ExtractText&lt; before the if and you will see yourself. ExtractText is the string function itself, but it is used as a variable as well."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 6, "last_activity_date": 1467806227, "last_edit_date": 1467806227, "creation_date": 1467804818, "answer_id": 38223013, "question_id": 38222798, "link": "https://stackoverflow.com/questions/38222798/extracting-text-from-string-between-two-identical-characters-using-vba/38223013#38223013", "title": "Extracting text from string between two identical characters using VBA", "body": "<p>Here you go, it works exactly as you wish. Judging from your code I am sure that you can adapt it for your needs quite quickly:</p>\n\n<pre><code>Option Explicit\n\nSub ExtractTextSub()\n\n    Debug.Print ExtractText(\"E. Stark, T. Lannister, A. Martell, P Baelish, B. Dondarrion, and J. Mormont. Increased levels of nudity across Westeros contributes to its sporadic seasonal climate. Nat. Proc. Aca. Sci. (2011) 3: 142-149.\")\n\nEnd Sub\n\nPublic Function ExtractText(str_text As String) As String\n\n    Dim arr         As Variant\n    Dim l_counter   As Long\n    arr = Split(str_text, \".\")\n\n    For l_counter = LBound(arr) To UBound(arr)\n\n        If Len(arr(l_counter)) &gt; 50 Then\n            ExtractText = arr(l_counter)\n        End If\n\n    Next l_counter\n\nEnd Function\n</code></pre>\n\n<p>Edit: 5 votes in no time made me improve my code a bit :) This would return the longest string, without thinking of the 50 chars. Furthermore, on Error handlaer and a constant for the point. Plus adding a point to the end of the extract.</p>\n\n<pre><code>Option Explicit\n\nPublic Const STR_POINT = \".\"\n\nSub ExtractTextSub()\n\n    Debug.Print ExtractText(\"E. Stark, T. Lannister, A. Martell, P Baelish, B. Dondarrion, and J. Mormont. Increased levels of nudity across Westeros contributes to its sporadic seasonal climate. Nat. Proc. Aca. Sci. (2011) 3: 142-149.\")\n\nEnd Sub\n\nPublic Function ExtractText(str_text As String) As String\n\n    On Error GoTo ExtractText_Error\n\n    Dim arr             As Variant\n    Dim l_counter       As Long\n    Dim str_longest     As String\n\n    arr = Split(str_text, STR_POINT)\n\n    For l_counter = LBound(arr) To UBound(arr)\n\n        If Len(arr(l_counter)) &gt; Len(ExtractText) Then\n            ExtractText = arr(l_counter)\n        End If\n\n    Next l_counter\n\nExtractText = ExtractText &amp; STR_POINT\n\nOn Error GoTo 0\nExit Function\n\nExtractText_Error:\n\nMsgBox \"Error \" &amp; Err.Number &amp; Err.Description \n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3764, "favorite_count": 0, "accepted_answer_id": 38223013, "answer_count": 1, "score": 1, "last_activity_date": 1518630562, "creation_date": 1467804098, "last_edit_date": 1518630562, "question_id": 38222798, "link": "https://stackoverflow.com/questions/38222798/extracting-text-from-string-between-two-identical-characters-using-vba", "title": "Extracting text from string between two identical characters using VBA", "body": "<p>Let's say I have the following string within a cell:</p>\n\n<p>E. Stark, T. Lannister, A. Martell, P Baelish, B. Dondarrion, and J. Mormont. Increased levels of nudity across Westeros contributes to its sporadic seasonal climate. Nat. Proc. Aca. Sci. (2011) 3: 142-149.</p>\n\n<p>And I want to extract only the title from this. The approach I am considering is to write a script that says \"Pull text from this string, but only if it is more than 50 characters long.\" This way it only returns the title, and not stuff like \" Stark, T\" and \" Martell, P\". The code I have so far is:</p>\n\n<pre><code>Sub TitleTest()\n    Dim txt As String\n    Dim Output As String\n    Dim i As Integer\n    Dim rng As Range\n    Dim j As Integer\n    Dim k As Integer\n\n    j = 5\n    Set rng = Range(\"A\" &amp; j) 'text is in cell A5\n    txt = rng.Value 'txt is string\n    i = 1\n\n    While j &lt;= 10 'there are five references between A5 and A10\n    k = InStr(i, txt, \".\") - InStr(i, txt, \". \") + 1 'k is supposed to be the length of the string returned, but I can't differenciate one \".\" from the other.\n\n    Output = Mid(txt, InStr(i, txt, \".\"), k)\n            If Len(Output) &lt; 100 Then\n                i = i + 1\n            ElseIf Len(Output) &gt; 10 Then\n                Output = Mid(txt, InStr(i, txt, \".\"), InStr(i, txt, \". \"))\n                Range(\"B5\") = Output\n                j = j + 1\n            End If\n    Wend\nEnd Sub\n</code></pre>\n\n<p>Of course, this would work well if it wasn't two \".\" I was trying to full information from. Is there a way to write the <code>InStr</code> function in such a way that it won't find the same character twice? Am I going about this in the wrong way?</p>\n\n<p>Thanks in advance,</p>\n\n<p>EDIT: Another approach that might work (if possible), is if I could have one character be \" <code>any lower case letter</code>.\" and \".\". Would even this be possible? I can't find any example of how this could be achieved...</p>\n"}, {"tags": ["vba", "checkbox", "userform"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467802308, "post_id": 38222222, "comment_id": 63866536, "body": "Hi, how proficient are you in VBA?  Does the original form stay open?"}, {"owner": {"reputation": 2342, "user_id": 6283475, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/s6Dic.jpg?s=128&g=1", "display_name": "KyloRen", "link": "https://stackoverflow.com/users/6283475/kyloren"}, "edited": false, "score": 0, "creation_date": 1467802758, "post_id": 38222222, "comment_id": 63866808, "body": "You will need global variables if the forms are not opened at the same time."}, {"owner": {"reputation": 451, "user_id": 6130153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ri5O0.jpg?s=128&g=1", "display_name": "paul frith", "link": "https://stackoverflow.com/users/6130153/paul-frith"}, "edited": false, "score": 0, "creation_date": 1467803947, "post_id": 38222222, "comment_id": 63867553, "body": "Yes The forms are open at the same time - though I use hide commands"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1467804101, "post_id": 38222222, "comment_id": 63867624, "body": "Can you reference form to form frm2.control.value=frm1.control.value?"}], "answers": [{"comments": [{"owner": {"reputation": 451, "user_id": 6130153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ri5O0.jpg?s=128&g=1", "display_name": "paul frith", "link": "https://stackoverflow.com/users/6130153/paul-frith"}, "edited": false, "score": 0, "creation_date": 1467807190, "post_id": 38222747, "comment_id": 63869365, "body": "Great that makes perfect sense. So this gets resolved by using &quot;Set c = BusinessRules.Controls(nm)&quot;"}], "tags": [], "owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "is_accepted": true, "score": 1, "last_activity_date": 1467803886, "creation_date": 1467803886, "answer_id": 38222747, "question_id": 38222222, "link": "https://stackoverflow.com/questions/38222222/setting-checkboxes-from-another-userform-in-vba/38222747#38222747", "title": "Setting CheckBoxes from another userform in VBA", "body": "<p>I think the <code>BusinessRules</code> is giving you the issue.  In the Controls collection, there is no Control named <code>\"BusinessRules.CheckBox1\"</code>, only one named <code>\"CheckBox1\"</code> within the <code>BusinessRules.Controls</code> collection.  Assuming there aren't other issues mentioned in the comments above (like the form being closed before this is called), then this should fix your issue</p>\n"}], "owner": {"reputation": 451, "user_id": 6130153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ri5O0.jpg?s=128&g=1", "display_name": "paul frith", "link": "https://stackoverflow.com/users/6130153/paul-frith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 38222747, "answer_count": 1, "score": 0, "last_activity_date": 1467803886, "creation_date": 1467802250, "question_id": 38222222, "link": "https://stackoverflow.com/questions/38222222/setting-checkboxes-from-another-userform-in-vba", "title": "Setting CheckBoxes from another userform in VBA", "body": "<p>I have a userform which contains a number of checkboxes from 1 to 100. I have written some very simple code so that when you submit the form it creates a binary string that represents the state of those 100 checkboxes, where 0 is false and 1 is true. The code to do this is here:</p>\n\n<pre><code>Private Sub BusRulesSubmit_Click()\n Dim myBinaryString As String\n Dim nm As String\n Dim c As Control\n\n For busRuleIdx = 1 To 100\n  nm = \"CheckBox\" &amp; busRuleIdx\n  Set c = Controls(nm)\n  If c.Value = True Then\n   myBinaryString = myBinaryString &amp; \"1\"\n  Else\n   myBinaryString = myBinaryString &amp; \"0\"\n  End If\n Next\n\n msgBox myBinaryString\nEnd Sub\n</code></pre>\n\n<p>I now want to open this Userform from another form, where I have a similar binary string, and use this string to set the values of the checkboxes to true or false as appropariate. However I am having issues when setting my control. The code is here:</p>\n\n<pre><code>Private Sub populateBusRules()\n Dim c As Control\n Dim myBRBinary As String\n myBRBinary =    \"000000000011100000000000000000000000000000000000000000000000000000000010000000000000000000000000000\"\n\n For busRuleIdx = 1 To 100\n  nm = \"BusinessRules.CheckBox\" &amp; busRuleIdx\n  Set c = Controls(nm)\n  If Mid(myBRBinary, buRuleIdx - 1, 1) = 1 Then\n   c.Value = True\n  Else\n   c.Value = False\n  End If\n Next\nEnd Sub\n</code></pre>\n\n<p>When I run the above, I get a runtime error \"Could not find the specified object\" and when going to debug it highlights this problem where the code states \"Set c = Controls(nm)\" - and I can see that it is failing in the first round of the loop i.e. where nm = \"BusinessRules.CheckBox1\"</p>\n\n<p>Interestingly if I run the code \"Set c = Controls(BusinessRules.CheckBox1)\" I get no such issue.</p>\n\n<p>Any help would be much appreciated.</p>\n\n<p>Thanks,</p>\n\n<p>Paul.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "edited": false, "score": 0, "creation_date": 1467803125, "post_id": 38222198, "comment_id": 63867019, "body": "I am not sure to understand what you want: return the table&#39;s name, return the cell&#39;s value or find out if the cell is in the table. Could you develop?"}, {"owner": {"reputation": 35, "user_id": 5112981, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7ae8cab1b5f2f90ae969d4668e3bf65d?s=128&d=identicon&r=PG&f=1", "display_name": "StumpedObject", "link": "https://stackoverflow.com/users/5112981/stumpedobject"}, "reply_to_user": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "edited": false, "score": 0, "creation_date": 1467831244, "post_id": 38222198, "comment_id": 63884936, "body": "Thank you for your interest Remi, what I am trying to do is stack tables created from a pivot-table &quot;double-click&quot; and integrate them into a single table, by identifying the tables identity I can remove its table status and then integrate it in to the growing upper table stack"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 5112981, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7ae8cab1b5f2f90ae969d4668e3bf65d?s=128&d=identicon&r=PG&f=1", "display_name": "StumpedObject", "link": "https://stackoverflow.com/users/5112981/stumpedobject"}, "edited": false, "score": 0, "creation_date": 1467831928, "post_id": 38223055, "comment_id": 63885366, "body": "Thanks Darren your method works well, I am fairly new to the list object in Excel but not in Access so I am often a bit startled with its use.  I tried both in the immediate window (.Name vs .DisplayName) and they both worked.  Moreover I also appreciate you explaining the indexing function pattern for ?ActiveSheet.ListObjects(2) and have tried it just now with 1, 2, and 3 on one of my table stacks: this is very powerful given that it does not depend on the specific coordinate of the active cell, thank you again."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 4, "last_activity_date": 1467804929, "creation_date": 1467804929, "answer_id": 38223055, "question_id": 38222198, "link": "https://stackoverflow.com/questions/38222198/using-vba-to-return-the-table-name-corresponding-to-a-given-activecell-selection/38223055#38223055", "title": "Using VBA to return the Table Name corresponding to a given ActiveCell Selection", "body": "<p>These return the name of the table of the selected cell.  If there is no table then a run-time error is thrown.</p>\n\n<pre><code>Selection.ListObject.Name\nSelection.ListObject.DisplayName\n</code></pre>\n\n<p>You can avoid the error using:</p>\n\n<pre><code>If Not Selection.ListObject Is Nothing Then\n    MsgBox Selection.ListObject.Name\nEnd If\n</code></pre>\n\n<p><code>?ActiveSheet.ListObjects(2)</code> will give the name of the second table on a sheet and throw an error if there is no second table.</p>\n"}], "owner": {"reputation": 35, "user_id": 5112981, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7ae8cab1b5f2f90ae969d4668e3bf65d?s=128&d=identicon&r=PG&f=1", "display_name": "StumpedObject", "link": "https://stackoverflow.com/users/5112981/stumpedobject"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2497, "favorite_count": 0, "accepted_answer_id": 38223055, "answer_count": 1, "score": 0, "last_activity_date": 1467804929, "creation_date": 1467802181, "last_edit_date": 1531164843, "question_id": 38222198, "link": "https://stackoverflow.com/questions/38222198/using-vba-to-return-the-table-name-corresponding-to-a-given-activecell-selection", "title": "Using VBA to return the Table Name corresponding to a given ActiveCell Selection", "body": "<p>For a given ActiveCell in Excel how can VBA return the Table Name that appears in the properties grouping that becomes visible when the Table Tools Design tab is activated. So for example in the immediate window:</p>\n\n<pre><code>?ActiveSheet.ListObjects(2)\n\n Table3600\n</code></pre>\n\n<p>but if I select a cell (potentially within a table) I can't seem to find a property that will either return the selected cell's containing table's name. I am trying to either store the return value or to state that the current cell is not in a table.</p>\n\n<p>TIA (This seems very fundamental yet I am nowhere)</p>\n"}, {"tags": ["excel", "macros", "vba"], "comments": [{"owner": {"reputation": 123, "user_id": 6370467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9778aeec18a9b296a9f8c4da6cc9041?s=128&d=identicon&r=PG&f=1", "display_name": "V. Wolf", "link": "https://stackoverflow.com/users/6370467/v-wolf"}, "edited": false, "score": 0, "creation_date": 1467801855, "post_id": 38221960, "comment_id": 63866289, "body": "In VBA there is a decent debug mechanism. You should try by just hitting F5 and have a look. Btw, your <code>for</code> Loop needs an <code>Next i</code> at the end."}, {"owner": {"reputation": 794, "user_id": 4469565, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-QtInUewVqDU/AAAAAAAAAAI/AAAAAAAAASY/JELdhXXcbOA/photo.jpg?sz=128", "display_name": "Joey", "link": "https://stackoverflow.com/users/4469565/joey"}, "reply_to_user": {"reputation": 123, "user_id": 6370467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9778aeec18a9b296a9f8c4da6cc9041?s=128&d=identicon&r=PG&f=1", "display_name": "V. Wolf", "link": "https://stackoverflow.com/users/6370467/v-wolf"}, "edited": false, "score": 0, "creation_date": 1467802027, "post_id": 38221960, "comment_id": 63866381, "body": "The problem is I don&#39;t know how to link the second macro file location prompt with the file location in the code. Is this even possible?"}], "answers": [{"tags": [], "owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "is_accepted": true, "score": 0, "last_activity_date": 1467802627, "creation_date": 1467802627, "answer_id": 38222336, "question_id": 38221960, "link": "https://stackoverflow.com/questions/38221960/running-macros-in-a-macro-in-excel/38222336#38222336", "title": "Running macros in a macro in excel", "body": "<p>Assuming that your macros look something like this:</p>\n\n<pre><code>Private Sub Macro1()\n    ' Prompt for location\n    ' Do stuff\nEnd Sub\n</code></pre>\n\n<p>You could refactor this to:</p>\n\n<pre><code>Private Sub Macro1(Optional location As String = \"\")\n    ' Test whether location was specified, and prompt for it if not\n    ' Do stuff\nEnd Sub\n</code></pre>\n\n<p>That way, you can loop through a list of locations and pass each one as a parameter, while still leaving the macro usable without this information.</p>\n"}], "owner": {"reputation": 794, "user_id": 4469565, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-QtInUewVqDU/AAAAAAAAAAI/AAAAAAAAASY/JELdhXXcbOA/photo.jpg?sz=128", "display_name": "Joey", "link": "https://stackoverflow.com/users/4469565/joey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 38222336, "answer_count": 1, "score": 0, "last_activity_date": 1467802627, "creation_date": 1467801409, "last_edit_date": 1531161705, "question_id": 38221960, "link": "https://stackoverflow.com/questions/38221960/running-macros-in-a-macro-in-excel", "title": "Running macros in a macro in excel", "body": "<p>I'm trying to write a macro that runs 2 other macros. However, the second macro requires you to select the location of the file where the data is. Is there a way of running the second macro 10 times for 10 different file locations. In summary, I would have 10 loops with both macros.</p>\n\n<p>Some along the lines of the following sudo code:</p>\n\n<pre><code>file_loc = ('c:/users/desktop/....sim1.csv','c:/users/desktop/....sim2.csv'..'sim3'...sim10')\n\nfor i in range (10): \n    Run Macro1 \n    wait for calculation \n\n    Run Macro2\n    file = file_loc(i)\n    wait for calculation \n\n    copy cell A10 (result) to AZ(i)\n    next i\n</code></pre>\n\n<p>is this a possibility in VBA? </p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1467808949, "post_id": 38221860, "comment_id": 63870479, "body": "Did you try anything else besides copy&amp;pasting the code from that question?"}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1467809182, "post_id": 38221860, "comment_id": 63870621, "body": "You should take a look at this for working with a shared mailbox <a href=\"http://www.slipstick.com/developer/code-samples/use-macro-assign-messages-shared-mailbox/\" rel=\"nofollow noreferrer\">slipstick.com/developer/code-samples/&hellip;</a>"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1467868092, "post_id": 38221860, "comment_id": 63896791, "body": "Can you post the script you are trying to run?"}, {"owner": {"reputation": 13, "user_id": 6555706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570e808592a16d6afe3150e14ff726ef?s=128&d=identicon&r=PG&f=1", "display_name": "AkAntA", "link": "https://stackoverflow.com/users/6555706/akanta"}, "reply_to_user": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1467952321, "post_id": 38221860, "comment_id": 63938372, "body": "@Tom yes I have tried some IF statements with GetNameSpace method but I think that&#39;s not a way to go."}, {"owner": {"reputation": 13, "user_id": 6555706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570e808592a16d6afe3150e14ff726ef?s=128&d=identicon&r=PG&f=1", "display_name": "AkAntA", "link": "https://stackoverflow.com/users/6555706/akanta"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1467952573, "post_id": 38221860, "comment_id": 63938441, "body": "@Om3r my script is at the moment basically the same as in the mentioned question but in the &#39;your code&#39; part I just call other sub with the desired function. I get my script work in every mailbox but I want it to work only in shared ones."}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1467961767, "post_id": 38221860, "comment_id": 63941702, "body": "This is what you are looking for: <a href=\"https://msdn.microsoft.com/us-en/library/office/ff868990.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/us-en/library/office/ff868990.aspx</a>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6555706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570e808592a16d6afe3150e14ff726ef?s=128&d=identicon&r=PG&f=1", "display_name": "AkAntA", "link": "https://stackoverflow.com/users/6555706/akanta"}, "edited": false, "score": 0, "creation_date": 1467967687, "post_id": 38261415, "comment_id": 63944742, "body": "Thank you! That solved my problem. And thanks to @hstay also."}], "tags": [], "owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1467963885, "last_edit_date": 1495541690, "creation_date": 1467963885, "answer_id": 38261415, "question_id": 38221860, "link": "https://stackoverflow.com/questions/38221860/running-a-script-in-shared-mailbox-only-when-opening-a-mail/38261415#38261415", "title": "Running a script in shared mailbox only when opening a mail", "body": "<p>Okay, I found an even easier way to do this (this is mostly code from the question linked to, in the OP)</p>\n\n<pre><code>Public WithEvents myItem As Outlook.MailItem\nPublic EventsDisable As Boolean\n\n\n\nPrivate Sub Application_ItemLoad(ByVal Item As Object)\n    If EventsDisable = True Then Exit Sub\n    If Item.Class = olMail Then\n        Set myItem = Item\n    End If\nEnd Sub\n\n\nPrivate Sub myItem_Open(Cancel As Boolean)\n    EventsDisable = True\n    'this is the new part\n    If myItem.Parent = \"NAMEOFYOURSHAREDINBOX\" Then\n        'your code here\n    End If\n    EventsDisable = False\nEnd Sub\n</code></pre>\n\n<p>Mostly credits to <a href=\"https://stackoverflow.com/users/3218398/hstay\">hstay</a></p>\n\n<p>HTH</p>\n"}], "owner": {"reputation": 13, "user_id": 6555706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570e808592a16d6afe3150e14ff726ef?s=128&d=identicon&r=PG&f=1", "display_name": "AkAntA", "link": "https://stackoverflow.com/users/6555706/akanta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 38261415, "answer_count": 1, "score": 1, "last_activity_date": 1593468392, "creation_date": 1467801086, "last_edit_date": 1593468392, "question_id": 38221860, "link": "https://stackoverflow.com/questions/38221860/running-a-script-in-shared-mailbox-only-when-opening-a-mail", "title": "Running a script in shared mailbox only when opening a mail", "body": "<p>I have tried to find answer to my question from all over the web.\nSince I don't have so much experience from outlook-vba I decided to ask here.</p>\n\n<p>What I'm trying to do is to run a script when user opens a mail. Also I need to run this script only in shared mailboxes not in users own box.</p>\n\n<p>I've used the code found in users <a href=\"https://stackoverflow.com/questions/21727768/rule-that-runs-macro-when-an-email-is-opened\">@ZZA question # 21727768</a> but it has that little annoyance with creating a mail and replying to one also (it runs the script in these cases also). It is helpful but I haven't found a way to apply that code only to cases where user is opening a mail from shared mailbox.</p>\n\n<p>Any help here?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "macros", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5417821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7285672a50c5853cfeebb67441f85162?s=128&d=identicon&r=PG&f=1", "display_name": "Alain", "link": "https://stackoverflow.com/users/5417821/alain"}, "edited": false, "score": 1, "creation_date": 1467890239, "post_id": 38227105, "comment_id": 63909038, "body": "I just found out that you CAN use a macro with parameters. The issue was that the list of macros shown when you click on the &quot;Macro&#39;s&quot; button does not contain these subroutines with paramers. When you click the Visual Basic button you can see the code of ALL subroutine."}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1467816721, "creation_date": 1467816721, "answer_id": 38227105, "question_id": 38221286, "link": "https://stackoverflow.com/questions/38221286/vba-powerpoint-how-to-know-which-shape-is-clicked-during-a-presentation/38227105#38227105", "title": "VBA Powerpoint How to know which shape is clicked during a presentation", "body": "<p>This still works in PPT 2013 and later but only for Public subroutines.  When you assign a macro as an action setting, you won't see any Private subroutines or any subs at all in modules that are private (ie, that have Option Private Module at the start).</p>\n"}], "owner": {"reputation": 33, "user_id": 5417821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7285672a50c5853cfeebb67441f85162?s=128&d=identicon&r=PG&f=1", "display_name": "Alain", "link": "https://stackoverflow.com/users/5417821/alain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1467816721, "creation_date": 1467799320, "last_edit_date": 1467799648, "question_id": 38221286, "link": "https://stackoverflow.com/questions/38221286/vba-powerpoint-how-to-know-which-shape-is-clicked-during-a-presentation", "title": "VBA Powerpoint How to know which shape is clicked during a presentation", "body": "<p>In Powerpoint you can link a command button to a macro.</p>\n\n<p>But in Powerpoint 2013 such a macro cannot have parameters;\nIn the popup list to link the button to a macro only subroutines without parameters are visible.</p>\n\n<p>(in previous versions of powerpoint it was possible to link the button to something like \nSub DoSomethingTo(oSh as Shape) where oSh was the shape that was clicked)</p>\n\n<p>In the subroutine (macro) I want to know which shape was clicked.</p>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1467797041, "post_id": 38220251, "comment_id": 63863496, "body": "Actually your first piece of code says <code>Sheet3.Range(&quot;B14&quot;).Value</code> so you put this into <code>B14</code> instead of <code>B4</code>"}, {"owner": {"reputation": 1, "user_id": 6555325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/594a88a6878f0a6b94b99cea24c46c81?s=128&d=identicon&r=PG&f=1", "display_name": "kckckc", "link": "https://stackoverflow.com/users/6555325/kckckc"}, "reply_to_user": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1467797151, "post_id": 38220251, "comment_id": 63863557, "body": "Ah my bad, typo. I want it to be at B14."}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 1, "creation_date": 1467797487, "post_id": 38220251, "comment_id": 63863750, "body": "The code seems fine to me. Maaaaybee the <code>Application.IfError</code> + the <code>Application.VLookup</code> (as in using the <code>Application</code> object twice in the same command) causes the error, but I wouldn&#39;t know why. As a workaround I would suggest running the <code>VLOOKUP</code> without the <code>IFERROR</code> and check for erros afterwards."}, {"owner": {"reputation": 1, "user_id": 6555325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/594a88a6878f0a6b94b99cea24c46c81?s=128&d=identicon&r=PG&f=1", "display_name": "kckckc", "link": "https://stackoverflow.com/users/6555325/kckckc"}, "reply_to_user": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1467798293, "post_id": 38220251, "comment_id": 63864220, "body": "Hmm that&#39;s weird though, because in other cells I&#39;m calling the same command but just gathering data from another column instead of column 9, and it is working. I&#39;ll keep troubleshooting and update the post here. thanks for the suggestion though, appreciate it"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1467820051, "post_id": 38220251, "comment_id": 63878303, "body": "Perhaps it is something related with the value expected to be returned. Would you tell us what&#39;s the value that should be returned from column 9. Somehow it seems that the <code>VLookup</code> is returning the correct value but value in column 9 is seen as an error by the <code>IfError</code> function."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6555325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/594a88a6878f0a6b94b99cea24c46c81?s=128&d=identicon&r=PG&f=1", "display_name": "kckckc", "link": "https://stackoverflow.com/users/6555325/kckckc"}, "edited": false, "score": 0, "creation_date": 1467798316, "post_id": 38220694, "comment_id": 63864238, "body": "Hmm, that could be an alternative! Thanks! I still wanna figure out why it isn&#39;t working though.."}], "tags": [], "owner": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "is_accepted": false, "score": 0, "last_activity_date": 1467797553, "creation_date": 1467797553, "answer_id": 38220694, "question_id": 38220251, "link": "https://stackoverflow.com/questions/38220251/calling-iferror-with-vlookup-in-vba-returns-error-even-though-cell-formula-retur/38220694#38220694", "title": "Calling IfError with vLookUp in VBA returns error even though cell formula returns value", "body": "<p>You could do without <code>IfError</code> and do an <code>if statement</code> after your <code>Vlookup</code> instead:</p>\n\n<pre><code>x = Application.VLookup(Sheet3.Range(\"B4\"), Sheet2.Range(\"D5:CU530\"), 9, False)\n\nIf IsError(x) Then\n    Sheet3.Range(\"B14\").Value = \"Not found\"\nElse\n    Sheet3.Range(\"B14\").Value = x\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "is_accepted": false, "score": -1, "last_activity_date": 1467798716, "creation_date": 1467798716, "answer_id": 38221099, "question_id": 38220251, "link": "https://stackoverflow.com/questions/38220251/calling-iferror-with-vlookup-in-vba-returns-error-even-though-cell-formula-retur/38221099#38221099", "title": "Calling IfError with vLookUp in VBA returns error even though cell formula returns value", "body": "<p>use on error funtion</p>\n\n<pre><code>On Error Resume Next\n\nws.Range(\"B14\").Value = Application.WorksheetFunction.IfError(Application.WorksheetFunction.VLookup(ws.Range(\"B2\").Value, ws.Range(\"E:F\"), 1, False), \"No error\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 324, "user_id": 6527224, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xcexG.jpg?s=128&g=1", "display_name": "dyslexicgruffalo", "link": "https://stackoverflow.com/users/6527224/dyslexicgruffalo"}, "is_accepted": false, "score": 0, "last_activity_date": 1467904431, "creation_date": 1467904431, "answer_id": 38249175, "question_id": 38220251, "link": "https://stackoverflow.com/questions/38220251/calling-iferror-with-vlookup-in-vba-returns-error-even-though-cell-formula-retur/38249175#38249175", "title": "Calling IfError with vLookUp in VBA returns error even though cell formula returns value", "body": "<p>I believe the error may lie in the vlookup section, vlookup as a much older section of code (i.e. an older version of VB) and where you can, I would really encourage the use of an index match combo, as it is much more specific in what you look for (and more efficient)!</p>\n\n<p>Here is a link to information on Index</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff197581.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff197581.aspx</a></p>\n\n<p>and Match</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff835873.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff835873.aspx</a></p>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 1, "user_id": 6555325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/594a88a6878f0a6b94b99cea24c46c81?s=128&d=identicon&r=PG&f=1", "display_name": "kckckc", "link": "https://stackoverflow.com/users/6555325/kckckc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1486, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1467904431, "creation_date": 1467796289, "last_edit_date": 1467797133, "question_id": 38220251, "link": "https://stackoverflow.com/questions/38220251/calling-iferror-with-vlookup-in-vba-returns-error-even-though-cell-formula-retur", "title": "Calling IfError with vLookUp in VBA returns error even though cell formula returns value", "body": "<p>I'm using <code>ifError</code> coupled with <code>vLookUp</code> to look for values in a large table and pull out a value from a specific column to be placed in a specific cell in another worksheet.</p>\n\n<p>This is my current code for drawing value from column no 9 starting from column D, to be placed into another worksheet's cell B14.</p>\n\n<pre><code>Sheet3.Range(\"B14\").Value = Application.IfError(Application.VLookup(Sheet3.Range(\"B4\"), Sheet2.Range(\"D5:CU530\"), 9, False), \"Not Found\")\n</code></pre>\n\n<p>This code returns \"Not Found\" for me. </p>\n\n<p>Further testing using the similar formula but placed directly into a random cell returns the true value. Below is the formula used. </p>\n\n<pre><code>=IFERROR(VLOOKUP(B4,'Sheet 2 Name'!D5:CU530,9,FALSE),\"Not Found\")\n</code></pre>\n\n<p>The same vba code (as shown in first block quote) used for other columns (eg column 2/3/4) are returning the true value instead of \"Not Found\", even when the destination cell is Sheet 3's B14.</p>\n\n<p>Any ideas why?</p>\n\n<p>Edit: More information\nIf I were to use vLookUp alone in VBA (see next code), I can get the true value, but I will need the IfError as there will be situations where no value are found. </p>\n\n<pre><code> Application.VLookup(Sheet3.Range(\"B4\"), Sheet2.Range(\"D5:CU530\"), 9, False)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 2, "creation_date": 1467795678, "post_id": 38219893, "comment_id": 63862785, "body": "Welcome to SO where everythings made up and the points don&#39;t matter.  Please post code you have attempted, as this is not a &quot;get-free-code&quot; site"}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 6370309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7105d99cd54c0e47803d8434775f6cfa?s=128&d=identicon&r=PG&f=1", "display_name": "Norby", "link": "https://stackoverflow.com/users/6370309/norby"}, "edited": false, "score": 0, "creation_date": 1467796285, "post_id": 38220129, "comment_id": 63863104, "body": "Concatenate is only for strings, and unfortunetly I need to have first column :( so my code should works like if letter is found in next column next to data merge them."}, {"owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "reply_to_user": {"reputation": 149, "user_id": 6370309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7105d99cd54c0e47803d8434775f6cfa?s=128&d=identicon&r=PG&f=1", "display_name": "Norby", "link": "https://stackoverflow.com/users/6370309/norby"}, "edited": false, "score": 0, "creation_date": 1467796645, "post_id": 38220129, "comment_id": 63863284, "body": "So solve by making it be text: =CONCATENATE(IF(ISNUMBER(B1),TEXT(B1,0),B1),IF(ISNUMBER(C1),&zwnj;&#8203;TEXT(C1,0),C1),IF(IS&zwnj;&#8203;NUMBER(D1),TEXT(D1,0&zwnj;&#8203;),D1))"}], "tags": [], "owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "is_accepted": false, "score": 0, "last_activity_date": 1467795959, "creation_date": 1467795959, "answer_id": 38220129, "question_id": 38219893, "link": "https://stackoverflow.com/questions/38219893/flexible-merge-two-columns-in-one/38220129#38220129", "title": "Flexible Merge - two columns in one", "body": "<p>Not 100% sure what your end goal is but could you not add a new column on the left and make it's formula be CONCATENATE(A1:E1) and make it go as far down the sheet as you need it?</p>\n\n<p>Then if you need to afterwards you could copy paste values that column and delete the others.</p>\n\n<p>All fairly quick to do even if recording in excel.\nDo you want to give that a go and post back if you get stuck?</p>\n"}, {"tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": false, "score": 0, "last_activity_date": 1467796474, "creation_date": 1467796474, "answer_id": 38220315, "question_id": 38219893, "link": "https://stackoverflow.com/questions/38219893/flexible-merge-two-columns-in-one/38220315#38220315", "title": "Flexible Merge - two columns in one", "body": "<p>Here is a Function that merges 2 Columns together:</p>\n\n<pre><code>Function mergeColumns(mergeColumn As Integer)\n\nDim i As Integer\n\n'Adjust startvalue(1)\nFor i = 1 To ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row Step 1\n\n    'Combine mergeColumn and Column next to it\n    Cells(i, mergeColumn).Value = Cells(i, mergeColumn).Value &amp; Cells(i, mergeColumn + 1).Value\n\n    'Clear the Content of the Cell next to Mergecolumn\n    Cells(i, mergeColumn + 1).Value = \"\"\nNext i\nEnd Function\n</code></pre>\n\n<p>Lets say you want to merge column A and B, the call would be <code>mergeColumns 1</code></p>\n\n<p>Now work out a routine to find the right columns to merge.</p>\n"}, {"comments": [{"owner": {"reputation": 149, "user_id": 6370309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7105d99cd54c0e47803d8434775f6cfa?s=128&d=identicon&r=PG&f=1", "display_name": "Norby", "link": "https://stackoverflow.com/users/6370309/norby"}, "edited": false, "score": 0, "creation_date": 1467797803, "post_id": 38220469, "comment_id": 63863946, "body": "This looks as something that I need. I have an error on this line Set ws = wb.Worksheets(&quot;Sheet1&quot;), I have tried to change sheet name but is not working. Is there are option for absolut sheets? Becase macro should apply for all my sheets in excel? I asume for all other month for exampe July and August I just have to copy/paste to code below and change the month name? Thank so much for your effort."}, {"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "reply_to_user": {"reputation": 149, "user_id": 6370309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7105d99cd54c0e47803d8434775f6cfa?s=128&d=identicon&r=PG&f=1", "display_name": "Norby", "link": "https://stackoverflow.com/users/6370309/norby"}, "edited": false, "score": 0, "creation_date": 1467798335, "post_id": 38220469, "comment_id": 63864246, "body": "check your sheetname. and paste the macro where data is"}, {"owner": {"reputation": 149, "user_id": 6370309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7105d99cd54c0e47803d8434775f6cfa?s=128&d=identicon&r=PG&f=1", "display_name": "Norby", "link": "https://stackoverflow.com/users/6370309/norby"}, "edited": false, "score": 0, "creation_date": 1467799416, "post_id": 38220469, "comment_id": 63864929, "body": "Sorry you are right, its working good. How can I add more sheets and more columns?"}, {"owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "reply_to_user": {"reputation": 149, "user_id": 6370309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7105d99cd54c0e47803d8434775f6cfa?s=128&d=identicon&r=PG&f=1", "display_name": "Norby", "link": "https://stackoverflow.com/users/6370309/norby"}, "edited": false, "score": 0, "creation_date": 1467800402, "post_id": 38220469, "comment_id": 63865473, "body": "use other month just like may and june i have used or loop it"}], "tags": [], "owner": {"reputation": 1053, "user_id": 1901755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27c8f48304bc53fe67bbfcac8f4d2c75?s=128&d=identicon&r=PG", "display_name": "PASUMPON V N", "link": "https://stackoverflow.com/users/1901755/pasumpon-v-n"}, "is_accepted": true, "score": 0, "last_activity_date": 1467800329, "last_edit_date": 1467800329, "creation_date": 1467796904, "answer_id": 38220469, "question_id": 38219893, "link": "https://stackoverflow.com/questions/38219893/flexible-merge-two-columns-in-one/38220469#38220469", "title": "Flexible Merge - two columns in one", "body": "<p>I have attach code for your requirement, It will automatically search for May and June keyword and will perform concatenation for that particular columns alone.</p>\n\n<pre><code>Sub test()\nDim wb As Workbook\n\nSet wb = ThisWorkbook\nDim Ws As Worksheet\n\nDim monthss(12) As String\n\nmonthss(1) = \"May\"\nmonthss(2) = \"June\"\nmonthss(3) = \"August\"\n\n\n\n    For Each Ws In wb.Worksheets\n\n    For j = 1 To 3\n\nWith Ws.UsedRange\n    Set c = .Find(monthss(j), LookIn:=xlValues)\n    If Not c Is Nothing Then\n        firstrow = c.Row\n        firstcol = c.Column\n        End If\n    End With\n\n    Set c = Nothing\n  lastrow = Ws.Cells(Ws.Rows.Count, firstcol).End(xlUp).Row\n\n\n' For May Sheet\nIf firstrow &gt; 0 Then\n\n    For i = firstrow + 1 To lastrow\n           Ws.Cells(i, firstcol).Value = Ws.Cells(i, firstcol).Value &amp; Ws.Cells(i, firstcol + 1).Value\n    Next\n\nfirstrow = 0\nEnd If\n' for June Sheet\n\nNext j\n\nNext Ws\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 6370309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7105d99cd54c0e47803d8434775f6cfa?s=128&d=identicon&r=PG&f=1", "display_name": "Norby", "link": "https://stackoverflow.com/users/6370309/norby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 38220469, "answer_count": 3, "score": -2, "last_activity_date": 1467800329, "creation_date": 1467795189, "last_edit_date": 1531164843, "question_id": 38219893, "link": "https://stackoverflow.com/questions/38219893/flexible-merge-two-columns-in-one", "title": "Flexible Merge - two columns in one", "body": "<p>I have data in about 50 sheets and structure for all of them are same. Please find data structure in an example below, in column May will be data and in next column letter for example \"B\" or \"AB\". I want to merge those two columns in one, so my data shold looks like 236AB. My code should work for all columns in sheets, because in some sheets I have 5 columns and in another 25. Anybody can help me with this one? Thank so much!</p>\n\n<p><a href=\"https://i.stack.imgur.com/J54mY.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/J54mY.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "directory", "vba"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 1, "creation_date": 1467796695, "post_id": 38219808, "comment_id": 63863314, "body": "Do you experience an error using <code>GetFolder</code> ? Seems to work fine for me."}, {"owner": {"reputation": 1478, "user_id": 1084483, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/4b0c9c774430f2546b3f65b464209549?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1084483/andrew"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1467797505, "post_id": 38219808, "comment_id": 63863770, "body": "@Robin no error, it doesn&#39;t load any of the files that I want to process though. &#39;MsgBox &quot;StrFile = &quot; &amp; strFile&#39; shows empty. strDir takes value ok and the folder I pick is taken in but none of the files are converted to Excel."}], "answers": [{"comments": [{"owner": {"reputation": 1478, "user_id": 1084483, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/4b0c9c774430f2546b3f65b464209549?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1084483/andrew"}, "edited": false, "score": 0, "creation_date": 1467798598, "post_id": 38220782, "comment_id": 63864423, "body": "I just realised this while looking at it again that slash was missing from end of directory path so added that and it worked. Thanks though for the more eloquent code you have provided above @welgen. will add that in."}], "tags": [], "owner": {"reputation": 404, "user_id": 6445909, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ed5578df506ea24f73c59e8fc7fca753?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Welsch", "link": "https://stackoverflow.com/users/6445909/christian-welsch"}, "is_accepted": true, "score": 1, "last_activity_date": 1467797806, "creation_date": 1467797806, "answer_id": 38220782, "question_id": 38219808, "link": "https://stackoverflow.com/questions/38219808/using-getfolder-function-to-go-to-a-default-folder-then-select-sub-folder/38220782#38220782", "title": "Using getfolder function to go to a default folder then select sub-folder", "body": "<p>Try adding these lines after <code>strDir = strDirCapture</code>:</p>\n\n<pre><code>If Right(strDir, 1) &lt;&gt; \"\\\" Then\n    strDir = strDir &amp; \"\\\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1478, "user_id": 1084483, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/4b0c9c774430f2546b3f65b464209549?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1084483/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 911, "favorite_count": 0, "accepted_answer_id": 38220782, "answer_count": 1, "score": 0, "last_activity_date": 1467798226, "creation_date": 1467794938, "last_edit_date": 1531164843, "question_id": 38219808, "link": "https://stackoverflow.com/questions/38219808/using-getfolder-function-to-go-to-a-default-folder-then-select-sub-folder", "title": "Using getfolder function to go to a default folder then select sub-folder", "body": "<p>I had used some code I found on here to start trying to convert a big list of Excel CSV files to Excel 2003 format. In the process of converting I wanted to open a default location folder then navigate to the right sub-folder where the CSV files are, however when stepping through the code one of my variables will not populate. My code is below and the variable that won't populate is strDir.</p>\n\n<p>I'm wanting code to populate strDir with the default location + the folder that I pick, however I'm unsure what I need to do to this code to enable it to do that. </p>\n\n<p>Right now I only have the default location hard-coded and when code runs, this location opens. however when I pick the sub-folder how do I record that programatically?</p>\n\n<p>I know what I want to do but how to achieve this in VBA is my question.</p>\n\n<pre><code>Public Sub CSV_to_XLS()\n\n\nDim wb As Workbook\nDim strFile As String\nDim strDir As String\nDim strDirCapture As String\n\n'Set base directory for get folder to manipulate csv files\n\nstrDirCapture = GetFolder(\"\\\\DEVP-APPS-07\\File Storgae\\1_Pending\\\")\n\n'strDir = strDirCapture\nstrDir = strDirCapture &amp; \"\\\"\nstrFile = Dir(strDir &amp; \"*.csv\")\n\nMsgBox \"String directory path = \" &amp; strDirCapture\nMsgBox \"StrFile = \" &amp; strFile\n\nDo While strFile &lt;&gt; \"\"\n\n\n\n    'Set wb = Workbooks.Open(Filename:=strDir &amp; strFile, Local:=True)\n    'wb.SaveAs Replace(wb.FullName, \".csv\", \".xls\"), 56 'UPDATE:\n    wb.Close True\n\n    Set wb = Nothing\n    strFile = Dir\nLoop\n\nEnd Sub\n\n\nFunction GetFolder(strPath As String) As String\nDim fldr As FileDialog\nDim sItem As String\nSet fldr = Application.FileDialog(msoFileDialogFolderPicker)\nWith fldr\n    .Title = \"Select a Folder\"\n    .AllowMultiSelect = False\n    .InitialFileName = strPath\n    If .Show &lt;&gt; -1 Then GoTo NextCode\n    sItem = .SelectedItems(1)\nEnd With\nNextCode:\nGetFolder = sItem\nSet fldr = Nothing\nEnd Function\n</code></pre>\n\n<p>Many thanks</p>\n\n<p>Andrew</p>\n\n<p>Update adding slash \"\\\" to end of directory captured seems to have fixed this. Have altered code above to reflect this change.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 3, "creation_date": 1467794938, "post_id": 38219638, "comment_id": 63862368, "body": "just FYI, your code can be shortened a ton by placing your &quot;Dim&quot;s in one line.  Instead of <code>Dim range1 As Range</code> new line <code>Dim range2 As Range</code>, they all can be written as <code>Dim range1 As Range, range2 As Range</code>.  Important to note that you must always include the <code>As Range</code> (or whatever the object is), or that particular variable will be auto-declared as a Variant"}, {"owner": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "reply_to_user": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 1, "creation_date": 1467795208, "post_id": 38219638, "comment_id": 63862526, "body": "To complete @RGA&#39;s comment, you should write <code>Option Explicit</code> above your <code>Sub</code> so you&#39;ll always have to declare your variables. Also, be careful when you declare <code>Dim i, j, k As Integer</code> only <code>k</code> is declared as integer, i and j will be as <code>Variant</code> you need to write <code>Dim i As Integer, j As Integer, k As Integer</code>"}, {"owner": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "reply_to_user": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "edited": false, "score": 0, "creation_date": 1467795347, "post_id": 38219638, "comment_id": 63862594, "body": "Nice to meet you again @R&#233;mi! And for the <code>Option Exolicit</code>, could you please explain a little bit? I don&#39;t know why and how to use it."}, {"owner": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "edited": false, "score": 1, "creation_date": 1467795903, "post_id": 38219638, "comment_id": 63862914, "body": "@Hiddenllyy You just need to write <code>Option Explicit</code> in the first line of your module. This way if you are using a variable that you forgot to declare when you run the macro it won&#39;t work. <a href=\"https://msdn.microsoft.com/en-us/library/y9341s4f.aspx\" rel=\"nofollow noreferrer\">link</a>"}], "answers": [{"comments": [{"owner": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "edited": false, "score": 0, "creation_date": 1467795105, "post_id": 38219721, "comment_id": 63862467, "body": "Thank you, but it didn&#39;t work. I&#39;ve changed <code>.Cells(i,j)</code> into <code>.Range(Cells(i,j).Address)</code>, but still i met the error 1004."}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "edited": false, "score": 0, "creation_date": 1467795426, "post_id": 38219721, "comment_id": 63862644, "body": "@Hiddenllyy I see now it could be related to &quot;TargetColumn&quot; which is passed in as a string. Is this string value an uppercase letter representing a specific column?"}, {"owner": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "edited": false, "score": 1, "creation_date": 1467795703, "post_id": 38219721, "comment_id": 63862800, "body": "@RGA is right. <code>TargetColumn</code> is declared as String so if its values is supposed to be <code>1</code> you will get <code>&quot;1&quot;</code>. You need to declare it as a numerical variable (integer, Long, etc) or as a Range and add <code>.Column</code> right after."}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "reply_to_user": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "edited": false, "score": 0, "creation_date": 1467795795, "post_id": 38219721, "comment_id": 63862857, "body": "@Hiddenllyy alternatively, you can just add Cint(TargetColumn) which will pass the value as an integer, although this is not always the smartest way to do this.  Declaring it numeric from the start would be the best"}], "tags": [], "owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "is_accepted": true, "score": 1, "last_activity_date": 1467795897, "last_edit_date": 1467795897, "creation_date": 1467794623, "answer_id": 38219721, "question_id": 38219638, "link": "https://stackoverflow.com/questions/38219638/using-set-but-error-application-defined-or-object-defined-error-shows-up/38219721#38219721", "title": "Using Set but Error &#39;Application-defined or object-defined error&#39; shows up", "body": "<p>The default value for <code>Cells()</code> is the value of the cell.  Pass it as a Range to define the Range object variable.  </p>\n\n<p>Everywhere where you have a Range variable equal to <code>.Cells(something)</code>, change it to <code>.Range(.Cells(something).Address)</code> and it should work as intended</p>\n\n<p>Further, <code>TargetColumn</code> is declared as a string, rather than a numeric value.  If the string value is not of a column name (ie \"A\" or \"B\"), this will error.  Either pass the variable to a numeric value with Cdbl() CInt() or Clng(), or declare the variable with a numeric type from the start</p>\n"}], "owner": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 38219721, "answer_count": 1, "score": 0, "last_activity_date": 1467795897, "creation_date": 1467794335, "last_edit_date": 1531164843, "question_id": 38219638, "link": "https://stackoverflow.com/questions/38219638/using-set-but-error-application-defined-or-object-defined-error-shows-up", "title": "Using Set but Error &#39;Application-defined or object-defined error&#39; shows up", "body": "<p>Sorry the question is not so specified. I've tried to use <code>Set</code> to help me filling a quelity control table, but the error 10o4 show up. It seems correct for me and so I don't know how to correct it. So please take a look of it, and leave a comment if you've got some idea. Thank you!</p>\n\n<pre><code>Private Sub FillTarget(ByVal TargetSheet As String, ByVal DepositSheet As String, _\n        ByVal TargetRow As Integer, ByVal TargetColumn As String, _\n        ByVal DepositRow As Integer, ByVal DepositColumn As Integer)\n\nDim i, j, k As Integer\nDim OpenedFile As String\nDim myObject As String\n\nDim MarkRow As Integer\nMarkRow = 1\nDim myData As String\nDim EndSearch As Boolean\n\nDim TargetCell As Range\nDim TargetTag As Range\nDim TargetType As Range\nDim TargetZone As Range\nDim TargetTest As Range\n\nDim DepositTag As Range\nDim DepositZone As Range\nDim DepositResult As Range\n\nFor i = 3 To TargetRow\n    With Worksheets(TargetSheet)\n        myObject = .Cells(i, 15).Text + \"_\" + Worksheets(TargetSheet).Cells(i, 17).Text\n        Set TargetCell = .Cells(i, TargetColumn) &lt;==== Here comes the error\n        Set TargetTag = .Cells(i, 15)\n        Set TargetType = .Cells(i, 17)\n        Set TargetZone = .Cells(i, 18)\n        Set TargetTest = .Cells(i, 20)\n    End With\n\n    For j = MarkRow To DepositRow\n        With Worksheets(DepositSheet)\n            Set DepositTag = .Cells(j, 1)\n            Set DepositZone = .Cells(j, 2)\n        End With\n\n        If InStr(DepositTag.Text, myObject) &lt;&gt; 0 Then\n            OpenedFile = OpenedFile &amp; DepositTag.Text &amp; \"|\"\n\n            If InStr(DepositZone.Text, TargetZone.Text + \":\") &lt;&gt; 0 _\n                Or InStr(TargetZone.Text, \"/\") &lt;&gt; 0 Then\n\n                For k = 2 To DepositColumn\n                    With Worksheets(DepositSheet)\n                        Set DepositResult = .Cells(j, k)\n                    End With\n\n                    If InStr(DepositResult.Text, TargetTest.Text) &lt;&gt; 0 Then\n                        MarkRow = j\n                        myData = DepositResult.Text\n                        'Split_monData\n                        'Derniere_Colonne\n                        TargetCell.Value = myData\n                        EndSearch = True\n                        Exit For\n                    End If\n\n                Next k\n\n            End If\n\n        End If\n\n        If EndSearch Then Exit For\n    Next j\n\n    EndSearch = False\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31833, "user_id": 23574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff71c4381eaf3816bffda6c6fe53d33e?s=128&d=identicon&r=PG", "display_name": "shahkalpesh", "link": "https://stackoverflow.com/users/23574/shahkalpesh"}, "edited": false, "score": 1, "creation_date": 1467792904, "post_id": 38219186, "comment_id": 63861231, "body": "What do you mean by &quot; it is not working&quot;? Does it throw any error? Try to step thrugh <code>start</code> by pressing F8."}, {"owner": {"reputation": 1521, "user_id": 1641564, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/724f62d6254a1a8b245ea725196c13a9?s=128&d=identicon&r=PG", "display_name": "daZza", "link": "https://stackoverflow.com/users/1641564/dazza"}, "edited": false, "score": 1, "creation_date": 1467792926, "post_id": 38219186, "comment_id": 63861241, "body": "Did you use the debugger yet and traced whether the line &quot;FormatSheets 1&quot; is even executed in the start() sub? Any error messages?"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 1, "creation_date": 1467793037, "post_id": 38219186, "comment_id": 63861314, "body": "Based on this piece of code we aren&#39;t even able to check what&#39;s wrong with your code..."}, {"owner": {"reputation": 1945, "user_id": 2148939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4495f8cf59bfe786fe5b75598ff13?s=128&d=identicon&r=PG", "display_name": "Selrac", "link": "https://stackoverflow.com/users/2148939/selrac"}, "edited": false, "score": 0, "creation_date": 1467793928, "post_id": 38219186, "comment_id": 63861825, "body": "Sorry, I&#39;ve added additional comments. I did debug the code, but when it gets to the line to execute the sub it doesn&#39;t do it. It just goes to the next line"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1467794020, "post_id": 38219186, "comment_id": 63861888, "body": "Do you have any <code>On Error ...</code> line somewhere above the call to FormatSheets ?"}, {"owner": {"reputation": 1945, "user_id": 2148939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4495f8cf59bfe786fe5b75598ff13?s=128&d=identicon&r=PG", "display_name": "Selrac", "link": "https://stackoverflow.com/users/2148939/selrac"}, "edited": false, "score": 0, "creation_date": 1467794515, "post_id": 38219186, "comment_id": 63862148, "body": "No I don&#39;t have &#39;on error&#39; in the code. The think is that the debugging goes through the line"}, {"owner": {"reputation": 1945, "user_id": 2148939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4495f8cf59bfe786fe5b75598ff13?s=128&d=identicon&r=PG", "display_name": "Selrac", "link": "https://stackoverflow.com/users/2148939/selrac"}, "edited": false, "score": 0, "creation_date": 1467794781, "post_id": 38219186, "comment_id": 63862293, "body": "Vincent G, you game the clue. I found the problem, there was a &#39;Unload Me&#39; command. commenting this it worked. I&#39;ll post the solution"}], "answers": [{"tags": [], "owner": {"reputation": 1945, "user_id": 2148939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4495f8cf59bfe786fe5b75598ff13?s=128&d=identicon&r=PG", "display_name": "Selrac", "link": "https://stackoverflow.com/users/2148939/selrac"}, "is_accepted": false, "score": 0, "last_activity_date": 1467794994, "creation_date": 1467794994, "answer_id": 38219831, "question_id": 38219186, "link": "https://stackoverflow.com/questions/38219186/sub-will-not-execute-in-vba/38219831#38219831", "title": "Sub will not execute in VBA", "body": "<p>The problem was caused by this line this command 'Unload Me'</p>\n\n<pre><code>Private Sub start()\n...\nUnload Me\n....\nFormatSheets 1\nEnd Sub\n\n\nPublic Sub FormatSheets(planMonthNum As Integer)\n...\nEnd Sub\n</code></pre>\n\n<p>Commenting 'Unload Me' resolved the problem</p>\n\n<p>Hope it helps someone else</p>\n"}], "owner": {"reputation": 1945, "user_id": 2148939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4495f8cf59bfe786fe5b75598ff13?s=128&d=identicon&r=PG", "display_name": "Selrac", "link": "https://stackoverflow.com/users/2148939/selrac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467794994, "creation_date": 1467792729, "last_edit_date": 1531164843, "question_id": 38219186, "link": "https://stackoverflow.com/questions/38219186/sub-will-not-execute-in-vba", "title": "Sub will not execute in VBA", "body": "<p>I have an simple problem (I think), but I'm stuck</p>\n\n<p>I'm calling a sub from another sub but it is not working. I mean, the 2nd sub is not being executed.</p>\n\n<pre><code>Private Sub start()\n...\nFormatSheets 1\nEnd Sub\n\n\nPublic Sub FormatSheets(planMonthNum As Integer)\n...\nEnd Sub\n</code></pre>\n\n<p>There is no error code. When debugging with F8 it goes over the line but it doesn't jump to execute the other sub.</p>\n\n<p>Any ideas on what I'm doing wrong?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1467792128, "post_id": 38218869, "comment_id": 63860816, "body": "Step through the code and see the error of your ways. With each sheet you add, you loop through all sheets and assign them names that are already in use. Check your inner loop and move it outside of the loop that creates the sheets."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5219796"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1467792455, "post_id": 38218869, "comment_id": 63860972, "body": "What a dumb mistake of mine, thank you!"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5219796"}, "is_accepted": false, "score": 0, "last_activity_date": 1467794940, "creation_date": 1467794940, "answer_id": 38219810, "question_id": 38218869, "link": "https://stackoverflow.com/questions/38218869/create-number-of-worksheets-and-rename-them/38219810#38219810", "title": "Create number of worksheets and rename them", "body": "<p>Ok so for everyone interested, I solved the issue. Maybe a bit unconventional but it does what it is supposed to do. Please see the code below:</p>\n\n<pre><code>Sub KlickME()\nDim Rng As Range\nDim WorkRng As Range\nDim newName As String\nDim convert As Integer\nDim i As Integer\nDim b As Integer\n\nnewName = \"P-\"\n\n\nhowMany = Application.InputBox(\"Many\", \"How Many\", \"\", Type:=2)\nconvert = CInt(howMany - 1)\n\n\n\nFor i = 1 To convert\n    Sheets(\"P-1\").Copy After:=Sheets(\"P-1\")\nNext i\n\nFor b = 2 To Application.Sheets.Count\n        Set Sheet = ActiveWorkbook.Worksheets(b)\n        If Sheet.name &lt;&gt; \"P-1\" Then\n            Application.Sheets(b).name = newName &amp; b - 1\n        End If\nNext b\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": false, "score": 1, "last_activity_date": 1467795692, "creation_date": 1467795692, "answer_id": 38220050, "question_id": 38218869, "link": "https://stackoverflow.com/questions/38218869/create-number-of-worksheets-and-rename-them/38220050#38220050", "title": "Create number of worksheets and rename them", "body": "<p>I took your new code and made it a little shorter:</p>\n\n<pre><code>Sub KlickME()\n\nDim howmany As Integer\nDim i As Integer\n\nhowmany = Application.InputBox(\"Many\", \"How Many\", \"\", Type:=2)\n\nFor i = 1 To howmany\n\n    Sheets(\"P-1\").Copy After:=Sheets(Sheets.Count) 'Inserts sheet on last position\n\n    Sheets(Sheets.Count).Name = \"P-\" &amp; i + 1 'renames sheet on last position\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5219796"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1467795692, "creation_date": 1467791644, "last_edit_date": 1467792079, "question_id": 38218869, "link": "https://stackoverflow.com/questions/38218869/create-number-of-worksheets-and-rename-them", "title": "Create number of worksheets and rename them", "body": "<p>I created the following code to create a number of worksheets based on the input and rename them. When opening the document there will be two worsheets called \"General\" and \"P-1\" where \"P-1\" serves as the template. </p>\n\n<p>The problem I have is that whenever I start the macro and enter a number I will get an error telling me that the name is already assigned.</p>\n\n<pre><code>Sub KlickME()\nDim Rng As Range\nDim WorkRng As Range\nDim newName As String\nDim convert As Integer\nDim i As Integer\nDim b As Integer\n\n\nnewName = \"P-\"\n\n\nhowMany = Application.InputBox(\"Many\", \"How Many\", \"\", Type:=2)\nconvert = CInt(howMany - 1)\n\n\n\nFor i = 1 To convert\n    Sheets(\"P-1\").Copy After:=Sheets(\"P-1\")\n\n    For b = 1 To Application.Sheets.Count\n        Application.Sheets(b).name = newName &amp; b\n    Next b\nNext i\n\n\nEnd Sub\n</code></pre>\n\n<p>Whenever I run the macro without the \"General\" worksheet and only the \"P-1\" worksheet present, it works without any problems. </p>\n"}, {"tags": ["sql", "vba", "excel", "ado"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1467791514, "post_id": 38218218, "comment_id": 63860456, "body": "why don&#39;t you run two queries like <code>Select officer from table ORDER BY xxx</code> and <code>Select salary from table ORDER BY xxx</code> where ORDER seems to be required to be sure you get matching set of data"}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1467791573, "post_id": 38218218, "comment_id": 63860501, "body": "the other way is to load data to excel by looping through Recordset, not by <code>.CopyFromRecordset</code>. Loop would then go only for 1st, fourth and fifth fields..."}, {"owner": {"reputation": 279, "user_id": 6506784, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/36e8dca1e3e5544488b9a819a4339d13?s=128&d=identicon&r=PG&f=1", "display_name": "Vito", "link": "https://stackoverflow.com/users/6506784/vito"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1467792215, "post_id": 38218218, "comment_id": 63860848, "body": "@ KazimierzJawor  now i already built one sql statement <code>mrs.Open sSQLSting, Conn sheet6.Range(&quot;A5&quot;).CopyFromRecordset mrs</code> But this sql statement across the cells where no need to be placed"}, {"owner": {"reputation": 279, "user_id": 6506784, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/36e8dca1e3e5544488b9a819a4339d13?s=128&d=identicon&r=PG&f=1", "display_name": "Vito", "link": "https://stackoverflow.com/users/6506784/vito"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1467792405, "post_id": 38218218, "comment_id": 63860949, "body": "@ KazimierzJawor you mean placing the data to cell in every field ?How is the syntax like, not by .CopyFromRecordset?"}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1467794125, "post_id": 38218218, "comment_id": 63861950, "body": "I suggested two SQLs instead of one...!  see sample below by @daZza"}], "answers": [{"tags": [], "owner": {"reputation": 1521, "user_id": 1641564, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/724f62d6254a1a8b245ea725196c13a9?s=128&d=identicon&r=PG", "display_name": "daZza", "link": "https://stackoverflow.com/users/1641564/dazza"}, "is_accepted": false, "score": 0, "last_activity_date": 1467794034, "creation_date": 1467794034, "answer_id": 38219539, "question_id": 38218218, "link": "https://stackoverflow.com/questions/38218218/how-to-skip-or-ignore-the-column-without-using-select-null/38219539#38219539", "title": "How to skip or ignore the column without using Select NULL?", "body": "<p>If I understand you correctly you are currently inserting the queried data directly to your worksheet?</p>\n\n<p>If that's so, I suggest using a recordset to hold the results of your query. Then loop through it. This way you can decide in which cells you want to put the data.</p>\n\n<p>A starting point could be this (modify according to your needs):</p>\n\n<pre><code>Set cn = CreateObject(\"ADODB.Connection\")\nWith cn\n .Provider = \"YOUR.PROVIDER\"\n  .ConnectionString = \"YOUR_CONNECTION_STRING\"\n.Open\nEnd With\nstrQuery = \"SELECT officer, salary FROM table\"\nSet rs = cn.Execute(strQuery)\nDo While Not rs.EOF\n  For i = 0 To rs.Fields.Count\n\n    ' Insert data to your worksheet here\n    ' rs.Fields(0).Value holds the value for officer\n    ' rs.Fields(1).Value holds the value for salary\n\n  Next\n  rs.MoveNext\nLoop\nrs.Close\n</code></pre>\n"}], "owner": {"reputation": 279, "user_id": 6506784, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/36e8dca1e3e5544488b9a819a4339d13?s=128&d=identicon&r=PG&f=1", "display_name": "Vito", "link": "https://stackoverflow.com/users/6506784/vito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 797, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467794034, "creation_date": 1467789333, "last_edit_date": 1531164843, "question_id": 38218218, "link": "https://stackoverflow.com/questions/38218218/how-to-skip-or-ignore-the-column-without-using-select-null", "title": "How to skip or ignore the column without using Select NULL?", "body": "<p><strong><em>I have to declare that i ask the question before ,but i find some wording mistakes that cause misleading  .Hence , i decide to delete the old question and ask the question again.</em></strong></p>\n\n<p>Here is my sql:</p>\n\n<pre><code>Select officer , NULL ,NULL, salary from table \n</code></pre>\n\n<p>As i use ADO to run sql in excel , second and third column are needed to input data before running the sql query.</p>\n\n<p>But i use NULL to skip 2 column .The sql query would clear and reset my data  or excel formula stored in column 2 and 3,because i choose to NULL these 2 columns .</p>\n\n<p>Hence , how to skip these two columns without affecting these two column data or formula ?</p>\n\n<p>Visualization :</p>\n\n<ul>\n<li><blockquote>\n  <p>officer , Column 2,Column 3, salary</p>\n</blockquote></li>\n<li><blockquote>\n  <p><strong>_ ,  2,=sum(B2*C2), _</strong>  </p>\n</blockquote></li>\n</ul>\n\n<p>SQL query run :    <code>Select officer , NULL ,NULL, salary from table</code> </p>\n\n<ul>\n<li><blockquote>\n  <p>officer , Column 2(NULL),Column 3(NULL), salary</p>\n</blockquote></li>\n<li><blockquote>\n  <p><strong>988, ___ ,___   , $4789</strong>// the SQL query clears the original data stored  in column 2 ,3</p>\n</blockquote></li>\n</ul>\n\n<p>(___  means blank)</p>\n\n<p>How to solve this problem?</p>\n"}, {"tags": ["excel", "for-loop", "vba"], "comments": [{"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1467789169, "post_id": 38218075, "comment_id": 63859172, "body": "Why not use <code>Worksheets(&quot;Data&quot;).Cells(i, 1).Value = i</code> directly instead of setting target to a cell."}, {"owner": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "reply_to_user": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1467789333, "post_id": 38218075, "comment_id": 63859260, "body": "Because I have lots of targets to use, for example : <code>Worksheets(&quot;Data&quot;).Cells(i,1).Value = i</code>, and <code>Worksheets(&quot;Data&quot;).Cells(i,2).Value = i +1</code>, and I want also to get some informations during the <code>Loop</code>, like <code>Colour = Worksheets(&quot;Data&quot;).Cells(i,10).Text</code>"}, {"owner": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "reply_to_user": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1467789395, "post_id": 38218075, "comment_id": 63859293, "body": "So in your opinion, it&#39;s not a good idea to set a <code>Range</code> before and use them during the Loop?"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1467789883, "post_id": 38218075, "comment_id": 63859546, "body": "<code>Set target = Worksheets(&quot;Data&quot;).Cells(i, 1)</code> this line will give you error unless you declare and initialize variable <code>i</code>"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 1, "creation_date": 1467789963, "post_id": 38218075, "comment_id": 63859597, "body": "If you are using large range then using <code>Worksheets(&quot;Data&quot;).Cells(i, 1).Value = i</code> instead of <code>Set target = Worksheets(&quot;Sheet3&quot;).Cells(i, 1)   target.Value = i</code> will be more efficient."}, {"owner": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "reply_to_user": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1467790051, "post_id": 38218075, "comment_id": 63859645, "body": "Yes, I think it&#39;s not possible to do so. It&#39;s just a little chaos in the Loop, because I&#39;ve lots of <code>Worksheets</code> and <code>Cells</code> inside."}, {"owner": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "reply_to_user": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1467790155, "post_id": 38218075, "comment_id": 63859695, "body": "I&#39;ve think about that, but does it works faster than I just use directly <code>Worksheets(&quot;Sheet3&quot;).Cells(i, 1).Value = i</code> ? It seems more evident?"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 1, "creation_date": 1467790266, "post_id": 38218075, "comment_id": 63859751, "body": "For a large range, yes it will be faster."}, {"owner": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "edited": false, "score": 1, "creation_date": 1467790356, "post_id": 38218075, "comment_id": 63859801, "body": "You can use <code>For Each</code> instead of indexed <code>For</code>. But if you would give us a bit more details about what you want to do we could give you more advice."}, {"owner": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "reply_to_user": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "edited": false, "score": 0, "creation_date": 1467793314, "post_id": 38218075, "comment_id": 63861487, "body": "@R&#233;mi Thank you, and I&#39;ve used <code>For Each</code> in stead of <code>For</code>. My object is actually to fill a report. So I have to &quot;Read&quot; each line, like &quot;Colour&quot;, &quot;Type&quot; etc, then fill this report with another sheet, which contains the results like &quot;Colour : Red&quot;, &quot;Type : A1&quot;. So I need to set lots of things and check if it&#39;s the correct answer that I need."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1467922696, "post_id": 38218075, "comment_id": 63930157, "body": "Get the values from the entire range to 2d array via <code>.Value</code> property, process that array, it much more faster then accessing each cell individually. Also you can create one more 2d array for output, and assign values from array to cells in one turn."}], "answers": [{"comments": [{"owner": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "edited": false, "score": 0, "creation_date": 1467804420, "post_id": 38221499, "comment_id": 63867794, "body": "Thank you, but this is not so useful for my work. I think it&#39;s me that didn&#39;t well explained my needs. I want to fill a table (a report of quality control of a product). For example, TV 1 | Colour | Size | Price, and TV2 | Colour | Size | Price. And for each cell in the report, I need to find the result in another sheet, and check if this is the result of that &#39;TV&#39; I need to fill (this is the result of TV1 or TV2). Then check if this is the answer of colour, or the answer of size, price,etc. At last, fill the report by the correct answer."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "edited": false, "score": 0, "creation_date": 1467805122, "post_id": 38221499, "comment_id": 63868193, "body": "Ah right, so you have text on both sheets to perform the match - e.g. on Sheet1 you have a cell with &quot;TV1&quot; written in it and you want to look up &quot;TV1&quot; on another sheet and return the corresponding colour, size, price, etc which are in the adjacent columns?"}, {"owner": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "edited": false, "score": 0, "creation_date": 1467809154, "post_id": 38221499, "comment_id": 63870599, "body": "Yes exactly! And so I want to do a several <code>Set</code> outside the Loop (if it&#39;s possible) and use the <code>Colour.value = NewReport.Colour.Value</code>, something like this. I think that could be faster and easier for reading and maintaining."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1467800002, "creation_date": 1467800002, "answer_id": 38221499, "question_id": 38218075, "link": "https://stackoverflow.com/questions/38218075/how-to-set-a-range-outside-a-loop-and-use-it-inside/38221499#38221499", "title": "How to Set a Range outside a Loop and use it inside", "body": "<p>Based on your comment about \"reading\" each line.  This code uses a <code>For Each</code> and examines each cell to see what to do.</p>\n\n<pre><code>Public Sub Test()\n\n    Dim rMyRange As Range\n    Dim rCell As Range\n\n    'Define a range on the same sheet.\n    Set rMyRange = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1:A15,C1:C20,D18,E19:E20\")\n\n    'Add another range using Union just for the hell of it.\n    Set rMyRange = Union(rMyRange, ThisWorkbook.Worksheets(\"Sheet1\").Range(\"F30\"))\n\n    'Step through each cell in rMyRange and decide what to do based on contents/formatting of cell.\n    For Each rCell In rMyRange\n        If rCell = \"Colour\" Then 'Value is default property.\n            rCell.Interior.Color = RGB(255, 0, 0)\n        Else\n            Select Case rCell.Font.Color\n                Case 255  'Red\n                    rCell = \"Red\"\n                Case 5287936 'Green\n                    rCell = \"Green\"\n                Case Else\n                    rCell = \"Some Other Colour\"\n            End Select\n        End If\n    Next rCell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 179, "user_id": 6396578, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96416893a7a8facb68d3cebdc8e74e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Hiddenllyy", "link": "https://stackoverflow.com/users/6396578/hiddenllyy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 295, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467800002, "creation_date": 1467788785, "last_edit_date": 1531164843, "question_id": 38218075, "link": "https://stackoverflow.com/questions/38218075/how-to-set-a-range-outside-a-loop-and-use-it-inside", "title": "How to Set a Range outside a Loop and use it inside", "body": "<p>\u00ce've read lots of questions recommanding me to avoid using Select. So I've tried to set a target cell but I've met a problem:</p>\n\n<p>I want to use a For Loop to fill a table, but the target cell will change each time with the Loop going on. For example:</p>\n\n<pre><code>Sub try()\n\nDim target As Range\nSet target = Worksheets(\"Data\").Cells(i, 1)\n\nFor i = 1 To 10\n    target.Value = i\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>So can I use a Range in Loop or not?</p>\n\n<p>If I set the target in the <code>For Loop</code>, I'm afraid it will not be faster than I choose directly the cell <code>Worksheets(\"Data\").Cells(i, 1)</code>in the Loop? Because I'll actually have lots of targets to use, so I wish to find a easier method to set the targets and fill them everytime without setting them one by one.</p>\n\n<p>Sorry if I've post a duplicate question because I didn't find a similar question or an answer on the net. If you've got an idea, please leave a comment. Thank you!</p>\n"}, {"tags": ["vba", "csv", "ms-access", "firebase-realtime-database"], "answers": [{"comments": [{"owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "edited": false, "score": 0, "creation_date": 1467797154, "post_id": 38218804, "comment_id": 63863560, "body": "There are few <code>.bas</code> files in the github. Which <code>.bas</code> file should I import to test this out?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "edited": false, "score": 1, "creation_date": 1467799458, "post_id": 38218804, "comment_id": 63864959, "body": "It&#39;s the <i>Json*.bas</i> files. The <i>JsonTest.bas</i> is the one to modify (as used above) or to replace with your own code."}, {"owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "edited": false, "score": 0, "creation_date": 1467804942, "post_id": 38218804, "comment_id": 63868087, "body": "When I print <code>DataCollection(Index)(CollectionItem.Name)</code> to my console, I am getting just <code>root</code>. I also tried adding <code>1</code> instead of <code>index</code>"}, {"owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "edited": false, "score": 0, "creation_date": 1467806653, "post_id": 38218804, "comment_id": 63869019, "body": "When I implemented exactly as your example. I get <code>Error 91: Object variable or With block variable not set</code>"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "edited": false, "score": 0, "creation_date": 1467807251, "post_id": 38218804, "comment_id": 63869405, "body": "I don&#39;t know. It worked here. Where do you see that error?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "edited": false, "score": 0, "creation_date": 1467807338, "post_id": 38218804, "comment_id": 63869452, "body": "Have in mind that <code>ListFieldNames</code> is called <i>recursively</i>."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1467791316, "creation_date": 1467791316, "answer_id": 38218804, "question_id": 38217539, "link": "https://stackoverflow.com/questions/38217539/saving-csv-in-ms-access-using-vba-based-on-response-from-api/38218804#38218804", "title": "Saving CSV in MS access using VBA based on response from API", "body": "<p>Using the Json modules from <a href=\"https://github.com/CactusData/VBA.CVRAPI.git\" rel=\"nofollow\">VBA.CVRAPI</a> you can modify these functions to read the Json string <em>as is</em>, and directly add the data to your recordset:</p>\n\n<pre><code>Public Sub TestJsonResponseText()\n\n    Dim ResponseText As String\n\n    ' For testing only.\n    ResponseText = _\n        \"{\" &amp; _\n        \"\"\"-KLk7i27KUizlqMEnua2\"\": true,\" &amp; _\n        \"\"\"-KLk9uAth59pyDImwjtu\"\": true,\" &amp; _\n        \"\"\"-KLszfh9xdYNqa5LcEvE\"\": true,\" &amp; _\n        \"\"\"-KLt-bCr5Fw9wCIFz9Mc\"\": true\" &amp; _\n        \"}\"\n\n    Dim DataCollection      As Collection\n    If ResponseText &lt;&gt; \"\" Then\n        Set DataCollection = CollectJson(ResponseText)\n    End If\n\n    Call ListFieldNames(DataCollection)\n\n    Set DataCollection = Nothing\n\nEnd Sub\n\n\nPublic Sub ListFieldNames( _\n    ByVal DataCollection As Collection)\n\n    On Error GoTo Err_ListFieldNames\n\n    Dim Index               As Long\n\n    For Index = 1 To DataCollection.Count\n        If VarType(DataCollection(Index)(CollectionItem.Data)) = vbObject Then\n            Debug.Print \"rs.OpenRecordset\"\n            Call ListFieldNames(DataCollection(Index)(CollectionItem.Data))\n            Debug.Print \"rs.Close\"\n        Else\n            Debug.Print , \"AddNew\"\n            Debug.Print , DataCollection(Index)(CollectionItem.Name), DataCollection(Index)(CollectionItem.Data)\n            Debug.Print , \"Update\"\n        End If\n    Next\n\nExit_ListFieldNames:\n    Exit Sub\n\nErr_ListFieldNames:\n    Debug.Print \"Error\" &amp; Str(Err.Number) &amp; \": \" &amp; Err.Description\n    Resume Exit_ListFieldNames\n\nEnd Sub\n</code></pre>\n\n<p>Of course, replace the <code>Debug.Print</code> lines with code to handle your recordset.</p>\n\n<p>For testing, the function <em>TestJsonResponseText</em> above returns:</p>\n\n<pre><code>rs.OpenRecordset\n              AddNew\n              -KLk7i27KUizlqMEnua2        True\n              Update\n              AddNew\n              -KLk9uAth59pyDImwjtu        True\n              Update\n              AddNew\n              -KLszfh9xdYNqa5LcEvE        True\n              Update\n              AddNew\n              -KLt-bCr5Fw9wCIFz9Mc        True\n              Update\nrs.Close\n</code></pre>\n"}], "owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467791316, "creation_date": 1467786633, "question_id": 38217539, "link": "https://stackoverflow.com/questions/38217539/saving-csv-in-ms-access-using-vba-based-on-response-from-api", "title": "Saving CSV in MS access using VBA based on response from API", "body": "<p>I am calling an API (firebase as backend) and in response I get the below data </p>\n\n<pre><code>{\n  \"-KLk7i27KUizlqMEnua2\": true,\n  \"-KLk9uAth59pyDImwjtu\": true,\n  \"-KLszfh9xdYNqa5LcEvE\": true,\n  \"-KLt-bCr5Fw9wCIFz9Mc\": true\n}\n</code></pre>\n\n<p>I am replacing the <code>{</code> and <code>}</code> and then using the data as CSV. </p>\n\n<p>I want to save the data in <code>tblStudents</code> under column <code>studentID</code></p>\n\n<p>Which function / method should be used to save this data in Tables which I am receiving from API.</p>\n\n<p>Any help will be appreciated. Or guide me to relevant page.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 6554414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7f5f8ec1c061675da06f379720265b2?s=128&d=identicon&r=PG&f=1", "display_name": "JDogg", "link": "https://stackoverflow.com/users/6554414/jdogg"}, "edited": false, "score": 0, "creation_date": 1467779422, "post_id": 38216342, "comment_id": 63855971, "body": "Also forgot to mention that the Macro / code works fine just in Excel, but when I have embedded it into Access it doesn&#39;t work?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1467779558, "post_id": 38216342, "comment_id": 63856001, "body": "When automating excel from Access you need to get a reference to the Excel Application object, and use that with any reference to an Excel object.  Also, add a reference to the excel object model in your Access VB project."}, {"owner": {"reputation": 1, "user_id": 6554414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7f5f8ec1c061675da06f379720265b2?s=128&d=identicon&r=PG&f=1", "display_name": "JDogg", "link": "https://stackoverflow.com/users/6554414/jdogg"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1467780084, "post_id": 38216342, "comment_id": 63856101, "body": "Thanks Tim, I have added the Excel object model in Access Vb. But I suspect something isn&#39;t quite right about the code."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1467781718, "post_id": 38216342, "comment_id": 63856473, "body": "There is no <code>Range</code> object in Access - that needs to be qualified with an Excel Application object reference: like <code>objExcel.ActiveSheet.Range(...)</code> for example.  Same for any other references to objects &quot;owned&quot; by Excel and not by Access.  <a href=\"http://stackoverflow.com/questions/5729195/how-to-refer-to-excel-objects-in-access-vba\" title=\"how to refer to excel objects in access vba\">stackoverflow.com/questions/5729195/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1468125506, "creation_date": 1468125506, "answer_id": 38288631, "question_id": 38216342, "link": "https://stackoverflow.com/questions/38216342/run-time-error-when-running-an-excel-macro-within-ms-access/38288631#38288631", "title": "Run time error when running an Excel Macro within MS Access", "body": "<p>If you want to control Excel from Access, you basically have 2 options.  Please try the 2 scripts below and post back with additional questions...</p>\n\n<pre><code>\u2018EARLY BINDING\nOption Compare Database\nOption Explicit ' Use this to make sure your variables are defined\n\n' One way to be able to use these objects throughout the Module is to Declare them\n' Here and not in a Sub\n\nPrivate objExcel As Excel.Application\nPrivate xlWB As Excel.Workbook\nPrivate xlWS As Excel.Worksheet\n\nSub Rep()\n\nDim strFile As String\n\nstrFile = \"C:\\Users\\Excel\\Desktop\\YourExcelFile.xls\"\n\n' Opens Excel and makes it Visible\nSet objExcel = New Excel.Application\nobjExcel.Visible = True\n\n'Opens up the Workbook\nSet xlWB = objExcel.Workbooks.Open(strFile)\n\n'Sets the Workseet to the last active sheet - Better to use the commented version and use the name of the sheet.\nSet xlWS = xlWB.ActiveSheet\n'Set xlWS = xlWB(\"Sheet2\")\n\nWith xlWS ' You are now working with the Named file and the named worksheet\n\n\nEnd With\n\n'Do Close and Cleanup\nEnd Sub\n\n\n\u2003\n\u2018LATE BINDING\nSub ControlExcelFromAccess()\n\n' No reference to a type library is needed to use late binding.\n' As long as the object supports IDispatch, the method can\n' be dynamically located and invoked at run-time.\n\n' Declare the object as a late-bound object\n  Dim oExcel As Object\n  Dim strFile As String\n\n  strFile = \"C:\\Users\\Excel\\Desktop\\YourExcelFile.xls\"\n\n  Set oExcel = CreateObject(\"Excel.Application\")\n\n' The Visible property is called via IDispatch\n  oExcel.Visible = True\n\n  Set xlWB = oExcel.Workbooks.Open(strFile)\n\n'Call Ron's code here . . .\n\nSet oExcel = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6554414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7f5f8ec1c061675da06f379720265b2?s=128&d=identicon&r=PG&f=1", "display_name": "JDogg", "link": "https://stackoverflow.com/users/6554414/jdogg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1468125506, "creation_date": 1467779366, "last_edit_date": 1531164843, "question_id": 38216342, "link": "https://stackoverflow.com/questions/38216342/run-time-error-when-running-an-excel-macro-within-ms-access", "title": "Run time error when running an Excel Macro within MS Access", "body": "<p>This is my first post and I am really new to programming.</p>\n\n<p>I am currently stuck on a line of code which is halting when the Graph is building.\nBasically I have a Database / Access and I have a function where I click the button and it opens a file from a specific location. It then Opens Excel and starts to run my code and then halts.</p>\n\n<p>Below is a snippet, It gets stuck on the below line </p>\n\n<p><strong>ActiveChart.Axes(xlValue, xlPrimary).AxisTitle.Text = \"M\u00b3 Per Month\"</strong></p>\n\n<pre><code>Range(\"A2:M6\").Select\nActiveSheet.Shapes.AddChart.Select\nActiveChart.ChartType = xlLine\nActiveChart.SetSourceData Source:=Range(\"LCLSPENDGRAPH!$A$2:$M$6\")\nActiveChart.SetElement (msoElementDataTableShow)\nActiveChart.SetElement (msoElementPrimaryValueAxisTitleRotated)\nActiveChart.Axes(xlValue, xlPrimary).AxisTitle.Text = \"M\u00b3 Per Month\"\nSelection.Format.TextFrame2.TextRange.Characters.Text = \"M\u00b3 Per Month\"\nWith Selection.Format.TextFrame2.TextRange.Characters(1, 11).ParagraphFormat\n    .TextDirection = msoTextDirectionLeftToRight\n    .Alignment = msoAlignCenter\nEnd With\nWith Selection.Format.TextFrame2.TextRange.Characters(1, 11).Font\n    .BaselineOffset = 0\n    .Bold = msoTrue\n    .NameComplexScript = \"+mn-cs\"\n    .NameFarEast = \"+mn-ea\"\n    .Fill.Visible = msoTrue\n    .Fill.ForeColor.RGB = RGB(0, 0, 0)\n    .Fill.Transparency = 0\n    .Fill.Solid\n    .Size = 10\n    .Italic = msoFalse\n    .Kerning = 12\n    .Name = \"+mn-lt\"\n    .UnderlineStyle = msoNoUnderline\n    .Strike = msoNoStrike\n</code></pre>\n\n<p>`</p>\n\n<p>Any suggestions would be appreciated.</p>\n\n<p>Kind regards\nJDogg</p>\n"}, {"tags": ["sql", "vba", "excel", "ado"], "comments": [{"owner": {"reputation": 381798, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1467774459, "post_id": 38215729, "comment_id": 63855004, "body": "Please show us sample input and output."}], "answers": [{"comments": [{"owner": {"reputation": 279, "user_id": 6506784, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/36e8dca1e3e5544488b9a819a4339d13?s=128&d=identicon&r=PG&f=1", "display_name": "Vito", "link": "https://stackoverflow.com/users/6506784/vito"}, "edited": false, "score": 0, "creation_date": 1467777985, "post_id": 38215845, "comment_id": 63855677, "body": "But in my perception , count() counts only (IIF) true case . Hence , count() should not count (IIF) false case (0) . Isn&#39;t ?"}, {"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "reply_to_user": {"reputation": 279, "user_id": 6506784, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/36e8dca1e3e5544488b9a819a4339d13?s=128&d=identicon&r=PG&f=1", "display_name": "Vito", "link": "https://stackoverflow.com/users/6506784/vito"}, "edited": false, "score": 0, "creation_date": 1467859258, "post_id": 38215845, "comment_id": 63895023, "body": "@Vito . . . Your perception is wrong.  <code>COUNT()</code> counts the number of non-<code>NULL</code> values, regardless of whether or not there is an <code>IIF()</code> expression."}], "tags": [], "owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "is_accepted": true, "score": 1, "last_activity_date": 1467774914, "creation_date": 1467774914, "answer_id": 38215845, "question_id": 38215729, "link": "https://stackoverflow.com/questions/38215729/how-to-write-count-if-group-by-officer/38215845#38215845", "title": "How to write count if group by officer?", "body": "<p><code>COUNT()</code> counts the number of non-<code>NULL</code> values.  Because <code>0</code> is not null, it is counted.  Here are two options:</p>\n\n<pre><code>COUNT(IIF(Survey='abc' AND Activity='FI' AND Outcome IN ('C', 'D'), Totalmin, NULL))\n</code></pre>\n\n<p>or</p>\n\n<pre><code>SUM(IIF(Survey='abc' AND Activity='FI' AND Outcome IN ('C', 'D') AND Totalmin IS NOT NULL, 1, 0))\n</code></pre>\n"}], "owner": {"reputation": 279, "user_id": 6506784, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/36e8dca1e3e5544488b9a819a4339d13?s=128&d=identicon&r=PG&f=1", "display_name": "Vito", "link": "https://stackoverflow.com/users/6506784/vito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 38215845, "answer_count": 1, "score": 2, "last_activity_date": 1467774914, "creation_date": 1467773863, "last_edit_date": 1467774584, "question_id": 38215729, "link": "https://stackoverflow.com/questions/38215729/how-to-write-count-if-group-by-officer", "title": "How to write count if group by officer?", "body": "<p>I have to count every officer's cases where Survey='abc' and Activity='FI' and (outcome='C' OR outcome='D')</p>\n\n<p>Here is my full SQL</p>\n\n<pre><code>SELECT officer, NULL,\n    SUM(IIF(ISNUMERIC(mkt) = TRUE AND Survey='dasda' AND Activity='FI' AND Outcome = 'C', Totalmin, 0 ) / 60),\n    SUM(Non), SUM(ICC), NULL, NULL, NULL, COUNT(IIF(Survey='abc' AND Activity='FI' AND (Outcome='C'or Outcome='D'), Totalmin, 0))\nFROM [DB$]\nGROUP BY officer \" '\n</code></pre>\n\n<p>The problematic part is </p>\n\n<pre><code>Count(IIF(  Survey='abc' and Activity='FI' and (Outcome='C'or Outcome='D'), Totalmin, 0 ))\n</code></pre>\n\n<p>However ,for the result that i generated doesn't work. The count result is far more than the answer .</p>\n"}, {"tags": ["windows", "vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 117, "user_id": 6841046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TFN5Y.png?s=128&g=1", "display_name": "graphemecluster", "link": "https://stackoverflow.com/users/6841046/graphemecluster"}, "is_accepted": true, "score": 0, "last_activity_date": 1483684883, "creation_date": 1483684883, "answer_id": 41500334, "question_id": 38215086, "link": "https://stackoverflow.com/questions/38215086/how-to-add-remove-phonetic-guides-by-vba-on-ms-word/41500334#41500334", "title": "How to add/remove phonetic guides by VBA on MS Word?", "body": "<p>Very simple. <strong>No VBA is needed.</strong> Just</p>\n\n<ol>\n<li><strong>Copy</strong> all.</li>\n<li>Start a new document and <strong>paste</strong> as text.</li>\n<li>By using \"Find and Replace\", <strong>replace</strong> all the <strong>blankets</strong> <code>(  )</code> to <strong>nothing</strong>. The steps are as below:\n\n<ol>\n<li>In \"<em>Find what</em>\", <strong>type</strong> <code>\\(*\\)</code> and <strong>empty</strong> \"<em>Replace with</em>\".</li>\n<li><strong>Click</strong> on \"<em>More >></em>\" and <strong>check</strong> \"<em>Use Wildcards</em>\".</li>\n<li><strong>Click</strong> on \"<em>Replace All</em>\".</li>\n</ol></li>\n<li>If the original format is needed, Just \"<strong><em>Copy Format</em></strong>\" from the original document.</li>\n</ol>\n\n<p><strong>Note:</strong> If the content have any <strong>blankets</strong> (before doing the above steps), <strong>replace</strong> all the <code>(</code> and <code>)</code> to <strong>any</strong> other <strong>characters</strong>. After doing the above steps, <strong>replace</strong> the characters <strong>back</strong> to <code>(</code> and <code>)</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 6553340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P5Hcm.jpg?s=128&g=1", "display_name": "hashi", "link": "https://stackoverflow.com/users/6553340/hashi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 1, "accepted_answer_id": 41500334, "answer_count": 1, "score": -1, "last_activity_date": 1483684883, "creation_date": 1467767681, "last_edit_date": 1495540427, "question_id": 38215086, "link": "https://stackoverflow.com/questions/38215086/how-to-add-remove-phonetic-guides-by-vba-on-ms-word", "title": "How to add/remove phonetic guides by VBA on MS Word?", "body": "<p>Environment: Windows, MS Word, VBA.</p>\n\n<p>How to add and remove phonetic guides by VBA on MS Word? \nI use the information in this link.\n<a href=\"https://stackoverflow.com/questions/34602598/how-to-add-phonetic-guides-to-all-the-texts-at-once\">How to add phonetic guides to all the texts at once?</a></p>\n\n<p>Add phonetic guides work!</p>\n\n<p>Now, how to remove the phonetic guides?</p>\n\n<p>Thanks in advance,\nhashi</p>\n"}, {"tags": ["html", "vba", "excel", "insert"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1467771618, "creation_date": 1467771618, "answer_id": 38215496, "question_id": 38214780, "link": "https://stackoverflow.com/questions/38214780/i-need-help-inputting-a-column-from-excel-in-vba-with-html-macro/38215496#38215496", "title": "I need help inputting a column from excel in VBA with html macro.", "body": "<p>You'll usually see the <code>Worksheet_SelectionChange</code> event used instaed of the <code>Worksheet_Change</code>.<br></p>\n\n<p>Here are some tips on using these events:</p>\n\n<ul>\n<li><p>Turn off EnableEvents.  If you don't you might re-trigger the event and get stuck in an infinite loop</p></li>\n<li><p>Use the <code>Intersect</code> method to test to see if your range and the Target intersect.</p></li>\n<li><p>You should use Target.Cells.Count to see if multiple cells are being effected.</p></li>\n</ul>\n\n<p>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"perch\")) Is Nothing Then\n        Application.EnableEvents = False</p>\n\n<pre><code>    Application.EnableEvents = True\nEnd If\n</code></pre>\n\n<p>End Sub</p>\n\n<p>I'm not really sure how you want to handle multiple values. <br></p>\n\n<p>Creating a function to add value(s) to the end of a list often helps.</p>\n\n<pre><code>Sub AddStatusRow(value As Variant)\n    Const StatColumn = 5\n    Dim lastRow As Long\n\n    lastRow = Range(Cells(1, StatColumn), Cells(Rows.count, StatColumn)).End(xlUp).Row + 1\n\n    Cells(lastRow, StatColumn) = value\n\nEnd Sub\n</code></pre>\n\n<p>You might want to consider iterating over the rows of the table instead of <code>Doc.getElementsByTagName(\"td\")(33).innerText</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1468496463, "creation_date": 1468496463, "answer_id": 38373238, "question_id": 38214780, "link": "https://stackoverflow.com/questions/38214780/i-need-help-inputting-a-column-from-excel-in-vba-with-html-macro/38373238#38373238", "title": "I need help inputting a column from excel in VBA with html macro.", "body": "<p>You can find lots of great examples of what you want to do from the URL below.</p>\n\n<p><a href=\"http://www.tushar-mehta.com/publish_train/xl_vba_cases/vba_web_pages_services/index.htm\" rel=\"nofollow\">http://www.tushar-mehta.com/publish_train/xl_vba_cases/vba_web_pages_services/index.htm</a></p>\n"}], "owner": {"reputation": 41, "user_id": 6553916, "user_type": "registered", "accept_rate": 12, "profile_image": "https://lh6.googleusercontent.com/-SXwrH9BdN1E/AAAAAAAAAAI/AAAAAAAAABY/Bi1KuBFrXCw/photo.jpg?sz=128", "display_name": "andrew", "link": "https://stackoverflow.com/users/6553916/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1468496463, "creation_date": 1467764710, "question_id": 38214780, "link": "https://stackoverflow.com/questions/38214780/i-need-help-inputting-a-column-from-excel-in-vba-with-html-macro", "title": "I need help inputting a column from excel in VBA with html macro.", "body": "<p>I selected 2 cells and named them \"perch\" and \"stats\". using what i inputted in the cell, i was able to run a search and retrieve the data i wanted from the html code(which i changed for safety). But my problem is want to input an entire column not just a single cell. And produce multiple results in a single column. Also the number of inputs will change periodically ~300, so i can't stipulate a specific range.</p>\n\n<pre><code> Private Sub Worksheet_Change(ByVal Target As Range)\n If Target.Row = Range(\"perch\").Row And _\n Target.Column = Range(\"perch\").Column Then\n     Dim IE As New InternetExplorer\n     'IE.Visible = True\n     IE.navigate \"http://\"google/not_real_link\"\nDo\n DoEvents\n  Loop Until IE.readyState = READYSTATE_COMPLETE\n  Dim Doc As HTMLDocument\n  Set Doc = IE.document\n  Dim sTD As String\n  sTD = Trim(Doc.getElementsByTagName(\"td\")(33).innerText)\n  IE.Quit\n  Range(\"stats\").Value = sTD\n\n\n End If\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6553832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2b1815f007c30a2ef67111f2398d646?s=128&d=identicon&r=PG&f=1", "display_name": "Tchristian", "link": "https://stackoverflow.com/users/6553832/tchristian"}, "edited": false, "score": 0, "creation_date": 1467836674, "post_id": 38215654, "comment_id": 63887879, "body": "Thomas, thank you for your input. I tried utilizing the code with the corrections you made but when I use the above code it get the Error 424 Object Required Error on the Set drp lines. Any advice?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1467773265, "creation_date": 1467773265, "answer_id": 38215654, "question_id": 38214403, "link": "https://stackoverflow.com/questions/38214403/excel-issue-object-variable-or-with-block-variable-not-set/38215654#38215654", "title": "Excel Issue: Object Variable or with block Variable not set", "body": "<p><code>While ie.busy</code> is probably to blame.  Use <code>Loop Until ie.readyState = READYSTATE_COMPLETE</code> instead.  </p>\n\n<p>I would cast <code>.Range(\"L2\")</code> as an integer using <code>CInt(.Range(\"L2\"))</code>.  You have a reference to the HTML Object library set.  You should go ahead and add a reference to Microsoft Internet Controls.  This way you'll get advantages of intellisense and internet constants.  If you don't want to set the reference add <code>Const READYSTATE_COMPLETE = 4</code> to the code and change the ie references back</p>\n\n<pre><code>Sub FillInternetForm()\n    Dim ie As InternetExplorer\n    Dim doc As HTMLDocument\n\n    Set ie = New InternetExplorer\n\n    'set references for copying to submitted reps sheet and deleting for next rep\n    Application.ScreenUpdating = False\n\n    'create new instance of IE.\n\n    ie.navigate \"removed for privacy\"\n\n    'go to web page listed inside quotes\n    ie.Visible = True\n\n    Do\n        DoEvents\n    Loop Until ie.readyState = READYSTATE_COMPLETE\n\n    With Sheets(\"sheet1\")\n\n        'select onboarding system CRIS or ENS\n        Set doc = ie.document\n        Dim drp As HTMLFormElement\n        Set drp = HTML.getElementById(\"ctl00$m$g_62853594_bb4b_4cec_8b5c_17fb6abb735e$ff45_1$ctl00    $DropDownChoice\")\n        drp.selectedIndex = CInt(.Range(\"L2\"))\n\n        'set address nickname based on value\n        Set drp = HTML.getElementById(\"ctl00$m$g_62853594_bb4b_4cec_8b5c_17fb6abb735e$ff32_1$ctl00    $Lookup\")\n        drp.selectedIndex = CInt(.Range(\"m2\"))\n\n        'set market based on value\n        Set drp = HTML.getElementById(\"ctl00$m$g_62853594_bb4b_4cec_8b5c_17fb6abb735e$ff6_1$ctl00$    DropDownChoice\")\n        drp.selectedIndex = CInt(.Range(\"e2\"))\n\n        'check Not moved from another partner\n        doc.getElementById(\"ctl00_m_g_62853594_bb4b_4cec_8b5c_17fb6abb735e_ff46_1_ctl00_ctl01\").Click\n\n        'input name and ssn based on excel sheet values\n        doc.all(\"ctl00$m$g_62853594_bb4b_4cec_8b5c_17fb6abb735e$ff3_1$ctl00$ctl00$TextField\").value = .Range(\"a2\")\n        doc.all(\"ctl00$m$g_62853594_bb4b_4cec_8b5c_17fb6abb735e$ff4_1$ctl00$ctl00$TextField\").value = .Range(\"b2\")\n        doc.all(\"ctl00$m$g_62853594_bb4b_4cec_8b5c_17fb6abb735e$ff5_1$ctl00$ctl00$TextField\").value = .Range(\"c2\")\n\n        'input extra fields based on ICL value\n        'owner\n        doc.all(\"ctl00_m_g_62853594_bb4b_4cec_8b5c_17fb6abb735e_ff11_1_ctl00_ctl00_TextField\").value = .Range(\"j2\")\n        'city\n        doc.all(\"ctl00$m$g_62853594_bb4b_4cec_8b5c_17fb6abb735e$ff14_1$ctl00$ctl00$TextField\").value = .Range(\"f2\")\n        'state\n        doc.all(\"ctl00$m$g_62853594_bb4b_4cec_8b5c_17fb6abb735e$ff15_1$ctl00$ctl00$TextField\").value = .Range(\"g2\")\n        'address\n        doc.all(\"ctl00$m$g_62853594_bb4b_4cec_8b5c_17fb6abb735e$ff13_1$ctl00$ctl00$TextField\").value = .Range(\"i2\")\n        'phone\n        doc.all(\"ctl00$m$g_62853594_bb4b_4cec_8b5c_17fb6abb735e$ff10_1$ctl00$ctl00$TextField\").value = .Range(\"k2\")\n        'zip\n        doc.all(\"ctl00$m$g_62853594_bb4b_4cec_8b5c_17fb6abb735e$ff16_1$ctl00$ctl00$TextField\").value = .Range(\"h2\")\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6553832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2b1815f007c30a2ef67111f2398d646?s=128&d=identicon&r=PG&f=1", "display_name": "Tchristian", "link": "https://stackoverflow.com/users/6553832/tchristian"}, "edited": false, "score": 0, "creation_date": 1467836764, "post_id": 38215779, "comment_id": 63887934, "body": "I will implement this an update you on my results. Thank you!"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 1, "user_id": 6553832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2b1815f007c30a2ef67111f2398d646?s=128&d=identicon&r=PG&f=1", "display_name": "Tchristian", "link": "https://stackoverflow.com/users/6553832/tchristian"}, "edited": false, "score": 0, "creation_date": 1467837145, "post_id": 38215779, "comment_id": 63888141, "body": "Sounds good - I added additional idea for you to try - it will prove what&#39;s happening if you add a Debug.Print in the loop to check for the ID"}, {"owner": {"reputation": 1, "user_id": 6553832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2b1815f007c30a2ef67111f2398d646?s=128&d=identicon&r=PG&f=1", "display_name": "Tchristian", "link": "https://stackoverflow.com/users/6553832/tchristian"}, "edited": false, "score": 0, "creation_date": 1467844722, "post_id": 38215779, "comment_id": 63891413, "body": "I&#39;m new to VBA and learning this as I go so an example would be awesome! Thanks for your help"}], "tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1467845582, "last_edit_date": 1467845582, "creation_date": 1467774324, "answer_id": 38215779, "question_id": 38214403, "link": "https://stackoverflow.com/questions/38214403/excel-issue-object-variable-or-with-block-variable-not-set/38215779#38215779", "title": "Excel Issue: Object Variable or with block Variable not set", "body": "<p>I agree with @Thomas Inzina in that it's probably because the document hasn't fully loaded yet.</p>\n\n<p>But I've found with my past projects that the best way to handle these 30% failure rates is to just \"wait a bit longer\" before processing or referring to elements.</p>\n\n<p>Try adding a DoEvents and a Sleep command before you selectedIndex call.\nSee if it makes a difference</p>\n\n<p>At the top of your module (before any subs are declared)</p>\n\n<pre><code>Private Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n</code></pre>\n\n<p>Then add the two lines before you start set the doc variable</p>\n\n<pre><code>Doevents\nSleep 2000 ' Sleep two seconds (2000 ms)\nSet doc = ie.document\n</code></pre>\n\n<p>You can play with the sleep value once you get a number that works for you</p>\n\n<blockquote>\n  <p><strong>EDIT - added solution</strong></p>\n</blockquote>\n\n<p>A more reliable way is to actually run a loop that has DoEvents/Sleep and an incrementing counter for numTries. It exits the loop only when the check for getElementById doesn't fail - or your maxTries counter is reached.</p>\n\n<p>Pretty simple loop but let me know if you need an example</p>\n\n<blockquote>\n  <p><strong>EDIT - EXAMPLE:</strong> A wait until loaded loop</p>\n</blockquote>\n\n<p><strong>Change this</strong></p>\n\n<pre><code>Set drp = HTML.getElementById(\"ctl00$m$g_62853594_bb4b_4cec_8b5c_17fb6abb735e$ff45_1$ctl00    $DropDownChoice\")\ndrp.selectedIndex = CInt(.Range(\"L2\"))\n</code></pre>\n\n<p><strong>To this:</strong></p>\n\n<pre><code>Dim iTries As Integer\nDim iMaxTries As Integer ' it's better to turn this into a const at top of your sub\n\niMaxTries = 3\niTries = 0\nWhile (iTries &lt; iMaxTries) And IsNull(HTML.getElementById(\"ctl00$m$g_62853594_bb4b_4cec_8b5c_17fb6abb735e$ff45_1$ctl00    $DropDownChoice\"))\n    iTries = iTries + 1\n    DoEvents\n    Sleep 750 ' try 3/4 second delays to start with\nWend\n\nIf iTries = iMaxTries Then\n    MsgBox \"Did not load HTML element in \" &amp; iMaxTries &amp; \" tries\"\n    Exit Sub\nEnd If\n\n' Should all be loaded and ready to process now\nSet drp = HTML.getElementById(\"ctl00$m$g_62853594_bb4b_4cec_8b5c_17fb6abb735e$ff45_1$ctl00    $DropDownChoice\")\ndrp.selectedIndex = CInt(.Range(\"L2\"))\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6553832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2b1815f007c30a2ef67111f2398d646?s=128&d=identicon&r=PG&f=1", "display_name": "Tchristian", "link": "https://stackoverflow.com/users/6553832/tchristian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 576, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1467845582, "creation_date": 1467761463, "last_edit_date": 1467763657, "question_id": 38214403, "link": "https://stackoverflow.com/questions/38214403/excel-issue-object-variable-or-with-block-variable-not-set", "title": "Excel Issue: Object Variable or with block Variable not set", "body": "<p>I have a code that works for me about 70% of the time, the other times it throws the <strong>Error</strong> code <strong>91</strong> <strong><code>\"Object Variable or With block Variable not set\"</code></strong>. If i click End and re-run it it will work fine. </p>\n\n<p>The function is taking data that is entered into cells of an excel spreadsheet and populating text boxes, checking radio buttons, and selecting from drop-down lists on a webpage. </p>\n\n<p>I can't post a link to the actual webpage for privacy issues but I'm hoping someone can help me why the error is coming up? </p>\n\n<p>The line that shows the error is \n <strong><code>drp.selectedIndex = Thisworkbook.sheets(\"sheet1\").Range(\"L2\").</code></strong></p>\n\n<pre><code>Sub FillInternetForm()\nDim ie As Object\nSet ie = CreateObject(\"InternetExplorer.Application\")\n\n'set references for copying to submitted reps sheet and deleting for next                  rep\nApplication.ScreenUpdating = False\n\n'create new instance of IE.\n\nie.navigate \"removed for privacy\"\n\n'go to web page listed inside quotes\nie.Visible = True\n\n\nWhile ie.busy\nDoEvents 'wait until IE is done loading page.\nWend\n\n'select onboarding system CRIS or ENS\nSet html = ie.document\nDim drp As HTMLFormElement\nSet drp =     html.getElementById(\"ctl00$m$g_62853594_bb4b_4cec_8b5c_17fb6abb735e$ff45_1$ctl00    $DropDownChoice\")\ndrp.selectedIndex = ThisWorkbook.Sheets(\"sheet1\").Range(\"L2\")\n\n'set address nickname based on value\nSet drp =     html.getElementById(\"ctl00$m$g_62853594_bb4b_4cec_8b5c_17fb6abb735e$ff32_1$ctl00    $Lookup\")\ndrp.selectedIndex = ThisWorkbook.Sheets(\"sheet1\").Range(\"m2\")\n\n'set market based on value\nSet drp =     html.getElementById(\"ctl00$m$g_62853594_bb4b_4cec_8b5c_17fb6abb735e$ff6_1$ctl00$    DropDownChoice\")\ndrp.selectedIndex = ThisWorkbook.Sheets(\"sheet1\").Range(\"e2\")\n\n'check Not moved from another partner\nie.document.getElementById(\"ctl00_m_g_62853594_bb4b_4cec_8b5c_17fb6abb735e_ff46_1_ctl00_ctl01\").Click\n\n'input name and ssn based on excel sheet values\nie.document.all(\"ctl00$m$g_62853594_bb4b_4cec_8b5c_17fb6abb735e$ff3_1$ctl00$ctl00$TextField\").Value = ThisWorkbook.Sheets(\"sheet1\").Range(\"a2\")\nie.document.all(\"ctl00$m$g_62853594_bb4b_4cec_8b5c_17fb6abb735e$ff4_1$ctl00$ctl00$TextField\").Value = ThisWorkbook.Sheets(\"sheet1\").Range(\"b2\")\nie.document.all(\"ctl00$m$g_62853594_bb4b_4cec_8b5c_17fb6abb735e$ff5_1$ctl00$ctl00$TextField\").Value = ThisWorkbook.Sheets(\"sheet1\").Range(\"c2\")\n\n'input extra fields based on ICL value\n'owner\nie.document.all(\"ctl00_m_g_62853594_bb4b_4cec_8b5c_17fb6abb735e_ff11_1_ctl00_ctl00_TextField\").Value = ThisWorkbook.Sheets(\"sheet1\").Range(\"j2\")\n'city\nie.document.all(\"ctl00$m$g_62853594_bb4b_4cec_8b5c_17fb6abb735e$ff14_1$ctl00$ctl00$TextField\").Value = ThisWorkbook.Sheets(\"sheet1\").Range(\"f2\")\n'state\nie.document.all(\"ctl00$m$g_62853594_bb4b_4cec_8b5c_17fb6abb735e$ff15_1$ctl00$ctl00$TextField\").Value = ThisWorkbook.Sheets(\"sheet1\").Range(\"g2\")\n'address\nie.document.all(\"ctl00$m$g_62853594_bb4b_4cec_8b5c_17fb6abb735e$ff13_1$ctl00$ctl00$TextField\").Value = ThisWorkbook.Sheets(\"sheet1\").Range(\"i2\")\n'phone\n    ie.document.all(\"ctl00$m$g_62853594_bb4b_4cec_8b5c_17fb6abb735e$ff10_1$ctl00$ctl00$TextField\").Value = ThisWorkbook.Sheets(\"sheet1\").Range(\"k2\")\n'zip\nie.document.all(\"ctl00$m$g_62853594_bb4b_4cec_8b5c_17fb6abb735e$ff16_1$ctl00$ctl00$TextField\").Value = ThisWorkbook.Sheets(\"sheet1\").Range(\"h2\")\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 880, "user_id": 5279080, "user_type": "registered", "accept_rate": 68, "profile_image": "https://lh5.googleusercontent.com/-LoDm6XYbQug/AAAAAAAAAAI/AAAAAAAAABE/t33anFH2T3I/photo.jpg?sz=128", "display_name": "alilland", "link": "https://stackoverflow.com/users/5279080/alilland"}, "edited": false, "score": 0, "creation_date": 1467844954, "post_id": 38215377, "comment_id": 63891473, "body": "your code works, unfortunately it doesnt work in my application of it :("}, {"owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "reply_to_user": {"reputation": 880, "user_id": 5279080, "user_type": "registered", "accept_rate": 68, "profile_image": "https://lh5.googleusercontent.com/-LoDm6XYbQug/AAAAAAAAAAI/AAAAAAAAABE/t33anFH2T3I/photo.jpg?sz=128", "display_name": "alilland", "link": "https://stackoverflow.com/users/5279080/alilland"}, "edited": false, "score": 0, "creation_date": 1467854654, "post_id": 38215377, "comment_id": 63894051, "body": "Is it something I can help you out with?"}], "tags": [], "owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "is_accepted": false, "score": 2, "last_activity_date": 1467770516, "creation_date": 1467770516, "answer_id": 38215377, "question_id": 38214308, "link": "https://stackoverflow.com/questions/38214308/vba-arrays-and-dynamically-adding-message-errors-to-a-msgbox/38215377#38215377", "title": "vba arrays and dynamically adding message errors to a msgbox", "body": "<p>Alilland, You're oh so close. What you need to do is use <code>ReDim</code> rather than <code>Dim</code>. Using <code>ReDim</code> will allow you to use a non-constant value to define the limits of your array. Thus,</p>\n\n<pre><code>num = 4\nReDim Errors(1 To num) As String\nErrors(1) = \"-Customer is blank on setup sheet\"\nErrors(2) = \"-From is blank on setup sheet\"\nErrors(3) = \"-Attention is blank on setup sheet\"\nErrors(4) = \"-Job Number is blank on setup sheet\"\nFor i = LBound(Errors) To UBound(Errors)\n    msg = msg &amp; Errors(i) &amp; vbNewLine\nNext i\nMsgBox vbNewLine &amp; msg, , \"Missing Info\"\n</code></pre>\n\n<p>Should work just fine for you. If not, please let me know.</p>\n"}], "owner": {"reputation": 880, "user_id": 5279080, "user_type": "registered", "accept_rate": 68, "profile_image": "https://lh5.googleusercontent.com/-LoDm6XYbQug/AAAAAAAAAAI/AAAAAAAAABE/t33anFH2T3I/photo.jpg?sz=128", "display_name": "alilland", "link": "https://stackoverflow.com/users/5279080/alilland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1467770516, "creation_date": 1467760871, "last_edit_date": 1467761398, "question_id": 38214308, "link": "https://stackoverflow.com/questions/38214308/vba-arrays-and-dynamically-adding-message-errors-to-a-msgbox", "title": "vba arrays and dynamically adding message errors to a msgbox", "body": "<p>I am trying to make an array that dynamically holds error messages</p>\n\n<p>the following code works but is not dynamic in any way:</p>\n\n<pre><code>Dim Errors(1 To 4) As String\n\nErrors(1) = \"-Customer is blank on setup sheet\"\nErrors(2) = \"-From is blank on setup sheet\"\nErrors(3) = \"-Attention is blank on setup sheet\"\nErrors(4) = \"-Job Number is blank on setup sheet\"\n\nFor i = LBound(Errors) To UBound(Errors)\n    msg = msg &amp; Errors(i) &amp; vbNewLine\nNext i\nMsgBox vbNewLine &amp; msg, , \"Missing Info\"\n</code></pre>\n\n<p>how can i assign a variable to the variable name?</p>\n\n<p>i am trying to do something like this:</p>\n\n<pre><code>num = 0\nDim Errors(1 To num) As String\n</code></pre>\n\n<p>I am hiding my errors inside if else statements and calling my loop at the end to display the errors. I am unable to use <code>Dim Errors(1 to num) As String</code> because an error is thrown saying \"constant expression is required\"</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1467760293, "post_id": 38214148, "comment_id": 63852018, "body": "Yes it can be done.  But, Stack Overflow is not a code for me service nor is it a teaching site.  Stack Overflow is a place where one can bring code that is flawed and the community will help fix the problem."}, {"owner": {"reputation": 11, "user_id": 6553795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32c314679bd5b5d1293a47a641fc10e2?s=128&d=identicon&r=PG&f=1", "display_name": "Manic31", "link": "https://stackoverflow.com/users/6553795/manic31"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1467765013, "post_id": 38214148, "comment_id": 63853120, "body": "Thanks Scott I think I know its not a code for me service or teaching site, I figured that out alone can you believe that. Also thanks for answering the question at the same time, that&#39;s all i need it to know if it could be done."}], "answers": [{"tags": [], "owner": {"reputation": 447, "user_id": 6476653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q4kG8.jpg?s=128&g=1", "display_name": "Benno Grimm", "link": "https://stackoverflow.com/users/6476653/benno-grimm"}, "is_accepted": false, "score": 0, "last_activity_date": 1467781423, "last_edit_date": 1495541296, "creation_date": 1467781423, "answer_id": 38216614, "question_id": 38214148, "link": "https://stackoverflow.com/questions/38214148/copy-specific-columns-from-excel-worksheet-to-another-worksheet/38216614#38216614", "title": "Copy specific columns from excel worksheet to another worksheet", "body": "<p>Copy the Data can be done like this:</p>\n\n<pre><code>Sheets(\"Data_1\").Range(\"A1:A100\").Copy _ '100 is just an example\nSheets(\"Data_2\").Range(\"A1:A100\")\n</code></pre>\n\n<p>The Problem is, that this would overwrite the the previous entries, so you would have to change the Range every time.</p>\n\n<p>To aviod doing that everytime try following these methods:\n<a href=\"https://stackoverflow.com/questions/38209191/select-different-column-range-excel-vba/38209637#38209637\">Select Different Column Range Excel VBA</a> and increase the values of the columns everytime (to paste it to other cells)</p>\n\n<p>I hope this is helpful, if it's not, just comment :)</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6553795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32c314679bd5b5d1293a47a641fc10e2?s=128&d=identicon&r=PG&f=1", "display_name": "Manic31", "link": "https://stackoverflow.com/users/6553795/manic31"}, "edited": false, "score": 0, "creation_date": 1467891293, "post_id": 38220997, "comment_id": 63909764, "body": "Excellent that would work, I will tweak it and post the end results. thanks!"}], "tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": false, "score": 0, "last_activity_date": 1467798458, "creation_date": 1467798458, "answer_id": 38220997, "question_id": 38214148, "link": "https://stackoverflow.com/questions/38214148/copy-specific-columns-from-excel-worksheet-to-another-worksheet/38220997#38220997", "title": "Copy specific columns from excel worksheet to another worksheet", "body": "<p>Try this:</p>\n\n<pre><code>Sub Demo()\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n    Dim path As String, fileName As String\n    Dim lastRowInput As Long, lastRowOutput As Long, rowCntr As Long, lastColumn As Long\n    Dim inputWS As Worksheet, outputWS As Worksheet\n\n    'set your sheets here\n    Set inputWS = ThisWorkbook.Sheets(\"Data_1\")\n    Set outputWS = ThisWorkbook.Sheets(\"Data_2\")\n    rowCntr = 1\n\n    'get last rows from both sheets\n    lastRowInput = inputWS.Cells(Rows.Count, \"A\").End(xlUp).Row\n    lastRowOutput = outputWS.Cells(Rows.Count, \"A\").End(xlUp).Row\n    lastColumn = inputWS.Cells(1, Columns.Count).End(xlToLeft).Column\n\n    'copy data from columns A, B, E, G, I, J, L and M\n    inputWS.Range(\"A1:B\" &amp; lastRowInput).Copy outputWS.Range(\"A\" &amp; lastRowOutput + 1)\n    inputWS.Range(\"E1:E\" &amp; lastRowInput).Copy outputWS.Range(\"E\" &amp; lastRowOutput + 1)\n    inputWS.Range(\"G1:G\" &amp; lastRowInput).Copy outputWS.Range(\"G\" &amp; lastRowOutput + 1)\n    inputWS.Range(\"I1:J\" &amp; lastRowInput).Copy outputWS.Range(\"I\" &amp; lastRowOutput + 1)\n    inputWS.Range(\"L1:M\" &amp; lastRowInput).Copy outputWS.Range(\"L\" &amp; lastRowOutput + 1)\n\n\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>Instead of copying ranges you can also assign values to ranges as:</p>\n\n<pre><code>Range(outputWS.Cells(lastRowOutput + 1, 1), outputWS.Cells(lastRowOutput + lastRowInput, 2)).Value = Range(inputWS.Cells(1, 1), inputWS.Cells(lastRowInput, 2)).Value\nRange(outputWS.Cells(lastRowOutput + 1, 5), outputWS.Cells(lastRowOutput + lastRowInput, 5)).Value = Range(inputWS.Cells(1, 5), inputWS.Cells(lastRowInput, 5)).Value\nRange(outputWS.Cells(lastRowOutput + 1, 7), outputWS.Cells(lastRowOutput + lastRowInput, 7)).Value = Range(inputWS.Cells(1, 7), inputWS.Cells(lastRowInput, 7)).Value\nRange(outputWS.Cells(lastRowOutput + 1, 9), outputWS.Cells(lastRowOutput + lastRowInput, 10)).Value = Range(inputWS.Cells(1, 9), inputWS.Cells(lastRowInput, 10)).Value\nRange(outputWS.Cells(lastRowOutput + 1, 12), outputWS.Cells(lastRowOutput + lastRowInput, 13)).Value = Range(inputWS.Cells(1, 12), inputWS.Cells(lastRowInput, 13)).Value\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6553795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32c314679bd5b5d1293a47a641fc10e2?s=128&d=identicon&r=PG&f=1", "display_name": "Manic31", "link": "https://stackoverflow.com/users/6553795/manic31"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 776, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1467798458, "creation_date": 1467759688, "question_id": 38214148, "link": "https://stackoverflow.com/questions/38214148/copy-specific-columns-from-excel-worksheet-to-another-worksheet", "title": "Copy specific columns from excel worksheet to another worksheet", "body": "<p>I am new to excel coding, and I was wondering if someone could help me out with this little issue.\nI have an excel workbook with two worksheets Data_1 and Data_2, what I need is some type of VBA code that can copy data from Data_1 worksheet to Data_2 worksheet, however the only columns that I need from Data_1 are A,B,E,G,I,J,L,M without overwriting the previous data on data_2 since this will be updated on a daily basis.\nis this something that can be done?</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "edited": false, "score": 0, "creation_date": 1467771383, "post_id": 38214119, "comment_id": 63854408, "body": "James, I&#39;d like to help you work through this, but I&#39;m having trouble finding where in your code you attempt to work with data in a subsequent column. Can you give me some guidance?"}, {"owner": {"reputation": 17, "user_id": 5994557, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/db0592b55c916f886d55b96b47cdee81?s=128&d=identicon&r=PG", "display_name": "jeden", "link": "https://stackoverflow.com/users/5994557/jeden"}, "reply_to_user": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "edited": false, "score": 0, "creation_date": 1467771976, "post_id": 38214119, "comment_id": 63854514, "body": "Hi Jim, I have tried to start the next column by the line: Range(&quot;A2&quot;).Offset(0, 1).Select. This is where I have tried to start referring to the next column to look in once the tidying up of the data has completed."}], "answers": [{"tags": [], "owner": {"reputation": 17, "user_id": 5994557, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/db0592b55c916f886d55b96b47cdee81?s=128&d=identicon&r=PG", "display_name": "jeden", "link": "https://stackoverflow.com/users/5994557/jeden"}, "is_accepted": false, "score": 0, "last_activity_date": 1467774482, "creation_date": 1467774482, "answer_id": 38215791, "question_id": 38214119, "link": "https://stackoverflow.com/questions/38214119/value-in-one-sheet-and-returning-value-to-right/38215791#38215791", "title": "Value in one sheet and returning value to right", "body": "<p>Just managed to work out where I was going wrong. I had not defined the itemNumber when starting the second loop (variable of .Select, not .Value).</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1467775019, "creation_date": 1467775019, "answer_id": 38215853, "question_id": 38214119, "link": "https://stackoverflow.com/questions/38214119/value-in-one-sheet-and-returning-value-to-right/38215853#38215853", "title": "Value in one sheet and returning value to right", "body": "<p>I refactored your code'</p>\n\n<ul>\n<li>Removed unnecessary cell selections</li>\n<li>Toggle Application.ScreenUpdating to improve speed</li>\n<li>Used Intersect to trim the column reference to fit the data</li>\n<li>Fixed a couple of bad variable assignments</li>\n</ul>\n\n<pre>\n    Option Explicit\n\n    Sub ReturnActions()\n        Application.ScreenUpdating = False\n        Dim itemNumber As String\n        Dim finalRow As Long\n        Dim i As Long\n        Dim ws1 As Worksheet\n        Dim ws2 As Worksheet\n\n        Set ws1 = Worksheets(\"Intermediate_Data\")\n        Set ws2 = Worksheets(\"Final Workings\")\n        Range(\"\").Value = 2\n        itemNumber = ws1.Range(\"A1\").Value\n\n        With ws2\n\n            finalRow = .Range(\"A2\", .Range(\"A\" & Rows.Count).End(xlUp)).Row\n\n            For i = 2 To finalRow\n                If .Cells(i, 1) = itemNumber Then\n                    .Cells(i, 2).Copy\n                    ws1.Range(\"A100000\").End(xlUp).Offset(1, 0).PasteSpecial    'Transpose:=True\n                End If\n\n            Next i\n\n        End With\n\n        'Remove duplicates and blanks from data\n        With Intersect(ws1.Range(\"A:A\"), ws1.UsedRange)\n            .Value = .Value\n            .RemoveDuplicates Columns:=1, Header:=xlYes\n            On Error Resume Next\n            .SpecialCells(xlCellTypeBlanks).Delete xlShiftUp\n            On Error GoTo 0\n        End With\n\n        'Select next column item number\n        itemNumber = ws1.Range(\"B1\").Value\n\n        'For i = 2 To finalRow\n        For i = 2 To ws2.Range(\"B10\").Row\n            If Cells(i, 2) = itemNumber Then\n                ws2.Cells(i, 3).Copy\n                ws1.Range(\"B\" & Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial    'Transpose:=True\n            End If\n\n        Next i\n\n        With Intersect(ws1.Range(\"B:B\"), ws1.UsedRange)\n            .Value = .Value\n            .RemoveDuplicates Columns:=1, Header:=xlYes\n            On Error Resume Next\n            .SpecialCells(xlCellTypeBlanks).Delete xlShiftUp\n            On Error GoTo 0\n        End With\n\n        Application.ScreenUpdating = True\n    End Sub\n</pre>\n"}, {"tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 0, "last_activity_date": 1467778663, "creation_date": 1467778663, "answer_id": 38216259, "question_id": 38214119, "link": "https://stackoverflow.com/questions/38214119/value-in-one-sheet-and-returning-value-to-right/38216259#38216259", "title": "Value in one sheet and returning value to right", "body": "<p>I know you've already accepted an answer but I'll post this anyway, as there may be a simpler way of achieving your task and it may be useful to you in the future.</p>\n\n<p>Just from a sequencing point of view, is there are reason why you wouldn't remove your blank cells all in one go at the start of your project?</p>\n\n<p>From a programming perspective, I feel you may be relying on the automation of key-strokes (ie maro recording) more than you need to. If you read the look-up data source into an array, then you could produce more of a 'pure' VBA solution which would vastly simplify your code.</p>\n\n<p>I'm not sure I precisely understand what you are trying to achieve, but the code below provides an example of how I have interpreted your task. I don't think it would take much to adjust to suit your own needs:</p>\n\n<pre><code>Dim dataSheet As Worksheet, finalSheet As Worksheet\nDim dataColumn As Range, newCell As Range, rng As Range\nDim columnValues As Variant, searchValue As Variant\nDim r As Long, c As Long\n\nSet finalSheet = ThisWorkbook.Worksheets(\"Final Workings\")\nSet dataSheet = ThisWorkbook.Worksheets(\"Intermediate_Data\")\n\n'Remove all the blanks\nApplication.ScreenUpdating = False\nOn Error Resume Next\nSet rng = dataSheet.UsedRange.SpecialCells(xlCellTypeBlanks)\nOn Error GoTo 0\nIf Not rng Is Nothing Then rng.Delete xlShiftUp\n\n'Read the final workings\ncolumnValues = finalSheet.UsedRange.Value2\n\n'Loop through the columns to find values\nc = 1 'this is the column index of your lookup values\nFor Each dataColumn In dataSheet.UsedRange.Columns\n    searchValue = dataColumn.Cells(1).Value2\n    For r = 2 To UBound(columnValues, 1) 'start with 2 because 1 is a header\n        If columnValues(r, c) = searchValue Then\n            'Write value into new cell at bottom of column\n            Set newCell = dataColumn.End(xlDown).Offset(1)\n            newCell.Value = columnValues(r, c + 1)\n            'Delete duplicates\n            dataSheet.Range(dataColumn.Cells(2), newCell).RemoveDuplicates Header:=xlNo\n            Exit For\n        End If\n    Next\n    c = c + 1\nNext\nApplication.ScreenUpdating = True\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 5994557, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/db0592b55c916f886d55b96b47cdee81?s=128&d=identicon&r=PG", "display_name": "jeden", "link": "https://stackoverflow.com/users/5994557/jeden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 38215853, "answer_count": 3, "score": 0, "last_activity_date": 1467778663, "creation_date": 1467759464, "last_edit_date": 1467773875, "question_id": 38214119, "link": "https://stackoverflow.com/questions/38214119/value-in-one-sheet-and-returning-value-to-right", "title": "Value in one sheet and returning value to right", "body": "<p>I've been tasked with creating a macro that will act like a VLOOKUP, but on a wider scale. Basically, we want the macro to look at the value at the top of a column, then search for that value in a different sheets column. If it finds that value, it should return the value in the cell to the immediate right of it. Once done, it should remove any duplicate values and blank cells in that column.</p>\n\n<p>I then need the code to loop to the next column and repeat until there is no more values left to look up. </p>\n\n<p>I can get the first column of data perfectly, but I can't seem to make it work on subsequent columns (loops or direct references). Can anyone point me in the right direction? (Note, I've disabled final row to test the loop on 10 rows only due to the large amount of data in each row).</p>\n\n<pre><code>Option Explicit\n\nSub ReturnActions()\n\n    Dim itemNumber As String\n    Dim finalRow As Integer\n    Dim i As Integer\n    Dim ws1 As Object\n    Dim ws2 As Object\n\n    Set ws1 = Worksheets(\"Intermediate_Data\")\n    Set ws2 = Worksheets(\"Final Workings\")\n\n    ws2.Activate\n\n    Range(\"A2\").Select\n\n    itemNumber = ws1.Range(\"A1\").value\n    finalRow = ws2.Range(ActiveCell, ActiveCell.End(xlUp)).Select\n\n    ws2.Activate\n\n    'For i = 2 To finalRow\n    For i = 2 To ws2.Range(\"A10\").Row\n        If Cells(i, 1) = itemNumber Then\n            ws2.Cells(i, 2).Copy\n            ws1.Range(\"A100000\").End(xlUp).Offset(1, 0).PasteSpecial    'Transpose:=True\n        End If\n\n    Next i\n\n    'Remove duplicates and blanks from data\n    With ws1.Range(\"A:A\")\n        .value = .value\n        .RemoveDuplicates Columns:=1, Header:=xlYes\n        On Error Resume Next\n        .SpecialCells(xlCellTypeBlanks).Delete xlShiftUp\n        On Error GoTo 0\n    End With\n\n    Range(\"A2\").Offset(0, 1).Select\n\n    'Select data worksheet\n    ws1.Activate\n\n    'Select cell A1\n    Range(\"A1\").Select\n\n    'Select next column item number\n    itemNumber = ActiveCell.Offset(0, 1).Select\n\n    'Execute code\n    ws2.Activate\n\n    'For i = 2 To finalRow\n    For i = 2 To ws2.Range(\"B10\").Row\n        If Cells(i, 2) = itemNumber Then\n            ws2.Cells(i, 3).Copy\n            ws1.Range(\"B100000\").End(xlUp).Offset(1, 0).PasteSpecial    'Transpose:=True\n        End If\n\n    Next i\n\n    With ws1.Range(\"B:B\")\n        .value = .value\n        .RemoveDuplicates Columns:=1, Header:=xlYes\n        On Error Resume Next\n        .SpecialCells(xlCellTypeBlanks).Delete xlShiftUp\n        On Error GoTo 0\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1467757122, "post_id": 38213732, "comment_id": 63851144, "body": "<code>I found this VBA on StackOverflow. Thank you.</code> your next step is to study the code you found ^_^"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 6402149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d810e5aa4f8aee32c95d6bfc1b67348?s=128&d=identicon&r=PG&f=1", "display_name": "Rick P", "link": "https://stackoverflow.com/users/6402149/rick-p"}, "edited": false, "score": 0, "creation_date": 1467903070, "post_id": 38213897, "comment_id": 63918565, "body": "Thank you.  What do you mean call it how I want?  Please excuse my ignorance. Part of my lack of knowledge is figuring out how to obtain (call?) the values in a range.  Also, the range will change with each job.  This one has 13.  The next could have 25-100.  Is there a way for me to go through the range and save the values in a variable (or an array)?  I tried running the code you wrote.  It created a new sheet but got an &quot;invalid name in sheet&quot; error.  I changed the line to read &quot;ws.Name = Sheets(&quot;Distribution (3)&quot;).Range(&quot;B2:B14&quot; &amp; i).Value&quot;  &#39; This gives me a type mismatch error."}, {"owner": {"reputation": 2342, "user_id": 6283475, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/s6Dic.jpg?s=128&g=1", "display_name": "KyloRen", "link": "https://stackoverflow.com/users/6283475/kyloren"}, "reply_to_user": {"reputation": 45, "user_id": 6402149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d810e5aa4f8aee32c95d6bfc1b67348?s=128&d=identicon&r=PG&f=1", "display_name": "Rick P", "link": "https://stackoverflow.com/users/6402149/rick-p"}, "edited": false, "score": 0, "creation_date": 1467903224, "post_id": 38213897, "comment_id": 63918676, "body": "@RickP, you could countrol the range via lastrow. Is all the sheets named <code>Sheets(&quot;Distribution (3)&quot;)</code> that you need to copy data from?"}, {"owner": {"reputation": 45, "user_id": 6402149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d810e5aa4f8aee32c95d6bfc1b67348?s=128&d=identicon&r=PG&f=1", "display_name": "Rick P", "link": "https://stackoverflow.com/users/6402149/rick-p"}, "edited": false, "score": 0, "creation_date": 1467903602, "post_id": 38213897, "comment_id": 63918944, "body": "Yes, at least for now.  I will do some research on lastrow.  Thanks."}, {"owner": {"reputation": 2342, "user_id": 6283475, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/s6Dic.jpg?s=128&g=1", "display_name": "KyloRen", "link": "https://stackoverflow.com/users/6283475/kyloren"}, "reply_to_user": {"reputation": 45, "user_id": 6402149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d810e5aa4f8aee32c95d6bfc1b67348?s=128&d=identicon&r=PG&f=1", "display_name": "Rick P", "link": "https://stackoverflow.com/users/6402149/rick-p"}, "edited": false, "score": 0, "creation_date": 1467931921, "post_id": 38213897, "comment_id": 63933958, "body": "@RickP, what I mean by call it is, you can use <code>Call MakeNewTab</code> in another macro. But you don&#39;t have to call it, you can put all the necessary code into this macro and use it that way too."}], "tags": [], "owner": {"reputation": 2342, "user_id": 6283475, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/s6Dic.jpg?s=128&g=1", "display_name": "KyloRen", "link": "https://stackoverflow.com/users/6283475/kyloren"}, "is_accepted": false, "score": 0, "last_activity_date": 1467757954, "creation_date": 1467757954, "answer_id": 38213897, "question_id": 38213732, "link": "https://stackoverflow.com/questions/38213732/vba-to-name-a-new-worksheet-based-on-a-range-of-values-in-a-column/38213897#38213897", "title": "VBA to name a new Worksheet based on a range of values in a column", "body": "<p>What you will need to do is just creat a loop to run through the range you need to create a name from, in your case through the <code>Distribution (3)</code> sheet and the <code>Range(\"B2:B14\")</code>.\n ie the code would look something like this.</p>\n\n<pre><code> Sub MakeNewTab()\n    Dim ws As Worksheet\n\n    For i = 2 To 14\n       Set ws = Sheets.Add(After:=Sheets(Sheets.Count))\n       ws.Name = Sheets(\"Distribution (3)\").Range(\"B\" &amp; i).Value\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Then you would just call it how you want.</p>\n"}, {"comments": [{"owner": {"reputation": 161, "user_id": 7416111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/867203559b28816f0a7a5ff95adf2f6c?s=128&d=identicon&r=PG&f=1", "display_name": "mkinson", "link": "https://stackoverflow.com/users/7416111/mkinson"}, "edited": false, "score": 0, "creation_date": 1484750124, "post_id": 41721882, "comment_id": 70638808, "body": "The reason the above code grabs the value of the second row is because when I built it for my own needs I was transferring data onto another sheet and then deleting the range that contained the information I needed and repeating the next iteration of a loop. For your needs see the comments I wrote in the code above."}], "tags": [], "owner": {"reputation": 161, "user_id": 7416111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/867203559b28816f0a7a5ff95adf2f6c?s=128&d=identicon&r=PG&f=1", "display_name": "mkinson", "link": "https://stackoverflow.com/users/7416111/mkinson"}, "is_accepted": false, "score": 0, "last_activity_date": 1484750011, "last_edit_date": 1484750011, "creation_date": 1484749354, "answer_id": 41721882, "question_id": 38213732, "link": "https://stackoverflow.com/questions/38213732/vba-to-name-a-new-worksheet-based-on-a-range-of-values-in-a-column/41721882#41721882", "title": "VBA to name a new Worksheet based on a range of values in a column", "body": "<p>I actually just made an Excel that does this. I wrote the following:</p>\n\n<pre><code>\n    Dim c as Range\n    Dim d as Range\n    Dim PEndRange As Long\n    Dim Pitem As String\n    Dim PStartRange As Long\n    Dim rng As Range\n    Dim worksh As Long\n\n    Set d = Nothing\n    Set c = Nothing\n\n'first I sort the table\n\n    With Worksheets(\"Sheet1\").Range(\"A1\").EntireRow\n    Set c = .Find(\"HEADER\", LookIn:=xlValues)\n    Set c = Worksheets(\"Sheet1\").Cells(2, c.Column)\n    Set d = .Find(\"VALUE\", LookIn:=xlValues)\nPitem = c.Value\nEnd With\n\n'This grabs the Value of the cell in row 2 of whatever column contains the header you're searching through. You can do a loop and lookup instead using counta of cells(x,c.Column) for x = 2 to lastrow, then define the last row using <pre>ActiveWorkbook.Worksheets(\"Sheet1\").Cells(ActiveWorkbook.Worksheets(\"Import\").Rows.count, \"A\").End(xlUp).Row</pre>, and then from there do a counta on Range(c.address).EntireColumn of that string, then set that value +1 as your range limit, then repeat after setting x as that value.\n\n\n    If (c.EntireColumn.Find(what:=Pitem, lookat:=xlWhole, After:=Cells(2, c.Column)).Row)  0 Then\n    PStartRange = c.EntireColumn.Find(what:=Pitem, After:=Cells(1, c.Column)).Row\n    PEndRange = c.EntireColumn.Find(what:=Pitem, After:=Cells(1, c.Column), searchdirection:=xlPrevious).Row\n\n    worksh = Application.Sheets.count\n    worksheetexists = False\n    For X = 1 To worksh\n        If Worksheets(X).Name = left(Pitem, 29) Then 'trimmed in case string is longer than max allowed for sheet name\n            worksheetexists = True\n            GoTo NextStep:\n            Exit For\n        End If\n    Next X\n\n    Worksheets(\"Template\").Copy After:=Sheets(Sheets.count) 'only if you have a template that already exists, otherwise you can just create a new sheet here\n    Set newsheet = ActiveSheet\n    newsheet.Name = left(Pitem, 29)\n\n    NextStep:\n\n    ActiveWorkbook.Worksheets(left(Pitem, 29)).Activate\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 6402149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d810e5aa4f8aee32c95d6bfc1b67348?s=128&d=identicon&r=PG&f=1", "display_name": "Rick P", "link": "https://stackoverflow.com/users/6402149/rick-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1536, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1484750011, "creation_date": 1467757031, "question_id": 38213732, "link": "https://stackoverflow.com/questions/38213732/vba-to-name-a-new-worksheet-based-on-a-range-of-values-in-a-column", "title": "VBA to name a new Worksheet based on a range of values in a column", "body": "<p>VBA to name a new worksheet based on a range of values in a column\nHi,\n      I am somewhat new to writing VBA.  I spent all weekend working on several pieces and have gotten most of them working.  I am stumped on this part and some other parts.</p>\n\n<p>I am trying to create a new worksheet and name it based on the values in a column on a different worksheet.</p>\n\n<p>For example, On Distribution (3) worksheet, in column B, I have 13 different values.</p>\n\n<p>I want to name the newly created worksheet the text value in cell B2 on the Distribution (3) worksheet.</p>\n\n<p>Then I want to create another worksheet and name it based on the value in B3 on the Distribution (3) worksheet.</p>\n\n<p>OR add x number of worksheets and then name them.</p>\n\n<p>I already figured out the VBA to create x number of worksheets but I have to put in the number of needed worksheets by hand (in the loop).</p>\n\n<p>What could work is to get a count of the values in the B2:B14 range and then add that count of worksheets if I could figure out how to pass that value into existing code.</p>\n\n<p>I have tried saving names to a variable.  (Could be an array for all I know but do not know how to extract the value in each one).  I only know how to print those values to an Immediate window.  See #1 below.</p>\n\n<h1>1 I found this VBA on StackOverflow.  Thank you.</h1>\n\n<pre><code>    Sub RegionNames()\n    Dim DatArr As Range\n    Dim AuxDat As Range\n    Dim CellCnt As Integer\n\n    Set DatArr = _\n    Application.InputBox( _\n    \"Select a contiguous range of cells.\", _\n    \"SelectARAnge Demo\", _\n    Selection.Address, , , , , 8)\n\n    CellCnt = DatArr.Count\n\n    If DatArr.Columns(1).Column &gt; 1 Then  '&lt;&lt;small error trap in case the user     selects column A\n    Set AuxDat = DatArr.Offset.Offset(0, -1)\n    End If\n\n    Debug.Print AuxDat.Count\n    Debug.Print AuxDat(1).Value\n    Debug.Print DatArr(0) ' This is \"Region\"\n    Debug.Print DatArr(1) ' This is \"Atlanta\"\n    Debug.Print DatArr(2) ' ...\n    Debug.Print DatArr(3)\n    Debug.Print DatArr(4)\n    Debug.Print DatArr(5)\n    Debug.Print DatArr(6)\n    Debug.Print DatArr(7)\n    Debug.Print DatArr(8)\n    Debug.Print DatArr(9)\n    Debug.Print DatArr(10)\n    Debug.Print DatArr(11)\n    Debug.Print DatArr(12)\n    Debug.Print DatArr(13)\n    Debug.Print DatArr(14)\n\n    End Sub\n</code></pre>\n\n<h1>2</h1>\n\n<pre><code>    Sub RegionList()\n        Range(\"B2\").Select\n        Range(Selection, Selection.End(xlDown)).Select\n    End Sub\n</code></pre>\n\n<h1>3</h1>\n\n<pre><code>    Sub MakeNewTab()\n    Dim ws As Worksheet\n    'ws.Name = \"NewSheet\"\n\n    Set ws = Sheets.Add(After:=Sheets(Sheets.Count))\n\n    Application.WindowState = xlNormal\n    Sheets(\"Distribution (3)\").Select\n    Sheets(\"Distribution (3)\").Name = \"Distribution (3)\"\n    Range(\"B2:B14\").Select\n    Sheets(\"Sheet4\").Select\n    Sheets(\"Distribution (3)\").Select\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1467756109, "post_id": 38213518, "comment_id": 63850822, "body": "Unrelated but you have<code>InsertMeal</code> then <code>InsertTime</code>? Edit: why not just use loop within <code>InsertMeal</code>?"}, {"owner": {"reputation": 3, "user_id": 6553634, "user_type": "registered", "profile_image": "https://graph.facebook.com/861800237283351/picture?type=large", "display_name": "Li Hongtao", "link": "https://stackoverflow.com/users/6553634/li-hongtao"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1467756738, "post_id": 38213518, "comment_id": 63851030, "body": "sorry I change the 1st function name, but forgot to change the 2nd when I pasted into stackoverflow. Just consider the 2 are the same please."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1467757318, "post_id": 38213518, "comment_id": 63851200, "body": "No comment on the second question? If there&#39;s no reason, don&#39;t call another sub, just loop in the original sub."}, {"owner": {"reputation": 3, "user_id": 6553634, "user_type": "registered", "profile_image": "https://graph.facebook.com/861800237283351/picture?type=large", "display_name": "Li Hongtao", "link": "https://stackoverflow.com/users/6553634/li-hongtao"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1467757636, "post_id": 38213518, "comment_id": 63851287, "body": "but it still won&#39;t end the loop. I think it&#39;s because the <code>ActiveCell.CurrentRegion.Cells</code> always change?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1467757998, "post_id": 38213518, "comment_id": 63851396, "body": "Please edit OP/don&#39;t put code in comments. Edit: yea you want a better loop such as <code>for</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6553634, "user_type": "registered", "profile_image": "https://graph.facebook.com/861800237283351/picture?type=large", "display_name": "Li Hongtao", "link": "https://stackoverflow.com/users/6553634/li-hongtao"}, "edited": false, "score": 0, "creation_date": 1467799067, "post_id": 38214145, "comment_id": 63864734, "body": "It works perfect! You inspired me a lot! Thank you KyloRen. Now I know how to use things like <code>End(xlUp)</code>,<code>Resize()</code>,etc. I also improved your codes so that it can be applied to any selected region. Feel free to leave a comment :D"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1467800423, "post_id": 38214145, "comment_id": 63865489, "body": "Another way is to work backwards from last row to first - <code>For i = lastrow to 1 Step -1</code>.  Inserting rows won&#39;t affect the loop then."}], "tags": [], "owner": {"reputation": 2342, "user_id": 6283475, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/s6Dic.jpg?s=128&g=1", "display_name": "KyloRen", "link": "https://stackoverflow.com/users/6283475/kyloren"}, "is_accepted": true, "score": 0, "last_activity_date": 1467759673, "creation_date": 1467759673, "answer_id": 38214145, "question_id": 38213518, "link": "https://stackoverflow.com/questions/38213518/call-function-to-each-cell-in-a-range-involve-insert-rows-so-the-range-will-ch/38214145#38214145", "title": "call function to each cell in a range (involve insert rows, so the range will change) in Excel VBA", "body": "<p>There really is no need for two functions here. To amend your loop to do what you need, b/c you are adding rows, you will need to nest a small loop inside the other loop that works in you block of <code>3</code> ,<code>Breakfast</code> ,<code>Lunch</code>, and <code>Dinner</code>.</p>\n\n<p>The code would look something like this, but you will have to amend the range to suit your purpose. For example</p>\n\n<pre><code>Sub dave()\n  Dim i As Long\n  Dim lastrow As Long\n  Dim j As Long\n\n   lastrow = Cells(Rows.Count, 1).End(xlUp).Row * 3\n   x = Array(\"Breakfast\", \"Lunch\", \"Dinner\")\n\n  For i = 1 To lastrow\n     Cells(i + 1, 1).Resize(2).EntireRow.Insert\n     For j = 1 To 3\n       Cells(i + j - 1, 3).Value = x(j - 1)\n     Next j\n       Cells(i, 1).Resize(3).Merge: i = i + 2\n  Next i\nEnd Sub\n</code></pre>\n\n<p>BTW, the lastrow will need to be multiplied by 3 as you are addeding rows, so the original lastrow will not reflect the actuall last row when finnished. </p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 6553634, "user_type": "registered", "profile_image": "https://graph.facebook.com/861800237283351/picture?type=large", "display_name": "Li Hongtao", "link": "https://stackoverflow.com/users/6553634/li-hongtao"}, "is_accepted": false, "score": 0, "last_activity_date": 1467799182, "creation_date": 1467799182, "answer_id": 38221248, "question_id": 38213518, "link": "https://stackoverflow.com/questions/38213518/call-function-to-each-cell-in-a-range-involve-insert-rows-so-the-range-will-ch/38221248#38221248", "title": "call function to each cell in a range (involve insert rows, so the range will change) in Excel VBA", "body": "<pre><code>Sub RelativeFunc()\n    col = ActiveCell.Column\n    lastrow = Cells(Rows.Count, col).End(xlUp).Row\n    firstrow = Cells(1, col).End(xlDown).Row\n    rownum = lastrow - firstrow + 1\n    frownum = rownum * 3\n\n    x = Array(\"Breakfast\", \"Lunch\", \"Dinner\")\n\n    For i = 1 To frownum\n        Cells(i + firstrow, col).Resize(2).EntireRow.Insert\n        For j = 1 To 3\n            Cells(firstrow + i - 1 + j - 1, col + 1).Value = x(j - 1)\n        Next j\n        Cells(firstrow + i - 1, col).Resize(3).Merge\n        i = i + 2\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6553634, "user_type": "registered", "profile_image": "https://graph.facebook.com/861800237283351/picture?type=large", "display_name": "Li Hongtao", "link": "https://stackoverflow.com/users/6553634/li-hongtao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 38214145, "answer_count": 2, "score": 0, "last_activity_date": 1467799182, "creation_date": 1467756020, "last_edit_date": 1467756849, "question_id": 38213518, "link": "https://stackoverflow.com/questions/38213518/call-function-to-each-cell-in-a-range-involve-insert-rows-so-the-range-will-ch", "title": "call function to each cell in a range (involve insert rows, so the range will change) in Excel VBA", "body": "<p>I'm learning VBA and have some problems</p>\n\n<p>What I have is a list of date:\n<a href=\"http://i.stack.imgur.com/WOal4.png\" rel=\"nofollow\">picture1</a></p>\n\n<p>What I want to do is add 3 meals for everyday like this\n<a href=\"http://i.stack.imgur.com/fCYei.png\" rel=\"nofollow\">picture2</a></p>\n\n<p>I have recorded a macro which can achieve this:</p>\n\n<pre><code>Sub InsertMeal()\n    ActiveCell.EntireRow.Insert\n    ActiveCell.EntireRow.Insert\n    ActiveCell.Offset(0, 2).Select\n    ActiveCell.FormulaR1C1 = \"Breakfast\"\n    ActiveCell.Offset(1, 0).Select\n    ActiveCell.FormulaR1C1 = \"Lunch\"\n    ActiveCell.Offset(1, 0).Select\n    ActiveCell.FormulaR1C1 = \"Dinner\"\n    ActiveCell.Offset(-2, -2).Range(\"A1:A3\").Select\n    Selection.Merge\nEnd Sub\n</code></pre>\n\n<p>Now I want write a macro, which apply this InsertMeal() function to each cells in selected range.</p>\n\n<p>This is what I wrote</p>\n\n<pre><code>Sub ApplyToAll()\n    For Each c In ActiveCell.CurrentRegion.Cells\n        Call InsertMeal\n        ActiveCell.Offset(1, 0).Select\n    Next\nEnd Sub\n</code></pre>\n\n<p>The problem is, since I insert rows every time, the For loop doesn't work well. The loop never end. Now I don't know how to \"keep the range\" to make the loop work.</p>\n\n<p>Please help if you know how to do this. Thank you, really appreciate.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1467755976, "post_id": 38213410, "comment_id": 63850776, "body": "<code>Split(yourstring,&quot;,&quot;)</code> which will return an array that you then can loop through.  Google will have many examples."}], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1467757157, "post_id": 38213575, "comment_id": 63851155, "body": "oh, you made it community. Didn&#39;t know you could do that^^;"}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1467757428, "post_id": 38213575, "comment_id": 63851232, "body": "@findwindow,yes and  now I know that I can do that"}], "tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": true, "score": 0, "last_activity_date": 1467789780, "last_edit_date": 1467789780, "creation_date": 1467756248, "answer_id": 38213575, "question_id": 38213410, "link": "https://stackoverflow.com/questions/38213410/need-to-get-the-charaters-available-before-comma/38213575#38213575", "title": "Need to get the charaters available before comma", "body": "<p>Try this:</p>\n\n<pre><code>Sub test()\n Dim st As String\n Dim a As Variant\n st = \"AR6, AB4, UUF, ABGtt, UUGyy, AC4, ABF,\"\n a = Split(st, \",\")\n For i = 0 To UBound(a)\n  Debug.Print Left(Trim(a(i)), 3)\n Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6539718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e721b393044987285fe38ecf8a1bdb21?s=128&d=identicon&r=PG&f=1", "display_name": "Anu", "link": "https://stackoverflow.com/users/6539718/anu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 38213575, "answer_count": 1, "score": -2, "last_activity_date": 1467789780, "creation_date": 1467755578, "last_edit_date": 1531164843, "question_id": 38213410, "link": "https://stackoverflow.com/questions/38213410/need-to-get-the-charaters-available-before-comma", "title": "Need to get the charaters available before comma", "body": "<p>Consider if a string has multiple comma's (,) i would like to get the 3 characters that are present before each comma in excel VBA macro. for example in the string \"AR6, AB4, UUF, ABG, UUG, AC4, ABF,\" in this string i would like to get the value of AR6 first then print then second AB4 and so on. the string may contain n number of Commas. Could you please help me to get this.</p>\n"}, {"tags": ["arrays", "vba", "range", "average", "worksheet-function"], "comments": [{"owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "edited": false, "score": 0, "creation_date": 1467753867, "post_id": 38212945, "comment_id": 63849952, "body": "When you step through the code (F8) and watch your range build, does it have the values that you expect it to have?"}, {"owner": {"reputation": 13, "user_id": 5636568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ed2832428decd931c369204bd4789d?s=128&d=identicon&r=PG&f=1", "display_name": "t_martens", "link": "https://stackoverflow.com/users/5636568/t-martens"}, "reply_to_user": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "edited": false, "score": 0, "creation_date": 1467754606, "post_id": 38212945, "comment_id": 63850258, "body": "I&#39;m not sure how to use F8 but when I add the line For r = LBound(rangesForAvg) To UBound(rangesForAvg) \\n Debug.Print rangesForAvg(r) \\n Next r after the for loop, all the right values are in the array."}, {"owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "edited": false, "score": 0, "creation_date": 1467755168, "post_id": 38212945, "comment_id": 63850470, "body": "When you are in the VBE click view/locals to turn on your locals window... it shows the value of each variable as it is during that step of the code. Then put your cursor at the top of your code and press F8 to start going through line by line. ... it is like the debug.print but you don&#39;t need to put it in. You can also hover your cursor over variables to see what they are at the time if they aren&#39;t arrays, ranges, etc."}, {"owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "edited": false, "score": 0, "creation_date": 1467755304, "post_id": 38212945, "comment_id": 63850523, "body": "Are you getting an error in your code, if so, what line is highlighted when it occurs and what error?"}, {"owner": {"reputation": 13, "user_id": 5636568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ed2832428decd931c369204bd4789d?s=128&d=identicon&r=PG&f=1", "display_name": "t_martens", "link": "https://stackoverflow.com/users/5636568/t-martens"}, "reply_to_user": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "edited": false, "score": 0, "creation_date": 1467755687, "post_id": 38212945, "comment_id": 63850658, "body": "Thanks for the explanation @Rodger, all of the expressions seem to be behaving as expected. However, none of my arrays display any values. However, when I use &#39; r = LBound(rangesForAvg) To UBound(rangesForAvg) Debug.Print rangesForAvg(r) Next r&#39; I do get expected values."}, {"owner": {"reputation": 13, "user_id": 5636568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ed2832428decd931c369204bd4789d?s=128&d=identicon&r=PG&f=1", "display_name": "t_martens", "link": "https://stackoverflow.com/users/5636568/t-martens"}, "reply_to_user": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "edited": false, "score": 0, "creation_date": 1467755743, "post_id": 38212945, "comment_id": 63850677, "body": "I am not getting any errors, @Rodger"}, {"owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "edited": false, "score": 0, "creation_date": 1467757467, "post_id": 38212945, "comment_id": 63851245, "body": "Ok, what are the values that you are getting from the array? Just the first few."}, {"owner": {"reputation": 13, "user_id": 5636568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ed2832428decd931c369204bd4789d?s=128&d=identicon&r=PG&f=1", "display_name": "t_martens", "link": "https://stackoverflow.com/users/5636568/t-martens"}, "reply_to_user": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "edited": false, "score": 0, "creation_date": 1467773114, "post_id": 38212945, "comment_id": 63854731, "body": "@Rodger Sorry for the delay. It would be values such as L4:L10, L18:L28, L31:L34. The goal would be to find the average for all ranges in rangesForAvg."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5636568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ed2832428decd931c369204bd4789d?s=128&d=identicon&r=PG&f=1", "display_name": "t_martens", "link": "https://stackoverflow.com/users/5636568/t-martens"}, "edited": false, "score": 0, "creation_date": 1467813116, "post_id": 38216178, "comment_id": 63873284, "body": "Thank you @Tim. It works like a charm. Thank you for also adding the checks and showing the use of application.union."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1467778014, "creation_date": 1467778014, "answer_id": 38216178, "question_id": 38212945, "link": "https://stackoverflow.com/questions/38212945/how-to-apply-worksheetfunction-average-to-a-dynamic-array-in-vba/38216178#38216178", "title": "How to apply WorksheetFunction.Average to a dynamic array in VBA", "body": "<p>Something like this:</p>\n\n<pre><code>Dim upcRange As Range, rngData As Range, rng As Range\n\nWith sht2.Range(\"B:B\") 'week ending column\n\n    Set begin_upc = .Find(upc, LookIn:=xlValues)\n    Set end_upc = .Find(upc, LookIn:=xlValues, SearchDirection:=xlPrevious)\n\n    Set upcRange = sht2.Range(begin_upc, end_upc).Offset(0, -1) 'range for UPCs\n\n    With upcRange\n\n        Set rngData = Nothing\n\n        For r = LBound(starts) To UBound(starts)\n\n            Set begin_date = .Find(starts(r), LookIn:=xlValues)\n            Set end_date = .Find(stops(r), LookIn:=xlValues, SearchDirection:=xlPrevious)\n            Set rng = sht2.Range(\"O\" &amp; begin_date.Row &amp; \":O\" &amp; end_date.Row)\n\n            If rngData Is Nothing Then\n                Set rngData = rng\n            Else\n                Set rngData = Application.Union(rngData, rng)\n            End If\n\n        Next r\n\n        avg_during = WorksheetFunction.Average(rngData)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5636568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ed2832428decd931c369204bd4789d?s=128&d=identicon&r=PG&f=1", "display_name": "t_martens", "link": "https://stackoverflow.com/users/5636568/t-martens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 359, "favorite_count": 0, "accepted_answer_id": 38216178, "answer_count": 1, "score": 0, "last_activity_date": 1467778014, "creation_date": 1467753654, "question_id": 38212945, "link": "https://stackoverflow.com/questions/38212945/how-to-apply-worksheetfunction-average-to-a-dynamic-array-in-vba", "title": "How to apply WorksheetFunction.Average to a dynamic array in VBA", "body": "<p>I'm having trouble applying WorksheetFunction.Average to a dynamic array in VBA. The elements of the array are ranges and I want to be able to compute the average over the entire range of ranges in the dynamic array. I hope that makes sense. (i.e. =average(D14:F15,E17:G17) in the regular formula bar). I did a good amount of research and could not find any answers to my question.</p>\n\n<pre><code>With sht2.Range(\"B:B\") 'week ending column\n            Set begin_upc = .Find(upc, LookIn:=xlValues) 'find the first occurence of the upc\n            Set end_upc = .Find(upc, LookIn:=xlValues, SearchDirection:=xlPrevious)   'find the last occurence of the upc\n            upcRange = \"A\" &amp; Range(begin_upc.Address).Row &amp; \":\" &amp; \"A\" &amp; Range(end_upc.Address).Row 'range for UPCs\n            With sht2.Range(upcRange)\n                For r = LBound(starts) To UBound(starts)\n                    Set begin_date = .Find(starts(r), LookIn:=xlValues) 'starts is an array of start dates for the .find within the UPC range\n                    Set end_date = .Find(stops(r), LookIn:=xlValues, SearchDirection:=xlPrevious) 'stops is an array for the .find within the UPC range\n                    rangeToAvg = \"O\" &amp; Range(begin_date.Address).Row &amp; \":\" &amp; \"O\" &amp; Range(end_date.Address).Row 'format the range\n                    ReDim Preserve rangesForAvg(r) 'resize the array\n                    rangesForAvg(r) = rangeToAvg 'append the range\n                Next r\n                avg_during = WorksheetFunction.Average(sht2.Range(rangesForAvg)) 'this is the line I need help with\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1467753748, "post_id": 38212913, "comment_id": 63849919, "body": "Sounds like you need more <code>if</code> statements."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1467754002, "post_id": 38212913, "comment_id": 63850006, "body": "Or look into <a href=\"http://www.techonthenet.com/excel/formulas/case.php\" rel=\"nofollow noreferrer\"><code>Select Case</code></a> as an <code>If</code> alternative"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1467754510, "post_id": 38212913, "comment_id": 63850220, "body": "I think you would be better served by adding a column that tracks Employee for all rows. So for each spouse and child row it would indicate the Employee. Much like a Foreign Key referencing the same table. This would make much easier to generate reports for this."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1467754952, "post_id": 38212913, "comment_id": 63850403, "body": "Loop backwards with two booleans that reset to false every time it finds &quot;Employee&quot; and deleting as it goes.  When it find &quot;Employee&quot; then it check those booleans and makes the determination of which of the four teirs."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 6553440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7d1c0e2796a180444598b5a6ba6e5f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/6553440/brian"}, "edited": false, "score": 0, "creation_date": 1467840161, "post_id": 38213468, "comment_id": 63889641, "body": "Thanks a ton -- this is almost exactly what I ended up using, logic wise.  Going backwards with the counters really makes it a lot easier."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 17, "user_id": 6553440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7d1c0e2796a180444598b5a6ba6e5f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/6553440/brian"}, "edited": false, "score": 0, "creation_date": 1467841272, "post_id": 38213468, "comment_id": 63890103, "body": "Please consider marking correct by clicking the check mark by the answer. @Brian"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1467761578, "last_edit_date": 1467761578, "creation_date": 1467755846, "answer_id": 38213468, "question_id": 38212913, "link": "https://stackoverflow.com/questions/38212913/vba-code-to-group-and-index/38213468#38213468", "title": "VBA code to group and index", "body": "<p>I decided to use arrays to speed it up a little.</p>\n\n<p>This will also put the Data in E1, which can be changed.</p>\n\n<p>This loops backwards keeping counts until it find \"Employee\"</p>\n\n<pre><code>Sub foo()\nDim inarr() As Variant\nDim oarr() As Variant\nDim ws As Worksheet\nDim cnt As Long\nDim spouse As Integer\nDim child As Integer\n\n\nSet ws = ActiveSheet\n\nWith ws\n    inarr = .Range(\"A2\", .Cells(.Rows.Count, \"B\").End(xlUp)).Value\n    cnt = WorksheetFunction.CountIf(.Range(\"B:B\"), \"Employee\")\n    ReDim oarr(1 To cnt, 1 To 3)\nEnd With\ncnt = 1\nFor i = UBound(inarr, 1) To 1 Step -1\n    Select Case inarr(i, 2)\n        Case \"Spouse\"\n            spouse = spouse + 1\n        Case \"Child\"\n            child = child + 1\n        Case \"Employee\"\n            oarr(cnt, 1) = inarr(i, 1)\n            oarr(cnt, 2) = spouse + child\n            If spouse &gt; 0 And child &gt; 0 Then\n                oarr(cnt, 3) = \"EE+family\"\n            ElseIf spouse &gt; 0 And child = 0 Then\n                oarr(cnt, 3) = \"EE+Spouse\"\n            ElseIf spouse = 0 And child &gt; 0 Then\n                oarr(cnt, 3) = \"EE+Child\"\n            Else\n                oarr(cnt, 3) = \"EE\"\n            End If\n            spouse = 0\n            child = 0\n            cnt = cnt + 1\n    End Select\nNext i\nws.Range(\"E1\").Resize(UBound(oarr, 1), 3).Value = oarr\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/rBwwy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rBwwy.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": true, "score": 0, "last_activity_date": 1467774800, "creation_date": 1467774800, "answer_id": 38215833, "question_id": 38212913, "link": "https://stackoverflow.com/questions/38212913/vba-code-to-group-and-index/38215833#38215833", "title": "VBA code to group and index", "body": "<p>By setting the \"Tier\" to a numerical value, you can change it to text later on. That way, you would get something like this:</p>\n\n<pre><code>Sub dadada()\n  Dim data As Variant, output() As Variant, i As Long, j As Long, mb As VbMsgBoxResult\n  With Sheets(\"sheet1\")\n    data = .[A1].Resize(.Cells(.Rows.Count, 1).End(xlUp).Row, 2).Value2\n    ReDim output(1 To UBound(data), 1 To 3)\n    output(1, 1) = \"Name\"\n    output(1, 2) = \"# Dependents\"\n    output(1, 3) = \"Tier\"\n    j = 1\n    For i = 1 To UBound(data)\n      If data(i, 2) = \"Employee\" Then\n        j = j + 1\n        output(j, 1) = data(i, 1)\n        output(j, 2) = 0\n        output(j, 3) = 0\n      ElseIf data(i, 2) = \"Spouse\" Then\n        output(j, 2) = output(j, 2) + 1\n        output(j, 3) = output(j, 3) Or 1\n      ElseIf data(i, 2) = \"Child\" Then\n        output(j, 2) = output(j, 2) + 1\n        output(j, 3) = output(j, 3) Or 2\n      ElseIf Len(data(i, 2)) Then '&lt;- skip start\n        mb = MsgBox(\"Can't evaluate '\" &amp; data(i, 2) &amp; \"' at row \" &amp; i &amp; \" ('\" &amp; data(i, 1) &amp; \"')!\", vbAbortRetryIgnore + vbApplicationModal + vbCritical, \"Error\")\n        If mb = vbAbort Then Exit Sub\n        If mb = vbRetry Then\n          If MsgBox(\"Is this a new employee?\", vbYesNo) = vbYes Then\n            data(i, 2) = \"Employee\"\n          ElseIf MsgBox(\"Is this a new spose?\", vbYesNo) = vbYes Then\n            data(i, 2) = \"Spouse\"\n          Else\n            MsgBox \"'\" &amp; data(i, 2) &amp; \"' will be used as 'Child'.\"\n            data(i, 2) = \"Child\"\n          End If\n          i = i - 1\n        End If '&lt;- skip end\n      End If\n    Next\n    For i = 2 To j\n      output(i, 3) = \"EE\" &amp; Application.Choose(output(i, 3) + 1, \"\", \"+Spouse\", \"+Child\", \"+Family\")\n    Next\n    .[E1].Resize(i - 1, 3).Value = output\n  End With\nEnd Sub\n</code></pre>\n\n<p>the <code>mb</code> part is optional (so if you do not like it, simply delete all lines between and including <code>skip start</code> and <code>skip end</code>)</p>\n"}], "owner": {"reputation": 17, "user_id": 6553440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7d1c0e2796a180444598b5a6ba6e5f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/6553440/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 0, "accepted_answer_id": 38215833, "answer_count": 2, "score": 0, "last_activity_date": 1467774800, "creation_date": 1467753535, "last_edit_date": 1467753742, "question_id": 38212913, "link": "https://stackoverflow.com/questions/38212913/vba-code-to-group-and-index", "title": "VBA code to group and index", "body": "<p>I'm working on a function of a spreadsheet that will group rows based on a column, and then count the number in each group while also categorizing the group.</p>\n\n<p>I have a list of names and family status such as this:</p>\n\n<pre><code>Bob     Employee    \nLaura   Spouse    \nSteve   Child    \nJim     Employee    \nBrian   Employee    \nAmy     Spouse    \nJon     Employee    \nKelly   Child\n</code></pre>\n\n<p>And I want it to be grouped by employee with a list of dependents and a tiering system.. to look like this</p>\n\n<pre><code>Name     # Dependents    Tier    \nBob           2         EE+Family    \nJim           0         EE    \nBrian         1         EE+Spouse    \nJon           1         EE+Child\n</code></pre>\n\n<p>I had been trying to take a nested if approach </p>\n\n<pre><code>For i=1 to NumberOfRows\n\n  If status(i) = spouse\n\n    go up 1 row increment dependent count &amp; add EE+Spouse, delete row\n\n  Else if status(i) = kid\n\n    go up 1 row increment dependent &amp; add EE+child\n</code></pre>\n\n<p>But this was only working when there was only a child or spouse.. not both.\nAlso forgot to mention the lists will always be ordered with employee first followed by dependents.  Any help is much appreciated!</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1467752048, "post_id": 38212525, "comment_id": 63849171, "body": "<code>I tried using the code the person in the link above</code> please show your code if you like assistance. Edit: you want <code>instr</code>."}], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 4638010, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zU9SMZUvpdI/AAAAAAAAAAI/AAAAAAAAAEU/QLl-vrx2-54/photo.jpg?sz=128", "display_name": "Michael Foster", "link": "https://stackoverflow.com/users/4638010/michael-foster"}, "is_accepted": false, "score": 0, "last_activity_date": 1467752292, "creation_date": 1467752292, "answer_id": 38212608, "question_id": 38212525, "link": "https://stackoverflow.com/questions/38212525/find-column-that-meet-a-criteria-and-copy-other-cells-in-that-row-to-a-new-sheet/38212608#38212608", "title": "Find column that meet a criteria and copy other cells in that row to a new sheet", "body": "<p>I think the function you are looking for is InStr.</p>\n\n<p>The example you posted has this: <code>If cell.Value = \"Card\" Then</code></p>\n\n<p>Instead, you will want something like this: <code>If InStr(cell.Value, \"Prodigy\") &gt; 0 Then</code></p>\n\n<p>Of course, you will probably replace the literal \"Prodigy\" with some cell value or variable.</p>\n"}], "owner": {"reputation": 1, "user_id": 6553317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/decccb1ddeb8fd62e997e2dd29b6e04e?s=128&d=identicon&r=PG&f=1", "display_name": "Bzinck15105", "link": "https://stackoverflow.com/users/6553317/bzinck15105"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467752292, "creation_date": 1467751990, "last_edit_date": 1495542778, "question_id": 38212525, "link": "https://stackoverflow.com/questions/38212525/find-column-that-meet-a-criteria-and-copy-other-cells-in-that-row-to-a-new-sheet", "title": "Find column that meet a criteria and copy other cells in that row to a new sheet", "body": "<p>I'm trying to create a Macro that will find text in a column (D) and if a criteria is met, then copies the row into to another sheet. The Criteria I am looking for will be not be the only text located in the cell.  For Example the criteria could be \"Prodigy\" but the Cell could contain \"Prodigy, Prodigy Tubing Set\".</p>\n\n<p>I have a Sheet called \"Sheet1\" which has all the raw data with headers. The column that has the values to meet the criteria is \"D\".</p>\n\n<p>I have  other sheets where the data will be copied to. For example one of the Sheets will be titled \"Prodigy\", another will be \"Prodigy Tubing Set\".  There will up to 20 other sheets.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/14693566/macro-given-row-x-copy-specific-cells-from-that-row-to-a-new-sheet\">Macro: Given row X copy specific cells from that row to a new sheet</a></p>\n\n<p>I tried using the code the person in the link above built but it would only work if my criteria was the only thing in the cell.</p>\n\n<p><a href=\"https://i.stack.imgur.com/e0Fhf.png\" rel=\"nofollow noreferrer\">A picture of what my spreadsheet will look like is below.</a>\nI am pretty new at this and would appreciate any possible assistance. Hope this makes sense.</p>\n"}, {"tags": ["vba", "loops", "range", "copy-paste"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "edited": false, "score": 0, "creation_date": 1467806824, "post_id": 38214107, "comment_id": 63869112, "body": "I&#39;m  having another issue you might be able to help with, I have three separate macros that I want to combine into one macro by calling each one. In addition, I want there to be pauses between each before running (there is BBRG data I want to fully refresh). However, it doesnt seem to be working."}, {"owner": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "edited": false, "score": 0, "creation_date": 1467806988, "post_id": 38214107, "comment_id": 63869236, "body": "Sub RunAll()  Call ClearContents_RefreshSheet                 Application.Wait (Now + (&quot;00:01:30&quot;))  Call CUSIP_Copy_Paste                   Application.Wait (Now + (&quot;00:00:05&quot;))  Call Copy_Pastee_Data_Into_Vertical_Format  End Sub"}, {"owner": {"reputation": 11, "user_id": 6481130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3a7a4df7eb5d7246ab8c6dc142357c3?s=128&d=identicon&r=PG&f=1", "display_name": "AlexB", "link": "https://stackoverflow.com/users/6481130/alexb"}, "reply_to_user": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "edited": false, "score": 0, "creation_date": 1467830044, "post_id": 38214107, "comment_id": 63884222, "body": "I am not sure if you posted it entirely or if you edited parts, but the correct syntax is (Now() + timevalue(&quot;00:00:005&quot;)) as opposed to Now + (&quot;00:00:05&quot;)"}], "tags": [], "owner": {"reputation": 11, "user_id": 6481130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3a7a4df7eb5d7246ab8c6dc142357c3?s=128&d=identicon&r=PG&f=1", "display_name": "AlexB", "link": "https://stackoverflow.com/users/6481130/alexb"}, "is_accepted": false, "score": 1, "last_activity_date": 1467759415, "creation_date": 1467759415, "answer_id": 38214107, "question_id": 38212398, "link": "https://stackoverflow.com/questions/38212398/copy-pasting-range-of-different-length-using-vba/38214107#38214107", "title": "Copy Pasting Range of different length using VBA", "body": "<p>Your error lies in the final offset. Instead of -5, put in a variable, preferrably the variable which is the difference between the end of the rows count and the beginning, which is always 3.</p>\n\n<p>That is to say, Offset(3 - lastRow, 9)</p>\n\n<p>You almost had it friendo :)</p>\n"}], "owner": {"reputation": 35, "user_id": 6529044, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a5777b5404380740d92e4975ebac8e6e?s=128&d=identicon&r=PG&f=1", "display_name": "markos", "link": "https://stackoverflow.com/users/6529044/markos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 635, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467759415, "creation_date": 1467751471, "question_id": 38212398, "link": "https://stackoverflow.com/questions/38212398/copy-pasting-range-of-different-length-using-vba", "title": "Copy Pasting Range of different length using VBA", "body": "<p><a href=\"http://i.stack.imgur.com/93bt7.png\" rel=\"nofollow\">http://i.stack.imgur.com/93bt7.png</a></p>\n\n<p>Hi,</p>\n\n<p>I am trying to work with a code I have made but am having some trouble.</p>\n\n<p>If you look at my photo above, in cell B3 I have a CUSIP. What I want to do is copy that CUSIP and paste it in each row of info for that CUSIP (so rows A4 till A8). Then I want to move to the second CUSIP in J3 (the CUSIPS are all in row 3 and 8 columns apart) and then paste the CUSIP in rows J4 to J35.</p>\n\n<p>I want to keep doing this over and over for 1000 securities but the issue is that the rows differ in length. </p>\n\n<p>My code is working until I get to the last piece of code which I have put in as a comment. It works but is static. Only works for moving from the 1st to 2nd security then fails. I am trying to think of a dynamic way for me to move from the cell which the CUSIP is last pasted in to the third row and corresponding column everytime (column will be 9 apart every time from the last pasted cell).</p>\n\n<p>Here it is:</p>\n\n<pre><code>Sub CUSIP_Copy_Paste()\n\nDim LastRow As Long\nDim LastCol As Long\nDim c As Long\nDim r As Long\n\nRange(\"B3\").Select\n\n    LastCol = Cells(4, Columns.Count).End(xlToLeft).column\n\nFor c = 2 To LastCol Step 8\n\n    LastRow = Cells(Rows.Count, c).End(xlUp).row\n\n        ActiveCell.Copy\n\n        Cells(4, ActiveCell.Offset(1, -1).column).PasteSpecial xlPasteValues\n\nFor r = 5 To LastRow\n\n    Cells(r, ActiveCell.Offset(1, 0).column).PasteSpecial xlPasteValues\n\nNext r\n\n     ''''''ActiveCell.Offset(-5, 9).Select\n\nNext c\n\nEnd Sub\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "userform"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6552530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b74c562a92b0ac378eead045da682857?s=128&d=identicon&r=PG&f=1", "display_name": "N.Miranda1991", "link": "https://stackoverflow.com/users/6552530/n-miranda1991"}, "edited": false, "score": 0, "creation_date": 1467838474, "post_id": 38212262, "comment_id": 63888790, "body": "When I use that code, I get a runtime error &#39;1004&#39; Application defined or object defined error."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 1, "user_id": 6552530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b74c562a92b0ac378eead045da682857?s=128&d=identicon&r=PG&f=1", "display_name": "N.Miranda1991", "link": "https://stackoverflow.com/users/6552530/n-miranda1991"}, "edited": false, "score": 0, "creation_date": 1467840330, "post_id": 38212262, "comment_id": 63889707, "body": "Where do you declare <code>NextRow</code> and what is it declared as?"}, {"owner": {"reputation": 1, "user_id": 6552530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b74c562a92b0ac378eead045da682857?s=128&d=identicon&r=PG&f=1", "display_name": "N.Miranda1991", "link": "https://stackoverflow.com/users/6552530/n-miranda1991"}, "edited": false, "score": 0, "creation_date": 1467929902, "post_id": 38212262, "comment_id": 63933324, "body": "In each instance where it says RowCount above, I replaced it with NextRow and the code that you suggested."}], "tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": false, "score": 1, "last_activity_date": 1467750890, "creation_date": 1467750890, "answer_id": 38212262, "question_id": 38212162, "link": "https://stackoverflow.com/questions/38212162/excel-userform-to-create-a-summary-line-after-adding-variable-amount-of-lines/38212262#38212262", "title": "Excel userform to create a summary line after adding variable amount of lines", "body": "<p>To put it in the last row change: </p>\n\n<pre><code>NextRow = ws.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row + 1\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>NextRow = ws.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n</code></pre>\n\n<p>The <code>.Offset(1,0)</code> is taking care of making sure it's on the line below the final line of data, so <code>+1</code> isn't necessary.</p>\n"}], "owner": {"reputation": 1, "user_id": 6552530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b74c562a92b0ac378eead045da682857?s=128&d=identicon&r=PG&f=1", "display_name": "N.Miranda1991", "link": "https://stackoverflow.com/users/6552530/n-miranda1991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1497403644, "creation_date": 1467750499, "last_edit_date": 1497403644, "question_id": 38212162, "link": "https://stackoverflow.com/questions/38212162/excel-userform-to-create-a-summary-line-after-adding-variable-amount-of-lines", "title": "Excel userform to create a summary line after adding variable amount of lines", "body": "<p>UPDATED TO ADD NEW CODE !</p>\n\n<p>I have so far created a Userform that allows me to enter between 1 and 10 rows to my Excel spreadsheet based on how many different test results are entered into the user form. This is the code that I have which accomplishes that. </p>\n\n<pre><code>Set ws = Sheets(\"Master\")\nDim NextRow As Long\n\nNextRow = ws.Cells(Rows.Count).End(x1Up).Offset(1, 0).Row\n\nWith Worksheets(\"Master\").Range(\"A1\")\n    .Offset(NextRow, 0).Value = Me.txtTestDate.Value\n    .Offset(NextRow, 1).Value = Me.txtSpraybox.Value\n    .Offset(NextRow, 2).Value = Me.txtRanch.Value\n    .Offset(NextRow, 3).Value = Me.txtFieldBox.Value\n    .Offset(NextRow, 4).Value = Me.txtCommbox.Value\n    .Offset(NextRow, 5).Value = Me.txtVarietybox.Value\n    .Offset(NextRow, 6).Value = \"Countries\"\n    .Offset(NextRow, 8).Value = \"US\"\n    .Offset(NextRow, 9).Value = \"Europe\"\n    .Offset(NextRow, 10).Value = \"Japan\"\n    .Offset(NextRow, 11).Value = \"Canada\"\n    .Offset(NextRow, 12).Value = \"Taiwan\"\n    .Offset(NextRow, 13).Value = \"NZ\"\n    .Offset(NextRow, 14).Value = \"S. Korea\"\n    .Offset(NextRow, 15).Value = \"CX\"\n    .Offset(NextRow, 16).Value = \"RU\"\n    .Offset(NextRow, 17).Value = \"Hong\"\n    .Offset(NextRow, 18).Value = \"Singapore\"\n    .Offset(NextRow, 19).Value = \"Indonesia\"\n    .Offset(NextRow, 20).Value = \"UK\"\n    .Offset(NextRow, 21).Value = \"Germany\"\n    .Offset(NextRow, 22).Value = \"Brazil\"\n    .Offset(NextRow, 23).Value = \"Thailand\"\n    .Offset(NextRow, 24).Value = \"Mexico\"\n    .Offset(NextRow, 25).Value = \"Aus\"\n\n\n\n    If Me.cboChem &lt;&gt; \"\" Then\n        .Offset(NextRow + 1, 6).Value = Me.cboChem.Value\n        .Offset(NextRow + 1, 7).Value = Me.txtResultbox.Value\n    End If\n\n    If Me.cboChem2 &lt;&gt; \"\" Then\n        .Offset(NextRow + 2, 6).Value = Me.cboChem2.Value\n        .Offset(NextRow + 2, 7).Value = Me.txtResultbox2.Value\n    End If\n    If Me.cboChem3 &lt;&gt; \"\" Then\n        .Offset(NextRow + 3, 6).Value = Me.cboChem3.Value\n        .Offset(NextRow + 3, 7).Value = Me.txtResultbox3.Value\n    End If\n    If Me.cboChem4 &lt;&gt; \"\" Then\n        .Offset(NextRow + 4, 6).Value = Me.cboChem4.Value\n        .Offset(NextRow + 4, 7).Value = Me.txtResultbox4.Value\n    End If\n    If Me.cboChem5 &lt;&gt; \"\" Then\n        .Offset(NextRow + 5, 6).Value = Me.cboChem5.Value\n        .Offset(NextRow + 5, 7).Value = Me.txtResultbox5.Value\n    End If\n    If Me.cboChem6 &lt;&gt; \"\" Then\n        .Offset(NextRow + 6, 6).Value = Me.cboChem6.Value\n        .Offset(NextRow + 6, 7).Value = Me.txtResultbox6.Value\n    End If\n    If Me.cboChem7 &lt;&gt; \"\" Then\n        .Offset(NextRow + 7, 6).Value = Me.cboChem7.Value\n        .Offset(NextRow + 7, 7).Value = Me.txtResultbox7.Value\n    End If\n    If Me.cboChem8 &lt;&gt; \"\" Then\n        .Offset(NextRow + 8, 6).Value = Me.cboChem8.Value\n        .Offset(NextRow + 8, 7).Value = Me.txtResultbox8.Value\n    End If\n    If Me.cboChem9 &lt;&gt; \"\" Then\n        .Offset(NextRow + 9, 6).Value = Me.cboChem9.Value\n        .Offset(NextRow + 9, 7).Value = Me.txtResultbox9.Value\n    End If\n    If Me.cboChem10 &lt;&gt; \"\" Then\n        .Offset(NextRow + 10, 6).Value = Me.cboChem10.Value\n        .Offset(NextRow + 10, 7).Value = Me.txtResultbox10.Value\n    End If\nEnd With\n</code></pre>\n\n<p>Now, I would like to add a Summary line inserted after the last filled line each time that \"OK\" is pressed. I have been researching for the last 3 days and haven't really been able to find anything that will accomplish what I want. I also have seen other ways to accomplish what I have already done (I know it's not the best way to do what I want) that look like they would be better ways to do it, but I always get error messages when I try other ways. </p>\n\n<p>I was hoping to use something like:</p>\n\n<pre><code>NextRow = ws.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row + 1\nws.Cells(NextRow, 4).Value = \"Overall\"\n</code></pre>\n\n<p>But it does not place it consistently at the end of the list. I also have been having trouble getting that form of code to work for all of the entries, but I am going to go back and try now, since I just got that code to run without giving an \"Object needed\" type of error message. I have also been getting <code>Error 1004</code>. </p>\n\n<p>I don't have very much background coding knowledge but I have been doing my best to learn as much as I can as I go. Any explanation of what each line does/why it's better than what I have, would be greatly appreciated. </p>\n\n<p>Not related to this question, but is it possible to write code that would allow the <code>userform</code> to read the conditional formatting of the cells after the results are entered and to give a yes/no response to it? For example, I have formatted my table to change to red or green based on each column's limits per the result in a separate column, but sometimes 4-5 rows are part of each test, therefore, I want an overall pass/fail row at the end of each \"test\" that is entered per the user form.</p>\n"}, {"tags": ["sql", "excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1467749995, "post_id": 38212005, "comment_id": 63848010, "body": "Note: The field names are not of my doing"}], "answers": [{"tags": [], "owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "is_accepted": false, "score": 1, "last_activity_date": 1467750986, "creation_date": 1467750986, "answer_id": 38212288, "question_id": 38212005, "link": "https://stackoverflow.com/questions/38212005/syntax-error-insert-into-statement-access-db/38212288#38212288", "title": "Syntax Error INSERT INTO Statement Access DB", "body": "<p>I've found what the issue was. Space found in one of the field names!</p>\n"}], "owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 626, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593958309, "creation_date": 1467749902, "last_edit_date": 1593958309, "question_id": 38212005, "link": "https://stackoverflow.com/questions/38212005/syntax-error-insert-into-statement-access-db", "title": "Syntax Error INSERT INTO Statement Access DB", "body": "<p>Not sure if this specific error has been found, but I cannot see where I have my syntax incorrect with this <code>INSERT INTO</code> statement:</p>\n\n<p>I have split it up into Insert and Values for easier reading. This is a string that is created by VBA and then passed to the connection.</p>\n\n<p>The specific error I'm getting is -2147217900 (8004e14)\n\"Syntax Error in INSERT INTO statement\"</p>\n\n<pre><code>INSERT INTO AS_Processing_2_2 (ImportDate, [Month], [Year], [Plant Name], [Plant Number], PDFReference, a_VAR_FIRSTPROCWOGSMH, a1_BPMH_FIRSTPROCWOGSMH, a2_EFF_ON_44FIRSTPROCWOGSMH, a3_FIRSTPROCWOGSMH_RANK, a4_WB_BPMH_FIRSTPROCWOGSMH, b_BPMH_BY_DEPT_REC_WOG_FIRSTPROCWOGSMH, b1_KILL_BPMH_BY_DEPT_FIRSTPROCWOGSMH, b2_EVISWOG_BPMH_BY_DEPT_FIRSTPROCWOGSMH, b3_WB_EVIS_BPMH_BY_DEPT_FIRSTPROCWOGSMH, c_PRCT_LINE_EFFCY_FIRSTPROCWOGSMH, d_VAR_GIB_HARV_EFFCY_FIRSTPROCWOGSMH, d1_LIVGIZ_HIS_LB_MH_FIRSTPROCWOGSMH, d2_LABORperLB_C__FIRSTPROCWOGSMH, d3_STAFF_per_LINE_FIRSTPROCWOGSMH, e_TOTAL_GIB_RECVR_FIRSTPROCWOGSMH, e1_LIVER_25_FIRSTPROCWOGSMH, e2_GIZ_HT_22_FIRSTPROCWOGSMH, f_NECKSALESnMMat64_FIRSTPROCWOGSMH, g_NBRLines_REC_FIRSTPROCWOGSMH, g1_EVIS NBR_FIRSTPROCWOGSMH, h_WKLY_RUNTIME_SHIFT_FIRSTPROCWOGSMH, i_TYPEPLANTSHIFTS_FIRSTPROCWOGSMH, j_GIBHARVPAY_DEPT_FIRSTPROCWOGSMH, k_LiveBirdWght_FIRSTPROCWOGSMH, k1_RangeLBW_FIRSTPROCWOGSMH)\nVALUES ('7/5/2016 4:00:43 PM', '12', '15', 'EUFAUL', '3060', '2.2', '13', '290', '-0.06', '8', '290', '725', '6889', '520', '520', '99.26', '0', '0', '0', '0', '0', '0', '0', '0', '1', '2', '37.8', '-', 'NO', '4.74', '4.4 - 5.2')\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1467749034, "post_id": 38211743, "comment_id": 63847506, "body": "You can&#39;t use the <code>Workbooks.Open</code> method to open multiple workbooks at once."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1467749198, "post_id": 38211743, "comment_id": 63847596, "body": "Sorry, I see what you are trying to do here now. You want to use <code>DIR()</code> to open the first file form a location."}], "answers": [{"tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": false, "score": 0, "last_activity_date": 1467749311, "creation_date": 1467749311, "answer_id": 38211865, "question_id": 38211743, "link": "https://stackoverflow.com/questions/38211743/open-one-workbook-form-another/38211865#38211865", "title": "open one workbook form another", "body": "<p>If you are trying to open the first file from the directory with \"final.xlsx\" use this:</p>\n\n<pre><code>Workbooks.Open Filename:=\"C:\\Users\\bchitlange\\Desktop\\*final.xlsx\", ReadOnly:=True\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6553319, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KTP0epfMq_4/AAAAAAAAAAI/AAAAAAAAADM/8C_aAUAZLbQ/photo.jpg?sz=128", "display_name": "Bhagyashree Chitlangya", "link": "https://stackoverflow.com/users/6553319/bhagyashree-chitlangya"}, "is_accepted": false, "score": 0, "last_activity_date": 1467842103, "creation_date": 1467842103, "answer_id": 38234430, "question_id": 38211743, "link": "https://stackoverflow.com/questions/38211743/open-one-workbook-form-another/38234430#38234430", "title": "open one workbook form another", "body": "<p>I did realized it later that  VBA will provide me the answer and hence I recorded the macro for that and this is what I got and it works fine</p>\n\n<p>ChDir \"C:\\Users\\bchitlange\\Desktop\\exp\"\nWorkbooks.Open Filename:=\"C:\\Users\\bchitlange\\Desktop\\exp\\dest.xlsm\"</p>\n\n<p>Thanks</p>\n"}], "owner": {"reputation": 11, "user_id": 6553319, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KTP0epfMq_4/AAAAAAAAAAI/AAAAAAAAADM/8C_aAUAZLbQ/photo.jpg?sz=128", "display_name": "Bhagyashree Chitlangya", "link": "https://stackoverflow.com/users/6553319/bhagyashree-chitlangya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1505608802, "creation_date": 1467748818, "last_edit_date": 1505608802, "question_id": 38211743, "link": "https://stackoverflow.com/questions/38211743/open-one-workbook-form-another", "title": "open one workbook form another", "body": "<p>I am trying to open one workbook from another workbook programmatically, I have tried a lot of forums, but I have written this code with the help of your forum only .</p>\n\n<pre><code>Sub emptycell()\nDim strfilepath As String\nstrfilepath = \"C:\\Users\\bchitlange\\Desktop\"\n\nDim strfilename As String\nstrfilename = \"*final.xlsx\"\n\nWorkbooks.Open Filename:=\"C:\\Users\\bchitlange\\Desktop\" &amp; Dir$(\"C:\\Users\\bchitlange\\Desktop\" &amp; \"*final.xlsx\"), ReadOnly:=True\n\n\nEnd Sub\n</code></pre>\n\n<p>When my files are saved on desktop it gives me an error of cannot access desktop.</p>\n\n<p>and when they are stored in drive it gives the following error - </p>\n\n<p><code>run time error 1004 application defined or object defined error</code></p>\n"}, {"tags": ["html", "vba", "excel", "internet-explorer"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1467748699, "post_id": 38211642, "comment_id": 63847321, "body": "Why are you using the object collection index when you are already looping through the object collection with the <code>obj</code> variable? Also you are not incrementing <code>i</code> through each loop."}], "answers": [{"tags": [], "owner": {"reputation": 1192, "user_id": 1744727, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8d02d3ecefb127c4467e9328308ffb12?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/1744727/david"}, "is_accepted": false, "score": 2, "last_activity_date": 1467748659, "creation_date": 1467748659, "answer_id": 38211703, "question_id": 38211642, "link": "https://stackoverflow.com/questions/38211642/using-vba-and-internet-explorer-to-parse-html/38211703#38211703", "title": "Using VBA and Internet Explorer to Parse HTML", "body": "<p>What about...</p>\n\n<pre><code>Dim objCollection As Object\nSet objCollection = IE.Document.getElementsbyTagName(\"a\")\n\nFor Each obj In objCollection\n    If obj.ID = \"go\" Then\n        obj.Click\n        Exit For\n    End If\nNext obj\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "is_accepted": false, "score": 0, "last_activity_date": 1467750228, "last_edit_date": 1467750228, "creation_date": 1467749843, "answer_id": 38211992, "question_id": 38211642, "link": "https://stackoverflow.com/questions/38211642/using-vba-and-internet-explorer-to-parse-html/38211992#38211992", "title": "Using VBA and Internet Explorer to Parse HTML", "body": "<p>If you have an html object having an <code>Id</code> you can get it direcly with something like this:  </p>\n\n<pre><code>Dim GoObj As Object\nSet GoObj = IE.Document.getElementbyId(\"go\")\n'Only if it was found you click it\nIf not GoObj is Nothing then\n    GoObj.Click\nEnd If\n</code></pre>\n\n<p>Pay attention to the difference between element in <code>getElementbyId</code> and element<strong>s</strong> in <code>getElementsByTagName</code></p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1468496372, "creation_date": 1468496372, "answer_id": 38373218, "question_id": 38211642, "link": "https://stackoverflow.com/questions/38211642/using-vba-and-internet-explorer-to-parse-html/38373218#38373218", "title": "Using VBA and Internet Explorer to Parse HTML", "body": "<p>This is a great example of how to do exactly that.</p>\n\n<pre><code>Dim HTMLDoc As HTMLDocument\nDim oBrowser As InternetExplorer\nSub Login_2_Website()\n\nDim oHTML_Element As IHTMLElement\nDim sURL As String\n\nOn Error GoTo Err_Clear\nsURL = \"https://www.google.com/accounts/Login\"\nSet oBrowser = New InternetExplorer\noBrowser.Silent = True\noBrowser.timeout = 60\noBrowser.navigate sURL\noBrowser.Visible = True\n\nDo\n' Wait till the Browser is loaded\nLoop Until oBrowser.readyState = READYSTATE_COMPLETE\n\nSet HTMLDoc = oBrowser.Document\n\nHTMLDoc.all.Email.Value = \"sample@vbadud.com\"\nHTMLDoc.all.passwd.Value = \"*****\"\n\nFor Each oHTML_Element In HTMLDoc.getElementsByTagName(\"input\")\nIf oHTML_Element.Type = \"submit\" Then oHTML_Element.Click: Exit For\nNext\n\n' oBrowser.Refresh ' Refresh If Needed\nErr_Clear:\nIf Err &lt;&gt; 0 Then\nDebug.Assert Err = 0\nErr.Clear\nResume Next\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Read more at: <a href=\"http://vbadud.blogspot.com/2009/08/how-to-login-to-website-using-vba.html#XwwFWylLQi9rjILC.99\" rel=\"nofollow\">http://vbadud.blogspot.com/2009/08/how-to-login-to-website-using-vba.html#XwwFWylLQi9rjILC.99</a></p>\n"}], "owner": {"reputation": 1, "user_id": 6534692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de0be50965cfeffb2058affdf80c08c9?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Lanier", "link": "https://stackoverflow.com/users/6534692/benjamin-lanier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 915, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1468496372, "creation_date": 1467748432, "question_id": 38211642, "link": "https://stackoverflow.com/questions/38211642/using-vba-and-internet-explorer-to-parse-html", "title": "Using VBA and Internet Explorer to Parse HTML", "body": "<p>I am trying to use VBA code to click a \"Go\" button on a website. This is the source code.</p>\n\n<pre><code> &lt;div class=\"actions\"&gt; \n  &lt;a id=\"go\" href=\"javascript:void(null);\" title=\"Go\"&gt;&lt;img src=\"/images/button-go-smaller.png\"&gt;&lt;/a&gt;\n   &lt;a id=\"reset\" href=\"javascript:void(null);\" title=\"Reset All Fields\"&gt;&lt;img src=\"/images/button-reset_all.png\"&gt;&lt;/a&gt;\n                    &lt;/div&gt;\n</code></pre>\n\n<p>This is my VBA code:</p>\n\n<pre><code>For Each obj In objCollection\n     If objCollection(i).ID = \"go\" Then\n        Set objElement = obj\nExit For\n    End If\nNext obj\nobjElement.Click\n</code></pre>\n\n<p>However, on the  objElement.Click line, I get an error 91, which means that the \"go\" action cannot be found. Why is that, and how can I access the go button?</p>\n"}]