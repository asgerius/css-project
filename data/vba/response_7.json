[{"tags": ["excel", "vba", "selenium"], "comments": [{"owner": {"reputation": 15014, "user_id": 3821981, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/QKE9Z.jpg?s=128&g=1", "display_name": "Saifur", "link": "https://stackoverflow.com/users/3821981/saifur"}, "edited": false, "score": 0, "creation_date": 1424908534, "post_id": 28731999, "comment_id": 45750042, "body": "Which line throws exception?"}, {"owner": {"reputation": 73, "user_id": 4567963, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3e1f3d0c87f058b397afc58377fd2a22?s=128&d=identicon&r=PG", "display_name": "Spencer Cloud", "link": "https://stackoverflow.com/users/4567963/spencer-cloud"}, "reply_to_user": {"reputation": 15014, "user_id": 3821981, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/QKE9Z.jpg?s=128&g=1", "display_name": "Saifur", "link": "https://stackoverflow.com/users/3821981/saifur"}, "edited": false, "score": 0, "creation_date": 1424992542, "post_id": 28731999, "comment_id": 45790910, "body": "@Saifur the line: <code>If driver.verifyTextPresent(invoice) = True Then</code> is giving me the problem"}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 4567963, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3e1f3d0c87f058b397afc58377fd2a22?s=128&d=identicon&r=PG", "display_name": "Spencer Cloud", "link": "https://stackoverflow.com/users/4567963/spencer-cloud"}, "edited": false, "score": 0, "creation_date": 1424994377, "post_id": 28732176, "comment_id": 45791451, "body": "Thanks for the suggestion. I tried <code>If driver.findElementByXPath(&quot;&#47;&#47;d[.=invoice]&quot;).Size() &gt; 0 Then</code> but I get an error message saying &quot;Compile error: Type mismatch&quot; which then highlights the &quot;&gt;&quot;. Do you know why this is happening?"}, {"owner": {"reputation": 15014, "user_id": 3821981, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/QKE9Z.jpg?s=128&g=1", "display_name": "Saifur", "link": "https://stackoverflow.com/users/3821981/saifur"}, "reply_to_user": {"reputation": 73, "user_id": 4567963, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3e1f3d0c87f058b397afc58377fd2a22?s=128&d=identicon&r=PG", "display_name": "Spencer Cloud", "link": "https://stackoverflow.com/users/4567963/spencer-cloud"}, "edited": false, "score": 0, "creation_date": 1424994897, "post_id": 28732176, "comment_id": 45791617, "body": "Actually do <code>driver.findElementsByXPath(&quot;&#47;&#47;td[.=&#39;Text to be verified&#39;]&quot;).size() &gt; 0</code>"}, {"owner": {"reputation": 15014, "user_id": 3821981, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/QKE9Z.jpg?s=128&g=1", "display_name": "Saifur", "link": "https://stackoverflow.com/users/3821981/saifur"}, "reply_to_user": {"reputation": 73, "user_id": 4567963, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3e1f3d0c87f058b397afc58377fd2a22?s=128&d=identicon&r=PG", "display_name": "Spencer Cloud", "link": "https://stackoverflow.com/users/4567963/spencer-cloud"}, "edited": false, "score": 0, "creation_date": 1424994918, "post_id": 28732176, "comment_id": 45791626, "body": "Sorry, not very familiar with Seleniium <code>VBA</code>"}], "tags": [], "owner": {"reputation": 15014, "user_id": 3821981, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/QKE9Z.jpg?s=128&g=1", "display_name": "Saifur", "link": "https://stackoverflow.com/users/3821981/saifur"}, "is_accepted": false, "score": 0, "last_activity_date": 1424909465, "last_edit_date": 1424909465, "creation_date": 1424909155, "answer_id": 28732176, "question_id": 28731999, "link": "https://stackoverflow.com/questions/28731999/need-to-verify-text-in-table-cell-using-selenium-wrapper-for-visual-basic/28732176#28732176", "title": "Need to verify text in table cell using Selenium Wrapper for Visual Basic", "body": "<p>It has been long time I wrote any <code>VBA</code> code. However yours problem look simple.</p>\n\n<pre><code>Sub SearchForInvoice()\n    Dim driver As New SeleniumWrapper.WebDriver\n    Dim invoice As String\n\n    invoice = \"Text to be verified\"\n\n    'You are doing driver.verifyTextPresent on driver itself. It should be on an element instead.\n    'Or, simply finding the element with text based xpath search is enough as well.\n\n    If driver.findElementByXPath(\"//td[.='Text to be verified']\").size() &gt; 0 Then\n\n       MsgBox(\"Success\")\n\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 4567963, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3e1f3d0c87f058b397afc58377fd2a22?s=128&d=identicon&r=PG", "display_name": "Spencer Cloud", "link": "https://stackoverflow.com/users/4567963/spencer-cloud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 731, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1424909465, "creation_date": 1424908177, "question_id": 28731999, "link": "https://stackoverflow.com/questions/28731999/need-to-verify-text-in-table-cell-using-selenium-wrapper-for-visual-basic", "title": "Need to verify text in table cell using Selenium Wrapper for Visual Basic", "body": "<p>I am using the Selenium Wrapper for Visual Basic to automate a Chrome browser.</p>\n\n<p>I need to verify text in a table based on a string in a previously stored string variable (invoice).</p>\n\n<p>Simplified HTML example:</p>\n\n<pre><code>&lt;th scope=\"row\" class=\" dataCell  \"&gt;\n&lt;a href=\"link-to-follow\" onclick=\"searchResultClick.mousedown(this, event)\" onmousedown=\"searchResultClick.mousedown(this, event)\"&gt;Link Text&lt;/a&gt;\n&lt;/th&gt;\n&lt;td class=\" dataCell  \"&gt;Text to be verified&lt;/td&gt;\n&lt;td class=\" dataCell  \"&gt;&amp;nbsp;&lt;/td&gt;\n</code></pre>\n\n<p>I've tried this in Excel VBA to no avail:</p>\n\n<pre><code>Sub SearchForInvoice()\nDim driver As New SeleniumWrapper.WebDriver\nDim invoice As String\ninvoice = \"Text to be verified\"\nIf driver.verifyTextPresent(invoice) = True Then\n   MsgBox(\"Success\")\nElse\nEnd If\nEnd Sub\n</code></pre>\n\n<p>An error message shows up saying \"Runtime Error '13': Type mismatch\"</p>\n\n<p>Thanks in advance for any help that can be offered. Still fairly new to programming.</p>\n"}, {"tags": ["vba", "email", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 2427395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a33b590ef639e143e40cf80df196ce1a?s=128&d=identicon&r=PG", "display_name": "DawnTreader", "link": "https://stackoverflow.com/users/2427395/dawntreader"}, "edited": false, "score": 0, "creation_date": 1424965136, "post_id": 28732302, "comment_id": 45775387, "body": "I found those schemas properties in other forums and posts but I couldn&#39;t find a definitive list that gave me a property to use for what I wanted. Are they fully documented somewhere or does Microsoft expect us to figure them out on our own?"}, {"owner": {"reputation": 111, "user_id": 2427395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a33b590ef639e143e40cf80df196ce1a?s=128&d=identicon&r=PG", "display_name": "DawnTreader", "link": "https://stackoverflow.com/users/2427395/dawntreader"}, "edited": false, "score": 0, "creation_date": 1424966444, "post_id": 28732302, "comment_id": 45776358, "body": "Rats... Took too long to edit the previous comment.   The mailitem.userproperties would be set where? And is adding my own property possible from Access or does it need to be done in Outlook? This reporting utility is all in Access.  Would objMailItem.PropertyAccessor.GetProperty(&quot;<a href=\"Http://schemas.microsoft.com/mapi/proptag/0x300b0102&quot;\" rel=\"nofollow noreferrer\">Http://schemas.mic&zwnj;&#8203;rosoft.com/mapi/prop&zwnj;&#8203;tag/0x300b0102&quot;</a>) be available in Access? Or is that code that only works in Outlook?  If I added a property to the objMailItem from Access, would it stick with the email no matter what? If it was moved from one folder to another would it loose that property?"}, {"owner": {"reputation": 111, "user_id": 2427395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a33b590ef639e143e40cf80df196ce1a?s=128&d=identicon&r=PG", "display_name": "DawnTreader", "link": "https://stackoverflow.com/users/2427395/dawntreader"}, "edited": false, "score": 0, "creation_date": 1424975352, "post_id": 28732302, "comment_id": 45781895, "body": "In looking for the quickest solution to my problem I am wondering if there is a way to set something on the exchange server that would create a unchangeable unique ID?  If not would it be helpful to create a &quot;macro&quot; that runs on all received email in the outlook client that would add a field that stores an unchangeable unique identifier that I could then import into Access. We have an AD Account that is logged into on a computer that runs 24/7 with an Outlook client open to cause rules to run on the incoming emails. I could add the macro there and get it to &quot;tag&quot; each incoming email."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 111, "user_id": 2427395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a33b590ef639e143e40cf80df196ce1a?s=128&d=identicon&r=PG", "display_name": "DawnTreader", "link": "https://stackoverflow.com/users/2427395/dawntreader"}, "edited": false, "score": 0, "creation_date": 1425045795, "post_id": 28732302, "comment_id": 45812607, "body": "No, there is no such Exchaneg server setting. What is wrong with a user property or PR_SEARCH_KEY?"}, {"owner": {"reputation": 111, "user_id": 2427395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a33b590ef639e143e40cf80df196ce1a?s=128&d=identicon&r=PG", "display_name": "DawnTreader", "link": "https://stackoverflow.com/users/2427395/dawntreader"}, "edited": false, "score": 0, "creation_date": 1425055976, "post_id": 28732302, "comment_id": 45818920, "body": "Nothing, although I am not sure how to use it and I was hoping to avoid have to code something if I didn&#39;t have to. Looking at the link, what does &quot;changeable by client after a copy&quot; mean? My feeling is that this Property is no more reliable than the entryid or the recordkey if the email is moved from one folder to another... I need a rock solid always the same ID field. It baffles me that there isn&#39;t such a thing in Outlook."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 111, "user_id": 2427395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a33b590ef639e143e40cf80df196ce1a?s=128&d=identicon&r=PG", "display_name": "DawnTreader", "link": "https://stackoverflow.com/users/2427395/dawntreader"}, "edited": false, "score": 0, "creation_date": 1425056129, "post_id": 28732302, "comment_id": 45819015, "body": "Nothing is rock solid. Some store providers (IMAP) do not support moves, so a message is created in the new folder and its properties are copied.&quot;changeable by client&quot; means you can change it if you want."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 3, "last_activity_date": 1599020273, "last_edit_date": 1599020273, "creation_date": 1424909944, "answer_id": 28732302, "question_id": 28731643, "link": "https://stackoverflow.com/questions/28731643/how-to-uniquely-identify-an-outlook-email-as-mailitem-entryid-changes-when-email/28732302#28732302", "title": "How to uniquely identify an Outlook email as MailItem.EntryID changes when email is moved", "body": "<p>You can use the <code>PR_SEARCH_KEY</code> property (DASL name <code>http://schemas.microsoft.com/mapi/proptag/0x300B0102</code>) - it does not change when a message is moved. It can be accessed through MailItem.PropertyAccessor.GetProperty, but unfortunately you cannot use PT_BINARY properties in Items.Find/Restrict.</p>\n<p>You can also set your own named property using MailItem.UserProperties.</p>\n<p><strong>UPDATE:</strong></p>\n<p>For <code>PR_SEARCH_KEY</code>, see <a href=\"https://msdn.microsoft.com/en-us/library/office/cc815908.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/cc815908.aspx</a>.</p>\n<p><code>MaillItem.UserProperties</code> can be used from anywhere - Outlook Object Model is Outlook Object Model whether it is used from inside Outlook or externally from Excel. Keep in mind that setting a user property and daving the item will change its last modified date.</p>\n<p>If you want to stick to PR_SEARCH_KEY, to be be able to sort on it, you might want to look at <a href=\"http://www.dimastr.com/redemption\" rel=\"nofollow noreferrer\">Redemption</a> - its <a href=\"http://www.dimastr.com/redemption/RDOItems.htm\" rel=\"nofollow noreferrer\">RDOFolder.Items</a>.Find / Restrict methods allow PT_BINARY properties in its queries, e.g. <code>&quot;http://schemas.microsoft.com/mapi/proptag/0x300B0102&quot; = '89F75D48972B384EB2C50266D1541099' </code></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8728049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/232bbd2cbf04a728f33dcfde91121659?s=128&d=identicon&r=PG", "display_name": "Colin Carter", "link": "https://stackoverflow.com/users/8728049/colin-carter"}, "is_accepted": false, "score": 1, "last_activity_date": 1507224979, "creation_date": 1507224979, "answer_id": 46591686, "question_id": 28731643, "link": "https://stackoverflow.com/questions/28731643/how-to-uniquely-identify-an-outlook-email-as-mailitem-entryid-changes-when-email/46591686#46591686", "title": "How to uniquely identify an Outlook email as MailItem.EntryID changes when email is moved", "body": "<p>Here is VBA code tested in MS Access 2013 to extract the PR_SEARCH_KEY from an Outlook.MailItem and convert to a string:</p>\n\n<pre><code>Public Function strGetMailItemUniqueId( _\n    olMailItem As Outlook.MailItem _\n) As String\n    Dim PR_SEARCH_KEY As String\n    PR_SEARCH_KEY = \"http://schemas.microsoft.com/mapi/proptag/0x300B0102\"\n\n    Dim olPA As Outlook.PropertyAccessor\n    Set olPA = olMailItem.PropertyAccessor\n\n    Dim vBinary As Variant\n    vBinary = olPA.GetProperty(PR_SEARCH_KEY)\n\n    strGetMailItemUniqueId = olPA.BinaryToString(vBinary)\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 150, "user_id": 11743048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0de1bfde2162e2f91b9cffa16a2f4fa3?s=128&d=identicon&r=PG&f=1", "display_name": "VAT", "link": "https://stackoverflow.com/users/11743048/vat"}, "is_accepted": false, "score": 0, "last_activity_date": 1575964207, "creation_date": 1575964207, "answer_id": 59262497, "question_id": 28731643, "link": "https://stackoverflow.com/questions/28731643/how-to-uniquely-identify-an-outlook-email-as-mailitem-entryid-changes-when-email/59262497#59262497", "title": "How to uniquely identify an Outlook email as MailItem.EntryID changes when email is moved", "body": "<p>In Microsoft Outlook versions like 2007, 2010, Office 365 etc. there is a property <code>Message-ID</code> in the headers section of the email. </p>\n\n<p>You can use this property to uniquely identify an email.</p>\n\n<p><a href=\"https://i.stack.imgur.com/c5fU6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/c5fU6.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 111, "user_id": 2427395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a33b590ef639e143e40cf80df196ce1a?s=128&d=identicon&r=PG", "display_name": "DawnTreader", "link": "https://stackoverflow.com/users/2427395/dawntreader"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8496, "favorite_count": 1, "answer_count": 3, "score": 3, "last_activity_date": 1599020273, "creation_date": 1424906437, "question_id": 28731643, "link": "https://stackoverflow.com/questions/28731643/how-to-uniquely-identify-an-outlook-email-as-mailitem-entryid-changes-when-email", "title": "How to uniquely identify an Outlook email as MailItem.EntryID changes when email is moved", "body": "<p>My company uses a single email address for customers to send requests and orders to. we created an Access database that import emails into a table. The table creates it's own unique identifier for each email imported but is not supposed to import an email twice. The system was working as we were only concerned with emails coming into the inbox and didn't need anything more than that.</p>\n\n<p>However we now need to know the \"flow\", \"traffic\" and \"workload\" of the email pool that this account is. The email that comes into the inbox is categorized and then moved to a folder called \"my_tasks\" and a subfolder the folder named as 1 of the four CSRs to be worked on by a manager. This email is then dealt with and the CSR moves it to a subfolder under another folder called \"Completed\".</p>\n\n<p>So email comes into Inbox, gets moved to my_tasks\\joeblow is dealt with and gets moved to Completed\\Canada.</p>\n\n<p>Currently I have code that iterates through the folders and finds each email, grabs the fields we want to store and then inserts them into the table. All of this is done in Access through VBA code.</p>\n\n<pre><code>Private Sub ImportEmailItem(objMailItem As Outlook.MailItem)\nOn Error GoTo ImportEmailItem_Error\n\n    ' Set up DAO objects\n    Dim rstMB As DAO.Recordset\n    Dim dskippedFolderMailCount As Double\n    Dim strSQLrMB As String\n\n    strSQLrMB = \"SELECT * FROM tblMailBox WHERE OLID='\" &amp; objMailItem.EntryID &amp; \"'\"\n\n    Set rstMB = CurrentDb.OpenRecordset(strSQLrMB)\n\n        With rstMB\n            If Not .BOF And Not .EOF Then\n\n                .MoveLast\n                .MoveFirst\n                While (Not .EOF)\n                    If .Updatable Then\n                        .Edit\n                            rstMB!Subject = objMailItem.Subject\n                            rstMB!Body = objMailItem.Body\n\n                            Call subCategory(objMailItem)\n\n                            rstMB!CSR = IIf(Len(objMailItem.Categories) = 0, \"Unassigned\", objMailItem.Categories)\n                            rstMB!Importance = objMailItem.Importance\n                            rstMB!Region = objMailItem.Parent\n                            rstMB!DateModified = objMailItem.LastModificationTime\n                            rstMB!FlagCompleted = objMailItem.FlagRequest\n                            rstMB!folder = objMailItem.Parent\n                            rstMB!Path = objMailItem\n                        .Update\n                    End If\n                .MoveNext\n                Wend\n            Else\n                rstMB.AddNew\n                    rstMB!olid = objMailItem.EntryID\n                    rstMB!ConversationIndex = objMailItem.ConversationIndex\n                    rstMB!ConversationID = objMailItem.ConversationID\n                    rstMB!Conversation = objMailItem.ConversationTopic\n                    rstMB!To = Left(objMailItem.To, 250)\n                    rstMB!CC = Left(objMailItem.CC, 250)\n                    rstMB!Subject = objMailItem.Subject\n                    rstMB!Body = objMailItem.Body\n\n                    Call subCategory(objMailItem)\n\n                    rstMB!CSR = IIf(Len(objMailItem.Categories) = 0, \"Unassigned\", objMailItem.Categories)\n                    rstMB!Importance = objMailItem.Importance\n                    rstMB!From = objMailItem.SenderEmailAddress\n                    rstMB!Region = objMailItem.Parent\n                    rstMB!DateReceived = objMailItem.ReceivedTime\n                    rstMB!DateSent = objMailItem.SentOn\n                    rstMB!DateCreated = objMailItem.CreationTime\n                    rstMB!DateModified = objMailItem.LastModificationTime\n                    rstMB!FlagCompleted = objMailItem.FlagRequest\n                    rstMB!folder = objMailItem.Parent\n                rstMB.Update\n            End If\n            .Close\n        End With\n\nImportEmailItem_Exit:\n    Set rstMB = Nothing\n    Exit Sub\n\nImportEmailItem_Error:\n    Debug.Print Err.Number &amp; \" \" &amp; Err.Description\n\n    Select Case Err.Number\n        Case 91\n            Resume Next\n        Case 3022\n            Resume Next\n        Case -2147221233\n            MsgBox \"Customer Care Account Name is incorrect, please enter the Mail box name as seen in your outlook client.\", vbOKOnly, \"Mail Folder Name Error\"\n            Me.txtMailAccountName.SetFocus\n            Exit Sub\n        Case Else\n            MsgBox \"Error #: \" &amp; Err.Number &amp; \"  \" &amp; Err.Description '&amp; Chr(13) + Chr(10) &amp; IIf(mail.Subject Is Null, \"\", mail.Subject) &amp; \" \" &amp; IIf(mail.ReceivedTime Is Null, \"\", mail.ReceivedTime)\n'            DoCmd.RunSQL \"INSERT INTO tblImportReport(ImportDate,ImportFolder,ImportResult,ImportEmailCount) VALUES (#\" &amp; Now() &amp; \"#,'\" &amp; mailFolder &amp; \"', 'Error \" &amp; Err.Number &amp; \"', \" &amp; dMailCount &amp; \")\"\n            Resume Next 'cmdImportEmail_Exit\n    End Select\n\nEnd Sub\n</code></pre>\n\n<p>Is there a way to uniquely identify an email with a single field no matter whether it has been moved or not?</p>\n\n<p>I have an idea of what I could do to make sure I have the right email and get the original entry in my database. If there was no other way I could concatenate fields together to form a unique field and then get the database table's primary key field value.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1424909779, "post_id": 28731640, "comment_id": 45750407, "body": "As I understand your narrative, you&#39;ve flipped the <i>Search For</i> and <i>Within Text</i> parameters. VBA&#39;s <code>InStr</code>&#39;s parameters are the opposite order of the worksheet&#39;s <code>Find</code> or <code>Search</code> function."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1424910139, "post_id": 28731640, "comment_id": 45750518, "body": "i would also like to confirm that you know what you are asking for. The <code>.Text</code> property of a range (aka <i>cell</i>) is the displayed text and subject to cell formatting. A cell with <code>=TODAY()</code> formatted as <i>dd-mmm-yyyy</i> will gave a <code>.Text</code> of  25-Feb-2015 a <code>.Value</code> of 02/25/2015 and a <code>.Value2</code> of  42060."}, {"owner": {"reputation": 3734, "user_id": 2921363, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5caeedd7806ff7242659106e06d3f2a9?s=128&d=identicon&r=PG&f=1", "display_name": "bsapaka", "link": "https://stackoverflow.com/users/2921363/bsapaka"}, "edited": false, "score": 1, "creation_date": 1424910328, "post_id": 28731640, "comment_id": 45750575, "body": "pardon if i am wrong but I think the <code>dim i</code> should be outside the <code>for each</code> loop"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 3734, "user_id": 2921363, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5caeedd7806ff7242659106e06d3f2a9?s=128&d=identicon&r=PG&f=1", "display_name": "bsapaka", "link": "https://stackoverflow.com/users/2921363/bsapaka"}, "edited": false, "score": 0, "creation_date": 1424910436, "post_id": 28731640, "comment_id": 45750614, "body": "@bsapaka  - Good catch! I completely missed that."}, {"owner": {"reputation": 12931, "user_id": 1472222, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0970aeafe38e05589964ef6ec1ec3b4?s=128&d=identicon&r=PG", "display_name": "theMayer", "link": "https://stackoverflow.com/users/1472222/themayer"}, "edited": false, "score": 0, "creation_date": 1424914605, "post_id": 28731640, "comment_id": 45751731, "body": "Put a debug breakpoint on the line with <code>InStr</code> and make sure you get a known-true condition. Then figure out what the value of <code>cell.Text</code> is."}, {"owner": {"reputation": 27, "user_id": 2994283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a012a7273e275066628be25a7bf83e?s=128&d=identicon&r=PG&f=1", "display_name": "s4b3r6", "link": "https://stackoverflow.com/users/2994283/s4b3r6"}, "edited": false, "score": 0, "creation_date": 1424922151, "post_id": 28731640, "comment_id": 45753460, "body": "I&#39;ve ended up using <code>like</code> instead. <code>If cell.Text Like &quot;*&quot; &amp; Range(&quot;A2&quot;) &amp; &quot;*&quot; Then Range(&quot;A5&quot;).Value = cell.Text</code> matches like a charm. And yes, I did need to instantiate <code>i</code> outside the <code>for</code> loop."}], "answers": [{"comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1424923757, "post_id": 28732465, "comment_id": 45753861, "body": "Should be <code>InStr(1, cell.Text, Range(&quot;A2&quot;).Text, vbTextCompare) &gt; 0</code> otherwise it only picks up things from 2nd character."}], "tags": [], "owner": {"reputation": 700, "user_id": 2958230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6939b22e1e1a3b1d34003669c9e60f0b?s=128&d=identicon&r=PG&f=1", "display_name": "D_Zab", "link": "https://stackoverflow.com/users/2958230/d-zab"}, "is_accepted": false, "score": 0, "last_activity_date": 1424976035, "last_edit_date": 1495542037, "creation_date": 1424911007, "answer_id": 28732465, "question_id": 28731640, "link": "https://stackoverflow.com/questions/28731640/excel-instr-not-matching/28732465#28732465", "title": "Excel InStr not Matching", "body": "<p>InStr returns a numeric value equal to the starting position of the search string within the searched field so you would have to compare it against a number:</p>\n\n<pre><code>If InStr(1, cell.Text, Range(\"A2\").Text, vbTextCompare) &gt; 0 Then Range(\"A5\").Value = cell.Text\n</code></pre>\n\n<p>On a side note, if you don't need it then it's faster to process a <code>.Value2</code> then a <code>.Text</code> - see <a href=\"https://stackoverflow.com/questions/17359835/what-is-the-difference-between-text-value-and-value2\">this question</a>.</p>\n"}], "owner": {"reputation": 27, "user_id": 2994283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a012a7273e275066628be25a7bf83e?s=128&d=identicon&r=PG&f=1", "display_name": "s4b3r6", "link": "https://stackoverflow.com/users/2994283/s4b3r6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 679, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424976035, "creation_date": 1424906419, "question_id": 28731640, "link": "https://stackoverflow.com/questions/28731640/excel-instr-not-matching", "title": "Excel InStr not Matching", "body": "<p>I believe that I'm having trouble with InStr here.</p>\n\n<p>I have a for loop, looping through a bunch of values, and exiting correctly when a cell contains \"--\".</p>\n\n<p>However, if the cell contains text that cound be found in Range(\"A2\"), then I want it to spit out it's value to Range(\"A5\").</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>Private Sub CommandButton21_Click()\n    Dim cell As Range\n    For Each cell In Sheets(1).Range(\"$B:$B\")\n        Dim i As Long\n        i = cell.Row + i\n        If InStr(1, cell.Text, Range(\"A2\").Text, vbTextCompare) Then Range(\"A5\").Value = cell.Text\n        If cell.Text = \"--\" Then Exit For\n    Next cell\nEnd Sub\n</code></pre>\n\n\n\n<p>No idea why this sort of compare is failing.</p>\n"}, {"tags": ["arrays", "vba"], "answers": [{"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 1, "last_activity_date": 1424903846, "creation_date": 1424903846, "answer_id": 28731010, "question_id": 28730950, "link": "https://stackoverflow.com/questions/28730950/declaration-of-multiple-arrays-on-a-single-line-in-vba/28731010#28731010", "title": "Declaration of multiple arrays on a single line in VBA", "body": "<p>You have to specify both types, logically I used to think it would work as you have it but it doesn't.</p>\n\n<p>Do this:</p>\n\n<pre><code>Dim X(3) As Double, V(3) As Double\n</code></pre>\n\n<p>The benefit though is you don't have to group types, you could have something like:</p>\n\n<pre><code>Dim X as long, Y as Double, V as Variant, Z(3) as String\n</code></pre>\n\n<p>All on one line</p>\n"}, {"comments": [{"owner": {"reputation": 157, "user_id": 4565173, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-3kCQ1Yrmhm0/AAAAAAAAAAI/AAAAAAAACc4/vnpg89j0l6I/photo.jpg?sz=128", "display_name": "Godzy", "link": "https://stackoverflow.com/users/4565173/godzy"}, "edited": false, "score": 1, "creation_date": 1424904358, "post_id": 28731012, "comment_id": 45748430, "body": "Oh a variant type... Is it only for arrays though? Because I have found this on the microsoft visual basic page: &gt;&gt; Dim a, b, c As Single, x, y As Double, i As Integer &lt;&lt; with the comment &gt;&gt; &#39;a, b, and c are all Single; x and y are both Double &lt;&lt; and I&#39;ve been using such a syntax throughout my code. Was I defining Variants?"}, {"owner": {"reputation": 96748, "user_id": 74757, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/10331bb0b4eb995500acc85fb0d16aea?s=128&d=identicon&r=PG", "display_name": "C\u1d0f\u0280\u028f", "link": "https://stackoverflow.com/users/74757/c%e1%b4%8f%ca%80%ca%8f"}, "reply_to_user": {"reputation": 157, "user_id": 4565173, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-3kCQ1Yrmhm0/AAAAAAAAAAI/AAAAAAAACc4/vnpg89j0l6I/photo.jpg?sz=128", "display_name": "Godzy", "link": "https://stackoverflow.com/users/4565173/godzy"}, "edited": false, "score": 0, "creation_date": 1424904447, "post_id": 28731012, "comment_id": 45748478, "body": "@Godzy: I think you were."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1424904533, "post_id": 28731012, "comment_id": 45748512, "body": "Those examples may have been for .NET  You have to be careful when checking the MS site otherwise it&#39;s easy to end up rwading the wrong docs..."}], "tags": [], "owner": {"reputation": 96748, "user_id": 74757, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/10331bb0b4eb995500acc85fb0d16aea?s=128&d=identicon&r=PG", "display_name": "C\u1d0f\u0280\u028f", "link": "https://stackoverflow.com/users/74757/c%e1%b4%8f%ca%80%ca%8f"}, "is_accepted": true, "score": 2, "last_activity_date": 1424904423, "last_edit_date": 1424904423, "creation_date": 1424903856, "answer_id": 28731012, "question_id": 28730950, "link": "https://stackoverflow.com/questions/28730950/declaration-of-multiple-arrays-on-a-single-line-in-vba/28731012#28731012", "title": "Declaration of multiple arrays on a single line in VBA", "body": "<p>In short, you need to specify the data type for each variable if you insist on declaring multiples on one line:</p>\n\n<pre><code>Dim X(3) As Double, V(3) As Double\n</code></pre>\n\n<p>If you don't specify a data type, VBA assumes the type is <code>Variant</code>. A <code>Variant</code> can be an <code>Array</code>, but then you shouldn't use the array notation:</p>\n\n<pre><code>Dim V(3) As Double\nDim X\n\nX = V ' X is now an array\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 4565173, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-3kCQ1Yrmhm0/AAAAAAAAAAI/AAAAAAAACc4/vnpg89j0l6I/photo.jpg?sz=128", "display_name": "Godzy", "link": "https://stackoverflow.com/users/4565173/godzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1770, "favorite_count": 0, "accepted_answer_id": 28731012, "answer_count": 2, "score": 3, "last_activity_date": 1424904423, "creation_date": 1424903562, "question_id": 28730950, "link": "https://stackoverflow.com/questions/28730950/declaration-of-multiple-arrays-on-a-single-line-in-vba", "title": "Declaration of multiple arrays on a single line in VBA", "body": "<p>I've wasted two hours of my life on the declaration of an array. I know how to avoid the problem now, but I want to understand what goes wrong here. I'm new again at VBA and I want to understand what i'm doing rather than just doing random edits until it works... which is what I did here!</p>\n\n<p>This first code works:</p>\n\n<pre><code>Public Sub Main()\n    Dim X(3) As Double\n    Dim V(3) As Double\n    Call SimpleFunc(X)\n    Debug.Print \"Finished!\"\nEnd Sub\n\nPrivate Sub Func1(ByRef X() As Double)\n    X(1) = 0.1\n    X(2) = 0.2\n    X(3) = 0.3\nEnd Sub\n</code></pre>\n\n<p>But this second code doesn't (error at compile \"Type mismatch: array or user-defined type expected\"). The only difference is in the declaration of X and V.</p>\n\n<pre><code>Public Sub Main()\n    Dim X(3), V(3) As Double\n    Call SimpleFunc(X)\n    Debug.Print \"Finished!\"\nEnd Sub\n\nPrivate Sub Func1(ByRef X() As Double)\n    X(1) = 0.1\n    X(2) = 0.2\n    X(3) = 0.3\nEnd Sub\n</code></pre>\n\n<p>Why is X not an array in this latter code?</p>\n\n<p>Thanks everyone!</p>\n"}, {"tags": ["vba", "excel", "range"], "comments": [{"owner": {"reputation": 665, "user_id": 4259417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a82ce39c7bfa96f76ec14a5dffdd27ef?s=128&d=identicon&r=PG", "display_name": "Shauno_88", "link": "https://stackoverflow.com/users/4259417/shauno-88"}, "edited": false, "score": 0, "creation_date": 1424902796, "post_id": 28730624, "comment_id": 45747670, "body": "Hi, What error are you getting and also when you step through the code what line does it stop at?"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1424916072, "post_id": 28730624, "comment_id": 45752042, "body": "A lot of your calls to <code>Range</code> aren&#39;t qualified with a sheet name and will default to the active sheet. That will be OK if &quot;TEXT&quot; is active but will fail if any other sheet is active when the macro runs"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 4537966, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a6a4a6f5e65e036b1cfbc84c404ca8a8?s=128&d=identicon&r=PG", "display_name": "user249611", "link": "https://stackoverflow.com/users/4537966/user249611"}, "edited": false, "score": 0, "creation_date": 1424965244, "post_id": 28730928, "comment_id": 45775477, "body": "This works, I did not understand that when creating and or assigning a range the sheet name should be included."}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": true, "score": 1, "last_activity_date": 1424967670, "last_edit_date": 1424967670, "creation_date": 1424903484, "answer_id": 28730928, "question_id": 28730624, "link": "https://stackoverflow.com/questions/28730624/vba-excel-copy-range/28730928#28730928", "title": "VBA EXCEL copy range", "body": "<p>I answered your more detailed earlier question.  This will not work because this line doesn't work for at least 2 reasons:</p>\n\n<pre><code>CurrentWorkbook.Sheets(\"TEXT\").Range(RangeToCopy).Copy Action:=xlFilterCopy, _\n    CopyToRange:=Sheets(\"Sheet3\").Range(\"A1\"), unique:=True\n</code></pre>\n\n<p>First, \"RangeToCopy\" is not a defined range on the sheet, so you cannot reference it in this way.  It is a variable in your VBA code, so you just need to use the Copy Function on this range.  Second, the Copy function of the Range Class does not have all of these parameters.  You want:</p>\n\n<pre><code>RangeToCopy.Copy Destination:=Sheets(\"Sheet3\").Range(\"A1\")\n</code></pre>\n\n<p>If you are actually tryin get unique values, then  you need to use the \"AdvancedFilter\" function.</p>\n\n<pre><code>RangeToCopy.AdvancedFilter Action:=xlFilterCopy, _\nCopyToRange:=Sheets(\"Sheet3\").Range(\"A1\"), unique:=True,  criteriarange:= &lt;Insert range that you wish to get unique values from here&gt; \n</code></pre>\n\n<p>Also, you should define RangeToCopy based on the Sheet Name so:</p>\n\n<pre><code>Set RangeToCopy = Sheets(\"TEXT\").Range(\"A2\", ColumnLetterNumber)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2221, "user_id": 1505990, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FIKz5.jpg?s=128&g=1", "display_name": "Jon Carlstedt", "link": "https://stackoverflow.com/users/1505990/jon-carlstedt"}, "edited": false, "score": 0, "creation_date": 1424944597, "post_id": 28738818, "comment_id": 45762135, "body": "I didn&#39;t take into account that D could have empty rows, but I&#39;m sure you can work that out yourself."}, {"owner": {"reputation": 55, "user_id": 4537966, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a6a4a6f5e65e036b1cfbc84c404ca8a8?s=128&d=identicon&r=PG", "display_name": "user249611", "link": "https://stackoverflow.com/users/4537966/user249611"}, "edited": false, "score": 0, "creation_date": 1424965334, "post_id": 28738818, "comment_id": 45775544, "body": "The prior post works, I&#39;m interested in the compressed format that you used. I will added the code for unique values."}], "tags": [], "owner": {"reputation": 2221, "user_id": 1505990, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FIKz5.jpg?s=128&g=1", "display_name": "Jon Carlstedt", "link": "https://stackoverflow.com/users/1505990/jon-carlstedt"}, "is_accepted": false, "score": 0, "last_activity_date": 1424944338, "last_edit_date": 1424944338, "creation_date": 1424943360, "answer_id": 28738818, "question_id": 28730624, "link": "https://stackoverflow.com/questions/28730624/vba-excel-copy-range/28738818#28738818", "title": "VBA EXCEL copy range", "body": "<p>Aren't you over doing this?</p>\n\n<pre><code>Sub Macro()\n\n    Dim dEnd As Integer\n\n    Sheets(\"Sheet1\").Select\n\n    Range(\"D1\").Select\n    dEnd = Selection.End(xlDown).Row\n\n    Range(\"A2:\" &amp; \"D\" &amp; dEnd).Copy\n\n    Sheets(\"Sheet2\").Select\n    Range(\"A1\").Select\n    ActiveSheet.Paste\n\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n\n<p>(I didn't bother with sheet names)</p>\n"}], "owner": {"reputation": 55, "user_id": 4537966, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a6a4a6f5e65e036b1cfbc84c404ca8a8?s=128&d=identicon&r=PG", "display_name": "user249611", "link": "https://stackoverflow.com/users/4537966/user249611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 709, "favorite_count": 0, "accepted_answer_id": 28730928, "answer_count": 2, "score": 0, "last_activity_date": 1424967670, "creation_date": 1424902151, "question_id": 28730624, "link": "https://stackoverflow.com/questions/28730624/vba-excel-copy-range", "title": "VBA EXCEL copy range", "body": "<p>I posted the same question a little while ago and was told that I had spelled sheets wrong. I took the question down; because I thought that I understood I was trying to call a method..that was my range (and yes sheet was spelled sheeet). I guess I still do not understand. I am trying to copy column \"A2\" through the last cell of column \"D\" from the sheet \"TEXT\" to Sheet3 </p>\n\n<pre><code>Dim TotalRows As Integer\nDim CurrentWorkbook As Workbook ' macro workbook\nDim RangeToCopy As Range\nDim ColumnLetterNumber As String\n\nSet CurrentWorkbook = ThisWorkbook\nTotalRows = Sheets(\"TEXT\").UsedRange.Rows.Count\nColumnLetterNumber = \"D\" &amp; TotalRows\n\n\nSet RangeToCopy = Range(\"A2\", ColumnLetterNumber)\n\n' Group Last Observed within the first three columns\n' Last Observed start in column N\n' After Insert end up in column )\n\n Columns(\"D:D\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n\n' Move the Last observed (now column O) to Column D so that they can be fitered together\n\nSheets(\"TEXT\").Range(Range(\"O1\"), Range(\"O1\").End(xlDown)).Copy Sheets(\"TEXT\").Range(\"D1\")\n\nWith Sheets(\"TEXT\")\n .AutoFilterMode = False\n .Range(\"A1:D1\").AutoFilter\nEnd With\n'\n'Copy Columns to the POAM sheet\nSet RangeToCopy = Range(\"A2\", ColumnLetterNumber) 'top left, bottom right\nRangeToCopy.Select\nCurrentWorkbook.Sheets(\"Sheet3\").Activate\n\n\nCurrentWorkbook.Sheets(\"TEXT\").Range(RangeToCopy).Copy Action:=xlFilterCopy, _\nCopyToRange:=Sheets(\"Sheet3\").Range(\"A1\"), unique:=True\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2007"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1424900686, "post_id": 28730233, "comment_id": 45746699, "body": "If they have formulas in, then they aren&#39;t blank!"}, {"owner": {"reputation": 273, "user_id": 1772011, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/127ab7553fa5a0e3e5d8c546cd5575b3?s=128&d=identicon&r=PG", "display_name": "kmiao91", "link": "https://stackoverflow.com/users/1772011/kmiao91"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1424967216, "post_id": 28730233, "comment_id": 45776861, "body": "I changed my code to where I pull the formula values and copy paste them as value into column AG. Now my code is <code>shMassPrelim.Column(&quot;AG&quot;).SpecialCells(xlBlanks).EntireRow.D&zwnj;&#8203;elete</code> and I&#39;m still getting an error where no blank cells are found but there are blank cells."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1424968111, "post_id": 28730233, "comment_id": 45777429, "body": "<code>&quot;&quot;</code> is still a value, and means the cell isn&#39;t blank. Either you need to post the rest of the code to see what&#39;s happening or you need to use the <code>Range.AutoFilter()</code> method."}, {"owner": {"reputation": 273, "user_id": 1772011, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/127ab7553fa5a0e3e5d8c546cd5575b3?s=128&d=identicon&r=PG", "display_name": "kmiao91", "link": "https://stackoverflow.com/users/1772011/kmiao91"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1424979687, "post_id": 28730233, "comment_id": 45784548, "body": "Yup I just went with the autofilter method."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1424979771, "post_id": 28730233, "comment_id": 45784607, "body": "Good choice, more flexible than <code>SpecialCells()</code> and a hell of a lot faster than looping."}], "answers": [{"tags": [], "owner": {"reputation": 1257, "user_id": 1232692, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b491eaba0f986b1c172bbbeff9434654?s=128&d=identicon&r=PG", "display_name": "Kelvin", "link": "https://stackoverflow.com/users/1232692/kelvin"}, "is_accepted": false, "score": 0, "last_activity_date": 1424901807, "creation_date": 1424901807, "answer_id": 28730538, "question_id": 28730233, "link": "https://stackoverflow.com/questions/28730233/vba-if-cell-blank-delete-entire-row/28730538#28730538", "title": "VBA - If cell blank, delete entire row", "body": "<p>Try this? </p>\n\n<pre><code>Sub misc()\nDim cell As Range\nDim EMPTY_CELL As String\n    EMPTY_CELL = \"\"\n    For Each cell In Selection\n        If Trim(cell.Value) = EMPTY_CELL Then\n            cell.EntireRow.Delete\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1424941046, "creation_date": 1424941046, "answer_id": 28738059, "question_id": 28730233, "link": "https://stackoverflow.com/questions/28730233/vba-if-cell-blank-delete-entire-row/28738059#28738059", "title": "VBA - If cell blank, delete entire row", "body": "<p>This will filter and delete the blank rows</p>\n\n<pre><code>Sub DeleteStuff()\n    Dim Rws As Long, Rng As Range\n\n    Rws = Cells(Rows.Count, \"AG\").End(xlUp).Row\n    Set Rng = Range(Cells(2, \"AG\"), Cells(Rws, \"AG\"))\n\n    Application.ScreenUpdating = 0\n\n    Range(\"AG:AG\").AutoFilter Field:=1, Criteria1:=\"=\"\n    Rng.SpecialCells(xlCellTypeVisible).EntireRow.Delete\n\n    ActiveSheet.AutoFilterMode = 0\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 273, "user_id": 1772011, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/127ab7553fa5a0e3e5d8c546cd5575b3?s=128&d=identicon&r=PG", "display_name": "kmiao91", "link": "https://stackoverflow.com/users/1772011/kmiao91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1547, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1572416664, "creation_date": 1424900596, "last_edit_date": 1531164843, "question_id": 28730233, "link": "https://stackoverflow.com/questions/28730233/vba-if-cell-blank-delete-entire-row", "title": "VBA - If cell blank, delete entire row", "body": "<pre><code>shMassPrelim.Range(\"AG2:AG\" &amp; lr).SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n</code></pre>\n\n<p>The above code is what I'm using to look for blank cells in column AG. However, Column AG is based upon an If formula. Is this the reason why I'm getting back \"No Cells Blank\" error?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 4071033, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04dc7742b2669036a911cf80b5980733?s=128&d=identicon&r=PG&f=1", "display_name": "Kim G", "link": "https://stackoverflow.com/users/4071033/kim-g"}, "edited": false, "score": 0, "creation_date": 1424968876, "post_id": 28731923, "comment_id": 45777930, "body": "Regarding inserting the filename, you mean into the input box, correct? That&#39;s a great idea to use the input box. Thanks! I&#39;m not sure what &quot;x&quot; is though. Sorry, I&#39;m still pretty new to all this."}, {"owner": {"reputation": 113, "user_id": 4071033, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04dc7742b2669036a911cf80b5980733?s=128&d=identicon&r=PG&f=1", "display_name": "Kim G", "link": "https://stackoverflow.com/users/4071033/kim-g"}, "edited": false, "score": 0, "creation_date": 1424969453, "post_id": 28731923, "comment_id": 45778348, "body": "BTW, I failed to mention that this code is awesome!"}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "reply_to_user": {"reputation": 113, "user_id": 4071033, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04dc7742b2669036a911cf80b5980733?s=128&d=identicon&r=PG&f=1", "display_name": "Kim G", "link": "https://stackoverflow.com/users/4071033/kim-g"}, "edited": false, "score": 0, "creation_date": 1425025345, "post_id": 28731923, "comment_id": 45800784, "body": "It&#39;s based on a generic solution, you can use wbname = ActiveWorkbook.Name too"}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "reply_to_user": {"reputation": 113, "user_id": 4071033, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04dc7742b2669036a911cf80b5980733?s=128&d=identicon&r=PG&f=1", "display_name": "Kim G", "link": "https://stackoverflow.com/users/4071033/kim-g"}, "edited": false, "score": 0, "creation_date": 1425028221, "post_id": 28731923, "comment_id": 45802248, "body": "x could be wbname2, it&#39;s the output name"}, {"owner": {"reputation": 113, "user_id": 4071033, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04dc7742b2669036a911cf80b5980733?s=128&d=identicon&r=PG&f=1", "display_name": "Kim G", "link": "https://stackoverflow.com/users/4071033/kim-g"}, "edited": false, "score": 0, "creation_date": 1425045195, "post_id": 28731923, "comment_id": 45812240, "body": "This is awesome! Thanks so much. The only last question I have is that I don&#39;t need to actually create the previous week&#39;s file; I need to access/open what&#39;s already created in the same folder. Then I need to do the VLOOKUP, or something, to compare the due dates column of both files to be sure the dates were not changed in the latter file from the former file. What you have so far is so great! Thank you, and thank you for helping with this one last question."}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "reply_to_user": {"reputation": 113, "user_id": 4071033, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04dc7742b2669036a911cf80b5980733?s=128&d=identicon&r=PG&f=1", "display_name": "Kim G", "link": "https://stackoverflow.com/users/4071033/kim-g"}, "edited": false, "score": 0, "creation_date": 1425050653, "post_id": 28731923, "comment_id": 45815559, "body": "I think it shoud be like     YourCells.FormulaR1C1 = &quot;=+VLOOKUP(RC2,&#39;[&quot; &amp; x &amp; &quot;]Master Sheet&#39;!R4C2:R953C16,6,FALSE)&quot;    where x is the output of my sniplet and the range YourCells is a range you&#39;ll need to specify either with Cells or Range method.    P.S. I recommend using a named range instead of B4 to P953 as the number of rows seems to be variable."}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "reply_to_user": {"reputation": 113, "user_id": 4071033, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04dc7742b2669036a911cf80b5980733?s=128&d=identicon&r=PG&f=1", "display_name": "Kim G", "link": "https://stackoverflow.com/users/4071033/kim-g"}, "edited": false, "score": 0, "creation_date": 1425050995, "post_id": 28731923, "comment_id": 45815800, "body": "Alternatively you can &quot;upgrade&quot; your outdated filename. In this case you&#39;ll copy the outdated &quot;02.02.15 Load Board&quot; and then run my sniplet, insert the name but with datemod = DateAdd(&quot;d&quot;, <b>+7</b>, datemod) and then make a replacement like ActiveSheet.Cells.Replace What:=&quot;&quot; &amp; wbname &amp; &quot;&quot;, Replacement:=&quot;&quot; &amp; x &amp; &quot;&quot;, LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False"}, {"owner": {"reputation": 113, "user_id": 4071033, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04dc7742b2669036a911cf80b5980733?s=128&d=identicon&r=PG&f=1", "display_name": "Kim G", "link": "https://stackoverflow.com/users/4071033/kim-g"}, "edited": false, "score": 0, "creation_date": 1425056169, "post_id": 28731923, "comment_id": 45819039, "body": "The YourCells.Formula is great with B4:P953. Prefect! Can you just tell me where in the code this should go?"}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "reply_to_user": {"reputation": 113, "user_id": 4071033, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04dc7742b2669036a911cf80b5980733?s=128&d=identicon&r=PG&f=1", "display_name": "Kim G", "link": "https://stackoverflow.com/users/4071033/kim-g"}, "edited": false, "score": 0, "creation_date": 1425057115, "post_id": 28731923, "comment_id": 45819653, "body": "<b>Cells.Replace What:=&quot;&quot; &amp; wbname &amp; &quot;&quot;, Replacement:=&quot;&quot; &amp; x &amp; &quot;&quot;, LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False</b> needs to run on each sheet of the upgraded workbook that has the formula you want to change."}, {"owner": {"reputation": 113, "user_id": 4071033, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04dc7742b2669036a911cf80b5980733?s=128&d=identicon&r=PG&f=1", "display_name": "Kim G", "link": "https://stackoverflow.com/users/4071033/kim-g"}, "edited": false, "score": 0, "creation_date": 1425057875, "post_id": 28731923, "comment_id": 45820115, "body": "AWESOME! Thanks for your patience. It&#39;s perfect."}], "tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": false, "score": 1, "last_activity_date": 1424954427, "last_edit_date": 1424954427, "creation_date": 1424907767, "answer_id": 28731923, "question_id": 28730190, "link": "https://stackoverflow.com/questions/28730190/vlookup-formula-and-or-vba-code-to-automaticall-search-files-named-by-date/28731923#28731923", "title": "VLOOKUP formula and/or VBA code to automaticall search files named by date", "body": "<p>I assume you know how to insert the filename. Then this snipplet will transform your data into actual dates that can in turn be used to create the actual one week before's filename (regardless of month or year change).<br>\nP.S. \"ww\" is for the weak.<br>\nP.P.S. smartass disclaimer: will only work from Jan 8, 2000 to Dec 31, 2,<strike>9</strike> 099.</p>\n\n<pre><code>Sub ert()\nDim wbname As String\n'wbname = InputBox(\"What is the name of the report file?\") '\"02.16.15 Load Board.xlsm\"\nwbyear = CLng(2000 + Mid(wbname, 7, 2))\nwbmonth = CLng(Left(wbname, 2))\nwbday = CLng(Mid(wbname, 4, 2))\n\ndatemod = DateValue(wbday &amp; \"/\" &amp; wbmonth &amp; \"/\" &amp; wbyear)\ndatemod = DateAdd(\"d\", -7, datemod)\n\nwbyear = Right(CStr(DatePart(\"yyyy\", datemod)), 2)\n    If Len(wbyear) &lt; 2 Then wbyear = \"0\" &amp; wbyear\nwbmonth = DatePart(\"m\", datemod)\n    If Len(wbmonth) &lt; 2 Then wbmonth = \"0\" &amp; wbmonth\nwbday = DatePart(\"d\", datemod)\n    If Len(wbday) &lt; 2 Then wbday = \"0\" &amp; wbday\nx = wbmonth &amp; \".\" &amp; wbday &amp; \".\" &amp; wbyear &amp; Right(wbname, Len(wbname) - 8)\n'MsgBox (x)\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 4071033, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04dc7742b2669036a911cf80b5980733?s=128&d=identicon&r=PG&f=1", "display_name": "Kim G", "link": "https://stackoverflow.com/users/4071033/kim-g"}, "edited": false, "score": 0, "creation_date": 1425056656, "post_id": 28768682, "comment_id": 45819378, "body": "How about the VLOOKUP formula placement - sorry, what I meant to ask."}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "reply_to_user": {"reputation": 113, "user_id": 4071033, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04dc7742b2669036a911cf80b5980733?s=128&d=identicon&r=PG&f=1", "display_name": "Kim G", "link": "https://stackoverflow.com/users/4071033/kim-g"}, "edited": false, "score": 0, "creation_date": 1425057389, "post_id": 28768682, "comment_id": 45819819, "body": "This should work just fine. Make sure the workbook where the new formulae will refer to is <b>open</b> and this should do the trick just fine. the wbname goes without extension, just as it goes in your formula (which you&#39;d like to replace). In this case it&#39;s <i>02.09.15 Load Board</i> ."}], "tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": true, "score": 0, "last_activity_date": 1425051144, "creation_date": 1425051144, "answer_id": 28768682, "question_id": 28730190, "link": "https://stackoverflow.com/questions/28730190/vlookup-formula-and-or-vba-code-to-automaticall-search-files-named-by-date/28768682#28768682", "title": "VLOOKUP formula and/or VBA code to automaticall search files named by date", "body": "<pre><code>Sub ert()\nDim wbname As String\nwbname = InputBox(\"What is the name of the outdated report file?\") '\"02.16.15 Load Board.xlsm\"\nwbyear = CLng(2000 + Mid(wbname, 7, 2))\nwbmonth = CLng(Left(wbname, 2))\nwbday = CLng(Mid(wbname, 4, 2))\n\ndatemod = DateValue(wbday &amp; \"/\" &amp; wbmonth &amp; \"/\" &amp; wbyear)\ndatemod = DateAdd(\"d\", +7, datemod)\n\nwbyear = Right(CStr(DatePart(\"yyyy\", datemod)), 2)\n    If Len(wbyear) &lt; 2 Then wbyear = \"0\" &amp; wbyear\nwbmonth = DatePart(\"m\", datemod)\n    If Len(wbmonth) &lt; 2 Then wbmonth = \"0\" &amp; wbmonth\nwbday = DatePart(\"d\", datemod)\n    If Len(wbday) &lt; 2 Then wbday = \"0\" &amp; wbday\nx = wbmonth &amp; \".\" &amp; wbday &amp; \".\" &amp; wbyear &amp; Right(wbname, Len(wbname) - 8)\nActiveSheet.Cells.Replace What:=\"\" &amp; wbname &amp; \"\", Replacement:=\"\" &amp; x &amp; \"\", LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 4071033, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04dc7742b2669036a911cf80b5980733?s=128&d=identicon&r=PG&f=1", "display_name": "Kim G", "link": "https://stackoverflow.com/users/4071033/kim-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 28768682, "answer_count": 2, "score": 0, "last_activity_date": 1425051144, "creation_date": 1424900445, "last_edit_date": 1531164843, "question_id": 28730190, "link": "https://stackoverflow.com/questions/28730190/vlookup-formula-and-or-vba-code-to-automaticall-search-files-named-by-date", "title": "VLOOKUP formula and/or VBA code to automaticall search files named by date", "body": "<p>I submit weekly reports using Excel 2013, in which the file name includes the current date as part of its name. For example, \"02.16.15 Load Board.\" I'm trying to create a VLOOKUP formula that will compare task due dates between the current week's file and the previous week's file automatically. An example of the formula I last used was:</p>\n\n<p>=+VLOOKUP(B560,'[02.09.15 Load Board.xlsm]Master Sheet'!$B$4:$P$953,6,FALSE).</p>\n\n<p>comparing \"02.16.15 Load Board\" with \"02.09.15 Load Board\" for differences in task due dates.</p>\n\n<p>This worked fine. But is there a VLOOPUP formula or VBA code that will automate this according to the name of the report date? Is it possible to subtract 7 days in the name of the report to automatically choose the report that was 7 days earlier? THANK YOU!</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 62, "user_id": 4555255, "user_type": "registered", "profile_image": "https://graph.facebook.com/10200137923248185/picture?type=large", "display_name": "Manuel Rocha", "link": "https://stackoverflow.com/users/4555255/manuel-rocha"}, "is_accepted": false, "score": 0, "last_activity_date": 1424909338, "creation_date": 1424909338, "answer_id": 28732218, "question_id": 28730160, "link": "https://stackoverflow.com/questions/28730160/access-vba-toggle-button-to-filter-non-null-records/28732218#28732218", "title": "Access VBA: Toggle button to filter non-null records", "body": "<p>Check if this query helps:</p>\n\n<pre><code>SELECT\n  city,\n  state,\n  country\nFROM\n  some_table\nWHERE\n  city is not null AND\n  city &lt;&gt; ''\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 79, "user_id": 3414755, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/089fc2c4ee4111c80bb6218c5501075c?s=128&d=identicon&r=PG&f=1", "display_name": "Anton", "link": "https://stackoverflow.com/users/3414755/anton"}, "is_accepted": false, "score": 0, "last_activity_date": 1424932930, "creation_date": 1424932930, "answer_id": 28736065, "question_id": 28730160, "link": "https://stackoverflow.com/questions/28730160/access-vba-toggle-button-to-filter-non-null-records/28736065#28736065", "title": "Access VBA: Toggle button to filter non-null records", "body": "<pre><code>Select * FROM TBL_WHATEVER WHERE [City] &lt;&gt;\"\" \n\nif recordset.eof = true then\n    msgbox \"No records in recordset\",vbokonly\n    exit sub\nend if\n\nrecordset.movefirst\n\nDo while recordset.eof = false\n    city = recordset![city]\n        if city &lt;&gt;\"\" then\n            with me.combobox1\n                .additem recordset![country]\n            end with\n            recordset.movenext\n         end if\nloop\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 3657363, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/157fc3cbff8a7b17d31d02a84547fdc5?s=128&d=identicon&r=PG&f=1", "display_name": "coburne", "link": "https://stackoverflow.com/users/3657363/coburne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 269, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1424932930, "creation_date": 1424900320, "question_id": 28730160, "link": "https://stackoverflow.com/questions/28730160/access-vba-toggle-button-to-filter-non-null-records", "title": "Access VBA: Toggle button to filter non-null records", "body": "<p>I have a form that uses combo boxes to select certain values from a query. I have a lot of columns that are blank on many records and I was hoping to use a toggle button to filter the query to only return records where a specific column contains info, and if it's not pressed, it will just return all records.</p>\n\n<p>Say for example that I have columns for City, State, Country, I might use combo box to select Canada to return all records in my query that have Canada listed as the country. For those records, if only half of them have a city filled in, can I tie the City column to a toggle button so that when I press it, only the records that contain something in the City column are returned, and if the button is not pressed, it will return all records?</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "answers": [{"tags": [], "owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "is_accepted": false, "score": 2, "last_activity_date": 1424900036, "creation_date": 1424900036, "answer_id": 28730056, "question_id": 28730013, "link": "https://stackoverflow.com/questions/28730013/vba-check-if-folder-exists-works-only-when-there-is-a-file-in-the-folder/28730056#28730056", "title": "VBA &quot;Check if folder exists&quot; works only when there is a file in the folder", "body": "<p>You could try this instead:</p>\n\n<pre><code>Dim objFSO \nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\n\nIf objFSO.FolderExists(FolderPath)\n...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 3, "last_activity_date": 1424900277, "creation_date": 1424900277, "answer_id": 28730152, "question_id": 28730013, "link": "https://stackoverflow.com/questions/28730013/vba-check-if-folder-exists-works-only-when-there-is-a-file-in-the-folder/28730152#28730152", "title": "VBA &quot;Check if folder exists&quot; works only when there is a file in the folder", "body": "<p>The following line returns a number greater than 0 if the folder exists, regardless of whether the folder has any files in it</p>\n\n<pre><code>len(dir(\"C:\\Users\\user\\Desktop\\Tests\\tt\", vbDirectory))\n</code></pre>\n"}], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2565, "favorite_count": 0, "accepted_answer_id": 28730152, "answer_count": 2, "score": 0, "last_activity_date": 1424900277, "creation_date": 1424899898, "last_edit_date": 1531164843, "question_id": 28730013, "link": "https://stackoverflow.com/questions/28730013/vba-check-if-folder-exists-works-only-when-there-is-a-file-in-the-folder", "title": "VBA &quot;Check if folder exists&quot; works only when there is a file in the folder", "body": "<p>I got the original code from www.rondebruin.nl</p>\n\n<p>It is designed to test whether or not a folder already exists in the directory. I modified it to fit my needs and it seemed to work well. </p>\n\n<p>Today, i discovered that it only works properly if the folder being tested for is NOT empty. If it is empty, then it returns false (i.e. the folder does not exist).</p>\n\n<p>I can't figure out why this is.  </p>\n\n<pre><code>FolderPath = sPfad\nIf Right(FolderPath, 1) &lt;&gt; \"\\\" Then\n    FolderPath = FolderPath &amp; \"\\\"\nEnd If\n\nTestStr = \"\"\nOn Error Resume Next\nTestStr = Dir(FolderPath)\nOn Error GoTo 0\nIf TestStr = \"\" Then\n    Test_Folder_Exist_With_Dir = False\n    Exit Function\nElse\n    Test_Folder_Exist_With_Dir = True\n    Exit Function\nEnd If\n</code></pre>\n\n<p>I suspect the answer lies in the <code>TestStr = Dir(FolderPath)</code> but haven't been able to get to the bottom of it. The MSDN <a href=\"https://msdn.microsoft.com/en-us/library/dk008ty4%28v=vs.90%29.aspx\" rel=\"nofollow\">article</a> basically explains that <code>Dir()</code> always returns something. However the examples give are all such that there is a file present to return.</p>\n\n<p>I basically need to get it so that it recognizes the folder regardless of whether there is something in it or not.</p>\n\n<p>Any help appreciated!</p>\n"}, {"tags": ["excel", "byref", "vba"], "comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 1, "creation_date": 1424918094, "post_id": 28730003, "comment_id": 45752555, "body": "On a side note, this: Dim wb_path, wb_name, ws_name, ws_cell As String doesn&#39;t do what you think it does, you need to set each one like this: Dim wb_path As String, wb_name As String, ws_name As String, ws_cell As String"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1424938286, "post_id": 28730003, "comment_id": 45758691, "body": "And if you do what @DanDonoghue suggests, your original code should work. :)"}], "answers": [{"tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": false, "score": 0, "last_activity_date": 1424900199, "creation_date": 1424900199, "answer_id": 28730123, "question_id": 28730003, "link": "https://stackoverflow.com/questions/28730003/excel-vba-byref-type-mismatch/28730123#28730123", "title": "excel vba byref type mismatch", "body": "<p>Declare the argument with <code>ByVal</code> keyword: <code>ByVal wbName As String, ByVal wsName As String</code>.</p>\n\n<pre><code>Function GetInfoFromClosedFile(ByVal wbPath As String, ByVal wbName As String, ByVal wsName As String, cellRef As String) As Variant\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8505629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf488016b7c446a17b86bf1a7510ec7a?s=128&d=identicon&r=PG&f=1", "display_name": "Deej", "link": "https://stackoverflow.com/users/8505629/deej"}, "is_accepted": false, "score": 0, "last_activity_date": 1503484790, "creation_date": 1503484790, "answer_id": 45837436, "question_id": 28730003, "link": "https://stackoverflow.com/questions/28730003/excel-vba-byref-type-mismatch/45837436#45837436", "title": "excel vba byref type mismatch", "body": "<p><a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/dim-statement\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/dim-statement</a></p>\n\n<p>Declaring Multiple Variables\nYou can declare several variables in one declaration statement, specifying the variable name for each one, and following each array name with parentheses. Multiple variables are separated by commas.\nVB</p>\n\n<p>Dim lastTime, nextTime, allTimes() As Date  </p>\n\n<p>Not sure what Dan Donoghue was on about but you can declare multiple variables in this manner (see above link) </p>\n"}], "owner": {"reputation": 29, "user_id": 3701191, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1428185145/picture?type=large", "display_name": "user3701191", "link": "https://stackoverflow.com/users/3701191/user3701191"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 278, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1503484790, "creation_date": 1424899874, "last_edit_date": 1531164843, "question_id": 28730003, "link": "https://stackoverflow.com/questions/28730003/excel-vba-byref-type-mismatch", "title": "excel vba byref type mismatch", "body": "<p>i'm trying to pass the wb_ and ws_variables to the function getinfofromclosedfile below, i keep getting a byref argument mismatch on the wb_name variable. </p>\n\n<pre><code> Sub check_update()\n\n Dim wb_path, wb_name, ws_name, ws_cell As String\n\n AGuser = GetUser\n If Dir(\"c:\\users\\\" &amp; AGuser &amp; \"\\documents\\appraiser_genie\\genieold.xlsm\") &lt;&gt; \"\" Then\n    wb_path = \"c:\\users\\\" &amp; AGuser &amp; \"\\documents\\\"\n    wb_name = \"genieold.xlsm\"\n    ws_name = \"input\"\n    ws_cell = Cells(17, 2).Address\n    Sheets(\"input\").Cells(17, 2).Select = GetInfoFromClosedFile(wb_path, wb_name, ws_name, ws_cell)\n   End If\nEnd Sub\n\nPrivate Function GetInfoFromClosedFile(ByVal wbPath As String, _\n    wbName As String, wsName As String, cellRef As String) As Variant\n</code></pre>\n\n<p>any help would be appreciated!</p>\n"}, {"tags": ["vba", "excel", "rally"], "comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1424915576, "post_id": 28729844, "comment_id": 45751936, "body": "This isn&#39;t the problem with the response but it looks like your <code>For Each</code> loop just keeps repeating the first defect. You probably need to set the value of <code>str</code> before the <code>If...Else</code> block"}], "answers": [{"tags": [], "owner": {"reputation": 8837, "user_id": 965782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ebd55d125712aeadb9df8ba78339d314?s=128&d=identicon&r=PG", "display_name": "Larry Maccherone", "link": "https://stackoverflow.com/users/965782/larry-maccherone"}, "is_accepted": false, "score": 1, "last_activity_date": 1424914973, "creation_date": 1424914973, "answer_id": 28733063, "question_id": 28729844, "link": "https://stackoverflow.com/questions/28729844/rubbish-in-get-response-from-rallydev-api/28733063#28733063", "title": "Rubbish in &quot;GET&quot; response from RallyDev API", "body": "<p>The response is compressed. Either try setting a request header for Accept-Encoding: identity or decompress the response.</p>\n"}, {"tags": [], "owner": {"reputation": 380, "user_id": 4211235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f84dfc5aa9c66e29c9d349acbffd84e3?s=128&d=identicon&r=PG&f=1", "display_name": "user4211235", "link": "https://stackoverflow.com/users/4211235/user4211235"}, "is_accepted": true, "score": 1, "last_activity_date": 1424916887, "creation_date": 1424916887, "answer_id": 28733333, "question_id": 28729844, "link": "https://stackoverflow.com/questions/28729844/rubbish-in-get-response-from-rallydev-api/28733333#28733333", "title": "Rubbish in &quot;GET&quot; response from RallyDev API", "body": "<p>Larry's answer is correct.</p>\n\n<p>As an aside, if you need to pull data from Rally into Excel, your best bet is the Rally Add-in for Excel:</p>\n\n<p><a href=\"https://help.rallydev.com/rally-add-excel\" rel=\"nofollow\">https://help.rallydev.com/rally-add-excel</a></p>\n\n<p>Since you mentioned VBA, you may be working to build some automation in Excel, which the Excel add-in doesn't support. There is an alpha-level Rally Rest Toolkit for VBA. It handles the authentication and REST serialization/de-serialization for you, so it could ease some of your coding effort.</p>\n\n<p>It is unofficial and not supported by Rally, but could be worth trying. Since it is unsupported though, Rally can't help you out if you run into issues. You'd have to refactor your own code against the VBA toolkit to pull the data you want:</p>\n\n<p><a href=\"https://github.com/markwilliams970/RallyRestToolkitForVBA\" rel=\"nofollow\">https://github.com/markwilliams970/RallyRestToolkitForVBA</a></p>\n"}], "owner": {"reputation": 967, "user_id": 2738882, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c4a87b27b18de15d87de3b85a0dffa11?s=128&d=identicon&r=PG&f=1", "display_name": "user2738882", "link": "https://stackoverflow.com/users/2738882/user2738882"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "accepted_answer_id": 28733333, "answer_count": 2, "score": 0, "last_activity_date": 1424916887, "creation_date": 1424899281, "last_edit_date": 1531164843, "question_id": 28729844, "link": "https://stackoverflow.com/questions/28729844/rubbish-in-get-response-from-rallydev-api", "title": "Rubbish in &quot;GET&quot; response from RallyDev API", "body": "<p>I have an function in Excel:</p>\n\n<pre><code>Function getState(Defects As Object) As String\n\nDim str As String\nDim res As String\nDim was As Boolean\nDim sURL As String\nDim oRequest As Object\nSet oRequest = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n\nwas = False\n\nFor Each defect In Defects\n    If was = False Then\n        str = \"(FormattedID = \"\"\" &amp; defect &amp; \"\"\")\"\n        res = str\n        was = True\n    Else\n        res = res &amp; \" OR \" &amp; str\n    End If\nNext defect\n\nsURL = \"https://rally1.rallydev.com/slm/webservice/v2.0/defect?query=(\" &amp; res &amp; \")&amp;fetch=FormattedID,State\"\n\noRequest.Open \"GET\", sURL, True\noRequest.setRequestHeader \"Content-Type\", \"application/json;charset=UTF-8\"\noRequest.Send\noRequest.WaitForResponse\n' Set Defects = oRequest.ResponseText\nDebug.Print (oRequest.ResponseText)\n\nEnd Function\n</code></pre>\n\n<p>Unfortunately, i get rubbish instead of json in response like:\n?      i?ANA0\u0010E?=A(utU\n\u00a4RoP\u00b0irC\u00b0%'.o$%\u00b7CI{OOYO????uApeaBRM?Zb?u?OWo?\"{oSCy5?(}e??e?qBA\"qnu~E\u00b7Uu?|?aRbE?a>an\u00b5?c?9P=?A[\u00adOu\u000el?0i  O {PZS?Af~??\u000f?^??k??R\u02dc?|\u00a9?#iEoPN\u000bO|?\u00a6'y\f?vO^Ol? ]?g?#?AjAa?\\aC\u00a4y  %\u00a9e\u00bb]\"IHog??@:?\u00b7 (??\"\u00b6E9yog?Az?7bw?/#?eWp^u?ZU?u??3?q?A)c\fy7\u00b5e?E  </p>\n\n<p>Could you please take a look at it and provide an solution how it can be fixed?</p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3913, "user_id": 3946482, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lVkJs.jpg?s=128&g=1", "display_name": "plaidshirt", "link": "https://stackoverflow.com/users/3946482/plaidshirt"}, "edited": false, "score": 0, "creation_date": 1424962234, "post_id": 28729807, "comment_id": 45773411, "body": "Great solution! Thanks a lot!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1424962857, "last_edit_date": 1424962857, "creation_date": 1424899154, "answer_id": 28729807, "question_id": 28729564, "link": "https://stackoverflow.com/questions/28729564/count-rows-in-a-block-of-cells/28729807#28729807", "title": "Count rows in a block of cells", "body": "<p>Here is a way to get the number of rows, columns, etc. in a range which is a <strong>block</strong>:</p>\n\n<pre><code>Set r = Range(\"C2:D10\")\n\nnLastRow = r.Rows.Count + r.Row - 1\nMsgBox (\"last row \" &amp; nLastRow)\n\nnLastColumn = r.Columns.Count + r.Column - 1\nMsgBox (\"last column \" &amp; nLastColumn)\n\nnFirstRow = r.Row\nMsgBox (\"first row \" &amp; nFirstRow)\n\nnFirstColumn = r.Column\nMsgBox (\"first column \" &amp; nFirstColumn)\n\nnumrow = r.Rows.Count\nMsgBox (\"number of rows \" &amp; numrow)\n\nnumcol = r.Columns.Count\nMsgBox (\"number of columns \" &amp; numcol)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "is_accepted": false, "score": 2, "last_activity_date": 1424953552, "creation_date": 1424953552, "answer_id": 28742441, "question_id": 28729564, "link": "https://stackoverflow.com/questions/28729564/count-rows-in-a-block-of-cells/28742441#28742441", "title": "Count rows in a block of cells", "body": "<p>ActiveSheet.Range(\"C2:D10\").Rows.Count</p>\n"}], "owner": {"reputation": 3913, "user_id": 3946482, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lVkJs.jpg?s=128&g=1", "display_name": "plaidshirt", "link": "https://stackoverflow.com/users/3946482/plaidshirt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 882, "favorite_count": 0, "accepted_answer_id": 28729807, "answer_count": 2, "score": 1, "last_activity_date": 1424962857, "creation_date": 1424898359, "last_edit_date": 1531164843, "question_id": 28729564, "link": "https://stackoverflow.com/questions/28729564/count-rows-in-a-block-of-cells", "title": "Count rows in a block of cells", "body": "<p>I would like to count rows in a range of cells, C2:D10. I use above code to select them, but I have no idea, how to count rows in this interval.</p>\n\n<pre><code>ActiveSheet.Range(\"C2:D10\").Select\n</code></pre>\n"}, {"tags": ["vba", "checkbox", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4607222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be065b1f1b9700bb812d32d89d1ab288?s=128&d=identicon&r=PG&f=1", "display_name": "Dirk Cruz", "link": "https://stackoverflow.com/users/4607222/dirk-cruz"}, "edited": false, "score": 0, "creation_date": 1424934259, "post_id": 28729408, "comment_id": 45757002, "body": "Thank you for your answer, however even so the error persists: Object Required!"}, {"owner": {"reputation": 11, "user_id": 4607222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be065b1f1b9700bb812d32d89d1ab288?s=128&d=identicon&r=PG&f=1", "display_name": "Dirk Cruz", "link": "https://stackoverflow.com/users/4607222/dirk-cruz"}, "edited": false, "score": 0, "creation_date": 1425029281, "post_id": 28729408, "comment_id": 45802809, "body": "Great that you have spotted this misspelling in the piece of code, after correction it did work. Thanks as well for the advice to use &quot;Option Explicit&quot; to force the compiler to raise an exception. I can go forward now."}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": false, "score": 1, "last_activity_date": 1424962048, "last_edit_date": 1424962048, "creation_date": 1424897835, "answer_id": 28729408, "question_id": 28729263, "link": "https://stackoverflow.com/questions/28729263/word-vba-status-of-a-checkbox-in-word-table-cells/28729408#28729408", "title": "Word VBA: Status of a checkbox in Word table cells", "body": "<p>The keyword \"Set\" is for objects.  An Integer is not an object so your line needs to be just:</p>\n\n<pre><code>nitem = cl.Range.ContentControls.Count\n</code></pre>\n\n<p>without \"Set\"</p>\n\n<p>EDIT:  This would cause the error that you are referring to, but I also noticed another issue that needs to be fixed after your comment.</p>\n\n<p>Note that the declared variable is \"cl\" where the second character is a lowercase \"L\".  You have tried to use it as \"c1\" where the second character is the numeral \"One\"  Make sure to use \"CL\" in all cases where this variable appears (in the line in question and also two lines below this)</p>\n\n<p>If you use \"Option Explicit\" at the beginning of the \"This_Workbook\" module (or whatever module the code is in) before any Subroutines, this will help prevent misspelling errors like this as the compiler will raise an exception alerting you that the variable is not defined.</p>\n"}], "owner": {"reputation": 11, "user_id": 4607222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be065b1f1b9700bb812d32d89d1ab288?s=128&d=identicon&r=PG&f=1", "display_name": "Dirk Cruz", "link": "https://stackoverflow.com/users/4607222/dirk-cruz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1114, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1425142114, "creation_date": 1424897277, "last_edit_date": 1425142114, "question_id": 28729263, "link": "https://stackoverflow.com/questions/28729263/word-vba-status-of-a-checkbox-in-word-table-cells", "title": "Word VBA: Status of a checkbox in Word table cells", "body": "<p>I have a set of identical Word files containing a set of yes/no questions organized in a table with simple checkboxes (from the Developer tab / Content Controls) included in columns 3 and 5, corresponding to the Yes or No answer.</p>\n\n<p>The Yes and No checkboxes are either checked or unchecked. </p>\n\n<p>I want to count the number of Yes and No checks for each of the questions. The Word files are already available and their format cannot be changed.</p>\n\n<p>As a first  step in this task I am trying to recognize when a table cell contains a checkbox, and then read the status of the checkbox: checked or unchecked. </p>\n\n<p>I came to the following code to identify the checkboxes. VBA complains with a compilation error: \"Object Required\", at line \"set nitem.....\".</p>\n\n<pre><code>Dim tbl As Table\nDim cl As Cell\nDim nitem As Integer\n\n''All tables\nFor Each tbl In ActiveDocument.Tables\n    For Each cl In tbl.Rows(1).Cells\n        If Not cl.Range.ContentControls Is Nothing Then\n            Set nitem = c1.Range.ContentControls.Count\n            MsgBox (\"Nr of Items\" &amp; nitem)\n            If c1.Range.ContentControls.Item(1).Type = wdContentControlCheckBox Then\n              ''Select ...\n              cl.Column.Select\n               .........\n            End If\n        End If\n    Next\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 1, "creation_date": 1424896669, "post_id": 28729032, "comment_id": 45744424, "body": "&quot;<i>it isn&#39;t working</i>&quot; doesn&#39;t tell us anything.  Tell us what&#39;s actually happening, and what should be happening.  An example can also be helpful."}, {"owner": {"reputation": 96, "user_id": 4563504, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/801bc6830bee12cfa1b8c43036126ea3?s=128&d=identicon&r=PG&f=1", "display_name": "Dimitri M", "link": "https://stackoverflow.com/users/4563504/dimitri-m"}, "reply_to_user": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1424907372, "post_id": 28729032, "comment_id": 45749670, "body": "I understand i didn&#39;t provide an example... as far as code, but I tried to explain it: &quot;whats happening right now is Alert starts running more frequently then the 3 seconds I would like it to&quot; In other words when Alert is triggered more than once in another code, instead of hearing &quot;Beep*, Part is done, Beep*&quot; wait 3 seconds &quot;Beep*, Part is done, Beep*&quot;... I hear &quot;Beep*, Part is done, Beep*&quot; wait (random seconds less than 3) &quot;Beep*, Part is done, Beep*&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 96, "user_id": 4563504, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/801bc6830bee12cfa1b8c43036126ea3?s=128&d=identicon&r=PG&f=1", "display_name": "Dimitri M", "link": "https://stackoverflow.com/users/4563504/dimitri-m"}, "edited": false, "score": 0, "creation_date": 1424907476, "post_id": 28729156, "comment_id": 45749716, "body": "Thank you, I believe I tried this and it did not work, but I will try this again and let you know. I do not have the code handy right now."}, {"owner": {"reputation": 96, "user_id": 4563504, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/801bc6830bee12cfa1b8c43036126ea3?s=128&d=identicon&r=PG&f=1", "display_name": "Dimitri M", "link": "https://stackoverflow.com/users/4563504/dimitri-m"}, "edited": false, "score": 0, "creation_date": 1424951026, "post_id": 28729156, "comment_id": 45766254, "body": "This did not work, if two of the events triggered then the &quot;Beep, Part is Done, Beep&quot; competed."}], "tags": [], "owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "is_accepted": false, "score": 0, "last_activity_date": 1424896902, "creation_date": 1424896902, "answer_id": 28729156, "question_id": 28729032, "link": "https://stackoverflow.com/questions/28729032/excel-vba-polling-preventing-code-from-running-more-than-once-in-specified-time/28729156#28729156", "title": "Excel VBA Polling/ preventing code from running more than once in specified time", "body": "<p>Try it like this:</p>\n\n<pre><code>Sub Alert()\n\n    If Sheets(\"Sheet1\").CommandButton21.Enabled = False And Sheets(\"Sheet1\").CommandButton22.Enabled = False And Sheets(\"Sheet1\").CommandButton25.Enabled = False Then\n        Beep\n        Application.Speech.Speak (\"Part is done\")\n        Beep\n\n    ElseIf Sheets(\"Sheet1\").CommandButton21.Enabled = False And Sheets(\"Sheet1\").CommandButton22.Enabled = False Then\n        Beep\n        Application.Speech.Speak (\"Part is done\")\n        Beep\n\n    ElseIf Sheets(\"Sheet1\").CommandButton21.Enabled = False And Sheets(\"Sheet1\").CommandButton25.Enabled = False Then\n        Beep\n        Application.Speech.Speak (\"Part is done\")\n        Beep\n\n    ElseIf Sheets(\"Sheet1\").CommandButton22.Enabled = False And Sheets(\"Sheet1\").CommandButton25.Enabled = False Then\n        Beep\n        Application.Speech.Speak (\"Part is done\")\n        Beep\n\n    ElseIf Sheets(\"Sheet1\").CommandButton21.Enabled = False Then\n        Beep\n        Application.Speech.Speak (\"Part is done\")\n        Beep\n\n    ElseIf Sheets(\"Sheet1\").CommandButton22.Enabled = False Then\n        Beep\n        Application.Speech.Speak (\"Part is done\")\n        Beep\n\n    ElseIf Sheets(\"Sheet1\").CommandButton25.Enabled = False Then\n        Beep\n        Application.Speech.Speak (\"Part is done\")\n        Beep\n    Else\n        Exit Sub\n    End If\n\n    Call AlertTIMER\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 96, "user_id": 4563504, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/801bc6830bee12cfa1b8c43036126ea3?s=128&d=identicon&r=PG&f=1", "display_name": "Dimitri M", "link": "https://stackoverflow.com/users/4563504/dimitri-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1425046207, "creation_date": 1425046207, "answer_id": 28767047, "question_id": 28729032, "link": "https://stackoverflow.com/questions/28729032/excel-vba-polling-preventing-code-from-running-more-than-once-in-specified-time/28767047#28767047", "title": "Excel VBA Polling/ preventing code from running more than once in specified time", "body": "<pre><code>Sub AlertTIMER()\n\nDim StartTick As Single\nDim CurrTick As Single\nDim EndTick As Single\n\nStartTick = Timer\nEndTick = StartTick + (\"3.00\")\nDo\n    CurrTick = Timer\n    DoEvents\nLoop Until CurrTick &gt;= EndTick\nCall Alert\nEnd Sub\n</code></pre>\n\n<p>This isn't exactly what I was looking for but it gets the job done I suppose... This allows the \"Beep, Part is Done, Beep\" to become synced up instead of competing. If AlertTimer is triggered while it has already been triggered previously (waiting for CurrTick to reach EndTick) then EndTick gets reset so now it is only being triggered once.</p>\n"}], "owner": {"reputation": 96, "user_id": 4563504, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/801bc6830bee12cfa1b8c43036126ea3?s=128&d=identicon&r=PG&f=1", "display_name": "Dimitri M", "link": "https://stackoverflow.com/users/4563504/dimitri-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 665, "favorite_count": 0, "accepted_answer_id": 28767047, "answer_count": 2, "score": 0, "last_activity_date": 1425046207, "creation_date": 1424896445, "last_edit_date": 1424982755, "question_id": 28729032, "link": "https://stackoverflow.com/questions/28729032/excel-vba-polling-preventing-code-from-running-more-than-once-in-specified-time", "title": "Excel VBA Polling/ preventing code from running more than once in specified time", "body": "<p>I have another code thats running in the background, and when certain conditions are met it will call the sub Alert. There are multiple scenarios that call this code out though and whats happening right now is Alert starts running more frequently then the 3 seconds I would like it to (indicated by AlertTIMER). Here's my attempt to solve the issue</p>\n\n<pre><code>Sub Alert()\nIf Sheets(\"Sheet1\").CommandButton21.Enabled = False And Sheets(\"Sheet1\").CommandButton22.Enabled = False And Sheets(\"Sheet1\").CommandButton25.Enabled = False Then\nBeep\nApplication.Speech.Speak (\"Part is done\")\nBeep\nCall AlertTIMER\nExit Sub\n\nElseIf Sheets(\"Sheet1\").CommandButton21.Enabled = False And Sheets(\"Sheet1\").CommandButton22.Enabled = False Then\nBeep\nApplication.Speech.Speak (\"Part is done\")\nBeep\nCall AlertTIMER\nExit Sub\n\nElseIf Sheets(\"Sheet1\").CommandButton21.Enabled = False And Sheets(\"Sheet1\").CommandButton25.Enabled = False Then\nBeep\nApplication.Speech.Speak (\"Part is done\")\nBeep\nCall AlertTIMER\nExit Sub\n\nElseIf Sheets(\"Sheet1\").CommandButton22.Enabled = False And Sheets(\"Sheet1\").CommandButton25.Enabled = False Then\nBeep\nApplication.Speech.Speak (\"Part is done\")\nBeep\nCall AlertTIMER\nExit Sub\n\nElseIf Sheets(\"Sheet1\").CommandButton21.Enabled = False Then\nBeep\nApplication.Speech.Speak (\"Part is done\")\nBeep\nCall AlertTIMER\nExit Sub\n\nElseIf Sheets(\"Sheet1\").CommandButton22.Enabled = False Then\nBeep\nApplication.Speech.Speak (\"Part is done\")\nBeep\nCall AlertTIMER\nExit Sub\n\nElseIf Sheets(\"Sheet1\").CommandButton25.Enabled = False Then\nBeep\nApplication.Speech.Speak (\"Part is done\")\nBeep\nCall AlertTIMER\nExit Sub\nElse\nExit Sub\nEnd If\n\nEnd Sub\n\nSub AlertTIMER()\nDim ACountDown As Date\nACountDown = Now + TimeValue(\"00:00:03\")\nApplication.OnTime ACountDown, \"Alert\"\nEnd Sub\n</code></pre>\n\n<p>Clearly it did not work haha. Originally i had one if Statement with or's instead of the ands... but that was not working either. Any help?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I believe what is happening is in the AlertTIMER sub it calculates the value ACountDown. In example lets say it is first triggered at 12:00:00 AM ( ACountDown will = 12:00:03 AM) and then submts it to Application.OnTime as that value (12:00:03 AM). When another event is triggered lets say at 12:00:01 AM it calculates ACountDown as 12:00:04 AM and then submits it to Application.OnTime as that value (12:00:04 AM). So in the end I have \"Alert\" being triggered at 12:00:03 and 12:00:04. One way to solve this would be if the code kept ACountDown as a variable until \"Alert\" is triggered from Application.OnTime??. So with the previous example it calculates 12:00:03 AM first for ACountDown, but then is reset to 12:00:04 AM when the second trigger comes in. At 12:00:04 AM it then triggers \"Alert\" via Application.OnTime - only running it once.</p>\n\n<p>EDIT2:</p>\n\n<p>Another way to work around this, if there is a way to accomplish this, would be to check if there is an Application.OnTime running/active if so then cancel it. The code would look like this:</p>\n\n<pre><code>Sub AlertTIMER()\nDim ACountDown As Date\n\nIf Application.OnTime(, \"Alert\") Is Nothing Then\nElse\n Application.OnTime ACountDown, \"Alert\", , False\nEnd If\n\nACountDown = Now + TimeValue(\"00:00:03\")\nApplication.OnTime ACountDown, \"Alert\"\nEnd Sub\n</code></pre>\n\n<p>But <code>If Application.OnTime(, \"Alert\") Is Nothing Then</code> returns an error... as you can't check to see if it is nothing since it's not an object. Any thought on how maybe I could get this to work?</p>\n"}, {"tags": ["excel", "adodb", "recordset", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1424897702, "post_id": 28729023, "comment_id": 45745011, "body": "What type of cursor does your <code>varConnection</code> use? I believe you need <code>adOpenKeyset</code> or <code>adOpenStatic</code> to get an accurate <code>.RecordCount</code> with ADO. The default <code>adOpenForwardOnly</code> is insufficient for this purpose."}, {"owner": {"reputation": 675, "user_id": 3431121, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1365436515/picture?type=large", "display_name": "jaysoncopes", "link": "https://stackoverflow.com/users/3431121/jaysoncopes"}, "edited": false, "score": 0, "creation_date": 1425308880, "post_id": 28729023, "comment_id": 45897822, "body": "@Jeeped I&#39;ve been using adUseClient (3). I saw it somewhere on the internet, but if adOpenKeyset or adOpenStatic would be better, I&#39;d be willing to try it."}], "answers": [{"comments": [{"owner": {"reputation": 675, "user_id": 3431121, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1365436515/picture?type=large", "display_name": "jaysoncopes", "link": "https://stackoverflow.com/users/3431121/jaysoncopes"}, "edited": false, "score": 0, "creation_date": 1424898792, "post_id": 28729256, "comment_id": 45745604, "body": "Thanks for the quick reply! I don&#39;t like the fact that I would have to work around ADO 2.5&#39;s idiosyncrasies, but if ADO 6.0 doesn&#39;t work out, this would absolutely be a valid option (I just tested it)."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 1, "last_activity_date": 1424897266, "creation_date": 1424897266, "answer_id": 28729256, "question_id": 28729023, "link": "https://stackoverflow.com/questions/28729023/type-mismatch-error-on-adodb-recordset/28729256#28729256", "title": "&#39;Type Mismatch&#39; Error on ADODB.Recordset", "body": "<p>I haven't had this exact problem, but I've found that the <code>recordcount</code> property on an ADODB recordset is hit or miss. Your best bet is to rewrite the loops like:</p>\n\n<pre><code>recordset.movefirst \nWhile Not recordset.eof\n    &lt;your stuff with your record&gt;\n    recordset.movenext\nLoop\n</code></pre>\n\n<p>Also, to test that there are records in your recordset you can use:</p>\n\n<pre><code>If recordset.BOF and recordset.EOF THEN\n     &lt;Something is wrong there are no records&gt;\nEnd If\n</code></pre>\n\n<p>My guess is that the ADODB recordcount property is probably crap with the 64 bit version of whatever ODBC driver you are using as it is in nearly every ODBC driver.</p>\n"}, {"comments": [{"owner": {"reputation": 2362, "user_id": 2585189, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/572230673/picture?type=large", "display_name": "Jay Killeen", "link": "https://stackoverflow.com/users/2585189/jay-killeen"}, "edited": false, "score": 1, "creation_date": 1465283556, "post_id": 28729499, "comment_id": 62823065, "body": "Saved my bacon. Cheers! Upgrading from 2.8 to 6.1 allowed me to correctly assigned a Long variable called <code>RecordCount</code> to the <code>rs.RecordCount</code> property"}], "tags": [], "owner": {"reputation": 675, "user_id": 3431121, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1365436515/picture?type=large", "display_name": "jaysoncopes", "link": "https://stackoverflow.com/users/3431121/jaysoncopes"}, "is_accepted": false, "score": 3, "last_activity_date": 1424898153, "creation_date": 1424898153, "answer_id": 28729499, "question_id": 28729023, "link": "https://stackoverflow.com/questions/28729023/type-mismatch-error-on-adodb-recordset/28729499#28729499", "title": "&#39;Type Mismatch&#39; Error on ADODB.Recordset", "body": "<p>Thank you guys for your quick replies, however, I somehow managed to get the idea of using ADO 6.1 instead of ADO 2.5. It appears that using a more up-to-date version of ActiveX Database Objects did the trick, duh. </p>\n\n<p>For future reference, if you are going to upgrade to ADO 6.0, the ConnectionString value will be the same EXCEPT you must use <code>User ID=&lt;USR&gt;; Password=&lt;PSWD&gt;</code> instead of <code>USR=&lt;USR&gt;;PWD=&lt;PWD&gt;</code></p>\n"}, {"comments": [{"owner": {"reputation": 362, "user_id": 2752308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574f9f2cb6733e7ebcdd340d6ec14b25?s=128&d=identicon&r=PG&f=1", "display_name": "Marcelo Scofano Diniz", "link": "https://stackoverflow.com/users/2752308/marcelo-scofano-diniz"}, "edited": false, "score": 0, "creation_date": 1561048693, "post_id": 46494340, "comment_id": 99946320, "body": "Thanks, fixed mine VBA code in Excel &amp; Word &amp; Access after had to upgrade Office 32 =&gt; 64 because of Visio...  Indeed, I think that this should be marked as the answer."}, {"owner": {"reputation": 730, "user_id": 7037499, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-58fz0ZZjpew/AAAAAAAAAAI/AAAAAAAAAJ4/7YcGnwKq7HI/photo.jpg?sz=128", "display_name": "dfresh22", "link": "https://stackoverflow.com/users/7037499/dfresh22"}, "reply_to_user": {"reputation": 362, "user_id": 2752308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574f9f2cb6733e7ebcdd340d6ec14b25?s=128&d=identicon&r=PG&f=1", "display_name": "Marcelo Scofano Diniz", "link": "https://stackoverflow.com/users/2752308/marcelo-scofano-diniz"}, "edited": false, "score": 0, "creation_date": 1561055423, "post_id": 46494340, "comment_id": 99949195, "body": "been a while since I looked at this one, but I am glad it was able to help you out. Cheers"}], "tags": [], "owner": {"reputation": 730, "user_id": 7037499, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-58fz0ZZjpew/AAAAAAAAAAI/AAAAAAAAAJ4/7YcGnwKq7HI/photo.jpg?sz=128", "display_name": "dfresh22", "link": "https://stackoverflow.com/users/7037499/dfresh22"}, "is_accepted": false, "score": 11, "last_activity_date": 1561055461, "last_edit_date": 1561055461, "creation_date": 1506707190, "answer_id": 46494340, "question_id": 28729023, "link": "https://stackoverflow.com/questions/28729023/type-mismatch-error-on-adodb-recordset/46494340#46494340", "title": "&#39;Type Mismatch&#39; Error on ADODB.Recordset", "body": "<p>this issue is actually caused by a bug in earlier excels. there is a hotfix out there. <a href=\"https://support.microsoft.com/en-us/help/983246/-type-mismatch-error-message-when-you-run-a-vba-macro-in-a-64-bit-vers\" rel=\"noreferrer\">HotFix</a></p>\n\n<p>I develop some macros on office 16, but when I do UAT on previous versions, it fails, a quick easy solution for this is simply to cast the RecordCount</p>\n\n<pre><code>rst = SomeRecordset\ndim rstCount as Long\nrstCount = CLng(rst.RecordCount)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9908145, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/79d61a9b8daf8a55b5e59ec88e96f87e?s=128&d=identicon&r=PG", "display_name": "Ashwin", "link": "https://stackoverflow.com/users/9908145/ashwin"}, "is_accepted": false, "score": 0, "last_activity_date": 1528365610, "creation_date": 1528365610, "answer_id": 50738392, "question_id": 28729023, "link": "https://stackoverflow.com/questions/28729023/type-mismatch-error-on-adodb-recordset/50738392#50738392", "title": "&#39;Type Mismatch&#39; Error on ADODB.Recordset", "body": "<p>Just check the version of Excel. ADO works well 32 bit and teething issues with 64 bit.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 7108677, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-p5wMp26p1bM/AAAAAAAAAAI/AAAAAAAAHTs/fKOL34-Nmg4/photo.jpg?sz=128", "display_name": "Jonson Tsai", "link": "https://stackoverflow.com/users/7108677/jonson-tsai"}, "is_accepted": false, "score": 2, "last_activity_date": 1531808257, "creation_date": 1531808257, "answer_id": 51374415, "question_id": 28729023, "link": "https://stackoverflow.com/questions/28729023/type-mismatch-error-on-adodb-recordset/51374415#51374415", "title": "&#39;Type Mismatch&#39; Error on ADODB.Recordset", "body": "<p>I change it from \n    as Long\nto\n    as LongLong\nThen my VBA starts to work. No hotfix needed...</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4086589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a936d5fca2f1cbf070a8e1760fba3be?s=128&d=identicon&r=PG&f=1", "display_name": "Bobznkazoo", "link": "https://stackoverflow.com/users/4086589/bobznkazoo"}, "is_accepted": false, "score": 0, "last_activity_date": 1558387174, "creation_date": 1558387174, "answer_id": 56228315, "question_id": 28729023, "link": "https://stackoverflow.com/questions/28729023/type-mismatch-error-on-adodb-recordset/56228315#56228315", "title": "&#39;Type Mismatch&#39; Error on ADODB.Recordset", "body": "<p>We had this error due to the same type of comparison and used the same sort of answer as from dfresh22 and Jonson Tsai.  Thanks folks!<br>\nThe only difference for us was that the error was occurring on 64-bit Office and we still have several users on 32-bit Office so it was easier to convert down to the smaller 32-bit variable instead of up to the larger 64-bit variable.  Since the variable we were comparing against RecordCount will always be less than 100 (and definitely always &lt; 32K) I was able to just Convert from Long to Integer in the 64-bit version and 32-bit code would just convert from Integer to Integer:</p>\n\n<p>IF intNumRecs > CInt(DBreports.RecordCount) THEN...</p>\n"}], "owner": {"reputation": 675, "user_id": 3431121, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1365436515/picture?type=large", "display_name": "jaysoncopes", "link": "https://stackoverflow.com/users/3431121/jaysoncopes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11506, "favorite_count": 1, "accepted_answer_id": 28729256, "answer_count": 6, "score": 5, "last_activity_date": 1588738917, "creation_date": 1424896418, "last_edit_date": 1531161705, "question_id": 28729023, "link": "https://stackoverflow.com/questions/28729023/type-mismatch-error-on-adodb-recordset", "title": "&#39;Type Mismatch&#39; Error on ADODB.Recordset", "body": "<p>I have a program that is supposed to read data from an SQL database and report back to Excel. It works as expected on a 32-bit machine, but since I moved over to a 64-bit work environment, the program has failed to run. Here is a sample of my code (the first error returned):</p>\n\n<pre><code>Private Sub SearchBox_Change()\nResultBox.Clear\n\nCall CompileQuery\n\n'If the query is empty\nIf SearchBox.Value = \"\" Then\n    NumShowingLabel = \"Showing 0 of 0 Results\"\n    ResultBox.Clear\n    GoTo noSearch\nEnd If\n\n'Open a new query with varQuery\nWith varRecordset\n    .ActiveConnection = varConnection\n    .Open varQuery\nEnd With\n\n'Set NumShowingLabel\nIf varRecordset.RecordCount &gt; varMaxResults Then\n    NumShowingLabel = \"Showing 60 of \" &amp; varRecordset.RecordCount &amp; \" Results\"\nElse\n    NumShowingLabel = \"Showing \" &amp; varRecordset.RecordCount &amp; \" of \" &amp; varRecordset.RecordCount &amp; \" Results\"\nEnd If\n\n'As long as there is a record, move to the first one\nIf Not varRecordset.RecordCount = 0 Then varRecordset.MoveFirst\n\n'Add each record to ResultBox\nIf varRecordset.RecordCount &gt; varMaxResults Then\n    For varTempInt = 1 To varMaxResults\n        ResultBox.AddItem varRecordset.Fields(\"FileName\").Value\n        varRecordset.MoveNext\n    Next\nElse\n    For varTempInt = 1 To varRecordset.RecordCount\n        ResultBox.AddItem varRecordset.Fields(\"FileName\").Value\n        varRecordset.MoveNext\n    Next\nEnd If\n\n'Release varRecordSet\nvarRecordset.Close\n\nnoSearch:\n\nEnd Sub\n</code></pre>\n\n<p>When run, Excel returns an error \"Type Mismatch\" and highlights <code>.RecordCount</code> of <code>For varTempInt = 1 To varRecordset.RecordCount</code> (the last for loop in the sample). I have installed the hotfix recommended by the Windows Support Article 983246, at least to the best of my understanding. I installed it to the C: directory and restarted my machine, but it still does not work.</p>\n\n<p>Edit 1: Just wanted to clarify that I was previously using ADO 2.5 NOT ADO 6.1</p>\n\n<p>TL;DR: How can I fix a <code>RecordSet.RecordCount</code> \"Type Mismatch\" error on a 64-bit machine running Excel 2010?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121, "user_id": 4607510, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/971d3e26e43b9fca8ee7c7e5857b54dc?s=128&d=identicon&r=PG&f=1", "display_name": "M M", "link": "https://stackoverflow.com/users/4607510/m-m"}, "is_accepted": false, "score": 10, "last_activity_date": 1593168233, "last_edit_date": 1593168233, "creation_date": 1424895830, "answer_id": 28728875, "question_id": 28728600, "link": "https://stackoverflow.com/questions/28728600/in-excel-can-i-use-a-hyperlink-to-run-vba-macro/28728875#28728875", "title": "In Excel, can I use a hyperlink to run vba macro?", "body": "<p>Yes you can, follow the below Simple Steps to do so:</p>\n<ol>\n<li>Select the Cell Where you want to make the Hyperlink</li>\n<li>Righ Click \u2013&gt; Hyperlink\u2026</li>\n<li>Enter the Address of the Same cell where you are making the hyperlink and Give name to the Link. See the below picture:</li>\n</ol>\n<p>Assign Macro to a Hyperlink</p>\n<ol start=\"4\">\n<li>Click Ok.</li>\n<li>HyperLink is created.</li>\n</ol>\n<p>Note: Clicking on this Hyperlink, will do nothing because it is assigned to the same Cell Address.</p>\n<ol start=\"6\">\n<li>Now Press Alt + F11</li>\n<li>Copy paste the below Code</li>\n</ol>\n<p>Run Excel Macro by Clicking on a Hyperlink</p>\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)  \n    'Check if the Target Address is same as you have given  \n    'In the above example i have taken A4 Cell, so I am  \n    'Comparing this with $A$4  \n  \n    If Target.Range.Address = &quot;$A$4&quot; Then  \n        'Write your all VBA Code, which you want to execute  \n        'Or Call the function or Macro which you have  \n        'written or recorded.  \n        MsgBox &quot;Write your Code here to be executed&quot;  \n        Exit Sub  \n    End If  \nEnd Sub  \n</code></pre>\n<p>In the Above Code we are comparing the Cell Address and then Executing a Set of Code or Function. There is another way of doing this also. We can Compare with the Target Name and execute the Code. In the above Example as i have given the Name of the Hyperlink Target as MyMacro.</p>\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)  \n    'Check if the Target Name is same as you have given  \n    'In the above example i have given the Name of the HyperLink  \n    'is MyMacro.  \n  \n    If Target.Name = &quot;mymacro&quot; Then  \n        'Write your all VBA Code, which you want to execute  \n        'Or Call the function or Macro which you have  \n        'written or recorded.  \n        MsgBox &quot;Write your Code here to be executed&quot;  \n        Exit Sub  \n    End If  \nEnd Sub  \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": true, "score": 18, "last_activity_date": 1424895840, "creation_date": 1424895840, "answer_id": 28728877, "question_id": 28728600, "link": "https://stackoverflow.com/questions/28728600/in-excel-can-i-use-a-hyperlink-to-run-vba-macro/28728877#28728877", "title": "In Excel, can I use a hyperlink to run vba macro?", "body": "<p>This will work for you</p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\n        MsgBox \"Row \" &amp; ActiveCell.Row &amp; \" is clicked\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 3, "last_activity_date": 1424896230, "creation_date": 1424896230, "answer_id": 28728969, "question_id": 28728600, "link": "https://stackoverflow.com/questions/28728600/in-excel-can-i-use-a-hyperlink-to-run-vba-macro/28728969#28728969", "title": "In Excel, can I use a hyperlink to run vba macro?", "body": "<p>I think rather than go through the hassle of creating a hyperlink for each cell, you would be better off creating a macro that references the <code>Activecell</code> property. Next, create a keyboard shortcut for the macro to run. To do so:</p>\n\n<ol>\n<li>Press ALT+F8</li>\n<li>Select <code>Options</code></li>\n<li>Choose a key to be the shortcut key </li>\n</ol>\n\n<p>If you already have hyperlinks, triggering a macro using the <code>Hyperlink_Follow</code> event may be best. If not, then consider my recommendation.</p>\n"}, {"tags": [], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "is_accepted": false, "score": 4, "last_activity_date": 1593169235, "last_edit_date": 1593169235, "creation_date": 1593003709, "answer_id": 62555687, "question_id": 28728600, "link": "https://stackoverflow.com/questions/28728600/in-excel-can-i-use-a-hyperlink-to-run-vba-macro/62555687#62555687", "title": "In Excel, can I use a hyperlink to run vba macro?", "body": "<p>I'd just like to add another approach inspired by one of the answers here, that I've used in the past. It means you don't have to create hyperlinks or a helper column to initiate processing the row, you can just double click on any cell in the row you want to process:</p>\n<p>On the sheet you want to have the double-clicking work use this:</p>\n<pre><code>Private Sub Worksheet_Activate()\nApplication.OnDoubleClick = &quot;Module1.ProcessRow&quot;\nEnd Sub\n\nPrivate Sub Worksheet_Deactivate()\nApplication.OnDoubleClick = &quot;&quot;\nEnd Sub\n</code></pre>\n<p>And then in <code>Module1</code> have a routine that will process the active cell:</p>\n<pre><code>Sub processRow()\nMsgBox &quot;Row &quot; &amp; ActiveCell.Row &amp; &quot; on &quot; &amp; ActiveSheet.Name &amp; &quot; was clicked&quot;\nEnd Sub\n</code></pre>\n<p>You should also disable the Excel double-click method in the workbook events:</p>\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\nApplication.OnDoubleClick = &quot;&quot;\nEnd Sub\n</code></pre>\n<p>I find the double-click method is really, really handy and intuitive for a lot of processes e.g. bringing up a UserForm with data populated from the row or transferring that data to another sheet maybe with calcs or formatting etc.</p>\n"}, {"comments": [{"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 2, "creation_date": 1593165818, "post_id": 62560690, "comment_id": 110690639, "body": "Interesting stuff, I didn&#39;t know functions could be called using this <code>#Function()</code> in a hyperlink syntax! Although I just tried a very simple application of it and the function is being called twice, and then I get a message saying &quot;reference isn&#39;t valid&quot; - weird, I will investigate"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 1, "creation_date": 1593166245, "post_id": 62560690, "comment_id": 110690827, "body": "@ jamheadart: Neither me, until I discovered it (I do not remember where and when...). I have some such pieces of code in my collection or interesting stuf. Nobody knows everything... In my opinion, it is important to learn and be able to appreciate what it is really interesting and may be useful :) About your problem, it is an error in your function. Its weakness is that it does not allow step by step debugging. When an error exists, it does not raise an error. It behaves in this way Working twice and issuing a semi elocvent message. <b>The code does not stop on error</b>! Very careful on coding"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1593167048, "post_id": 62560690, "comment_id": 110691168, "body": "Definitely no way to know everything, but that&#39;s what keeps it interesting, if we knew it all we would be bored!! For my issue, I tried literally just <code>=HYPERLINK(&quot;#MyUdf()&quot;,&quot;Click me&quot;)</code> in a cell, and then in <code>Module1</code> had a function <code>Public Function MyUDF(): MsgBox &quot;wow&quot;: End Function</code>"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 1, "creation_date": 1593167664, "post_id": 62560690, "comment_id": 110691429, "body": "@ jamheadart: You missed the core of the function... :) <code>Set MyUDF = Selection</code>"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 1, "creation_date": 1593167839, "post_id": 62560690, "comment_id": 110691526, "body": "Lol yup, I didn&#39;t even realise that line was there or what it was doing. Works fine now, that&#39;s awesome. Thanks!"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 1, "creation_date": 1593167980, "post_id": 62560690, "comment_id": 110691594, "body": "@ jamheadart: Maybe it will be good to edit my answer and emphasize that also... I thought it will be self understood. Did it..."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1593168115, "post_id": 62560690, "comment_id": 110691666, "body": "Yeah I didn&#39;t realise that bit was totally necessary, I thought you were just using that as an example of how to use the <code>Selection</code> properties, I thought it would just call the function and a simple &quot;MsgBox&quot; would be called fine."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 1, "creation_date": 1593168457, "post_id": 62560690, "comment_id": 110691818, "body": "@ jamheadart: The function needs to know, somehow, to what cell is the code referring. Based on that, the function can be made to differently return... It also returns, but in that strange way, if the function does not know its root."}, {"owner": {"reputation": 238, "user_id": 6822528, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9qdwoKJelAI/AAAAAAAAAAI/AAAAAAAAADY/n0BjP2CuCZQ/photo.jpg?sz=128", "display_name": "Malan Kriel", "link": "https://stackoverflow.com/users/6822528/malan-kriel"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 1, "creation_date": 1609926705, "post_id": 62560690, "comment_id": 115971090, "body": "@FaneDuru this is an excellent implementation for my distributed software (I want to avoid using sheet specific code). I wrote a little wrapper function that can be used to run any sub from:  <code>Function runFromHyperlink(procName): Set runFromHyperlink = selection: application.Run procName: End Function</code>. The hyperlink formula would then be: <code>=HYPERLINK(&quot;#runFromHyperlink(&quot;&quot;myUdf&quot;&quot;)&quot;,&quot;Click me&quot;)</code> using @jamheadart &#39;s example. This is useful as you don&#39;t need a wrapper function for each sub with the <code>Set MyUDF = Selection</code>."}, {"owner": {"reputation": 238, "user_id": 6822528, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9qdwoKJelAI/AAAAAAAAAAI/AAAAAAAAADY/n0BjP2CuCZQ/photo.jpg?sz=128", "display_name": "Malan Kriel", "link": "https://stackoverflow.com/users/6822528/malan-kriel"}, "edited": false, "score": 0, "creation_date": 1609928249, "post_id": 62560690, "comment_id": 115971660, "body": "And <code>MyUDF</code> can then be any <code>Sub</code> or <code>Function</code> too without the <code>Set MyUDF = Selection</code> syntax. I could even pass some arguments to the procedure like: <code>=HYPERLINK(&quot;#runFromHyperlink(&quot;&quot;foo(5)&quot;&quot;)&quot;,&quot;Run procedure &#39;foo&#39; with argument of 5&quot;)</code> or <code>=HYPERLINK(&quot;#runFromHyperlink(&quot;&quot;foo(True)&quot;&quot;)&quot;,&quot;Run procedure &#39;foo&#39; with argument True&quot;)</code>. I couldn&#39;t get it to work for string arguments though."}], "tags": [], "owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "is_accepted": false, "score": 7, "last_activity_date": 1593168015, "last_edit_date": 1593168015, "creation_date": 1593019365, "answer_id": 62560690, "question_id": 28728600, "link": "https://stackoverflow.com/questions/28728600/in-excel-can-i-use-a-hyperlink-to-run-vba-macro/62560690#62560690", "title": "In Excel, can I use a hyperlink to run vba macro?", "body": "<p>The more interesting way of hyperlink to run a macro, looks to be the next approach (Hyperlink formula). It does not need any event:</p>\n<ol>\n<li>Write a hyperlink formula in a cell. This can be done in VBA, too:</li>\n</ol>\n<pre><code>    Sub testCreateHyperlinkFunction()\n       'Very important to have # in front of the function name!\n       Range(&quot;A1:A5&quot;).Formula = &quot;=HYPERLINK(&quot;&quot;#MyFunctionkClick()&quot;&quot;, &quot;&quot;Run a function...&quot;&quot;)&quot;\n    End Sub\n</code></pre>\n<p>A more spectacular use will be the next approach, able to keep the initial cells value of the processed range (&quot;A1:A5&quot; in example):</p>\n<pre><code>Sub testCreateHyperlinkFunctionBis()\n  Dim rng As Range, arr As Variant, c As Range, i As Long\n   Set rng = Range(&quot;A1:A5&quot;)\n   arr = rng.Value\n   For i = 1 To UBound(arr, 1)\n     Range(&quot;A&quot; &amp; i).Formula = &quot;=HYPERLINK(&quot;&quot;#MyFunctionkClick()&quot;&quot;, &quot; &amp; _\n            IIf(IsNumeric(arr(i, 1)), arr(i, 1), &quot;&quot;&quot;&quot; &amp; arr(i, 1) &amp; &quot;&quot;&quot;&quot;) &amp; &quot;)&quot;\n   Next i\nEnd Sub\n</code></pre>\n<ol start=\"2\">\n<li>Create the function to be called (in a module):</li>\n</ol>\n<pre><code>    Function MyFunctionkClick()\n      Set MyFunctionkClick = Selection 'Do not miss this part!\n      MsgBox &quot;The clicked cell addres is &quot; &amp; Selection.row\n    End Function\n</code></pre>\n<ol start=\"3\">\n<li>Clicking the cell, the function <code>MyFunctionkClick()</code> runs...</li>\n</ol>\n"}], "owner": {"reputation": 403, "user_id": 4547107, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/ef42f758ae6b02e6ba7c5371ff4d8738?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4547107/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49892, "favorite_count": 3, "accepted_answer_id": 28728877, "answer_count": 5, "score": 13, "last_activity_date": 1593676848, "creation_date": 1424894808, "last_edit_date": 1593676848, "question_id": 28728600, "link": "https://stackoverflow.com/questions/28728600/in-excel-can-i-use-a-hyperlink-to-run-vba-macro", "title": "In Excel, can I use a hyperlink to run vba macro?", "body": "<p>I have a spreadsheet that has many rows of data. I would like to be able to click on a cell that will run a macro using the data from that row. Since the number of rows will always be changing, I though a hyperlink for each row might be the best way.</p>\n\n<pre><code>   ROW MeterID   Lat    Long   ReadX  ReadY  ReadZ   CoeffA  CoeffB  CoeffC\n   2   10f62gs   34.1   33.3   102.2  231.3  382.2   4.34    22.1    0.002\n   3   83gs72g   34.4   31.4   109.2  213.1  372.1   2.23    12.7    0.023\n   4   43gS128   33.3   32.2   118.8  138.7  241.8   1.94    5.08    0.107\n</code></pre>\n\n<p>Is there a way to run a vba macro from clicking on a hyperlink and being able to know the row of the cell that clicked on the hyperlink?</p>\n"}, {"tags": ["vba", "object"], "comments": [{"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1424894726, "post_id": 28728399, "comment_id": 45743362, "body": "that&#39;s because <code>objcol</code> is a <code>Variant</code> which at first is equal to a <code>String</code> of &quot;computer1.ForegroundColor&quot;, &quot;computer2.ForegroundColor&quot;, etc... which then all you do is change it equal to <code>255</code> or <code>65280</code>"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1424896045, "last_edit_date": 1495541188, "creation_date": 1424895542, "answer_id": 28728804, "question_id": 28728399, "link": "https://stackoverflow.com/questions/28728399/substitution-for-object-name/28728804#28728804", "title": "Substitution for object name", "body": "<p>A <code>String</code> isn't an <em>object reference</em>; you simply can't do that.</p>\n\n<p>As <a href=\"https://stackoverflow.com/questions/28728399/substitution-for-object-name#comment45743362_28728399\">already mentioned</a>, all you're doing is re-assigning the strings' values:</p>\n\n<pre><code>objcol = myIP(i) &amp; \".ForegroundColor\" ' objcol is \"[computername].ForegroundColor\"\n\n...\n\nobjcol = 255 ' objcol is now \"255\"\n</code></pre>\n\n<hr>\n\n<p>You could have a <code>Scripting.Dictionary</code> with <code>[computername]</code> as keys and the actual object references as values, and then do something like this:</p>\n\n<pre><code>Dim mappings As New Scripting.Dictionary\nmappings.Add \"computer1\", computer1\nmappings.Add \"computer2\", computer2\n...\n\nmappings(myIP(i)).ForegroundColor = IIf(strPing = vbNullString, 255, 65280)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 4346988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cac9098034d2bd285a8aafeff37fa806?s=128&d=identicon&r=PG&f=1", "display_name": "Catsrules", "link": "https://stackoverflow.com/users/4346988/catsrules"}, "edited": false, "score": 0, "creation_date": 1424901170, "post_id": 28728876, "comment_id": 45746944, "body": "Yep that work perfectly, Thanks   It did have to add Set in front of myIP(0) set myIP(0) = computer1 set myIP(1) = computer2 set myIP(2) = computer3 set myIP(3) = computer4"}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": true, "score": 3, "last_activity_date": 1424897730, "last_edit_date": 1424897730, "creation_date": 1424895838, "answer_id": 28728876, "question_id": 28728399, "link": "https://stackoverflow.com/questions/28728399/substitution-for-object-name/28728876#28728876", "title": "Substitution for object name", "body": "<p>You are confusing the line:</p>\n\n<pre><code>computer1.foregroundcolor \n</code></pre>\n\n<p>where \"Computer1\" represents an object whose foregroundcolor you can change with:</p>\n\n<pre><code>objcol\n</code></pre>\n\n<p>which is a string which has the value of \"computer1.foregroundcolor\".</p>\n\n<p>In order to do this you would need to create an array of your objects like so:</p>\n\n<pre><code>Dim myIP() As Object\nReDim myIP(0 To 3) As Object\n\nmyIP(0) = computer1\nmyIP(1) = computer2\nmyIP(2) = computer3\nmyIP(3) = computer4\n\nFor i = 0 To 3\nMsgBox myIP(i)\n\n\nstrCommand = \"%ComSpec% /C %SystemRoot%\\system32\\ping.exe -n 1 -w 500    \" &amp;    myIP(i).name &amp; \" | \" &amp; \"%SystemRoot%\\system32\\find.exe /i \" &amp; Chr(34) &amp; \"TTL=\" &amp; Chr(34)\nstrPing = fShellRun(strCommand)\n\n\n\n    If strPing = \"\" Then\n        myIP(i).foregroundcolor = 255\n    Else\n        myIP(i).foregroundcolor = 65280\n\n    End If\n\nNext i\n\nEnd\n\nEnd Sub\n</code></pre>\n\n<p>This assumes that you have computer1, computer2 available as objects to put into your array and that these objects have a \".name\" property that contains the names \"computer1\", \"computer2\" etc.</p>\n"}], "owner": {"reputation": 45, "user_id": 4346988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cac9098034d2bd285a8aafeff37fa806?s=128&d=identicon&r=PG&f=1", "display_name": "Catsrules", "link": "https://stackoverflow.com/users/4346988/catsrules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 28728876, "answer_count": 2, "score": 1, "last_activity_date": 1424897730, "creation_date": 1424894138, "question_id": 28728399, "link": "https://stackoverflow.com/questions/28728399/substitution-for-object-name", "title": "Substitution for object name", "body": "<p>I am trying to make a object change color based on a result of a ping. I have a object for each device I am pinging, the objects name are the same as the computer. So I am trying to substitute the object name with a varible that I can pass throw with a For statement.  </p>\n\n<pre><code>Private Sub PING_Click()\nDim strCommand As String\nDim strPing As String\nDim myIP() As String\nReDim myIP(0 To 3) As String\n\nmyIP(0) = \"computer1\"\nmyIP(1) = \"computer2\"\nmyIP(2) = \"computer3\"\nmyIP(3) = \"computer4\"\n\n\n\nFor i = 0 To 3\nMsgBox myIP(i)\n\n\nstrCommand = \"%ComSpec% /C %SystemRoot%\\system32\\ping.exe -n 1 -w 500    \" &amp; myIP(i) &amp; \" | \" &amp; \"%SystemRoot%\\system32\\find.exe /i \" &amp; Chr(34) &amp; \"TTL=\" &amp; Chr(34)\nstrPing = fShellRun(strCommand)\n\nobjcol = myIP(i) &amp; \".ForegroundColor\"\n\nIf strPing = \"\" Then\n    objcol = 255\nElse\n    objcol = 65280\n\nEnd If\n\nNext i\n\nEnd\n\nEnd Sub\n</code></pre>\n\n<p>My problem is at </p>\n\n<pre><code>    objcol = myIP(i) &amp; \".ForegroundColor\"\n\nIf strPing = \"\" Then\n    objcol = 255\nElse\n    objcol = 65280\n</code></pre>\n\n<p>For some reason it does not change the object's color. It does it just fine, if I hard code, the variable for example</p>\n\n<pre><code>    objcol = myIP(i) &amp; \".ForegroundColor\"\n\nIf strPing = \"\" Then\n    computer1.ForegroundColor = 255\nElse\n    computer1.ForegroundColor = 65280 \n</code></pre>\n\n<p>Any help would be much appreciated.  </p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "random"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1424893093, "post_id": 28727744, "comment_id": 45742415, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/13195583/split-string-into-array-of-characters\">Split string into array of characters?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1424893002, "creation_date": 1424893002, "answer_id": 28728041, "question_id": 28727744, "link": "https://stackoverflow.com/questions/28727744/random-string-split-into-characters/28728041#28728041", "title": "Random string split into characters", "body": "<p>The type of <code>buff</code> is <code>string()</code> - an <em>array</em> of strings (VBA doesn't have a <code>Char</code> type).</p>\n\n<p><code>MsgBox</code> wants a <code>String</code> message, not an array of these; you'll have to <code>Join</code> the elements:</p>\n\n<pre><code>MsgBox Join(buff) 'no error\n</code></pre>\n"}], "owner": {"reputation": 3913, "user_id": 3946482, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lVkJs.jpg?s=128&g=1", "display_name": "plaidshirt", "link": "https://stackoverflow.com/users/3946482/plaidshirt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 28728041, "answer_count": 1, "score": 1, "last_activity_date": 1424893002, "creation_date": 1424891930, "last_edit_date": 1424892848, "question_id": 28727744, "link": "https://stackoverflow.com/questions/28727744/random-string-split-into-characters", "title": "Random string split into characters", "body": "<p>I have a procedure, that generates a random string without any delimiter. I store return value of this as a string, but I would like to split this text into characters and after that examine each characters. I try to use above code to split string into characters, but it gives Type mismatch error.</p>\n\n<pre><code>Sub gen()\n    Dim s As String\n    s = textgen(4000, 5)\n    Dim buff() As String\n    ReDim buff(Len(s) - 1)\n\n    For i = 1 To Len(s)\n        buff(i - 1) = Mid$(s, i, 1)\n    Next\n\n    MsgBox (buff)  ' type mismatch\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "imacros"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 4607074, "user_type": "registered", "profile_image": "https://graph.facebook.com/1287912777889065/picture?type=large", "display_name": "Dustin Haycraft", "link": "https://stackoverflow.com/users/4607074/dustin-haycraft"}, "edited": false, "score": 0, "creation_date": 1424900242, "post_id": 28730036, "comment_id": 45746470, "body": "I will let you know how it works as soon as I can implement it when I can get home later! Thank you for the answer."}, {"owner": {"reputation": 5, "user_id": 4607074, "user_type": "registered", "profile_image": "https://graph.facebook.com/1287912777889065/picture?type=large", "display_name": "Dustin Haycraft", "link": "https://stackoverflow.com/users/4607074/dustin-haycraft"}, "edited": false, "score": 0, "creation_date": 1425062802, "post_id": 28730036, "comment_id": 45822777, "body": "Sorry it took so long to come back, but it worked flawlessly! Thank you so much OpiesDad for saving me more time than I could ever explain!"}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": true, "score": 1, "last_activity_date": 1424899978, "creation_date": 1424899978, "answer_id": 28730036, "question_id": 28727119, "link": "https://stackoverflow.com/questions/28727119/looping-with-excel-vba-and-imacros/28730036#28730036", "title": "Looping with Excel VBA and iMacros", "body": "<p>You haven't incremented the 'row' variable.  You need to include \"row = row + 1\" right before \"Loop\", or if you really want to use the Activecell idea, you can put \"row = ActiveCell.row\" right before 'Loop' (although the other way makes more sense and will be faster)</p>\n\n<p>Even if you set row = ActiveCell.row, this won't change the row variable when you select a new cell.  It simply sets the row variable to whatever cell is active at the time and then this value of row is set until it is changed.</p>\n"}], "owner": {"reputation": 5, "user_id": 4607074, "user_type": "registered", "profile_image": "https://graph.facebook.com/1287912777889065/picture?type=large", "display_name": "Dustin Haycraft", "link": "https://stackoverflow.com/users/4607074/dustin-haycraft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1231, "favorite_count": 1, "accepted_answer_id": 28730036, "answer_count": 1, "score": 0, "last_activity_date": 1424899978, "creation_date": 1424889807, "last_edit_date": 1531164843, "question_id": 28727119, "link": "https://stackoverflow.com/questions/28727119/looping-with-excel-vba-and-imacros", "title": "Looping with Excel VBA and iMacros", "body": "<p>Alright, the scenario is this.\nI am working to move a client list from one backend manager to another, but unfortunately the one I am moving the list from (which contains addresses, phone numbers, notes about the account and general information about what each client likes) cannot export to excel. Hence where this begins to get tedious. My next step was trying something called iMacros for IE. \nThe way I have it setup now is very rudimentary. I have 15 imacro macros (one for each field needing to be copied). The first one changes the page so that a loop is made and extracts the first field. Each of the other 14 only extract one field at a time. \nI am trying to put all the information for a single client on a single row, just separate columns for the piece of info gathered. Then go to the next row to prepare for the next client. It starts on row 3 currently, but If that needs to be changed, fine.</p>\n\n<pre><code>   dim iim1, iret, row\n\n\nSub Button1_Click()\n\n    Set iim1 = CreateObject(\"imacros\")\n     iret = iim1.iimInit\n    iret = iim1.iimDisplay(\"Submitting Data from Excel\")\n\n    row = ActiveCell.row\n\n    Range(\"A3\").Select\n\n    iret = iim1.iimPlay(\"Login\")\n    If iret &lt; 0 Then\n        MsgBox iim1.iimgetlasterror()\n    End If\n\n\n\n\n    clientloop1\n\nEnd Sub\n\nSub clientloop1()\n\n\n    Do Until ActiveSheet.UsedRange.Rows.Count = 4\n\n\n    iret = iim1.iimPlay(\"Field1\")\n    If iret &lt; 0 Then\n        MsgBox iim1.iimgetlasterror()\n    End If\n    Cells(row, 1).Value = iim1.iimgetlastextract(0)\n\n\n    iret = iim1.iimPlay(\"Field2\")\n    If iret &lt; 0 Then\n        MsgBox iim1.iimgetlasterror()\n    End If\n    Cells(row, 2).Value = iim1.iimgetlastextract(0)\n\n\n     iret = iim1.iimPlay(\"Field3\")\n    If iret &lt; 0 Then\n        MsgBox iim1.iimgetlasterror()\n    End If\n    Cells(row, 3).Value = iim1.iimgetlastextract(0)\n\n\n     iret = iim1.iimPlay(\"Field4\")\n    If iret &lt; 0 Then\n        MsgBox iim1.iimgetlasterror()\n    End If\n    Cells(row, 4).Value = iim1.iimgetlastextract(0)\n\n\n     iret = iim1.iimPlay(\"Field5\")\n    If iret &lt; 0 Then\n        MsgBox iim1.iimgetlasterror()\n    End If\n    Cells(row, 5).Value = iim1.iimgetlastextract(0)\n\n\n     iret = iim1.iimPlay(\"Field6\")\n    If iret &lt; 0 Then\n        MsgBox iim1.iimgetlasterror()\n    End If\n    Cells(row, 6).Value = iim1.iimgetlastextract(0)\n\n\n     iret = iim1.iimPlay(\"Field7\")\n    If iret &lt; 0 Then\n        MsgBox iim1.iimgetlasterror()\n    End If\n    Cells(row, 7).Value = iim1.iimgetlastextract(0)\n\n\n     iret = iim1.iimPlay(\"Field8\")\n    If iret &lt; 0 Then\n        MsgBox iim1.iimgetlasterror()\n    End If\n    Cells(row, 8).Value = iim1.iimgetlastextract(0)\n\n\n     iret = iim1.iimPlay(\"Field9\")\n    If iret &lt; 0 Then\n        MsgBox iim1.iimgetlasterror()\n    End If\n    Cells(row, 9).Value = iim1.iimgetlastextract(0)\n\n\n     iret = iim1.iimPlay(\"Field10\")\n    If iret &lt; 0 Then\n        MsgBox iim1.iimgetlasterror()\n    End If\n    Cells(row, 10).Value = iim1.iimgetlastextract(0)\n\n\n     iret = iim1.iimPlay(\"Field11\")\n    If iret &lt; 0 Then\n        MsgBox iim1.iimgetlasterror()\n    End If\n    Cells(row, 11).Value = iim1.iimgetlastextract(0)\n\n\n     iret = iim1.iimPlay(\"Field12\")\n    If iret &lt; 0 Then\n        MsgBox iim1.iimgetlasterror()\n    End If\n    Cells(row, 12).Value = iim1.iimgetlastextract(0)\n\n\n     iret = iim1.iimPlay(\"Field13\")\n    If iret &lt; 0 Then\n        MsgBox iim1.iimgetlasterror()\n    End If\n    Cells(row, 13).Value = iim1.iimgetlastextract(0)\n\n     iret = iim1.iimPlay(\"Field14\")\n    If iret &lt; 0 Then\n        MsgBox iim1.iimgetlasterror()\n    End If\n    Cells(row, 14).Value = iim1.iimgetlastextract(0)\n\n\n     iret = iim1.iimPlay(\"Field15\")\n    If iret &lt; 0 Then\n        MsgBox iim1.iimgetlasterror()\n    End If\n\n    ActiveCell.Offset(1, 0).EntireRow.Range(\"A1\").Select\n\n\n\n\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>\"</p>\n\n<p>When I execute the code as is, it does the first row correctly, but keeps overwriting the information with the next client instead of going to the next row and adding it there.\nAny help that can be provided, I appreciate. I'm stumped sadly. \nIt's great to join this community finally, I can't tell you guys how many times a question on here was relevant to another issue and helped me out lol.</p>\n\n<p>It's either this or copy and paste 1 at a time lol for a very large client list. </p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1424889012, "post_id": 28726753, "comment_id": 45740130, "body": "<a href=\"http://stackoverflow.com/questions/3301733/vba-what-is-97-45-1\">stackoverflow.com/questions/3301733/vba-what-is-97-45-1</a>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1424889509, "post_id": 28726753, "comment_id": 45740412, "body": "That&#39;s an excellent answer you linked to, thanks @TimWilliams."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1424889620, "post_id": 28726753, "comment_id": 45740478, "body": "Useful for me too..."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1424948827, "post_id": 28726753, "comment_id": 45764911, "body": "It may also be worth noting that VBA converts all <code>Integer</code> values to <code>Long</code> type, so there isn&#39;t  any real benefits (which I can think of) in using <code>Integer</code> over  <code>Long</code>. <a href=\"https://msdn.microsoft.com/en-us/library/office/aa164506(v=office.10).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1429560088, "post_id": 28726753, "comment_id": 47646840, "body": "Now I&#39;m confused - if VBA converts Integer to Long as the article suggests, then why would an overflow occur for values outside of a 16 bit boundary?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1429624380, "post_id": 28726753, "comment_id": 47678727, "body": "@SOofWXLS AFAIK it&#39;s an internal conversion to long data type, if you try to put that result in to a typed variable <code>as Integer</code>, an overflow results. For my OP here, when doing math operations on <i>all</i> integer type data, VBA assumes the implied result is also <code>Integer</code>. It is quirky in this regard."}], "answers": [{"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1424899891, "post_id": 28729992, "comment_id": 45746249, "body": "@David Zemens I fully appreciate with a rep of 21k+ you will already know most of this - it&#39;s mainly for the benefit of the VBA community that aren&#39;t as &#39;clued up&#39; on memory allocation and OOP."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424923413, "post_id": 28729992, "comment_id": 45753782, "body": "+1 all very good information! It doesn&#39;t answer the question per se (i know why a long causes an overflow in an integer, but wasnt sure why certain arithmetic would cause an overflow independent of a type container, i.e., multiplying an integer x integer implies an integer output even if assigning the result to a property capable of accepting a Long!) but should still be useful for others with similar q&#39;s in the future. Thanks!"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424947516, "post_id": 28729992, "comment_id": 45764084, "body": "@DavidZemens I&#39;ve added some more onto my answer after playing around some more, I think ultimately without any official documentation all we can do is make &#39;educated guesses&#39; at what the reason is. VERY interesting though so I hope some more information comes to light - good question!"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424962909, "post_id": 28729992, "comment_id": 45773892, "body": "You&#39;ve got too many parentheses in the Debug statements  or, you&#39;ve put parentheses in such a way that changes the order of operations: <code>(20 * t - 1)</code> == <code>((20 * t) - 1)</code>., <code>(20 * t - 1)</code> will throw an error, because of the implied output type as discussed <a href=\"http://stackoverflow.com/questions/3301733/vba-what-is-97-45-1\">here</a>. The issue is that the product of an expression consisting only of integers can potentially cause an overflow even if assigning to a Long/Double container, because the implied output will be of type <code>Integer</code> -- try it: <code>Dim val as Long: val = (20 * 1639 * 1)</code>."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424979950, "post_id": 28729992, "comment_id": 45784708, "body": "Yeah, I understand that - I think I just misunderstood the question and went on a bit of a tangent, oops!"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 1, "last_activity_date": 1424947702, "last_edit_date": 1424947702, "creation_date": 1424899830, "answer_id": 28729992, "question_id": 28726753, "link": "https://stackoverflow.com/questions/28726753/overflow-error-evaluating-arithmetic-expression-with-integers-in-vba/28729992#28729992", "title": "Overflow Error evaluating arithmetic expression with integers in VBA", "body": "<p>If my logic is correct, <code>Dim</code> or 'Dimension' is a way of telling the application that you expect use a variable of a certain type, and that type pertains to a certain amount of 'bits' (of memory).</p>\n\n<p>This reserves a section of the system's memory, which has been allocated a certain amount of bits dependant on the variable type that you have instructed in your code. These bits then define how many  (If you're familiar with C++ or similar then you will probably already know all this...)</p>\n\n<p>An Integer is 16 bits in VBA and is a <em>signed</em> integer which means we can store negative values too, so the limit is 32,767 because this is the biggest number we can achieve with 16 bits:</p>\n\n<p>(generally a variable can hold 2^n where n = number of bits)</p>\n\n<hr>\n\n<pre><code>unsigned 16 bits =         0 - 65,536    (2^16)\nsigned 16 bits   =   -32,768 - 32,767\n32,767           =    111111111111111    (Binary)\n32,768           =    1000000000000000 &lt;--- note the extra bit\n</code></pre>\n\n<hr>\n\n<p>This extra bit is what causes the \"overflow\" error - because the amount of bits required to produce the number <em>overflows</em> the amount of bits that the memory has to store the number safely.</p>\n\n<p>I don't think the method of the calculation is documented to this extent, however your code snippet:</p>\n\n<pre><code>Dim t as Integer\nt = 1639\nDebug.Print (20 * t - 1)\n</code></pre>\n\n<p>would require <code>t</code> to be first be multiplied by 20, resulting in a figure of 32,780:</p>\n\n<pre><code>20 * t = 20 * 1639 = 32,780\n32,780 = 1000000000001100 (Binary)\n</code></pre>\n\n<p>which overflows the bit limit for the <code>Integer</code> data type. At this point the system throws an error before it has the chance to proceed with the rest of the calculation because it tries to multiply <code>t</code> <em>whilst still in it's allocated memory address</em>, for which only 16 bits of memory have been reserved.</p>\n\n<p>Also, not declaring <code>t</code> as a type will force VBA to default to type <code>Variant</code> which will assess that <code>t</code> needs to have more memory allocated when the calculation runs and push it into the <code>Long</code> boundary automatically.</p>\n\n<hr>\n\n<p><strong>Update:</strong> It would appear that VBA will only permit the highest amount of bits held by a variable within the equation for the return value, as can be seen in this example:</p>\n\n<pre><code>Sub SO()\n\nDim t As Integer, c As Long\n\nt = 1639\nc = 20\n\nDebug.Print (20 * (t - 1))  '// No Error\nDebug.Print (c * (t - 1))   '// No Error\nDebug.Print ((c * t) - 1)   '// No Error\n\nc = (20 * t - 1)            '// Error\nDebug.Print (20 * t - 1)    '// Error\n\nEnd Sub\n</code></pre>\n\n<p>Although I don't believe this is documented anywhere, it would lead one to believe that VBA limits memory usage to the highest amount of bits being used by a variable at any one time.</p>\n"}], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "accepted_answer_id": 28729992, "answer_count": 1, "score": 1, "last_activity_date": 1424947702, "creation_date": 1424888638, "question_id": 28726753, "link": "https://stackoverflow.com/questions/28726753/overflow-error-evaluating-arithmetic-expression-with-integers-in-vba", "title": "Overflow Error evaluating arithmetic expression with integers in VBA", "body": "<p>The following evaluates to <code>32760</code>, an integer:</p>\n\n<pre><code>Debug.Print (20 * 1638 - 1)\n</code></pre>\n\n<p>But this raises an overflow error:</p>\n\n<pre><code>Dim t as Integer\nt = 1639\nDebug.Print (20 * t - 1)\n</code></pre>\n\n<p>It seems like this is implicitly expecting an <code>Integer</code> return value, because if I do either of the following, the error is avoided. </p>\n\n<p><code>Dim t as Long</code> OR <code>Debug.print (20 * CLng(t) - 1)</code> OR <code>Debug.Print (20# * t - 1)</code></p>\n\n<p>Is this behavior documented? </p>\n\n<p>Is my assumption accurate? Namely, that arithmetic of integers implies an integer return value, and that simply introducing one <code>Long</code> or <code>Double</code> value in to the equation will avoid the error?</p>\n"}, {"tags": ["vba", "vb6", "outlook", "automation"], "comments": [{"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1424888300, "post_id": 28726460, "comment_id": 45739724, "body": "What code do you use? Why do you need to create a new Outlook instance every time?"}, {"owner": {"reputation": 761, "user_id": 1122249, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/c722c9bf26818067b037a9f279206df0?s=128&d=identicon&r=PG", "display_name": "Byrd", "link": "https://stackoverflow.com/users/1122249/byrd"}, "reply_to_user": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1424898600, "post_id": 28726460, "comment_id": 45745499, "body": "If outlook isn&#39;t opened, <code>Set outlookobject = CreateObject(&quot;Outlook.Application&quot;)</code> Opens an automated outlook and not the actual application. And after you finish using it, it closes."}, {"owner": {"reputation": 379, "user_id": 3633265, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/da02d691cf77ba921eb7cf354c490c06?s=128&d=identicon&r=PG&f=1", "display_name": "CMaster", "link": "https://stackoverflow.com/users/3633265/cmaster"}, "edited": false, "score": 0, "creation_date": 1424944610, "post_id": 28726460, "comment_id": 45762144, "body": "Any reason you can&#39;t just continue using the same &quot;outlookobject&quot; without closing it? Or does that have the same problem?"}, {"owner": {"reputation": 761, "user_id": 1122249, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/c722c9bf26818067b037a9f279206df0?s=128&d=identicon&r=PG", "display_name": "Byrd", "link": "https://stackoverflow.com/users/1122249/byrd"}, "edited": false, "score": 0, "creation_date": 1425588461, "post_id": 28726460, "comment_id": 46036001, "body": "the problem with it is theres an automated version of outlook that pops up. as oppose to the actual outlook."}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1430947970, "last_edit_date": 1430947970, "creation_date": 1425124331, "answer_id": 28781391, "question_id": 28726460, "link": "https://stackoverflow.com/questions/28726460/vb6-outlook-automation/28781391#28781391", "title": "VB6 Outlook automation", "body": "<p>You can trap Err.Number or Err.Description and generate a message box for the user to click to try again (Resume) or cancel (Exit Sub).</p>\n\n<p>You may loop continually, attempting to create, to avoid user intervention. At some point generate the message box so users know the app is still working.</p>\n\n<p>Edit 2015 05 06 - Maybe something less abstract. VBA but should be generic enough for other languages.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub errorHandler_429()\n\nDim uErrorMsg1 As String\nDim uErrorMsg As String\nDim errCount As Long\n\nuErrorMsg1 = \"Click OK to try again.\"\n\nOn Error GoTo ErrorHandler\n\nrestart:\n\n    ' code that triggers an error here\n    Err.Raise 429   ' &lt;-- For testing\n    'Err.Raise 430   ' &lt;--- For testing\n\nExitRoutine:\n\n    Exit Sub\n\nErrorHandler:\n\n    Select Case Err.Number\n\n    Case 429\n\n        errCount = errCount + 1\n\n        uErrorMsg = Err.Number &amp; \": \" &amp; Err.Description &amp; \" occurred \" &amp; errCount &amp; \" times.\"\n\n        Debug.Print uErrorMsg\n\n        If (errCount Mod 200) = 0 Then\n            uErrorMsg = uErrorMsg1 &amp; vbCr &amp; vbCr &amp; _\n                \"Error # \" &amp; Err.Number &amp; \" was generated by \" &amp; _\n                Err.Source &amp; Chr(13) &amp; Chr(13) &amp; Err.Description\n\n            Debug.Print uErrorMsg\n\n            If MsgBox(uErrorMsg, vbOKCancel, \"errorHandler_429\", Err.HelpFile, Err.HelpContext) = vbOK Then\n                Resume restart\n            Else\n                Resume ExitRoutine\n            End If\n\n        Else\n            Resume restart\n\n        End If\n\n    Case Else\n\n        uErrorMsg = Err.Number &amp; \": \" &amp; Err.Description\n        'Debug.Print uErrorMsg\n\n        MsgBox uErrorMsg, , \"errHandler_429\", Err.HelpFile, Err.HelpContext\n        Resume ExitRoutine\n\n    End Select\n\nEnd Sub\n\nSub errHandler_Description()\n\n' Where the error number is negative and inconsistent\n\nDim uErrorMsg1 As String\nDim uErrorMsg As String\nDim errCount As Long\n\nDim LErrDesc As String\n\nuErrorMsg1 = \"Click OK to try again.\"\n\nOn Error GoTo ErrorHandler\n\nrestart:\n\n    ' code that triggers an error here\n    Err.Raise 429  ' &lt;--- For testing\n    'Err.Raise 430   ' &lt;--- For testing\n\n\nExitRoutine:\n    Exit Sub\n\nErrorHandler:\n\n    LErrDesc = Left(Err.Description, 51)\n    Debug.Print \" LErrDesc: \" &amp; LErrDesc\n\n    Select Case LErrDesc\n\n    Case \"ActiveX component can't create object\"\n\n        errCount = errCount + 1\n        Debug.Print \" errCcount: \" &amp; errCount\n\n        If (errCount Mod 200) = 0 Then\n            uErrorMsg = uErrorMsg1 &amp; vbCr &amp; vbCr &amp; _\n                \"Error # \" &amp; Err.Number &amp; \" was generated by \" &amp; _\n                Err.Source &amp; Chr(13) &amp; Chr(13) &amp; Err.Description\n\n            'Debug.Print uErrorMsg\n\n            If MsgBox(uErrorMsg, vbOKCancel, \"errHandler_Description\", Err.HelpFile, Err.HelpContext) = vbOK Then\n                Resume restart\n            Else\n                Resume ExitRoutine\n            End If\n\n        Else\n            Resume restart\n\n        End If\n\n    Case Else\n\n        uErrorMsg = \"This error has not been handled.\"\n        uErrorMsg = uErrorMsg &amp; vbCr &amp; vbCr &amp; _\n            \"Error # \" &amp; Err.Number &amp; \" was generated by \" &amp; _\n            Err.Source &amp; Chr(13) &amp; Chr(13) &amp; Err.Description\n\n        Debug.Print uErrorMsg\n        MsgBox uErrorMsg, , \"errHandler_Description\", Err.HelpFile, Err.HelpContext\n\n        Resume ExitRoutine\n\n    End Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 761, "user_id": 1122249, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/c722c9bf26818067b037a9f279206df0?s=128&d=identicon&r=PG", "display_name": "Byrd", "link": "https://stackoverflow.com/users/1122249/byrd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 292, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1430947970, "creation_date": 1424887691, "question_id": 28726460, "link": "https://stackoverflow.com/questions/28726460/vb6-outlook-automation", "title": "VB6 Outlook automation", "body": "<p>I have a block of code that will send emails using Outlook on the users PC. However when we email a bigger amount, it seems as though outlook isn't working as fast as the application so the application opens outlook sends the first email, but the second time it tries to open outlook but gets errors such as Outlook not available etc. So Outlook is taking to long to do the task while the application is trying to create the object again. I was using <code>DoEvents</code> previously but that doesn't work. Is there anyway to wait for outlook to finish its job Before it continues?</p>\n\n<p>In this scenario outlook is not open yet, it is closed and the vb6 application is opening it.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1257, "user_id": 1232692, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b491eaba0f986b1c172bbbeff9434654?s=128&d=identicon&r=PG", "display_name": "Kelvin", "link": "https://stackoverflow.com/users/1232692/kelvin"}, "edited": false, "score": 0, "creation_date": 1424885595, "post_id": 28725743, "comment_id": 45737892, "body": "One note.  You typically want to have all business logic and macro&#39;s that &quot;do stuff&quot; to be located in a module.  Worksheet objects/events are usually kept blank unless for very straightforward purposes"}, {"owner": {"reputation": 117, "user_id": 3203709, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/56bd091a728e45acbd8b68facb141365?s=128&d=identicon&r=PG&f=1", "display_name": "fonzy16", "link": "https://stackoverflow.com/users/3203709/fonzy16"}, "edited": false, "score": 0, "creation_date": 1424888480, "post_id": 28725743, "comment_id": 45739819, "body": "Oh great!  I would rather have it in a module but I had only seen this through the sheet.  I will try all options and see how it goes.  Thanks.  I will let you know if something works."}, {"owner": {"reputation": 117, "user_id": 3203709, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/56bd091a728e45acbd8b68facb141365?s=128&d=identicon&r=PG&f=1", "display_name": "fonzy16", "link": "https://stackoverflow.com/users/3203709/fonzy16"}, "edited": false, "score": 0, "creation_date": 1424890580, "post_id": 28725743, "comment_id": 45740953, "body": "I am trying to put it in a module and not directly onto the sheet.  I&#39;m having trouble having trouble having this code active the entire time.  I am missing something in the process."}, {"owner": {"reputation": 1257, "user_id": 1232692, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b491eaba0f986b1c172bbbeff9434654?s=128&d=identicon&r=PG", "display_name": "Kelvin", "link": "https://stackoverflow.com/users/1232692/kelvin"}, "reply_to_user": {"reputation": 117, "user_id": 3203709, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/56bd091a728e45acbd8b68facb141365?s=128&d=identicon&r=PG&f=1", "display_name": "fonzy16", "link": "https://stackoverflow.com/users/3203709/fonzy16"}, "edited": false, "score": 1, "creation_date": 1424891281, "post_id": 28725743, "comment_id": 45741351, "body": "In the VBA editor, in the explorer on the left, right click on &quot;modules&quot; and &quot;insert module&quot;.  Under that module, move a function into a Sub/Function.  Then it should be available to use from the change event."}], "tags": [], "owner": {"reputation": 1257, "user_id": 1232692, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b491eaba0f986b1c172bbbeff9434654?s=128&d=identicon&r=PG", "display_name": "Kelvin", "link": "https://stackoverflow.com/users/1232692/kelvin"}, "is_accepted": false, "score": 0, "last_activity_date": 1424899645, "last_edit_date": 1424899645, "creation_date": 1424885524, "answer_id": 28725743, "question_id": 28725612, "link": "https://stackoverflow.com/questions/28725612/excel-vba-prevent-selection-change-to-refresh-execute-on-the-click-of-each-cell/28725743#28725743", "title": "Excel VBA Prevent Selection Change to refresh/execute on the click of each cell", "body": "<p>You can use Target which is the active cell that triggerd the worksheet change event:</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n\n    On Error GoTo EXIT_SUB\n    If Sh.name = Worksheets(\"Your Sheet Name\").name Then\n        If Target.Address = .Range(\"rngYourDropdownRange\").Address Then\n            myMacro\n        ElseIf Target.Address = .Range(\"rngAnotherRangeIHave\").Address Then\n            mySecondMacro\n        End If\n    End If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 117, "user_id": 3203709, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/56bd091a728e45acbd8b68facb141365?s=128&d=identicon&r=PG&f=1", "display_name": "fonzy16", "link": "https://stackoverflow.com/users/3203709/fonzy16"}, "edited": false, "score": 0, "creation_date": 1424888498, "post_id": 28725897, "comment_id": 45739828, "body": "Thanks!  I will try this out now."}, {"owner": {"reputation": 117, "user_id": 3203709, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/56bd091a728e45acbd8b68facb141365?s=128&d=identicon&r=PG&f=1", "display_name": "fonzy16", "link": "https://stackoverflow.com/users/3203709/fonzy16"}, "edited": false, "score": 0, "creation_date": 1424890502, "post_id": 28725897, "comment_id": 45740913, "body": "I saw that all I had to do was change from Worksheet_SelectionChange to Worksheet_Change and it is doing what I want to do.  Thanks for the insight."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1424885957, "creation_date": 1424885957, "answer_id": 28725897, "question_id": 28725612, "link": "https://stackoverflow.com/questions/28725612/excel-vba-prevent-selection-change-to-refresh-execute-on-the-click-of-each-cell/28725897#28725897", "title": "Excel VBA Prevent Selection Change to refresh/execute on the click of each cell", "body": "<p>If you want to respond only when cell <strong>C2</strong> is changed then use a different <em>Event</em></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Intersect(Cells(2, 3), Target) Is Nothing Then Exit Sub\n    Application.EnableEvents = False\n        MsgBox \"A change has been made to cell(2,3)\"\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 3203709, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/56bd091a728e45acbd8b68facb141365?s=128&d=identicon&r=PG&f=1", "display_name": "fonzy16", "link": "https://stackoverflow.com/users/3203709/fonzy16"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1832, "favorite_count": 0, "accepted_answer_id": 28725897, "answer_count": 2, "score": 0, "last_activity_date": 1424899645, "creation_date": 1424885166, "last_edit_date": 1531164843, "question_id": 28725612, "link": "https://stackoverflow.com/questions/28725612/excel-vba-prevent-selection-change-to-refresh-execute-on-the-click-of-each-cell", "title": "Excel VBA Prevent Selection Change to refresh/execute on the click of each cell", "body": "<p>I created the subroutine below with the intention of executing the macro when an item is selected from a data validation list drop-down on cell(2,3).  I template to compare Forecast vs. Actuals and a Variance section.  Forecast is on the top, Actuals is in the middle and Variance is at the bottom.  Each sections contains the same list of sub-market names.  The idea is if cell (2,3) is blank then all the data is viewed.  If an item is selected then all rows are hidden except for the sub-market selected.  The end-user will see the forecast, actuals and variance rows with its titles and headers on the screen to allow for simple analysis and make it a user-friendly tool.  It works fine but the subroutine seems to execute/refresh any time any cell is selected either by mouse or by keyboard.  Furthermore, the subroutine will not execute when selecting an item on the drop down in cells(2,3).  It will only execute when clicking on the sheet again anywhere.</p>\n\n<p>I have been reading for over two hours trying to find a solution on how to prevent the execution/refresh of the subroutine on each click of the sheet.  The goal is for the subroutine to execute only when an item is selected on the drop down in cells(2,3) or when it is cleared in cells(2,3).  I will continue reading but I figured to post the question to see if I can get an answer while I am researching.  Thank you in advanced for any assistance provided.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n\nDim Wk2 As Worksheet\nSet Wk2 = Sheets(\"By SubMarket\")\n\nApplication.ScreenUpdating = False\n\nWith Wk2\n\nSet Target = Cells(2, 3)\n\n'If the cell with the drop-down data validation list is blank then unhide all rows -- effectively show all data\nIf Target = \"\" Then\n\nWk2.Cells.Rows.Hidden = False\n\nElse\n'Goal:  Hide all rows and only leave the rows related to the submarket selected on the drop down for each section\n'       This is down so the end-user can drill down and view a specific market easily FCST vs. Actual vs. Variance\nWk2.Cells.Rows.Hidden = False\n\n'define the header row of the Forecast section\n'define the first row of data in the Forecast section\n'define the last row of data in the Forecast section\n\nDim hRowFcst As Long\nDim fRowFcst As Long\nDim lRowFcst As Long\n\nhRowFcst = Cells.Find(\"FCST\", LookAt:=xlWhole).Offset(1, 0).Row\nfRowFcst = Cells.Find(\"FCST\", LookAt:=xlWhole).Offset(2, 0).Row\nlRowFcst = Cells.Rows(hRowFcst).Find(\"State\", LookAt:=xlWhole).End(xlDown).Row\n\n'define the header row of the Actuals section\n'define the first row of data in the Actuals section\n'define the last row of data in the Actuals section\nDim hRowAct As Long\nDim fRowAct As Long\nDim lRowAct As Long\n\nhRowAct = Cells.Find(\"ACT\", LookAt:=xlWhole).Offset(1, 0).Row\nfRowAct = Cells.Find(\"ACT\", LookAt:=xlWhole).Offset(2, 0).Row\nlRowAct = Cells.Rows(hRowAct).Find(\"State\", LookAt:=xlWhole).End(xlDown).Row\n\n'define the header row of the Variance section\n'define the first row of data in the Variance section\n'define the last row of data in the Variance section\n\nDim hRowVar As Long\nDim fRowVar As Long\nDim lRowVar As Long\n\nhRowVar = Cells.Find(\"Over/(Under)\", LookAt:=xlWhole).End(xlUp).Row\nfRowVar = Cells.Rows(hRowVar).Offset(1, 0).Row\nlRowVar = Cells.Find(\"Over/(Under)\", LookAt:=xlWhole).Offset(-1, 0).Row\n\n\n'define the Total row of the Forecast section\n'define the Total row of data in the Actuals section\n'define the Total row of data in the Variance section\nDim tRowFcst As Long\nDim tRowAct As Long\nDim tRowVar As Long\n\ntRowFcst = Cells.Rows(lRowFcst).Offset(1, 0).Row\ntRowAct = Cells.Rows(lRowAct).Offset(1, 0).Row\ntRowVar = Cells.Rows(lRowVar).Offset(1, 0).Row\n\n\nDim StateCol As Long\nDim SubMktCol As Long\n'Dim Month Col As Long -- See how to make choosing a period dynamic &lt;will define later&gt;\n\nStateCol = Cells.Find(\"State\", LookAt:=xlWhole).Column\nSubMktCol = Cells.Find(\"Sub-Market\", LookAt:=xlWhole).Column\n\n'Define the range of all the submarkets listed in the Forecast section\n'Define the range of all the submarkets listed in the Actuals section\n'Define the range of all the submarkets listed in the Variance section\nDim FSubMktRg As Range\nDim ASubMktRg As Range\nDim VSubMktRg As Range\n\nSet FSubMktRg = Range(Cells(fRowFcst, SubMktCol), Cells(lRowFcst, SubMktCol))\nSet ASubMktRg = Range(Cells(fRowAct, SubMktCol), Cells(lRowAct, SubMktCol))\nSet VSubMktRg = Range(Cells(fRowVar, SubMktCol), Cells(lRowVar, SubMktCol))\n\n'\n  Dim HideRg As Range\n  For Each cell In Application.Union(FSubMktRg, ASubMktRg, VSubMktRg)\n    If cell &lt;&gt; Cells(2, 3) Then\n        If HideRg Is Nothing Then\n            Set HideRg = cell\n        Else\n            Set HideRg = Union(HideRg, cell)\n        End If\n    End If\n  Next\n  HideRg.EntireRow.Hidden = True\n  'Hides miscelaneous rows between each section\n  Range(Cells(tRowFcst, 1), Cells(hRowAct, 1).Offset(-2, 0)).EntireRow.Hidden = True\n  Range(Cells(tRowAct, 1), Cells(hRowVar, 1).Offset(-2, 0)).EntireRow.Hidden = True\n  Cells(tRowVar, 1).EntireRow.Hidden = True\n\n\n\nEnd If\n\nEnd With\n\n\n\nApplication.ScreenUpdating = True\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1424885447, "post_id": 28725638, "comment_id": 45737776, "body": "To be on the safe side, maybe <code>.Formula = &quot;=&#39;&quot; &amp; SN &amp; &quot;&#39;!Cost&quot;</code>."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1424885615, "post_id": 28725638, "comment_id": 45737911, "body": "Right! I missed that ;)"}, {"owner": {"reputation": 41, "user_id": 4480738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05c184fae89449a0959706191a3a6c7c?s=128&d=identicon&r=PG&f=1", "display_name": "nam24", "link": "https://stackoverflow.com/users/4480738/nam24"}, "edited": false, "score": 0, "creation_date": 1424885810, "post_id": 28725638, "comment_id": 45738059, "body": "Awesome. That worked. Thanks for the quick response."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 41, "user_id": 4480738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05c184fae89449a0959706191a3a6c7c?s=128&d=identicon&r=PG&f=1", "display_name": "nam24", "link": "https://stackoverflow.com/users/4480738/nam24"}, "edited": false, "score": 0, "creation_date": 1424893729, "post_id": 28725638, "comment_id": 45742805, "body": "@nam24, Thank you! Call again ;)"}], "tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": true, "score": 2, "last_activity_date": 1424885631, "last_edit_date": 1424885631, "creation_date": 1424885220, "answer_id": 28725638, "question_id": 28725571, "link": "https://stackoverflow.com/questions/28725571/referencing-a-worksheet-in-a-formula-thats-always-changing-in-vba/28725638#28725638", "title": "Referencing a Worksheet in a Formula That&#39;s Always Changing in VBA", "body": "<p>Try this:</p>\n\n<pre><code>Formula = \"='\" &amp; SN &amp; \"'!Cost\"\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 4480738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05c184fae89449a0959706191a3a6c7c?s=128&d=identicon&r=PG&f=1", "display_name": "nam24", "link": "https://stackoverflow.com/users/4480738/nam24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 28725638, "answer_count": 1, "score": 0, "last_activity_date": 1424885761, "creation_date": 1424885058, "last_edit_date": 1424885761, "question_id": 28725571, "link": "https://stackoverflow.com/questions/28725571/referencing-a-worksheet-in-a-formula-thats-always-changing-in-vba", "title": "Referencing a Worksheet in a Formula That&#39;s Always Changing in VBA", "body": "<p>I am trying to write a macro that copies data from another worksheet. I am having troubles on how to properly input the worksheet name in a formula. The Summary worksheet is the destination and the 5th worksheet, which will change daily (and is in format x.xx_1), is the source. Here's my code:</p>\n\n<pre><code> Sub steadf()\n\n Dim SN As String\n\n SN = InputBox(\"Enter Tab Date - 2.24, 10.24, etc.\")\n Worksheets(5).Name = SN &amp; \"_1\"\n\n    Sheets(\"Summary\").Select\n    Range(\"D24\").Select\n    ActiveCell.Offset(0, 3).Formula = \"=SN\" &amp; \"_1\" &amp; \"!\" &amp; \"Cost\"\n\nEnd Sub\n</code></pre>\n\n<p>When I run this, the formula in G24 is</p>\n\n<pre><code>=SN_1!Cost\n</code></pre>\n\n<p>The formula I'm looking to use is <code>='2.24_1'!Cost</code>. I would appreciate any help. Thanks in advance.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1424885107, "post_id": 28725527, "comment_id": 45737564, "body": "Why not check the recordset before adding?"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 1, "creation_date": 1424885109, "post_id": 28725527, "comment_id": 45737567, "body": "Are you handling it this way because your top <code>rst</code> might not be open when you call <code>.AddNew</code>?"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1424885253, "post_id": 28725527, "comment_id": 45737650, "body": "<a href=\"http://stackoverflow.com/questions/17611545/check-if-adodb-connection-is-open\" title=\"check if adodb connection is open\">stackoverflow.com/questions/17611545/&hellip;</a>"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1424885301, "post_id": 28725527, "comment_id": 45737685, "body": "@Brad why ADO with MS Access? <a href=\"http://stackoverflow.com/questions/2631678/vba-check-if-object-is-set\" title=\"vba check if object is set\">stackoverflow.com/questions/2631678/vba-check-if-object-is-s&zwnj;&#8203;et</a>"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1424885561, "post_id": 28725527, "comment_id": 45737862, "body": "@Fionnuala OP declared their recordset as an ADO recordset. I just stuck with that. Plenty of legit reasons to you ADO, right?"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1424885633, "post_id": 28725527, "comment_id": 45737923, "body": "@Brad good point &lt;sheepish grin&gt;. It is just that DAO is nearly always better with MS Access."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1424885640, "post_id": 28725527, "comment_id": 45737929, "body": "@Fionnuala but I think I see what else you&#39;re getting at here. We don&#39;t know if the error is happening because the <code>rst</code> object is not set or it is set and not open, or there is something else throwing the error."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1424885833, "post_id": 28725527, "comment_id": 45738079, "body": "I can check the recordset and I intend on actually doing it that way, but as I mentioned, I&#39;m curious as to whether this is possible.  This was more of an example I had to create the issue I am talking about.  As far as ADO, there really is not reason for the ADO recordset (and in actuality, my recordset is DAO, and I&#39;m not sure why I declared it as ADO in this post.  I&#39;ll update that)."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1424886368, "post_id": 28725527, "comment_id": 45738479, "body": "You&#39;re asking whether there is something like <code>Resume Previous</code> (there is not). The code executes sequentially and would not go &quot;backwards&quot; or to some previous point without explicitly being told where to go. In this case, how would the compiler <i>know</i> to resume at the beginning of the <code>With</code> block (and not at some other point)?"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1424886472, "post_id": 28725527, "comment_id": 45738541, "body": "you could have another label at the start of the <code>with</code> then a <code>goto</code> to that label after your error handler but there are certainly better ways of doing something than that."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424886489, "post_id": 28725527, "comment_id": 45738554, "body": "<code>Resume</code> or <code>Resume Next</code> is intuitive, the compiler simply picks up running at the next line after the error was raised, assuming the error handler adequately resolves the error. Anything else would have to be explicit, with a label."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424886577, "post_id": 28725527, "comment_id": 45738613, "body": "@David.  Thanks.  That&#39;s a very good point.  I was thinking that since the line is logically related that it would make sense to jump back to the original With statement, but that doesn&#39;t take into consideration many other coding constructs that would leave the compiler confused."}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1424887331, "post_id": 28726141, "comment_id": 45739124, "body": "You <b>can</b> <code>Resume</code> into a with block as long as the error handler doesn&#39;t execute an <code>End With</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1424887409, "post_id": 28726141, "comment_id": 45739178, "body": "@DavidZemens ouch! I&#39;d rather keep my innocence and believe you can&#39;t do that... wouldn&#39;t that smell terrible?"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 3, "last_activity_date": 1424887489, "last_edit_date": 1424887489, "creation_date": 1424886705, "answer_id": 28726141, "question_id": 28725527, "link": "https://stackoverflow.com/questions/28725527/vba-error-handler-with-with-statement/28726141#28726141", "title": "VBA Error Handler with &quot;With&quot; Statement", "body": "<p>A <code>With</code> block holds an instance of an object, and releases it at <code>End With</code>. If you jumped outside the <code>With</code> block, the object is gone.</p>\n\n<p><s>So the answer is no, you can't <code>Resume</code> into the middle of a <code>With</code> block.</s> <em>well you actually can, but things get ugly and confusing.</em></p>\n\n<p>This is a common misuse of the <code>With</code> statement you have here - you're merely using it because you're being lazy (no offense intended), and don't want to type <code>rst.</code> in front of every line that uses that object.</p>\n\n<p>Proper usage would have the <code>With</code> block <em>itself</em> hold the reference, like this:</p>\n\n<pre><code>With GetRecordset 'a function that returns a recordset\n    .AddNew\n    !MyValue = 1\n    .Update\n    .Bookmark = .LastModified\n    .Close\nEnd With\n</code></pre>\n\n<p>..not that I'd recommend working with recordsets like this, but you get the idea ;)</p>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1424887303, "post_id": 28726154, "comment_id": 45739110, "body": "My <a href=\"https://github.com/retailcoder/Rubberduck/releases\" rel=\"nofollow noreferrer\">Rubberduck VBE add-in</a> says &quot;Use of obsolete Call statement&quot; on that <code>Call SetRST rst</code> line ;)"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1424887696, "post_id": 28726154, "comment_id": 45739369, "body": "I never write the &#39;Call&#39;, which is useless, I just wrote it here to keep asker&#39;s style. You&#39;re right, it&#39;s useless and (therefore) unelegant."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1424887903, "post_id": 28726154, "comment_id": 45739496, "body": "Sorry for the confusing code.  I understand that the code as written would not open the recordset.  This, however, isn&#39;t the issue I was having.  Even if I added the ByRef arg, this still wouldn&#39;t work as when the error handler resumes, it will still resume on the &quot;.AddNew&quot; line which is referencing the Nothing recordset."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1424888004, "post_id": 28726154, "comment_id": 45739548, "body": "@OpiesDad: yes it would"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1424888627, "post_id": 28726154, "comment_id": 45739908, "body": "@OpiesDad pass parameters instead of using globals, most of your problems will start fading away..."}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 5, "creation_date": 1424888894, "post_id": 28726154, "comment_id": 45740055, "body": "I like you. We could always use <a href=\"http://codereview.stackexchange.com/questions/tagged/vba\">more VBA Reviewers on Code Review</a> if you get tired of SO."}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 4, "last_activity_date": 1424887162, "last_edit_date": 1424887162, "creation_date": 1424886730, "answer_id": 28726154, "question_id": 28725527, "link": "https://stackoverflow.com/questions/28725527/vba-error-handler-with-with-statement/28726154#28726154", "title": "VBA Error Handler with &quot;With&quot; Statement", "body": "<p>Just add a byRef argument to SetRST.</p>\n\n<p>e.g:  </p>\n\n<pre><code>Sub SetRST(byref myrs as recordset)\n   'do stuff\n   set myrs = ...\n</code></pre>\n\n<p>By the way, your error handling sample sucks:  just add an <code>Exit Sub</code> before <code>ErrHand:</code>,<br>\nso you won't need to test if <code>err.number&lt;&gt;0</code>, because you know it will always be. </p>\n\n<p>In your error handling, use:  </p>\n\n<pre><code>call SetRST rst\n</code></pre>\n\n<hr>\n\n<p>Edit:<br>\nI would prefer something like:  </p>\n\n<pre><code>If rst Is Nothing Then\n    Set rst = something\nEnd if\nWith rst\n   'continue here\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 3, "last_activity_date": 1424886889, "creation_date": 1424886889, "answer_id": 28726206, "question_id": 28725527, "link": "https://stackoverflow.com/questions/28725527/vba-error-handler-with-with-statement/28726206#28726206", "title": "VBA Error Handler with &quot;With&quot; Statement", "body": "<p>In this case, how would the compiler know to resume at the beginning of the With block (and not at some other point)?  It would not, and although it may be logically connected (i.e., it's within the <code>With</code> block) that's still no reason to assume by rule that execution should resume at the start of that block, without explicit reference to resume at that point.  </p>\n\n<p>What you're asking essentially assumes the source of the error, and then expects that VBA has this assumption built in, but it would certainly not be applicable for all or even most cases, consider below, assume the <code>rst</code> is open/etc., the actual error raises at the <code>Bookmark</code> property, your error handler doesn't account for that, and so resuming at the beginning of the block will cause infinite failure loop!</p>\n\n<pre><code>On Error GoTo ErrHand\nWith rst\n    .AddNew\n    !MyValue = 1\n    .Update\n    .Bookmark = \"George Washington\"\nEnd With\n</code></pre>\n\n<p>See the documentation on the <code>Resume</code> statement:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/gg251630.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/gg251630.aspx</a></p>\n\n<p>There are your options to <code>Resume</code></p>\n\n<blockquote>\n  <p>If the error occurred in the same procedure as the error handler, execution resumes with the statement that caused the error. If the error occurred in a called procedure, execution resumes at the statement that last called out of the procedure containing the error-handling routine.</p>\n</blockquote>\n\n<p>Or to <code>Resume Next</code>:</p>\n\n<blockquote>\n  <p>If the error occurred in the same procedure as the error handler, execution resumes with the statement immediately following the statement that caused the error. If the error occurred in a called procedure, execution resumes with the statement immediately following the statement that last called out of the procedure containing the error-handling routine (or On Error Resume Next statement).</p>\n</blockquote>\n\n<p>Or to <code>Resume &lt;line&gt;</code></p>\n\n<blockquote>\n  <p>Execution resumes at line specified in the required line argument. The line argument is a line label or line number and must be in the same procedure as the error handler.</p>\n</blockquote>\n"}], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 0, "accepted_answer_id": 28726206, "answer_count": 3, "score": 3, "last_activity_date": 1594654628, "creation_date": 1424884961, "last_edit_date": 1594654628, "question_id": 28725527, "link": "https://stackoverflow.com/questions/28725527/vba-error-handler-with-with-statement", "title": "VBA Error Handler with &quot;With&quot; Statement", "body": "<p>Without setting a Label, is it possible for a VBA Error Handler to resume at the beginning of a With statement?</p>\n\n<p>For example:</p>\n\n<pre><code>Dim rst As DAO.Recordset\nSet rst = Nothing\n\nOn Error GoTo ErrHand\nWith rst\n    .AddNew\n    !MyValue = 1\n    .Update\n    .Bookmark = .LastModified\nEnd With\n\nErrHand:\n\nIf Err.Number &lt;&gt; 0 Then\n    Call SetRST 'Assume this procedure opens the recordset appropriately\n    Resume\nEnd If\nEnd Sub()\n</code></pre>\n\n<p>The code will cause an error on the \".AddNew\" line, and then when it goes through the error handler will set the recordset, but then it will Resume on the \".AddNew\" line.  The problem is that it is still within the \"With\" statement where CommentRST Is Nothing.  Is there a way to tell the error handler to resume at the \"With RST\" line instead or the \".AddNew\" line without creating a label before the \"With\" statement or checking for a blank recordset first?</p>\n\n<p>I know there are ways around this (as I've just suggested 2 of them), but am curious as to whether this is possible.</p>\n"}, {"tags": ["vba", "loops", "excel", "autofilter"], "answers": [{"comments": [{"owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "edited": false, "score": 0, "creation_date": 1425045572, "post_id": 28726874, "comment_id": 45812459, "body": "If I need to change the column that has the list of company names ex column C, Do I just need to change the &quot;A1&quot;s to &quot;C1&quot;? Or also change the value within the Columns to Columns(3)?"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "edited": false, "score": 0, "creation_date": 1425046357, "post_id": 28726874, "comment_id": 45812958, "body": "@New2VBA To create the dictionary object with the unique entries, you&#39;d only have to change <code>Columns(3)</code> in the <code>Set rngCompanyNames...</code> line. The <code>CurrentRegion</code> property, being set against <code>Range(A1)</code> checks all cells adjacent to <code>A1</code> without breaks, so it wouldn&#39;t make a difference to change it. Let me know if that&#39;s clear enough."}, {"owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "edited": false, "score": 0, "creation_date": 1425403892, "post_id": 28726874, "comment_id": 45945710, "body": "For some reason I can only get it to work when I&#39;m trying to filter through the unique values within the A column. I&#39;ve tried to switch it to others (as you&#39;ve described above) and all it does is go blank under the headings"}, {"owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "edited": false, "score": 0, "creation_date": 1425404567, "post_id": 28726874, "comment_id": 45946080, "body": "Ah figured it out. Had to change the field number in the editing_sheet.range part"}, {"owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "edited": false, "score": 0, "creation_date": 1425589021, "post_id": 28726874, "comment_id": 46036295, "body": "Any reason why it wouldn&#39;t recognize cells with the value &quot;#NA&quot;? It loops and filters through all of the values except that one."}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 1, "last_activity_date": 1424889062, "creation_date": 1424889062, "answer_id": 28726874, "question_id": 28725399, "link": "https://stackoverflow.com/questions/28725399/looping-through-autofilters-that-frequently-change/28726874#28726874", "title": "Looping Through AutoFilters that Frequently Change", "body": "<p>The <code>Dictionary</code> object allows you to create a list of all unique entries in <code>Column A</code>. Next, you can loop over the unique entries, filtering by each one. NOTE: In my code below, I've employed the <code>CurrentRegion</code> property of <code>A1</code>. This property assume that data is contiguous, without any empty rows or columns. Update it if necessary.</p>\n\n<pre><code>Sub StackOverflowQuestion()\n    Dim rngCompanyNames As Range\n    Dim oDictionary As Object\n    Dim cel As Range\n\n    Set oDictionary = CreateObject(\"Scripting.Dictionary\")\n    Set rngCompanyNames = Intersect(Editing_Sheet.Range(\"A1\").CurrentRegion, Editing_Sheet.Columns(1))\n\n    For Each cel In rngCompanyNames\n        If oDictionary.exists(cel.Value) Then\n            'Do nothing for now\n        Else\n            oDictionary.Add cel.Value, 0\n        End If\n    Next cel\n\n    For Each oKey In oDictionary.keys\n        Editing_Sheet.Range(\"A1\").CurrentRegion.AutoFilter field:=1, Criteria1:=CStr(oKey)\n        'RUN WHATEVER CODE YOU NEED TO RUN NOW\n    Next oKey\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 28726874, "answer_count": 1, "score": 0, "last_activity_date": 1426010638, "creation_date": 1424884609, "last_edit_date": 1531164843, "question_id": 28725399, "link": "https://stackoverflow.com/questions/28725399/looping-through-autofilters-that-frequently-change", "title": "Looping Through AutoFilters that Frequently Change", "body": "<p>I have a dataset that is going to be changing daily. I want to filter the data based on the company name - \"Company 1\", \"Company 2\", \"Company 3\", etc. And then run another sub. I currently do (just the filtering) with the following code.</p>\n\n<pre><code>Sub StackOverflowQuestion()\n    Editing_Sheet.Range(\"$A$1:$AH$1669\").AutoFilter Field:=1, Criteria1:= _\n        \"Company 1\"\n    Editing_Sheet.Range(\"$A$1:$AH$1669\").AutoFilter Field:=1, Criteria1:= _\n        \"Company 2\"\n    Editing_Sheet.Range(\"$A$1:$AH$1669\").AutoFilter Field:=1, Criteria1:= _\n        \"Company 3\"\n    Editing_Sheet.Range(\"$A$1:$AH$1669\").AutoFilter Field:=1, Criteria1:= _\n        \"Company 4\"\n    Editing_Sheet.Range(\"$A$1:$AH$1669\").AutoFilter Field:=1, Criteria1:= _\n        \"Company 5\"\nEnd Sub\n</code></pre>\n\n<p>But as the data (including the company names) is constantly changing - e.g. it will go all the way up to \"Company 20\", exclude the odd numbered companies, have names that are different altogether like \"New company name 45\", etc. It makes it difficult to have consistent code that does it all at the click of the button.</p>\n\n<p>I tried the following code (just to see if I was on the right track, arbitrarily using \"50\") to loop through all the autofilter options</p>\n\n<pre><code>Sub LoopThroughAuto\n    For i = 1 to 50\n    Editing_Sheet.Range(\"$A$1:$AH$1669\").AutoFilter Field:=1, Criteria1:= _\n        i\nnext i\n</code></pre>\n\n<p>But that didn't work. Is there anyway to loop through all the the autofilter options and then filter them?</p>\n\n<p>Thanks for the help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 1, "creation_date": 1424883511, "post_id": 28724858, "comment_id": 45736524, "body": "There is something similar-ish <a href=\"http://stackoverflow.com/questions/6525462/on-focus-after-tabbing-of-excel-drop-down-automatically-show-list-for-selection\">here</a>."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424884564, "post_id": 28724858, "comment_id": 45737198, "body": "Following that suggestion, <code>Application.SendKeys (&quot;%{DOWN}&quot;)</code> seems to do the trick."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424884731, "post_id": 28724858, "comment_id": 45737313, "body": "@DavidZemens  You are correct!! ........create an Answer and I&#39;ll mark this <i>Answered</i> .........thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1424885996, "post_id": 28725730, "comment_id": 45738201, "body": "...............Thanks!................."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1424885487, "last_edit_date": 1495539813, "creation_date": 1424885487, "answer_id": 28725730, "question_id": 28724858, "link": "https://stackoverflow.com/questions/28724858/click-a-pull-down-with-vba/28725730#28725730", "title": "Click a Pull-Down with VBA", "body": "<p>Modifying from the suggestion <a href=\"https://stackoverflow.com/questions/6525462/on-focus-after-tabbing-of-excel-drop-down-automatically-show-list-for-selection\">here</a>, it seems like <code>SendKeys</code> should do the trick:</p>\n\n<pre><code>Sub InternalString()\n    Range(\"B2\").Select\n    With Selection.Validation\n        .Delete\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n        xlBetween, Formula1:=\"alpha,beta,gamma,delta\"\n        .IgnoreBlank = True\n        .InCellDropdown = True\n        .InputTitle = \"\"\n        .ErrorTitle = \"\"\n        .InputMessage = \"\"\n        .ErrorMessage = \"\"\n        .ShowInput = True\n        .ShowError = True\n    End With\n\n    '\"Show\" the validation list as a dropdown:\n    Application.SendKeys (\"%{DOWN}\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "closed_date": 1424931100, "accepted_answer_id": 28725730, "answer_count": 1, "score": 0, "last_activity_date": 1424885487, "creation_date": 1424883171, "question_id": 28724858, "link": "https://stackoverflow.com/questions/28724858/click-a-pull-down-with-vba", "closed_reason": "Duplicate", "title": "Click a Pull-Down with VBA", "body": "<p>I have a small macro that establishes a Data Validation pull-down in cell <strong>B2</strong></p>\n\n<pre><code>Sub InternalString()\n    Range(\"B2\").Select\n    With Selection.Validation\n        .Delete\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n        xlBetween, Formula1:=\"alpha,beta,gamma,delta\"\n        .IgnoreBlank = True\n        .InCellDropdown = True\n        .InputTitle = \"\"\n        .ErrorTitle = \"\"\n        .InputMessage = \"\"\n        .ErrorMessage = \"\"\n        .ShowInput = True\n        .ShowError = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>The macro also <strong>Select</strong>s the cell.  I would like to add something to the macro that would \"click\" on the pull-down, so that once control is returned to the user, they would see:</p>\n\n<p><img src=\"https://i.stack.imgur.com/eoejF.png\" alt=\"enter image description here\"></p>\n\n<p>Any suggestion are welcome.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 4606709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e52773812285a1da71e2115197fa6be?s=128&d=identicon&r=PG&f=1", "display_name": "Tree", "link": "https://stackoverflow.com/users/4606709/tree"}, "edited": false, "score": 0, "creation_date": 1424887999, "post_id": 28725576, "comment_id": 45739546, "body": "Thank you I shall try this. I had another smaller question. I have a dynamic range that changes based on the data set. I have attempted to use &quot;Dim rd As Range     Dim nr As Long     Set rd = Sheets(&quot;Raw Data&quot;).Range(&quot;b2&quot;, Range(&quot;b2&quot;).End(xlDown))     nr = rd.Rows.Count&quot; but I get a 1004 error"}, {"owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "reply_to_user": {"reputation": 5, "user_id": 4606709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e52773812285a1da71e2115197fa6be?s=128&d=identicon&r=PG&f=1", "display_name": "Tree", "link": "https://stackoverflow.com/users/4606709/tree"}, "edited": false, "score": 0, "creation_date": 1424897806, "post_id": 28725576, "comment_id": 45745080, "body": "@Tree Couldn&#39;t recreate your error (even though the syntax in the third line looks weird to me).  Maybe ask a new question with some more details, like which line the error happens on."}], "tags": [], "owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "is_accepted": true, "score": 0, "last_activity_date": 1424885063, "creation_date": 1424885063, "answer_id": 28725576, "question_id": 28724837, "link": "https://stackoverflow.com/questions/28724837/excel-vba-isolate-unique-dates-when-you-have-time-with-it/28725576#28725576", "title": "Excel VBA isolate Unique dates when you have time with it", "body": "<p>Not the prettiest solution with the error handling but it should give you a collection of unique dates.  An error is generated and ignored when adding another date with the same key.  Convert the collection to an array or a range as needed,</p>\n\n<pre><code>Sub uniqueDates()\n    Dim inputRange As Range\n    Dim c As Collection\n    Dim cell As Range\n\n    Set inputRange = Range(\"A1:A6\")\n    Set c = New Collection\n\n    On Error Resume Next\n    For Each cell In inputRange\n        c.Add DateValue(cell.Value), CStr(DateValue(cell.Value))\n    Next\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 4606709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e52773812285a1da71e2115197fa6be?s=128&d=identicon&r=PG&f=1", "display_name": "Tree", "link": "https://stackoverflow.com/users/4606709/tree"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 28725576, "answer_count": 1, "score": 0, "last_activity_date": 1424885063, "creation_date": 1424883127, "question_id": 28724837, "link": "https://stackoverflow.com/questions/28724837/excel-vba-isolate-unique-dates-when-you-have-time-with-it", "title": "Excel VBA isolate Unique dates when you have time with it", "body": "<p>I am looking to create an array or range of unique dates from a column of dates that have time associated with it. For example</p>\n\n<pre><code>1/3/1984 0:15\n1/3/1984 0:20\n1/4/1984 0:25\n1/4/1984 0:30\n1/6/1984 0:35\n1/6/1984 0:40\n</code></pre>\n\n<p>The range would return </p>\n\n<pre><code> 1/3/1984\n 1/4/1984\n 1/6/1984 \n</code></pre>\n\n<p>Thanks for any help!</p>\n"}, {"tags": ["vba", "excel", "autofilter"], "comments": [{"owner": {"reputation": 1, "user_id": 4603736, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YGB4fE9z1XY/AAAAAAAAAAI/AAAAAAAACww/I9r8kL5kR48/photo.jpg?sz=128", "display_name": "Jps5013", "link": "https://stackoverflow.com/users/4603736/jps5013"}, "edited": false, "score": 0, "creation_date": 1424883089, "post_id": 28724788, "comment_id": 45736250, "body": "sorry, all parts of my code are working to my liking until the last line. that being said, suggestions on improvements to the rest are welcome, but my real question is about the last line of code."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1424889300, "post_id": 28724788, "comment_id": 45740301, "body": "Could you write an if statement in column AD to populate with &quot;Regular&quot; and &quot;Rush&quot;?"}, {"owner": {"reputation": 1, "user_id": 4603736, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YGB4fE9z1XY/AAAAAAAAAAI/AAAAAAAACww/I9r8kL5kR48/photo.jpg?sz=128", "display_name": "Jps5013", "link": "https://stackoverflow.com/users/4603736/jps5013"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1424892384, "post_id": 28724788, "comment_id": 45741988, "body": "Thanks Kyle, I am sure that I can, logically that makes sense. Let me try a few things and if I am stumped again, I will reach out."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1424892738, "post_id": 28724788, "comment_id": 45742166, "body": "This should do it. Put this in cell AD1 and drag down (assuming your data starts in AC1) <code>=If(Or(AC1 = &quot;D&quot;, AC1 = &quot;K&quot;, AC1 = &quot;Q&quot;, AC1 = &quot;V&quot;, AC1 = &quot;U&quot;, AC1 = &quot;1&quot;, AC1 = &quot;9&quot;),&quot;Regular&quot;,&quot;Rush&quot;)</code>"}, {"owner": {"reputation": 1, "user_id": 4603736, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YGB4fE9z1XY/AAAAAAAAAAI/AAAAAAAACww/I9r8kL5kR48/photo.jpg?sz=128", "display_name": "Jps5013", "link": "https://stackoverflow.com/users/4603736/jps5013"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1424893140, "post_id": 28724788, "comment_id": 45742435, "body": "Thanks Kyle, and yes, that will work- but basically what i want to do is write that formula in VBA to automate the process. Some kind of boolean expression i suppose."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1424893813, "post_id": 28724788, "comment_id": 45742867, "body": "<code>Range(&quot;ad1&quot;).Formula = &quot;=If(Or(AC1 = &quot;D&quot;, AC1 = &quot;K&quot;, AC1 = &quot;Q&quot;, AC1 = &quot;V&quot;, AC1 = &quot;U&quot;, AC1 = &quot;1&quot;, AC1 = &quot;9&quot;),&quot;Regular&quot;,&quot;Rush&quot;)&quot;</code>  <code>Range(&quot;ad1:ad&quot; Range(&quot;ac&quot; &amp; activesheet.rows.count).end(xlup).row)).autofill</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4603736, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YGB4fE9z1XY/AAAAAAAAAAI/AAAAAAAACww/I9r8kL5kR48/photo.jpg?sz=128", "display_name": "Jps5013", "link": "https://stackoverflow.com/users/4603736/jps5013"}, "edited": false, "score": 0, "creation_date": 1424893214, "post_id": 28727856, "comment_id": 45742472, "body": "Thank you!! and actually I am working on 100,000 plus data set. 102,124 specifically...I am sure my code is very inefficient."}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "reply_to_user": {"reputation": 1, "user_id": 4603736, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YGB4fE9z1XY/AAAAAAAAAAI/AAAAAAAACww/I9r8kL5kR48/photo.jpg?sz=128", "display_name": "Jps5013", "link": "https://stackoverflow.com/users/4603736/jps5013"}, "edited": false, "score": 0, "creation_date": 1424905569, "post_id": 28727856, "comment_id": 45748954, "body": "Adding &quot;righnow = Now&quot; to the beginning then &quot;rightnow2 = Now&quot; to somewhere by the end and &quot;MsgBox(rightnow2-rightnow)&quot; or some variations thereof can help you a great deal with optimising your runtime."}], "tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": false, "score": 0, "last_activity_date": 1424892380, "creation_date": 1424892380, "answer_id": 28727856, "question_id": 28724788, "link": "https://stackoverflow.com/questions/28724788/how-to-autofilter-column-1-and-return-related-results-in-column-2/28727856#28727856", "title": "How to autofilter column 1 and return related results in column 2", "body": "<p>This sniplet is independent from your solution as that relies too much on views.<br>\nMy sniplet parses through your \"AC\" column and does all your required fill-in.<br>\nIt is time-consuming, but not as much as yours (I assume you're not working on 100,000 record datasets, more like couple-hundred line evaluations of MMOs so it really shouldn't matter).<br>\nFiltering itself is up to you, add that part to the end of my sub.</p>\n\n<pre><code>Sub ertdfgcvb()\nLastRow = Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\nDim RegBool As Boolean\nDim ert As String\nDim MyArray(6) As String\nMyArray(0) = \"D\"\nMyArray(1) = \"K\"\nMyArray(2) = \"Q\"\nMyArray(3) = \"V\"\nMyArray(4) = \"U\"\nMyArray(5) = \"1\"\nMyArray(6) = \"9\"\nFor i = 1 To LastRow\n    RegBool = False\n    ert = CStr(Cells(i, 29).Value) 'the CStr is unnecessary\n    'unless you want to make it case-insensitive, in which case\n    'you'll want to wrap it in a UCase() function\n    For j = 0 To 6 'size of your array\n        If InStr(1, ert, MyArray(j)) &lt;&gt; 0 Then RegBool = True\n    Next\n\n    If RegBool Then\n        Cells(i, 30) = \"Regular\"\n    Else\n        Cells(i, 30) = \"Rush\"\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4603736, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YGB4fE9z1XY/AAAAAAAAAAI/AAAAAAAACww/I9r8kL5kR48/photo.jpg?sz=128", "display_name": "Jps5013", "link": "https://stackoverflow.com/users/4603736/jps5013"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424892380, "creation_date": 1424883019, "last_edit_date": 1424885934, "question_id": 28724788, "link": "https://stackoverflow.com/questions/28724788/how-to-autofilter-column-1-and-return-related-results-in-column-2", "title": "How to autofilter column 1 and return related results in column 2", "body": "<p>This is my first post. I am new to VBA and programming in general. I am still trying to get the hang of when to use variables and everything else. I am writing a basic VBA against a download file that can not be changed. Code is below</p>\n\n<pre><code>Sub KPIMacroFull()\n\nSet sht = ThisWorkbook.Worksheets(Sheet1.Name)\nRows(\"1:2\").Select\n    Selection.Delete Shift:=xlUp\n\nActiveCell.Offset(0, 9).Activate\n    Range(\"J:J\").AutoFilter 1, 20\n\n\nlr = Cells(Rows.Count, \"J\").End(xlUp).Row\n    If lr &gt; 1 Then\n        Range(\"A2:A\" &amp; lr).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    End If\n\n\nCells.AutoFilter\nCells.AutoFilter\n\n\nActiveCell.Offset(0, 0).Activate\nActiveCell.Offset(0, 20).Activate\n\n\nRange(\"AD1\").EntireColumn.Insert\nRange(\"AD1\").Value = \"Rush or Regular\"\nRange(\"A1:AK1\").Columns.AutoFit\nRange(\"AC:AC\").AutoFilter 29, \"D\"\n</code></pre>\n\n<p>So basically what I want to do is autofilter column AC for values \"D\",\"K\",\"Q\",\"V\",\"U\",1,9.  then in Column AD excel would return \"Regular\". For all other values in column AC (there are about 15 more classifications) I want excel to return \"Rush\". I am thinking a variable to set Regular to the above values and then going from there, but I am lost.</p>\n\n<p>I checked a lot of other autofilter and VBA posts, but my questions seems to be more rudimentary and have not found anything too helpful.</p>\n"}, {"tags": [".net", "vba", "templates", "ms-word", "vsto"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 4437127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c61586783d236dc9da21785aff35c55d?s=128&d=identicon&r=PG&f=1", "display_name": "nelb", "link": "https://stackoverflow.com/users/4437127/nelb"}, "edited": false, "score": 0, "creation_date": 1424884322, "post_id": 28724789, "comment_id": 45737042, "body": "We&#39;ve looked at the application-level customization, however it doesn&#39;t apply to our project as we&#39;re working with document-level customization. We have some knowledge of WCF as we use it to communicate with some Windows hosted services. Could you elaborate on how WCF could be used to call a VSTO method from another .NET application?"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 5, "user_id": 4437127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c61586783d236dc9da21785aff35c55d?s=128&d=identicon&r=PG&f=1", "display_name": "nelb", "link": "https://stackoverflow.com/users/4437127/nelb"}, "edited": false, "score": 0, "creation_date": 1424884827, "post_id": 28724789, "comment_id": 45737378, "body": "Yes, the link I mentioned can&#39;t be applied to document-level customizations. Use .Net remoting for communication between your applications. You may consider your document-level add-in as a regular .net application."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 0, "last_activity_date": 1424883019, "creation_date": 1424883019, "answer_id": 28724789, "question_id": 28724612, "link": "https://stackoverflow.com/questions/28724612/how-to-run-a-method-in-a-vsto-word-template-from-a-separate-net-application/28724789#28724789", "title": "How to run a method in a VSTO Word Template from a separate .NET application?", "body": "<p>You can use standard .Net mechanisms such as WCF (.Net Remoting) and etc. Consider your document level add-in as a separate application. </p>\n\n<p>In case of application level add-ins, you can call them directly. See <a href=\"https://msdn.microsoft.com/en-us/library/bb608621.aspx\" rel=\"nofollow\">Calling Code in Application-Level Add-ins from Other Office Solutions</a> for more information.</p>\n"}], "owner": {"reputation": 5, "user_id": 4437127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c61586783d236dc9da21785aff35c55d?s=128&d=identicon&r=PG&f=1", "display_name": "nelb", "link": "https://stackoverflow.com/users/4437127/nelb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 0, "accepted_answer_id": 28724789, "answer_count": 1, "score": 0, "last_activity_date": 1425674788, "creation_date": 1424882455, "last_edit_date": 1495540613, "question_id": 28724612, "link": "https://stackoverflow.com/questions/28724612/how-to-run-a-method-in-a-vsto-word-template-from-a-separate-net-application", "title": "How to run a method in a VSTO Word Template from a separate .NET application?", "body": "<p>I'm working on a project that involves migrating macros in a <strong>Word Template</strong> to VB.NET making use of VSTO. We've been able to create the Word Template and migrate the code to VB.NET just fine, however we need to action a certain VSTO method from a separate .NET application. </p>\n\n<p>Previously, we were able to achieve this in VBA by doing this:</p>\n\n<pre><code>Word.Application.Run(MacroName:=\"MyDocument.MyModule.MyMethod\")\n</code></pre>\n\n<p>There are a few articles explaining how this can be achieved with Application and Document-level customizations, but we've yet to find any information on how this can be done with a <strong>VSTO Document-level Word Template</strong>.</p>\n\n<p>We've already tried a number of different approaches including: </p>\n\n<ul>\n<li>Exposing the class and method as outlined in this <a href=\"https://stackoverflow.com/q/22787956\">How to expose a C# class to a VBA module in a document-level add-in?</a></li>\n<li>Introducing a VBA macro (which we can access from the .NET application), that can action the VSTO method as <a href=\"https://msdn.microsoft.com/en-us/library/vstudio/bb386306(v=vs.100).aspx\" rel=\"nofollow noreferrer\">outlined in this MSDN article</a> </li>\n</ul>\n\n<p>However neither of these seems to be applicable for document-level templates. In addition to this we also tried adding a button to the ribbon which fires the required method, and attempting to access it from our .NET application using <code>Word.Application.CommandBars.FindControl()</code></p>\n\n<p>Some more info: the VSTO Word Template was created using VS2013, and the separate .NET application has been developed on VS2010. Both applications run .NET Framework 4.</p>\n"}, {"tags": ["vba", "import"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 3398182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/684b3865410474017043fa52e1b5d392?s=128&d=identicon&r=PG&f=1", "display_name": "asar_k", "link": "https://stackoverflow.com/users/3398182/asar-k"}, "edited": false, "score": 0, "creation_date": 1424938262, "post_id": 28735931, "comment_id": 45758677, "body": "Hi @MarkWickett, I tried using your suggested change, but the macro exits, giving me an &quot;Automation Error&quot; message. It does not show where the error occurs."}, {"owner": {"reputation": 93, "user_id": 4570045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70bfa73fea7427e9819d28f1edf6c83?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Wickett", "link": "https://stackoverflow.com/users/4570045/mark-wickett"}, "reply_to_user": {"reputation": 31, "user_id": 3398182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/684b3865410474017043fa52e1b5d392?s=128&d=identicon&r=PG&f=1", "display_name": "asar_k", "link": "https://stackoverflow.com/users/3398182/asar-k"}, "edited": false, "score": 0, "creation_date": 1424996996, "post_id": 28735931, "comment_id": 45792265, "body": "Ok - not sure why you&#39;re getting that, but I did note that once you open the CSV, that becomes the ActiveWorkbook, so trying to copy that a new sheet in itself isn&#39;t going to work. I&#39;ve edited my response above to reflect a more accurate solution!"}, {"owner": {"reputation": 93, "user_id": 4570045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70bfa73fea7427e9819d28f1edf6c83?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Wickett", "link": "https://stackoverflow.com/users/4570045/mark-wickett"}, "reply_to_user": {"reputation": 31, "user_id": 3398182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/684b3865410474017043fa52e1b5d392?s=128&d=identicon&r=PG&f=1", "display_name": "asar_k", "link": "https://stackoverflow.com/users/3398182/asar-k"}, "edited": false, "score": 0, "creation_date": 1424997901, "post_id": 28735931, "comment_id": 45792519, "body": "Also, your error handling might be getting in the way of telling you where the error is - just comment out the <code>On Error Goto ErrHandler</code> and then you should get an option to debug at the offending statement if an error pops up. Of course, uncomment this once it&#39;s working :-)"}, {"owner": {"reputation": 31, "user_id": 3398182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/684b3865410474017043fa52e1b5d392?s=128&d=identicon&r=PG&f=1", "display_name": "asar_k", "link": "https://stackoverflow.com/users/3398182/asar-k"}, "edited": false, "score": 0, "creation_date": 1425018524, "post_id": 28735931, "comment_id": 45797991, "body": "Thanks again. But please pardon my (lack of) knowledge on VBA. I run this code with your change and now, I get an error &quot;No data selected to parse&quot;. But I see the first file that I selected, has been imported to the ActiveWorkbook. The others are not"}], "tags": [], "owner": {"reputation": 93, "user_id": 4570045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70bfa73fea7427e9819d28f1edf6c83?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Wickett", "link": "https://stackoverflow.com/users/4570045/mark-wickett"}, "is_accepted": false, "score": 0, "last_activity_date": 1424997752, "last_edit_date": 1424997752, "creation_date": 1424932371, "answer_id": 28735931, "question_id": 28724606, "link": "https://stackoverflow.com/questions/28724606/i-want-this-vba-code-to-run-from-a-command-button-in-the-current-workbook/28735931#28735931", "title": "I want this VBA code to run from a Command Button in the current workbook", "body": "<p>It's the <code>wbkTemp.Sheets(1).Copy</code> that is the problem: if you don't provde either of the optional parameters <code>Before</code> or <code>After</code>, Excel creates a copy in a new workbook (see Remarks here <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837784.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff837784.aspx</a>).</p>\n\n<p>You will need to set the reference to the originating workbook earlier - change your code around the opening of the first CSV as follows:</p>\n\n<pre><code>Set wkbAll = ActiveWorkbook 'moved from a few lines lower down\nSet wkbTemp = Workbooks.Open(Filename:=FilesToOpen(x))\nwbkTemp.Sheets(1).Copy After:=wkbAll.Sheets(wkbAll.Sheets.Count)\n</code></pre>\n\n<p>You will have to make the equivalent changes to the later copy methods</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 3398182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/684b3865410474017043fa52e1b5d392?s=128&d=identicon&r=PG&f=1", "display_name": "asar_k", "link": "https://stackoverflow.com/users/3398182/asar-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1425192781, "creation_date": 1425192781, "answer_id": 28790956, "question_id": 28724606, "link": "https://stackoverflow.com/questions/28724606/i-want-this-vba-code-to-run-from-a-command-button-in-the-current-workbook/28790956#28790956", "title": "I want this VBA code to run from a Command Button in the current workbook", "body": "<p>I found this link helpful.</p>\n\n<p><a href=\"http://answers.microsoft.com/en-us/office/forum/office_2010-customize/importing-multiple-text-files-and-replace-contents/f13e1ca2-821c-4337-bf94-897987eaab7d\" rel=\"nofollow\">Import multiple text files</a></p>\n\n<p>It worked for my case, with the only exception that I'd have to select a particular folder containing all the relevant files, rather than the individual files themselves.</p>\n\n<p>It would also work only for txt files because of the option <strong>Workbooks.OpenText FileName</strong></p>\n\n<p>Hope it also helps who face similar issues too.</p>\n\n<p>Regards\nasar_k</p>\n"}], "owner": {"reputation": 31, "user_id": 3398182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/684b3865410474017043fa52e1b5d392?s=128&d=identicon&r=PG&f=1", "display_name": "asar_k", "link": "https://stackoverflow.com/users/3398182/asar-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 218, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1425192781, "creation_date": 1424882435, "question_id": 28724606, "link": "https://stackoverflow.com/questions/28724606/i-want-this-vba-code-to-run-from-a-command-button-in-the-current-workbook", "title": "I want this VBA code to run from a Command Button in the current workbook", "body": "<p>I have a VBA (Excel 2010) code.\nIt imports multiple csv files and pastes them in different sheets.\nBut it does not import the data into the current workbook from where the code is executed. It rather opens a new workbook and does the job.</p>\n\n<p>I want to be able to run this code via a Command Button and import data into the active workbook.</p>\n\n<p>Any suggetions what changes I should incorporate?</p>\n\n<p>Your advice is greatly appreciated.</p>\n\n<pre><code>Sub CombineTextFiles()\n    Dim FilesToOpen\n    Dim x As Integer\n    Dim wkbAll As Workbook\n    Dim wkbTemp As Workbook\n    Dim sDelimiter As String\nOn Error GoTo ErrHandler\n    Application.ScreenUpdating = False\nsDelimiter = \"|\"\nFilesToOpen = Application.GetOpenFilename _\n      (FileFilter:=\"Text Files (*.csv), *.csv\", _\n      MultiSelect:=True, Title:=\"Text Files to Open\")\nIf TypeName(FilesToOpen) = \"Boolean\" Then\n        MsgBox \"No Files were selected\"\n        GoTo ExitHandler\n    End If\nx = 1\n    Set wkbTemp = Workbooks.Open(Filename:=FilesToOpen(x))\n    wkbTemp.Sheets(1).Copy\n    Set wkbAll = ActiveWorkbook\n    wkbTemp.Close (False)\n    wkbAll.Worksheets(x).Columns(\"A:A\").TextToColumns _\n      Destination:=Range(\"A1\"), DataType:=xlDelimited, _\n      TextQualifier:=xlDoubleQuote, _\n      ConsecutiveDelimiter:=False, _\n      Tab:=False, Semicolon:=False, _\n      Comma:=False, Space:=False, _\n      Other:=True, OtherChar:=\"|\"\n    x = x + 1\nWhile x &lt;= UBound(FilesToOpen)\n        Set wkbTemp = Workbooks.Open(Filename:=FilesToOpen(x))\n        With wkbAll\n            wkbTemp.Sheets(1).Move After:=.Sheets(.Sheets.Count)\n            .Worksheets(x).Columns(\"A:A\").TextToColumns _\n              Destination:=Range(\"A1\"), DataType:=xlDelimited, _\n              TextQualifier:=xlDoubleQuote, _\n              ConsecutiveDelimiter:=False, _\n              Tab:=False, Semicolon:=False, _\n              Comma:=False, Space:=False, _\n              Other:=True, OtherChar:=sDelimiter\n        End With\n        x = x + 1\n    Wend\nExitHandler:\n    Application.ScreenUpdating = True\n    Set wkbAll = Nothing\n    Set wkbTemp = Nothing\n    Exit Sub\nErrHandler:\n    MsgBox Err.Description\n    Resume ExitHandler\nEnd Sub\n</code></pre>\n"}, {"tags": ["database", "vba", "excel", "data-manipulation"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1424884230, "post_id": 28724476, "comment_id": 45736976, "body": "You can use a pivot table for this."}, {"owner": {"reputation": 35, "user_id": 4606297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa08b0100831ad76c4c8ff0d3f0774e4?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin P", "link": "https://stackoverflow.com/users/4606297/kevin-p"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1424897545, "post_id": 28724476, "comment_id": 45744919, "body": "@TimWilliams that actually worked! Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4606297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa08b0100831ad76c4c8ff0d3f0774e4?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin P", "link": "https://stackoverflow.com/users/4606297/kevin-p"}, "edited": false, "score": 0, "creation_date": 1424891213, "post_id": 28725520, "comment_id": 45741307, "body": "I am running a VBA script to get data from the SQL table on another sheet. I am using a Micro button to update the information. Is there a way to implement this in VBA?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 35, "user_id": 4606297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa08b0100831ad76c4c8ff0d3f0774e4?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin P", "link": "https://stackoverflow.com/users/4606297/kevin-p"}, "edited": false, "score": 0, "creation_date": 1424895819, "post_id": 28725520, "comment_id": 45743949, "body": "@KevinP - FWIW, a couple of GROUP BY aggregates in your SQL SELECT statement should be sufficient to put it into exactly what you are trying to achieve."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1424884934, "last_edit_date": 1592644375, "creation_date": 1424884934, "answer_id": 28725520, "question_id": 28724476, "link": "https://stackoverflow.com/questions/28724476/table-manipulations-in-excel-vba/28725520#28725520", "title": "Table Manipulations in Excel VBA", "body": "<p>Beyond an intellectual pursuit, there is absolutely no need for VBA. From your example, put this <em>array formula</em> in C24.</p>\n<pre><code>=IFERROR(INDEX($B$2:$B$23, MATCH(0, IF(LEN($B$2:$B$23), COUNTIF($B24:B24, $B$2:$B$23), 1), 0)), &quot;&quot;)\n</code></pre>\n<p>Finalize with <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Enter\u21b5</kbd>. Once entered correctly, fill right until you run out of values to retrieve.</p>\n<p>In A25 use this <em>standard formula</em>.</p>\n<pre><code>=IF(COUNTIF(A$24:A24, MOD(ROW(1:1)-1, MAX(A$2:A$23))+1)&lt;SUMPRODUCT((D$2:D$23&lt;&gt;&quot;&quot;)/COUNTIF(D$2:D$23, D$2:D$23&amp;&quot;&quot;)), MOD(ROW(1:1)-1, MAX(A$2:A$23))+1, &quot;&quot;)\n</code></pre>\n<p>Fill down to get all of the shelves you will need.</p>\n<p>In B25 use this <em>array formula</em>,</p>\n<pre><code>=IF(AND(ROW(1:1)&gt;1,COUNTIF(A$24:A25, A25)=COUNTIF(A$24:A24, A24)), B24, IFERROR(INDEX($D$2:$D$23, MATCH(0, IF(LEN($D$2:$D$23), COUNTIF(B$24:B24, $D$2:$D$23), 1), 0)), &quot;&quot;))\n</code></pre>\n<p>Finalize with <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Enter\u21b5</kbd>. Fill down to catch all of the stores.</p>\n<p>Finally, put this in C25.</p>\n<pre><code>=SUMIFS($C$2:$C$23, $A$2:$A$23, $A25, $B$2:$B$23, C$24, $D$2:$D$23, $B25)\n</code></pre>\n<p>Fill right to D25 then fill C25:D25 down to the length of the table.</p>\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<img src=\"https://i.stack.imgur.com/Mj4tq.png\" alt=\"Store Inventory Tables\" /></p>\n<p>The only difference in my second table is that <em>Water</em> comes before <em>Gartorade</em> and that is a result of it appearing the first table's <em>Item</em> list first.</p>\n"}], "owner": {"reputation": 35, "user_id": 4606297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa08b0100831ad76c4c8ff0d3f0774e4?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin P", "link": "https://stackoverflow.com/users/4606297/kevin-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "accepted_answer_id": 28725520, "answer_count": 1, "score": 0, "last_activity_date": 1480025893, "creation_date": 1424882086, "last_edit_date": 1531164843, "question_id": 28724476, "link": "https://stackoverflow.com/questions/28724476/table-manipulations-in-excel-vba", "title": "Table Manipulations in Excel VBA", "body": "<p>I have the following table on one sheet, top table of the picture, and I need to transform it to the to the different format on the second sheet (bottom table of the picture). I need to use VBA in Excel to do this manipulations. I pulled the main table (top) from SQL query on the separate sheet and need to rearrange it to fit my needs. I have a lot more data than that but it follows the same format. Just imagine that there are just more Shelves, Items, Amounts and Stores. </p>\n\n<p>I searched everywhere but can't seem to find direct answer.</p>\n\n<p>I am relatively new to VBA. Can someone give me a some directions? Is there a website with some tutorials about table manipulations in Excel VBA?</p>\n\n<p><img src=\"https://s15.postimg.org/kbzweh6sr/Table_1.png\" alt=\"Table_Link_Image\"></p>\n"}, {"tags": ["excel", "vba", "outlook", "inbox"], "answers": [{"comments": [{"owner": {"reputation": 251, "user_id": 4233291, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/dca7b89667f1cb99a16263879305ac9b?s=128&d=identicon&r=PG&f=1", "display_name": "pexpex223", "link": "https://stackoverflow.com/users/4233291/pexpex223"}, "edited": false, "score": 0, "creation_date": 1425229639, "post_id": 28725427, "comment_id": 45867229, "body": "Hi eugene, I change my line to &quot;urn:schemas:mailheader:subject like &#39;%order 14567%&#39;&quot;, still not working on Set objSch = Application.AdvancedSearch(scope:=strS, _         Filter:=strF, Tag:=strTag), I was thinkg if i need to add any extra VBA reference?"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 251, "user_id": 4233291, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/dca7b89667f1cb99a16263879305ac9b?s=128&d=identicon&r=PG&f=1", "display_name": "pexpex223", "link": "https://stackoverflow.com/users/4233291/pexpex223"}, "edited": false, "score": 0, "creation_date": 1425238099, "post_id": 28725427, "comment_id": 45870306, "body": "Did you have a chance to check out the the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff861239(v=office.15).aspx\" rel=\"nofollow noreferrer\">IsInstantSearchEnabled</a> property of the Store class?"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1424884681, "creation_date": 1424884681, "answer_id": 28725427, "question_id": 28724435, "link": "https://stackoverflow.com/questions/28724435/advanced-search-for-subject-incurs-error-438-object-doesnt-support-this-prope/28725427#28725427", "title": "Advanced search for subject incurs error 438 - object doesn&#39;t support this properties or method", "body": "<p>It looks like the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff861239(v=office.15).aspx\" rel=\"nofollow\">IsInstantSearchEnabled</a> property of the Store returns false, i.e. the instant search is turned off for the store. In that case you need to use the search string like the following one:</p>\n\n<pre><code>\"urn:schemas:mailheader:subject like '%order 14567%'\"\n</code></pre>\n\n<p>You can read about filtering strings in the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869374.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Filtering Items Using Query Keywords</a> section in MSDN. </p>\n\n<p>Also you may find the Find/FindNext or Restrict methods of the Items class helpful. They are described in depth in the following articles:</p>\n\n<ul>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2012/05/31/outlook-search-csharp-vbnet/\" rel=\"nofollow\">Advanced search in Outlook programmatically: C#, VB.NET</a></li>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/09/20/outlook-find-findnext-retrieve-mail/\" rel=\"nofollow\">How To: Use Find and FindNext methods to retrieve Outlook mail items from a folder (C#, VB.NET)</a></li>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/09/23/outlook-restrict-method-retrieve-mail/\" rel=\"nofollow\">How To: Use Restrict method to retrieve Outlook mail items from a folder</a></li>\n</ul>\n"}], "owner": {"reputation": 251, "user_id": 4233291, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/dca7b89667f1cb99a16263879305ac9b?s=128&d=identicon&r=PG&f=1", "display_name": "pexpex223", "link": "https://stackoverflow.com/users/4233291/pexpex223"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 897, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593248689, "creation_date": 1424881987, "last_edit_date": 1593248689, "question_id": 28724435, "link": "https://stackoverflow.com/questions/28724435/advanced-search-for-subject-incurs-error-438-object-doesnt-support-this-prope", "title": "Advanced search for subject incurs error 438 - object doesn&#39;t support this properties or method", "body": "<p>I would like to search for email with subject \"order 14567\" in my current Outlook folder. </p>\n\n<p>There is an error (438 - object doesn't support this properties or method.) incurred in the following code: </p>\n\n<pre><code>Set objSch = Application.AdvancedSearch(scope:=strS, _\n            Filter:=strF, Tag:=strTag)   \n</code></pre>\n\n<p><strong>VBA code:</strong></p>\n\n<pre><code>Sub SearchInboxFolder()\n'Searches the Inbox\n    Dim objSch As Search\n    Const strF As String = \"urn:schemas:mailheader:subject = 'order 14567'\"\n    Const strS As String = \"Inbox\"\n    Const strTag As String = \"SubjectSearch\"\n    Set objSch = Application.AdvancedSearch(scope:=strS, _\n        Filter:=strF, Tag:=strTag)\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "url", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1424881945, "post_id": 28724049, "comment_id": 45735471, "body": "Are the cells truly blank or zero-length strings returned by a formula; e.g. &quot;&quot; ? If zero-length strings then they are not truly blank and <code>IsEmpty</code> cannot be used to determine a valid entry. Try <code>If CBool(Len(cell.Value)) Then</code> or more precisely something like <code>If CBool(InStr(1, cell.Value, &quot;.png&quot;, vbTextCompare)) Then</code>."}, {"owner": {"reputation": 1, "user_id": 4606513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bde15659d9eb5674135e5830f4fd76c?s=128&d=identicon&r=PG&f=1", "display_name": "Neil Angermeier", "link": "https://stackoverflow.com/users/4606513/neil-angermeier"}, "edited": false, "score": 0, "creation_date": 1424971839, "post_id": 28724049, "comment_id": 45779833, "body": "The first option worked perfectly. Thanks for your help"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1424972149, "post_id": 28748999, "comment_id": 45780021, "body": "This was originally posted as a comment to the question to verify the nature of the cell data in question. As it appears to be the solution to this situation, I&#39;ve reposted it as an answer."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1424971961, "creation_date": 1424971961, "answer_id": 28748999, "question_id": 28724049, "link": "https://stackoverflow.com/questions/28724049/vba-trying-to-render-image-urls-but-skip-blank-cells/28748999#28748999", "title": "VBA trying to render image urls but skip blank cells", "body": "<p>Are the cells truly blank or zero-length strings returned by a formula; e.g. \"\" ? If zero-length strings then they are not truly blank and <code>IsEmpty</code> cannot be used to determine a valid entry. Try,</p>\n\n<pre><code>If CBool(Len(cell.Value)) Then\n</code></pre>\n\n<p>... or more precisely something like </p>\n\n<pre><code>If CBool(InStr(1, cell.Value, \".png\", vbTextCompare)) Then. \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4606513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bde15659d9eb5674135e5830f4fd76c?s=128&d=identicon&r=PG&f=1", "display_name": "Neil Angermeier", "link": "https://stackoverflow.com/users/4606513/neil-angermeier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424971961, "creation_date": 1424881012, "last_edit_date": 1531164843, "question_id": 28724049, "link": "https://stackoverflow.com/questions/28724049/vba-trying-to-render-image-urls-but-skip-blank-cells", "title": "VBA trying to render image urls but skip blank cells", "body": "<p>I have a macro written to render an image url in column A into the column beside it. The images are large, so I have information in every other cell in column A, and the range in column A has a max number but will vary in size each time. I am tryingt to get the code to skip blank cells, but right now it is showing every other cell instead of skipping all the blanks.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub Name()\n\nDim cell, shp As Shape, target As Range\n\n myurl = \"http://(site)\"\n\n   Set Rng = ActiveSheet.Range(\"a1:a195\") ' range with names\n   For Each cell in Rng\n   If Not IsEmpty(cell) Then\n       filenam = myurl &amp; cell\n       ActiveSheet.Pictures.Insert(filenam).Select\n\n    Set shp = Selection.ShapeRange.Item(1)\n     With shp\n       .LockAspectRatio = msoTrue\n       .Width = 600\n       .Height = 600\n       .Cut\n     End With\n     Cells(cell.Row, cell.Column + 1).PasteSpecial\n   End If\n Next\nEnd Sub\n</code></pre>\n\n<p>I am able to create the images, but I am creating images for blank cells at the end also that are returning boxes saying \"Image Not Available\" because the url does not exist. Does anyone know how I can omit the blank cells instead of just omitting every other cell?</p>\n\n<p>If this is confusing, I can give more detail.Thanks</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 51, "user_id": 3270394, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4b865715a9f0c2f94acddde7de105df9?s=128&d=identicon&r=PG&f=1", "display_name": "RosscoP", "link": "https://stackoverflow.com/users/3270394/rosscop"}, "reply_to_user": {"reputation": 1655, "user_id": 116927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/293fc299b969d0abdfaef797190ee9ef?s=128&d=identicon&r=PG", "display_name": "KevenDenen", "link": "https://stackoverflow.com/users/116927/kevendenen"}, "edited": false, "score": 0, "creation_date": 1424883273, "post_id": 28723935, "comment_id": 45736356, "body": "Hi. I am in the stage of conceptualising this solution and my VBA is limited but I figured it would be possible. Essentially I am looking for guidance to avoid 100 queries and to increase my VBA skills or my approach."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 3270394, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4b865715a9f0c2f94acddde7de105df9?s=128&d=identicon&r=PG&f=1", "display_name": "RosscoP", "link": "https://stackoverflow.com/users/3270394/rosscop"}, "edited": false, "score": 0, "creation_date": 1424944963, "post_id": 28725356, "comment_id": 45762398, "body": "Am I right in thinking that a process to loop through that distinct list is only achievable from writing VBA rather than anything else built in to Access. I can supply more information but am unsure what you would want to make it less general. Thanks."}, {"owner": {"reputation": 1655, "user_id": 116927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/293fc299b969d0abdfaef797190ee9ef?s=128&d=identicon&r=PG", "display_name": "KevenDenen", "link": "https://stackoverflow.com/users/116927/kevendenen"}, "reply_to_user": {"reputation": 51, "user_id": 3270394, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4b865715a9f0c2f94acddde7de105df9?s=128&d=identicon&r=PG&f=1", "display_name": "RosscoP", "link": "https://stackoverflow.com/users/3270394/rosscop"}, "edited": false, "score": 0, "creation_date": 1425577183, "post_id": 28725356, "comment_id": 46029495, "body": "There probably is some way to do this using a set of queries, but I would use VBA for this, yes."}], "tags": [], "owner": {"reputation": 1655, "user_id": 116927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/293fc299b969d0abdfaef797190ee9ef?s=128&d=identicon&r=PG", "display_name": "KevenDenen", "link": "https://stackoverflow.com/users/116927/kevendenen"}, "is_accepted": false, "score": 0, "last_activity_date": 1424884445, "creation_date": 1424884445, "answer_id": 28725356, "question_id": 28723935, "link": "https://stackoverflow.com/questions/28723935/access-possible-vba-export-to-multiple-files-based-on-column-content/28725356#28725356", "title": "Access (possible VBA) Export to multiple files based on column content", "body": "<p>As your question is pretty general, here's a general approach I might take.</p>\n\n<ol>\n<li>Query the data to get a distinct list of airports.</li>\n<li>Loop over list from #1, building a set of data just for that airport.</li>\n<li>Export the data from #2 to Excel.</li>\n</ol>\n\n<p>The details on how to do each of those is going to depend on what the initial dataset looks like and is beyond the scope of what Stack Overflow is for. </p>\n"}], "owner": {"reputation": 51, "user_id": 3270394, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4b865715a9f0c2f94acddde7de105df9?s=128&d=identicon&r=PG&f=1", "display_name": "RosscoP", "link": "https://stackoverflow.com/users/3270394/rosscop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1424884445, "creation_date": 1424880703, "question_id": 28723935, "link": "https://stackoverflow.com/questions/28723935/access-possible-vba-export-to-multiple-files-based-on-column-content", "title": "Access (possible VBA) Export to multiple files based on column content", "body": "<p>I currently have a dataset that contains information for arrivals at over 100 airports. My end goal is create an excel file with a tab for each of those airports containing only the information for that airport (multiple rows).</p>\n\n<p>I can of course create 100 queries and export them in a macro. However the list may change overtime and while I can amend the query that creates the initial file I'd rather not have to tweak the downstream process each time.</p>\n\n<p>I cannot amend the source file process so do not want to export 105 initial files each time.</p>\n\n<p>I am looking for a process that will export based on the contents of the data.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8749, "user_id": 990750, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/nIvmG.jpg?s=128&g=1", "display_name": "Tarik", "link": "https://stackoverflow.com/users/990750/tarik"}, "edited": false, "score": 0, "creation_date": 1424879964, "post_id": 28723520, "comment_id": 45733976, "body": "SumA=0 instead of Null"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424880072, "post_id": 28723520, "comment_id": 45734064, "body": "You&#39;re setting them to <code>Null</code> outside of the <code>j</code> loop.  This code appears to correctly <code>Null</code> the variables within the <code>Counter</code> loop.  Note that you can&#39;t add to a null value, i.e., <code>SumA = Null + 1</code> will yield a <code>Null</code> result. You probably should be assigning these values as <code>0</code> rather than <code>Null</code>."}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 1, "creation_date": 1424880660, "post_id": 28723520, "comment_id": 45734509, "body": "Wouldn&#39;t the loop set them to 0 at the start of each iteration anyways?"}], "answers": [{"comments": [{"owner": {"reputation": 617, "user_id": 1561149, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/62567c57565e50b800d1882941c512e6?s=128&d=identicon&r=PG", "display_name": "zerospiel", "link": "https://stackoverflow.com/users/1561149/zerospiel"}, "edited": false, "score": 0, "creation_date": 1424883102, "post_id": 28723634, "comment_id": 45736263, "body": "I tried this and this not working for me. Varieables continue to stack. No matter how many times I try to 0 or <code>Null</code> them."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 4, "last_activity_date": 1424879930, "creation_date": 1424879930, "answer_id": 28723634, "question_id": 28723520, "link": "https://stackoverflow.com/questions/28723520/variables-doesnt-null-after-step-of-loop/28723634#28723634", "title": "Variables doesn&#39;t null after step of loop", "body": "<p>..............use <strong>0</strong> rather than <strong>Null</strong></p>\n"}, {"comments": [{"owner": {"reputation": 617, "user_id": 1561149, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/62567c57565e50b800d1882941c512e6?s=128&d=identicon&r=PG", "display_name": "zerospiel", "link": "https://stackoverflow.com/users/1561149/zerospiel"}, "edited": false, "score": 0, "creation_date": 1424883354, "post_id": 28723696, "comment_id": 45736420, "body": "I already tried these solutions, but <code>SumA</code>, <code>SubB</code> and <code>SumC</code> just stack sum of each step of loop. At the beggining I just assign them to 0, like <code>SumA = 0</code> without dimension, then I tried this after assign values of sum to cells. Then I tried to <code>Null</code> them. It just doesn&#39;t work."}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "reply_to_user": {"reputation": 617, "user_id": 1561149, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/62567c57565e50b800d1882941c512e6?s=128&d=identicon&r=PG", "display_name": "zerospiel", "link": "https://stackoverflow.com/users/1561149/zerospiel"}, "edited": false, "score": 0, "creation_date": 1424883466, "post_id": 28723696, "comment_id": 45736488, "body": "What do you mean by &quot;stack&quot;? I have a feeling you are getting the error because they are dimensioned as <code>Variant</code> instead of <code>Long</code>."}, {"owner": {"reputation": 617, "user_id": 1561149, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/62567c57565e50b800d1882941c512e6?s=128&d=identicon&r=PG", "display_name": "zerospiel", "link": "https://stackoverflow.com/users/1561149/zerospiel"}, "edited": false, "score": 0, "creation_date": 1424883798, "post_id": 28723696, "comment_id": 45736700, "body": "I edited my question with two versions that I already tried. I&#39;ll try to move dimensions out of the loop and dimension them as <code>Integer</code>"}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "reply_to_user": {"reputation": 617, "user_id": 1561149, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/62567c57565e50b800d1882941c512e6?s=128&d=identicon&r=PG", "display_name": "zerospiel", "link": "https://stackoverflow.com/users/1561149/zerospiel"}, "edited": false, "score": 0, "creation_date": 1424884398, "post_id": 28723696, "comment_id": 45737088, "body": "I&#39;m still not understanding what you mean by &quot;stack.&quot; Does it continue to add the numbers or does it put one number at the end of the previous number?"}, {"owner": {"reputation": 617, "user_id": 1561149, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/62567c57565e50b800d1882941c512e6?s=128&d=identicon&r=PG", "display_name": "zerospiel", "link": "https://stackoverflow.com/users/1561149/zerospiel"}, "edited": false, "score": 0, "creation_date": 1424884514, "post_id": 28723696, "comment_id": 45737164, "body": "It&#39;s ok, I just debug my code and there is my fault in algorithm. All variables are successfully null"}], "tags": [], "owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "is_accepted": false, "score": 2, "last_activity_date": 1424880092, "creation_date": 1424880092, "answer_id": 28723696, "question_id": 28723520, "link": "https://stackoverflow.com/questions/28723520/variables-doesnt-null-after-step-of-loop/28723696#28723696", "title": "Variables doesn&#39;t null after step of loop", "body": "<p>A couple things:</p>\n\n<ol>\n<li>You should not dimension your variables within the <code>For</code> loop. Move those out of the loop below the first one.</li>\n<li>If <code>SumA</code>, <code>SumB</code>, and <code>SumC</code> are always integers, you should dimension them as <code>Long</code> or <code>Integer</code> instead of variant.</li>\n<li>You're resetting each of these variables to 0 at the start of the loop, so there is no need for the <code>SumA = Null</code>, <code>SumB = Null</code>, and <code>SumC = Null</code> lines.</li>\n</ol>\n"}], "owner": {"reputation": 617, "user_id": 1561149, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/62567c57565e50b800d1882941c512e6?s=128&d=identicon&r=PG", "display_name": "zerospiel", "link": "https://stackoverflow.com/users/1561149/zerospiel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 28723634, "answer_count": 2, "score": 0, "last_activity_date": 1424884577, "creation_date": 1424879644, "last_edit_date": 1424884577, "question_id": 28723520, "link": "https://stackoverflow.com/questions/28723520/variables-doesnt-null-after-step-of-loop", "title": "Variables doesn&#39;t null after step of loop", "body": "<p>I want to count chars of data in columns, so I'm using <code>for</code> loop to do it.\nHere is an example of my code:</p>\n\n<pre><code>Sub CharCount()\n    Dim Counter As Long\n\n    For Counter = 1 To 257 Step 1\n        Dim SumA As Variant\n        Dim SumB As Variant\n        Dim SumC As Variant\n        SumA = 0\n        SumB = 0\n        SumC = 0\n        Dim j As Long\n        For j = Counter To Counter * 257 Step 1\n            SumA = SumA + Len(Cells(j, 1))\n            SumB = SumB + Len(Cells(j, 2))\n            SumC = SumC + Len(Cells(j, 3))\n        Next j\n        Range(\"E\" &amp; Counter) = SumA\n        Range(\"F\" &amp; Counter) = SumB\n        Range(\"G\" &amp; Counter) = SumC\n        SumA = Null\n        SumB = Null\n        SumC = Null\n    Next Counter\nEnd Sub\n</code></pre>\n\n<p>As you can see, I'm trying to <code>Null</code> variables for sum, but it doesn't seem to work and after each step of loop these variables just stack values of previous steps. How can I null variables?</p>\n\n<p>I already tried these versions of code:</p>\n\n<p>1:</p>\n\n<pre><code>Sub CharCount()\n    Dim Counter As Long\n\n    For Counter = 1 To 257 Step 1\n        SumA = 0\n        SumB = 0\n        SumC = 0\n        Dim j As Long\n        For j = Counter To Counter * 257 Step 1\n            SumA = SumA + Len(Cells(j, 1))\n            SumB = SumB + Len(Cells(j, 2))\n            SumC = SumC + Len(Cells(j, 3))\n        Next j\n        Range(\"E\" &amp; Counter) = SumA\n        Range(\"F\" &amp; Counter) = SumB\n        Range(\"G\" &amp; Counter) = SumC\n    Next Counter\nEnd Sub\n</code></pre>\n\n<p>2:</p>\n\n<pre><code>Sub CharCount()\n    Dim Counter As Long\n\n    For Counter = 1 To 257 Step 1\n        SumA = 0\n        SumB = 0\n        SumC = 0\n        Dim j As Long\n        For j = Counter To Counter * 257 Step 1\n            SumA = SumA + Len(Cells(j, 1))\n            SumB = SumB + Len(Cells(j, 2))\n            SumC = SumC + Len(Cells(j, 3))\n        Next j\n        Range(\"E\" &amp; Counter) = SumA\n        Range(\"F\" &amp; Counter) = SumB\n        Range(\"G\" &amp; Counter) = SumC\n        SumA = 0\n        SumB = 0\n        SumC = 0\n    Next Counter\nEnd Sub`\n</code></pre>\n\n<p>First and second versions doesn't work for me.</p>\n\n<p>UPD. It was just my fault in algorithm. After debugging I noticed that all variables successfully nulled after step of loop.</p>\n"}, {"tags": ["vba", "ms-access-2007", "ms-access-2010"], "comments": [{"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 1, "creation_date": 1424879684, "post_id": 28723255, "comment_id": 45733726, "body": "If you look at <a href=\"https://msdn.microsoft.com/en-us/library/office/ff820845.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff820845.aspx</a>, you will see you are missing a form name. In addition, the Where statement should either be <code>&quot;[UserID]= &quot; &amp; Me.CboUserID</code> or <code>&quot;[UserID]= &#39;&quot; &amp; Me.CboUserID &amp; &quot;&#39;&quot;</code>"}, {"owner": {"reputation": 1, "user_id": 4606430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60deebe54a1893a3cf73a8dadbd7ede1?s=128&d=identicon&r=PG&f=1", "display_name": "Rafiki", "link": "https://stackoverflow.com/users/4606430/rafiki"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1424882500, "post_id": 28723255, "comment_id": 45735875, "body": "cleaned it up a bit , but the where statement keeps giving me an error that the form name is wrong"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1424882823, "post_id": 28723255, "comment_id": 45736069, "body": "What is the name of your form? This <code>&quot;[UserID]&quot; = &quot;CboUserID &#39;&quot;</code> can never be correct."}, {"owner": {"reputation": 1, "user_id": 4606430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60deebe54a1893a3cf73a8dadbd7ede1?s=128&d=identicon&r=PG&f=1", "display_name": "Rafiki", "link": "https://stackoverflow.com/users/4606430/rafiki"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1424882994, "post_id": 28723255, "comment_id": 45736194, "body": "its multiple forms for multiple users ,"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1424883036, "post_id": 28723255, "comment_id": 45736217, "body": "What is the outline name of any form you wish to use? Examples, please."}, {"owner": {"reputation": 1, "user_id": 4606430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60deebe54a1893a3cf73a8dadbd7ede1?s=128&d=identicon&r=PG&f=1", "display_name": "Rafiki", "link": "https://stackoverflow.com/users/4606430/rafiki"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1424883207, "post_id": 28723255, "comment_id": 45736323, "body": "Example of form name is  &#39;TyoungForm&#39; , error i get is &quot; the Form name [UserID] = &#39;Tyoung&#39; is Misspelled or refers to a form that doesnt exist"}], "answers": [{"tags": [], "owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "is_accepted": false, "score": 0, "last_activity_date": 1424883651, "creation_date": 1424883651, "answer_id": 28725035, "question_id": 28723255, "link": "https://stackoverflow.com/questions/28723255/point-specific-users-to-a-specific-form-in-access-2010/28725035#28725035", "title": "Point specific users to a specific form in Access 2010", "body": "<p>The name of the form is the username &amp; form, so:</p>\n\n<pre><code>DoCmd.OpenForm Me.CboUserID &amp; \"Form\"\n</code></pre>\n\n<p>I think it is not sensible to work with multiple forms - forms can be filtered and adjusted so that only one is necessary.</p>\n"}], "owner": {"reputation": 1, "user_id": 4606430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60deebe54a1893a3cf73a8dadbd7ede1?s=128&d=identicon&r=PG&f=1", "display_name": "Rafiki", "link": "https://stackoverflow.com/users/4606430/rafiki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424883651, "creation_date": 1424879020, "last_edit_date": 1424879556, "question_id": 28723255, "link": "https://stackoverflow.com/questions/28723255/point-specific-users-to-a-specific-form-in-access-2010", "title": "Point specific users to a specific form in Access 2010", "body": "<p>I am building a small database for 5 people. I am not a guru in Access but I can find my way around. I just need help with making the login form I created only open the individual form for each individual user. Below is the code I have so far. Any help is appreciated </p>\n\n<pre><code>Private Sub txtPassword_AfterUpdate()\n\n'Check that User is selected\nIf IsNull(Me.CboUserID) Then\n    MsgBox \"You need to select a user!\", vbCritical\n    Me.CboUserID.SetFocus\nElse\n\n        DoCmd.OpenForm \"[UserID]\" = \"CboUserID '\"\n        Me.Visible = False\n\n        MsgBox \"Password does not match, please re-enter!\", vbOKOnly Or vbExclamation\n        Me.txtPassword = Null\n        Me.txtPassword.SetFocus\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "compiler-errors"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424878835, "post_id": 28722852, "comment_id": 45733042, "body": "<code>Dim CurrentPathA As Variant</code>"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 4325170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000860947899/picture?type=large", "display_name": "Milo Kang", "link": "https://stackoverflow.com/users/4325170/milo-kang"}, "edited": false, "score": 0, "creation_date": 1424878969, "post_id": 28723205, "comment_id": 45733149, "body": "Thanks for your help!"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 3, "last_activity_date": 1587078700, "last_edit_date": 1587078700, "creation_date": 1424878881, "answer_id": 28723205, "question_id": 28722852, "link": "https://stackoverflow.com/questions/28722852/convert-shared-folder-path-to-unc-path/28723205#28723205", "title": "Convert Shared folder path to UNC path", "body": "<p>I'm surprised that this line doesn't throw a Mismatch error:</p>\n\n<pre><code>CurrentPathA = Split(CurrentPath, \"\\\")\n</code></pre>\n\n<p>The <code>Split</code> function converts a string to an array. So, attempting to assign the result of <code>Split</code> to a string variable should raise an error.</p>\n\n<p>In any case, the <code>Ubound</code> function requires an array. Thus, the error when you're doing <code>Ubound(_string_)</code> instead of <code>UBound(_array_)</code>.</p>\n\n<p><code>Dim CurrentPathA As Variant</code></p>\n"}, {"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": true, "score": 6, "last_activity_date": 1424880732, "creation_date": 1424880732, "answer_id": 28723942, "question_id": 28722852, "link": "https://stackoverflow.com/questions/28722852/convert-shared-folder-path-to-unc-path/28723942#28723942", "title": "Convert Shared folder path to UNC path", "body": "<p>Or use file system object:</p>\n\n<pre><code>Function GetUNCLateBound(strMappedDrive As String) As String\n\n    Dim objFso  As Object\n    Set objFso = CreateObject(\"Scripting.FileSystemObject\")\n\n    Dim strDrive As String\n    Dim strShare As String\n\n    'Separate the mapped letter from\n    'any following sub-folders\n    strDrive = objFso.GetDriveName(strMappedDrive)\n\n    'find the UNC share name from the mapped letter\n    strShare = objFso.Drives(strDrive &amp; \"\\\").ShareName\n\n    'The Replace function allows for sub-folders\n    'of the mapped drive\n    GetUNCLateBound = Replace(strMappedDrive, strDrive, strShare)\n\n    Set objFso = Nothing 'Destroy the object\n\nEnd Function\n</code></pre>\n\n<p>I just found and modified this, to which the credit is due, to be late-bound:</p>\n\n<p><a href=\"http://pagecommunication.co.uk/2014/07/vba-to-convert-a-mapped-drive-letter-to-unc-path/\" rel=\"noreferrer\">http://pagecommunication.co.uk/2014/07/vba-to-convert-a-mapped-drive-letter-to-unc-path/</a></p>\n"}], "owner": {"reputation": 57, "user_id": 4325170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000860947899/picture?type=large", "display_name": "Milo Kang", "link": "https://stackoverflow.com/users/4325170/milo-kang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4840, "favorite_count": 2, "accepted_answer_id": 28723942, "answer_count": 2, "score": 2, "last_activity_date": 1587078700, "creation_date": 1424877955, "question_id": 28722852, "link": "https://stackoverflow.com/questions/28722852/convert-shared-folder-path-to-unc-path", "title": "Convert Shared folder path to UNC path", "body": "<p>I'm trying to convert current shared folder path to unc path by manipulating current path with computer name. However result in compile error: expected array on the line\"elem = UBound(CurrentPathA)\" in Public Function UNCpath(). Can you guys tell me what seems to be the problem causing this issue? and perhaps share better idea to get unc path?</p>\n\n<pre><code>    Option Explicit\n\n    #If VBA7 Then\n    Private Declare PtrSafe Function fnGetComputerName Lib \"kernel32\" Alias \"GetComputerNameW\" (ByVal lpBuffer As LongPtr, ByRef nSize As Long) As Long\n    #Else\n    Private Declare Function fnGetComputerName Lib \"kernel32\" Alias \"GetComputerNameW\" (ByVal lpBuffer As Long, ByRef nSize As Long) As Long\n    #End If\n\n    Public Function GetComputerName() As String\n    Const MAX_COMPUTERNAME_LENGTH As Long = 31\n\n    Dim buf As String, buf_len As Long\n\n    buf = String$(MAX_COMPUTERNAME_LENGTH + 1, 0)\n    buf_len = Len(buf)\n\n    If (fnGetComputerName(StrPtr(buf), buf_len)) = 0 Then\n    GetComputerName = \"ErrorGettingComputerName\"\n    Else\n    GetComputerName = Left$(buf, buf_len)\n    End If\n    End Function\n\n\n    Public Function UNCpath() As String\n    Dim CompName As String, CurrentPath As String, CurrentPathA As String\n\n    CompName = GetComputerName()\n    CurrentPath = ThisWorkbook.Path\n    CurrentPathA = Split(CurrentPath, \"\\\")\n    elem = UBound(CurrentPathA)\n    CurrentPath = CurrentPathA(elem)\n    UNCpath = \"\\\\\" &amp; CompName &amp; \"\\\" &amp; CurrentPath\n    End Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "copy-paste"], "comments": [{"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 1, "creation_date": 1424877040, "post_id": 28722030, "comment_id": 45731677, "body": "Generally speaking, you will not get someone to write the code for you on this site. Try adding the code that you&#39;ve tried so far and asking specific questions on how to improve it."}, {"owner": {"reputation": 11, "user_id": 4606011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a29b37f24809e48e903edd2d4a0a130?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4606011/chris"}, "reply_to_user": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1424877475, "post_id": 28722030, "comment_id": 45731957, "body": "Hi @TheEngineer so far this is what I&#39;ve got:   Sub Save_Click()  Sheets(&quot;sheet1&quot;).Range(&quot;A2:I2&quot;).Copy   IfSheet1.A2 = &quot;Technical Report&quot;    ActiveSheet.Paste Destination:=Sheets(&quot;TEC&quot;).Range(B, 10)   Sheets(&quot;sheet3&quot;).Range(&quot;B10:I10&quot;).PasteSpecial   End Sub"}, {"owner": {"reputation": 40194, "user_id": 3829407, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/DQPor.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/3829407/matt"}, "edited": false, "score": 0, "creation_date": 1424877689, "post_id": 28722030, "comment_id": 45732123, "body": "Add that code into the question as an edit. Reading code in comments hurts ones head."}, {"owner": {"reputation": 11, "user_id": 4606011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a29b37f24809e48e903edd2d4a0a130?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4606011/chris"}, "reply_to_user": {"reputation": 40194, "user_id": 3829407, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/DQPor.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/3829407/matt"}, "edited": false, "score": 0, "creation_date": 1424878181, "post_id": 28722030, "comment_id": 45732496, "body": "@Matt have added it to the comments. Currently getting an &#39;object required&#39; message."}], "answers": [{"tags": [], "owner": {"reputation": 898, "user_id": 4425957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faea4ee63cb1f9c3e30d3faac96f978b?s=128&d=identicon&r=PG&f=1", "display_name": "Porcupine911", "link": "https://stackoverflow.com/users/4425957/porcupine911"}, "is_accepted": false, "score": 0, "last_activity_date": 1424887905, "last_edit_date": 1424887905, "creation_date": 1424886954, "answer_id": 28726218, "question_id": 28722030, "link": "https://stackoverflow.com/questions/28722030/using-vba-and-a-form-button-to-copy-and-paste-in-excel-2013/28726218#28726218", "title": "Using VBA and a Form button to copy and paste in Excel 2013", "body": "<p>In general I don't like to use copy/paste in VBA but rather assign values to ranges. This way you don't have to move back and forth between sheets. The following will work assuming you have a header row in each worksheet you are moving data to (since rowCount is never returned as zero).</p>\n\n<pre><code>Sub button()\n\n    Dim sheetName As String\n\n    If Sheets(\"Sheet1\").Range(\"A2\") = \"Technical Report\" Then\n    sheetName = \"TEC\"   ' check for type of document and activate relevant document worksheet\n\n    ElseIf Sheets(\"Sheet1\").Range(\"A2\") = \"Engineering Coordination Memo\" Then\n    sheetName = \"ECM\"\n\n    ElseIf Sheets(\"Sheet1\").Range(\"A2\") = \"Critical Design Review\" Then\n    sheetName = \"CDR\"\n\n    ElseIf Sheets(\"Sheet1\").Range(\"A2\") = \"Preliminary Design Review\" Then\n    sheetName = \"PDR\"\n\n    ElseIf Sheets(\"Sheet1\").Range(\"A2\") = \"Qualification by Similarity and Analysis\" Then\n    sheetName = \"QSR\"\n\n    ElseIf Sheets(\"Sheet1\").Range(\"A2\") = \"Qualification by Test Procedure\" Then\n    sheetName = \"QTP\"\n\n    ElseIf Sheets(\"Sheet1\").Range(\"A2\") = \"Reliability Report\" Then\n    sheetName = \"REL\"\n\n    ElseIf Sheets(\"Sheet1\").Range(\"A2\") = \"Specification Compliance Tabulation\" Then\n    sheetName = \"SCT\"\n    End If\n\n    Dim rowCount As Integer\n    Dim sourceCol As Integer\n\n    sourceCol = 2   'column B has a value of 2\n\n    With Sheets(sheetName)\n        rowCount = .Cells(Rows.Count, sourceCol).End(xlUp).Row\n        .Range(\"B\" &amp; rowCount + 1 &amp; \":I\" &amp; rowCount + 1) = Sheets(\"Sheet1\").Range(\"B2:I2\").Value\n    End With\n\n    Sheets(\"Sheet1\").Range(\"A5\") = Sheets(sheetName).Range(\"A\" &amp; rowCount + 1).Value\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4606011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a29b37f24809e48e903edd2d4a0a130?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4606011/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1086, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1424887905, "creation_date": 1424875673, "last_edit_date": 1424884269, "question_id": 28722030, "link": "https://stackoverflow.com/questions/28722030/using-vba-and-a-form-button-to-copy-and-paste-in-excel-2013", "title": "Using VBA and a Form button to copy and paste in Excel 2013", "body": "<p>I hope someone can help me, I need a button in Excel 2013 to carry out the following commands:</p>\n\n<ol>\n<li>In \"Sheet1\" the range \"A2:I2\" is copied.</li>\n<li>The value in A2 is looked up to determine an appropriate worksheet, which is activated and the copied range is pasted into the next available row in the range of B:J. </li>\n<li>Once the data is pasted, the value of the cell in column A in the pasted row of the activated worksheet is returned to the user.</li>\n</ol>\n\n<p>So for example: </p>\n\n<p>When I input into Sheet1.A2 \"technical report\", and click on my button, it would copy Sheet1.A2:I2, then lookup the worksheet called \"TEC\", activate it, and paste the data into TEC.B2:I2. </p>\n\n<p>In my \"TEC\" sheet, I have a pre-existing list of numbers in column A. When a data range is copied into TEC.B5:I5, the value of TEC.A5 is looked up and returned to the user (who is locked out of TEC and only has access to Sheet1).</p>\n\n<p>Importantly, every time this happens, the data must be pasted into a new row, and therefore a new number is returned to the user.</p>\n\n<hr>\n\n<p>I know this is a lot to ask but I have been trying to use bits of code with no results and I am not a very advanced VBA user so any help provided here would be really appreciated!</p>\n\n<p>Code so far is:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub button()\r\n\r\nApplication.CutCopyMode = False\r\n\r\nSheets(\"sheet1\").Range(\"A2:I2\").Copy                          'copy document data\r\nIf Sheets(\"Sheet1\").Range(\"A2\") = \"Technical Report\" Then\r\nSheets(\"TEC\").Activate                                            ' check for type of document and activate relevant document worksheet\r\n                  \r\nElseIf Sheets(\"Sheet1\").Range(\"A2\") = \"Engineering Coordination Memo\" Then\r\nSheets(\"ECM\").Activate\r\n\r\nElseIf Sheets(\"Sheet1\").Range(\"A2\") = \"Critical Design Review\" Then\r\nSheets(\"CDR\").Activate\r\n\r\nElseIf Sheets(\"Sheet1\").Range(\"A2\") = \"Preliminary Design Review\" Then\r\nSheets(\"PDR\").Activate\r\n\r\nElseIf Sheets(\"Sheet1\").Range(\"A2\") = \"Qualification by Similarity and Analysis\" Then\r\nSheets(\"QSR\").Activate\r\n\r\nElseIf Sheets(\"Sheet1\").Range(\"A2\") = \"Qualification by Test Procedure\" Then\r\nSheets(\"QTP\").Activate\r\n\r\nElseIf Sheets(\"Sheet1\").Range(\"A2\") = \"Reliability Report\" Then\r\nSheets(\"REL\").Activate\r\n\r\nElseIf Sheets(\"Sheet1\").Range(\"A2\") = \"Specification Compliance Tabulation\" Then\r\nSheets(\"SCT\").Activate\r\n\r\nEnd If\r\n\r\n\r\n\r\n\r\n Dim sourceCol As Integer, rowCount As Integer, currentRow As Integer   'code to select next empty cell in coumn B\r\n    Dim currentRowValue As String\r\n\r\n    sourceCol = 2   'column B has a value of 2\r\n    rowCount = Cells(Rows.Count, sourceCol).End(xlUp).Row\r\n\r\n    'for every row, find the first blank cell and select it\r\n    For currentRow = 1 To rowCount\r\n        currentRowValue = Cells(currentRow, sourceCol).Value\r\n        If IsEmpty(currentRowValue) Or currentRowValue = \"\" Then\r\n            Cells(currentRow, sourceCol).Select\r\n            Exit For\r\n        End If\r\n    Next\r\n\r\n\r\n\r\nPaste\r\n\r\n ActiveCell.Offset(columnoffset:=-1).Select\r\n Copy\r\n Sheets(\"Sheet1\").Activate\r\n Sheets(\"Sheet1\").Range(\"A5\").Paste\r\n \r\n\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["sql", "vba", "excel", "ado"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 4606087, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204902329857284/picture?type=large", "display_name": "Karol Svat&#253;", "link": "https://stackoverflow.com/users/4606087/karol-svat%c3%bd"}, "edited": false, "score": 0, "creation_date": 1424877188, "post_id": 28722147, "comment_id": 45731773, "body": "thanx for quick reply. I have no problem with mathematical calculation it works well. But if i add a clausule where ....RPJ = (&#39;&quot; &amp; Range(&quot;U12&quot;) &amp; &quot;&#39;) &quot; ODBC excel give me an error: Type mismatch error..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 15, "user_id": 4606087, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204902329857284/picture?type=large", "display_name": "Karol Svat&#253;", "link": "https://stackoverflow.com/users/4606087/karol-svat%c3%bd"}, "edited": false, "score": 0, "creation_date": 1424877508, "post_id": 28722147, "comment_id": 45731981, "body": "@KarolSvat&#253; - What do you get in the <i>Immediate</i> window (<code>Ctrl+G</code>) if you add <code>Debug.print sSQLSting</code> directly under the string construction? Another point may be that Range(&quot;U12&quot;) is NULL so that clause would have to address the possibility with <code>ISNULL(...)</code> or <code>RPJ LIKE &#39;&quot; &amp; Range(&quot;U12&quot;).value &amp; &quot;&#39;;&quot; </code>."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1424875999, "creation_date": 1424875999, "answer_id": 28722147, "question_id": 28721957, "link": "https://stackoverflow.com/questions/28721957/vba-excel-odbc-driver-type-mismatch-error-while-using-sql-query-with-paramete/28722147#28722147", "title": "VBA, Excel ODBC driver - Type Mismatch error while using sql query with parameter from cell", "body": "<p>You may have suffered from a little too much copy and paste. It seems that you are wrapping the `Range(\"U17\") value in ticks while using it within a mathematical calculation.</p>\n\n<pre><code>sSQLSting = \"SELECT SUM(Sicherkoef*LG/KFM/\" &amp; Range(\"U17\").value &amp; \") AS MAXLG From [DATABASE$] WHERE Platzierung ='\" &amp; Range(\"S11\").value &amp; \"' AND RPJ = '\" &amp; Range(\"U12\").value &amp; \"';\" \n</code></pre>\n\n<p>I've also removed some bracketing in the actual text WHERE conditions. They are really only necessary when multiple text values are used with,</p>\n\n<pre><code> ... WHERE [fld1] IN ('abc', 'def')\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 4606087, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204902329857284/picture?type=large", "display_name": "Karol Svat&#253;", "link": "https://stackoverflow.com/users/4606087/karol-svat%c3%bd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 643, "favorite_count": 0, "accepted_answer_id": 28722147, "answer_count": 1, "score": 0, "last_activity_date": 1424875999, "creation_date": 1424875490, "last_edit_date": 1424875697, "question_id": 28721957, "link": "https://stackoverflow.com/questions/28721957/vba-excel-odbc-driver-type-mismatch-error-while-using-sql-query-with-paramete", "title": "VBA, Excel ODBC driver - Type Mismatch error while using sql query with parameter from cell", "body": "<p>I have problem with <code>Type Mismatch error</code> while I do a select with getting parameter from excels cell. I am using excel like a database. \nMy code is:</p>\n\n<pre><code>Sub maxlg()\n\n    Dim sSQLQry As String\n    Dim ReturnArray\n\n    Dim Conn As New ADODB.Connection\n    Dim mrs As New ADODB.Recordset\n\n    Dim DBPath As String, sconnect As String\n\n\n\n    DBPath = ThisWorkbook.FullName\n\n    sconnect = \"Provider=MSDASQL.1;DSN=Excel Files;DBQ=\" &amp; DBPath &amp; \";HDR=Yes';\"\n\n    Conn.Open sconnect\n        sSQLSting = \"SELECT SUM(Sicherkoef*LG/KFM/'\" &amp; Range(\"U17\") &amp; \"') AS MAXLG From [DATABASE$] WHERE Platzierung =('\" &amp; Range(\"S11\") &amp; \"') AND RPJ = ('\" &amp; Range(\"U12\") &amp; \"') \"        \n        mrs.Open sSQLSting, Conn\n            '=&gt;Load the Data into an array\n            'ReturnArray = mrs.GetRows\n                    ''OR''\n            '=&gt;Paste the data into a sheet\n            ActiveSheet.Range(\"V12\").CopyFromRecordset mrs\n            'Close Recordset\n        mrs.Close\n\n\n    Conn.Close\n\nEnd Sub\n</code></pre>\n\n<p>Problem is in getting parameter from here: <code>RPJ = ('\" &amp; Range(\"U12\") &amp; \"') \"</code> in the <code>WHERE</code> clause.</p>\n"}, {"tags": ["ms-access", "ms-word", "vba"], "comments": [{"owner": {"reputation": 12196, "user_id": 4245446, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/CQYen.jpg?s=128&g=1", "display_name": "Weedoze", "link": "https://stackoverflow.com/users/4245446/weedoze"}, "edited": false, "score": 0, "creation_date": 1424876838, "post_id": 28721750, "comment_id": 45731502, "body": "All the copy paste I found were like &quot;Word to another word&quot; or &quot;Word to excel&quot;."}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1424879408, "post_id": 28721750, "comment_id": 45733507, "body": "It would help if you showed the portion of your code where you are accessing the Word document."}], "answers": [{"tags": [], "owner": {"reputation": 12196, "user_id": 4245446, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/CQYen.jpg?s=128&g=1", "display_name": "Weedoze", "link": "https://stackoverflow.com/users/4245446/weedoze"}, "is_accepted": false, "score": 0, "last_activity_date": 1425042704, "creation_date": 1425042704, "answer_id": 28765969, "question_id": 28721750, "link": "https://stackoverflow.com/questions/28721750/access-vba-duplicate-word-table/28765969#28765969", "title": "Access VBA - duplicate Word table", "body": "<p>Actually, I don't think it's possible to copy/paste the table.\nSomeone said that I'll be maybe easier to create a new table in HTML and add it under the first one.</p>\n\n<pre><code>Source = \"&lt;table style=\"\"display:inline;border-collapse:collapse;font-size:1em;width:100%\"\" border=\"\"1\"\"&gt;&lt;tbody&gt;\"\n\n        First line of the table (ID and Title)\n        Source = Source &amp; \"&lt;tr&gt;&lt;td style=\"\"vertical-align:top\"\" class=\"\"ms-rtetablecells\"\"&gt;&lt;div&gt;(Story ID) - Title:&lt;/div&gt;&lt;/td&gt;\"\n        Source = Source &amp; \"&lt;td style=\"\"vertical-align:top\"\" class=\"\"ms-rtetablecells\"\" colspan=2&gt;&lt;div&gt;\" &amp; \"testing cell\" &amp; \"&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;\"\n        Source = Source &amp; \"&lt;/tbody&gt;&lt;/table&gt;\"\n</code></pre>\n\n<p>So now I have my table (still need to fill it but that's ok).</p>\n\n<p>But I still have a problem. How can I paste it just under the template table ?</p>\n"}, {"tags": [], "owner": {"reputation": 12196, "user_id": 4245446, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/CQYen.jpg?s=128&g=1", "display_name": "Weedoze", "link": "https://stackoverflow.com/users/4245446/weedoze"}, "is_accepted": false, "score": 0, "last_activity_date": 1425372790, "creation_date": 1425372790, "answer_id": 28827560, "question_id": 28721750, "link": "https://stackoverflow.com/questions/28721750/access-vba-duplicate-word-table/28827560#28827560", "title": "Access VBA - duplicate Word table", "body": "<p>The only solution I found was to create a new table on html then write this table in a TextFile and finally copy this file in my word template.</p>\n"}], "owner": {"reputation": 12196, "user_id": 4245446, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/CQYen.jpg?s=128&g=1", "display_name": "Weedoze", "link": "https://stackoverflow.com/users/4245446/weedoze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 216, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594641000, "creation_date": 1424875001, "last_edit_date": 1594641000, "question_id": 28721750, "link": "https://stackoverflow.com/questions/28721750/access-vba-duplicate-word-table", "title": "Access VBA - duplicate Word table", "body": "<p>I'm working on an access application.\nAt the end of the application, I need to fill a word template with data from an Access table.</p>\n\n<p>My word template have a table which will be filled with a row from the table.</p>\n\n<p>The problem is that I need a table per row. So I need to duplicate the only table of my word template.</p>\n\n<p>How can I copy the table and paste it juste under ?</p>\n\n<p>Here my current code which can fill the first table</p>\n\n<pre><code>   Dim appWord As Word.Application\nDim appWord2 As Word.Application\nDim doc As Word.Document\nDim template As Word.Document\nDim db As DAO.Database\nDim rs As DAO.Recordset\n\n\nOn Error Resume Next\n\nErr.Clear\n\nSet appWord = CreateObject(\"Word.Application\")\nIf Err.Number &lt;&gt; 0 Then\n\n    'If Word isn't open, create a new instance of Word.\n\n    Set appWord = New Word.Application\nEnd If\n\nSet appWord2 = CreateObject(\"Word.Application\")\nIf Err.Number &lt;&gt; 0 Then\n\n    'If Word isn't open, create a new instance of Word.\n\n    Set appWord2 = New Word.Application\nEnd If\n\n\nSet db = CurrentDb()\n\n'The final selected Building Blocks are in the table ConsultingOffer\nSet rs = db.OpenRecordset(\"ConsultingOffer\")\n\n'Open the Word template\nSet template = appWord.Documents.Open(\"C:\\WordForms\\Template.docx\", , True)\n\n'Open a new Word document which is a copy of the template\nSet doc = appWord2.Documents.Add(template.FullName)\n\n\nDim iTable As Integer\niTable = 2\n\n'Loop on all records to populate the word\nDo While Not rs.EOF\n\n    With doc\n\n        .SelectContentControlsByTitle(\"Title\").Item(1).Range.Text = rs.Fields(\"ModuleName\")\n\n        .Tables(iTable).Cell(1, 2).Range.Text = rs.Fields(\"Comments\")\n\n        .Tables(iTable).Cell(2, 3).Range.Text = rs.Fields(\"DeliverablesDescription\")\n\n        .Tables(iTable).Cell(5, 2).Range.Text = rs.Fields(\"EffortRequired\") &amp; \" man-days\"\n\n        rs.MoveNext\n\n    End With\n\nLoop\n\n'Save our final document as \"Proposal\" + date\ndoc.SaveAs2 (\"C:\\WordForms\\Proposal_\" &amp; Format(Now(), \"ddmmmyyyy_h\\hmm_ss\") &amp; \".docx\")\n\n'Open Word Application with our final document\nappWord2.Visible = True\n\n'Quit the word template\nappWord.Quit True\n\nSet template = Nothing\nSet doc = Nothing\nSet appWord = Nothing\nSet appWord2 = Nothing\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1424875177, "post_id": 28721581, "comment_id": 45730249, "body": "If you hid row 2 and started all of the data input on row 3 with the CF rules&#39; <i>Applies to:</i> starting at row 2, wouldn&#39;t inserting a new row at row 3 (pushing everything down) auto-magically adjust the applies to?"}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 1, "creation_date": 1424875803, "post_id": 28721581, "comment_id": 45730706, "body": "One note and one suggestion. Note that when adding a new CF condition it becomes <code>FormatConditions(1)</code>. You are effectively modifying the same one over and over, I think. I also suggest you look at the the<code>.FormatConditions.ModifyAppliesToRange</code> method. This allows you to adjust the range the FormatCondition applies to. (I suppose that&#39;s obvious!)"}, {"owner": {"reputation": 23, "user_id": 4605857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ho76I.png?s=128&g=1", "display_name": "Mr Boris", "link": "https://stackoverflow.com/users/4605857/mr-boris"}, "reply_to_user": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1424904344, "post_id": 28721581, "comment_id": 45748426, "body": "@ Jeeped Yes your suggestion is in theory great however it would require altering many many lines of code elsewhere so not really an option. @Doug - Each of the CF&#39;s is different formatting and various ranges based on differing conditions and since adding rows etc mucks up the stored CF&#39;s  I thought it would be super easy to clean them out then reapply.   I just CAN&#39;T figure out why the above coding(s) do not work and returns the error?"}, {"owner": {"reputation": 23, "user_id": 4605857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ho76I.png?s=128&g=1", "display_name": "Mr Boris", "link": "https://stackoverflow.com/users/4605857/mr-boris"}, "edited": false, "score": 0, "creation_date": 1424904537, "post_id": 28721581, "comment_id": 45748520, "body": "Anyone have ANY thoughts why it would get to CF item 5 then error? This one has really driven me crazy"}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1424907376, "post_id": 28721581, "comment_id": 45749671, "body": "I understand your problem. Did you understand either of my points? Your response gives no indication whether you do.Good luck!"}, {"owner": {"reputation": 23, "user_id": 4605857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ho76I.png?s=128&g=1", "display_name": "Mr Boris", "link": "https://stackoverflow.com/users/4605857/mr-boris"}, "edited": false, "score": 0, "creation_date": 1424909833, "post_id": 28721581, "comment_id": 45750426, "body": "Hi Doug, yes thanks - sorry for not being clear? - I reviewed ModifyAppliesToRange however this still relies on the CF index and I&#39;m not sure how to implement the command to apply text and background color?  MSDN isn&#39;t very clear on this and I haven&#39;t seen it before.  I  thought my &quot;simple&quot; solution was clever and it should have done the trick."}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1424913832, "post_id": 28721581, "comment_id": 45751559, "body": "Ok. How about fixing the indexes? Again, each time you add a condition it becomes FormatConditionds(1). You keep modifying your first added condition over and over, eight times."}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1424929608, "post_id": 28721581, "comment_id": 45755447, "body": "Okay, I just realized I&#39;m wrong, because I left out a step, which is adding the <code>FormatConditions.SetFirstPriority</code> statement. When you do that, <b>then</b> the last condition you added is #1, making it less painful to track them. Try running the Macro Recorder and adding a couple of conditional formats. When you look at the resulting code you&#39;ll see what I mean. Sorry about that."}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1424930939, "post_id": 28721581, "comment_id": 45755875, "body": "...Or see my comment on BarrowC&#39;s answer."}], "answers": [{"comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 1, "creation_date": 1424930884, "post_id": 28733497, "comment_id": 45755860, "body": "Alternately, you could just do <code>.FormatConditions(.FormatConditions.Count)</code>, which would be flexible. +1"}, {"owner": {"reputation": 23, "user_id": 4605857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ho76I.png?s=128&g=1", "display_name": "Mr Boris", "link": "https://stackoverflow.com/users/4605857/mr-boris"}, "edited": false, "score": 0, "creation_date": 1424941519, "post_id": 28733497, "comment_id": 45760255, "body": "Thanks Doug!  You are correct!  After some guidance on Mr Excel I rearranged the CF&#39;s and put the Global CF&#39;s first THEN the others.  I was also directed to use .FormatConditions.Count instead if the CF Index # - It worked perfect first time thanks to AlphaFrog!   See here: <a href=\"http://www.mrexcel.com/forum/excel-questions/838576-excel-2013-visual-basic-applications-runtime-error-9-when-creating-accessing-%5Bmore-than-4-%5D-conditional-formating-items-help-please.html#post4086241\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>  Many thanks for all your efforts!"}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1425002654, "post_id": 28733497, "comment_id": 45793724, "body": "I&#39;m glad we got there eventually. :)"}], "tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": true, "score": 2, "last_activity_date": 1424917976, "creation_date": 1424917976, "answer_id": 28733497, "question_id": 28721581, "link": "https://stackoverflow.com/questions/28721581/excel-2013-vba-runtime-error-9-when-creating-accessing-more-than-4-cond/28733497#28733497", "title": "Excel 2013 - VBA - Runtime Error 9 when creating &amp; accessing [more than 4!] Conditional Formatting Items", "body": "<p>Each <code>FormatConditions</code> collection relates to the range you specify and not to the whole worksheet. Your conditional format #5 is breaking because it only applies to part of column F and there have only been two previous CFs defined which include that part of column F. If you changed your reference into the collection from <code>.FormatConditions(5)</code> to <code>.FormatConditions(3)</code> then it should work</p>\n\n<p>CFs #1 and #2 only applied to part of column G whereas CFs #3 and #4 applied to parts of columns A:I. So when you try to add CF #5 to part of column F, there are only two previous CFs in the collection. To fix this, CF #5 should use index 3, CF #6 should use index 4, CF #7 should use index 3 and CF #8 should use index 3</p>\n"}], "owner": {"reputation": 23, "user_id": 4605857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ho76I.png?s=128&g=1", "display_name": "Mr Boris", "link": "https://stackoverflow.com/users/4605857/mr-boris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "accepted_answer_id": 28733497, "answer_count": 1, "score": 2, "last_activity_date": 1483358359, "creation_date": 1424874516, "last_edit_date": 1483358359, "question_id": 28721581, "link": "https://stackoverflow.com/questions/28721581/excel-2013-vba-runtime-error-9-when-creating-accessing-more-than-4-cond", "title": "Excel 2013 - VBA - Runtime Error 9 when creating &amp; accessing [more than 4!] Conditional Formatting Items", "body": "<p>I have searched and searched and not come up with a solution and cannot explain what is happening.</p>\n\n<p>Basically I have a worksheet in Excel 2013 that has a selection of invoicing data on each row.  The worksheet has 8 conditional formats on it at various ranges.   </p>\n\n<p>As rows get inserted [at the top of the range] in to the range using this approach:</p>\n\n<pre><code>    Manager.Select\n    Manager.Range(\"headerRow\").Offset(1, 0).Range(\"a1:M1\").Select\n    Selection.Copy\n    Selection.Insert Shift:=xlDown\n</code></pre>\n\n<p>the conditional formatting gets convoluted, messy, fragmented and eventually after a few months is such a mess it seems stops working correctly.</p>\n\n<p>After wasting several hours on various approaches my solution is simple. (SURE!)  When a row gets inserted at the top of the range then I want to clear and reset the 8 x conditional formats using VBA - in essence perform a quick clean-up - by deleting all of the the conditional formatting on the worksheet and reapplying 8 clean conditional formats with the correct ranges and formatting for the entire range (top to bottom). </p>\n\n<p>The problem is that after adding and formatting 4 conditional formats using .FormatConditions.Add and .FormatConditions(x) it throws a Subscript Error when I attempt to format the Item 5 Font or background color.  I have searched for an explanation and understand that basically I can add as many CF's as I like so what is going on?  </p>\n\n<p>The crazy thing is that it appeared to work correctly once then never again? </p>\n\n<p>Here is my test code and it all works well until formula 5!</p>\n\n\n\n<pre><code>Sub CFReset()\n\n' Get top and bottom of Invoices\nTopRow = (Manager.Range(\"headerRow\").Row) + 1\nBottomRow = ActiveSheet.UsedRange.Rows.Count\n\n' Clear All Current Conditional Formatting on Manager Sheet between Invoice Top Row and Invocie Bottom Row\nRange(\"A\" &amp; TopRow &amp; \":L\" &amp; BottomRow).FormatConditions.Delete\n\n'CD Formula 1 - 'Formula:  =AND(I17=\"Paid\",G17&lt;&gt;0) - 'Colour: Red on White Background 'Applies to: =$G$17:$G$49\nWith ActiveSheet.Range(\"$G$\" &amp; TopRow &amp; \":$G$\" &amp; BottomRow)\n    .FormatConditions.Add Type:=xlExpression, Formula1:=\"=AND(I\" &amp; TopRow &amp; \"=\"\"Paid\"\",G\" &amp; TopRow &amp; \"&lt;&gt;0)\"\n    .FormatConditions(1).Font.ColorIndex = 3 ' Red\nEnd With\n\n'CD Formula 2 - '=AND(I17=\"Partial\",F17&lt;&gt;0) 'Colour: Red on white background 'Applies to: =$G$17:$G$49\nWith ActiveSheet.Range(\"$G$\" &amp; TopRow &amp; \":$G$\" &amp; BottomRow)\n    .FormatConditions.Add Type:=xlExpression, Formula1:=\"=AND(I\" &amp; TopRow &amp; \"=\"\"Partial\"\",F\" &amp; TopRow &amp; \"&lt;&gt;0)\"\n    .FormatConditions(2).Font.ColorIndex = 3 ' Red\nEnd With\n\n'CD Formula 3 '=OR($I17=\"Void\") - Text Colour RGB: 255,179,179 'Applies to: =$A$17:$I$49\nWith ActiveSheet.Range(\"$A$\" &amp; TopRow &amp; \":$I$\" &amp; BottomRow)\n    .FormatConditions.Add Type:=xlExpression, Formula1:=\"=OR($I\" &amp; TopRow &amp; \"=\"\"Void\"\")\"\n    .FormatConditions(3).Font.Color = RGB(255, 179, 179) ' Pinkish\nEnd With\n\n'CD Formula 4 - '=OR($I17=\"Paid\",$I17=\"Closed\") - Text Colour: RGB 192, 192, 192 'Applies to: =$A$17:$I$49\nWith ActiveSheet.Range(\"$A$\" &amp; TopRow &amp; \":$I$\" &amp; BottomRow)\n    .FormatConditions.Add Type:=xlExpression, Formula1:=\"=OR($I\" &amp; TopRow &amp; \"=\"\"Paid\"\",$I\" &amp; TopRow &amp; \"=\"\"Closed\"\")\"\n    .FormatConditions(4).Font.Color = RGB(192, 192, 192) ' Gray\nEnd With\n\n'CD Formula 5 '=AND(I17=\"Paid\",G17&lt;&gt;0) 'Color: RGB 0, 0, 0 'Black 'Background Colour:RGB: 255,255,204 ' Light Yellow 'Applies to: =$F$17:$F$49\nWith ActiveSheet.Range(\"$F$\" &amp; TopRow &amp; \":$F$\" &amp; BottomRow)\n    .FormatConditions.Add Type:=xlExpression, Formula1:=\"=AND(I\" &amp; TopRow &amp; \"=\"\"Paid\"\",G\" &amp; TopRow &amp; \"&lt;&gt;0)\"\n    .FormatConditions(5).Font.ColorIndex = 1 ' Black\n    .FormatConditions(5).Interior.Color = RGB(255, 255, 204) ' Light Yellow\nEnd With\n\n'CD Formula 6  '=AND(I17=\"Partial\",F17=0) 'Color: RGB 0, 0, 0 'Black 'Background Colour:RGB: 255,255,204 ' Light Yellow 'Applies to: =$F$17:$F$49\nWith ActiveSheet.Range(\"$F$\" &amp; TopRow &amp; \":$F$\" &amp; BottomRow)\n    .FormatConditions.Add Type:=xlExpression, Formula1:=\"=AND(I\" &amp; TopRow &amp; \"=\"\"Partial\"\",F\" &amp; TopRow &amp; \"=0)\"\n    .FormatConditions(6).Font.ColorIndex = 1 ' Black\n    .FormatConditions(6).Interior.Color = RGB(255, 255, 204) ' Light Yellow\nEnd With\n\n\n'CD Formula 7 '=AND(G17&gt;0,AND(D17&lt;TODAY(),D17&lt;&gt;\"\")) 'Colour: Red 'Background Colour:RGB: 255,255,204 ' Light Yellow 'Applies to: =$D$17:$D$49\nWith ActiveSheet.Range(\"$D$\" &amp; TopRow &amp; \":$D$\" &amp; BottomRow)\n    .FormatConditions.Add Type:=xlExpression, Formula1:=\"=AND(G\" &amp; TopRow &amp; \"&gt;0,AND(D\" &amp; TopRow &amp; \"&lt;TODAY(),D\" &amp; TopRow &amp; \"&lt;&gt;\"\"\"\"))\"\n    .FormatConditions(7).Font.ColorIndex = 3 ' Red\n    .FormatConditions(7).Interior.Color = RGB(255, 255, 204) ' Light Yellow\nEnd With\n\n\n'CD Formula 8 '=COUNTIF($B:$B,B17)&gt;1 'Color: RGB 255,255,255 -'White 'Background Colour: Red ' Rgb 255 ' Applies to: =$B$17:$B$49\nWith ActiveSheet.Range(\"$B$\" &amp; TopRow &amp; \":$B$\" &amp; BottomRow)\n    .FormatConditions.Add Type:=xlExpression, Formula1:=\"=COUNTIF($B:$B,B\" &amp; TopRow &amp; \")&gt;1\"\n    .FormatConditions(8).Font.ColorIndex = 2 ' White\n    .FormatConditions(8).Interior.ColorIndex = 3 ' Red\nEnd With\n\n\nEnd Sub\n</code></pre>\n\n\n\n<p>If I rem out the formatting of font and background the CF rule is added to the worksheet but clearly this is a waste of time without formatting! :) </p>\n\n<p>I also attempted a different way of formatting the font color Background color however selecting a Conditional Formatting item higher than 4 returns the same error.</p>\n\n<pre><code>'Attempt2\nWith ActiveSheet.Range(\"$A$\" &amp; TopRow &amp; \":$I$\" &amp; BottomRow).FormatConditions\n    .Add Type:=xlExpression, Formula1:=\"=OR($I\" &amp; TopRow &amp; \"=\"\"Void\"\")\"\n    With .Item(3).Font\n        .Color = RGB(255, 179, 179) ' Pinkish\n    End With\nEnd With\n</code></pre>\n\n<p>I have included my remarks which are my notes for each of the formats - these are actually from my original CF's.</p>\n"}, {"tags": ["sql", "sql-server", "vba", "stored-procedures"], "comments": [{"owner": {"reputation": 22892, "user_id": 1745672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NYFQg.jpg?s=128&g=1", "display_name": "Mihai", "link": "https://stackoverflow.com/users/1745672/mihai"}, "edited": false, "score": 0, "creation_date": 1424874351, "post_id": 28721461, "comment_id": 45729642, "body": "Post the full error.Does it compile in sql server?"}, {"owner": {"reputation": 4677, "user_id": 519348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TIdre.jpg?s=128&g=1", "display_name": "TZHX", "link": "https://stackoverflow.com/users/519348/tzhx"}, "edited": false, "score": 1, "creation_date": 1424874379, "post_id": 28721461, "comment_id": 45729659, "body": "&quot;It is throwing an error when called&quot; -- <i>what</i> error?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1424874400, "post_id": 28721461, "comment_id": 45729674, "body": "It compiles in sql server and comes back with <code>Invalid object name CSLL.Users</code> error in vba"}, {"owner": {"reputation": 4677, "user_id": 519348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TIdre.jpg?s=128&g=1", "display_name": "TZHX", "link": "https://stackoverflow.com/users/519348/tzhx"}, "edited": false, "score": 1, "creation_date": 1424874466, "post_id": 28721461, "comment_id": 45729723, "body": "You&#39;ve enclosed <code>[CSLL.Users]</code> as a single object name. You want <code>[CSLL].[Users]</code>. You also probably want <code>BEGIN</code> and <code>END</code> around your <code>IF</code>s."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1424874477, "post_id": 28721461, "comment_id": 45729734, "body": "Just seen it - I&#39;ve got the brackets in the wrong place I&#39;ve got <code>[CSLL.Users]</code> and should be <code>[CSLL].[Users]</code>"}, {"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1424874489, "post_id": 28721461, "comment_id": 45729745, "body": "It&#39;s going to be  <code>INSERT INTO [CSLL.Users]</code>."}, {"owner": {"reputation": 368, "user_id": 2402694, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/22d4d4cd8011111a87399fa473a23b57?s=128&d=identicon&r=PG", "display_name": "Jeff Beese", "link": "https://stackoverflow.com/users/2402694/jeff-beese"}, "edited": false, "score": 0, "creation_date": 1424874498, "post_id": 28721461, "comment_id": 45729752, "body": "Have you tried using a <code>MERGE</code> statement?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1424874671, "post_id": 28721461, "comment_id": 45729867, "body": "Yes as TZHX pointed out. TZHX - if you want to add it as an answer I&#39;ll accept it. Thanks guys"}], "answers": [{"tags": [], "owner": {"reputation": 1399, "user_id": 4584335, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q8zHtvjpvi4/AAAAAAAAAAI/AAAAAAAADEo/Mb1fVAnabIE/photo.jpg?sz=128", "display_name": "Rubik", "link": "https://stackoverflow.com/users/4584335/rubik"}, "is_accepted": false, "score": 1, "last_activity_date": 1424875689, "last_edit_date": 1424875689, "creation_date": 1424874509, "answer_id": 28721579, "question_id": 28721461, "link": "https://stackoverflow.com/questions/28721461/sql-stored-procedure-to-check-if-exists-then-add-if-not-to-update/28721579#28721579", "title": "SQL Stored Procedure to Check if exists then add. If not to update", "body": "<p>This seems to be caused by a typo:</p>\n\n<pre><code>-- you currently use: [CSLL.Users]\nIF NOT EXISTS(SELECT 1 FROM [CSLL].[Users] WHERE [Alias] = @Name) \n    INSERT INTO [CSLL.Users] ([Alias], [Country], [Role]) \n    VALUES (@Name, 'UK', 'Employee')\n</code></pre>\n\n<p>Instead try:</p>\n\n<pre><code>-- use: [CSLL].[Users]\nIF NOT EXISTS(SELECT 1 FROM [CSLL].[Users] Where [Alias] = @Name) \n    INSERT INTO [CSLL].[Users] ([Alias], [Country], [Role]) \n    VALUES (@Name, 'UK', 'Employee')\n</code></pre>\n"}], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 520, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424875689, "creation_date": 1424874216, "question_id": 28721461, "link": "https://stackoverflow.com/questions/28721461/sql-stored-procedure-to-check-if-exists-then-add-if-not-to-update", "title": "SQL Stored Procedure to Check if exists then add. If not to update", "body": "<p>I'm trying to write a stored procedure to populate a user table (Named CSLL.Users)</p>\n\n<p>The procedure is given a series of user details when triggered.</p>\n\n<p>It then checks to see if the Alias exists in the table. If not it adds the alias. The sp then goes on to populate the rest of the columns (using the update command)</p>\n\n<p>It is called using vba, but is throwing an error when it is called. I think it is with the first <code>IF NOT EXISTS</code> statement but can't see where I'd possibly going wrong.</p>\n\n<pre><code>ALTER procedure [CSLL].[UploadUser]\n    -- Add the parameters for the stored procedure here\n    @Name varchar(max) = NULL,\n    @FirstName varchar(max) = NULL,\n    @LastName varchar(max) = NULL,\n    @Email varchar(max) = NULL,\n    @Telephone varchar(max) = NULL,\n    @Division varchar(max) = NULL,\n    @Manager varchar(max) = NULL,\n    @DirectReports varchar(max) = NULL,\n    @Title varchar(max) = NULL\nAS\n\nSET NOCOUNT ON\n\nIF NOT EXISTS(SELECT 1 FROM [CSLL].[Users] Where [Alias] = @Name) INSERT INTO [CSLL.Users] ([Alias], [Country], [Role]) VALUES (@Name, 'UK', 'Employee')\n\nUPDATE [CSLL].[Users]\n    SET FirstName = @FirstName,\n        LastName = @LastName,\n        Email = @Email,\n        Telephone = @Telephone,\n        Division = @Division,\n        Manager = @Manager,\n        DirectReports = @DirectReports,\n        Title = @Title\nWHERE Alias = @Name\n\nDECLARE @Pos int\nDECLARE @DR varchar(max)\n\nSET @DirectReports = @DirectReports + ','\n\nWHILE LEN(@DirectReports) &gt; 0\n    BEGIN\n\n    SET @Pos = CHARINDEX(',', @DirectReports, 1)\n\n    SET @DR = (CASE @Pos\n        WHEN 0 THEN RTRIM(LTRIM(@DirectReports))\n        ELSE RTRIM(LTRIM(LEFT(@DirectReports, @Pos - 1)))\n    END)\n\n    IF NOT EXISTS(SELECT 1 FROM [CSLL].[Users] where [Alias] = @DR) INSERT INTO [CSLL].[Users] ([Alias], [Country], [Role]) VALUES (@DR, 'UK', 'Employee')\n\n    SET @DirectReports = RIGHT(@DirectReports, LEN(@DirectReports) - @Pos)\n    END\n</code></pre>\n"}, {"tags": ["ms-access", "textbox", "vba", "command"], "comments": [{"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1424873830, "post_id": 28721275, "comment_id": 45729305, "body": "If you bind a table to the form and fields to the controls, MS Access will automatically save the data, stopping it saving is more difficult."}, {"owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1424874403, "post_id": 28721275, "comment_id": 45729675, "body": "Well I have half of my form boud to a table that pulls historical data and the other half is when the user enters if they agree with the historical data and the comman button transfers their data to a different table"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1424874554, "post_id": 28721275, "comment_id": 45729795, "body": "Then just move to a new record and write the data from form 1 to form 2."}], "answers": [{"tags": [], "owner": {"reputation": 77, "user_id": 4389518, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8398fb66030276c0d4498a544944b844?s=128&d=identicon&r=PG&f=1", "display_name": "rmh", "link": "https://stackoverflow.com/users/4389518/rmh"}, "is_accepted": false, "score": 0, "last_activity_date": 1426297297, "creation_date": 1426297297, "answer_id": 29044523, "question_id": 28721275, "link": "https://stackoverflow.com/questions/28721275/access-2013-retrieving-data-from-textboxes-on-a-form-and-inserting-them-into-a-n/29044523#29044523", "title": "Access 2013 retrieving data from textboxes on a form and inserting them into a new table based on the click on a command button", "body": "<p>I'm not quite sure what you are going for, but if I understand correctly you want to verify the information is correct and make an entry in another table with any changes. </p>\n\n<p>I think the best way would be to create your table UserData with columns:\nRelatedID (Number), ManHours2 , AMTs2, Duration2, ToolsRequired2</p>\n\n<p>Then create a query that contains the original fields ie (ManHours AMTs Duration adn ToolsRequired) and the fields from the new table.</p>\n\n<p>You will then add a relationship between the two tables by connecting the Primary Key (ID) from the original table and drag it to the (RelatedID) from the new table</p>\n\n<p>It will be a LEFT join ie ALL of the original table and only the UserData table entires that match. *VERY IMPORTANT</p>\n\n<p>Then make a form based on the query and delete the RelatedID from the FORM only. Now you will have a form that will automatically create a new record and link it to the original. Just make sure to disable to fields that are linked to the original table so the values in the original table cannot be changed.</p>\n\n<p>Let me know if you have any questions about this.</p>\n\n<p>Thank you,</p>\n"}], "owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 255, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594645256, "creation_date": 1424873710, "last_edit_date": 1594645256, "question_id": 28721275, "link": "https://stackoverflow.com/questions/28721275/access-2013-retrieving-data-from-textboxes-on-a-form-and-inserting-them-into-a-n", "title": "Access 2013 retrieving data from textboxes on a form and inserting them into a new table based on the click on a command button", "body": "<p>Im looking for some help in creating a form than when data is entered into text boxes by the user and then submitted by the click of a command button populates a table as a new record.</p>\n\n<p>My table im looking to put the data in is UserData and the textboxes I plan on using are txtManHours2 , txtAMTs2, txtDuration2, and txtToolsRequired2. I do not have these textboxes bound they are all unbounded. Should I bound them to the table? </p>\n\n<p>Thank You!</p>\n"}, {"tags": ["excel", "vba", "for-loop", "split"], "comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 1, "creation_date": 1424905149, "post_id": 28720911, "comment_id": 45748794, "body": "Haven&#39;t we already answered this? <a href=\"http://stackoverflow.com/questions/28686052/excel-macro-if-the-final-characters-of-a-cell-is-something-then-cut-them-and/28687998#28687998\" title=\"excel macro if the final characters of a cell is something then cut them and\">stackoverflow.com/questions/28686052/&hellip;</a> You already asked how to get the left side, then in the linked article you asked for the right side."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 3261463, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f8083e88084b64cdb75107018284a754?s=128&d=identicon&r=PG&f=1", "display_name": "digitaura", "link": "https://stackoverflow.com/users/3261463/digitaura"}, "edited": false, "score": 0, "creation_date": 1424903106, "post_id": 28721029, "comment_id": 45747815, "body": "Thanks...I get a type mismatch error however, on the InStr line."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 1, "creation_date": 1424908753, "post_id": 28721029, "comment_id": 45750116, "body": "Perhaps change it to this: If InStr(1,Cells(i, 1).text, &quot; XX &quot;)&gt;0 Then"}], "tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": false, "score": 0, "last_activity_date": 1424961291, "last_edit_date": 1424961291, "creation_date": 1424873095, "answer_id": 28721029, "question_id": 28720911, "link": "https://stackoverflow.com/questions/28720911/excel-macro-if-the-characters-xx-are-in-the-middle-of-a-string-then-split-t/28721029#28721029", "title": "Excel Macro: If the characters &quot; XX &quot; are in the middle of a string then split the string at that point", "body": "<pre><code>Sub splitit()\nDim i As Long, l As Long,\nDim x as variant\nl = Cells(Rows.Count, 1).End(xlUp).Row\nFor i = l To 1 Step -1\n    If InStr(Cells(i, 1).Value, celltxt, \"XX\") &lt;&gt; 0 Then\n      x = split(cells(i,1),\"XX\")\n          cells(i,4) = x(0)\n          cells(i,6) = \" XX \" &amp; x(1)\n    End if\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 3261463, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f8083e88084b64cdb75107018284a754?s=128&d=identicon&r=PG&f=1", "display_name": "digitaura", "link": "https://stackoverflow.com/users/3261463/digitaura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1424961291, "creation_date": 1424872762, "last_edit_date": 1424904868, "question_id": 28720911, "link": "https://stackoverflow.com/questions/28720911/excel-macro-if-the-characters-xx-are-in-the-middle-of-a-string-then-split-t", "title": "Excel Macro: If the characters &quot; XX &quot; are in the middle of a string then split the string at that point", "body": "<p>I'm trying to divide a column into two columns based on finding a specific characters in the string.</p>\n\n<p>Specifically, if ColumnA contains the string \" XX \" then, copy all before \" XX \" in ColumnD, and copy \" XX \" &amp; everything after to ColumnF.</p>\n\n<pre><code>Sub splitit()\nDim i As Long, l As Long\nl = Cells(Rows.Count, 1).End(xlUp).Row\nFor i = l To 1 Step -1\n    If InStr(Cells(i, 1).Value, celltxt, \" XX \") Then\n      Cells(i, 4).Value = Left(Cells(i, 1).Value, Find(\" XX \", Cells(i, 1).Value) - 1)\n      Cells(i, 6).Value = \" XX \" &amp; Mid(Cells(i, 1).Value, Find(\" XX \", Cells(i, 1).Value) + 1, Len(Cells(i, 1).Value))\n    End if\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["regex", "vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 0, "last_activity_date": 1424874937, "creation_date": 1424874937, "answer_id": 28721728, "question_id": 28720806, "link": "https://stackoverflow.com/questions/28720806/find-2-or-more-occurences-of-a-pattern-submit-report-or-submitted-report-usi/28721728#28721728", "title": "Find 2 or more occurences of a pattern &quot;submit report&quot; or &quot;submitted report&quot; using vba regex", "body": "<p>I am not sure how to achieve this with RegEx and the following is surely not the best way to tackle the problem. But it certainly does the trick. Hope this helps:</p>\n\n<pre><code>Option Compare Text\n\nPublic Sub SearchForMultipleOccurencesOfReport()\nDim bolFoundSomehing As Boolean\nDim strLargeReport As String\nDim lngCounter As Long\nDim lngLooper As Long\nDim z As Variant\n\nintCounter = 0\nstrLargeReport = \"This is the text of your large report containing all these searched terms like submit report, submitting rep, or resubmitting report.\"\n\nFor lngLooper = 1 To 100000\n    bolFoundSomehing = False\n    z = InStr(1, strLargeReport, \"submit report\")\n    If IsNumeric(z) And z &gt; 0 Then\n        lngCounter = lngCounter + 1\n        bolFoundSomehing = True\n        strLargeReport = Mid(strLargeReport, InStr(1, strLargeReport, \"submit report\") + Len(\"submit report\"))\n    End If\n    z = InStr(1, strLargeReport, \"submitted report\")\n    If IsNumeric(z) And z &gt; 0 Then\n        lngCounter = lngCounter + 1\n        bolFoundSomehing = True\n        strLargeReport = Mid(strLargeReport, InStr(1, strLargeReport, \"submitted report\") + Len(\"submitted report\"))\n    End If\n    z = InStr(1, strLargeReport, \"submitting rep\")\n    If IsNumeric(z) And z &gt; 0 Then\n        lngCounter = lngCounter + 1\n        bolFoundSomehing = True\n        strLargeReport = Mid(strLargeReport, InStr(1, strLargeReport, \"submitting rep\") + Len(\"submitting rep\"))\n    End If\n    z = InStr(1, strLargeReport, \"resubmitted rep\")\n    If IsNumeric(z) And z &gt; 0 Then\n        lngCounter = lngCounter + 1\n        bolFoundSomehing = True\n        strLargeReport = Mid(strLargeReport, InStr(1, strLargeReport, \"resubmitted rep\") + Len(\"resubmitted rep\"))\n    End If\n    z = InStr(1, strLargeReport, \"resubmitting report\")\n    If IsNumeric(z) And z &gt; 0 Then\n        lngCounter = lngCounter + 1\n        bolFoundSomehing = True\n        strLargeReport = Mid(strLargeReport, InStr(1, strLargeReport, \"resubmitting report\") + Len(\"resubmitting report\"))\n    End If\n    If bolFoundSomehing = False Then Exit For\nNext lngLooper\n\nMsgBox \"Found \" &amp; lngCounter &amp; \" occurences of the searched terms in the report.\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 131, "user_id": 4303571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/260ef203055794f885bef4c596c9d9c0?s=128&d=identicon&r=PG&f=1", "display_name": "mroemore", "link": "https://stackoverflow.com/users/4303571/mroemore"}, "is_accepted": false, "score": 0, "last_activity_date": 1424876297, "creation_date": 1424876297, "answer_id": 28722254, "question_id": 28720806, "link": "https://stackoverflow.com/questions/28720806/find-2-or-more-occurences-of-a-pattern-submit-report-or-submitted-report-usi/28722254#28722254", "title": "Find 2 or more occurences of a pattern &quot;submit report&quot; or &quot;submitted report&quot; using vba regex", "body": "<p>I'm not familiar with VBA at all, or the specifics of how VBA does RegEx, but this RegEx should match all of the terms you mentioned in your question:</p>\n\n<pre><code>/(?:re)?submit(?:ted|ting)? rep(?:ort)?/i\n</code></pre>\n\n<p>This will match <strong>one</strong> instance of any of the strings you mentioned. You could use RegEx subroutines or recursion to match multiple instances of this pattern, but I don't know wether VBA supports these. Here's an ugly but functional solution:</p>\n\n<pre><code>/(?:re)?submit(?:ted|ting)? rep(?:ort)?.+?(?:re)?submit(?:ted|ting)? rep(?:ort)?/i\n</code></pre>\n\n<p>This is just the same RegEx above repeated twice, with a <code>.+?</code> between them. This will cause the RegEx to match any and all characters between the first and second instances of the phrase you're looking for. If there's a match, it means that there are <strong>at least</strong> two instances of that phrase in the text.</p>\n"}], "owner": {"reputation": 11, "user_id": 4163344, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-R_PzATe-I2k/AAAAAAAAAAI/AAAAAAAABq8/H1b39kxO6xo/photo.jpg?sz=128", "display_name": "Riquet", "link": "https://stackoverflow.com/users/4163344/riquet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1424876297, "creation_date": 1424872470, "question_id": 28720806, "link": "https://stackoverflow.com/questions/28720806/find-2-or-more-occurences-of-a-pattern-submit-report-or-submitted-report-usi", "title": "Find 2 or more occurences of a pattern &quot;submit report&quot; or &quot;submitted report&quot; using vba regex", "body": "<p>I am new to vba regex and I need to find the fields in a very large report where the text in a text field or text cell contains 3 or more occurrences of the following pattern:</p>\n\n<p>\"submit report\" or \"submitted report\" or \"submitting rep\" or \"resubmitted rep\" or  \"resubmitting report\" using vba regex, case insensitive.</p>\n\n<p>I have not been able to figure out the regex and the condition count so it could be adjusted to 2, 3 or more.  </p>\n\n<p>Any guidance will be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 3, "creation_date": 1424871915, "post_id": 28720122, "comment_id": 45727971, "body": "What have you tried so far? Post some code and let us know what you are unable to figure out."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1424880519, "post_id": 28720122, "comment_id": 45734401, "body": "HTML can contain multiple elements attributed with a certain <i>class</i> but is only supposed to have one element per unique <i>id</i>. Your statement <i>&quot;...get some class id on this page ...&quot;</i> seems to mash-up the two attributes making it unclear what you are asking for."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4605795, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vSNPs-0zHFE/AAAAAAAAAAI/AAAAAAAAC5Q/4kVq19d3bUw/photo.jpg?sz=128", "display_name": "Arthur Brunoro Meira", "link": "https://stackoverflow.com/users/4605795/arthur-brunoro-meira"}, "edited": false, "score": 0, "creation_date": 1424880838, "post_id": 28722233, "comment_id": 45734648, "body": "When you say..&quot;Then you just&quot;.. What means...I am not expert on VBA."}, {"owner": {"reputation": 7418, "user_id": 2983632, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IvTM4.png?s=128&g=1", "display_name": "ttaaoossuu", "link": "https://stackoverflow.com/users/2983632/ttaaoossuu"}, "reply_to_user": {"reputation": 11, "user_id": 4605795, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vSNPs-0zHFE/AAAAAAAAAAI/AAAAAAAAC5Q/4kVq19d3bUw/photo.jpg?sz=128", "display_name": "Arthur Brunoro Meira", "link": "https://stackoverflow.com/users/4605795/arthur-brunoro-meira"}, "edited": false, "score": 0, "creation_date": 1424881704, "post_id": 28722233, "comment_id": 45735290, "body": "Then you just paste this formula into a cell! :D"}], "tags": [], "owner": {"reputation": 7418, "user_id": 2983632, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IvTM4.png?s=128&g=1", "display_name": "ttaaoossuu", "link": "https://stackoverflow.com/users/2983632/ttaaoossuu"}, "is_accepted": false, "score": 0, "last_activity_date": 1424881841, "last_edit_date": 1424881841, "creation_date": 1424876228, "answer_id": 28722233, "question_id": 28720122, "link": "https://stackoverflow.com/questions/28720122/how-get-id-class-using-vba-on-excel/28722233#28722233", "title": "How get id class using VBA on EXCEL?", "body": "<p>I think this should get you enough:</p>\n\n<pre><code>Public Function GetHttpResponse(URL As String) As String\n    Dim Request As Object, Result As String\n    Set Request = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n    Request.Open \"GET\", URL\n    Request.Send\n    Result = Request.ResponseText\n    Set Request = Nothing\n    GetHttpResponse = Result\nEnd Function\n\nPublic Function GetNodeByPath(ResponseText As String, Path As String) As String\n    Dim Result As String, DOM As Object\n    Set DOM = CreateObject(\"Msxml2.DOMDocument.6.0\")\n    DOM.async = False\n    DOM.validateOnParse = False\n    DOM.LoadXML ResponseText\n    DOM.setProperty \"SelectionLanguage\", \"XPath\"\n    Dim NodeList As Object\n    Set NodeList = DOM.SelectNodes(Path)\n    Dim Node As Object\n    Result = \"\"\n    For Each Node In NodeList\n        Result = Node.Text\n        Exit For\n    Next\n    Set DOM = Nothing\n    Set NodeList = Nothing\n    Set Node = Nothing\n    GetNodeByPath = Result\nEnd Function\n</code></pre>\n\n<p>Then you just:</p>\n\n<pre><code>=GetNodeByPath(GetHttpResponse(\"http://website.com/\"),\"/html/body/div[2]\")\n</code></pre>\n\n<p>Which means: retrieve page from <code>website.com</code> and get the contents of the second <code>div</code> tag inside <code>body</code> tag inside <code>html</code> tag.</p>\n"}], "owner": {"reputation": 11, "user_id": 4605795, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vSNPs-0zHFE/AAAAAAAAAAI/AAAAAAAAC5Q/4kVq19d3bUw/photo.jpg?sz=128", "display_name": "Arthur Brunoro Meira", "link": "https://stackoverflow.com/users/4605795/arthur-brunoro-meira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1099, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1424881841, "creation_date": 1424870539, "last_edit_date": 1424880203, "question_id": 28720122, "link": "https://stackoverflow.com/questions/28720122/how-get-id-class-using-vba-on-excel", "title": "How get id class using VBA on EXCEL?", "body": "<p>I am looking to coding some VBA..This VBA will need get some value from cell that is an URL.\nThe VBA must be open this URL and get some class id on this page and returns the values.</p>\n\n<p>Is it Simple?</p>\n\n<p>Example:\n\n1- A1 = www.google.com</p>\n\n<p>2- the VBA will open A1 values</p>\n\n<p>3- the VBA will get some class ID on this page.</p>\n\n<p>4- the VBA will returns on A2 this values.</p>\n\n<p><strong>Code from OP's answer post</strong></p>\n\n<pre><code>Sub FetchData()\n    With ActiveSheet.QueryTables.Add(Connection:= _\n        \"URL;http://www.google.com\", Destination:=Range( _\n        \"$A$1\"))\n        .Name = \"67083361_zpid\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .BackgroundQuery = True\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .WebSelectionType = xlEntirePage\n        .WebFormatting = xlWebFormattingNone\n        .WebPreFormattedTextToColumns = True\n        .WebConsecutiveDelimitersAsOne = True\n        .WebSingleBlockTextImport = False\n        .WebDisableDateRecognition = False\n        .WebDisableRedirections = False\n        .Refresh BackgroundQuery:=False\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1424878958, "post_id": 28723080, "comment_id": 45733136, "body": "Do While Not IsEmpty(~~~~) will continue the loop until it finds an empty cell, which appears to be the OP&#39;s intent. I&#39;m not sure what you mean when you are saying it does this while the cells are empty"}], "tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": false, "score": 0, "last_activity_date": 1424888514, "last_edit_date": 1424888514, "creation_date": 1424878571, "answer_id": 28723080, "question_id": 28720007, "link": "https://stackoverflow.com/questions/28720007/calculate-future-service-dates/28723080#28723080", "title": "Calculate future service dates", "body": "<p>x and z are counters by one.\nI would recommend using</p>\n\n<pre><code>For x = 1 To 21\nNext\n</code></pre>\n\n<p>instead. This doesn't seem to be your problem though.\n<strike>The</p>\n\n<pre><code>Do While Not IsEmpty(~~~~~~)\n</code></pre>\n\n<p>actually means do while the cells are empty. </strike></p>\n"}], "owner": {"reputation": 11, "user_id": 4605533, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vxlwIMbISPU/AAAAAAAAAAI/AAAAAAAAAIU/9-Q1dP0NLFE/photo.jpg?sz=128", "display_name": "Mike &#39;PrimalRat&#39; Ranner", "link": "https://stackoverflow.com/users/4605533/mike-primalrat-ranner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1455154746, "creation_date": 1424870205, "last_edit_date": 1455154746, "question_id": 28720007, "link": "https://stackoverflow.com/questions/28720007/calculate-future-service-dates", "title": "Calculate future service dates", "body": "<p>I have been working on a VBA Macro that takes vehicle service and MOT dates from a data entry page inserts them into a new line on a different sheet and calculates future service dates on a set interval time I have entered. This all works fine its just the next part I am having trouble with. I then need to take these dates and add them into a schedule. </p>\n\n<p>I have tried setting up nested <code>Do While</code> loops but I can't get it working. I've made a simplified example of what I am trying to do (link below). </p>\n\n<p>Red is the manually entered data. Yellow is the 1st macro product with the new line containing copied dates with orange calculated future dates. Green is the new line inserted (where I have got to) but I need the symbols inserted into that new row.</p>\n\n<p><img src=\"https://i.stack.imgur.com/V5pYb.png\" alt=\"enter image description here\"></p>\n\n<p>This is the basic code I have have for entering the service dates into the schedule from the database. </p>\n\n<pre><code>x = 1\ny = x + 1\nz = 16\n'my data starts in C6R16 and I have 5 dates (hence to 21)\nDo While z &lt; 21\n'Have a shedule for the whole year so 53.\n    Do While x &lt; 53\n'If functions to locate which week the event is located\n    If Worksheets(\"Dates Input\").Cells(6, z).Value &gt; Worksheets(\"Maintenance Shedule\").Cells(3, x) Then\n        If Worksheets(\"Dates Input\").Cells(6, z).Value &lt; Worksheets(\"Maintenance Shedule\").Cells(3, y) Then\n'Quick location of the lowest empy cell. The others will be full of data from prevous entries.\n                Range(\"F9:F10\").Select\n                Do While Not IsEmpty(ActiveCell)\n                    ActiveCell.Offset(1, 0).Select\n                Loop\n'Move my active cell to the correct place\n            ActiveCell.Offset(-1, (3 + x)).Select\n            ActiveCell = \"/\"\n        Else\n        End If\n'Move to the next set of dates in shedule\n    x = x + 1\n    Loop\n'move to next service date\nz = z + 1\nLoop\n</code></pre>\n\n<p>On top of this, I need to add (I assume) an <code>If</code> statement to check if there is an MOT (M) and service (/) in the same week so that one does not delete the other.</p>\n\n<p>Any pointers and help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1424871395, "post_id": 28719845, "comment_id": 45727594, "body": "What is the error?  On what line does it occur?  What is the nature of lookup_value and the data in table_array?  In your first try, if you want to write the <b>results</b> of the formula, you need to <code>Evaluate</code>.  If you want to use the formula, you should use the <code>.Formula</code> property."}], "answers": [{"comments": [{"owner": {"reputation": 1103, "user_id": 3621724, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a3cff6bae9bfef786c85a49a8c425a5a?s=128&d=identicon&r=PG&f=1", "display_name": "tadalendas", "link": "https://stackoverflow.com/users/3621724/tadalendas"}, "edited": false, "score": 0, "creation_date": 1424872109, "post_id": 28719991, "comment_id": 45728109, "body": "Thank you! i used the second one. For the first one I assumed that it has to look as if I type it in Excel sheet, since there semicolon is required I used the semicolon in VBA as well."}, {"owner": {"reputation": 1103, "user_id": 3621724, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a3cff6bae9bfef786c85a49a8c425a5a?s=128&d=identicon&r=PG&f=1", "display_name": "tadalendas", "link": "https://stackoverflow.com/users/3621724/tadalendas"}, "edited": false, "score": 0, "creation_date": 1424872292, "post_id": 28719991, "comment_id": 45728220, "body": "How can I skip the run-time error if the values do not match?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 1103, "user_id": 3621724, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a3cff6bae9bfef786c85a49a8c425a5a?s=128&d=identicon&r=PG&f=1", "display_name": "tadalendas", "link": "https://stackoverflow.com/users/3621724/tadalendas"}, "edited": false, "score": 0, "creation_date": 1424872902, "post_id": 28719991, "comment_id": 45728642, "body": "It depends what you want to happen but basically you either need an <code>On Error</code> statement  of some sort, or you can use <code>Application.HLookup</code> instead which will return an error value rather than raising a run-time error. You can assign the result of the function to a <code>Variant</code> variable and then test that using <code>IsError</code> and decide what to do."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1424870839, "last_edit_date": 1424870839, "creation_date": 1424870149, "answer_id": 28719991, "question_id": 28719845, "link": "https://stackoverflow.com/questions/28719845/excel-vba-hlookup-function/28719991#28719991", "title": "Excel VBA hlookup function", "body": "<p>For your first one, you need to use US regional settings, so a comma separator, and you should really enclose the sheet names in single quotes in case they contain spaces or look like special names (e.g. dates):</p>\n\n<pre><code>lookupValue = \"'\" &amp; Worksheets(1).Name &amp; \"'!A1\"\ntableArray = \"'\" &amp; Worksheets(3).Name &amp; \"'!$A$1:$\" &amp; Col_letter &amp; \"$1\"\nWorksheets(\"Comparison\").Cells(1, 2).Formula = \"=HLookup(\" &amp; lookupValue _\n&amp; \",\" &amp; tableArray &amp; \",1,FALSE)\"\n</code></pre>\n\n<p>and for the second you have to use a range object for the table argument:</p>\n\n<pre><code>tda = Worksheets(1).Cells(1, 1).Value ' I also tried using tda without .Value\nSet Table = Worksheets(3).Range(Worksheets(3).Cells(1, 1), Worksheets(3).Cells(1, Col_letter))\nWorksheets(\"Comparison\").Cells(1, 2).Value = WorksheetFunction. _\nHLookup(tda, Table, 1, False)\n</code></pre>\n\n<p>I have assumed Table is declared as Variant, Object or Range.</p>\n\n<p>Note you will still get a run-time error if there is no match for your lookup value.</p>\n"}, {"tags": [], "owner": {"reputation": 1851, "user_id": 2789717, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/XdQcC.jpg?s=128&g=1", "display_name": "Pedro Braz", "link": "https://stackoverflow.com/users/2789717/pedro-braz"}, "is_accepted": false, "score": 1, "last_activity_date": 1424871340, "last_edit_date": 1424871340, "creation_date": 1424870668, "answer_id": 28720175, "question_id": 28719845, "link": "https://stackoverflow.com/questions/28719845/excel-vba-hlookup-function/28720175#28720175", "title": "Excel VBA hlookup function", "body": "<p>what you're doing there usually works, which is creating a string with the function you want to call and inputting it.</p>\n\n<p>I don't think that's the safest way, since it would not work if you run that macro from an Excel with a different language.</p>\n\n<p>the proper way to call an Excel function from VBA call is for example:</p>\n\n<pre><code>cells(1,2) = Application.WorksheetFunction.VLookup(123,Range(\"A1:C100\"),3,FALSE)\n</code></pre>\n\n<p>anyway if you'd rather use this string approach the problem in the first try is that </p>\n\n<pre><code>\"=HLookup(\" &amp; lookupValue _\n    &amp; \";\" &amp; tableArray &amp; \";1;FALSE)\"\n</code></pre>\n\n<p>results in the string:</p>\n\n<pre><code>=HLookup(Sheet1!A1;Sheet3!$A$1:$B$1;1;FALSE)\n</code></pre>\n\n<p>note that you're using semicolons  where you're supposed to use commmas.</p>\n\n<p>the problem in the second try is that the <code>.Range</code> property takes a string as input, so you cant <code>Range(Cells(1,1))</code> you should do something like <code>.Range(\"A1:A3\")</code></p>\n\n<p>hope it helps !</p>\n"}], "owner": {"reputation": 1103, "user_id": 3621724, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a3cff6bae9bfef786c85a49a8c425a5a?s=128&d=identicon&r=PG&f=1", "display_name": "tadalendas", "link": "https://stackoverflow.com/users/3621724/tadalendas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12236, "favorite_count": 0, "accepted_answer_id": 28719991, "answer_count": 2, "score": -2, "last_activity_date": 1424871340, "creation_date": 1424869701, "question_id": 28719845, "link": "https://stackoverflow.com/questions/28719845/excel-vba-hlookup-function", "title": "Excel VBA hlookup function", "body": "<p>I am trying to use the excel VBA HLookup function. I have tried it two ways and both produce error. Could anyone explain me what is that I am doing wrong?</p>\n\n<p>First try:</p>\n\n<pre><code>    lookupValue = Worksheets(1).Name &amp; \"!A1\"\n    tableArray = Worksheets(3).Name &amp; \"!$A$1:$\" &amp; Col_letter &amp; \"$1\"\n    Worksheets(\"Comparison\").Cells(1, 2).Value = \"=HLookup(\" &amp; lookupValue _\n    &amp; \";\" &amp; tableArray &amp; \";1;FALSE)\"\n</code></pre>\n\n<p>Second try:</p>\n\n<pre><code>    tda = Worksheets(1).Cells(1, 1).Value ' I also tried using tda without .Value\n    Table = Worksheets(3).Range(Cells(1, 1))\n    Worksheets(\"Comparison\").Cells(1, 2).Value = WorksheetFunction. _\n    HLookup(tda, Table, 1, False)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1424869240, "post_id": 28718991, "comment_id": 45726133, "body": "try to open both workbook in one application, not two as you do now. Assuming that your macro run for activeworkbook then the other logic should be ok."}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1424869373, "post_id": 28718991, "comment_id": 45726223, "body": "one more thing- you would need to call macro name including workbook name where it is placed in this way: <code>x1App.Run &quot;test.xlsm!MyMacro&quot;</code>"}, {"owner": {"reputation": 41, "user_id": 2996131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783122336b379e41cd9b62346d06bdf0?s=128&d=identicon&r=PG&f=1", "display_name": "HovoK", "link": "https://stackoverflow.com/users/2996131/hovok"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1424875439, "post_id": 28718991, "comment_id": 45730472, "body": "That works for me, thanks a lot!!!!"}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 2996131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783122336b379e41cd9b62346d06bdf0?s=128&d=identicon&r=PG&f=1", "display_name": "HovoK", "link": "https://stackoverflow.com/users/2996131/hovok"}, "is_accepted": true, "score": 0, "last_activity_date": 1425016920, "creation_date": 1425016920, "answer_id": 28758558, "question_id": 28718991, "link": "https://stackoverflow.com/questions/28718991/running-excel-macro-for-excel-books-that-does-not-contain-that-macro/28758558#28758558", "title": "Running excel macro for excel books that does not contain that macro", "body": "<p>Here is the working example of the code</p>\n\n<pre><code>Option Explicit\n\nDim x1App, x1Book, x2App, x2Book\ndim fso\ndim curDir\nset fso = CreateObject(\"Scripting.FileSystemObject\")\ncurDir = fso.GetAbsolutePathName(\".\")\nset fso = nothing\n\nSet x1App = CreateObject(\"Excel.Application\")\nSet x1Book = x1App.Workbooks.Open(curDir &amp; \"\\macro_for_creating_charts\")\nSet x2Book = x1App.Workbooks.Open(curDir &amp; \"\\agent_perf.csv\")\n'x1App.visible = true\nx1App.Run \"macro_for_creating_charts.xlsm!Macro4\"\nx1App.ActiveWorkbook.Close(False)\nx1App.Quit\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 2996131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783122336b379e41cd9b62346d06bdf0?s=128&d=identicon&r=PG&f=1", "display_name": "HovoK", "link": "https://stackoverflow.com/users/2996131/hovok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 28758558, "answer_count": 1, "score": 0, "last_activity_date": 1425016920, "creation_date": 1424867088, "last_edit_date": 1531161705, "question_id": 28718991, "link": "https://stackoverflow.com/questions/28718991/running-excel-macro-for-excel-books-that-does-not-contain-that-macro", "title": "Running excel macro for excel books that does not contain that macro", "body": "<p>I need to run a macro that is not present in my excel document, it is recorded in another excel doc or in another file if it is possible.</p>\n\n<p>I have tried to open two excel books, first that contains that macro and the second one that does not contain and when I run that macro it says that my excel book does not contain that macro.</p>\n\n<pre><code>Option Explicit\nDim x1App, x1Book, x2App, x2Book\ndim fso\ndim curDir\nset fso = CreateObject(\"Scripting.FileSystemObject\")\ncurDir = fso.GetAbsolutePathName(\".\")\nset fso = nothing\n\nSet x1App = CreateObject(\"Excel.Application\")\nSet x2App = CreateObject(\"Excel.Application\")\n'~~&gt; Change Path here\nSet x1Book = x1App.Workbooks.Open(curDir &amp; \"\\test.xlsm\", 0, true)\nSet x2Book = x2App.Workbooks.Open(curDir &amp; \"\\perf.csv\", 0, true)\nx1App.visible = true\nx2App.visible = true\nx1App.Run \"MyMacro\"\nx2App.Run \"MyMacro\"\nxlBook.Close\nxlApp.Quit\n\nSet xlBook = Nothing\nSet xlApp = Nothing\n\nWScript.Echo \"Finished.\"\n</code></pre>\n\n<p>So here my macro is in test.xlsm excel file and i want to run it on perf.csv. </p>\n\n<p>In this way I can't do it. Is there any other way to do this kind of staff?</p>\n\n<p>I have also exported the macro to the file than copied the content of the macro to my *.vbs script to run it directly from their and also no success. </p>\n"}, {"tags": ["vba", "excel", "listbox", "checkedlistbox"], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 2016172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wOVAn.jpg?s=128&g=1", "display_name": "Fractional", "link": "https://stackoverflow.com/users/2016172/fractional"}, "edited": false, "score": 0, "creation_date": 1424869790, "post_id": 28719627, "comment_id": 45726500, "body": "Sorry for being utterly dim, but where is this output &quot;printed&quot; to and how do I use it in a formula? My familiarity with VBA is very small."}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "reply_to_user": {"reputation": 153, "user_id": 2016172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wOVAn.jpg?s=128&g=1", "display_name": "Fractional", "link": "https://stackoverflow.com/users/2016172/fractional"}, "edited": false, "score": 0, "creation_date": 1424869906, "post_id": 28719627, "comment_id": 45726579, "body": "it returns <code>true</code> or <code>false</code> in Immediate window in vba editor. How to use it in cells? instead of <code>Debug.Print</code> use <code>Cells(i +1, &quot;A&quot;) = .selected(i)</code> to get results from A1 down direction."}, {"owner": {"reputation": 153, "user_id": 2016172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wOVAn.jpg?s=128&g=1", "display_name": "Fractional", "link": "https://stackoverflow.com/users/2016172/fractional"}, "edited": false, "score": 0, "creation_date": 1424873465, "post_id": 28719627, "comment_id": 45729060, "body": "Okay, I think that gives me something to work with. It&#39;s quite indirect but I can probably figure out how to get a list/range of Countries."}], "tags": [], "owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "is_accepted": false, "score": 2, "last_activity_date": 1424869001, "creation_date": 1424869001, "answer_id": 28719627, "question_id": 28718460, "link": "https://stackoverflow.com/questions/28718460/output-from-an-excel-listbox-multiselect-as-a-column-or-range/28719627#28719627", "title": "Output from an Excel Listbox (multiselect) as a column or Range", "body": "<p>Try something like this (here with <code>Listbox.Change</code> event):</p>\n\n<pre><code>Private Sub ListBox1_Change()\n\n    With ListBox1\n\n        Dim i As Byte\n        For i = 0 To .ListCount - 1\n            Debug.Print .Selected(i)\n        Next i\n\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 2016172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wOVAn.jpg?s=128&g=1", "display_name": "Fractional", "link": "https://stackoverflow.com/users/2016172/fractional"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3465, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424869001, "creation_date": 1424865504, "last_edit_date": 1424867858, "question_id": 28718460, "link": "https://stackoverflow.com/questions/28718460/output-from-an-excel-listbox-multiselect-as-a-column-or-range", "title": "Output from an Excel Listbox (multiselect) as a column or Range", "body": "<p>I have a summary report refers to raw data for multiple countries on another sheet. The user can choose which Country's data to show by using a simple validated cell dropdown.</p>\n\n<p><img src=\"https://i.stack.imgur.com/iokCb.png\" alt=\"generic country dropdown singleselect\"></p>\n\n<p>However this is single select, and I wish to make this list multiselect. It seems that I should use a Listbox (ActiveX) to do this. I have created a Listbox with the range of Countries, however I can't find how to use the countries which are selected.</p>\n\n<p><img src=\"https://i.stack.imgur.com/7Cq8s.png\" alt=\"multiselect listbox\"></p>\n\n<p>I'd like to output the selected Countries into a column in a sheet, or directly into a Range to be referred to by formula. Is this possible, or is there a better method?</p>\n"}, {"tags": ["excel", "actuate", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2221, "user_id": 1505990, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FIKz5.jpg?s=128&g=1", "display_name": "Jon Carlstedt", "link": "https://stackoverflow.com/users/1505990/jon-carlstedt"}, "is_accepted": true, "score": 0, "last_activity_date": 1424865392, "creation_date": 1424865392, "answer_id": 28718414, "question_id": 28717980, "link": "https://stackoverflow.com/questions/28717980/copying-actuate-report-parameters-names-to-excel/28718414#28718414", "title": "Copying Actuate Report Parameters Names To Excel", "body": "<p>This question does not show any effort of solving the problem yourself, and no example code.\nAlso, it does not specify how the .bas file looks.\nPlease try to write more constructive questions in the future, or you will experience lots of downvotes.\nHowever, here is something that might get you going in the right direction.</p>\n\n<p>If you record a macro and then go to data and import from text you will get some code that looks like this:</p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n'\n\n'\n    With ActiveSheet.QueryTables.Add(Connection:= _\n        \"TEXT;C:\\directory\\filename.bas\" _\n        , Destination:=Range(\"$A$1\"))\n        .Name = \"filename\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 65001\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = False\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = True\n        .TextFileSpaceDelimiter = False\n        .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, _\n        1, 1, 1, 1)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n    End With\nEnd Sub\n</code></pre>\n\n<p>You should then be able to use that code to build what you want.</p>\n\n<p>This code imports a file as text, it delimits with \",\" and then place it in A1.</p>\n"}], "owner": {"reputation": 51, "user_id": 4253015, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/100001396921626/picture?type=large", "display_name": "Kaushal", "link": "https://stackoverflow.com/users/4253015/kaushal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 28718414, "answer_count": 1, "score": -1, "last_activity_date": 1425334646, "creation_date": 1424864069, "last_edit_date": 1531164843, "question_id": 28717980, "link": "https://stackoverflow.com/questions/28717980/copying-actuate-report-parameters-names-to-excel", "title": "Copying Actuate Report Parameters Names To Excel", "body": "<p>I have some actuate reports whose parameter names needs to copy to excel or text file. The Parameters of an actuate report resides in a <code>.bas</code> file.</p>\n\n<p>Can someone help with an Excel macro code to open the <code>.bas</code> file and copy the parameter names to an excel sheet.</p>\n\n<p>I am very new to macros so any help will be highly appreciated. Thanks</p>\n"}, {"tags": ["vba", "ms-access", "object", "adodb"], "comments": [{"owner": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "edited": false, "score": 0, "creation_date": 1424863032, "post_id": 28717534, "comment_id": 45722324, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/tyd4tfw8%28v=vs.90%29.aspx\" rel=\"nofollow noreferrer\">This</a> set of articles will help you get a clear understanding of using objects in VBA."}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "reply_to_user": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "edited": false, "score": 0, "creation_date": 1424863388, "post_id": 28717534, "comment_id": 45722518, "body": "@Jens: the link you gave is for VB.NET, which is not the same as VBA, though there is some degree of overlap."}], "answers": [{"tags": [], "owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "is_accepted": true, "score": 2, "last_activity_date": 1424863231, "last_edit_date": 1424863231, "creation_date": 1424862920, "answer_id": 28717574, "question_id": 28717534, "link": "https://stackoverflow.com/questions/28717534/assigning-object-reference-to-a-variant-long/28717574#28717574", "title": "Assigning object reference to a Variant/Long", "body": "<p>The <code>Long</code> data type can hold a 32-bit integer. It isn't an object reference, so don't use <code>Set</code>. </p>\n\n<pre><code>Dim userId As Long\nuserId = RS.Fields(0).value\n</code></pre>\n\n<p>For more on what is and isn't an object, see <a href=\"https://msdn.microsoft.com/en-us/library/aa263420%28v=vs.60%29.aspx\" rel=\"nofollow\">Data Type Summary for VBA</a>.</p>\n"}], "owner": {"reputation": 245, "user_id": 3485995, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/dvfnX.png?s=128&g=1", "display_name": "Alaanor", "link": "https://stackoverflow.com/users/3485995/alaanor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 28717574, "answer_count": 1, "score": 1, "last_activity_date": 1424863321, "creation_date": 1424862785, "last_edit_date": 1424863321, "question_id": 28717534, "link": "https://stackoverflow.com/questions/28717534/assigning-object-reference-to-a-variant-long", "title": "Assigning object reference to a Variant/Long", "body": "<p>I have sometime some error like this: \"Required object\" (translate from my french error.)</p>\n\n<p>But I can't understand what is exactly an object in VBA (with Access, if it's change something).</p>\n\n<p>For example, I have do an SQL SELECT with ADODB.recordset and I see in the spy of the Access IDE for VBA, the value is an \"Variant/Long\". Okay, I create an Long variable and I set the value of query in the long variable.\n<code>Set userId = RS.Fields(0).value</code>\nBut it's doesn't work...</p>\n\n<p>At the start, I have think: the object is like an array. But the array already exist in VBA.</p>\n\n<p>Someone can help me ?</p>\n"}, {"tags": ["excel", "boolean", "vba"], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1424863103, "creation_date": 1424863103, "answer_id": 28717650, "question_id": 28717177, "link": "https://stackoverflow.com/questions/28717177/why-does-excel-macro-show-boolean-as-1/28717650#28717650", "title": "why does excel/macro show boolean as -1?", "body": "<p>Consider:</p>\n\n<pre><code>Function VBARound(N As Double, Optional NumPlaces As Long = 0) As Boolean\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 4602978, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06ccabb17964c3edc8c659dc2bde8b16?s=128&d=identicon&r=PG&f=1", "display_name": "job vink", "link": "https://stackoverflow.com/users/4602978/job-vink"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 28717650, "answer_count": 1, "score": 0, "last_activity_date": 1424863592, "creation_date": 1424861822, "last_edit_date": 1531161705, "question_id": 28717177, "link": "https://stackoverflow.com/questions/28717177/why-does-excel-macro-show-boolean-as-1", "title": "why does excel/macro show boolean as -1?", "body": "<p>Excel has started showing boolean answers form my macro function as a number</p>\n\n<p><code>TRUE</code> as <code>-1</code>,\n<code>FALSE</code> as <code>0</code></p>\n\n<p>yesterday it showed then as <code>TRUE</code>  or <code>FALSE</code>.</p>\n\n<p>Does Anybody know how to change that back? I have no idea what I changed.</p>\n\n<p>Code:</p>\n\n<pre><code>Function VBARound(N As Double, Optional NumPlaces As Long = 0) As Double\n    'VBARound = Round(N, NumPlaces)\n    VBARound = True\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 301, "user_id": 2269532, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c585e45a3f4d8ac541d4a07eb462bbf9?s=128&d=identicon&r=PG", "display_name": "Mike Eburne", "link": "https://stackoverflow.com/users/2269532/mike-eburne"}, "edited": false, "score": 0, "creation_date": 1424859123, "post_id": 28716230, "comment_id": 45720056, "body": "Sorry to all... The title should have been VBA not VBD...."}, {"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1424860268, "post_id": 28716230, "comment_id": 45720709, "body": "That&#39;ll be difficult to achieve. I had the same problem with my co-workers. You can basically create a specific button to do the macro saves as for that matter."}], "answers": [{"comments": [{"owner": {"reputation": 301, "user_id": 2269532, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c585e45a3f4d8ac541d4a07eb462bbf9?s=128&d=identicon&r=PG", "display_name": "Mike Eburne", "link": "https://stackoverflow.com/users/2269532/mike-eburne"}, "edited": false, "score": 0, "creation_date": 1424957261, "post_id": 28718737, "comment_id": 45770037, "body": "Thanks MikeD. We eventually worked this out with something very similar to what you have shown. Greatly appreciated the help."}], "tags": [], "owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "is_accepted": false, "score": 2, "last_activity_date": 1424866618, "last_edit_date": 1424866618, "creation_date": 1424866275, "answer_id": 28718737, "question_id": 28716230, "link": "https://stackoverflow.com/questions/28716230/excel-vba-prevent-saveas-xlsx/28718737#28718737", "title": "Excel VBA prevent SaveAs .xlsx", "body": "<p>You may replace the standard FileSave dialog by your own. Unfortunately you cannot manipulate the Filter list to remove anything but \".xlsm\" and \".xls\" but you can catch the selected file name and act accordingly ...</p>\n\n<p>suggestion:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\nDim FD As FileDialog, FTyp As Long\n\n    MsgBox \"Sub Workbook_BeforeSave\"\n\n    ' this Sub will never save, we save through the Dialog box below\n    Cancel = True\n\n    ' reference a SaveAs Dialog\n    Set FD = Application.FileDialog(msoFileDialogSaveAs)\n    FD.Show\n\n    If FD.SelectedItems.Count = 0 Then\n        MsgBox \"Nothing chosen\"\n        Exit Sub\n    Else\n        ' check for proper extension\n        If Right(FD.SelectedItems(1), 3) = \"xls\" Or Right(FD.SelectedItems(1), 4) = \"xlsm\" Then\n            MsgBox \"saving as \" &amp; FD.SelectedItems(1)\n\n            If Right(FD.SelectedItems(1), 3) = \"xls\" Then\n                ' different enum before Excel 2007\n                If Val(Application.Version) &lt; 12 Then\n                    FTyp = -4143           ' xls pre-2007\n                Else\n                    FTyp = 56              ' xls post-2007\n                End If\n            Else\n                FTyp = 52                  ' xlsm post-2007\n            End If\n\n            ' we don't want to come here again, so temporarily switch off event handling\n            Application.EnableEvents = False\n            Me.SaveAs FD.SelectedItems(1), FTyp\n            Application.EnableEvents = True\n\n        Else\n            MsgBox \"selected wrong file format ... not saving\"\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 301, "user_id": 2269532, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/c585e45a3f4d8ac541d4a07eb462bbf9?s=128&d=identicon&r=PG", "display_name": "Mike Eburne", "link": "https://stackoverflow.com/users/2269532/mike-eburne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1280, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424866618, "creation_date": 1424859071, "last_edit_date": 1531161705, "question_id": 28716230, "link": "https://stackoverflow.com/questions/28716230/excel-vba-prevent-saveas-xlsx", "title": "Excel VBA prevent SaveAs .xlsx", "body": "<p>I produce a suite of Scorecard calculators with macros. I distribute the workbooks as .xls files. However, sometimes a user will save the workbook as an .xlsx file and thereby removing all the VBA code and macros. The built-in functions obviously no longer work.</p>\n\n<p>Is there any way I can make the standard Excel SaveAs function exclude .xlsx as an option?</p>\n"}, {"tags": ["vba", "replace", "ms-word", "find", "wildcard"], "comments": [{"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 2, "creation_date": 1424858735, "post_id": 28716028, "comment_id": 45719823, "body": "Can you provide the text on which the <code>.find</code> is applied?"}, {"owner": {"reputation": 1688, "user_id": 1079093, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/14f127499bff3cdd17bb0204e55948ac?s=128&d=identicon&r=PG", "display_name": "Hauns TM", "link": "https://stackoverflow.com/users/1079093/hauns-tm"}, "edited": false, "score": 1, "creation_date": 1424858747, "post_id": 28716028, "comment_id": 45719828, "body": "Why are you using <code>[^$]</code>? What do you expect to find?"}, {"owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "edited": false, "score": 1, "creation_date": 1424858789, "post_id": 28716028, "comment_id": 45719850, "body": "What is your error on execute?"}, {"owner": {"reputation": 113, "user_id": 4571581, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-mELqc8FkCPQ/AAAAAAAAAAI/AAAAAAAAAAs/xTHvAmk3khg/photo.jpg?sz=128", "display_name": "Rub&#233;n P S", "link": "https://stackoverflow.com/users/4571581/rub%c3%a9n-p-s"}, "edited": false, "score": 0, "creation_date": 1424878149, "post_id": 28716028, "comment_id": 45732471, "body": "Sorry I forgot it. I&#39;m trying to find splitted words within a OCRed document.   For example, If I find a paragraph with :  &quot;blablablabl-   ablabla.&quot; I wnat this macro to repair it. Sometimes &quot;-&quot; is followed by linefeed,space+linefeed,space+paragraph   And error throwed is 5692"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 4571581, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-mELqc8FkCPQ/AAAAAAAAAAI/AAAAAAAAAAs/xTHvAmk3khg/photo.jpg?sz=128", "display_name": "Rub&#233;n P S", "link": "https://stackoverflow.com/users/4571581/rub%c3%a9n-p-s"}, "edited": false, "score": 0, "creation_date": 1424873008, "post_id": 28719629, "comment_id": 45728733, "body": "Works OK, thank you, but I&#39;d prefer to do it without regexp object."}, {"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "reply_to_user": {"reputation": 113, "user_id": 4571581, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-mELqc8FkCPQ/AAAAAAAAAAI/AAAAAAAAAAs/xTHvAmk3khg/photo.jpg?sz=128", "display_name": "Rub&#233;n P S", "link": "https://stackoverflow.com/users/4571581/rub%c3%a9n-p-s"}, "edited": false, "score": 0, "creation_date": 1424873252, "post_id": 28719629, "comment_id": 45728906, "body": "You are welcome, I am sorry i am not familiar with Word&#39;s Find/Replace. So I am afraid I won&#39;t be able to help you much. Can I ask why you don&#39;t want to use RegEx?"}, {"owner": {"reputation": 113, "user_id": 4571581, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-mELqc8FkCPQ/AAAAAAAAAAI/AAAAAAAAAAs/xTHvAmk3khg/photo.jpg?sz=128", "display_name": "Rub&#233;n P S", "link": "https://stackoverflow.com/users/4571581/rub%c3%a9n-p-s"}, "edited": false, "score": 0, "creation_date": 1424877988, "post_id": 28719629, "comment_id": 45732342, "body": "Because as you with find/replace, I&#39;m not familiar with regex and I&#39;d like to understand what the hell I am doing XDDD. I&#39;m a total newbie with vba macros"}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": true, "score": 0, "last_activity_date": 1424958777, "last_edit_date": 1424958777, "creation_date": 1424869006, "answer_id": 28719629, "question_id": 28716028, "link": "https://stackoverflow.com/questions/28716028/modified-vba-word-find-inside-a-word-and-left-the-word/28719629#28719629", "title": "---MODIFIED--- VBA Word - Find &quot;- &quot; inside a word and left the word", "body": "<p>You can do this with RegEx. Using the following recursive procedure</p>\n\n<pre><code>Sub ReplaceHyphens() ' Make sure you add a reference to Microsoft VBScript Regular Expressions 5.5\n    Dim rex As New RegExp\n    rex.Pattern = \"(.)-(.)\"\n    rex.Global = False\n    Dim str As String: str = ActiveDocument.Content\n    Dim mtch As Object\n    If rex.Test(str) Then\n        ActiveDocument.Content = rex.Replace(ActiveDocument.Content, rex.Execute(str)(0).SubMatches(0) &amp; ActiveDocument.Content, rex.Execute(str)(0).SubMatches(1))\n        ReplaceHyphens\n    Else\n        Exit Sub\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 113, "user_id": 4571581, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-mELqc8FkCPQ/AAAAAAAAAAI/AAAAAAAAAAs/xTHvAmk3khg/photo.jpg?sz=128", "display_name": "Rub&#233;n P S", "link": "https://stackoverflow.com/users/4571581/rub%c3%a9n-p-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1424953463, "last_edit_date": 1424953463, "creation_date": 1424950202, "answer_id": 28741271, "question_id": 28716028, "link": "https://stackoverflow.com/questions/28716028/modified-vba-word-find-inside-a-word-and-left-the-word/28741271#28741271", "title": "---MODIFIED--- VBA Word - Find &quot;- &quot; inside a word and left the word", "body": "<p><strong>SOLVED</strong>:</p>\n\n<pre><code>Sub FindDash()\nWith Selection.Find\n                .Text = \"([0-9A-z])- ([0-9A-z])\"\n                .Replacement.Text = \"\\1\\2\"\n                .Forward = True\n                .Wrap = wdFindContinue\n                .MatchWildcards = True\n                .Execute Replace:=wdReplaceAll\n            End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 4571581, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-mELqc8FkCPQ/AAAAAAAAAAI/AAAAAAAAAAs/xTHvAmk3khg/photo.jpg?sz=128", "display_name": "Rub&#233;n P S", "link": "https://stackoverflow.com/users/4571581/rub%c3%a9n-p-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 28719629, "answer_count": 2, "score": 0, "last_activity_date": 1425674643, "creation_date": 1424858476, "last_edit_date": 1425674643, "question_id": 28716028, "link": "https://stackoverflow.com/questions/28716028/modified-vba-word-find-inside-a-word-and-left-the-word", "title": "---MODIFIED--- VBA Word - Find &quot;- &quot; inside a word and left the word", "body": "<p>OLD\n-----How could I do that? I've tried with this, but it crashes ant execute</p>\n\n<pre><code>Sub Sintesis()\n\n            With ActiveDocument.Content.Find\n                .Text = \"([^$])\" &amp; \"-^p\" \n                .Replacement.Text = \"\\1\" \n                .MatchWildcards = True\n                .Execute Replace:=wdReplaceAll\n\n\n            End With\nEnd sub\n</code></pre>\n\n<p>Some help? Before anyone tell me this, I prefer to do this with find/replace instead of Regex\nEND OLD-----</p>\n\n<p>I've seen I was solving partially my real problem. What I really need is to remove the \"- \"string between the two halfs of a word. I can't replace \"-\" by \"\" because my text have some correct strings like the first one.</p>\n\n<p>I actually need to conver this:\n\"Blablablab- labla\"\nInto:\n\"Blablablablabla\"</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4604922, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7a74f1e2566312ce1704ec5896f050de?s=128&d=identicon&r=PG&f=1", "display_name": "Siti", "link": "https://stackoverflow.com/users/4604922/siti"}, "edited": false, "score": 0, "creation_date": 1425004892, "post_id": 28715971, "comment_id": 45794220, "body": "Hi, thanks for the reply. However, its now showing runtime error 424. Object required at this section Loop Until Payment_Center = &quot; &quot;"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "reply_to_user": {"reputation": 25, "user_id": 4604922, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7a74f1e2566312ce1704ec5896f050de?s=128&d=identicon&r=PG&f=1", "display_name": "Siti", "link": "https://stackoverflow.com/users/4604922/siti"}, "edited": false, "score": 0, "creation_date": 1425028904, "post_id": 28715971, "comment_id": 45802616, "body": "that&#39;s because after you change the range, or delete the row, the range <code>Payment_Center</code> is no longer set, so you have to set it again in the loop"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "reply_to_user": {"reputation": 25, "user_id": 4604922, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7a74f1e2566312ce1704ec5896f050de?s=128&d=identicon&r=PG&f=1", "display_name": "Siti", "link": "https://stackoverflow.com/users/4604922/siti"}, "edited": false, "score": 0, "creation_date": 1425029254, "post_id": 28715971, "comment_id": 45802796, "body": "@Siti: I have edited my answer to give more information, and changed your loop."}, {"owner": {"reputation": 25, "user_id": 4604922, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7a74f1e2566312ce1704ec5896f050de?s=128&d=identicon&r=PG&f=1", "display_name": "Siti", "link": "https://stackoverflow.com/users/4604922/siti"}, "edited": false, "score": 0, "creation_date": 1425090698, "post_id": 28715971, "comment_id": 45832889, "body": "I have tried but now its showing runtime error 91 for this section      *Payment_Center = Sheet1.Range(&quot;A&quot; &amp; row_number) &#39; *  Should I adjust anything in the variable?  Error 91: Object variable or With block variable not set"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "reply_to_user": {"reputation": 25, "user_id": 4604922, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7a74f1e2566312ce1704ec5896f050de?s=128&d=identicon&r=PG&f=1", "display_name": "Siti", "link": "https://stackoverflow.com/users/4604922/siti"}, "edited": false, "score": 0, "creation_date": 1425135699, "post_id": 28715971, "comment_id": 45842627, "body": "@Siti: sorry, I had made a mistake in my code, of course, as I had said, to modify a range object you must always use the <code>Set</code> keyword, thus the code should have been:   <code>Set Payment_Center = Sheet1.Range(&quot;A&quot; &amp; row_number)</code>  I have changed it, please try again"}], "tags": [], "owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "is_accepted": false, "score": 0, "last_activity_date": 1425135606, "last_edit_date": 1425135606, "creation_date": 1424858311, "answer_id": 28715971, "question_id": 28715849, "link": "https://stackoverflow.com/questions/28715849/vba-error-error-1004-error-method-range-of-object-worksheet-failed/28715971#28715971", "title": "VBA error: Error 1004: Error Method range of object _worksheet failed", "body": "<p>The error happens because the range object needs to be modified using the <code>Set</code> keyword.</p>\n\n<pre><code>Set Payment_Center = Sheet1.Range(\"A\" &amp; row_number)\n</code></pre>\n\n<p>and your loop should look like</p>\n\n<pre><code>row_number = 1\n\nDo\n  DoEvents\n  row_number = row_number + 1\n  Set Payment_Center = Sheet1.Range(\"A\" &amp; row_number) '\n\n  If InStr(Payment_Center, \"BG01\") &gt;= 1 Then\n    Sheet1.Rows(row_number &amp; \":\" &amp; row_number).Delete\n    row_number = row_number - 1\n\n  End If\n\n  ' reset Payment_Center range using new row number\n  set Payment_Center = Sheet1.Range(\"A\" &amp; row_number)\n\nLoop Until Payment_Center = \" \"\n</code></pre>\n\n<p>and it should work</p>\n\n<p>it would also help your coding and debugging if you had <code>Option Explicit</code> at the top of <strong>all</strong> your code modules, and declared all variables properly, such as </p>\n\n<pre><code>Dim row_number As Integer\nDim Payment_Center as Range\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4604922, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7a74f1e2566312ce1704ec5896f050de?s=128&d=identicon&r=PG&f=1", "display_name": "Siti", "link": "https://stackoverflow.com/users/4604922/siti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 274, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1425135606, "creation_date": 1424857896, "last_edit_date": 1424857960, "question_id": 28715849, "link": "https://stackoverflow.com/questions/28715849/vba-error-error-1004-error-method-range-of-object-worksheet-failed", "title": "VBA error: Error 1004: Error Method range of object _worksheet failed", "body": "<p>I am trying to create VBA for this function - to delete rows if cell in column A contains \"BG01\". Header name for column A is \"Payment Center\"</p>\n\n<p>But when I run the macro, it shows: Error Method range of object _worksheet failed </p>\n\n<pre><code>row_number = 1\n\nDo\n    DoEvents\n    row_number = row_number + 1\n    Payment_Center = Sheet1.Range(\"A\" &amp; row_number) ' &lt;~~~~~ Error occurs here\n\n    If InStr(Payment_Center, \"BG01\") &gt;= 1 Then\n        Sheet1.Rows(row_number &amp; \":\" &amp; row_number).Delete\n        row_number = row_number - 1\n    End If\n\nLoop Until Payment_Center = \" \"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "edited": false, "score": 0, "creation_date": 1424858787, "post_id": 28715626, "comment_id": 45719848, "body": "If I understand correctly, you receive a list with courses including the amount of slots per course. Then you want to insert that amount of slots as blank rows below each course line?"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1424859082, "post_id": 28715626, "comment_id": 45720029, "body": "Will the layout of the table always be like in the top example? If so there is really no point in searching for the correct column-header, as it&#39;ll always be in the same column."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "edited": false, "score": 0, "creation_date": 1424863319, "post_id": 28715626, "comment_id": 45722483, "body": "@Jens that is correct."}, {"owner": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "edited": false, "score": 0, "creation_date": 1424867152, "post_id": 28715626, "comment_id": 45724837, "body": "I believe the cause of your error is the use of the <a href=\"http://stackoverflow.com/q/349613/3725745\">&#39;Set&#39; keyword</a>, which sets a reference to an object. Since integer variables aren&#39;t objects you don&#39;t need this keyword. The rest of your code others seem to have made some attempt at in their answers."}], "answers": [{"comments": [{"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1424863601, "post_id": 28716242, "comment_id": 45722642, "body": "MS Access is unfortunately not an option - believe me, my first thought about this problem was to export it to a database. The powers that be have decided that I must use Excel."}], "tags": [], "owner": {"reputation": 839, "user_id": 3790184, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100001405018565/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/3790184/jens"}, "is_accepted": false, "score": 0, "last_activity_date": 1424859098, "creation_date": 1424859098, "answer_id": 28716242, "question_id": 28715626, "link": "https://stackoverflow.com/questions/28715626/excel-vba-create-rows-below-based-on-int-in-abritrary-col-row/28716242#28716242", "title": "Excel / VBA -- Create rows below based on int in abritrary col/row", "body": "<p>May I suggest transferring your data to ms access? Even though what you are asking is easily possible in excel, I don't think it will let you keep track of everything in a handy way.</p>\n\n<p>My suggestion is, create two tables in ms access. One with all your courses, and with all participants, regardless of the course. The you add a reference in the participants table, in which you connect the correct course ID from the first table. Afterwards, you can easily run a query to get all your data. If you want to, you can always export your data to excel.</p>\n\n<p>Should you really want to do it in excel for whatever reason, leave a comment and I'll help you out.</p>\n"}, {"comments": [{"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1424865224, "post_id": 28717516, "comment_id": 45723619, "body": "I can&#39;t get your code to work. Debugger says type mismatch on row 11:"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1424865852, "post_id": 28717516, "comment_id": 45724001, "body": "It works for me. Is there something else than the number of open slots in your column E?"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1424866083, "post_id": 28717516, "comment_id": 45724136, "body": "There is a column header, similar to how it appears in the example."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1424866352, "post_id": 28717516, "comment_id": 45724297, "body": "Yeah, that&#39;s why it starts in <code>E2</code>/row 2. What is the line it stops on? For me line 11 is <code>Worksheets(&quot;Sheet1&quot;).Range(&quot;E&quot; &amp; CStr(at_row_number)).Formula = &quot;=COUNTBLANK(B&quot; &amp; CStr(at_row_number + 1) &amp; &quot;:B&quot; &amp; CStr(at_row_number + CLng(v)) &amp; &quot;)&quot;</code> Are you able to post an actual sample workbook somewhere?"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1424868382, "post_id": 28717516, "comment_id": 45725607, "body": "<a href=\"http://s000.tinyupload.com/?file_id=02770147469124312893\" rel=\"nofollow noreferrer\">s000.tinyupload.com/?file_id=02770147469124312893</a>         The formatting isn&#39;t the same as in my original post (but the testbook I tried your code was!), this is the production sample layout with bogus data.        Sheet 2 contains an estimate of the result (I only formatted the top 3 courses) - the lines that are filled in with Does are just examples of what I would do with the file after the macro has run, and how the COUNTBLANK function needs to play into it all."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1424869170, "post_id": 28717516, "comment_id": 45726095, "body": "I have a meeting now, but I&#39;ll see if I can have a look at it a bit later today. Worst case scenario I&#39;ll check back in tomorrow :)"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1424869228, "post_id": 28717516, "comment_id": 45726121, "body": "But to answer your previous question, yes, the line you pasted is where it stopped for me too. The sample book I tried the code on was laid out identical to the example in OP."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1424945813, "post_id": 28717516, "comment_id": 45762956, "body": "Your workbook had two header rows (sort of). I&#39;ve updated the code,   and I now believe that it should do what you want it to. At least it seems to do what you ask for for me. I&#39;ll leave in the old code too, for comparison."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1424947141, "post_id": 28717516, "comment_id": 45763826, "body": "That does seem to work for me too, in the testbook. But if the layout changes and I change the corresponding values in your code, from column B to column A, the code breaks: subscript out of range, on the no_to_insert bit."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1424947249, "post_id": 28717516, "comment_id": 45763893, "body": "If it works, I&#39;d appreciate it if you marked my answer as the solution (there&#39;s a checkmark next to the top of the answer). And feel free to contact me again for any further questions."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1424949189, "post_id": 28717516, "comment_id": 45765124, "body": "It should already be marked. And I figured out how to make it work for any column. The only thing I might add, it doesn&#39;t perform any inserts after the last-most course line? And lastly, if I were to bring this code to my workplace, would that be permissible to you and if so how do you want me to put the credit?"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1424949950, "post_id": 28717516, "comment_id": 45765580, "body": "No need for any credit, and feel  free to use it any way you like. I believe it does insert rows after the final entry, it just doesn&#39;t copy the formatting from the row above. If it&#39;s just the borders you want, try to add in these two lines after the loop: <code>Worksheets(&quot;Sheet1&quot;).Range(&quot;A3:H3&quot;).Resize(at_row_number - 2, 8).Borders.LineStyle = xlContinuous</code> and <code>Worksheets(&quot;Sheet1&quot;).Range(&quot;A3:H3&quot;).Resize(at_row_number - 2, 8).Borders.Weight = xlThin</code>"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1424950773, "post_id": 28717516, "comment_id": 45766101, "body": "Partially functional - if the last line has 15 slots, the code formats 17 lines below it."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1424950881, "post_id": 28717516, "comment_id": 45766173, "body": "Hmm, even with the <code>-2</code>? Increase that  to <code>-4</code>, then, though I&#39;m not sure why the count is off."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1424951303, "post_id": 28717516, "comment_id": 45766423, "body": "Beautiful! I would give you more +&#39;s if I knew how."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1424951401, "post_id": 28717516, "comment_id": 45766488, "body": "There&#39;s  an up-arrow next to the arrow too, but I&#39;m not sure if you have enough reputation to use it? ;)"}], "tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": true, "score": 1, "last_activity_date": 1424945867, "last_edit_date": 1424945867, "creation_date": 1424862728, "answer_id": 28717516, "question_id": 28715626, "link": "https://stackoverflow.com/questions/28715626/excel-vba-create-rows-below-based-on-int-in-abritrary-col-row/28717516#28717516", "title": "Excel / VBA -- Create rows below based on int in abritrary col/row", "body": "<p>Here is my take on your problem. Please note that you'll probably run into trouble if the data isn't formatted as it seems to be in your top post, or if there e.g. are empty cells in the column describing number of participants.</p>\n\n<p>As to your own code, I didn't look too closely into it, as I found it easier to start from scratch, but from what I saw I'd strongly recommend you to use <code>Option Explicit</code> at the top of your modules, forcing you to declare all your variables. Where are you for instance getting the values for NumCols or NumRows from?</p>\n\n<p>As to why the sub aborts at the line it does, I believe it is because the argument you pass to <code>Worksheets.Range()</code> is not valid.</p>\n\n<pre><code>Sub insertRowsCourseSpace()\n  Dim no_to_insert() As Variant, v As Variant, at_row_number As Long, i As Long\n\n  no_to_insert = Range(Worksheets(\"Sheet1\").Range(\"E2\"), Worksheets(\"Sheet1\").Range(\"E1048576\").End(xlUp))\n  at_row_number = 2\n\n  For Each v In no_to_insert\n    ' Inserts new rows\n    Worksheets(\"Sheet1\").Rows(CStr(at_row_number + 1) &amp; \":\" &amp; CStr(at_row_number + CLng(v))).Insert shift:=xlDown\n    ' Inserts formula\n    Worksheets(\"Sheet1\").Range(\"E\" &amp; CStr(at_row_number)).Formula = \"=COUNTBLANK(B\" &amp; CStr(at_row_number + 1) &amp; \":B\" &amp; CStr(at_row_number + CLng(v)) &amp; \")\"\n    ' Name range\n    Worksheets(\"Sheet1\").Range(\"A2:E2\").Offset(at_row_number - 2, 0).Resize(CLng(v) + 1, 5).Name = \"Range\" &amp; CStr(i)\n    i = i + 1\n    ' Decides where to insert the new set of rows\n    at_row_number = at_row_number + CLng(v) + 1\n  Next\n  With Worksheets(\"Sheet1\").Range(\"A1\")\n    .Value = \"01.\"\n    .AutoFill .Resize(at_row_number, 1), xlFillSeries\n  End With\nEnd Sub\n</code></pre>\n\n<p>Updated code:</p>\n\n<pre><code>Sub insertRowsCourseSpace()\n  Dim no_to_insert() As Variant, v As Variant, at_row_number As Long, i As Long\n\n  no_to_insert = Range(Worksheets(\"Sheet1\").Range(\"B3\"), Worksheets(\"Sheet1\").Range(\"B1048576\").End(xlUp))\n  at_row_number = 3\n\n  For Each v In no_to_insert\n    ' Inserts new rows\n    Worksheets(\"Sheet1\").Rows(CStr(at_row_number + 1) &amp; \":\" &amp; CStr(at_row_number + CLng(v))).Insert shift:=xlDown\n    ' Inserts formula\n    Worksheets(\"Sheet1\").Range(\"B\" &amp; CStr(at_row_number)).Formula = \"=COUNTBLANK(A\" &amp; CStr(at_row_number + 1) &amp; \":A\" &amp; CStr(at_row_number + CLng(v)) &amp; \")\"\n    ' Name range\n    Worksheets(\"Sheet1\").Range(\"A3:H3\").Offset(at_row_number - 3, 0).Resize(CLng(v) + 1, 8).Name = \"Range\" &amp; CStr(i)\n    i = i + 1\n    ' Decides where to insert the new set of rows\n    at_row_number = at_row_number + CLng(v) + 1\n  Next\n  'With Worksheets(\"Sheet1\").Range(\"A1\")\n  '  .Value = \"01.\"\n  '  .AutoFill .Resize(at_row_number, 1), xlFillSeries\n  'End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 28717516, "answer_count": 2, "score": 2, "last_activity_date": 1424946538, "creation_date": 1424857218, "last_edit_date": 1424946538, "question_id": 28715626, "link": "https://stackoverflow.com/questions/28715626/excel-vba-create-rows-below-based-on-int-in-abritrary-col-row", "title": "Excel / VBA -- Create rows below based on int in abritrary col/row", "body": "<p>I am making an Excel sheet for keeping track of courses and its participants.</p>\n\n<p>The format is as such:</p>\n\n<pre><code>01. Place  | Time | Date | Slots\n02. SO.com   Now     Now     5\n03. SE.com   Soon    Soon    10\n</code></pre>\n\n<p>And etc.</p>\n\n<p>This list is sent to me with anywhere from 10 to 50 courses at a time, and I want to keep track of the participants for each course in the same file. </p>\n\n<p>So ideally, I want to run a macro that, under the course for SO.com, creates 5 (See Slots) new rows, and then replaces the value 5 with a =COUNTBLANK for the range that was just created, so that the \"Slots\" value will now show how many free slots there are instead of the total number of slots. Bonus points if anyone can point me to how I can make the macro group the created selection as well.</p>\n\n<p>The macro should loop through the entire worksheet and do the same operation for every course.</p>\n\n<p>The result should look like this:</p>\n\n<pre><code>01. Place | Time | Date | Slots\n02. SO.com  Now     Now     5\n03. &lt;empty&gt;\n04. &lt;empty&gt;\n05. &lt;empty&gt;\n06. &lt;empty&gt;\n07. &lt;empty&gt;\n08. SE.com  Soon    Soon    10\n09. &lt;empty&gt;\n10. &lt;empty&gt;\n...\n</code></pre>\n\n<p>Entering the participants into the Excel field is done through copypasta, as I have a system for mass exporting this information from a different program.</p>\n\n<p>I'm very new at VBA, but below is my initial attempt at starting to construct this code. I cut some code from other parts of the web, did some lookups to MSDN, and guesstimated the rest, and not very surprisingly, it doesn't quite work yet. I get an object required error on the line starting with \"Set cellCount = Worksheets [...]\" and I don't understand why.</p>\n\n<p>Any input on other parts of the process (if you see that my code is stillborn regardless of the object error, for example) is also appreciated.</p>\n\n<hr>\n\n<pre><code>Sub insertRowsCourseSpace()\n\n    Dim i&amp;\n    Dim cellCount As Integer\n    Dim a As Integer\n\n    'Locate the column to look for course space values    \n    Dim col_n As Long\n        For f = 1 To NumCols\n        If Cells(2, f).Value = \"Slots\" Then col_n = f 'Finding the cell with the given string sets the column number\n    Next\n\n    'If cell value is numerical, create rows equal to value\n    For i = 1 To NumRows\n        If IsNumeric(Worksheets(1).Range(col_n &amp; i).Value) = True Then\n            Set cellCount = Worksheets(1).Range(col_n &amp; i).Value\n            Set Worksheets(1).Range(col_n &amp; i).Value = \"=COUNTBLANK(ActiveCell.Offset(1):ActiveCell(Offset(1 + cellCount))\"\n            For j = 1 To cellCount\n                ActiveCell.Offset(j).EntireRow.Insert\n            Next j\n    Next i\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>EDIT:</p>\n\n<p>OK, new attempt:</p>\n\n<p>Using this workbook: <a href=\"http://s000.tinyupload.com/?file_id=02770147469124312893\" rel=\"nofollow\">http://s000.tinyupload.com/?file_id=02770147469124312893</a> </p>\n\n<pre><code>Sub insertRowsCourseSlots()\n\nDim i&amp;\nDim cellCount As Integer\nDim cellValue As Integer\nDim a As String\nDim b As String\n\n'Locate correct column to look for course slots\n'Dim col_n As Long\n'\n'    For f = 1 To 15 'Course slots won't be located further out than 15 columns, arbitrary value\n'    If Cells(2, f).Value = \"Antall kursplass\" Then col_n = f\n'Next\n\n'If cell value is numerical, insert number of rows equal to the cell value\nFor i = 3 To 400 '400 = Arbitrary number\n    If IsNumeric(Sheets(\"Sheet1\").Cells(2, i).Value) = True Then\n        cellValue = Sheets(\"Sheet1\").Cells(2, i).Value\n        cellCount = cellValue\n        a = ActiveCell.Offset(1)\n        b = ActiveCell.Offset(1) + CStr(cellCount)\n        Set Sheets(\"Sheet1\").Cells(2, i).Value = \"=COUNTBLANK(a:b)\"\n        For j = 1 To cellCount\n            ActiveCell.Offset(j).EntireRow.Insert\n        Next j\n    End If\nNext i \nEnd Sub\n</code></pre>\n\n<p>This gives me Runtime error '9', subscript out of range, on the line Set Sheets(\"Sheet1\").Cells(2, i).Value = \"=COUNTBLANK(a:b)\"</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 1, "creation_date": 1424857789, "post_id": 28715608, "comment_id": 45719207, "body": "What is the variable <code>aaa</code> in your sub supposed to be? It seems to be the same as <code>searchword</code>? You also have two different <code>m_wsSheet</code> in your code, one of which isn&#39;t defined."}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 1, "creation_date": 1424857835, "post_id": 28715608, "comment_id": 45719238, "body": "Your code doesn&#39;t do what you say it does. Your variable names are all mixed up. Please write <code>Option Explicit</code> at the top of your module, and declare all of your variables using <code>Dim</code>. This will help you find your own mistakes."}], "answers": [{"comments": [{"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 2, "creation_date": 1424860742, "post_id": 28716573, "comment_id": 45721005, "body": "+1 for making it work, might I suggest renaming of variables? This makes it a lot more easier to know what variable does what, with the current setup <code>kkk</code>, <code>celld</code> are a bit confusing. Good work though. Also you could pass the <b>word</b> to the Sub, than hardcoding."}], "tags": [], "owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "is_accepted": true, "score": 2, "last_activity_date": 1424860020, "creation_date": 1424860020, "answer_id": 28716573, "question_id": 28715608, "link": "https://stackoverflow.com/questions/28715608/apply-color-to-a-specific-word-in-a-range/28716573#28716573", "title": "Apply color to a specific word in a range", "body": "<p>I've done a version using your variable names. You were halfway there. Just didn't need the aaa or mmm variable, your second sheet name was incorrect and exit criteria for the loop didn't work.</p>\n\n<p>In future make sure your indentation is correct and variables are declared. Also try and come up with better variable names.</p>\n\n<pre><code>Sub search()\n\n'add in declarations\nDim m_wsSheet1 As Range\nDim celld As Range\nDim kkk As Integer\nDim searchWord As String\nDim blnEndSearch As Boolean\n\n\nSet m_wsSheet1 = Sheets(1).Range(\"A1:A5\")\n\nsearchWord = \"Henry\"\n\nFor Each celld In m_wsSheet1 'changed to same range as above\n\n    kkk = 1 'starting search position\n\n    Do\n        'finds starting position of search word\n        kkk = InStr(kkk, celld.Value, searchWord) 'changed aaa to searchWord\n\n        'if we've found a match\n        If kkk &lt;&gt; 0 Then\n            'colours found word\n            celld.Characters(kkk, Len(searchWord)).Font.Color = RGB(221, 21, 221)\n\n            'start at end of last position\n            kkk = kkk + Len(searchWord)\n        End If\n\n    Loop While kkk &lt;&gt; 0\n\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 4536718, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/6f9246168eb45e82be8c1ef9ac8bd983?s=128&d=identicon&r=PG&f=1", "display_name": "javad", "link": "https://stackoverflow.com/users/4536718/javad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 28716573, "answer_count": 1, "score": -1, "last_activity_date": 1424861231, "creation_date": 1424857155, "last_edit_date": 1424861231, "question_id": 28715608, "link": "https://stackoverflow.com/questions/28715608/apply-color-to-a-specific-word-in-a-range", "title": "Apply color to a specific word in a range", "body": "<p>I want to apply color to a specific word in a range. for example in the range below I want to add color to word \"Henry\" (Please pay attention that some cells have more than one \"Henry\". I want to add color to all \"Henry\" in the range.<br></p>\n\n<pre><code>         A\n1  Henry is Henry\n2  Lean and REyhan came\n3  Fendo Henry came \n4  dce\n5  Henry and Henry uu Henry \n</code></pre>\n\n<p>My code not only apply color to Henry but apply color to the first five character of every cell. I don't know why.</p>\n\n<pre><code>Sub search()\n\n  Set m_wsSheet1 = Sheets(1).Range(\"A1:A5\")\n\n  searchWord = \"Henry\"\n\n  For Each celld In m_wsSheet1\n    kkk = 1\n    Do\n      kkk = InStr(kkk, celld, searchWord )\n      mmm = kkk\n      celld.Characters(kkk, Len(searchWord)).Font.Color = RGB(221, 21, 221)\n      kkk = kkk + Len(searchWord )\n    Loop While mmm &gt; 0\n  Next\n\nEnd Sub\n</code></pre>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["vba", "excel", "compare", "subtraction"], "comments": [{"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1424856422, "post_id": 28715302, "comment_id": 45718283, "body": "If I&#39;ve understood your question correctly, could you not just use a <code>VLOOKUP</code> and <code>IFERROR</code> function together to lookup the value and subtract if it does exist. If if doesn&#39;t exist do nothing?"}], "answers": [{"tags": [], "owner": {"reputation": 265, "user_id": 1534035, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/cbe937653af345a35eb303a976d1dee9?s=128&d=identicon&r=PG", "display_name": "Ashwith Ullal", "link": "https://stackoverflow.com/users/1534035/ashwith-ullal"}, "is_accepted": false, "score": 0, "last_activity_date": 1424860292, "creation_date": 1424860292, "answer_id": 28716671, "question_id": 28715302, "link": "https://stackoverflow.com/questions/28715302/how-do-i-compare-the-values-of-a-column-and-then-subtract-values-from-the-adjace/28716671#28716671", "title": "How do I compare the values of a column and then subtract values from the adjacent column", "body": "<pre><code>sub match_col()\n\nSet ws1 = ThisWorkbook.Sheets(\"Sheet9\")\nSet ws2 = ThisWorkbook.Sheets(\"Sheet12\")\n\nlastRow1 = ws1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nlastrow2 = ws2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\ni = 1 to lastRow1\nj = 1 to lastRow2\n\nif worksheets(\"ws1_A\").range(\"a\" &amp; i).value =  worksheets(\"ws2_A\").range(\"a\" &amp; i).value \n\nmsgBox worksheets(\"ws2_B\").range(\"B\" &amp; i).value - worksheets(\"ws1_B\").range(\"B\" &amp; i).value\n\nend if\nnext j\nnext i\n</code></pre>\n"}], "owner": {"reputation": 669, "user_id": 2556655, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e3e5019b130af9396a6da9e9aa9c27d3?s=128&d=identicon&r=PG", "display_name": "Manus", "link": "https://stackoverflow.com/users/2556655/manus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 330, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1424860292, "creation_date": 1424856245, "last_edit_date": 1424856810, "question_id": 28715302, "link": "https://stackoverflow.com/questions/28715302/how-do-i-compare-the-values-of-a-column-and-then-subtract-values-from-the-adjace", "title": "How do I compare the values of a column and then subtract values from the adjacent column", "body": "<p>I have two worksheets. WS1 and WS2</p>\n\n<p>WS1 - Column A and WS2 - Column A have product codes.<br>\nWS1 - Column B and WS2 - Column B have quantities ordered.</p>\n\n<p>What I would like to do is Compare WS1-A to WS2-A.<br>\nIf the strings match, then subtract WS2-B from WS1-B.<br>\nIf no match then go to next row.<br></p>\n\n<p>I found a bit of code, but since I'm new to VBA, I am not too sure how to modify it to meet my needs.</p>\n\n<pre><code>Public Sub CompareRange(range1 As Range, range2 As Range)\n    Dim ws1 As Worksheet, ws2 As Worksheet\n    Dim lastRow1 As Integer, lastrow2 As Integer\n    Dim rng1 As Range, rng2 As Range\n    Dim CompareCell As Range\n    Dim CheckCell As Range\n    Dim CellFound As Boolean\n\n    Application.ScreenUpdating = False\n\n    Set ws1 = ThisWorkbook.Sheets(\"Sheet9\")\n    Set ws2 = ThisWorkbook.Sheets(\"Sheet12\")\n\n    lastRow1 = ws1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    lastrow2 = ws2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    Set rng1 = ws1.Range(\"A1:A\" &amp; lastRow1)\n    Set rng2 = ws2.Range(\"A1:A\" &amp; lastrow2)\n\n    Set qty1 = ws1.Range(\"B1:B\" &amp; lastRow1)\n    Set qtyair = ws2.Range(\"B1:B\" &amp; lastrow2)\n\n    For Each CompareCell In rng1.Cells\n        CellFound = False\n        For Each CheckCell In rng2.Cells\n            If CheckCell.Text = CompareCell.Text Then\n\n            End If\n        Next CheckCell\n        If Not CellFound Then\n        End If\n    Next CompareCell\nEnd Sub\n</code></pre>\n\n<p>Kindly advise on how I can get this done in Excel VBA. I am using Excel 2013.</p>\n"}, {"tags": ["excel", "excel-udf", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1424862871, "post_id": 28717360, "comment_id": 45722230, "body": "Darn. Is there any simple way to see what native functions are valid to use in an UDF, or will I just have to come here an ask you every time? ;) At any rate, thanks for the help!"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1424863856, "post_id": 28717360, "comment_id": 45722799, "body": "I&#39;m not aware of a specific list, but off the top of my head, you can&#39;t use most methods (inlcuding <code>Specialcells</code>) and these properties: <code>CurrentArray</code>, <code>CurrentRegion</code>, <code>DisplayFormat</code>."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 3, "last_activity_date": 1424862297, "creation_date": 1424862297, "answer_id": 28717360, "question_id": 28715135, "link": "https://stackoverflow.com/questions/28715135/udf-using-findnext-seems-to-abort-without-warning/28717360#28717360", "title": "UDF using FindNext seems to abort without warning", "body": "<p><code>FindNext</code> doesn't work in UDFs. You have to simply repeat the original <code>Find</code> operation.</p>\n"}], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 28717360, "answer_count": 1, "score": 1, "last_activity_date": 1424862297, "creation_date": 1424855733, "last_edit_date": 1531161705, "question_id": 28715135, "link": "https://stackoverflow.com/questions/28715135/udf-using-findnext-seems-to-abort-without-warning", "title": "UDF using FindNext seems to abort without warning", "body": "<p>I have the following user-defined function, which attempts to find the nth non-empty cell in a range:</p>\n\n<pre><code>Option Explicit\n\nFunction finn_prioritert_oppgave(nummer As Long) As String\n\n  Dim i As Long, r As Range, c As Range\n\n  Set r = Range(PDCA.Range(\"L9\"), PDCA.Range(\"L1048576\").End(xlUp))\n  i = 1\n\n  Set c = r.Find(What:=\"*\", LookIn:=xlValues, LookAt:=xlWhole)\n\n  While (Not c Is Nothing) And (Intersect(c, PDCA.Rows(9)) Is Nothing) And (i &lt; nummer)\n\n    Debug.Print c\n    Set c = r.FindNext(c)\n    Debug.Print c\n    Debug.Print CBool(c Is Nothing)\n    i = i + 1\n\n  Wend\n\n  If c Is Nothing Then\n    finn_prioritert_oppgave = \"#N/A\"\n  Else\n    finn_prioritert_oppgave = c.Offset(0, -10).Value\n  End If\n\nEnd Function\n</code></pre>\n\n<p>Running it with 1 as the argument works fine, presumably because it doesn't enter the <code>While</code>-loop and hit the <code>FindNext</code>, but running it with any larger value as the argument causes the cell it is called from to display a <code>#VALUE!</code>-alert.</p>\n\n<p>Looking at what is displayed in my immediate-window is also really strange, as the two <code>Debug.Print</code> messages after doing the <code>FindNext</code> doesn't print, although I get no alerts.</p>\n\n<p>The output I get in the immediate window, with the UDF invoked with 2 as its argument is simply an x:</p>\n\n<p><img src=\"https://i.stack.imgur.com/T62Zf.png\" alt=\"enter image description here\"><br>\nThe area the function is called from looks like <a href=\"https://imgur.com/nQpHwX1\" rel=\"nofollow noreferrer\">this</a> (the first line is the UDF invoked with 1 as the argument, the second is it invoked with 2 as the argument), while the area containing data looks like <a href=\"https://imgur.com/eapRHMT\" rel=\"nofollow noreferrer\">this</a>.</p>\n\n<p>So what I wonder is, why does <code>FindNext</code> fail to find the second non-empty cell in the range, and why does the function abort without any warning?</p>\n"}, {"tags": ["excel", "pdf", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 4604774, "user_type": "registered", "profile_image": "https://graph.facebook.com/1050651791628185/picture?type=large", "display_name": "Mario", "link": "https://stackoverflow.com/users/4604774/mario"}, "reply_to_user": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "edited": false, "score": 0, "creation_date": 1426237925, "post_id": 28715049, "comment_id": 46298378, "body": "The solution was to convert pdf with pdftotext.exe into a textfile, pull out the sheet numbers of schema and map them with pdf page numbers. Further it was straightforward to run the pdf with correct page number."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4604774, "user_type": "registered", "profile_image": "https://graph.facebook.com/1050651791628185/picture?type=large", "display_name": "Mario", "link": "https://stackoverflow.com/users/4604774/mario"}, "is_accepted": false, "score": 0, "last_activity_date": 1426238019, "creation_date": 1426238019, "answer_id": 29028492, "question_id": 28715049, "link": "https://stackoverflow.com/questions/28715049/map-pdf-pages-to-certain-text-on-pages/29028492#29028492", "title": "Map pdf pages to certain text on pages", "body": "<p>The solution was to convert pdf with pdftotext.exe into a textfile, pull out the sheet numbers of schema and map them with pdf page numbers. Further it was straightforward to run the pdf with correct page number.</p>\n"}], "owner": {"reputation": 1, "user_id": 4604774, "user_type": "registered", "profile_image": "https://graph.facebook.com/1050651791628185/picture?type=large", "display_name": "Mario", "link": "https://stackoverflow.com/users/4604774/mario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1426238019, "creation_date": 1424855475, "last_edit_date": 1531164843, "question_id": 28715049, "link": "https://stackoverflow.com/questions/28715049/map-pdf-pages-to-certain-text-on-pages", "title": "Map pdf pages to certain text on pages", "body": "<p>I need to open a pdf file from excel at a certain page. The problem is that actual pdf pages and sheet numbers used in excel do not match. For example page 7 in pdf is referenced as sheet 111 in excel, page 8 in pdf is referenced as sheet 121 in excel. The pdf file is an electrical drawing, that is why sheet numbers are arranged by function without any logical relation to the actual pdf page numbers.</p>\n"}, {"tags": ["vba", "visio", "visio-2010"], "answers": [{"tags": [], "owner": {"reputation": 2368, "user_id": 683606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YugId.jpg?s=128&g=1", "display_name": "JohnGoldsmith", "link": "https://stackoverflow.com/users/683606/johngoldsmith"}, "is_accepted": true, "score": 2, "last_activity_date": 1424944760, "creation_date": 1424944760, "answer_id": 28739306, "question_id": 28714744, "link": "https://stackoverflow.com/questions/28714744/get-layer-of-connector/28739306#28739306", "title": "Get layer of connector", "body": "<p>I'm not completely clear on your issue, but there's nothing special about connectors - they're still just shapes.  So if you know the index of your target shape and layer, then you can use your code above.  </p>\n\n<p>Shapes in Visio can also belong to multiple layers (layers don't work in the same way as, say, Photoshop), so you might want to get the layer count first and then run through each one.  For example:</p>\n\n<pre><code>Sub CheckLayers()\n    Dim shp As Visio.Shape\n    Dim i As Integer\n    For Each shp In ActivePage.Shapes\n        Debug.Print shp.NameU\n        For i = 1 To shp.LayerCount\n            Debug.Print \"  \" &amp; shp.Layer(i).Name\n        Next i\n        Debug.Print \"\"\n    Next shp\nEnd Sub\n</code></pre>\n\n<p>Also, depending on what you're trying to do, you might want to take advantage of the <a href=\"https://msdn.microsoft.com/en-us/library/ff767064%28v=office.14%29.aspx\" rel=\"nofollow\">Page.CreateSelection method</a> to return a selection based on shapes on a particular layer.  Here's a very slightly modified version from the Visio SDK:</p>\n\n<pre><code>Public Sub CreateSelection_Layer_Example()\n\n Dim vsoLayer As Visio.Layer\n Dim vsoSelection As Visio.Selection\n\n Set vsoLayer = ActivePage.Layers.ItemU(\"Connector\")\n Set vsoSelection = ActivePage.CreateSelection(visSelTypeByLayer, visSelModeSkipSuper, vsoLayer)\n\n 'Note that you don't have to pass the selection object to\n 'the ActiveWindow Selection property - you can just work\n 'with it directly if you want to\n Application.ActiveWindow.Selection = vsoSelection\n\nEnd Sub\n</code></pre>\n\n<p>If you're using the <em>Dynamic Connector</em>, this gets automatically assigned to a layer called 'Connector'.</p>\n"}], "owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 0, "accepted_answer_id": 28739306, "answer_count": 1, "score": 0, "last_activity_date": 1593554651, "creation_date": 1424854349, "last_edit_date": 1593554651, "question_id": 28714744, "link": "https://stackoverflow.com/questions/28714744/get-layer-of-connector", "title": "Get layer of connector", "body": "<p>Can I get the name of the layer a connector is assigned to in vba?</p>\n\n<p>I am doing this with shapes like this</p>\n\n<pre><code>ActivePage.Shapes(1).layer(1)\n</code></pre>\n\n<p>And now I am looking for something similar but for connectors.</p>\n"}, {"tags": ["asp.net", "excel", "vba", "export-to-excel", "epplus"], "answers": [{"tags": [], "owner": {"reputation": 408521, "user_id": 284240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/01d6005ebf89c14de87a62add488aaad?s=128&d=identicon&r=PG", "display_name": "Tim Schmelter", "link": "https://stackoverflow.com/users/284240/tim-schmelter"}, "is_accepted": false, "score": 2, "last_activity_date": 1451586276, "last_edit_date": 1495542173, "creation_date": 1424853860, "answer_id": 28714591, "question_id": 28714488, "link": "https://stackoverflow.com/questions/28714488/using-epplus-export-to-excel-set-range-as-text-to-a-specific-column/28714591#28714591", "title": "Using EPPlus -export to excel, set range as Text to a specific column", "body": "<p>Apply the style to the range <em>after</em> you have loaded it:</p>\n\n<pre><code>worksheet.Cells[\"A1\"].LoadFromDataTable(ds.Tables[i], true);\nExcelRange rng = worksheet.Cells[\"B1:B\" + (ds.Tables[i].Rows.Count + 1)];\nrng.Style.Numberformat.Format = \"#\";\n</code></pre>\n\n<p>Btw: Using for excelrange is needless: <a href=\"https://stackoverflow.com/questions/23132659/epplus-do-i-need-to-call-dispose-on-objects-like-excelrange?lq=1\">EPPlus - Do I need to call Dispose on objects like ExcelRange?</a></p>\n"}, {"comments": [{"owner": {"reputation": 12593, "user_id": 1324284, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/6bsvn.jpg?s=128&g=1", "display_name": "Ernie S", "link": "https://stackoverflow.com/users/1324284/ernie-s"}, "reply_to_user": {"reputation": 23, "user_id": 1685989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58e07c0a7be0e97ef33f3f2ebc299983?s=128&d=identicon&r=PG", "display_name": "user1685989", "link": "https://stackoverflow.com/users/1685989/user1685989"}, "edited": false, "score": 0, "creation_date": 1425222895, "post_id": 28723732, "comment_id": 45864779, "body": "@user1685989  Humm..try the unit test above?  Seemed to make the difference (note that I am using 0.00 as the format but that should not matter)."}, {"owner": {"reputation": 23, "user_id": 1685989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58e07c0a7be0e97ef33f3f2ebc299983?s=128&d=identicon&r=PG", "display_name": "user1685989", "link": "https://stackoverflow.com/users/1685989/user1685989"}, "edited": false, "score": 0, "creation_date": 1425295577, "post_id": 28723732, "comment_id": 45889648, "body": "found some links to hide the warning in excel.. &lt;<a href=\"http://stackoverflow.com/questions/11858109/using-epplus-excel-how-to-ignore-excel-error-checking-or-remove-green-tag-on-t\" title=\"using epplus excel how to ignore excel error checking or remove green tag on t\">stackoverflow.com/questions/11858109/&hellip;</a>&gt; but here i applied for one column, it should not consider others.. any thoughts are appreciated!"}, {"owner": {"reputation": 12593, "user_id": 1324284, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/6bsvn.jpg?s=128&g=1", "display_name": "Ernie S", "link": "https://stackoverflow.com/users/1324284/ernie-s"}, "reply_to_user": {"reputation": 23, "user_id": 1685989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58e07c0a7be0e97ef33f3f2ebc299983?s=128&d=identicon&r=PG", "display_name": "user1685989", "link": "https://stackoverflow.com/users/1685989/user1685989"}, "edited": false, "score": 1, "creation_date": 1425301768, "post_id": 28723732, "comment_id": 45893263, "body": "@user1685989 Oh wait, if you are getting the green trangles then the problem is not with the code (althought I still think you need to remove those spaces).  The problem is the data table itself.  You are probably storing numbers as strings or vice versa.  Post that part of your code or check out this post:   <a href=\"http://stackoverflow.com/questions/28591763/epplus-how-to-know-the-format-of-the-worksheet-cell/28630723#28630723\" title=\"epplus how to know the format of the worksheet cell\">stackoverflow.com/questions/28591763/&hellip;</a>"}, {"owner": {"reputation": 23, "user_id": 1685989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58e07c0a7be0e97ef33f3f2ebc299983?s=128&d=identicon&r=PG", "display_name": "user1685989", "link": "https://stackoverflow.com/users/1685989/user1685989"}, "edited": false, "score": 0, "creation_date": 1425359593, "post_id": 28723732, "comment_id": 45920031, "body": "Thank you.. i didnt think that way.. will try, currently in the datatable everything is string...."}], "tags": [], "owner": {"reputation": 12593, "user_id": 1324284, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/6bsvn.jpg?s=128&g=1", "display_name": "Ernie S", "link": "https://stackoverflow.com/users/1324284/ernie-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1425222834, "last_edit_date": 1425222834, "creation_date": 1424880188, "answer_id": 28723732, "question_id": 28714488, "link": "https://stackoverflow.com/questions/28714488/using-epplus-export-to-excel-set-range-as-text-to-a-specific-column/28723732#28723732", "title": "Using EPPlus -export to excel, set range as Text to a specific column", "body": "<p>Remove the spaces from the string address you are building <code>\"B1 : B\"</code>:</p>\n\n<pre><code>using (ExcelRange rng = worksheet.Cells[\"B1:B\" + (dt.Rows.Count + 1)])\n{\n    rng.Style.Numberformat.Format = \"0.00\";\n}\n</code></pre>\n\n<p>That will likely trip up excel.</p>\n\n<hr>\n\n<pre><code>[TestMethod]\npublic void ExportToExcelAsStram()\n{\n    //http://stackoverflow.com/questions/28714488/using-epplus-export-to-excel-set-range-as-text-to-a-specific-column\n    //Throw in some data\n    var dt = new DataTable(\"tblData\");\n    dt.Columns.Add(new DataColumn(\"Date\", typeof(DateTime)));\n    dt.Columns.Add(new DataColumn(\"Col2\", typeof(int)));\n    dt.Columns.Add(new DataColumn(\"Col3\", typeof(int)));\n\n    for (var i = 0; i &lt; 20; i++)\n    {\n        var row = dt.NewRow();\n        row[\"Date\"] = DateTime.Now.AddDays(i);\n        row[\"Col2\"] = i * 10;\n        row[\"Col3\"] = i * 100;\n        dt.Rows.Add(row);\n    }\n\n    var ds = new DataSet();\n    ds.Tables.Add(dt);\n\n    MemoryStream ms = new MemoryStream();\n    ExcelPackage package = new ExcelPackage(ms);\n    try\n    {\n        for (int i = 0; i &lt; ds.Tables.Count; i++)\n        {\n\n            ExcelWorksheet worksheet = package.Workbook.Worksheets.Add((ds.Tables[i].Rows[i][\"Date\"]).ToString());\n\n            using (ExcelRange rng = worksheet.Cells[\"B1:B\" + (ds.Tables[i].Rows.Count + 1)])\n            {\n                rng.Style.Numberformat.Format = \"0.00\";\n            }\n\n            //worksheet.Cells[\"B1 : B\" + (ds.Tables[i].Rows.Count + 1)].Style.Numberformat.Format = \"@\";\n            worksheet.Cells[\"A1\"].LoadFromDataTable(ds.Tables[i], true);\n\n            //Format the header for column 1-9\n            using (ExcelRange range = worksheet.Cells[1, 1, 1, 12])\n            {\n                range.Style.Font.Bold = true;\n                range.Style.Fill.PatternType = OfficeOpenXml.Style.ExcelFillStyle.Solid;\n                range.Style.Fill.BackgroundColor.SetColor(System.Drawing.Color.DarkRed);\n                range.Style.Font.Color.SetColor(System.Drawing.Color.White);\n            }\n\n            worksheet.Cells[\"A1:L\" + (ds.Tables[i].Rows.Count + 1)].Style.Border.BorderAround(OfficeOpenXml.Style.ExcelBorderStyle.Thin, System.Drawing.Color.Black);\n            worksheet.Cells[\"A1:L\" + (ds.Tables[i].Rows.Count + 1)].Style.VerticalAlignment = ExcelVerticalAlignment.Center;\n            worksheet.Cells[\"A1:L\" + (ds.Tables[i].Rows.Count + 1)].Style.HorizontalAlignment = ExcelHorizontalAlignment.Center;\n\n        }\n\n    }\n    catch (Exception ex)\n    {\n        throw ex;\n    }\n    package.Save();\n    ms.Position = 0;\n    //return ms;\n\n    var existingFile = new FileInfo(@\"c:\\temp\\temp.xlsx\");\n    if (existingFile.Exists)\n        existingFile.Delete();\n\n    ms.WriteTo(new FileStream(existingFile.FullName, FileMode.Create));\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 1685989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58e07c0a7be0e97ef33f3f2ebc299983?s=128&d=identicon&r=PG", "display_name": "user1685989", "link": "https://stackoverflow.com/users/1685989/user1685989"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6807, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1451586276, "creation_date": 1424853466, "last_edit_date": 1424854042, "question_id": 28714488, "link": "https://stackoverflow.com/questions/28714488/using-epplus-export-to-excel-set-range-as-text-to-a-specific-column", "title": "Using EPPlus -export to excel, set range as Text to a specific column", "body": "<p>am using <code>EPPlus</code> to export data to excel(from  <code>MemoryStream</code>), below is the code </p>\n\n<pre><code>private static MemoryStream ExportToExcelAsStram(DataSet ds)\n{\n    MemoryStream ms = new MemoryStream();\n    ExcelPackage package = new ExcelPackage(ms);\n    try\n    {\n        for (int i = 0; i &lt; ds.Tables.Count; i++)\n        {\n\n            ExcelWorksheet worksheet = package.Workbook.Worksheets.Add((ds.Tables[i].Rows[i][\"Date\"]).ToString());\n\n            using (ExcelRange rng = worksheet.Cells[\"B1 : B\" + (ds.Tables[i].Rows.Count + 1)])\n            {\n                rng.Style.Numberformat.Format = \"#\";\n            }\n\n            //worksheet.Cells[\"B1 : B\" + (ds.Tables[i].Rows.Count + 1)].Style.Numberformat.Format = \"@\";\n            worksheet.Cells[\"A1\"].LoadFromDataTable(ds.Tables[i], true);\n\n            //Format the header for column 1-9\n            using (ExcelRange range = worksheet.Cells[1, 1, 1, 12])\n            {\n                range.Style.Font.Bold = true;\n                range.Style.Fill.PatternType = OfficeOpenXml.Style.ExcelFillStyle.Solid;\n                range.Style.Fill.BackgroundColor.SetColor(System.Drawing.Color.DarkRed);\n                range.Style.Font.Color.SetColor(System.Drawing.Color.White);\n            }\n\n            worksheet.Cells[\"A1:L\" + (ds.Tables[i].Rows.Count + 1)].Style.Border.BorderAround(OfficeOpenXml.Style.ExcelBorderStyle.Thin, System.Drawing.Color.Black);\n            worksheet.Cells[\"A1:L\" + (ds.Tables[i].Rows.Count + 1)].Style.VerticalAlignment = ExcelVerticalAlignment.Center;\n            worksheet.Cells[\"A1:L\" + (ds.Tables[i].Rows.Count + 1)].Style.HorizontalAlignment = ExcelHorizontalAlignment.Center;\n\n        }\n\n    }\n    catch (Exception ex)\n    {\n        throw ex;\n    }\n    package.Save();\n    ms.Position = 0;\n    return ms;\n}\n</code></pre>\n\n<p>i need to set the format of column B as text. i gave the range specifically for column B, but once the excel is generated this formatting is applied for all other columns. Please help me solve this... thanks in advance.</p>\n"}, {"tags": ["excel", "vba", "datepicker", "userform"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 2, "creation_date": 1424852826, "post_id": 28714246, "comment_id": 45716338, "body": "Which is apparently because the <code>dtmDate = Date</code> line always executes in your case? Anyhow try the <a href=\"https://support.office.com/en-us/article/EOMONTH-function-1525129b-fafb-44fc-90cd-4bea29ddda57\" rel=\"nofollow noreferrer\">built-in solution</a>."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1424853228, "post_id": 28714246, "comment_id": 45716522, "body": "Agree with @Gserg. Try double checking your input. If it is how you&#39;ve written it, I don&#39;t think Excel or VBA recognize that format as a Date."}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 1, "creation_date": 1424853349, "post_id": 28714246, "comment_id": 45716582, "body": "I tested your code and couldn&#39;t reproduce your issue. The code worked as expected."}, {"owner": {"reputation": 33, "user_id": 4578693, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10200196082982381/picture?type=large", "display_name": "Ax3landra", "link": "https://stackoverflow.com/users/4578693/ax3landra"}, "edited": false, "score": 0, "creation_date": 1424853513, "post_id": 28714246, "comment_id": 45716659, "body": "My problems is that the code only returns the end of February but I also need the end of January, March etc."}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 1, "creation_date": 1424856013, "post_id": 28714246, "comment_id": 45718042, "body": "It isn&#39;t clear what you&#39;re trying to achieve. Please show some example input, desired output, current output, and point out how the current output differs from the desired. <a href=\"http://stackoverflow.com/help/mcve\">A Minimal, Complete, and Verifiable example</a> always helps."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1424878746, "post_id": 28714246, "comment_id": 45732973, "body": "You never pass the parameter to the function, what else do you expect? The <code>dtmDate = Date</code> always executes."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1424866298, "creation_date": 1424866298, "answer_id": 28718739, "question_id": 28714246, "link": "https://stackoverflow.com/questions/28714246/end-of-the-month-for-every-month/28718739#28718739", "title": "End of the month for every month", "body": "<p>You must define the year and month as <em>inputs</em> to get the last date in the month:</p>\n\n<pre><code>Public Function LastDayInMonth(dIn As Date) As Date\n    LastDayInMonth = DateSerial(Year(dIn), Month(dIn) + 1, 0)\nEnd Function\n</code></pre>\n\n<p>will give the last date in some month, but only if <strong>dIn</strong> has the proper value.</p>\n\n<p>Clearly you should <strong>MsgBox</strong> <em>dtmDate</em> at the top of your UDF.</p>\n"}], "owner": {"reputation": 33, "user_id": 4578693, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10200196082982381/picture?type=large", "display_name": "Ax3landra", "link": "https://stackoverflow.com/users/4578693/ax3landra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2541, "favorite_count": 0, "accepted_answer_id": 28718739, "answer_count": 1, "score": 0, "last_activity_date": 1424866298, "creation_date": 1424852476, "last_edit_date": 1424856253, "question_id": 28714246, "link": "https://stackoverflow.com/questions/28714246/end-of-the-month-for-every-month", "title": "End of the month for every month", "body": "<p>In a user form in excel, using vba, I need to find the end of the month.For example my start date is 01.01.2015 and the end date will be automatically 31.01.2015.I try using this code:</p>\n\n<pre><code>Private Function dhLastDayInMonth(Optional dtmDate As Date = 0) As Date\n    ' Return the last day in the specified month.\n\nIf dtmDate = 0 Then\n        ' Did the caller pass in a date? If not, use\n        ' the current date.\n        dtmDate = Date\nEnd If\n\ndhLastDayInMonth = DateSerial(Year(dtmDate), _\n     Month(dtmDate) + 1, 0)\n\nEnd Function\n</code></pre>\n\n<p>but this code only returns the end of February.\nExample:\nstart date:01.01.2015 my code returns 28.02.2015\nor start date: 05.02.2015 my code returns 28.02.2015 </p>\n\n<p>The seconde code line is to edit the text box to insert the end date </p>\n\n<pre><code>Private Sub txtEDate_Change()\n\nIf txtEDate.Text = \"\" Then\n    MsgBox \"You must enter a Date! \"\n    Exit Sub\nEnd If\n\nIf txtEDate.TextLength = 2 Or txtEDate.TextLength = 5 Then\n    txtEDate.Text = txtEDate.Text + \".\"\nEnd If\n\nIf txtEDate.TextLength = 2 Or txtEDate.TextLength = 5 Then\ntxtEDate.Text = txtEDate.Text + \"DD/MM/YYYY\"\nEnd If\n\ntxtEDate.Text = dhLastDayInMonth()\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["string", "vba", "pivot-table", "inputbox"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1424851219, "post_id": 28713863, "comment_id": 45715617, "body": "Have you tried doing it without using variables? What happens? Does it work? If so, have you checked if you are supplying the correct input?"}, {"owner": {"reputation": 537, "user_id": 3815869, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/Beeih.jpg?s=128&g=1", "display_name": "krillebimbim", "link": "https://stackoverflow.com/users/3815869/krillebimbim"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1424851402, "post_id": 28713863, "comment_id": 45715701, "body": "I tried running it without using variables and it works fine (I recorded a macro to retrieve the data). Furthermore, I have double checked the input and it&#39;s runs fine."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1424851585, "post_id": 28713863, "comment_id": 45715781, "body": "<code>Furthermore, I have double checked the input and it&#39;s runs fine</code> I thought it doesn&#39;t work? With  <code>Doesn&#39;t seem to work</code> are you trying to say it is working but not as expected?"}], "owner": {"reputation": 537, "user_id": 3815869, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/Beeih.jpg?s=128&g=1", "display_name": "krillebimbim", "link": "https://stackoverflow.com/users/3815869/krillebimbim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1424851140, "creation_date": 1424850845, "last_edit_date": 1424851140, "question_id": 28713863, "link": "https://stackoverflow.com/questions/28713863/insert-data-string-to-retrieve-date-range-from-pivottable-with-vba", "title": "Insert data string to retrieve date range from PivotTable with VBA", "body": "<p>I have a problem inserting a string in my code to replace the PivotTable field. I want to use InputBox to dynamically change the range of data the program will output.</p>\n\n<p>I tried using the <code>CurrentPage</code> command but it doesn't seem to work.</p>\n\n<p>The error is:</p>\n\n<blockquote>\n  <p>runtime error '1004': Unable to get PivotTables property of the Worksheet class.</p>\n</blockquote>\n\n<pre><code>Sub InputBoxPivot()\n'\n' InputBoxPivot Macro\n'\n\n'\nDim s, p As String\n\ns = InputBox(\"Which media house?\")\n\nRange(\"C5\").Select\nWith ActiveSheet.PivotTables(\"PivotCube\").CubeFields( _\n    \"[Media House].[Media House]\")\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\nActiveSheet.PivotTables(\"PivotCube\").PivotFields( _\n    \"[Media House].[Media House].[Media House]\").VisibleItemsList = Array( _\n    \"[Media House].[Media House]\").CurrentPage = s\nWith ActiveSheet.PivotTables(\"PivotCube\").CubeFields(\"[Date].[Calendar Months]\" _\n    )\n    .Orientation = xlRowField\n    .Position = 2\nEnd With\nActiveSheet.PivotTables(\"PivotCube\").AddDataField ActiveSheet.PivotTables( _\n    \"PivotCube\").CubeFields(\"[Measures].[Downloads Count]\")\nEnd Sub\n</code></pre>\n\n<p>Do you have any idea what's causing this?</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 44235, "user_id": 1124287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rgSLN.jpg?s=128&g=1", "display_name": "barry houdini", "link": "https://stackoverflow.com/users/1124287/barry-houdini"}, "edited": false, "score": 0, "creation_date": 1424851833, "post_id": 28713560, "comment_id": 45715886, "body": "I can&#39;t see your screenshot. Which data is mixed? If lookup value is &quot;x&quot; and you expect to match that with &quot;xyz&quot; in table then you can use wild cards in VLOOKUP"}, {"owner": {"reputation": 1, "user_id": 4604459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67aaa7c724e9cb6dab528e4b5d5adb6c?s=128&d=identicon&r=PG&f=1", "display_name": "OMAR.M", "link": "https://stackoverflow.com/users/4604459/omar-m"}, "reply_to_user": {"reputation": 44235, "user_id": 1124287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rgSLN.jpg?s=128&g=1", "display_name": "barry houdini", "link": "https://stackoverflow.com/users/1124287/barry-houdini"}, "edited": false, "score": 0, "creation_date": 1424857097, "post_id": 28713560, "comment_id": 45718733, "body": "in colomn A1 &quot;SPAN PUR POS-55453717 000 INMA 432328xxxxxx7224R: 443083&quot; in colomn C1 &quot;443083&quot; how to lookup &quot;443083&quot; in &quot;SPAN PUR POS-55453717 000 INMA 432328xxxxxx7224R: 443083&quot; ?"}], "answers": [{"comments": [{"owner": {"reputation": 1105, "user_id": 1038431, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3251b5cb381c3026b6ee36f7975c2d87?s=128&d=identicon&r=PG", "display_name": "mshthn", "link": "https://stackoverflow.com/users/1038431/mshthn"}, "edited": false, "score": 1, "creation_date": 1424850640, "post_id": 28713785, "comment_id": 45715364, "body": "Depending on your regional settings, you may have to change the semicolons to commas in the formula. Or something else."}], "tags": [], "owner": {"reputation": 1105, "user_id": 1038431, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3251b5cb381c3026b6ee36f7975c2d87?s=128&d=identicon&r=PG", "display_name": "mshthn", "link": "https://stackoverflow.com/users/1038431/mshthn"}, "is_accepted": false, "score": 0, "last_activity_date": 1424850566, "creation_date": 1424850566, "answer_id": 28713785, "question_id": 28713560, "link": "https://stackoverflow.com/questions/28713560/how-to-vlookup-in-excel-if-your-table-array-with-mixed-data/28713785#28713785", "title": "how to vlookup in excel if your table array with mixed data", "body": "<p>Add another column with a formula that extracts the values you are looking for, e.g. <code>=MID(A2;29;6)</code>, then do a vlookup with that column.</p>\n"}, {"tags": [], "owner": {"reputation": 7418, "user_id": 2983632, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IvTM4.png?s=128&g=1", "display_name": "ttaaoossuu", "link": "https://stackoverflow.com/users/2983632/ttaaoossuu"}, "is_accepted": false, "score": 0, "last_activity_date": 1424855138, "creation_date": 1424855138, "answer_id": 28714967, "question_id": 28713560, "link": "https://stackoverflow.com/questions/28713560/how-to-vlookup-in-excel-if-your-table-array-with-mixed-data/28714967#28714967", "title": "how to vlookup in excel if your table array with mixed data", "body": "<p>Assuming your lookup values are 6 rightmost characters in <code>A:A</code> column, you need to create a helper column with something like:</p>\n\n<pre><code>=RIGHT(A1,6)\n</code></pre>\n\n<p>And then do <code>VLOOKUP</code> by those values.</p>\n"}, {"tags": [], "owner": {"reputation": 44235, "user_id": 1124287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rgSLN.jpg?s=128&g=1", "display_name": "barry houdini", "link": "https://stackoverflow.com/users/1124287/barry-houdini"}, "is_accepted": false, "score": 0, "last_activity_date": 1424868848, "creation_date": 1424868848, "answer_id": 28719581, "question_id": 28713560, "link": "https://stackoverflow.com/questions/28713560/how-to-vlookup-in-excel-if-your-table-array-with-mixed-data/28719581#28719581", "title": "how to vlookup in excel if your table array with mixed data", "body": "<p>As per my comment, you can avoid using any helper columns by using wildcards in the formula. If you simply trying to get the data from column A then try this formula:</p>\n\n<p><code>=VLOOKUP(\"*\"&amp;C1&amp;\"*\",A:A,1,0)</code></p>\n"}], "owner": {"reputation": 1, "user_id": 4604459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67aaa7c724e9cb6dab528e4b5d5adb6c?s=128&d=identicon&r=PG&f=1", "display_name": "OMAR.M", "link": "https://stackoverflow.com/users/4604459/omar-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 404, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1424868848, "creation_date": 1424849663, "last_edit_date": 1531161705, "question_id": 28713560, "link": "https://stackoverflow.com/questions/28713560/how-to-vlookup-in-excel-if-your-table-array-with-mixed-data", "title": "how to vlookup in excel if your table array with mixed data", "body": "<p>I am trying to vlookup the values in <code>Column C</code> from <code>Column A</code> , the problem is the data I want to look for is mixed with text:</p>\n\n<p><strong>Screen Shot:</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/AeNak.jpg\" alt=\"Sample Table layout\"></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1424887538, "post_id": 28713388, "comment_id": 45739275, "body": "<i>If</i> your code works as is, you might want to consider <a href=\"http://codereview.stackexchange.com/\">codereview.stackexchange.com</a>, but please check the help center there to make sure your question fits."}], "answers": [{"comments": [{"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "reply_to_user": {"reputation": 59, "user_id": 4600109, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/60Zvk.jpg?s=128&g=1", "display_name": "uniks", "link": "https://stackoverflow.com/users/4600109/uniks"}, "edited": false, "score": 0, "creation_date": 1424852743, "post_id": 28713620, "comment_id": 45716292, "body": "Sorry! Forget to add next to the for loop! I think it should work fine now."}, {"owner": {"reputation": 59, "user_id": 4600109, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/60Zvk.jpg?s=128&g=1", "display_name": "uniks", "link": "https://stackoverflow.com/users/4600109/uniks"}, "edited": false, "score": 0, "creation_date": 1424912283, "post_id": 28713620, "comment_id": 45751162, "body": "it show another error &quot;Unable to get the VLOOKUP property of the WorksheetFunction class&quot;"}, {"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "reply_to_user": {"reputation": 59, "user_id": 4600109, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/60Zvk.jpg?s=128&g=1", "display_name": "uniks", "link": "https://stackoverflow.com/users/4600109/uniks"}, "edited": false, "score": 0, "creation_date": 1424940780, "post_id": 28713620, "comment_id": 45759850, "body": "Thats mean that Vlookup is unable to find a match. Something&#39;s wrong with your code. You&#39;ve got this line in your question <code>set look harga book1.sheets(&quot;harga&quot;).range(&quot;B4:E50&quot;)</code>, did you correct it?"}, {"owner": {"reputation": 59, "user_id": 4600109, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/60Zvk.jpg?s=128&g=1", "display_name": "uniks", "link": "https://stackoverflow.com/users/4600109/uniks"}, "edited": false, "score": 0, "creation_date": 1425608117, "post_id": 28713620, "comment_id": 46043640, "body": "Sorry for taking too long to response I tried to change my code &quot;Sub Worksheet_Change&quot; into &quot;Sub CommandButton1_Click&quot; and then my code works just fine Thanks for your help"}], "tags": [], "owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "is_accepted": true, "score": 1, "last_activity_date": 1424852759, "last_edit_date": 1424852759, "creation_date": 1424849886, "answer_id": 28713620, "question_id": 28713388, "link": "https://stackoverflow.com/questions/28713388/looping-vlookup-inside-an-if-in-va/28713620#28713620", "title": "Looping VLOOKUP inside an IF in VA", "body": "<p>Write your code like follow:</p>\n\n<pre><code>Dim book1 As Workbooks\nDim customer As Range, rang As Range, jdiskon As Range, pelanggan As Range, lookharga As Range, diskon As Range\nDim rout(1 To 10) As Variant, i As Long\nSet book1 = Workbooks(\"database.xlsx\")\nSet rang = book1.Sheets(\"DB\").Range(\"A6:N84\")\nSet lookharga = book1.Sheets(\"harga\").Range(\"B4:E50\")\n\nSet pelanggan = Range(\"E7\")\nSet alamat = Range(\"E8\")\nSet jdiskon = Range(\"M26\")\nSet diskon = Range(\"P3\")\n\ngetalamat = Application.WorksheetFunction.VLookup(pelanggan, rang, 13, False)\njenisdiskon = Application.WorksheetFunction.VLookup(pelanggan, rang, 10, False)\ngetdiskon = Application.WorksheetFunction.VLookup(pelanggan, rang, 8, False)\n'New code with if statement starts from here\nalamat.Value = getalamat\njdiskon.Value = jenisdiskon\ndiskon.Value = getdiskon / 100\n\nFor i = 13 To 17\n\ngetharga = Application.WorksheetFunction.VLookup(Range(\"D\" &amp; i) &amp; Range(\"E\" &amp; i), lookharga, 4, False)\n\nIf jdiskon = \"nett\" Then\n    Range(\"M\" &amp; i).Value = getharga - (getharga * diskon)\n\nElseIf jdiskon.Value = \"pot\" Then\n    Range(\"M\" &amp; i).Value = getharga\n    Range(\"L25\").Value = diskon\nEnd If\n' new code with if statement ends here\nNext\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 4600109, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/60Zvk.jpg?s=128&g=1", "display_name": "uniks", "link": "https://stackoverflow.com/users/4600109/uniks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 28713620, "answer_count": 1, "score": 2, "last_activity_date": 1424852759, "creation_date": 1424849006, "last_edit_date": 1424849476, "question_id": 28713388, "link": "https://stackoverflow.com/questions/28713388/looping-vlookup-inside-an-if-in-va", "title": "Looping VLOOKUP inside an IF in VA", "body": "<p>I am a VBA newbie and just started learning about loops.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>sub worksheet_change(byval target as range)\n\napplication.screenupdating = false\napplication.enableevents = false\n\ndim book1 as workbooks\ndim customer as range, rang as range, jdiskon as range, pelanggan as range, lookharga as range, diskon as range\ndim rout(1 to 10) as variant, i as long\nset book1 = workbooks(\"database.xlsx\")\nset rang = book1.sheets(\"DB\").range(\"A6:N84\")\nset look harga book1.sheets(\"harga\").range(\"B4:E50\")\n\nset pelanggan = range(\"E7\")\nset alamat = range(\"E8\")\nset jdiskon = range(\"M26\")\nset diskon = range(\"P3\")\n\ngetalamat = application.worksheetfunction.vlookup(pelanggan, rang, 13, false)\njenisdiskon = application.worksheetfunction.vlookup(pelanggan, rang, 10, false)\ngetdiskon = application.worksheetfunction.vlookup(pelanggan, rang, 8, false)\ngetharga = application.worksheetfunction.vlookup(range(\"D13\") &amp; range(\"E13\"), lookharga, 4, false)\ngetharga1 = application.worksheetfunction.vlookup(range(\"D14\") &amp; range(\"E14\"), lookharga, 4, false)\ngetharga2 = application.worksheetfunction.vlookup(range(\"D15\") &amp; range(\"E15\"), lookharga, 4, false)\ngetharga3 = application.worksheetfunction.vlookup(range(\"D16\") &amp; range(\"E16\"), lookharga, 4, false)\ngetharga4 = application.worksheetfunction.vlookup(range(\"D17\") &amp; range(\"E17\"), lookharga, 4, false)\n\nalamat.value = getalamat\njdiskon.value = jenisdiskon\ndiskon.value = getdiskon / 100\n\nif jdiskon = \"nett\" then\n    range(\"M13\").value = getharga - (getharga * diskon)\n    range(\"M14\").value = getharga1 - (getharga1 * diskon)\n    range(\"M15\").value = getharga2 - (getharga2 * diskon)\n    range(\"M16\").value = getharga3 - (getharga3 * diskon)\n    range(\"M17\").value = getharga4 - (getharga4 * diskon)\nelseif jdiskon.value = \"pot\" then\n    range(\"M13\").value = getharga\n    range(\"M14\").value = getharga1\n    range(\"M15\").value = getharga2\n    range(\"M16\").value = getharga3\n    range(\"M17\").value = getharga4\n    range(\"L25\").value = diskon\nend if\n\napplication.enableevents = true\n\nend sub\n</code></pre>\n\n<p>Right now I'm just using the manual code by copy/pasting.  However, I want to simplify the code within the IF by using loops because it seems to be more efficient.</p>\n\n<p>What's the best way to do this?</p>\n"}, {"tags": ["excel", "vba", "row", "increment", "delete-row"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1424848652, "post_id": 28713111, "comment_id": 45714420, "body": "<code>lRow &gt;= 1</code> only gets checked <i>once for each pass through the loop</i>, so within the loop you can still decrement <code>lRow</code> to be &lt; 1."}, {"owner": {"reputation": 31, "user_id": 4326008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf093797573d31af350aab72fa6c0ed5?s=128&d=identicon&r=PG&f=1", "display_name": "JamesK", "link": "https://stackoverflow.com/users/4326008/jamesk"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1425280168, "post_id": 28713111, "comment_id": 45881874, "body": "I see that makes sense, thank you for the reply."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4326008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf093797573d31af350aab72fa6c0ed5?s=128&d=identicon&r=PG&f=1", "display_name": "JamesK", "link": "https://stackoverflow.com/users/4326008/jamesk"}, "edited": false, "score": 0, "creation_date": 1425280800, "post_id": 28713414, "comment_id": 45882128, "body": "Thank you @L42, I&#39;m getting an error with this script saying &quot;Invalid Outside Procedure&quot;. Here is what I currently have:"}, {"owner": {"reputation": 31, "user_id": 4326008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf093797573d31af350aab72fa6c0ed5?s=128&d=identicon&r=PG&f=1", "display_name": "JamesK", "link": "https://stackoverflow.com/users/4326008/jamesk"}, "edited": false, "score": 0, "creation_date": 1425280830, "post_id": 28713414, "comment_id": 45882139, "body": "Dim c As Range, rngtodelete As Range For Each c In Sheets(&quot;LoadProfile&quot;).Range(&quot;A1:A9468&quot;) &#39;change this to suit     If c.Value &lt;&gt; &quot;&quot; Then         If rngtodelete Is Nothing Then Set rngtodelete = c _         Else: Set rngtodelete = Union(rngtodelete, c)    &#39; End If &#39;Next&#39;If Not rngtodelete Is Nothing Then rngtodelete.EntireRow.Delete xlUp"}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 0, "last_activity_date": 1424849118, "creation_date": 1424849118, "answer_id": 28713414, "question_id": 28713111, "link": "https://stackoverflow.com/questions/28713111/delete-incremental-rows-in-excel/28713414#28713414", "title": "Delete Incremental Rows in Excel", "body": "<p>Tim is absolutely right. Now, I think deleting rows one by one is costly in terms of speed, so might as well try below.</p>\n\n<pre><code>Dim c As Range, rngtodelete As Range\nFor Each c in Sheets(\"SheetName\").Range(\"A1:A9468\") 'change this to suit\n    If c.Value &lt;&gt; \"\" Then\n        If rngtodelete Is Nothing Then Set rngtodelete = c _\n        Else Set rngtodelete = Union(rngtodelete, c)\n    End If\nNext\nIf not rngtodelete Is Nothing Then rngtodelete.EntireRow.Delete xlUp\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 4326008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf093797573d31af350aab72fa6c0ed5?s=128&d=identicon&r=PG&f=1", "display_name": "JamesK", "link": "https://stackoverflow.com/users/4326008/jamesk"}, "edited": false, "score": 0, "creation_date": 1425280910, "post_id": 28713952, "comment_id": 45882177, "body": "Hello @brettdj My apologies, I am using Excel 2013. Unfortunately only one of the 3 rows i need to delete is blank. The others have content."}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 0, "last_activity_date": 1424851166, "creation_date": 1424851166, "answer_id": 28713952, "question_id": 28713111, "link": "https://stackoverflow.com/questions/28713111/delete-incremental-rows-in-excel/28713952#28713952", "title": "Delete Incremental Rows in Excel", "body": "<p>If the rows are truly blank then you can do this in a single shot with <code>SpecialCells</code>. Assuming that column A contains the blank data:</p>\n\n<pre><code>Sub Cull()\n' in case there are no blank cells\nOn Error Resume Next\nRange(\"A1:A9468\").SpecialCells(xlCellTypeBlanks).EntireRow.Delete\nEnd Sub\n</code></pre>\n\n<p>You haven't specified your Excel version, but given you data layout you won't be running into the <a href=\"http://www.excelguru.ca/blog/2009/07/23/excel-2010-finally-fixes-specialcells-8192-limit/\" rel=\"nofollow\">SpecialCells 8192 Limit</a> that occurs in xl07 and earlier.</p>\n"}], "owner": {"reputation": 31, "user_id": 4326008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf093797573d31af350aab72fa6c0ed5?s=128&d=identicon&r=PG&f=1", "display_name": "JamesK", "link": "https://stackoverflow.com/users/4326008/jamesk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 266, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1436102524, "creation_date": 1424847937, "last_edit_date": 1436102524, "question_id": 28713111, "link": "https://stackoverflow.com/questions/28713111/delete-incremental-rows-in-excel", "title": "Delete Incremental Rows in Excel", "body": "<p>I have a full year of of 24 hour, hourly data with 3 unnecessary rows between each day (set of 24 hour rows). I would like to delete all of these unnecessary rows. My current method is to increment 24 spaces up, delete 3 rows, and then loop back to the 24 space increment until the value of the last row (lRow) is &lt;1 in which case the loop will stop. Please see below for my current code:</p>\n\n<pre><code>Sub Delete_Rows()\n\n    Dim lRow\n    lRow = 9468\n\n    Do While lRow &gt;= 1\n        lRow = lRow - 24\n        Sheets(\"Sheet 1\").Rows(lRow).Delete\n        lRow = lRow - 1\n        Sheets(\"Sheet 1\").Rows(lRow).Delete\n        lRow = lRow - 1\n        Sheets(\"Sheet 1\").Rows(lRow).Delete\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>However, I keep on getting a Run Time Error: 1004 on this line:</p>\n\n<pre><code>Sheets(\"Sheet 1\").Rows(lRow).Delete\n</code></pre>\n\n<p>I can't figure out why that is and any help or alternative methods to accomplishing this goal are appreciated.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4604355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11c783971a4ad1d7e380a24e2fa68263?s=128&d=identicon&r=PG&f=1", "display_name": "Jayant Sharma", "link": "https://stackoverflow.com/users/4604355/jayant-sharma"}, "edited": false, "score": 0, "creation_date": 1425015471, "post_id": 28732685, "comment_id": 45797021, "body": "thanks @Tony for your answer, I will try to create the macro on my own with proper documentation. One more thing is that can please dwelve more on the third condition i have put in the question.. Meaning that after the name and date, i would like to search on the basis of activity and group them together, with adding the number of hourse of the corresponding values. Thanks!"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 3, "user_id": 4604355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11c783971a4ad1d7e380a24e2fa68263?s=128&d=identicon&r=PG&f=1", "display_name": "Jayant Sharma", "link": "https://stackoverflow.com/users/4604355/jayant-sharma"}, "edited": false, "score": 0, "creation_date": 1425030402, "post_id": 28732685, "comment_id": 45803444, "body": "@JayantSharma  You do not explain condition 3 in sufficient detail. Does &quot;group the activities based on their names&quot; mean you want to merge all the rows for a single fruit? What is the &quot;hours tab&quot;? Notice how I created simple macros that each explored how to solve a small part of your total requirement. I know most of the VBA date and time functions but I have never needed to use them as I believe you wish to. In my macro <code>Test3</code>, I experimented with the date functions and discovered how to calculate Monday and Friday of the current week. Can you do something similar with condition 3?"}, {"owner": {"reputation": 3, "user_id": 4604355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11c783971a4ad1d7e380a24e2fa68263?s=128&d=identicon&r=PG&f=1", "display_name": "Jayant Sharma", "link": "https://stackoverflow.com/users/4604355/jayant-sharma"}, "edited": false, "score": 0, "creation_date": 1425363252, "post_id": 28732685, "comment_id": 45921224, "body": "thanks @TonyDallimore. I have almost covered the first 2 conditions by creating a macro using your inputs but I think a better way of solving condition 3 would be to provide the data in a pivot table and follow the condition."}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": true, "score": 0, "last_activity_date": 1424912357, "creation_date": 1424912357, "answer_id": 28732685, "question_id": 28713039, "link": "https://stackoverflow.com/questions/28713039/need-a-excel-macro-on-to-search-and-copy-on-the-basis-of-multiple-criteria/28732685#28732685", "title": "Need a excel macro on to search and copy on the basis of multiple criteria", "body": "<p>I believe the points below will allow you to progress although it cannot be a full answer because you do not give enough information for that.  Warning: I do not explain my macros fully.  Look up Help for the statements I use and try to work out why they have the effect they do.  Come back with questions as necessary but the more you can work out for yourself, the more you will develop your VBA knowledge.</p>\n\n<hr>\n\n<pre><code>lngLstRow = ActiveSheet.UsedRange.Rows.Count\n</code></pre>\n\n<p>It is best to avoid <code>ActiveSheet</code> and <code>UsedRange</code> unless you know exactly what you are doing.</p>\n\n<p>If you use the active worksheet, you are relying on the user having the correct worksheet active when they start the macro.  You may one day want to allow the user to select which worksheet is the target for a macro but I doubt that is the case here.  If possible be explicit. For example:</p>\n\n<pre><code>With Worksheets(\"New Data\")\n\n  .Range(\"A1\").Values = \"Date\"\n\nEnd With\n</code></pre>\n\n<p>Above I explicit specify the worksheet I wish to use.  It does not matter what worksheet is active when the user starts the macro.  If I come back to the macro after six months, I do not have to remember which of the 20 worksheets it operates on.</p>\n\n<p>Excel\u2019s definition of <code>UsedRange</code> does not always mean what the programmer thinks its means.  Do not use it until you have tried it out on a variety of test worksheets.  In particular, try (1) formatting cells outside the range with values and (2) leaving the left columns and top rows unused.  Try <code>Debug.Print .UsedRange.Address</code>.  You will be surprised at some of the ranges you get.</p>\n\n<p>Create a new workbook.  Place values in E4, C7 and B10.  Merge cells F12 and F13 and place a value in the merged area.  It does not matter what those values are.</p>\n\n<p>Copy this macro to a module and run it:</p>\n\n<pre><code>Option Explicit\nSub Test1()\n\n  Dim ColFinal As Long\n  Dim RowFinal As Long\n  Dim RowFinalC As Long\n\n  With Sheets(\"Sheet1\")\n\n    RowFinal = .Cells.Find(What:=\"*\", After:=.Range(\"A1\"), LookIn:=xlFormulas, _\n                           SearchOrder:=xlByRows, _\n                           SearchDirection:=xlPrevious).Row\n    ColFinal = .Cells.Find(What:=\"*\", After:=.Range(\"A1\"), LookIn:=xlFormulas, _\n                           SearchOrder:=xlByColumns, _\n                           SearchDirection:=xlPrevious).Column\n\n    RowFinalC = .Cells(Rows.Count, \"C\").End(xlUp).Row\n\n  End With\n\n  Debug.Print \"ColFinal\" = ColFinal\n  Debug.Print \"RowFinal\" = RowFinal\n  Debug.Print \"RowFinalC\" = RowFinalC\n\nEnd Sub\n</code></pre>\n\n<p>The output will be:</p>\n\n<pre><code>ColFinal=5\nRowFinal=12\nRowFinalC=7\n</code></pre>\n\n<p>In most cases, <code>Find</code> is the best way of locating the last row and/or column of a worksheet.  <code>What:=\"*\"</code>means look for anything.  Notice that I have different values for <code>SearchOrder</code>.  It does not matter that the worksheet is not rectangular; the last row and the last column do not have to be the same cell.</p>\n\n<p>However, there is no method of finding the last row or column that works in every situation.  <code>Find</code> has not \u201cseen\u201d the merged cell when searching by column.  (Warning, I am using an old version of Excel and this may have been fixed in your version.)</p>\n\n<p>You want the last used cell in column J.  My technique for finding the last row in column C may be the easiest technique for you.</p>\n\n<hr>\n\n<p>Consider:</p>\n\n<pre><code>intFruitMax = 3\nReDim strFruit(1 To intFruitMax)\n\nstrFruit(1) = \"A\"\nstrFruit(2) = \"B\"\nstrFruit(3) = \"C\"\n\n    For i = 1 To intFruitMax\n\n    Next i\n</code></pre>\n\n<p>There is nothing wrong with your code but this macro shows a different approach that may be more convenient:</p>\n\n<pre><code>Sub Test2()\n\n  Dim Fruit() As Variant\n  Dim InxFruit As Long\n\n  Fruit = Array(\"A\", \"B\", \"C\")\n\n  For InxFruit = LBound(Fruit) To UBound(Fruit)\n    Debug.Print Fruit(InxFruit)\n  Next\n\nEnd Sub\n</code></pre>\n\n<p>It is becoming uncommon to have a three letter prefix specifying the type of a variable.  As someone asked: \u201cIs strFruit really more useful than Fruit?\u201d. Avoid variable names like <code>i</code>.  It probably does not matter with such a small macro but I have tried to decipher macros with a bunch of meaningless names and can assure you it is a nightmare.  <code>InxFruit</code> says this is an index into array Fruit.  I can look at macros I wrote years ago and immediately know what all the variables are.</p>\n\n<p><code>LBound(Fruit)</code> will always be zero if you use <code>Array</code>.  Note also that <code>Fruit</code> has to be of type <code>Variant</code>.  The advantage is that when you want to add fruits D and E, you just change to:</p>\n\n<pre><code> Fruit = Array(\"A\", \"B\", \"C\", \"D\", \"E\")\n</code></pre>\n\n<hr>\n\n<p>If the name is found it will proceed to check the 'submitted' column and check whether the submitted date is between a weekly date. (like if the date is between 2/23/2015-2/27/2015).</p>\n\n<p>Your technique for finding rows for interesting fruit is not the best technique but I think it is good enough.  I am giving you enough to think about without discussing other approaches.</p>\n\n<p>I am guessing you want to know if the date is between Monday and Friday of the current week.</p>\n\n<p><code>Now()</code> gives you the current date and time.  The next macro shows how to calculate the Monday and Friday for any day of a week.  If you chose to copy this technique, please document it properly for the benefit of the poor sod who has to update your macro in a year\u2019s time.  This macro is all clever arithmetic with functions and constants.  I do not like clever code, unless it is properly documented, because it is usually the programmer showing off rather than solving the problem using the simplest method.</p>\n\n<pre><code>Sub Test3()\n\n  Dim Friday As Date\n  Dim InxDate As Long\n  Dim Monday As Date\n  Dim TestDates() As Variant\n  Dim Today As Date\n  Dim TodayDoW As Long\n\n  TestDates = Array(DateSerial(2015, 2, 22), DateSerial(2015, 2, 23), _\n                    DateSerial(2015, 2, 24), DateSerial(2015, 2, 25), _\n                    DateSerial(2015, 2, 26), DateSerial(2015, 2, 27), _\n                    DateSerial(2015, 2, 28), Now())\n\n  For InxDate = 0 To UBound(TestDates)\n    Today = TestDates(InxDate)\n    TodayDoW = Weekday(Today)\n    Monday = DateSerial(Year(Today), Month(Today), Day(Today) + vbMonday - TodayDoW)\n    Friday = DateSerial(Year(Today), Month(Today), Day(Today) + vbFriday - TodayDoW)\n\n    Debug.Print \"Today=\" &amp; Format(Today, \"ddd d mmm yy\") &amp; _\n                \"  Monday=\" &amp; Format(Monday, \"ddd d mmm yy\") &amp; _\n                \"  Friday=\" &amp; Format(Friday, \"ddd d mmm yy\")\n  Next\n\nEnd Sub\n</code></pre>\n\n<p>Note that Excel holds dates as numbers so you can write <code>If Monday &lt;= TransDate And TransDate &lt;= Friday Then</code>.</p>\n\n<hr>\n\n<p>Your technique for moving data from one worksheet to another is clumsy.  This macro moves every row with \u201cA\u201d, \u201ca\u201d, \u201cB\u201d, \u201cb\u201d, \u201cC\u201d or \u201cc\u201d in column J from worksheet \u201cSheet2\u201d to \u201cSheet3\u201d.  I believe you will agree the innermost loop in clearer than yours.</p>\n\n<pre><code>Sub Test4()\n\n  ' I assume row 1 contains column headers and is not to be copied\n  ' to the new worksheet.  Constants are a good way of making such\n  ' assumptions explicit and easy to change if for example to add\n  ' a second header row\n  Const RowSht2DataFirst  As Long = 2   ' This only applies to Sheet2\n  Const ColFruit As Long = 10           ' This applies to both sheets\n\n  Dim Fruit() As Variant\n  Dim FruitCrnt As String\n  Dim InxFruit As Long\n  Dim RowSht2Crnt As Long\n  Dim RowSht2Last As Long\n  Dim RowSht3Next As Long\n  Dim Wsht2 As Worksheet\n  Dim Wsht3 As Worksheet\n\n  ' It takes VBA some time to evaluate Worksheets(\"Sheet2\") and\n  ' Worksheets(\"Sheet3\").  This means it only has to do it once.\n  Set Wsht2 = Worksheets(\"Sheet2\")\n  Set Wsht3 = Worksheets(\"Sheet3\")\n  ' BTW Please don't use the default names for a real workbook.\n  ' It is so much easier to understand code with meaingful names\n\n  Fruit = Array(\"A\", \"B\", \"C\")\n\n  With Wsht3\n    ' Place new rows under any existing ones.\n    RowSht3Next = .Cells(Rows.Count, ColFruit).End(xlUp).Row + 1\n  End With\n\n  With Wsht2\n\n    RowSht2Last = .Cells(Rows.Count, ColFruit).End(xlUp).Row\n\n      For RowSht2Crnt = RowSht2DataFirst To RowSht2Last\n        FruitCrnt = UCase(.Cells(RowSht2Crnt, ColFruit).Value)\n        For InxFruit = LBound(Fruit) To UBound(Fruit)\n          If Fruit(InxFruit) = FruitCrnt Then\n            .Rows(RowSht2Crnt).Copy Destination:=Wsht3.Cells(RowSht3Next, 1)\n            RowSht3Next = RowSht3Next + 1\n            Exit For\n          End If  ' Match on fruit\n        Next InxFruit\n      Next RowSht2Crnt\n\n  End With  ' Wsht3\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4604355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11c783971a4ad1d7e380a24e2fa68263?s=128&d=identicon&r=PG&f=1", "display_name": "Jayant Sharma", "link": "https://stackoverflow.com/users/4604355/jayant-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 383, "favorite_count": 1, "accepted_answer_id": 28732685, "answer_count": 1, "score": 0, "last_activity_date": 1424912357, "creation_date": 1424847554, "last_edit_date": 1424861827, "question_id": 28713039, "link": "https://stackoverflow.com/questions/28713039/need-a-excel-macro-on-to-search-and-copy-on-the-basis-of-multiple-criteria", "title": "Need a excel macro on to search and copy on the basis of multiple criteria", "body": "<p>I am trying to create a VBA macro which will search the rows on the basis of the following criteria:</p>\n\n<ol>\n<li><p>First it will look for a name specified in the macro in the name column.</p></li>\n<li><p>If the name is found it will proceed to check the 'submitted' column and check whether the submitted date is between a weekly date. (like if the date is between 2/23/2015-2/27/2015).</p></li>\n<li><p>If the date lies between the specified dates then the macro will group the activities based on their names and add the number of hours based on the values in the hours tab.\nThis whole data is finally to be copied and pasted into another worksheet in the same workbook.</p></li>\n</ol>\n\n<p>So far I have only been able to get to searching for the names part and being  a newbie to VBA macro I have absolutely no idea of how to proceed. </p>\n\n<p>So far I have done pathetically since yesterday to come up with a solution. Please help. I am attaching my code, though I wonder if its of any use</p>\n\n<pre><code>Sub Demo()\n    Dim rngCell As Range\n    Dim lngLstRow As Long\n    Dim strFruit() As String\n    Dim intFruitMax As Integer\n\n    intFruitMax = 3\n    ReDim strFruit(1 To intFruitMax)\n\n    strFruit(1) = \"A\"\n    strFruit(2) = \"B\"\n    strFruit(3) = \"C\"\n\n    lngLstRow = ActiveSheet.UsedRange.Rows.Count\n\n    For Each rngCell In Range(\"J2:J\" &amp; lngLstRow)\n        For i = 1 To intFruitMax\n            If strFruit(i) = rngCell.Value Then\n                rngCell.EntireRow.Copy\n                Sheets(\"Inventory\").Select\n                Range(\"A65536\").End(xlUp).Offset(1, 0).Select\n                Selection.PasteSpecial xlPasteValues\n                Sheets(\"Sheet1\").Select\n            End If\n        Next i\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 1, "creation_date": 1424846370, "post_id": 28712366, "comment_id": 45713410, "body": "You need something to exit you out of that loop. Change it to a do while loop with an exit instruction."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 1, "creation_date": 1424846918, "post_id": 28712366, "comment_id": 45713637, "body": "Quoted from this <a href=\"http://www.cpearson.com/excel/ErrorHandling.htm\" rel=\"nofollow noreferrer\">Error handling link</a> <code>When the first error is raised, execution transfers to the line following  reqLangVisible:. The error hander is still active when the second error occurs, and therefore the second error is not trapped by the On Error statement.</code> Furthermore from the same link: <code>You can&#39;t use  to the On Error Goto &lt;label&gt;:  statement merely skip over lines</code>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1424849327, "post_id": 28712366, "comment_id": 45714738, "body": "Are you using error handling to avoid having to get the count of the collection returned by <code>SelectContentControlsByXXX</code> or using a For Each loop?"}, {"owner": {"reputation": 91, "user_id": 4566870, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b401fe7a3b8d296cb4946703b214c49?s=128&d=identicon&r=PG&f=1", "display_name": "blackwind", "link": "https://stackoverflow.com/users/4566870/blackwind"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1424888894, "post_id": 28712366, "comment_id": 45740056, "body": "@TimWilliams: not sure what you mean. I have a limited number of CCs, (say, 82) and I want the code to loop until it hits 83. Once it hits 83, it triggers an error, which then I use as an indicator that it&#39;s time to end the loop."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1424889221, "post_id": 28712366, "comment_id": 45740246, "body": "What I&#39;m saying is typically you only use error handling for dealing with <i>unexpected or unpredictable</i> situations, such as not being able to access a drive, or finding you have no network access.  Error handling is not intended as a substitute for reasonable checks which could otherwise be done.  i.e. collections have a <code>Count</code> property which you can use when looping over their items, so avoiding any error caused by trying to access <code>Item(n+1)</code> when there are only <code>n</code> items (and you <i>know</i> <code>n</code> from <code>Count</code>).  Alternatively, use a <code>For Each</code> loop."}, {"owner": {"reputation": 91, "user_id": 4566870, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b401fe7a3b8d296cb4946703b214c49?s=128&d=identicon&r=PG&f=1", "display_name": "blackwind", "link": "https://stackoverflow.com/users/4566870/blackwind"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1425088351, "post_id": 28712366, "comment_id": 45832433, "body": "@TimWilliams, could you please show how this particular issue would be solved with a <code>For Each</code> loop? That seems to be the only way to make this work."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 4566870, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b401fe7a3b8d296cb4946703b214c49?s=128&d=identicon&r=PG&f=1", "display_name": "blackwind", "link": "https://stackoverflow.com/users/4566870/blackwind"}, "edited": false, "score": 0, "creation_date": 1424877359, "post_id": 28713032, "comment_id": 45731874, "body": "Tried it, but it only creates an endless loop. It ends up stuck in the first one. Maybe it&#39;s because the next line of code is <code>i = i + 1</code> instead of <code>On Error Goto 0</code>?"}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 0, "last_activity_date": 1424847535, "creation_date": 1424847535, "answer_id": 28713032, "question_id": 28712366, "link": "https://stackoverflow.com/questions/28712366/on-error-works-in-first-and-doesnt-work-in-second-instance-bug/28713032#28713032", "title": "On Error works in first and doesn&#39;t work in second instance. Bug?", "body": "<p>So if you've read my comment, and to formally answer your question, it is not a bug. <br>\nYou just need to use <code>Error Handling Routines</code> correctly. <br>\nWhat you're trying to do is somewhat like below. HTH.</p>\n\n<pre><code>Select Case reqlang\n\nCase \"CRO\", \"ENG\"\n    On Error Resume Next '~~&gt; ignores the error when encountered\n    '~~&gt; Your loop which possibly creates the error goes here\n    On Error Goto 0 '~~&gt; resets the actively triggered error handling\n\nCase \"CROENG\"\n    On Error Resume Next '~~&gt; ignores the error when encountered\n    '~~&gt; Your loop which possibly creates the error goes here\n    On Error Goto 0 '~~&gt; resets the actively triggered error handling\n\nEnd Select\n\nMsgBox \"Success\"\n</code></pre>\n\n<p>But as the link suggest, you need to handle errors and not simply disregard them.<br> Try cheking on the actual error and find a way to correct it or avoid it.<br>\nYou'll be surprise that you won't even be needing the <code>Error Handling Routine</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1425160171, "creation_date": 1425160171, "answer_id": 28787333, "question_id": 28712366, "link": "https://stackoverflow.com/questions/28712366/on-error-works-in-first-and-doesnt-work-in-second-instance-bug/28787333#28787333", "title": "On Error works in first and doesn&#39;t work in second instance. Bug?", "body": "<p>Typically you only use error handling for dealing with <em>unexpected or unpredictable situations</em>, such as not being able to access a drive, or finding you have no network access. </p>\n\n<p>Error handling is not intended as a substitute for reasonable checks which could otherwise be done. i.e. collections have a Count property which you can use when looping over their items, so avoiding any error caused by trying to access Item(n+1) when there are only n items (and here you <em>know</em> n from <code>Count</code>). Alternatively, use a For Each loop.</p>\n\n<p>Here's some sample code demonstrating use of two methods for looping over your controls:</p>\n\n<pre><code>Sub Tester()\n\n    Dim cc1 As ContentControls, cc2 As ContentControls\n    Dim c, i As Long\n\n    With ActiveDocument\n        Set cc1 = .SelectContentControlsByTag(\"tbTag\")\n        Set cc2 = .SelectContentControlsByTitle(\"tbTitle\")\n    End With\n\n    Debug.Print \"cc1 has \" &amp; cc1.Count\n    Debug.Print \"cc2 has \" &amp; cc2.Count\n\n    'use the Count property\n    For i = 1 To cc1.Count\n        Set c = cc1(i)\n        c.Range.Font.Hidden = True\n    Next i\n\n    'use a For Each loop\n    For Each c In cc2\n        c.Range.Font.Hidden = False\n    Next c\n\nEnd Sub\n</code></pre>\n\n<p>This is the type of scenario for which this type of flow control is designed.</p>\n\n<p>Applied to your original code:</p>\n\n<pre><code>Sub Tester2()\n    Dim reqLang, cc As ContentControls, c\n\n    reqLang = \"ENG\"\n\n    Select Case reqLang\n\n        Case \"CRO\", \"ENG\"\n\n            Set cc = ActiveDocument.SelectContentControlsByTag(\"ccCROENG\")\n            SetTextHidden cc, True\n\n            Set cc = ActiveDocument.SelectContentControlsByTitle(\"cc\" &amp; reqLang)\n            SetTextHidden cc, False\n\n        Case \"CROENG\"\n\n            Set cc = ActiveDocument.SelectContentControlsByTag(\"ccCROENG\")\n            SetTextHidden cc, False\n\n    End Select\n\n    MsgBox \"Success!\" '-- yeah really\n\nEnd Sub\n\nSub SetTextHidden(cc As ContentControls, MakeHidden As Boolean)\n    Dim c\n    For Each c In cc\n        c.Range.Font.Hidden = MakeHidden\n    Next c\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 4566870, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b401fe7a3b8d296cb4946703b214c49?s=128&d=identicon&r=PG&f=1", "display_name": "blackwind", "link": "https://stackoverflow.com/users/4566870/blackwind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "accepted_answer_id": 28787333, "answer_count": 2, "score": 0, "last_activity_date": 1425160171, "creation_date": 1424844703, "last_edit_date": 1424848142, "question_id": 28712366, "link": "https://stackoverflow.com/questions/28712366/on-error-works-in-first-and-doesnt-work-in-second-instance-bug", "title": "On Error works in first and doesn&#39;t work in second instance. Bug?", "body": "<p>I have a very strange problem here. Here's the code:</p>\n\n<pre><code>reqLang = \"ENG\"\n    Select Case reqLang\n        Case \"CRO\", \"ENG\"\n            'first loop -------------------------------------\n            On Error GoTo reqLangVisible\n            i = 1\n            'Loop until ccCROENG's are all hidden and then go to reqLangVisible.\n            Do\n                ActiveDocument.SelectContentControlsByTag(\"ccCROENG\")(i) _\n                    .Range.Font.Hidden = True 'hides all CCs\n                i = i + 1\n            Loop\nreqLangVisible:\n            'second loop -------------------------------------\n            On Error GoTo langOut\n            i = 1\n            'Loop until ccreqLang's are all visible and then go to langOut.\n            Do\n                ActiveDocument.SelectContentControlsByTitle(\"cc\" &amp; reqLang)(i) _\n                    .Range.Font.Hidden = False 'activates reqLang CCs\n                i = i + 1\n            Loop ' CAN'T GET OUT -----------------------------------\n        Case \"CROENG\"\n            i = 1\n            'Loop until ccCROENG's are all visible and then go to langOut.\n            Do\n                On Error GoTo langOut\n                    ActiveDocument.SelectContentControlsByTag(\"ccCROENG\")(i) _\n                        .Range.Font.Hidden = False 'Shows all CCs\n                i = i + 1\n            Loop\n    End Select\nlangOut:\nMsgBox \"Success!\" '------- yeah, not really.\nStop\n</code></pre>\n\n<p>I hope it's clear enough what it's trying to do (at least programming-wise). I have multiple <code>ContentControls(CCs)</code> with same titles and tags. The problem I end up with is marked with <em>CAN'T GET OUT</em>, because, you guessed it - I can't get of this second loop! I end up with the <code>Out of range error</code> because it runs out of <code>CCs</code>.</p>\n\n<p>What's even weirder is that it actually did get out of the first loop which has the exact same On Error statement, thought pointing to a different section.\nIs it me, or did I just - however unlikely - run onto a bug in VBA?\nIn any case, is there a solution or at least a workaround?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1424840906, "post_id": 28711422, "comment_id": 45711496, "body": "It&#39;s too bad your department names start in B1. An <code>.AutoFilter</code> would do this nicely but requires a header row."}, {"owner": {"reputation": 145, "user_id": 4601655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-bMOUaEZ_Yh4/AAAAAAAAAAI/AAAAAAAAAFM/oa9q6gxp9Q8/photo.jpg?sz=128", "display_name": "John Shaw", "link": "https://stackoverflow.com/users/4601655/john-shaw"}, "edited": false, "score": 0, "creation_date": 1424842629, "post_id": 28711422, "comment_id": 45712028, "body": "I could insert a header row first before anything else, right?  I see what you&#39;re getting at.  We could simply use .autofilter to make visible those rows of items that correspond to the specific depts.  I get that, now.  Huh.  But, we are working with Federal Gov Data that requires us to break items out by spreadsheet with no other data (unfilitered data) on the sheet because we are uploading this sheet into yet another database."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1424843235, "creation_date": 1424843235, "answer_id": 28712051, "question_id": 28711422, "link": "https://stackoverflow.com/questions/28711422/dynamic-range-selection-new-worksheets/28712051#28712051", "title": "Dynamic Range Selection &amp; New Worksheets", "body": "<p>If you decide to insert a header row, this routine uses <code>.AutoFilter</code> to split out the data. In addition, it makes use of the unique key property of a <code>Scripting.Dictionary</code>. You will have to go into the VBE's Tools \u25ba References and add the <strong>Microsoft Scripting Runtime</strong> to your project.</p>\n\n<pre><code>Sub Split_Depts()\n    Dim b As Long, w As Long\n    Dim dDEPTs As New Scripting.Dictionary\n    dDEPTs.CompareMode = TextCompare\n    For w = 2 To Sheets.Count\n        dDEPTs.Add Key:=Sheets(w).Name, Item:=w ' no need to check if dDEPTs.Exists, ws names are unique\n    Next w\n    With Sheet2.Cells(1, 1).CurrentRegion  'change to your own sheet codename\n        For b = 2 To .Rows.Count\n            If Not dDEPTs.Exists(Trim(.Cells(b, \"B\").Value)) Then\n                Sheets.Add after:=Sheets(Sheets.Count)\n                Sheets(Sheets.Count).Name = Trim(.Cells(b, \"B\").Value)\n                dDEPTs.Add Key:=Sheets(Sheets.Count).Name, Item:=Sheets.Count\n                If .AutoFilter Then .AutoFilter\n                .AutoFilter Field:=2, Criteria1:=dDEPTs.Keys(UBound(dDEPTs.Keys))\n                .Cells.Copy Destination:=Sheets(Sheets.Count).Cells(1, 1)\n                .AutoFilter\n            End If\n        Next b\n    End With\nCleanUp:\n    dDEPTs.RemoveAll\n    Set dDEPTs = Nothing\nEnd Sub\n</code></pre>\n\n<p>If you wanted it any quicker you could add lines to turn off screen updating, disable events, calculation, etc.</p>\n"}], "owner": {"reputation": 145, "user_id": 4601655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-bMOUaEZ_Yh4/AAAAAAAAAAI/AAAAAAAAAFM/oa9q6gxp9Q8/photo.jpg?sz=128", "display_name": "John Shaw", "link": "https://stackoverflow.com/users/4601655/john-shaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424843235, "creation_date": 1424840189, "last_edit_date": 1424842466, "question_id": 28711422, "link": "https://stackoverflow.com/questions/28711422/dynamic-range-selection-new-worksheets", "title": "Dynamic Range Selection &amp; New Worksheets", "body": "<p>An Excel Master Sheet lists Items by Cost Center in Col A and then Dept. in Col B.  I need to create a dynamic range that can identify Items in each row by a specific Dept; then, select those Rows for those Items identified; then, copy and paste those rows onto a New Sheet that's Named for the Respective Dept in Column B.</p>\n\n<p>Assuming that the Dept will always be in Column B, this is the code I've come up with thus far.  This code finds a new Dept. in Col B and adds a new sheet with the same Name.  I need a Code that will select the rows with the same Dept Name; copy the selection, then paste that info onto the newly created Sheet. Does Anyone Have Any Suggestions as to the approach?</p>\n\n<pre><code>Sub Breakout1975()\nDim I As String\nDim First As Variant\n\nRange(\"B1\").Select\nDo Until ActiveCell.Value = \"\"\nActiveCell.Offset(1, 0).Select\n\n  If ActiveCell.Value &lt;&gt; Selection.Offset(-1, 0) Then\n    MsgBox (\"The Program has identified a new Dept. in Cell:\" &amp; \" \" &amp;_\n    ActiveCell.Address)\n    MsgBox (Selection)'just using this as a check for myself\n    Sheets.Add.Name = Selection\n    Worksheets(\"sheet1\").Select 'advance to variable later\n  End If\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1424844542, "post_id": 28710669, "comment_id": 45712657, "body": "What cell are you starting on? The first code line references <code>ActiveCell</code>. Is it J10 on the active worksheet?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1424846182, "creation_date": 1424846182, "answer_id": 28712726, "question_id": 28710669, "link": "https://stackoverflow.com/questions/28710669/reference-a-worksheet-in-vba-using-inputbox/28712726#28712726", "title": "Reference a worksheet in vba using inputbox", "body": "<p>I've removed your <code>.Select</code> statements and resolved the formulas to their xlA1 equivalents. You should proof those carefully as I was counting the alphabet (columns) backwards on my fingers.</p>\n\n<pre><code>Sub GetMPRE_Data()\n    ' GetMPRE_Data Macro\n    ' Gets MPRE data to add to MLEA total\n    ' Keyboard Shortcut: Ctrl+Shift+G\n    Dim vWS As Variant\n    vWS = InputBox(\"Select a worksheet\", \"Workshgeet Slector\", Default:=ActiveSheet.Name)\n    Debug.Print vWS\n    If Len(vWS) Then\n        With ActiveSheet\n            .Range(\"J10\").Resize(1, 6) = _\n              Array(\"Staffed MPRE\", \"Non-Prod MPRE\", \"Staffed Time\", \"Staffed Time Decimal\", \"Non-Productive\", \"Non-Productive Decimal\")\n            .Range(\"J11\").Formula = \"=VLOOKUP(A11,'\" &amp; vWS &amp; \"'!$A$2:E100, 2, FALSE)\"\n            .Range(\"K11\").Formula = \"=VLOOKUP(A11,'\" &amp; vWS &amp; \"'!$A$2:E101, 4, FALSE)\"\n            .Range(\"L11\").Formula = \"=SUM(E11, J11)\"\n            .Range(\"L11\").NumberFormat = \"[h]:mm:ss\"\n            .Range(\"M11\").Formula = \"=L11*24\"\n            .Range(\"M11\").NumberFormat = \"0.0\"\n            .Range(\"N11\").Formula = \"=SUM(F11, K11)\"\n            .Range(\"N11\").NumberFormat = \"[h]:mm:ss\"\n            .Range(\"O11\").Formula = \"=M11*24\"\n            .Range(\"O11\").NumberFormat = \"0.0\"\n            With .Range(\"J11:O30\")\n                .FillDown\n                With .Interior\n                    .Pattern = xlNone\n                    .TintAndShade = 0\n                    .PatternTintAndShade = 0\n                End With\n            End With\n        End With\n    End If\nEnd Sub\n</code></pre>\n\n<p>The <code>VLOOKUP</code> formulas are constructed from concatenated strings using the variant that the input box returned. If you get a File \u25ba Open dialog, then the worksheet name is incorrect. You should be able to write a short loop that verified that the name supplied exists if you want to apply some error control on the worksheet designation process.</p>\n"}], "owner": {"reputation": 1, "user_id": 2939935, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000265797421/picture?type=large", "display_name": "Gustavo Diaz", "link": "https://stackoverflow.com/users/2939935/gustavo-diaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 751, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424846335, "creation_date": 1424835365, "question_id": 28710669, "link": "https://stackoverflow.com/questions/28710669/reference-a-worksheet-in-vba-using-inputbox", "title": "Reference a worksheet in vba using inputbox", "body": "<p>I got this code using the macro recorder but I need to run this macro pulling data from diferent worksheets, What I'm trying to acomplish is to launch the inputbox to tell the formula where to look for the data, my worksheets names are 1,2,3,4 and so on meaning each corresponds to a day of the month.\nIn this example the VLOOKUP formula is referencing worksheet 5 ('5') can you please help me to figure out the code to replace the 5 (in this case) for any other number I set using the inputbox? \nI've tried something like:Dim myNum As String<br>\n        myNum = Application.InputBox(\"Enter Worksheet Number\", Type:=1)\n    but cannot get it work\nthis the sample code:</p>\n\n<pre><code>   Sub GetMPRE_Data()\n'\n' GetMPRE_Data Macro\n' Gets MPRE data to add to MLEA total\n'\n' Keyboard Shortcut: Ctrl+Shift+G\n'\nActiveCell.FormulaR1C1 = \"Staffed MPRE\"\nRange(\"K10\").Select\nActiveCell.FormulaR1C1 = \"Non-Prod MPRE\"\nRange(\"L10\").Select\nActiveCell.FormulaR1C1 = \"Staffed Time\"\nRange(\"M10\").Select\nActiveCell.FormulaR1C1 = \"Staffed Time Decimal\"\nRange(\"N10\").Select\nActiveCell.FormulaR1C1 = \"Non-Productive\"\nRange(\"O10\").Select\nActiveCell.FormulaR1C1 = \"Non-Productive Decimal\"\nRange(\"J11\").Select\nActiveCell.FormulaR1C1 = \"=VLOOKUP(RC[-9],'5'!R[-9]C[-9]:R[89]C[-5],2,FALSE)\"\nRange(\"K11\").Select\nActiveCell.FormulaR1C1 = \"=VLOOKUP(RC[-10],'5'!R[-9]C[-10]:R[90]C[-6],4,FALSE)\"\nRange(\"L11\").Select\nActiveCell.FormulaR1C1 = \"=RC[-7]+RC[-2]\"\nRange(\"L11\").Select\nSelection.NumberFormat = \"[h]:mm:ss\"\nRange(\"M11\").Select\nActiveCell.FormulaR1C1 = \"=RC[-1]*24\"\nRange(\"M11\").Select\nSelection.NumberFormat = \"0.0\"\nRange(\"N11\").Select\nActiveCell.FormulaR1C1 = \"=RC[-8]+RC[-3]\"\nRange(\"N11\").Select\nSelection.NumberFormat = \"[h]:mm:ss\"\nRange(\"O11\").Select\nActiveCell.FormulaR1C1 = \"=RC[-1]*24\"\nRange(\"O11\").Select\nSelection.NumberFormat = \"0.0\"\nRange(\"J11:O11\").Select\nSelection.AutoFill Destination:=Range(\"J11:O30\"), Type:=xlFillDefault\nRange(\"J11:O30\").Select\nRange(\"R28\").Select\nActiveWindow.SmallScroll Down:=-12\nRange(\"J11:J30\").Select\nWith Selection.Interior\n    .Pattern = xlNone\n    .TintAndShade = 0\n    .PatternTintAndShade = 0\nEnd With\nRange(\"J11\").Select\nEnd Sub\n</code></pre>\n\n<p>Any help will be appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 514, "user_id": 2705845, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/BeZbN.jpg?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/2705845/simon"}, "edited": false, "score": 0, "creation_date": 1424834369, "post_id": 28710446, "comment_id": 45709821, "body": "I don&#39;t get it :/ so what is your userform asking? Is it some sort of booking system? So if they put &quot;boat1&quot; in to textbox &quot;name&quot;, and the &quot;date&quot; in to another text box... you want those values to appear in the appriate worksheet right?"}, {"owner": {"reputation": 1, "user_id": 4603794, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EWIJkPo6Hds/AAAAAAAAAAI/AAAAAAAACBY/Z6iny1NW-yI/photo.jpg?sz=128", "display_name": "Barnabe Muzima", "link": "https://stackoverflow.com/users/4603794/barnabe-muzima"}, "reply_to_user": {"reputation": 514, "user_id": 2705845, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/BeZbN.jpg?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/2705845/simon"}, "edited": false, "score": 0, "creation_date": 1425074759, "post_id": 28710446, "comment_id": 45828494, "body": "Hello Simon! that&#39;s exactly my concern,"}, {"owner": {"reputation": 1, "user_id": 4603794, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EWIJkPo6Hds/AAAAAAAAAAI/AAAAAAAACBY/Z6iny1NW-yI/photo.jpg?sz=128", "display_name": "Barnabe Muzima", "link": "https://stackoverflow.com/users/4603794/barnabe-muzima"}, "reply_to_user": {"reputation": 514, "user_id": 2705845, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/BeZbN.jpg?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/2705845/simon"}, "edited": false, "score": 0, "creation_date": 1425076472, "post_id": 28710446, "comment_id": 45829169, "body": "lets assume the booking of March 2015, if someone takes boat1within dates from 2nd to 6th (only weekdays) his name will appear in week1 worksheet, 9th to 13rd week2 worksheet.......the trick is that someone can book for 3days , 4days or 5 days which will go beyond the active sheet and involve the following one for next week. do u get it now? sorry im new in vba ! Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 514, "user_id": 2705845, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/BeZbN.jpg?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/2705845/simon"}, "is_accepted": false, "score": 0, "last_activity_date": 1425245798, "creation_date": 1425245798, "answer_id": 28799410, "question_id": 28710446, "link": "https://stackoverflow.com/questions/28710446/moving-column-data-into-the-next-sheet-on-condition-of-column-range-using-vba/28799410#28799410", "title": "Moving column data into the next sheet on condition of column range using vba", "body": "<p>Start by breaking the problem in to steps: you'll need to:</p>\n\n<ol>\n<li>Call a userform and retrieve values some how (looks like you've done\nthis bit) </li>\n<li>I think you should create a loop for each day in your date\n    range</li>\n<li>For each \"day\" in that loop you need functions that gives you the correct\n    sheet for that day</li>\n<li>You need a function that gives you the correct\n        cell for that day within that sheet</li>\n<li>You need some way of handling if there's already\n    bookings for that day</li>\n</ol>\n\n<p>I'd say the easiest way to match a date with a sheet is a lookup table... use application.worksheetfunction.vlookup within your VBA code, and instead of \"exact match\" use \"TRUE\" for final parameter... then have a lookup table which has entries for the first day of the month next to a sheet name for that month. This will work for ALL dates because vlookup uses the \"largest value = or less to lookup\" if you don't specify exact match</p>\n"}], "owner": {"reputation": 1, "user_id": 4603794, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EWIJkPo6Hds/AAAAAAAAAAI/AAAAAAAACBY/Z6iny1NW-yI/photo.jpg?sz=128", "display_name": "Barnabe Muzima", "link": "https://stackoverflow.com/users/4603794/barnabe-muzima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1425245798, "creation_date": 1424833804, "last_edit_date": 1531164843, "question_id": 28710446, "link": "https://stackoverflow.com/questions/28710446/moving-column-data-into-the-next-sheet-on-condition-of-column-range-using-vba", "title": "Moving column data into the next sheet on condition of column range using vba", "body": "<p>For a sailing club. I have created  columns for the weekdays from Monday to friday on a sheet representing the first week of the month and so I made 4 sheets named week1 to week4 for the whole month \nusing a vba userform I put data into the cells.</p>\n\n<pre><code>      monday       tuesday      wednesday     Thursday      friday\n</code></pre>\n\n<p>boat1    </p>\n\n<p>boat2\n.\n.</p>\n\n<p><strong>My question</strong>: I would like to create a macro that if the date is in week2 will rather transfer automatically  userform data(textbox \"name\") into next sheet than current seheet. </p>\n\n<p>I don't know if it makes sense or if I have to give more details\nThank you for any help! </p>\n"}, {"tags": ["string", "excel", "numbers", "move", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4603797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7368f29e61800c544e286bef5465d617?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Buller", "link": "https://stackoverflow.com/users/4603797/justin-buller"}, "edited": false, "score": 0, "creation_date": 1425153184, "post_id": 28710614, "comment_id": 45848387, "body": "Im having trouble figuring out how to use the function you suggested. I don&#39;t know how to get the function to take the values at the right and move them over, maybe something like     <code>Sub ValCut() Dim rngA As Range     Dim cell As Range     Dim r As Range, rows As Long     Dim intLastSpace as String     intLastSpace = InstrRev(stString, &quot; &quot;)      Set rngA = ActiveSheet.Range(&quot;A2:A100&quot;)     For Each cell In rngA         Left(stString, intLastSpace -1)            intLastSpace.Offset(0, 1)     Next cell End Sub</code>"}, {"owner": {"reputation": 514, "user_id": 2705845, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/BeZbN.jpg?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/2705845/simon"}, "reply_to_user": {"reputation": 1, "user_id": 4603797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7368f29e61800c544e286bef5465d617?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Buller", "link": "https://stackoverflow.com/users/4603797/justin-buller"}, "edited": false, "score": 0, "creation_date": 1425244978, "post_id": 28710614, "comment_id": 45872647, "body": "You were nearly there :) See above: have edited answer"}, {"owner": {"reputation": 1, "user_id": 4603797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7368f29e61800c544e286bef5465d617?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Buller", "link": "https://stackoverflow.com/users/4603797/justin-buller"}, "edited": false, "score": 0, "creation_date": 1426360847, "post_id": 28710614, "comment_id": 46343928, "body": "Thanks for help, it finally works, and I would have been lost without your assistance.  One note - there was a runtime error (5) on the line:   <code>rgCell.value = Left(rgCell.Value, intSpace - 1)</code>    but I noticed that the code still grabbed the number and moved it, but couldn&#39;t proceed to next due to the error. I removed the line, and it works fine.  What was the purpose of that line?"}, {"owner": {"reputation": 514, "user_id": 2705845, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/BeZbN.jpg?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/2705845/simon"}, "reply_to_user": {"reputation": 1, "user_id": 4603797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7368f29e61800c544e286bef5465d617?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Buller", "link": "https://stackoverflow.com/users/4603797/justin-buller"}, "edited": false, "score": 0, "creation_date": 1426472851, "post_id": 28710614, "comment_id": 46372810, "body": "So if original rgCell.value = &quot;PartA PartB&quot; then rgCell.offset(0,1) is set to PartB, and then the original rgCell.value is set to &quot;PartA&quot; (i.e. PartB removed)   It shouldn&#39;t have thrown an error unless perhaps you have some values with no space at all?"}], "tags": [], "owner": {"reputation": 514, "user_id": 2705845, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/BeZbN.jpg?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/2705845/simon"}, "is_accepted": false, "score": 1, "last_activity_date": 1425244939, "last_edit_date": 1425244939, "creation_date": 1424834981, "answer_id": 28710614, "question_id": 28710421, "link": "https://stackoverflow.com/questions/28710421/remove-value-from-end-of-string-vba/28710614#28710614", "title": "remove value from end of string vba", "body": "<p>\nHi there's a nice function \"Instrrev\" which is like Instr but searches from the right hand side... so you can use that to find the first \" \" space character from the right:</p>\n\n<pre><code>intLastSpace = instrrev(stString, \" \")\n</code></pre>\n\n<p>Then just a case of using <code>Left(stString, intLastSpace - 1)</code></p>\n\n<p>[EDIT: To address comment]</p>\n\n<p>Something like...</p>\n\n<pre><code>Sub SplitStuff()\n    Dim rgList As Range\n    Dim rgCell As Range\n    Dim intSpace As Integer\n\n    Set rgList = ThisWorkbook.Sheets(\"Whatever\").Range(\"A1:A200\")\n\n    For Each rgCell In rgList\n        intSpace = InStrRev(rgCell.Value, \" \")\n        rgCell.Offset(0, 1).Value = Mid(rgCell.Value, intSpace + 1)\n        rgCell.Value = Left(rgCell.Value, intSpace - 1)\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 4603797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7368f29e61800c544e286bef5465d617?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Buller", "link": "https://stackoverflow.com/users/4603797/justin-buller"}, "edited": false, "score": 0, "creation_date": 1425152423, "post_id": 28710760, "comment_id": 45848141, "body": "I&#39;m using 2011 on a mac, and flash fill gives me weird values. I tried the text to columns approach initially - it works great if the strings have equal numbers of spaces. The string length is variable, as is the number of spaces, so the target values end up in different columns."}], "tags": [], "owner": {"reputation": 32, "user_id": 2595265, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRoIK.jpg?s=128&g=1", "display_name": "OzRoz", "link": "https://stackoverflow.com/users/2595265/ozroz"}, "is_accepted": false, "score": 0, "last_activity_date": 1424835932, "creation_date": 1424835932, "answer_id": 28710760, "question_id": 28710421, "link": "https://stackoverflow.com/questions/28710421/remove-value-from-end-of-string-vba/28710760#28710760", "title": "remove value from end of string vba", "body": "<p>If you are using Excel 2013, you can do this without VBA too. Just start typing what you want (23.78) in the next column and do one more example too. A new feature called Flash Fill will then fill down the rest of the column automatically for you.</p>\n\n<p>In older versions of Excel, you can use Data - Text to Columns - Delimited - by a space.</p>\n"}], "owner": {"reputation": 1, "user_id": 4603797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7368f29e61800c544e286bef5465d617?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Buller", "link": "https://stackoverflow.com/users/4603797/justin-buller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1927, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1425244939, "creation_date": 1424833699, "last_edit_date": 1531161705, "question_id": 28710421, "link": "https://stackoverflow.com/questions/28710421/remove-value-from-end-of-string-vba", "title": "remove value from end of string vba", "body": "<p>This will be pretty simple for those versed in vba - I write it so rarely that I need a lot of help. I've seen a heap of threads and tutorials about manipulating strings, but none seem to capture what I'm attempting to do, working in excel, which is simply this:</p>\n\n<ul>\n<li>remove the numbers from the end of the string, then move them to another cell. </li>\n</ul>\n\n<p>e.g. \"april 26 april 27 merchant 23.78\" The goal is to take 23.78 out of the string and move it to an adjacent cell.</p>\n\n<p>Simple enough, but there are string characteristics (problems) that I have not been able to solve: </p>\n\n<ul>\n<li><p>target number is variable </p></li>\n<li><p>target number length is variable </p></li>\n<li><p>there are multiple numbers in the string, but only the numbers at the end (right) are targeted</p></li>\n</ul>\n\n<p>Certainties</p>\n\n<ul>\n<li><p>The target numbers are always at the end (right)</p></li>\n<li><p>the target numbers are always separated from the rest of the string by a space</p></li>\n</ul>\n\n<p>I'm thinking that a substring function that moves through characters from right to left and stops when a character is not a number (i.e. a space or a letter) might work well.\nAny suggestions the forum might have on writing such a query would be most helpful. </p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "ms-access", "events", "charts"], "comments": [{"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1424847005, "post_id": 28710269, "comment_id": 45713663, "body": "Is there such a thing like report_activate in access VBA?  I&#39;m only assuming?"}], "answers": [{"tags": [], "owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "is_accepted": false, "score": 0, "last_activity_date": 1424857978, "creation_date": 1424857978, "answer_id": 28715873, "question_id": 28710269, "link": "https://stackoverflow.com/questions/28710269/how-can-i-change-the-chart-title-in-an-access-report-with-vba/28715873#28715873", "title": "How can I change the Chart Title in an Access report with VBA?", "body": "<p>I am not sure if your code works, but to trigger an event on opening a report you need to put the code into the <code>Report.Load</code> event.</p>\n\n<p>Check out msdn: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff197739.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff197739.aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 1997, "user_id": 4409883, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/xZatI.jpg?s=128&g=1", "display_name": "Edgar", "link": "https://stackoverflow.com/users/4409883/edgar"}, "is_accepted": true, "score": 0, "last_activity_date": 1425002998, "last_edit_date": 1495542512, "creation_date": 1425002998, "answer_id": 28756367, "question_id": 28710269, "link": "https://stackoverflow.com/questions/28710269/how-can-i-change-the-chart-title-in-an-access-report-with-vba/28756367#28756367", "title": "How can I change the Chart Title in an Access report with VBA?", "body": "<p>I found the answer here:<br>\n<a href=\"https://stackoverflow.com/questions/27113380/modify-chart-properties-in-access-report-via-vba-error-2771\">Modify Chart properties in Access report via VBA (error 2771)</a></p>\n\n<p>First I copied the chart from a report to a form and tested the code to change the title. That worked.<br>\nThen I tried to run the code with the open or load event in the report and I always received an error. I googled that error and found the article above and that was the solution.<br>\nI just added a button to the report and added the line</p>\n\n<pre><code>Me.Command1.SetFocus\n</code></pre>\n\n<p>at the beginning of my code.<br>\nNow I can run the code from Report_Load() or Report_Open(). It works for both.\nProblem solved.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11595768, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/7fbaf8470f6c98e58fa9ea49187b3afa?s=128&d=identicon&r=PG", "display_name": "Rafael", "link": "https://stackoverflow.com/users/11595768/rafael"}, "is_accepted": false, "score": 0, "last_activity_date": 1559593897, "creation_date": 1559593897, "answer_id": 56434176, "question_id": 28710269, "link": "https://stackoverflow.com/questions/28710269/how-can-i-change-the-chart-title-in-an-access-report-with-vba/56434176#56434176", "title": "How can I change the Chart Title in an Access report with VBA?", "body": "<p>Use the OnActivate event if using a Form.</p>\n"}], "owner": {"reputation": 1997, "user_id": 4409883, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/xZatI.jpg?s=128&g=1", "display_name": "Edgar", "link": "https://stackoverflow.com/users/4409883/edgar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3109, "favorite_count": 0, "accepted_answer_id": 28756367, "answer_count": 3, "score": 0, "last_activity_date": 1559593897, "creation_date": 1424832700, "question_id": 28710269, "link": "https://stackoverflow.com/questions/28710269/how-can-i-change-the-chart-title-in-an-access-report-with-vba", "title": "How can I change the Chart Title in an Access report with VBA?", "body": "<p>I have an Access Report with a chart and I want to change the title of the chart when the report is opened (preview or print).\nI found the following code:</p>\n\n<pre><code>Dim g As Graph.Chart\nSet g = Me!Graph0.Object\nWith g\n    .ChartTitle.Text = \"Test\"\nEnd With\n</code></pre>\n\n<p>But I don't know with which event I should run this code. I tried Report_Open and other events but it never changes the title.</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 4205135, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bfe428b9dfa06cc438f7595dcd193a67?s=128&d=identicon&r=PG&f=1", "display_name": "vicky", "link": "https://stackoverflow.com/users/4205135/vicky"}, "edited": false, "score": 0, "creation_date": 1424841745, "post_id": 28710514, "comment_id": 45711752, "body": "this code is not working . thus it moves my content to a temporary loaction dude. i need to copy and paste it into a new worksheet from various worksheets"}], "tags": [], "owner": {"reputation": 141, "user_id": 4440388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8097f6c1f9fb532a67c4e7d44f54f43e?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Becker", "link": "https://stackoverflow.com/users/4440388/jim-becker"}, "is_accepted": false, "score": 0, "last_activity_date": 1424834281, "creation_date": 1424834281, "answer_id": 28710514, "question_id": 28710061, "link": "https://stackoverflow.com/questions/28710061/excel-vba-to-copy-and-paste-a-cells-from-different-worksheets-to-new-worksheet/28710514#28710514", "title": "Excel vba to copy and paste a cells from different worksheets to new worksheet", "body": "<pre><code>Sub copyrange()\n    Dim rngTarget As Range, wksTemp As Worksheet\n\n    Set rngTarget = ThisWorkbook.Worksheets(1).Range(\"A2:C7\")\n\n    For Each wksTemp In ActiveWorkbook.Worksheets\n        rngTarget.Value = wksTemp.Range(\"B5:D10\").Value\n        Set rngTarget = rngTarget.Offset(6)\n    Next wksTemp\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 4205135, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bfe428b9dfa06cc438f7595dcd193a67?s=128&d=identicon&r=PG&f=1", "display_name": "vicky", "link": "https://stackoverflow.com/users/4205135/vicky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1425334638, "creation_date": 1424831067, "last_edit_date": 1531164843, "question_id": 28710061, "link": "https://stackoverflow.com/questions/28710061/excel-vba-to-copy-and-paste-a-cells-from-different-worksheets-to-new-worksheet", "title": "Excel vba to copy and paste a cells from different worksheets to new worksheet", "body": "<p>i need a macro to copy and paste a certain cells(b5:d10) from multiple worksheets and paste it into a new single worksheet. just i want to collide the contents .thanks in advance</p>\n\n<pre><code>sub copyrange()\nrange(\"b5:d10).copy\nrange(\"e1\").select\nactivesheet.paste\napplication.cutcopymode=false\nendsub\n</code></pre>\n\n<p>my code doesnot copy all the worksheets data. kindly help me to copy and paste it</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 2482756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2feb0a0f3f582c3392493d45039d3091?s=128&d=identicon&r=PG", "display_name": "user2482756", "link": "https://stackoverflow.com/users/2482756/user2482756"}, "edited": false, "score": 0, "creation_date": 1424854649, "post_id": 28710844, "comment_id": 45717248, "body": "Hi Simon Thank you for  your advice  , I am unable to use the Formatting condition  because the return value is not Text but as string so  I had to include some extra code to condition the value . Volatile function I tried to include it in the beginning but  as you wondered was causing issue to the pc overloading all the memory and having problem with the other programs. I try to add it again and I would really appreciate if you can advice more detailed about the &#39;if activesheet.codename = &quot;wsSheet&quot; then...&#39; as mentioned in my post I am not skilled in VBA and ths can solve my problem THX"}, {"owner": {"reputation": 51, "user_id": 2482756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2feb0a0f3f582c3392493d45039d3091?s=128&d=identicon&r=PG", "display_name": "user2482756", "link": "https://stackoverflow.com/users/2482756/user2482756"}, "edited": false, "score": 0, "creation_date": 1424857944, "post_id": 28710844, "comment_id": 45719299, "body": "&#39;wsSheet.Calculate&#39; return error object not defined"}, {"owner": {"reputation": 514, "user_id": 2705845, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/BeZbN.jpg?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/2705845/simon"}, "reply_to_user": {"reputation": 51, "user_id": 2482756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2feb0a0f3f582c3392493d45039d3091?s=128&d=identicon&r=PG", "display_name": "user2482756", "link": "https://stackoverflow.com/users/2482756/user2482756"}, "edited": false, "score": 0, "creation_date": 1424917931, "post_id": 28710844, "comment_id": 45752515, "body": "So in VBA click &quot;view project explorer&quot; and &quot;view properties window&quot;... You&#39;ll see your worksheet objects listed under &quot;Microsoft Excel Objects&quot; something like &quot;Sheet1 (Sheet1)&quot;, &quot;Sheet2 (Sheet2)&quot; etc... The first bit is the codename, the second bit is the Excel name or tab name... Click on your sheet and look in the &quot;properties&quot; box: it has a field ambigously  called &quot;(Name)&quot;... This is where you can change that codename to anything you like... Then you can reference it in your code as such... i.e. if you change it to &quot;wsHorse&quot; then your code can use &quot;ThisWorkbook.wsHorse&quot; ..."}, {"owner": {"reputation": 514, "user_id": 2705845, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/BeZbN.jpg?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/2705845/simon"}, "reply_to_user": {"reputation": 51, "user_id": 2482756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2feb0a0f3f582c3392493d45039d3091?s=128&d=identicon&r=PG", "display_name": "user2482756", "link": "https://stackoverflow.com/users/2482756/user2482756"}, "edited": false, "score": 0, "creation_date": 1424917998, "post_id": 28710844, "comment_id": 45752534, "body": "PS in your conditional formatting, use a formula &quot;=value(A1) &gt; 5&quot; etc... that will let you compare the cell as if it were a number rather than text  PPS how many instances of that givemevalue formula do you have on the sheet?"}, {"owner": {"reputation": 51, "user_id": 2482756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2feb0a0f3f582c3392493d45039d3091?s=128&d=identicon&r=PG", "display_name": "user2482756", "link": "https://stackoverflow.com/users/2482756/user2482756"}, "edited": false, "score": 0, "creation_date": 1424918796, "post_id": 28710844, "comment_id": 45752702, "body": "I have around 200/250 instance on every sheet"}], "tags": [], "owner": {"reputation": 514, "user_id": 2705845, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/BeZbN.jpg?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/2705845/simon"}, "is_accepted": false, "score": 0, "last_activity_date": 1424836609, "creation_date": 1424836609, "answer_id": 28710844, "question_id": 28709869, "link": "https://stackoverflow.com/questions/28709869/how-to-trigger-update-refresh-data-from-website/28710844#28710844", "title": "How to trigger/Update refresh Data from website", "body": "<p></p>\n\n<p>Sounds ambitious. I like it! :) </p>\n\n<p>For a start can you just use conditional formatting? Will be a lot quicker than looping through every cell and changing colour.</p>\n\n<p>Secondly, make your GiveMeValue function \"volatile\" (<a href=\"http://www.excel-easy.com/vba/examples/volatile-functions.html\" rel=\"nofollow\">http://www.excel-easy.com/vba/examples/volatile-functions.html</a>) so that it refreshes every time you recalculate the page i.e. add a line \"application.volatile(true) before anything else in the function.</p>\n\n<p>Thirdly: run your refresh code in the \"worksheet_calculate\" event and change it to: </p>\n\n<pre><code>Sub Refresh()\n    Dim WAIT As Double\n    WAIT = Timer\n    While Timer &lt; WAIT + 10\n        DoEvents 'do nothing'\n    Wend\n    wsSheet.Calculate\nEnd Sub\n</code></pre>\n\n<p>So it runs... waits a bit... calculates, then that calculation triggers another wait... etc... Now that your function is volatile, it should refresh all the \"getvalue\" formulas you have on the current sheet...</p>\n\n<p>And I guess forthly put a \"wsSheet.calculate\" in the worksheet_activate event to trigger start of that endless loop...</p>\n\n<p>Having said all that, perhaps that endless loop will cause huge issues i.e. mega computer slow down, inability to use computer, and general doom... only one way to find out! The doevents thing should in theory make everything OK. Maybe add  <code>if activesheet.codename = \"wsSheet\" then...</code> so its only running when you're on that sheet...</p>\n"}], "owner": {"reputation": 51, "user_id": 2482756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2feb0a0f3f582c3392493d45039d3091?s=128&d=identicon&r=PG", "display_name": "user2482756", "link": "https://stackoverflow.com/users/2482756/user2482756"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 597, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594645340, "creation_date": 1424829644, "last_edit_date": 1594645340, "question_id": 28709869, "link": "https://stackoverflow.com/questions/28709869/how-to-trigger-update-refresh-data-from-website", "title": "How to trigger/Update refresh Data from website", "body": "<p>Hi I am using the following code to parsing some data from website to excel , I need to create  a routine in order to update /Refresh the data and keep is up to date and I been advice to start  new topic , is big list  with multiple sheets so take long time every time excel  has to calculate , I hope someone can may help me out </p>\n\n<pre><code> Public Function giveMeValue(ByVal link As Variant) As Variant\n\nSet htm = CreateObject(\"htmlFile\")\n\nWith CreateObject(\"msxml2.xmlhttp\")\n   .Open \"GET\", link, False\n   .send\n   htm.body.innerhtml = .responsetext\nEnd With\n\nIf Not htm.getelementbyId(\"JS_topStoreCount\") Is Nothing Then\n\n   giveMeValue = htm.getelementbyId(\"JS_topStoreCount\").innerText\n\nElse\n    giveMeValue = \"0\"\n\nEnd If\n\nhtm.Close\nSet htm = Nothing\n\nEnd Function\n</code></pre>\n\n<p>to retrive the value I use <code>=GiveMeValue(A1)</code> and condition  formatting the returned value I use the Following code :</p>\n\n<pre><code>Dim color As Integer 'Start Color range\n\n  For Each cell In Sheets(1).Range(\"M4:M5000\")\n\n    If IsEmpty(cell) Then GoTo nextcell:\n    If Not IsNumeric(cell.Value) Then GoTo nextcell:\n\n    If cell.Value &gt; 14 Then\n      color = 4\n    ElseIf cell.Value &lt; 8 Then color = 3\n    Else: color = 6\n    End If\n    cell.Interior.ColorIndex = color\nnextcell:\n  Next cell\n\nEnd Sub\n</code></pre>\n\n<p>so as I am not skilled at all with VBA I may unappropriate use the following code to try get refresh it but without result:</p>\n\n<pre><code>Sub Refresh()\nDim WAIT As Double\nWAIT = Timer\nWhile Timer &lt; WAIT + 10\nDoEvents 'do nothing'\nActiveWorkbook.RefreshAll\nWend\nMsgBox \"Update Finished Successfully !\"\n\n'End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "if-statement", "range"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 4592361, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23178e7e8f12215e0ccaab7120cdae70?s=128&d=identicon&r=PG&f=1", "display_name": "Danny M", "link": "https://stackoverflow.com/users/4592361/danny-m"}, "edited": false, "score": 0, "creation_date": 1424995079, "post_id": 28710937, "comment_id": 45791679, "body": "Thank you for your help!"}], "tags": [], "owner": {"reputation": 514, "user_id": 2705845, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/BeZbN.jpg?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/2705845/simon"}, "is_accepted": false, "score": 0, "last_activity_date": 1424837221, "creation_date": 1424837221, "answer_id": 28710937, "question_id": 28709534, "link": "https://stackoverflow.com/questions/28709534/varying-ranges-in-sum-and-criteria-range-for-if-statments/28710937#28710937", "title": "Varying ranges in sum and criteria range for IF statments", "body": "<p></p>\n\n<p>Hi, </p>\n\n<p>So where you've got R[-39] or R[-3], you want to insert a variable for your actual calculated rows? </p>\n\n<pre><code>intStartRow = GetStartRow() ' i.e. however you define it, set a variable\nintEndRow = GetEndRow()\n</code></pre>\n\n<p>Then replace where needed:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = _\n    \"=(SUMIF(R[\" &amp; intStartRow &amp; \"]C:R[\" &amp; intEndRow &amp; \"]C, ...\n</code></pre>\n\n<p>i.e. use concatenate symbol \"&amp;\", </p>\n\n<p>Either that or use \"=Offset\" formula combined with Counta: that allows you to have \"growing/shrinking\" ranges without having to rerun your code</p>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 4592361, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23178e7e8f12215e0ccaab7120cdae70?s=128&d=identicon&r=PG&f=1", "display_name": "Danny M", "link": "https://stackoverflow.com/users/4592361/danny-m"}, "edited": false, "score": 0, "creation_date": 1424995059, "post_id": 28711443, "comment_id": 45791674, "body": "Ah ok got it. Makes sense. Thank you!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1424840298, "creation_date": 1424840298, "answer_id": 28711443, "question_id": 28709534, "link": "https://stackoverflow.com/questions/28709534/varying-ranges-in-sum-and-criteria-range-for-if-statments/28711443#28711443", "title": "Varying ranges in sum and criteria range for IF statments", "body": "<p>There is no guarantee that all four of those columns have data in the same last row. However, each <code>SUMIF</code> <em>requires</em> that all ranges have the same size. Use the same formula for each of the pairs. You are also not evaluating hte formula within VBA, merely constructing a string together. You can use the ranges' addresses as strings for this.</p>\n\n<pre><code>Sub sumifstate()\n    Dim lr As Long, critRange As String, sumRange As String, critRange2 As String, sumRange2 As String\n\n    lr = Cells(Rows.Count, \"L\").End(xlUp).Row\n    critRange = Range(\"K2:K\" &amp; lr).Address\n    sumRange = Range(\"L2:L\" &amp; lr).Address\n    lr = Cells(Rows.Count, \"N\").End(xlUp).Row\n    critRange2 = Range(\"M2:M\" &amp; lr).Address\n    sumRange2 = Range(\"N2:N\" &amp; lr).Address\n\n    Range(\"K41\").Formula = _\n        \"=SUMIF(\" &amp; critRange &amp; \", \"\"*DF*\"\", \" &amp; sumRange &amp; \")+SUMIF(\" &amp; critRange2 &amp; \", \"\"*DF*\"\", \" &amp; sumRange2 &amp; \")\"\n\nEnd Sub\n</code></pre>\n\n<p>The formula produced will be dynamic but in this format.</p>\n\n<pre><code>=SUMIF($K$2:$K$10, \"*DF*\", $L$2:$L$10)+SUMIF($M$2:$M$10, \"*DF*\", $N$2:$N$10)\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 4592361, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/23178e7e8f12215e0ccaab7120cdae70?s=128&d=identicon&r=PG&f=1", "display_name": "Danny M", "link": "https://stackoverflow.com/users/4592361/danny-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 28711443, "answer_count": 2, "score": -1, "last_activity_date": 1424840298, "creation_date": 1424827342, "last_edit_date": 1424838584, "question_id": 28709534, "link": "https://stackoverflow.com/questions/28709534/varying-ranges-in-sum-and-criteria-range-for-if-statments", "title": "Varying ranges in sum and criteria range for IF statments", "body": "<p>Hey guys I need help with my novice skills at VBA code writing. I would like to modify the code below to accommodate the varying ranges of data rows for my sum range and criteria range in a SUMIF statment.</p>\n\n<pre><code>Sub sumifstate ()\n\nSet critRange = Range(\"K2\", Selection.End(xlUp).Offset(-1, 0)).Select\nSet sumRange = Range(\"L2\", Selection.End(xlUp).Offset(-1, 0)).Select\nSet critRange2 = Range(\"M2\", Selection.End(xlUp).Offset(-1, 0)).Select\nSet sumRange2 = Range(\"N2\", Selection.End(xlUp).Offset(-1, 0)).Select\n\nRange(\"K41\").Select\n\nActiveCell.FormulaR1C1 = _\n    \"=     (SUMIF(\"critRange\",\"\"*DF*\"\",\"sumRange\")+SUMIF(\"critRange2,\"\"*DF*\"\",\"sumRange2\")\"\n\nEnd Sub ()\n</code></pre>\n\n<p>I hope I was specific enough if not let me know what other information you might need. Thank you!</p>\n"}, {"tags": ["forms", "vba", "ms-access-2010", "duplicates"], "answers": [{"tags": [], "owner": {"reputation": 121, "user_id": 4417424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/503b20a1f11d3efc301dc58567fd9775?s=128&d=identicon&r=PG&f=1", "display_name": "Wiz", "link": "https://stackoverflow.com/users/4417424/wiz"}, "is_accepted": false, "score": 0, "last_activity_date": 1424860430, "creation_date": 1424860430, "answer_id": 28716727, "question_id": 28708721, "link": "https://stackoverflow.com/questions/28708721/how-do-i-create-multiple-duplicate-records-in-a-single-microsoft-access-table/28716727#28716727", "title": "How do I create multiple (duplicate) records in a single Microsoft Access table from a single form?", "body": "<p>Unfortunately from your description I can't understand well, especially because I can't see the structure of your tables.\nAnyway, let's discuss about how to copy a record from a table to another.\nThere are many ways to do that (as usual).\nI'll show you two\nThe 1st is a very compact solution for copying records (just one in your case).</p>\n\n<p>The 2nd is a bit more tricky if you are new to vba but gives you much more control on what you're doing.\nPersonally I prefer the 2nd solution</p>\n\n<p><strong>1st Solution - Using SQL SELECT INTO instruction</strong></p>\n\n<p>The SQL transaction is </p>\n\n<pre><code>SELECT *\nINTO TargetTable \nFROM SourceTable WHERE Condition;\n</code></pre>\n\n<p>In this example <em>newtable</em> is the target table name where you want to copy the record.\n<em>SourceTable</em> is the name of the table from which you want to copy the record\n<em>Condition</em> is the condition to select the record to copy. If your record has an ID field (named ID, for example) the Condition can be <em>ID = NumID</em> where NumID is the ID value of the record to be duplicated.</p>\n\n<p>How do you use this transactions?\nYou can build a string for SQL statement and then execute it.</p>\n\n<pre><code>Private Sub CopyRecord(lngID As Long, strSourceTable As String, strTargetTable As String)\n    Dim strSQL as string\n\n    strSQL = \"SELECT * INTO \" &amp; strTargetTable \" FROM \" &amp; strSourceTable &amp; \" WHERE ID=\" &amp; CStr(lngID)\n\n    DoCmd.RunSQL strSQL\n\nEnd Sub\n</code></pre>\n\n<p>This subroutine can be called from a form where you are on a certain record in this way</p>\n\n<pre><code>    Call CopyRecord(Me.ID,\"SourceTable\", \"TargetTable\")              ' Copy record\n\n    DoCmd.OpenForm \"frmFeedback_Form\", ,acNormal,\"ID = \"+CStr(Me.ID) ' Open 2nd form @ new record\n</code></pre>\n\n<p><strong>2nd Solution - Using DAO.RECORDSET</strong>\nWith this solution you can modify the contents of the fields during the copy.\nYou can also have different names for the 2 different tables. In the 1st case you physically duplicate the record with the same field names.</p>\n\n<pre><code>Private CopyRecord(lngID As Long, strSourceTable As String, strTargetTable As String)   \n  dim rsSource as DAO.RecordSet\n  dim rsTarget as DAO.RecordSet\n\n  Set rsSource = CurrentDb.OpenRecordSet(\"SELECT * FROM SourceTable WHERE ID = \" &amp; CStr(lngID),dbOpenDynaset) ' Open Source Table\n\n  Set rsTarget = CurrentDb.OpenRecordSet(\"SELECT * FROM SourceTable WHERE ID = \" &amp; CStr(lngID),dbOpenDynaset) ' Open Target Table\n\n  if rsSource.EOF Then Exit Sub                 ' Exit if no record is selected  \n\n  rsTarget.AddNew                               ' Append a new record to destination table\n  rsTarget!TrgtField1 = rsSource!SrcFields1     ' Copy Source field 1 into target field 1\n  rsTarget.TrgtField2 = rsSource!SrcFields2     ' Copy Source field 2 into target field 2\n  ...\n  rsTarget.Update                               ' Save new record\n\n  rsTarget.Close                                ' Close Recordset\n  rsSource.Close                                ' Close Recordset\n\n  Set rsSource = Nothing                        ' Free memory\n  Set rsTarget = Nothing                        ' Free memory\n\nEnd Sub\n</code></pre>\n\n<p>The call of the subroutine is the same as the 1st case.</p>\n\n<p><strong>PLEASE NOTE THAT I DIDN'T MENTION THE ID FIELD OF THE TARGET RECORDSET.</strong>\nThis is very important because if you use an ID field (KEY) with <em>autonumbering</em> (as usual) you don't have to assign anything to it because it's automatically generated once you insert a new record.</p>\n\n<p>Let me know if this works for you.</p>\n\n<p>Bye:-)</p>\n"}], "owner": {"reputation": 1, "user_id": 4603447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b02cc28858f3e180b5a6f670a82a0224?s=128&d=identicon&r=PG&f=1", "display_name": "rootlogic", "link": "https://stackoverflow.com/users/4603447/rootlogic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2891, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424860430, "creation_date": 1424822323, "question_id": 28708721, "link": "https://stackoverflow.com/questions/28708721/how-do-i-create-multiple-duplicate-records-in-a-single-microsoft-access-table", "title": "How do I create multiple (duplicate) records in a single Microsoft Access table from a single form?", "body": "<p>I have been creating a main screen for our training organization. From this main screen, I've created a button that launches the form Instructors will use to enter training evaluations. I've had a request to build an additional button that will launch a different form so instructors can put the average scores for each question and say how many attended the class. Once they submit this form, it will need to create as many records as attendees, so that the weight of each day's averages will be fine when running reports.</p>\n\n<p>I can't find a solution to fit my need, but here is the VBA for the button I've tried to use:</p>\n\n<p>DoCmd.RunMacro \"DuplicateRecord\", Forms!Feedback_Form!Attendees</p>\n\n<p>This doesn't seem to do anything for me. I know it's pretty simple, but I'm new to VBA.</p>\n\n<p>What is the best way to go about this?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 487, "user_id": 2487576, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/014148a7855918f8c9737fdb6d3860ab?s=128&d=identicon&r=PG", "display_name": "jmaz", "link": "https://stackoverflow.com/users/2487576/jmaz"}, "edited": false, "score": 0, "creation_date": 1424837521, "post_id": 28709438, "comment_id": 45710554, "body": "Tim: GL Budget is the name of the original tab, and GL Budget2 is the name of the copy. GL Budget has event handler code that is exactly copied for GL Budget2, but I need to change the sheet name within the GL Budget2 code from &quot;GL Budget&quot; to &quot;GL Budget2&quot; in order for the code to point to the correct sheet and work correctly. When I insert your code, the error goes away, but the string substitution does not happen."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 487, "user_id": 2487576, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/014148a7855918f8c9737fdb6d3860ab?s=128&d=identicon&r=PG", "display_name": "jmaz", "link": "https://stackoverflow.com/users/2487576/jmaz"}, "edited": false, "score": 1, "creation_date": 1424837902, "post_id": 28709438, "comment_id": 45710670, "body": "Do you have the sheet name hard-coded in its code module?  You could use <code>Me.Name</code> to replace that."}, {"owner": {"reputation": 487, "user_id": 2487576, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/014148a7855918f8c9737fdb6d3860ab?s=128&d=identicon&r=PG", "display_name": "jmaz", "link": "https://stackoverflow.com/users/2487576/jmaz"}, "edited": false, "score": 0, "creation_date": 1424898306, "post_id": 28709438, "comment_id": 45745346, "body": "Tim, your suggestion was in the ballpark and now it works, thanks."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1424826779, "creation_date": 1424826779, "answer_id": 28709438, "question_id": 28708542, "link": "https://stackoverflow.com/questions/28708542/find-and-replace-string-within-sheet-macro-using-code-in-another-macro/28709438#28709438", "title": "Find and Replace string within sheet macro using code in another macro", "body": "<p><code>GL Budget2</code> is likely not the <em>code name</em> of your sheet, but the name on the sheet tab.</p>\n\n<p>Try this:</p>\n\n<pre><code>Dim cn as string\n\ncn = ThisWorkbook.Sheets(\"GL Budget2\").CodeName\n\nWith ThisWorkbook.VBProject.VBComponents(cn).CodeModule\n'...etc\n</code></pre>\n"}], "owner": {"reputation": 487, "user_id": 2487576, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/014148a7855918f8c9737fdb6d3860ab?s=128&d=identicon&r=PG", "display_name": "jmaz", "link": "https://stackoverflow.com/users/2487576/jmaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424826779, "creation_date": 1424821298, "last_edit_date": 1531164843, "question_id": 28708542, "link": "https://stackoverflow.com/questions/28708542/find-and-replace-string-within-sheet-macro-using-code-in-another-macro", "title": "Find and Replace string within sheet macro using code in another macro", "body": "<p>I have a worksheet and worksheet related code called \"GL Budget2\". The code contains several instances of the string \"GL Budget\". This string must be renamed \"GL Budget2\" by using code from within another macro called FindAndReplace. My code (thanks to Pearson):</p>\n\n<pre><code>Sub FindAndReplace()\n\n    Dim SL As Long, EL As Long, SC As Long, EC As Long\n    Dim S As String\n    Dim Found As Boolean\n\n    With ThisWorkbook.VBProject.VBComponents(\"GL Budget2\").CodeModule\n        SL = 1\n        SC = 1\n        EL = 99999\n        EC = 999\n        Found = .Find(\"GL Budget\", SL, SC, EL, EC, True, False, False)\n\n        If Found = True Then\n            S = .Lines(SL, 1)\n            S = Replace(S, \"GL Budget\", \"GL Budget2\")\n            .ReplaceLine SL, S\n        End If\n\n    End With\nEnd Sub\n</code></pre>\n\n<p>It crashes with the subscript out of range error on the line</p>\n\n<pre><code>With ThisWorkbook.VBProject.VBComponents(\"GL Budget2\").CodeModule\n</code></pre>\n\n<p>Any suggestions would be greatly appreciated.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4603421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f47535178c81a2f9d7ca45370003e968?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/4603421/oliver"}, "edited": false, "score": 0, "creation_date": 1424822827, "post_id": 28708532, "comment_id": 45706847, "body": "I cannot believe I didn&#39;t think of this..... Always good to get another pair of eyes looking at things to pick out the silly things you missed! I did that all the time with excel macros... Okay well its working now so thank you so much!"}], "tags": [], "owner": {"reputation": 21, "user_id": 4599203, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9068fbe5e63599418744af4274df3ecb?s=128&d=identicon&r=PG", "display_name": "Serenity", "link": "https://stackoverflow.com/users/4599203/serenity"}, "is_accepted": false, "score": 0, "last_activity_date": 1424821251, "creation_date": 1424821251, "answer_id": 28708532, "question_id": 28708399, "link": "https://stackoverflow.com/questions/28708399/word-2010-userform-vba-autotextentry-problems/28708532#28708532", "title": "Word 2010 Userform + VBA AutoTextEntry problems", "body": "<p>If you want to know something like this, ask Word.</p>\n\n<p>Put cursor where macro leaves it, Alt + T, M, R. Move by keyboard the cursor where you want it. Turn off recording (Alt + T, M, R). Copy and paste from the new macro into your macro.</p>\n\n<hr>\n\n<p>These are some examples from doing the same thing in Excel.</p>\n\n<p>You are using Excel and you can record it in Excel and have Excel write your code.</p>\n\n<p>Alt + T, M, R</p>\n\n<p>then Home key then Up Arrow. Stop recording.</p>\n\n<p>Look what Excel wrote</p>\n\n<pre><code>Selection.End(xlUp).Select\n</code></pre>\n\n<p>or if you had of recorded Go To dialog</p>\n\n<pre><code>Application.Goto Reference:=\"R1C1\"\n</code></pre>\n\n<p>or if you had of recorded Ctrl + Home</p>\n\n<pre><code>Range(\"A1\").Select\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4603421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f47535178c81a2f9d7ca45370003e968?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/4603421/oliver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1425674409, "creation_date": 1424820384, "last_edit_date": 1425674409, "question_id": 28708399, "link": "https://stackoverflow.com/questions/28708399/word-2010-userform-vba-autotextentry-problems", "title": "Word 2010 Userform + VBA AutoTextEntry problems", "body": "<p>I have around 60 pages of code that I have picked up and edited from another member of staff. What I have is a Userform where a person will enter some details to create a letter. This part is all good and working. The next part is where I am having troubles. Basically, if someone clicks a button then it will insert some autotext and fill in any bookmarks as necessary. </p>\n\n<pre><code>If chk1 = True Then\n   ActiveDocument.AttachedTemplate.AutoTextEntries(\"1\").Insert Where:=Selection.Range, RichText:=True\n   ActiveDocument.Bookmarks(\"bm1\").Select\n   Selection.Text = txt1.Value\nEnd If\n\nIf chk2 = True Then\n   ActiveDocument.AttachedTemplate.AutoTextEntries(\"2\").Insert Where:=Selection.Range, RichText:=True\n</code></pre>\n\n<p>End If\nNow what I am trying to figure out is how to change the selection/range to just below the insert. So when the autotext entry is input and after it has changed the bookmarks as required I would like the selection to be under it to start a new paragraph.</p>\n\n<p>Example: Text text text text text text text</p>\n\n<p>&lt;- Selection will be here for entry of new autotext.</p>\n\n<p>I have been looking online and I just don't know how to do it! I Should mention that this is sort of in the middle of the document. I have a signature and stuff below it so it doesn't really work with the make the selection the last paragraph sor of thing.</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1424820710, "post_id": 28708393, "comment_id": 45706173, "body": "It&#39;s very difficult to say without seeing the schema and your desired results. My gut tells me that your table schema is the real problem here though since you have 80 different ways to join two tables based on values in the records within those tables. That just sounds really nasty."}, {"owner": {"reputation": 14733, "user_id": 2589202, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/KBJx4.jpg?s=128&g=1", "display_name": "crthompson", "link": "https://stackoverflow.com/users/2589202/crthompson"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1424820943, "post_id": 28708393, "comment_id": 45706247, "body": "You could create a table with your 80 options, but as @JNevill suggests, this is very indicative of a poor schema."}], "answers": [{"tags": [], "owner": {"reputation": 347, "user_id": 4114914, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/34266fce4775945c2311e4cc9e78d214?s=128&d=identicon&r=PG&f=1", "display_name": "plateriot", "link": "https://stackoverflow.com/users/4114914/plateriot"}, "is_accepted": false, "score": 0, "last_activity_date": 1424823674, "creation_date": 1424823674, "answer_id": 28708953, "question_id": 28708393, "link": "https://stackoverflow.com/questions/28708393/variant-join-in-ms-access/28708953#28708953", "title": "Variant Join in MS Access", "body": "<p>Yes, I am working with a back end that leaves a lot to be desired.  In the interim, I'm probing for alternate solutions.   Do you know a way to make a join respond like a variant variable i.e so it can work with null values.  I've tried outer joins but it doesn't really work. </p>\n"}], "owner": {"reputation": 347, "user_id": 4114914, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/34266fce4775945c2311e4cc9e78d214?s=128&d=identicon&r=PG&f=1", "display_name": "plateriot", "link": "https://stackoverflow.com/users/4114914/plateriot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424823674, "creation_date": 1424820355, "question_id": 28708393, "link": "https://stackoverflow.com/questions/28708393/variant-join-in-ms-access", "title": "Variant Join in MS Access", "body": "<p>I am converting a spreadsheet that had over 80 Sumifs for output.</p>\n\n<p>For a query, I can join 2 tables, but they depend on 6-8 factors that aren't consistent, hence, the sumifs.</p>\n\n<p>I've been successful with right joins in some instances, but most of the time I have to piece meal all of the conditions.</p>\n\n<p>One of my approaches is to write a function like this:</p>\n\n<pre><code>Public Function DetermineCOB_ID(strFund As String, strType As String, strMDEP As String, _\nstrTier1 As String, strAirGround As Variant, strAcctType As String) As Integer\n\n    If strFund = \"A82AB\" And strType = \"Base\" And strTier1 = \"2 BCT\" And strMDEP = \"W25D\" And strAcctType = \"Subordinate_Cmds\" Then\n        DetermineCOB_ID = 1\n    ElseIf strFund = \"A82AC\" And strType = \"Base\" And strMDEP = \"W25D\" And strAcctType = \"Subordinate_Cmds\" Then\n        DetermineCOB_ID = 2\n    ElseIf strFund = \"A82AD\" And strType = \"Base\" And strMDEP = \"W25D\" And strAirGround = \"Ground\" And strAcctType = \"Subordinate_Cmds\" Then\n        DetermineCOB_ID = 3\n    Else\n        DetermineCOB_ID = 0\n    End If\n\n\nEnd Function\n</code></pre>\n\n<p>But I will have to write 80 separate ElseIf statements.</p>\n\n<p>I'd like to hook up my logic to a control table that the user can change the factors that determine the values.</p>\n\n<p>This would somehow involve a 'variant' join everywhere there is a join where one is not required.  I hope I am making sense.</p>\n\n<p>Is there another approach to solving this problem?</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 568, "user_id": 2781105, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a8ef4fa797b69a4ccb767ed87ccfe8a8?s=128&d=identicon&r=PG&f=1", "display_name": "jimiclapton", "link": "https://stackoverflow.com/users/2781105/jimiclapton"}, "edited": false, "score": 0, "creation_date": 1424848499, "post_id": 28708429, "comment_id": 45714342, "body": "Works perfectly and much simpler than other incremental loops I attempted. Thanks so much!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1424820536, "creation_date": 1424820536, "answer_id": 28708429, "question_id": 28708272, "link": "https://stackoverflow.com/questions/28708272/vba-to-insert-and-increment-formulae-in-cell/28708429#28708429", "title": "VBA to insert and increment formulae in cell", "body": "<p>Try finding the last value in column A (looking from the bottom up) and using that cell's row to define the extent of the range in column H that the formula is applied to.</p>\n\n<pre><code>Range(\"H2:H\" &amp; cells(rows.count, 1).end(xlup).row).Formula = \"=GetPattern($A2)\"\n</code></pre>\n"}], "owner": {"reputation": 568, "user_id": 2781105, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a8ef4fa797b69a4ccb767ed87ccfe8a8?s=128&d=identicon&r=PG&f=1", "display_name": "jimiclapton", "link": "https://stackoverflow.com/users/2781105/jimiclapton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 626, "favorite_count": 0, "accepted_answer_id": 28708429, "answer_count": 1, "score": 0, "last_activity_date": 1527953384, "creation_date": 1424819818, "last_edit_date": 1424820225, "question_id": 28708272, "link": "https://stackoverflow.com/questions/28708272/vba-to-insert-and-increment-formulae-in-cell", "title": "VBA to insert and increment formulae in cell", "body": "<p>I have this VBA </p>\n\n<pre><code>Sub ApplyCV()\nRange(\"H2:H5000\").Formula = \"=GetPattern($A2)\"\nEnd Sub\n</code></pre>\n\n<p>Which basically applies the custom function \"=GetPattern\" to execute the macro of the same name. This works fine.</p>\n\n<p>However, instead of explicitly stating the range (which will vary with each dataset) I'd like to increment the formula on a loop UNTIL the last row of data or until there is no cell value in A:whatever.</p>\n\n<p>Any help with this would be gratefully received.</p>\n\n<p>Many thanks </p>\n"}, {"tags": ["vba", "excel", "filter"], "comments": [{"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "edited": false, "score": 0, "creation_date": 1424818660, "post_id": 28707914, "comment_id": 45705333, "body": "You are really asking for too much with very little details, doubtful you will find people to simply write an extensive amount of code for you for free"}, {"owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "reply_to_user": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "edited": false, "score": 0, "creation_date": 1424818786, "post_id": 28707914, "comment_id": 45705399, "body": "I&#39;m just asking for somewhere to start."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1424819127, "post_id": 28707914, "comment_id": 45705543, "body": "After you filter by product, you could use Range.Find searching for each company.  Start at the first cell in the company column; <code>searchdirection:=xlprevious</code>; <code>lookin:=xlvalues</code>.   Using those arguments, .Find should skip the hidden rows and, searching from the bottom up, should find the last instance first."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1424820003, "post_id": 28707914, "comment_id": 45705884, "body": "Find the row number of the last <i>CCE</i> with <code>application.match(&quot;CCEzz&quot;, range(&quot;E:E&quot;))</code>. If <i>CCE</i> is stored in a var then it would seem a simple matter to append <i>zz</i> to the var."}, {"owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1424820413, "post_id": 28707914, "comment_id": 45706056, "body": "@pnuts, it&#39;s actually the opposite. The last row is the latest date. The first row is the most recent."}], "answers": [{"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1424821905, "creation_date": 1424821905, "answer_id": 28708641, "question_id": 28707914, "link": "https://stackoverflow.com/questions/28707914/find-last-row-of-name-with-constantly-changing-names/28708641#28708641", "title": "Find Last Row of Name with constantly changing names", "body": "<p>If a specific company name in say F1 then:  </p>\n\n<pre><code>=MIN(IF(A:A=F1,D:D))  \n</code></pre>\n\n<p>entered with Ctrl+Shift+Enter should give you the earliest date for the company named in F1, that if more recent than today()-30 (or less far into the future than today()+30 ?) you might use for your e-mail trigger (subject to other filtering etc). </p>\n"}], "owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426010655, "creation_date": 1424818171, "last_edit_date": 1426010655, "question_id": 28707914, "link": "https://stackoverflow.com/questions/28707914/find-last-row-of-name-with-constantly-changing-names", "title": "Find Last Row of Name with constantly changing names", "body": "<p>I'm really stuck on this one. I have a spreadsheet with thousands of rows. I use this code to filter them based off of product in the E column.</p>\n\n<pre><code>Sub IsolateCCENCE()\nDim Operations As Workbook\nDim Operations_Sheet As Worksheet\nSet Operations = Workbooks(\"Operations for Macros\")\nSet Operations_Sheet = Operations.Worksheets(\"Operations\")\n\nOperations_Sheet.Range(\"$A$6:$AH$13108\").AutoFilter Field:=5,      Criteria1:=\"=CCE\" _\n    , Operator:=xlOr, Criteria2:=\"=NCE\"\nEnd Sub\n</code></pre>\n\n<p>Which works and leaves me with just under 1700 rows. Within these rows, in the A column, there are company names. Each company takes up approximately 20 rows. Each row represents a payment and has a corresponding date, in the D column. I need a macro (I'm assuming with a loop) that will then do the following:</p>\n\n<ol>\n<li>Go through the rows, find the last row for each company</li>\n<li>In that row, find the corresponding date</li>\n<li>If that date is within 30 days from today, generate an email</li>\n</ol>\n\n<p>Part 3 is easy. But Part 1 and 2 I can't seem to get. The data is always going to be changing.</p>\n\n<p>Maybe it would be easier to have all of the data copy and pasted into another spreadsheet and then filter through every single company, find the last row (and thus the corresponding date)? But I don't know I would have a macro defined to filter through each company when the company names will be changing constantly.</p>\n\n<p>I appreciate any help. Thanks in advance!</p>\n"}, {"tags": ["arrays", "vba", "excel", "multidimensional-array"], "answers": [{"comments": [{"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1424836246, "post_id": 28707959, "comment_id": 45710277, "body": "+1. When using arrays uses <code>Value2</code> rather than <code>Value</code> , ie.  <code>v = ThisWorkbook.Worksheets(&quot;Sheet1&quot;).Range(&quot;A1:C200&quot;).Value2</code>. See this  <a href=\"https://fastexcel.wordpress.com/2011/11/30/text-vs-value-vs-value2-slow-text-and-how-to-avoid-it/\" rel=\"nofollow noreferrer\">post</a> by Charles Williams."}, {"owner": {"reputation": 39, "user_id": 4350322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41bd38140ec2fc00d083bab5999932d6?s=128&d=identicon&r=PG&f=1", "display_name": "WJol", "link": "https://stackoverflow.com/users/4350322/wjol"}, "edited": false, "score": 0, "creation_date": 1424872416, "post_id": 28707959, "comment_id": 45728299, "body": "I know I can populate it in one shot, but that&#39;s not really what I&#39;m looking for here.  I have one row of formulas that changes based on some inputs.  My macro cycles through each combo of inputs, and I want to be able to grab the results from the formulas and put it into the array."}, {"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "edited": false, "score": 0, "creation_date": 1424873008, "post_id": 28707959, "comment_id": 45728735, "body": "To my knowledge you cannot populate a row at once, you will need to use a loop"}, {"owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "edited": false, "score": 0, "creation_date": 1509480985, "post_id": 28707959, "comment_id": 81034967, "body": "See the example in the answer"}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": false, "score": 0, "last_activity_date": 1424818369, "creation_date": 1424818369, "answer_id": 28707959, "question_id": 28707750, "link": "https://stackoverflow.com/questions/28707750/populate-vba-array-one-row-at-a-time/28707959#28707959", "title": "Populate VBA array, one row at a time", "body": "<p>You can actually populate an array in one shot. Suppose your Range of interest is <code>A1:C200</code> in <code>Sheet1</code>. You can populate the array using the following</p>\n\n<pre><code>Dim v as Variant\nv = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1:C200\").Value\n</code></pre>\n\n<p>This will give you a 2D array with 3 columns and 200 rows.</p>\n"}, {"tags": [], "owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "is_accepted": false, "score": 0, "last_activity_date": 1509543436, "last_edit_date": 1509543436, "creation_date": 1509481148, "answer_id": 47043893, "question_id": 28707750, "link": "https://stackoverflow.com/questions/28707750/populate-vba-array-one-row-at-a-time/47043893#47043893", "title": "Populate VBA array, one row at a time", "body": "<p>If any one need  help, I was looking for a solution to the same need too, and I found this right now.</p>\n\n<p>Here is a solution using \"Index\" function :</p>\n\n<pre><code>Sub Test()\n\n    Dim varArray            As Variant\n    Dim varTemp             As Variant\n\n    varArray = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1:E10\")\n    varTemp = Application.Index(varArray, 2, 0)\n\nEnd Sub\n</code></pre>\n\n<p>In this example, varTemp contains the values of the row number \"2\" in the range \"A1:E10\".</p>\n\n<p>Say we have, in the columns A, B and C, from row 1 to 10, this values :</p>\n\n<pre><code>1   a   q\n2   b   w\n3   c   e\n4   d   r\n5   e   t\n6   f   y\n7   g   u\n8   h   i\n9   i   o\n10  j   p\n</code></pre>\n\n<p>then :</p>\n\n<pre><code>Debug.Print varTemp(1)\nDebug.Print varTemp(2)\nDebug.Print varTemp(3)\n</code></pre>\n\n<p>will display :</p>\n\n<pre><code>2\nb\nw\n</code></pre>\n\n<p>Have a look here : <a href=\"https://usefulgyaan.wordpress.com/2013/06/12/vba-trick-of-the-week-slicing-an-array-without-loop-application-index/\" rel=\"nofollow noreferrer\">https://usefulgyaan.wordpress.com/2013/06/12/vba-trick-of-the-week-slicing-an-array-without-loop-application-index/</a></p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 12028888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e455bd874ea540d49bcd1fd2d253e41?s=128&d=identicon&r=PG&f=1", "display_name": "vivek", "link": "https://stackoverflow.com/users/12028888/vivek"}, "is_accepted": false, "score": 0, "last_activity_date": 1596312012, "last_edit_date": 1596312012, "creation_date": 1596274729, "answer_id": 63203785, "question_id": 28707750, "link": "https://stackoverflow.com/questions/28707750/populate-vba-array-one-row-at-a-time/63203785#63203785", "title": "Populate VBA array, one row at a time", "body": "<p>You can actually store the entire row at once. I was trying to do exactly what you are doing here</p>\n<p>Consider you have formulae in &quot;A3:Z3&quot; which you want to loop got 1000 times and store values. below are steps</p>\n<p>declare a variant</p>\n<pre><code>Dim myarray(1000) As Variant\nfor i = 1 to 1000\n    myarray(i) = Range(&quot;A3:Z3&quot;).value2\nnext i\n</code></pre>\n<p>use the same loop to paste wherever you want</p>\n"}], "owner": {"reputation": 39, "user_id": 4350322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41bd38140ec2fc00d083bab5999932d6?s=128&d=identicon&r=PG&f=1", "display_name": "WJol", "link": "https://stackoverflow.com/users/4350322/wjol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2252, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1596312012, "creation_date": 1424817454, "question_id": 28707750, "link": "https://stackoverflow.com/questions/28707750/populate-vba-array-one-row-at-a-time", "title": "Populate VBA array, one row at a time", "body": "<p>I want to be able to populate an array with rows of data at a time instead of element by element.  For example, I'd like to get a final product like the 3x3 array:<br/></p>\n\n<p>1 2 3 <br/>\n4 5 6 <br/>\n7 8 9 </p>\n\n<p>by populating it with the row 1 2 3, then with 4 5 6, then with 7 8 9. </p>\n\n<p>In Excel, I have formulas set up in cells F1:Z1 that change based on inputs in cells A1:D1.  The macro loads the case in A1:D1, and then I want to be able to select cells F1:Z1 and insert them into an array at once, instead of looping through individual elements in F1, G1, H1, ..., Z1.  (I have 10,000 cases, so I know the array would have 10,000 rows and 21 columns.)  </p>\n\n<p>Is there any way to do this, or would I have to loop through each element individually?</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "edited": false, "score": 0, "creation_date": 1424818811, "post_id": 28707647, "comment_id": 45705415, "body": "Try changing <code>Debug.Print sourceSH.Cells(1,1)</code> to <code>Debug.Print sourceSH.Cells(1,1).Value</code>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1424831736, "post_id": 28707647, "comment_id": 45709196, "body": "<code>.Value</code> is the default property of a range object, so it should not matter whether you do the <code>.Value</code> or not, but I suppose it is worth a try, or you could similarly try: <code>sourceSh.Range(&quot;A1&quot;).Value</code>."}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 0, "last_activity_date": 1424874821, "last_edit_date": 1424874821, "creation_date": 1424854452, "answer_id": 28714778, "question_id": 28707647, "link": "https://stackoverflow.com/questions/28707647/vba-extract-cells1-1-from-a-saved-xls-file-in-outlook-vba/28714778#28714778", "title": "VBA: Extract cells(1,1) from a saved xls file in Outlook VBA", "body": "<blockquote>\n  <p>Debug.Print sourceSH.Cells(1,1)</p>\n</blockquote>\n\n<p>The Print method output the message to the immediate window. You need to pass a string, not the Range object. Try to pass the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840217(v=office.15).aspx\" rel=\"nofollow\">Text</a> property values to the Print method.</p>\n\n<pre><code>Debug.Print sourceSH.Cells(1,1).Text\n</code></pre>\n"}], "owner": {"reputation": 1763, "user_id": 551705, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7311c566c1f1a5fd2326da17fce4a50f?s=128&d=identicon&r=PG", "display_name": "Mariska", "link": "https://stackoverflow.com/users/551705/mariska"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 28714778, "answer_count": 1, "score": 0, "last_activity_date": 1424874821, "creation_date": 1424817029, "question_id": 28707647, "link": "https://stackoverflow.com/questions/28707647/vba-extract-cells1-1-from-a-saved-xls-file-in-outlook-vba", "title": "VBA: Extract cells(1,1) from a saved xls file in Outlook VBA", "body": "<p>Note: I wrote the following code in Outlook VBA. Basically the code is in ThisOutlookSession and I scan emails that start with \"new\", save the attachment in Desktop and debug.print the value in Cells(1,1). However, Outlook crashed and said \"Object doesn't support this property or method\" on the \"     Debug.Print sourceSH.Cells(1,1)\" line. What is wrong?</p>\n\n<pre><code>Public WithEvents myOlItems  As Outlook.Items\n\nPrivate Sub Application_Startup()\n    Dim olApp As Outlook.Application\n    Dim objNS As Outlook.NameSpace\n    Set olApp = Outlook.Application\n    Set objNS = olApp.GetNamespace(\"MAPI\")\n\n    Dim f As Folder\n    Set f = Application.Session.Folders.item(\"me\").Folders.item(\"Inbox\")\n\n    Set myOlItems = f.Items\n\n    Call LoadForm\n\n\nEnd Sub\n\nPrivate Sub myOlItems_ItemAdd(ByVal item As Object)\n\nOn Error GoTo ErrorHandler\n\n  Dim Msg As Outlook.MailItem\n\n    Dim name As String\n    Dim res As String\n\n    Dim sourceWB As Workbook\n    Dim sourceSH As Worksheet\n\n    Dim NewFileName As String\n\n    Dim xlApp As Object\n\n\n    If TypeName(item) = \"MailItem\" Then\n        Set Msg = item\n\n\n        ' do stuff with item\n        If Left(Msg.Subject, 3) = \"New\" And Msg.Attachments.Count &gt; 0 Then\n\n            NewFileName = \"C:\\Desktop\\\" &amp; Msg.Attachments.item(1).Filename\n\n            ' save file\n            Msg.Attachments.item(1).SaveAsFile NewFileName\n\n            Set xlApp = CreateObject(\"Excel.Application\")\n\n            xlApp.Application.Visible = True\n\n            Set sourceWB = xlApp.Workbooks.Open(NewFileName, True, True)\n\n            Set sourceSH = sourceWB.Worksheets(1)\n\n            Debug.Print sourceSH.Cells(1,1)\n\n        End If\n\n    End If\n\nProgramExit:\n  Exit Sub\nErrorHandler:\n  MsgBox Err.Number &amp; \" - \" &amp; Err.Description\n  Resume ProgramExit\nEnd Sub\n</code></pre>\n"}, {"tags": ["image", "vba", "ms-word"], "comments": [{"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1459272576, "post_id": 28707591, "comment_id": 60207528, "body": "Welcome to StackOverflow! If you are asking <i>how to create a macro?</i>, StackOverflow is not the place for such a broad and nonspecific question. If you&#39;ve written a macro that doesn&#39;t work, please show the macro, and explain why it doesn&#39;t do what you want."}], "answers": [{"tags": [], "owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "is_accepted": false, "score": 0, "last_activity_date": 1424872690, "last_edit_date": 1424872690, "creation_date": 1424864793, "answer_id": 28718232, "question_id": 28707591, "link": "https://stackoverflow.com/questions/28707591/insert-paragraph-breaks-before-images/28718232#28718232", "title": "Insert paragraph breaks before images", "body": "<p>If your images are of <code>InlineShapes</code> type then the code below will do the trick:</p>\n\n<pre><code>Sub InsertParagraphBeforeInlinShapes()\n\n    Dim iSHP As InlineShape\n    For Each iSHP In ActiveDocument.InlineShapes\n\n        ActiveDocument.Range(iSHP.Range.Start, _\n                                iSHP.Range.Start).InsertParagraphBefore\n\n    Next iSHP\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4603284, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153612518992166/picture?type=large", "display_name": "JSoule", "link": "https://stackoverflow.com/users/4603284/jsoule"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 495, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1459272368, "creation_date": 1424816832, "last_edit_date": 1459272368, "question_id": 28707591, "link": "https://stackoverflow.com/questions/28707591/insert-paragraph-breaks-before-images", "title": "Insert paragraph breaks before images", "body": "<p>How can I create a macro to insert paragraph breaks before each image in a file?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1254, "user_id": 1207060, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/77a4c7259fa080dc084138c7198b1e3e?s=128&d=identicon&r=PG", "display_name": "cfs", "link": "https://stackoverflow.com/users/1207060/cfs"}, "edited": false, "score": 0, "creation_date": 1424815418, "post_id": 28707207, "comment_id": 45703796, "body": "Which version of Outlook and operating system do you use?"}, {"owner": {"reputation": 65, "user_id": 4589630, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6db73b5d70a20f5b0fde53ace679706f?s=128&d=identicon&r=PG&f=1", "display_name": "ABCCompany", "link": "https://stackoverflow.com/users/4589630/abccompany"}, "reply_to_user": {"reputation": 1254, "user_id": 1207060, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/77a4c7259fa080dc084138c7198b1e3e?s=128&d=identicon&r=PG", "display_name": "cfs", "link": "https://stackoverflow.com/users/1207060/cfs"}, "edited": false, "score": 0, "creation_date": 1424818236, "post_id": 28707207, "comment_id": 45705151, "body": "Outlook 2007 and Windows 7, thanks"}], "answers": [{"tags": [], "owner": {"reputation": 1254, "user_id": 1207060, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/77a4c7259fa080dc084138c7198b1e3e?s=128&d=identicon&r=PG", "display_name": "cfs", "link": "https://stackoverflow.com/users/1207060/cfs"}, "is_accepted": false, "score": 0, "last_activity_date": 1424822253, "last_edit_date": 1424822253, "creation_date": 1424819459, "answer_id": 28708187, "question_id": 28707207, "link": "https://stackoverflow.com/questions/28707207/how-to-send-outlook-email-without-prompt-in-access-using-macros/28708187#28708187", "title": "How to send Outlook email without prompt in Access using macros?", "body": "<p>OK, I have stumbled on this once before with outlook 2007. In outlook 2007 there was a change from previous versions. The not so obvious thing was that it needed an installed antivirus to let go of the prompt that showed up. I just installed a free one but I think you have to use one that is recognized by windows. It must also be up to date with the virus definitions.</p>\n\n<p>This is of course after you have disabled all security in Outlook preventing programatic access (which is the default setting), and I think you need administrator privileges on the computer also. I just post this here, it's so long ago that I'll have to check on the system later to be 100% shure.</p>\n\n<p>Have a look at <a href=\"https://support.office.com/en-au/article/I-get-warnings-about-a-program-accessing-e-mail-address-information-or-sending-e-mail-on-my-behalf-df007135-c632-4ae4-8577-dd4ba26750a2?CorrelationId=63cb971b-b4fa-4f78-aa02-1302d20f260e&amp;ui=en-US&amp;rs=en-AU&amp;ad=AU\" rel=\"nofollow\">this</a> for some more information.</p>\n"}], "owner": {"reputation": 65, "user_id": 4589630, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6db73b5d70a20f5b0fde53ace679706f?s=128&d=identicon&r=PG&f=1", "display_name": "ABCCompany", "link": "https://stackoverflow.com/users/4589630/abccompany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 958, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424824324, "creation_date": 1424815303, "last_edit_date": 1424824324, "question_id": 28707207, "link": "https://stackoverflow.com/questions/28707207/how-to-send-outlook-email-without-prompt-in-access-using-macros", "title": "How to send Outlook email without prompt in Access using macros?", "body": "<p>How to send Outlook email without prompt in Access using macros? For example in the macro builder, I have send object selected and filled out the relevant fields. However when the macro runs, an outlook prompt pops up with the message but doesn't send the email.</p>\n"}, {"tags": ["vba", "outlook", "outlook-2010"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 4565343, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/7066f98b723f3d0319ed6c3644a5a72c?s=128&d=identicon&r=PG&f=1", "display_name": "parodytx", "link": "https://stackoverflow.com/users/4565343/parodytx"}, "edited": false, "score": 0, "creation_date": 1424871718, "post_id": 28709284, "comment_id": 45727844, "body": "No, that made no difference. Outlook is still appending the signature."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "reply_to_user": {"reputation": 65, "user_id": 4565343, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/7066f98b723f3d0319ed6c3644a5a72c?s=128&d=identicon&r=PG&f=1", "display_name": "parodytx", "link": "https://stackoverflow.com/users/4565343/parodytx"}, "edited": false, "score": 0, "creation_date": 1424899912, "post_id": 28709284, "comment_id": 45746265, "body": "Regardless of this not being the final fix you are processing the original &quot;objItem&quot; in DeleteSig rather than &quot;myItem&quot; which is the forwarded mail."}, {"owner": {"reputation": 65, "user_id": 4565343, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/7066f98b723f3d0319ed6c3644a5a72c?s=128&d=identicon&r=PG&f=1", "display_name": "parodytx", "link": "https://stackoverflow.com/users/4565343/parodytx"}, "edited": false, "score": 0, "creation_date": 1424919335, "post_id": 28709284, "comment_id": 45752827, "body": "For some reason your recommendation caused the autoforward to stop working. It works again when I reverted back. I cannot explain why this occurred."}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1424989554, "last_edit_date": 1525816189, "creation_date": 1424825791, "answer_id": 28709284, "question_id": 28706852, "link": "https://stackoverflow.com/questions/28706852/delete-automatic-signature-from-forwarded-emails-vba-macro/28709284#28709284", "title": "Delete automatic Signature from forwarded emails VBA macro", "body": "<p>Processing the wrong mail in DeleteSig.</p>\n\n<pre><code>myItem.DeleteAfterSubmit = True\n\nCall DeleteSig(myItem)\n\nmyItem.Send\n</code></pre>\n\n<p>Edit 2015 02 26</p>\n\n<p><a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">Debugging VBA Code</a></p>\n\n<pre><code>Private Sub Incoming3_test()\n' Open a mailitem then click F8 repeatedly from this code    \n    Dim currItem As MailItem\n    Set currItem = ActiveInspector.currentItem\n    Incoming3 currItem        \nEnd Sub\n\nSub Incoming3(MyMail As MailItem)        \n    Dim myItem As Outlook.MailItem        \n    Set myItem = MyMail.Forward            \n    myItem.Subject = MyMail.senderName &amp; \": \" &amp; MyMail.Subject\n    myItem.Recipients.Add \"bcc.hwb@gmail.com\"\n    myItem.DeleteAfterSubmit = True\n\n    myItem.Display  ' If you are using F8 you can\n                    '   view the action taken in DeleteSig.\n                    '  Delete the line later.\n\n    Call DeleteSig(myItem)\n    'myItem.Send\n\n    Set myItem = Nothing\n\nEnd Sub\n\nSub DeleteSig(msg As Outlook.MailItem)\n\n    Dim objDoc As Word.Document\n    Dim objBkm As Word.Bookmark\n\n    On Error Resume Next    '&lt;--- Very bad without On Error GoTo 0\n    Set objDoc = msg.GetInspector.WordEditor\n    Set objBkm = objDoc.Bookmarks(\"_MailAutoSig\")\n    On Error GoTo 0\n\n    If Not objBkm Is Nothing Then\n        objBkm.Select                       ' &lt;--- This is where the action starts.\n        objDoc.Windows(1).Selection.Delete\n    End If\n\n    Set objDoc = Nothing\n    Set objBkm = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Edit 2015 02 26 - End</p>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 4565343, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/7066f98b723f3d0319ed6c3644a5a72c?s=128&d=identicon&r=PG&f=1", "display_name": "parodytx", "link": "https://stackoverflow.com/users/4565343/parodytx"}, "edited": false, "score": 0, "creation_date": 1424872703, "post_id": 28715876, "comment_id": 45728510, "body": "Commented out the above. Changed all objItem to MyMail. Macro autoforwards correctly but also still appends the sig, As stated the called subroutine code comes from Microsoft but was in an Outlook 2007 example. I am not skilled enough in Word VBA to debug it adequately. Any other ideas?"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 65, "user_id": 4565343, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/7066f98b723f3d0319ed6c3644a5a72c?s=128&d=identicon&r=PG&f=1", "display_name": "parodytx", "link": "https://stackoverflow.com/users/4565343/parodytx"}, "edited": false, "score": 0, "creation_date": 1424872957, "post_id": 28715876, "comment_id": 45728698, "body": "The current web site is for developers. I&#39;d suggest learning the basics at least."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1424857986, "creation_date": 1424857986, "answer_id": 28715876, "question_id": 28706852, "link": "https://stackoverflow.com/questions/28706852/delete-automatic-signature-from-forwarded-emails-vba-macro/28715876#28715876", "title": "Delete automatic Signature from forwarded emails VBA macro", "body": "<p>When you assign a VBA macro sub to run by the rule you get an instance of the MailItem object. For example:</p>\n\n<pre><code> Sub Incoming3(MyMail As MailItem)\n</code></pre>\n\n<p>The MyMail object represents an incoming email message which you should use in the code. But I see that you get a new instance:</p>\n\n<pre><code>strID = MyMail.entryID\nSet objItem = Application.Session.GetItemFromID(strID)\n</code></pre>\n\n<p>There is no need to do so. Use the MyMail object in the code.</p>\n\n<p>Also I see the following code:</p>\n\n<pre><code> Set objBkm = objDoc.Bookmarks(\"_MailAutoSig\")\n</code></pre>\n\n<p>Try to run the code under the debugger and see whether the bookmark can be found. If there is no such bookmark you need to search the body for the first entry <strong>From:</strong> in the text and delete all the content before that keyword.</p>\n\n<p>Finally, you may find the <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736%28v=office.14%29.aspx\" rel=\"nofollow\">Getting Started with VBA in Outlook 2010</a> article in MSDN helpful.</p>\n"}], "owner": {"reputation": 65, "user_id": 4565343, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/7066f98b723f3d0319ed6c3644a5a72c?s=128&d=identicon&r=PG&f=1", "display_name": "parodytx", "link": "https://stackoverflow.com/users/4565343/parodytx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3505, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1593155606, "creation_date": 1424813960, "last_edit_date": 1593155606, "question_id": 28706852, "link": "https://stackoverflow.com/questions/28706852/delete-automatic-signature-from-forwarded-emails-vba-macro", "title": "Delete automatic Signature from forwarded emails VBA macro", "body": "<p>Newbie Outlook VBA. intermediate Excel VBA. Windows 7 Professional, Outlook 2010</p>\n\n<p>I have a script running from a rule that autoforwards all incoming emails. I need it as a rule because otherwise it will not forward the mails in the queue when Outlook loads.</p>\n\n<p>I would like to have the default signature deleted when the mails are forwarded. As the reply is \"blank\" it is unnecessary to have the sig appended. I have found some code that supposedly worked in Outlook 2007 from the MSDN site. It compiles no errors, executes no errors. I have referenced MS Word in VBA. But the forwarded emails all have the signature still attached.</p>\n\n<p>I cannot just delete the signature because I need it to be there on replies. The switch for the signature is for both replies and forwarded mail.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Option Explicit\nSub Incoming3(MyMail As MailItem)\n    Dim strID As String\n    Dim strSender As String\n    Dim StrSubject As String\n    Dim objItem As Outlook.MailItem\n    Dim myItem As Outlook.MailItem\n\n    strID = MyMail.entryID\n    Set objItem = Application.Session.GetItemFromID(strID)\n\n    strSender = objItem.SenderName\n    StrSubject = objItem.Subject\n    StrSubject = strSender + \": \" + StrSubject\n    objItem.Subject = StrSubject\n    objItem.AutoForwarded = False\n\n    Set myItem = objItem.Forward\n\n    myItem.Recipients.Add \"bcc.hwb@gmail.com\"\n    myItem.DeleteAfterSubmit = True\n\n    Call DeleteSig(objItem)\n\n    myItem.Send\n\n    Set myItem = Nothing\n    Set objItem = Nothing\n\nEnd Sub\n\n\nSub DeleteSig(msg As Outlook.MailItem)\n\n    Dim objDoc As Word.Document\n    Dim objBkm As Word.Bookmark\n\n    On Error Resume Next\n\n    Set objDoc = msg.GetInspector.WordEditor\n\n    Set objBkm = objDoc.Bookmarks(\"_MailAutoSig\")\n\n    If Not objBkm Is Nothing Then\n        objBkm.Select\n        objDoc.Windows(1).Selection.Delete\n    End If\n\n    Set objDoc = Nothing\n    Set objBkm = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Any help with Outlook or VBA code would be much appreciated.</p>\n"}, {"tags": ["excel", "vba", "date", "text"], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 3794203, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cba2a1760eb1c8f18f60de42d7070f21?s=128&d=identicon&r=PG&f=1", "display_name": "user3794203", "link": "https://stackoverflow.com/users/3794203/user3794203"}, "edited": false, "score": 0, "creation_date": 1424882215, "post_id": 28707254, "comment_id": 45735663, "body": "If I did decide to go the route of implementing a worksheet formula, if there a way to designate three different possibilities?  I.e. if I wanted three different possible answers depending upon whether the date was vbSunday (&quot;SUNDAY&quot;), vbSaturday(&quot;Saturday&quot;), or any other vbweekdays (&quot;No&quot;)?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 185, "user_id": 3794203, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cba2a1760eb1c8f18f60de42d7070f21?s=128&d=identicon&r=PG&f=1", "display_name": "user3794203", "link": "https://stackoverflow.com/users/3794203/user3794203"}, "edited": false, "score": 0, "creation_date": 1424882631, "post_id": 28707254, "comment_id": 45735954, "body": "WORKDAY() returns a number representing a day of the week, in my example 1 = monday, 2 = tuesday etc.. so you just test the value of that number"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 1, "last_activity_date": 1424815471, "creation_date": 1424815471, "answer_id": 28707254, "question_id": 28706807, "link": "https://stackoverflow.com/questions/28706807/returning-responses-based-upon-adjacent-cell-values/28707254#28707254", "title": "Returning Responses Based Upon Adjacent Cell Values", "body": "<p>In any scenario, you shouldn't even be using VBA for this - a worksheet formula will suffice:  </p>\n\n<hr>\n\n<p><strong>=IF(WEEKDAY(A1,2)&lt;6,\"No\",\"Yes\")</strong></p>\n\n<hr>\n\n<p>But the fact that you're getting an Application Error and not a 'Subscript out of range' error would suggest to me that you maybe have this code in the wrong place - perhaps in a worksheet module instead of a code module?</p>\n\n<p>Also, if this code is being called by a change event, then you really should be using manual event handling to stop an infinite loop occuring.</p>\n"}, {"comments": [{"owner": {"reputation": 185, "user_id": 3794203, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cba2a1760eb1c8f18f60de42d7070f21?s=128&d=identicon&r=PG&f=1", "display_name": "user3794203", "link": "https://stackoverflow.com/users/3794203/user3794203"}, "edited": false, "score": 0, "creation_date": 1424880707, "post_id": 28707980, "comment_id": 45734542, "body": "Thank you for the help.  On the &quot;Set X = Worksheets(&quot;Sheet1&quot;) line, I get an error &quot;Object required&quot;. Any guesses on what I may be missing?"}, {"owner": {"reputation": 5277, "user_id": 156648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dc62782d79a90b829e96f36f48fe164?s=128&d=identicon&r=PG", "display_name": "guitarthrower", "link": "https://stackoverflow.com/users/156648/guitarthrower"}, "reply_to_user": {"reputation": 185, "user_id": 3794203, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cba2a1760eb1c8f18f60de42d7070f21?s=128&d=identicon&r=PG&f=1", "display_name": "user3794203", "link": "https://stackoverflow.com/users/3794203/user3794203"}, "edited": false, "score": 0, "creation_date": 1424896720, "post_id": 28707980, "comment_id": 45744454, "body": "I edited the answer, I forgot to remove the <code>Set</code> from the begging of that line."}], "tags": [], "owner": {"reputation": 5277, "user_id": 156648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dc62782d79a90b829e96f36f48fe164?s=128&d=identicon&r=PG", "display_name": "guitarthrower", "link": "https://stackoverflow.com/users/156648/guitarthrower"}, "is_accepted": false, "score": 0, "last_activity_date": 1424879242, "last_edit_date": 1424879242, "creation_date": 1424818493, "answer_id": 28707980, "question_id": 28706807, "link": "https://stackoverflow.com/questions/28706807/returning-responses-based-upon-adjacent-cell-values/28707980#28707980", "title": "Returning Responses Based Upon Adjacent Cell Values", "body": "<p>This line is giving you your error</p>\n\n<pre><code>Set X = Worksheets(\"Sheet1\").Cells(i,3).Value\n</code></pre>\n\n<p>You cannot assign the value of a cell to a variable declared as a range.</p>\n\n<p>Based on your code, it looks like you want X to be text and not a Range object.</p>\n\n<p>Here is what your code should look like (I think):</p>\n\n<pre><code>Sub weekcheck()\n    Dim X As String\n\n    For i = 3 To 1500\n        If Worksheets(\"Sheet1\").Cells(i,3).Value &lt;&gt; 0 Then\n            X = Worksheets(\"Sheet1\").Cells(i,3).Value\n            If X = True Then\n                Worksheets(\"Sheet1\").Cells(i,3).Value = \"Yes\"\n            ElseIf X = False Then\n                Worksheets(\"Sheet1\").Cells(i,3).Value = \"No\"\n            End If\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 185, "user_id": 3794203, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cba2a1760eb1c8f18f60de42d7070f21?s=128&d=identicon&r=PG&f=1", "display_name": "user3794203", "link": "https://stackoverflow.com/users/3794203/user3794203"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1424888925, "creation_date": 1424813816, "last_edit_date": 1424888925, "question_id": 28706807, "link": "https://stackoverflow.com/questions/28706807/returning-responses-based-upon-adjacent-cell-values", "title": "Returning Responses Based Upon Adjacent Cell Values", "body": "<p>I have made some adjustments to my original question.  Firstly, a caveat that I am not a VBA elite by any stretch of the imagination, so this is just what I am trying to parse together for ease of workflow.</p>\n\n<p>Taking into consideration the comments given, I decided to include formulas in hidden cells that would help to make the process a bit easier, but I am still getting errors and am not sure exactly what is causing them. I have a column (rows 3-1500, col.U) that returns the name of the day of the week (it is reading the \"dddd\" of the date value that is entered into Column C (rows 3-1500))  and then I am trying to get Column M to return \"Yes\", \"No\", or \"Sunday\" depending upon the values stored in Column U... I keep getting the \"Application-defined or User-defined Error\" message, and am not really sure where the error is coming from. </p>\n\n<p>Note: this sub is within my worksheet module of the specific worksheet, I tried moving it outside as a public module, but it was throwing errors still.</p>\n\n<pre><code>Sub IsWeekend()\nFor i = 3 To 1500\nIf Cells(i, 3) &lt;&gt; 0 And Cells(i, 20) &lt;&gt; \"\" Then\nIf Range(\"U3:1500\") = \"Sunday\" Then\nRange(\"M3:1500\") = \"Sunday\"\nElseIf Range(\"U3:1500\").Text = \"Saturday\" Then\nRange(\"M3:1500\") = \"Yes\"\nElse\nRange(\"M3:1500\") = \"No\"\nEnd If\nEnd If\nNext i\nEnd Sub\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 3658086, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/x8POy.gif?s=128&g=1", "display_name": "hotkoreanchick", "link": "https://stackoverflow.com/users/3658086/hotkoreanchick"}, "edited": false, "score": 0, "creation_date": 1424814738, "post_id": 28706411, "comment_id": 45703442, "body": "Okay, that goes through my selected range but that doesn&#39;t necessarily activate each row for me to access the info I need from each row??"}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": false, "score": 1, "last_activity_date": 1424816698, "last_edit_date": 1424816698, "creation_date": 1424812483, "answer_id": 28706411, "question_id": 28706329, "link": "https://stackoverflow.com/questions/28706329/how-to-go-through-each-row-within-a-selected-range-using-vba/28706411#28706411", "title": "How to go through each row within a selected range using VBA", "body": "<p>Use a <code>For</code> loop, <code>Rows.Count</code> property, <code>Columns.Count</code></p>\n\n<pre><code>Dim i as long\nFor i = 1 to Selection.Rows.Count\n   For j = 1 To Selection.Columns.Count\n       Cells(i, j).Value ' Use this to access the value of cell in row i and column j\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 3658086, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/x8POy.gif?s=128&g=1", "display_name": "hotkoreanchick", "link": "https://stackoverflow.com/users/3658086/hotkoreanchick"}, "edited": false, "score": 0, "creation_date": 1424890070, "post_id": 28710868, "comment_id": 45740687, "body": "Thank you so much! Exactly what I needed to do :)"}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": true, "score": 1, "last_activity_date": 1424836738, "creation_date": 1424836738, "answer_id": 28710868, "question_id": 28706329, "link": "https://stackoverflow.com/questions/28706329/how-to-go-through-each-row-within-a-selected-range-using-vba/28710868#28710868", "title": "How to go through each row within a selected range using VBA", "body": "<p>You can loop through rows - but looping through a variant array is more efficient (for many rows)</p>\n\n<p><em>variant aray</em></p>\n\n<pre><code>Dim X\nDim lngCnt As Long\nX = Range(\"A6:B9\").Value2\nFor lngCnt = 1 To UBound(X)\n    Debug.Print Application.Min(Application.Index(X, lngCnt))\nNext\n</code></pre>\n\n<p><em>range approach</em></p>\n\n<pre><code>Dim rng1 As Range\nDim rng2 As Range\nSet rng1 = Range(\"A6:B9\")\nFor Each rng2 In rng1.Rows\n    Debug.Print Application.Min(rng2)\nNext\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 3658086, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/x8POy.gif?s=128&g=1", "display_name": "hotkoreanchick", "link": "https://stackoverflow.com/users/3658086/hotkoreanchick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7527, "favorite_count": 1, "accepted_answer_id": 28710868, "answer_count": 2, "score": 1, "last_activity_date": 1424836756, "creation_date": 1424812240, "last_edit_date": 1531161705, "question_id": 28706329, "link": "https://stackoverflow.com/questions/28706329/how-to-go-through-each-row-within-a-selected-range-using-vba", "title": "How to go through each row within a selected range using VBA", "body": "<p>Ideally, I would have a range selected and then I would run the macro and I want the macro to essentially run a loop to go through each row so I can extract information from each row until it reaches the end of the range.</p>\n\n<p>For example, A6:B9 are selected, first I want to focus on A6:B6. As in I want to be able to find the min value of the two cells for instance, using my MinSelected function(stated below) which requires a selected range which would ideally be A6:B6. And I want to do this for each row until the end of the original range.</p>\n\n<pre><code>Function MinSelected(R As Range)\n    MinSelected = Application.WorksheetFunction.min(R)\nEnd Function\n</code></pre>\n\n<p>Is there any way to do this??? Please tell me to clarify anything that's unclear. Thanks in advance.</p>\n"}, {"tags": ["vba", "debugging", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1424812160, "post_id": 28706249, "comment_id": 45702118, "body": "Try commenting out all the code, or even just change the function name so it stops getting called."}, {"owner": {"reputation": 37, "user_id": 2746898, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0aab350497eeb9316b5cf7b6e93c71ac?s=128&d=identicon&r=PG&f=1", "display_name": "User49582934", "link": "https://stackoverflow.com/users/2746898/user49582934"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1424812233, "post_id": 28706249, "comment_id": 45702155, "body": "In VBA editor, I went File-&gt; Close. Now I have excel tab in taskbar, but nothing shows up when I click on it. I am not able to close is either. What do I do?! Kill it using taskbar? Please help me!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 4, "creation_date": 1424812321, "post_id": 28706249, "comment_id": 45702191, "body": "Yes - kill it using Task Manager."}, {"owner": {"reputation": 37, "user_id": 2746898, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0aab350497eeb9316b5cf7b6e93c71ac?s=128&d=identicon&r=PG&f=1", "display_name": "User49582934", "link": "https://stackoverflow.com/users/2746898/user49582934"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1424812582, "post_id": 28706249, "comment_id": 45702334, "body": "@TimWilliams, killed it, started again, recovered old excel file. Got same error on evaluating the cell, renaming the function temporarily worked indeed, it opened the excel editor for me. Thanks!!"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1424815687, "post_id": 28706249, "comment_id": 45703952, "body": "Try posting the code that you&#39;re using so that we can try and see what is happening."}, {"owner": {"reputation": 37, "user_id": 2746898, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0aab350497eeb9316b5cf7b6e93c71ac?s=128&d=identicon&r=PG&f=1", "display_name": "User49582934", "link": "https://stackoverflow.com/users/2746898/user49582934"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1424818305, "post_id": 28706249, "comment_id": 45705184, "body": "@SO, actually this happens often, I just wanted to know how to stop debugging, irrespective of the mistakes in my code :)"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1424819448, "post_id": 28706249, "comment_id": 45705685, "body": "Does this code reside in an add-in or a normal workbook? Also - try pressing Ctrl + Break if the stop button isn&#39;t working."}, {"owner": {"reputation": 37, "user_id": 2746898, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0aab350497eeb9316b5cf7b6e93c71ac?s=128&d=identicon&r=PG&f=1", "display_name": "User49582934", "link": "https://stackoverflow.com/users/2746898/user49582934"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1424844028, "post_id": 28706249, "comment_id": 45712460, "body": "@SO, I triggered the error once again, tried saving and got the same &quot;can&#39;t save while debugging&quot; appeared. Now, I pressed CTRL + [Pause|Break] Key. Nothing visible happened, pressed save, and got the same &quot;can&#39;t save while debugging&quot;, thanks for helping though. I have posted my code to trigger this."}], "owner": {"reputation": 37, "user_id": 2746898, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0aab350497eeb9316b5cf7b6e93c71ac?s=128&d=identicon&r=PG&f=1", "display_name": "User49582934", "link": "https://stackoverflow.com/users/2746898/user49582934"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3957, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1424913802, "creation_date": 1424811989, "last_edit_date": 1424913802, "question_id": 28706249, "link": "https://stackoverflow.com/questions/28706249/stop-excel-form-debugging", "title": "Stop excel form debugging", "body": "<p>I made a custom function in VBA, and when I called it from a cell, some error occurred. I am not able to edit the cell or save the file because excel is \"debugging\". If I try to edit excel cells, it gives a \"beep\", and if I try to save, it shows this dialog. I have tried pressing the blue square (reset) button in VBA many times. How do I stop this \"debugging\"?</p>\n\n<p>Following is how VBA code looks like. The problem arose because I created a function named x(), and triggered it by calling ri() from a cell. After reading comments, I now know that I can stop debugging by renaming the function temporarily, but what is the right way to stop excel from \"debugging\"? I have also kept \"Auto Syntax Check\" unticked.</p>\n\n<p><img src=\"https://i.stack.imgur.com/7appj.png\" alt=\"enter image description here\"></p>\n\n<p>Following is the error message which appears on trying to save document.</p>\n\n<p><img src=\"https://i.stack.imgur.com/VGjUc.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["excel", "vba", "rounding"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1424811797, "post_id": 28706055, "comment_id": 45701899, "body": "Does it have to be VBA or an Excel formula can work? What have you tried? You&#39;ll have to narrow it down a bit, as it stands this is a pretty broad question."}, {"owner": {"reputation": 101, "user_id": 4602978, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06ccabb17964c3edc8c659dc2bde8b16?s=128&d=identicon&r=PG&f=1", "display_name": "job vink", "link": "https://stackoverflow.com/users/4602978/job-vink"}, "edited": false, "score": 0, "creation_date": 1424812719, "post_id": 28706055, "comment_id": 45702406, "body": "See the question is harder than it looks. I know how to round to the nearest even and I know how to round up or down. but the hard part is detecting when you have to do it."}], "answers": [{"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 1, "last_activity_date": 1424812908, "creation_date": 1424812908, "answer_id": 28706552, "question_id": 28706055, "link": "https://stackoverflow.com/questions/28706055/how-to-do-a-special-type-of-rounding-in-excel-vba/28706552#28706552", "title": "How to do a special type of rounding in excel/vba", "body": "<p>In VBA it is quite simple, since the VBA Round function does that kind of Rounding:</p>\n\n<pre><code>Function VBARound(N As Double, Optional NumPlaces As Long = 0) As Double\n    VBARound = Round(N, NumPlaces)\nEnd Function\n</code></pre>\n\n<p>The NUMPLACES will allow you to optionally round to other than a whole number.</p>\n"}, {"comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1424819422, "post_id": 28707412, "comment_id": 45705677, "body": "And why do you think the previous answer does NOT round 0.5 to whichever whole # is even?"}], "tags": [], "owner": {"reputation": 9, "user_id": 4603259, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/28da11fa59dd6b7ac19baf1419d817e7?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/4603259/nathan"}, "is_accepted": false, "score": 0, "last_activity_date": 1424816067, "creation_date": 1424816067, "answer_id": 28707412, "question_id": 28706055, "link": "https://stackoverflow.com/questions/28706055/how-to-do-a-special-type-of-rounding-in-excel-vba/28707412#28707412", "title": "How to do a special type of rounding in excel/vba", "body": "<p>I am a little unsure if this is what you were looking for as in your description you seem to imply looking for only whole numbers as results, so I left out a second variable for the function for the inclusion of additional decimal points to keep it simple. I think I interpreted your rounding a little differently than the previous answer, such that in the case of .5 you would opt to round to whichever whole # is even (not sure why this would be the case but if it were here you go!).</p>\n\n<p>I apologize for my sloppy formatting... I am a self taught VBA user so there may be a more efficient way:</p>\n\n<pre><code>Function CustomRound(N As Double)\n    If N - Application.WorksheetFunction.RoundDown(N, 0) = 0.5 Then\n        If Application.WorksheetFunction.RoundDown(N, 0) Mod 2 = 0 Then\n         CustomRound = Application.WorksheetFunction.RoundDown(N, 0)\n        Else\n         CustomRound = Application.WorksheetFunction.RoundUp(N, 0)\n        End If    \n    Else\n         CustomRound = Round(N, 0)\n    End If   \nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 4602978, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06ccabb17964c3edc8c659dc2bde8b16?s=128&d=identicon&r=PG&f=1", "display_name": "job vink", "link": "https://stackoverflow.com/users/4602978/job-vink"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 0, "accepted_answer_id": 28706552, "answer_count": 2, "score": 0, "last_activity_date": 1424816067, "creation_date": 1424811306, "last_edit_date": 1424812849, "question_id": 28706055, "link": "https://stackoverflow.com/questions/28706055/how-to-do-a-special-type-of-rounding-in-excel-vba", "title": "How to do a special type of rounding in excel/vba", "body": "<p>I have to do a special type of rounding in excel for my school project.</p>\n\n<p>If the number is bigger than #.5 I have to round it up.\nIf the  number is equal to #.5 I have to round it to the nearest even number.\nIf the number is less the #.5 I have to round it down.</p>\n\n<p>I hope somebody is able to help me.</p>\n\n<pre><code>Dim getal As Decimal = Nothing\n    Console.WriteLine(\"voer een nummer in\")\n    getal = Console.ReadLine()\n\n    Dim dec As Integer = Nothing\n    Console.WriteLine(\"voer het aantal deciale in\")\n    dec = Console.ReadLine()\n\n    Dim factor As Integer = 0\n    Dim floor As Decimal = 0\n    Dim decimaal As Decimal = 0\n    Dim antwoord As Decimal = 0\n    Dim percentage As Decimal = 0\n    Dim GetalTimesFactor As Decimal = 0\n    Dim OnNoukeurigheid As Decimal = 0\n    Dim VerFactor As Integer = 0\n    Dim HasFactor As Boolean = False\n    Dim notation As String = Nothing\n    Dim RoundUp As Decimal = 0\n\n    If getal &gt; 1000 Then\n        While getal &gt; 10\n            getal = getal / 10\n            VerFactor = VerFactor + 1\n            HasFactor = True\n        End While\n        Console.WriteLine(\"getal: \" &amp; getal)\n\n\n    End If\n\n    If getal &lt; 0.0001 Then\n        While getal &lt; 1\n            getal = getal * 10\n            VerFactor = VerFactor - 1\n            HasFactor = True\n        End While\n    End If\n\n    Select Case dec\n        Case 0\n            factor = 1\n            OnNoukeurigheid = 0.5\n            RoundUp = 1\n        Case 1\n            factor = 10\n            OnNoukeurigheid = 0.05\n            RoundUp = 0.1\n        Case 2\n            factor = 100\n            OnNoukeurigheid = 0.005\n            RoundUp = 0.01\n        Case 3\n            factor = 1000\n            OnNoukeurigheid = 0.0005\n            RoundUp = 0.001\n    End Select\n\n    GetalTimesFactor = getal * factor\n    floor = Decimal.Floor(GetalTimesFactor)\n    floor = floor / factor\n    decimaal = getal - floor\n    Console.WriteLine(\"floor: \" &amp; floor)\n\n    If decimaal &gt; OnNoukeurigheid Then\n        floor = floor * factor\n        antwoord = floor + 1\n        antwoord = antwoord / factor\n    ElseIf decimaal = OnNoukeurigheid Then\n        antwoord = Decimal.Round(getal, dec, MidpointRounding.ToEven)\n    Else\n        Console.WriteLine(\"decimaal: \" &amp; decimaal)\n        Console.WriteLine(\"getal: \" &amp; getal)\n        percentage = (decimaal / getal) * 100\n        If percentage &lt; 5 Then\n            Console.WriteLine(\"percentage is: \" &amp; Decimal.Round(percentage, 1) &amp; \"%\")\n            antwoord = floor\n        Else\n            Console.WriteLine(\"percentage is: \" &amp; Decimal.Round(percentage, 1) &amp; \"%\")\n            antwoord = floor + RoundUp\n        End If\n    End If\n\n    If HasFactor Then\n        notation = \"E\" &amp; Format(VerFactor, \"00\")\n    End If\n\n    Console.WriteLine(antwoord &amp; notation)\n    Console.ReadLine()\n</code></pre>\n\n<p>this is what i have made in express it does work but it doesn't work in macro</p>\n\n<p>note: sorry for the dutch varables</p>\n"}, {"tags": ["vba", "ms-access", "hyperlink", "ms-access-2010", "messagebox"], "comments": [{"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1424811045, "post_id": 28705916, "comment_id": 45701493, "body": "No but you could ask the user if they wanted to open the link and then navigate IE to the location for example."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 4, "creation_date": 1424811138, "post_id": 28705916, "comment_id": 45701540, "body": "or build a custom form for the messagebox and then you could add in the hyperlink"}], "answers": [{"tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 12, "last_activity_date": 1424817817, "creation_date": 1424817817, "answer_id": 28707842, "question_id": 28705916, "link": "https://stackoverflow.com/questions/28705916/putting-a-hyperlink-in-a-messagebox/28707842#28707842", "title": "Putting a hyperlink in a MessageBox", "body": "<p>A straight-forward answer is <strong>NO</strong>. MsgBox does not allow hyperlinks, just plain text.</p>\n\n<p>Thus, here is a workaround that should work alright.</p>\n\n<pre><code>Set objShell = CreateObject(\"Wscript.Shell\")\n\nintMessage = MsgBox(\"Sorry, but you have an out-of-date database version.  Please redownload via the batch file to ensure that you have the latest version. Contact the administrator of this database or your manager if you need help.\" &amp; vbCr _\n        &amp; vbCr _\n        &amp; \"Your current database version is \" &amp; CurrentVer &amp; \" which may be out of date. The current database version prescribed on the network share is \" &amp; FileVer &amp; \". They must match in order for you to proceed.\" &amp; vbCr _\n        &amp; vbCr _\n        &amp; \"Would you like to learn more about CSC self-help instructions on how to reload the most current version of the PRF Intake Tool to your computer?\", _\n        vbYesNo, \"There is a problem...\")\n\nIf intMessage = vbYes Then\n    objShell.Run (\"http://www.OurSite.com/online/Solutions/Search_Results.asp?opsystem=7&amp;keywords=PRF+Intake+Tool&amp;Category=\")\nElse\n    Wscript.Quit\nEnd If\n</code></pre>\n\n<p>If underline style is a requirement, then you should just create your own User Form as described at <a href=\"http://j-walk.com/ss/excel/tips/tip71.htm\" rel=\"noreferrer\">http://j-walk.com/ss/excel/tips/tip71.htm</a>. Here are the steps:</p>\n\n<ol>\n<li>Add a <code>Label</code> object and type your message</li>\n<li>Make the Label blue (<code>ForeColor</code>) and underlined (<code>Font</code>) so it looks like a typical hyperlink.</li>\n<li>Set the Label's <code>MousePointer</code> property to <em>99 - fmMousePointerCustom</em></li>\n<li>Specify the cursor file for the Label's <code>MouseIcon</code> image (if you have one).</li>\n<li><p>Double-click the Label and create a subroutine the <em>Click</em> event. Here's a sample code:</p>\n\n<pre><code>Private Sub Label1_Click()\n  Link = \"http://www.YOUR_SITE.com\"\n  On Error GoTo NoCanDo\n  ActiveWorkbook.FollowHyperlink Address:=Link, NewWindow:=True\n  Unload Me\n  Exit Sub\n NoCanDo:\n  MsgBox \"Cannot open \" &amp; Link End Sub\n</code></pre></li>\n</ol>\n\n<p>To create a \"mail to\" hyperlink, use a statement like this:</p>\n\n<pre><code>Link = \"mailto:someone@somewhere.com\"\n</code></pre>\n"}], "owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30394, "favorite_count": 2, "accepted_answer_id": 28707842, "answer_count": 1, "score": 8, "last_activity_date": 1594643534, "creation_date": 1424810823, "last_edit_date": 1594643534, "question_id": 28705916, "link": "https://stackoverflow.com/questions/28705916/putting-a-hyperlink-in-a-messagebox", "title": "Putting a hyperlink in a MessageBox", "body": "<p>Is it possible to add a hyperlink to a messagebox?  I'm trying to do something like this:</p>\n\n<pre><code>   MsgBox \"Sorry, but you have an out-of-date database version.  Please redownload via the batch file to ensure that you have the latest version. Contact the administrator of this database or your manager if you need help.\" &amp; vbCr _\n        &amp; vbCr _\n        &amp; \"Your current database version is \" &amp; CurrentVer &amp; \" which may be out of date. The current database version prescribed on the network share is \" &amp; FileVer &amp; \". They must match in order for you to proceed.\" &amp; vbCr _\n        &amp; vbCr _\n        &amp; \"For CSC self-help instructions on how to reload the most current version of the PRF Intake Tool to your computer, please click the link below to be directed to CSC Online instructions.\" &amp; vbCr _\n        &amp; vbCr _\n        &amp; \"http://www.OurSite.com/online/Solutions/Search_Results.asp?opsystem=7&amp;keywords=PRF+Intake+Tool&amp;Category=\", , \"There is a problem...\"\n</code></pre>\n\n<p>The problem is, the hyperlink isn't clickable.  I'd like to do this so that the users can just click the link and have the download begin automatically.</p>\n\n<p>I'm using Access 2010 in a Win7 environment.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 1, "creation_date": 1424810484, "post_id": 28705793, "comment_id": 45701188, "body": "I don&#39;t believe this requires VBA. A simple If statement should be able to handle this."}, {"owner": {"reputation": 81, "user_id": 4602863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/faa542ef97c6f26df75cfc5128350af4?s=128&d=identicon&r=PG&f=1", "display_name": "Munir Abrar", "link": "https://stackoverflow.com/users/4602863/munir-abrar"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1424819202, "post_id": 28705793, "comment_id": 45705576, "body": "Thanks a lot Kyle :)"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1424811338, "creation_date": 1424811338, "answer_id": 28706066, "question_id": 28705793, "link": "https://stackoverflow.com/questions/28705793/vba-excel-insert-symbol-based-on-cell-value/28706066#28706066", "title": "VBA Excel \u2014 Insert symbol based on cell value", "body": "<p>Give this a try:</p>\n\n<pre><code>Sub WhatEver()\n    Dim C As Range\n    Set C = Intersect(ActiveSheet.UsedRange, Range(\"C:C\"))\n    For Each cc In C\n        ccv = cc.Value\n        If ccv &lt;&gt; \"\" Then\n            If ccv = 0 Then\n                cc.Offset(0, -1).Value = \"&amp;n&amp;\"\n            ElseIf ccv &gt; 0 Then\n                cc.Offset(0, -1).Value = \"&amp;u&amp;\"\n            Else\n                cc.Offset(0, -1).Value = \"&amp;d&amp;\"\n            End If\n        End If\n    Next cc\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 4602863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/faa542ef97c6f26df75cfc5128350af4?s=128&d=identicon&r=PG&f=1", "display_name": "Munir Abrar", "link": "https://stackoverflow.com/users/4602863/munir-abrar"}, "edited": false, "score": 0, "creation_date": 1424819141, "post_id": 28706181, "comment_id": 45705549, "body": "Thanks eirikdaude for the formula. I was looking for a VBA which I got from Gary&#39;s Student :)"}], "tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": false, "score": 1, "last_activity_date": 1424811763, "creation_date": 1424811763, "answer_id": 28706181, "question_id": 28705793, "link": "https://stackoverflow.com/questions/28705793/vba-excel-insert-symbol-based-on-cell-value/28706181#28706181", "title": "VBA Excel \u2014 Insert symbol based on cell value", "body": "<p>As Kyle says, all you need for this is a simple (well, nested) if-formula:</p>\n\n<pre><code>=IF(C1&lt;0;\"&amp;d&amp;\";IF(C1&gt;0;\"&amp;u&amp;\";\"&amp;n&amp;\"))\n</code></pre>\n\n<p>The format is pretty straightforward, the if has three parts separated by semicolons. The first is the logical test, what you test for, in this case if the value in C1 is smaller (or larger) than 0. The next is the value you want in the cell if the the statement in the test is true, and finally what to put in if it is false.</p>\n\n<p>In this case, we test again if C1 is not smaller than 0, to see if it is larger than zero, that is why there is another if-statement inside the first one.</p>\n\n<p>To apply the formula to your entire column, just copy it down the entire way, and the cell it refers to should update automatically.</p>\n"}], "owner": {"reputation": 81, "user_id": 4602863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/faa542ef97c6f26df75cfc5128350af4?s=128&d=identicon&r=PG&f=1", "display_name": "Munir Abrar", "link": "https://stackoverflow.com/users/4602863/munir-abrar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1306, "favorite_count": 0, "accepted_answer_id": 28706066, "answer_count": 2, "score": 0, "last_activity_date": 1424811763, "creation_date": 1424810366, "last_edit_date": 1531161705, "question_id": 28705793, "link": "https://stackoverflow.com/questions/28705793/vba-excel-insert-symbol-based-on-cell-value", "title": "VBA Excel \u2014 Insert symbol based on cell value", "body": "<p>I need to work with Excel to which I am absolutely new. I am looking for a VBA solution to speed up some daily work. Here is my case: I need to check cells of Column C which has negative, positive and netural values and then insert sysmbols in corresponding cells of Column B.</p>\n\n<p>For instance, if <strong>C4</strong> has a positive value (2,345), <strong>B4</strong> should have <strong>&amp;u&amp;</strong> as symbol. If <strong>C5</strong> has negative value (-12.98), then <strong>B5</strong> should have <strong>&amp;d&amp;</strong> as a symbol. And if <strong>C6</strong> has a netural value (0.000), then <strong>B6</strong> should be inserted with <strong>&amp;n&amp;</strong> as a symbol.</p>\n\n<p>An empty <strong>B</strong> column already exists and values are all in Column <strong>C</strong>.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": false, "score": 0, "last_activity_date": 1424808428, "creation_date": 1424808428, "answer_id": 28705273, "question_id": 28705054, "link": "https://stackoverflow.com/questions/28705054/excel-vba-to-parse-vowels-in-a-string/28705273#28705273", "title": "Excel VBA to parse vowels in a string", "body": "<p>Insert this function into a module and type \"=Words(\"reference\") in a cell where \"reference\" is a cell containing one of the strings you would like to process. This could also be put into a sub procedure to loop through all your cells of strings, but you would need to supply more information.</p>\n\n<pre><code>Function Words(str as String) as String\nDim str as String\nDim result as string\nDim i as Integer\nFor i = 1 to Len(str)\nIf Mid(str,i,1) like [aeiouAEIOU] then\nResult = \"V\" &amp; Result\nElse\nResult = \"C\" &amp; Result\nEnd if\nWords = Result\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 568, "user_id": 2781105, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a8ef4fa797b69a4ccb767ed87ccfe8a8?s=128&d=identicon&r=PG&f=1", "display_name": "jimiclapton", "link": "https://stackoverflow.com/users/2781105/jimiclapton"}, "edited": false, "score": 0, "creation_date": 1424811778, "post_id": 28705283, "comment_id": 45701888, "body": "Thanks so much. Could you please explain the process here? I&#39;m now using the function =ConsonantVowel but it&#39;s only assessing the first 2 chars. Is this to be expected?"}, {"owner": {"reputation": 838, "user_id": 3865006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gkKb8.png?s=128&g=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/3865006/steven"}, "reply_to_user": {"reputation": 568, "user_id": 2781105, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a8ef4fa797b69a4ccb767ed87ccfe8a8?s=128&d=identicon&r=PG&f=1", "display_name": "jimiclapton", "link": "https://stackoverflow.com/users/2781105/jimiclapton"}, "edited": false, "score": 0, "creation_date": 1424872856, "post_id": 28705283, "comment_id": 45728611, "body": "Put a break point on the While line to see what the value is for the sInputString.  This function should loop through all of the characters in the string."}], "tags": [], "owner": {"reputation": 838, "user_id": 3865006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gkKb8.png?s=128&g=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/3865006/steven"}, "is_accepted": false, "score": 0, "last_activity_date": 1424808447, "creation_date": 1424808447, "answer_id": 28705283, "question_id": 28705054, "link": "https://stackoverflow.com/questions/28705054/excel-vba-to-parse-vowels-in-a-string/28705283#28705283", "title": "Excel VBA to parse vowels in a string", "body": "<p>Nothing fancy here.  This code would go into a Module and referenced from a cell that would contain the output data.</p>\n\n<pre><code>Public Function ConsonantVowel(ByVal sInputString As String) As String\nDim sReturnData As String\nDim x As Integer\n\nsReturnData = \"\"\nx = 1\nWhile x &lt;= Len(sInputString)\n\n    If UCase(Mid(sInputString, x, 1)) = \"A\" Or UCase(Mid(sInputString, x, 1)) = \"E\" Or UCase(Mid(sInputString, x, 1)) = \"I\" _\n        Or UCase(Mid(sInputString, x, 1)) = \"O\" Or UCase(Mid(sInputString, x, 1)) = \"U\" Then\n        sReturnData = sReturnData &amp; \"V\"\n    Else\n        sReturnData = sReturnData &amp; \"C\"\n    End If\n    x = x + 1\nWend\nConsonantVowel = sReturnData\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 0, "last_activity_date": 1424808494, "creation_date": 1424808494, "answer_id": 28705301, "question_id": 28705054, "link": "https://stackoverflow.com/questions/28705054/excel-vba-to-parse-vowels-in-a-string/28705301#28705301", "title": "Excel VBA to parse vowels in a string", "body": "<p>I created a user defined function to loop through the characters in the string, and return a C if it's a consonant and a V if it's a vowel.</p>\n\n<p>Place the below code in a standard VBA module:</p>\n\n<pre><code>Function ConsonantOrVowel(strWord As String) As String\n    Dim nLen As Integer\n\n    nLen = Len(strWord)\n\n    ConsonantOrVowel = \"\"\n    For i = 1 To nLen\n        If UCase(Mid(strWord, i, 1)) Like \"[AEIOU]\" Then\n            ConsonantOrVowel = ConsonantOrVowel + \"V\"\n        Else\n            ConsonantOrVowel = ConsonantOrVowel + \"C\"\n        End If\n    Next i\nEnd Function\n</code></pre>\n\n<p>Next, in an Excel cell, enter the formula <code>=ConsonantOrVowel(A1)</code> as you would a regular formula. (Note, the preceding example assumes the string you want to test is in cell A1). </p>\n"}, {"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 568, "user_id": 2781105, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a8ef4fa797b69a4ccb767ed87ccfe8a8?s=128&d=identicon&r=PG&f=1", "display_name": "jimiclapton", "link": "https://stackoverflow.com/users/2781105/jimiclapton"}, "edited": false, "score": 1, "creation_date": 1424879083, "post_id": 28705417, "comment_id": 45733226, "body": "@jimiclapton you&#39;re welcome. Do consider &quot;accepting&quot; the answer if it has solved your problem."}, {"owner": {"reputation": 4965, "user_id": 14728, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4634fe0cea18d6e2daa35a25eee89581?s=128&d=identicon&r=PG&f=1", "display_name": "Taptronic", "link": "https://stackoverflow.com/users/14728/taptronic"}, "edited": false, "score": 0, "creation_date": 1429152249, "post_id": 28705417, "comment_id": 47468151, "body": "Thanks for this function!"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 3, "last_activity_date": 1424808888, "creation_date": 1424808888, "answer_id": 28705417, "question_id": 28705054, "link": "https://stackoverflow.com/questions/28705054/excel-vba-to-parse-vowels-in-a-string/28705417#28705417", "title": "Excel VBA to parse vowels in a string", "body": "<p>I'll jump on the bandwagon, too... This checks the ASCII code value of each character, ignores anything outside of the A-Z range for consideration.</p>\n\n<pre><code>Public Function GetPattern(ByRef rng As Excel.Range)\n\nDim str As String ' the value being parsed\nDim ret As String ' the return value for the function\nDim i As Long\nConst C As String = \"C\"\nConst V As String = \"V\"\nDim char As String\n\nstr = Trim(UCase(rng.Value))\n\nFor i = 1 To Len(str)\n    char = Mid(str, i, 1)\n    'Ignores numbers and non-printing characters, symbols, etc.\n    If 65 &lt;= Asc(char) And Asc(char) &lt;= 90 Then\n        Select Case Asc(char)\n            Case 65, 69, 73, 79, 85 'Ascii codes for A, E, I, O, U\n                ret = ret &amp; V\n            Case Else\n                ret = ret &amp; C\n        End Select\n    End If\nNext\n\nGetPattern = ret\n\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1424811075, "last_edit_date": 1424811075, "creation_date": 1424809312, "answer_id": 28705545, "question_id": 28705054, "link": "https://stackoverflow.com/questions/28705054/excel-vba-to-parse-vowels-in-a-string/28705545#28705545", "title": "Excel VBA to parse vowels in a string", "body": "<p>Here's a method that makes use of Regular Expressions to define vowels</p>\n\n<ul>\n<li>Replace all the vowels with a tilde <code>~</code></li>\n<li>Replace everything that is not a tilde with a <code>C</code></li>\n<li>Replace the tilde with a <code>V</code></li>\n</ul>\n\n<hr>\n\n<pre><code>Option Explicit\nFunction VorC(S As String) As String\n    Dim RE As Object\n    Dim sTemp As String\nSet RE = CreateObject(\"vbscript.regexp\")\nWith RE\n    .Global = True\n    .ignorecase = True\n    .Pattern = \"[AEIOU]\"\nEnd With\n\nsTemp = RE.Replace(S, \"~\")\nRE.Pattern = \"[^~]\"\nsTemp = RE.Replace(sTemp, \"C\")\nVorC = Replace(sTemp, \"~\", \"V\")\n\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>If you want to include the occasional <code>Y</code> as a vowel, and are happy with calling it a vowel in the instance where it is surrounded by two consonants, one could change the first Regex Replacement routine to:</p>\n\n<pre><code>With RE\n    .Global = True\n    .ignorecase = True\n    .Pattern = \"[AEIOU]|([^AEIOU])Y([^AEIOU])\"\nEnd With\n\nsTemp = RE.Replace(S, \"$1~$2\")\n</code></pre>\n\n<p>And keep the rest of the UDF unchanged.</p>\n\n<p>However, the rules for calling <code>Y</code> a vowel are more complex than that, and sometimes it's not really a vowel, but part of a dipthong, so things can get fuzzy pretty quickly.</p>\n"}], "owner": {"reputation": 568, "user_id": 2781105, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a8ef4fa797b69a4ccb767ed87ccfe8a8?s=128&d=identicon&r=PG&f=1", "display_name": "jimiclapton", "link": "https://stackoverflow.com/users/2781105/jimiclapton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2062, "favorite_count": 0, "accepted_answer_id": 28705417, "answer_count": 5, "score": 0, "last_activity_date": 1424811075, "creation_date": 1424807705, "last_edit_date": 1424809487, "question_id": 28705054, "link": "https://stackoverflow.com/questions/28705054/excel-vba-to-parse-vowels-in-a-string", "title": "Excel VBA to parse vowels in a string", "body": "<p>I have a list of 5char alpha strings made of consonants and vowels.\nI'm trying to identify the combination in each string. </p>\n\n<blockquote>\n  <p>Eg DBNJE is CCCCV and AHOIS is VCVVC for example.</p>\n</blockquote>\n\n<p>I've written this as a series of 5 pretty clumsy formulae to assess the C or V property for each of the 5 chars in the string, as below</p>\n\n<p>Char1    </p>\n\n<pre><code>=IF(OR(LEFT($B2,1)=\"A\",LEFT($B2,1)=\"E\",LEFT($B2,1)=\"I\",LEFT($B2,1)=\"O\",LEFT($B2,1)=\"U\"),\"V\",\"C\")\n</code></pre>\n\n<p>And</p>\n\n<p>Char2   </p>\n\n<pre><code>=IF(OR(MID($B2,2,1)=\"A\",MID($B2,2,1)=\"E\",MID($B2,2,1)=\"I\",MID($B2,2,1)=\"O\",MID($B2,2,1)=\"U\"),\"V\",\"C\")\n</code></pre>\n\n<p>Etc etc</p>\n\n<p>With me so far?</p>\n\n<p>I then concatenate the results in a single cell to give me the combo as in the first example above.</p>\n\n<p>This works fine, but I'd like to automate it using VBA. Could anybody please tell me the best way to go about doing this?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "paramarray"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1424807828, "post_id": 28704950, "comment_id": 45699694, "body": "I&#39;m visual, can you please add a little code snippet to illustrate your problem?"}], "answers": [{"tags": [], "owner": {"reputation": 1688, "user_id": 1079093, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/14f127499bff3cdd17bb0204e55948ac?s=128&d=identicon&r=PG", "display_name": "Hauns TM", "link": "https://stackoverflow.com/users/1079093/hauns-tm"}, "is_accepted": false, "score": 1, "last_activity_date": 1424808010, "last_edit_date": 1525816150, "creation_date": 1424808010, "answer_id": 28705152, "question_id": 28704950, "link": "https://stackoverflow.com/questions/28704950/passing-an-unknown-number-of-arguments-into-paramarray-in-vba/28705152#28705152", "title": "Passing an unknown number of arguments into ParamArray in VBA", "body": "<p>From Cpearson <a href=\"http://www.cpearson.com/excel/passingandreturningarrays.htm\" rel=\"nofollow noreferrer\">Passing And Returning Arrays With Functions</a>, this is how you pass an array into a function and loop that array:</p>\n\n<pre><code>Sub DoSomethingWithPassedArray(ByRef Arr() As Long)\n\n    Dim N As Long\n    For N = LBound(Arr) To UBound(Arr)\n        '...do something\n    Next N\nEnd Sub\n</code></pre>\n\n<p>Further on, it's not clear what you want to do...</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 11554034, "user_type": "registered", "profile_image": "https://graph.facebook.com/1196957956996000/picture?type=large", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/11554034/francisco-costa"}, "is_accepted": false, "score": 0, "last_activity_date": 1569953620, "last_edit_date": 1569953620, "creation_date": 1569953206, "answer_id": 58190159, "question_id": 28704950, "link": "https://stackoverflow.com/questions/28704950/passing-an-unknown-number-of-arguments-into-paramarray-in-vba/58190159#58190159", "title": "Passing an unknown number of arguments into ParamArray in VBA", "body": "<p>Here it is (it is related with my question in <a href=\"https://stackoverflow.com/questions/58188684/calling-vba-macro-from-python-with-unknown-number-of-arguments\">Calling vba macro from python with unknown number of arguments</a>)<br/></p>\n\n<p>Use this:<br/></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub pass_this()\n    Call flexible(\"a\")\nEnd Sub\nSub pass_alsothis()\n    Call flexible(\"a\", 2)\nEnd Sub\nSub flexible(ParamArray args() As Variant)\n    Dim i As Long\n    MsgBox (\"I have received \" &amp; _\n            Str(UBound(args) + 1) &amp; _\n            \" parameters.\")\n    For i = 0 To UBound(args)\n        MsgBox (TypeName(args(i)))\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Cheers.</p>\n"}], "owner": {"reputation": 351, "user_id": 4484829, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/9e67521a149838fd6fb023c678716905?s=128&d=identicon&r=PG&f=1", "display_name": "KingKong", "link": "https://stackoverflow.com/users/4484829/kingkong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1393, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1569953620, "creation_date": 1424807393, "last_edit_date": 1424830029, "question_id": 28704950, "link": "https://stackoverflow.com/questions/28704950/passing-an-unknown-number-of-arguments-into-paramarray-in-vba", "title": "Passing an unknown number of arguments into ParamArray in VBA", "body": "<p>I have a function that takes in a ParamArray that I'm trying to pass an unknown number of parameters into.  I'm looping through rows and passing in numbers based on if the cells are empty or not, but it seems like I have to pass in each number as its own argument.  I tried putting the numbers into an array and passing that, but it just ended up being an array of an array in the function and not working properly.  Is there a way to do this?  Thank you.</p>\n\n<p>Ex:</p>\n\n<pre><code>Dim myarray() as double\n\nfunction test(ParamArray arg() as variant) as single\n  'function does stuff with arg(s)\nend function\n\nfor each cell in [somerange]\n  if cell &lt;&gt; \"\" then\n    'save cell value into an myarray?\n  endif\nnext\n\n'want to pass those saved values into function\ncall test(myarray)\n</code></pre>\n\n<p>Edit: I kind of found a workaround.  I realized I can pass a range into the function so I'm just going to create a temporary range and pass that in.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 4387101, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6bd4fbb0d14d0a8a6c4be1d53cb19a58?s=128&d=identicon&r=PG&f=1", "display_name": "Aerogems", "link": "https://stackoverflow.com/users/4387101/aerogems"}, "edited": false, "score": 0, "creation_date": 1424809148, "post_id": 28705043, "comment_id": 45700442, "body": "As this is just a small segment of a couple hundred lines of code, I realize I neglected to mention that I do disable both events and screen updating.  I have a function to turn both of those on and off, but just to test I commented it out, added <code>Application.EnableEvents = False</code> at the top of my code and get the exact same error."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 15, "user_id": 4387101, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6bd4fbb0d14d0a8a6c4be1d53cb19a58?s=128&d=identicon&r=PG&f=1", "display_name": "Aerogems", "link": "https://stackoverflow.com/users/4387101/aerogems"}, "edited": false, "score": 0, "creation_date": 1424809865, "post_id": 28705043, "comment_id": 45700858, "body": "You may be better off adding a button to perform the paste operation entirely via VBA, rather than trying to capture it as an event."}, {"owner": {"reputation": 15, "user_id": 4387101, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6bd4fbb0d14d0a8a6c4be1d53cb19a58?s=128&d=identicon&r=PG&f=1", "display_name": "Aerogems", "link": "https://stackoverflow.com/users/4387101/aerogems"}, "edited": false, "score": 0, "creation_date": 1424810982, "post_id": 28705043, "comment_id": 45701459, "body": "That explains what is happening and why, now for my own edification I want to know if there&#39;s some way I can override this behavior in the event it may become useful later. At this time, I was using the table primarily as a convenient means of providing shading to alternating rows, so I can live without it if it is going to be an issue."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 15, "user_id": 4387101, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6bd4fbb0d14d0a8a6c4be1d53cb19a58?s=128&d=identicon&r=PG&f=1", "display_name": "Aerogems", "link": "https://stackoverflow.com/users/4387101/aerogems"}, "edited": false, "score": 0, "creation_date": 1424811964, "post_id": 28705043, "comment_id": 45702002, "body": "Which specific behavior are you trying to override? The automatic insertion of the table column headers, or the <code>Undo</code> clearing out the clipboard?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 15, "user_id": 4387101, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6bd4fbb0d14d0a8a6c4be1d53cb19a58?s=128&d=identicon&r=PG&f=1", "display_name": "Aerogems", "link": "https://stackoverflow.com/users/4387101/aerogems"}, "edited": false, "score": 0, "creation_date": 1424812123, "post_id": 28705043, "comment_id": 45702094, "body": "There will not be an easy way to do the former (i.e., there is no built in method to do this although you could develop some complicated logic to test for &quot;adjacency&quot; with the existing ListObject table...) and the latter is probably not possible at all.  Do remember to mark answers as &quot;Accepted&quot; if they&#39;ve answered the question/solved the problem.  Cheers."}, {"owner": {"reputation": 15, "user_id": 4387101, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6bd4fbb0d14d0a8a6c4be1d53cb19a58?s=128&d=identicon&r=PG&f=1", "display_name": "Aerogems", "link": "https://stackoverflow.com/users/4387101/aerogems"}, "edited": false, "score": 0, "creation_date": 1424815706, "post_id": 28705043, "comment_id": 45703960, "body": "It would be the former, overriding the automatic creation of table headers. Guess I will have to dump the table."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 15, "user_id": 4387101, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6bd4fbb0d14d0a8a6c4be1d53cb19a58?s=128&d=identicon&r=PG&f=1", "display_name": "Aerogems", "link": "https://stackoverflow.com/users/4387101/aerogems"}, "edited": false, "score": 0, "creation_date": 1424815916, "post_id": 28705043, "comment_id": 45704065, "body": "Yeah, I think the table headers will automatically happen whenever you paste, insert, or enter data adjacent to an existing table row/column.  You can &quot;undo&quot; this like you tried, but that breaks the &quot;paste&quot;, it would be possible to make a clunky workaround, where you temporarily add a hidden worksheet, paste the data there, then paste it in the destination sheet, then do the undo, then try to re-paste from the hidden sheet accounting for adjacency, etc., then delete the hidden sheet.  But that may be overkill :)"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 0, "last_activity_date": 1424809628, "last_edit_date": 1424809628, "creation_date": 1424807675, "answer_id": 28705043, "question_id": 28704919, "link": "https://stackoverflow.com/questions/28704919/excel-2010-pastespecial-method-of-range-class-failed/28705043#28705043", "title": "Excel 2010 PasteSpecial method of range class failed", "body": "<blockquote>\n  <p>I want to understand why \"Column1\" and \"Column2\" are being inserted by Excel,</p>\n</blockquote>\n\n<p>This happens when you paste data adjacent to an existing <code>ListObject</code> table.</p>\n\n<p>The change event occurs (i.e., you \"Paste\" the data), the worksheet changes, and <em>then</em>, the <code>Worksheet_Change</code> event fires.</p>\n\n<p>The error seems to happen because <code>Application.Undo</code> is undoing the Paste operation <em>and</em> further affecting the <code>Application.CutCopyMode = False</code>, so on the next line when you attempt to use the <code>PasteSpecial</code> method, there simply is nothing that can be pasted, because the <code>Undo</code> has cleared it.</p>\n"}, {"tags": [], "owner": {"reputation": 578, "user_id": 2864943, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1c2806b31e9db236ecaea41e7427abb4?s=128&d=identicon&r=PG&f=1", "display_name": "Michael ", "link": "https://stackoverflow.com/users/2864943/michael"}, "is_accepted": false, "score": -1, "last_activity_date": 1448830136, "last_edit_date": 1495542618, "creation_date": 1448830136, "answer_id": 33987956, "question_id": 28704919, "link": "https://stackoverflow.com/questions/28704919/excel-2010-pastespecial-method-of-range-class-failed/33987956#33987956", "title": "Excel 2010 PasteSpecial method of range class failed", "body": "<p>Pastespecial seems to be very sensitive to the parameters it's fed. </p>\n\n<p>I was experiencing exactly the same error message from code that had worked before migrating to Windows 10.  I found this combination of parameters worked in my case:</p>\n\n<pre><code>Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n:=False, Transpose:=False\n</code></pre>\n\n<p>Can't claim that I found that combo of parameters- it came from <a href=\"https://stackoverflow.com/questions/17281872/pastespecial-method-of-range-class-failed\">yactici's self answer</a> </p>\n\n<p>Kudos to yactici for returning to his initial problem despite having a workaround and directly resolving the problem with pastespecial.</p>\n"}], "owner": {"reputation": 15, "user_id": 4387101, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6bd4fbb0d14d0a8a6c4be1d53cb19a58?s=128&d=identicon&r=PG&f=1", "display_name": "Aerogems", "link": "https://stackoverflow.com/users/4387101/aerogems"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1087, "favorite_count": 0, "accepted_answer_id": 28705043, "answer_count": 2, "score": 0, "last_activity_date": 1448830136, "creation_date": 1424807302, "last_edit_date": 1424809260, "question_id": 28704919, "link": "https://stackoverflow.com/questions/28704919/excel-2010-pastespecial-method-of-range-class-failed", "title": "Excel 2010 PasteSpecial method of range class failed", "body": "<p>I am attempting to understand why a certain bit of code will not work in Excel 2010. </p>\n\n<p>I have a file where cells A1:K200 are part of a table (the Format as Table option form the Home tab), but rows 2-13 are hidden for use with data validation combo boxes. Header row and row banding options are enabled. What I want to do is copy (via the user pressing Ctrl-C) and paste (via user pressing Ctrl-V) data from another workbook and then have a macro function in <code>Worksheet_Change</code> that will transpose the data (based on the value of a checkbox on the worksheet) and paste only the values. Columns A-H will be filled out with other data.</p>\n\n<p>I have disabled events and screen updating, set up a range for cells I14:I200 as <code>StdCost</code> for an intersect function and then have the following code to trap changes to the above range. <code>optTranspose</code> is a checkbox I have placed on the sheet and <code>Target</code> is the variable set up by Excel as part of the <code>Worksheet_Change</code> function. </p>\n\n<pre><code>If Not Application.Intersect(Target, StdCost) Is Nothing Then\n    If Application.CutCopyMode = xlCopy Then\n        Application.Undo\n        .Range(\"I\" &amp; Target.Row).PasteSpecial Paste:=xlPasteValues, Transpose:=optTranspose\n    End If\nEnd If\n</code></pre>\n\n<p>The above code will work, but based on my testing it will only work with a maximum of 4 values being pasted in OR it will work if I paste starting on row 15 or below. However, if I paste 5+ values I get the error from the subject</p>\n\n<blockquote>\n  <p>PasteSpecial method of range class failed</p>\n</blockquote>\n\n<p>From my testing, what appears to happen is that before the undo operation kicks in, Excel automatically adds <code>Column1</code> and <code>Column2</code> to columns L and M, which then causes <code>Target</code> to take on \"Column1\" and \"Column2\" and thus ends up causing the error when I try and run it on the actual values I want to paste. If I convert the table to a normal range, everything appears to operate as expected. </p>\n\n<p>I want to understand why \"Column1\" and \"Column2\" are being inserted by Excel, why it's only at 5+ cells from another spreadsheet that it becomes and issue and how I might be able to account for this in my code.</p>\n"}, {"tags": ["vb.net", "vba", "vsto"], "answers": [{"comments": [{"owner": {"reputation": 2316, "user_id": 398157, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/ciEpE.jpg?s=128&g=1", "display_name": "ForEachLoop", "link": "https://stackoverflow.com/users/398157/foreachloop"}, "edited": false, "score": 0, "creation_date": 1424874494, "post_id": 28715474, "comment_id": 45729746, "body": "Thanks. I haven&#39;t explicitly used a thread or background worker. Your link mentions using XML or a pause-evoking class. Do you have examples you like? I&#39;ve never used either like this."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 2316, "user_id": 398157, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/ciEpE.jpg?s=128&g=1", "display_name": "ForEachLoop", "link": "https://stackoverflow.com/users/398157/foreachloop"}, "edited": false, "score": 0, "creation_date": 1424874806, "post_id": 28715474, "comment_id": 45729972, "body": "No, I don&#39;t have any sample for that."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1424856822, "creation_date": 1424856822, "answer_id": 28715474, "question_id": 28704807, "link": "https://stackoverflow.com/questions/28704807/avoiding-vsto-word-automation-timing-rpc-e-call-rejected-errors/28715474#28715474", "title": "Avoiding VSTO, Word Automation Timing RPC_E_CALL_REJECTED Errors", "body": "<p>Most probably you are using the Word object model from secondary threads. Office application uses the single threaded apartment model. It is not recommended to use any object model from a secondary thread. </p>\n\n<p>Also you may find the <a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/d599aa35-9239-411d-b5b3-1f95ae413ba3/microsoftofficeinteropwordapplication-prevent-open-document?forum=worddev\" rel=\"nofollow\">similar forum thread</a> helpful.</p>\n"}], "owner": {"reputation": 2316, "user_id": 398157, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/ciEpE.jpg?s=128&g=1", "display_name": "ForEachLoop", "link": "https://stackoverflow.com/users/398157/foreachloop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 463, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424856822, "creation_date": 1424806936, "question_id": 28704807, "link": "https://stackoverflow.com/questions/28704807/avoiding-vsto-word-automation-timing-rpc-e-call-rejected-errors", "title": "Avoiding VSTO, Word Automation Timing RPC_E_CALL_REJECTED Errors", "body": "<p>I am writing a VSTO VB.NET application that controls a Word document, using standard features such as copying, pasting, inserting text, and pages, for example, and no additional threads. I get the following error at different times: <strong>Call was rejected by callee. (Exception from HRESULT: 0x80010001 (RPC_E_CALL_REJECTED)</strong>).</p>\n\n<p>This appears to be a timing issue with Word, since it fails almost randomly but only on Word calls. In the debugger, I can then click <strong>Continue</strong> and the code resumes.</p>\n\n<p>I've seen a lot of comments about this, relevant ones seems to be about the COM IMessageFilter interface. But they all skip one important point: I just want to wait for Word to get free again and then continue. I don't want to prompt the user with options (such as with RetryRejectedCall). An ugly work around right now is intentional delays, like Threading.Thread.Sleep(500), but that's hardly the solution, and with many calls that's also impractical.</p>\n\n<p>What is the proper way of handling this?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 4536718, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/6f9246168eb45e82be8c1ef9ac8bd983?s=128&d=identicon&r=PG&f=1", "display_name": "javad", "link": "https://stackoverflow.com/users/4536718/javad"}, "edited": false, "score": 0, "creation_date": 1424807567, "post_id": 28704694, "comment_id": 45699536, "body": "Thanks for your code but the problem is if there is two john in one cell, your code only see the first john, In that case, I want to copy that cell in two rows in column B, because the cell has two john."}], "tags": [], "owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "is_accepted": false, "score": 2, "last_activity_date": 1424873220, "last_edit_date": 1424873220, "creation_date": 1424806578, "answer_id": 28704694, "question_id": 28704563, "link": "https://stackoverflow.com/questions/28704563/finding-a-word-in-a-range-and-inserting-those-cells-that-have-the-word-into-a-co/28704694#28704694", "title": "Finding a word in a range and inserting those cells that have the word into a column", "body": "<p>Edited since I missed the repeat necessity.  </p>\n\n<p>This worked on my quick test.</p>\n\n<pre><code>Sub find()\n  Dim c As Range\n  Dim destination As Range\n  Dim i As Long\n  Const SEARCH_TERM As String = \"john\"\n\n  Set destination = Range(\"B1\")\n  For Each c In Range(\"A1:A10\")\n    i = 1\n    Do While InStr(i, c.Value, SEARCH_TERM) &gt; 0\n        destination.Value = c.Value\n        Set destination = destination.Offset(1, 0)\n        i = InStr(i, c.Value, SEARCH_TERM) + Len(SEARCH_TERM)\n    Loop\n  Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 4536718, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/6f9246168eb45e82be8c1ef9ac8bd983?s=128&d=identicon&r=PG&f=1", "display_name": "javad", "link": "https://stackoverflow.com/users/4536718/javad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1424873220, "creation_date": 1424806167, "last_edit_date": 1424808689, "question_id": 28704563, "link": "https://stackoverflow.com/questions/28704563/finding-a-word-in-a-range-and-inserting-those-cells-that-have-the-word-into-a-co", "title": "Finding a word in a range and inserting those cells that have the word into a column", "body": "<p>I want to find a word in a range of cells and then copying the cells that have the word in another column.<br>\nfor example the range of cells is<br></p>\n\n<pre><code>          A \n1   john see the man john\n2   rain is the friend\n3   john can teach\n4   learn\n5   learning those books\n6   fred\n7   continuing\n8   learn john\n9   see top\n10  fresh verdic\n</code></pre>\n\n<p>I want to find the word \"john\" and copying those cells that contain john in column B:<br></p>\n\n<pre><code>        B\n1  john see the man john\n2  john see the man john\n3  john can teach\n4  learn john\n</code></pre>\n\n<p>My code doesn't work.</p>\n\n<pre><code>Sub find()\n Dim m_rnFind As Range\n    Dim m_stAddress As String\n\n    'Initialize the Excel objects.\n    Set m_wbBook = ThisWorkbook\n    Set m_wsSheet = m_wbBook.Worksheets(\"Book1\")\n\n    Set m_rnCheck = m_wsSheet.Range(\"A1:A10\").SpecialCells(xlCellTypeConstants)\n\n    'Retrieve all rows that contain john.  \n    With m_rnCheck\n        Set m_rnFind = .find(What:=\"john\")\n        i = 1\n        If Not m_rnFind Is Nothing Then\n            m_stAddress = m_rnFind.value\n            Cells(i, 2).Value = m_stAddress\n\n            Do\n\n                Set m_rnFind = .FindNext(m_rnFind)\n                i = i + 1\n            Loop While Not m_rnFind Is Nothing And m_rnFind.Address &lt;&gt; m_stAddress\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n"}]